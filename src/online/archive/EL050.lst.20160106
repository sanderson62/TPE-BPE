* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   146*-----------------------------------------------------------------
   147
   148 01  WORK-AREAS.
   149
   150*****************************************************************
   151*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   152*****************************************************************
   153
   154     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   157     12  WS-NAME-EDIT-WORK-AREA.
   158         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   159         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   160             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   161         16  WS-WORK-NAME.
   162             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   163             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   164             20  FILLER           PIC X(10)     VALUE SPACES.
   165         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   166             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   167
   168*****************************************************************
   169*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   170*****************************************************************
   171
   172     12  WS-ERRESC-KEY.
   173         16 WS-ERRESC-SEARCH-KEY.
   174             20  WS-ERRESC-COMPANY-CD PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   5
* EL050.cbl
   175             20  WS-ERRESC-CARRIER    PIC  X.
   176             20  WS-ERRESC-GROUP      PIC X(6).
   177             20  WS-ERRESC-STATE      PIC XX.
   178             20  WS-ERRESC-ACCOUNT    PIC X(10).
   179         16 WS-ERRESC-RESIDUAL-KEY.
   180             20  WS-ERRESC-AGENT      PIC X(10).
   181             20  WS-ERRESC-RES-STATE  PIC XX.
   182             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   183*                                          YYYYMMDD
   184     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   185     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   186
   187*RESIDENT STATE TAX MASTER(ERRESS)
   188*
   189     12  WS-ERRESS-KEY.
   190         16  WS-ERRESS-COMPANY-CD      PIC  X.
   191         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   192         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   193         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   194*                                          YYYYMMDD
   195
   196     12  WS-CONTRACT-DATE              PIC 9(8).
   197*                                          YYYYMMDD
   198     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   199     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   200         16 WS-YEAR-YY                 PIC   9999.
   201         16 FILLER                     PIC 9(4).
   202*                                          YYYYMMDD
   203     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   204     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   205     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   206     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   207
   208     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   209         88  DPRB-1ST-TIME                      VALUE ' '.
   210
   211*****************************************************************
   212*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   213*****************************************************************
   214
   215     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   216     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   217     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   221     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   222     12  ws-st-agent-sig-edit    pic x          value spaces.
   223     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   224     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   226     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   228         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   229     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   230         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   231         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   232     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   6
* EL050.cbl
   233
   234     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   235     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   236
   237     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   238     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   251     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   252     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   273     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   274     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   275     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   276     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   285     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   286     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   287     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   288     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   289     12  WS-2671-SW               PIC X         VALUE SPACE.
   290     12  WS-2672-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   7
* EL050.cbl
   291     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   292         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   293     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   294         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   295     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   296
   297     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   298         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   299         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   300         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   301         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   302
   303     12  WS-CREDIT-EDIT-CONTROLS.
   304         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   305         16  WS-MIN-AGE           PIC 99                VALUE  0.
   306         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   307         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   308         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   309         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   310
   311     12  WS-AGE-FIELDS.
   312         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   313         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   314         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   315         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   316
   317     12  WS-SAVE-ALLOWABLE-BENEFIT.
   318         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   319         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   320         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   321         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   322         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   323         16  FILLER                      PIC XX.
   324
   325     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   326     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   327     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   328     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   329     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   330     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   331     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   332     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   333     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   334     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   335
   336     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   337     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   338     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   339     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   340     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   341     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   342     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   343     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   344         88  WS-REDUCING              VALUE 'R'.
   345         88  WS-LEVEL                 VALUE 'L' 'P'.
   346     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   347
   348     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   8
* EL050.cbl
   349     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   350     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   351     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   352     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   353     12  ws-ah-max-bens           pic 99        value zeros.
   354     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   355     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   356     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   357     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   358
   359     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   360     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   361     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   362     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   363     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   364     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   365     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   367     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   368     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   369     12  WS-ACCT-SIG-SW.
   370         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   371         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   372     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   373     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   374     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   379     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-INITIALS.
   382         16  WS-INIT-1            PIC X         VALUE SPACES.
   383         16  WS-INIT-2            PIC X         VALUE SPACES.
   384
   385     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   386     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   387     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   388     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   389     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   390*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   391     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   398     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   399     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   400     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   401     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   403     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   404     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413******** FLA
   414     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   417     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   418     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   419********
   420     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   422     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   423     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   424     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   425     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   426     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   427     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   428     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   429     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   430
   431     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   432         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   433                                         '0' THRU '9'.
   434
   435     12  NUMBER-OF-MONTHS.
   436         16  SK-MO OCCURS 12 TIMES PIC X.
   437
   438     12  WS-WORK-DATE.
   439         16  WS-YEAR            PIC 99    VALUE 00.
   440         16  WS-MONTH           PIC 99    VALUE 00.
   441         16  WS-DAY             PIC 99    VALUE 00.
   442
   443     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   444     12  WS-WORK-CRIT-DEV       REDEFINES
   445         WS-WORK-LF-CRIT-PER    PIC X(03).
   446
   447     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   448     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   449
   450     12  WS-WORK-DATE-FROM.
   451         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   452         16  FILLER             PIC X  VALUE SPACE.
   453         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   454         16  FILLER             PIC X         VALUE SPACE.
   455         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   456
   457     12  WS-WORK-DATE-THRU.
   458         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   459         16  FILLER             PIC X         VALUE SPACE.
   460         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   461         16  FILLER             PIC X         VALUE SPACE.
   462         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   463
   464     12  WS-LF-INPUT-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  10
* EL050.cbl
   465         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   466         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   467
   468     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   469     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   470         16  WS-AH-INPUT-CD-1   PIC X.
   471         16  WS-AH-INPUT-CD-2-3 PIC XX.
   472
   473     12  WS-SWITCHES.
   474         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   475         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   476             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   477         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   478             88  BANK-ACCT-FOUND          VALUE 'Y'.
   479         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   480             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   481         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   482             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   483         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   484             88  COMP-MASTER-FOUND        VALUE 'Y'.
   485         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   487         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   489         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   490             88  STAT-MASTER-FOUND        VALUE 'Y'.
   491         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   492             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   493         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   494             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   495         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   496             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   497         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   498             88  FORM-MASTER-FOUND        VALUE 'Y'.
   499         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   500             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   501         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   502             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   503         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   504             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   505         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   506             88  NO-BENEFIT-FOUND         VALUE 'N'.
   507         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   508             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   509         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   510             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   511         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  AH-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   514         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  LF-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   517         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   518             88  NO-STATE-RECORD          VALUE '1'.
   519         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   520             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   521         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   522             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  11
* EL050.cbl
   523         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   524             88  CERT-WAS-FOUND           VALUE ' '.
   525             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   526         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   527             88  BROWSE-STARTED           VALUE 'Y'.
   528         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   529             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   530         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   531             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   532         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   533             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   534         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   535             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   536         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   537             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   538         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   539             88  APP-CERT-USED            VALUE 'Y' 'A'.
   540         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   541             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   542             88  FIRST-TIME-THROUGH       VALUE '1'.
   543             88  CTBL-NOT-FOUND           VALUE '2'.
   544
   545         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   546             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   547
   548         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   549             88  DLO-ERROR-FOUND          VALUE 'Y'.
   550
   551********FLA
   552     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   553     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   554********
   555     12  RC-SW-1                  PIC X           VALUE '0'.
   556     12  RC-SW-2                  PIC X           VALUE '0'.
   557     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   558     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   559     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   567     12  LIT-SPACES               PIC X           VALUE SPACES.
   568     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   569     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   570     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   571     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   572     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   573     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   574     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   575         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   576         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   577     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   578         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   579
   580 01  WS-EXTRA-PERIODS-BY-STATE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  12
* EL050.cbl
   581     12  WS-INT-PERIODS          PIC 9.
   582     12  WS-EXTRA-PMTS           PIC 9.
   583 01  ws-net-only-state           pic x value 'N'.
   584 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   585     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   586     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   587 01  WS-CRI-SSN-WORK-AREA.
   588     05  WS-CRI-SOC-SEC-NO.
   589         10  WS-SS-REPT-CD       PIC X(5).
   590         10  WS-SS-LAST-NAME     PIC X(5).
   591         10  WS-SS-INITIAL       PIC X.
   592
   593     05  WS-CRI-REPORT-CODE.
   594         10  FILLER              PIC X(5).
   595         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   596
   597     05  WS-CRI-LAST-NAME.
   598         10  WS-CRI-NAME-MOVE    PIC X(5).
   599         10  FILLER              PIC X(10).
   600
   601 01  WS-NUM-TABLE                PIC X(26)  VALUE
   602     '12345678012345070923456789'.
   603 01  FILLER REDEFINES WS-NUM-TABLE.
   604     05  WS-NUM OCCURS 26        PIC 9.
   605 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   606 01  V1                          PIC S999 COMP-3.
   607 01  V2                          PIC S999 COMP-3.
   608 01  V3                          PIC S999 COMP-3.
   609 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   610 01  FILLER REDEFINES WS-WORK-VIN.
   611     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   612 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   613 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   614 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   615 01  WS-HEX-WORK.
   616     05  FILLER                  PIC X  VALUE LOW-VALUES.
   617     05  WS-HEX-BYTE             PIC X.
   618 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   619 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   620 01  WS-WORK-HIN-ROW-B.
   621     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   622
   623 01  ws-benefit-cd-chg-sw      pic x value spaces.
   624     88  benefit-code-chg           value 'Y'.
   625 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   626 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   627     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   628 01  WS-ROW-D-TABLE.
   629     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   630
   631 01  WS-HIN-TABLE-B.
   632     05  F                       PIC XX VALUE 'A2'.
   633     05  F                       PIC XX VALUE 'B3'.
   634     05  F                       PIC XX VALUE 'C4'.
   635     05  F                       PIC XX VALUE 'D5'.
   636     05  F                       PIC XX VALUE 'E6'.
   637     05  F                       PIC XX VALUE 'F7'.
   638     05  F                       PIC XX VALUE 'G8'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'H9'.
   640     05  F                       PIC XX VALUE 'I1'.
   641     05  F                       PIC XX VALUE 'J2'.
   642     05  F                       PIC XX VALUE 'K3'.
   643     05  F                       PIC XX VALUE 'L4'.
   644     05  F                       PIC XX VALUE 'M5'.
   645     05  F                       PIC XX VALUE 'N6'.
   646     05  F                       PIC XX VALUE 'O0'.
   647     05  F                       PIC XX VALUE 'P7'.
   648     05  F                       PIC XX VALUE 'Q0'.
   649     05  F                       PIC XX VALUE 'R8'.
   650     05  F                       PIC XX VALUE 'S9'.
   651     05  F                       PIC XX VALUE 'T2'.
   652     05  F                       PIC XX VALUE 'U3'.
   653     05  F                       PIC XX VALUE 'V4'.
   654     05  F                       PIC XX VALUE 'W5'.
   655     05  F                       PIC XX VALUE 'X6'.
   656     05  F                       PIC XX VALUE 'Y7'.
   657     05  F                       PIC XX VALUE 'Z8'.
   658 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   659     05  WS-VAL-IN               PIC X.
   660     05  WS-VAL-OUT              PIC 9.
   661 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   662 01  WS-COMPARE-BINARY-DATES.
   663     05  WS-971231                PIC XX VALUE X'92FF'.
   664     05  WS-931231                PIC XX VALUE X'8CFF'.
   665     05  WS-791231                PIC XX VALUE X'77FF'.
   666     05  WS-771001                PIC XX VALUE X'74A1'.
   667     05  WS-820301                PIC XX VALUE X'7B41'.
   668     05  WS-831031                PIC XX VALUE X'7DBF'.
   669     05  WS-831231                PIC XX VALUE X'7DFF'.
   670     05  WS-810831                PIC XX VALUE X'7A7F'.
   671     05  WS-830901                PIC XX VALUE X'7D81'.
   672
   673 01  FILE-ACCESS-IDS.
   674     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   675     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   676     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   677     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   678     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   679     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   680     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   681     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   682     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   683     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   684     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   685     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   686     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   687     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   688     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   689     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   690     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   691 01  DD-IU-SW                    PIC X   VALUE ' '.
   692     88  DD-IU-PRESENT                 VALUE 'Y'.
   693
   694 01  ACCESS-KEYS.
   695     12  ELMSTR-KEY.
   696         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  14
* EL050.cbl
   697         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   698     12  W-CLAIM-KEY.
   699         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   701
   702     12  ELCNTL-KEY.
   703         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   704         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   705         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   706         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   707
   708     12  ELCERT-KEY.
   709         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   710         16  CERT-CARRIER         PIC X       VALUE SPACE.
   711         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   712         16  CERT-STATE           PIC XX      VALUE SPACES.
   713         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   714         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   715         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   716
   717     12  ELCERT2-KEY.
   718         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   719         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   720
   721     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   722
   723     12  ELCERT-SAVE.
   724         16  FILLER                      PIC XX    VALUE SPACES.
   725
   726         16  WCS-CONTROL-PRIMARY.
   727             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   728             20  WCS-CARRIER             PIC X     VALUE SPACE.
   729             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   730             20  WCS-STATE               PIC XX    VALUE SPACES.
   731             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   732             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   733             20  WCS-CERT-NO.
   734                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   735                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-NAME.
   738             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   739             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   740             20  CS-INSURED-INITIALS.
   741                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   742                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   743
   744         16  CS-CONTROL-BY-SSN.
   745             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   746             20  CS-SOC-SEC-NO.
   747                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   748                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   749                 24  CS-SSN-LN3.
   750                     28 CS-INSURED-INITIALS-A2   PIC XX
   751                                     VALUE SPACES.
   752                     28 CS-PART-LAST-NAME-A2     PIC X
   753                                     VALUE SPACE.
   754
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  15
* EL050.cbl
   755         16  CS-CONTROL-BY-CERT-NO.
   756             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   757             20  CS-CERT-NO-A4           PIC X(11)
   758                                     VALUE SPACES.
   759
   760         16  CS-CONTROL-BY-MEMB.
   761             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   762             20  CS-MEMBER-NO.
   763                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   764                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   765                 24  CS-MEMB-LN4.
   766                     28 CS-INSURED-INITIALS-A5   PIC XX
   767                                      VALUE SPACES.
   768                     28 CS-PART-LAST-NAME-A5     PIC XX
   769                                      VALUE SPACES.
   770
   771         16  FILLER              PIC X(360) VALUE SPACES.
   772
   773     12  ERACCT-KEY.
   774         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   775         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   776         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   777         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   778         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   779         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   780
   781     12  ERCOMP-KEY.
   782         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  COMP-CARRIER         PIC X     VALUE SPACES.
   784         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   785         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   786         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   787         16  COMP-TYPE            PIC X     VALUE SPACES.
   788
   789     12  ERLOFC-KEY.
   790         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   791         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   792         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   793         16  LOFC-STATE           PIC XX    VALUE SPACES.
   794         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   795         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   796
   797     12  WS-ELCRTT-KEY.
   798         16  WS-ELCRTT-PRIMARY       PIC X(33).
   799         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   800
   801     12  ERBXRF-KEY.
   802         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   803         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   804         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   805         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   806
   807     12  ERAGTC-KEY.
   808         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   810         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   811         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   812         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  16
* EL050.cbl
   813         16  AGTC-TYPE            PIC X     VALUE SPACES.
   814
   815     12  ERPLAN-KEY.
   816         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   817         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   818         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   819         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   820         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   821         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   822         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   823         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   824
   825     12  ERFORM-KEY.
   826         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   827         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   828         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   829         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   830
   831     12  ERREIN-KEY.
   832         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  REIN-TYPE            PIC X     VALUE SPACES.
   834         16  REIN-TABLE-CO.
   835             20  REIN-CODE-1      PIC X     VALUE SPACE.
   836             20  REIN-CODE-2      PIC X     VALUE SPACE.
   837             20  REIN-CODE-3      PIC X     VALUE SPACE.
   838         16  FILLER               PIC X(3)  VALUE SPACES.
   839
   840     12  ERCTBL-KEY.
   841         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   842         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   843         16  CTBL-CNTRL-2.
   844             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   845             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   846
   847     12  ELCRTO-KEY.
   848         16  ELCRTO-COMPANY-CD       PIC X.
   849         16  ELCRTO-CARRIER          PIC X.
   850         16  ELCRTO-GROUPING         PIC X(6).
   851         16  ELCRTO-STATE            PIC XX.
   852         16  ELCRTO-ACCOUNT          PIC X(10).
   853         16  ELCRTO-CERT-EFF-DT      PIC XX.
   854         16  ELCRTO-CERT-NO.
   855             20  ELCRTO-CERT-PRIME   PIC X(10).
   856             20  ELCRTO-CERT-SFX     PIC X.
   857         16  ELCRTO-RECORD-TYPE      PIC X.
   858         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   859
   860
   861     12  WS-ACCESS.
   862         16  FILLER               PIC XX    VALUE SPACES.
   863         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   864
   865     12  WS-CARR-ACCESS.
   866         16  FILLER               PIC X(3)  VALUE SPACES.
   867         16  WS-CARR              PIC X     VALUE SPACE.
   868*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   869*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   870     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  17
* EL050.cbl
   871         88  WS-DMD-LF-RATING   VALUE 'Y'.
   872         88  WS-DMD-AH-RATING   VALUE 'Y'.
   873         88  WS-DMD-NO-RATING   VALUE 'N'.
   874
   875     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   876         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   877                                         'NJ' 'NL'
   878                                         'PJ' 'PL'
   879                                         'SJ' 'SL'.
   880     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   881         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   882                                         'NI' 'NJ' 'NL' 'NU'
   883                                         'PJ' 'PL' 'PI' 'PU'
   884                                         'SI' 'SJ' 'SL' 'SU'
   885                                         'MX' 'MY' 'MZ'.
   886 01  ERPDEF-KEY-SAVE             PIC X(18).
   887 01  ERPDEF-KEY.
   888     12  ERPDEF-COMPANY-CD       PIC X.
   889     12  ERPDEF-STATE            PIC XX.
   890     12  ERPDEF-PROD-CD          PIC XXX.
   891     12  F                       PIC X(7).
   892     12  ERPDEF-BEN-TYPE         PIC X.
   893     12  ERPDEF-BEN-CODE         PIC XX.
   894     12  ERPDEF-EXP-DT           PIC XX.
   895
   896 01  ELSTAT-KEY-SAVE             PIC X(20).
   897 01  ELSTAT-KEY.
   898     12  ELSTAT-COMPANY-ID       PIC XXX.
   899     12  ELSTAT-CARRIER          PIC X.
   900     12  ELSTAT-GROUP            PIC X(6).
   901     12  ELSTAT-STATE            PIC XX.
   902     12  ELSTAT-EXP-DT           PIC 9(8).
   903 01  WS-ERROR-VALUES.
   904     12  ER-1570                     PIC S9(4)   VALUE +1570.
   905     12  ER-1571                     PIC S9(4)   VALUE +1571.
   906     12  er-1572                     pic s9(4)   value +1572.
   907     12  er-1573                     pic s9(4)   value +1573.
   908     12  er-1574                     pic s9(4)   value +1574.
   909     12  ER-1575                     PIC S9(4)   VALUE +1575.
   910     12  er-1576                     pic s9(4)   value +1576.
   911     12  er-1743                     pic s9(4)   value +1743.
   912     12  er-1744                     pic s9(4)   value +1744.
   913     12  er-1745                     pic s9(4)   value +1745.
   914     12  er-1746                     pic s9(4)   value +1746.
   915     12  er-1747                     pic s9(4)   value +1747.
   916     12  er-1748                     pic s9(4)   value +1748.
   917     12  ER-1891                     PIC S9(4)   VALUE +1891.
   918     12  ER-1892                     PIC S9(4)   VALUE +1892.
   919     12  ER-1893                     PIC S9(4)   VALUE +1893.
   920     12  ER-1894                     PIC S9(4)   VALUE +1894.
   921     12  ER-1895                     PIC S9(4)   VALUE +1895.
   922     12  ER-1896                     PIC S9(4)   VALUE +1896.
   923     12  ER-1897                     PIC S9(4)   VALUE +1897.
   924     12  ER-1898                     PIC S9(4)   VALUE +1898.
   925     12  ER-1899                     PIC S9(4)   VALUE +1899.
   926     12  ER-1900                     PIC S9(4)   VALUE +1900.
   927     12  ER-1901                     PIC S9(4)   VALUE +1901.
   928     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  18
* EL050.cbl
   929     12  ER-1903                     PIC S9(4)   VALUE +1903.
   930     12  ER-1904                     PIC S9(4)   VALUE +1904.
   931     12  ER-1905                     PIC S9(4)   VALUE +1905.
   932     12  ER-1906                     PIC S9(4)   VALUE +1906.
   933     12  ER-1907                     PIC S9(4)   VALUE +1907.
   934     12  ER-1909                     PIC S9(4)   VALUE +1909.
   935     12  ER-1910                     PIC S9(4)   VALUE +1910.
   936     12  ER-1911                     PIC S9(4)   VALUE +1911.
   937     12  ER-1912                     PIC S9(4)   VALUE +1912.
   938     12  ER-1913                     PIC S9(4)   VALUE +1913.
   939     12  ER-1914                     PIC S9(4)   VALUE +1914.
   940     12  ER-1915                     PIC S9(4)   VALUE +1915.
   941     12  ER-1916                     PIC S9(4)   VALUE +1916.
   942     12  ER-1917                     PIC S9(4)   VALUE +1917.
   943     12  ER-1918                     PIC S9(4)   VALUE +1918.
   944     12  ER-1919                     PIC S9(4)   VALUE +1919.
   945     12  ER-1920                     PIC S9(4)   VALUE +1920.
   946     12  ER-1921                     PIC S9(4)   VALUE +1921.
   947     12  ER-1922                     PIC S9(4)   VALUE +1922.
   948     12  ER-1923                     PIC S9(4)   VALUE +1923.
   949     12  ER-1924                     PIC S9(4)   VALUE +1924.
   950     12  ER-1925                     PIC S9(4)   VALUE +1925.
   951     12  ER-1926                     PIC S9(4)   VALUE +1926.
   952     12  ER-1927                     PIC S9(4)   VALUE +1927.
   953     12  ER-2393                     PIC S9(4)   VALUE +2393.
   954     12  ER-2600                     PIC S9(4)   VALUE +2600.
   955     12  ER-2601                     PIC S9(4)   VALUE +2601.
   956     12  ER-2602                     PIC S9(4)   VALUE +2602.
   957     12  ER-2603                     PIC S9(4)   VALUE +2603.
   958     12  ER-2604                     PIC S9(4)   VALUE +2604.
   959     12  ER-2605                     PIC S9(4)   VALUE +2605.
   960     12  ER-2606                     PIC S9(4)   VALUE +2606.
   961     12  ER-2607                     PIC S9(4)   VALUE +2607.
   962     12  ER-2608                     PIC S9(4)   VALUE +2608.
   963     12  ER-2609                     PIC S9(4)   VALUE +2609.
   964     12  ER-2610                     PIC S9(4)   VALUE +2610.
   965     12  ER-2611                     PIC S9(4)   VALUE +2611.
   966     12  ER-2612                     PIC S9(4)   VALUE +2612.
   967     12  ER-2613                     PIC S9(4)   VALUE +2613.
   968     12  ER-2614                     PIC S9(4)   VALUE +2614.
   969     12  ER-2615                     PIC S9(4)   VALUE +2615.
   970     12  ER-2616                     PIC S9(4)   VALUE +2616.
   971     12  ER-2617                     PIC S9(4)   VALUE +2617.
   972     12  ER-2618                     PIC S9(4)   VALUE +2618.
   973     12  ER-2619                     PIC S9(4)   VALUE +2619.
   974     12  ER-2620                     PIC S9(4)   VALUE +2620.
   975     12  ER-2621                     PIC S9(4)   VALUE +2621.
   976     12  ER-2622                     PIC S9(4)   VALUE +2622.
   977     12  ER-2623                     PIC S9(4)   VALUE +2623.
   978     12  ER-2624                     PIC S9(4)   VALUE +2624.
   979     12  ER-2625                     PIC S9(4)   VALUE +2625.
   980     12  ER-2626                     PIC S9(4)   VALUE +2626.
   981     12  ER-2627                     PIC S9(4)   VALUE +2627.
   982     12  ER-2628                     PIC S9(4)   VALUE +2628.
   983     12  ER-2629                     PIC S9(4)   VALUE +2629.
   984     12  ER-2630                     PIC S9(4)   VALUE +2630.
   985     12  ER-2631                     PIC S9(4)   VALUE +2631.
   986     12  ER-2632                     PIC S9(4)   VALUE +2632.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  19
* EL050.cbl
   987     12  ER-2633                     PIC S9(4)   VALUE +2633.
   988     12  ER-2634                     PIC S9(4)   VALUE +2634.
   989     12  ER-2635                     PIC S9(4)   VALUE +2635.
   990     12  ER-2636                     PIC S9(4)   VALUE +2636.
   991     12  ER-2637                     PIC S9(4)   VALUE +2637.
   992     12  ER-2638                     PIC S9(4)   VALUE +2638.
   993     12  ER-2639                     PIC S9(4)   VALUE +2639.
   994     12  ER-2640                     PIC S9(4)   VALUE +2640.
   995     12  ER-2641                     PIC S9(4)   VALUE +2641.
   996     12  ER-2642                     PIC S9(4)   VALUE +2642.
   997     12  ER-2643                     PIC S9(4)   VALUE +2643.
   998     12  ER-2644                     PIC S9(4)   VALUE +2644.
   999     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1000     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1001     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1002     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1003     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1004     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1005     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1006     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1007     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1008     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1009     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1010     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1011     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1012     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1013     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1014     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1015     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1016     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1017     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1018     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1019     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1020     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1021     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1022     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1023     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1024     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1025     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1026     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1027     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1028     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1029     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1030     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1031     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1032     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1033     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1034     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1035     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1036     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1037     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1038     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1039     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1040     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1041     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1042     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1043     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1044     12  ER-2690                     PIC S9(4)   VALUE +2690.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  20
* EL050.cbl
  1045     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1046     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1047     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1048     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1049     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1050     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1051     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1052     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1053     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1054     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1055     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1056     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1057     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1058     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1059     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1060     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1061     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1062     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1063     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1064     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1065     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1066     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1067     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1068     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1069     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1070     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1071     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1072     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1073     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1074     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1075     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1076     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1077     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1078     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1079     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1080     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1081     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1082     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1083     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1084     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1085     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1086     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1087     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1088     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1089     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1090     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1091     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1092     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1093     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1094     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1095     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1096     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1097     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1098     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1099     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1100     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1101     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1102     12  ER-2758                     PIC S9(4)   VALUE +2758.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  21
* EL050.cbl
  1103     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1104     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1105     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1106     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1107     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1108     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1109     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1110     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1111     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1112     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1113     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1114     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1115     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1116     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1117     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1118     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1119     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1120     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1121     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1122     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1123     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1124     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1125     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1126     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1127     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1128     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1129     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1130     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1131     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1132     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1133     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1134     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1135     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1136     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1137     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1138     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1139     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1140     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1141     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1142     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1143     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1144     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1145     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1146     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1147     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1148     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1149     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1150     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1151     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1152     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1153     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1154     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1155     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1156     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1157     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1158     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1159     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1160     12  ER-3006                     PIC S9(4)   VALUE +3006.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  22
* EL050.cbl
  1161     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1162     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1163     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1164     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1165     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1166     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1167     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1168     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1169     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1170     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1171     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1172     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1173     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1174     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1175     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1176     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1177     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1178     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1179     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1180     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1181     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1182     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1183     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1184     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1185     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1186     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1187     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1188     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1189     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1190     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1191     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1192     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1193     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1194     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1195     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1196     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1197     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1198     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1199     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1200     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1201     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1202     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1203     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1204     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1205     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1206     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1207     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1208     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1209     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1210     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1211     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1212     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1213     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1214     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1215     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1216     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1217     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1218     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  23
* EL050.cbl
  1219     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1220     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1221     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1222     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1223     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1224     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1225     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1226     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1227     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1228     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1229     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1230     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1231     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1232     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1233     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1234     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1235     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1236     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1237     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1238     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1239     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1240     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1241     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1242     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1243     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1244     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1245     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1246     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1247     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1248     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1249     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1250     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1251     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1252     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1253     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1254     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1255     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1256     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1257     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1258     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1259     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1260     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1261******************************************************************
  1262***************   END OF ELC50WS     ****************************
  1263******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  24
* EL050.cbl
  1266 01  WORKING-STORAGE-WORK-AREAS.
  1267     12  WS-RESPONSE             PIC S9(8)  COMP.
  1268         88  WS-RESP-NORMAL           VALUE +00.
  1269         88  WS-RESP-ERROR            VALUE +01.
  1270         88  WS-RESP-NOTFND           VALUE +13.
  1271         88  WS-RESP-DUPREC           VALUE +14.
  1272         88  WS-RESP-ENDFILE          VALUE +20.
  1273     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1274     12  WORK-AREAS.
  1275         16  WK-CONV-GREG.
  1276             24  WCG-CENT             PIC XX.
  1277             24  WCG-REST             PIC X(4).
  1278         16  WORK-GREGORIAN-DATE.
  1279             24  WK-GREG-CENT         PIC XX.
  1280             24  WK-GREG-DATE-YYMMDD.
  1281                 28  WK-GREG-YYMM     PIC X(4).
  1282                 28  WK-GREG-DD       PIC XX.
  1283
  1284         16  WORK-SELECT-DATE.
  1285             24  WK-SELECT-CENT            PIC XX.
  1286             24  WK-SELECT-DATE-YYMMDD.
  1287                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1288                 28  FILLER                PIC XX.
  1289
  1290         16  WK-FORM-NO.
  1291             24  WK-FORM-BANK-ID       PIC X(5).
  1292             24  WK-FORM-UNDRWRTR      PIC X(1).
  1293             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1294
  1295         16  WK-MEMBER-NO.
  1296             24  WK-MEMBER-1-6        PIC X(6).
  1297             24  WK-MEMBER-7-12       PIC X(6).
  1298
  1299         16  WK-FULL-CERT-NO.
  1300             24  WK-CERT-POS-1-2      PIC X(2).
  1301             24  WK-CERT-POS-3        PIC X(1).
  1302             24  WK-CERT-POS-4        PIC X(1).
  1303             24  WK-CERT-POS-5-6      PIC X(2).
  1304             24  WK-CERT-POS-7        PIC X(1).
  1305             24  WK-CERT-POS-8-11     PIC X(4).
  1306
  1307         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1308             88  VALID-RATE-CODE        VALUE 'Y'.
  1309             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1310
  1311         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1312         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1313         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1314         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1315         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1316         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1317         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1318         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1319         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1320         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1321
  1322* DLO001
  1323 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  25
* EL050.cbl
  1324     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1325     12  DMPF-RETURN-CODE          PIC XX.
  1326         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1327         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1328         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1329         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1330         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1331         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1332
  1333* DLO002
  1334 01  WS-DLO-INTERNAL-POLICY-FORM.
  1335     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1336     12  DIPF-RETURN-CODE          PIC XX.
  1337         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1338         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1339         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1340         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1341         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1342         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1343
  1344* DLO003
  1345 01  WS-DLO-VALID-BANK-ID.
  1346     12  DVBI-BANK-ID              PIC X(5).
  1347     12  DVBI-BANK-ID-TYPE         PIC X.
  1348         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1349         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1350         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1351         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1352         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1353     12  DVBI-RETURN-CODE          PIC XX.
  1354         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1355         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1356         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1357         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1358         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1359         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1360         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1361         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1362         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1363
  1364* DLO007
  1365 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1366     12  DCUA-RES-STATE            PIC XX.
  1367     12  DCUA-BEN-TYPE             PIC XX.
  1368     12  DCUA-SYS-IDENT            PIC X.
  1369         88  DCUA-CLAIM                        VALUE 'C'.
  1370         88  DCUA-PREMIUM                      VALUE 'P'.
  1371     12  DCUA-COVERAGE-RULE        PIC X.
  1372     12  DCUA-CLIENT-ID            PIC X(10).
  1373     12  DCUA-EFF-DATE             PIC X(8).
  1374     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1375     12  DCUA-RETURN-CODE          PIC XX.
  1376         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1377     12  DCUA-CERT-NUMBER          PIC X(11).
  1378     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1379     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1380
  1381* DLO011
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  26
* EL050.cbl
  1382 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1383     12  DPRB-RATE-CODE            PIC X(4).
  1384     12  DPRB-COVERAGE-CATEG       PIC X.
  1385     12  DPRB-RETURN-CODE          PIC XX.
  1386         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1387         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1388         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1389         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1390         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1391         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1392         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1393         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1395     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1396     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1397     12  DPRB-BEN-TYPE             PIC XX.
  1398
  1399* DLO017
  1400 01  WS-DLO-VALID-RATE-CODE.
  1401     12  DVRC-RATE-CODE            PIC X(4).
  1402     12  DVRC-RETURN-CODE          PIC XX.
  1403         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1404         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1405         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1406         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1407         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1408         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1409
  1410* DLO019
  1411 01  WS-DLO-ORIG-COV-CAT.
  1412     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1413     12  DOCC-RETURN-CODE          PIC XX.
  1414     12  DOCC-ORIG-COV-CAT         PIC X.
  1415     12  DOCC-UNDERWITER           PIC XX.
  1416     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1417     12  DOCC-FILLER               PIC X(6).
  1418
  1419* DLO021
  1420 01  WS-DLO-VALID-LOAN-OFFICER.
  1421     12  DVLO-LOAN-OFFICER.
  1422         16  DVLO-BILL-TYPE        PIC X.
  1423         16  DVLO-BILL-SOURCE      PIC X.
  1424         16  DVLO-BATCH-TYPE       PIC X.
  1425     12  DVLO-RETURN-CODE          PIC XX.
  1426         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1427         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1428         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1429         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1430         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1431         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1432
  1433* DLO022
  1434 01  WS-DLO-VALID-STATE-CODE.
  1435     12  DVSC-STATE-CODE           PIC XX.
  1436     12  DVSC-RETURN-CODE          PIC XX.
  1437         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1438
  1439* DLO023
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  27
* EL050.cbl
  1440 01  WS-DLO-VALID-CODE-VALUES.
  1441     12  DVCV-SYSTEM-ID            PIC XX.
  1442         88  DVCV-CLAIMS                       VALUE 'CL'.
  1443         88  DVCV-CREDIT                       VALUE 'CR'.
  1444     12  DVCV-RECORD-TYPE          PIC XX.
  1445         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1446         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1447         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1448         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1449         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1450         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1451         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1452         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1453     12  DVCV-RECORD-KEY           PIC X(6).
  1454     12  DVCV-RETURN-CODE          PIC XX.
  1455         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1456         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1457         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1458         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1459         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1460         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1461         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1462     12  DVCV-CODE-DESC            PIC X(60).
  1463     12  DVCV-GEN-DESC-1           PIC X(20).
  1464     12  DVCV-GEN-DESC-2           PIC X(20).
  1465     12  DVCV-GEN-DESC-3           PIC X(20).
  1466
  1467****  this is for aggregate report.
  1468****  Length is erpndb + 100 of passed-key-area
  1469 01  ws-passed-key-length        pic s9(4) comp value +587.
  1470 01  ws-pass-to-pemaggo.
  1471     05  ws-passed-erpndb        pic x(585).
  1472     05  ws-exceed-limit-yn      pic x.
  1473     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  28
* EL050.cbl
  1475*    COPY ERCBXRF.
  1476******************************************************************
  1477*                                                                *
  1478*                                                                *
  1479*                            ERCBXRF                             *
  1480*                                                                *
  1481*   ONLINE CREDIT SYSTEM                                         *
  1482*                                                                *
  1483*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1484*                                                                *
  1485*   FILE TYPE = VSAM,KSDS                                        *
  1486*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1487*                                                                *
  1488*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1489*       ALTERNATE PATH = NONE                                    *
  1490*                                                                *
  1491*   LOG = NO                                                     *
  1492*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1493*                                                                *
  1494******************************************************************
  1495
  1496 01  BANK-CROSS-REFERENCE.
  1497     12  BK-RECORD-ID                PIC XX.
  1498         88  VALID-BK-ID             VALUE 'BK'.
  1499
  1500     12  BK-CONTROL-PRIMARY.
  1501         16  BK-COMPANY-CD           PIC X.
  1502         16  BK-CARRIER              PIC X.
  1503         16  BK-GROUPING             PIC X(6).
  1504         16  BK-BANK-NO              PIC X(10).
  1505
  1506     12  BK-MAINT-INFORMATION.
  1507         16  BK-LAST-MAINT-DT        PIC XX.
  1508         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1509         16  BK-LAST-MAINT-USER      PIC X(4).
  1510         16  FILLER                  PIC X(9).
  1511
  1512     12  FILLER                      PIC X(37).
  1513
  1514     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1515
  1516     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1517                            DEPENDING ON BK-BANK-POINTER-CNT.
  1518         16  BK-AM-ACCOUNT           PIC X(10).
  1519         16  BK-AM-EXP-DT            PIC XX.
  1520         16  BK-AM-EFF-DT            PIC XX.
  1521         16  BK-AM-STATE             PIC XX.
  1522         16  FILLER                  PIC X(20).
  1523
  1524******************************************************************
  1525
  1526*    COPY ERCCOMP.
  1527******************************************************************
  1528*                                                                *
  1529*                                                                *
  1530*                            ERCCOMP                             *
  1531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1532*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  29
* EL050.cbl
  1533*                                                                *
  1534*   ONLINE CREDIT SYSTEM                                         *
  1535*                                                                *
  1536*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1537*                                                                *
  1538*   FILE TYPE = VSAM,KSDS                                        *
  1539*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1540*                                                                *
  1541*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1542*       ALTERNATE PATH = NONE                                    *
  1543*                                                                *
  1544*   LOG = NO                                                     *
  1545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1546*                                                                *
  1547******************************************************************
  1548*                   C H A N G E   L O G
  1549*
  1550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1551*-----------------------------------------------------------------
  1552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1553* EFFECTIVE    NUMBER
  1554*-----------------------------------------------------------------
  1555* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1556* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1557* 092205    2005050300006  PEMA  ADD LEASE FEE
  1558* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1559* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1560* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1561* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1562* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1563* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1564******************************************************************
  1565
  1566 01  COMPENSATION-MASTER.
  1567     12  CO-RECORD-ID                          PIC XX.
  1568         88  VALID-CO-ID                          VALUE 'CO'.
  1569
  1570     12  CO-CONTROL-PRIMARY.
  1571         16  CO-COMPANY-CD                     PIC X.
  1572         16  CO-CONTROL.
  1573             20  CO-CTL-1.
  1574                 24  CO-CARR-GROUP.
  1575                     28  CO-CARRIER            PIC X.
  1576                     28  CO-GROUPING.
  1577                         32  CO-GROUP-PREFIX   PIC XXX.
  1578                         32  CO-GROUP-PRIME    PIC XXX.
  1579                 24  CO-RESP-NO.
  1580                     28  CO-RESP-PREFIX        PIC X(4).
  1581                     28  CO-RESP-PRIME         PIC X(6).
  1582             20  CO-CTL-2.
  1583                 24  CO-ACCOUNT.
  1584                     28  CO-ACCT-PREFIX        PIC X(4).
  1585                     28  CO-ACCT-PRIME         PIC X(6).
  1586         16  CO-TYPE                           PIC X.
  1587             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1588             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1589             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1590
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  30
* EL050.cbl
  1591     12  CO-MAINT-INFORMATION.
  1592         16  CO-LAST-MAINT-DT                  PIC XX.
  1593         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1594         16  CO-LAST-MAINT-USER                PIC X(4).
  1595     12  FILLER                                PIC XX.
  1596     12  CO-STMT-TYPE                          PIC XXX.
  1597     12  CO-COMP-TYPE                          PIC X.
  1598         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1599     12  CO-STMT-OWNER                         PIC X(4).
  1600     12  CO-BALANCE-CONTROL                    PIC X.
  1601         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1602         88  CO-NO-BALANCE                        VALUE 'N'.
  1603
  1604     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1605         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1606         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1607         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1608
  1609     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1610         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1611         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1612
  1613     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1614     12  CO-GA-DIRECT-DEP                      PIC X.
  1615     12  CO-FUTURE-SPACE                       PIC X.
  1616         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1617
  1618     12  CO-ACCT-NAME                          PIC X(30).
  1619     12  CO-MAIL-NAME                          PIC X(30).
  1620     12  CO-ADDR-1                             PIC X(30).
  1621     12  CO-ADDR-2                             PIC X(30).
  1622     12  CO-ADDR-3.
  1623         16  CO-ADDR-CITY                      PIC X(27).
  1624         16  CO-ADDR-STATE                     PIC XX.
  1625     12  CO-CSO-1099                           PIC X.
  1626     12  CO-ZIP.
  1627         16  CO-ZIP-PRIME.
  1628             20  CO-ZIP-PRI-1ST                PIC X.
  1629                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1630             20  FILLER                        PIC X(4).
  1631         16  CO-ZIP-PLUS4                      PIC X(4).
  1632     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1633         16  CO-CAN-POSTAL-1                   PIC XXX.
  1634         16  CO-CAN-POSTAL-2                   PIC XXX.
  1635         16  FILLER                            PIC XXX.
  1636     12  CO-SOC-SEC                            PIC X(13).
  1637     12  CO-TELEPHONE.
  1638         16  CO-AREA-CODE                      PIC XXX.
  1639         16  CO-PREFIX                         PIC XXX.
  1640         16  CO-PHONE                          PIC X(4).
  1641
  1642     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1643
  1644     12  CO-AR-BAL-LEVEL                       PIC X.
  1645         88  CO-AR-REF-LVL                        VALUE '1'.
  1646         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1647         88  CO-AR-BILL-LVL                       VALUE '2'.
  1648         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  31
* EL050.cbl
  1649         88  CO-AR-FR-LVL                         VALUE '4'.
  1650
  1651     12  CO-AR-NORMAL-PRINT                    PIC X.
  1652         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1653         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1654
  1655     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1656
  1657     12  CO-AR-REPORTING                       PIC X.
  1658         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1659         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1660
  1661     12  CO-AR-PULL-CHECK                      PIC X.
  1662         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1663         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1664
  1665     12  CO-AR-BALANCE-PRINT                   PIC X.
  1666         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1667
  1668     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1669         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1670         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1671         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1672
  1673     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1674
  1675     12  CO-USER-CODE                          PIC X.
  1676     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1677
  1678******************************************************************
  1679*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1680*    THE LAST MONTH END RUN.
  1681******************************************************************
  1682
  1683     12  CO-LAST-ACTIVITY-DATE.
  1684         16  CO-ACT-YEAR                       PIC 99.
  1685         16  CO-ACT-MONTH                      PIC 99.
  1686         16  CO-ACT-DAY                        PIC 99.
  1687
  1688     12  CO-LAST-STMT-DT.
  1689         16  CO-LAST-STMT-YEAR                 PIC 99.
  1690         16  CO-LAST-STMT-MONTH                PIC 99.
  1691         16  CO-LAST-STMT-DAY                  PIC 99.
  1692
  1693     12  CO-MO-END-TOTALS.
  1694         16  CO-MONTHLY-TOTALS.
  1695             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1696             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1697             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1698             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1699             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1700
  1701         16  CO-AGING-TOTALS.
  1702             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1703             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1704             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1705             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1706
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  32
* EL050.cbl
  1707         16  CO-YTD-TOTALS.
  1708             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1709             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1710
  1711         16  CO-OVER-UNDER-TOTALS.
  1712             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1714
  1715     12  CO-MISCELLANEOUS-TOTALS.
  1716         16  CO-FICA-TOTALS.
  1717             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1718             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CLAIM-TOTALS.
  1721             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1722             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1723
  1724******************************************************************
  1725*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1726*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1727******************************************************************
  1728
  1729     12  CO-CURRENT-TOTALS.
  1730         16  CO-CURRENT-LAST-STMT-DT.
  1731             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1732             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1733             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1734
  1735         16  CO-CURRENT-MONTHLY-TOTALS.
  1736             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1737             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1738             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1739             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1740             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1741
  1742         16  CO-CURRENT-AGING-TOTALS.
  1743             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1745             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1747
  1748         16  CO-CURRENT-YTD-TOTALS.
  1749             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1751
  1752     12  CO-PAID-COMM-TOTALS.
  1753         16  CO-YTD-PAID-COMMS.
  1754             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1755             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1756
  1757     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1758         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1759         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1760
  1761     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1762         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1763         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1764         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  33
* EL050.cbl
  1765         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1766         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1767         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1768         88  CO-FINAL-LETTER                  VALUE 'F'.
  1769         88  CO-RECONCILING                   VALUE 'R'.
  1770         88  CO-PHONE-CALL                    VALUE 'P'.
  1771         88  CO-LEGAL                         VALUE 'L'.
  1772         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1773         88  CO-WRITE-OFF                     VALUE 'W'.
  1774         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1775
  1776     12  CO-CSR-CODE                       PIC X(4).
  1777
  1778     12  CO-GA-STATUS-INFO.
  1779         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1780         16  CO-GA-TERMINATION-DT          PIC XX.
  1781         16  CO-GA-STATUS-CODE             PIC X.
  1782             88  CO-GA-ACTIVE                 VALUE 'A'.
  1783             88  CO-GA-INACTIVE               VALUE 'I'.
  1784             88  CO-GA-PENDING                VALUE 'P'.
  1785         16  CO-GA-COMMENTS.
  1786             20  CO-GA-COMMENT-1           PIC X(40).
  1787             20  CO-GA-COMMENT-2           PIC X(40).
  1788             20  CO-GA-COMMENT-3           PIC X(40).
  1789             20  CO-GA-COMMENT-4           PIC X(40).
  1790
  1791     12  CO-RPTCD2                         PIC X(10).
  1792     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1793         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1794         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1795
  1796     12  CO-TYPE-AGENT                     PIC X(01).
  1797         88  CO-CORPORATION                   VALUE 'C'.
  1798         88  CO-PARTNERSHIP                   VALUE 'P'.
  1799         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1800         88  CO-TRUST                         VALUE 'T'.
  1801         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1802
  1803     12  CO-FAXNO.
  1804         16  CO-FAX-AREA-CODE                  PIC XXX.
  1805         16  CO-FAX-PREFIX                     PIC XXX.
  1806         16  CO-FAX-PHONE                      PIC X(4).
  1807
  1808     12  CO-BANK-INFORMATION.
  1809         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1810         16  CO-BANK-TRANSIT-NON REDEFINES
  1811             CO-BANK-TRANSIT-NO                PIC 9(8).
  1812
  1813         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1814     12  CO-MISC-DEDUCT-INFO REDEFINES
  1815                  CO-BANK-INFORMATION.
  1816         16  CO-MD-GL-ACCT                     PIC X(10).
  1817         16  CO-MD-DIV                         PIC XX.
  1818         16  CO-MD-CENTER                      PIC X(4).
  1819         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1820         16  CO-CREATE-AP-CHECK                PIC X.
  1821         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1822         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  34
* EL050.cbl
  1823     12  CO-ACH-STATUS                         PIC X.
  1824         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1825         88  CO-ACH-PENDING                        VALUE 'P'.
  1826
  1827     12  CO-BILL-SW                            PIC X.
  1828     12  CO-CONTROL-NAME                       PIC X(30).
  1829     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1830     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1831     12  CO-CLP-STATE                          PIC XX.
  1832     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1833     12  CO-SPP-REFUND-EDIT                    PIC X.
  1834
  1835******************************************************************
  1836
  1837*    COPY ERCAGTC.
  1838******************************************************************
  1839*                                                                *
  1840*                                                                *
  1841*                            ERCAGTC                             *
  1842*                            VMOD=2.001                          *
  1843*                                                                *
  1844*   ONLINE CREDIT SYSTEM                                         *
  1845*                                                                *
  1846*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1847*                                                                *
  1848*   FILE TYPE = VSAM,KSDS                                        *
  1849*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1850*                                                                *
  1851*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1852*       ALTERNATE PATH = NONE                                    *
  1853*                                                                *
  1854*   LOG = NO                                                     *
  1855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1856*                                                                *
  1857******************************************************************
  1858*                   C H A N G E   L O G
  1859*
  1860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1861*-----------------------------------------------------------------
  1862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1863* EFFECTIVE    NUMBER
  1864*-----------------------------------------------------------------
  1865* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1866* 111004                         NEW FILE AND COPYBOOK
  1867* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1868******************************************************************
  1869 01  AGENT-COMMISSIONS.
  1870     12  AG-RECORD-ID                          PIC XX.
  1871         88  VALID-CO-ID                          VALUE 'AG'.
  1872     12  AG-CONTROL-PRIMARY.
  1873         16  AG-COMPANY-CD                     PIC X.
  1874         16  AG-CONTROL.
  1875             20  AG-CTL-1.
  1876                 24  AG-CARR-GROUP.
  1877                     28  AG-CARRIER            PIC X.
  1878                     28  AG-GROUPING           PIC X(6).
  1879                 24  AG-BANK                   PIC X(10).
  1880             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  35
* EL050.cbl
  1881                 24  AG-EXP-DT                 PIC XX.
  1882         16  AG-TYPE                           PIC X.
  1883             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1884             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1885     12  AG-MAINT-INFORMATION.
  1886         16  AG-LAST-MAINT-DT                  PIC XX.
  1887         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1888         16  AG-LAST-MAINT-USER                PIC X(4).
  1889         16  FILLER                            PIC X(10).
  1890     12  AG-EFF-DT                             PIC XX.
  1891     12  AG-COMM-STRUCTURE.
  1892         16  AG-AGT-COMMS OCCURS 10.
  1893             20  AG-AGT                PIC X(10).
  1894             20  AG-COM-TYP            PIC X.
  1895             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1896             20  AG-RECALC-LV-INDIC    PIC X.
  1897             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1898             20  AG-LRCALC-LV-INDIC    PIC X.
  1899             20  FILLER                PIC X(05).
  1900     12  FILLER                  PIC X(145).
  1901******************************************************************
  1902*    COPY ERCRESS.
  1903******************************************************************
  1904*                                                                *
  1905*                            ERCRESS                             *
  1906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1907*                            VMOD=2.002                          *
  1908*                                                                *
  1909*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1910*                                                                *
  1911*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1912*   VSAM RESIDENT STATE TAX MASTER                              *
  1913*                                                                *
  1914*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1915*                                                                *
  1916*   FILE TYPE = VSAM,KSDS                                        *
  1917*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1918*                                                                *
  1919*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1920*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1921*                                                                *
  1922*   LOG = NO                                                     *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924*                                                                *
  1925*                                                                *
  1926******************************************************************
  1927
  1928 01  RESIDENT-STATE-TAX-MASTER.
  1929
  1930     10  ERRESS-PRIMARY-KEY.
  1931         15  RES-COMPANY-CD        PIC X.
  1932         15  RES-RESIDENT-STATE    PIC XX.
  1933         15  RES-COVERAGE-CATEGORY PIC X.
  1934         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1935*                                      YYYYMMDD
  1936*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1937
  1938     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  36
* EL050.cbl
  1939
  1940         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1941         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1942         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1943         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1944
  1945     10 RES-RECALC-SW              PIC   X.
  1946         88 RECALC                VALUE 'Y'.
  1947         88 NO-RECALC             VALUE 'N'.
  1948     10  RES-MAINT-BY              PIC X(4).
  1949     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1950     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1951*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  37
* EL050.cbl
  1953*    COPY ERCRESC.
  1954******************************************************************
  1955*                                                                *
  1956*                            ERCRESC                             *
  1957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1958*                            VMOD=2.003                          *
  1959*                                                                *
  1960*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1966*       ALTERNATE PATH1 = NONE                                   *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971******************************************************************
  1972
  1973 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1974
  1975     10  ERRESC-RECORD-KEY.
  1976         15  RESC-COMPANY-CD           PIC   X.
  1977         15  RESC-CARRIER              PIC   X.
  1978         15  RESC-GROUP                PIC   X(6).
  1979         15  RESC-STATE                PIC   XX.
  1980         15  RESC-ACCOUNT              PIC   X(10).
  1981         15  RESC-AGENT                PIC   X(10).
  1982         15  RESC-RESIDENT-STATE       PIC   XX.
  1983         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1984*                                           YYYYMMDD
  1985     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1986
  1987     10  RESC-COMM-RECORD-DATA.
  1988         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1989             20 RESC-COVERAGE-CAT      PIC    X.
  1990             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1991             20 RESC-COMMISSION-TAB REDEFINES
  1992                RESC-COMMISSION-PER    PIC  XXX.
  1993
  1994     10  RESC-MAINT-BY                 PIC X(4).
  1995     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1996     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1997*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  38
* EL050.cbl
  1999*    COPY ERCPLAN.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ERCPLAN                             *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.003                          *
  2006*                                                                *
  2007*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2008*                                                                *
  2009*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2010*   PLAN MASTER                                                  *
  2011*                                                                *
  2012*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2013*                                                                *
  2014*   FILE TYPE = VSAM,KSDS                                        *
  2015*   RECORD SIZE = 420   RECFORM = FIX                            *
  2016*                                                                *
  2017*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2018*       ALTERNATE PATH1 = N/A                                    *
  2019*                                                                *
  2020*   LOG = NO                                                     *
  2021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2022*                                                                *
  2023*                                                                *
  2024******************************************************************
  2025
  2026 01  PLAN-MASTER.
  2027     12  PL-RECORD-ID                      PIC XX.
  2028         88  VALID-PL-ID                      VALUE 'PL'.
  2029
  2030     12  PL-CONTROL-PRIMARY.
  2031         16  PL-COMPANY-CD                 PIC X.
  2032         16  PL-MSTR-CNTRL.
  2033             20  PL-CONTROL-A.
  2034                 24  PL-CARRIER            PIC X.
  2035                 24  PL-GROUPING           PIC X(6).
  2036                 24  PL-STATE              PIC XX.
  2037                 24  PL-ACCOUNT            PIC X(10).
  2038             20  PL-BENEFIT-TYPE           PIC X.
  2039             20  PL-BENEFIT-CODE           PIC XX.
  2040             20  PL-REVISION-NO            PIC X(3).
  2041
  2042     12  PL-CONTROL-BY-VAR-GRP.
  2043         16  PL-COMPANY-CD-A1              PIC X.
  2044         16  PL-VG-CARRIER                 PIC X.
  2045         16  PL-VG-GROUPING                PIC X(6).
  2046         16  PL-VG-STATE                   PIC XX.
  2047         16  PL-VG-ACCOUNT                 PIC X(10).
  2048         16  PL-BENEFIT-TYPE-A1            PIC X.
  2049         16  PL-BENEFIT-CODE-A1            PIC XX.
  2050         16  PL-REVISION-NO-A1             PIC 999.
  2051
  2052     12  PL-MAINT-INFORMATION.
  2053         16  PL-LAST-MAINT-DT              PIC XX.
  2054         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2055         16  PL-LAST-MAINT-USER            PIC X(4).
  2056         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  39
* EL050.cbl
  2057
  2058     12  PL-LIABILITY-LIMITS.
  2059         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2060         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2061             20  PL-LM-AGE                 PIC S99        COMP-3.
  2062             20  PL-LM-DUR                 PIC S999       COMP-3.
  2063             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2064             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2065
  2066     12  FILLER                            PIC X(30).
  2067
  2068     12  PL-GL-ACCOUNT-NOS.
  2069         16  PL-PREMIUM-GL                 PIC X(8).
  2070         16  PL-COMM-GL                    PIC X(8).
  2071         16  PL-CLAIM-GL                   PIC X(8).
  2072     12  FILLER                            PIC X(24).
  2073     12  PL-TOLERANCES.
  2074         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2075         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2076         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2077         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2078         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2079         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2080     12  PL-OVER-SHORT.
  2081         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2082         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2083     12  FILLER                            PIC X(24).
  2084     12  PLAN-MISC.
  2085         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2086         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2087         16  PL-IG                         PIC X.
  2088         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2089         16  PL-POLICY-FORM                PIC X(12).
  2090         16  PL-EDIT-FOR-FORM              PIC X(01).
  2091         16  PL-DEV-CODE                   PIC XXX.
  2092         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2093         16  PL-CALC-METHOD                PIC X.
  2094         16  PL-BENEFIT-GROUP              PIC X(05).
  2095         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2096
  2097         16  FILLER                        PIC X(99).
  2098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  40
* EL050.cbl
  2100*    COPY ELCCERT.
  2101******************************************************************
  2102*                                                                *
  2103*                            ELCCERT.                            *
  2104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2105*                            VMOD=2.013                          *
  2106*                                                                *
  2107*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2108*                                                                *
  2109*   FILE TYPE = VSAM,KSDS                                        *
  2110*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2111*                                                                *
  2112*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2113*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2114*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2115*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2116*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2117*                                                                *
  2118*   LOG = YES                                                    *
  2119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2120******************************************************************
  2121*                   C H A N G E   L O G
  2122*
  2123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2124*-----------------------------------------------------------------
  2125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2126* EFFECTIVE    NUMBER
  2127*-----------------------------------------------------------------
  2128* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2129* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2130* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2131* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2132* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2133* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2134* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2135* 032612  CR2011110200001  PEMA  AHL CHANGES
  2136* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2137******************************************************************
  2138
  2139 01  CERTIFICATE-MASTER.
  2140     12  CM-RECORD-ID                      PIC XX.
  2141         88  VALID-CM-ID                      VALUE 'CM'.
  2142
  2143     12  CM-CONTROL-PRIMARY.
  2144         16  CM-COMPANY-CD                 PIC X.
  2145         16  CM-CARRIER                    PIC X.
  2146         16  CM-GROUPING.
  2147             20  CM-GROUPING-PREFIX        PIC X(3).
  2148             20  CM-GROUPING-PRIME         PIC X(3).
  2149         16  CM-STATE                      PIC XX.
  2150         16  CM-ACCOUNT.
  2151             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2152             20  CM-ACCOUNT-PRIME          PIC X(6).
  2153         16  CM-CERT-EFF-DT                PIC XX.
  2154         16  CM-CERT-NO.
  2155             20  CM-CERT-PRIME             PIC X(10).
  2156             20  CM-CERT-SFX               PIC X.
  2157
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  41
* EL050.cbl
  2158     12  CM-CONTROL-BY-NAME.
  2159         16  CM-COMPANY-CD-A1              PIC X.
  2160         16  CM-INSURED-LAST-NAME          PIC X(15).
  2161         16  CM-INSURED-INITIALS.
  2162             20  CM-INSURED-INITIAL1       PIC X.
  2163             20  CM-INSURED-INITIAL2       PIC X.
  2164
  2165     12  CM-CONTROL-BY-SSN.
  2166         16  CM-COMPANY-CD-A2              PIC X.
  2167         16  CM-SOC-SEC-NO.
  2168             20  CM-SSN-STATE              PIC XX.
  2169             20  CM-SSN-ACCOUNT            PIC X(6).
  2170             20  CM-SSN-LN3.
  2171                 25  CM-INSURED-INITIALS-A2.
  2172                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2173                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2174                 25 CM-PART-LAST-NAME-A2         PIC X.
  2175
  2176     12  CM-CONTROL-BY-CERT-NO.
  2177         16  CM-COMPANY-CD-A4              PIC X.
  2178         16  CM-CERT-NO-A4                 PIC X(11).
  2179
  2180     12  CM-CONTROL-BY-MEMB.
  2181         16  CM-COMPANY-CD-A5              PIC X.
  2182         16  CM-MEMBER-NO.
  2183             20  CM-MEMB-STATE             PIC XX.
  2184             20  CM-MEMB-ACCOUNT           PIC X(6).
  2185             20  CM-MEMB-LN4.
  2186                 25  CM-INSURED-INITIALS-A5.
  2187                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2188                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2189                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2190
  2191     12  CM-INSURED-PROFILE-DATA.
  2192         16  CM-INSURED-FIRST-NAME.
  2193             20  CM-INSURED-1ST-INIT       PIC X.
  2194             20  FILLER                    PIC X(9).
  2195         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2196         16  CM-INSURED-SEX                PIC X.
  2197             88  CM-SEX-MALE                  VALUE 'M'.
  2198             88  CM-SEX-FEMAL                 VALUE 'F'.
  2199         16  CM-INSURED-JOINT-AGE          PIC 99.
  2200         16  CM-JOINT-INSURED-NAME.
  2201             20  CM-JT-LAST-NAME           PIC X(15).
  2202             20  CM-JT-FIRST-NAME.
  2203                 24  CM-JT-1ST-INIT        PIC X.
  2204                 24  FILLER                PIC X(9).
  2205             20  CM-JT-INITIAL             PIC X.
  2206
  2207     12  CM-LIFE-DATA.
  2208         16  CM-LF-BENEFIT-CD              PIC XX.
  2209         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2212         16  CM-LF-DEV-CODE                PIC XXX.
  2213         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2214         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  42
* EL050.cbl
  2216         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2217         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2218         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2219         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2220         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2223         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2224         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2225         16  cm-temp-epiq                  pic xx.
  2226             88  EPIQ-CLASS                  value 'EQ'.
  2227*        16  FILLER                        PIC XX.
  2228
  2229     12  CM-AH-DATA.
  2230         16  CM-AH-BENEFIT-CD              PIC XX.
  2231         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2232         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2233         16  CM-AH-DEV-CODE                PIC XXX.
  2234         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2235         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2237         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2238         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2240         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2241         16  CM-AH-PAID-THRU-DT            PIC XX.
  2242             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2243         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2244         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2245         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2246         16  FILLER                        PIC X.
  2247
  2248     12  CM-LOAN-INFORMATION.
  2249         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2250         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2251                                           PIC S9(5)V99  COMP-3.
  2252         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2253         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2254         16  CM-PAY-FREQUENCY              PIC S99.
  2255         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2256         16  CM-RATE-CLASS                 PIC XX.
  2257         16  CM-BENEFICIARY                PIC X(25).
  2258         16  CM-POLICY-FORM-NO             PIC X(12).
  2259         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2260         16  CM-LAST-ADD-ON-DT             PIC XX.
  2261         16  CM-DEDUCTIBLE-AMOUNTS.
  2262             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2263             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2264         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2265             20  CM-RESIDENT-STATE         PIC XX.
  2266             20  CM-RATE-CODE              PIC X(4).
  2267             20  FILLER                    PIC XX.
  2268         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2269             20  CM-LOAN-OFFICER           PIC X(5).
  2270             20  FILLER                    PIC XXX.
  2271         16  CM-CSR-CODE                   PIC XXX.
  2272         16  CM-UNDERWRITING-CODE          PIC X.
  2273             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  43
* EL050.cbl
  2274         16  CM-POST-CARD-IND              PIC X.
  2275         16  CM-NH-INTERFACE-SW            PIC X.
  2276         16  CM-PREMIUM-TYPE               PIC X.
  2277             88  CM-SING-PRM                  VALUE '1'.
  2278             88  CM-O-B-COVERAGE              VALUE '2'.
  2279             88  CM-OPEN-END                  VALUE '3'.
  2280         16  CM-IND-GRP-TYPE               PIC X.
  2281             88  CM-INDIVIDUAL                VALUE 'I'.
  2282             88  CM-GROUP                     VALUE 'G'.
  2283         16  CM-SKIP-CODE                  PIC X.
  2284             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2285             88  SKIP-JULY                    VALUE '1'.
  2286             88  SKIP-AUGUST                  VALUE '2'.
  2287             88  SKIP-SEPTEMBER               VALUE '3'.
  2288             88  SKIP-JULY-AUG                VALUE '4'.
  2289             88  SKIP-AUG-SEPT                VALUE '5'.
  2290             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2291             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2292             88  SKIP-JUNE                    VALUE '8'.
  2293             88  SKIP-JUNE-JULY               VALUE '9'.
  2294             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2295             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2296         16  CM-PAYMENT-MODE               PIC X.
  2297             88  PAY-MONTHLY                  VALUE SPACE.
  2298             88  PAY-WEEKLY                   VALUE '1'.
  2299             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2300             88  PAY-BI-WEEKLY                VALUE '3'.
  2301             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2302         16  CM-LOAN-NUMBER                PIC X(8).
  2303         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2304         16  CM-OLD-LOF                    PIC XXX.
  2305*        16  CM-LOAN-OFFICER               PIC XXX.
  2306         16  CM-REIN-TABLE                 PIC XXX.
  2307         16  CM-SPECIAL-REIN-CODE          PIC X.
  2308         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2309         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2310         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2311
  2312     12  CM-STATUS-DATA.
  2313         16  CM-ENTRY-STATUS               PIC X.
  2314         16  CM-ENTRY-DT                   PIC XX.
  2315
  2316         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2317         16  CM-LF-CANCEL-DT               PIC XX.
  2318         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2319
  2320         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2321         16  CM-LF-DEATH-DT                PIC XX.
  2322         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2323
  2324         16  CM-LF-CURRENT-STATUS          PIC X.
  2325             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2326                                                'M' '4' '5' '9'.
  2327             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2328             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2329             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2330             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2331             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  44
* EL050.cbl
  2332             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2333             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2334             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2335             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2336             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2337             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2338             88  CM-LF-DECLINED               VALUE 'D'.
  2339             88  CM-LF-VOIDED                 VALUE 'V'.
  2340
  2341         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2342         16  CM-AH-CANCEL-DT               PIC XX.
  2343         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2344
  2345         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2346         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2347         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2348
  2349         16  CM-AH-CURRENT-STATUS          PIC X.
  2350             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2351                                                'M' '4' '5' '9'.
  2352             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2353             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2354             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2355             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2356             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2357             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2358             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2359             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2360             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2361             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2362             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2363             88  CM-AH-DECLINED               VALUE 'D'.
  2364             88  CM-AH-VOIDED                 VALUE 'V'.
  2365
  2366         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2367             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2368             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2369             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2370         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2371
  2372         16  CM-ENTRY-BATCH                PIC X(6).
  2373         16  CM-LF-EXIT-BATCH              PIC X(6).
  2374         16  CM-AH-EXIT-BATCH              PIC X(6).
  2375         16  CM-LAST-MONTH-END             PIC XX.
  2376
  2377     12  CM-NOTE-SW                        PIC X.
  2378         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2379         88  CERT-NOTES-PRESENT               VALUE '1'.
  2380         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2381         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2382         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2383         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2384         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2385         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2386     12  CM-COMP-EXCP-SW                   PIC X.
  2387         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2388         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2389     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  45
* EL050.cbl
  2390         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2391         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2392
  2393*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2394     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2395     12  FILLER                            PIC X.
  2396
  2397*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2398     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2399     12  FILLER                            PIC X.
  2400*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2401     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2402
  2403     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2404         88  CERT-ADDED-BATCH                 VALUE ' '.
  2405         88  CERT-ADDED-ONLINE                VALUE '1'.
  2406         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2407         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2408         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2409     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2410         88  CERT-AS-LOADED                   VALUE ' '.
  2411         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2412         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2413         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2414         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2415         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2416         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2417         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2418
  2419     12  CM-ACCOUNT-COMM-PCTS.
  2420         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2421         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2422
  2423     12  CM-USER-FIELD                     PIC X.
  2424     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2425     12  CM-CLP-STATE                      PIC XX.
  2426     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2427     12  CM-USER-RESERVED                  PIC XXX.
  2428     12  FILLER REDEFINES CM-USER-RESERVED.
  2429         16  CM-AH-CLASS-CD                PIC XX.
  2430         16  F                             PIC X.
  2431******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  46
* EL050.cbl
  2433*    COPY ERCMAIL.
  2434******************************************************************
  2435*                                                                *
  2436*                                                                *
  2437*                            ERCMAIL                             *
  2438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2439*                            VMOD=2.003                          *
  2440*                                                                *
  2441*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2442*                                                                *
  2443*   FILE TYPE = VSAM,KSDS                                        *
  2444*   RECORD SIZE = 374   RECFORM = FIX                            *
  2445*                                                                *
  2446*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2447*   ALTERNATE PATH    = NOT USED                                 *
  2448*                                                                *
  2449*   LOG = YES                                                    *
  2450*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2451******************************************************************
  2452*                   C H A N G E   L O G
  2453*
  2454* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2455*-----------------------------------------------------------------
  2456*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2457* EFFECTIVE    NUMBER
  2458*-----------------------------------------------------------------
  2459* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2460* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2461* 111108                   PEMA  ADD CRED BENE ADDR2
  2462******************************************************************
  2463
  2464 01  MAILING-DATA.
  2465     12  MA-RECORD-ID                      PIC XX.
  2466         88  VALID-MA-ID                       VALUE 'MA'.
  2467
  2468     12  MA-CONTROL-PRIMARY.
  2469         16  MA-COMPANY-CD                 PIC X.
  2470         16  MA-CARRIER                    PIC X.
  2471         16  MA-GROUPING.
  2472             20  MA-GROUPING-PREFIX        PIC XXX.
  2473             20  MA-GROUPING-PRIME         PIC XXX.
  2474         16  MA-STATE                      PIC XX.
  2475         16  MA-ACCOUNT.
  2476             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2477             20  MA-ACCOUNT-PRIME          PIC X(6).
  2478         16  MA-CERT-EFF-DT                PIC XX.
  2479         16  MA-CERT-NO.
  2480             20  MA-CERT-PRIME             PIC X(10).
  2481             20  MA-CERT-SFX               PIC X.
  2482
  2483     12  FILLER                            PIC XX.
  2484
  2485     12  MA-ACCESS-CONTROL.
  2486         16  MA-SOURCE-SYSTEM              PIC XX.
  2487             88  MA-FROM-CREDIT                VALUE 'CR'.
  2488             88  MA-FROM-VSI                   VALUE 'VS'.
  2489             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2490             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  47
* EL050.cbl
  2491         16  MA-RECORD-ADD-DT              PIC XX.
  2492         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2493         16  MA-LAST-MAINT-DT              PIC XX.
  2494         16  MA-LAST-MAINT-BY              PIC XXXX.
  2495         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2496
  2497     12  MA-PROFILE-INFO.
  2498         16  MA-QUALIFY-CODE-1             PIC XX.
  2499         16  MA-QUALIFY-CODE-2             PIC XX.
  2500         16  MA-QUALIFY-CODE-3             PIC XX.
  2501         16  MA-QUALIFY-CODE-4             PIC XX.
  2502         16  MA-QUALIFY-CODE-5             PIC XX.
  2503
  2504         16  MA-INSURED-LAST-NAME          PIC X(15).
  2505         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2506         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2507         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2508         16  MA-INSURED-BIRTH-DT           PIC XX.
  2509         16  MA-INSURED-SEX                PIC X.
  2510             88  MA-SEX-MALE                   VALUE 'M'.
  2511             88  MA-SEX-FEMALE                 VALUE 'F'.
  2512         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2513
  2514         16  MA-ADDRESS-CORRECTED          PIC X.
  2515         16  MA-JOINT-BIRTH-DT             PIC XX.
  2516*        16  FILLER                        PIC X(12).
  2517
  2518         16  MA-ADDRESS-LINE-1             PIC X(30).
  2519         16  MA-ADDRESS-LINE-2             PIC X(30).
  2520         16  MA-CITY-STATE.
  2521             20  MA-CITY                   PIC X(28).
  2522             20  MA-ADDR-STATE             PIC XX.
  2523         16  MA-ZIP.
  2524             20  MA-ZIP-CODE.
  2525                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2526                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2527                 24  FILLER                PIC X(4).
  2528             20  MA-ZIP-PLUS4              PIC X(4).
  2529         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2530             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2531             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2532             20  FILLER                    PIC X(3).
  2533
  2534         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2535
  2536         16  FILLER                        PIC XXX.
  2537*        16  FILLER                        PIC X(10).
  2538
  2539     12  MA-CRED-BENE-INFO.
  2540         16  MA-CRED-BENE-NAME                 PIC X(25).
  2541         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2542         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2543         16  MA-CRED-BENE-CTYST.
  2544             20  MA-CRED-BENE-CITY             PIC X(28).
  2545             20  MA-CRED-BENE-STATE            PIC XX.
  2546         16  MA-CRED-BENE-ZIP.
  2547             20  MA-CB-ZIP-CODE.
  2548                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  48
* EL050.cbl
  2549                     88  MA-CB-CANADIAN-POST-CODE
  2550                                           VALUE 'A' THRU 'Z'.
  2551                 24  FILLER                    PIC X(4).
  2552             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2553         16  MA-CB-CANADIAN-POSTAL-CODE
  2554                            REDEFINES MA-CRED-BENE-ZIP.
  2555             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2556             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2557             20  FILLER                        PIC X(3).
  2558     12  MA-POST-CARD-MAIL-DATA.
  2559         16  MA-MAIL-DATA OCCURS 7.
  2560             20  MA-MAIL-TYPE              PIC X.
  2561                 88  MA-12MO-MAILING           VALUE '1'.
  2562                 88  MA-EXP-MAILING            VALUE '2'.
  2563             20  MA-MAIL-STATUS            PIC X.
  2564                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2565                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2566                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2567             20  MA-MAIL-DATE              PIC XX.
  2568     12  FILLER                            PIC XX.
  2569     12  FILLER                            PIC XX.
  2570*    12  FILLER                            PIC X(30).
  2571******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  49
* EL050.cbl
  2573*    COPY ERCPNDM.
  2574******************************************************************
  2575*                                                                *
  2576*                                                                *
  2577*                            ERCPNDM                             *
  2578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2579*                            VMOD=2.003                          *
  2580*                                                                *
  2581*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2582*                                                                *
  2583*   FILE TYPE = VSAM,KSDS                                        *
  2584*   RECORD SIZE = 374   RECFORM = FIX                            *
  2585*                                                                *
  2586*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2587*   ALTERNATE PATH    = NOT USED                                 *
  2588*                                                                *
  2589*   LOG = YES                                                    *
  2590*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2591******************************************************************
  2592*                   C H A N G E   L O G
  2593*
  2594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2595*-----------------------------------------------------------------
  2596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2597* EFFECTIVE    NUMBER
  2598*-----------------------------------------------------------------
  2599* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2600* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2601* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2602******************************************************************
  2603
  2604 01  PENDING-MAILING-DATA.
  2605     12  PM-RECORD-ID                      PIC XX.
  2606         88  VALID-MA-ID                       VALUE 'PM'.
  2607
  2608     12  PM-CONTROL-PRIMARY.
  2609         16  PM-COMPANY-CD                 PIC X.
  2610         16  PM-ENTRY-BATCH                PIC X(6).
  2611         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2612         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2613
  2614     12  FILLER                            PIC X(14).
  2615
  2616     12  PM-ACCESS-CONTROL.
  2617         16  PM-SOURCE-SYSTEM              PIC XX.
  2618             88  PM-FROM-CREDIT                VALUE 'CR'.
  2619             88  PM-FROM-VSI                   VALUE 'VS'.
  2620             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2621             88  PM-FROM-OTHER                 VALUE 'OT'.
  2622         16  PM-RECORD-ADD-DT              PIC XX.
  2623         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2624         16  PM-LAST-MAINT-DT              PIC XX.
  2625         16  PM-LAST-MAINT-BY              PIC XXXX.
  2626         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2627
  2628     12  PM-PROFILE-INFO.
  2629         16  PM-QUALIFY-CODE-1             PIC XX.
  2630         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  50
* EL050.cbl
  2631         16  PM-QUALIFY-CODE-3             PIC XX.
  2632         16  PM-QUALIFY-CODE-4             PIC XX.
  2633         16  PM-QUALIFY-CODE-5             PIC XX.
  2634
  2635         16  PM-INSURED-LAST-NAME          PIC X(15).
  2636         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2637         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2638         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2639         16  PM-INSURED-BIRTH-DT           PIC XX.
  2640         16  PM-INSURED-SEX                PIC X.
  2641             88  PM-SEX-MALE                   VALUE 'M'.
  2642             88  PM-SEX-FEMALE                 VALUE 'F'.
  2643         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2644
  2645         16  PM-ADDRESS-CORRECTED          PIC X.
  2646         16  PM-JOINT-BIRTH-DT             PIC XX.
  2647*        16  FILLER                        PIC X(12).
  2648
  2649         16  PM-ADDRESS-LINE-1             PIC X(30).
  2650         16  PM-ADDRESS-LINE-2             PIC X(30).
  2651         16  PM-CITY-STATE.
  2652             20  PM-CITY                   PIC X(28).
  2653             20  PM-STATE                  PIC XX.
  2654         16  PM-ZIP.
  2655             20  PM-ZIP-CODE.
  2656                 24  PM-ZIP-1              PIC X.
  2657                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2658                 24  FILLER                PIC X(4).
  2659             20  PM-ZIP-PLUS4              PIC X(4).
  2660         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2661             20  PM-CAN-POST1              PIC XXX.
  2662             20  PM-CAN-POST2              PIC XXX.
  2663             20  FILLER                    PIC XXX.
  2664
  2665         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2666
  2667         16  FILLER                        PIC X(03).
  2668
  2669     12  PM-CRED-BENE-INFO.
  2670         16  PM-CRED-BENE-NAME             PIC X(25).
  2671         16  PM-CRED-BENE-ADDR             PIC X(30).
  2672         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2673         16  PM-CRED-BENE-CTYST.
  2674             20  PM-CRED-BENE-CITY         PIC X(28).
  2675             20  PM-CRED-BENE-STATE        PIC XX.
  2676         16  PM-CRED-BENE-ZIP.
  2677             20  PM-CB-ZIP-CODE.
  2678                 24  PM-CB-ZIP-1           PIC X.
  2679                     88  PM-CB-CANADIAN-POST-CODE
  2680                                  VALUE 'A' THRU 'Z'.
  2681                 24  FILLER                PIC X(4).
  2682             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2683         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2684             20  PM-CB-CAN-POST1           PIC XXX.
  2685             20  PM-CB-CAN-POST2           PIC XXX.
  2686             20  FILLER                    PIC XXX.
  2687     12  PM-POST-CARD-MAIL-DATA.
  2688         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  51
* EL050.cbl
  2689             20  PM-MAIL-TYPE              PIC X.
  2690                 88  PM-12MO-MAILING           VALUE '1'.
  2691                 88  PM-EXP-MAILING            VALUE '2'.
  2692             20  PM-MAIL-STATUS            PIC X.
  2693                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2694                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2695                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2696             20  PM-MAIL-DATE              PIC XX.
  2697     12  FILLER                            PIC XX.
  2698     12  FILLER                            PIC X(12).
  2699*    12  FILLER                            PIC X(30).
  2700
  2701******************************************************************
  2702*                                COPY ERCLOFC.
  2703******************************************************************
  2704*                                                                *
  2705*                                                                *
  2706*                            ERCLOFC                             *
  2707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2708*                            VMOD=2.003                          *
  2709*                                                                *
  2710*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2711*                                                                *
  2712*   FILE TYPE = VSAM,KSDS                                        *
  2713*   RECORD SIZE = 670   RECFORM = FIX                            *
  2714*                                                                *
  2715*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2716*                                                                *
  2717*   LOG = YES                                                    *
  2718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2719*                                                                *
  2720******************************************************************
  2721
  2722 01  LOAN-OFFICER-MASTER.
  2723     12  LO-RECORD-ID                PIC XX.
  2724         88  VALID-LO-ID                VALUE 'LO'.
  2725
  2726     12  LO-CONTROL-PRIMARY.
  2727         16  LO-COMPANY-CD           PIC X.
  2728         16  LO-CARRIER              PIC X.
  2729         16  LO-GROUPING.
  2730             20  LO-GROUPING-PREFIX  PIC XXX.
  2731             20  LO-GROUPING-PRIME   PIC XXX.
  2732         16  LO-STATE                PIC XX.
  2733         16  LO-ACCOUNT.
  2734             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2735             20  LO-ACCOUNT-PRIME    PIC X(6).
  2736         16  LO-OFFICER-CODE         PIC X(5).
  2737
  2738     12  LO-OFFICER-NAME             PIC X(30).
  2739
  2740     12  LO-LAST-MAINT-DT            PIC XX.
  2741     12  LO-LAST-USER                PIC X(4).
  2742     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2743
  2744     12  LO-COMP-CONTROL             PIC X.
  2745             88  LO-SHOW-COMP           VALUE 'Y'.
  2746             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  52
* EL050.cbl
  2747     12  LO-DETAIL-CONTROL           PIC X.
  2748             88  LO-PRINT-DETAIL        VALUE 'D'.
  2749             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2750
  2751     12  LO-SV-CARRIER               PIC X.
  2752     12  LO-SV-GROUPING              PIC X(6).
  2753     12  LO-SV-STATE                 PIC XX.
  2754
  2755     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2756     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2757
  2758     12  LO-OFFICER-INFO.
  2759         16  FILLER OCCURS 12 TIMES.
  2760             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2761             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2762             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2763             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2764             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2765             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2766             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2767             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2768     12  FILLER                      PIC X(198).
  2769******************************************************************
  2770*                                COPY ERCPDEF.
  2771******************************************************************
  2772*                                                                *
  2773*                                                                *
  2774*                            ERCPDEF.                            *
  2775*                                                                *
  2776*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2777*                                                                *
  2778*    FILE TYPE = VSAM,KSDS                                       *
  2779*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2780*                                                                *
  2781*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2782*                                                                *
  2783*    LOG = YES                                                   *
  2784*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2785******************************************************************
  2786*                   C H A N G E   L O G
  2787*
  2788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2789*-----------------------------------------------------------------
  2790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2791* EFFECTIVE    NUMBER
  2792*-----------------------------------------------------------------
  2793* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2794* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2795* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2796******************************************************************
  2797 01  PRODUCT-MASTER.
  2798    12  PD-RECORD-ID                 PIC X(02).
  2799        88  VALID-PD-ID                  VALUE 'PD'.
  2800    12  PD-CONTROL-PRIMARY.
  2801        16  PD-COMPANY-CD            PIC X.
  2802        16  PD-STATE                 PIC XX.
  2803        16  PD-PRODUCT-CD            PIC XXX.
  2804        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  53
* EL050.cbl
  2805        16  PD-BEN-TYPE              PIC X.
  2806        16  PD-BEN-CODE              PIC XX.
  2807        16  PD-PROD-EXP-DT           PIC XX.
  2808    12  FILLER                       PIC X(50).
  2809    12  PD-PRODUCT-DATA OCCURS 8.
  2810        16  PD-PROD-CODE             PIC X.
  2811            88  PD-PROD-LIFE           VALUE 'L'.
  2812            88  PD-PROD-PROP           VALUE 'P'.
  2813            88  PD-PROD-AH             VALUE 'A'.
  2814            88  PD-PROD-IU             VALUE 'I'.
  2815            88  PD-PROD-GAP            VALUE 'G'.
  2816            88  PD-PROD-FAML           VALUE 'F'.
  2817        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2818        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2819        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2820        16  PD-MAX-TERM              PIC S999        COMP-3.
  2821        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2822        16  FILLER                   PIC X.
  2823        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2824        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2825        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2826        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2827        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2828        16  PD-REC-CRIT-PERIOD       PIC 99.
  2829        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2830            20  PD-RECURRING-YN      PIC X.
  2831            20  FILLER               PIC X.
  2832        16  PD-RTW-MOS               PIC 99.
  2833        16  PD-MAX-EXTENSION         PIC 99.
  2834        16  pd-ben-pct               pic sv999 comp-3.
  2835*       16  FILLER                   PIC XX.
  2836    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2837    12  PD-TERM-LIMITS OCCURS 15.
  2838        16  PD-LOW-TERM              PIC S999        COMP-3.
  2839        16  PD-HI-TERM               PIC S999        COMP-3.
  2840*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2841    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2842        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2843        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2844    12  PD-EARN-FACTORS.
  2845        16  FILLER OCCURS 15.
  2846            20  FILLER OCCURS 15.
  2847                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2848    12  PD-PRODUCT-DESC              PIC X(80).
  2849    12  PD-TRUNCATED                 PIC X.
  2850    12  FILLER                       PIC X(59).
  2851    12  PD-MAINT-INFORMATION.
  2852        16  PD-LAST-MAINT-DT         PIC X(02).
  2853        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2854        16  PD-LAST-MAINT-BY         PIC X(04).
  2855*                                COPY ELCSTATE.
  2856******************************************************************
  2857*                                                                *
  2858*                                                                *
  2859*                            ELCSTATE.                           *
  2860*                                                                *
  2861*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2862*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  54
* EL050.cbl
  2863*   FILE TYPE = VSAM,KSDS                                        *
  2864*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2865*                                                                *
  2866*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2867*       ALTERNATE INDEX = NONE                                   *
  2868*                                                                *
  2869*   LOG = YES                                                    *
  2870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2871******************************************************************
  2872*                   C H A N G E   L O G
  2873*
  2874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2875*-----------------------------------------------------------------
  2876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2877* EFFECTIVE    NUMBER
  2878*-----------------------------------------------------------------
  2879* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2880******************************************************************
  2881*
  2882 01  STATE-FILE.
  2883     12  SF-RECORD-ID                       PIC XX.
  2884         88  VALID-CF-ID                        VALUE 'SF'.
  2885     12  SF-CONTROL-PRIMARY.
  2886         16  SF-COMPANY-ID                  PIC XXX.
  2887         16  SF-CARRIER-CODE                PIC X.
  2888         16  SF-GROUPING                    PIC X(6).
  2889         16  SF-STATE-CODE                  PIC XX.
  2890         16  SF-EXPIRE-DATE                 PIC 9(8).
  2891****************************************************************
  2892*             STATE CONTROLS
  2893****************************************************************
  2894     12  SF-LAST-MAINT-DT                   PIC XX.
  2895     12  SF-LAST-MAINT-BY                   PIC X(4).
  2896     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2897     12  SF-STATE-RT-CONTROLS.
  2898         16  SF-ST-RT-CALC                  PIC X.
  2899     12  SF-ST-TAX-CONTROLS.
  2900         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2901         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2902         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2903     12  SF-ST-REFUND-OPTIONS.
  2904         16  SF-ST-RF-LR-CALC               PIC X.
  2905         16  SF-ST-RF-LL-CALC               PIC X.
  2906         16  SF-ST-RF-LN-CALC               PIC X.
  2907         16  SF-ST-RF-AH-CALC               PIC X.
  2908         16  SF-ST-RF-CP-CALC               PIC X.
  2909     12  SF-ST-UNEARN-PREM-OPTIONS.
  2910         16  SF-ST-LUEP-R78                 PIC X.
  2911         16  SF-ST-LUEP-PRO                 PIC X.
  2912         16  SF-ST-LUEP-ST                  PIC X.
  2913         16  SF-ST-LUEP-DOM                 PIC X.
  2914         16  SF-ST-AUEP-R78                 PIC X.
  2915         16  SF-ST-AUEP-PRO                 PIC X.
  2916         16  SF-ST-AUEP-ST                  PIC X.
  2917         16  SF-ST-AUEP-DOM                 PIC X.
  2918         16  SF-ST-CUEP-R78                 PIC X.
  2919         16  SF-ST-CUEP-PRO                 PIC X.
  2920         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  55
* EL050.cbl
  2921         16  SF-ST-CUEP-DOM                 PIC X.
  2922     12  SF-ST-EARN-PREM-OPTIONS.
  2923         16  SF-ST-LEP-R78                  PIC X.
  2924         16  SF-ST-LEP-PRO                  PIC X.
  2925         16  SF-ST-LEP-ST                   PIC X.
  2926         16  SF-ST-LEP-DOM                  PIC X.
  2927         16  SF-ST-AEP-R78                  PIC X.
  2928         16  SF-ST-AEP-PRO                  PIC X.
  2929         16  SF-ST-AEP-ST                   PIC X.
  2930         16  SF-ST-AEP-DOM                  PIC X.
  2931         16  SF-ST-CEP-R78                  PIC X.
  2932         16  SF-ST-CEP-PRO                  PIC X.
  2933         16  SF-ST-CEP-ST                   PIC X.
  2934         16  SF-ST-CEP-DOM                  PIC X.
  2935     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  56
* EL050.cbl
  2937*    COPY ELCCRTT.
  2938******************************************************************
  2939*                                                                *
  2940*                            ELCCRTT.                            *
  2941*                                                                *
  2942*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2943*                                                                *
  2944*   FILE TYPE = VSAM,KSDS                                        *
  2945*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2946*                                                                *
  2947*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2948*                                                                *
  2949*   LOG = YES                                                    *
  2950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2951******************************************************************
  2952*                   C H A N G E   L O G
  2953*
  2954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2955*-----------------------------------------------------------------
  2956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2957* EFFECTIVE    NUMBER
  2958*-----------------------------------------------------------------
  2959* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2960* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2961* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2962* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2963* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2964* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2965* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2966* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2967******************************************************************
  2968
  2969 01  CERTIFICATE-TRAILERS.
  2970     12  CS-RECORD-ID                      PIC XX.
  2971         88  VALID-CS-ID                      VALUE 'CS'.
  2972
  2973     12  CS-CONTROL-PRIMARY.
  2974         16  CS-COMPANY-CD                 PIC X.
  2975         16  CS-CARRIER                    PIC X.
  2976         16  CS-GROUPING                   PIC X(6).
  2977         16  CS-STATE                      PIC XX.
  2978         16  CS-ACCOUNT                    PIC X(10).
  2979         16  CS-CERT-EFF-DT                PIC XX.
  2980         16  CS-CERT-NO.
  2981             20  CS-CERT-PRIME             PIC X(10).
  2982             20  CS-CERT-SFX               PIC X.
  2983         16  CS-TRAILER-TYPE               PIC X.
  2984             88  COMM-TRLR           VALUE 'A'.
  2985             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2986             88  CERT-DATA-TRLR      VALUE 'C'.
  2987
  2988     12  CS-DATA-AREA                      PIC X(516).
  2989
  2990     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2991         16  CS-BANK-COMMISSION-AREA.
  2992             20  CS-BANK-COMMS       OCCURS 10.
  2993                 24  CS-AGT                PIC X(10).
  2994                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  57
* EL050.cbl
  2995                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2996                 24  CS-RECALC-LV-INDIC    PIC X.
  2997                 24  FILLER                PIC X(10).
  2998         16  FILLER                        PIC X(256).
  2999
  3000     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3001****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3002         16  CS-MB-CLAIM-DATA OCCURS 24.
  3003             20  CS-CLAIM-NO               PIC X(7).
  3004             20  CS-CLAIM-TYPE             PIC X.
  3005                 88  CS-AH-CLM               VALUE 'A'.
  3006                 88  CS-IU-CLM               VALUE 'I'.
  3007                 88  CS-GP-CLM               VALUE 'G'.
  3008                 88  CS-LF-CLM               VALUE 'L'.
  3009                 88  CS-PR-CLM               VALUE 'P'.
  3010                 88  CS-FL-CLM               VALUE 'F'.
  3011             20  CS-INSURED-TYPE           PIC X.
  3012                 88  CS-PRIM-INSURED          VALUE 'P'.
  3013                 88  CS-CO-BORROWER           VALUE 'C'.
  3014             20  CS-BENEFIT-PERIOD         PIC 99.
  3015             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3016             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3017             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3018         16  FILLER                        PIC X(12).
  3019     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3020         16  CS-VIN-NUMBER                 PIC X(17).
  3021         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3022         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3023         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3024         16  cs-agent-name.
  3025             20  cs-agent-fname            pic x(20).
  3026             20  cs-agent-mi               pic x.
  3027             20  cs-agent-lname            pic x(25).
  3028         16  cs-license-no                 pic x(15).
  3029         16  cs-npn-number                 pic x(10).
  3030         16  cs-agent-edit-status          pic x.
  3031             88  cs-ae-refer-to-manager      value 'M'.
  3032             88  cs-ae-cover-sheet           value 'C'.
  3033             88  cs-ae-sig-form              value 'S'.
  3034             88  cs-ae-verified              value 'V'.
  3035             88  cs-unidentified-signature   value 'U'.
  3036             88  cs-cert-returned            value 'R'.
  3037             88  cs-accept-no-commission     value 'N'.
  3038         16  FILLER                        PIC X(424).
  3039*        16  FILLER                        PIC X(496).
  3040*    COPY ELCCRTO.
  3041******************************************************************
  3042*                                                                *
  3043*                            ELCCRTO.                            *
  3044*                                                                *
  3045*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3046*                                                                *
  3047*   FILE TYPE = VSAM,KSDS                                        *
  3048*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3049*                                                                *
  3050*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3051*                                                                *
  3052*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  58
* EL050.cbl
  3053*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3054******************************************************************
  3055*                   C H A N G E   L O G
  3056*
  3057* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3058*-----------------------------------------------------------------
  3059*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3060* EFFECTIVE    NUMBER
  3061*-----------------------------------------------------------------
  3062* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3063* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3064* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3065* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3066* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3067******************************************************************
  3068 01  ORIGINAL-CERTIFICATE.
  3069     12  OC-RECORD-ID                      PIC XX.
  3070         88  VALID-OC-ID                      VALUE 'OC'.
  3071     12  OC-CONTROL-PRIMARY.
  3072         16  OC-COMPANY-CD                 PIC X.
  3073         16  OC-CARRIER                    PIC X.
  3074         16  OC-GROUPING                   PIC X(6).
  3075         16  OC-STATE                      PIC XX.
  3076         16  OC-ACCOUNT                    PIC X(10).
  3077         16  OC-CERT-EFF-DT                PIC XX.
  3078         16  OC-CERT-NO.
  3079             20  OC-CERT-PRIME             PIC X(10).
  3080             20  OC-CERT-SFX               PIC X.
  3081         16  OC-RECORD-TYPE                PIC X.
  3082         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3083     12  OC-LAST-MAINT-DT                  PIC XX.
  3084     12  OC-LAST-MAINT-BY                  PIC X(4).
  3085     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3086     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3087     12  FILLER                            PIC X(49).
  3088     12  OC-ORIG-REC.
  3089         16  OC-INS-LAST-NAME              PIC X(15).
  3090         16  OC-INS-FIRST-NAME             PIC X(10).
  3091         16  OC-INS-MIDDLE-INIT            PIC X.
  3092         16  OC-INS-AGE                    PIC S999     COMP-3.
  3093         16  OC-JNT-LAST-NAME              PIC X(15).
  3094         16  OC-JNT-FIRST-NAME             PIC X(10).
  3095         16  OC-JNT-MIDDLE-INIT            PIC X.
  3096         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3097         16  OC-LF-BENCD                   PIC XX.
  3098         16  OC-LF-TERM                    PIC S999      COMP-3.
  3099         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3100         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3101         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3102         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3103         16  OC-LF-EXP-DT                  PIC XX.
  3104         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3105         16  OC-LF-CANCEL-DT               PIC XX.
  3106         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3107         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3108         16  OC-AH-BENCD                   PIC XX.
  3109         16  OC-AH-TERM                    PIC S999      COMP-3.
  3110         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  59
* EL050.cbl
  3111         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-AH-EXP-DT                  PIC XX.
  3113         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3114         16  OC-AH-CP                      PIC 99.
  3115         16  OC-AH-CANCEL-DT               PIC XX.
  3116         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3117         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3118         16  OC-CRED-BENE-NAME             PIC X(25).
  3119         16  OC-1ST-PMT-DT                 PIC XX.
  3120         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3121         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3122         16  OC-ISSUE-TRAN-IND             PIC X.
  3123         16  OC-CANCEL-TRAN-IND            PIC X.
  3124         16  FILLER                        PIC X(211).
  3125
  3126     12  FILLER                            PIC X(50).
  3127******************************************************************
  3128
  3129*    COPY ELCDATE.
  3130******************************************************************
  3131*                                                                *
  3132*                                                                *
  3133*                            ELCDATE.                            *
  3134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3135*                            VMOD=2.003
  3136*                                                                *
  3137*                                                                *
  3138*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3139*                 LENGTH = 200                                   *
  3140******************************************************************
  3141
  3142 01  DATE-CONVERSION-DATA.
  3143     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3144     12  DC-OPTION-CODE                PIC X.
  3145         88  BIN-TO-GREG                VALUE ' '.
  3146         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3147         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3148         88  YMD-GREG-TO-BIN            VALUE '3'.
  3149         88  MDY-GREG-TO-BIN            VALUE '4'.
  3150         88  JULIAN-TO-BIN              VALUE '5'.
  3151         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3152         88  FIND-CENTURY               VALUE '7'.
  3153         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3154         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3155         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3156         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3157         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3158         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3159         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3160         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3161         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3162         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3163         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3164         88  BIN-3-TO-GREG              VALUE 'I'.
  3165         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3166         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3167         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3168         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  60
* EL050.cbl
  3169         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3170         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3171         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3172         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3173         88  THREE-CHARACTER-BIN
  3174                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3175         88  GREGORIAN-TO-BIN
  3176                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3177         88  BIN-TO-GREGORIAN
  3178                  VALUES ' ' '1' 'I' '8' 'G'.
  3179         88  JULIAN-TO-BINARY
  3180                  VALUES '5' 'C' 'E' 'F'.
  3181     12  DC-ERROR-CODE                 PIC X.
  3182         88  NO-CONVERSION-ERROR        VALUE ' '.
  3183         88  DATE-CONVERSION-ERROR
  3184                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3185         88  DATE-IS-ZERO               VALUE '1'.
  3186         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3187         88  DATE-IS-INVALID            VALUE '3'.
  3188         88  DATE1-GREATER-DATE2        VALUE '4'.
  3189         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3190         88  DATE-INVALID-OPTION        VALUE '9'.
  3191         88  INVALID-CENTURY            VALUE 'A'.
  3192         88  ONLY-CENTURY               VALUE 'B'.
  3193         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3194         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3195     12  DC-END-OF-MONTH               PIC X.
  3196         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3197     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3198         88  USE-NORMAL-PROCESS         VALUE ' '.
  3199         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3200         88  ADJUST-UP-100-YRS          VALUE '2'.
  3201     12  FILLER                        PIC X.
  3202     12  DC-CONVERSION-DATES.
  3203         16  DC-BIN-DATE-1             PIC XX.
  3204         16  DC-BIN-DATE-2             PIC XX.
  3205         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3206         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3207                       DC-GREG-DATE-1-EDIT.
  3208             20  DC-EDIT1-MONTH        PIC 99.
  3209             20  SLASH1-1              PIC X.
  3210             20  DC-EDIT1-DAY          PIC 99.
  3211             20  SLASH1-2              PIC X.
  3212             20  DC-EDIT1-YEAR         PIC 99.
  3213         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3214         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3215                     DC-GREG-DATE-2-EDIT.
  3216             20  DC-EDIT2-MONTH        PIC 99.
  3217             20  SLASH2-1              PIC X.
  3218             20  DC-EDIT2-DAY          PIC 99.
  3219             20  SLASH2-2              PIC X.
  3220             20  DC-EDIT2-YEAR         PIC 99.
  3221         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3222         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3223                     DC-GREG-DATE-1-YMD.
  3224             20  DC-YMD-YEAR           PIC 99.
  3225             20  DC-YMD-MONTH          PIC 99.
  3226             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  61
* EL050.cbl
  3227         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3228         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3229                      DC-GREG-DATE-1-MDY.
  3230             20  DC-MDY-MONTH          PIC 99.
  3231             20  DC-MDY-DAY            PIC 99.
  3232             20  DC-MDY-YEAR           PIC 99.
  3233         16  DC-GREG-DATE-1-ALPHA.
  3234             20  DC-ALPHA-MONTH        PIC X(10).
  3235             20  DC-ALPHA-DAY          PIC 99.
  3236             20  FILLER                PIC XX.
  3237             20  DC-ALPHA-CENTURY.
  3238                 24 DC-ALPHA-CEN-N     PIC 99.
  3239             20  DC-ALPHA-YEAR         PIC 99.
  3240         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3241         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3242         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3243         16  DC-JULIAN-DATE            PIC 9(05).
  3244         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3245                                       PIC 9(05).
  3246         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3247             20  DC-JULIAN-YEAR        PIC 99.
  3248             20  DC-JULIAN-DAYS        PIC 999.
  3249         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3250         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3251         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3252     12  DATE-CONVERSION-VARIBLES.
  3253         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3254         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3255             20  FILLER                PIC 9(3).
  3256             20  HOLD-CEN-1-CCYY.
  3257                 24  HOLD-CEN-1-CC     PIC 99.
  3258                 24  HOLD-CEN-1-YY     PIC 99.
  3259             20  HOLD-CEN-1-MO         PIC 99.
  3260             20  HOLD-CEN-1-DA         PIC 99.
  3261         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3262             20  HOLD-CEN-1-R-MO       PIC 99.
  3263             20  HOLD-CEN-1-R-DA       PIC 99.
  3264             20  HOLD-CEN-1-R-CCYY.
  3265                 24  HOLD-CEN-1-R-CC   PIC 99.
  3266                 24  HOLD-CEN-1-R-YY   PIC 99.
  3267             20  FILLER                PIC 9(3).
  3268         16  HOLD-CENTURY-1-X.
  3269             20  FILLER                PIC X(3)  VALUE SPACES.
  3270             20  HOLD-CEN-1-X-CCYY.
  3271                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3272                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3273             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3274             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3275         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3276             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3277             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3278             20  HOLD-CEN-1-R-X-CCYY.
  3279                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3280                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3281             20  FILLER                PIC XXX.
  3282         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3283         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3284         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  62
* EL050.cbl
  3285         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3286             20  DC-JULIAN-1-CCYY.
  3287                 24  DC-JULIAN-1-CC    PIC 99.
  3288                 24  DC-JULIAN-1-YR    PIC 99.
  3289             20  DC-JULIAN-DA-1        PIC 999.
  3290         16  DC-JULIAN-DATE-2          PIC 9(07).
  3291         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3292             20  DC-JULIAN-2-CCYY.
  3293                 24  DC-JULIAN-2-CC    PIC 99.
  3294                 24  DC-JULIAN-2-YR    PIC 99.
  3295             20  DC-JULIAN-DA-2        PIC 999.
  3296         16  DC-GREG-DATE-A-EDIT.
  3297             20  DC-EDITA-MONTH        PIC 99.
  3298             20  SLASHA-1              PIC X VALUE '/'.
  3299             20  DC-EDITA-DAY          PIC 99.
  3300             20  SLASHA-2              PIC X VALUE '/'.
  3301             20  DC-EDITA-CCYY.
  3302                 24  DC-EDITA-CENT     PIC 99.
  3303                 24  DC-EDITA-YEAR     PIC 99.
  3304         16  DC-GREG-DATE-B-EDIT.
  3305             20  DC-EDITB-MONTH        PIC 99.
  3306             20  SLASHB-1              PIC X VALUE '/'.
  3307             20  DC-EDITB-DAY          PIC 99.
  3308             20  SLASHB-2              PIC X VALUE '/'.
  3309             20  DC-EDITB-CCYY.
  3310                 24  DC-EDITB-CENT     PIC 99.
  3311                 24  DC-EDITB-YEAR     PIC 99.
  3312         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3313         16  DC-GREG-DATE-CYMD-R REDEFINES
  3314                              DC-GREG-DATE-CYMD.
  3315             20  DC-CYMD-CEN           PIC 99.
  3316             20  DC-CYMD-YEAR          PIC 99.
  3317             20  DC-CYMD-MONTH         PIC 99.
  3318             20  DC-CYMD-DAY           PIC 99.
  3319         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3320         16  DC-GREG-DATE-MDCY-R REDEFINES
  3321                              DC-GREG-DATE-MDCY.
  3322             20  DC-MDCY-MONTH         PIC 99.
  3323             20  DC-MDCY-DAY           PIC 99.
  3324             20  DC-MDCY-CEN           PIC 99.
  3325             20  DC-MDCY-YEAR          PIC 99.
  3326    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3327        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3328    12  DC-EL310-DATE                  PIC X(21).
  3329    12  FILLER                         PIC X(28).
  3330
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  63
* EL050.cbl
  3332*    COPY ELCCALC.
  3333******************************************************************
  3334*                                                                *
  3335*                           ELCCALC.                            *
  3336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3337*                            VMOD=2.025                          *
  3338*                                                                *
  3339*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3340*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3341*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3342*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3343*                                                                *
  3344*  PASSED TO ELRTRM                                              *
  3345*  -----------------                                             *
  3346*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3347*  ORIGINAL TERM                                                 *
  3348*  BEGINNING DATE                                                *
  3349*  ENDING DATE                                                   *
  3350*  COMPANY I.D.                                                  *
  3351*  ACCOUNT MASTER USER FIELD                                     *
  3352*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3353*  FREE LOOK DAYS                                                *
  3354*                                                                *
  3355*  RETURNED FROM ELRTRM                                          *
  3356*  ---------------------                                         *
  3357*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3358*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3359*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3360*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3361*----------------------------------------------------------------*
  3362*  PASSED TO ELRAMT                                              *
  3363*  ----------------                                              *
  3364*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3365*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3366*  ORIGINAL AMOUNT                                               *
  3367*  ALTERNATE BENEFIT (BALLON)                                    *
  3368*  A.P.R. - NET PAY ONLY                                         *
  3369*  METHOD
  3370*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3371*  COMPANY I.D.                                                  *
  3372*  BENEFIT TYPE                                                  *
  3373*                                                                *
  3374*  RETURNED FROM ELRAMT                                          *
  3375*  --------------------                                          *
  3376*  REMAINING AMOUNT 1 - CURRENT                                  *
  3377*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3378*  REMAINING AMOUNT FACTOR
  3379*----------------------------------------------------------------*
  3380*  PASSED TO ELRESV                                              *
  3381*  -----------------                                             *
  3382*  CERTIFICATE EFFECTIVE DATE                                    *
  3383*  VALUATION DATE                                                *
  3384*  PAID THRU DATE                                                *
  3385*  BENEFIT                                                       *
  3386*  INCURRED DATE                                                 *
  3387*  REPORTED DATE                                                 *
  3388*  ISSUE AGE                                                     *
  3389*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  64
* EL050.cbl
  3390*  CDT PERCENT                                                   *
  3391*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3392* *CLAIM TYPE (LIFE, A/H)                                        *
  3393* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3394* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3395*                                                                *
  3396*  RETURNED FROM ELRESV                                          *
  3397*  --------------------                                          *
  3398*  CDT TABLE USED                                                *
  3399*  CDT FACTOR USED                                               *
  3400*  PAY TO CURRENT RESERVE                                        *
  3401*  I.B.N.R. - A/H ONLY                                           *
  3402*  FUTURE (ACCRUED) AH ONLY                                      *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRATE                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3408*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3409*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3410*  STATE CODE (CLIENT DEFINED)                                   *
  3411*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3412*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3413*  DEVIATION CODE                                                *
  3414*  ISSUE AGE                                                     *
  3415*  ORIGINAL BENEFIT AMOUNT                                       *
  3416*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3417*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3418*  BENEFIT KIND (LIFE OR A/H)                                    *
  3419*  A.P.R.                                                        *
  3420*  METHOD
  3421*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3422*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3423*  COMPANY I.D. (3 CHARACTER)                                    *
  3424*  BENEFIT CODE                                                  *
  3425*  BENEFIT OVERRIDE CODE                                         *
  3426*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3427*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3428*  JOINT INDICATOR (CSL ONLY)                                    *
  3429*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3430*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3431*                                                                *
  3432*  RETURNED FROM ELRATE                                          *
  3433*  --------------------                                          *
  3434*  CALCULATED PREMIUM                                            *
  3435*  PREMIUM RATE                                                  *
  3436*  MORTALITY CODE                                                *
  3437*  MAX ATTAINED AGE                                              *
  3438*  MAX AGE                                                       *
  3439*  MAX TERM                                                      *
  3440*  MAX MONTHLY BENEFIT                                           *
  3441*  MAX TOTAL BENIFIT                                             *
  3442*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3443*----------------------------------------------------------------*
  3444*  PASSED TO ELRFND                                              *
  3445*  ----------------                                              *
  3446*  CERT ISSUE DATE                                               *
  3447*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  65
* EL050.cbl
  3448*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3449*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3450*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3451*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3452*  STATE CODE (CLIENT DEFINED)                                   *
  3453*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3454*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3455*  DEVIATION CODE                                                *
  3456*  ISSUE AGE                                                     *
  3457*  ORIGINAL BENEFIT AMOUNT                                       *
  3458*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3459*  PROCESS TYPE (CANCEL)                                         *
  3460*  BENEFIT KIND (LIFE OR A/H)                                    *
  3461*  A.P.R.                                                        *
  3462*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3463*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3464*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3465*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3466*  COMPANY I.D. (3 CHARACTER)                                    *
  3467*  BENEFIT CODE                                                  *
  3468*  BENEFIT OVERRIDE CODE                                         *
  3469*                                                                *
  3470*  RETURNED FROM ELRFND                                          *
  3471*  --------------------                                          *
  3472*  CALCULATED REFUND                                             *
  3473*----------------------------------------------------------------*
  3474*  PASSED TO ELEARN                                              *
  3475*  ----------------                                              *
  3476*  CERT ISSUE DATE                                               *
  3477*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3478*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3479*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3480*  STATE CODE (CLIENT DEFINED)                                   *
  3481*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3482*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3483*  DEVIATION CODE                                                *
  3484*  ISSUE AGE                                                     *
  3485*  ORIGINAL BENEFIT AMOUNT                                       *
  3486*  BENEFIT KIND (LIFE OR A/H)                                    *
  3487*  A.P.R.                                                        *
  3488*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3489*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3490*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3491*  COMPANY I.D. (3 CHARACTER)                                    *
  3492*  BENEFIT CODE                                                  *
  3493*  BENEFIT OVERRIDE CODE                                         *
  3494*                                                                *
  3495*  RETURNED FROM ELEARN                                          *
  3496*  --------------------                                          *
  3497*  INDICATED  EARNINGS                                           *
  3498*----------------------------------------------------------------*
  3499*                 LENGTH = 450                                   *
  3500*                                                                *
  3501******************************************************************
  3502******************************************************************
  3503*                   C H A N G E   L O G
  3504*
  3505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  66
* EL050.cbl
  3506*-----------------------------------------------------------------
  3507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3508* EFFECTIVE    NUMBER
  3509*-----------------------------------------------------------------
  3510* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3511* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3512* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3513* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3514* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3515* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3516* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3517* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3518* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3519* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3520******************************************************************
  3521
  3522 01  CALCULATION-PASS-AREA.
  3523     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3524                                     COMP.
  3525
  3526     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3527       88  NO-CP-ERROR                             VALUE ZERO.
  3528       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3529                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3530       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3531       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3532       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3533       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3534       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3535       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3536       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3537       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3538       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3539       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3540       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3541       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3542       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3543       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3544       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3545       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3546       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3547
  3548     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3549       88  NO-CP-ERROR-2                           VALUE ZERO.
  3550***********************  INPUT AREAS ****************************
  3551
  3552     12  CP-CALCULATION-AREA.
  3553         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3554         16  CP-CERT-EFF-DT        PIC XX.
  3555         16  CP-VALUATION-DT       PIC XX.
  3556         16  CP-PAID-THRU-DT       PIC XX.
  3557         16  CP-BENEFIT-TYPE       PIC X.
  3558           88  CP-AH                               VALUE 'A' 'D'
  3559                                                   'I' 'U'.
  3560           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3561           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3562         16  CP-INCURRED-DT        PIC XX.
  3563         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  67
* EL050.cbl
  3564         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3565         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3566         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3569                                     COMP-3.
  3570         16  CP-CDT-METHOD         PIC X.
  3571           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3572           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3573           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3574         16  CP-CLAIM-TYPE         PIC X.
  3575           88  CP-AH-CLAIM                         VALUE 'A'.
  3576           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3577         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-REM-TERM-METHOD    PIC X.
  3592           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3593           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3594           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3595           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3596           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3597           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3598           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3599         16  CP-EARNING-METHOD     PIC X.
  3600           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3601           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3602           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3603           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3604           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3605           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3606           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3607           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3608           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3609           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3610           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3611           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3612           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3613           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3614         16  CP-PROCESS-TYPE       PIC X.
  3615           88  CP-CLAIM                            VALUE '1'.
  3616           88  CP-CANCEL                           VALUE '2'.
  3617           88  CP-ISSUE                            VALUE '3'.
  3618         16  CP-SPECIAL-CALC-CD    PIC X.
  3619           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3620           88  CP-1-MTH-INTEREST               VALUE ' '.
  3621           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  68
* EL050.cbl
  3622           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3623           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3624           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3625           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3626           88  CP-FARM-PLAN                    VALUE 'F'.
  3627           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3628           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3629           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3630           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3631           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3632           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3633           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3634           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3635           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3636           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3637                                                     'W' 'X'.
  3638           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3639           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3640           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3641           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3642           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3643           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3644           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3645           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3646           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3647           88  CP-CSL-METH-1                   VALUE '5'.
  3648           88  CP-CSL-METH-2                   VALUE '6'.
  3649           88  CP-CSL-METH-3                   VALUE '7'.
  3650           88  CP-CSL-METH-4                   VALUE '8'.
  3651
  3652         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3653                                     COMP-3.
  3654         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3655         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3656         16  CP-STATE              PIC XX          VALUE SPACE.
  3657         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3658         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3659           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3660               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3661         16  CP-R78-OPTION         PIC X.
  3662           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3663           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3664
  3665         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3666         16  CP-IBNR-RESERVE-SW    PIC X.
  3667         16  CP-CLAIM-STATUS       PIC X.
  3668         16  CP-RATE-FILE          PIC X.
  3669         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3670                                     COMP-3.
  3671
  3672         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3673         16  CP-AH-OVERRIDE-CODE   PIC X.
  3674
  3675         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3678                                   PIC S9(5)V99 COMP-3.
  3679         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  69
* EL050.cbl
  3680                                     COMP-3.
  3681         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3686                                  PIC S9(7)V99 COMP-3.
  3687
  3688         16  CP-PAID-FROM-DATE     PIC X(02).
  3689         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3690         16  CP-EXT-DAYS-CALC      PIC X.
  3691           88  CP-EXT-NO-CHG                   VALUE ' '.
  3692           88  CP-EXT-CHG-LF                   VALUE '1'.
  3693           88  CP-EXT-CHG-AH                   VALUE '2'.
  3694           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3695         16  CP-DOMICILE-STATE     PIC XX.
  3696         16  CP-CARRIER            PIC X.
  3697         16  CP-REIN-FLAG          PIC X.
  3698         16  CP-REM-TRM-CALC-OPTION PIC X.
  3699           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3700                      '2' '3' '4' '5'.
  3701           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3702           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3703           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3704           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3705           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3706           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3707           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3708           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3709         16  CP-SIG-SWITCH         PIC X.
  3710         16  CP-RATING-METHOD      PIC X.
  3711           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3712           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3713           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3714           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3715           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3716           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3717           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3718           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3719           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3720         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3721                                     COMP-3.
  3722         16  CP-BEN-CATEGORY       PIC X.
  3723         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3724         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3725                                   PIC S99V9(5) COMP-3.
  3726         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3727         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3728                                   PIC S99V9(5) COMP-3.
  3729         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3730         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3731         16  CP-EXPIRE-DT          PIC XX.
  3732         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3733         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3734         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3735         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3736         16  CP-DDF-SPEC-CALC      PIC X.
  3737             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  70
* EL050.cbl
  3738             88  CP-CALC-CLP              VALUE 'C'.
  3739         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3740         16  CP-CANCEL-REASON      PIC X.
  3741         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3742         16  CP-PMT-MODE           PIC X.
  3743         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3744         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3745         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3746         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3747         16  FILLER                PIC X.
  3748
  3749***************    OUTPUT FROM ELRESV   ************************
  3750
  3751         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3752
  3753         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3760                                     COMP-3.
  3761         16  FILLER                PIC X(09).
  3762***************    OUTPUT FROM ELRTRM   *************************
  3763
  3764         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3771                                     COMP-3.
  3772         16  FILLER                PIC X(12).
  3773
  3774***************    OUTPUT FROM ELRAMT   *************************
  3775
  3776         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  FILLER                PIC X(12).
  3781
  3782***************    OUTPUT FROM ELRATE   *************************
  3783
  3784         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-MORTALITY-CODE     PIC X(4).
  3789         16  CP-RATE-EDIT-FLAG     PIC X.
  3790             88  CP-RATES-NEED-APR                  VALUE '1'.
  3791         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3794         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3795         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  71
* EL050.cbl
  3796                                   PIC S9(7)V99 COMP-3.
  3797         16  FILLER                PIC X(07).
  3798
  3799***************    OUTPUT FROM ELRFND   *************************
  3800
  3801         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REFUND-TYPE-USED   PIC X.
  3804           88  CP-R-AS-R78                         VALUE '1'.
  3805           88  CP-R-AS-PRORATA                     VALUE '2'.
  3806           88  CP-R-AS-CALIF                       VALUE '3'.
  3807           88  CP-R-AS-TEXAS                       VALUE '4'.
  3808           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3809           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3810           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3811           88  CP-R-AS-MEAN                        VALUE '8'.
  3812           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3813           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3814           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3815           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3816           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3817           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3818         16  FILLER                PIC X(12).
  3819
  3820***************    OUTPUT FROM ELEARN   *************************
  3821
  3822         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-EARNING-TYPE-USED  PIC X.
  3835           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3836           88  CP-E-AS-R78                         VALUE '1'.
  3837           88  CP-E-AS-PRORATA                     VALUE '2'.
  3838           88  CP-E-AS-TEXAS                       VALUE '4'.
  3839           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3840           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3841           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3842           88  CP-E-AS-MEAN                        VALUE '8'.
  3843           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3844         16  FILLER                PIC X(12).
  3845
  3846***************    OUTPUT FROM ELPMNT   *************************
  3847
  3848         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3851                                     COMP-3.
  3852         16  FILLER                PIC X(12).
  3853
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  72
* EL050.cbl
  3854***************   MISC WORK AREAS    *****************************
  3855         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3868             88  OPEN-RATE-FILE                   VALUE 'O'.
  3869             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3870             88  IO-ERROR                         VALUE 'E'.
  3871
  3872         16  CP-FIRST-PAY-DATE     PIC XX.
  3873
  3874         16  CP-JOINT-INDICATOR    PIC X.
  3875
  3876         16  CP-RESERVE-REMAINING-TERM
  3877                                   PIC S9(4)V9    VALUE ZERO
  3878                                     COMP-3.
  3879
  3880         16  CP-INSURED-BIRTH-DT   PIC XX.
  3881
  3882         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884
  3885         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3886                                     COMP-3.
  3887
  3888         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3889                                     COMP-3.
  3890
  3891         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3892                                     COMP-3.
  3893
  3894         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3898                                     COMP-3.
  3899
  3900         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3904             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3905
  3906         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3911         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  73
* EL050.cbl
  3912         16  cp-net-only-state     pic x value spaces.
  3913         16  FILLER                PIC X(13).
  3914******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  74
* EL050.cbl
  3916******************************************************************
  3917*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3918*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3919*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3920*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3921*** MODIFICATION.                                              ***
  3922*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3923*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3924******************************************************************
  3925*    COPY ERCPNDB.
  3926******************************************************************
  3927*                                                                *
  3928*                                                                *
  3929*                            ERCPNDB.                            *
  3930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3931*                            VMOD=2.025                          *
  3932*                                                                *
  3933*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3934*                                                                *
  3935******************************************************************
  3936*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3937*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*   FILE TYPE = VSAM,KSDS                                        *
  3942*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3943*                                                                *
  3944*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3945*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3946*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3947*                                                 RKP=13,LEN=36  *
  3948*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3949*                                      AND CHG-SEQ.)             *
  3950*                                                RKP=49,LEN=11   *
  3951*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3952*                                      AND CHG-SEQ.)             *
  3953*                                                RKP=60,LEN=15   *
  3954*                                                                *
  3955*   LOG = NO                                                     *
  3956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3957******************************************************************
  3958******************************************************************
  3959*                   C H A N G E   L O G
  3960*
  3961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3962*-----------------------------------------------------------------
  3963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3964* EFFECTIVE    NUMBER
  3965*-----------------------------------------------------------------
  3966* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3967* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3968* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3969* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3970* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3971* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3972* 032306                   PEMA  ADD BOW LOAN NUMBER
  3973* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  75
* EL050.cbl
  3974* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3975* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3976* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3977* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3978* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3979* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3980* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3981* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3982******************************************************************
  3983
  3984 01  PENDING-BUSINESS.
  3985     12  PB-RECORD-ID                     PIC XX.
  3986         88  VALID-PB-ID                        VALUE 'PB'.
  3987
  3988     12  PB-CONTROL-PRIMARY.
  3989         16  PB-COMPANY-CD                PIC X.
  3990         16  PB-ENTRY-BATCH               PIC X(6).
  3991         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3992         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3993
  3994     12  PB-CONTROL-BY-ACCOUNT.
  3995         16  PB-COMPANY-CD-A1             PIC X.
  3996         16  PB-CARRIER                   PIC X.
  3997         16  PB-GROUPING.
  3998             20  PB-GROUPING-PREFIX       PIC XXX.
  3999             20  PB-GROUPING-PRIME        PIC XXX.
  4000         16  PB-STATE                     PIC XX.
  4001         16  PB-ACCOUNT.
  4002             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4003             20  PB-ACCOUNT-PRIME         PIC X(6).
  4004         16  PB-CERT-EFF-DT               PIC XX.
  4005         16  PB-CERT-NO.
  4006             20  PB-CERT-PRIME            PIC X(10).
  4007             20  PB-CERT-SFX              PIC X.
  4008         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4009
  4010         16  PB-RECORD-TYPE               PIC X.
  4011             88  PB-MAILING-DATA                VALUE '0'.
  4012             88  PB-ISSUE                       VALUE '1'.
  4013             88  PB-CANCELLATION                VALUE '2'.
  4014             88  PB-BATCH-TRAILER               VALUE '9'.
  4015
  4016     12  PB-CONTROL-BY-ORIG-BATCH.
  4017         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4018         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4019         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4020         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4021
  4022     12  PB-CONTROL-BY-CSR.
  4023         16  PB-CSR-COMPANY-CD            PIC X.
  4024         16  PB-CSR-ID                    PIC X(4).
  4025         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4026         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4027         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4028******************************************************************
  4029*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4030******************************************************************
  4031
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  76
* EL050.cbl
  4032     12  PB-LAST-MAINT-DT                 PIC XX.
  4033     12  PB-LAST-MAINT-BY                 PIC X(4).
  4034     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4035
  4036     12  PB-RECORD-BODY                   PIC X(375).
  4037
  4038     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4039         16  PB-CERT-ORIGIN               PIC X.
  4040             88  CLASIC-CREATED-CERT         VALUE '1'.
  4041         16  PB-I-NAME.
  4042             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4043             20  PB-I-INSURED-FIRST-NAME.
  4044                 24  PB-I-INSURED-1ST-INIT PIC X.
  4045                 24  FILLER                PIC X(9).
  4046             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4047         16  PB-I-AGE                     PIC S99   COMP-3.
  4048         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4049         16  PB-I-BIRTHDAY                PIC XX.
  4050         16  PB-I-INSURED-SEX             PIC X.
  4051             88  PB-SEX-MALE     VALUE 'M'.
  4052             88  PB-SEX-FEMALE   VALUE 'F'.
  4053
  4054         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4055         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4056         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4057         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4058         16  PB-I-SKIP-CODE               PIC X.
  4059             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4060             88  PB-SKIP-JULY              VALUE '1'.
  4061             88  PB-SKIP-AUGUST            VALUE '2'.
  4062             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4063             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4064             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4065             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4066             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4067             88  PB-SKIP-JUNE              VALUE '8'.
  4068             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4069             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4070             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4071         16  PB-I-TERM-TYPE               PIC X.
  4072             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4073             88  PB-PAID-WEEKLY            VALUE 'W'.
  4074             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4075             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4076             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4077         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4078         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4079         16  PB-I-DATA-ENTRY-SW           PIC X.
  4080             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4081             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4082             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4083             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4084         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4085         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4086*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4087         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4088         16  FILLER                       PIC X.
  4089
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  77
* EL050.cbl
  4090         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4091             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4092             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4093                                                   '90' THRU '99'.
  4094         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4095                                          PIC XX.
  4096         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4097         16  PB-I-AMOUNT-FINANCED REDEFINES
  4098                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4099         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4100         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4101                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4102         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4103         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4104         16  PB-I-CLP-AMOUNT REDEFINES
  4105                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4106         16  PB-I-LF-CALC-FLAG            PIC X.
  4107             88 PB-COMP-LF-PREM               VALUE '?'.
  4108         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4109         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4110         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4111         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4112         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4113         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4114         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4115         16  PB-I-LF-ABBR                 PIC XXX.
  4116         16  PB-I-LF-INPUT-CD             PIC XX.
  4117
  4118         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4119             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4120             88  PB-INVALID-AH               VALUE '  ' '00'
  4121                                                   '90' THRU '99'.
  4122         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4123         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4124         16  PB-I-AH-CALC-FLAG            PIC X.
  4125             88 PB-COMP-AH-PREM                  VALUE '?'.
  4126         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4127         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4128         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4129         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4130         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4131         16  PB-I-AH-ABBR                 PIC XXX.
  4132         16  PB-I-AH-INPUT-CD             PIC XXX.
  4133
  4134         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4135         16  PB-I-REIN-TABLE              PIC XXX.
  4136         16  PB-I-BUSINESS-TYPE           PIC 99.
  4137         16  PB-I-INDV-GRP-CD             PIC X.
  4138         16  PB-I-MORT-CODE.
  4139             20  PB-I-TABLE               PIC X.
  4140             20  PB-I-INTEREST            PIC XX.
  4141             20  PB-I-MORT-TYP            PIC X.
  4142         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4143         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4144         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4145         16  PB-I-INDV-GRP-OVRD           PIC X.
  4146         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4147         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  78
* EL050.cbl
  4148             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4149         16  PB-I-RATE-CLASS              PIC XX.
  4150         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4151         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4152         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4153         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4154         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4155         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4156         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4157         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4158         16  PB-I-OB-FLAG                 PIC X.
  4159             88  PB-I-OB                      VALUE 'B'.
  4160             88  PB-I-SUMMARY                 VALUE 'Z'.
  4161         16  PB-I-ENTRY-STATUS            PIC X.
  4162             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4163                                              'M' '5' '9' '2'.
  4164             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4165             88  PB-I-POLICY-PENDING          VALUE '2'.
  4166             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4167             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4168             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4169             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4170             88  PB-I-REIN-ONLY               VALUE '9'.
  4171             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4172             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4173             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4174             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4175         16  PB-I-INT-CODE                PIC X.
  4176             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4177             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4178         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4179         16  PB-I-SOC-SEC-NO              PIC X(11).
  4180         16  PB-I-MEMBER-NO               PIC X(12).
  4181         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4182*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4183         16  PB-I-OLD-LOF                 PIC XXX.
  4184         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4185         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4186         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4187         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4188         16  PB-I-LIFE-INDICATOR          PIC X.
  4189             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4190         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4191         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4192                                          PIC S9(5)V99    COMP-3.
  4193         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4194             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4195             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4196         16  PB-I-1ST-PMT-DT              PIC XX.
  4197         16  PB-I-JOINT-INSURED.
  4198             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4199             20 PB-I-JOINT-FIRST-NAME.
  4200                24  PB-I-JOINT-FIRST-INIT PIC X.
  4201                24  FILLER                PIC X(9).
  4202             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4203*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4204         16  PB-I-BENEFICIARY-NAME.
  4205             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  79
* EL050.cbl
  4206             20  FILLER                   PIC X(15).
  4207         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4208         16  PB-I-REFERENCE               PIC X(12).
  4209         16  FILLER REDEFINES PB-I-REFERENCE.
  4210             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4211             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4212             20  PB-I-CLP-STATE           PIC XX.
  4213         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4214             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4215             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4216             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4217         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4218         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4219         16  PB-I-RESIDENT-STATE          PIC XX.
  4220         16  PB-I-RATE-CODE               PIC X(4).
  4221         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4222         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4223         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4224         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4225         16  PB-I-BANK-NOCHRGB            PIC 99.
  4226         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4227         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4228
  4229     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4230         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4231             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4232         16  PB-C-CANCEL-ORIGIN           PIC X.
  4233             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4234         16  PB-C-LF-CANCEL-DT            PIC XX.
  4235         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4236         16  PB-C-LF-CALC-REQ             PIC X.
  4237             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4238         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4239         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4240         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4241             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4242         16  PB-C-AH-CANCEL-DT            PIC XX.
  4243         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4244         16  PB-C-AH-CALC-REQ             PIC X.
  4245             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4246         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4247         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4248         16  PB-C-LAST-NAME               PIC X(15).
  4249         16  PB-C-REFUND-SW               PIC X.
  4250             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4251             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4252         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4253         16  PB-C-PAYEE-CODE              PIC X(6).
  4254         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4255         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4256         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4257         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4258         16  PB-C-REFERENCE               PIC X(12).
  4259         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4260         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4261         16  PB-C-POST-CARD-IND           PIC X.
  4262         16  PB-C-CANCEL-REASON           PIC X.
  4263         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  80
* EL050.cbl
  4264         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4265         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4266         16  FILLER                       PIC X(01).
  4267*        16  FILLER                       PIC X(18).
  4268         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4269*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4270         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4271         16  PB-CANCELED-CERT-DATA.
  4272             20  PB-CI-INSURED-NAME.
  4273                 24  PB-CI-LAST-NAME      PIC X(15).
  4274                 24  PB-CI-INITIALS       PIC XX.
  4275             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4276             20  PB-CI-INSURED-SEX        PIC X.
  4277             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4278             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4279             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4280             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4281             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4282             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4283             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4284             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4285             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4286             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4287             20  PB-CI-RATE-CLASS         PIC XX.
  4288             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4289             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4290             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4291             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4292             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4293             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4294             20  PB-CI-LF-ABBR            PIC X(3).
  4295             20  PB-CI-AH-ABBR            PIC X(3).
  4296             20  PB-CI-OB-FLAG            PIC X.
  4297                 88  PB-CI-OB                VALUE 'B'.
  4298             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4299                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4300                                           'M' '4' '5' '9' '2'.
  4301                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4302                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4303                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4304                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4305                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4306                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4307                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4308                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4309                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4310                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4311                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4312                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4313                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4314             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4315                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4316                                           'M' '4' '5' '9' '2'.
  4317                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4318                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4319                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4320                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4321                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  81
* EL050.cbl
  4322                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4323                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4324                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4325                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4326                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4327                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4328                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4329                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4330             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4331             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4332             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4333             20  PB-CI-MEMBER-NO          PIC X(12).
  4334             20  PB-CI-INT-CODE           PIC X.
  4335                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4336                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4337             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4338             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4339             20  PB-CI-COMP-EXCP-SW       PIC X.
  4340                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4341                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4342             20  PB-CI-ENTRY-STATUS       PIC X.
  4343             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4344             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4345             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4346             20  PB-CI-DEATH-DT           PIC XX.
  4347             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4348             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4349             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4350             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4351             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4352             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4353             20  PB-CI-ENTRY-DT              PIC XX.
  4354             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4355             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4356             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4357             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4358             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4359             20  PB-CI-OLD-LOF               PIC XXX.
  4360*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4361             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4362             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4363             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4364             20  PB-CI-INDV-GRP-CD           PIC X.
  4365             20  PB-CI-BENEFICIARY-NAME.
  4366                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4367                 24  FILLER                  PIC X(15).
  4368             20  PB-CI-NOTE-SW               PIC X.
  4369             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4370             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4371             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4372             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4373             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4374             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4375             20  PB-CI-FIRST-NAME            PIC X(10).
  4376             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4377
  4378         16  FILLER                       PIC X(13).
  4379*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  82
* EL050.cbl
  4380*        16  FILLER                       PIC X(46).
  4381
  4382     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4383         16  FILLER                       PIC X(10).
  4384         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4385         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4386         16  PB-M-INSURED-MID-INIT        PIC X.
  4387         16  PB-M-INSURED-AGE             PIC 99.
  4388         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4389         16  PB-M-INSURED-SEX             PIC X.
  4390         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4391         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4392         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4393         16  PB-M-INSURED-CITY-STATE.
  4394             20  PB-M-INSURED-CITY        PIC X(28).
  4395             20  PB-M-INSURED-STATE       PIC XX.
  4396         16  PB-M-INSURED-ZIP-CODE.
  4397             20  PB-M-INSURED-ZIP-PRIME.
  4398                 24  PB-M-INSURED-ZIP-1   PIC X.
  4399                     88  PB-M-CANADIAN-POST-CODE
  4400                                             VALUE 'A' THRU 'Z'.
  4401                 24  FILLER               PIC X(4).
  4402             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4403         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4404                                        PB-M-INSURED-ZIP-CODE.
  4405             20  PM-M-INS-CAN-POST1       PIC XXX.
  4406             20  PM-M-INS-CAN-POST2       PIC XXX.
  4407             20  FILLER                   PIC XXX.
  4408         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4409         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4410         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4411         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4412         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4413         16  PB-M-CRED-BENE-CITYST.
  4414             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4415             20  PB-M-CRED-BENE-STATE     PIC XX.
  4416         16  FILLER                       PIC X(92).
  4417
  4418     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4419         16  FILLER                       PIC X(10).
  4420         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4422         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4423         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4425         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4426         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4428         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4431         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4432         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4433         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4434         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4435         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4436         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4437         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  83
* EL050.cbl
  4438         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4439         16  PB-REFERENCE                 PIC X(12).
  4440         16  PB-B-RECEIVED-DT             PIC XX.
  4441         16  FILLER                       PIC X(234).
  4442
  4443     12  PB-RECORD-STATUS.
  4444         16  PB-CREDIT-SELECT-DT          PIC XX.
  4445         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4446         16  PB-BILLED-DT                 PIC XX.
  4447         16  PB-BILLING-STATUS            PIC X.
  4448             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4449             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4450             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4451         16  PB-RECORD-BILL               PIC X.
  4452             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4453             88  PB-RECORD-RETURNED           VALUE 'R'.
  4454             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4455             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4456             88  PB-OVERRIDE-AH               VALUE 'A'.
  4457             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4458         16  PB-BATCH-ENTRY               PIC X.
  4459             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4460             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4461             88  PB-REISSUED-CERT             VALUE 'E'.
  4462             88  PB-CASH-CERT                 VALUE 'C'.
  4463             88  PB-MONTHLY-CERT              VALUE 'M'.
  4464             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4465             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4466             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4467         16  PB-FORCE-CODE                PIC X.
  4468             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4469             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4470             88  PB-CANCEL-FORCE              VALUE '8'.
  4471             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4472             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4473             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4474             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4475             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4476             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4477             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4478         16  PB-FATAL-FLAG                PIC X.
  4479             88  PB-FATAL-ERRORS              VALUE 'X'.
  4480         16  PB-FORCE-ER-CD               PIC X.
  4481             88  PB-FORCE-ERRORS              VALUE 'F'.
  4482             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4483         16  PB-WARN-ER-CD                PIC X.
  4484             88  PB-WARNING-ERRORS            VALUE 'W'.
  4485         16  FILLER                       PIC X.
  4486         16  PB-OUT-BAL-CD                PIC X.
  4487             88  PB-OUT-OF-BAL                VALUE 'O'.
  4488         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4489         16  PB-AH-OVERRIDE-L1            PIC X.
  4490         16  PB-INPUT-DT                  PIC XX.
  4491         16  PB-INPUT-BY                  PIC X(4).
  4492         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4493         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4494         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4495         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  84
* EL050.cbl
  4496         16  PB-AH-EARNING-METHOD         PIC X.
  4497         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4498         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4499         16  PB-REIN-CD                   PIC XXX.
  4500         16  PB-LF-REFUND-TYPE            PIC X.
  4501         16  PB-AH-REFUND-TYPE            PIC X.
  4502         16  PB-ACCT-EFF-DT               PIC XX.
  4503         16  PB-ACCT-EXP-DT               PIC XX.
  4504         16  PB-COMPANY-ID                PIC X(3).
  4505         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4506         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4507         16  PB-SV-CARRIER                PIC X.
  4508         16  PB-SV-GROUPING               PIC X(6).
  4509         16  PB-SV-STATE                  PIC XX.
  4510         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4511         16  PB-GA-BILLING-INFO.
  4512             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4513                                          PIC XX.
  4514         16  PB-SV-REMIT-TO  REDEFINES
  4515             PB-GA-BILLING-INFO           PIC X(10).
  4516         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4517         16  PB-I-LOAN-OFFICER            PIC X(5).
  4518         16  PB-I-VIN                     PIC X(17).
  4519
  4520         16  FILLER                       PIC X(04).
  4521         16  IMNET-BYPASS-SW              PIC X.
  4522
  4523******************************************************************
  4524*                COMMON EDIT ERRORS                              *
  4525******************************************************************
  4526
  4527     12  PB-COMMON-ERRORS.
  4528         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4529                                           PIC S9(4)     COMP.
  4530
  4531******************************************************************
  4532
  4533* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4534*    COPY ELC50W1.
  4535******************************************************************
  4536*                                                                *
  4537*                                                                *
  4538*                             ELC50W1                            *
  4539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4540*                            VMOD=2.004                          *
  4541*                                                                *
  4542*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4543*                                                                *
  4544*                                                                *
  4545******************************************************************
  4546
  4547     12  WK-WORK-AREA.
  4548         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4549         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4550         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4551         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4552         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4553         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  85
* EL050.cbl
  4554         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4555         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4556         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4557         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4558         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4559         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4560         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4561         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4562         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4563         16  WK-CREDIT-EDIT-CONTROLS.
  4564             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4565             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4566             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4567             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4568             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4569             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4570         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4571         16  WK-SAVE-REIN-DATA.
  4572             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4573             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4574             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4575         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4576             88  ENTRY-FROM-EL6311       VALUE '6'.
  4577         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4578         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4579     12  WK-RECORD-ADDRESSES.
  4580         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4581         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4582         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4583         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4584         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4585         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4586         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4587         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4588     12  WK-OVER-SHORT-AREA.
  4589         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4590         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4591         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4592             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4593         16  FILLER                   PIC X(5) VALUE SPACES.
  4594
  4595*    COPY ELCEDITC.
  4596******************************************************************
  4597*                                                                *
  4598*                                                                *
  4599*                            ELCEDITC                            *
  4600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4601*                            VMOD=2.012                          *
  4602*                                                                *
  4603*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4604*                     EL6313, EL050 AND EL517.                   *
  4605*                                                                *
  4606******************************************************************
  4607******************************************************************
  4608*                   C H A N G E   L O G
  4609*
  4610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4611*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  86
* EL050.cbl
  4612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4613* EFFECTIVE    NUMBER
  4614*-----------------------------------------------------------------
  4615* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4616******************************************************************
  4617
  4618     12  EDIT-CRITERIA-DATA.
  4619         16  EC-CO-MONTH-END-DT       PIC XX.
  4620         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4621         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4622         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4623         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4624         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4625         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4626         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4627         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4628         16  EC-CO-REM-TERM-CALC      PIC X.
  4629               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4630               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4631               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4632               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4633
  4634         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4635               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4636               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4637               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4638               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4639               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4640               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4641               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4642               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4643               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4644               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4645
  4646         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4647               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4648               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4649               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4650               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4651               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4652               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4653               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4654               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4655
  4656         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4657                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4658                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4659
  4660         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4661                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4662                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4663                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4664                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4665                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4666                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4667                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4668                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4669
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  87
* EL050.cbl
  4670         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4671               88  EC-BR-REDUCING                   VALUE 'R'.
  4672               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4673
  4674         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4675         16  EC-BR-LF-DESC             PIC X(10).
  4676         16  EC-BR-AH-DESC             PIC X(10).
  4677         16  EC-BR-LF-COMMENT          PIC X(10).
  4678         16  EC-BR-AH-COMMENT          PIC X(10).
  4679
  4680         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4681               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4682               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4683               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4684               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4685
  4686         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4687               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4688               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4689               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4690               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4691
  4692         16  EC-BR-LF-REFUND-CALC      PIC X.
  4693                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4694                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4695                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4696                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4697                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4698                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4699                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4700
  4701         16  EC-BR-AH-REFUND-CALC      PIC X.
  4702                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4703                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4704                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4705                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4706                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4707                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4708                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4709                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4710
  4711         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4712                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4713                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4714                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4715
  4716         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4717                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4718                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4719                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4720
  4721         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4722         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4723         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4724         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4725
  4726         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4727         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  88
* EL050.cbl
  4728                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4729                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4730                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4731                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4732
  4733         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4734               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4735               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4736               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4737               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4738               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4739
  4740         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4741               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4742               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4743               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4744               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4745               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4746
  4747         16  EC-ST-LF-REFUND-CALC      PIC X.
  4748                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4749                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4750                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4751                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4752                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4753                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4754                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4755                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4756
  4757         16  EC-ST-AH-REFUND-CALC      PIC X.
  4758                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4759                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4760                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4761                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4762                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4763                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4764                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4765                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4766
  4767         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4768         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4769         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4770         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4771         16  EC-AM-EXPIRATION-DT       PIC XX.
  4772         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4773         16  EC-AM-CLASS-CD            PIC XX.
  4774         16  EC-AM-LF-DEVIATION        PIC XXX.
  4775         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4776         16  EC-AM-AH-DEVIATION        PIC XXX.
  4777         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4778         16  EC-AM-PHONE-NO            PIC X(10).
  4779
  4780         16  EC-AM-LF-REFUND-CALC      PIC X.
  4781                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4782                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4783                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4784                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4785                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  89
* EL050.cbl
  4786                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4787                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4788
  4789         16  EC-AM-AH-REFUND-CALC      PIC X.
  4790                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4791                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4792                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4793                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4794                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4795                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4796                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4797
  4798         16  EC-AM-BEN-I-G-CD          PIC X.
  4799                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4800                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4801                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4802
  4803         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4804         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4805         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4806         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4807         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4808         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4809         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4810         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4811         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4812
  4813         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4814         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4815         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4816         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4817         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4818         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4819         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4820         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4821         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4822         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4823         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4824         16  EC-RT-LF-NSP-ST           PIC XX.
  4825         16  EC-RT-AH-NSP-ST           PIC XX.
  4826         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4827         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4828
  4829         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4830             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4831                                             'M' '5' '9' '2'.
  4832             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4833             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4834             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4835             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4836             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4837             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4838             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4839             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4840             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4841             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4842
  4843         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  90
* EL050.cbl
  4844             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4845                                             'M' '5' '9' '2'.
  4846             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4847             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4848             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4849             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4850             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4851             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4852             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4853             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4854             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4855             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4856
  4857         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4858         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4859         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4860         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4861         16  EC-CM-DEATH-DT            PIC XX.
  4862
  4863*DMD CUSTOM CODING FIELDS BELOW
  4864*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4865         16  EC-BR-DMD-RATING-SW       PIC X.
  4866                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4867                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4868                 88  NO-DMD-RATING               VALUE 'N'.
  4869
  4870         16  EC-NEW-CERT               PIC X(11).
  4871         16  EC-NEW-STATE              PIC XX.
  4872         16  FILLER                    PIC X.
  4873*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4874         16  OVER-SHORT-EDIT-FIELDS.
  4875             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4876             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4877             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4878             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4879             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4880             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4881             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4882             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4883             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4884         16  FILLER                    PIC X(71).
  4885******************************************************************
  4886
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  91
* EL050.cbl
  4888*    COPY ELCDIFRD.
  4889******************************************************************
  4890*                                                                *
  4891*                                                                *
  4892*                            ELCDIFRD.                           *
  4893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4894*                            VMOD=2.004                          *
  4895*                                                                *
  4896*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4897*                                                                *
  4898******************************************************************
  4899*
  4900  01  WS-DIFFERENCE-CALCULATION.
  4901        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4902        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4903        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4904        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4905        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4906        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4907        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4908        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4909        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4910        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4911        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4912
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  92
* EL050.cbl
  4914****************************************************************
  4915*
  4916* Copyright (c) 2007 by Clerity Solutions, Inc.
  4917* All rights reserved.
  4918*
  4919****************************************************************
  4920 01  DFHEIV.
  4921   02  DFHEIV0               PIC X(35).
  4922   02  DFHEIV1               PIC X(08).
  4923   02  DFHEIV2               PIC X(08).
  4924   02  DFHEIV3               PIC X(08).
  4925   02  DFHEIV4               PIC X(06).
  4926   02  DFHEIV5               PIC X(04).
  4927   02  DFHEIV6               PIC X(04).
  4928   02  DFHEIV7               PIC X(02).
  4929   02  DFHEIV8               PIC X(02).
  4930   02  DFHEIV9               PIC X(01).
  4931   02  DFHEIV10              PIC S9(7) COMP-3.
  4932   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4933   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4934   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4935   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4936   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4937   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4938   02  DFHEIV17              PIC X(04).
  4939   02  DFHEIV18              PIC X(04).
  4940   02  DFHEIV19              PIC X(04).
  4941   02  DFHEIV20              USAGE IS POINTER.
  4942   02  DFHEIV21              USAGE IS POINTER.
  4943   02  DFHEIV22              USAGE IS POINTER.
  4944   02  DFHEIV23              USAGE IS POINTER.
  4945   02  DFHEIV24              USAGE IS POINTER.
  4946   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4947   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4948   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4949   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4950   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4951   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4952   02  FILLER                PIC X(02).
  4953   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4954   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4955   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4956   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4957   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4958 LINKAGE  SECTION.
  4959*****************************************************************
  4960*                                                               *
  4961* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4962* All rights reserved.                                          *
  4963*                                                               *
  4964*****************************************************************
  4965 01  dfheiblk.
  4966     02  eibtime          pic s9(7) comp-3.
  4967     02  eibdate          pic s9(7) comp-3.
  4968     02  eibtrnid         pic x(4).
  4969     02  eibtaskn         pic s9(7) comp-3.
  4970     02  eibtrmid         pic x(4).
  4971     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  93
* EL050.cbl
  4972     02  eibcposn         pic s9(4) comp.
  4973     02  eibcalen         pic s9(4) comp.
  4974     02  eibaid           pic x(1).
  4975     02  eibfiller1       pic x(1).
  4976     02  eibfn            pic x(2).
  4977     02  eibfiller2       pic x(2).
  4978     02  eibrcode         pic x(6).
  4979     02  eibfiller3       pic x(2).
  4980     02  eibds            pic x(8).
  4981     02  eibreqid         pic x(8).
  4982     02  eibrsrce         pic x(8).
  4983     02  eibsync          pic x(1).
  4984     02  eibfree          pic x(1).
  4985     02  eibrecv          pic x(1).
  4986     02  eibsend          pic x(1).
  4987     02  eibatt           pic x(1).
  4988     02  eibeoc           pic x(1).
  4989     02  eibfmh           pic x(1).
  4990     02  eibcompl         pic x(1).
  4991     02  eibsig           pic x(1).
  4992     02  eibconf          pic x(1).
  4993     02  eiberr           pic x(1).
  4994     02  eibrldbk         pic x(1).
  4995     02  eiberrcd         pic x(4).
  4996     02  eibsynrb         pic x(1).
  4997     02  eibnodat         pic x(1).
  4998     02  eibfiller5       pic x(2).
  4999     02  eibresp          pic 9(09) comp.
  5000     02  eibresp2         pic 9(09) comp.
  5001     02  dfheigdj         pic s9(4) comp.
  5002     02  dfheigdk         pic s9(4) comp.
  5003
  5004 01  DFHCOMMAREA                   PIC X(1036).
  5005
  5006*01 PARMLIST .
  5007*    02  FILLER                    PIC S9(8)   COMP.
  5008*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5009*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5010*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5011*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5012*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5013*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5014*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5015
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  94
* EL050.cbl
  5017*    COPY ELCCNTL.
  5018******************************************************************
  5019*                                                                *
  5020*                                                                *
  5021*                            ELCCNTL.                            *
  5022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5023*                            VMOD=2.059                          *
  5024*                                                                *
  5025*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5026*                                                                *
  5027*   FILE TYPE = VSAM,KSDS                                        *
  5028*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5029*                                                                *
  5030*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5031*       ALTERNATE INDEX = NONE                                   *
  5032*                                                                *
  5033*   LOG = YES                                                    *
  5034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5035******************************************************************
  5036*                   C H A N G E   L O G
  5037*
  5038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5039*-----------------------------------------------------------------
  5040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5041* EFFECTIVE    NUMBER
  5042*-----------------------------------------------------------------
  5043* 082503                   PEMA  ADD BENEFIT GROUP
  5044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5045* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5046* 092705    2005050300006  PEMA  ADD SPP LEASES
  5047* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5048* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5049* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5050* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5051* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5053* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5054* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5055* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5056* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5057******************************************************************
  5058*
  5059 01  CONTROL-FILE.
  5060     12  CF-RECORD-ID                       PIC XX.
  5061         88  VALID-CF-ID                        VALUE 'CF'.
  5062
  5063     12  CF-CONTROL-PRIMARY.
  5064         16  CF-COMPANY-ID                  PIC XXX.
  5065         16  CF-RECORD-TYPE                 PIC X.
  5066             88  CF-COMPANY-MASTER              VALUE '1'.
  5067             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5068             88  CF-STATE-MASTER                VALUE '3'.
  5069             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5070             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5071             88  CF-CARRIER-MASTER              VALUE '6'.
  5072             88  CF-MORTALITY-MASTER            VALUE '7'.
  5073             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5074             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  95
* EL050.cbl
  5075             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5076             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5077             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5078             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5079             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5080             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5081             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5082             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5083             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5084         16  CF-ACCESS-CD-GENL              PIC X(4).
  5085         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5086             20  CF-PROCESSOR               PIC X(4).
  5087         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5088             20  CF-STATE-CODE              PIC XX.
  5089             20  FILLER                     PIC XX.
  5090         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5091             20  FILLER                     PIC XX.
  5092             20  CF-HI-BEN-IN-REC           PIC XX.
  5093         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5094             20  FILLER                     PIC XXX.
  5095             20  CF-CARRIER-CNTL            PIC X.
  5096         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5097             20  FILLER                     PIC XX.
  5098             20  CF-HI-TYPE-IN-REC          PIC 99.
  5099         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5100             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5101                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5102             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5103             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5104         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5105             20  FILLER                     PIC X.
  5106             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5107         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5108             20  FILLER                     PIC XX.
  5109             20  CF-MORTGAGE-PLAN           PIC XX.
  5110         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5111
  5112     12  CF-LAST-MAINT-DT                   PIC XX.
  5113     12  CF-LAST-MAINT-BY                   PIC X(4).
  5114     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5115
  5116     12  CF-RECORD-BODY                     PIC X(728).
  5117
  5118
  5119****************************************************************
  5120*             COMPANY MASTER RECORD                            *
  5121****************************************************************
  5122
  5123     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5124         16  CF-COMPANY-ADDRESS.
  5125             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5126             20  CF-CL-IN-CARE-OF           PIC X(30).
  5127             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5128             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5129             20  CF-CL-CITY-STATE           PIC X(30).
  5130             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5131             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5132         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  96
* EL050.cbl
  5133         16  CF-COMPANY-PASSWORD            PIC X(8).
  5134         16  CF-SECURITY-OPTION             PIC X.
  5135             88  ALL-SECURITY                   VALUE '1'.
  5136             88  COMPANY-VERIFY                 VALUE '2'.
  5137             88  PROCESSOR-VERIFY               VALUE '3'.
  5138             88  NO-SECURITY                    VALUE '4'.
  5139             88  ALL-BUT-TERM                   VALUE '5'.
  5140         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5141             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5142         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5143             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5144         16  CF-INFORCE-LOCATION            PIC X.
  5145             88  CERTS-ARE-ONLINE               VALUE '1'.
  5146             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5147             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5148         16  CF-LOWER-CASE-LETTERS          PIC X.
  5149         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5150             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5151             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5152             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5153             88  CF-ACCNT-CNTL                  VALUE '3'.
  5154             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5155
  5156         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5157         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5158
  5159         16  CF-LGX-CREDIT-USER             PIC X.
  5160             88  CO-IS-NOT-USER                 VALUE 'N'.
  5161             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5162
  5163         16 CF-CREDIT-CALC-CODES.
  5164             20  CF-CR-REM-TERM-CALC PIC X.
  5165               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5166               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5167               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5168               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5169               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5170               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5171               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5172             20  CF-CR-R78-METHOD           PIC X.
  5173               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5174               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5175
  5176         16  CF-CLAIM-CONTROL-COUNTS.
  5177             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5178                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5179
  5180             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5181                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5182
  5183             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5184                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5185
  5186             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5187                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5188
  5189         16  CF-CURRENT-MONTH-END           PIC XX.
  5190
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  97
* EL050.cbl
  5191         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5192             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5193             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5194             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5195             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5196                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5197                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5198             20  CF-CO-PREM-REJECT-SW       PIC X.
  5199                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5200                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5201             20  CF-CO-REF-REJECT-SW        PIC X.
  5202                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5203                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5204
  5205         16  CF-CO-REPORTING-DT             PIC XX.
  5206         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5207         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5208           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5209           88  CF-CO-MONTH-END                  VALUE '1'.
  5210
  5211         16  CF-LGX-CLAIM-USER              PIC X.
  5212             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5213             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5214
  5215         16  CF-CREDIT-EDIT-CONTROLS.
  5216             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5217             20  CF-MIN-AGE                 PIC 99.
  5218             20  CF-DEFAULT-AGE             PIC 99.
  5219             20  CF-MIN-TERM                PIC S999      COMP-3.
  5220             20  CF-MAX-TERM                PIC S999      COMP-3.
  5221             20  CF-DEFAULT-SEX             PIC X.
  5222             20  CF-JOINT-AGE-INPUT         PIC X.
  5223                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5224             20  CF-BIRTH-DATE-INPUT        PIC X.
  5225                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5226             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5227                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5228                 88  CF-ZERO-CARRIER            VALUE '1'.
  5229                 88  CF-ZERO-GROUPING           VALUE '2'.
  5230                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5231             20  CF-EDIT-SW                 PIC X.
  5232                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5233             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5234             20  CF-CR-PR-METHOD            PIC X.
  5235               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5236               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5237             20  FILLER                     PIC X.
  5238
  5239         16  CF-CREDIT-MISC-CONTROLS.
  5240             20  CF-REIN-TABLE-SW           PIC X.
  5241                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5242             20  CF-COMP-TABLE-SW           PIC X.
  5243                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5244             20  CF-EXPERIENCE-RETENTION-AGE
  5245                                            PIC S9        COMP-3.
  5246             20  CF-CONVERSION-DT           PIC XX.
  5247             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5248             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  98
* EL050.cbl
  5249                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5250                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5251
  5252             20  CF-CR-CHECK-NO-CONTROL.
  5253                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5254                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5255                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5256                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5257                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5258                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5259
  5260                 24  CF-CR-CHECK-COUNT       REDEFINES
  5261                     CF-CR-CHECK-COUNTER      PIC X(4).
  5262
  5263                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5264                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5265
  5266                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5267                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5268                 24  CF-MAIL-PROCESSING       PIC X.
  5269                     88  MAIL-PROCESSING          VALUE 'Y'.
  5270
  5271         16  CF-MISC-SYSTEM-CONTROL.
  5272             20  CF-SYSTEM-C                 PIC X.
  5273                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5274             20  CF-SYSTEM-D                 PIC X.
  5275                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5276             20  CF-SOC-SEC-NO-SW            PIC X.
  5277                 88  SOC-SEC-NO-USED             VALUE '1'.
  5278             20  CF-MEMBER-NO-SW             PIC X.
  5279                 88  MEMBER-NO-USED              VALUE '1'.
  5280             20  CF-TAX-ID-NUMBER            PIC X(11).
  5281             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5282             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5283                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5284                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5285                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5286                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5287             20  CF-SYSTEM-E                 PIC X.
  5288                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5289
  5290         16  CF-LGX-LIFE-USER               PIC X.
  5291             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5292             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5293
  5294         16  CF-CR-MONTH-END-DT             PIC XX.
  5295
  5296         16  CF-FILE-MAINT-DATES.
  5297             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5298                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5299             20  CF-LAST-BATCH       REDEFINES
  5300                 CF-LAST-BATCH-NO               PIC X(4).
  5301             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5302             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5303             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5304             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5305             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5306             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page  99
* EL050.cbl
  5307             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5308             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5309             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5310             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5311
  5312         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5313         16  FILLER                         PIC X.
  5314
  5315         16  CF-ALT-MORT-CODE               PIC X(4).
  5316         16  CF-MEMBER-CAPTION              PIC X(10).
  5317
  5318         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5319             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5320             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5321             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5322             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5323             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5324
  5325         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5326
  5327         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5328         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5329         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5330         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5331
  5332         16  CF-AH-OVERRIDE-L1              PIC X.
  5333         16  CF-AH-OVERRIDE-L2              PIC XX.
  5334         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5335         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5336
  5337         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5338         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5339
  5340         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5341         16  CF-AR-LAST-EL860-DT            PIC XX.
  5342         16  CF-MP-MONTH-END-DT             PIC XX.
  5343
  5344         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5345         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5346             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5347
  5348         16  CF-AR-MONTH-END-DT             PIC XX.
  5349
  5350         16  CF-CRDTCRD-USER                PIC X.
  5351             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5352             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5353
  5354         16  CF-CC-MONTH-END-DT             PIC XX.
  5355
  5356         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5357
  5358         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5359             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5360             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5361             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5362         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5363         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5364         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 100
* EL050.cbl
  5365         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5366             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5367             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5368         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5369         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5370         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5371             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5372         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5373
  5374         16  CF-CL-ZIP-CODE.
  5375             20  CF-CL-ZIP-PRIME.
  5376                 24  CF-CL-ZIP-1ST          PIC X.
  5377                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5378                 24  FILLER                 PIC X(4).
  5379             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5380         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5381             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5382             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5383             20  FILLER                     PIC XXX.
  5384
  5385         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5386         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5387         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5388         16  CF-CO-OPTION-START-DATE        PIC XX.
  5389         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5390           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5391                                                      '3' '4'.
  5392           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5393           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5394           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5395           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5396           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5397           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5398
  5399         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5400
  5401         16  CF-PAYMENT-APPROVAL-LEVELS.
  5402             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5403             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5404             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5405             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5406             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5407             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5408
  5409         16  CF-END-USER-REPORTING-USER     PIC X.
  5410             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5411             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5412
  5413         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5414             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5415             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5416
  5417         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5418
  5419         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5420         16  FILLER                         PIC X.
  5421
  5422         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 101
* EL050.cbl
  5423             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5424             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5425             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5426
  5427         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5428
  5429         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5430             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5431             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5432
  5433         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5434             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5435             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5436
  5437         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5438
  5439         16  CF-CO-ACH-ID-CODE              PIC  X.
  5440             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5441             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5442             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5443         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5444         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5445         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5446         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5447         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5448         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5449         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5450         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5451         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5452                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5453         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5454                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5455
  5456         16  CF-CO-OVER-SHORT.
  5457             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5458             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5459
  5460*         16  FILLER                         PIC X(102).
  5461         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5462             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5463             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5464
  5465         16  CF-AH-APPROVAL-DAYS.
  5466             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5467             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5468             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5469             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5470
  5471         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5472
  5473         16  CF-APPROV-LEV-5.
  5474             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5475             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5476             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5477
  5478         16  FILLER                         PIC X(68).
  5479****************************************************************
  5480*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 102
* EL050.cbl
  5481****************************************************************
  5482
  5483     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5484         16  CF-PROCESSOR-NAME              PIC X(30).
  5485         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5486         16  CF-PROCESSOR-TITLE             PIC X(26).
  5487         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5488                 88  MESSAGE-YES                VALUE 'Y'.
  5489                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5490
  5491*****************************************************
  5492****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5493****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5494****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5495****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5496*****************************************************
  5497
  5498         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5499             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5500             20  CF-APPLICATION-FORCE       PIC X.
  5501             20  CF-INDIVIDUAL-APP.
  5502                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5503                     28  CF-BROWSE-APP      PIC X.
  5504                     28  CF-UPDATE-APP      PIC X.
  5505
  5506         16  CF-CURRENT-TERM-ON             PIC X(4).
  5507         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5508             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5509             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5510             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5511             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5512             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5513             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5514             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5515         16  CF-PROCESSOR-CARRIER           PIC X.
  5516             88  NO-CARRIER-SECURITY            VALUE ' '.
  5517         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5518             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5519         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5520             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5521         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5522             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5523
  5524         16  CF-PROC-SYS-ACCESS-SW.
  5525             20  CF-PROC-CREDIT-CLAIMS-SW.
  5526                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5527                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5528                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5529                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5530             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5531                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5532                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5533             20  CF-PROC-LIFE-GNRLDGR-SW.
  5534                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5535                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5536                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5537                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5538             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 103
* EL050.cbl
  5539                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5540                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5541         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5542             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5543             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5544         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5545
  5546         16  CF-APPROVAL-LEVEL                  PIC X.
  5547             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5548             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5549             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5550             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5551             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5552
  5553         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5554
  5555         16  CF-LANGUAGE-TYPE                   PIC X.
  5556             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5557             88  CF-LANG-IS-FR                      VALUE 'F'.
  5558
  5559         16  CF-CSR-IND                         PIC X.
  5560         16  FILLER                             PIC X(239).
  5561
  5562****************************************************************
  5563*             PROCESSOR/REMINDERS RECORD                       *
  5564****************************************************************
  5565
  5566     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5567         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5568             20  CF-START-REMIND-DT         PIC XX.
  5569             20  CF-END-REMIND-DT           PIC XX.
  5570             20  CF-REMINDER-TEXT           PIC X(50).
  5571         16  FILLER                         PIC X(296).
  5572
  5573
  5574****************************************************************
  5575*             STATE MASTER RECORD                              *
  5576****************************************************************
  5577
  5578     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5579         16  CF-STATE-ABBREVIATION          PIC XX.
  5580         16  CF-STATE-NAME                  PIC X(25).
  5581         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5582         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5583             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5584             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5585             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5586             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5587                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5588                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5589             20  CF-ST-PREM-REJECT-SW       PIC X.
  5590                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5591                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5592             20  CF-ST-REF-REJECT-SW        PIC X.
  5593                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5594                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5595         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5596         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 104
* EL050.cbl
  5597         16  CF-ST-REFUND-RULES.
  5598             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5599             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5600             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5601         16  CF-ST-FST-PMT-EXTENSION.
  5602             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5603             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5604                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5605                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5606                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5607                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5608         16  CF-ST-STATE-CALL.
  5609             20  CF-ST-CALL-UNEARNED        PIC X.
  5610             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5611             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5612         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5613             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5614             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5615         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5616         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5617         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5618         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5619         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5620         16  FILLER                         PIC X.
  5621         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5622             20  CF-ST-BENEFIT-CD           PIC XX.
  5623             20  CF-ST-BENEFIT-KIND         PIC X.
  5624                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5625                 88  CF-ST-AH-KIND              VALUE 'A'.
  5626             20  CF-ST-REM-TERM-CALC        PIC X.
  5627                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5628                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5629                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5630                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5631                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5632                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5633                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5634                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5635
  5636             20  CF-ST-REFUND-CALC          PIC X.
  5637                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5638                 88  ST-REFD-BY-R78             VALUE '1'.
  5639                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5640                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5641                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5642                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5643                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5644                 88  ST-REFD-UTAH               VALUE '7'.
  5645                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5646                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5647                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5648
  5649             20  CF-ST-EARNING-CALC         PIC X.
  5650                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5651                 88  ST-EARN-BY-R78             VALUE '1'.
  5652                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5654                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 105
* EL050.cbl
  5655                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5657                 88  ST-EARN-MEAN               VALUE '8'.
  5658                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5659
  5660             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5661                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5662                 88  ST-OVRD-BY-R78             VALUE '1'.
  5663                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5664                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5665                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5666                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5667                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5668                 88  ST-OVRD-MEAN               VALUE '8'.
  5669                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5670             20  cf-st-extra-periods        pic 9.
  5671*            20  FILLER                     PIC X.
  5672
  5673         16  CF-ST-COMMISSION-CAPS.
  5674             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5675             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5676             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5677             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5678         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5679                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5680
  5681         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5682
  5683         16  CF-ST-STATUTORY-INTEREST.
  5684             20  CF-ST-STAT-DATE-FROM       PIC X.
  5685                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5686                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5687             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5688             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5689             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5690             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5691             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5692
  5693         16  CF-ST-OVER-SHORT.
  5694             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5695             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5696
  5697         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5698
  5699         16  CF-ST-RT-CALC                  PIC X.
  5700
  5701         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5702         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5703         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5704         16  CF-ST-RF-LR-CALC               PIC X.
  5705         16  CF-ST-RF-LL-CALC               PIC X.
  5706         16  CF-ST-RF-LN-CALC               PIC X.
  5707         16  CF-ST-RF-AH-CALC               PIC X.
  5708         16  CF-ST-RF-CP-CALC               PIC X.
  5709*        16  FILLER                         PIC X(206).
  5710*CIDMOD         16  FILLER                         PIC X(192).
  5711         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5712             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 106
* EL050.cbl
  5713         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5714         16  CF-ST-VFY-2ND-BENE             PIC X.
  5715         16  CF-ST-CAUSAL-STATE             PIC X.
  5716         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5717         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5718         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5719             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5720         16  CF-ST-NET-ONLY-STATE           PIC X.
  5721             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5722         16  FILLER                         PIC X(181).
  5723
  5724****************************************************************
  5725*             BENEFIT MASTER RECORD                            *
  5726****************************************************************
  5727
  5728     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5729         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5730             20  CF-BENEFIT-CODE            PIC XX.
  5731             20  CF-BENEFIT-NUMERIC  REDEFINES
  5732                 CF-BENEFIT-CODE            PIC XX.
  5733             20  CF-BENEFIT-ALPHA           PIC XXX.
  5734             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5735             20  CF-BENEFIT-COMMENT         PIC X(10).
  5736
  5737             20  CF-LF-COVERAGE-TYPE        PIC X.
  5738                 88  CF-REDUCING                VALUE 'R'.
  5739                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5740
  5741             20  CF-SPECIAL-CALC-CD         PIC X.
  5742                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5743                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5744                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5745                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5746                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5747                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5748                 88  CF-FARM-PLAN               VALUE 'F'.
  5749                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5750                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5751                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5752                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5753                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5754                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5755                 88  CF-PRUDENTIAL              VALUE 'P'.
  5756                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5757                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5758                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5759                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5760                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5761                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5762
  5763             20  CF-JOINT-INDICATOR         PIC X.
  5764                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5765
  5766*            20  FILLER                     PIC X(12).
  5767             20  cf-maximum-benefits        pic s999 comp-3.
  5768             20  FILLER                     PIC X(09).
  5769             20  CF-BENEFIT-CATEGORY        PIC X.
  5770             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 107
* EL050.cbl
  5771
  5772             20  CF-CO-REM-TERM-CALC        PIC X.
  5773                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5774                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5775                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5776                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5777                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5778
  5779             20  CF-CO-EARNINGS-CALC        PIC X.
  5780                 88  CO-EARN-BY-R78             VALUE '1'.
  5781                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5782                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5783                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5784                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5785                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5786                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5787                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5788
  5789             20  CF-CO-REFUND-CALC          PIC X.
  5790                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5791                 88  CO-REFD-BY-R78             VALUE '1'.
  5792                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5793                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5794                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5795                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5796                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5797                 88  CO-REFD-MEAN               VALUE '8'.
  5798                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5799                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5800                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5801
  5802             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5803                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5804                 88  CO-OVRD-BY-R78             VALUE '1'.
  5805                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5807                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-OVRD-MEAN               VALUE '8'.
  5811                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5812
  5813             20  CF-CO-BEN-I-G-CD           PIC X.
  5814                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5815                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5816                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5817
  5818         16  FILLER                         PIC X(304).
  5819
  5820
  5821****************************************************************
  5822*             CARRIER MASTER RECORD                            *
  5823****************************************************************
  5824
  5825     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5826         16  CF-ADDRESS-DATA.
  5827             20  CF-MAIL-TO-NAME            PIC X(30).
  5828             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 108
* EL050.cbl
  5829             20  CF-ADDRESS-LINE-1          PIC X(30).
  5830             20  CF-ADDRESS-LINE-2          PIC X(30).
  5831             20  CF-CITY-STATE              PIC X(30).
  5832             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5833             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5834
  5835         16  CF-CLAIM-NO-CONTROL.
  5836             20  CF-CLAIM-NO-METHOD         PIC X.
  5837                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5838                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5839                 88  CLAIM-NO-SEQ               VALUE '3'.
  5840                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5841             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5842                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5843                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5844                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5845
  5846         16  CF-CHECK-NO-CONTROL.
  5847             20  CF-CHECK-NO-METHOD         PIC X.
  5848                 88  CHECK-NO-MANUAL            VALUE '1'.
  5849                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5850                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5851                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5852             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5853                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5854
  5855         16  CF-DOMICILE-STATE              PIC XX.
  5856
  5857         16  CF-EXPENSE-CONTROLS.
  5858             20  CF-EXPENSE-METHOD          PIC X.
  5859                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5860                 88  DOLLARS-PER-PMT            VALUE '2'.
  5861                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5862                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5863             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5864             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5865
  5866         16  CF-CORRESPONDENCE-CONTROL.
  5867             20  CF-LETTER-RESEND-OPT       PIC X.
  5868                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5869                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5870             20  FILLER                     PIC X(4).
  5871
  5872         16  CF-RESERVE-CONTROLS.
  5873             20  CF-MANUAL-SW               PIC X.
  5874                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5875             20  CF-FUTURE-SW               PIC X.
  5876                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5877             20  CF-PTC-SW                  PIC X.
  5878                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5879             20  CF-IBNR-SW                 PIC X.
  5880                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5881             20  CF-PTC-LF-SW               PIC X.
  5882                 88  CF-LF-PTC-USED             VALUE '1'.
  5883             20  CF-CDT-ACCESS-METHOD       PIC X.
  5884                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5885                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5886                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 109
* EL050.cbl
  5887             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5888
  5889         16  CF-CLAIM-CALC-METHOD           PIC X.
  5890             88  360-PLUS-MONTHS                VALUE '1'.
  5891             88  365-PLUS-MONTHS                VALUE '2'.
  5892             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5893             88  360-DAILY                      VALUE '4'.
  5894             88  365-DAILY                      VALUE '5'.
  5895
  5896         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5897         16  FILLER                         PIC X(11).
  5898
  5899         16  CF-LIMIT-AMOUNTS.
  5900             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5901             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5902             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5903             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5904             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5905             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5906             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5907             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5908             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5909             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5910
  5911         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5912         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5913         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5914
  5915         16  CF-ZIP-CODE.
  5916             20  CF-ZIP-PRIME.
  5917                 24  CF-ZIP-1ST             PIC X.
  5918                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5919                 24  FILLER                 PIC X(4).
  5920             20  CF-ZIP-PLUS4               PIC X(4).
  5921         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5922             20  CF-CAN-POSTAL-1            PIC XXX.
  5923             20  CF-CAN-POSTAL-2            PIC XXX.
  5924             20  FILLER                     PIC XXX.
  5925
  5926         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5927         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5928         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5929
  5930         16  CF-RATING-SWITCH               PIC X.
  5931             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5932             88  CF-NO-RATING                   VALUE 'N'.
  5933
  5934         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5935
  5936         16  CF-CARRIER-OVER-SHORT.
  5937             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5938             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5939
  5940         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5941         16  CF-SECPAY-SWITCH               PIC X.
  5942             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5943             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5944         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 110
* EL050.cbl
  5945         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5946         16  FILLER                         PIC X(444).
  5947*        16  FILLER                         PIC X(452).
  5948
  5949
  5950****************************************************************
  5951*             MORTALITY MASTER RECORD                          *
  5952****************************************************************
  5953
  5954     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5955         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5956                                INDEXED BY CF-MORT-NDX.
  5957             20  CF-MORT-TABLE              PIC X(5).
  5958             20  CF-MORT-TABLE-TYPE         PIC X.
  5959                 88  CF-MORT-JOINT              VALUE 'J'.
  5960                 88  CF-MORT-SINGLE             VALUE 'S'.
  5961                 88  CF-MORT-COMBINED           VALUE 'C'.
  5962                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5963                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5964             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5965             20  CF-MORT-AGE-METHOD         PIC XX.
  5966                 88  CF-AGE-LAST                VALUE 'AL'.
  5967                 88  CF-AGE-NEAR                VALUE 'AN'.
  5968             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5969             20  CF-MORT-ADJUSTMENT-DIRECTION
  5970                                            PIC X.
  5971                 88  CF-MINUS                   VALUE '-'.
  5972                 88  CF-PLUS                    VALUE '+'.
  5973             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5974             20  CF-MORT-JOINT-CODE         PIC X.
  5975                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5976             20  CF-MORT-PC-Q               PIC X.
  5977                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5978             20  CF-MORT-TABLE-CODE         PIC X(4).
  5979             20  CF-MORT-COMMENTS           PIC X(15).
  5980             20  FILLER                     PIC X(14).
  5981
  5982         16  FILLER                         PIC X(251).
  5983
  5984
  5985****************************************************************
  5986*             BUSSINESS TYPE MASTER RECORD                     *
  5987****************************************************************
  5988
  5989     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5990* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5991* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5992* AND RECORD 05 IS TYPES 81-99
  5993         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5994             20  CF-BUSINESS-TITLE          PIC  X(19).
  5995             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5996                                            PIC S9V9(4) COMP-3.
  5997             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5998             20  FILLER                     PIC  X.
  5999         16  FILLER                         PIC  X(248).
  6000
  6001
  6002****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 111
* EL050.cbl
  6003*             TERMINAL MASTER RECORD                           *
  6004****************************************************************
  6005
  6006     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6007
  6008         16  CF-COMPANY-TERMINALS.
  6009             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6010                                  PIC X(4).
  6011         16  FILLER               PIC X(248).
  6012
  6013
  6014****************************************************************
  6015*             LIFE EDIT MASTER RECORD                          *
  6016****************************************************************
  6017
  6018     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6019         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6020             20  CF-LIFE-CODE-IN            PIC XX.
  6021             20  CF-LIFE-CODE-OUT           PIC XX.
  6022         16  FILLER                         PIC X(248).
  6023
  6024
  6025****************************************************************
  6026*             AH EDIT MASTER RECORD                            *
  6027****************************************************************
  6028
  6029     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6030         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6031             20  CF-AH-CODE-IN              PIC XXX.
  6032             20  CF-AH-CODE-OUT             PIC XX.
  6033         16  FILLER                         PIC X(248).
  6034
  6035
  6036****************************************************************
  6037*             CREDIBILITY TABLES                               *
  6038****************************************************************
  6039
  6040     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6041         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6042                             INDEXED BY CF-CRDB-NDX.
  6043             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6044             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6045             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6046         16  FILLER                         PIC  X(332).
  6047
  6048
  6049****************************************************************
  6050*             REPORT CUSTOMIZATION RECORD                      *
  6051****************************************************************
  6052
  6053     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6054         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6055             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6056             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6057             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6058**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6059****       A T-TRANSFER.                                   ****
  6060             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 112
* EL050.cbl
  6061
  6062         16  FILLER                         PIC XX.
  6063
  6064         16  CF-CARRIER-CNTL-OPT.
  6065             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6066                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6067                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6068             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6069                                            PIC X.
  6070         16  CF-GROUP-CNTL-OPT.
  6071             20  CF-GROUP-OPT-SEQ           PIC 9.
  6072                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6073                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6074             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6075                                            PIC X(6).
  6076         16  CF-STATE-CNTL-OPT.
  6077             20  CF-STATE-OPT-SEQ           PIC 9.
  6078                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6079                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6080             20  CF-STATE-SELECT OCCURS 3 TIMES
  6081                                            PIC XX.
  6082         16  CF-ACCOUNT-CNTL-OPT.
  6083             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6084                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6085                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6086             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6087                                            PIC X(10).
  6088         16  CF-BUS-TYP-CNTL-OPT.
  6089             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6090                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6091                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6092             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6093                                            PIC XX.
  6094         16  CF-LF-TYP-CNTL-OPT.
  6095             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6096                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6097                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6098             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6099                                            PIC XX.
  6100         16  CF-AH-TYP-CNTL-OPT.
  6101             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6102                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6103                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6104             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6105                                            PIC XX.
  6106         16  CF-REPTCD1-CNTL-OPT.
  6107             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6108                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6109                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6110             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112         16  CF-REPTCD2-CNTL-OPT.
  6113             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6114                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6115                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6116             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6117                                            PIC X(10).
  6118         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 113
* EL050.cbl
  6119             20  CF-USER1-OPT-SEQ           PIC 9.
  6120                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6121                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6122             20  CF-USER1-SELECT OCCURS 3 TIMES
  6123                                            PIC X(10).
  6124         16  CF-USER2-CNTL-OPT.
  6125             20  CF-USER2-OPT-SEQ           PIC 9.
  6126                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6127                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6128             20  CF-USER2-SELECT OCCURS 3 TIMES
  6129                                            PIC X(10).
  6130         16  CF-USER3-CNTL-OPT.
  6131             20  CF-USER3-OPT-SEQ           PIC 9.
  6132                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6133                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6134             20  CF-USER3-SELECT OCCURS 3 TIMES
  6135                                            PIC X(10).
  6136         16  CF-USER4-CNTL-OPT.
  6137             20  CF-USER4-OPT-SEQ           PIC 9.
  6138                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6139                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6140             20  CF-USER4-SELECT OCCURS 3 TIMES
  6141                                            PIC X(10).
  6142         16  CF-USER5-CNTL-OPT.
  6143             20  CF-USER5-OPT-SEQ           PIC 9.
  6144                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6145                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6146             20  CF-USER5-SELECT OCCURS 3 TIMES
  6147                                            PIC X(10).
  6148         16  CF-REINS-CNTL-OPT.
  6149             20  CF-REINS-OPT-SEQ           PIC 9.
  6150                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6151                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6152             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6153                 24  CF-REINS-PRIME         PIC XXX.
  6154                 24  CF-REINS-SUB           PIC XXX.
  6155
  6156         16  CF-AGENT-CNTL-OPT.
  6157             20  CF-AGENT-OPT-SEQ           PIC 9.
  6158                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6159                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6160             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6161                                            PIC X(10).
  6162
  6163         16  FILLER                         PIC X(43).
  6164
  6165         16  CF-LOSS-RATIO-SELECT.
  6166             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6167             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6168         16  CF-ENTRY-DATE-SELECT.
  6169             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6170             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6171         16  CF-EFFECTIVE-DATE-SELECT.
  6172             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6173             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6174
  6175         16  CF-EXCEPTION-LIST-IND          PIC X.
  6176             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 114
* EL050.cbl
  6177
  6178         16  FILLER                         PIC X(318).
  6179
  6180****************************************************************
  6181*                  EXCEPTION REPORTING RECORD                  *
  6182****************************************************************
  6183
  6184     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6185         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6186             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6187
  6188         16  CF-COMBINED-LIFE-AH-OPT.
  6189             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6190             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6191             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6192             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6193
  6194         16  CF-LIFE-OPT.
  6195             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6196             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6197             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6198             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6199             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6200             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6203             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6204             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6205
  6206         16  CF-AH-OPT.
  6207             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6208             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6209             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6210             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6211             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6215             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6216             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6217
  6218         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6219             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6220             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6221             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6222
  6223         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6224
  6225         16  FILLER                         PIC X(673).
  6226
  6227
  6228****************************************************************
  6229*             MORTGAGE SYSTEM PLAN RECORD                      *
  6230****************************************************************
  6231
  6232     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6233         16  CF-PLAN-TYPE                   PIC X.
  6234             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 115
* EL050.cbl
  6235             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6236             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6237         16  CF-PLAN-ABBREV                 PIC XXX.
  6238         16  CF-PLAN-DESCRIPT               PIC X(10).
  6239         16  CF-PLAN-NOTES                  PIC X(20).
  6240         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6241         16  CF-PLAN-UNDERWRITING.
  6242             20  CF-PLAN-TERM-DATA.
  6243                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6244                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6245             20  CF-PLAN-AGE-DATA.
  6246                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6247                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6248                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6249             20  CF-PLAN-BENEFIT-DATA.
  6250                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6251                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6252                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6253                                            PIC S9(7)V99  COMP-3.
  6254         16  CF-PLAN-POLICY-FORMS.
  6255             20  CF-POLICY-FORM             PIC X(12).
  6256             20  CF-MASTER-APPLICATION      PIC X(12).
  6257             20  CF-MASTER-POLICY           PIC X(12).
  6258         16  CF-PLAN-RATING.
  6259             20  CF-RATE-CODE               PIC X(5).
  6260             20  CF-SEX-RATING              PIC X.
  6261                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6262                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6263             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6264             20  CF-SUB-STD-TYPE            PIC X.
  6265                 88  CF-PCT-OF-PREM            VALUE '1'.
  6266                 88  CF-PCT-OF-BENE            VALUE '2'.
  6267         16  CF-PLAN-PREM-TOLERANCES.
  6268             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6269             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6270         16  CF-PLAN-PYMT-TOLERANCES.
  6271             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6272             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6273         16  CF-PLAN-MISC-DATA.
  6274             20  FILLER                     PIC X.
  6275             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6276             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6277         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6278         16  CF-PLAN-IND-GRP                PIC X.
  6279             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6280                                                     '1'.
  6281             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6282                                                     '2'.
  6283         16  CF-MIB-SEARCH-SW               PIC X.
  6284             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6285             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6286             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6287             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6288         16  CF-ALPHA-SEARCH-SW             PIC X.
  6289             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6290             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6291             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6292             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 116
* EL050.cbl
  6293             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6294             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6295             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6296             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6297             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6298             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6299                                                     'A' 'B' 'C'
  6300                                                     'X' 'Y' 'Z'.
  6301         16  CF-EFF-DT-RULE-SW              PIC X.
  6302             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6303             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6304             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6305             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6306             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6307         16  FILLER                         PIC X(4).
  6308         16  CF-HEALTH-QUESTIONS            PIC X.
  6309             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6310         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6311         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6312         16  CF-PLAN-SNGL-JNT               PIC X.
  6313             88  CF-COMBINED-PLAN              VALUE 'C'.
  6314             88  CF-JNT-PLAN                   VALUE 'J'.
  6315             88  CF-SNGL-PLAN                  VALUE 'S'.
  6316         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6317         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6318         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6319         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6320         16  CF-RERATE-CNTL                 PIC  X.
  6321             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6322             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6323             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6324             88  CF-AUTO-RECALC                 VALUE '4'.
  6325         16  CF-BENEFIT-TYPE                PIC  X.
  6326             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6327             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6328         16  CF-POLICY-FEE                  PIC S999V99
  6329                                                    COMP-3.
  6330         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6331         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6332         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6333         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6334         16  FILLER                         PIC  X(32).
  6335         16  CF-TERMINATION-FORM            PIC  X(04).
  6336         16  FILLER                         PIC  X(08).
  6337         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6338                                                       COMP-3.
  6339         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6340         16  CF-ISSUE-LETTER                PIC  X(4).
  6341         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6342         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6343             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6344             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6345         16  CF-MP-REFUND-CALC              PIC X.
  6346             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6347             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6348             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6349             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6350             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 117
* EL050.cbl
  6351             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6352             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6353             88  CF-MP-REFD-MEAN                VALUE '8'.
  6354         16  CF-ALT-RATE-CODE               PIC  X(5).
  6355
  6356
  6357         16  FILLER                         PIC X(498).
  6358****************************************************************
  6359*             MORTGAGE COMPANY MASTER RECORD                   *
  6360****************************************************************
  6361
  6362     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6363         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6364         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6365             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6366             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6367             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6368             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6369             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6370
  6371         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6372         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6373         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6374         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6375         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6376
  6377         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6378             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6379         16  CF-MP-RECON-USE-IND            PIC X(1).
  6380             88  CF-MP-USE-RECON             VALUE 'Y'.
  6381         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6382             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6383         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6384             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6385             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6386         16  FILLER                         PIC X(1).
  6387         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6388             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6389         16  CF-MORTG-MIB-VERSION           PIC X.
  6390             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6391             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6392             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6393         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6394             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6395                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6396             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6397                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6398             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6399                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6400             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6401                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6402             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6403                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6404             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6405                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6406         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6407         16  FILLER                         PIC X(7).
  6408         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 118
* EL050.cbl
  6409             20  CF-MORTG-MIB-COMM          PIC X(5).
  6410             20  CF-MORTG-MIB-TERM          PIC X(5).
  6411         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6412             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6413         16  FILLER                         PIC X(03).
  6414         16  CF-MP-CHECK-NO-CONTROL.
  6415             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6416                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6417                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6418                                                ' ' LOW-VALUES.
  6419                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6420                                               VALUE '3'.
  6421         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6422         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6423         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6424             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6425                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6426             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6427                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6428             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6429                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6430             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6431                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6432             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6433                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6434             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6435                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6436         16  CF-MORTG-BILLING-AREA.
  6437             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6438                                            PIC X.
  6439         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6440         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6441         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6442         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6443             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6444             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6445         16  FILLER                         PIC X.
  6446         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6447             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6448             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6449         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6450         16  FILLER                         PIC X(8).
  6451         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6452         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6453         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6454         16  CF-ACH-COMPANY-ID.
  6455             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6456                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6457                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6458                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6459             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6460         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6461             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6462         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6463             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6464             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6465         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6466         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 119
* EL050.cbl
  6467         16  FILLER                         PIC X(536).
  6468
  6469****************************************************************
  6470*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6471****************************************************************
  6472
  6473     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6474         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6475             20  CF-FEMALE-HEIGHT.
  6476                 24  CF-FEMALE-FT           PIC 99.
  6477                 24  CF-FEMALE-IN           PIC 99.
  6478             20  CF-FEMALE-MIN-WT           PIC 999.
  6479             20  CF-FEMALE-MAX-WT           PIC 999.
  6480         16  FILLER                         PIC X(428).
  6481
  6482     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6483         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6484             20  CF-MALE-HEIGHT.
  6485                 24  CF-MALE-FT             PIC 99.
  6486                 24  CF-MALE-IN             PIC 99.
  6487             20  CF-MALE-MIN-WT             PIC 999.
  6488             20  CF-MALE-MAX-WT             PIC 999.
  6489         16  FILLER                         PIC X(428).
  6490******************************************************************
  6491*             AUTOMATIC ACTIVITY RECORD                          *
  6492******************************************************************
  6493     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6494         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6495             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6496             20  CF-SYS-LETTER-ID           PIC X(04).
  6497             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6498             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6499             20  CF-SYS-RESET-SW            PIC X(01).
  6500             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6501             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6502
  6503         16  FILLER                         PIC X(50).
  6504
  6505         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6506             20  CF-USER-ACTIVE-SW          PIC X(01).
  6507             20  CF-USER-LETTER-ID          PIC X(04).
  6508             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6509             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6510             20  CF-USER-RESET-SW           PIC X(01).
  6511             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6512             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6513             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6514
  6515         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 120
* EL050.cbl
  6517*    COPY ERCACCT.
  6518******************************************************************
  6519*                                                                *
  6520*                                                                *
  6521*                            ERCACCT                             *
  6522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6523*                            VMOD=2.031                          *
  6524*                                                                *
  6525*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6526*                                                                *
  6527*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6528*   VSAM ACCOUNT MASTER FILES.                                   *
  6529*                                                                *
  6530*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6531*                                                                *
  6532*   FILE TYPE = VSAM,KSDS                                        *
  6533*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6534*                                                                *
  6535*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6536*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6537*                                                                *
  6538*   LOG = NO                                                     *
  6539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6540*                                                                *
  6541*                                                                *
  6542******************************************************************
  6543*                   C H A N G E   L O G
  6544*
  6545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6546*-----------------------------------------------------------------
  6547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6548* EFFECTIVE    NUMBER
  6549*-----------------------------------------------------------------
  6550* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6551* 092705    2005050300006  PEMA  ADD SPP LEASES
  6552* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6553* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6554* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6555* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6556* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6557******************************************************************
  6558
  6559 01  ACCOUNT-MASTER.
  6560     12  AM-RECORD-ID                      PIC XX.
  6561         88  VALID-AM-ID                      VALUE 'AM'.
  6562
  6563     12  AM-CONTROL-PRIMARY.
  6564         16  AM-COMPANY-CD                 PIC X.
  6565         16  AM-MSTR-CNTRL.
  6566             20  AM-CONTROL-A.
  6567                 24  AM-CARRIER            PIC X.
  6568                 24  AM-GROUPING.
  6569                     28 AM-GROUPING-PREFIX PIC XXX.
  6570                     28 AM-GROUPING-PRIME  PIC XXX.
  6571                 24  AM-STATE              PIC XX.
  6572                 24  AM-ACCOUNT.
  6573                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6574                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 121
* EL050.cbl
  6575             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6576                                           PIC X(19).
  6577             20  AM-CNTRL-B.
  6578                 24  AM-EXPIRATION-DT      PIC XX.
  6579                 24  FILLER                PIC X(4).
  6580             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6581                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6582
  6583     12  AM-CONTROL-BY-VAR-GRP.
  6584         16  AM-COMPANY-CD-A1              PIC X.
  6585         16  AM-VG-CARRIER                 PIC X.
  6586         16  AM-VG-GROUPING                PIC X(6).
  6587         16  AM-VG-STATE                   PIC XX.
  6588         16  AM-VG-ACCOUNT                 PIC X(10).
  6589         16  AM-VG-DATE.
  6590             20  AM-VG-EXPIRATION-DT       PIC XX.
  6591             20  FILLER                    PIC X(4).
  6592         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6593                                           PIC 9(11)      COMP-3.
  6594     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6595         16  FILLER                        PIC X(10).
  6596         16  AM-VG-KEY3.
  6597             20  AM-VG3-ACCOUNT            PIC X(10).
  6598             20  AM-VG3-EXP-DT             PIC XX.
  6599         16  FILLER                        PIC X(4).
  6600     12  AM-MAINT-INFORMATION.
  6601         16  AM-LAST-MAINT-DT              PIC XX.
  6602         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6603         16  AM-LAST-MAINT-USER            PIC X(4).
  6604         16  FILLER                        PIC XX.
  6605
  6606     12  AM-EFFECTIVE-DT                   PIC XX.
  6607     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6608
  6609     12  AM-PREV-DATES  COMP-3.
  6610         16  AM-PREV-EXP-DT                PIC 9(11).
  6611         16  AM-PREV-EFF-DT                PIC 9(11).
  6612
  6613     12  AM-REPORT-CODE-1                  PIC X(10).
  6614     12  AM-REPORT-CODE-2                  PIC X(10).
  6615
  6616     12  AM-CITY-CODE                      PIC X(4).
  6617     12  AM-COUNTY-PARISH                  PIC X(6).
  6618
  6619     12  AM-NAME                           PIC X(30).
  6620     12  AM-PERSON                         PIC X(30).
  6621     12  AM-ADDRS                          PIC X(30).
  6622     12  AM-CITY.
  6623         16  AM-ADDR-CITY                  PIC X(28).
  6624         16  AM-ADDR-STATE                 PIC XX.
  6625     12  AM-ZIP.
  6626         16  AM-ZIP-PRIME.
  6627             20  AM-ZIP-PRI-1ST            PIC X.
  6628                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-ZIP-PLUS4                  PIC X(4).
  6631     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6632         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 122
* EL050.cbl
  6633         16  AM-CAN-POSTAL-2               PIC XXX.
  6634         16  FILLER                        PIC XXX.
  6635     12  AM-TEL-NO.
  6636         16  AM-AREA-CODE                  PIC 999.
  6637         16  AM-TEL-PRE                    PIC 999.
  6638         16  AM-TEL-NBR                    PIC 9(4).
  6639     12  AM-TEL-LOC                        PIC X.
  6640         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6641         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6642
  6643     12  AM-COMM-STRUCTURE.
  6644         16  AM-DEFN-1.
  6645             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6646                 24  AM-AGT.
  6647                     28  AM-AGT-PREFIX     PIC X(4).
  6648                     28  AM-AGT-PRIME      PIC X(6).
  6649                 24  AM-COM-TYP            PIC X.
  6650                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6651                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6652                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6653                 24  AM-RECALC-LV-INDIC    PIC X.
  6654                 24  AM-RETRO-LV-INDIC     PIC X.
  6655                 24  AM-GL-CODES           PIC X.
  6656                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6657                 24  FILLER                PIC X(01).
  6658         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6659             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6660                 24  FILLER                PIC X(11).
  6661                 24  AM-L-COMA             PIC XXX.
  6662                 24  AM-J-COMA             PIC XXX.
  6663                 24  AM-A-COMA             PIC XXX.
  6664                 24  FILLER                PIC X(6).
  6665
  6666     12  AM-COMM-CHANGE-STATUS             PIC X.
  6667         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6668
  6669     12  AM-CSR-CODE                       PIC X(4).
  6670
  6671     12  AM-BILLING-STATUS                 PIC X.
  6672         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6673         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6674     12  AM-AUTO-REFUND-SW                 PIC X.
  6675         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6676         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6677     12  AM-GPCD                           PIC 99.
  6678     12  AM-IG                             PIC X.
  6679         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6680         88  AM-HAS-GROUP                     VALUE '2'.
  6681     12  AM-STATUS                         PIC X.
  6682         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6683         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6684         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6685         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6686         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6687         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6688     12  AM-REMIT-TO                       PIC 99.
  6689     12  AM-ID-NO                          PIC X(11).
  6690
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 123
* EL050.cbl
  6691     12  AM-CAL-TABLE                      PIC XX.
  6692     12  AM-LF-DEVIATION                   PIC XXX.
  6693     12  AM-AH-DEVIATION                   PIC XXX.
  6694     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6695     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6696     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6697     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6698     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6699     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6700
  6701     12  AM-USER-FIELDS.
  6702         16  AM-FLD-1                      PIC XX.
  6703         16  AM-FLD-2                      PIC XX.
  6704         16  AM-FLD-3                      PIC XX.
  6705         16  AM-FLD-4                      PIC XX.
  6706         16  AM-FLD-5                      PIC XX.
  6707
  6708     12  AM-1ST-PROD-DATE.
  6709         16  AM-1ST-PROD-YR                PIC XX.
  6710         16  AM-1ST-PROD-MO                PIC XX.
  6711         16  AM-1ST-PROD-DA                PIC XX.
  6712     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6713     12  AM-CERTS-PURGED-DATE.
  6714         16  AM-PUR-YR                     PIC XX.
  6715         16  AM-PUR-MO                     PIC XX.
  6716         16  AM-PUR-DA                     PIC XX.
  6717     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6718     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6719     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6720     12  AM-INACTIVE-DATE.
  6721         16  AM-INA-MO                     PIC 99.
  6722         16  AM-INA-DA                     PIC 99.
  6723         16  AM-INA-YR                     PIC 99.
  6724     12  AM-AR-HI-CERT-DATE                PIC XX.
  6725
  6726     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6727     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6728
  6729     12  AM-OB-PAYMENT-MODE                PIC X.
  6730         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6731         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6732         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6733         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6734
  6735     12  AM-AH-ONLY-INDICATOR              PIC X.
  6736         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6737         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6738
  6739     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6740
  6741     12  AM-OVER-SHORT.
  6742         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6743         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6744
  6745     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6746     12  AM-DCC-CLP-STATE                  PIC XX.
  6747
  6748     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 124
* EL050.cbl
  6749     12  AM-RECALC-REIN                    PIC X.
  6750
  6751     12  AM-REI-TABLE                      PIC XXX.
  6752     12  AM-REI-ET-LF                      PIC X.
  6753     12  AM-REI-ET-AH                      PIC X.
  6754     12  AM-REI-PE-LF                      PIC X.
  6755     12  AM-REI-PE-AH                      PIC X.
  6756     12  AM-REI-PRT-ST                     PIC X.
  6757     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6758     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6759     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6760     12  AM-REI-GROUP-A                    PIC X(6).
  6761     12  AM-REI-MORT                       PIC X(4).
  6762     12  AM-REI-PRT-OW                     PIC X.
  6763     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6764     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6765     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6766     12  AM-REI-GROUP-B                    PIC X(6).
  6767
  6768     12  AM-TRUST-TYPE                     PIC X(2).
  6769
  6770     12  AM-EMPLOYER-STMT-USED             PIC X.
  6771     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6772
  6773     12  AM-STD-AH-TYPE                    PIC XX.
  6774     12  AM-EARN-METHODS.
  6775         16  AM-EARN-METHOD-R              PIC X.
  6776             88 AM-REF-RL-R78                 VALUE 'R'.
  6777             88 AM-REF-RL-PR                  VALUE 'P'.
  6778             88 AM-REF-RL-MEAN                VALUE 'M'.
  6779             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6780         16  AM-EARN-METHOD-L              PIC X.
  6781             88 AM-REF-LL-R78                 VALUE 'R'.
  6782             88 AM-REF-LL-PR                  VALUE 'P'.
  6783             88 AM-REF-LL-MEAN                VALUE 'M'.
  6784             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6785         16  AM-EARN-METHOD-A              PIC X.
  6786             88 AM-REF-AH-R78                 VALUE 'R'.
  6787             88 AM-REF-AH-PR                  VALUE 'P'.
  6788             88 AM-REF-AH-MEAN                VALUE 'M'.
  6789             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6790             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6791             88 AM-REF-AH-NET                 VALUE 'N'.
  6792
  6793     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6794     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6795     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6796
  6797     12  AM-RET-Y-N                        PIC X.
  6798     12  AM-RET-P-E                        PIC X.
  6799     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6800     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6801     12  AM-RET-GRP                        PIC X(6).
  6802     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6803         16  AM-POOL-PRIME                 PIC XXX.
  6804         16  AM-POOL-SUB                   PIC XXX.
  6805     12  AM-RETRO-EARNINGS.
  6806         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 125
* EL050.cbl
  6807         16  AM-RET-EARN-L                 PIC X.
  6808         16  AM-RET-EARN-A                 PIC X.
  6809     12  AM-RET-ST-TAX-USE                 PIC X.
  6810         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6811         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6812     12  AM-RETRO-BEG-EARNINGS.
  6813         16  AM-RET-BEG-EARN-R             PIC X.
  6814         16  AM-RET-BEG-EARN-L             PIC X.
  6815         16  AM-RET-BEG-EARN-A             PIC X.
  6816     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6817     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6818
  6819     12  AM-USER-SELECT-OPTIONS.
  6820         16  AM-USER-SELECT-1              PIC X(10).
  6821         16  AM-USER-SELECT-2              PIC X(10).
  6822         16  AM-USER-SELECT-3              PIC X(10).
  6823         16  AM-USER-SELECT-4              PIC X(10).
  6824         16  AM-USER-SELECT-5              PIC X(10).
  6825
  6826     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6827
  6828     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6829
  6830     12  AM-RPT045A-SWITCH                 PIC X.
  6831         88  RPT045A-OFF                   VALUE 'N'.
  6832
  6833     12  AM-INSURANCE-LIMITS.
  6834         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6835         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6836
  6837     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6838         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6839
  6840     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6841         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6842         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6843
  6844     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6845
  6846     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6847     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6848     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6849     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6850     12  AM-DCC-UEF-STATE                  PIC XX.
  6851     12  FILLER                            PIC XXX.
  6852     12  AM-REPORT-CODE-3                  PIC X(10).
  6853*    12  FILLER                            PIC X(22).
  6854
  6855     12  AM-RESERVE-DATE.
  6856         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6857         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6858         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6859
  6860     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6861     12  AM-NOTIFICATION-TYPES.
  6862         16  AM-NOTIF-OF-LETTERS           PIC X.
  6863         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6864         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 126
* EL050.cbl
  6865         16  AM-NOTIF-OF-STATUS            PIC X.
  6866
  6867     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6868         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6869         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6870         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6871         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6872
  6873     12  AM-BENEFIT-CONTROLS.
  6874         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6875             20  AM-BENEFIT-CODE           PIC XX.
  6876             20  AM-BENEFIT-TYPE           PIC X.
  6877             20  AM-BENEFIT-REVISION       PIC XXX.
  6878             20  AM-BENEFIT-REM-TERM       PIC X.
  6879             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6880             20  FILLER                    PIC XX.
  6881         16  FILLER                        PIC X(80).
  6882
  6883     12  AM-TRANSFER-DATA.
  6884         16  AM-TRANSFERRED-FROM.
  6885             20  AM-TRNFROM-CARRIER        PIC X.
  6886             20  AM-TRNFROM-GROUPING.
  6887                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6888                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6889             20  AM-TRNFROM-STATE          PIC XX.
  6890             20  AM-TRNFROM-ACCOUNT.
  6891                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6892                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6893             20  AM-TRNFROM-DTE            PIC XX.
  6894         16  AM-TRANSFERRED-TO.
  6895             20  AM-TRNTO-CARRIER          PIC X.
  6896             20  AM-TRNTO-GROUPING.
  6897                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6898                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6899             20  AM-TRNTO-STATE            PIC XX.
  6900             20  AM-TRNTO-ACCOUNT.
  6901                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6902                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6903             20  AM-TRNTO-DTE              PIC XX.
  6904         16  FILLER                        PIC X(10).
  6905
  6906     12  AM-SAVED-REMIT-TO                 PIC 99.
  6907
  6908     12  AM-COMM-STRUCTURE-SAVED.
  6909         16  AM-DEFN-1-SAVED.
  6910             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6911                 24  AM-AGT-SV             PIC X(10).
  6912                 24  AM-COM-TYP-SV         PIC X.
  6913                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6914                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6915                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6916                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6917                 24  FILLER                PIC X.
  6918                 24  AM-GL-CODES-SV        PIC X.
  6919                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6920                 24  FILLER                PIC X.
  6921         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6922             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 127
* EL050.cbl
  6923                 24  FILLER                PIC X(11).
  6924                 24  AM-L-COMA-SV          PIC XXX.
  6925                 24  AM-J-COMA-SV          PIC XXX.
  6926                 24  AM-A-COMA-SV          PIC XXX.
  6927                 24  FILLER                PIC X(6).
  6928
  6929     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6930         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6931            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6932            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6933            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6934
  6935     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6936     12  FILLER                            PIC X(120).
  6937
  6938     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6939         16  AM-CONTROL-NAME               PIC X(30).
  6940         16  AM-EXECUTIVE-ONE.
  6941             20  AM-EXEC1-NAME             PIC X(15).
  6942             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6943                                                          COMP-3.
  6944             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6945                                                          COMP-3.
  6946         16  AM-EXECUTIVE-TWO.
  6947             20  AM-EXEC2-NAME             PIC X(15).
  6948             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6949                                                          COMP-3.
  6950             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6951                                                          COMP-3.
  6952
  6953     12  AM-RETRO-ADDITIONAL-DATA.
  6954         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6955         16  AM-RETRO-PREM-P-E             PIC X.
  6956         16  AM-RETRO-CLMS-P-I             PIC X.
  6957         16  AM-RETRO-RET-BRACKET-LF.
  6958             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6959                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6960                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6961             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6962                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6963                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6964             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6965                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6966                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6967         16  AM-RETRO-RET-BRACKET-AH.
  6968             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6969                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6970                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6971                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6972             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6973                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6974                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6975             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6976                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6977                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6978
  6979     12  AM-COMMENTS.
  6980         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 128
* EL050.cbl
  6981
  6982     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6983         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6984         16  AM-FLI-BILLING-CODE           PIC X.
  6985         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6986         16  AM-FLI-UNITED-IDENT           PIC X.
  6987         16  AM-FLI-INTEREST-LOST-DATA.
  6988             20  AM-FLI-BANK-NO            PIC X(5).
  6989             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6990             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6991             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6992         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6993             20  AM-FLI-AGT                PIC X(9).
  6994             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6995             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6996         16  FILLER                        PIC X(102).
  6997
  6998     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6999         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7000             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7001             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7002             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7003             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7004             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7005         16  FILLER                          PIC X(10).
  7006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 129
* EL050.cbl
  7008*    COPY ERCREIN.
  7009******************************************************************
  7010*                                                                *
  7011*                            ERCREIN                             *
  7012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7013*                            VMOD=2.010                          *
  7014*                                                                *
  7015*   ONLINE CREDIT SYSTEM                                         *
  7016*                                                                *
  7017*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7018*                                                                *
  7019*   FILE TYPE = VSAM,KSDS                                        *
  7020*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7021*                                                                *
  7022*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7023*       ALTERNATE PATH = NONE                                    *
  7024*                                                                *
  7025*   LOG = NO                                                     *
  7026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7027*                                                                *
  7028******************************************************************
  7029*                   C H A N G E   L O G
  7030*
  7031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7032*-----------------------------------------------------------------
  7033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7034* EFFECTIVE    NUMBER
  7035*-----------------------------------------------------------------
  7036* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7037* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7038******************************************************************
  7039 01  REINSURANCE-RECORD.
  7040     12  RE-RECORD-ID                      PIC XX.
  7041         88  VALID-RE-ID                      VALUE 'RE'.
  7042
  7043     12  RE-CONTROL-PRIMARY.
  7044         16  RE-COMPANY-CD                 PIC X.
  7045         16  RE-KEY.
  7046             20  RE-CODE                   PIC X.
  7047                 88  RE-TABLE-RECORD          VALUE 'A'.
  7048                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7049             20  RE-TABLE                  PIC XXX.
  7050             20  FILLER                    PIC XXX.
  7051         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7052             20  FILLER                    PIC X.
  7053             20  RE-COMPANY.
  7054                 24  RE-COMP-PRIME         PIC XXX.
  7055                 24  RE-COMP-SUB           PIC XXX.
  7056
  7057     12  RE-MAINT-INFORMATION.
  7058         16  RE-LAST-MAINT-DT              PIC XX.
  7059         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7060         16  RE-LAST-MAINT-USER            PIC X(4).
  7061         16  FILLER                        PIC X(10).
  7062
  7063     12  RE-TABLE-DATA.
  7064         16  RE-100-COMP                   PIC 99.
  7065
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 130
* EL050.cbl
  7066         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7067             20  RE-REI-COMP-NO.
  7068                 24  RE-REI-COMP           PIC XXX.
  7069                 24  RE-REI-COMP-SUB       PIC XXX.
  7070             20  RE-LF-QC                  PIC X.
  7071             20  RE-AH-QC                  PIC X.
  7072             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7073             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7074             20  RE-LFAGE-LO               PIC 99.
  7075             20  RE-LFAGE-HI               PIC 99.
  7076             20  RE-AHAGE-LO               PIC 99.
  7077             20  RE-AHAGE-HI               PIC 99.
  7078             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7079             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7080             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7081             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7082             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7083             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7084             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7085             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7086             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7087             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7088             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7089             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7090             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7091             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7092             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7093             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7094             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7095             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7096             20  RE-LF-BEN-CODE            PIC X.
  7097             20  RE-AH-BEN-CODE            PIC X.
  7098             20  RE-INTERACTIVE            PIC X.
  7099             20  RE-REMAINING              PIC X.
  7100             20  RE-LF-RUNOFF-SW           PIC X.
  7101             20  RE-AH-RUNOFF-SW           PIC X.
  7102             20  FILLER                    PIC X(19).
  7103
  7104         16  RE-COMP-INFO-END              PIC X(6).
  7105         16  RE-NSP-ST-CD-LF               PIC XX.
  7106         16  RE-NSP-ST-CD-AH               PIC XX.
  7107         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7108             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7109
  7110         16  FILLER                        PIC X(27).
  7111
  7112     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7113         16  RE-NAME                       PIC X(30).
  7114         16  RE-LF-PE                      PIC X.
  7115         16  RE-AH-PE                      PIC X.
  7116         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7117         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7118         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7119         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7120         16  RE-PRT-ST                     PIC X.
  7121         16  RE-PRT-OW                     PIC X.
  7122         16  RE-MORT-CODE                  PIC X(4).
  7123         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 131
* EL050.cbl
  7124         16  RE-ZERO-LF-FEE                PIC X.
  7125         16  RE-ZERO-AH-FEE                PIC X.
  7126         16  RE-CEDE-NAME                  PIC X(30).
  7127         16  RE-LF-COMM                    PIC X.
  7128         16  RE-AH-COMM                    PIC X.
  7129         16  RE-LF-TAX                     PIC X.
  7130         16  RE-AH-TAX                     PIC X.
  7131         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7132         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7133         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7134
  7135         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7136             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7137
  7138         16  RE-LF-CEDING-FEE-BRACKETS.
  7139             20  RE-LF-FEE-METHOD          PIC X.
  7140                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7141                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7142                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7143                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7144             20  RE-LF-FEE-BASIS           PIC X.
  7145                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7146                 88  RE-LF-NET-CEDED               VALUE '2'.
  7147                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7148                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7149                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7150                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7151                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7152                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7153             20  FILLER                    PIC XXX.
  7154             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7155                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7156                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7157
  7158         16  RE-AH-CEDING-FEE-BRACKETS.
  7159             20  RE-AH-FEE-METHOD          PIC X.
  7160                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7161                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7162                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7163                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7164             20  RE-AH-FEE-BASIS           PIC X.
  7165                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7166                 88  RE-AH-NET-CEDED               VALUE '2'.
  7167                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7168                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7169                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7170                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7171                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7172                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7173             20  FILLER                    PIC XXX.
  7174             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7175                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7176                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7177
  7178         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7179
  7180         16  RE-OLD-CEDING-STMT            PIC X.
  7181
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 132
* EL050.cbl
  7182         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7183         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7184         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7185         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7186         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7187         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7188         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7189         16  RE-MORT-SW                    PIC X.
  7190         16  RE-CEDING-TYPE-FLAG           PIC X.
  7191             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7192             88  RE-CEDED                          VALUE 'C'.
  7193             88  RE-ASSUMED                        VALUE 'A'.
  7194             88  RE-PHANTOM                        VALUE 'P'.
  7195
  7196         16  RE-CEDING-STMT-OPT-A          PIC X.
  7197             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7198         16  RE-CEDING-STMT-OPT-B          PIC X.
  7199             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7200         16  RE-CEDING-STMT-OPT-C          PIC X.
  7201             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7202         16  RE-CEDING-STMT-OPT-D          PIC X.
  7203             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7204         16  RE-CEDING-STMT-OPT-E          PIC X.
  7205             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7206
  7207         16  RE-PRT-CRSV                   PIC X.
  7208
  7209         16  RE-GL-CENTER                  PIC X(4).
  7210
  7211         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7212
  7213         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7214
  7215         16  RE-EARN-STOP-CODE             PIC X.
  7216             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7217             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7218
  7219         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7220             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7221
  7222         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7223         16  FILLER                        PIC X(2281).
  7224
  7225         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7226
  7227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 133
* EL050.cbl
  7229*    COPY ERCCTBL.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ERCCTBL                             *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.003
  7236*                                                                *
  7237*   ONLINE CREDIT SYSTEM                                         *
  7238*                                                                *
  7239*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7240*                                                                *
  7241*   FILE TYPE = VSAM,KSDS                                        *
  7242*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7243*                                                                *
  7244*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7245*       ALTERNATE PATH = NONE                                    *
  7246*                                                                *
  7247*   LOG = NO                                                     *
  7248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7249*                                                                *
  7250*                                                                *
  7251******************************************************************
  7252
  7253 01  COMM-TABLE-RECORD.
  7254     12  CT-RECORD-ID                      PIC XX.
  7255         88  VALID-CT-ID                      VALUE 'CT'.
  7256
  7257     12  CT-CONTROL-PRIMARY.
  7258         16  CT-COMPANY-CD                 PIC X.
  7259         16  CT-TABLE                      PIC XXX.
  7260         16  CT-CNTRL-2.
  7261             20  CT-BEN-TYPE               PIC X.
  7262             20  CT-BEN-CODE               PIC XX.
  7263
  7264     12  CT-MAINT-INFORMATION.
  7265         16  CT-LAST-MAINT-DT              PIC XX.
  7266         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7267         16  CT-LAST-MAINT-USER            PIC X(4).
  7268         16  FILLER                        PIC X(31).
  7269
  7270     12  CT-LIMITS.
  7271         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7272
  7273         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7274
  7275         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7276
  7277     12  CT-RATES.
  7278         16  CT-RTX          OCCURS 27 TIMES.
  7279             20  CT-RT                     PIC SV9(5)     COMP-3.
  7280             20  CT-RT-R   REDEFINES
  7281                 CT-RT                     PIC XXX.
  7282
  7283     12  FILLER                            PIC  X(42).
  7284
  7285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 134
* EL050.cbl
  7287*    COPY ERCFORM.
  7288******************************************************************
  7289*                                                                *
  7290*                                                                *
  7291*                            ERCFORM.                            *
  7292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7293*                            VMOD=2.003                          *
  7294*                                                                *
  7295*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7296*                                                                *
  7297*    FILE TYPE = VSAM,KSDS                                       *
  7298*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7299*                                                                *
  7300*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7301*                                                                *
  7302*    LOG = YES                                                   *
  7303*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7304******************************************************************
  7305 01  FORM-MASTER.
  7306    12  FO-RECORD-ID                 PIC X(02).
  7307        88  VALID-FO-ID                  VALUE 'FO'.
  7308
  7309    12  FO-CONTROL-PRIMARY.
  7310        16  FO-COMPANY-CD            PIC X(01).
  7311        16  FO-STATE                 PIC X(02).
  7312        16  FO-FORM-ID               PIC X(12).
  7313        16  FO-FORM-EXP-DT           PIC X(02).
  7314
  7315    12  FO-POLICY-FORM-DATA.
  7316        16  FO-IND-GRP-CD            PIC X(01).
  7317        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7318        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7319        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7320        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7321        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7322        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7323        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7324        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7325        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7326        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7327        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7328        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7329        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7330        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7331        16  FO-APP-CERT-USE-CD       PIC X(01).
  7332
  7333    12  FILLER                       PIC X(29).
  7334
  7335    12  FO-FORM-PLAN-TABLE.
  7336        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7337            20  FO-PLAN-TYPE         PIC X(01).
  7338            20  FO-PLAN-ID           PIC X(02).
  7339            20  FO-PLAN-TERM         PIC 9(03).
  7340            20  FO-PLAN-REFUND-METHOD
  7341                                     PIC X.
  7342
  7343    12  FILLER                       PIC X(30).
  7344
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 135
* EL050.cbl
  7345    12  FO-COMMENTS-AREA.
  7346        16  FO-COMMENT-LINE-1        PIC X(78).
  7347
  7348    12  FILLER                       PIC X(20).
  7349
  7350    12  FO-MAINT-INFORMATION.
  7351        16  FO-LAST-MAINT-DT         PIC X(02).
  7352        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7353        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 136
* EL050.cbl
  7355*    COPY ELCMSTR.
  7356******************************************************************
  7357*                                                                *
  7358*                            ELCMSTR.                            *
  7359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7360*                            VMOD=2.012                          *
  7361*                                                                *
  7362*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7363*                                                                *
  7364*   FILE TYPE = VSAM,KSDS                                        *
  7365*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7366*                                                                *
  7367*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7368*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7369*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7370*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7371*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7372*                                                 RKP=75,LEN=21  *
  7373*                                                                *
  7374*   **** NOTE ****                                               *
  7375*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7376*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7377*                                                                *
  7378*   LOG = YES                                                    *
  7379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7380******************************************************************
  7381*                   C H A N G E   L O G
  7382*
  7383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7384*-----------------------------------------------------------------
  7385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7386* EFFECTIVE    NUMBER
  7387*-----------------------------------------------------------------
  7388* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7389* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7390* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7391* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7392* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7393******************************************************************
  7394 01  CLAIM-MASTER.
  7395     12  CL-RECORD-ID                PIC XX.
  7396         88  VALID-CL-ID         VALUE 'CL'.
  7397
  7398     12  CL-CONTROL-PRIMARY.
  7399         16  CL-COMPANY-CD           PIC X.
  7400         16  CL-CARRIER              PIC X.
  7401         16  CL-CLAIM-NO             PIC X(7).
  7402         16  CL-CERT-NO.
  7403             20  CL-CERT-PRIME       PIC X(10).
  7404             20  CL-CERT-SFX         PIC X.
  7405
  7406     12  CL-CONTROL-BY-NAME.
  7407         16  CL-COMPANY-CD-A1        PIC X.
  7408         16  CL-INSURED-LAST-NAME    PIC X(15).
  7409         16  CL-INSURED-NAME.
  7410             20  CL-INSURED-1ST-NAME PIC X(12).
  7411             20  CL-INSURED-MID-INIT PIC X.
  7412
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 137
* EL050.cbl
  7413     12  CL-CONTROL-BY-SSN.
  7414         16  CL-COMPANY-CD-A2        PIC X.
  7415         16  CL-SOC-SEC-NO.
  7416             20  CL-SSN-STATE        PIC XX.
  7417             20  CL-SSN-ACCOUNT      PIC X(6).
  7418             20  CL-SSN-LN3          PIC X(3).
  7419
  7420     12  CL-CONTROL-BY-CERT-NO.
  7421         16  CL-COMPANY-CD-A4        PIC X.
  7422         16  CL-CERT-NO-A4.
  7423             20  CL-CERT-A4-PRIME    PIC X(10).
  7424             20  CL-CERT-A4-SFX      PIC X.
  7425
  7426     12  CL-CONTROL-BY-CCN.
  7427         16  CL-COMPANY-CD-A5        PIC X.
  7428         16  CL-CCN-A5.
  7429             20  CL-CCN.
  7430                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7431                 24  CL-CCN-PRIME-A5 PIC X(12).
  7432             20  CL-CCN-FILLER-A5    PIC X(4).
  7433
  7434     12  CL-INSURED-PROFILE-DATA.
  7435         16  CL-INSURED-BIRTH-DT     PIC XX.
  7436         16  CL-INSURED-SEX-CD       PIC X.
  7437             88  INSURED-IS-MALE        VALUE 'M'.
  7438             88  INSURED-IS-FEMALE      VALUE 'F'.
  7439             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7440         16  CL-INSURED-OCC-CD       PIC X(6).
  7441         16  FILLER                  PIC X(5).
  7442
  7443     12  CL-PROCESSING-INFO.
  7444         16  CL-PROCESSOR-ID         PIC X(4).
  7445         16  CL-CLAIM-STATUS         PIC X.
  7446             88  CLAIM-IS-OPEN          VALUE 'O'.
  7447             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7448         16  CL-CLAIM-TYPE           PIC X.
  7449*            88  AH-CLAIM               VALUE 'A'.
  7450*            88  LIFE-CLAIM             VALUE 'L'.
  7451*            88  PROPERTY-CLAIM         VALUE 'P'.
  7452*            88  IUI-CLAIM              VALUE 'I'.
  7453*            88  GAP-CLAIM              VALUE 'G'.
  7454*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7455         16  CL-CLAIM-PREM-TYPE      PIC X.
  7456             88  SINGLE-PREMIUM         VALUE '1'.
  7457             88  O-B-COVERAGE           VALUE '2'.
  7458             88  OPEN-END-COVERAGE      VALUE '3'.
  7459         16  CL-INCURRED-DT          PIC XX.
  7460         16  CL-REPORTED-DT          PIC XX.
  7461         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7462         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7463         16  CL-LAST-PMT-DT          PIC XX.
  7464         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7465         16  CL-PAID-THRU-DT         PIC XX.
  7466         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7467         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7468         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7469         16  CL-PMT-CALC-METHOD      PIC X.
  7470             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 138
* EL050.cbl
  7471             88  CL-365-DAY-YR          VALUE '2'.
  7472             88  CL-FULL-MONTHS         VALUE '3'.
  7473         16  CL-CAUSE-CD             PIC X(6).
  7474
  7475         16  CL-PRIME-CERT-NO.
  7476             20  CL-PRIME-CERT-PRIME PIC X(10).
  7477             20  CL-PRIME-CERT-SFX   PIC X.
  7478
  7479         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7480             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7481             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7482
  7483         16  CL-MICROFILM-NO         PIC X(10).
  7484         16  FILLER REDEFINES CL-MICROFILM-NO.
  7485             20  CL-BENEFIT-PERIOD   PIC 99.
  7486             20  FILLER              PIC X(8).
  7487         16  CL-PROG-FORM-TYPE       PIC X.
  7488         16  CL-LAST-ADD-ON-DT       PIC XX.
  7489
  7490         16  CL-LAST-REOPEN-DT       PIC XX.
  7491         16  CL-LAST-CLOSE-DT        PIC XX.
  7492         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7493             88  FINAL-PAID             VALUE '1'.
  7494             88  CLAIM-DENIED           VALUE '2'.
  7495             88  AUTO-CLOSE             VALUE '3'.
  7496             88  MANUAL-CLOSE           VALUE '4'.
  7497             88  BENEFITS-CHANGED       VALUE 'C'.
  7498             88  SETUP-ERRORS           VALUE 'E'.
  7499         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7500         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7501         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7502             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7503         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7504         16  FILLER                  PIC X.
  7505
  7506     12  CL-CERTIFICATE-DATA.
  7507         16  CL-CERT-ORIGIN          PIC X.
  7508             88  CERT-WAS-ONLINE        VALUE '1'.
  7509             88  CERT-WAS-CREATED       VALUE '2'.
  7510             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7511         16  CL-CERT-KEY-DATA.
  7512             20  CL-CERT-CARRIER     PIC X.
  7513             20  CL-CERT-GROUPING    PIC X(6).
  7514             20  CL-CERT-STATE       PIC XX.
  7515             20  CL-CERT-ACCOUNT.
  7516                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7517                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7518             20  CL-CERT-EFF-DT      PIC XX.
  7519
  7520     12  CL-STATUS-CONTROLS.
  7521         16  CL-PRIORITY-CD          PIC X.
  7522             88  CONFIDENTIAL-DATA      VALUE '8'.
  7523             88  HIGHEST-PRIORITY       VALUE '9'.
  7524         16  CL-SUPV-ATTN-CD         PIC X.
  7525             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7526             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7527         16  CL-PURGED-DT            PIC XX.
  7528         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 139
* EL050.cbl
  7529         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7530         16  CL-NEXT-RESEND-DT       PIC XX.
  7531         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7532         16  CL-CRITICAL-PERIOD      PIC 99.
  7533*        16  FILLER                  PIC XX.
  7534         16  CL-LAST-MAINT-DT        PIC XX.
  7535         16  CL-LAST-MAINT-USER      PIC X(4).
  7536         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7537         16  CL-LAST-MAINT-TYPE      PIC X.
  7538             88  CLAIM-SET-UP           VALUE ' '.
  7539             88  PAYMENT-MADE           VALUE '1'.
  7540             88  LETTER-SENT            VALUE '2'.
  7541             88  MASTER-WAS-ALTERED     VALUE '3'.
  7542             88  MASTER-WAS-RESTORED    VALUE '4'.
  7543             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7544             88  FILE-CONVERTED         VALUE '6'.
  7545             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7546             88  ERROR-CORRECTION       VALUE 'E'.
  7547         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7548         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7549         16  CL-BENEFICIARY          PIC X(10).
  7550         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7551         16  CL-DENIAL-TYPE          PIC X.
  7552             88  CL-TYPE-DENIAL          VALUE '1'.
  7553             88  CL-TYPE-RESCISSION      VALUE '2'.
  7554             88  CL-TYPE-REFORMATION     VALUE '3'.
  7555             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7556             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7557         16  filler                  pic x(5).
  7558*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7559*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7560*        16  CL-RTW-DT               PIC XX.
  7561
  7562     12  CL-TRAILER-CONTROLS.
  7563         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7564             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7565             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7566             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7567         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7568         16  FILLER                  PIC XX.
  7569         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7570         16  CL-ADDRESS-TRAILER-CNT.
  7571             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7572                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7573             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7574                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7575             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7576                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7577             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7578                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7579             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7580                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7581             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7582                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7583             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7584                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7585
  7586     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 140
* EL050.cbl
  7587         16  CL-CV-REFNO-PRIME       PIC X(18).
  7588         16  CL-CV-REFNO-SFX         PIC XX.
  7589
  7590     12  CL-FILE-LOCATION            PIC X(4).
  7591
  7592     12  CL-PROCESS-ERRORS.
  7593         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7594             88  NO-FATAL-ERRORS        VALUE ZERO.
  7595         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7596             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7597
  7598     12  CL-PRODUCT-CD               PIC X.
  7599
  7600     12  CL-CURRENT-KEY-DATA.
  7601         16  CL-CURRENT-CARRIER      PIC X.
  7602         16  CL-CURRENT-GROUPING     PIC X(6).
  7603         16  CL-CURRENT-STATE        PIC XX.
  7604         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7605
  7606     12  CL-ASSOCIATES               PIC X.
  7607         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7608         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7609         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7610         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7611
  7612     12  CL-ACTIVITY-CODE            PIC 99.
  7613     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7614     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7615
  7616     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7617     12  CL-LAG-REPORT-CODE          PIC 9.
  7618     12  CL-LOAN-TYPE                PIC XX.
  7619     12  CL-LEGAL-STATE              PIC XX.
  7620
  7621     12  CL-YESNOSW                  PIC X.
  7622     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7623         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7624         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7625         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7626     12  cl-insured-type             pic x.
  7627         88  cl-claim-on-primary         value 'P'.
  7628         88  cl-claim-on-co-borrower     value 'C'.
  7629     12  cl-benefit-expiration-dt    PIC XX.
  7630
  7631 01  PLAN-RECORDS.
  7632     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7633     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7634
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 141
* EL050.cbl
  7636 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7637                          ACCOUNT-MASTER REINSURANCE-RECORD
  7638                          COMM-TABLE-RECORD FORM-MASTER
  7639                          CLAIM-MASTER PLAN-RECORDS.
  7640 0000-DFHEXIT SECTION.
  7641     MOVE '9#                    $   ' TO DFHEIV0.
  7642     MOVE 'EL050' TO DFHEIV1.
  7643     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7644
  7645     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7646
  7647
  7648* EXEC CICS  HANDLE CONDITION
  7649*           ERROR    (9300-ABEND)
  7650*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7651*    END-EXEC.
  7652*    MOVE '"$.J                  ! " #00007643' TO DFHEIV0
  7653     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7655     MOVE X'2220233030303037363433' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660 0000-COPY-PROCEDURE-DIV.
  7661*                          COPY ELC50PD.
  7662******************************************************************
  7663*                                                                *
  7664*                            ELC50PD                             *
  7665*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7666*                            VMOD=2.188                          *
  7667*                                                                *
  7668******************************************************************
  7669*                   C H A N G E   L O G
  7670*
  7671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7672*-----------------------------------------------------------------
  7673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7674* EFFECTIVE    NUMBER
  7675*-----------------------------------------------------------------
  7676* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7677* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7678* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7679*                             2709 AND 2718
  7680* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7681* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7682* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7683* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7684* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7685*                                IS OPEN OR CNC DT < PD THRU
  7686* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7687* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7688* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7689* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7690* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7691* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7692* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7693* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 142
* EL050.cbl
  7694* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7695* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7696* 020906                   PEMA  EXPAND LOAN OFFICER
  7697* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7698* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7699* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7700* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7701* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7702* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7703* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7704* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7705* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7706* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7708* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7709* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7710* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7711* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7712* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7713* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7714* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7715* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7716* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7717* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7718* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7719* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7720* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7721* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7722*                                UPDATE VIN ON CERT TRAILER
  7723* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7724* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7725* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7726* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7727* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7728* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7729* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7730* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7731* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7732* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7733* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7734* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7735* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7736* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7737* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7738* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7739* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7740* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7741* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7742* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7743* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7744* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7745* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7746* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7747* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7748* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7749* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7750* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7751* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 143
* EL050.cbl
  7752* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7753* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7754* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7755* 032912  CR2011110200001  PEMA  AHL CHANGES
  7756* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7757* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7758* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7759* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7760* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7761* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7762* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7763* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7764* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7765* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7766* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7767* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7768* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7769* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7770* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7771* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7772* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7773* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7774* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7775* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7776* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7777* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7778* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7779* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7780* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7781* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7782* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7783*                                CERT #, ADD 2898 FORCIBLE ERROR
  7784* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7785* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7786* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7787* 121815  CR2015121700006  PEMA  ADD ERROR 3827 (foreign vin)
  7788******************************************************************
  7789************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7790******************************************************************
  7791
  7792     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7793
  7794     MOVE SPACES                 TO PB-FATAL-FLAG
  7795                                    PB-FORCE-ER-CD
  7796                                    PB-WARN-ER-CD
  7797                                    PB-OUT-BAL-CD.
  7798
  7799     MOVE SPACE                  TO WS-IG-OVRD-AH
  7800                                    WS-IG-OVRD-LF
  7801                                    WS-IG-OVRD-AM
  7802                                    WS-IG-OVRD
  7803                                    WS-IG-OVRD-AH-PL
  7804                                    WS-IG-OVRD-LF-PL
  7805                                    WS-IG-OVRD-AH-BEN
  7806                                    WS-IG-OVRD-LF-BEN.
  7807
  7808******************************************************************
  7809*************       INITIALIZE COMMON ERRORS       ***************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 144
* EL050.cbl
  7810******************************************************************
  7811
  7812     MOVE +0                     TO PB-NO-OF-ERRORS.
  7813     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7814
  7815******************************************************************
  7816
  7817     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7818     SET JULIAN-TO-BIN           TO TRUE.
  7819*    MOVE 5                      TO DC-OPTION-CODE.
  7820     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7821     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7822
  7823     MOVE ZERO                   TO  SUB4.
  7824
  7825 0040-INITIALIZE-GA-BILL-DT.
  7826
  7827     ADD +1                      TO  SUB4.
  7828
  7829     IF  SUB4 GREATER THAN +5
  7830         GO TO 0050-CHECK-CNTL-FOUND.
  7831
  7832     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7833         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7834
  7835     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7836
  7837 0050-CHECK-CNTL-FOUND.
  7838
  7839     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7840        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7841                                         WS-AH-REM-TERM-CALC
  7842                                         EC-CO-REM-TERM-CALC
  7843        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7844        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7845        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7846                                         WS-TOL-AH-CLAIM
  7847        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7848                                         WS-TOL-AH-PREM
  7849                                         EC-CO-TOL-PREM
  7850        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7851                                         WS-TOL-AH-REFUND
  7852                                         EC-CO-TOL-REFUND
  7853        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7854                                         WS-AH-REFUND-OVS-AMT
  7855                                         EC-CO-OVR-SHT-AMT
  7856        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7857                                         WS-TOL-AH-PREM-PCT
  7858                                         EC-CO-TOL-PREM-PCT
  7859        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7860                                         WS-TOL-AH-REFUND-PCT
  7861                                         EC-CO-TOL-REFUND-PCT
  7862        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7863                                         WS-AH-REFUND-OVS-PCT
  7864                                         EC-CO-OVR-SHT-PCT
  7865        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7866        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7867        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 145
* EL050.cbl
  7868        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7869        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7870        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7871        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7872        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7873        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7874        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7875        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7876        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7877                                         EC-CO-MONTH-END-DT
  7878        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7879          GO TO 0100-READ-ACCT.
  7880
  7881     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7882     MOVE SPACES                 TO CNTL-ACCESS.
  7883     MOVE '1'                    TO CNTL-REC-TYPE.
  7884     MOVE +0                     TO CNTL-SEQ-NO.
  7885
  7886     MOVE '1' TO RC-SW-1.
  7887     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7888     IF NOT CF-COMPANY-MASTER
  7889         MOVE ZEROS             TO WK-CO-TOL-PREM
  7890                                   WK-CO-TOL-CLAIM
  7891                                   WK-CO-TOL-REFUND
  7892                                   WK-REFUND-OVS-AMT
  7893                                   WK-REFUND-OVS-PCT
  7894                                   WK-CO-TOL-PREM-PCT
  7895                                   WK-CO-TOL-REFUND-PCT
  7896                                   WK-DEFAULT-APR
  7897                                   WK-CO-MAX-CAP
  7898        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7899                                   WK-CR-R78-METHOD
  7900                                   WK-CO-REF-REJECT-SW
  7901                                   WK-CO-PREM-REJECT-SW
  7902                                   WK-REM-TRM-CALC-OPTION
  7903                                   WK-BIRTH-DATE-INPUT
  7904                                   WK-JOINT-AGE-INPUT
  7905        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7906        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7907        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7908        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7909          GO TO 0099-COMPANY-NOT-FOUND.
  7910
  7911     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7912        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7913     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7914        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7915     IF CF-CO-TOL-CAP NOT NUMERIC
  7916        MOVE +0                    TO CF-CO-TOL-CAP.
  7917     IF CF-DEFAULT-APR NOT NUMERIC
  7918        MOVE +0                    TO CF-DEFAULT-APR.
  7919
  7920     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7921     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7922     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7923     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7924     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7925     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 146
* EL050.cbl
  7926     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7927     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7928     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7929     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7930     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7931     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7932
  7933     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7934          CF-CO-OVR-SHT-AMT > +0
  7935        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7936
  7937     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7938          CF-CO-OVR-SHT-PCT > +0
  7939        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7940
  7941     IF CF-VALID-REM-TRM-OPTION
  7942         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7943     ELSE
  7944         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7945
  7946     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7947     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7948     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7949     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7950
  7951     GO TO 0050-CHECK-CNTL-FOUND.
  7952
  7953 0099-COMPANY-NOT-FOUND.
  7954
  7955     MOVE ER-2616                TO WS-ERROR.
  7956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7957
  7958 0100-READ-ACCT.
  7959
  7960     MOVE SPACES                 TO DATE-RANGE-SW.
  7961
  7962     IF WK-ACCT-ADDR = ZEROS
  7963        GO TO 0102-ACCT-GETMAIN.
  7964
  7965     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7966     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7967     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7968
  7969     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7970        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7971        GO TO 0105-READ-ACCT
  7972     END-IF
  7973
  7974     IF PB-CARRIER NOT = SPACES
  7975        IF PB-CARRIER NOT = AM-VG-CARRIER
  7976           GO TO 0105-READ-ACCT.
  7977
  7978     IF PB-STATE NOT = SPACES
  7979        IF PB-STATE NOT = AM-VG-STATE
  7980           GO TO 0105-READ-ACCT.
  7981
  7982     IF PB-GROUPING NOT = SPACES
  7983        IF PB-GROUPING NOT = AM-VG-GROUPING
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 147
* EL050.cbl
  7984           GO TO 0105-READ-ACCT.
  7985
  7986     MOVE 'X'                 TO DATE-RANGE-SW.
  7987
  7988     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7989        MOVE 'X'                 TO DATE-RANGE-SW
  7990        GO TO 0105-READ-ACCT.
  7991
  7992     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7993        GO TO 0105-READ-ACCT.
  7994
  7995     GO TO 0180-ACCOUNT-FOUND.
  7996
  7997 0102-ACCT-GETMAIN.
  7998     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7999     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8000
  8001 0105-READ-ACCT.
  8002     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8003     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8004     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8005     MOVE PB-STATE               TO ACCT-STATE.
  8006     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8007     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8008
  8009     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8010
  8011     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8012
  8013 0110-FIND-ACCT-TOLERANCES-LOOP.
  8014     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8015
  8016     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8017        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8018        GO TO 0199-ACCT-NOT-FOUND
  8019     END-IF
  8020     IF PB-CARRIER NOT = SPACES
  8021        IF PB-CARRIER NOT = AM-VG-CARRIER
  8022           GO TO 0199-ACCT-NOT-FOUND.
  8023
  8024     IF PB-STATE NOT = SPACES
  8025        IF PB-STATE NOT = AM-VG-STATE
  8026           GO TO 0199-ACCT-NOT-FOUND.
  8027
  8028     IF PB-GROUPING NOT = SPACES
  8029        IF PB-GROUPING NOT = AM-VG-GROUPING
  8030           GO TO 0199-ACCT-NOT-FOUND.
  8031
  8032     MOVE 'X'                    TO DATE-RANGE-SW.
  8033
  8034     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8035        MOVE 'X'                 TO DATE-RANGE-SW
  8036        GO TO 0199-ACCT-NOT-FOUND.
  8037
  8038     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8039        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8040
  8041 0180-ACCOUNT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 148
* EL050.cbl
  8042     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8043     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8044     MOVE AM-STATE               TO PB-SV-STATE.
  8045     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8046
  8047     IF AM-CANCEL-FEE  NOT NUMERIC
  8048        MOVE ZEROS TO AM-CANCEL-FEE.
  8049
  8050     IF AM-MAX-MON-BEN NOT NUMERIC
  8051        MOVE ZEROS TO AM-MAX-MON-BEN.
  8052
  8053     IF AM-MAX-TOT-BEN NOT NUMERIC
  8054        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8055
  8056     IF AM-CLP-TOL-PCT NOT NUMERIC
  8057        MOVE +0                  TO AM-CLP-TOL-PCT
  8058     END-IF
  8059     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8060        MOVE +0                  TO AM-SPP-LEASE-COMM
  8061     END-IF
  8062     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8063        MOVE ER-2611             TO   WS-ERROR
  8064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8065
  8066     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8067        MOVE ER-2621             TO   WS-ERROR
  8068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8069
  8070     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8071        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8072        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8073        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8074         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8075
  8076     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8077     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8078     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8079     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8080     IF AM-CLP-TOL-PCT NOT = ZEROS
  8081        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8082     END-IF
  8083     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8084        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8085     END-IF
  8086*    IF PB-COMPANY-ID = 'DCC'
  8087*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8088*                                   WS-ADMIN-FEES
  8089*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8090*          (SUB5 > +10)
  8091*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8092*             AND (AM-A-COM (SUB5) NUMERIC)
  8093*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8094*                + (AM-A-COM (SUB5) * 1000)
  8095*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8096*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8097*                + (AM-A-COM (SUB5) * 1000)
  8098*             END-IF
  8099*             IF AM-COM-TYP (SUB5) = 'N'
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 149
* EL050.cbl
  8100*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8101*                + (AM-A-COM (SUB5) * 1000)
  8102*             END-IF
  8103*          END-IF
  8104*       END-PERFORM
  8105*    END-IF
  8106     IF (PB-COMPANY-ID = 'DCC')
  8107        AND (PB-ISSUE)
  8108        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8109                                    ws-cred-union-fees
  8110        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8111           (SUB5 > +10)
  8112           MOVE +0 TO WS-WK-RATE
  8113           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8114                                   'O' OR 'S')
  8115              IF (AM-A-COM (SUB5) NUMERIC)
  8116                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8117                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8118              ELSE
  8119                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8120                 IF PB-ISSUE
  8121                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8122                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8123                 ELSE
  8124                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8125                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8126                 END-IF
  8127                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8128                 MOVE ZEROS             TO WS-SUB1
  8129                                           WS-COMMISSION
  8130                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8131                 MOVE '0530'               TO CTBL-SW
  8132                 MOVE ' '                  TO WS-CTBL-READ-SW
  8133                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8134                 IF FIRST-TIME-THROUGH
  8135                    MOVE 'AA'              TO CTBL-BEN-CODE
  8136                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8137                 END-IF
  8138                 IF CTBL-TABLE-FOUND
  8139                    IF PB-ISSUE
  8140                       COMPUTE WS-COMM-CK-AMT =
  8141                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8142                    ELSE
  8143                       COMPUTE WS-COMM-CK-AMT =
  8144                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8145                    END-IF
  8146                    PERFORM 8800-GET-COMP-RATE
  8147                              THRU 8800-EXIT
  8148                 END-IF
  8149              END-IF
  8150              if am-com-typ (sub5) = 'O' or 'S'
  8151                 compute ws-cred-union-fees rounded =
  8152                    ws-cred-union-fees +
  8153                    (pb-i-ah-premium-amt * ws-wk-rate)
  8154              else
  8155                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8156                + (WS-WK-RATE * 1000)
  8157              end-if
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 150
* EL050.cbl
  8158           END-IF
  8159        END-PERFORM
  8160     END-IF
  8161     IF PB-COMPANY-ID EQUAL 'CRI'
  8162         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8163
  8164     IF PB-COMPANY-ID EQUAL 'NCL'
  8165         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8166     END-IF
  8167
  8168     GO TO 0200-READ-CERT.
  8169
  8170 0199-ACCT-NOT-FOUND.
  8171
  8172     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8173
  8174     IF DATE-RANGE-SW NOT = SPACES
  8175        MOVE ER-2601             TO WS-ERROR
  8176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8177     ELSE
  8178        MOVE ER-2619             TO WS-ERROR
  8179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8180
  8181     GO TO 9990-RETURN.
  8182
  8183 0200-READ-CERT.
  8184
  8185     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8186     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8187     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8188     MOVE PB-SV-STATE            TO CERT-STATE.
  8189     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8190     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8191     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8192
  8193     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8194
  8195     IF CERT-WAS-NOT-FOUND
  8196        GO TO 0299-CERT-NOT-FOUND.
  8197
  8198     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8199        MOVE ER-2759             TO WS-ERROR
  8200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201        GO TO 0298-UNLOCK-RETURN.
  8202
  8203     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8204         MOVE ER-2758            TO WS-ERROR
  8205         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8206         GO TO 0298-UNLOCK-RETURN.
  8207
  8208     IF PB-ISSUE
  8209        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8210           IF CERT-WAS-CREATED-FOR-CLAIM
  8211              NEXT SENTENCE
  8212            ELSE
  8213              MOVE ER-2626       TO WS-ERROR
  8214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8215              GO TO 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 151
* EL050.cbl
  8216
  8217     IF NOT PB-CANCELLATION
  8218        GO TO 0300-CONTINUE-EDIT.
  8219
  8220     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8221     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8222     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8223     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8224     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8225     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8226
  8227     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8228     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8229     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8230     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8231     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8232     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8233     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8234     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8235     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8236
  8237     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8238     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8239     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8240     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8241     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8242     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8243     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8244
  8245     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8246     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8247
  8248     MOVE CM-CREDIT-INTERFACE-SW-1
  8249                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8250     MOVE CM-CREDIT-INTERFACE-SW-2
  8251                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8252
  8253     IF CM-O-B-COVERAGE
  8254         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8255
  8256     IF CM-LIVES NOT NUMERIC
  8257         MOVE ZERO                TO CM-LIVES.
  8258
  8259     IF CM-BILLED NOT NUMERIC
  8260         MOVE ZERO                TO CM-BILLED.
  8261
  8262     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8263         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8264         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8265         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8266         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8267         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8268         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8269         MOVE CM-LIVES             TO PB-CI-LIVES
  8270*The next line causes a problem with my change  I dont think it is
  8271*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8272
  8273     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 152
* EL050.cbl
  8274     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8275     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8276     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8277     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8278     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8279
  8280     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8281     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8282     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8283     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8284
  8285     IF CM-LIFE-COMM-PCT NUMERIC
  8286         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8287     ELSE
  8288         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8289
  8290     IF CM-AH-COMM-PCT NUMERIC
  8291         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8292     ELSE
  8293         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8294
  8295     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8296
  8297     IF CM-LOAN-APR       NOT NUMERIC
  8298           MOVE ZERO               TO CM-LOAN-APR.
  8299
  8300     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8301           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8302
  8303     IF CM-LOAN-TERM      NOT NUMERIC
  8304           MOVE ZERO               TO CM-LOAN-TERM.
  8305
  8306     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8307           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8308
  8309     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8310           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8311
  8312     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8313     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8314     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8315     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8316     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8317     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8318     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8319     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8320     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8321     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8322     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8323     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8324
  8325     IF CM-STATE = CM-SSN-STATE
  8326         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8327
  8328     IF CM-STATE NOT = CM-MEMB-STATE
  8329         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8330
  8331     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 153
* EL050.cbl
  8332
  8333     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8334        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8335        IF CM-ADDL-CLP NOT NUMERIC
  8336           MOVE +0               TO CM-ADDL-CLP
  8337        END-IF
  8338        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8339        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8340           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8341        END-IF
  8342     END-IF
  8343     IF PB-COMPANY-ID = 'DCC'
  8344        MOVE +0                  TO WS-ADMIN-FEES
  8345                                    WS-CSO-ADMIN-FEE
  8346                                    WS-COMM-AND-MFEE
  8347                                    WS-1ST-YR-ALLOW
  8348        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8349           (SUB5 > +10)
  8350           MOVE +0 TO WS-WK-RATE
  8351           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8352              IF (AM-A-COM (SUB5) NUMERIC)
  8353                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8354                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8355              ELSE
  8356                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8357                 IF PB-ISSUE
  8358                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8359                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8360                 ELSE
  8361                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8362                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8363                 END-IF
  8364                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8365                 MOVE ZEROS             TO WS-SUB1
  8366                                           WS-COMMISSION
  8367                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8368                 MOVE '0530'               TO CTBL-SW
  8369                 MOVE ' '                  TO WS-CTBL-READ-SW
  8370                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8371                 IF FIRST-TIME-THROUGH
  8372                    MOVE 'AA'              TO CTBL-BEN-CODE
  8373                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8374                 END-IF
  8375                 IF CTBL-TABLE-FOUND
  8376                    IF PB-ISSUE
  8377                       COMPUTE WS-COMM-CK-AMT =
  8378                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8379                    ELSE
  8380                       COMPUTE WS-COMM-CK-AMT =
  8381                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8382                    END-IF
  8383                    PERFORM 8800-GET-COMP-RATE
  8384                              THRU 8800-EXIT
  8385                 END-IF
  8386              END-IF
  8387              IF AM-COM-TYP (SUB5) = 'I'
  8388                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8389                   + (WS-WK-RATE * 1000)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 154
* EL050.cbl
  8390              END-IF
  8391              IF AM-COM-TYP (SUB5) = 'N'
  8392                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8393                   + (WS-WK-RATE * 1000)
  8394              END-IF
  8395              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8396                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8397                   + (WS-WK-RATE * 1000)
  8398              END-IF
  8399              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8400                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8401                   + (WS-WK-RATE * 1000)
  8402              END-IF
  8403           END-IF
  8404        END-PERFORM
  8405     END-IF
  8406     GO TO 0300-CONTINUE-EDIT.
  8407
  8408 0298-UNLOCK-RETURN.
  8409      PERFORM 9250-UNLOCK-RETURN
  8410      GO TO 9990-RETURN.
  8411
  8412 0299-CERT-NOT-FOUND.
  8413
  8414     MOVE '1'                     TO CERT-STATUS-SW.
  8415
  8416     IF PB-COMPANY-ID = 'UCL'
  8417         IF WS-ERROR = ER-2799
  8418             GO TO 3000-CONTINUE-EDIT.
  8419
  8420     IF NOT PB-CANCELLATION
  8421         GO TO 0300-CONTINUE-EDIT.
  8422
  8423     MOVE ER-2726                  TO  WS-ERROR.
  8424     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8425     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8426     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8427                                    PB-CI-LF-TERM
  8428                                    PB-C-LF-REM-TERM
  8429                                    PB-CI-AH-TERM
  8430                                    PB-C-AH-REM-TERM
  8431                                    PB-CI-LF-BENEFIT-CD
  8432                                    PB-CI-LF-BENEFIT-AMT
  8433                                    PB-CI-LF-ALT-BENEFIT-AMT
  8434                                    PB-CI-LF-PREMIUM-AMT
  8435                                    PB-CI-LF-ALT-PREMIUM-AMT
  8436                                    PB-CI-AH-BENEFIT-CD
  8437                                    PB-CI-AH-BENEFIT-AMT
  8438                                    PB-CI-AH-PREMIUM-AMT
  8439                                    PB-CI-PAY-FREQUENCY
  8440                                    PB-CI-LOAN-APR
  8441                                    PB-CI-LOAN-TERM
  8442                                    PB-CI-LIFE-COMMISSION
  8443                                    PB-CI-AH-COMMISSION
  8444                                    PB-CI-CURR-SEQ
  8445                                    PB-CI-AH-CANCEL-AMT
  8446                                    PB-CI-LF-CANCEL-AMT
  8447                                    PB-CI-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 155
* EL050.cbl
  8448                                    PB-CI-RATE-DEV-PCT-AH
  8449                                    PB-CI-EXTENTION-DAYS
  8450                                    PB-CI-TERM-IN-DAYS
  8451                                    PB-CI-LIVES
  8452                                    PB-CI-LF-CRIT-PER
  8453                                    PB-CI-AH-CRIT-PER
  8454                                    PB-CI-ADDL-CLP
  8455                                    PB-CI-DDF-IU-RATE-UP.
  8456
  8457     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8458                                    PB-CI-AH-SETTLEMENT-DT
  8459                                    PB-CI-DEATH-DT
  8460                                    PB-CI-LF-PRIOR-CANCEL-DT
  8461                                    PB-CI-AH-PRIOR-CANCEL-DT
  8462                                    PB-CI-ENTRY-DT
  8463                                    PB-CI-LF-EXPIRE-DT
  8464                                    PB-CI-AH-EXPIRE-DT
  8465                                    PB-CI-LOAN-1ST-PMT-DT.
  8466
  8467     IF ACCOUNT-MAST-FOUND
  8468        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8469        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8470
  8471
  8472 0300-CONTINUE-EDIT.
  8473
  8474     IF PB-ISSUE
  8475        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8476            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8477
  8478     IF PB-ISSUE
  8479        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8480            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8481
  8482     IF PB-ISSUE
  8483       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8484          (AM-NO-AH-ONLY)
  8485           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8486               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8487                   MOVE ER-2679 TO WS-ERROR
  8488                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8489
  8490     IF PB-ISSUE
  8491        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8492        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8493        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8494     ELSE
  8495        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8496        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8497        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8498
  8499     MOVE 'N'                    TO PLAN-MASTER-SW
  8500                                    PLAN-MASTER-LIFE-SW
  8501                                    FORM-MASTER-SW
  8502                                    WS-APP-CERT-SW.
  8503
  8504     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8505                                    WS-PL-TOL-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 156
* EL050.cbl
  8506                                    WS-PL-REF-OVS-AMT
  8507                                    WS-PL-TOL-LF-PREM-PCT
  8508                                    WS-PL-TOL-LF-REFUND-PCT
  8509                                    WS-PL-REF-OVS-PCT
  8510                                    WS-PL-TOL-LF-CLAIM.
  8511
  8512     IF PB-COMPANY-ID = 'NCL'
  8513       IF PB-ISSUE
  8514         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8515             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8516             IF FORM-MASTER-FOUND
  8517                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8518
  8519     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8520        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8521
  8522********************** MON CODE **********************
  8523     IF PB-COMPANY-ID = 'MON'
  8524     IF PB-ISSUE
  8525     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8526        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8527             PB-I-LOAN-APR = ZERO)
  8528               MOVE 14.0         TO PB-I-LOAN-APR.
  8529******************************************************
  8530
  8531     IF PB-COMPANY-ID = 'NCL'
  8532       IF PB-ISSUE
  8533           IF FORM-MASTER-FOUND
  8534             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8535                AM-DISMBR-COVERAGE
  8536                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8537                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8538                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8539                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8540                                           PB-I-LIFE-BENEFIT-CD.
  8541
  8542     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8543
  8544     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8545         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8546         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8547         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8548         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8549         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8550           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8551             GO TO 0301-LIFE-BENEFIT-SEARCH
  8552         ELSE
  8553             NEXT SENTENCE
  8554     ELSE
  8555         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8556
  8557     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8558     MOVE '4'                    TO CNTL-REC-TYPE.
  8559     MOVE +0                     TO CNTL-SEQ-NO.
  8560     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8561
  8562     MOVE '1' TO RC-SW-2.
  8563     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 157
* EL050.cbl
  8564
  8565     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8566        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8567         GO TO 0305-BENEFIT-NOT-FOUND.
  8568
  8569     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8570
  8571 0301-LIFE-BENEFIT-SEARCH.
  8572
  8573     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8574
  8575     IF NO-BENEFIT-FOUND
  8576        GO TO 0305-BENEFIT-NOT-FOUND.
  8577
  8578     IF WS-BEN-CD = '99'
  8579        GO TO 0305-BENEFIT-NOT-FOUND.
  8580
  8581     IF PB-COMPANY-ID = 'NCL'
  8582         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8583             GO TO 0304-LIFE-BENEFIT-FOUND.
  8584
  8585     MOVE +1                     TO SUB5.
  8586     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8587
  8588* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8589* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8590     IF PB-COMPANY-ID = 'DMD'
  8591         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8592
  8593 0302-EDIT-ACCT-LF-BENEFITS.
  8594
  8595     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8596        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8597           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8598                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8599           GO TO 03XX-GET-LIFE-ERPLAN.
  8600
  8601     IF SUB5 LESS THAN +20
  8602        ADD +1                   TO SUB5
  8603        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8604
  8605     MOVE +1                     TO SUB5.
  8606
  8607     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8608        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8609
  8610 0303-EDIT-DMD-EXTRA-BENEFITS.
  8611
  8612     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8613        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8614           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8615                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8616           GO TO 03XX-GET-LIFE-ERPLAN.
  8617
  8618     IF SUB5 LESS THAN +30
  8619        ADD +1                   TO SUB5
  8620        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8621
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 158
* EL050.cbl
  8622     MOVE +1                     TO SUB5.
  8623
  8624 03XX-EDIT-FOR-NINETY-LF.
  8625
  8626***************************************************************
  8627*                                                             *
  8628*    NINETY BENEFIT PLAN TYPES:                               *
  8629*                                                             *
  8630*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8631*      92 = ALL GROUP REDUCING BENEFITS                       *
  8632*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8633*      94 = ALL GROUP LEVEL BENEFITS                          *
  8634*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8635*           BENEFIT CONTROLS.                                 *
  8636*      99 = ALL BENEFITS                                      *
  8637*                                                             *
  8638***************************************************************
  8639
  8640     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8641                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8642
  8643     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8644       AND
  8645        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8646        GO TO 03XX-GET-LIFE-ERPLAN.
  8647
  8648     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8649       AND
  8650        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8651        IF CF-REDUCING (SUB3)
  8652           IF (PB-I-INDV-GRP-OVRD = 'I')
  8653              OR
  8654           ((AM-IG = '1') AND
  8655           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8656              OR
  8657           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8658           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8659           (AM-IG NOT = '2'))
  8660              GO TO 03XX-GET-LIFE-ERPLAN.
  8661
  8662     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8663       AND
  8664        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8665        IF CF-REDUCING (SUB3)
  8666           IF (PB-I-INDV-GRP-OVRD = 'G')
  8667              OR
  8668           ((AM-IG = '2') AND
  8669           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8670              OR
  8671           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8672           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8673           (AM-IG NOT = '1'))
  8674              GO TO 03XX-GET-LIFE-ERPLAN.
  8675
  8676     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8677       AND
  8678        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8679        IF CF-LEVEL    (SUB3)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 159
* EL050.cbl
  8680           IF (PB-I-INDV-GRP-OVRD = 'I')
  8681              OR
  8682           ((AM-IG = '1') AND
  8683           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8684              OR
  8685           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8686           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8687            (AM-IG NOT = '2'))
  8688              GO TO 03XX-GET-LIFE-ERPLAN.
  8689
  8690     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8691       AND
  8692        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8693        IF CF-LEVEL    (SUB3)
  8694           IF (PB-I-INDV-GRP-OVRD = 'G')
  8695              OR
  8696           ((AM-IG = '2') AND
  8697           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8698              OR
  8699           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8700           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8701           (AM-IG NOT = '1'))
  8702              GO TO 03XX-GET-LIFE-ERPLAN.
  8703
  8704     IF SUB5 LESS THAN +20
  8705        ADD +1                   TO SUB5
  8706        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8707
  8708     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8709
  8710     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8711        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8712
  8713     MOVE +1                     TO SUB5.
  8714
  8715 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8716
  8717     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8718                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8719
  8720     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8721       AND
  8722        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8723        GO TO 03XX-GET-LIFE-ERPLAN.
  8724
  8725     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8726       AND
  8727        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8728        IF CF-REDUCING (SUB3)
  8729           IF (PB-I-INDV-GRP-OVRD = 'I')
  8730              OR
  8731           ((AM-IG = '1') AND
  8732           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8733              OR
  8734           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8735           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8736           (AM-IG NOT = '2'))
  8737              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 160
* EL050.cbl
  8738
  8739     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8740       AND
  8741        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8742        IF CF-REDUCING (SUB3)
  8743           IF (PB-I-INDV-GRP-OVRD = 'G')
  8744              OR
  8745           ((AM-IG = '2') AND
  8746           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8747              OR
  8748           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8749           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8750           (AM-IG NOT = '1'))
  8751              GO TO 03XX-GET-LIFE-ERPLAN.
  8752
  8753     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8754       AND
  8755        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8756        IF CF-LEVEL    (SUB3)
  8757           IF (PB-I-INDV-GRP-OVRD = 'I')
  8758              OR
  8759           ((AM-IG = '1') AND
  8760           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8761              OR
  8762           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8763           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8764            (AM-IG NOT = '2'))
  8765              GO TO 03XX-GET-LIFE-ERPLAN.
  8766
  8767     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8768       AND
  8769        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8770        IF CF-LEVEL    (SUB3)
  8771           IF (PB-I-INDV-GRP-OVRD = 'G')
  8772              OR
  8773           ((AM-IG = '2') AND
  8774           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8775              OR
  8776           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8777           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8778           (AM-IG NOT = '1'))
  8779              GO TO 03XX-GET-LIFE-ERPLAN.
  8780
  8781     IF SUB5 LESS THAN +30
  8782        ADD +1                   TO SUB5
  8783        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8784
  8785     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8786
  8787 03XX-EDIT-FOR-NINETY-LF-CONT.
  8788
  8789     MOVE +99                    TO SUB5.
  8790
  8791     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8792        IF PB-ISSUE
  8793           MOVE ER-1924          TO  WS-ERROR
  8794           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8795
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 161
* EL050.cbl
  8796     GO TO 0304-LIFE-BENEFIT-FOUND.
  8797
  8798 03XX-GET-LIFE-ERPLAN.
  8799
  8800     IF WK-PLAN-ADDR EQUAL +0
  8801        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8802
  8803     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8804     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8805     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8806     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8807     MOVE 'Y'                    TO PLAN-MASTER-SW
  8808                                    PLAN-MASTER-LIFE-SW.
  8809     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8810
  8811 03XX-ERPLAN-LIFE-GETMAIN.
  8812
  8813     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8814     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8815
  8816 03XX-ERPLAN-LIFE-READ.
  8817
  8818     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8819     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8820     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8821     MOVE PB-SV-STATE            TO PLAN-STATE.
  8822     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8823     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8824     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8825     MOVE WS-SAVE-BENEFIT-REVISION
  8826                                 TO PLAN-REVISION-NO.
  8827
  8828     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8829     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8830
  8831     IF PB-COMPANY-ID = 'NCL'
  8832       IF NOT LF-PLAN-MASTER-FOUND
  8833         IF NOT PB-POLICY-IS-DECLINED  AND
  8834            NOT PB-POLICY-IS-VOIDED
  8835             MOVE  ER-1921         TO  WS-ERROR
  8836             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8837             GO TO 0304-LIFE-BENEFIT-FOUND.
  8838
  8839     IF NOT LF-PLAN-MASTER-FOUND
  8840        GO TO 0304-LIFE-BENEFIT-FOUND.
  8841
  8842 XXXX-CHECK-LF-PLAN-KEY.
  8843
  8844     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8845        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8846        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8847        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8848        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8849        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8850        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8851        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8852        MOVE 'N'                 TO PLAN-MASTER-SW
  8853          GO TO 03XX-ERPLAN-LIFE-READ.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 162
* EL050.cbl
  8854
  8855     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8856
  8857     IF  PB-CANCELLATION
  8858         GO TO  0303-LF-ACCT-BEN-FOUND.
  8859
  8860     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8861        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8862           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8863           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8864              MOVE ER-2644             TO WS-ERROR
  8865              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8866           ELSE
  8867              NEXT SENTENCE
  8868        ELSE
  8869           IF PB-COMPANY-ID NOT = 'NCL'
  8870              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8871                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8872
  8873 0303-LF-ACCT-BEN-FOUND.
  8874
  8875     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8876
  8877     IF PL-DEV-CODE NOT = SPACES
  8878        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8879
  8880     IF PL-DEV-PCT NUMERIC AND
  8881        PL-DEV-PCT NOT = ZEROS
  8882        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8883
  8884     IF PL-TOL-PREM-AMT GREATER THAN +0
  8885        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8886
  8887     IF PL-TOL-REF-AMT GREATER THAN +0
  8888        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8889
  8890     IF PL-TOL-PREM-PCT GREATER THAN +0
  8891        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8892
  8893     IF PL-TOL-REF-PCT GREATER THAN +0
  8894        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8895
  8896     IF PL-TOL-CLM-AMT GREATER THAN +0
  8897        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8898
  8899     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8900                          PL-OVER-SHORT-AMT > +0
  8901        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8902
  8903     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8904                          PL-OVER-SHORT-PCT > +0
  8905        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8906
  8907     IF PL-SALES-TAX NUMERIC AND
  8908                          PL-SALES-TAX > +0
  8909         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8910
  8911     IF PL-IG NOT EQUAL SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 163
* EL050.cbl
  8912        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8913                                    WS-IG-OVRD-AM.
  8914
  8915 0304-LIFE-BENEFIT-FOUND.
  8916
  8917     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8918
  8919     IF PB-ISSUE
  8920        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8921     ELSE
  8922        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8923
  8924     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8925     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8926     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8927     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8928     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8929                                         WS-LF-REFUND-CALC.
  8930     if (ws-lf-earnings-calc = '5')
  8931        and (pb-i-loan-apr = zeros)
  8932        and (benefit-code-chg)
  8933        move +99.9999 to pb-i-loan-apr
  8934     end-if
  8935
  8936     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8937        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8938
  8939     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8940        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8941     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8942
  8943     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8944     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8945     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8946     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8947     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8948     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8949
  8950     IF PB-COMPANY-ID = 'NCL'  AND
  8951        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8952         NEXT SENTENCE
  8953     ELSE
  8954         IF SUB5 NOT GREATER THAN +20
  8955            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8956               MOVE WS-SAVE-BENEFIT-REM-TERM
  8957                                      TO WS-AM-LF-BENE-REM-TERM
  8958                                         EC-BR-LF-REM-TERM-CALC.
  8959
  8960     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8961     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8962
  8963     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8964
  8965 0305-BENEFIT-NOT-FOUND.
  8966
  8967     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8968     MOVE ER-2604                TO WS-ERROR.
  8969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 164
* EL050.cbl
  8970
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 165
* EL050.cbl
  8972
  8973 0310-FIND-AH-BENEFIT-RECORD.
  8974
  8975     MOVE 'N'                    TO PLAN-MASTER-SW
  8976                                    PLAN-MASTER-AH-SW.
  8977
  8978     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8979                                    WS-PL-TOL-AH-REFUND
  8980                                    WS-AH-PL-REF-OVS-AMT
  8981                                    WS-PL-TOL-AH-PREM-PCT
  8982                                    WS-PL-TOL-AH-REFUND-PCT
  8983                                    WS-AH-PL-REF-OVS-PCT
  8984                                    WS-PL-TOL-AH-CLAIM.
  8985     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8986
  8987
  8988     if pb-issue
  8989        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8990           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8991        end-if
  8992        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8993           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8994           GO TO 0399-BENEFIT-NOT-FOUND
  8995        end-if
  8996     end-if
  8997
  8998     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8999        GO TO 0400-FIND-CARRIER.
  9000
  9001     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9002
  9003     IF WK-AH-BEN-ADDR NOT = ZEROS
  9004         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9005         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9006         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9007         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9008           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9009             GO TO 0311-AH-BENEFIT-SEARCH
  9010         ELSE
  9011             NEXT SENTENCE
  9012     ELSE
  9013         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9014
  9015     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9016     MOVE '5'                    TO CNTL-REC-TYPE.
  9017     MOVE +0                     TO CNTL-SEQ-NO.
  9018     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9019
  9020     MOVE '2' TO RC-SW-2.
  9021     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9022
  9023     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9024        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9025          GO TO 0399-BENEFIT-NOT-FOUND.
  9026
  9027     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9028
  9029 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 166
* EL050.cbl
  9030
  9031     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9032
  9033     IF NO-BENEFIT-FOUND
  9034         GO TO 0399-BENEFIT-NOT-FOUND.
  9035
  9036     IF WS-BEN-CD = '99'
  9037        GO TO 0399-BENEFIT-NOT-FOUND.
  9038
  9039     IF PB-COMPANY-ID  =  'NCL'
  9040         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9041             GO TO 0314-A-H-BENEFIT-FOUND.
  9042
  9043     MOVE +1                     TO SUB5.
  9044     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9045
  9046* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9047* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9048     IF PB-COMPANY-ID = 'DMD'
  9049         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9050
  9051 0312-EDIT-ACCT-AH-BENEFITS.
  9052
  9053     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9054        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9055           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9056                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9057           GO TO 03XX-GET-AH-ERPLAN.
  9058
  9059     IF SUB5 LESS THAN +20
  9060        ADD +1                   TO SUB5
  9061        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9062
  9063     MOVE +1                     TO SUB5.
  9064
  9065     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9066        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9067
  9068 0313-EDIT-DMD-EXTRA-BENEFITS.
  9069
  9070     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9071        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9072           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9073                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9074           GO TO 03XX-GET-AH-ERPLAN.
  9075
  9076     IF SUB5 LESS THAN +30
  9077        ADD +1                   TO SUB5
  9078        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9079
  9080     MOVE +1                     TO SUB5.
  9081
  9082 03XX-EDIT-FOR-NINETY-AH.
  9083
  9084***************************************************************
  9085*                                                             *
  9086*    NINETY BENEFIT PLAN TYPES:                               *
  9087*                                                             *
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 167
* EL050.cbl
  9088*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9089*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9090*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9091*           BENEFIT CONTROLS.                                 *
  9092*      99 = ALL BENEFITS.                                     *
  9093*                                                             *
  9094***************************************************************
  9095
  9096     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9097                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9098
  9099     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9100       AND
  9101        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9102        GO TO 03XX-GET-AH-ERPLAN.
  9103
  9104     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9105       AND
  9106        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9107           IF (PB-I-INDV-GRP-OVRD = 'I')
  9108              OR
  9109           ((AM-IG = '1') AND
  9110           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9111              OR
  9112           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9113           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9114           (AM-IG NOT = '2'))
  9115              GO TO 03XX-GET-AH-ERPLAN.
  9116
  9117     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9118       AND
  9119        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9120           IF (PB-I-INDV-GRP-OVRD = 'G')
  9121              OR
  9122           ((AM-IG = '2') AND
  9123           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9124              OR
  9125           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9126           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9127           (AM-IG NOT = '1'))
  9128              GO TO 03XX-GET-AH-ERPLAN.
  9129
  9130     IF SUB5 LESS THAN +20
  9131        ADD +1                   TO SUB5
  9132        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9133
  9134     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9135        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9136
  9137     MOVE +1                    TO SUB5.
  9138
  9139 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9140
  9141     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9142                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9143
  9144     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9145       AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 168
* EL050.cbl
  9146        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9147        GO TO 03XX-GET-AH-ERPLAN.
  9148
  9149     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9150       AND
  9151        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9152           IF (PB-I-INDV-GRP-OVRD = 'I')
  9153              OR
  9154           ((AM-IG = '1') AND
  9155           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9156              OR
  9157           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9158           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9159           (AM-IG NOT = '2'))
  9160              GO TO 03XX-GET-AH-ERPLAN.
  9161
  9162     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9163       AND
  9164        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9165           IF (PB-I-INDV-GRP-OVRD = 'G')
  9166              OR
  9167           ((AM-IG = '2') AND
  9168           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9169              OR
  9170           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9171           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9172           (AM-IG NOT = '1'))
  9173              GO TO 03XX-GET-AH-ERPLAN.
  9174
  9175     IF SUB5 LESS THAN +30
  9176        ADD +1                   TO SUB5
  9177        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9178
  9179 03XX-EDIT-FOR-NINETY-AH-CONT.
  9180
  9181     MOVE +99                    TO SUB5.
  9182
  9183     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9184
  9185     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9186        IF PB-ISSUE
  9187           MOVE ER-1925          TO  WS-ERROR
  9188           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9189
  9190     GO TO 0314-A-H-BENEFIT-FOUND.
  9191
  9192 03XX-GET-AH-ERPLAN.
  9193
  9194     IF WK-PLAN-ADDR EQUAL +0
  9195         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9196
  9197     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9198     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9199     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9200     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9201     MOVE 'Y'                    TO PLAN-MASTER-SW
  9202                                    PLAN-MASTER-AH-SW.
  9203*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 169
* EL050.cbl
  9204     GO TO 03XX-ERPLAN-AH-READ.
  9205
  9206 03XX-ERPLAN-AH-GETMAIN.
  9207
  9208     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9209     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9210
  9211 03XX-ERPLAN-AH-READ.
  9212
  9213     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9214     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9215     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9216     MOVE PB-SV-STATE            TO PLAN-STATE.
  9217     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9218     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9219     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9220     MOVE WS-SAVE-BENEFIT-REVISION
  9221                                 TO PLAN-REVISION-NO.
  9222
  9223     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9224     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9225
  9226     IF PB-COMPANY-ID = 'NCL'
  9227       IF NOT AH-PLAN-MASTER-FOUND
  9228         IF NOT PB-POLICY-IS-DECLINED  AND
  9229            NOT PB-POLICY-IS-VOIDED
  9230             MOVE  ER-1922         TO  WS-ERROR
  9231             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9232             GO TO 0314-A-H-BENEFIT-FOUND.
  9233
  9234     IF NOT AH-PLAN-MASTER-FOUND
  9235        GO TO 0314-A-H-BENEFIT-FOUND.
  9236
  9237 XXXX-CHECK-AH-PLAN-KEY.
  9238
  9239     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9240        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9241        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9242        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9243        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9244        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9245        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9246        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9247        MOVE 'N'                 TO PLAN-MASTER-SW
  9248          GO TO 03XX-ERPLAN-AH-READ.
  9249
  9250     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9251
  9252     IF  PB-CANCELLATION
  9253         GO TO  0313-AH-ACCT-BEN-FOUND.
  9254
  9255     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9256       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9257          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9258          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9259             MOVE ER-2644             TO WS-ERROR
  9260             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9261          ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 170
* EL050.cbl
  9262             NEXT SENTENCE
  9263       ELSE
  9264          IF PB-COMPANY-ID NOT = 'NCL'
  9265             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9266                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9267
  9268 0313-AH-ACCT-BEN-FOUND.
  9269
  9270     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9271
  9272     IF PL-DEV-CODE NOT = SPACES
  9273        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9274
  9275     IF PL-DEV-PCT NUMERIC AND
  9276        PL-DEV-PCT NOT = ZEROS
  9277        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9278
  9279     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9280        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9281
  9282     IF PL-TOL-REF-AMT NOT EQUAL +0
  9283        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9284
  9285     IF PL-TOL-PREM-PCT GREATER THAN +0
  9286        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9287
  9288     IF PL-TOL-REF-PCT GREATER THAN +0
  9289        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9290
  9291     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9292        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9293
  9294     IF PL-OVER-SHORT-AMT NUMERIC AND
  9295                          PL-OVER-SHORT-AMT > +0
  9296        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9297
  9298     IF PL-OVER-SHORT-PCT NUMERIC AND
  9299                          PL-OVER-SHORT-PCT > +0
  9300        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9301
  9302     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9303        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9304        IF WS-IG-OVRD-AM EQUAL SPACES
  9305            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9306
  9307 0314-A-H-BENEFIT-FOUND.
  9308
  9309     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9310
  9311     IF PB-ISSUE
  9312        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9313       ELSE
  9314        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9315
  9316     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9317     if cf-maximum-benefits (sub3) numeric
  9318        move cf-maximum-benefits (sub3)
  9319                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 171
* EL050.cbl
  9320     else
  9321        move zeros               to ws-ah-max-bens
  9322     end-if
  9323     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9324     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9325     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9326                                         WS-AH-REFUND-CALC.
  9327
  9328     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9329        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9330
  9331     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9332        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9333     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9334
  9335     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9336     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9337     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9338     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9339     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9340     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9341
  9342     IF PB-COMPANY-ID = 'NCL'  AND
  9343        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9344         NEXT SENTENCE
  9345     ELSE
  9346         IF SUB5 NOT GREATER THAN +20
  9347            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9348                MOVE WS-SAVE-BENEFIT-REM-TERM
  9349                                      TO WS-AM-AH-BENE-REM-TERM
  9350                                         EC-BR-AH-REM-TERM-CALC.
  9351
  9352     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9353     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9354
  9355     GO TO 0400-FIND-CARRIER.
  9356
  9357 0399-BENEFIT-NOT-FOUND.
  9358
  9359     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9360     MOVE ER-2605                TO WS-ERROR.
  9361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9362
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 172
* EL050.cbl
  9364
  9365 0400-FIND-CARRIER.
  9366
  9367     MOVE PB-SV-CARRIER          TO WS-CARR.
  9368
  9369     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9370     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9371     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9372     MOVE '6'                    TO CNTL-REC-TYPE.
  9373
  9374*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9375     MOVE SPACE                  TO WS-DMD-RATING-SW
  9376                                    EC-BR-DMD-RATING-SW.
  9377
  9378     MOVE '2'                    TO RC-SW-1.
  9379     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9380
  9381     IF NOT CF-CARRIER-MASTER
  9382        GO TO 0400-CARRIER-NOT-FOUND.
  9383
  9384 0400-BUILD-CARR-TOL.
  9385
  9386     IF CF-CR-TOL-PREM NUMERIC AND
  9387        CF-CR-TOL-PREM GREATER THAN +0
  9388        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9389                                    WS-TOL-AH-PREM.
  9390
  9391     IF CF-CR-TOL-REFUND NUMERIC AND
  9392        CF-CR-TOL-REFUND GREATER THAN +0
  9393        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9394                                    WS-TOL-AH-REFUND.
  9395
  9396     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9397        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9398        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9399                                    WS-AH-REFUND-OVS-AMT.
  9400
  9401     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9402        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9403        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9404                                    WS-AH-REFUND-OVS-PCT.
  9405
  9406     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9407        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9408        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9409                                    WS-TOL-AH-PREM-PCT.
  9410
  9411     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9412        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9413        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9414                                     WS-TOL-AH-REFUND-PCT.
  9415
  9416     IF CF-COMPANY-ID EQUAL 'DMD'
  9417         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9418                                    EC-BR-DMD-RATING-SW.
  9419
  9420     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9421     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 173
* EL050.cbl
  9422        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9423     END-IF
  9424     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9425        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9426     END-IF
  9427     IF WS-TOL-CLP-PCT = ZEROS
  9428        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9429     END-IF
  9430
  9431     IF WS-SPP-LEASE-COMM = ZEROS
  9432        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9433     END-IF
  9434     GO TO 0400-FIND-ERPDEF.
  9435
  9436 0400-CARRIER-NOT-FOUND.
  9437
  9438     MOVE ER-2602                TO WS-ERROR.
  9439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9440
  9441 0400-FIND-ERPDEF.
  9442     IF PB-COMPANY-ID = 'DCC'
  9443        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9444        CONTINUE
  9445     ELSE
  9446        GO TO 0400-FIND-ERCOMP
  9447     END-IF
  9448     MOVE ' '                    TO PDEF-MASTER-SW
  9449     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9450     MOVE PB-STATE               TO ERPDEF-STATE
  9451     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9452     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9453     IF PB-ISSUE
  9454        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9455     ELSE
  9456        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9457     END-IF
  9458     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9459     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9460     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9461     IF PDEF-MASTER-FOUND
  9462        MOVE 'N'                 TO PDEF-MASTER-SW
  9463        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9464        IF PDEF-MASTER-FOUND
  9465           IF (ERPDEF-KEY-SAVE (1:16) =
  9466                        PD-CONTROL-PRIMARY (1:16))
  9467              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9468              CONTINUE
  9469           ELSE
  9470              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9471              IF (ERPDEF-KEY-SAVE (1:16) =
  9472                        PD-CONTROL-PRIMARY (1:16))
  9473                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9474                 CONTINUE
  9475              ELSE
  9476                 MOVE 'N'        TO PDEF-MASTER-SW
  9477              END-IF
  9478           END-IF
  9479        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 174
* EL050.cbl
  9480        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9481     END-IF
  9482     IF PDEF-MASTER-FOUND
  9483        IF PD-TRUNCATED = 'Y'
  9484           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9485        END-IF
  9486     END-IF
  9487     .
  9488 0400-FIND-ERCOMP.
  9489     IF PB-COMPANY-ID = 'DCC'
  9490        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9491           (WS-SUB1 > +10)
  9492           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9493                 OR 'A' OR 'N'
  9494              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9495              MOVE PB-CARRIER    TO COMP-CARRIER
  9496              MOVE PB-GROUPING   TO COMP-GROUPING
  9497              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9498              MOVE AM-AGT (WS-SUB1)
  9499                                 TO COMP-FIN-RESP
  9500              MOVE 'G'           TO COMP-TYPE
  9501              PERFORM 8582-READ-COMPENSATION-MASTER
  9502                                 THRU 8582-EXIT
  9503              IF COMP-MASTER-FOUND
  9504                 IF CO-GA-INACTIVE
  9505                    MOVE ER-2763 TO WS-ERROR
  9506                    PERFORM 9900-ERROR-FORMAT
  9507                                 THRU 9900-EXIT
  9508                    MOVE +11     TO WS-SUB1
  9509                 END-IF
  9510                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9511                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9512                    MOVE ER-2788 TO WS-ERROR
  9513                    PERFORM 9900-ERROR-FORMAT
  9514                                 THRU 9900-EXIT
  9515                    MOVE +11     TO WS-SUB1
  9516                 END-IF
  9517              END-IF
  9518           END-IF
  9519        END-PERFORM
  9520     END-IF
  9521     IF PB-COMPANY-ID = 'DCC'
  9522        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9523           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9524                                    WS-CLP-STATE
  9525        ELSE
  9526           MOVE SPACES           TO PB-I-CLP-STATE
  9527                                    WS-CLP-STATE
  9528        END-IF
  9529     END-IF
  9530
  9531     IF (PB-COMPANY-ID = 'DCC')
  9532        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9533        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9534        CONTINUE
  9535     ELSE
  9536        GO TO 0400-FIND-STATE-RECORD
  9537     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 175
* EL050.cbl
  9538     MOVE SPACES                 TO WS-CLP-STATE
  9539     MOVE +0                     TO WS-BANK-FEE
  9540                                    WS-BANK-LFEE
  9541                                    WS-BANK-NOCHRGB
  9542
  9543     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9544     IF (PB-ISSUE)
  9545        AND (PB-I-BANK-NUMBER NOT =
  9546            SPACES AND ZEROS AND LOW-VALUES)
  9547        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9548     ELSE
  9549        IF (PB-CANCELLATION)
  9550           AND (PB-CI-BANK-NUMBER NOT =
  9551                SPACES AND ZEROS AND LOW-VALUES)
  9552           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9553        END-IF
  9554     END-IF
  9555     IF COMP-FIN-RESP NOT = LOW-VALUES
  9556        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9557        MOVE PB-CARRIER          TO COMP-CARRIER
  9558        MOVE PB-GROUPING         TO COMP-GROUPING
  9559        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9560        MOVE 'B'                 TO COMP-TYPE
  9561        PERFORM 8582-READ-COMPENSATION-MASTER
  9562                                 THRU 8582-EXIT
  9563        IF COMP-MASTER-FOUND
  9564           IF CO-MAX-BANK-FEE NOT NUMERIC
  9565              MOVE +0            TO CO-MAX-BANK-FEE
  9566           END-IF
  9567           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9568              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9569           END-IF
  9570           IF CO-GA-INACTIVE
  9571              MOVE ER-2763       TO WS-ERROR
  9572              PERFORM 9900-ERROR-FORMAT
  9573                                 THRU 9900-EXIT
  9574           END-IF
  9575           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9576              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9577              MOVE ER-2788 TO WS-ERROR
  9578              PERFORM 9900-ERROR-FORMAT
  9579                                 THRU 9900-EXIT
  9580              MOVE +11     TO WS-SUB1
  9581           END-IF
  9582           IF WS-AH-BEN-CATEGORY = 'G'
  9583              MOVE CO-MAX-BANK-FEE
  9584                                 TO WS-BANK-FEE
  9585                                    PB-I-BANK-FEE
  9586           ELSE
  9587              MOVE CO-MAX-BANK-FEE-LEASE
  9588                                 TO WS-BANK-LFEE
  9589                                    PB-I-BANK-FEE
  9590           END-IF
  9591           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9592              AND (WS-AH-REFUND-CALC = 'G'))
  9593                        OR
  9594              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9595              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 176
* EL050.cbl
  9596              CONTINUE
  9597           ELSE
  9598              MOVE ER-2789 TO WS-ERROR
  9599              PERFORM 9900-ERROR-FORMAT
  9600                                 THRU 9900-EXIT
  9601           END-IF
  9602           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9603                                    PB-I-CLP-STATE
  9604           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9605           MOVE CO-CARRIER       TO BXRF-CARRIER
  9606           MOVE CO-GROUPING      TO BXRF-GROUPING
  9607           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9608           MOVE BXRF-MAX-REC-LENGTH
  9609                                 TO BXRF-REC-LENGTH
  9610           PERFORM 8584-READ-BANK-CROSS-REF
  9611                                 THRU 8584-EXIT
  9612           IF BXRF-MASTER-FOUND
  9613              MOVE ' '           TO BANK-ACCT-SW
  9614              MOVE BK-BANK-POINTER-CNT
  9615                                 TO BK-BANK-POINTER-CNT
  9616              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9617                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9618                 OR (BANK-ACCT-FOUND)
  9619                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9620                    AND (BK-AM-EXP-DT (WS-SUB1)
  9621                                 > PB-CERT-EFF-DT)
  9622                    AND (BK-AM-EFF-DT (WS-SUB1)
  9623                                 NOT > PB-CERT-EFF-DT)
  9624                    SET BANK-ACCT-FOUND TO TRUE
  9625                 END-IF
  9626              END-PERFORM
  9627              IF NOT BANK-ACCT-FOUND
  9628                 MOVE ZEROS      TO WS-BANK-FEE
  9629                                    WS-BANK-LFEE
  9630                 MOVE ER-2869    TO WS-ERROR
  9631                 PERFORM 9900-ERROR-FORMAT
  9632                                 THRU 9900-EXIT
  9633              ELSE
  9634                 PERFORM 5000-PROCESS-REPS
  9635                                 THRU 5000-EXIT
  9636                 IF AGENT-MASTER-FOUND
  9637                    MOVE +0      TO WS-BANK-FEE
  9638                                    WS-BANK-LFEE
  9639*                   MOVE AG-SPP-FEES (1)
  9640*                                TO PB-I-BANK-FEE
  9641*                                   WS-BANK-FEE
  9642                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9643                       (WS-SUB1 > +10)
  9644                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9645                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9646                       END-IF
  9647                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9648                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9649                       END-IF
  9650                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9651                          AG-SPP-FEES (WS-SUB1)
  9652                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9653                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 177
* EL050.cbl
  9654                    END-PERFORM
  9655                    IF WS-AH-BEN-CATEGORY = 'G'
  9656                       MOVE WS-BANK-FEE
  9657                                 TO PB-I-BANK-FEE
  9658                    ELSE
  9659                       MOVE WS-BANK-LFEE
  9660                                 TO PB-I-BANK-FEE
  9661                    END-IF
  9662                 END-IF
  9663              END-IF
  9664           END-IF
  9665        ELSE
  9666           MOVE ER-2879          TO WS-ERROR
  9667           PERFORM 9900-ERROR-FORMAT
  9668                                 THRU 9900-EXIT
  9669        END-IF
  9670     ELSE
  9671        MOVE ER-2879             TO WS-ERROR
  9672        PERFORM 9900-ERROR-FORMAT
  9673                                 THRU 9900-EXIT
  9674     END-IF
  9675     IF WS-AH-BEN-CATEGORY = 'G'
  9676        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9677        + WS-BANK-FEE
  9678     ELSE
  9679        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9680        + WS-BANK-LFEE
  9681     END-IF
  9682     .
  9683 0400-FIND-STATE-RECORD.
  9684
  9685     IF WK-STATE-ADDR NOT = ZEROS
  9686         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9687         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9688         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9689         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9690         IF PB-SV-STATE = CF-STATE-CODE
  9691             GO TO 0405-CONTINUE-EDIT
  9692         ELSE
  9693             NEXT SENTENCE
  9694     ELSE
  9695         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9696
  9697     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9698     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9699     MOVE '3'                    TO CNTL-REC-TYPE.
  9700     MOVE +0                     TO CNTL-SEQ-NO.
  9701
  9702     MOVE '3'                    TO RC-SW-2.
  9703     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9704
  9705     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9706        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9707        PB-SV-STATE   NOT = CF-STATE-CODE)
  9708        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9709                                    WS-TOL-AH-CLAIM
  9710                                    WS-MINIMUM-REFUND
  9711                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 178
* EL050.cbl
  9712                                    WS-TOL-AH-PREM
  9713                                    WS-TOL-LF-REFUND
  9714                                    WS-TOL-AH-REFUND
  9715                                    EC-ST-TOL-PREM-PCT
  9716                                    WS-TOL-LF-PREM-PCT
  9717                                    WS-TOL-AH-PREM-PCT
  9718                                    EC-ST-TOL-REFUND-PCT
  9719                                    WS-TOL-LF-REFUND-PCT
  9720                                    WS-TOL-AH-REFUND-PCT
  9721                                    EC-ST-TOL-PREM
  9722                                    EC-ST-TOL-REFUND
  9723                                    EC-ST-FST-PMT-DAYS-MAX
  9724                                    WS-FREE-LOOK-PERIOD
  9725                                    WS-ST-LF-PREM-TAX
  9726                                    WS-ST-AH-PREM-TAX-I
  9727                                    WS-ST-AH-PREM-TAX-G
  9728                                    WS-BANK-FEE
  9729                                    WS-BANK-LFEE
  9730                                    WS-TOL-CLP-PCT
  9731                                    WS-SPP-LEASE-COMM
  9732                                    WS-INT-PERIODS
  9733                                    WS-EXTRA-PMTS
  9734        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9735                                    EC-ST-FST-PMT-DAYS-CHG
  9736                                    WS-LF-REM-TERM-CALC
  9737                                    WS-LF-REFUND-CALC
  9738                                    EC-ST-LF-REM-TERM-CALC
  9739                                    EC-ST-LF-REFUND-CALC
  9740                                    WS-AH-REM-TERM-CALC
  9741                                    WS-AH-REFUND-CALC
  9742                                    WS-LF-BEN-CATEGORY
  9743                                    WS-AH-BEN-CATEGORY
  9744                                    WS-CLP-STATE
  9745                                    WS-ST-REFUND-CLAIM-FLAG
  9746                                    WS-ST-CAUSAL-STATE
  9747                                    ws-st-agent-sig-edit
  9748                                    EC-ST-AH-REM-TERM-CALC
  9749                                    EC-ST-AH-REFUND-CALC
  9750          GO TO 0499-STATE-NOT-FOUND.
  9751
  9752     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9753
  9754 0405-CONTINUE-EDIT.
  9755
  9756     if pb-company-id = 'AHL'
  9757        continue
  9758     else
  9759        IF PB-CERT-PRIME NOT NUMERIC
  9760           MOVE ER-2722          TO WS-ERROR
  9761           PERFORM 9900-ERROR-FORMAT
  9762                                 THRU 9900-EXIT
  9763        end-if
  9764     END-IF
  9765*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9766*       MOVE +0                  TO SUB3
  9767*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9768*       IF SUB3 > +0
  9769*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 179
* EL050.cbl
  9770*          PERFORM 9900-ERROR-FORMAT
  9771*                                THRU 9900-EXIT
  9772*       END-IF
  9773*    END-IF
  9774*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9775*       IF PB-CERT-PRIME NOT NUMERIC
  9776*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9777*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9778*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9779*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9780*
  9781*          MOVE ER-2722          TO WS-ERROR
  9782*          PERFORM 9900-ERROR-FORMAT
  9783*                                THRU 9900-EXIT
  9784*       END-IF
  9785*    END-IF
  9786
  9787     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9788
  9789     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9790        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9791                                    WS-TOL-AH-CLAIM.
  9792
  9793     IF CF-ST-REFUND-MIN NOT NUMERIC
  9794        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9795
  9796     IF CF-ST-REFUND-MIN NOT = ZEROS
  9797        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9798
  9799     IF CF-ST-TOL-PREM  NOT = ZEROS
  9800        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9801                                    WS-TOL-AH-PREM
  9802        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9803
  9804     IF CF-ST-TOL-REFUND NOT = ZEROS
  9805        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9806                                    WS-TOL-AH-REFUND
  9807        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9808
  9809     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9810        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9811        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9812                                    WS-AH-REFUND-OVS-AMT
  9813                                    EC-ST-OVR-SHT-AMT.
  9814
  9815     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9816        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9817        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9818                                    WS-TOL-LF-PREM-PCT
  9819                                    WS-TOL-AH-PREM-PCT.
  9820
  9821     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9822        CF-ST-TOL-REF-PCT GREATER THAN +0
  9823        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9824                                    WS-TOL-LF-REFUND-PCT
  9825                                    WS-TOL-AH-REFUND-PCT.
  9826
  9827     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 180
* EL050.cbl
  9828        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9829        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9830                                    WS-AH-REFUND-OVS-PCT
  9831                                    EC-ST-OVR-SHT-PCT.
  9832
  9833     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9834     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9835
  9836     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9837          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9838
  9839     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9840     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9841     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9842
  9843     IF CF-ST-LF-PREM-TAX NUMERIC
  9844        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9845     END-IF
  9846     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9847        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9848     END-IF
  9849     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9850        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9851     END-IF
  9852
  9853     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9854         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9855     END-IF.
  9856
  9857     IF CF-ST-CAUSAL-STATE > SPACES
  9858         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9859     END-IF.
  9860     if cf-st-extra-interest-periods not numeric
  9861        move zeros               to cf-st-extra-interest-periods
  9862     end-if
  9863     if cf-st-extra-payments not numeric
  9864        move zeros               to cf-st-extra-payments
  9865     end-if
  9866
  9867     move cf-st-extra-interest-periods
  9868                                 to ws-int-periods
  9869     move cf-st-extra-payments   to ws-extra-pmts
  9870     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9871     move cf-st-net-only-state   to ws-net-only-state
  9872     IF WS-LF-BENEFIT-CD = ZEROS
  9873        GO TO 0410-CHECK-AH.
  9874
  9875     IF CF-ST-RT-CALC NOT = SPACES
  9876        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9877                                    EC-ST-LF-REM-TERM-CALC
  9878     END-IF
  9879
  9880     IF WS-LF-COVERAGE-TYPE = 'R'
  9881        IF WS-LF-EARNINGS-CALC = '5'
  9882           IF CF-ST-RF-LN-CALC > '0'
  9883              MOVE CF-ST-RF-LN-CALC
  9884                                 TO WS-LF-REFUND-CALC
  9885                                    EC-ST-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 181
* EL050.cbl
  9886           END-IF
  9887        ELSE
  9888           IF CF-ST-RF-LR-CALC > '0'
  9889              MOVE CF-ST-RF-LR-CALC
  9890                                 TO WS-LF-REFUND-CALC
  9891                                    EC-ST-LF-REFUND-CALC
  9892           END-IF
  9893        END-IF
  9894     ELSE
  9895        IF CF-ST-RF-LL-CALC > '0'
  9896           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9897                                    EC-ST-LF-REFUND-CALC
  9898        END-IF
  9899     END-IF
  9900
  9901     IF CF-ST-RT-CALC NOT = SPACES
  9902        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9903                                    EC-ST-LF-REM-TERM-CALC
  9904     END-IF
  9905
  9906     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9907     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9908
  9909     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9910
  9911     IF NO-BENEFIT-FOUND
  9912        GO TO 0410-CHECK-AH.
  9913
  9914     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9915        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9916                                 TO EC-ST-LF-REM-TERM-CALC
  9917                                    WS-LF-REM-TERM-CALC
  9918     END-IF
  9919
  9920     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9921        MOVE CF-ST-REFUND-CALC (SUB3)
  9922                                 TO WS-LF-REFUND-CALC
  9923                                    EC-ST-LF-REFUND-CALC
  9924     END-IF
  9925*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9926     if cf-st-extra-periods (sub3) not numeric
  9927        move zeros               to cf-st-extra-periods (sub3)
  9928     end-if
  9929     if cf-st-extra-periods (sub3) > zeros
  9930        if ws-lf-ben-category = 'P'
  9931           move cf-st-extra-periods (sub3)
  9932                                 to ws-extra-pmts
  9933        else
  9934           if ws-lf-ben-category = 'I'
  9935              move cf-st-extra-periods (sub3)
  9936                                 to ws-int-periods
  9937           end-if
  9938        end-if
  9939     end-if
  9940     .
  9941 0410-CHECK-AH.
  9942
  9943     IF WS-AH-BENEFIT-CD = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 182
* EL050.cbl
  9944        GO TO 0500-SET-ACCOUNT.
  9945
  9946     IF CF-ST-RT-CALC NOT = SPACES
  9947        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9948                                    EC-ST-AH-REM-TERM-CALC
  9949     END-IF
  9950
  9951     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9952        IF CF-ST-RF-CP-CALC > '0'
  9953           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9954                                    EC-ST-AH-REFUND-CALC
  9955        END-IF
  9956     ELSE
  9957        IF CF-ST-RF-AH-CALC > '0'
  9958           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9959                                    EC-ST-AH-REFUND-CALC
  9960        END-IF
  9961     END-IF
  9962     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9963     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9964
  9965     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9966
  9967     IF NO-BENEFIT-FOUND
  9968        GO TO 0500-SET-ACCOUNT.
  9969
  9970     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9971        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9972                                 TO WS-AH-REM-TERM-CALC
  9973                                    EC-ST-AH-REM-TERM-CALC
  9974     END-IF
  9975
  9976     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9977        MOVE CF-ST-REFUND-CALC (SUB3)
  9978                                 TO WS-AH-REFUND-CALC
  9979                                    EC-ST-AH-REFUND-CALC
  9980     END-IF
  9981
  9982*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9983
  9984     GO TO 0500-SET-ACCOUNT.
  9985
  9986 0499-STATE-NOT-FOUND.
  9987
  9988     MOVE ER-2603                TO WS-ERROR.
  9989     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9990
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 183
* EL050.cbl
  9992
  9993 0500-SET-ACCOUNT.
  9994*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9995     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9996        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9997        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9998        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9999        MOVE '3'                 TO CNTL-REC-TYPE
 10000        MOVE +0                  TO CNTL-SEQ-NO
 10001
 10002        MOVE '3'                 TO RC-SW-2
 10003        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10004
 10005        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10006           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10007           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10008           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10009                                    WS-ST-AH-PREM-TAX-I
 10010                                    WS-ST-AH-PREM-TAX-G
 10011        ELSE
 10012           IF CF-ST-LF-PREM-TAX NUMERIC
 10013              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10014           END-IF
 10015           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10016              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10017           END-IF
 10018           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10019              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10020           END-IF
 10021        END-IF
 10022        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10023     END-IF
 10024*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10025*  FOR DCC ONLY
 10026     IF PB-COMPANY-ID = 'DCC'
 10027
 10028     MOVE ' '                    TO STAT-MASTER-SW
 10029     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10030     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10031     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10032     MOVE PB-STATE               TO ELSTAT-STATE
 10033     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10034        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10035     END-IF
 10036
 10037     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10038     SET BIN-TO-GREG             TO TRUE
 10039     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10040     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10041     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10042
 10043     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10044     IF STAT-MASTER-FOUND
 10045        MOVE 'N'                 TO STAT-MASTER-SW
 10046        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10047        IF STAT-MASTER-FOUND
 10048           IF (ELSTAT-KEY-SAVE (1:12) =
 10049                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 184
* EL050.cbl
 10050              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10051                 MOVE 'F'        TO STAT-MASTER-SW
 10052              ELSE
 10053                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10054                 IF (STAT-MASTER-FOUND)
 10055                    AND (ELSTAT-KEY-SAVE (1:12) =
 10056                        SF-CONTROL-PRIMARY (1:12))
 10057                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10058                    MOVE 'F'     TO STAT-MASTER-SW
 10059                 END-IF
 10060              END-IF
 10061           END-IF
 10062        END-IF
 10063     END-IF
 10064
 10065     IF STAT-MASTER-SW = 'F'
 10066        IF SF-ST-LF-PREM-TAX NUMERIC
 10067           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10068        END-IF
 10069        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10070           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10071        END-IF
 10072        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10073           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10074        END-IF
 10075     END-IF
 10076
 10077     END-IF
 10078     IF (PB-COMPANY-ID = 'DCC')
 10079        AND (PB-ISSUE)
 10080        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10081        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10082        AND (AM-GPCD = 06)
 10083        MOVE 'Y'                 TO WS-GOOD-HIN
 10084        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10085           MOVE PB-I-VIN         TO WS-WORK-VIN
 10086           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10087              (V1 > 16)
 10088              IF WS-WORK-VIN (V1:1) NUMERIC
 10089                 MOVE WS-WORK-VIN-N (V1)
 10090                                 TO WS-ROW-B-VAL (V1)
 10091              ELSE
 10092                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10093                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10094                    OR (V2 > 26)
 10095                 END-PERFORM
 10096                 IF V2 < 27
 10097                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10098                 ELSE
 10099                    MOVE 'N'     TO WS-GOOD-HIN
 10100                 END-IF
 10101              END-IF
 10102              COMPUTE WS-ROW-D-VAL (V1) =
 10103                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10104              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10105                 WS-ROW-D-VAL (V1)
 10106           END-PERFORM
 10107           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 185
* EL050.cbl
 10108           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10109             REMAINDER WS-VIN-REMAINDER
 10110           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10111              CONTINUE
 10112           ELSE
 10113              MOVE 'N'           TO WS-GOOD-HIN
 10114           END-IF
 10115        ELSE
 10116           MOVE 'N'              TO WS-GOOD-HIN
 10117        END-IF
 10118        IF WS-GOOD-HIN NOT = 'Y'
 10119           MOVE ER-3826           TO WS-ERROR
 10120           PERFORM 9900-ERROR-FORMAT
 10121                                 THRU 9900-EXIT
 10122        END-IF
 10123     END-IF
 10124     IF (PB-COMPANY-ID = 'DCC')
 10125        AND (PB-ISSUE)
 10126        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10127        AND (AM-GPCD NOT = 06)
 10128        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10129           perform 3400-edit-vin thru 3400-exit
 10130        ELSE
 10131          MOVE ER-3826           TO WS-ERROR
 10132          PERFORM 9900-ERROR-FORMAT
 10133                                 THRU 9900-EXIT
 10134        END-IF
 10135     END-IF
 10136     if (pb-company-id = 'CID')
 10137        and (pb-issue)
 10138        and (pb-i-vin not = spaces and low-values and zeros)
 10139        perform 3400-edit-vin    thru 3400-exit
 10140     end-if
 10141******************************************************************
 10142******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10143******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10144******* METHODS.
 10145******************************************************************
 10146     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10147        IF PB-CANCELLATION
 10148           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10149              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10150                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10151                IF FORM-MASTER-FOUND
 10152                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10153******************************************************************
 10154
 10155     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10156     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10157
 10158     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10159     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10160     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10161     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10162
 10163
 10164     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10165     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 186
* EL050.cbl
 10166     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10167
 10168     IF AM-LF-OB-RATE NOT NUMERIC
 10169         MOVE ZERO               TO AM-LF-OB-RATE.
 10170
 10171     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10172         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10173
 10174     IF AM-AH-OB-RATE NOT NUMERIC
 10175         MOVE ZERO               TO AM-AH-OB-RATE.
 10176
 10177     IF WS-LF-JOINT-INDICATOR = 'J'
 10178         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10179     ELSE
 10180         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10181
 10182     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10183
 10184     IF WS-IG-OVRD-AM  EQUAL SPACE
 10185         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10186
 10187     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10188         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10189                                       WS-IG-OVRD
 10190     ELSE
 10191         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10192             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10193                                       WS-IG-OVRD
 10194         ELSE
 10195             MOVE AM-IG             TO WS-IG-OVRD-AH
 10196                                       WS-IG-OVRD.
 10197
 10198     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10199         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10200                                       WS-IG-OVRD
 10201     ELSE
 10202         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10203             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10204                                       WS-IG-OVRD
 10205         ELSE
 10206             MOVE AM-IG             TO WS-IG-OVRD-LF
 10207                                       WS-IG-OVRD.
 10208
 10209     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10210     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10211     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10212     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10213     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10214
 10215     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10216     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10217     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10218     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10219
 10220     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10221     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10222     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10223     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 187
* EL050.cbl
 10224     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10225     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10226     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10227
 10228     IF WS-ACCT-AH-DEV-PCT > +0
 10229        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10230     ELSE
 10231        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10232
 10233     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10234        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10235     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10236        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10237
 10238        IF AM-EARN-METHOD-L = 'S'
 10239            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10240                                        WS-LF-REFUND-CALC.
 10241
 10242        IF AM-EARN-METHOD-R = 'S'
 10243            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10244                                        WS-LF-REFUND-CALC.
 10245
 10246     IF WS-LF-COVERAGE-TYPE = 'R'
 10247         IF AM-EARN-METHOD-R = 'R'
 10248            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10249                                    WS-LF-REFUND-CALC.
 10250     IF WS-LF-COVERAGE-TYPE = 'R'
 10251         IF AM-EARN-METHOD-R = 'P'
 10252            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10253                                    WS-LF-REFUND-CALC.
 10254     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10255         IF AM-EARN-METHOD-L = 'R'
 10256            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10257                                    WS-LF-REFUND-CALC.
 10258     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10259         IF AM-EARN-METHOD-L = 'P'
 10260            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10261                                    WS-LF-REFUND-CALC.
 10262     IF WS-LF-COVERAGE-TYPE = 'R'
 10263         IF AM-EARN-METHOD-R = 'A'
 10264            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10265                                    WS-LF-REFUND-CALC.
 10266     IF WS-LF-COVERAGE-TYPE = 'R'
 10267         IF AM-EARN-METHOD-R = 'M'
 10268            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10269                                    WS-LF-REFUND-CALC.
 10270     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10271         IF AM-EARN-METHOD-L = 'A'
 10272            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10273                                    WS-LF-REFUND-CALC.
 10274     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10275         IF AM-EARN-METHOD-L = 'M'
 10276            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10277                                    WS-LF-REFUND-CALC.
 10278
 10279     IF AM-EARN-METHOD-A = 'R'
 10280        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10281                                    WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 188
* EL050.cbl
 10282     IF AM-EARN-METHOD-A = 'P'
 10283        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10284                                    WS-AH-REFUND-CALC.
 10285     IF AM-EARN-METHOD-A = 'C'
 10286        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10287                                    WS-AH-REFUND-CALC.
 10288     IF AM-EARN-METHOD-A = 'A'
 10289        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10290                                    WS-AH-REFUND-CALC.
 10291     IF AM-EARN-METHOD-A = 'M'
 10292        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10293                                    WS-AH-REFUND-CALC.
 10294     IF AM-EARN-METHOD-A = 'N'
 10295        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10296                                    WS-AH-REFUND-CALC.
 10297     IF AM-EARN-METHOD-A = 'S'
 10298        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10299                                    WS-AH-REFUND-CALC.
 10300
 10301     IF AM-TOL-PREM NOT = ZEROS
 10302        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10303                                    WS-TOL-AH-PREM.
 10304
 10305     IF AM-OVR-SHT-AMT NUMERIC AND
 10306                  AM-OVR-SHT-AMT > 0
 10307        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10308                                    EC-AM-LF-OVR-SHT-AMT
 10309                                    WS-AH-REFUND-OVS-AMT
 10310                                    EC-AM-AH-OVR-SHT-AMT.
 10311
 10312     IF AM-OVR-SHT-PCT NUMERIC AND
 10313                    AM-OVR-SHT-PCT > 0
 10314        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10315                                    EC-AM-LF-OVR-SHT-PCT
 10316                                    WS-AH-REFUND-OVS-PCT
 10317                                    EC-AM-AH-OVR-SHT-PCT.
 10318
 10319     IF AM-TOL-REF-PCT NUMERIC AND
 10320                  AM-TOL-REF-PCT > 0
 10321        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10322                                    WS-TOL-AH-REFUND-PCT.
 10323
 10324     IF AM-TOL-REF  NOT = ZEROS  AND
 10325                  AM-TOL-REF NUMERIC
 10326        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10327                                    EC-AM-LF-TOL-REFUND
 10328                                    WS-TOL-AH-REFUND
 10329                                    EC-AM-AH-TOL-REFUND.
 10330
 10331     IF AM-TOL-CLM  NOT = ZEROS
 10332        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10333                                    WS-TOL-AH-CLAIM.
 10334
 10335     IF AM-CLP-TOL-PCT NOT NUMERIC
 10336        MOVE +0                  TO AM-CLP-TOL-PCT
 10337     END-IF
 10338
 10339     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 189
* EL050.cbl
 10340        MOVE +0                  TO AM-SPP-LEASE-COMM
 10341     END-IF
 10342     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10343        MOVE WS-PL-TOL-LF-PREM-PCT
 10344                                 TO WS-TOL-LF-PREM-PCT.
 10345
 10346     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10347        MOVE WS-PL-TOL-AH-PREM-PCT
 10348                                 TO WS-TOL-AH-PREM-PCT.
 10349
 10350     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10351        MOVE WS-PL-TOL-LF-REFUND-PCT
 10352                                 TO WS-TOL-LF-REFUND-PCT.
 10353
 10354     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10355        MOVE WS-PL-TOL-AH-REFUND-PCT
 10356                                 TO WS-TOL-AH-REFUND-PCT.
 10357
 10358     IF WS-PL-REF-OVS-AMT > +0
 10359        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10360
 10361     IF WS-PL-REF-OVS-PCT > +0
 10362        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10363
 10364     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10365        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10366     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10367        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10368     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10369        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10370     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10371        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10372     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10373        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10374     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10375        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10376
 10377     IF WS-AH-PL-REF-OVS-AMT > +0
 10378        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10379
 10380     IF WS-AH-PL-REF-OVS-PCT > +0
 10381        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10382
 10383     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10384     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10385
 10386     IF PB-CANCELLATION
 10387        GO TO 3000-CONTINUE-EDIT.
 10388
 10389     MOVE +1 TO SUB1.
 10390     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10391     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10392
 10393     IF CF-COMPANY-ID = 'DMD'
 10394       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10395         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10396        ELSE
 10397         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 190
* EL050.cbl
 10398
 10399  0525-FIND-ACCT-COMM.
 10400     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10401        NEXT SENTENCE
 10402      ELSE
 10403         ADD +1 TO SUB1
 10404         IF SUB1 LESS +11
 10405            GO TO 0525-FIND-ACCT-COMM
 10406          ELSE
 10407             GO TO 0560-EDIT-CONTINUE.
 10408
 10409     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10410     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10411                                    PB-I-LIFE-COMMISSION.
 10412***  IF PB-COMPANY-ID = 'CRI'
 10413     IF PB-PREM-ACCTNG-ONLY
 10414         GO TO 0560-EDIT-CONTINUE.
 10415
 10416     MOVE '0530' TO CTBL-SW.
 10417     MOVE ' '    TO WS-CTBL-READ-SW.
 10418
 10419
 10420 0530-GET-AH-COMP.
 10421     IF NO-AH-COVERAGE  OR
 10422        NO-AH-BENEFIT-MATCH
 10423           GO TO 0540-NEXT-READ-STEP.
 10424
 10425     IF AM-A-COM (SUB1) NUMERIC
 10426        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10427         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10428         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10429         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10430         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10431     ELSE
 10432          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10433          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10434          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10435          MOVE ZEROS             TO WS-SUB1
 10436                                    WS-COMMISSION
 10437          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10438          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10439          IF WS-COMMISSION > ZEROS
 10440             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10441             GO TO 0540-NEXT-READ-STEP
 10442          END-IF
 10443          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10444          IF CTBL-TABLE-FOUND
 10445             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10446                                        PB-I-AH-TERM
 10447             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10448             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10449             GO TO 0540-NEXT-READ-STEP
 10450          ELSE
 10451             IF FIRST-TIME-THROUGH
 10452                 GO TO 0530-GET-AH-COMP
 10453             ELSE
 10454                 MOVE ER-2609                TO WS-ERROR
 10455                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 191
* EL050.cbl
 10456
 10457 0540-NEXT-READ-STEP.
 10458     MOVE '0540' TO CTBL-SW.
 10459     MOVE ' '    TO WS-CTBL-READ-SW.
 10460
 10461 0540-GET-LF-COMP.
 10462     IF NO-LIFE-COVERAGE  OR
 10463        NO-LF-BENEFIT-MATCH
 10464           GO TO 0560-EDIT-CONTINUE.
 10465
 10466     IF WS-LF-JOINT-INDICATOR = 'J'
 10467        IF AM-J-COM (SUB1) NUMERIC
 10468           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10469           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10470           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10471           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10472           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10473        ELSE
 10474           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10475           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10476           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10477           MOVE ZEROS                TO WS-SUB1
 10478                                        WS-COMMISSION
 10479           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10480           IF WS-COMMISSION > ZEROS
 10481              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10482              GO TO 0560-EDIT-CONTINUE
 10483           END-IF
 10484           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10485           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10486           IF CTBL-TABLE-FOUND
 10487              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10488              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10489              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10490              GO TO 0560-EDIT-CONTINUE
 10491           ELSE
 10492              IF FIRST-TIME-THROUGH
 10493                  GO TO 0540-GET-LF-COMP
 10494              ELSE
 10495                  MOVE ER-2609                TO WS-ERROR
 10496                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10497                  GO TO 0560-EDIT-CONTINUE.
 10498
 10499     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10500        IF AM-L-COM (SUB1) NUMERIC
 10501           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10502           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10503           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10504           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10505           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10506        ELSE
 10507           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10508           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10509           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10510           MOVE ZEROS                TO WS-SUB1
 10511                                        WS-COMMISSION
 10512           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10513           IF WS-COMMISSION IS GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 192
* EL050.cbl
 10514              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10515              GO TO 0560-EDIT-CONTINUE
 10516           END-IF
 10517           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10518           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10519           IF CTBL-TABLE-FOUND
 10520              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10521              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10522              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10523              GO TO 0560-EDIT-CONTINUE
 10524           ELSE
 10525              IF FIRST-TIME-THROUGH
 10526                  GO TO 0540-GET-LF-COMP
 10527              ELSE
 10528                  MOVE ER-2609                TO WS-ERROR
 10529                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10530
 10531*    GO TO 0560-EDIT-CONTINUE.
 10532
 10533 0560-EDIT-CONTINUE.
 10534     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10535                                    WS-AH-PMF-COMM
 10536*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10537*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10538     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10539        (SUB1 > +10)
 10540        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10541           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10542           MOVE '0530'           TO CTBL-SW
 10543           MOVE ' '              TO WS-CTBL-READ-SW
 10544           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10545           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10546           MOVE '0540'           TO CTBL-SW
 10547           MOVE ' '              TO WS-CTBL-READ-SW
 10548           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10549        END-IF
 10550     END-PERFORM
 10551     GO TO 0564-EDIT-CONTINUE
 10552     .
 10553 0561-CHECK-AH.
 10554     IF (NO-AH-COVERAGE)
 10555        OR (NO-AH-BENEFIT-MATCH)
 10556        CONTINUE
 10557     ELSE
 10558        IF (AM-A-COM (SUB1) NUMERIC)
 10559           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10560           IF (AM-COM-TYP (SUB1) = 'A')
 10561              AND (WS-AH-PMF-COMM = ZEROS)
 10562              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10563           END-IF
 10564           CONTINUE
 10565        ELSE
 10566           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10567           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10568           MOVE PB-AH-OVERRIDE-L1
 10569                                 TO CTBL-BEN-TYPE
 10570           MOVE ZEROS            TO WS-SUB1
 10571                                    WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 193
* EL050.cbl
 10572           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10573           PERFORM 8300-READ-CTBL-TABLE
 10574                                 THRU 8300-EXIT
 10575           IF CTBL-TABLE-FOUND
 10576              IF (AM-COM-TYP (SUB1) = 'A')
 10577                 AND (WS-AH-PMF-COMM = ZEROS)
 10578                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10579                                        PB-I-AH-TERM
 10580                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10581                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10582              END-IF
 10583              CONTINUE
 10584           ELSE
 10585              IF FIRST-TIME-THROUGH
 10586                 GO TO 0561-CHECK-AH
 10587              ELSE
 10588                 MOVE ER-2609    TO WS-ERROR
 10589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10590              END-IF
 10591           END-IF
 10592        END-IF
 10593     END-IF
 10594     .
 10595 0561-EXIT.
 10596     EXIT.
 10597 0563-CHECK-LF.
 10598     IF (NO-LIFE-COVERAGE)
 10599        OR (NO-LF-BENEFIT-MATCH)
 10600        CONTINUE
 10601     ELSE
 10602        IF WS-LF-JOINT-INDICATOR = 'J'
 10603           IF AM-J-COM (SUB1) NUMERIC
 10604              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10605              IF (AM-COM-TYP (SUB1) = 'A')
 10606                 AND (WS-LF-PMF-COMM = ZEROS)
 10607                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10608              END-IF
 10609              CONTINUE
 10610           ELSE
 10611              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10612              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10613              MOVE PB-LIFE-OVERRIDE-L1
 10614                                 TO CTBL-BEN-TYPE
 10615              MOVE ZEROS         TO WS-SUB1
 10616                                    WS-COMMISSION
 10617              MOVE AM-J-COMA (SUB1)
 10618                                 TO CTBL-TABLE
 10619              PERFORM 8300-READ-CTBL-TABLE
 10620                                 THRU 8300-EXIT
 10621              IF CTBL-TABLE-FOUND
 10622                 IF (AM-COM-TYP (SUB1) = 'A')
 10623                    AND (WS-LF-PMF-COMM = ZEROS)
 10624                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10625                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10626                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10627                 END-IF
 10628                 CONTINUE
 10629              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 194
* EL050.cbl
 10630                 IF FIRST-TIME-THROUGH
 10631                    GO TO 0563-CHECK-LF
 10632                 ELSE
 10633                    MOVE ER-2609 TO WS-ERROR
 10634                    PERFORM 9900-ERROR-FORMAT
 10635                                 THRU 9900-EXIT
 10636*                   GO TO 0560-EDIT-CONTINUE
 10637                 END-IF
 10638              END-IF
 10639           END-IF
 10640        ELSE
 10641           IF AM-L-COM (SUB1) NUMERIC
 10642              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10643              IF (AM-COM-TYP (SUB1) = 'A')
 10644                 AND (WS-LF-PMF-COMM = ZEROS)
 10645                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10646              END-IF
 10647              CONTINUE
 10648           ELSE
 10649              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10650              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10651              MOVE PB-LIFE-OVERRIDE-L1
 10652                                 TO CTBL-BEN-TYPE
 10653              MOVE ZEROS         TO WS-SUB1
 10654                                    WS-COMMISSION
 10655              MOVE AM-L-COMA (SUB1)
 10656                                 TO CTBL-TABLE
 10657              PERFORM 8300-READ-CTBL-TABLE
 10658                                 THRU 8300-EXIT
 10659              IF CTBL-TABLE-FOUND
 10660                 CONTINUE
 10661              ELSE
 10662                 IF FIRST-TIME-THROUGH
 10663                    GO TO 0563-CHECK-LF
 10664                 ELSE
 10665                    MOVE ER-2609 TO WS-ERROR
 10666                    PERFORM 9900-ERROR-FORMAT
 10667                                 THRU 9900-EXIT
 10668                 END-IF
 10669              END-IF
 10670           END-IF
 10671        END-IF
 10672     END-IF
 10673     .
 10674 0563-EXIT.
 10675     EXIT.
 10676 0564-EDIT-CONTINUE.
 10677
 10678     IF  PB-COMPANY-ID EQUAL 'DMD'
 10679         IF PB-I-NUM-BILLED EQUAL ZEROS
 10680            MOVE ER-8148       TO WS-ERROR
 10681            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10682
 10683*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10684*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10685*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10686*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10687*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 195
* EL050.cbl
 10688*         IF NO-CONVERSION-ERROR
 10689*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10690*         ELSE
 10691*             IF PB-COMPANY-ID EQUAL 'HAN'
 10692*                 MOVE ZEROS     TO PB-I-AGE.
 10693     IF PB-I-BIRTHDAY > LOW-VALUES
 10694        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10695        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10696        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10697        PERFORM 8500-DATE-CONVERT
 10698                                 THRU 8500-EXIT
 10699        IF NO-CONVERSION-ERROR
 10700           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10701           IF PB-I-AGE > ZEROS
 10702              IF WS-WORK-AGE NOT = PB-I-AGE
 10703                 MOVE ER-9501    TO WS-ERROR
 10704                 PERFORM 9900-ERROR-FORMAT
 10705                                 THRU 9900-EXIT
 10706              END-IF
 10707           ELSE
 10708              MOVE WS-WORK-AGE   TO PB-I-AGE
 10709           END-IF
 10710        END-IF
 10711     END-IF
 10712     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10713                                   WS-INS-AGE-SET
 10714     IF PB-I-AGE = ZEROS
 10715        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10716           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10717                                   WS-INS-AGE-SET
 10718           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10719
 10720     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10721                                   WS-AH-EDIT-AGE.
 10722
 10723     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10724        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10725        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10726        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10727        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10728        IF NO-CONVERSION-ERROR
 10729           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10730           IF PB-I-JOINT-AGE > 0
 10731              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10732                 MOVE ER-9503    TO WS-ERROR
 10733                 PERFORM 9900-ERROR-FORMAT
 10734                                 THRU 9900-EXIT
 10735              END-IF
 10736           ELSE
 10737              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10738           END-IF
 10739        ELSE
 10740           MOVE ZEROS            TO PB-I-JOINT-AGE
 10741        END-IF
 10742     END-IF
 10743     IF PB-I-JOINT-AGE NOT NUMERIC
 10744        MOVE ZERO               TO PB-I-JOINT-AGE.
 10745
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 196
* EL050.cbl
 10746     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10747                                   WS-JNT-AGE-SET
 10748     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10749        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10750           (WS-AH-JOINT-INDICATOR = 'J')
 10751           IF PB-I-JOINT-AGE = ZEROS
 10752               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10753                                          WS-JNT-AGE-SET
 10754               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10755           END-IF
 10756        END-IF
 10757     END-IF
 10758
 10759     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10760     IF WS-LF-JOINT-INDICATOR = 'J'
 10761        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10762        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10763            IF  PB-I-JOINT-AGE = ZERO
 10764                MOVE ER-2686       TO WS-ERROR
 10765                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10766            ELSE
 10767                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10768                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10769                    IF PB-COMPANY-ID NOT = 'LBL'
 10770                        MOVE ER-2685    TO WS-ERROR
 10771                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10772
 10773     IF WS-AH-JOINT-INDICATOR = 'J'
 10774        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10775            IF  PB-I-JOINT-AGE = ZERO
 10776                MOVE ER-2686       TO WS-ERROR
 10777                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10778            ELSE
 10779                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10780                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10781                                           WS-EDIT-AGE
 10782                    IF PB-COMPANY-ID NOT = 'LBL'
 10783                        MOVE ER-2685    TO WS-ERROR
 10784                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786******************************************************************
 10787*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10788******************************************************************
 10789
 10790     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10791        (WS-AH-SPECIAL-CALC-CD = 'O')
 10792        NEXT SENTENCE
 10793     ELSE
 10794        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10795          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10796           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10797            WS-AH-JOINT-INDICATOR = 'J')  AND
 10798           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10799            MOVE ER-2627             TO WS-ERROR
 10800            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10801
 10802     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10803        (WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 197
* EL050.cbl
 10804         NEXT SENTENCE
 10805     ELSE
 10806         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10807            WS-AH-JOINT-INDICATOR = 'J'
 10808             IF PB-I-JOINT-INSURED = SPACES
 10809                 IF PB-COMPANY-ID NOT = 'JAL'
 10810                     MOVE ER-2696    TO WS-ERROR
 10811                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10812
 10813     IF PB-COMPANY-ID NOT = 'BOA'
 10814        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10815           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10816           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10817               PB-I-JOINT-INSURED NOT = SPACES)
 10818                MOVE ER-2691         TO WS-ERROR
 10819                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10820
 10821     IF PB-COMPANY-ID = 'BOA'
 10822        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10823           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10824            IF PB-I-JOINT-AGE NOT = ZEROS
 10825                MOVE ER-2691         TO WS-ERROR
 10826                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10827
 10828     IF PB-COMPANY-ID = 'CRI'
 10829        IF PB-I-SIG-SW = 'J'
 10830           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10831              WS-AH-JOINT-INDICATOR NOT = 'J'
 10832              MOVE ER-2675       TO WS-ERROR
 10833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10834
 10835     IF PB-COMPANY-ID = 'CRI'
 10836        IF PB-I-SIG-SW = 'S'
 10837           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10838              WS-AH-JOINT-INDICATOR = 'J'
 10839              MOVE ER-2676       TO WS-ERROR
 10840              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10841
 10842     IF PB-COMPANY-ID = 'CVL'
 10843         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10844            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10845              MOVE ER-2783           TO WS-ERROR
 10846              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10847     IF (WS-LF-JOINT-INDICATOR = 'J')
 10848        AND (WS-AH-JOINT-INDICATOR = 'J')
 10849        AND (PB-I-LF-TERM > 120)
 10850        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10851        MOVE ER-2783             TO WS-ERROR
 10852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10853     END-IF
 10854     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10855
 10856     IF PB-I-INDV-GRP-OVRD = 'I'
 10857        MOVE ER-2666             TO WS-ERROR
 10858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10859        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10860
 10861     IF PB-I-INDV-GRP-OVRD = 'G'
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 198
* EL050.cbl
 10862        MOVE ER-2666             TO WS-ERROR
 10863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10864        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10865
 10866     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10867        NEXT SENTENCE
 10868     ELSE
 10869        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10870
 10871     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10872        IF WS-ERROR = ER-2666
 10873           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10874           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10875
 10876     IF PB-COMPANY-ID = 'CID'
 10877        IF PB-STATE = 'UT' OR 'MO'
 10878           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10879                 OR '76' OR '77')
 10880                      OR
 10881               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10882                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10883                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10884                   OR '2K' OR '2L'))
 10885              AND PB-I-INDV-GRP-CD = 'I'
 10886              MOVE ER-2721             TO WS-ERROR
 10887              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10888           END-IF
 10889        END-IF
 10890     END-IF
 10891
 10892     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10893     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10894        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10895     ELSE
 10896        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10897     END-IF
 10898
 10899*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10900*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10901     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10902                                    ACCOUNT-AH-CK-SW.
 10903
 10904     IF PB-REISSUED-CERT       OR
 10905        PB-REIN-ONLY-CERT      OR
 10906        PB-POLICY-IS-DECLINED  OR
 10907        PB-POLICY-IS-VOIDED
 10908*       OR PB-MONTHLY-CERT
 10909         GO TO 3000-CONTINUE-EDIT.
 10910
 10911     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10912        IF WS-EDIT-AGE           > +65
 10913           MOVE ER-2709          TO WS-ERROR
 10914           PERFORM 9900-ERROR-FORMAT
 10915                                 THRU 9900-EXIT
 10916        ELSE
 10917           IF WS-EDIT-AGE        > +55
 10918              MOVE ER-2718       TO WS-ERROR
 10919              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 199
* EL050.cbl
 10920                                 THRU 9900-EXIT
 10921           END-IF
 10922        END-IF
 10923     IF PB-COMPANY-ID = 'DCC'
 10924        IF WS-EDIT-AGE           > +65
 10925           MOVE ER-2709          TO WS-ERROR
 10926           PERFORM 9900-ERROR-FORMAT
 10927                                 THRU 9900-EXIT
 10928        END-IF
 10929     END-IF
 10930     .
 10931
 10932 0565-LIFE-PLAN-LIMIT-EDITS.
 10933
 10934     IF NOT LF-PLAN-MASTER-FOUND
 10935        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10936                                    EC-AM-LF-MAX-TOT-BEN
 10937        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10938
 10939     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10940
 10941     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10942         IF PL-LM-AGE (1) = ZEROS
 10943             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10944
 10945     IF NO-LF-BENEFIT-MATCH          OR
 10946        WS-LF-BENEFIT-CD = ZEROS     OR
 10947        WS-LF-SPECIAL-CALC-CD = 'M'
 10948        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10949
 10950     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10951     MOVE +1                     TO SUB2.
 10952
 10953     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10954        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10955           MOVE +5   TO SUB2
 10956           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10957              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10958              (PL-LM-AGE (SUB2) EQUAL +0)
 10959              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10960              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10961
 10962     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10963
 10964     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10965                               + PB-I-LF-ALT-BENEFIT-AMT.
 10966
 10967 0568-CHECK-LIFE-ATT-AGE.
 10968
 10969     IF PL-ATT-AGE NUMERIC AND
 10970        PL-ATT-AGE > +0
 10971        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10972     END-IF
 10973*    IF PL-ATT-AGE NUMERIC AND
 10974*       PL-ATT-AGE > +0
 10975*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10976*       IF PB-I-BIRTHDAY > LOW-VALUES
 10977*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 200
* EL050.cbl
 10978*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10979*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10980*          SET BIN-PLUS-ELAPSED  TO TRUE
 10981*          PERFORM 8500-DATE-CONVERT
 10982*                                THRU 8500-EXIT
 10983*          IF NO-CONVERSION-ERROR
 10984*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10985*             MOVE ER-2669       TO WS-ERROR
 10986*             PERFORM 9900-ERROR-FORMAT
 10987*                                THRU 9900-EXIT
 10988*          END-IF
 10989*       ELSE
 10990*          IF WS-ATT-AGE >= PL-ATT-AGE
 10991*             MOVE ER-2669       TO WS-ERROR
 10992*             PERFORM 9900-ERROR-FORMAT
 10993*                                THRU 9900-EXIT
 10994*          END-IF
 10995*       END-IF
 10996*    END-IF
 10997     .
 10998 0570-CHECK-LIFE-LIMITS.
 10999
 11000     IF PB-COMPANY-ID EQUAL 'CRI'
 11001        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11002           IF SUB2 GREATER THAN +4
 11003              MOVE ER-2637 TO WS-ERROR
 11004              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11005              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11006
 11007     IF PB-COMPANY-ID  =  'NCL'
 11008        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11009            SUB2 GREATER THAN +8
 11010             MOVE 'U'         TO PB-BATCH-ENTRY
 11011             MOVE ER-2637     TO WS-ERROR
 11012             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11013             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11014
 11015     IF SUB2 > +8
 11016        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11017           AND (PB-I-SIG-SW = 'Y')
 11018           CONTINUE
 11019        ELSE
 11020           MOVE ER-2637          TO WS-ERROR
 11021           PERFORM 9900-ERROR-FORMAT
 11022                                 THRU 9900-EXIT
 11023        END-IF
 11024        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11025     END-IF
 11026     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11027     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11028     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11029
 11030     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11031        ADD +1  TO SUB2
 11032        GO TO 0570-CHECK-LIFE-LIMITS.
 11033
 11034     IF PB-COMPANY-ID = 'NCL'
 11035         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 201
* EL050.cbl
 11036
 11037     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11038        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11039        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11040           AND (PB-I-SIG-SW = 'Y')
 11041           CONTINUE
 11042        ELSE
 11043           MOVE ER-2637          TO WS-ERROR
 11044           PERFORM 9900-ERROR-FORMAT
 11045                                 THRU 9900-EXIT
 11046        END-IF
 11047     END-IF
 11048     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11049
 11050
 11051 0570-CHECK-NCL-LIFE-LIMITS.
 11052
 11053     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11054        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11055         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11056
 11057     IF APP-CERT-USED
 11058         IF SUB2  LESS THAN  +5
 11059             MOVE +5          TO SUB2
 11060             GO TO 0570-CHECK-LIFE-LIMITS.
 11061
 11062     MOVE ER-2637             TO WS-ERROR.
 11063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11064
 11065     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11066
 11067 0575-CHECK-NCL-SIG-SWITCH.
 11068
 11069     IF NOT APP-CERT-USED
 11070         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11071
 11072     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11073        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11074        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11075        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11076         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11077
 11078     IF SUB2 GREATER THAN +4
 11079         IF PL-LM-AGE (5) = ZEROS  AND
 11080            PL-LM-AGE (6) = ZEROS  AND
 11081            PL-LM-AGE (7) = ZEROS  AND
 11082            PL-LM-AGE (8) = ZEROS
 11083             MOVE  ER-1927        TO WS-ERROR
 11084             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11085             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11086         ELSE
 11087             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11088                 MOVE  ER-1920    TO WS-ERROR
 11089                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11090
 11091     IF PB-I-SIG-SW  = 'Y'
 11092       IF NOT PB-I-POLICY-ACCEPTED  AND
 11093          NOT PB-I-POLICY-DECLINED
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 202
* EL050.cbl
 11094           MOVE 'U'               TO PB-BATCH-ENTRY
 11095           MOVE  ER-1926          TO WS-ERROR
 11096           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11097
 11098
 11099 0580-AH-PLAN-LIMIT-EDITS.
 11100
 11101     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11102        IF PB-I-AH-BENEFIT-AMT > +1250
 11103           MOVE ER-2702          TO WS-ERROR
 11104           PERFORM 9900-ERROR-FORMAT
 11105                                 THRU 9900-EXIT
 11106        END-IF
 11107     END-IF
 11108
 11109     IF (PB-COMPANY-ID = 'DCC')
 11110        AND (PB-MONTHLY-CERT)
 11111        IF PB-I-AH-BENEFIT-AMT > +3000
 11112           MOVE ER-2881          TO WS-ERROR
 11113           PERFORM 9900-ERROR-FORMAT
 11114                                 THRU 9900-EXIT
 11115        END-IF
 11116     END-IF
 11117     IF NOT AH-PLAN-MASTER-FOUND
 11118        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11119        GO TO 3000-CONTINUE-EDIT.
 11120
 11121     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11122
 11123     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11124         IF PL-LM-AGE (1) = ZEROS
 11125             GO TO 3000-CONTINUE-EDIT.
 11126
 11127     IF NO-AH-BENEFIT-MATCH          OR
 11128        WS-AH-BENEFIT-CD = ZEROS     OR
 11129        WS-AH-SPECIAL-CALC-CD = 'M'
 11130        GO TO 3000-CONTINUE-EDIT.
 11131
 11132     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11133     MOVE +1                     TO SUB2.
 11134
 11135     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11136        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11137           MOVE +5 TO SUB2
 11138           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11139              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11140              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11141              (PL-LM-AGE (SUB2) EQUAL +0)
 11142              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11143              GO TO 3000-CONTINUE-EDIT.
 11144
 11145     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11146
 11147 0590-CHECK-AH-ATT-AGE.
 11148
 11149     IF PL-ATT-AGE NUMERIC AND
 11150        PL-ATT-AGE GREATER THAN +0
 11151        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 203
* EL050.cbl
 11152     END-IF
 11153*       IF WS-ATT-AGE >= PL-ATT-AGE
 11154*          MOVE ER-3054          TO WS-ERROR
 11155*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11156     .
 11157 0597-CHECK-AH-LIMITS.
 11158
 11159     IF PB-COMPANY-ID EQUAL 'CRI'
 11160        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11161           IF SUB2 GREATER THAN +4
 11162              MOVE ER-2638       TO WS-ERROR
 11163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11164              GO TO 3000-CONTINUE-EDIT.
 11165
 11166     IF PB-COMPANY-ID  =  'NCL'
 11167        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11168            SUB2 GREATER THAN +8
 11169             MOVE 'U'            TO PB-BATCH-ENTRY
 11170             MOVE ER-2638        TO WS-ERROR
 11171             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11172             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11173
 11174     IF SUB2 > +8
 11175        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11176           AND (PB-I-SIG-SW = 'Y')
 11177           CONTINUE
 11178        ELSE
 11179           MOVE ER-2638          TO WS-ERROR
 11180           PERFORM 9900-ERROR-FORMAT
 11181                                 THRU 9900-EXIT
 11182        END-IF
 11183        GO TO 3000-CONTINUE-EDIT
 11184     END-IF
 11185
 11186     IF PB-COMPANY-ID = 'CRI'
 11187        IF WS-ERROR = ER-2638
 11188           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11189
 11190     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11191     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11192     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11193     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11194
 11195     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11196        ADD +1                   TO SUB2
 11197        GO TO 0597-CHECK-AH-LIMITS.
 11198
 11199     IF PB-COMPANY-ID = 'NCL'
 11200         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11201
 11202     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11203        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11204        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11205                                 > PL-LM-AMT (SUB2))
 11206        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11207           AND (PB-I-SIG-SW = 'Y')
 11208           CONTINUE
 11209        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 204
* EL050.cbl
 11210           MOVE ER-2638          TO WS-ERROR
 11211           PERFORM 9900-ERROR-FORMAT
 11212                                 THRU 9900-EXIT
 11213        END-IF
 11214     END-IF
 11215
 11216     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11217         IF  WS-ERROR    EQUAL    ER-2638
 11218             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11219                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11220                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11221                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11222                MOVE  ER-1910    TO  WS-ERROR
 11223                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11224
 11225     IF PB-COMPANY-ID = 'CRI'
 11226        IF WS-ERROR = ER-2638
 11227            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11228            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11229            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11230
 11231     GO TO 3000-CONTINUE-EDIT.
 11232
 11233 0597-CHECK-NCL-AH-LIMITS.
 11234
 11235     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11236        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11237        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11238                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11239         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11240
 11241     IF APP-CERT-USED
 11242         IF SUB2  LESS THAN  +5
 11243             MOVE +5             TO SUB2
 11244             GO TO 0597-CHECK-AH-LIMITS.
 11245
 11246     MOVE ER-2638                TO WS-ERROR.
 11247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11248
 11249     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11250
 11251 0599-CHECK-NCL-SIG-SWITCH.
 11252
 11253     IF NOT APP-CERT-USED
 11254         GO TO 3000-CONTINUE-EDIT.
 11255
 11256     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11257        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11258        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11259        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11260         GO TO 3000-CONTINUE-EDIT.
 11261
 11262     IF SUB2 GREATER THAN +4
 11263         IF PL-LM-AGE (5) = ZEROS  AND
 11264            PL-LM-AGE (6) = ZEROS  AND
 11265            PL-LM-AGE (7) = ZEROS  AND
 11266            PL-LM-AGE (8) = ZEROS
 11267             MOVE  ER-1927        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 205
* EL050.cbl
 11268             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11269             GO TO 3000-CONTINUE-EDIT
 11270         ELSE
 11271             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11272                 MOVE  ER-1920    TO WS-ERROR
 11273                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11274
 11275     IF PB-I-SIG-SW  = 'Y'
 11276       IF NOT PB-I-POLICY-ACCEPTED  AND
 11277          NOT PB-I-POLICY-DECLINED
 11278           MOVE 'U'               TO PB-BATCH-ENTRY
 11279           MOVE  ER-1926          TO WS-ERROR
 11280           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11281
 11282******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 206
* EL050.cbl
 11284
 11285 3000-CONTINUE-EDIT.
 11286
 11287     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11288     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11289     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11290     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11291     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11292
 11293     IF BROWSE-STARTED
 11294        PERFORM 9990-RETURN THRU 9990-EXIT
 11295        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11296
 11297     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11298        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11299        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11300        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11301*       MOVE 1                   TO DC-OPTION-CODE
 11302        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11303        IF DATE-CONVERSION-ERROR
 11304           MOVE ER-2622          TO WS-ERROR
 11305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11306        ELSE
 11307           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11308              MOVE ER-2623       TO WS-ERROR
 11309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310           ELSE
 11311              MOVE ER-2622       TO WS-ERROR
 11312              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11313
 11314     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11315     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11316     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11317*    MOVE 1                      TO DC-OPTION-CODE.
 11318     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11319     IF DATE-CONVERSION-ERROR
 11320        GO TO 3005-EDIT-CONTINUE
 11321     ELSE
 11322        IF DC-ELAPSED-DAYS GREATER +180
 11323           MOVE ER-2613          TO WS-ERROR
 11324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        ELSE
 11326           IF DC-ELAPSED-DAYS GREATER +90
 11327              MOVE ER-2612       TO WS-ERROR
 11328              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11329           ELSE
 11330             IF DC-ELAPSED-DAYS GREATER +60
 11331                MOVE ER-2614     TO WS-ERROR
 11332                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11333
 11334 3005-EDIT-CONTINUE.
 11335
 11336     IF PB-CANCELLATION
 11337         GO TO 3700-EDIT-CANCEL.
 11338
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 207
* EL050.cbl
 11340******************************************************************
 11341*                  E D I T   I S S U E                           *
 11342******************************************************************
 11343
 11344 3020-EDIT-ISSUE.
 11345
 11346      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11347      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11348      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11349      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11350      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11351
 11352     IF PB-ISSUE-FORCE
 11353        OR PB-ISSUE-DATE-FORCED
 11354        OR PB-FORCE-OFF
 11355        OR PB-OVERCHARGE-FORCE
 11356        CONTINUE
 11357     ELSE
 11358        MOVE ER-2670             TO WS-ERROR
 11359        PERFORM 9900-ERROR-FORMAT
 11360                                 THRU 9900-EXIT
 11361     END-IF
 11362     .
 11363 3022-SET-POLICY-STATUS.
 11364
 11365     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11366
 11367     IF (PB-REISSUED-CERT)
 11368             OR
 11369        ((PB-COMPANY-ID NOT = 'DCC')
 11370         AND (PB-MONTHLY-CERT))
 11371         MOVE '5'                TO PB-I-ENTRY-STATUS
 11372         MOVE 'E'                TO PB-BATCH-ENTRY
 11373     END-IF
 11374
 11375     IF PB-COMPANY-ID = 'DCC'
 11376        IF PB-MONTHLY-CERT
 11377           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11378        END-IF
 11379        IF PB-CASH-CERT
 11380           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11381        END-IF
 11382     END-IF
 11383     IF PB-POLICY-IS-DECLINED
 11384         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11385     IF PB-POLICY-IS-VOIDED
 11386         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11387     IF PB-NEEDS-UNDERWRITING
 11388         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11389     IF PB-REIN-ONLY-CERT
 11390         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11391     IF PB-PREM-ACCTNG-ONLY
 11392         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11393
 11394     MOVE SPACE                  TO PB-I-OB-FLAG.
 11395
 11396     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11397         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 208
* EL050.cbl
 11398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11400
 11401     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11402        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11403           MOVE 'Z'             TO PB-I-OB-FLAG.
 11404
 11405     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11406        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11407           MOVE 'Z'             TO PB-I-OB-FLAG.
 11408
 11409     IF ACCOUNT-MAST-FOUND
 11410         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11411         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11412         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11413         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11414         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11415         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11416         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11417     END-IF
 11418
 11419     IF ACCOUNT-MAST-FOUND
 11420        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11421         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11422
 11423     IF (ACCOUNT-MAST-FOUND)
 11424        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11425        IF PB-REISSUED-CERT
 11426           CONTINUE
 11427        ELSE
 11428           MOVE ER-2608          TO WS-ERROR
 11429           PERFORM 9900-ERROR-FORMAT
 11430                                 THRU 9900-EXIT
 11431         END-IF
 11432     END-IF
 11433
 11434     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11435        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11436        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11437
 11438**********   DMD CUSTOM CODE FOLLOWS  **********
 11439 3024-EDIT-DMD-FIELDS.
 11440     IF PB-COMPANY-ID NOT = 'DMD'
 11441        GO TO 3025-EDIT-REINSURANCE.
 11442
 11443*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11444*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11445*** ERROR IF THEY ARE NOT EQUAL.
 11446
 11447     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11448     SET BIN-TO-GREG               TO TRUE.
 11449     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11450     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11451**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11452
 11453     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11454     SET BIN-TO-GREG               TO TRUE.
 11455     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 209
* EL050.cbl
 11456     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11457**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11458
 11459     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11460        MOVE ER-8116               TO WS-ERROR
 11461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11462
 11463     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11464
 11465     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11466                                      WK-FULL-CERT-NO.
 11467     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11468
 11469     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11470
 11471     IF PB-VALID-LIFE
 11472        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11473     ELSE
 11474        IF PB-VALID-AH
 11475          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11476
 11477
 11478     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11479     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11480     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11481                                      DCUA-UNDRWRTR-CODE
 11482                                      DCUA-UNDRWRTR-GROUP-CODE
 11483                                      DCUA-RETURN-CODE.
 11484
 11485****************************************************************
 11486*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11487***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11488***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11489***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11490***   TO THIS RECORD.                                        ***
 11491****************************************************************
 11492     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11493     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11494     IF DCUA-SUCCESSFUL-PROCESS
 11495        GO TO 3024-EDIT-DL7-CONT.
 11496
 11497     IF DCUA-RETURN-CODE EQUAL '01'
 11498        MOVE ER-8110               TO WS-ERROR
 11499        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11501        GO TO 3024-EDIT-DL7-CONT.
 11502
 11503     IF DCUA-RETURN-CODE EQUAL '02'
 11504        MOVE ER-8111               TO WS-ERROR
 11505        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL7-CONT.
 11508
 11509     IF DCUA-RETURN-CODE EQUAL '03'
 11510        MOVE ER-8074               TO WS-ERROR
 11511        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11513        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 210
* EL050.cbl
 11514
 11515     IF DCUA-RETURN-CODE EQUAL '04'
 11516        MOVE ER-8075               TO WS-ERROR
 11517        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11519        GO TO 3024-EDIT-DL7-CONT.
 11520
 11521     IF DCUA-RETURN-CODE EQUAL '05'
 11522        MOVE ER-8076               TO WS-ERROR
 11523        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11525        GO TO 3024-EDIT-DL7-CONT.
 11526
 11527     IF DCUA-RETURN-CODE EQUAL '06'
 11528        MOVE ER-8077               TO WS-ERROR
 11529        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL7-CONT.
 11532
 11533     IF DCUA-RETURN-CODE EQUAL '07'
 11534        MOVE ER-8078               TO WS-ERROR
 11535        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL7-CONT.
 11538
 11539     IF DCUA-RETURN-CODE EQUAL 'E1'
 11540        MOVE ER-8079               TO WS-ERROR
 11541        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11543        GO TO 3024-EDIT-DL7-CONT.
 11544
 11545     IF DCUA-RETURN-CODE EQUAL 'E2'
 11546        MOVE ER-8080               TO WS-ERROR
 11547        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549        GO TO 3024-EDIT-DL7-CONT.
 11550
 11551     IF DCUA-RETURN-CODE EQUAL 'E3'
 11552        MOVE ER-8098               TO WS-ERROR
 11553        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11555        GO TO 3024-EDIT-DL7-CONT.
 11556
 11557     IF DCUA-RETURN-CODE EQUAL 'C1'
 11558        MOVE ER-8099               TO WS-ERROR
 11559        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL7-CONT.
 11562
 11563     IF DCUA-RETURN-CODE EQUAL 'U1'
 11564        MOVE ER-8109               TO WS-ERROR
 11565        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL7-CONT.
 11568
 11569     IF DCUA-RETURN-CODE EQUAL 'N1'
 11570        MOVE ER-8112               TO WS-ERROR
 11571        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 211
* EL050.cbl
 11572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573        GO TO 3024-EDIT-DL7-CONT.
 11574
 11575     IF DCUA-RETURN-CODE EQUAL 'N2'
 11576        MOVE ER-8113               TO WS-ERROR
 11577        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579        GO TO 3024-EDIT-DL7-CONT.
 11580
 11581     IF DCUA-RETURN-CODE EQUAL 'N3'
 11582        MOVE ER-8114               TO WS-ERROR
 11583        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL7-CONT.
 11586
 11587     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11588     MOVE ER-8097                  TO WS-ERROR.
 11589     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11590     GO TO 3024-EDIT-DL7-CONT.
 11591
 11592 3024-EDIT-DL7-CONT.
 11593
 11594     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11595     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11596     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11597        NEXT SENTENCE
 11598     ELSE
 11599        MOVE ER-9263               TO WS-ERROR
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11601
 11602******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11603******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11604     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11605        NEXT SENTENCE
 11606     ELSE
 11607        MOVE ER-8039               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11609
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 212
* EL050.cbl
 11611****************************************************************
 11612*** VALIDATE STATE  : DLO022                                 ***
 11613****************************************************************
 11614     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11615     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11616
 11617     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11618     IF DVSC-SUCCESSFUL-EDIT
 11619        GO TO 3024-EDIT-DL22-CONT.
 11620
 11621     IF DVSC-RETURN-CODE EQUAL '01'
 11622        MOVE ER-8300               TO WS-ERROR
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL22-CONT.
 11625
 11626     IF DVSC-RETURN-CODE EQUAL '02'
 11627        MOVE ER-8301               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11629        GO TO 3024-EDIT-DL22-CONT.
 11630
 11631     IF DVSC-RETURN-CODE EQUAL '03'
 11632        MOVE ER-8302               TO WS-ERROR
 11633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11634        GO TO 3024-EDIT-DL22-CONT.
 11635
 11636     IF DVSC-RETURN-CODE EQUAL 'N1'
 11637        MOVE ER-8304               TO WS-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11639        GO TO 3024-EDIT-DL22-CONT.
 11640
 11641     MOVE ER-8303                  TO WS-ERROR
 11642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11643
 11644 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 213
* EL050.cbl
 11646****************************************************************
 11647*** VALIDATE LOAN OFFICER : DLO021                           ***
 11648****************************************************************
 11649
 11650     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11651     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11652     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11653     IF DVLO-SUCCESSFUL-EDIT
 11654        GO TO 3024-EDIT-DL21-CONT.
 11655
 11656     IF DVLO-RETURN-CODE EQUAL '01'
 11657        MOVE ER-8081               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL21-CONT.
 11660
 11661     IF DVLO-RETURN-CODE EQUAL '02'
 11662        MOVE ER-8082               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL21-CONT.
 11665
 11666     IF DVLO-RETURN-CODE EQUAL '03'
 11667        MOVE ER-8083               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL21-CONT.
 11670
 11671     IF DVLO-RETURN-CODE EQUAL '04'
 11672        MOVE ER-8084               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL21-CONT.
 11675
 11676     IF DVLO-RETURN-CODE EQUAL '05'
 11677        MOVE ER-8085               TO WS-ERROR
 11678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679        GO TO 3024-EDIT-DL21-CONT.
 11680
 11681     MOVE ER-7825                  TO WS-ERROR
 11682     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11683     GO TO 3024-EDIT-DL21-CONT.
 11684
 11685 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 214
* EL050.cbl
 11687
 11688****************************************************************
 11689*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11690****************************************************************
 11691
 11692     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11693     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11694     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11695     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11696     IF DIPF-SUCCESSFUL-EDIT
 11697        GO TO 3024-EDIT-DL02-CONT.
 11698
 11699     IF DIPF-RETURN-CODE EQUAL '01'
 11700        MOVE ER-8086               TO WS-ERROR
 11701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702        GO TO 3024-EDIT-DL02-CONT.
 11703
 11704     IF DIPF-RETURN-CODE EQUAL '02'
 11705        MOVE ER-8087               TO WS-ERROR
 11706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707        GO TO 3024-EDIT-DL02-CONT.
 11708
 11709     IF DIPF-RETURN-CODE EQUAL '03'
 11710        MOVE ER-8088               TO WS-ERROR
 11711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11712        GO TO 3024-EDIT-DL02-CONT.
 11713
 11714     MOVE ER-8095                  TO WS-ERROR
 11715     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11716     GO TO 3024-EDIT-DL02-CONT.
 11717
 11718 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 215
* EL050.cbl
 11720
 11721****************************************************************
 11722*** VALIDATE BANK ID : DLO003                                ***
 11723****************************************************************
 11724
 11725     MOVE WK-GREG-CENT           TO WCG-CENT.
 11726     MOVE WK-GREG-YYMM           TO WCG-REST.
 11727     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11728        MOVE ER-8040               TO WS-ERROR
 11729        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11730
 11731     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11732     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11733     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11734     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11735     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11736     IF DVBI-SUCCESSFUL-EDIT
 11737        GO TO 3024-EDIT-DL03-CONT.
 11738
 11739     IF DVBI-RETURN-CODE EQUAL '01'
 11740        MOVE ER-8089               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL03-CONT.
 11743
 11744     IF DVBI-RETURN-CODE EQUAL '02'
 11745        MOVE ER-8090               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL03-CONT.
 11748
 11749     IF DVBI-RETURN-CODE EQUAL '03'
 11750        MOVE ER-8091               TO WS-ERROR
 11751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752        GO TO 3024-EDIT-DL03-CONT.
 11753
 11754     IF DVBI-RETURN-CODE EQUAL '04'
 11755        MOVE ER-8092               TO WS-ERROR
 11756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757        GO TO 3024-EDIT-DL03-CONT.
 11758
 11759     IF DVBI-RETURN-CODE EQUAL '05'
 11760        MOVE ER-8093               TO WS-ERROR
 11761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762        GO TO 3024-EDIT-DL03-CONT.
 11763
 11764     IF DVBI-RETURN-CODE EQUAL '06'
 11765        MOVE ER-8094               TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767        GO TO 3024-EDIT-DL03-CONT.
 11768
 11769     MOVE ER-8096                  TO WS-ERROR
 11770     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11771     GO TO 3024-EDIT-DL03-CONT.
 11772
 11773 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 216
* EL050.cbl
 11775
 11776     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11777        NEXT SENTENCE
 11778     ELSE
 11779        MOVE ER-8042               TO WS-ERROR
 11780        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11781
 11782     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11783     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11784     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11785
 11786     IF DMPF-RETURN-CODE = '01'
 11787        MOVE ER-8067               TO WS-ERROR
 11788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11789        GO TO 3024-EDIT-DL01-CONT.
 11790
 11791     IF DMPF-RETURN-CODE = '02'
 11792        MOVE ER-8068               TO WS-ERROR
 11793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11794        GO TO 3024-EDIT-DL01-CONT.
 11795
 11796     IF DMPF-RETURN-CODE = '03'
 11797        MOVE ER-8069               TO WS-ERROR
 11798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799        GO TO 3024-EDIT-DL01-CONT.
 11800
 11801     IF DMPF-RETURN-CODE = 'E1'
 11802        MOVE ER-8070               TO WS-ERROR
 11803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804        GO TO 3024-EDIT-DL01-CONT.
 11805
 11806     IF DMPF-RETURN-CODE = 'N1'
 11807        MOVE ER-8071               TO WS-ERROR
 11808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11809        GO TO 3024-EDIT-DL01-CONT.
 11810
 11811     IF DMPF-RETURN-CODE NOT = 'OK'
 11812        MOVE ER-8072               TO WS-ERROR
 11813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11814
 11815 3024-EDIT-DL01-CONT.
 11816******************************************************************
 11817***  VALIDATES RATE CODES : DLO017                             ***
 11818******************************************************************
 11819
 11820      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11821      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11822      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11823      IF DVRC-SUCCESSFUL-EDIT
 11824        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11825        GO TO 3024-CHECK-VALID-RATE.
 11826
 11827      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11828
 11829      IF DVRC-RETURN-CODE EQUAL '01'
 11830         MOVE ER-7817                   TO WS-ERROR
 11831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 217
* EL050.cbl
 11833
 11834      IF DVRC-RETURN-CODE EQUAL '02'
 11835         MOVE ER-7818                   TO WS-ERROR
 11836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11837         GO TO 3025-EDIT-REINSURANCE.
 11838
 11839      IF DVRC-RETURN-CODE EQUAL '03'
 11840         MOVE ER-7819                   TO WS-ERROR
 11841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11842         GO TO 3025-EDIT-REINSURANCE.
 11843
 11844       MOVE ER-7820                     TO WS-ERROR.
 11845       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11846       GO TO 3025-EDIT-REINSURANCE.
 11847
 11848******************************************************************
 11849***  GET PREMIUM RATES : DLO011                                ***
 11850******************************************************************
 11851
 11852 3024-CHECK-VALID-RATE.
 11853
 11854     IF VALID-RATE-CODE
 11855        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11856        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11857        MOVE SPACES                TO DPRB-RETURN-CODE
 11858        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11859     ELSE
 11860         GO TO 3025-EDIT-REINSURANCE.
 11861
 11862      IF DPRB-SUCCESSFUL-PROCESS
 11863         IF PB-VALID-LIFE
 11864             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11865             GO TO 3025-EDIT-REINSURANCE
 11866         ELSE
 11867             IF PB-VALID-AH
 11868                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11869                 GO TO 3025-EDIT-REINSURANCE.
 11870
 11871      IF DPRB-RETURN-CODE EQUAL '01'
 11872         MOVE ER-7812                   TO WS-ERROR
 11873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11874         GO TO 3025-EDIT-REINSURANCE.
 11875
 11876      IF DPRB-RETURN-CODE EQUAL '02'
 11877         MOVE ER-7813                   TO WS-ERROR
 11878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11879         GO TO 3025-EDIT-REINSURANCE.
 11880
 11881      IF DPRB-RETURN-CODE EQUAL '03'
 11882         MOVE ER-7814                   TO WS-ERROR
 11883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11884         GO TO 3025-EDIT-REINSURANCE.
 11885
 11886      IF DPRB-RETURN-CODE EQUAL '04'
 11887         IF NOT DPRB-1ST-TIME
 11888            MOVE ER-7815                   TO WS-ERROR
 11889            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11890            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 218
* EL050.cbl
 11891          ELSE
 11892         IF PB-VALID-LIFE
 11893            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11894          ELSE
 11895            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11896         END-IF
 11897         MOVE SPACES                TO DOCC-RETURN-CODE
 11898         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11899         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11900         IF DOCC-RETURN-CODE = 'OK'
 11901             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11902             GO TO 3024-CHECK-VALID-RATE
 11903           ELSE
 11904             MOVE ER-7823               TO WS-ERROR
 11905             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11906             GO TO 3025-EDIT-REINSURANCE.
 11907
 11908       MOVE ER-7816                     TO WS-ERROR.
 11909       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11910       GO TO 3025-EDIT-REINSURANCE.
 11911
 11912**********   DMD CUSTOM CODE ABOVE    **********
 11913
 11914 3025-EDIT-REINSURANCE.
 11915     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11916         GO TO 3027-EDIT-CONTINUE.
 11917
 11918     MOVE LOW-VALUES               TO ERREIN-KEY.
 11919     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11920     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11921                                      REIN-CODE-2
 11922                                      REIN-CODE-3.
 11923     MOVE 'A'                      TO REIN-TYPE.
 11924
 11925     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11926
 11927     MOVE '3026' TO REIN-SW.
 11928     MOVE ' '                   TO WS-REIN-READ-SW.
 11929
 11930     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11931     IF REIN-TABLE-NOT-FOUND
 11932         GO TO 3026-NO-SPEC-TABLE.
 11933
 11934     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11935     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11936                                   WS-NSP-ST-CD-LF.
 11937     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11938                                   WS-NSP-ST-CD-AH.
 11939
 11940     GO TO 3040-EDIT-CONTINUE.
 11941
 11942 3026-NO-SPEC-TABLE.
 11943
 11944     MOVE ER-2664                TO WS-ERROR.
 11945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11946     GO TO 3040-EDIT-CONTINUE.
 11947
 11948 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 219
* EL050.cbl
 11949
 11950     IF PB-I-REIN-TABLE = SPACES
 11951       GO TO 3040-EDIT-CONTINUE.
 11952
 11953     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11954          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11955          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11956           GO TO 3040-EDIT-CONTINUE.
 11957
 11958     MOVE LOW-VALUES            TO ERREIN-KEY.
 11959     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11960     MOVE 'A'                   TO REIN-TYPE.
 11961     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11962
 11963     MOVE '3028'                TO REIN-SW.
 11964     MOVE ' '                   TO WS-REIN-READ-SW.
 11965
 11966     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11967     IF REIN-TABLE-NOT-FOUND
 11968         GO TO 3028-NO-REIN-TABLE.
 11969
 11970     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11971     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11972                                   WS-NSP-ST-CD-LF.
 11973     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11974                                   WS-NSP-ST-CD-AH.
 11975
 11976     GO TO 3040-EDIT-CONTINUE.
 11977
 11978 3028-NO-REIN-TABLE.
 11979
 11980     MOVE ER-2615                TO WS-ERROR.
 11981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11982     GO TO 3040-EDIT-CONTINUE.
 11983
 11984 3040-EDIT-CONTINUE.
 11985
 11986     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11987         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11988
 11989     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11990         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11991
 11992     IF (NOT PB-REISSUED-CERT)
 11993        AND (NOT PB-MONTHLY-CERT)
 11994        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11995            MOVE '001'           TO PB-I-LF-TERM
 11996            MOVE 'M'             TO PB-I-INSURED-SEX.
 11997
 11998     IF (NOT PB-REISSUED-CERT)
 11999        AND (NOT PB-MONTHLY-CERT)
 12000        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12001            MOVE '001'           TO PB-I-AH-TERM
 12002            MOVE 'M'             TO PB-I-INSURED-SEX.
 12003
 12004 3040-EDIT-1ST-PMT-DT.
 12005     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12006     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 220
* EL050.cbl
 12007         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12008
 12009******************************************************************
 12010*                                                                *
 12011*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12012*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12013*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12014*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12015*                                                                *
 12016******************************************************************
 12017
 12018     IF PB-EFF-DT-PROCESSING
 12019        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12020                                    PB-I-LF-EXPIRE-DT
 12021                                    PB-I-AH-EXPIRE-DT
 12022        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12023        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12024        MOVE ZERO                TO DC-ELAPSED-DAYS
 12025        MOVE +1                  TO DC-ELAPSED-MONTHS
 12026        SET BIN-PLUS-ELAPSED     TO TRUE
 12027*       MOVE 6                   TO DC-OPTION-CODE
 12028        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12029        IF NO-CONVERSION-ERROR
 12030           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12031
 12032******************************************************************
 12033*                                                                *
 12034*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12035*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12036*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12037*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12038*                                                                *
 12039******************************************************************
 12040
 12041     IF PB-EXT-DAYS-PROCESSING
 12042          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12043                                         PB-I-LF-EXPIRE-DT
 12044                                         PB-I-AH-EXPIRE-DT
 12045          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12046          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12047          MOVE +1                     TO DC-ELAPSED-MONTHS
 12048          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12049          SET BIN-PLUS-ELAPSED        TO TRUE
 12050*         MOVE 6                      TO DC-OPTION-CODE
 12051          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12052          IF NO-CONVERSION-ERROR
 12053             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12054
 12055******************************************************************
 12056*                                                                *
 12057*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12058*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12059*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12060*        (EXPIRE DATE - (TERM -1))  *  -1.
 12061*                                                                *
 12062******************************************************************
 12063
 12064     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 221
* EL050.cbl
 12065        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12066           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12067              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12068              MOVE PB-I-AH-TERM      TO WS-TERM
 12069           ELSE
 12070              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12071              MOVE PB-I-LF-TERM      TO WS-TERM
 12072        ELSE
 12073           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12074              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12075              MOVE PB-I-LF-TERM      TO WS-TERM
 12076           ELSE
 12077              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12078              MOVE PB-I-AH-TERM      TO WS-TERM.
 12079
 12080     IF PB-EXPIRE-DT-PROCESSING
 12081        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12082        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12083        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12084        MOVE ZERO                TO DC-ELAPSED-DAYS
 12085                                    DC-ODD-DAYS-OVER
 12086          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12087          SET BIN-PLUS-ELAPSED    TO TRUE
 12088*         MOVE 6                  TO DC-OPTION-CODE
 12089          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12090          IF NO-CONVERSION-ERROR
 12091             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12092
 12093******************************************************************
 12094*                                                                *
 12095*            1ST PAYMENT DATE PROCESSING                         *
 12096*                                                                *
 12097******************************************************************
 12098
 12099     IF PB-1ST-PMT-DT-PROCESSING
 12100        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12101                                    PB-I-AH-EXPIRE-DT
 12102        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12103
 12104     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12105         NEXT SENTENCE
 12106     ELSE
 12107         MOVE ER-2680                 TO WS-ERROR
 12108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12109         GO TO 3060-ORIG-TERM-CHECK.
 12110
 12111     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12112     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12113     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12114*    MOVE 1                      TO DC-OPTION-CODE.
 12115     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12116                                    DC-ELAPSED-DAYS
 12117                                    DC-ODD-DAYS-OVER.
 12118
 12119     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12120
 12121     IF DATE-CONVERSION-ERROR
 12122        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 222
* EL050.cbl
 12123
 12124     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12125     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12126        AND (WS-LF-COVERAGE-TYPE = 'L')
 12127        IF (DC-ELAPSED-MONTHS > 1)
 12128                      OR
 12129           ((DC-ELAPSED-MONTHS = 1)
 12130           AND (DC-ODD-DAYS-OVER > 0))
 12131           MOVE ER-2882          TO WS-ERROR
 12132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        END-IF
 12134     END-IF
 12135     if dc-elapsed-months > 0
 12136        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12137        + dc-odd-days-over
 12138     end-if
 12139     IF PB-EXT-DAYS-PROCESSING
 12140        CONTINUE
 12141     ELSE
 12142        IF DC-ELAPSED-MONTHS = +0
 12143           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12144        ELSE
 12145           IF (WS-LF-EARNINGS-CALC = '4')
 12146              AND (DC-ELAPSED-MONTHS > ZERO)
 12147              AND (DC-ELAPSED-DAYS > ZERO)
 12148              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12149           ELSE
 12150              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12151                                 THRU 6499-EXIT
 12152              MOVE WS-ODD-DAYS-OVER
 12153                                 TO PB-I-EXTENTION-DAYS
 12154           END-IF
 12155        END-IF
 12156     END-IF
 12157******************************************************************
 12158*                                                                *
 12159*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12160*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12161*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12162*            AND ANY ODD DAYS.                                   *
 12163*                                                                *
 12164******************************************************************
 12165
 12166     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12167                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12168     IF WS-LF-EARNINGS-CALC NOT = '4'
 12169        IF DC-ELAPSED-DAYS > ZEROS
 12170           MOVE ER-2681          TO WS-ERROR
 12171           PERFORM 9900-ERROR-FORMAT
 12172                                 THRU 9900-EXIT
 12173        END-IF
 12174     END-IF
 12175
 12176     IF WS-LF-EARNINGS-CALC NOT = '4'
 12177        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12178           MOVE ER-2681          TO WS-ERROR
 12179           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12180
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 223
* EL050.cbl
 12181     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12182        (PB-I-LF-TERM NOT = ZERO) AND
 12183         NOT NO-LIFE-COVERAGE
 12184          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12185          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12186          IF WS-LF-EARNINGS-CALC = '4'
 12187             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12188             PB-I-PAY-FREQUENCY
 12189          END-IF
 12190          MOVE ZERO              TO DC-ELAPSED-DAYS
 12191                                    DC-ODD-DAYS-OVER
 12192          MOVE 1                 TO DC-END-OF-MONTH
 12193          SET BIN-PLUS-ELAPSED        TO TRUE
 12194*         MOVE 6                 TO DC-OPTION-CODE
 12195          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12196          IF NO-CONVERSION-ERROR
 12197             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12198             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12199                (WS-LF-SPECIAL-CALC-CD = 'L')
 12200                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12201                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12202                  MOVE +1             TO DC-ELAPSED-MONTHS
 12203                  SET BIN-PLUS-ELAPSED  TO TRUE
 12204*                 MOVE 6              TO DC-OPTION-CODE
 12205                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12206                  IF NO-CONVERSION-ERROR
 12207                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12208
 12209* okay, i had to move the new att age edit down here because the
 12210* expiration date could get recalculated and i need the exp date
 12211     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12212        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12213        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12214        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12215           AND ZEROS
 12216           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12217           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12218           SET ELAPSED-BETWEEN-BIN TO TRUE
 12219           PERFORM 8500-DATE-CONVERT
 12220                                 THRU 8500-EXIT
 12221           IF NO-CONVERSION-ERROR
 12222              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12223                 MOVE ER-2669       TO WS-ERROR
 12224*                PERFORM 9900-ERROR-FORMAT
 12225*                                THRU 9900-EXIT
 12226              END-IF
 12227           END-IF
 12228        ELSE
 12229           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12230           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12231              MOVE ER-2669       TO WS-ERROR
 12232*             PERFORM 9900-ERROR-FORMAT
 12233*                                THRU 9900-EXIT
 12234           ELSE
 12235              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12236                 MOVE ER-1570    TO WS-ERROR
 12237                 PERFORM 9900-ERROR-FORMAT
 12238                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 224
* EL050.cbl
 12239              END-IF
 12240           END-IF
 12241        END-IF
 12242        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12243           AND ZEROS
 12244           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12245           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12246           SET ELAPSED-BETWEEN-BIN TO TRUE
 12247           PERFORM 8500-DATE-CONVERT
 12248                                 THRU 8500-EXIT
 12249           IF NO-CONVERSION-ERROR
 12250              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12251                 MOVE ER-2669       TO WS-ERROR
 12252*                PERFORM 9900-ERROR-FORMAT
 12253*                                THRU 9900-EXIT
 12254              END-IF
 12255           END-IF
 12256        ELSE
 12257           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12258             (PB-I-LF-TERM / 12)
 12259           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12260              MOVE ER-2669       TO WS-ERROR
 12261*             PERFORM 9900-ERROR-FORMAT
 12262*                                THRU 9900-EXIT
 12263           ELSE
 12264              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12265                 MOVE ER-1571    TO WS-ERROR
 12266                 PERFORM 9900-ERROR-FORMAT
 12267                                 THRU 9900-EXIT
 12268              END-IF
 12269           END-IF
 12270        END-IF
 12271        IF WS-ERROR = ER-2669
 12272           PERFORM 9900-ERROR-FORMAT
 12273                                 THRU 9900-EXIT
 12274        END-IF
 12275     END-IF
 12276     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12277        (PB-I-AH-TERM NOT = ZERO) AND
 12278         NOT NO-AH-COVERAGE
 12279          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12280             AND (PB-COMPANY-ID = 'DCC')
 12281             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12282             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12283          ELSE
 12284             IF WS-LF-EARNINGS-CALC = '4'
 12285                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12286                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12287                PB-I-PAY-FREQUENCY
 12288             ELSE
 12289                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12290                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12291             END-IF
 12292          END-IF
 12293          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12294                                         DC-ODD-DAYS-OVER
 12295          MOVE 1                      TO DC-END-OF-MONTH
 12296          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 225
* EL050.cbl
 12297*         MOVE 6                      TO DC-OPTION-CODE
 12298          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12299          IF NO-CONVERSION-ERROR
 12300             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12301     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12302        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12303        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12304        IF PB-I-BIRTHDAY > LOW-VALUES
 12305           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12306           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12307           SET ELAPSED-BETWEEN-BIN TO TRUE
 12308           PERFORM 8500-DATE-CONVERT
 12309                                 THRU 8500-EXIT
 12310           IF NO-CONVERSION-ERROR
 12311              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12312                 MOVE ER-3054       TO WS-ERROR
 12313*                PERFORM 9900-ERROR-FORMAT
 12314*                                THRU 9900-EXIT
 12315              END-IF
 12316           END-IF
 12317        ELSE
 12318           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12319           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12320              MOVE ER-3054       TO WS-ERROR
 12321*             PERFORM 9900-ERROR-FORMAT
 12322*                                THRU 9900-EXIT
 12323           END-IF
 12324        END-IF
 12325        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12326           AND ZEROS
 12327           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12328           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12329           SET ELAPSED-BETWEEN-BIN TO TRUE
 12330           PERFORM 8500-DATE-CONVERT
 12331                                 THRU 8500-EXIT
 12332           IF NO-CONVERSION-ERROR
 12333              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12334                 MOVE ER-3054       TO WS-ERROR
 12335*                PERFORM 9900-ERROR-FORMAT
 12336*                                THRU 9900-EXIT
 12337              END-IF
 12338           END-IF
 12339        ELSE
 12340           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12341             (PB-I-AH-TERM / 12)
 12342           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12343              MOVE ER-3054       TO WS-ERROR
 12344*             PERFORM 9900-ERROR-FORMAT
 12345*                                THRU 9900-EXIT
 12346           END-IF
 12347        END-IF
 12348        IF WS-ERROR = ER-3054
 12349           PERFORM 9900-ERROR-FORMAT
 12350                                 THRU 9900-EXIT
 12351        END-IF
 12352     END-IF
 12353     MOVE SPACE                       TO DC-END-OF-MONTH.
 12354
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 226
* EL050.cbl
 12355     IF PB-COMPANY-ID = 'NCB'
 12356        GO TO 3040-EDIT-EXTENSION-DAYS.
 12357
 12358     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12359       AND
 12360        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12361        NEXT SENTENCE
 12362     ELSE
 12363        GO TO 3040-EDIT-EXTENSION-DAYS.
 12364
 12365     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12366        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12367        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12368     ELSE
 12369        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12370        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12371
 12372     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12373*    MOVE '1'      TO DC-OPTION-CODE
 12374     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12375     IF (NO-CONVERSION-ERROR)
 12376        AND (DC-ELAPSED-MONTHS > +1)
 12377        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12378        MOVE ER-2668   TO WS-ERROR
 12379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12380
 12381 3040-EDIT-EXTENSION-DAYS.
 12382
 12383     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12384        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12385         GO TO 3050-EDIT-TERM-IN-DAYS
 12386     ELSE
 12387         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12388
 12389     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12390         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12391     ELSE
 12392        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12393           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12394           MOVE ER-2681         TO WS-ERROR
 12395           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12396
 12397     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12398        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12399        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12400         GO TO 3060-ORIG-TERM-CHECK.
 12401
 12402     GO TO 3060-ORIG-TERM-CHECK.
 12403
 12404 3050-EDIT-TERM-IN-DAYS.
 12405
 12406     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12407
 12408     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12409         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12410     ELSE
 12411         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12412            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 227
* EL050.cbl
 12413            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12414
 12415     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12416                                       REMAINDER WS-WORK-TERM.
 12417     IF WS-WORK-TERM GREATER THAN ZERO
 12418         ADD +1 TO PB-I-LF-TERM.
 12419
 12420     IF NOT NO-AH-COVERAGE
 12421         MOVE ER-2684            TO WS-ERROR
 12422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12423
 12424
 12425 3060-ORIG-TERM-CHECK.
 12426
 12427******************************************************************
 12428*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12429******************************************************************
 12430
 12431     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12432        NEXT SENTENCE
 12433     ELSE
 12434        IF NOT NO-LIFE-COVERAGE
 12435           IF PB-I-LF-TERM NUMERIC
 12436              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12437              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12438              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12439                  NEXT SENTENCE
 12440           ELSE
 12441              MOVE ER-2647       TO WS-ERROR
 12442              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443
 12444     IF NOT NO-AH-COVERAGE
 12445         IF PB-I-AH-TERM NUMERIC
 12446            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12447            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12448            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12449             NEXT SENTENCE
 12450          ELSE
 12451              MOVE ER-2658       TO WS-ERROR
 12452              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12453
 12454     IF PB-COMPANY-ID = 'NCB'
 12455        GO TO 3070-LOAN-TERM-CHECK.
 12456
 12457     IF POLICY-HAS-AH
 12458       AND
 12459        POLICY-HAS-LIFE
 12460       AND
 12461        PB-I-LF-TERM NUMERIC
 12462       AND
 12463        PB-I-AH-TERM NUMERIC
 12464        NEXT SENTENCE
 12465     ELSE
 12466        GO TO 3070-LOAN-TERM-CHECK.
 12467
 12468     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12469     IF WS-TEX-FACT-2 LESS THAN +0
 12470        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 228
* EL050.cbl
 12471
 12472     IF WS-TEX-FACT-2 GREATER THAN +1
 12473        MOVE ER-2668             TO WS-ERROR
 12474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12475
 12476 3070-LOAN-TERM-CHECK.
 12477
 12478     IF (WS-LF-BENEFIT-CD = ZERO)
 12479         OR (NO-LF-BENEFIT-MATCH)
 12480            GO TO 3125-EDIT-PMT-FREQ.
 12481*    IF PB-COMPANY-ID NOT = 'DCC'
 12482*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12483*          AND 'V' AND 'W' AND 'X'
 12484*          GO TO 3125-EDIT-PMT-FREQ
 12485*       END-IF
 12486*    ELSE
 12487*       IF WS-AH-DCC-TRUNC = 'T'
 12488*          CONTINUE
 12489*       ELSE
 12490*          GO TO 3125-EDIT-PMT-FREQ
 12491*       END-IF
 12492*    END-IF
 12493     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12494                    OR
 12495        ((PB-COMPANY-ID = 'DCC')
 12496        AND (WS-AH-DCC-TRUNC = 'T'))
 12497        CONTINUE
 12498     ELSE
 12499        GO TO 3125-EDIT-PMT-FREQ
 12500     END-IF
 12501     IF PB-I-LOAN-TERM NOT NUMERIC
 12502         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12503
 12504     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12505        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12506*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12507        PB-I-LOAN-TERM NOT GREATER THAN +360
 12508         NEXT SENTENCE
 12509     ELSE
 12510         MOVE ER-2648            TO WS-ERROR
 12511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12512
 12513     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12514        MOVE ER-3058             TO WS-ERROR
 12515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12516     end-if
 12517
 12518     IF WS-STATE-ABBREVIATION = 'NC'
 12519        IF PB-I-LOAN-TERM > +59
 12520           CONTINUE
 12521        ELSE
 12522           MOVE ER-2792          TO WS-ERROR
 12523           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12524        END-IF
 12525     END-IF
 12526
 12527     .
 12528 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 229
* EL050.cbl
 12529     IF (WS-LF-BENEFIT-CD = ZERO)
 12530         OR (NO-LF-BENEFIT-MATCH)
 12531            GO TO 3127-EDIT-LOAN-OFFICER.
 12532     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12533                    OR
 12534        ((PB-COMPANY-ID = 'DCC')
 12535        AND (WS-AH-DCC-TRUNC = 'T'))
 12536                    OR
 12537         (PB-COMPANY-ID = 'AHL')
 12538        CONTINUE
 12539     ELSE
 12540        IF (PB-I-LOAN-TERM > ZEROS)
 12541           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12542           MOVE ER-1575          TO WS-ERROR
 12543           PERFORM 9900-ERROR-FORMAT
 12544                                 THRU 9900-EXIT
 12545        END-IF
 12546     END-IF
 12547     IF WS-LF-EARNINGS-CALC NOT = '4'
 12548         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12549            MOVE ER-2653         TO WS-ERROR
 12550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12551            GO TO 3127-EDIT-LOAN-OFFICER
 12552         ELSE
 12553            GO TO 3127-EDIT-LOAN-OFFICER.
 12554
 12555     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12556         MOVE ER-2655            TO WS-ERROR
 12557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12558         GO TO 3127-EDIT-LOAN-OFFICER.
 12559
 12560     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12561         MOVE ER-2654            TO WS-ERROR
 12562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563         GO TO 3127-EDIT-LOAN-OFFICER.
 12564
 12565     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12566         GIVING WS-TEX-FACT-2
 12567             REMAINDER WS-TEX-FACT-3.
 12568
 12569*    IF WS-TEX-FACT-3 NOT = ZERO
 12570*       MOVE ER-2654             TO WS-ERROR
 12571*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12572
 12573
 12574 3127-EDIT-LOAN-OFFICER.
 12575
 12576     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12577        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12578           MOVE ER-2690          TO WS-ERROR
 12579           PERFORM 9900-ERROR-FORMAT
 12580                                 THRU 9900-EXIT
 12581        ELSE
 12582           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12583           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12584           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12585           MOVE PB-SV-STATE      TO LOFC-STATE
 12586           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 230
* EL050.cbl
 12587           MOVE PB-I-LOAN-OFFICER
 12588                                 TO LOFC-CODE
 12589           PERFORM 8586-READ-LOAN-OFFICER
 12590                                 THRU 8586-EXIT
 12591           IF (NOT LOFC-MASTER-FOUND)
 12592              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12593              MOVE ER-3006       TO WS-ERROR
 12594              PERFORM 9900-ERROR-FORMAT
 12595                                 THRU 9900-EXIT
 12596           END-IF
 12597        END-IF
 12598     END-IF
 12599     .
 12600 3129-EDIT-APR.
 12601
 12602     IF (WS-LF-BENEFIT-CD = ZERO)
 12603        OR (NO-LF-BENEFIT-MATCH)
 12604        IF PB-COMPANY-ID NOT = 'DCC'
 12605           GO TO 3130-EDIT-AGE
 12606*       ELSE
 12607*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12608*             GO TO 3130-EDIT-AGE
 12609*          END-IF
 12610        END-IF
 12611     END-IF
 12612
 12613     IF (WS-STATE-ABBREVIATION = 'OH')
 12614         AND (PB-I-RATE-CLASS NOT = 'L ')
 12615         AND (PB-I-LF-TERM GREATER THAN 60)
 12616         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12617         GO TO 3129-APR-CONT.
 12618
 12619     IF (WS-STATE-ABBREVIATION = 'RI')
 12620         AND (PB-I-LF-TERM GREATER THAN 60)
 12621         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12622         GO TO 3129-APR-CONT.
 12623
 12624     IF (WS-STATE-ABBREVIATION = 'UT')
 12625         AND (PB-I-LF-TERM GREATER THAN 62)
 12626         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12627         AND (PB-CERT-EFF-DT LESS WS-830901)
 12628         GO TO 3129-APR-CONT.
 12629
 12630     IF PB-COMPANY-ID = 'LAP'
 12631        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12632           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12633              MOVE ER-2656         TO WS-ERROR
 12634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12635              GO TO 3130-EDIT-AGE.
 12636
 12637     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12638        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12639        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12640        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12641        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12642        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12643         GO TO 3130-EDIT-AGE.
 12644
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 231
* EL050.cbl
 12645 3129-APR-CONT.
 12646     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12647         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12648         GO TO 3130-EDIT-AGE.
 12649
 12650     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12651         WS-AH-BENEFIT-CD (1:1) = 'S')
 12652        AND (PB-COMPANY-ID = 'DCC')
 12653        AND (PB-I-LOAN-APR = ZERO)
 12654        MOVE ER-2657             TO WS-ERROR
 12655        PERFORM 9900-ERROR-FORMAT
 12656                                 THRU 9900-EXIT
 12657        GO TO 3130-EDIT-AGE
 12658     END-IF
 12659*    IF PB-I-LOAN-APR = ZERO
 12660*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12661*    END-IF
 12662
 12663     if pb-i-loan-apr = +99.9999
 12664        move er-2656             to ws-error
 12665        PERFORM 9900-ERROR-FORMAT
 12666                                 THRU 9900-EXIT
 12667        GO TO 3130-EDIT-AGE
 12668     end-if
 12669*    IF PB-I-LOAN-APR = ZERO
 12670*       MOVE ER-2656             TO WS-ERROR
 12671*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12672*       GO TO 3130-EDIT-AGE.
 12673
 12674*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12675     if pb-i-loan-apr not = +99.9999
 12676        IF PB-I-LOAN-APR > +30.000
 12677           MOVE ER-2657          TO WS-ERROR
 12678           PERFORM 9900-ERROR-FORMAT
 12679                                 THRU 9900-EXIT
 12680        end-if
 12681     end-if
 12682     .
 12683 3130-EDIT-AGE.
 12684
 12685******************************************************************
 12686*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12687******************************************************************
 12688
 12689     IF NOT NO-LIFE-COVERAGE
 12690        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12691           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12692               MOVE ER-2628             TO WS-ERROR
 12693               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12694
 12695     IF NOT NO-AH-COVERAGE
 12696        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12697           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12698               MOVE ER-2628         TO WS-ERROR
 12699               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12700
 12701 3133-SEX-CODE.
 12702     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 232
* EL050.cbl
 12703         IF WS-DEFAULT-SEX = 'M'
 12704             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12705          ELSE
 12706             IF WS-DEFAULT-SEX = 'F'
 12707             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12708
 12709     IF PB-I-INSURED-SEX = '1'
 12710         MOVE 'M' TO PB-I-INSURED-SEX.
 12711
 12712     IF PB-I-INSURED-SEX = '2'
 12713         MOVE 'F' TO PB-I-INSURED-SEX.
 12714
 12715 3134-SIG-SW-EDIT.
 12716     IF PB-I-SIG-SW = SPACE
 12717         MOVE 'N'                TO  PB-I-SIG-SW.
 12718
 12719     IF PB-COMPANY-ID = 'NCL'
 12720         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12721             NEXT SENTENCE
 12722         ELSE
 12723             MOVE ER-1923        TO  WS-ERROR
 12724             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725     ELSE
 12726     IF PB-COMPANY-ID = 'CRI'
 12727         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12728             NEXT SENTENCE
 12729         ELSE
 12730             MOVE ER-2606        TO  WS-ERROR
 12731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12732     ELSE
 12733     IF PB-COMPANY-ID = 'TMS'
 12734         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12735             NEXT SENTENCE
 12736         ELSE
 12737             MOVE ER-2689        TO  WS-ERROR
 12738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12739     ELSE
 12740         IF PB-I-SIG-SW = 'Y' OR 'N'
 12741             NEXT SENTENCE
 12742         ELSE
 12743             MOVE ER-2651        TO  WS-ERROR
 12744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12745
 12746     IF PB-COMPANY-ID = 'FLA'
 12747         IF (WS-EDIT-AGE GREATER 54  OR
 12748             WS-AH-EDIT-AGE GREATER 54)  AND
 12749            PB-I-SIG-SW = 'N'
 12750            MOVE ER-2651         TO  WS-ERROR
 12751            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12752
 12753 3135-NAME-EDIT.
 12754
 12755     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12756        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12757        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12758           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12759                                 TO PB-I-JOINT-FIRST-NAME
 12760        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 233
* EL050.cbl
 12761     END-IF
 12762     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12763        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12764        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12765           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12766                                 TO PB-I-JOINT-LAST-NAME
 12767        END-PERFORM
 12768     END-IF
 12769     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12770        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12771        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12772           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12773                                 TO PB-I-INSURED-FIRST-NAME
 12774        END-PERFORM
 12775     END-IF
 12776     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12777        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12778        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12779           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12780                                 TO PB-I-INSURED-LAST-NAME
 12781        END-PERFORM
 12782     END-IF
 12783     IF PB-I-INSURED-LAST-NAME = SPACES
 12784       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12785       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12786           MOVE ER-2660    TO WS-ERROR
 12787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12788
 12789 3136-EDIT-SEX.
 12790
 12791******************************************************************
 12792*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12793******************************************************************
 12794
 12795     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12796        (WS-AH-SPECIAL-CALC-CD = 'O')
 12797        NEXT SENTENCE
 12798     ELSE
 12799        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12800           NEXT SENTENCE
 12801        ELSE
 12802           MOVE ER-2629            TO WS-ERROR
 12803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805 3137-EDIT-EFF-DATE.
 12806
 12807     IF PB-REISSUED-CERT       OR
 12808        PB-POLICY-IS-DECLINED  OR
 12809        PB-POLICY-IS-VOIDED
 12810         GO TO 3139-EDIT-COVERAGE-CODES.
 12811
 12812     MOVE SPACE                  TO WS-2671-SW
 12813                                    WS-2672-SW.
 12814
 12815     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12816         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12817             MOVE ER-2703        TO WS-ERROR
 12818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 234
* EL050.cbl
 12819             GO TO 3139-EDIT-COVERAGE-CODES.
 12820
 12821     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12822         GO TO 3139-EDIT-COVERAGE-CODES.
 12823
 12824     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12825     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12826*    MOVE '1'                    TO DC-OPTION-CODE.
 12827     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12828     MOVE +0                     TO DC-ELAPSED-MONTHS
 12829                                    DC-ELAPSED-DAYS.
 12830     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12831
 12832     IF DATE-CONVERSION-ERROR
 12833         GO TO 3139-EDIT-COVERAGE-CODES.
 12834
 12835     IF DC-ELAPSED-DAYS GREATER +180
 12836         MOVE ER-2672            TO WS-ERROR
 12837         MOVE 'Y'                TO WS-2672-SW
 12838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12839     END-IF
 12840
 12841     IF WS-ERROR = ER-2671  AND
 12842        PB-COMPANY-ID  = 'LBL'
 12843        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12844        MOVE SPACE               TO WS-2671-SW
 12845        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12846
 12847     IF PB-ISSUE-DATE-FORCED  AND
 12848      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12849         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12850         MOVE ER-2673            TO WS-ERROR
 12851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12852         MOVE SPACE              TO WS-2671-SW
 12853                                    WS-2672-SW.
 12854
 12855     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12856         IF PB-ISSUE-DATE-FORCED
 12857             MOVE ER-2600          TO  WS-ERROR
 12858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12859         ELSE
 12860             MOVE ER-2692          TO  WS-ERROR
 12861             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12862
 12863
 12864 3139-EDIT-COVERAGE-CODES.
 12865
 12866     if pb-company-id not = 'AHL'
 12867        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12868           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12869           MOVE ER-2787          TO WS-ERROR
 12870           PERFORM 9900-ERROR-FORMAT
 12871                                 THRU 9900-EXIT
 12872        END-IF
 12873     end-if
 12874     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12875        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12876                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 235
* EL050.cbl
 12877           MOVE ER-2719          TO WS-ERROR
 12878           PERFORM 9900-ERROR-FORMAT
 12879                                 THRU 9900-EXIT
 12880        END-IF
 12881     END-IF
 12882
 12883     IF PB-POLICY-IS-DECLINED  OR
 12884        PB-POLICY-IS-VOIDED
 12885         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12886
 12887     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12888        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12889         MOVE ER-2630                TO WS-ERROR
 12890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12891
 12892     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12893        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12894        PB-I-LF-PREMIUM-AMT = ZERO
 12895         GO TO 3140-CHECK-AH-FOR-ZERO.
 12896
 12897     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12898        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12899        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12900         GO TO 3140-CHECK-AH-FOR-ZERO.
 12901
 12902     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12903        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12904        MOVE ER-2631             TO WS-ERROR
 12905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12906     END-IF
 12907
 12908
 12909******************************************************************
 12910*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12911******************************************************************
 12912
 12913     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12914        NEXT SENTENCE
 12915     ELSE
 12916        IF PB-I-LF-BENEFIT-AMT = ZERO
 12917           MOVE ER-2632             TO WS-ERROR
 12918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12919
 12920
 12921******************************************************************
 12922*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12923******************************************************************
 12924
 12925     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12926        CONTINUE
 12927     ELSE
 12928        IF PB-I-LF-PREMIUM-AMT = ZERO
 12929           IF (NOT PB-COMP-LF-PREM)
 12930              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12931              and (ws-lf-ben-category not = 'C')
 12932              MOVE ER-2633       TO WS-ERROR
 12933              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12934           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 236
* EL050.cbl
 12935        END-IF
 12936     END-IF
 12937     .
 12938 3140-CHECK-AH-FOR-ZERO.
 12939
 12940     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12941        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12942        PB-I-AH-PREMIUM-AMT = ZERO
 12943         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12944
 12945     IF PB-COMPANY-ID = 'CSL'  AND
 12946        PB-I-AH-BENEFIT-CD = ZERO  AND
 12947        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12948        PB-I-AH-PREMIUM-AMT = ZERO
 12949         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12950
 12951     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12952        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12953        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12954         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12955
 12956     IF PB-I-AH-BENEFIT-CD = ZERO
 12957         MOVE ER-2634            TO WS-ERROR
 12958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12959
 12960******************************************************************
 12961*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12962******************************************************************
 12963
 12964     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12965        NEXT SENTENCE
 12966     ELSE
 12967        IF PB-I-AH-BENEFIT-AMT = ZERO
 12968           MOVE ER-2635             TO WS-ERROR
 12969           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12970
 12971******************************************************************
 12972*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12973******************************************************************
 12974
 12975     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12976        NEXT SENTENCE
 12977     ELSE
 12978        IF PB-I-AH-PREMIUM-AMT = ZERO
 12979            IF NOT PB-COMP-AH-PREM
 12980                MOVE ER-2636    TO WS-ERROR
 12981                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12982
 12983
 12984 3140-EDIT-MAX-AMT-SIZES.
 12985* CUSTOM CODE FOR CLIENT    'DMD'
 12986     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12987                                     WS-RES-MUNI-TAX
 12988                                     PB-I-STATE-TAX
 12989                                     PB-I-MUNI-TAX.
 12990
 12991     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12992
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 237
* EL050.cbl
 12993     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12994        GO TO 3150-RATE-OUTSTAND-BAL.
 12995
 12996     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12997        GO TO 3150-RATE-OUTSTAND-BAL.
 12998
 12999     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13000        GO TO 3150-RATE-OUTSTAND-BAL.
 13001
 13002     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13003                             OR 'RIC')
 13004        GO TO 3150-RATE-OUTSTAND-BAL.
 13005
 13006     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13007        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13008            GO TO 3150-RATE-OUTSTAND-BAL
 13009        ELSE
 13010           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13011               GO TO 3150-RATE-OUTSTAND-BAL.
 13012
 13013     IF NOT PB-NO-MONTHS-SKIPPED
 13014        GO TO 3150-RATE-OUTSTAND-BAL.
 13015
 13016     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13017        GO TO 3150-RATE-OUTSTAND-BAL.
 13018
 13019     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13020        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13021           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13022             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13023           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13024           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13025              MOVE ER-2693     TO WS-ERROR
 13026              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027              GO TO 3150-RATE-OUTSTAND-BAL
 13028           ELSE
 13029              GO TO 3150-RATE-OUTSTAND-BAL.
 13030
 13031 3150-RATE-OUTSTAND-BAL.
 13032
 13033* DMD RATING TEST
 13034     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13035         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13036         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13037         MOVE ER-2687                 TO WS-ERROR
 13038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13039         MOVE 'B'                     TO PB-I-OB-FLAG
 13040         GO TO 3260-EDIT-CONTINUE.
 13041
 13042     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13043         IF  WS-ERROR    EQUAL    ER-2693
 13044             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13045                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13046                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13047                 MOVE  +0            TO  WS-ERROR.
 13048
 13049     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13050         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 238
* EL050.cbl
 13051             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13052                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13053                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13054                 MOVE  +0            TO  WS-ERROR.
 13055
 13056     IF PLAN-MASTER-AH-SW = 'Y'
 13057        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13058            IF  WS-ERROR    EQUAL    ER-2693
 13059              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13060                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13061                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13062                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13063                 MOVE  ER-1910           TO  WS-ERROR
 13064                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13065
 13066     IF PLAN-MASTER-AH-SW = 'Y'
 13067        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13068            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13069               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13070               MOVE  ER-1910           TO  WS-ERROR
 13071               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13072
 13073     IF PLAN-MASTER-AH-SW = 'Y'
 13074        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13075            IF  WS-ERROR    EQUAL    ER-2693
 13076                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13077                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13078                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13079                 MOVE  +0       TO  WS-ERROR.
 13080
 13081     IF WS-ERROR = ER-2693
 13082        IF PB-COMPANY-ID = 'JAL' AND
 13083           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13084           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13085           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13086
 13087     IF WS-ERROR = ER-2693
 13088        IF PB-COMPANY-ID = 'NCL'  AND
 13089           PB-I-AH-BENEFIT-CD = 'OA'
 13090           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13091           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13092
 13093     IF WS-ERROR = ER-2693
 13094        IF PB-COMPANY-ID = 'CNL' AND
 13095           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13096           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13097           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13098
 13099     IF WS-ERROR = ER-2693
 13100        IF PB-COMPANY-ID = 'HER'
 13101           IF WS-LEVEL
 13102              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13103              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13104
 13105     IF ((LF-BENEFIT-FOUND) AND
 13106         (NOT NO-LIFE-COVERAGE)  AND
 13107         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13108       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 239
* EL050.cbl
 13109             (NOT NO-AH-COVERAGE)    AND
 13110             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13111         NEXT SENTENCE
 13112     ELSE
 13113         GO TO 3215-EDIT-RATES.
 13114
 13115     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13116        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13117           MOVE ER-2674          TO WS-ERROR
 13118           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119           GO TO 3215-EDIT-RATES.
 13120
 13121     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13122        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13123           MOVE ER-2674          TO WS-ERROR
 13124           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13125           GO TO 3215-EDIT-RATES.
 13126
 13127     MOVE 'B'                    TO PB-I-OB-FLAG.
 13128
 13129     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13130         NEXT SENTENCE
 13131     ELSE
 13132         IF NOT NO-LIFE-COVERAGE
 13133             IF WS-ACCT-LF-OB-RT = ZERO
 13134                MOVE ER-2641    TO WS-ERROR
 13135                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13136
 13137     IF PB-COMPANY-ID = 'CRI'
 13138       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13139         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13140         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13141         IF WS-ERROR = ER-2675
 13142            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13143            MOVE ER-2687              TO WS-ERROR
 13144            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13145         ELSE
 13146            MOVE ER-2687              TO WS-ERROR
 13147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13148
 13149
 13150     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13151         NEXT SENTENCE
 13152     ELSE
 13153       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13154            NEXT SENTENCE
 13155       ELSE
 13156         IF NOT NO-AH-COVERAGE
 13157             IF WS-ACCT-AH-OB-RT = ZERO
 13158                MOVE ER-2642    TO WS-ERROR
 13159                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160
 13161     IF PB-COMPANY-ID = 'CRI'
 13162       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13163         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13164         IF WS-ERROR = ER-2676
 13165            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13166            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 240
* EL050.cbl
 13167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13168         ELSE
 13169            MOVE ER-2687              TO WS-ERROR
 13170            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13171
 13172     IF PB-COMPANY-ID NOT = 'GIC'
 13173         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13174            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13175     ELSE
 13176         IF PB-I-LF-PREM-CALC = ZEROS
 13177             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13178                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13179
 13180     IF PB-COMPANY-ID NOT = 'GIC'
 13181         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13182            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13183     ELSE
 13184         IF PB-I-AH-PREM-CALC = ZEROS
 13185             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13186                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13187
 13188     MOVE ZEROS TO PB-I-MORT-CODE.
 13189
 13190     GO TO 3260-EDIT-CONTINUE.
 13191
 13192
 13193 3215-EDIT-RATES.
 13194     IF ACCOUNT-MAST-FOUND
 13195         NEXT SENTENCE
 13196     ELSE
 13197         GO TO 3999-END-EDIT.
 13198
 13199 3220-CHECK-LF-RATES.
 13200
 13201     IF PB-COMPANY-ID = 'DCC'
 13202        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13203        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13204        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13205           AND (NOT WS-LF-CASH))
 13206                           OR
 13207           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13208           AND (NOT WS-AH-CASH)))
 13209                       AND
 13210           (PB-I-ENTRY-STATUS NOT = '5')
 13211           MOVE 'M'              TO PB-BATCH-ENTRY
 13212                                    PB-I-ENTRY-STATUS
 13213        END-IF
 13214     END-IF
 13215     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13216                                    PB-I-AH-PREM-CALC
 13217                                    PB-I-LF-ALT-PREM-CALC
 13218                                    PB-I-LF-ALT-RATE
 13219                                    PB-I-LF-REI-RATE
 13220                                    PB-I-LF-ALT-REI-RATE
 13221                                    PB-I-AH-REI-RATE
 13222                                    PB-I-TOT-FEES-CALC.
 13223
 13224     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 241
* EL050.cbl
 13225        NEXT SENTENCE
 13226     ELSE
 13227        MOVE ZEROS               TO PB-I-LF-RATE
 13228                                    PB-I-AH-RATE.
 13229
 13230     IF PB-I-TOT-FEES NOT NUMERIC
 13231        MOVE ZEROS               TO PB-I-TOT-FEES
 13232     END-IF
 13233     IF PB-I-LIVES NOT NUMERIC
 13234         MOVE ZERO               TO PB-I-LIVES.
 13235
 13236     IF PB-I-NUM-BILLED NOT NUMERIC
 13237         MOVE ZERO               TO PB-I-NUM-BILLED.
 13238
 13239     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13240        MOVE +0                  TO PB-I-LF-PREM-TAX
 13241     END-IF
 13242
 13243     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13244        MOVE +0                  TO PB-I-AH-PREM-TAX
 13245     END-IF
 13246
 13247     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13248        PB-I-PAY-FREQUENCY = ZEROS
 13249            MOVE 12 TO CP-PAY-FREQUENCY
 13250     ELSE
 13251            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13252
 13253     IF PB-I-STATE-TAX NOT NUMERIC
 13254         MOVE ZEROS               TO PB-I-STATE-TAX.
 13255
 13256     IF PB-I-MUNI-TAX NOT NUMERIC
 13257         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13258
 13259     MOVE SPACES                 TO CP-BEN-CATEGORY
 13260     IF PB-COMPANY-ID  = 'CSL'  AND
 13261        PB-I-LF-TERM NOT = ZERO
 13262        COMPUTE WS-PAYMENT-AMT =
 13263             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13264        COMPUTE WS-CSL-AMT1 =
 13265             PB-I-LF-TERM * AM-MAX-MON-BEN
 13266        COMPUTE WS-CSL-AMT2 =
 13267             WS-PAYMENT-AMT * PB-I-LF-TERM
 13268        IF CP-PAY-FREQUENCY NOT = 12
 13269           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13270           MOVE '8' TO WS-CSL-CALC-CD
 13271        ELSE
 13272           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13273              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13274               AM-MAX-TOT-BEN
 13275               MOVE '6' TO WS-CSL-CALC-CD
 13276           ELSE
 13277              IF (WS-CSL-AMT1  GREATER THAN
 13278                 AM-MAX-TOT-BEN) AND
 13279                 (WS-CSL-AMT2  GREATER THAN
 13280                 AM-MAX-TOT-BEN)
 13281                 MOVE '7' TO WS-CSL-CALC-CD
 13282              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 242
* EL050.cbl
 13283                 MOVE '5' TO WS-CSL-CALC-CD.
 13284
 13285     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13286         NEXT SENTENCE
 13287     ELSE
 13288         GO TO 3300-CHECK-AH-RATES.
 13289
 13290*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13291
 13292     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13293        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13294              OR
 13295           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13296           MOVE ER-2618          TO WS-ERROR
 13297           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13298           GO TO 3300-CHECK-AH-RATES.
 13299
 13300     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13301           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13302                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13303
 13304     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13305         MOVE ER-2687             TO WS-ERROR
 13306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13307         MOVE 'Z000'              TO PB-I-MORT-CODE
 13308         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13309         GO TO 3300-CHECK-AH-RATES.
 13310
 13311     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13312        IF PB-I-LIVES = ZERO
 13313           MOVE ER-2688          TO WS-ERROR
 13314           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13315
 13316     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13317
 13318     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13319     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13320     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13321     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13322     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13323     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13324     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13325     MOVE '3'                    TO CP-PROCESS-TYPE.
 13326     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13327     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13328
 13329******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13330     IF PB-COMPANY-ID EQUAL 'CDL'
 13331         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13332            CP-EARN-AS-NET-PAY)
 13333             IF PB-CERT-EFF-DT GREATER  WS-931231
 13334                 MOVE '1'        TO CP-EARNING-METHOD.
 13335*******
 13336
 13337     MOVE PB-SV-STATE            TO CP-STATE.
 13338     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13339     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13340     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 243
* EL050.cbl
 13341     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13342     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13343                                    CP-RATING-BENEFIT-AMT.
 13344     IF CP-STATE-STD-ABBRV = 'OR'
 13345         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13346                                         PB-I-LF-ALT-BENEFIT-AMT.
 13347     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13348     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13349     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13350     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13351     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13352     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13353     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13354     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13355     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13356                                    CP-REMAINING-TERM
 13357                                    CP-LOAN-TERM.
 13358
 13359     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13360         NEXT SENTENCE
 13361     ELSE
 13362         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13363             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13364                                           PB-I-LF-PREMIUM-AMT.
 13365
 13366     IF PB-COMPANY-ID EQUAL 'CSL'
 13367        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13368           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13369                                         PB-I-LF-PREMIUM-AMT.
 13370
 13371     IF PB-COMPANY-ID EQUAL 'NCB'
 13372         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13373            CP-EARN-AS-NET-PAY
 13374             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13375                 PB-I-LF-PREMIUM-AMT.
 13376
 13377     IF (CP-TRUNCATED-LIFE)
 13378        or ((pb-company-id = 'AHL')
 13379           and (pb-i-loan-term > pb-i-lf-term))
 13380        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13381
 13382     IF PB-COMPANY-ID EQUAL 'CRI'
 13383        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13384
 13385     IF CP-TERM-IS-DAYS
 13386         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13387     ELSE
 13388         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13389     IF PB-COMPANY-ID = 'DCC'
 13390        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13391        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13392        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13393        IF WS-LF-BEN-CATEGORY = 'D'
 13394           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13395           MOVE PB-I-LIFE-COMMISSION
 13396                                 TO CP-DCC-ACT-COMM
 13397           MOVE WS-LF-BEN-CATEGORY
 13398                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 244
* EL050.cbl
 13399        END-IF
 13400        IF (CP-BENEFIT-CD (1:1) = 'P')
 13401           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13402           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13403           add pb-i-ah-premium-amt to cp-original-premium
 13404        END-IF
 13405     END-IF
 13406     IF PB-COMPANY-ID = 'CSL'
 13407         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13408         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13409         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13410
 13411     IF PB-COMPANY-ID = 'CSL'
 13412        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13413
 13414     IF (CP-SPECIAL-CALC-CD = 'H')
 13415        OR (PB-COMPANY-ID = 'DCC')
 13416         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13417                                    TO CP-ALTERNATE-BENEFIT
 13418         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13419     if (pb-company-id = 'CID')
 13420        and (ws-lf-earnings-calc = '4')
 13421        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13422        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13423        move pb-i-term-type      to cp-pmt-mode
 13424        move pb-i-no-of-payments to cp-no-of-pmts
 13425     end-if
 13426     move ws-net-only-state      to cp-net-only-state
 13427     IF (PB-COMPANY-ID = 'CID')
 13428        AND (WS-LF-EARNINGS-CALC = 'B')
 13429        AND (CP-STATE-STD-ABBRV = 'MN')
 13430        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13431                                 TO CP-ALTERNATE-BENEFIT
 13432        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13433     END-IF
 13434     IF (PB-COMPANY-ID = 'CID')
 13435        AND (WS-LF-EARNINGS-CALC = 'B')
 13436        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13437                                 TO CP-ALTERNATE-BENEFIT
 13438        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13439        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13440*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13441*         pb-i-lf-alt-premium-amt
 13442        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13443        IF WS-LF-BEN-CATEGORY = 'P'
 13444           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13445        ELSE
 13446           IF WS-LF-BEN-CATEGORY = 'I'
 13447              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13448           END-IF
 13449        END-IF
 13450     END-IF
 13451     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13452     MOVE 'R'                   TO CP-RATE-FILE.
 13453     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13454
 13455     IF CP-ERROR-RATE-NOT-FOUND
 13456        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 245
* EL050.cbl
 13457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13458        GO TO 3300-CHECK-AH-RATES.
 13459
 13460     IF PB-COMPANY-ID EQUAL 'CRI'
 13461        IF CP-ERROR-NO-LIMITS-CRI
 13462           IF NOT ACCOUNT-LIFE-CHECKED
 13463              MOVE ER-2607      TO WS-ERROR
 13464              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13465
 13466******************************************************************
 13467*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13468*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13469******************************************************************
 13470
 13471* CALC LIFE AGE AT EXPIRATION.
 13472
 13473     COMPUTE WS-AGE-AT-EXPIRE =
 13474          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13475
 13476*    IF PB-STATE = 'CO' OR 'UT'
 13477*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13478*        MOVE 'F'            TO PB-FATAL-FLAG
 13479*        MOVE ER-2709        TO WS-ERROR
 13480*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13481*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13482
 13483*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13484*        MOVE 'X'            TO PB-FATAL-FLAG
 13485*        MOVE ER-2718        TO WS-ERROR
 13486*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13487*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13488
 13489* CALC A & H AGE AT EXPIRATION.
 13490
 13491     COMPUTE WS-AGE-AT-EXPIRE =
 13492          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13493
 13494*    IF PB-STATE = 'CO' OR 'UT'
 13495*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13496*        MOVE 'F'            TO PB-FATAL-FLAG
 13497*        MOVE ER-2709        TO WS-ERROR
 13498*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13499*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13500
 13501*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13502*        MOVE 'X'            TO PB-FATAL-FLAG
 13503*        MOVE ER-2718        TO WS-ERROR
 13504*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13505*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13506
 13507     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13508        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13509
 13510     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13511        and (not pb-monthly-cert)
 13512        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13513     end-if
 13514
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 246
* EL050.cbl
 13515     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13516        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13517
 13518     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13519         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13520         MOVE ER-2639        TO WS-ERROR
 13521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13522
 13523
 13524******************************************************************
 13525*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13526******************************************************************
 13527
 13528 PREMIUM-EDITING-IS-BYPASSED.
 13529     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13530        AND (CP-R-MAX-ATT-AGE > +0)
 13531        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13532        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13533           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13534           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13535           MOVE '1'              TO DC-OPTION-CODE
 13536           PERFORM 8500-DATE-CONVERT
 13537                                 THRU 8500-EXIT
 13538           IF NO-CONVERSION-ERROR
 13539              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13540                 MOVE ER-2661       TO WS-ERROR
 13541*                PERFORM 9900-ERROR-FORMAT
 13542*                                THRU 9900-EXIT
 13543              END-IF
 13544           END-IF
 13545        ELSE
 13546           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13547           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13548              MOVE ER-2661       TO WS-ERROR
 13549*             PERFORM 9900-ERROR-FORMAT
 13550*                                THRU 9900-EXIT
 13551           ELSE
 13552              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13553                 MOVE ER-1570    TO WS-ERROR
 13554                 PERFORM 9900-ERROR-FORMAT
 13555                                 THRU 9900-EXIT
 13556              END-IF
 13557           END-IF
 13558        END-IF
 13559        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13560           MOVE PB-I-JOINT-BIRTHDAY
 13561                                 TO DC-BIN-DATE-1
 13562           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13563           MOVE '1'              TO DC-OPTION-CODE
 13564           PERFORM 8500-DATE-CONVERT
 13565                                 THRU 8500-EXIT
 13566           IF NO-CONVERSION-ERROR
 13567              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13568                 MOVE ER-2661       TO WS-ERROR
 13569*                PERFORM 9900-ERROR-FORMAT
 13570*                                THRU 9900-EXIT
 13571              END-IF
 13572           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 247
* EL050.cbl
 13573              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13574           END-IF
 13575        ELSE
 13576           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13577             (PB-I-LF-TERM / 12)
 13578           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13579              MOVE ER-2661       TO WS-ERROR
 13580*             PERFORM 9900-ERROR-FORMAT
 13581*                                THRU 9900-EXIT
 13582           ELSE
 13583              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13584                 MOVE ER-1571    TO WS-ERROR
 13585                 PERFORM 9900-ERROR-FORMAT
 13586                                 THRU 9900-EXIT
 13587              END-IF
 13588           END-IF
 13589        END-IF
 13590        IF WS-ERROR = ER-2661
 13591           PERFORM 9900-ERROR-FORMAT
 13592                                 THRU 9900-EXIT
 13593        END-IF
 13594     END-IF
 13595*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13596*       MOVE ER-2661             TO WS-ERROR
 13597*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13598
 13599     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13600        MOVE ER-2662             TO WS-ERROR
 13601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13602
 13603     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13604        MOVE ER-2677             TO WS-ERROR
 13605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13606
 13607     IF CP-ERROR-LOAN-TERM
 13608        MOVE ER-2648             TO WS-ERROR
 13609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13610
 13611 3221-CHECK-ERROR-RATE-OPEN.
 13612
 13613     IF CP-ERROR-RATE-FILE-NOTOPEN
 13614         GO TO 3990-FILES-NOT-OPEN.
 13615
 13616     IF PB-COMPANY-ID NOT = 'DMD'
 13617        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13618     END-IF
 13619     .
 13620 3221-CONTINUE.
 13621     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13622                                    WS-DCC-AH-RATE
 13623     IF PB-COMPANY-ID = 'DCC'
 13624        IF WS-LF-BEN-CATEGORY = 'D'
 13625           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13626              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13627        END-IF
 13628     END-IF
 13629     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13630*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 248
* EL050.cbl
 13631     IF (PB-COMPANY-ID = 'CID')
 13632        AND (WS-LF-EARNINGS-CALC = 'B')
 13633        AND (CP-STATE-STD-ABBRV = 'MN')
 13634        AND (PB-CERT-EFF-DT > X'A4FF')
 13635        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13636     END-IF
 13637     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13638
 13639     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13640     IF (PB-COMPANY-ID = 'DCC')
 13641        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13642        AND (PB-I-POLICY-IS-MONTHLY)
 13643        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13644        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13645     END-IF
 13646     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13647     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13648     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13649     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13650     IF (PB-COMPANY-ID = 'DCC')
 13651        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13652        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13653        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13654        MOVE ER-2786             TO WS-ERROR
 13655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13656     END-IF
 13657
 13658     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13659
 13660******************************************************************
 13661*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13662******************************************************************
 13663     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13664        and ((not pb-monthly-cert)
 13665        or (ws-lf-ben-category = 'C'))
 13666        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13667
 13668     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13669        GO TO 3225-CHECK-ALT-LIFE-RATE
 13670     ELSE
 13671       IF PB-I-LF-RATE = ZERO
 13672          MOVE ER-2641          TO WS-ERROR
 13673          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13674
 13675 3225-CHECK-ALT-LIFE-RATE.
 13676
 13677     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13678        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13679        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13680         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13681
 13682     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13683         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13684             AND PB-COMPANY-ID NOT = 'DCC')
 13685                   OR
 13686              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13687              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13688              AND PB-COMPANY-ID NOT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 249
* EL050.cbl
 13689             MOVE ER-2720        TO  WS-ERROR
 13690             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13691             GO TO 3225-RATING-CONT
 13692         ELSE
 13693             GO TO 3225-RATING-CONT.
 13694     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13695        AND (AM-GPCD = 01 OR 06 OR 15)
 13696        MOVE ER-2798             TO WS-ERROR
 13697        PERFORM 9900-ERROR-FORMAT
 13698                                 THRU 9900-EXIT
 13699*       GO TO 3225-RATING-CONT
 13700     END-IF
 13701     if (pb-company-id = 'CID')
 13702        and (ws-lf-earnings-calc = 'B')
 13703        and (ws-lf-ben-category = 'P' or 'I')
 13704        and (ws-net-only-state = 'Y')
 13705        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13706        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13707        go to 3225-rating-cont
 13708     end-if
 13709     IF (PB-COMPANY-ID = 'CID')
 13710        AND (WS-LF-EARNINGS-CALC = 'B')
 13711        AND (CP-STATE-STD-ABBRV = 'MN')
 13712        AND (PB-CERT-EFF-DT > X'A4FF')
 13713        GO TO 3225-RATING-CONT
 13714     END-IF
 13715     IF PB-COMPANY-ID = 'DCC'
 13716        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13717           AND (PB-I-POLICY-IS-MONTHLY)
 13718           GO TO 3225-RATING-CONT
 13719        END-IF
 13720     END-IF
 13721
 13722     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13723        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13724        CP-EARN-AS-REG-BALLOON
 13725        NEXT SENTENCE
 13726     ELSE
 13727        MOVE '2'                 TO CP-EARNING-METHOD.
 13728
 13729 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13730
 13731     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13732
 13733     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13734        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13735        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13736         NEXT SENTENCE
 13737     ELSE
 13738         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13739
 13740     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13741     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13742     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13743                                     CP-RATING-BENEFIT-AMT.
 13744     IF CP-STATE-STD-ABBRV = 'OR'
 13745         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13746                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 250
* EL050.cbl
 13747     IF PB-COMPANY-ID = 'DCC'
 13748        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13749     END-IF
 13750     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13751     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13752     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13753                                    CP-REMAINING-TERM
 13754                                    CP-LOAN-TERM.
 13755     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13756        ADD +1                   TO CP-ORIGINAL-TERM
 13757                                    CP-REMAINING-TERM
 13758                                    CP-LOAN-TERM.
 13759
 13760     MOVE 'R'                   TO CP-RATE-FILE.
 13761     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13762
 13763     IF CP-ERROR-RATE-NOT-FOUND
 13764         MOVE ER-2641            TO WS-ERROR
 13765         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13766         GO TO 3300-CHECK-AH-RATES.
 13767
 13768     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13769     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13770
 13771     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13772         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13773
 13774     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13775                               + PB-I-LF-ALT-BENEFIT-AMT.
 13776
 13777     IF ACCOUNT-LIFE-CHECKED  OR
 13778        PB-POLICY-IS-VOIDED   OR
 13779        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13780        and (not pb-monthly-cert))
 13781        GO TO 3225-CONTINUE.
 13782
 13783     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13784        GO TO 3225-CONTINUE.
 13785
 13786     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13787                             EC-RT-LF-MAX-TOT-BEN
 13788        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13789        MOVE ER-2639       TO WS-ERROR
 13790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13791
 13792 3225-CONTINUE.
 13793     IF PB-I-LF-ALT-RATE = ZERO
 13794         MOVE ER-2659            TO WS-ERROR
 13795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13796
 13797     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13798        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13799        MOVE ER-2698             TO WS-ERROR
 13800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13801
 13802 3225-RATING-CONT.
 13803
 13804     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 251
* EL050.cbl
 13805        and (not pb-monthly-cert)
 13806         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13807         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13808         IF (PB-COMPANY-ID = 'DCC')
 13809            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13810            CONTINUE
 13811         ELSE
 13812            MOVE ER-2687         TO WS-ERROR
 13813            PERFORM 9900-ERROR-FORMAT
 13814                                 THRU 9900-EXIT
 13815         END-IF
 13816         GO TO 3290-EDIT-LF-REIN-RATE
 13817     END-IF
 13818
 13819* DMD RATING TEST
 13820     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13821         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13822         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13823         MOVE ER-2687                 TO WS-ERROR
 13824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13825         GO TO 3290-EDIT-LF-REIN-RATE.
 13826
 13827 3230-CLIENT-MORT-CD-SPECIALS.
 13828
 13829     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13830     SET BIN-TO-GREG          TO TRUE.
 13831*    MOVE ' '                 TO DC-OPTION-CODE.
 13832     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13833     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13834
 13835 C-POS-3230-MORT-CD.
 13836     IF PB-COMPANY-ID = 'POS' AND
 13837        PB-SV-CARRIER = '2'
 13838         NEXT SENTENCE
 13839     ELSE
 13840         GO TO C-POS-3240-MORT-CD.
 13841
 13842     IF PB-SV-GROUPING = '030'
 13843        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13844         MOVE '2350' TO PB-I-MORT-CODE
 13845      ELSE
 13846         MOVE '3300' TO PB-I-MORT-CODE.
 13847
 13848
 13849 C-POS-3240-MORT-CD.
 13850     IF PB-COMPANY-ID = 'POS' AND
 13851        PB-SV-CARRIER = '1'
 13852         NEXT SENTENCE
 13853     ELSE
 13854         GO TO 3230-CONTINUE.
 13855
 13856     IF PB-SV-STATE = '45' OR '47'
 13857        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13858         MOVE '5200' TO PB-I-MORT-CODE
 13859     ELSE
 13860         MOVE '8300' TO PB-I-MORT-CODE.
 13861
 13862 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 252
* EL050.cbl
 13863
 13864     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13865        GO TO 3240-CONTINUE
 13866     END-IF
 13867
 13868     IF PB-CERT-EFF-DT > WS-971231
 13869        GO TO 3240-CONTINUE
 13870     END-IF
 13871
 13872     IF LF-BENEFIT-FOUND AND
 13873        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13874         MOVE 'F250'       TO PB-I-MORT-CODE
 13875     ELSE
 13876         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13877             MOVE '7250'   TO PB-I-MORT-CODE
 13878         ELSE
 13879             MOVE '4251'   TO PB-I-MORT-CODE
 13880         END-IF
 13881     END-IF
 13882
 13883     .
 13884 3240-CONTINUE.
 13885
 13886     IF PB-COMPANY-ID NOT = 'GNL'
 13887         GO TO 3256-CONTINUE.
 13888
 13889     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13890         MOVE 'A300' TO PB-I-MORT-CODE
 13891     ELSE
 13892         MOVE '8350' TO PB-I-MORT-CODE.
 13893
 13894 3256-CONTINUE.
 13895     IF PB-COMPANY-ID NOT = 'ABL'
 13896         GO TO 3260-EDIT-CONTINUE.
 13897
 13898     IF PB-I-LF-TERM GREATER THAN 59
 13899         MOVE 'F550' TO PB-I-MORT-CODE
 13900     ELSE
 13901         MOVE 'E550' TO PB-I-MORT-CODE.
 13902
 13903 3260-EDIT-CONTINUE.
 13904     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13905
 13906 3290-EDIT-LF-REIN-RATE.
 13907     IF LF-REIN-NSP-NOT-USED
 13908         GO TO 3290-RATING-CONT.
 13909
 13910     IF PB-COMPANY-ID = 'DCC'
 13911        GO TO 3290-RATING-CONT.
 13912     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13913     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13914     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13915     MOVE '3'                   TO CP-PROCESS-TYPE.
 13916     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13917
 13918******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13919     IF PB-COMPANY-ID EQUAL 'CDL'
 13920         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 253
* EL050.cbl
 13921            CP-EARN-AS-NET-PAY)
 13922             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13923*            MOVE SPACE          TO DC-OPTION-CODE
 13924             SET BIN-TO-GREG     TO TRUE
 13925             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13926***  Y2K PROJ 7744
 13927             IF DC-GREG-DATE-CYMD GREATER 19931231
 13928                 MOVE '1'        TO CP-EARNING-METHOD.
 13929***  Y2K PROJ 7744
 13930*******
 13931
 13932     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13933     MOVE PB-SV-STATE           TO CP-STATE.
 13934     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13935     MOVE ZERO                  TO CP-DEVIATION-CODE
 13936                                   CP-RATE-DEV-PCT.
 13937     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13938     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13939                                   CP-RATING-BENEFIT-AMT.
 13940
 13941************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13942     IF PB-COMPANY-ID EQUAL 'NCB'
 13943         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13944            CP-EARN-AS-NET-PAY
 13945             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13946                 PB-I-LF-PREMIUM-AMT.
 13947************
 13948
 13949     IF CP-STATE-STD-ABBRV = 'OR'
 13950         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13951                                         PB-I-LF-ALT-BENEFIT-AMT.
 13952     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13953     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13954     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13955     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13956     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13957     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13958     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13959     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13960                                   CP-REMAINING-TERM
 13961                                   CP-LOAN-TERM.
 13962     IF CP-TRUNCATED-LIFE
 13963        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13964
 13965     IF CP-TERM-IS-DAYS
 13966         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13967     ELSE
 13968         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13969
 13970     IF PB-COMPANY-ID = 'DCC'
 13971        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13972     END-IF
 13973     IF PB-COMPANY-ID NOT = 'TIC'
 13974          MOVE ZERO          TO CP-CLASS-CODE.
 13975
 13976     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13977
 13978     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 254
* EL050.cbl
 13979     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13980
 13981     IF CP-ERROR-RATE-NOT-FOUND
 13982        IF PB-I-OB
 13983           MOVE ER-2625      TO WS-ERROR
 13984           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985           GO TO 3299-EDIT-CONTINUE
 13986        ELSE
 13987           MOVE ER-2643      TO WS-ERROR
 13988           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13989           GO TO 3299-EDIT-CONTINUE.
 13990
 13991     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13992
 13993     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13994     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13995
 13996     IF PB-I-LF-REI-RATE = ZERO
 13997         MOVE ER-2643        TO WS-ERROR
 13998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13999
 14000 3290-CHECK-ALT-REIN-RATE.
 14001
 14002     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14003        GO TO 3290-RATING-CONT.
 14004
 14005     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14006     MOVE '2'                    TO CP-EARNING-METHOD.
 14007     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14008     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14009     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14010     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14011                                     CP-RATING-BENEFIT-AMT.
 14012     IF CP-STATE-STD-ABBRV = 'OR'
 14013         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14014                                         PB-I-LF-ALT-BENEFIT-AMT.
 14015     IF PB-COMPANY-ID = 'DCC'
 14016        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14017     END-IF
 14018     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14019     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14020     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14021                                    CP-REMAINING-TERM
 14022                                    CP-LOAN-TERM.
 14023     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14024        ADD +1                   TO CP-ORIGINAL-TERM
 14025                                    CP-REMAINING-TERM
 14026                                    CP-LOAN-TERM.
 14027
 14028     MOVE 'R'                   TO CP-RATE-FILE.
 14029     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14030
 14031     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14032
 14033     IF PB-I-LF-ALT-REI-RATE = ZERO
 14034         MOVE ER-2643            TO WS-ERROR
 14035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14036
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 255
* EL050.cbl
 14037 3290-RATING-CONT.
 14038
 14039     IF PB-I-OB
 14040*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14041        GO TO 3300-CHECK-AH-RATES.
 14042
 14043 3299-EDIT-CONTINUE.
 14044
 14045     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14046         NEXT SENTENCE
 14047     ELSE
 14048         MOVE ER-2620           TO WS-ERROR
 14049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14050
 14051 3300-CHECK-AH-RATES.
 14052     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14053         NEXT SENTENCE
 14054     ELSE
 14055         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14056
 14057     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14058        and (not pb-monthly-cert))
 14059                  or
 14060        ((CF-COMPANY-ID = 'DMD') AND
 14061                (NO-DMD-RATING))
 14062         IF (PB-COMPANY-ID = 'DCC')
 14063            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14064            CONTINUE
 14065         ELSE
 14066            MOVE ER-2687         TO WS-ERROR
 14067            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14068         END-IF
 14069         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14070         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14071     END-IF
 14072
 14073     IF PB-I-OB
 14074        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14075
 14076     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14077         MOVE ER-2687             TO WS-ERROR
 14078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14080         GO TO 3999-END-EDIT.
 14081
 14082*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14083     if pb-company-id = 'AHL'
 14084        go to 3300-skip-crit-per
 14085     end-if
 14086     if (pb-i-ah-crit-per not = zeros)
 14087        and (ws-ah-special-calc-cd not = 'C')
 14088        MOVE ER-1572             TO WS-ERROR
 14089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14090        go to 3300-skip-crit-per
 14091     END-IF
 14092     if (pb-company-id = 'DCC')
 14093        and (am-dcc-product-code not = spaces)
 14094        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 256
* EL050.cbl
 14095     end-if
 14096     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14097        IF PB-I-AH-CRIT-PER = ZERO
 14098           move ws-ah-max-bens   to pb-i-ah-crit-per
 14099*          MOVE ER-2618       TO WS-ERROR
 14100*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14101*          GO TO 3999-END-EDIT
 14102        END-IF
 14103     END-IF
 14104     if (ws-ah-special-calc-cd = 'C')
 14105        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14106        MOVE ER-1576             TO WS-ERROR
 14107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14108     end-if
 14109
 14110     .
 14111 3300-skip-crit-per.
 14112     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14113     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14114     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14115     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14116     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14117     MOVE PB-SV-STATE            TO CP-STATE.
 14118     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14119     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14120     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14121*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14122     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14123     MOVE '3'                    TO CP-PROCESS-TYPE.
 14124     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14125     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14126                                    CP-RATING-BENEFIT-AMT.
 14127     IF PB-COMPANY-ID = 'CID'
 14128               OR
 14129        CP-STATE-STD-ABBRV = 'OR'
 14130         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14131                                         PB-I-AH-TERM.
 14132     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14133        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14134           AND (PB-I-POLICY-IS-MONTHLY)
 14135           MOVE PB-I-LF-BENEFIT-AMT
 14136                                 TO CP-NET-BENEFIT-AMT
 14137           move pb-i-ah-premium-amt to cp-original-premium
 14138           add pb-i-lf-premium-amt to cp-original-premium
 14139        END-IF
 14140     END-IF
 14141     MOVE SPACES                 TO CP-BEN-CATEGORY
 14142     IF PB-COMPANY-ID = 'DCC'
 14143        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14144        EVALUATE TRUE
 14145           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14146              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14147              MOVE PB-I-LF-BENEFIT-AMT
 14148                                 TO CP-RATING-BENEFIT-AMT
 14149              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14150           WHEN WS-AH-BEN-CATEGORY = 'G'
 14151              MOVE PB-I-UNPAID-CASH-PRICE
 14152                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 257
* EL050.cbl
 14153           WHEN WS-AH-BEN-CATEGORY = 'D'
 14154              MOVE WS-AH-PMF-COMM
 14155                                 TO CP-DCC-PMF-COMM
 14156              MOVE PB-I-AH-COMMISSION
 14157                                 TO CP-DCC-ACT-COMM
 14158        END-EVALUATE
 14159     END-IF
 14160     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14161     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14162     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14163     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14164     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14165     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14166     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14167                                    CP-REMAINING-TERM
 14168                                    WS-WORK-TERM.
 14169     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14170
 14171     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14172     SET BIN-TO-GREG             TO TRUE.
 14173*    MOVE ' '                    TO DC-OPTION-CODE.
 14174     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14175     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14176
 14177     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14178     IF NOT VALID-SKIP-CODE
 14179         MOVE ER-2683            TO WS-ERROR
 14180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14181         GO TO 3320-RATE-CONTINUE.
 14182
 14183     IF PB-NO-MONTHS-SKIPPED
 14184         GO TO 3320-RATE-CONTINUE.
 14185
 14186     MOVE SPACE TO NUMBER-OF-MONTHS.
 14187
 14188     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14189         MOVE 'S'                TO SK-MO (6).
 14190     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14191         MOVE 'S'                TO SK-MO (7).
 14192     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14193         MOVE 'S'                TO SK-MO (8).
 14194     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14195         MOVE 'S'                TO SK-MO (9).
 14196     IF PB-I-SKIP-CODE = 'A'
 14197         MOVE 'S'                TO SK-MO (10).
 14198
 14199     MOVE 1                      TO SUB2.
 14200     MOVE PB-I-AH-TERM           TO SUB3.
 14201     MOVE WS-MONTH               TO SUB1.
 14202     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14203     GO TO 3320-RATE-CONTINUE.
 14204
 14205 3310-GET-SKIP-MO.
 14206     IF SUB1 = 13
 14207         MOVE 1                  TO SUB1.
 14208
 14209     IF SK-MO (SUB1) = 'S'
 14210         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 258
* EL050.cbl
 14211
 14212     ADD 1 TO SUB2
 14213              SUB1.
 14214
 14215 3320-RATE-CONTINUE.
 14216
 14217     IF WS-WORK-TERM = ZERO
 14218         MOVE 1                  TO WS-WORK-TERM.
 14219
 14220     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14221                                    CP-LOAN-TERM.
 14222
 14223     IF PB-COMPANY-ID EQUAL 'DMD'
 14224         NEXT SENTENCE
 14225     ELSE
 14226         MOVE ZERO               TO PB-I-AH-RATE
 14227                                    PB-I-AH-REI-RATE.
 14228
 14229
 14230     IF PB-COMPANY-ID EQUAL 'CRI'
 14231        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14232
 14233     IF PB-COMPANY-ID = 'CSL'
 14234         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14235         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14236         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14237         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14238
 14239     IF PB-COMPANY-ID = 'DCC'
 14240        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14241           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14242              PB-I-RATE-DEV-PCT-LF
 14243        END-IF
 14244        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14245                                 TO CP-ALTERNATE-BENEFIT
 14246        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14247        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14248        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14249     END-IF
 14250     IF (PB-COMPANY-ID = 'CID')
 14251        AND (WS-LF-EARNINGS-CALC = 'B')
 14252        AND (CP-STATE-STD-ABBRV = 'MN')
 14253        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14254     ELSE
 14255        MOVE ' '                 TO CP-AH-BALLOON-SW
 14256     END-IF
 14257     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14258     MOVE 'R'                   TO CP-RATE-FILE.
 14259     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14260
 14261     IF (CP-ERROR-RATE-NOT-FOUND)
 14262        and (not pb-monthly-cert)
 14263        IF PB-I-OB
 14264           MOVE ER-2624          TO WS-ERROR
 14265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266           GO TO 3340-CALCULATE-PREMIUM-AMT
 14267        ELSE
 14268          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 259
* EL050.cbl
 14269              NEXT SENTENCE
 14270          ELSE
 14271           MOVE ER-2642          TO WS-ERROR
 14272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14273           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14274
 14275     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14276        CP-ERROR-DIV-BY-ZERO
 14277           MOVE ER-3782          TO WS-ERROR
 14278           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14279
 14280     IF PB-COMPANY-ID EQUAL 'CRI'
 14281        IF CP-ERROR-NO-LIMITS-CRI
 14282           IF NOT ACCOUNT-AH-CHECKED
 14283              MOVE ER-2607          TO WS-ERROR
 14284              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14285
 14286     IF ACCOUNT-AH-CHECKED
 14287        NEXT SENTENCE
 14288     ELSE
 14289       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14290          MOVE ER-2640           TO WS-ERROR
 14291          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14292
 14293     IF PB-COMPANY-ID = 'CRI'
 14294         IF WS-ERROR = ER-2640
 14295             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14296     IF ACCOUNT-AH-CHECKED
 14297        CONTINUE
 14298     ELSE
 14299        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14300           AND (CP-R-MAX-ATT-AGE > +0)
 14301           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14302           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14303              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14304              MOVE PB-I-AH-EXPIRE-DT
 14305                                 TO DC-BIN-DATE-2
 14306              MOVE '1'           TO DC-OPTION-CODE
 14307              PERFORM 8500-DATE-CONVERT
 14308                                 THRU 8500-EXIT
 14309              IF NO-CONVERSION-ERROR
 14310                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14311                    MOVE ER-2661       TO WS-ERROR
 14312*                   PERFORM 9900-ERROR-FORMAT
 14313*                                THRU 9900-EXIT
 14314                 END-IF
 14315              END-IF
 14316           ELSE
 14317              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14318              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14319                 MOVE ER-2661    TO WS-ERROR
 14320*                PERFORM 9900-ERROR-FORMAT
 14321*                                THRU 9900-EXIT
 14322              ELSE
 14323                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14324                    MOVE ER-1570 TO WS-ERROR
 14325                    PERFORM 9900-ERROR-FORMAT
 14326                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 260
* EL050.cbl
 14327                 END-IF
 14328              END-IF
 14329           END-IF
 14330           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14331              MOVE PB-I-JOINT-BIRTHDAY
 14332                                    TO DC-BIN-DATE-1
 14333              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14334              MOVE '1'              TO DC-OPTION-CODE
 14335              PERFORM 8500-DATE-CONVERT
 14336                                    THRU 8500-EXIT
 14337              IF NO-CONVERSION-ERROR
 14338                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14339                    MOVE ER-2661       TO WS-ERROR
 14340*                   PERFORM 9900-ERROR-FORMAT
 14341*                                   THRU 9900-EXIT
 14342                 END-IF
 14343              END-IF
 14344           ELSE
 14345              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14346                (PB-I-AH-TERM / 12)
 14347              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14348                 MOVE ER-2661       TO WS-ERROR
 14349*                PERFORM 9900-ERROR-FORMAT
 14350*                                   THRU 9900-EXIT
 14351              ELSE
 14352                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14353                    MOVE ER-1571 TO WS-ERROR
 14354                    PERFORM 9900-ERROR-FORMAT
 14355                                 THRU 9900-EXIT
 14356                 END-IF
 14357              END-IF
 14358           END-IF
 14359           IF WS-ERROR = ER-2661
 14360              PERFORM 9900-ERROR-FORMAT
 14361                                    THRU 9900-EXIT
 14362           END-IF
 14363        END-IF
 14364     END-IF
 14365*    IF ACCOUNT-AH-CHECKED
 14366*       NEXT SENTENCE
 14367*    ELSE
 14368*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14369*          MOVE ER-2661          TO WS-ERROR
 14370*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14371
 14372     IF ACCOUNT-AH-CHECKED
 14373        NEXT SENTENCE
 14374     ELSE
 14375        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14376           MOVE ER-2663          TO WS-ERROR
 14377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14378
 14379     IF ACCOUNT-AH-CHECKED OR
 14380        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14381         PB-POLICY-IS-VOIDED
 14382        NEXT SENTENCE
 14383     ELSE
 14384        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 261
* EL050.cbl
 14385           MOVE ER-2667            TO WS-ERROR
 14386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14387
 14388     IF PB-COMPANY-ID = 'CRI'
 14389         IF WS-ERROR = ER-2667
 14390             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14391
 14392     IF ACCOUNT-AH-CHECKED
 14393        NEXT SENTENCE
 14394     ELSE
 14395        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14396           MOVE ER-2678            TO WS-ERROR
 14397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14398
 14399     IF CP-ERROR-RATE-FILE-NOTOPEN
 14400         GO TO 3990-FILES-NOT-OPEN.
 14401
 14402 3321-CONTINUE.
 14403     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14404     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14405     IF (PB-COMPANY-ID = 'DCC')
 14406        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14407        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14408                                    PB-I-LF-ALT-PREM-CALC
 14409        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14410        IF WS-AH-BEN-CATEGORY = 'G'
 14411           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14412           + PB-I-ADDL-CLP)
 14413           * (1 + WS-TOL-CLP-PCT)
 14414*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14415        ELSE
 14416           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14417           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14418*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14419        END-IF
 14420        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14421                                 TO PB-I-AH-PREM-CALC
 14422        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14423           MOVE ER-8152          TO WS-ERROR
 14424           PERFORM 9900-ERROR-FORMAT
 14425                                 THRU 9900-EXIT
 14426        ELSE
 14427           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14428                 PB-I-ADDL-CLP)
 14429              MOVE ER-8148       TO WS-ERROR
 14430              PERFORM 9900-ERROR-FORMAT
 14431                                 THRU 9900-EXIT
 14432           END-IF
 14433        END-IF
 14434     END-IF
 14435     IF (PB-COMPANY-ID = 'DCC')
 14436        AND (PB-I-POLICY-IS-MONTHLY)
 14437        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14438        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14439        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14440           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14441        END-IF
 14442     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 262
* EL050.cbl
 14443     IF (PB-COMPANY-ID = 'DCC')
 14444        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14445        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14446        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14447        MOVE ER-2786             TO WS-ERROR
 14448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14449     END-IF
 14450     MOVE +0                     TO PB-I-AH-CLP
 14451     IF PB-COMPANY-ID = 'DCC'
 14452        evaluate true
 14453           when WS-AH-BEN-CATEGORY = 'D'
 14454              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14455                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14456           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14457              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14458           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14459              compute ws-cred-union-fees rounded =
 14460                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14461                    pb-i-ah-commission)
 14462              COMPUTE PB-I-AH-CLP =
 14463                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14464        end-evaluate
 14465     END-IF
 14466     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14467
 14468     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14469         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14470
 14471     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14472         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14473
 14474     if (ws-ah-special-calc-cd = 'E')
 14475        and (pb-monthly-cert)
 14476        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14477     end-if
 14478     IF PB-COMPANY-ID = 'CRI'
 14479         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14480            PB-I-PAYMENT-AMOUNT = ZERO
 14481             NEXT SENTENCE
 14482         ELSE
 14483             COMPUTE PB-I-AH-PREM-CALC =
 14484                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14485                 (CP-PREMIUM-RATE / 100)
 14486             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14487                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14488                                             PB-I-RATE-DEV-PCT-AH.
 14489
 14490     IF (PB-I-AH-RATE  = ZERO)
 14491        and (not pb-monthly-cert)
 14492       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14493           NEXT SENTENCE
 14494       ELSE
 14495         MOVE ER-2642            TO WS-ERROR
 14496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14497
 14498     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14499     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14500     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 263
* EL050.cbl
 14501     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14502     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14503     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14504
 14505     IF (PB-COMPANY-ID = 'DCC')
 14506        AND (WS-AH-BEN-CATEGORY = 'G')
 14507        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14508        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14509        IF CP-DEVIATION-CODE NOT = '000'
 14510           MOVE '000'            TO CP-DEVIATION-CODE
 14511           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14512           IF NO-CP-ERROR
 14513              COMPUTE PB-I-DDF-IU-RATE-UP =
 14514              PB-I-AH-CLP - CP-CALC-PREMIUM
 14515           ELSE
 14516              MOVE ER-3057        TO WS-ERROR
 14517              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14518           END-IF
 14519        END-IF
 14520     END-IF
 14521     .
 14522 3335-EDIT-AH-REIN-NSP-RATE.
 14523     IF PB-COMPANY-ID = 'DCC'
 14524        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14525              compute ws-cred-union-fees rounded =
 14526                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14527                    pb-i-ah-commission)
 14528              COMPUTE PB-I-AH-CLP =
 14529                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14530        end-if
 14531     END-IF
 14532     IF AH-REIN-NSP-NOT-USED
 14533         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14534
 14535     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14536     IF PB-COMPANY-ID = 'DCC'
 14537         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14538     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14539     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14540     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14541     MOVE PB-SV-STATE            TO CP-STATE.
 14542     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14543     MOVE ZERO                   TO CP-DEVIATION-CODE
 14544                                    CP-RATE-DEV-PCT.
 14545*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14546     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14547     MOVE '3'                    TO CP-PROCESS-TYPE.
 14548     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14549     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14550                                    CP-RATING-BENEFIT-AMT.
 14551     IF CP-STATE-STD-ABBRV = 'OR'
 14552         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14553                                         PB-I-AH-TERM.
 14554     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14555     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14556     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14557     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14558     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 264
* EL050.cbl
 14559     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14560                                    CP-REMAINING-TERM
 14561                                    WS-WORK-TERM.
 14562     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14563     IF PB-COMPANY-ID = 'DCC'
 14564        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14565     END-IF
 14566     IF  PB-COMPANY-ID = 'TIC'
 14567         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14568            MOVE ZERO TO CP-CLASS-CODE.
 14569
 14570     IF PB-COMPANY-ID NOT = 'TIC'
 14571          MOVE ZERO          TO CP-CLASS-CODE.
 14572
 14573     MOVE ZERO               TO CP-DEVIATION-CODE.
 14574
 14575     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14576
 14577     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14578
 14579     MOVE 'R'                   TO CP-RATE-FILE.
 14580     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14581
 14582     IF CP-ERROR-RATE-NOT-FOUND
 14583         MOVE ER-2645        TO WS-ERROR
 14584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14585         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14586
 14587     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14588
 14589     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14590     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14591
 14592     IF PB-I-AH-REI-RATE = ZERO
 14593         MOVE ER-2645        TO WS-ERROR
 14594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14595
 14596
 14597 3340-CALCULATE-PREMIUM-AMT.
 14598
 14599     IF PB-COMPANY-ID = 'NCL'
 14600         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14601             WS-AH-SPECIAL-CALC-CD = 'O')
 14602             GO TO 3999-END-EDIT.
 14603
 14604     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14605                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14606                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14607                         OR 'AHL'
 14608         NEXT SENTENCE
 14609     ELSE
 14610         IF WS-STATE-ABBREVIATION = 'CT'
 14611             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14612                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14613                 COMPUTE PB-I-LF-PREM-CALC =
 14614                                     PB-I-LF-PREM-CALC * .90
 14615                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14616                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 265
* EL050.cbl
 14617                 COMPUTE PB-I-AH-PREM-CALC =
 14618                                     PB-I-AH-PREM-CALC * .90.
 14619
 14620     IF PB-COMP-LF-PREM
 14621        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14622        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14623
 14624     IF PB-COMP-AH-PREM
 14625        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14626
 14627 3340-CHECK-DCC-TOT-FEES.
 14628     IF (PB-COMPANY-ID = 'DCC')
 14629        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14630        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14631        AND (PB-I-POLICY-IS-MONTHLY)
 14632        CONTINUE
 14633     ELSE
 14634        GO TO 3340-EDIT-LF-AH-TOL
 14635     END-IF
 14636     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14637     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14638     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14639        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14640           PB-I-RATE-DEV-PCT-LF
 14641     END-IF
 14642     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14643        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14644           PB-I-RATE-DEV-PCT-AH
 14645     END-IF
 14646     MOVE 'N'                    TO CP-BEN-CATEGORY
 14647     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14648
 14649     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14650     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14651     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14652     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14653     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14654     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14655     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14656     MOVE '3'                    TO CP-PROCESS-TYPE.
 14657     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14658     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14659
 14660     MOVE PB-SV-STATE            TO CP-STATE.
 14661     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14662     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14663     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14664     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14665     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14666                                    CP-RATING-BENEFIT-AMT.
 14667     IF CP-STATE-STD-ABBRV = 'OR'
 14668         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14669                                         PB-I-LF-ALT-BENEFIT-AMT.
 14670     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14671     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14672     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14673     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14674     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 266
* EL050.cbl
 14675     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14676     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14677     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14678     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14679                                    CP-REMAINING-TERM
 14680                                    CP-LOAN-TERM.
 14681     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14682        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14683           PB-I-LF-PREMIUM-AMT
 14684     end-if
 14685
 14686     IF CP-TRUNCATED-LIFE
 14687        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14688
 14689     IF CP-TERM-IS-DAYS
 14690         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14691     ELSE
 14692         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14693
 14694     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14695     IF CP-SPECIAL-CALC-CD = 'H'
 14696         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14697                                    TO CP-ALTERNATE-BENEFIT
 14698         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14699     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14700     MOVE 'R'                    TO CP-RATE-FILE
 14701     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14702     IF NOT CP-ERROR-RATE-NOT-FOUND
 14703        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14704        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14705           AND (CP-BENEFIT-CD (1:1) = 'S')
 14706           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14707                                    PB-I-LF-PREMIUM-AMT
 14708        END-IF
 14709     ELSE
 14710        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14711     END-IF
 14712     .
 14713 3340-EDIT-LF-AH-TOL.
 14714
 14715***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14716***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14717***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14718***
 14719     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14720         PB-I-AH-PREMIUM-AMT
 14721          GIVING WS-CALC-WORK.
 14722
 14723     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14724        AND WS-CALC-WORK NOT = ZERO
 14725         MOVE ER-2649            TO WS-ERROR
 14726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14727
 14728     SUBTRACT PB-I-LF-PREM-CALC
 14729             FROM PB-I-LF-PREMIUM-AMT
 14730                 GIVING WS-UNSIGN-WRK1.
 14731
 14732     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 267
* EL050.cbl
 14733             FROM PB-I-LF-ALT-PREMIUM-AMT
 14734                 GIVING WS-UNSIGN-WRK4.
 14735
 14736     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14737                                + WS-UNSIGN-WRK4.
 14738
 14739     SUBTRACT PB-I-AH-PREM-CALC
 14740             FROM PB-I-AH-PREMIUM-AMT
 14741                 GIVING WS-UNSIGN-WRK2.
 14742
 14743******************************************************************
 14744*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14745******************************************************************
 14746
 14747     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14748         MOVE ZERO TO WS-UNSIGN-WRK1.
 14749
 14750     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14751         MOVE ZERO TO WS-UNSIGN-WRK2.
 14752
 14753     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14754             GIVING WS-UNSIGN-WRK3.
 14755
 14756 3342-CONTINUE.
 14757
 14758     IF (PB-I-LF-RATE = ZERO  AND
 14759         PB-I-AH-RATE = ZERO)
 14760         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14761            WS-AH-SPECIAL-CALC-CD = 'O'
 14762              NEXT SENTENCE
 14763         ELSE
 14764             GO TO 3345-EDIT-CONTINUE.
 14765
 14766     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14767         NEXT SENTENCE
 14768     ELSE
 14769     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14770        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14771           IF (PB-REISSUED-CERT         OR
 14772               PB-POLICY-IS-DECLINED    OR
 14773               PB-POLICY-IS-VOIDED)
 14774              NEXT SENTENCE
 14775           ELSE
 14776              IF WS-PREM-REJECT-SW = SPACE
 14777                 MOVE ER-2652    TO WS-ERROR
 14778                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14779                 GO TO 3344-CHECK-AH
 14780              ELSE
 14781                 MOVE ER-2650    TO WS-ERROR
 14782                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14783                 GO TO 3344-CHECK-AH.
 14784
 14785***
 14786***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14787***
 14788
 14789     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14790         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 268
* EL050.cbl
 14791            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14792             (1 + WS-TOL-LF-PREM-PCT)
 14793         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14794            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14795             (1 - WS-TOL-LF-PREM-PCT)
 14796     ELSE
 14797         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14798         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14799
 14800***
 14801***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14802***
 14803
 14804     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14805         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14806          WS-TOL-LF-PREM.
 14807
 14808     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14809         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14810          WS-TOL-LF-PREM.
 14811
 14812     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14813        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14814
 14815     IF PB-REISSUED-CERT
 14816        or PB-POLICY-IS-DECLINED
 14817        or PB-POLICY-IS-VOIDED
 14818        continue
 14819     ELSE
 14820        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14821              > WS-TOL-LF-HIGH-PREM-AMT)
 14822           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14823              < WS-TOL-LF-LOW-PREM-AMT))
 14824                      or
 14825           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14826              > WS-TOL-LF-HIGH-PREM-PCT)
 14827           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14828              < WS-TOL-LF-LOW-PREM-PCT))
 14829           IF WS-PREM-REJECT-SW = SPACE
 14830              MOVE ER-2652       TO WS-ERROR
 14831              PERFORM 9900-ERROR-FORMAT
 14832                                 THRU 9900-EXIT
 14833           ELSE
 14834              MOVE ER-2650       TO WS-ERROR
 14835              PERFORM 9900-ERROR-FORMAT
 14836                                 THRU 9900-EXIT
 14837           end-if
 14838        end-if
 14839     end-if
 14840
 14841*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14842*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14843*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14844*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14845
 14846     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14847        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14848                      OR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 269
* EL050.cbl
 14849           ((PB-COMPANY-ID = 'DCC')
 14850           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14851           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14852           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14853        END-IF
 14854     END-IF
 14855
 14856     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14857        IF WS-COMP-MAX-CAP GREATER THAN +0
 14858           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14859              IF (PB-REISSUED-CERT         OR
 14860                  PB-POLICY-IS-DECLINED    OR
 14861                  PB-POLICY-IS-VOIDED)
 14862                 NEXT SENTENCE
 14863              ELSE
 14864                  MOVE ER-2646   TO  WS-ERROR
 14865                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14866
 14867 3344-CVL-TOLERANCE-CHECK.
 14868
 14869      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14870          GO TO 3344-CHECK-AH.
 14871
 14872      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14873          GO TO 3344-CHECK-AH.
 14874
 14875      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14876                                     WS-UNSIGN-WRK6.
 14877
 14878      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14879          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14880                                 + PB-I-LF-PREMIUM-AMT
 14881                                 - PB-I-LF-PREM-CALC.
 14882
 14883      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14884          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14885                                 + PB-I-LF-ALT-PREMIUM-AMT
 14886                                 - PB-I-LF-ALT-PREM-CALC.
 14887
 14888      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14889          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14890              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14891                 MOVE ER-2652    TO  WS-ERROR
 14892                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14893              ELSE
 14894                 MOVE ER-2650    TO  WS-ERROR
 14895                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14896
 14897      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14898          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14899              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14900                 MOVE ER-2652    TO  WS-ERROR
 14901                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14902              ELSE
 14903                 MOVE ER-2650    TO  WS-ERROR
 14904                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14905
 14906 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 270
* EL050.cbl
 14907
 14908****************************************************************
 14909***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14910***
 14911
 14912     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14913         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14914             (1 + WS-TOL-AH-PREM-PCT)
 14915         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14916             (1 - WS-TOL-AH-PREM-PCT)
 14917     ELSE
 14918         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14919         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14920
 14921***
 14922***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14923***
 14924
 14925     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14926         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14927
 14928     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14929         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14930
 14931     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14932        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14933
 14934     IF (PB-REISSUED-CERT)
 14935        OR (PB-POLICY-IS-DECLINED)
 14936        OR (PB-POLICY-IS-VOIDED)
 14937        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14938        CONTINUE
 14939     ELSE
 14940        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14941              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14942                          or
 14943           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14944              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14945           IF WS-PREM-REJECT-SW = SPACE
 14946              MOVE ER-3052       TO WS-ERROR
 14947              PERFORM 9900-ERROR-FORMAT
 14948                                 THRU 9900-EXIT
 14949           ELSE
 14950              MOVE ER-3050       TO WS-ERROR
 14951              PERFORM 9900-ERROR-FORMAT
 14952                                 THRU 9900-EXIT
 14953           END-IF
 14954        END-IF
 14955     END-IF
 14956     if (pb-company-id = 'DCC')
 14957        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14958        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14959        and (pb-i-policy-is-monthly)
 14960        compute ws-tol-ah-high-prem-amt =
 14961           pb-i-tot-fees-calc + ws-tol-ah-prem
 14962        compute ws-tol-ah-low-prem-amt =
 14963           pb-i-tot-fees-calc - ws-tol-ah-prem
 14964        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 271
* EL050.cbl
 14965           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14966              (1 + ws-tol-ah-prem-pct)
 14967           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14968              (1 - ws-tol-ah-prem-pct)
 14969        else
 14970           move +9999999.99      to ws-tol-ah-high-prem-pct
 14971           move +0               to ws-tol-ah-low-prem-pct
 14972        end-if
 14973        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14974            or
 14975           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14976                          or
 14977           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14978           or
 14979           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14980            move er-3049         to ws-error
 14981           perform 9900-error-format
 14982                                 thru 9900-exit
 14983
 14984        end-if
 14985     end-if
 14986     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14987         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14988             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14989             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14990
 14991     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14992        IF WS-COMP-MAX-CAP GREATER THAN +0
 14993           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14994              IF (PB-REISSUED-CERT         OR
 14995                  PB-POLICY-IS-DECLINED    OR
 14996                  PB-POLICY-IS-VOIDED)
 14997                 NEXT SENTENCE
 14998              ELSE
 14999                  MOVE ER-2646   TO  WS-ERROR
 15000                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15001
 15002     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15003        (WS-COMP-MAX-CAP EQUAL +0)
 15004           GO TO 3345-EDIT-CONTINUE.
 15005
 15006     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15007        GREATER THAN WS-COMP-MAX-CAP
 15008           MOVE ER-2646          TO  WS-ERROR
 15009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15010
 15011 3345-EDIT-CONTINUE.
 15012
 15013*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15014*       IF PB-ENTRY-BATCH   NUMERIC
 15015*          IF PB-ISSUE
 15016*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15017*          ELSE
 15018*              IF PB-CANCELLATION
 15019*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15020
 15021*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15022*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 272
* EL050.cbl
 15023*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15024*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15025*        ELSE
 15026*            MOVE  ER-1909            TO  WS-ERROR
 15027*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15028
 15029     IF PB-I-POLICY-ACCEPTED
 15030        IF PB-POLICY-IS-DECLINED  OR
 15031           PB-REISSUED-CERT  OR
 15032           PB-REIN-ONLY-CERT  OR
 15033           PB-POLICY-IS-VOIDED
 15034            MOVE  ER-1891         TO  WS-ERROR
 15035            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15036        ELSE
 15037            MOVE SPACE            TO  PB-BATCH-ENTRY
 15038            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15039
 15040     IF PB-I-POLICY-DECLINED
 15041        IF PB-REISSUED-CERT  OR
 15042           PB-REIN-ONLY-CERT  OR
 15043           PB-POLICY-IS-VOIDED
 15044            MOVE  ER-1906         TO  WS-ERROR
 15045            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15046        ELSE
 15047            MOVE  'D'             TO  PB-BATCH-ENTRY
 15048                                      PB-I-ENTRY-STATUS.
 15049
 15050     IF PB-I-NEEDS-UNDERWRITING
 15051        IF PB-POLICY-IS-DECLINED OR
 15052           PB-REISSUED-CERT  OR
 15053           PB-REIN-ONLY-CERT  OR
 15054           PB-POLICY-IS-VOIDED
 15055            MOVE  ER-1907         TO  WS-ERROR
 15056            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15057        ELSE
 15058            MOVE 'U'              TO  PB-BATCH-ENTRY
 15059                                      PB-I-ENTRY-STATUS.
 15060
 15061     IF PB-NEEDS-UNDERWRITING
 15062        MOVE  ER-1901             TO  WS-ERROR
 15063        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15064     IF PB-COMPANY-ID = 'DCC'
 15065        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15066        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15067        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15068           AND (NOT WS-LF-CASH))
 15069                           OR
 15070           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15071           AND (NOT WS-AH-CASH)))
 15072                       AND
 15073           (PB-I-ENTRY-STATUS NOT = '5')
 15074           MOVE 'M'              TO PB-BATCH-ENTRY
 15075                                    PB-I-ENTRY-STATUS
 15076        END-IF
 15077     END-IF
 15078     move pending-business       to ws-passed-erpndb
 15079     move ' '                    to ws-exceed-limit-yn
 15080     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 273
* EL050.cbl
 15081     display ' el050 exceed ' ws-exceed-limit-yn
 15082     if ws-exceed-limit-yn = 'Y'
 15083        MOVE  ER-9813            TO WS-ERROR
 15084        PERFORM  9900-ERROR-FORMAT
 15085                                 THRU 9900-EXIT
 15086     end-if
 15087     IF  PB-COMPANY-ID NOT = 'NCL'
 15088         GO TO 3999-END-EDIT.
 15089
 15090     IF PB-REISSUED-CERT  OR
 15091        PB-POLICY-IS-DECLINED  OR
 15092        PB-POLICY-IS-VOIDED  OR
 15093        PB-I-OB
 15094         GO TO 3999-END-EDIT.
 15095
 15096     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15097         MOVE  ER-2644            TO  WS-ERROR
 15098         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15099         GO TO 3999-END-EDIT.
 15100
 15101     MOVE 'N'                     TO  FORM-MASTER-SW.
 15102     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15103
 15104     IF NOT FORM-MASTER-FOUND
 15105         GO TO 3999-END-EDIT.
 15106
 15107     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15108                                      FORM-MASTER-AH-SW.
 15109
 15110     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15111         MOVE  +1                 TO SUB6
 15112         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15113
 15114     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15115         MOVE  +1                 TO SUB6
 15116         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15117
 15118     IF LF-FORM-MASTER-FOUND  OR
 15119        AH-FORM-MASTER-FOUND
 15120         GO TO 3360-CHECK-FORM-LIMITS
 15121     ELSE
 15122         GO TO 3999-END-EDIT.
 15123
 15124******************************************************************
 15125*                  3350-GET-ERFORM                               *
 15126*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15127*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15128******************************************************************
 15129
 15130 3350-GET-ERFORM.
 15131
 15132     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15133         GO TO  3350-ERFORM-GETMAIN.
 15134
 15135     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15136     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15137     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15138     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 274
* EL050.cbl
 15139
 15140     IF PB-CANCELLATION
 15141         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15142            PB-SV-STATE          EQUAL   FO-STATE       AND
 15143            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15144              GO TO 3350-EXIT
 15145         ELSE
 15146             NEXT SENTENCE
 15147     ELSE
 15148         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15149            PB-SV-STATE          EQUAL   FO-STATE       AND
 15150            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15151              GO TO 3350-EXIT.
 15152
 15153 3350-ERFORM-GETMAIN.
 15154
 15155     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15156     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15157
 15158 3350-ERFORM-READ.
 15159
 15160     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15161     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15162     IF PB-CANCELLATION
 15163         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15164     ELSE
 15165         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15166     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15167
 15168     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15169
 15170     IF FORM-MASTER-FOUND
 15171       IF PB-CANCELLATION
 15172          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15173             PB-SV-STATE          EQUAL   FO-STATE       AND
 15174             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15175              GO  TO 3350-EXIT
 15176          ELSE
 15177              NEXT SENTENCE
 15178       ELSE
 15179          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15180             PB-SV-STATE          EQUAL   FO-STATE       AND
 15181             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15182              GO  TO 3350-EXIT.
 15183
 15184     MOVE  'N'                    TO  FORM-MASTER-SW.
 15185     MOVE  ER-1895                TO  WS-ERROR.
 15186     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15187
 15188 3350-EXIT.
 15189      EXIT.
 15190
 15191******************************************************************
 15192*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15193*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15194*   VALID FOR THE POLICY FORM USED.                              *
 15195******************************************************************
 15196
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 275
* EL050.cbl
 15197 3355-EDIT-FORM-LF-BENEFITS.
 15198
 15199     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15200        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15201         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15202         GO TO   3355-EXIT.
 15203
 15204     IF  SUB6    LESS THAN   +40
 15205         ADD  +1      TO  SUB6
 15206         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15207
 15208     MOVE  ER-1896         TO  WS-ERROR.
 15209     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15210
 15211 3355-EXIT.
 15212      EXIT.
 15213
 15214******************************************************************
 15215*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15216*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15217*   VALID FOR THE POLICY FORM USED.                              *
 15218******************************************************************
 15219
 15220 3356-EDIT-FORM-AH-BENEFITS.
 15221
 15222     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15223        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15224         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15225         GO TO  3356-EXIT.
 15226
 15227      IF  SUB6    LESS THAN     +40
 15228          ADD  +1      TO  SUB6
 15229          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15230
 15231     MOVE  ER-1897         TO  WS-ERROR.
 15232     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15233
 15234 3356-EXIT.
 15235      EXIT.
 15236
 15237******************************************************************
 15238*                  3357-BENEFIT-SEARCH                           *
 15239*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15240*   CANCELLATIONS ONLY.                                          *
 15241******************************************************************
 15242 3357-BENEFIT-SEARCH.
 15243     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15244         MOVE +1                          TO SUB6
 15245         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15246
 15247     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15248         MOVE +1                          TO SUB6
 15249         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15250
 15251 3357-EXIT.
 15252     EXIT.
 15253
 15254******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 276
* EL050.cbl
 15255*                  3358-BENEFIT-LIFE-SEARCH                      *
 15256*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15257*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15258*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15259******************************************************************
 15260 3358-BENEFIT-LIFE-SEARCH.
 15261     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15262       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15263         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15264           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15265              IF FO-PLAN-REFUND-METHOD (SUB6)
 15266                     IS GREATER THAN SPACES
 15267                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15268                                          WS-LF-REFUND-CALC
 15269                 GO TO 3358-EXIT.
 15270
 15271     IF SUB6 LESS THAN +40
 15272         ADD +1                 TO SUB6
 15273         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15274
 15275 3358-EXIT.
 15276     EXIT.
 15277******************************************************************
 15278*                  3359-BENEFIT-AH-SEARCH                        *
 15279*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15280*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15281*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15282******************************************************************
 15283 3359-BENEFIT-AH-SEARCH.
 15284     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15285       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15286         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15287           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15288              IF FO-PLAN-REFUND-METHOD (SUB6)
 15289                      IS GREATER THAN SPACES
 15290                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15291                                          WS-AH-REFUND-CALC
 15292                 GO TO 3359-EXIT.
 15293
 15294     IF SUB6 LESS THAN +40
 15295         ADD +1                 TO SUB6
 15296         GO TO 3359-BENEFIT-AH-SEARCH.
 15297
 15298 3359-EXIT.
 15299     EXIT.
 15300
 15301******************************************************************
 15302*                  3360-CHECK-FORM-LIMITS                        *
 15303*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15304*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15305******************************************************************
 15306
 15307 3360-CHECK-FORM-LIMITS.
 15308
 15309     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15310         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15311
 15312     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 277
* EL050.cbl
 15313         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15314
 15315 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15316
 15317     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15318       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15319        WS-LF-JOINT-INDICATOR = 'J'  AND
 15320        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15321         IF PB-COMPANY-ID = 'NCL'
 15322            MOVE  ER-1911          TO  WS-ERROR
 15323            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15324         ELSE
 15325            MOVE  ER-1892          TO  WS-ERROR
 15326            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15327
 15328 3360-CHECK-FORM-LF-ATT-AGE.
 15329
 15330     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15331
 15332     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15333         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15334         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15335            IF PB-COMPANY-ID = 'NCL'
 15336                MOVE  ER-1913      TO  WS-ERROR
 15337                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15338            ELSE
 15339                MOVE  ER-1894      TO  WS-ERROR
 15340                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15341
 15342 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15343
 15344     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15345         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15346         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15347            IF PB-COMPANY-ID = 'NCL'
 15348                MOVE  ER-1914      TO  WS-ERROR
 15349                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15350            ELSE
 15351                MOVE  ER-1899      TO  WS-ERROR
 15352                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15353
 15354 3360-CHECK-FORM-LF-TERM-BAMT.
 15355
 15356     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15357         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15358         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15359           IF  PB-COMPANY-ID = 'NCL'
 15360               MOVE  ER-1916       TO  WS-ERROR
 15361               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15362           ELSE
 15363               MOVE  ER-1902       TO  WS-ERROR
 15364               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15365
 15366     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15367                                    PB-I-LF-ALT-BENEFIT-AMT.
 15368
 15369     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15370         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 278
* EL050.cbl
 15371         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15372             IF  PB-COMPANY-ID = 'NCL'
 15373                 MOVE  ER-1918     TO  WS-ERROR
 15374                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15375             ELSE
 15376                 MOVE  ER-1904     TO  WS-ERROR
 15377                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15378
 15379******************************************************************
 15380*                  3360-CHECK-FORM-AH-LIMITS                     *
 15381*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15382*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15383******************************************************************
 15384
 15385 3360-CHECK-FORM-AH-LIMITS.
 15386
 15387     IF NOT AH-FORM-MASTER-FOUND
 15388         GO TO 3999-END-EDIT.
 15389
 15390 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15391
 15392     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15393       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15394        WS-AH-JOINT-INDICATOR = 'J'  AND
 15395        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15396         IF PB-COMPANY-ID = 'NCL'
 15397            MOVE  ER-1912          TO  WS-ERROR
 15398            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15399         ELSE
 15400            MOVE  ER-1893          TO  WS-ERROR
 15401            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15402
 15403 3360-CHECK-FORM-AH-ATT-AGE.
 15404
 15405     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15406
 15407     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15408         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15409         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15410            IF PB-COMPANY-ID = 'NCL'
 15411                MOVE  ER-1913      TO  WS-ERROR
 15412                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15413            ELSE
 15414                MOVE  ER-1894      TO  WS-ERROR
 15415                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15416
 15417 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15418
 15419     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15420         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15421         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15422            IF PB-COMPANY-ID = 'NCL'
 15423                MOVE  ER-1915      TO  WS-ERROR
 15424                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15425            ELSE
 15426                MOVE  ER-1900      TO  WS-ERROR
 15427                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15428
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 279
* EL050.cbl
 15429 3360-CHECK-FORM-AH-TERM-BAMT.
 15430
 15431     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15432         FO-AH-MAX-TERM    GREATER THAN  +0
 15433         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15434             IF  PB-COMPANY-ID = 'NCL'
 15435                 MOVE  ER-1917     TO  WS-ERROR
 15436                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15437             ELSE
 15438                  MOVE  ER-1903    TO  WS-ERROR
 15439                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15440
 15441     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15442         FO-MAX-AH-AMT    GREATER THAN  +0
 15443         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15444             IF  PB-COMPANY-ID = 'NCL'
 15445                 MOVE  ER-1919     TO  WS-ERROR
 15446                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15447             ELSE
 15448                 MOVE  ER-1905     TO  WS-ERROR
 15449                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15450
 15451     GO TO 3999-END-EDIT.
 15452
 15453******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 280
* EL050.cbl
 15455 3400-edit-vin.
 15456
 15457     MOVE PB-I-VIN               TO WS-WORK-VIN
 15458     MOVE +8                     TO V2
 15459     MOVE ZEROS                  TO WS-VIN-TOTAL
 15460     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15461      (V1 > 17)
 15462        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15463           MOVE ER-3825          TO WS-ERROR
 15464           PERFORM 9900-ERROR-FORMAT
 15465                                 THRU 9900-EXIT
 15466        ELSE
 15467           IF V1 = 8
 15468              MOVE 10            TO V2
 15469           END-IF
 15470           IF V1 = 9
 15471              MOVE 0             TO V2
 15472           END-IF
 15473           IF V1 = 10
 15474              MOVE 9             TO V2
 15475           END-IF
 15476           IF WS-WORK-VIN (V1:1) NUMERIC
 15477              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15478               + (WS-WORK-VIN-N (V1) * V2)
 15479           ELSE
 15480              MOVE WS-WORK-VIN (V1:1)
 15481                            TO WS-HEX-BYTE
 15482              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15483              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15484               + (WS-NUM (V3) * V2)
 15485           END-IF
 15486           COMPUTE V2 = V2 - 1
 15487        END-IF
 15488     END-PERFORM
 15489     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15490     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15491        REMAINDER WS-VIN-REMAINDER
 15492     IF ((WS-WORK-VIN (9:1) = 'X')
 15493        AND (WS-VIN-REMAINDER = 10))
 15494                OR
 15495        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15496        CONTINUE
 15497     ELSE
 15498        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15499           MOVE ER-3826          TO WS-ERROR
 15500           PERFORM 9900-ERROR-FORMAT
 15501                                 THRU 9900-EXIT
 15502        ELSE
 15503           MOVE ER-3827          TO WS-ERROR
 15504           PERFORM 9900-ERROR-FORMAT
 15505                                 THRU 9900-EXIT
 15506        END-IF
 15507     END-IF
 15508
 15509     .
 15510 3400-exit.
 15511     exit.
 15512******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 281
* EL050.cbl
 15513*                  E D I T   C A N C E L                         *
 15514******************************************************************
 15515
 15516 3700-EDIT-CANCEL.
 15517     IF PB-COMPANY-ID = 'DMD'
 15518         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15519                                         WS-RES-MUNI-TAX
 15520                                         PB-CI-STATE-TAX
 15521                                         PB-CI-MUNI-TAX
 15522         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15523
 15524*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15525*       IF PB-ENTRY-BATCH  NUMERIC
 15526*          IF PB-CANCELLATION
 15527*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15528*          ELSE
 15529*             IF PB-ISSUE
 15530*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15531
 15532     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15533        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15534     END-IF
 15535*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15536*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15537
 15538     IF CM-ENTRY-STATUS = 'V'
 15539        MOVE ER-2780             TO WS-ERROR
 15540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15541        GO TO 3999-END-EDIT.
 15542
 15543     IF CM-ENTRY-STATUS = 'D'
 15544        MOVE ER-2781             TO WS-ERROR
 15545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15546        GO TO 3999-END-EDIT.
 15547
 15548     IF CM-ENTRY-STATUS = 'U'
 15549        MOVE ER-2782             TO WS-ERROR
 15550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15551
 15552***************************************************************
 15553*                                                             *
 15554*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15555*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15556*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15557*   OF ANOTHER COVERAGE.                                      *
 15558*                                                             *
 15559***************************************************************
 15560
 15561     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15562                                    PB-C-AH-CANCEL-VOID-SW.
 15563
 15564     IF PB-C-LF-CANCEL-AMT = ZERO
 15565        NEXT SENTENCE
 15566     ELSE
 15567        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15568           AND
 15569           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15570               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 282
* EL050.cbl
 15571               MOVE ER-2745           TO WS-ERROR
 15572               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15573
 15574     IF PB-C-AH-CANCEL-AMT = ZERO
 15575        NEXT SENTENCE
 15576     ELSE
 15577        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15578           AND
 15579           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15580               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15581               MOVE ER-2745           TO WS-ERROR
 15582               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15583
 15584     IF WS-LF-EARNINGS-CALC = '4'
 15585        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15586
 15587     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15588     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15589     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15590     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15591     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15592     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15593
 15594     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15595                                      PB-C-AH-REF-CALC.
 15596     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15597
 15598******************************************************************
 15599*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15600*             TO VALIDATE COVERAGE.                              *
 15601******************************************************************
 15602
 15603     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15604        PB-C-LF-CANCEL-AMT = ZEROS
 15605          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15606      ELSE
 15607          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15608
 15609     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15610        PB-C-AH-CANCEL-AMT = ZEROS
 15611          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15612      ELSE
 15613          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15614
 15615     EVALUATE TRUE
 15616         WHEN PB-CANCEL-FORCE             OR
 15617              PB-CANCEL-DATE-FORCED       OR
 15618              PB-FORCE-OFF
 15619                  IF PB-COMPANY-ID = 'ACE'
 15620                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15621                  END-IF
 15622         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15623               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15624              (PB-COMPANY-ID = 'ACE' )
 15625                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15626         WHEN OTHER
 15627              IF PB-COMPANY-ID = 'ACE'
 15628                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 283
* EL050.cbl
 15629              ELSE
 15630                 MOVE ER-2749              TO WS-ERROR
 15631              END-IF
 15632              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15633     END-EVALUATE.
 15634
 15635
 15636*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15637*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15638*            MOVE  ER-1909            TO  WS-ERROR
 15639*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15640*        ELSE
 15641*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15642
 15643     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15644     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15645        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15646     ELSE
 15647        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15648     END-IF
 15649     .
 15650 3705-EDIT-CANCEL-DT.
 15651
 15652     IF LF-COVERAGE-CANCELLED
 15653        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15654         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15655         MOVE WS-CURRENT-MONTH-END
 15656                                 TO DC-BIN-DATE-2
 15657         SET ELAPSED-BETWEEN-BIN TO TRUE
 15658*        MOVE 1                  TO DC-OPTION-CODE
 15659         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15660         IF DATE-CONVERSION-ERROR
 15661            NEXT SENTENCE
 15662          ELSE
 15663             IF DC-ELAPSED-DAYS GREATER +180
 15664                IF PB-CANCEL-DATE-FORCED  OR
 15665                   PB-CANCEL-DATE-FORCED-NO-FEE
 15666                      MOVE ER-2751  TO WS-ERROR
 15667                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15668                 ELSE
 15669                   MOVE ER-2752  TO WS-ERROR
 15670                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15671
 15672     IF AH-COVERAGE-CANCELLED
 15673        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15674         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15675         MOVE WS-CURRENT-MONTH-END
 15676                                 TO DC-BIN-DATE-2
 15677         SET ELAPSED-BETWEEN-BIN TO TRUE
 15678*        MOVE 1                  TO DC-OPTION-CODE
 15679         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15680         IF DATE-CONVERSION-ERROR
 15681            NEXT SENTENCE
 15682          ELSE
 15683             IF DC-ELAPSED-DAYS GREATER +180
 15684                IF PB-CANCEL-DATE-FORCED OR
 15685                   PB-CANCEL-DATE-FORCED-NO-FEE
 15686                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 284
* EL050.cbl
 15687                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15688                 ELSE
 15689                   MOVE ER-2752  TO WS-ERROR
 15690                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15691
 15692     IF WS-ERROR = ER-2752
 15693        AND (PB-COMPANY-ID = 'ABL'
 15694         OR  PB-COMPANY-ID = 'FGL'
 15695         OR  PB-COMPANY-ID = 'IST'
 15696         OR  PB-COMPANY-ID = 'JHL'
 15697         OR  PB-COMPANY-ID = 'LAP'
 15698         OR  PB-COMPANY-ID = 'LBL'
 15699         OR  PB-COMPANY-ID = 'NCB'
 15700         OR  PB-COMPANY-ID = 'NLI'
 15701         OR  PB-COMPANY-ID = 'OFI'
 15702         OR  PB-COMPANY-ID = 'PLI'
 15703         OR  PB-COMPANY-ID = 'TAO'
 15704         OR  PB-COMPANY-ID = 'TIC'
 15705         OR  PB-COMPANY-ID = 'HER'
 15706         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15707         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15708            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15709            MOVE ER-2762     TO WS-ERROR
 15710            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15711
 15712     IF LF-COVERAGE-CANCELLED
 15713        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15714        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15715             MOVE ER-2733         TO WS-ERROR
 15716             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15717
 15718     IF AH-COVERAGE-CANCELLED
 15719        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15720        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15721              MOVE ER-2733        TO WS-ERROR
 15722              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15723
 15724     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15725        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15726        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15727           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15728            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15729              IF PB-COMPANY-ID NOT = 'LAP'
 15730               MOVE ER-2704            TO WS-ERROR
 15731               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15732
 15733     IF CERT-WAS-NOT-FOUND
 15734         GO TO 3999-END-EDIT.
 15735
 15736     IF PB-COMPANY-ID EQUAL 'CDC'
 15737        IF LF-COVERAGE-CANCELLED
 15738           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15739            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15740            MOVE PB-C-LF-CANCEL-DT
 15741                                 TO DC-BIN-DATE-2
 15742            SET ELAPSED-BETWEEN-BIN TO TRUE
 15743*           MOVE 1               TO DC-OPTION-CODE
 15744            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 285
* EL050.cbl
 15745            IF DATE-CONVERSION-ERROR
 15746               NEXT SENTENCE
 15747             ELSE
 15748                IF DC-ELAPSED-DAYS GREATER +60
 15749                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15750
 15751     IF PB-COMPANY-ID EQUAL 'CDC'
 15752        IF AH-COVERAGE-CANCELLED
 15753           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15754            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15755            MOVE PB-C-AH-CANCEL-DT
 15756                                 TO DC-BIN-DATE-2
 15757            MOVE +0              TO DC-ELAPSED-DAYS
 15758                                    DC-ELAPSED-MONTHS
 15759            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15760*           MOVE 1               TO DC-OPTION-CODE
 15761            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15762            IF DATE-CONVERSION-ERROR
 15763               NEXT SENTENCE
 15764             ELSE
 15765                IF DC-ELAPSED-DAYS GREATER +60
 15766                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15767
 15768     MOVE +0                     TO DC-ELAPSED-DAYS
 15769                                    DC-ELAPSED-MONTHS.
 15770
 15771     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15772        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15773          MOVE 'Z'                TO PB-CI-OB-FLAG
 15774          MOVE ER-2767            TO WS-ERROR
 15775          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15776          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15777          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15778          GO TO 3775-OVER-REF-CHK
 15779        ELSE
 15780          MOVE ZEROS              TO PB-CI-LIVES
 15781                                     PB-C-LIVES
 15782          IF PB-CI-OB-FLAG NOT = 'B'
 15783             MOVE SPACE           TO PB-CI-OB-FLAG.
 15784
 15785     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15786         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15787     ELSE
 15788         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15789
 15790     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15791        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15792            MOVE ER-2760         TO WS-ERROR
 15793            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15794
 15795     IF LF-COVERAGE-CANCELLED
 15796        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15797         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15798            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15799               MOVE ER-2774       TO WS-ERROR
 15800               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15801
 15802     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 286
* EL050.cbl
 15803        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15804         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15805            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15806               MOVE ER-2775       TO WS-ERROR
 15807               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15808
 15809     IF LF-COVERAGE-CANCELLED
 15810        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15811         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15812            MOVE ER-2776         TO WS-ERROR
 15813            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15814
 15815     IF AH-COVERAGE-CANCELLED
 15816        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15817         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15818            MOVE ER-2777         TO WS-ERROR
 15819            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15820
 15821     IF LF-COVERAGE-CANCELLED
 15822        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15823        if pb-ci-lf-expire-dt = low-values or spaces
 15824           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15825           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15826           MOVE PB-CI-EXTENTION-DAYS
 15827                                 TO DC-ELAPSED-DAYS
 15828           SET BIN-PLUS-ELAPSED  TO TRUE
 15829           PERFORM 8500-DATE-CONVERT
 15830                                 THRU 8500-EXIT
 15831           IF DATE-CONVERSION-ERROR
 15832              move low-values    to dc-bin-date-2
 15833           end-if
 15834        else
 15835           move pb-ci-lf-expire-dt
 15836                                 to dc-bin-date-2
 15837        end-if
 15838        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15839           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15840                             OR  'FIA'
 15841              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15842           ELSE
 15843              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15844              MOVE ER-2731       TO WS-ERROR
 15845              PERFORM 9900-ERROR-FORMAT
 15846                                 THRU 9900-EXIT
 15847           end-if
 15848        end-if
 15849     end-if
 15850*    IF LF-COVERAGE-CANCELLED
 15851*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15852*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15853*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15854*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15855*        SET BIN-PLUS-ELAPSED      TO TRUE
 15856*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15857*        IF DATE-CONVERSION-ERROR
 15858*           NEXT SENTENCE
 15859*         ELSE
 15860*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 287
* EL050.cbl
 15861*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15862*                            OR  'FIA'
 15863*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15864*              ELSE
 15865*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15866*               MOVE ER-2731       TO WS-ERROR
 15867*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15868     .
 15869 3705-EDIT-AH-CANCEL-DT.
 15870     IF AH-COVERAGE-CANCELLED
 15871        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15872        if pb-ci-AH-expire-dt = low-values or spaces
 15873           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15874           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15875           MOVE PB-CI-EXTENTION-DAYS
 15876                                 TO DC-ELAPSED-DAYS
 15877           SET BIN-PLUS-ELAPSED  TO TRUE
 15878           PERFORM 8500-DATE-CONVERT
 15879                                 THRU 8500-EXIT
 15880           IF DATE-CONVERSION-ERROR
 15881              move low-values    to dc-bin-date-2
 15882           end-if
 15883        else
 15884           move pb-ci-ah-expire-dt
 15885                                 to dc-bin-date-2
 15886        end-if
 15887        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15888           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15889                             OR  'FIA'
 15890              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15891           ELSE
 15892              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15893              MOVE ER-2771       TO WS-ERROR
 15894              PERFORM 9900-ERROR-FORMAT
 15895                                 THRU 9900-EXIT
 15896           end-if
 15897        end-if
 15898     end-if
 15899*    IF AH-COVERAGE-CANCELLED
 15900*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15901*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15902*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15903*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15904**       MOVE 6                    TO DC-OPTION-CODE
 15905*        SET BIN-PLUS-ELAPSED      TO TRUE
 15906*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15907*        IF DATE-CONVERSION-ERROR
 15908*           NEXT SENTENCE
 15909*         ELSE
 15910*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15911*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15912*                             OR 'FIA'
 15913*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15914*             ELSE
 15915*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15916*              MOVE ER-2771       TO WS-ERROR
 15917*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15918     .
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 288
* EL050.cbl
 15919 3705-EDIT-CONTINUED.
 15920
 15921*    IF LF-COVERAGE-CANCELLED
 15922*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15923*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15924*            MOVE ER-2727         TO WS-ERROR
 15925*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15926*
 15927*    IF AH-COVERAGE-CANCELLED
 15928*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15929*        IF PB-COMPANY-ID = 'ACE'
 15930*           MOVE ER-2727        TO WS-ERROR
 15931*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15932*        ELSE
 15933*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15934*              MOVE ER-2727     TO WS-ERROR
 15935*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15936
 15937     IF PB-COMPANY-ID = 'ACE'
 15938       IF AH-COVERAGE-CANCELLED
 15939         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15940           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15941              MOVE ER-2732      TO WS-ERROR
 15942              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15943
 15944     IF PB-COMPANY-ID      EQUAL   'HER'
 15945        IF WS-ERROR        EQUAL   ER-2727
 15946            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15947            MOVE  ER-2725          TO  WS-ERROR
 15948            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15949
 15950     IF PB-C-CLAIM-CREATED-CANCEL
 15951            MOVE ER-2748         TO WS-ERROR
 15952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15953
 15954     IF PB-C-LAST-NAME NOT = SPACES
 15955         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15956            MOVE ER-2747         TO WS-ERROR
 15957            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15958
 15959 3710-EDIT-LUMP-SUM-PRIOR.
 15960
 15961     IF AH-COVERAGE-CANCELLED
 15962         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15963             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15964                MOVE ER-2735    TO WS-ERROR
 15965                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15966
 15967     IF LF-COVERAGE-CANCELLED
 15968         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15969             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15970                MOVE ER-2735    TO WS-ERROR
 15971                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15972
 15973 3710-EDIT-PRIOR-DEATH.
 15974
 15975*    IF LF-COVERAGE-CANCELLED
 15976*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 289
* EL050.cbl
 15977*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15978*           (NOT PB-CI-OB)
 15979*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15980*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15981*                   MOVE ER-2732  TO WS-ERROR
 15982*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15983*
 15984*    IF AH-COVERAGE-CANCELLED
 15985*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15986*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15987*           (NOT PB-CI-OB)
 15988*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15989*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15990*                   MOVE ER-2732  TO WS-ERROR
 15991*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15992
 15993     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15994         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15995            (NOT PB-COMP-LF-CANCEL)
 15996             NEXT SENTENCE
 15997         ELSE
 15998           IF PB-C-LF-CANCEL-VOIDED
 15999              NEXT SENTENCE
 16000           ELSE
 16001              MOVE ER-2753      TO WS-ERROR
 16002              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16003
 16004     IF CANCEL-FUTURE-DT
 16005         GO TO 3999-END-EDIT.
 16006
 16007 3715-GET-REMAIN-TERM-LF.
 16008
 16009     IF NO-LF-BENEFIT-MATCH  OR
 16010        WS-LF-BENEFIT-CD = ZEROS
 16011        GO TO 3730-GET-AH-REMAIN-TERM.
 16012
 16013     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16014     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16015     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16016     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16017     MOVE PB-SV-STATE            TO CP-STATE.
 16018     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16019     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16020     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16021     MOVE '2'                    TO CP-PROCESS-TYPE.
 16022     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16023     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16024     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16025     IF (PB-COMPANY-ID = 'CID')
 16026        AND (CP-STATE-STD-ABBRV = 'WI')
 16027        MOVE '7'                 TO CP-REM-TERM-METHOD
 16028        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16029     ELSE
 16030        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16031        MOVE WS-REM-TRM-CALC-OPTION
 16032                                 TO CP-REM-TRM-CALC-OPTION
 16033     END-IF
 16034**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 290
* EL050.cbl
 16035     IF (PB-COMPANY-ID = 'CID')
 16036        AND (CP-STATE-STD-ABBRV = 'MO')
 16037        AND (PB-CERT-EFF-DT >= X'9B41')
 16038        AND (PB-CERT-EFF-DT <= X'A2FB')
 16039        MOVE '7'                 TO CP-REM-TERM-METHOD
 16040        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16041     END-IF
 16042     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16043                                    CP-LOAN-TERM.
 16044     IF CP-TRUNCATED-LIFE
 16045        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16046
 16047     IF CP-TERM-IS-DAYS
 16048         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16049     ELSE
 16050         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16051
 16052     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16053
 16054     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16055
 16056     IF LF-COVERAGE-CANCELLED
 16057        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16058        NEXT SENTENCE
 16059      ELSE
 16060          GO TO 3730-GET-AH-REMAIN-TERM.
 16061
 16062 3720-GET-LF-REFUND.
 16063
 16064     IF PB-C-LF-CANCEL-VOIDED
 16065        GO TO 3730-GET-AH-REMAIN-TERM
 16066     end-if
 16067
 16068     IF PB-COMPANY-ID EQUAL 'BOA'
 16069         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16070         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16071         GO TO 3730-GET-AH-REMAIN-TERM.
 16072
 16073     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16074        (WS-AH-SPECIAL-CALC-CD = 'M')
 16075         MOVE ER-2767            TO WS-ERROR
 16076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16077         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16078         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16079         GO TO 3780-UPDATE-CANCEL-CERT.
 16080
 16081*    if (ws-lf-earnings-calc = '6')
 16082*       or (pb-c-lf-refund-override = '6')
 16083*       move cp-remaining-term-1 to cp-remaining-term-2
 16084*    end-if
 16085     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16086
 16087     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16088     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16089     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16090     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16091     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16092     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 291
* EL050.cbl
 16093     IF (PB-COMPANY-ID = 'DCC')
 16094        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16095        IF PDEF-MASTER-FOUND
 16096           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16097              (V1 > +8)
 16098              OR (PD-PROD-CODE (V1) = 'L')
 16099           END-PERFORM
 16100           IF V1 < +9
 16101              MOVE PD-MAX-AMT (V1)
 16102                           TO CP-R-MAX-TOT-BEN
 16103                              EC-AM-LF-MAX-TOT-BEN
 16104           END-IF
 16105        ELSE
 16106        MOVE ' '                 TO PDEF-MASTER-SW
 16107        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16108        MOVE PB-STATE            TO ERPDEF-STATE
 16109        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16110        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16111        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16112        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16113        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16114        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16115        IF PDEF-MASTER-FOUND
 16116           MOVE 'N'              TO PDEF-MASTER-SW
 16117           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16118           IF PDEF-MASTER-FOUND
 16119              IF (ERPDEF-KEY-SAVE (1:16) =
 16120                           PD-CONTROL-PRIMARY (1:16))
 16121                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16122                 CONTINUE
 16123              ELSE
 16124                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16125                 IF (ERPDEF-KEY-SAVE (1:16) =
 16126                           PD-CONTROL-PRIMARY (1:16))
 16127                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16128                    CONTINUE
 16129                 ELSE
 16130                    MOVE 'N'     TO PDEF-MASTER-SW
 16131                 END-IF
 16132              END-IF
 16133
 16134              IF PDEF-MASTER-FOUND
 16135                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16136                    (V1 > +8)
 16137                    OR (PD-PROD-CODE (V1) = 'L')
 16138                 END-PERFORM
 16139                 IF V1 < +9
 16140                    MOVE PD-MAX-AMT (V1)
 16141                                 TO CP-R-MAX-TOT-BEN
 16142                                    EC-AM-LF-MAX-TOT-BEN
 16143                 END-IF
 16144              END-IF
 16145           END-IF
 16146           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16147        END-IF
 16148        END-IF
 16149     END-IF
 16150     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 292
* EL050.cbl
 16151
 16152     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16153
 16154     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16155                                    PB-C-LF-REM-TERM.
 16156
 16157     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16158     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16159
 16160     IF PB-COMPANY-ID EQUAL 'FLC'
 16161        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16162           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16163           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16164                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16165                    - CM-LF-ITD-DEATH-AMT
 16166           IF PB-C-LF-REF-CALC LESS THAN +0
 16167              MOVE +0            TO PB-C-LF-REF-CALC
 16168              GO TO 3730-GET-AH-REMAIN-TERM
 16169           ELSE
 16170              GO TO 3730-GET-AH-REMAIN-TERM.
 16171
 16172     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16173                            OR '4' OR '5' OR '6' OR '8'
 16174                            OR '9' OR 'G'
 16175        MOVE PB-C-LF-REFUND-OVERRIDE
 16176                                 TO CP-EARNING-METHOD.
 16177
 16178     if pb-company-id = 'AHL'
 16179        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16180        if cp-class-code = spaces
 16181           move zeros            to cp-class-code
 16182        end-if
 16183     ELSE
 16184        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16185     END-IF
 16186*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16187     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16188     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16189                                    CP-RATING-BENEFIT-AMT.
 16190     IF CP-STATE-STD-ABBRV = 'OR'
 16191         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16192                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16193     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16194     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16195     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16196     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16197     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16198     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16199     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16200     IF WS-DEFAULT-APR NOT NUMERIC
 16201         MOVE ZEROS TO WS-DEFAULT-APR.
 16202****   N O T E   ****
 16203*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16204*      THE OH HARD CODING IN ELCRFNDP
 16205
 16206     IF PB-COMPANY-ID = 'CID'
 16207        IF CP-STATE-STD-ABBRV = 'OH'
 16208           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 293
* EL050.cbl
 16209                                 TO CP-EARNING-METHOD
 16210        END-IF
 16211     END-IF
 16212
 16213****   N O T E   ****
 16214
 16215     IF CP-EARN-AS-NET-PAY
 16216         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16217            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16218                MOVE WS-DEFAULT-APR
 16219                                 TO  CP-LOAN-APR
 16220                MOVE ER-3780     TO  WS-ERROR
 16221                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16222            ELSE
 16223                MOVE ER-3781     TO  WS-ERROR
 16224                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16225*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16226     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16227
 16228     IF CP-REFUND-TYPE-USED NOT = SPACE
 16229         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16230
 16231     IF CP-ERROR-RATE-IS-ZERO OR
 16232        CP-ERROR-RATE-NOT-FOUND
 16233        MOVE ER-2740             TO WS-ERROR
 16234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16235
 16236     IF CP-ERROR-RATE-FILE-NOTOPEN
 16237        MOVE ER-2617             TO WS-ERROR
 16238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16239
 16240     IF PB-COMPANY-ID = 'DCC'
 16241        AND PB-CI-ENTRY-STATUS = 'M'
 16242        MOVE +0                  TO PB-C-LF-REF-CALC
 16243     ELSE
 16244        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16245     END-IF
 16246
 16247     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16248         GO TO 3730-GET-AH-REMAIN-TERM.
 16249
 16250*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16251*       ADD +1                   TO PB-C-LF-REM-TERM
 16252*                                   CP-REMAINING-TERM
 16253*                                   CP-ORIGINAL-TERM.
 16254
 16255     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16256     MOVE '2'                    TO CP-EARNING-METHOD
 16257                                    CP-RATING-METHOD.
 16258     IF PB-COMPANY-ID = 'CID'
 16259        IF (CP-STATE-STD-ABBRV = 'MN')
 16260           AND (PB-CERT-EFF-DT > X'A4FF')
 16261           AND (WS-LF-EARNINGS-CALC = 'B')
 16262           MOVE '5'              TO CP-EARNING-METHOD
 16263           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16264        END-IF
 16265     END-IF
 16266     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 294
* EL050.cbl
 16267                                        CP-REMAINING-BENEFIT
 16268                                        CP-RATING-BENEFIT-AMT.
 16269     IF CP-STATE-STD-ABBRV = 'OR'
 16270         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16271                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16272     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16273     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16274
 16275     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16276
 16277     IF CP-ERROR-RATE-IS-ZERO OR
 16278        CP-ERROR-RATE-NOT-FOUND
 16279        MOVE ER-2740             TO WS-ERROR
 16280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16281
 16282     IF CP-ERROR-RATE-FILE-NOTOPEN
 16283        MOVE ER-2617             TO WS-ERROR
 16284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16285
 16286     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16287
 16288******************************************************************
 16289
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 295
* EL050.cbl
 16291 3730-GET-AH-REMAIN-TERM.
 16292     IF NO-AH-BENEFIT-MATCH  OR
 16293        WS-AH-BENEFIT-CD = ZEROS
 16294         GO TO 3770-CHECK-REFUNDS.
 16295
 16296     IF PB-CI-AH-LUMP-SUM-DISAB
 16297         IF  PB-C-AH-CANCEL-AMT = ZERO
 16298            IF NOT PB-COMP-AH-CANCEL
 16299             GO TO 3770-CHECK-REFUNDS.
 16300
 16301     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16302     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16303     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16304     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16305     MOVE PB-SV-STATE            TO CP-STATE.
 16306     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16307     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16308     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16309     MOVE '2'                    TO CP-PROCESS-TYPE.
 16310     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16311     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16312     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16313     IF (PB-COMPANY-ID = 'CID')
 16314        AND (CP-STATE-STD-ABBRV = 'WI')
 16315        MOVE '7'                 TO CP-REM-TERM-METHOD
 16316        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16317     ELSE
 16318        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16319        MOVE WS-REM-TRM-CALC-OPTION
 16320                                 TO CP-REM-TRM-CALC-OPTION
 16321     END-IF
 16322     IF (PB-COMPANY-ID = 'CID')
 16323        AND (CP-STATE-STD-ABBRV = 'MO')
 16324        AND (PB-CERT-EFF-DT >= X'9B41')
 16325        AND (PB-CERT-EFF-DT <= X'A2FB')
 16326        MOVE '7'                 TO CP-REM-TERM-METHOD
 16327        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16328     END-IF
 16329     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16330                                    CP-LOAN-TERM.
 16331     IF NOT CP-TERM-IS-DAYS
 16332         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16333
 16334     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16335
 16336     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16337
 16338     IF AH-COVERAGE-CANCELLED
 16339        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16340        NEXT SENTENCE
 16341      ELSE
 16342         GO TO 3770-CHECK-REFUNDS.
 16343
 16344 3740-GET-AH-REFUND.
 16345
 16346     IF PB-C-AH-CANCEL-VOIDED
 16347        GO TO 3780-UPDATE-CANCEL-CERT
 16348     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 296
* EL050.cbl
 16349
 16350     IF PB-COMPANY-ID = 'BOA'
 16351         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16352         GO TO 3770-CHECK-REFUNDS.
 16353
 16354     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16355*    MOVE ' '                    TO DC-OPTION-CODE
 16356     SET BIN-TO-GREG             TO TRUE
 16357     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16358     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16359                                    PB-C-AH-REM-TERM.
 16360     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16361     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16362
 16363     IF PB-COMPANY-ID EQUAL 'FLC'
 16364        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16365           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16366           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16367                    - CM-AH-ITD-AH-PMT)
 16368           IF PB-C-AH-REF-CALC LESS THAN +0
 16369              MOVE +0            TO PB-C-AH-REF-CALC
 16370              GO TO 3770-CHECK-REFUNDS
 16371           ELSE
 16372              GO TO 3770-CHECK-REFUNDS.
 16373
 16374     IF PB-COMPANY-ID = 'DCC'
 16375        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16376            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16377           MOVE 'S'              TO CP-EARNING-METHOD
 16378        END-IF
 16379     END-IF
 16380     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16381                            OR '4' OR '5' OR '6' OR '8'
 16382                            OR '9' OR 'G' OR 'S'
 16383        MOVE PB-C-AH-REFUND-OVERRIDE
 16384                                 TO CP-EARNING-METHOD.
 16385
 16386     if pb-company-id = 'AHL'
 16387        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16388        if cp-class-code = spaces
 16389           move zeros            to cp-class-code
 16390        end-if
 16391     ELSE
 16392        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16393     END-IF
 16394*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16395     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16396     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16397                                    CP-RATING-BENEFIT-AMT.
 16398     IF CP-STATE-STD-ABBRV = 'OR'
 16399         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16400                                         PB-CI-AH-TERM.
 16401     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16402     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16403     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16404     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16405     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16406     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 297
* EL050.cbl
 16407
 16408     IF CP-STATE-STD-ABBRV = 'OH'
 16409        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16410                                AND 'CID' AND 'DCC' AND 'AHL')
 16411           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16412              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16413              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16414              MOVE '6' TO CP-EARNING-METHOD
 16415           END-IF
 16416        END-IF
 16417        IF PB-COMPANY-ID = 'CID'
 16418           IF NO-LIFE-COVERAGE
 16419              IF CP-CRITICAL-PERIOD
 16420                 MOVE '2'       TO CP-EARNING-METHOD
 16421              ELSE
 16422                 MOVE '6'       TO CP-EARNING-METHOD
 16423              END-IF
 16424           ELSE
 16425              IF WS-LF-COVERAGE-TYPE = 'L'
 16426                 MOVE '2'       TO CP-EARNING-METHOD
 16427              ELSE
 16428                 IF (PB-CI-LF-TERM > +60) OR
 16429                    (WS-LF-EARNINGS-CALC = '5')
 16430                    IF CP-CRITICAL-PERIOD
 16431                       MOVE '2'  TO CP-EARNING-METHOD
 16432                    ELSE
 16433                       MOVE '6'  TO CP-EARNING-METHOD
 16434                    END-IF
 16435                 ELSE
 16436                    MOVE '1'     TO CP-EARNING-METHOD
 16437                 END-IF
 16438              END-IF
 16439           END-IF
 16440        END-IF
 16441     END-IF
 16442
 16443*    IF CP-STATE-STD-ABBRV = 'VA'
 16444*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16445*          IF CP-ORIGINAL-TERM GREATER 61
 16446*             MOVE '6' TO CP-EARNING-METHOD
 16447*          ELSE
 16448*             MOVE '1' TO CP-EARNING-METHOD.
 16449
 16450     IF WS-DEFAULT-APR NOT NUMERIC
 16451         MOVE ZEROS TO WS-DEFAULT-APR.
 16452     IF CP-EARN-AS-NET-PAY
 16453         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16454            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16455                MOVE WS-DEFAULT-APR
 16456                                 TO  CP-LOAN-APR
 16457                MOVE ER-3780     TO  WS-ERROR
 16458                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16459            ELSE
 16460                MOVE ER-3781     TO  WS-ERROR
 16461                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16462     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16463     IF PB-COMPANY-ID = 'DCC'
 16464        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 298
* EL050.cbl
 16465        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16466        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16467     END-IF
 16468     IF PB-COMPANY-ID = 'DCC'
 16469        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16470        AND (CP-EARNING-METHOD = 'D')
 16471        AND (CP-CANCEL-REASON NOT = 'R')
 16472        CONTINUE
 16473     ELSE
 16474        GO TO 3750-CONTINUE
 16475     END-IF
 16476     MOVE ' '                    TO DD-IU-SW
 16477     IF NOT PDEF-MASTER-FOUND
 16478        MOVE ' '                 TO PDEF-MASTER-SW
 16479        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16480        MOVE PB-STATE            TO ERPDEF-STATE
 16481        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16482        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16483        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16484        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16485        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16486        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16487        IF PDEF-MASTER-FOUND
 16488           MOVE 'N'              TO PDEF-MASTER-SW
 16489           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16490           IF PDEF-MASTER-FOUND
 16491              IF (ERPDEF-KEY-SAVE (1:16) =
 16492                           PD-CONTROL-PRIMARY (1:16))
 16493                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16494                 CONTINUE
 16495              ELSE
 16496                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16497                 IF (ERPDEF-KEY-SAVE (1:16) =
 16498                           PD-CONTROL-PRIMARY (1:16))
 16499                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16500                    CONTINUE
 16501                 ELSE
 16502                    MOVE ER-2740 TO WS-ERROR
 16503                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16504                    GO TO 3770-CHECK-REFUNDS
 16505                 END-IF
 16506              END-IF
 16507           END-IF
 16508           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16509        END-IF
 16510     END-IF
 16511     IF PDEF-MASTER-FOUND
 16512        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16513           (V1 > +8)
 16514           OR (PD-PROD-CODE (V1) = 'I')
 16515        END-PERFORM
 16516        IF V1 < +9
 16517           SET DD-IU-PRESENT        TO TRUE
 16518        END-IF
 16519        IF WS-AH-DCC-TRUNC = 'T'
 16520           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16521        ELSE
 16522           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 299
* EL050.cbl
 16523        END-IF
 16524        EVALUATE TRUE
 16525           WHEN WS-TERM > +168
 16526              MOVE 15               TO V1
 16527           WHEN WS-TERM > +156
 16528              MOVE 14               TO V1
 16529           WHEN WS-TERM > +144
 16530              MOVE 13               TO V1
 16531           WHEN WS-TERM > +132
 16532              MOVE 12               TO V1
 16533           WHEN WS-TERM > +120
 16534              MOVE 11               TO V1
 16535           WHEN WS-TERM > +108
 16536              MOVE 10               TO V1
 16537           WHEN WS-TERM > +96
 16538              MOVE 9                TO V1
 16539           WHEN WS-TERM > +84
 16540              MOVE 8                TO V1
 16541           WHEN WS-TERM > +72
 16542              MOVE 7                TO V1
 16543           WHEN WS-TERM > +60
 16544              MOVE 6                TO V1
 16545           WHEN WS-TERM > +48
 16546              MOVE 5                TO V1
 16547           WHEN WS-TERM > +36
 16548              MOVE 4                TO V1
 16549           WHEN WS-TERM > +24
 16550              MOVE 3                TO V1
 16551           WHEN WS-TERM > +12
 16552              MOVE 2                TO V1
 16553           WHEN OTHER
 16554              MOVE 1                TO V1
 16555        END-EVALUATE
 16556
 16557        EVALUATE TRUE
 16558*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16559*             < +13)
 16560*             AND (DD-IU-PRESENT)
 16561*             MOVE 2                TO V2
 16562*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16563*             MOVE 1                TO V2
 16564           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16565              MOVE 2                TO V2
 16566           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16567              MOVE 3                TO V2
 16568           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16569              MOVE 4                TO V2
 16570           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16571              MOVE 5                TO V2
 16572           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16573              MOVE 6                TO V2
 16574           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16575              MOVE 7                TO V2
 16576           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16577              MOVE 8                TO V2
 16578           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16579              MOVE 9                TO V2
 16580           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 300
* EL050.cbl
 16581              MOVE 10               TO V2
 16582           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16583              MOVE 11               TO V2
 16584           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16585              MOVE 12               TO V2
 16586           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16587              MOVE 13               TO V2
 16588           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16589              MOVE 14               TO V2
 16590           WHEN OTHER
 16591              MOVE 15               TO V2
 16592        END-EVALUATE
 16593
 16594        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16595                                 TO CP-DDF-LO-FACT
 16596        MOVE PD-UEP-FACTOR (V1 V2)
 16597                                 TO CP-DDF-HI-FACT
 16598
 16599        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16600        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16601        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16602           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16603        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16604        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16605        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16606           + PD-1ST-YR-ADMIN-ALLOW
 16607
 16608        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16609*       IF PI-CLP-YN = 'Y'
 16610*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16611*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16612*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16613*       END-IF
 16614
 16615        IF DD-IU-PRESENT
 16616           MOVE 'I'              TO CP-EARNING-METHOD
 16617        END-IF
 16618        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16619                                     CP-CLP-RATE-UP
 16620        IF CP-IU-RATE-UP NOT = ZEROS
 16621           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16622              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16623           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16624              / (1 - WS-WORK-FACT)
 16625        END-IF
 16626     END-IF
 16627     .
 16628 3750-CONTINUE.
 16629     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16630
 16631     IF CP-REFUND-TYPE-USED NOT = SPACE
 16632         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16633
 16634     IF CP-ERROR-RATE-IS-ZERO OR
 16635        CP-ERROR-RATE-NOT-FOUND
 16636        MOVE ER-2740             TO WS-ERROR
 16637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16638
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 301
* EL050.cbl
 16639     IF CP-ERROR-RATE-FILE-NOTOPEN
 16640        MOVE ER-2617             TO WS-ERROR
 16641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16642     IF PB-COMPANY-ID = 'DCC'
 16643        AND PB-CI-ENTRY-STATUS = 'M'
 16644        MOVE +0                  TO PB-C-AH-REF-CALC
 16645     ELSE
 16646        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16647     END-IF
 16648     IF PB-COMPANY-ID = 'DCC'
 16649        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16650        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16651        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16652        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16653        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16654        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16655        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16656        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16657*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16658     END-IF
 16659     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 302
* EL050.cbl
 16661
 16662 3770-CHECK-REFUNDS.
 16663
 16664     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16665        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16666           MOVE ER-2766          TO WS-ERROR
 16667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16668           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16669           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16670              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16671
 16672     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16673        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16674           MOVE ER-2766          TO WS-ERROR
 16675           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16676           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16677           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16678              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16679
 16680     IF PB-COMP-LF-CANCEL
 16681        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16682        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16683           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16684              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16685
 16686     IF PB-COMP-AH-CANCEL
 16687        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16688        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16689           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16690              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16691
 16692     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16693             GIVING WS-UNSIGN-WRK1
 16694     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16695             GIVING WS-UNSIGN-WRK2.
 16696
 16697     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16698         MOVE ZERO TO WS-UNSIGN-WRK1.
 16699
 16700     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16701         MOVE ZERO TO WS-UNSIGN-WRK2.
 16702
 16703     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16704
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 303
* EL050.cbl
 16706
 16707 3772-CONTINUE.
 16708
 16709**********************************
 16710*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16711*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16712*** DOUBLES THE TOLERANCE AMOUNT.
 16713***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16714**********************************
 16715     IF PB-COMPANY-ID = 'MON'
 16716     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16717         IF WS-REF-REJECT-SW = SPACE
 16718             MOVE ER-2754        TO WS-ERROR
 16719             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16720           ELSE
 16721             MOVE ER-2736        TO WS-ERROR
 16722             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723**********************************
 16724
 16725 3773-CONTINUE.
 16726
 16727     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16728        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16729           MOVE ER-2723          TO WS-ERROR
 16730           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16731
 16732     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16733        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16734           MOVE ER-2724          TO WS-ERROR
 16735           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16736
 16737     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16738         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16739             (1 + WS-LF-REFUND-OVS-PCT)
 16740     ELSE
 16741         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16742
 16743     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16744         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16745             (1 - WS-TOL-LF-REFUND-PCT)
 16746     ELSE
 16747         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16748
 16749     IF (PB-COMPANY-ID = 'DCC')
 16750        AND (PB-CI-ENTRY-STATUS = 'M')
 16751        AND (PB-C-LF-CANCEL-AMT > +0)
 16752        MOVE ER-3843             TO WS-ERROR
 16753        PERFORM 9900-ERROR-FORMAT
 16754                                 THRU 9900-EXIT
 16755     END-IF
 16756     EVALUATE TRUE
 16757        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16758           CONTINUE
 16759        WHEN PB-C-LF-CANCEL-AMT = +0
 16760                 AND PB-C-LF-REF-CALC > +0
 16761           CONTINUE
 16762        WHEN WS-LF-REFUND-OVS-AMT = 0
 16763                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 304
* EL050.cbl
 16764           CONTINUE
 16765        WHEN OTHER
 16766           IF WS-TOL-LF-REFUND  = +0
 16767              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16768           END-IF
 16769           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16770                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16771                          (PB-C-LF-CANCEL-AMT))
 16772              CONTINUE
 16773           ELSE
 16774              IF WS-LF-REFUND-OVS-AMT = +0
 16775                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16776              END-IF
 16777              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16778                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16779                                       PB-C-LF-CANCEL-AMT)
 16780                 CONTINUE
 16781              ELSE
 16782                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16783                   MOVE ER-2754   TO  WS-ERROR
 16784                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16785                 ELSE
 16786                    MOVE ER-2736   TO  WS-ERROR
 16787                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16788                 END-IF
 16789              END-IF
 16790           END-IF
 16791     END-EVALUATE.
 16792
 16793     EVALUATE TRUE
 16794        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16795           CONTINUE
 16796        WHEN PB-C-LF-CANCEL-AMT = +0
 16797                 AND PB-C-LF-REF-CALC > +0
 16798           CONTINUE
 16799        WHEN OTHER
 16800           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16801               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16802              CONTINUE
 16803           ELSE
 16804              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16805               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16806                CONTINUE
 16807              ELSE
 16808                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16809                     MOVE ER-2754   TO  WS-ERROR
 16810                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16811                 ELSE
 16812                     MOVE ER-2736   TO  WS-ERROR
 16813                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16814                 END-IF
 16815              END-IF
 16816           END-IF
 16817     END-EVALUATE.
 16818
 16819     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16820         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16821             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 305
* EL050.cbl
 16822     ELSE
 16823         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16824
 16825     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16826         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16827             (1 - WS-TOL-AH-REFUND-PCT)
 16828     ELSE
 16829         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16830
 16831     IF (PB-COMPANY-ID = 'DCC')
 16832        AND (PB-CI-ENTRY-STATUS = 'M')
 16833        AND (PB-C-AH-CANCEL-AMT > +0)
 16834        MOVE ER-3843             TO WS-ERROR
 16835        PERFORM 9900-ERROR-FORMAT
 16836                                 THRU 9900-EXIT
 16837     END-IF
 16838     EVALUATE TRUE
 16839        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16840           CONTINUE
 16841*       WHEN PB-C-AH-REF-CALC = +0 AND
 16842*                  PB-C-AH-CANCEL-AMT > +0
 16843        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16844                   PB-C-AH-REF-CALC > +0
 16845           CONTINUE
 16846        WHEN WS-AH-REFUND-OVS-AMT = +0
 16847                AND WS-TOL-AH-REFUND = +0
 16848           CONTINUE
 16849        WHEN OTHER
 16850           IF WS-TOL-AH-REFUND = +0
 16851              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16852           END-IF
 16853           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16854               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16855                                         PB-C-AH-CANCEL-AMT)
 16856              CONTINUE
 16857           ELSE
 16858              IF WS-AH-REFUND-OVS-AMT = +0
 16859                 MOVE +9999999.99 TO
 16860                         WS-AH-REFUND-OVS-AMT
 16861              END-IF
 16862              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16863                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16864                                         PB-C-AH-CANCEL-AMT)
 16865                 CONTINUE
 16866              ELSE
 16867                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16868                    MOVE ER-2754   TO  WS-ERROR
 16869                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16870                 ELSE
 16871                    MOVE ER-2736   TO  WS-ERROR
 16872                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16873                 END-IF
 16874              END-IF
 16875           END-IF
 16876     END-EVALUATE.
 16877
 16878     EVALUATE TRUE
 16879        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 306
* EL050.cbl
 16880           CONTINUE
 16881*       WHEN PB-C-AH-REF-CALC > +0 AND
 16882*                  PB-C-AH-CANCEL-AMT = +0
 16883        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16884                   PB-C-AH-REF-CALC = +0
 16885           CONTINUE
 16886        WHEN OTHER
 16887           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16888               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16889              CONTINUE
 16890           ELSE
 16891              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16892                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16893                 CONTINUE
 16894              ELSE
 16895                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16896                     MOVE ER-2754   TO  WS-ERROR
 16897                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16898                 ELSE
 16899                     MOVE ER-2736   TO  WS-ERROR
 16900                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16901                 END-IF
 16902              END-IF
 16903           END-IF
 16904     END-EVALUATE.
 16905
 16906     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16907        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16908        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16909           AND  PB-C-LF-REF-CALC < +1.00
 16910           AND  PB-C-AH-REF-CALC < +1.00
 16911           CONTINUE
 16912        ELSE
 16913           IF (PB-COMPANY-ID = 'DCC')
 16914              AND (PB-CI-ENTRY-STATUS = 'M')
 16915              CONTINUE
 16916           ELSE
 16917              MOVE ER-2741       TO WS-ERROR
 16918              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16919           END-IF
 16920        END-IF
 16921     END-IF
 16922
 16923     IF (PB-C-LF-CANCEL-AMT = ZERO
 16924        AND WS-LF-BENEFIT-CD NOT = ZERO
 16925        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16926        AND PB-C-LF-REF-CALC NOT = ZERO)
 16927        OR
 16928        (PB-C-LF-CANCEL-AMT = ZERO
 16929        AND WS-LF-BENEFIT-CD NOT = ZERO
 16930        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16931             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16932                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16933                NEXT SENTENCE
 16934             ELSE
 16935                MOVE ER-2739        TO WS-ERROR
 16936                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16937
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 307
* EL050.cbl
 16938     IF (PB-C-AH-CANCEL-AMT = ZERO
 16939        AND WS-AH-BENEFIT-CD NOT = ZERO
 16940        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16941        AND PB-C-AH-REF-CALC NOT = ZERO)
 16942        OR
 16943        (PB-C-AH-CANCEL-AMT = ZERO
 16944        AND WS-AH-BENEFIT-CD NOT = ZERO
 16945        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16946             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16947                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16948                NEXT SENTENCE
 16949             ELSE
 16950                MOVE ER-2738        TO WS-ERROR
 16951                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16952
 16953 3775-OVER-REF-CHK.
 16954
 16955     IF PB-CI-ENTRY-STATUS = '5'
 16956        GO TO 3780-UPDATE-CANCEL-CERT.
 16957
 16958     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16959                              PB-CI-LF-ALT-PREMIUM-AMT.
 16960
 16961     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16962        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16963                                 PB-C-LF-REF-CALC
 16964      ELSE
 16965        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16966                                 PB-C-LF-CANCEL-AMT.
 16967
 16968     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16969        MOVE ER-2755             TO WS-ERROR
 16970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16971
 16972     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16973
 16974     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16975        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16976                                 PB-C-AH-REF-CALC
 16977      ELSE
 16978        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16979                                 PB-C-AH-CANCEL-AMT.
 16980
 16981     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16982        MOVE ER-2778             TO WS-ERROR
 16983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16984
 16985     IF PB-CI-OB-FLAG NOT = 'Z'
 16986        NEXT SENTENCE
 16987       ELSE
 16988         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16989            MOVE ER-2757           TO WS-ERROR
 16990            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16991
 16992 3780-UPDATE-CANCEL-CERT.
 16993
 16994     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16995        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 308
* EL050.cbl
 16996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16997
 16998     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16999         MOVE ER-2729              TO WS-ERROR
 17000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17001
 17002     IF PB-CI-LF-BENEFIT-CD = ZERO
 17003         GO TO 3780-UPDATE-CONT-1.
 17004
 17005     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17006         GO TO 3780-UPDATE-CONT-1.
 17007
 17008     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17009       AND
 17010        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17011       AND
 17012        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17013       AND
 17014        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17015            NEXT SENTENCE
 17016       ELSE
 17017        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17018          AND
 17019***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17020***       AND
 17021           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17022            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17023               MOVE ER-2730      TO WS-ERROR
 17024               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17025               GO TO 3999-END-EDIT
 17026            ELSE
 17027               GO TO 3999-END-EDIT
 17028        ELSE
 17029            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17030               MOVE ER-2765           TO WS-ERROR
 17031               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17032               GO TO 3785-CHECK-NH.
 17033*              GO TO 3999-END-EDIT.
 17034
 17035 3780-UPDATE-CONT-1.
 17036     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17037
 17038     IF PB-CI-AH-BENEFIT-CD = ZERO
 17039         GO TO 3780-UPDATE-CONT-2.
 17040
 17041     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17042         GO TO 3780-UPDATE-CONT-2.
 17043
 17044     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17045
 17046     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17047       AND
 17048        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17049       AND
 17050        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17051       AND
 17052        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17053            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 309
* EL050.cbl
 17054       ELSE
 17055        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17056          AND
 17057***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17058***       AND
 17059           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17060           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17061            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17062               MOVE ER-2773      TO WS-ERROR
 17063               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17064               GO TO 3999-END-EDIT
 17065            ELSE
 17066               GO TO 3999-END-EDIT
 17067            END-IF
 17068           ELSE
 17069             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17070                IF MSTR-CERT-NO = W-CL-CERT-NO
 17071                   MOVE ER-2890 TO WS-ERROR
 17072                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17073                   GO TO 3999-END-EDIT
 17074                ELSE
 17075                   MOVE ER-2898 TO WS-ERROR
 17076                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17077                   GO TO 3999-END-EDIT
 17078                END-IF
 17079             ELSE
 17080                GO TO 3785-CHECK-NH
 17081             END-IF
 17082           END-IF
 17083          ELSE
 17084            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17085              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17086                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17087                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17088                      MOVE ER-2890 TO WS-ERROR
 17089                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17090                      GO TO 3999-END-EDIT
 17091                   ELSE
 17092                      MOVE ER-2898 TO WS-ERROR
 17093                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17094                      GO TO 3999-END-EDIT
 17095                   END-IF
 17096                ELSE
 17097                   MOVE ER-2765 TO WS-ERROR
 17098                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17099                   GO TO 3785-CHECK-NH
 17100                END-IF
 17101              ELSE
 17102               MOVE ER-2765      TO WS-ERROR
 17103               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17104               GO TO 3785-CHECK-NH.
 17105*              GO TO 3999-END-EDIT.
 17106
 17107 3780-UPDATE-CONT-2.
 17108
 17109     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17110        AND WS-LF-BENEFIT-CD = ZERO
 17111           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 310
* EL050.cbl
 17112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17113
 17114     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17115        AND WS-AH-BENEFIT-CD = ZERO
 17116           MOVE ER-2744           TO WS-ERROR
 17117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17118
 17119     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17120        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17121        AND
 17122        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17123         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17124           MOVE ER-2746           TO WS-ERROR
 17125           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17126
 17127     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17128       AND
 17129        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17130             MOVE ER-2737        TO WS-ERROR
 17131             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17132
 17133     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17134       AND
 17135        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17136             MOVE ER-2737        TO WS-ERROR
 17137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17138
 17139     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17140         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17141             OR 'CID' OR 'DCC' OR 'AHL'
 17142             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17143         ELSE
 17144             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17145                 MOVE ER-2768    TO WS-ERROR
 17146                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17147             ELSE
 17148                 MOVE ER-2756    TO WS-ERROR
 17149                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17150
 17151     IF CERT-PEND-ISSUE-RETURNED
 17152        MOVE ER-2772             TO WS-ERROR
 17153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17154 3785-CHECK-NH.
 17155     IF PB-STATE NOT = 'NH'
 17156        GO TO 3999-END-EDIT
 17157     END-IF
 17158
 17159     MOVE ER-2796                TO WS-ERROR
 17160     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17161     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17162        OR (CM-NH-INTERFACE-SW = 'Y')
 17163        MOVE ER-2793             TO WS-ERROR
 17164        PERFORM 9900-ERROR-FORMAT
 17165                                 THRU 9900-EXIT
 17166     END-IF
 17167     MOVE +0                     TO WS-PAYMENT-AMT
 17168     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17169        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 311
* EL050.cbl
 17170     END-IF
 17171     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17172        GO TO 3999-END-EDIT
 17173     END-IF
 17174     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17175     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17176     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17177        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17178     END-IF
 17179     MOVE '1'                    TO DC-OPTION-CODE
 17180     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17181     IF NO-CONVERSION-ERROR
 17182        IF DC-ELAPSED-DAYS < +16
 17183           GO TO 3999-END-EDIT
 17184        END-IF
 17185     END-IF
 17186     MOVE +0                     TO DC-ELAPSED-DAYS
 17187     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17188     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17189     MOVE '1'                    TO DC-OPTION-CODE
 17190     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17191     IF NO-CONVERSION-ERROR
 17192        IF DC-ELAPSED-DAYS > +30
 17193           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17194        ELSE
 17195           GO TO 3999-END-EDIT
 17196        END-IF
 17197     ELSE
 17198        GO TO 3999-END-EDIT
 17199     END-IF
 17200     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17201        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17202           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17203     IF WS-PAYMENT-AMT < 600.00
 17204        GO TO 3999-END-EDIT
 17205     END-IF
 17206     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17207
 17208     IF (ERMAIL-FOUND = ' ')
 17209         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17210         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17211        GO TO 3999-END-EDIT
 17212     END-IF
 17213     MOVE ER-2795                TO WS-ERROR
 17214     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17215
 17216     GO TO 3999-END-EDIT.
 17217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 312
* EL050.cbl
 17219 3990-FILES-NOT-OPEN.
 17220
 17221     MOVE ER-2617                TO WS-ERROR.
 17222     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17223     GO TO 9990-RETURN.
 17224
 17225 3999-END-EDIT.
 17226
 17227     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17228
 17229     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17230         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17231         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17232             PERFORM 9250-UNLOCK-RETURN
 17233             GO TO 9990-RETURN
 17234          ELSE
 17235             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17236             GO TO 9990-RETURN.
 17237
 17238     IF PB-CANCELLATION
 17239          GO TO 9990-RETURN.
 17240
 17241     IF CERT-WAS-NOT-FOUND
 17242        MOVE SPACES              TO CERTIFICATE-MASTER.
 17243
 17244     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17245
 17246     IF CERT-WAS-FOUND
 17247         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17248             PERFORM 9250-UNLOCK-RETURN
 17249          ELSE
 17250            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17251      ELSE
 17252         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17253
 17254     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17255        IF ((PB-COMPANY-ID = 'DCC')
 17256           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17257                         or
 17258            (pb-company-id = 'CID')
 17259            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17260        END-IF
 17261     END-IF.
 17262
 17263     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17264         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17265     END-IF.
 17266     move ' '                    to ws-ins-age-defaulted
 17267     perform 8150-read-elcrtt    thru 8150-exit
 17268     if ws-ins-age-defaulted = 'Y'
 17269        move er-1573             to ws-error
 17270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17271     end-if
 17272
 17273     if ws-jnt-age-defaulted = 'Y'
 17274        move er-1574             to ws-error
 17275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17276     end-if
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 313
* EL050.cbl
 17277***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17278***                                                           ****
 17279***  Set an error if the state requires verification of agent ****
 17280***  and agent hasn't verified yet and the status is not =    ****
 17281***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17282***  and the entry date > 09/01/2015.                         ****
 17283***                                                           ****
 17284***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17285     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17286        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17287        and (pb-account (9:2) not = 'OB')
 17288        if (ws-st-agent-sig-edit = 'Y')
 17289           and (am-report-code-1 not = 'CONLEY')
 17290           evaluate true
 17291              when cs-agent-edit-status = 'C'
 17292                 move er-1743    to ws-error
 17293                 perform 9900-error-format
 17294                                 thru 9900-exit
 17295              when cs-agent-edit-status = 'S'
 17296                 move er-1744    to ws-error
 17297                 perform 9900-error-format
 17298                                 thru 9900-exit
 17299              when cs-agent-edit-status = 'M'
 17300                 move er-1745    to ws-error
 17301                 perform 9900-error-format
 17302                                 thru 9900-exit
 17303              when cs-agent-edit-status = 'R'
 17304                 move er-1747    to ws-error
 17305                 perform 9900-error-format
 17306                                 thru 9900-exit
 17307              when cs-agent-edit-status = 'N'
 17308                 move er-1748    to ws-error
 17309                 perform 9900-error-format
 17310                                 thru 9900-exit
 17311              when cs-agent-edit-status <> 'V' and 'U' and
 17312                                           'R' and 'N'
 17313                 move er-1746    to ws-error
 17314                 perform 9900-error-format
 17315                                 thru 9900-exit
 17316           end-evaluate
 17317        end-if
 17318     end-if
 17319     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17320     IF ((PB-COMPANY-ID = 'DCC')
 17321        AND (WS-NO-SECURE-PAY))
 17322                  OR
 17323        (WS-LF-SPECIAL-CALC-CD = 'O'
 17324        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17325        SET SKIP-ADDR-EDIT       TO TRUE
 17326     END-IF
 17327     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17328        AND (NOT SKIP-ADDR-EDIT)
 17329        MOVE ER-2963             TO WS-ERROR
 17330        PERFORM 9900-ERROR-FORMAT
 17331                                 THRU 9900-EXIT
 17332        GO TO 9990-RETURN
 17333     END-IF
 17334     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 314
* EL050.cbl
 17335     IF ERPNDM-FOUND NOT = 'X'
 17336        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17337           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17338           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17339           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17340           AND (NOT SKIP-ADDR-EDIT)
 17341           MOVE ER-2694          TO WS-ERROR
 17342           PERFORM 9900-ERROR-FORMAT
 17343                                 THRU 9900-EXIT
 17344        END-IF
 17345        MOVE ' '                 TO STATE-RECORD-ERROR
 17346        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17347        MOVE PM-STATE            TO CNTL-ACCESS
 17348        MOVE '3'                 TO CNTL-REC-TYPE
 17349        MOVE +0                  TO CNTL-SEQ-NO
 17350        MOVE '0'                 TO RC-SW-2
 17351        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17352        IF (NO-STATE-RECORD)
 17353           OR (CF-RECORD-TYPE NOT = '3')
 17354           OR (PM-STATE NOT = CF-STATE-CODE)
 17355           IF (PM-STATE = SPACES)
 17356              AND (SKIP-ADDR-EDIT)
 17357              CONTINUE
 17358           ELSE
 17359              MOVE ER-2963       TO WS-ERROR
 17360              PERFORM 9900-ERROR-FORMAT
 17361                                 THRU 9900-EXIT
 17362           END-IF
 17363        END-IF
 17364        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17365           MOVE ER-2883          TO WS-ERROR
 17366           PERFORM 9900-ERROR-FORMAT
 17367                                 THRU 9900-EXIT
 17368        END-IF
 17369        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17370           MOVE ' '                 TO STATE-RECORD-ERROR
 17371           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17372           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17373           MOVE '3'                 TO CNTL-REC-TYPE
 17374           MOVE +0                  TO CNTL-SEQ-NO
 17375           MOVE '0'                 TO RC-SW-2
 17376           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17377           IF NO-STATE-RECORD
 17378              OR (CF-RECORD-TYPE NOT = '3')
 17379              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17380              MOVE ER-2964          TO WS-ERROR
 17381              PERFORM 9900-ERROR-FORMAT
 17382                                    THRU 9900-EXIT
 17383           END-IF
 17384        END-IF
 17385     ELSE
 17386        IF NOT SKIP-ADDR-EDIT
 17387           MOVE ER-2393          TO WS-ERROR
 17388           PERFORM 9900-ERROR-FORMAT
 17389                                 THRU 9900-EXIT
 17390        END-IF
 17391     END-IF
 17392
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 315
* EL050.cbl
 17393     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17394
 17395     IF (ERMAIL-FOUND = ' ' AND
 17396        ERPNDM-FOUND = ' ')
 17397        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17398           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17399           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17400          OR
 17401           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17402          OR
 17403           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17404           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17405           GO TO 3999-UNLOCK-ERMAIL.
 17406
 17407     IF ERPNDM-FOUND = 'X'
 17408        GO TO 3999-UNLOCK-ERMAIL.
 17409
 17410     IF PM-INSURED-LAST-NAME      = SPACES
 17411        AND PM-INSURED-FIRST-NAME = SPACES
 17412        AND PM-ADDRESS-LINE-1     = SPACES
 17413        AND PM-ADDRESS-LINE-2     = SPACES
 17414        AND PM-CITY-STATE         = SPACES
 17415        AND PM-CRED-BENE-NAME     = SPACES
 17416        AND PM-CRED-BENE-ADDR     = SPACES
 17417        AND PM-CRED-BENE-CTYST    = SPACES
 17418        GO TO 3999-UNLOCK-ERMAIL
 17419     END-IF
 17420
 17421     MOVE SPACES                 TO MAILING-DATA.
 17422
 17423     MOVE 'MA'                   TO MA-RECORD-ID.
 17424     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17425     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17426     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17427     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17428     MOVE PB-SV-STATE            TO MA-STATE.
 17429     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17430     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17431
 17432     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17433     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17434
 17435     IF ERMAIL-FOUND = ' '
 17436        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17437     ELSE
 17438        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17439        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17440        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17441
 17442     GO TO 9990-RETURN.
 17443
 17444 3999-UNLOCK-ERMAIL.
 17445     IF ERMAIL-FOUND = ' '
 17446        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17447
 17448     GO TO 9990-RETURN.
 17449******************************************************************
 17450
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 316
* EL050.cbl
 17452 4000-UPDATE-CANCELLED-CERT.
 17453     IF CERT-WAS-NOT-FOUND
 17454        GO TO 4299-EXIT.
 17455
 17456*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17457     IF PB-C-NH-INT-ON-REFS > ZEROS
 17458        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17459     END-IF
 17460     IF PB-C-REF-INTERFACE-SW = 'Y'
 17461        MOVE PB-C-REF-INTERFACE-SW
 17462                                 TO CM-NH-INTERFACE-SW
 17463     END-IF
 17464     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17465     IF ERMAIL-FOUND = 'X'
 17466        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17467        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17468        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17469        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17470           MOVE ER-2694          TO WS-ERROR
 17471           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17472     END-IF
 17473
 17474     IF PB-C-POST-CARD-IND = 'Y'
 17475        MOVE +8                  TO SUB
 17476*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17477        IF ERMAIL-FOUND = ' '
 17478           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17479              (SUB > +7)
 17480              OR (MA-MAIL-STATUS (SUB) = '1')
 17481           END-PERFORM
 17482        END-IF
 17483        IF (SUB > +7)
 17484           OR (ERMAIL-FOUND = 'X')
 17485           MOVE ER-3789          TO WS-ERROR
 17486           PERFORM 9900-ERROR-FORMAT
 17487                                 THRU 9900-EXIT
 17488        END-IF
 17489     ELSE
 17490        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17491     END-IF
 17492
 17493     IF ERMAIL-FOUND = ' '
 17494        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17495     END-IF.
 17496
 17497     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17498
 17499     IF PB-CI-OB-FLAG = 'Z'
 17500        GO TO 4150-SUMMARY-CERT-CANCEL.
 17501
 17502     IF PB-C-LF-CANCEL-VOIDED
 17503         PERFORM 4200-REVERSE-LF-CANCEL.
 17504     IF PB-C-AH-CANCEL-VOIDED
 17505         PERFORM 4200-REVERSE-AH-CANCEL.
 17506
 17507 4100-APPLY-LF-CANCEL.
 17508
 17509     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 317
* EL050.cbl
 17510
 17511 4100-CHECK-LF-ERRORS.
 17512
 17513     ADD +1                       TO WS-SUB.
 17514
 17515     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17516        IF LF-COVERAGE-CANCELLED
 17517           GO TO 4100-LF-CANCEL-CONT
 17518        ELSE
 17519           GO TO 4100-UPDATE-LF-COVERAGE.
 17520
 17521     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17522                                   ER-2729 OR
 17523                                   ER-2730 OR
 17524                                   ER-2731 OR
 17525                                   ER-2732 OR
 17526                                   ER-2737 OR
 17527                                   ER-2740 OR
 17528                                   ER-2743 OR
 17529                                   ER-2749 OR
 17530                                   ER-2750 OR
 17531                                   ER-2755 OR
 17532                                   ER-2757 OR
 17533                                   ER-2760 OR
 17534                                   ER-2772 OR
 17535                                   ER-2774 OR
 17536                                   ER-2776 OR
 17537                                   ER-2794
 17538        GO TO 4100-UPDATE-LF-COVERAGE.
 17539
 17540     GO TO 4100-CHECK-LF-ERRORS.
 17541
 17542 4100-UPDATE-LF-COVERAGE.
 17543
 17544     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17545     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17546     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17547        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17548     END-IF
 17549     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17550                                      TO CM-CREDIT-INTERFACE-SW-2.
 17551     IF CM-LF-CANCEL-DT = LOW-VALUE
 17552         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17553
 17554     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17555         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17556                                         CM-LF-STATUS-AT-CANCEL.
 17557
 17558     GO TO 4100-APPLY-AH-CANCEL.
 17559
 17560 4100-LF-CANCEL-CONT.
 17561     IF PB-C-LF-CANCEL-VOIDED
 17562         GO TO 4100-APPLY-AH-CANCEL.
 17563
 17564     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17565         GO TO 4100-APPLY-AH-CANCEL.
 17566
 17567     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 318
* EL050.cbl
 17568        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17569           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17570        ELSE
 17571           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17572
 17573     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17574     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17575
 17576     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17577         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17578
 17579     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17580        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17581         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17582         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17583
 17584     IF PB-RECORD-RETURNED
 17585        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17586      ELSE
 17587        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17588
 17589 4100-APPLY-AH-CANCEL.
 17590
 17591     MOVE +0                      TO WS-SUB.
 17592
 17593 4100-CHECK-AH-ERRORS.
 17594
 17595     ADD +1                       TO WS-SUB.
 17596
 17597     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17598        IF AH-COVERAGE-CANCELLED
 17599           GO TO 4100-AH-CANCEL-CONT
 17600        ELSE
 17601           GO TO 4100-UPDATE-AH-COVERAGE.
 17602
 17603     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17604                                   ER-2729 OR
 17605                                   ER-2732 OR
 17606                                   ER-2737 OR
 17607                                   ER-2740 OR
 17608                                   ER-2744 OR
 17609                                   ER-2749 OR
 17610                                   ER-2750 OR
 17611                                   ER-2755 OR
 17612                                   ER-2757 OR
 17613                                   ER-2760 OR
 17614                                   ER-2771 OR
 17615                                   ER-2772 OR
 17616                                   ER-2773 OR
 17617                                   ER-2775 OR
 17618                                   ER-2777 OR
 17619                                   ER-2778 OR
 17620                                   ER-2794
 17621        GO TO 4100-UPDATE-AH-COVERAGE.
 17622
 17623     GO TO 4100-CHECK-AH-ERRORS.
 17624
 17625 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 319
* EL050.cbl
 17626
 17627     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17628     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17629     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17630     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17631                                      TO CM-CREDIT-INTERFACE-SW-2.
 17632     IF CM-AH-CANCEL-DT = LOW-VALUE
 17633         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17634
 17635     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17636         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17637                                         CM-AH-STATUS-AT-CANCEL.
 17638
 17639     IF LF-COVERAGE-CANCELLED
 17640         IF PB-RECORD-RETURNED
 17641              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17642          ELSE
 17643              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17644
 17645     GO TO 4299-EXIT.
 17646
 17647 4100-AH-CANCEL-CONT.
 17648     IF PB-C-AH-CANCEL-VOIDED
 17649         GO TO 4299-EXIT.
 17650
 17651     if cm-credit-interface-sw-2 = ' '
 17652        if pb-fatal-errors or pb-unforced-errors
 17653           move '4'              to cm-credit-interface-sw-2
 17654        else
 17655           move '1'              to cm-credit-interface-sw-2
 17656        end-if
 17657     end-if
 17658     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17659         GO TO 4299-EXIT.
 17660
 17661     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17662        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17663           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17664        ELSE
 17665           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17666
 17667     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17668     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17669
 17670     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17671         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17672
 17673     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17674         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17675         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17676
 17677     IF PB-RECORD-RETURNED
 17678        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17679      ELSE
 17680        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17681
 17682     GO TO 4299-EXIT.
 17683
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 320
* EL050.cbl
 17684 4150-SUMMARY-CERT-CANCEL.
 17685     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17686
 17687     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17688        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17689                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17690     ELSE
 17691        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17692                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17693
 17694     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17695        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17696                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17697     ELSE
 17698        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17699                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17700
 17701     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17702        NEXT SENTENCE
 17703     ELSE
 17704        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17705
 17706     GO TO 4299-EXIT.
 17707
 17708 4200-REVERSE-LF-CANCEL.
 17709     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17710
 17711     IF CM-LF-CANCEL-APPLIED
 17712        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17713        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17714        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17715
 17716     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17717
 17718     IF PB-RECORD-RETURNED
 17719        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17720       ELSE
 17721        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17722
 17723 4200-REVERSE-LF-EXIT.
 17724       EXIT.
 17725
 17726 4200-REVERSE-AH-CANCEL.
 17727     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17728
 17729     IF CM-AH-CANCEL-APPLIED
 17730        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17731        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17732        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17733
 17734     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17735
 17736     IF PB-RECORD-RETURNED
 17737        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17738       ELSE
 17739        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17740
 17741 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 321
* EL050.cbl
 17742       EXIT.
 17743
 17744 4299-EXIT.
 17745       EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 322
* EL050.cbl
 17747
 17748 4500-UPDATE-NEW-CERT.
 17749     IF CERT-WAS-FOUND
 17750         NEXT SENTENCE
 17751       ELSE
 17752         GO TO 4520-BUILD-NEW-KEY.
 17753
 17754     IF  CLASIC-CREATED-CERT
 17755         GO TO 4999-EXIT.
 17756
 17757     IF  CERT-WAS-CREATED-FOR-CLAIM
 17758         GO TO 4520-BUILD-NEW-KEY.
 17759
 17760     IF CERT-ADDED-BATCH
 17761        IF CM-RECORD-ID = 'CM'
 17762            GO TO 4999-EXIT.
 17763
 17764 4520-BUILD-NEW-KEY.
 17765* BUILD CONTROL PRIMARY
 17766
 17767     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17768                                       CM-COMPANY-CD-A1
 17769                                       CM-COMPANY-CD-A2
 17770                                       CM-COMPANY-CD-A4
 17771                                       CM-COMPANY-CD-A5.
 17772
 17773     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17774     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17775     MOVE PB-SV-STATE               TO CM-STATE.
 17776     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17777     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17778     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17779     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17780
 17781     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17782
 17783     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17784     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17785     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17786     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17787
 17788     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17789        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17790
 17791     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17792         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17793         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17794         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17795         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17796     ELSE
 17797         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17798
 17799     IF PB-COMPANY-ID   EQUAL  'CRI'
 17800         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17801         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17802         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17803         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17804         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 323
* EL050.cbl
 17805
 17806     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17807        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17808         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17809
 17810     IF PB-COMPANY-ID  = 'LBL'
 17811        IF PB-I-JOINT-COVERAGE
 17812            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17813                                           PB-I-MEMBER-NO
 17814            GO TO 4550-CONT-CERT-PROCESS.
 17815
 17816     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17817        NEXT SENTENCE
 17818     ELSE
 17819        GO TO 4540-BUILD-MEMBER-NO.
 17820
 17821******************************************************************
 17822*                                                                *
 17823*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17824*    FOR 'MON'.                                                  *
 17825*                                                                *
 17826******************************************************************
 17827
 17828     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17829     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17830     MOVE +1                     TO WS-SUB1
 17831                                    WS-SUB2.
 17832
 17833 4530-EDIT-MEMB-NAME.
 17834
 17835     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17836        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17837        ADD +1                       TO WS-SUB2.
 17838
 17839     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17840        ADD +1                       TO WS-SUB1
 17841        GO TO 4530-EDIT-MEMB-NAME.
 17842
 17843     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17844     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17845     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17846*    MOVE SPACE                      TO DC-OPTION-CODE.
 17847     SET  BIN-TO-GREG                TO TRUE.
 17848     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17849     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17850
 17851     GO TO 4550-CONT-CERT-PROCESS.
 17852
 17853******************************************************************
 17854*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17855******************************************************************
 17856
 17857 4540-BUILD-MEMBER-NO.
 17858
 17859     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17860         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17861         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17862         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 324
* EL050.cbl
 17863         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17864     ELSE
 17865         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17866
 17867     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17868        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17869         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17870
 17871 4550-CONT-CERT-PROCESS.
 17872
 17873*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17874*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17875*    ELSE
 17876*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17877
 17878     IF CERT-WAS-CREATED-FOR-CLAIM
 17879        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17880        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17881
 17882     IF CERT-AND-CLAIM-ONLINE
 17883        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17884        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17885
 17886     MOVE 'CM'                     TO CM-RECORD-ID.
 17887     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17888
 17889     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17890        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17891        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17892     ELSE
 17893        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17894        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17895
 17896     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17897     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17898     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17899     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17900     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17901     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17902     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17903                                      CM-LF-ITD-CANCEL-AMT
 17904                                      CM-LF-ITD-DEATH-AMT
 17905                                      CM-AH-ITD-AH-PMT
 17906                                      CM-AH-ITD-LUMP-PMT
 17907                                      CM-AH-ITD-CANCEL-AMT
 17908                                      CM-LF-NSP-PREMIUM-AMT
 17909                                      CM-AH-NSP-PREMIUM-AMT.
 17910*                                     CM-CLAIM-DEDUCT-WITHHELD
 17911*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17912     if pb-i-loan-apr = +99.9999
 17913        move zeros                 to cm-loan-apr
 17914     else
 17915        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17916     end-if
 17917     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17918     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17919     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17920     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 325
* EL050.cbl
 17921     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17922     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17923     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17924     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17925     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17926     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17927     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17928
 17929     IF PB-I-LIVES NOT NUMERIC
 17930         MOVE ZERO                 TO PB-I-LIVES.
 17931
 17932     IF PB-I-NUM-BILLED NOT NUMERIC
 17933         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17934
 17935     MOVE PB-I-LIVES               TO CM-LIVES.
 17936     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17937
 17938     IF PB-COMPANY-ID EQUAL  'DMD'
 17939         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17940         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17941
 17942     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17943     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17944     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17945     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17946     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17947     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17948
 17949     IF PB-I-LF-POLICY-FEE NUMERIC
 17950        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17951     ELSE
 17952        MOVE +0                    TO CM-LF-POLICY-FEE.
 17953
 17954     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17955        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17956        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17957     ELSE
 17958        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17959
 17960     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17961     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17962     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17963     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17964     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17965     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17966     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17967     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17968     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17969
 17970     IF PB-I-AH-POLICY-FEE NUMERIC
 17971        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17972     ELSE
 17973        MOVE +0                    TO CM-AH-POLICY-FEE.
 17974
 17975     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17976        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17977     ELSE
 17978        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 326
* EL050.cbl
 17979
 17980     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17981     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17982
 17983     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17984                                      CM-LF-DEATH-EXIT-DT
 17985                                      CM-AH-SETTLEMENT-EXIT-DT.
 17986
 17987*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17988*                       'TIH' OR 'OFL' OR 'FLA' OR
 17989*                       'TII' OR 'TMS' OR 'CRI' OR
 17990*                       'NCL'
 17991     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17992
 17993     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17994         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17995            MOVE '2'                TO CM-PREMIUM-TYPE.
 17996
 17997     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17998         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17999            MOVE '2'                TO CM-PREMIUM-TYPE.
 18000
 18001     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18002         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18003     ELSE
 18004         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18005         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18006
 18007     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18008     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18009     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18010     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18011     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18012     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18013     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18014     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18015
 18016     IF PB-NO-MONTHS-SKIPPED
 18017         MOVE SPACE                 TO CM-SKIP-CODE
 18018     ELSE
 18019         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18020
 18021     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18022     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18023                                       CM-LF-STATUS-AT-CANCEL.
 18024
 18025     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18026     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18027                                       CM-AH-STATUS-AT-CANCEL.
 18028
 18029     MOVE '1'                       TO CM-ENTRY-STATUS.
 18030
 18031     IF PB-REISSUED-CERT
 18032        MOVE '5'                    TO CM-ENTRY-STATUS.
 18033
 18034     IF PB-MONTHLY-CERT
 18035        MOVE 'M'                    TO CM-ENTRY-STATUS.
 18036
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 327
* EL050.cbl
 18037     IF PB-CASH-CERT
 18038        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18039
 18040     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18041     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18042     IF PB-POLICY-IS-DECLINED
 18043        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18044
 18045     IF PB-POLICY-IS-VOIDED
 18046        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18047
 18048     IF PB-NEEDS-UNDERWRITING
 18049        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18050
 18051     IF PB-REIN-ONLY-CERT
 18052        MOVE '9'                    TO CM-ENTRY-STATUS.
 18053
 18054     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18055         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18056     ELSE
 18057         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18058
 18059     IF PB-RECORD-RETURNED
 18060        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18061      ELSE
 18062        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18063
 18064     IF PB-I-MAIL-ADDRS-PRESENT
 18065        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18066
 18067     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18068                                       CM-ENTRY-DT.
 18069
 18070 4999-EXIT.
 18071     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 328
* EL050.cbl
 18073
 18074 5000-PROCESS-REPS.
 18075     MOVE ' '                    TO AGTC-MASTER-SW
 18076     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18077     MOVE CO-TYPE                TO AGTC-TYPE
 18078     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18079     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18080     IF (AGTC-MASTER-SW NOT = 'N')
 18081        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18082        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18083        PERFORM 8583-READ-ERAGTC-NEXT
 18084                                 THRU 8583-EXIT
 18085     END-IF
 18086     IF AGTC-MASTER-SW = 'N'
 18087        CONTINUE
 18088     ELSE
 18089        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18090           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18091              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18092              MOVE 'Y'           TO AGTC-MASTER-SW
 18093           END-IF
 18094        END-IF
 18095     END-IF
 18096     .
 18097 5000-EXIT.
 18098     EXIT.
 18099 6370-EDIT-INPUT-LF-CODE.
 18100     move ' ' to ws-benefit-cd-chg-sw
 18101     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18102        MOVE +1                  TO SUB
 18103        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18104        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18105        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18106        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18107        GO TO 6370-SEARCH-LOOP.
 18108
 18109     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18110
 18111     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18112     MOVE SPACES                 TO CNTL-ACCESS.
 18113*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18114     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18115     MOVE +0                     TO CNTL-SEQ-NO.
 18116     MOVE '4' TO RC-SW-2.
 18117     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18118
 18119     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18120        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18121        GO TO 6370-NO-LF-FOUND.
 18122
 18123     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18124     MOVE +1                     TO SUB.
 18125
 18126 6370-SEARCH-LOOP.
 18127     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18128         GO TO 6370-NO-LF-FOUND.
 18129
 18130     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 329
* EL050.cbl
 18131        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18132           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18133           set benefit-code-chg to true
 18134        end-if
 18135        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18136        GO TO 6370-HER-NET-PAY-CHECK.
 18137
 18138     ADD 1   TO SUB.
 18139*    IF SUB GREATER 120
 18140     IF SUB GREATER 200
 18141         GO TO 6370-NO-LF-FOUND.
 18142
 18143     GO TO 6370-SEARCH-LOOP.
 18144
 18145 6370-NO-LF-FOUND.
 18146
 18147     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18148        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18149        set benefit-code-chg to true
 18150     end-if
 18151     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18152
 18153 6370-HER-NET-PAY-CHECK.
 18154
 18155     IF PB-COMPANY-ID = 'CID'
 18156        IF PB-SV-STATE = 'CA' OR 'MN'
 18157           IF PB-I-LF-BENEFIT-CD = '02'
 18158              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18159           ELSE
 18160              IF PB-I-LF-BENEFIT-CD = '04'
 18161                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18162              END-IF
 18163           END-IF
 18164        END-IF
 18165     END-IF
 18166
 18167     IF PB-COMPANY-ID NOT = 'HER'
 18168         GO TO 6370-EXIT.
 18169
 18170     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18171         GO TO 6370-EXIT.
 18172
 18173     IF PB-I-LF-TERM NOT NUMERIC
 18174         MOVE ZEROS              TO PB-I-LF-TERM.
 18175
 18176     IF PB-I-LOAN-TERM NOT NUMERIC
 18177         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18178
 18179     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18180         GO TO 6370-EXIT.
 18181
 18182     IF PB-I-LF-BENEFIT-CD = '33'
 18183         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18184
 18185     IF PB-I-LF-BENEFIT-CD = '34'
 18186         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18187
 18188 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 330
* EL050.cbl
 18189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 331
* EL050.cbl
 18191
 18192 6380-EDIT-INPUT-AH-CODE.
 18193     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18194        MOVE +1                  TO SUB
 18195        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18196        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18197        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18198        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18199        GO TO 6380-SEARCH-LOOP.
 18200
 18201     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18202
 18203     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18204     MOVE SPACES                 TO CNTL-ACCESS.
 18205     MOVE 'A'                    TO CNTL-REC-TYPE.
 18206*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18207     MOVE +0                     TO CNTL-SEQ-NO.
 18208     MOVE '5' TO RC-SW-2.
 18209     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18210
 18211     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18212        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18213        GO TO 6380-NO-AH-FOUND.
 18214
 18215     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18216     MOVE +1 TO SUB.
 18217
 18218 6380-SEARCH-LOOP.
 18219     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18220         GO TO 6380-NO-AH-FOUND.
 18221
 18222     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18223         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18224         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18225
 18226     ADD 1   TO SUB.
 18227     IF SUB GREATER THAN 96
 18228*    IF SUB GREATER THAN 300
 18229         GO TO 6380-NO-AH-FOUND.
 18230
 18231     GO TO 6380-SEARCH-LOOP.
 18232
 18233 6380-NO-AH-FOUND.
 18234
 18235     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18236
 18237     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18238         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18239     ELSE
 18240         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18241
 18242 6380-CSO-AH-ONLY-CHECKS.
 18243
 18244     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18245        NEXT SENTENCE
 18246      ELSE
 18247        GO TO 6380-EXIT.
 18248
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 332
* EL050.cbl
 18249     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18250         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18251
 18252
 18253     GO TO 6380-EXIT
 18254     .
 18255 6380-CSO-LIFE-WITH-AH-CHECKS.
 18256
 18257
 18258     .
 18259 6380-EXIT.
 18260     EXIT.
 18261
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 333
* EL050.cbl
 18263
 18264 6400-COMPUTE-EXTENSION-DAYS.
 18265
 18266******************************************************************
 18267*                                                                *
 18268*                   COMPUTE EXTENSION DAYS                       *
 18269*                                                                *
 18270*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18271*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18272*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18273*    THE EXTENSION DAYS.                                         *
 18274*                                                                *
 18275******************************************************************
 18276
 18277     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18278     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18279
 18280******************************************************************
 18281*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18282*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18283******************************************************************
 18284
 18285     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18286        COMPUTE WS-ODD-DAYS-OVER =
 18287               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18288     ELSE
 18289        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18290
 18291     IF WS-ODD-DAYS-OVER = ZEROS
 18292           GO TO 6499-EXIT
 18293     ELSE
 18294        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18295           IF WS-WDF-MONTH = 02
 18296              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18297              ADD 2       TO  WS-ODD-DAYS-OVER
 18298              GO TO 6499-EXIT
 18299           ELSE
 18300              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18301                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18302                 GO TO 6499-EXIT
 18303               ELSE
 18304                 GO TO 6499-EXIT
 18305        ELSE
 18306           GO TO 6499-EXIT.
 18307
 18308 6412-CHECK-TO-DAY.
 18309
 18310        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18311           IF WS-WDT-DAY = 28
 18312              ADD 2              TO WS-ODD-DAYS-OVER
 18313           ELSE
 18314              IF WS-WDT-DAY = 29
 18315                 ADD 1           TO WS-ODD-DAYS-OVER
 18316              ELSE
 18317                 NEXT SENTENCE
 18318        ELSE
 18319           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18320              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 334
* EL050.cbl
 18321
 18322     GO TO 6499-EXIT.
 18323
 18324
 18325 6415-CHECK-LEAP-YEAR.
 18326
 18327     IF DC-DAYS-IN-MONTH = 29
 18328        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18329
 18330 6415-EXIT.
 18331     EXIT.
 18332
 18333 6499-EXIT.
 18334      EXIT.
 18335
 18336 6500-END.
 18337     EXIT.
 18338
 18339
 18340******************************************************************
 18341************* PROCEDURE DIVISION FOR EL050 ***********************
 18342********************** ELC50PD END *******************************
 18343
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 335
* EL050.cbl
 18345
 18346**START***********************************************************
 18347*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18348*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18349******************************************************************
 18350*
 18351 6600-GET-STATE-MUNICIPAL-TAX.
 18352
 18353     IF PB-COMPANY-ID NOT = 'DMD'
 18354         GO TO 6640-EXIT.
 18355
 18356     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18357     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18358     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18359*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18360*
 18361***  Y2K PROJ 7744
 18362     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18363     SET BIN-TO-GREG          TO TRUE.
 18364     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18365
 18366     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18367
 18368     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18369     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18370
 18371
 18372* EXEC CICS HANDLE CONDITION
 18373*        INVREQ    (6610-START-BROWSE)
 18374*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18375*        NOTFND    (6630-END-OF-FILE)
 18376*    END-EXEC.
 18377*    MOVE '"$8JI                 ! # #00018359' TO DFHEIV0
 18378     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18380     MOVE X'2320233030303138333539' TO DFHEIV0(25:11)
 18381     CALL 'kxdfhei1' USING DFHEIV0
 18382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18383
 18384
 18385 6610-START-BROWSE.
 18386
 18387
 18388* EXEC CICS HANDLE CONDITION
 18389*        NOTFND    (6630-END-OF-FILE)
 18390*        DISABLED  (6630-ERRESS-PROBLEM)
 18391*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18392*        ENDFILE   (6630-END-OF-FILE)
 18393*    END-EXEC.
 18394*    MOVE '"$IcJ''                ! $ #00018367' TO DFHEIV0
 18395     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18397     MOVE X'2420233030303138333637' TO DFHEIV0(25:11)
 18398     CALL 'kxdfhei1' USING DFHEIV0
 18399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18400
 18401
 18402
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 336
* EL050.cbl
 18403* EXEC CICS STARTBR
 18404*        DATASET (FILE-ID-ERRESS)
 18405*        RIDFLD  (WS-ERRESS-KEY)
 18406*        GTEQ
 18407*    END-EXEC.
 18408     MOVE 0
 18409       TO DFHEIV11
 18410*    MOVE '&,         G          &   #00018374' TO DFHEIV0
 18411     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18413     MOVE X'2020233030303138333734' TO DFHEIV0(25:11)
 18414     CALL 'kxdfhei1' USING DFHEIV0,
 18415           FILE-ID-ERRESS,
 18416           WS-ERRESS-KEY,
 18417           DFHEIV99,
 18418           DFHEIV11,
 18419           DFHEIV99
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
 18422
 18423 6620-READ-NEXT-ERRESS-MASTER.
 18424
 18425
 18426* EXEC CICS HANDLE CONDITION
 18427*        NOTFND    (6630-END-OF-FILE)
 18428*        ENDFILE   (6630-END-OF-FILE)
 18429*        DISABLED  (6630-ERRESS-PROBLEM)
 18430*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18431*    END-EXEC.
 18432*    MOVE '"$I''cJ                ! % #00018382' TO DFHEIV0
 18433     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18435     MOVE X'2520233030303138333832' TO DFHEIV0(25:11)
 18436     CALL 'kxdfhei1' USING DFHEIV0
 18437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18438
 18439
 18440
 18441* EXEC CICS READNEXT
 18442*        DATASET (FILE-ID-ERRESS)
 18443*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18444*        RIDFLD  (WS-ERRESS-KEY)
 18445*    END-EXEC.
 18446     MOVE LENGTH OF
 18447      RESIDENT-STATE-TAX-MASTER
 18448       TO DFHEIV12
 18449     MOVE 0
 18450       TO DFHEIV11
 18451*    MOVE '&.IL                  )   #00018389' TO DFHEIV0
 18452     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18454     MOVE X'2020233030303138333839' TO DFHEIV0(25:11)
 18455     CALL 'kxdfhei1' USING DFHEIV0,
 18456           FILE-ID-ERRESS,
 18457           RESIDENT-STATE-TAX-MASTER,
 18458           DFHEIV12,
 18459           WS-ERRESS-KEY,
 18460           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 337
* EL050.cbl
 18461           DFHEIV11,
 18462           DFHEIV99,
 18463           DFHEIV99
 18464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18465
 18466
 18467     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18468
 18469* EXEC CICS ENDBR
 18470*            DATASET (FILE-ID-ERRESS)
 18471*       END-EXEC
 18472     MOVE 0
 18473       TO DFHEIV11
 18474*    MOVE '&2                    $   #00018396' TO DFHEIV0
 18475     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18477     MOVE X'2020233030303138333936' TO DFHEIV0(25:11)
 18478     CALL 'kxdfhei1' USING DFHEIV0,
 18479           FILE-ID-ERRESS,
 18480           DFHEIV11,
 18481           DFHEIV99
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18483        GO TO 6630-END-OF-FILE.
 18484
 18485     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18486        NEXT SENTENCE
 18487      ELSE
 18488        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18489
 18490*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18491*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18492*
 18493     MOVE +2                     TO WS-SUB1.
 18494
 18495     IF PB-ISSUE
 18496     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18497        MOVE +1                  TO WS-SUB1.
 18498
 18499     IF PB-CANCELLATION
 18500     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18501        MOVE +1                  TO WS-SUB1.
 18502*
 18503*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18504*
 18505***  Y2K PROJ 7744
 18506     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18507***  Y2K PROJ 7744
 18508
 18509*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18510* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18511* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18512
 18513     ADD 1                    TO WS-YEAR-YY.
 18514
 18515     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18516         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18517                              TO WS-RES-STATE-TAX
 18518         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 338
* EL050.cbl
 18519                              TO WS-RES-MUNI-TAX
 18520     ELSE
 18521         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18522                              TO WS-RES-STATE-TAX
 18523         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18524                              TO WS-RES-MUNI-TAX.
 18525
 18526*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18527
 18528     IF PB-CANCELLATION
 18529         GO TO 6640-CANCEL-TAX.
 18530
 18531     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18532         COMPUTE PB-I-STATE-TAX ROUNDED =
 18533                                   PB-I-LF-PREMIUM-AMT
 18534                                 * WS-RES-STATE-TAX
 18535         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18536                                   PB-I-LF-PREMIUM-AMT
 18537                                 * WS-RES-MUNI-TAX
 18538     ELSE
 18539     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18540         COMPUTE PB-I-STATE-TAX ROUNDED =
 18541                                   PB-I-AH-PREMIUM-AMT
 18542                                 * WS-RES-STATE-TAX
 18543         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18544                                   PB-I-AH-PREMIUM-AMT
 18545                                 * WS-RES-MUNI-TAX.
 18546
 18547
 18548* EXEC CICS ENDBR
 18549*         DATASET (FILE-ID-ERRESS)
 18550*    END-EXEC.
 18551     MOVE 0
 18552       TO DFHEIV11
 18553*    MOVE '&2                    $   #00018463' TO DFHEIV0
 18554     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18555     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18556     MOVE X'2020233030303138343633' TO DFHEIV0(25:11)
 18557     CALL 'kxdfhei1' USING DFHEIV0,
 18558           FILE-ID-ERRESS,
 18559           DFHEIV11,
 18560           DFHEIV99
 18561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18562
 18563
 18564     GO TO 6640-EXIT.
 18565
 18566 6640-CANCEL-TAX.
 18567     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18568
 18569     IF PB-C-LF-CANCEL-AMT > ZEROS
 18570         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18571                                   PB-C-LF-CANCEL-AMT
 18572                                 * WS-RES-STATE-TAX
 18573         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18574                                   PB-C-LF-CANCEL-AMT
 18575                                *  WS-RES-MUNI-TAX
 18576     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 339
* EL050.cbl
 18577     IF PB-C-AH-CANCEL-AMT > ZEROS
 18578         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18579                                   PB-C-AH-CANCEL-AMT
 18580                                 * WS-RES-STATE-TAX
 18581         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18582                                   PB-C-AH-CANCEL-AMT
 18583                                *  WS-RES-MUNI-TAX.
 18584
 18585
 18586* EXEC CICS ENDBR
 18587*         DATASET (FILE-ID-ERRESS)
 18588*    END-EXEC.
 18589     MOVE 0
 18590       TO DFHEIV11
 18591*    MOVE '&2                    $   #00018488' TO DFHEIV0
 18592     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18594     MOVE X'2020233030303138343838' TO DFHEIV0(25:11)
 18595     CALL 'kxdfhei1' USING DFHEIV0,
 18596           FILE-ID-ERRESS,
 18597           DFHEIV11,
 18598           DFHEIV99
 18599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18600
 18601
 18602     GO TO 6640-EXIT.
 18603
 18604 6630-END-OF-FILE.
 18605     MOVE ER-8002              TO WS-ERROR.
 18606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18607
 18608     GO TO 6640-EXIT.
 18609
 18610 6630-ERRESS-PROBLEM.
 18611     MOVE ER-8044              TO WS-ERROR.
 18612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18613
 18614 6640-EXIT.
 18615     EXIT.
 18616
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 340
* EL050.cbl
 18618 6650-GET-RES-STATE-COMM.
 18619
 18620     IF PB-COMPANY-ID NOT = 'DMD'
 18621         GO TO 6700-COMM-EXIT.
 18622
 18623     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18624     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18625     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18626     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18627     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18628     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18629     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18630
 18631*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18632*
 18633***  Y2K PROJ 7744
 18634     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18635     SET BIN-TO-GREG          TO TRUE.
 18636     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18637
 18638     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18639***  Y2K PROJ 7744
 18640
 18641     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18642
 18643
 18644* EXEC CICS HANDLE CONDITION
 18645*        INVREQ    (6660-START-BROWSE)
 18646*        DISABLED  (6690-ERRESC-PROBLEM)
 18647*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18648*        NOTFND    (6690-END-OF-FILE)
 18649*    END-EXEC.
 18650*    MOVE '"$8cJI                ! & #00018533' TO DFHEIV0
 18651     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18653     MOVE X'2620233030303138353333' TO DFHEIV0(25:11)
 18654     CALL 'kxdfhei1' USING DFHEIV0
 18655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18656
 18657
 18658
 18659* EXEC CICS RESETBR
 18660*        DATASET (FILE-ID-ERRESC)
 18661*        RIDFLD  (WS-ERRESC-KEY)
 18662*    END-EXEC.
 18663     MOVE 0
 18664       TO DFHEIV11
 18665*    MOVE '&4         G          &   #00018540' TO DFHEIV0
 18666     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18667     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18668     MOVE X'2020233030303138353430' TO DFHEIV0(25:11)
 18669     CALL 'kxdfhei1' USING DFHEIV0,
 18670           FILE-ID-ERRESC,
 18671           WS-ERRESC-KEY,
 18672           DFHEIV99,
 18673           DFHEIV11,
 18674           DFHEIV99
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 341
* EL050.cbl
 18676
 18677
 18678 6660-START-BROWSE.
 18679
 18680
 18681* EXEC CICS HANDLE CONDITION
 18682*        NOTFND    (6690-END-OF-FILE)
 18683*        DISABLED  (6690-ERRESC-PROBLEM)
 18684*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18685*        ENDFILE   (6690-END-OF-FILE)
 18686*    END-EXEC.
 18687*    MOVE '"$IcJ''                ! '' #00018547' TO DFHEIV0
 18688     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18690     MOVE X'2720233030303138353437' TO DFHEIV0(25:11)
 18691     CALL 'kxdfhei1' USING DFHEIV0
 18692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18693
 18694
 18695
 18696* EXEC CICS STARTBR
 18697*        DATASET (FILE-ID-ERRESC)
 18698*        RIDFLD  (WS-ERRESC-KEY)
 18699*        GTEQ
 18700*    END-EXEC.
 18701     MOVE 0
 18702       TO DFHEIV11
 18703*    MOVE '&,         G          &   #00018554' TO DFHEIV0
 18704     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18705     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18706     MOVE X'2020233030303138353534' TO DFHEIV0(25:11)
 18707     CALL 'kxdfhei1' USING DFHEIV0,
 18708           FILE-ID-ERRESC,
 18709           WS-ERRESC-KEY,
 18710           DFHEIV99,
 18711           DFHEIV11,
 18712           DFHEIV99
 18713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18714
 18715
 18716     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18717
 18718 6670-READ-NEXT-ERRESC-MASTER.
 18719
 18720
 18721* EXEC CICS HANDLE CONDITION
 18722*        NOTFND    (6690-END-OF-FILE)
 18723*        DISABLED  (6690-ERRESC-PROBLEM)
 18724*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18725*        ENDFILE   (6690-END-OF-FILE)
 18726*    END-EXEC.
 18727*    MOVE '"$IcJ''                ! ( #00018564' TO DFHEIV0
 18728     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18730     MOVE X'2820233030303138353634' TO DFHEIV0(25:11)
 18731     CALL 'kxdfhei1' USING DFHEIV0
 18732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18733
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 342
* EL050.cbl
 18734
 18735
 18736* EXEC CICS READNEXT
 18737*        DATASET (FILE-ID-ERRESC)
 18738*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18739*        RIDFLD  (ERRESC-RECORD-KEY)
 18740*    END-EXEC.
 18741     MOVE LENGTH OF
 18742      ACCOUNT-RESIDENT-ST-COMMISSION
 18743       TO DFHEIV12
 18744     MOVE 0
 18745       TO DFHEIV11
 18746*    MOVE '&.IL                  )   #00018571' TO DFHEIV0
 18747     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18748     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18749     MOVE X'2020233030303138353731' TO DFHEIV0(25:11)
 18750     CALL 'kxdfhei1' USING DFHEIV0,
 18751           FILE-ID-ERRESC,
 18752           ACCOUNT-RESIDENT-ST-COMMISSION,
 18753           DFHEIV12,
 18754           ERRESC-RECORD-KEY,
 18755           DFHEIV99,
 18756           DFHEIV11,
 18757           DFHEIV99,
 18758           DFHEIV99
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18763        NEXT SENTENCE
 18764     ELSE
 18765
 18766* EXEC CICS ENDBR
 18767*            DATASET (FILE-ID-ERRESC)
 18768*       END-EXEC
 18769     MOVE 0
 18770       TO DFHEIV11
 18771*    MOVE '&2                    $   #00018580' TO DFHEIV0
 18772     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18773     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18774     MOVE X'2020233030303138353830' TO DFHEIV0(25:11)
 18775     CALL 'kxdfhei1' USING DFHEIV0,
 18776           FILE-ID-ERRESC,
 18777           DFHEIV11,
 18778           DFHEIV99
 18779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18780        GO TO 6690-END-OF-FILE.
 18781
 18782     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18783
 18784* EXEC CICS ENDBR
 18785*            DATASET (FILE-ID-ERRESC)
 18786*       END-EXEC
 18787     MOVE 0
 18788       TO DFHEIV11
 18789*    MOVE '&2                    $   #00018586' TO DFHEIV0
 18790     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 343
* EL050.cbl
 18792     MOVE X'2020233030303138353836' TO DFHEIV0(25:11)
 18793     CALL 'kxdfhei1' USING DFHEIV0,
 18794           FILE-ID-ERRESC,
 18795           DFHEIV11,
 18796           DFHEIV99
 18797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18798        GO TO 6690-END-OF-FILE.
 18799
 18800     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18801        NEXT SENTENCE
 18802      ELSE
 18803        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18804
 18805* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18806*
 18807     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18808
 18809     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18810
 18811     IF WS-SUB1 > ZERO
 18812         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18813             PERFORM 6680-SET-COMMISSION
 18814         ELSE
 18815             PERFORM 6680-SET-TABLE-CODE.
 18816
 18817
 18818* EXEC CICS ENDBR
 18819*         DATASET (FILE-ID-ERRESC)
 18820*    END-EXEC.
 18821     MOVE 0
 18822       TO DFHEIV11
 18823*    MOVE '&2                    $   #00018608' TO DFHEIV0
 18824     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18826     MOVE X'2020233030303138363038' TO DFHEIV0(25:11)
 18827     CALL 'kxdfhei1' USING DFHEIV0,
 18828           FILE-ID-ERRESC,
 18829           DFHEIV11,
 18830           DFHEIV99
 18831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18832
 18833
 18834     GO TO 6700-COMM-EXIT.
 18835
 18836 6680-SET-TABLE-CODE.
 18837     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18838        MOVE ZEROS             TO WS-SUB1
 18839     ELSE
 18840* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18841* TO COMPUTE AH COMMISSION.
 18842        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18843        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18844        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18845        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18846        PERFORM 6680-READ-CTBL-TABLE
 18847        IF WS-CTBL-READ-SW NOT = 'Y'
 18848           MOVE ZEROS          TO WS-SUB1.
 18849
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 344
* EL050.cbl
 18850 6680-READ-CTBL-TABLE.
 18851*
 18852* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18853* TO COMPUTE LIFE COMMISSION
 18854
 18855     IF CTBL-SW = '0540'
 18856        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18857        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18858        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18859
 18860     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18861
 18862     IF CTBL-TABLE-FOUND
 18863        IF CTBL-SW = '0530'
 18864             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18865                                    * PB-I-AH-TERM
 18866             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18867             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18868        ELSE
 18869             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18870             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18871             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18872     ELSE
 18873        IF FIRST-TIME-THROUGH
 18874            GO TO 6680-READ-CTBL-TABLE
 18875        ELSE
 18876            MOVE ZEROS         TO WS-SUB1.
 18877
 18878 6680-SET-COMMISSION.
 18879     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18880           MOVE ZEROS          TO WS-SUB1
 18881       ELSE
 18882           MOVE RESC-COMMISSION-PER (WS-SUB)
 18883                               TO WS-COMMISSION
 18884           IF CTBL-SW = '0530'
 18885               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18886           ELSE
 18887               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18888
 18889 6680-SEARCH-CATEGORY.
 18890     ADD +1                   TO WS-SUB.
 18891     IF WS-SUB > +12
 18892         GO TO 6680-EXIT.
 18893
 18894     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18895          MOVE WS-SUB         TO WS-SUB1
 18896          GO TO 6680-EXIT.
 18897
 18898     GO TO 6680-SEARCH-CATEGORY.
 18899
 18900 6680-EXIT.
 18901     EXIT.
 18902
 18903 6690-END-OF-FILE.
 18904     GO TO 6700-COMM-EXIT.
 18905
 18906 6690-ERRESC-PROBLEM.
 18907      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 345
* EL050.cbl
 18908      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18909
 18910      GO TO 6700-COMM-EXIT.
 18911
 18912 6700-COMM-EXIT.
 18913     EXIT.
 18914
 18915 7000-GET-RATE.
 18916
 18917* EXEC CICS LINK
 18918*        PROGRAM    ('ELRATE')
 18919*        COMMAREA   (CALCULATION-PASS-AREA)
 18920*        LENGTH     (CP-COMM-LENGTH)
 18921*    END-EXEC.
 18922     MOVE 'ELRATE' TO DFHEIV1
 18923*    MOVE '."C                   (   #00018694' TO DFHEIV0
 18924     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18926     MOVE X'2020233030303138363934' TO DFHEIV0(25:11)
 18927     CALL 'kxdfhei1' USING DFHEIV0,
 18928           DFHEIV1,
 18929           CALCULATION-PASS-AREA,
 18930           CP-COMM-LENGTH,
 18931           DFHEIV99,
 18932           DFHEIV99,
 18933           DFHEIV99,
 18934           DFHEIV99
 18935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18936
 18937
 18938 7000-EXIT.
 18939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 346
* EL050.cbl
 18941 7100-FIND-BENEFIT-IN-STATE.
 18942     MOVE 'N'                    TO BEN-SEARCH-SW.
 18943
 18944     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18945         VARYING SUB3 FROM 1 BY 1 UNTIL
 18946            ((SUB3 GREATER 50) OR
 18947              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18948               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18949
 18950     IF SUB3 NOT = 51
 18951         MOVE 'Y'                TO BEN-SEARCH-SW.
 18952
 18953     GO TO 7199-EXIT.
 18954
 18955 7100-BENEFIT-DUMMY.
 18956
 18957 7100-DUMMY-EXIT.
 18958     EXIT.
 18959
 18960 7199-EXIT.
 18961     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 347
* EL050.cbl
 18963 7200-FIND-BENEFIT.
 18964     MOVE 'N'                    TO BEN-SEARCH-SW.
 18965
 18966     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18967         VARYING SUB3 FROM 1 BY 1 UNTIL
 18968            ((SUB3 GREATER 8) OR
 18969            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18970
 18971     IF SUB3 NOT = 9
 18972         MOVE 'Y'                TO BEN-SEARCH-SW.
 18973
 18974     GO TO 7200-EXIT.
 18975
 18976 7200-BENEFIT-DUMMY.
 18977
 18978 7200-DUMMY-EXIT.
 18979     EXIT.
 18980
 18981 7200-EXIT.
 18982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 348
* EL050.cbl
 18984 7250-LOOK-FOR-RESCINDED-CLAIM.
 18985     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18986                                    W-CL-COMP-CD.
 18987     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18988                                    W-CL-CERT-NO.
 18989
 18990
 18991* EXEC CICS HANDLE CONDITION
 18992*        NOTFND  (7250-CONTINUE)
 18993*        ENDFILE (7250-CONTINUE)
 18994*    END-EXEC.
 18995*    MOVE '"$I''                  ! ) #00018752' TO DFHEIV0
 18996     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18998     MOVE X'2920233030303138373532' TO DFHEIV0(25:11)
 18999     CALL 'kxdfhei1' USING DFHEIV0
 19000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19001
 19002
 19003
 19004* EXEC CICS IGNORE CONDITION
 19005*        DUPKEY
 19006*    END-EXEC.
 19007*    MOVE '"*$                   !   #00018757' TO DFHEIV0
 19008     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19010     MOVE X'2020233030303138373537' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0
 19012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19013
 19014
 19015
 19016* EXEC CICS STARTBR
 19017*        DATASET   (CLMS-ID)
 19018*        RIDFLD    (ELMSTR-KEY)
 19019*        GENERIC   EQUAL
 19020*        KEYLENGTH (ELMSTR-LENGTH)
 19021*    END-EXEC.
 19022     MOVE 0
 19023       TO DFHEIV11
 19024*    MOVE '&,   KG    E          &   #00018761' TO DFHEIV0
 19025     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19027     MOVE X'2020233030303138373631' TO DFHEIV0(25:11)
 19028     CALL 'kxdfhei1' USING DFHEIV0,
 19029           CLMS-ID,
 19030           ELMSTR-KEY,
 19031           ELMSTR-LENGTH,
 19032           DFHEIV11,
 19033           DFHEIV99
 19034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19035
 19036
 19037     MOVE 'Y'                    TO W-BROWSE-SW.
 19038
 19039 7250-NEXT-CLAIM.
 19040
 19041
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 349
* EL050.cbl
 19042* EXEC CICS READNEXT
 19043*        DATASET   (CLMS-ID)
 19044*        RIDFLD    (ELMSTR-KEY)
 19045*        SET       (ADDRESS OF CLAIM-MASTER)
 19046*    END-EXEC.
 19047     MOVE 0
 19048       TO DFHEIV11
 19049*    MOVE '&.S                   )   #00018772' TO DFHEIV0
 19050     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19051     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19052     MOVE X'2020233030303138373732' TO DFHEIV0(25:11)
 19053     CALL 'kxdfhei1' USING DFHEIV0,
 19054           CLMS-ID,
 19055           DFHEIV20,
 19056           DFHEIV99,
 19057           ELMSTR-KEY,
 19058           DFHEIV99,
 19059           DFHEIV11,
 19060           DFHEIV99,
 19061           DFHEIV99
 19062     SET ADDRESS OF CLAIM-MASTER TO
 19063         DFHEIV20
 19064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19065
 19066
 19067     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19068        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19069         GO TO 7250-CONTINUE
 19070     END-IF.
 19071
 19072     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19073        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19074        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19075        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19076        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19077         GO TO 7250-NEXT-CLAIM
 19078     END-IF.
 19079
 19080     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19081        OR (CL-CLAIM-TYPE = 'I')
 19082        OR (CL-CLAIM-TYPE = 'G')
 19083        OR (CL-CLAIM-TYPE = 'F')
 19084          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19085              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19086              GO TO 7250-CONTINUE
 19087          END-IF
 19088     END-IF.
 19089
 19090     GO TO 7250-NEXT-CLAIM.
 19091
 19092 7250-CONTINUE.
 19093
 19094     IF W-BROWSE-SW = 'Y'
 19095
 19096* EXEC CICS ENDBR
 19097*            DATASET   (CLMS-ID)
 19098*        END-EXEC
 19099     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 350
* EL050.cbl
 19100       TO DFHEIV11
 19101*    MOVE '&2                    $   #00018806' TO DFHEIV0
 19102     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19104     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
 19105     CALL 'kxdfhei1' USING DFHEIV0,
 19106           CLMS-ID,
 19107           DFHEIV11,
 19108           DFHEIV99
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19110         MOVE 'N' TO W-BROWSE-SW
 19111     END-IF.
 19112
 19113 7250-EXIT.
 19114     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 351
* EL050.cbl
 19116 7300-CHECK-FOR-OPEN-CLMS.
 19117
 19118*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19119*    MOVE SPACES                 TO CNTL-ACCESS.
 19120*    MOVE '1'                    TO CNTL-REC-TYPE.
 19121*    MOVE +0                     TO CNTL-SEQ-NO.
 19122
 19123*    MOVE '3'                    TO RC-SW-1.
 19124*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19125
 19126*    IF NOT CF-COMPANY-MASTER
 19127*         PERFORM 0099-COMPANY-NOT-FOUND
 19128*         GO TO 7300-EXIT.
 19129
 19130     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19131                                    W-CL-COMP-CD.
 19132     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19133                                    W-CL-CERT-NO.
 19134
 19135
 19136* EXEC CICS HANDLE CONDITION
 19137*        NOTFND  (7300-CONTINUE)
 19138*        ENDFILE (7300-CONTINUE)
 19139*    END-EXEC.
 19140*    MOVE '"$I''                  ! * #00018834' TO DFHEIV0
 19141     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19143     MOVE X'2A20233030303138383334' TO DFHEIV0(25:11)
 19144     CALL 'kxdfhei1' USING DFHEIV0
 19145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19146
 19147
 19148
 19149* EXEC CICS IGNORE CONDITION
 19150*        DUPKEY
 19151*    END-EXEC.
 19152*    MOVE '"*$                   !   #00018839' TO DFHEIV0
 19153     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19154     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19155     MOVE X'2020233030303138383339' TO DFHEIV0(25:11)
 19156     CALL 'kxdfhei1' USING DFHEIV0
 19157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19158
 19159
 19160
 19161* EXEC CICS STARTBR
 19162*        DATASET   (CLMS-ID)
 19163*        RIDFLD    (ELMSTR-KEY)
 19164*        GENERIC   EQUAL
 19165*        KEYLENGTH (ELMSTR-LENGTH)
 19166*    END-EXEC.
 19167     MOVE 0
 19168       TO DFHEIV11
 19169*    MOVE '&,   KG    E          &   #00018843' TO DFHEIV0
 19170     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 352
* EL050.cbl
 19174           CLMS-ID,
 19175           ELMSTR-KEY,
 19176           ELMSTR-LENGTH,
 19177           DFHEIV11,
 19178           DFHEIV99
 19179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19180
 19181
 19182     MOVE 'Y'                    TO W-BROWSE-SW.
 19183
 19184 7300-NEXT-CLAIM.
 19185
 19186
 19187* EXEC CICS READNEXT
 19188*        DATASET   (CLMS-ID)
 19189*        RIDFLD    (ELMSTR-KEY)
 19190*        SET       (ADDRESS OF CLAIM-MASTER)
 19191*    END-EXEC.
 19192     MOVE 0
 19193       TO DFHEIV11
 19194*    MOVE '&.S                   )   #00018854' TO DFHEIV0
 19195     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19197     MOVE X'2020233030303138383534' TO DFHEIV0(25:11)
 19198     CALL 'kxdfhei1' USING DFHEIV0,
 19199           CLMS-ID,
 19200           DFHEIV20,
 19201           DFHEIV99,
 19202           ELMSTR-KEY,
 19203           DFHEIV99,
 19204           DFHEIV11,
 19205           DFHEIV99,
 19206           DFHEIV99
 19207     SET ADDRESS OF CLAIM-MASTER TO
 19208         DFHEIV20
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19213        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19214         GO TO 7300-CONTINUE.
 19215
 19216     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19217        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19218        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19219        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19220        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19221         GO TO 7300-NEXT-CLAIM.
 19222
 19223*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19224     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19225        OR (CL-CLAIM-TYPE = 'I')
 19226        OR (CL-CLAIM-TYPE = 'G')
 19227        OR (CL-CLAIM-TYPE = 'F')
 19228        IF CLAIM-IS-OPEN
 19229           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19230             AND PB-C-AH-CANCEL-DT > SPACES
 19231              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 353
* EL050.cbl
 19232              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19233           END-IF
 19234           EVALUATE TRUE
 19235             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19236                 MOVE ER-2884      TO WS-ERROR
 19237             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19238                 MOVE ER-2887      TO WS-ERROR
 19239             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19240                 MOVE ER-2886      TO WS-ERROR
 19241             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19242                 MOVE ER-2888      TO WS-ERROR
 19243             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19244                 MOVE ER-2885      TO WS-ERROR
 19245             WHEN OTHER
 19246                 MOVE ER-2768      TO WS-ERROR
 19247           END-EVALUATE
 19248           IF PB-C-AH-CANCEL-VOIDED OR
 19249              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19250                NOT AH-COVERAGE-CANCELLED)
 19251               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19252               MOVE ER-2768      TO WS-ERROR
 19253           END-IF
 19254           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19255           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19256              PB-FORCE-CODE NOT EQUAL '8'
 19257               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19258           END-IF
 19259           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19260           GO TO 7300-NEXT-CLAIM
 19261        ELSE
 19262           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19263*****THIS IS A RESCISSION OR REFORMATION
 19264              IF AH-COVERAGE-CANCELLED
 19265                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19266                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19267                    MOVE 1                   TO DC-ELAPSED-DAYS
 19268                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19269                    SET BIN-PLUS-ELAPSED     TO TRUE
 19270                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19271                    IF NO-CONVERSION-ERROR
 19272                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19273                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19274                          MOVE ER-2897 TO WS-ERROR
 19275                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19276                          GO TO 7300-NEXT-CLAIM
 19277                       END-IF
 19278                    END-IF
 19279                 ELSE
 19280                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19281                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19282                         MOVE ER-2890 TO WS-ERROR
 19283                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19284                         GO TO 7300-NEXT-CLAIM
 19285                      ELSE
 19286                         MOVE ER-2898 TO WS-ERROR
 19287                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19288                         GO TO 7300-NEXT-CLAIM
 19289                      END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 354
* EL050.cbl
 19290                   END-IF
 19291                 END-IF
 19292              END-IF
 19293           ELSE
 19294              IF CL-DENIAL-TYPE = '1'  AND
 19295                 CL-TOTAL-PAID-AMT = 0
 19296                    GO TO 7300-NEXT-CLAIM
 19297              END-IF
 19298              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19299               AND PB-C-AH-CANCEL-DT > SPACES
 19300                 MOVE ER-2756        TO WS-ERROR
 19301                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19302                 GO TO 7300-NEXT-CLAIM
 19303              END-IF
 19304           END-IF
 19305        END-IF
 19306     ELSE
 19307*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19308        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19309           IF (CLAIM-IS-OPEN)
 19310              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19311                 <> zeros
 19312              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19313                 <> zeros)
 19314              MOVE ER-2889      TO WS-ERROR
 19315              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19316              GO TO 7300-NEXT-CLAIM
 19317           ELSE
 19318              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19319*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19320                 IF (LF-COVERAGE-CANCELLED AND
 19321                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19322                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19323                         MOVE ER-2890 TO WS-ERROR
 19324                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19325                         GO TO 7300-NEXT-CLAIM
 19326                      ELSE
 19327                         MOVE ER-2898 TO WS-ERROR
 19328                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19329                         GO TO 7300-NEXT-CLAIM
 19330                      END-IF
 19331                 END-IF
 19332              ELSE
 19333                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19334                    and (CL-TOTAL-PAID-AMT = 0)
 19335                    GO TO 7300-NEXT-CLAIM
 19336                 END-IF
 19337                 IF (
 19338                      (AH-COVERAGE-CANCELLED)
 19339                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19340                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19341                      and (pb-ci-ah-cancel-amt +
 19342                         pb-c-ah-cancel-amt) <> zeros
 19343                    )
 19344                               OR
 19345                    (
 19346                      (LF-COVERAGE-CANCELLED)
 19347                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 355
* EL050.cbl
 19348                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19349                      and (pb-ci-lf-cancel-amt +
 19350                         pb-c-lf-cancel-amt) <> zeros
 19351                    )
 19352                       MOVE ER-2965 TO WS-ERROR
 19353                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19354                       GO TO 7300-NEXT-CLAIM
 19355                 END-IF
 19356                 IF LF-COVERAGE-CANCELLED
 19357                  IF CL-TOTAL-PAID-AMT > 0
 19358                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19359                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19360                        MOVE ER-2891 TO WS-ERROR
 19361                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19362                        GO TO 7300-NEXT-CLAIM
 19363                      END-IF
 19364                    ELSE
 19365****only show this error if cert num matches exactly
 19366                      IF PB-CERT-NO = CL-CERT-NO
 19367                         MOVE ER-2892 TO WS-ERROR
 19368                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19369                         GO TO 7300-NEXT-CLAIM
 19370                      END-IF
 19371                    END-IF
 19372                  END-IF
 19373                 END-IF
 19374              END-IF
 19375           END-IF
 19376        END-IF
 19377     END-IF
 19378
 19379     GO TO 7300-NEXT-CLAIM.
 19380
 19381 7300-CONTINUE.
 19382
 19383     IF W-BROWSE-SW = 'Y'
 19384
 19385* EXEC CICS ENDBR
 19386*            DATASET   (CLMS-ID)
 19387*        END-EXEC.
 19388     MOVE 0
 19389       TO DFHEIV11
 19390*    MOVE '&2                    $   #00019032' TO DFHEIV0
 19391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303139303332' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0,
 19395           CLMS-ID,
 19396           DFHEIV11,
 19397           DFHEIV99
 19398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19399
 19400
 19401 7300-EXIT.
 19402     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 356
* EL050.cbl
 19404
 19405 7400-GET-REMAIN-TERM.
 19406
 19407* EXEC CICS LINK
 19408*        PROGRAM    ('ELRTRM')
 19409*        COMMAREA   (CALCULATION-PASS-AREA)
 19410*        LENGTH     (CP-COMM-LENGTH)
 19411*    END-EXEC.
 19412     MOVE 'ELRTRM' TO DFHEIV1
 19413*    MOVE '."C                   (   #00019041' TO DFHEIV0
 19414     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19416     MOVE X'2020233030303139303431' TO DFHEIV0(25:11)
 19417     CALL 'kxdfhei1' USING DFHEIV0,
 19418           DFHEIV1,
 19419           CALCULATION-PASS-AREA,
 19420           CP-COMM-LENGTH,
 19421           DFHEIV99,
 19422           DFHEIV99,
 19423           DFHEIV99,
 19424           DFHEIV99
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428 7400-EXIT.
 19429     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 357
* EL050.cbl
 19431
 19432 7500-GET-REMAIN-AMOUNT.
 19433
 19434* EXEC CICS LINK
 19435*        PROGRAM    ('ELRAMT')
 19436*        COMMAREA   (CALCULATION-PASS-AREA)
 19437*        LENGTH     (CP-COMM-LENGTH)
 19438*    END-EXEC.
 19439     MOVE 'ELRAMT' TO DFHEIV1
 19440*    MOVE '."C                   (   #00019052' TO DFHEIV0
 19441     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19443     MOVE X'2020233030303139303532' TO DFHEIV0(25:11)
 19444     CALL 'kxdfhei1' USING DFHEIV0,
 19445           DFHEIV1,
 19446           CALCULATION-PASS-AREA,
 19447           CP-COMM-LENGTH,
 19448           DFHEIV99,
 19449           DFHEIV99,
 19450           DFHEIV99,
 19451           DFHEIV99
 19452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19453
 19454
 19455 7500-EXIT.
 19456     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 358
* EL050.cbl
 19458
 19459 7600-GET-REFUND.
 19460
 19461* EXEC CICS LINK
 19462*        PROGRAM    ('ELRFND')
 19463*        COMMAREA   (CALCULATION-PASS-AREA)
 19464*        LENGTH     (CP-COMM-LENGTH)
 19465*    END-EXEC.
 19466     MOVE 'ELRFND' TO DFHEIV1
 19467*    MOVE '."C                   (   #00019063' TO DFHEIV0
 19468     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19470     MOVE X'2020233030303139303633' TO DFHEIV0(25:11)
 19471     CALL 'kxdfhei1' USING DFHEIV0,
 19472           DFHEIV1,
 19473           CALCULATION-PASS-AREA,
 19474           CP-COMM-LENGTH,
 19475           DFHEIV99,
 19476           DFHEIV99,
 19477           DFHEIV99,
 19478           DFHEIV99
 19479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19480
 19481
 19482 7600-EXIT.
 19483     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 359
* EL050.cbl
 19485 7700-CALL-DL1.
 19486
 19487* EXEC CICS LINK
 19488*        PROGRAM    ('DLO001')
 19489*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19490*        LENGTH     (DLO001-COMM-LENGTH)
 19491*    END-EXEC.
 19492     MOVE 'DLO001' TO DFHEIV1
 19493*    MOVE '."C                   (   #00019073' TO DFHEIV0
 19494     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19496     MOVE X'2020233030303139303733' TO DFHEIV0(25:11)
 19497     CALL 'kxdfhei1' USING DFHEIV0,
 19498           DFHEIV1,
 19499           WS-DLO-MASTER-POLICY-FORM,
 19500           DLO001-COMM-LENGTH,
 19501           DFHEIV99,
 19502           DFHEIV99,
 19503           DFHEIV99,
 19504           DFHEIV99
 19505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19506
 19507
 19508 7700-EXIT.
 19509     EXIT.
 19510
 19511 7710-CALL-DL2.
 19512
 19513* EXEC CICS LINK
 19514*        PROGRAM    ('DLO002')
 19515*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19516*        LENGTH     (DLO002-COMM-LENGTH)
 19517*    END-EXEC.
 19518     MOVE 'DLO002' TO DFHEIV1
 19519*    MOVE '."C                   (   #00019083' TO DFHEIV0
 19520     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19522     MOVE X'2020233030303139303833' TO DFHEIV0(25:11)
 19523     CALL 'kxdfhei1' USING DFHEIV0,
 19524           DFHEIV1,
 19525           WS-DLO-INTERNAL-POLICY-FORM,
 19526           DLO002-COMM-LENGTH,
 19527           DFHEIV99,
 19528           DFHEIV99,
 19529           DFHEIV99,
 19530           DFHEIV99
 19531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19532
 19533
 19534 7710-EXIT.
 19535     EXIT.
 19536
 19537 7720-CALL-DL3.
 19538
 19539* EXEC CICS LINK
 19540*        PROGRAM    ('DLO003')
 19541*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19542*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 360
* EL050.cbl
 19543*    END-EXEC.
 19544     MOVE 'DLO003' TO DFHEIV1
 19545*    MOVE '."C                   (   #00019093' TO DFHEIV0
 19546     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19548     MOVE X'2020233030303139303933' TO DFHEIV0(25:11)
 19549     CALL 'kxdfhei1' USING DFHEIV0,
 19550           DFHEIV1,
 19551           WS-DLO-VALID-BANK-ID,
 19552           DLO003-COMM-LENGTH,
 19553           DFHEIV99,
 19554           DFHEIV99,
 19555           DFHEIV99,
 19556           DFHEIV99
 19557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19558
 19559
 19560 7720-EXIT.
 19561     EXIT.
 19562
 19563 7730-CALL-DL7.
 19564
 19565* EXEC CICS LINK
 19566*        PROGRAM    ('DLO007')
 19567*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19568*        LENGTH     (DLO007-COMM-LENGTH)
 19569*    END-EXEC.
 19570     MOVE 'DLO007' TO DFHEIV1
 19571*    MOVE '."C                   (   #00019103' TO DFHEIV0
 19572     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19574     MOVE X'2020233030303139313033' TO DFHEIV0(25:11)
 19575     CALL 'kxdfhei1' USING DFHEIV0,
 19576           DFHEIV1,
 19577           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19578           DLO007-COMM-LENGTH,
 19579           DFHEIV99,
 19580           DFHEIV99,
 19581           DFHEIV99,
 19582           DFHEIV99
 19583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19584
 19585
 19586 7730-EXIT.
 19587     EXIT.
 19588
 19589 7740-CALL-DL11.
 19590
 19591* EXEC CICS LINK
 19592*        PROGRAM    ('DLO011')
 19593*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19594*        LENGTH     (DLO011-COMM-LENGTH)
 19595*    END-EXEC.
 19596     MOVE 'DLO011' TO DFHEIV1
 19597*    MOVE '."C                   (   #00019113' TO DFHEIV0
 19598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19600     MOVE X'2020233030303139313133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 361
* EL050.cbl
 19601     CALL 'kxdfhei1' USING DFHEIV0,
 19602           DFHEIV1,
 19603           WS-DLO-PREM-RATES-BEN-TYPE,
 19604           DLO011-COMM-LENGTH,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99,
 19608           DFHEIV99
 19609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19610
 19611
 19612 7740-EXIT.
 19613     EXIT.
 19614
 19615 7750-CALL-DL17.
 19616
 19617* EXEC CICS LINK
 19618*        PROGRAM    ('DLO017')
 19619*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19620*        LENGTH     (DLO017-COMM-LENGTH)
 19621*    END-EXEC.
 19622     MOVE 'DLO017' TO DFHEIV1
 19623*    MOVE '."C                   (   #00019123' TO DFHEIV0
 19624     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19626     MOVE X'2020233030303139313233' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0,
 19628           DFHEIV1,
 19629           WS-DLO-VALID-RATE-CODE,
 19630           DLO017-COMM-LENGTH,
 19631           DFHEIV99,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638 7750-EXIT.
 19639     EXIT.
 19640
 19641 7755-CALL-DL19.
 19642
 19643* EXEC CICS LINK
 19644*        PROGRAM    ('DLO019')
 19645*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19646*        LENGTH     (DLO019-COMM-LENGTH)
 19647*    END-EXEC.
 19648     MOVE 'DLO019' TO DFHEIV1
 19649*    MOVE '."C                   (   #00019133' TO DFHEIV0
 19650     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19652     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 19653     CALL 'kxdfhei1' USING DFHEIV0,
 19654           DFHEIV1,
 19655           WS-DLO-ORIG-COV-CAT,
 19656           DLO019-COMM-LENGTH,
 19657           DFHEIV99,
 19658           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 362
* EL050.cbl
 19659           DFHEIV99,
 19660           DFHEIV99
 19661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19662
 19663
 19664 7755-EXIT.
 19665     EXIT.
 19666
 19667 7760-CALL-DL21.
 19668
 19669* EXEC CICS LINK
 19670*        PROGRAM    ('DLO021')
 19671*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19672*        LENGTH     (DLO021-COMM-LENGTH)
 19673*    END-EXEC.
 19674     MOVE 'DLO021' TO DFHEIV1
 19675*    MOVE '."C                   (   #00019143' TO DFHEIV0
 19676     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19678     MOVE X'2020233030303139313433' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           DFHEIV1,
 19681           WS-DLO-VALID-LOAN-OFFICER,
 19682           DLO021-COMM-LENGTH,
 19683           DFHEIV99,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690 7760-EXIT.
 19691     EXIT.
 19692
 19693 7770-CALL-DL22.
 19694
 19695* EXEC CICS LINK
 19696*        PROGRAM    ('DLO022')
 19697*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19698*        LENGTH     (DLO022-COMM-LENGTH)
 19699*    END-EXEC.
 19700     MOVE 'DLO022' TO DFHEIV1
 19701*    MOVE '."C                   (   #00019153' TO DFHEIV0
 19702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19704     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 19705     CALL 'kxdfhei1' USING DFHEIV0,
 19706           DFHEIV1,
 19707           WS-DLO-VALID-STATE-CODE,
 19708           DLO022-COMM-LENGTH,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99,
 19712           DFHEIV99
 19713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19714
 19715
 19716 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 363
* EL050.cbl
 19717     EXIT.
 19718
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 364
* EL050.cbl
 19720
 19721 7780-CALL-AGG.
 19722
 19723* EXEC CICS LINK
 19724*        PROGRAM    ('ELAGGO')
 19725*        COMMAREA   (WS-PASS-to-pemaggo)
 19726*        LENGTH     (ws-passed-key-LENGTH)
 19727*    END-EXEC.
 19728     MOVE 'ELAGGO' TO DFHEIV1
 19729*    MOVE '."C                   (   #00019165' TO DFHEIV0
 19730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19732     MOVE X'2020233030303139313635' TO DFHEIV0(25:11)
 19733     CALL 'kxdfhei1' USING DFHEIV0,
 19734           DFHEIV1,
 19735           WS-PASS-to-pemaggo,
 19736           ws-passed-key-LENGTH,
 19737           DFHEIV99,
 19738           DFHEIV99,
 19739           DFHEIV99,
 19740           DFHEIV99
 19741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19742
 19743 7780-EXIT.
 19744     EXIT.
 19745 7800-REWRITE-CERT.
 19746******************************************************************
 19747*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19748*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19749******************************************************************
 19750
 19751     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19752        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19753        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19754        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19755
 19756* EXEC CICS REWRITE
 19757*                  DATASET (CERT-ID)
 19758*                  FROM    (CERTIFICATE-MASTER)
 19759*              END-EXEC
 19760     MOVE LENGTH OF
 19761      CERTIFICATE-MASTER
 19762       TO DFHEIV11
 19763*    MOVE '&& L                  %   #00019182' TO DFHEIV0
 19764     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19765     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19766     MOVE X'2020233030303139313832' TO DFHEIV0(25:11)
 19767     CALL 'kxdfhei1' USING DFHEIV0,
 19768           CERT-ID,
 19769           CERTIFICATE-MASTER,
 19770           DFHEIV11,
 19771           DFHEIV99
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19773        GO TO 7800-EXIT.
 19774
 19775       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19776       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19777
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 365
* EL050.cbl
 19778 7800-EXIT.
 19779      EXIT.
 19780
 19781 7900-DELETE-CERT.
 19782
 19783* EXEC CICS DELETE
 19784*        DATASET (CERT-ID)
 19785*    END-EXEC.
 19786*    MOVE '&(                    &   #00019195' TO DFHEIV0
 19787     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19789     MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
 19790     CALL 'kxdfhei1' USING DFHEIV0,
 19791           CERT-ID,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99
 19796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19797
 19798
 19799 7900-EXIT.
 19800     EXIT.
 19801
 19802 8000-WRITE-CERT.
 19803
 19804* EXEC CICS HANDLE CONDITION
 19805*        DUPKEY    (8000-FREE-MAIN)
 19806*    END-EXEC.
 19807*    MOVE '"$$                   ! + #00019203' TO DFHEIV0
 19808     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19809     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19810     MOVE X'2B20233030303139323033' TO DFHEIV0(25:11)
 19811     CALL 'kxdfhei1' USING DFHEIV0
 19812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19813
 19814
 19815
 19816* EXEC CICS WRITE
 19817*        DATASET     (CERT-ID)
 19818*        FROM        (CERTIFICATE-MASTER)
 19819*        RIDFLD      (ELCERT-KEY)
 19820*    END-EXEC.
 19821     MOVE LENGTH OF
 19822      CERTIFICATE-MASTER
 19823       TO DFHEIV11
 19824*    MOVE '&$ L                  ''   #00019207' TO DFHEIV0
 19825     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19827     MOVE X'2020233030303139323037' TO DFHEIV0(25:11)
 19828     CALL 'kxdfhei1' USING DFHEIV0,
 19829           CERT-ID,
 19830           CERTIFICATE-MASTER,
 19831           DFHEIV11,
 19832           ELCERT-KEY,
 19833           DFHEIV99,
 19834           DFHEIV99
 19835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 366
* EL050.cbl
 19836
 19837
 19838 8000-FREE-MAIN.
 19839
 19840 8000-EXIT.
 19841      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 367
* EL050.cbl
 19843
 19844 8100-READ-ERPNDM.
 19845
 19846* EXEC CICS HANDLE CONDITION
 19847*         NOTFND     (8100-NOTFND)
 19848*         ENDFILE    (8100-NOTFND)
 19849*    END-EXEC.
 19850*    MOVE '"$I''                  ! , #00019220' TO DFHEIV0
 19851     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19853     MOVE X'2C20233030303139323230' TO DFHEIV0(25:11)
 19854     CALL 'kxdfhei1' USING DFHEIV0
 19855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19856
 19857
 19858     MOVE SPACES                 TO ERPNDM-FOUND.
 19859     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19860
 19861
 19862* EXEC CICS READ
 19863*         DATASET   (FILE-ERPNDM)
 19864*         RIDFLD    (PM-CONTROL-PRIMARY)
 19865*         INTO      (PENDING-MAILING-DATA)
 19866*    END-EXEC.
 19867     MOVE LENGTH OF
 19868      PENDING-MAILING-DATA
 19869       TO DFHEIV11
 19870*    MOVE '&"IL       E          (   #00019228' TO DFHEIV0
 19871     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19873     MOVE X'2020233030303139323238' TO DFHEIV0(25:11)
 19874     CALL 'kxdfhei1' USING DFHEIV0,
 19875           FILE-ERPNDM,
 19876           PENDING-MAILING-DATA,
 19877           DFHEIV11,
 19878           PM-CONTROL-PRIMARY,
 19879           DFHEIV99,
 19880           DFHEIV99,
 19881           DFHEIV99
 19882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19883
 19884
 19885     GO TO 8100-EXIT.
 19886
 19887 8100-NOTFND.
 19888
 19889     MOVE 'X'                    TO ERPNDM-FOUND.
 19890     MOVE ER-2694                TO WS-ERROR.
 19891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19892     MOVE ER-2883                TO WS-ERROR
 19893     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19894     .
 19895 8100-EXIT.
 19896     EXIT.
 19897
 19898 8110-READ-ERMAIL.
 19899
 19900* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 368
* EL050.cbl
 19901*         NOTFND     (8110-NOTFND)
 19902*         ENDFILE    (8110-NOTFND)
 19903*    END-EXEC.
 19904*    MOVE '"$I''                  ! - #00019248' TO DFHEIV0
 19905     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19907     MOVE X'2D20233030303139323438' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0
 19909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19910
 19911
 19912     MOVE SPACES                 TO ERMAIL-FOUND.
 19913     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19914     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19915     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19916     MOVE PB-SV-STATE            TO MA-STATE.
 19917
 19918
 19919* EXEC CICS READ
 19920*         UPDATE
 19921*         DATASET   (FILE-ERMAIL)
 19922*         RIDFLD    (MA-CONTROL-PRIMARY)
 19923*         INTO      (MAILING-DATA)
 19924*    END-EXEC.
 19925     MOVE LENGTH OF
 19926      MAILING-DATA
 19927       TO DFHEIV11
 19928*    MOVE '&"IL       EU         (   #00019259' TO DFHEIV0
 19929     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19930     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19931     MOVE X'2020233030303139323539' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0,
 19933           FILE-ERMAIL,
 19934           MAILING-DATA,
 19935           DFHEIV11,
 19936           MA-CONTROL-PRIMARY,
 19937           DFHEIV99,
 19938           DFHEIV99,
 19939           DFHEIV99
 19940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19941
 19942
 19943     GO TO 8110-EXIT.
 19944
 19945 8110-NOTFND.
 19946     MOVE 'X'                    TO ERMAIL-FOUND.
 19947
 19948 8110-EXIT.
 19949     EXIT.
 19950
 19951 8120-REWRITE-ERMAIL.
 19952
 19953* EXEC CICS REWRITE
 19954*         DATASET    (FILE-ERMAIL)
 19955*         FROM       (MAILING-DATA)
 19956*    END-EXEC.
 19957     MOVE LENGTH OF
 19958      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 369
* EL050.cbl
 19959       TO DFHEIV11
 19960*    MOVE '&& L                  %   #00019275' TO DFHEIV0
 19961     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19962     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19963     MOVE X'2020233030303139323735' TO DFHEIV0(25:11)
 19964     CALL 'kxdfhei1' USING DFHEIV0,
 19965           FILE-ERMAIL,
 19966           MAILING-DATA,
 19967           DFHEIV11,
 19968           DFHEIV99
 19969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19970
 19971
 19972 8120-EXIT.
 19973     EXIT.
 19974
 19975 8130-WRITE-ERMAIL.
 19976
 19977* EXEC CICS HANDLE CONDITION
 19978*         DUPKEY   (8130-EXIT)
 19979*    END-EXEC.
 19980*    MOVE '"$$                   ! . #00019284' TO DFHEIV0
 19981     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19983     MOVE X'2E20233030303139323834' TO DFHEIV0(25:11)
 19984     CALL 'kxdfhei1' USING DFHEIV0
 19985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19986
 19987
 19988
 19989* EXEC CICS WRITE
 19990*         DATASET     (FILE-ERMAIL)
 19991*         RIDFLD      (MA-CONTROL-PRIMARY)
 19992*         FROM        (MAILING-DATA)
 19993*    END-EXEC.
 19994     MOVE LENGTH OF
 19995      MAILING-DATA
 19996       TO DFHEIV11
 19997*    MOVE '&$ L                  ''   #00019288' TO DFHEIV0
 19998     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20000     MOVE X'2020233030303139323838' TO DFHEIV0(25:11)
 20001     CALL 'kxdfhei1' USING DFHEIV0,
 20002           FILE-ERMAIL,
 20003           MAILING-DATA,
 20004           DFHEIV11,
 20005           MA-CONTROL-PRIMARY,
 20006           DFHEIV99,
 20007           DFHEIV99
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011 8130-EXIT.
 20012     EXIT.
 20013
 20014 8140-UNLOCK-ERMAIL.
 20015
 20016* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 370
* EL050.cbl
 20017*         DATASET   (FILE-ERMAIL)
 20018*    END-EXEC.
 20019*    MOVE '&*                    #   #00019298' TO DFHEIV0
 20020     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20022     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 20023     CALL 'kxdfhei1' USING DFHEIV0,
 20024           FILE-ERMAIL,
 20025           DFHEIV99
 20026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20027
 20028
 20029 8140-EXIT.
 20030     EXIT.
 20031
 20032 8150-read-elcrtt.
 20033
 20034
 20035* EXEC CICS HANDLE CONDITION
 20036*        NOTFND   (8150-exit)
 20037*    END-EXEC
 20038*    MOVE '"$I                   ! / #00019307' TO DFHEIV0
 20039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20041     MOVE X'2F20233030303139333037' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20044
 20045     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20046     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20047
 20048
 20049* EXEC CICS READ
 20050*        DATASET  (CRTT-ID)
 20051*        RIDFLD   (WS-ELCRTT-KEY)
 20052*        INTO     (CERTIFICATE-TRAILERS)
 20053*    END-EXEC
 20054     MOVE LENGTH OF
 20055      CERTIFICATE-TRAILERS
 20056       TO DFHEIV11
 20057*    MOVE '&"IL       E          (   #00019314' TO DFHEIV0
 20058     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20060     MOVE X'2020233030303139333134' TO DFHEIV0(25:11)
 20061     CALL 'kxdfhei1' USING DFHEIV0,
 20062           CRTT-ID,
 20063           CERTIFICATE-TRAILERS,
 20064           DFHEIV11,
 20065           WS-ELCRTT-KEY,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20070
 20071     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20072     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20073
 20074     .
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 371
* EL050.cbl
 20075 8150-exit.
 20076     exit.
 20077 8180-UPDATE-VIN-NUMBER.
 20078
 20079* EXEC CICS HANDLE CONDITION
 20080*        NOTFND   (8180-NOTFND)
 20081*    END-EXEC.
 20082*    MOVE '"$I                   ! 0 #00019327' TO DFHEIV0
 20083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20085     MOVE X'3020233030303139333237' TO DFHEIV0(25:11)
 20086     CALL 'kxdfhei1' USING DFHEIV0
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20091     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20092
 20093
 20094* EXEC CICS READ
 20095*        UPDATE
 20096*        DATASET  (CRTT-ID)
 20097*        RIDFLD   (WS-ELCRTT-KEY)
 20098*        INTO     (CERTIFICATE-TRAILERS)
 20099*    END-EXEC.
 20100     MOVE LENGTH OF
 20101      CERTIFICATE-TRAILERS
 20102       TO DFHEIV11
 20103*    MOVE '&"IL       EU         (   #00019334' TO DFHEIV0
 20104     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20105     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20106     MOVE X'2020233030303139333334' TO DFHEIV0(25:11)
 20107     CALL 'kxdfhei1' USING DFHEIV0,
 20108           CRTT-ID,
 20109           CERTIFICATE-TRAILERS,
 20110           DFHEIV11,
 20111           WS-ELCRTT-KEY,
 20112           DFHEIV99,
 20113           DFHEIV99,
 20114           DFHEIV99
 20115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20116
 20117
 20118     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20119         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20120
 20121* EXEC CICS REWRITE
 20122*           DATASET  (CRTT-ID)
 20123*           FROM     (CERTIFICATE-TRAILERS)
 20124*        END-EXEC
 20125     MOVE LENGTH OF
 20126      CERTIFICATE-TRAILERS
 20127       TO DFHEIV11
 20128*    MOVE '&& L                  %   #00019343' TO DFHEIV0
 20129     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20130     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20131     MOVE X'2020233030303139333433' TO DFHEIV0(25:11)
 20132     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 372
* EL050.cbl
 20133           CRTT-ID,
 20134           CERTIFICATE-TRAILERS,
 20135           DFHEIV11,
 20136           DFHEIV99
 20137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20138     ELSE
 20139
 20140* EXEC CICS UNLOCK
 20141*          DATASET  (CRTT-ID)
 20142*       END-EXEC
 20143*    MOVE '&*                    #   #00019348' TO DFHEIV0
 20144     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20145     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20146     MOVE X'2020233030303139333438' TO DFHEIV0(25:11)
 20147     CALL 'kxdfhei1' USING DFHEIV0,
 20148           CRTT-ID,
 20149           DFHEIV99
 20150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20151     END-IF.
 20152
 20153     GO TO 8180-EXIT.
 20154
 20155 8180-NOTFND.
 20156
 20157     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20158     MOVE 'CS'         TO CS-RECORD-ID.
 20159     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20160     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20161     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20162     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20163
 20164* EXEC CICS WRITE
 20165*       DATASET  (CRTT-ID)
 20166*       RIDFLD   (WS-ELCRTT-KEY)
 20167*       FROM     (CERTIFICATE-TRAILERS)
 20168*    END-EXEC.
 20169     MOVE LENGTH OF
 20170      CERTIFICATE-TRAILERS
 20171       TO DFHEIV11
 20172*    MOVE '&$ L                  ''   #00019363' TO DFHEIV0
 20173     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20175     MOVE X'2020233030303139333633' TO DFHEIV0(25:11)
 20176     CALL 'kxdfhei1' USING DFHEIV0,
 20177           CRTT-ID,
 20178           CERTIFICATE-TRAILERS,
 20179           DFHEIV11,
 20180           WS-ELCRTT-KEY,
 20181           DFHEIV99,
 20182           DFHEIV99
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186 8180-EXIT.
 20187     EXIT.
 20188
 20189 8190-UPDATE-REFUND-CLAIM-FLAG.
 20190
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 373
* EL050.cbl
 20191* EXEC CICS HANDLE CONDITION
 20192*        NOTFND   (8190-NOTFND)
 20193*    END-EXEC.
 20194*    MOVE '"$I                   ! 1 #00019373' TO DFHEIV0
 20195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20197     MOVE X'3120233030303139333733' TO DFHEIV0(25:11)
 20198     CALL 'kxdfhei1' USING DFHEIV0
 20199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20200
 20201
 20202     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20203     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20204
 20205
 20206* EXEC CICS READ
 20207*        UPDATE
 20208*        DATASET  (CRTT-ID)
 20209*        RIDFLD   (WS-ELCRTT-KEY)
 20210*        INTO     (CERTIFICATE-TRAILERS)
 20211*    END-EXEC.
 20212     MOVE LENGTH OF
 20213      CERTIFICATE-TRAILERS
 20214       TO DFHEIV11
 20215*    MOVE '&"IL       EU         (   #00019380' TO DFHEIV0
 20216     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20218     MOVE X'2020233030303139333830' TO DFHEIV0(25:11)
 20219     CALL 'kxdfhei1' USING DFHEIV0,
 20220           CRTT-ID,
 20221           CERTIFICATE-TRAILERS,
 20222           DFHEIV11,
 20223           WS-ELCRTT-KEY,
 20224           DFHEIV99,
 20225           DFHEIV99,
 20226           DFHEIV99
 20227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20228
 20229
 20230     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20231
 20232* EXEC CICS REWRITE
 20233*       DATASET  (CRTT-ID)
 20234*       FROM     (CERTIFICATE-TRAILERS)
 20235*    END-EXEC.
 20236     MOVE LENGTH OF
 20237      CERTIFICATE-TRAILERS
 20238       TO DFHEIV11
 20239*    MOVE '&& L                  %   #00019388' TO DFHEIV0
 20240     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20241     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20242     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 20243     CALL 'kxdfhei1' USING DFHEIV0,
 20244           CRTT-ID,
 20245           CERTIFICATE-TRAILERS,
 20246           DFHEIV11,
 20247           DFHEIV99
 20248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 374
* EL050.cbl
 20249
 20250
 20251     GO TO 8190-EXIT.
 20252
 20253 8190-NOTFND.
 20254
 20255     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20256     MOVE 'CS'         TO CS-RECORD-ID.
 20257     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20258     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20259     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20260     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20261
 20262* EXEC CICS WRITE
 20263*       DATASET  (CRTT-ID)
 20264*       RIDFLD   (WS-ELCRTT-KEY)
 20265*       FROM     (CERTIFICATE-TRAILERS)
 20266*    END-EXEC.
 20267     MOVE LENGTH OF
 20268      CERTIFICATE-TRAILERS
 20269       TO DFHEIV11
 20270*    MOVE '&$ L                  ''   #00019403' TO DFHEIV0
 20271     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20273     MOVE X'2020233030303139343033' TO DFHEIV0(25:11)
 20274     CALL 'kxdfhei1' USING DFHEIV0,
 20275           CRTT-ID,
 20276           CERTIFICATE-TRAILERS,
 20277           DFHEIV11,
 20278           WS-ELCRTT-KEY,
 20279           DFHEIV99,
 20280           DFHEIV99
 20281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20282
 20283
 20284 8190-EXIT.
 20285     EXIT.
 20286
 20287 8195-UPDATE-AGE-FLAGS.
 20288
 20289* EXEC CICS HANDLE CONDITION
 20290*        NOTFND   (8195-NOTFND)
 20291*    END-EXEC.
 20292*    MOVE '"$I                   ! 2 #00019413' TO DFHEIV0
 20293     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20295     MOVE X'3220233030303139343133' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0
 20297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20298
 20299
 20300     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20301     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20302
 20303
 20304* EXEC CICS READ
 20305*        UPDATE
 20306*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 375
* EL050.cbl
 20307*        RIDFLD   (WS-ELCRTT-KEY)
 20308*        INTO     (CERTIFICATE-TRAILERS)
 20309*    END-EXEC.
 20310     MOVE LENGTH OF
 20311      CERTIFICATE-TRAILERS
 20312       TO DFHEIV11
 20313*    MOVE '&"IL       EU         (   #00019420' TO DFHEIV0
 20314     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20316     MOVE X'2020233030303139343230' TO DFHEIV0(25:11)
 20317     CALL 'kxdfhei1' USING DFHEIV0,
 20318           CRTT-ID,
 20319           CERTIFICATE-TRAILERS,
 20320           DFHEIV11,
 20321           WS-ELCRTT-KEY,
 20322           DFHEIV99,
 20323           DFHEIV99,
 20324           DFHEIV99
 20325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20326
 20327
 20328     IF WS-INS-AGE-SET = 'Y'
 20329        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20330     END-IF
 20331     IF WS-JNT-AGE-SET = 'Y'
 20332        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20333     END-IF
 20334
 20335
 20336* EXEC CICS REWRITE
 20337*       DATASET  (CRTT-ID)
 20338*       FROM     (CERTIFICATE-TRAILERS)
 20339*    END-EXEC.
 20340     MOVE LENGTH OF
 20341      CERTIFICATE-TRAILERS
 20342       TO DFHEIV11
 20343*    MOVE '&& L                  %   #00019434' TO DFHEIV0
 20344     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20345     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20346     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 20347     CALL 'kxdfhei1' USING DFHEIV0,
 20348           CRTT-ID,
 20349           CERTIFICATE-TRAILERS,
 20350           DFHEIV11,
 20351           DFHEIV99
 20352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20353
 20354
 20355     GO TO 8195-EXIT.
 20356
 20357 8195-NOTFND.
 20358
 20359     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20360     MOVE 'CS'         TO CS-RECORD-ID.
 20361     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20362     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20363     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20364     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 376
* EL050.cbl
 20365     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20366
 20367* EXEC CICS WRITE
 20368*       DATASET  (CRTT-ID)
 20369*       RIDFLD   (WS-ELCRTT-KEY)
 20370*       FROM     (CERTIFICATE-TRAILERS)
 20371*    END-EXEC.
 20372     MOVE LENGTH OF
 20373      CERTIFICATE-TRAILERS
 20374       TO DFHEIV11
 20375*    MOVE '&$ L                  ''   #00019450' TO DFHEIV0
 20376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20378     MOVE X'2020233030303139343530' TO DFHEIV0(25:11)
 20379     CALL 'kxdfhei1' USING DFHEIV0,
 20380           CRTT-ID,
 20381           CERTIFICATE-TRAILERS,
 20382           DFHEIV11,
 20383           WS-ELCRTT-KEY,
 20384           DFHEIV99,
 20385           DFHEIV99
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389 8195-EXIT.
 20390     EXIT.
 20391
 20392 8200-READ-REIN-TABLE.
 20393
 20394* EXEC CICS HANDLE CONDITION
 20395*         NOTFND   (8200-NOTFND)
 20396*    END-EXEC.
 20397*    MOVE '"$I                   ! 3 #00019460' TO DFHEIV0
 20398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20400     MOVE X'3320233030303139343630' TO DFHEIV0(25:11)
 20401     CALL 'kxdfhei1' USING DFHEIV0
 20402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20403
 20404
 20405
 20406* EXEC CICS READ
 20407*        DATASET     (REIN-ID)
 20408*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20409*        RIDFLD      (ERREIN-KEY)
 20410*    END-EXEC.
 20411*    MOVE '&"S        E          (   #00019464' TO DFHEIV0
 20412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20414     MOVE X'2020233030303139343634' TO DFHEIV0(25:11)
 20415     CALL 'kxdfhei1' USING DFHEIV0,
 20416           REIN-ID,
 20417           DFHEIV20,
 20418           DFHEIV99,
 20419           ERREIN-KEY,
 20420           DFHEIV99,
 20421           DFHEIV99,
 20422           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 377
* EL050.cbl
 20423     SET ADDRESS OF REINSURANCE-RECORD TO
 20424         DFHEIV20
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428     GO TO 8200-EXIT.
 20429
 20430 8200-NOTFND.
 20431     MOVE 'N'             TO WS-REIN-READ-SW.
 20432
 20433 8200-EXIT.
 20434      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 378
* EL050.cbl
 20436
 20437 8300-READ-CTBL-TABLE.
 20438
 20439* EXEC CICS HANDLE CONDITION
 20440*        NOTFND    (8300-NOTFND)
 20441*        DISABLED  (8300-ERRESS-PROBLEM)
 20442*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20443*        ENDFILE   (8300-NOTFND)
 20444*    END-EXEC.
 20445*    MOVE '"$IcJ''                ! 4 #00019480' TO DFHEIV0
 20446     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20448     MOVE X'3420233030303139343830' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0
 20450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20451
 20452
 20453
 20454* EXEC CICS READ
 20455*        DATASET     (CTBL-ID)
 20456*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20457*        RIDFLD      (ERCTBL-KEY)
 20458*    END-EXEC.
 20459*    MOVE '&"S        E          (   #00019487' TO DFHEIV0
 20460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20462     MOVE X'2020233030303139343837' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0,
 20464           CTBL-ID,
 20465           DFHEIV20,
 20466           DFHEIV99,
 20467           ERCTBL-KEY,
 20468           DFHEIV99,
 20469           DFHEIV99,
 20470           DFHEIV99
 20471     SET ADDRESS OF COMM-TABLE-RECORD TO
 20472         DFHEIV20
 20473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20474
 20475
 20476     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20477
 20478     GO TO 8300-EXIT.
 20479
 20480 8300-NOTFND.
 20481
 20482     IF CTBL-SW = '0530'
 20483         MOVE 'AA'                     TO WS-AH-COMP-CD
 20484         MOVE '0550'                   TO CTBL-SW
 20485         MOVE '1'                      TO WS-CTBL-READ-SW
 20486         GO TO 8300-EXIT.
 20487
 20488     IF CTBL-SW = '0540'
 20489         MOVE 'AA'                     TO WS-LF-COMP-CD
 20490         MOVE '0550'                   TO CTBL-SW
 20491         MOVE '1'                      TO WS-CTBL-READ-SW
 20492         GO TO 8300-EXIT.
 20493
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 379
* EL050.cbl
 20494     IF CTBL-SW = '0550'
 20495         MOVE '2'                      TO WS-CTBL-READ-SW
 20496         GO TO 8300-EXIT.
 20497
 20498     GO TO 8300-EXIT.
 20499
 20500 8300-ERRESS-PROBLEM.
 20501
 20502      MOVE ER-8050              TO WS-ERROR.
 20503      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20504
 20505     GO TO 8300-EXIT.
 20506
 20507 8300-EXIT.
 20508      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 380
* EL050.cbl
 20510
 20511
 20512 8400-GETMAIN-ERFORM.
 20513
 20514
 20515* EXEC CICS   GETMAIN
 20516*        LENGTH  (500)
 20517*        SET     (ADDRESS OF FORM-MASTER)
 20518*    END-EXEC.
 20519     MOVE 500
 20520       TO DFHEIV11
 20521*    MOVE '," L                  $   #00019531' TO DFHEIV0
 20522     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20524     MOVE X'2020233030303139353331' TO DFHEIV0(25:11)
 20525     CALL 'kxdfhei1' USING DFHEIV0,
 20526           DFHEIV20,
 20527           DFHEIV11,
 20528           DFHEIV99
 20529     SET ADDRESS OF FORM-MASTER TO
 20530         DFHEIV20
 20531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20532
 20533
 20534     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20535
 20536 8400-EXIT.
 20537      EXIT.
 20538
 20539 8450-READ-FORM-MASTER.
 20540
 20541
 20542* EXEC CICS  HANDLE CONDITION
 20543*        NOTFND   (8450-FORM-NOT-FOUND)
 20544*        ENDFILE  (8450-FORM-NOT-FOUND)
 20545*    END-EXEC.
 20546*    MOVE '"$I''                  ! 5 #00019543' TO DFHEIV0
 20547     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20549     MOVE X'3520233030303139353433' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
 20554
 20555* EXEC CICS   READ
 20556*        DATASET   (FORM-ID)
 20557*        RIDFLD    (ERFORM-KEY)
 20558*        INTO      (FORM-MASTER)
 20559*        GTEQ
 20560*    END-EXEC.
 20561     MOVE LENGTH OF
 20562      FORM-MASTER
 20563       TO DFHEIV11
 20564*    MOVE '&"IL       G          (   #00019548' TO DFHEIV0
 20565     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20567     MOVE X'2020233030303139353438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 381
* EL050.cbl
 20568     CALL 'kxdfhei1' USING DFHEIV0,
 20569           FORM-ID,
 20570           FORM-MASTER,
 20571           DFHEIV11,
 20572           ERFORM-KEY,
 20573           DFHEIV99,
 20574           DFHEIV99,
 20575           DFHEIV99
 20576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20577
 20578
 20579     MOVE  'Y'           TO  FORM-MASTER-SW.
 20580
 20581     GO TO  8450-EXIT.
 20582
 20583 8450-FORM-NOT-FOUND.
 20584
 20585     MOVE  'N'           TO  FORM-MASTER-SW.
 20586
 20587 8450-EXIT.
 20588      EXIT.
 20589
 20590 8500-DATE-CONVERT.
 20591
 20592* EXEC CICS LINK
 20593*        PROGRAM    ('ELDATCV')
 20594*        COMMAREA   (DATE-CONVERSION-DATA)
 20595*        LENGTH     (DC-COMM-LENGTH)
 20596*    END-EXEC.
 20597     MOVE 'ELDATCV' TO DFHEIV1
 20598*    MOVE '."C                   (   #00019567' TO DFHEIV0
 20599     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20601     MOVE X'2020233030303139353637' TO DFHEIV0(25:11)
 20602     CALL 'kxdfhei1' USING DFHEIV0,
 20603           DFHEIV1,
 20604           DATE-CONVERSION-DATA,
 20605           DC-COMM-LENGTH,
 20606           DFHEIV99,
 20607           DFHEIV99,
 20608           DFHEIV99,
 20609           DFHEIV99
 20610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20611
 20612
 20613 8500-EXIT.
 20614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 382
* EL050.cbl
 20616
 20617 8555-RELOAD-CONTROL-FILE.
 20618     CONTINUE.
 20619
 20620 8555-EXIT.
 20621     EXIT.
 20622
 20623 8557-GETMAIN-ERPLAN.
 20624
 20625
 20626* EXEC CICS GETMAIN
 20627*        LENGTH    (840)
 20628*        SET       (ADDRESS OF PLAN-RECORDS)
 20629*    END-EXEC.
 20630     MOVE 840
 20631       TO DFHEIV11
 20632*    MOVE '," L                  $   #00019585' TO DFHEIV0
 20633     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20635     MOVE X'2020233030303139353835' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0,
 20637           DFHEIV20,
 20638           DFHEIV11,
 20639           DFHEIV99
 20640     SET ADDRESS OF PLAN-RECORDS TO
 20641         DFHEIV20
 20642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20643
 20644
 20645     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20646
 20647 8557-EXIT.
 20648     EXIT.
 20649
 20650 8560-GETMAIN.
 20651
 20652* EXEC CICS GETMAIN
 20653*        LENGTH    (2000)
 20654*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20655*    END-EXEC.
 20656     MOVE 2000
 20657       TO DFHEIV11
 20658*    MOVE '," L                  $   #00019596' TO DFHEIV0
 20659     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           DFHEIV20,
 20664           DFHEIV11,
 20665           DFHEIV99
 20666     SET ADDRESS OF ACCOUNT-MASTER TO
 20667         DFHEIV20
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20672
 20673 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 383
* EL050.cbl
 20674     EXIT.
 20675
 20676 8570-START-ACCOUNT-MASTER.
 20677
 20678* EXEC CICS HANDLE CONDITION
 20679*        NOTFND    (0199-ACCT-NOT-FOUND)
 20680*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20681*    END-EXEC.
 20682*    MOVE '"$I''                  ! 6 #00019607' TO DFHEIV0
 20683     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20685     MOVE X'3620233030303139363037' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0
 20687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20688
 20689
 20690
 20691* EXEC CICS STARTBR
 20692*        DATASET    (ACCT-ID)
 20693*        RIDFLD     (ERACCT-KEY)
 20694*        GTEQ
 20695*    END-EXEC.
 20696     MOVE 0
 20697       TO DFHEIV11
 20698*    MOVE '&,         G          &   #00019612' TO DFHEIV0
 20699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20701     MOVE X'2020233030303139363132' TO DFHEIV0(25:11)
 20702     CALL 'kxdfhei1' USING DFHEIV0,
 20703           ACCT-ID,
 20704           ERACCT-KEY,
 20705           DFHEIV99,
 20706           DFHEIV11,
 20707           DFHEIV99
 20708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20709
 20710
 20711 8570-EXIT.
 20712     EXIT.
 20713
 20714 8580-READ-ACCOUNT-MASTER.
 20715
 20716* EXEC CICS HANDLE CONDITION
 20717*        NOTFND    (0199-ACCT-NOT-FOUND)
 20718*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20719*    END-EXEC.
 20720*    MOVE '"$I''                  ! 7 #00019622' TO DFHEIV0
 20721     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20723     MOVE X'3720233030303139363232' TO DFHEIV0(25:11)
 20724     CALL 'kxdfhei1' USING DFHEIV0
 20725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20726
 20727
 20728
 20729* EXEC CICS READNEXT
 20730*        DATASET     (ACCT-ID)
 20731*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 384
* EL050.cbl
 20732*        RIDFLD      (ERACCT-KEY)
 20733*    END-EXEC.
 20734     MOVE LENGTH OF
 20735      ACCOUNT-MASTER
 20736       TO DFHEIV12
 20737     MOVE 0
 20738       TO DFHEIV11
 20739*    MOVE '&.IL                  )   #00019627' TO DFHEIV0
 20740     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20742     MOVE X'2020233030303139363237' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           ACCT-ID,
 20745           ACCOUNT-MASTER,
 20746           DFHEIV12,
 20747           ERACCT-KEY,
 20748           DFHEIV99,
 20749           DFHEIV11,
 20750           DFHEIV99,
 20751           DFHEIV99
 20752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20753
 20754
 20755 8580-EXIT.
 20756     EXIT.
 20757
 20758 8582-READ-COMPENSATION-MASTER.
 20759
 20760* EXEC CICS HANDLE CONDITION
 20761*        NOTFND    (8582-COMP-NOT-FOUND)
 20762*        ENDFILE   (8582-COMP-NOT-FOUND)
 20763*    END-EXEC.
 20764*    MOVE '"$I''                  ! 8 #00019637' TO DFHEIV0
 20765     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20767     MOVE X'3820233030303139363337' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0
 20769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20770
 20771
 20772
 20773* EXEC CICS READ
 20774*        DATASET     (COMP-ID)
 20775*        INTO        (COMPENSATION-MASTER)
 20776*        RIDFLD      (ERCOMP-KEY)
 20777*    END-EXEC.
 20778     MOVE LENGTH OF
 20779      COMPENSATION-MASTER
 20780       TO DFHEIV11
 20781*    MOVE '&"IL       E          (   #00019642' TO DFHEIV0
 20782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20784     MOVE X'2020233030303139363432' TO DFHEIV0(25:11)
 20785     CALL 'kxdfhei1' USING DFHEIV0,
 20786           COMP-ID,
 20787           COMPENSATION-MASTER,
 20788           DFHEIV11,
 20789           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 385
* EL050.cbl
 20790           DFHEIV99,
 20791           DFHEIV99,
 20792           DFHEIV99
 20793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20794
 20795
 20796     MOVE 'Y'                    TO COMP-MASTER-SW
 20797
 20798     GO TO 8582-EXIT
 20799     .
 20800 8582-COMP-NOT-FOUND.
 20801
 20802     MOVE 'N'                    TO COMP-MASTER-SW.
 20803
 20804 8582-EXIT.
 20805     EXIT.
 20806
 20807 8583-READ-ERAGTC.
 20808
 20809* EXEC CICS HANDLE CONDITION
 20810*        NOTFND    (8583-AGTC-NOT-FOUND)
 20811*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20812*    END-EXEC.
 20813*    MOVE '"$I''                  ! 9 #00019660' TO DFHEIV0
 20814     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20816     MOVE X'3920233030303139363630' TO DFHEIV0(25:11)
 20817     CALL 'kxdfhei1' USING DFHEIV0
 20818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20819
 20820
 20821
 20822* EXEC CICS STARTBR
 20823*        DATASET    (AGTC-ID)
 20824*        RIDFLD     (ERAGTC-KEY)
 20825*        GTEQ
 20826*    END-EXEC.
 20827     MOVE 0
 20828       TO DFHEIV11
 20829*    MOVE '&,         G          &   #00019665' TO DFHEIV0
 20830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20832     MOVE X'2020233030303139363635' TO DFHEIV0(25:11)
 20833     CALL 'kxdfhei1' USING DFHEIV0,
 20834           AGTC-ID,
 20835           ERAGTC-KEY,
 20836           DFHEIV99,
 20837           DFHEIV11,
 20838           DFHEIV99
 20839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20840
 20841
 20842 8583-READ-ERAGTC-NEXT.
 20843
 20844* EXEC CICS READNEXT
 20845*        DATASET     (AGTC-ID)
 20846*        INTO        (AGENT-COMMISSIONS)
 20847*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 386
* EL050.cbl
 20848*    END-EXEC.
 20849     MOVE LENGTH OF
 20850      AGENT-COMMISSIONS
 20851       TO DFHEIV12
 20852     MOVE 0
 20853       TO DFHEIV11
 20854*    MOVE '&.IL                  )   #00019672' TO DFHEIV0
 20855     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20856     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20857     MOVE X'2020233030303139363732' TO DFHEIV0(25:11)
 20858     CALL 'kxdfhei1' USING DFHEIV0,
 20859           AGTC-ID,
 20860           AGENT-COMMISSIONS,
 20861           DFHEIV12,
 20862           ERAGTC-KEY,
 20863           DFHEIV99,
 20864           DFHEIV11,
 20865           DFHEIV99,
 20866           DFHEIV99
 20867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20868
 20869
 20870*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20871
 20872     GO TO 8583-EXIT
 20873     .
 20874 8583-AGTC-NOT-FOUND.
 20875
 20876     MOVE 'N'                    TO AGTC-MASTER-SW.
 20877
 20878 8583-EXIT.
 20879     EXIT.
 20880
 20881 8584-READ-BANK-CROSS-REF.
 20882
 20883* EXEC CICS HANDLE CONDITION
 20884*        NOTFND    (8584-BXRF-NOT-FOUND)
 20885*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20886*    END-EXEC.
 20887*    MOVE '"$I''                  ! : #00019690' TO DFHEIV0
 20888     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20890     MOVE X'3A20233030303139363930' TO DFHEIV0(25:11)
 20891     CALL 'kxdfhei1' USING DFHEIV0
 20892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20893
 20894
 20895
 20896* EXEC CICS READ
 20897*        DATASET     (BXRF-ID)
 20898*        INTO        (BANK-CROSS-REFERENCE)
 20899*        RIDFLD      (ERBXRF-KEY)
 20900*        LENGTH      (BXRF-REC-LENGTH)
 20901*    END-EXEC.
 20902*    MOVE '&"IL       E          (   #00019695' TO DFHEIV0
 20903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20905     MOVE X'2020233030303139363935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 387
* EL050.cbl
 20906     CALL 'kxdfhei1' USING DFHEIV0,
 20907           BXRF-ID,
 20908           BANK-CROSS-REFERENCE,
 20909           BXRF-REC-LENGTH,
 20910           ERBXRF-KEY,
 20911           DFHEIV99,
 20912           DFHEIV99,
 20913           DFHEIV99
 20914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20915
 20916
 20917     MOVE 'Y'                    TO BXRF-MASTER-SW
 20918
 20919     GO TO 8584-EXIT
 20920     .
 20921 8584-BXRF-NOT-FOUND.
 20922
 20923     MOVE 'N'                    TO BXRF-MASTER-SW.
 20924
 20925 8584-EXIT.
 20926     EXIT.
 20927
 20928 8585-READ-PLAN-MASTER.
 20929
 20930
 20931* EXEC CICS HANDLE CONDITION
 20932*        NOTFND    (8585-PLAN-NOT-FOUND)
 20933*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20934*    END-EXEC.
 20935*    MOVE '"$I''                  ! ; #00019715' TO DFHEIV0
 20936     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20938     MOVE X'3B20233030303139373135' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0
 20940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20941
 20942
 20943
 20944* EXEC CICS READ
 20945*        DATASET     (PLAN-ID)
 20946*        INTO        (PLAN-MASTER)
 20947*        RIDFLD      (ERPLAN-KEY)
 20948*    END-EXEC.
 20949     MOVE LENGTH OF
 20950      PLAN-MASTER
 20951       TO DFHEIV11
 20952*    MOVE '&"IL       E          (   #00019720' TO DFHEIV0
 20953     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20955     MOVE X'2020233030303139373230' TO DFHEIV0(25:11)
 20956     CALL 'kxdfhei1' USING DFHEIV0,
 20957           PLAN-ID,
 20958           PLAN-MASTER,
 20959           DFHEIV11,
 20960           ERPLAN-KEY,
 20961           DFHEIV99,
 20962           DFHEIV99,
 20963           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 388
* EL050.cbl
 20964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20965
 20966
 20967     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20968
 20969     GO TO 8585-EXIT.
 20970
 20971 8585-PLAN-NOT-FOUND.
 20972
 20973     MOVE 'N'                    TO PLAN-MASTER-SW.
 20974
 20975 8585-EXIT.
 20976     EXIT.
 20977
 20978 8586-READ-LOAN-OFFICER.
 20979
 20980* EXEC CICS READ
 20981*        DATASET     (LOFC-ID)
 20982*        INTO        (LOAN-OFFICER-MASTER)
 20983*        RIDFLD      (ERLOFC-KEY)
 20984*        RESP        (WS-RESPONSE)
 20985*    END-EXEC
 20986     MOVE LENGTH OF
 20987      LOAN-OFFICER-MASTER
 20988       TO DFHEIV11
 20989*    MOVE '&"IL       E          (  N#00019738' TO DFHEIV0
 20990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20992     MOVE X'204E233030303139373338' TO DFHEIV0(25:11)
 20993     CALL 'kxdfhei1' USING DFHEIV0,
 20994           LOFC-ID,
 20995           LOAN-OFFICER-MASTER,
 20996           DFHEIV11,
 20997           ERLOFC-KEY,
 20998           DFHEIV99,
 20999           DFHEIV99,
 21000           DFHEIV99
 21001     MOVE EIBRESP  TO WS-RESPONSE
 21002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21003
 21004     IF WS-RESP-NORMAL
 21005        MOVE 'Y'                 TO LOFC-MASTER-SW
 21006     ELSE
 21007        MOVE 'N'                 TO LOFC-MASTER-SW
 21008     END-IF
 21009     .
 21010 8586-EXIT.
 21011     EXIT.
 21012 8587-START-ERPDEF.
 21013
 21014* EXEC CICS STARTBR
 21015*       DATASET   (PDEF-ID)
 21016*       RIDFLD    (ERPDEF-KEY)
 21017*       GTEQ
 21018*       RESP      (WS-RESPONSE)
 21019*    END-EXEC
 21020     MOVE 0
 21021       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 389
* EL050.cbl
 21022*    MOVE '&,         G          &  N#00019754' TO DFHEIV0
 21023     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21024     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21025     MOVE X'204E233030303139373534' TO DFHEIV0(25:11)
 21026     CALL 'kxdfhei1' USING DFHEIV0,
 21027           PDEF-ID,
 21028           ERPDEF-KEY,
 21029           DFHEIV99,
 21030           DFHEIV11,
 21031           DFHEIV99
 21032     MOVE EIBRESP  TO WS-RESPONSE
 21033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21034     IF WS-RESP-NORMAL
 21035        MOVE 'Y'                 TO PDEF-MASTER-SW
 21036     ELSE
 21037        MOVE 'N'                 TO PDEF-MASTER-SW
 21038     END-IF
 21039     .
 21040 8587-EXIT.
 21041     EXIT.
 21042 8588-READ-ERPDEF.
 21043
 21044* EXEC CICS READNEXT
 21045*       DATASET   (PDEF-ID)
 21046*       RIDFLD    (ERPDEF-KEY)
 21047*       INTO      (PRODUCT-MASTER)
 21048*       RESP      (WS-RESPONSE)
 21049*    END-EXEC
 21050     MOVE LENGTH OF
 21051      PRODUCT-MASTER
 21052       TO DFHEIV12
 21053     MOVE 0
 21054       TO DFHEIV11
 21055*    MOVE '&.IL                  )  N#00019769' TO DFHEIV0
 21056     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21058     MOVE X'204E233030303139373639' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0,
 21060           PDEF-ID,
 21061           PRODUCT-MASTER,
 21062           DFHEIV12,
 21063           ERPDEF-KEY,
 21064           DFHEIV99,
 21065           DFHEIV11,
 21066           DFHEIV99,
 21067           DFHEIV99
 21068     MOVE EIBRESP  TO WS-RESPONSE
 21069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21070     IF WS-RESP-NORMAL
 21071        MOVE 'Y'                 TO PDEF-MASTER-SW
 21072     ELSE
 21073        MOVE 'N'                 TO PDEF-MASTER-SW
 21074     END-IF
 21075     .
 21076 8588-EXIT.
 21077     EXIT.
 21078 8589-ENDBR-ERPDEF.
 21079
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 390
* EL050.cbl
 21080* EXEC CICS ENDBR
 21081*       DATASET   (PDEF-ID)
 21082*    END-EXEC
 21083     MOVE 0
 21084       TO DFHEIV11
 21085*    MOVE '&2                    $   #00019784' TO DFHEIV0
 21086     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21088     MOVE X'2020233030303139373834' TO DFHEIV0(25:11)
 21089     CALL 'kxdfhei1' USING DFHEIV0,
 21090           PDEF-ID,
 21091           DFHEIV11,
 21092           DFHEIV99
 21093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21094     .
 21095 8589-EXIT.
 21096     EXIT.
 21097 8590-READ-CERT-MASTER.
 21098     IF PB-COMPANY-ID = 'UCL'
 21099         GO TO 8690-READ-CERT-MASTER-UCL.
 21100
 21101
 21102* EXEC CICS HANDLE CONDITION
 21103*         NOTFND    (0299-CERT-NOT-FOUND)
 21104*    END-EXEC.
 21105*    MOVE '"$I                   ! < #00019794' TO DFHEIV0
 21106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21108     MOVE X'3C20233030303139373934' TO DFHEIV0(25:11)
 21109     CALL 'kxdfhei1' USING DFHEIV0
 21110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21111
 21112
 21113
 21114* EXEC CICS READ
 21115*        DATASET     (CERT-ID)
 21116*        INTO        (CERTIFICATE-MASTER)
 21117*        RIDFLD      (ELCERT-KEY)
 21118*        UPDATE
 21119*    END-EXEC.
 21120     MOVE LENGTH OF
 21121      CERTIFICATE-MASTER
 21122       TO DFHEIV11
 21123*    MOVE '&"IL       EU         (   #00019798' TO DFHEIV0
 21124     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303139373938' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           CERT-ID,
 21129           CERTIFICATE-MASTER,
 21130           DFHEIV11,
 21131           ELCERT-KEY,
 21132           DFHEIV99,
 21133           DFHEIV99,
 21134           DFHEIV99
 21135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21136
 21137
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 391
* EL050.cbl
 21138 8590-EXIT.
 21139     EXIT.
 21140
 21141 8690-READ-CERT-MASTER-UCL.
 21142
 21143* EXEC CICS HANDLE CONDITION
 21144*         NOTFND    (8700-READ-CERT-MASTER)
 21145*    END-EXEC.
 21146*    MOVE '"$I                   ! = #00019809' TO DFHEIV0
 21147     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21149     MOVE X'3D20233030303139383039' TO DFHEIV0(25:11)
 21150     CALL 'kxdfhei1' USING DFHEIV0
 21151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21152
 21153
 21154 8690-READ-CERT-CONT.
 21155
 21156* EXEC CICS READ
 21157*        DATASET     (CERT-ID)
 21158*        INTO        (CERTIFICATE-MASTER)
 21159*        RIDFLD      (ELCERT-KEY)
 21160*        UPDATE
 21161*    END-EXEC.
 21162     MOVE LENGTH OF
 21163      CERTIFICATE-MASTER
 21164       TO DFHEIV11
 21165*    MOVE '&"IL       EU         (   #00019814' TO DFHEIV0
 21166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21168     MOVE X'2020233030303139383134' TO DFHEIV0(25:11)
 21169     CALL 'kxdfhei1' USING DFHEIV0,
 21170           CERT-ID,
 21171           CERTIFICATE-MASTER,
 21172           DFHEIV11,
 21173           ELCERT-KEY,
 21174           DFHEIV99,
 21175           DFHEIV99,
 21176           DFHEIV99
 21177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21178
 21179
 21180     GO TO 8590-EXIT.
 21181
 21182 8700-READ-CERT-MASTER.
 21183     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21184     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21185
 21186* EXEC CICS HANDLE CONDITION
 21187*         DUPKEY    (8720-COMP-ACCOUNTS)
 21188*         ENDFILE   (8730-END-BROWSE)
 21189*         NOTFND    (8740-NOT-FOUND)
 21190*    END-EXEC.
 21191*    MOVE '"$$''I                 ! > #00019826' TO DFHEIV0
 21192     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21194     MOVE X'3E20233030303139383236' TO DFHEIV0(25:11)
 21195     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 392
* EL050.cbl
 21196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21197
 21198
 21199
 21200* EXEC CICS STARTBR
 21201*        DATASET     ('ELCERT5')
 21202*        RIDFLD      (ELCERT2-KEY)
 21203*        EQUAL
 21204*    END-EXEC.
 21205     MOVE 'ELCERT5' TO DFHEIV1
 21206     MOVE 0
 21207       TO DFHEIV11
 21208*    MOVE '&,         E          &   #00019832' TO DFHEIV0
 21209     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21211     MOVE X'2020233030303139383332' TO DFHEIV0(25:11)
 21212     CALL 'kxdfhei1' USING DFHEIV0,
 21213           DFHEIV1,
 21214           ELCERT2-KEY,
 21215           DFHEIV99,
 21216           DFHEIV11,
 21217           DFHEIV99
 21218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21219
 21220
 21221 8710-READ-NEXT.
 21222
 21223* EXEC CICS READNEXT
 21224*        DATASET     ('ELCERT5')
 21225*        INTO        (CERTIFICATE-MASTER)
 21226*        RIDFLD      (ELCERT2-KEY)
 21227*    END-EXEC.
 21228     MOVE LENGTH OF
 21229      CERTIFICATE-MASTER
 21230       TO DFHEIV12
 21231     MOVE 'ELCERT5' TO DFHEIV1
 21232     MOVE 0
 21233       TO DFHEIV11
 21234*    MOVE '&.IL                  )   #00019839' TO DFHEIV0
 21235     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21237     MOVE X'2020233030303139383339' TO DFHEIV0(25:11)
 21238     CALL 'kxdfhei1' USING DFHEIV0,
 21239           DFHEIV1,
 21240           CERTIFICATE-MASTER,
 21241           DFHEIV12,
 21242           ELCERT2-KEY,
 21243           DFHEIV99,
 21244           DFHEIV11,
 21245           DFHEIV99,
 21246           DFHEIV99
 21247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21248
 21249
 21250 8720-COMP-ACCOUNTS.
 21251
 21252* EXEC CICS ENTER
 21253*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 393
* EL050.cbl
 21254*         FROM (PB-C-LAST-NAME)
 21255*    END-EXEC.
 21256     MOVE 001
 21257       TO DFHEIV11
 21258*    MOVE ':$F                   %   #00019846' TO DFHEIV0
 21259     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21260     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21261     MOVE X'2020233030303139383436' TO DFHEIV0(25:11)
 21262     CALL 'kxdfhei1' USING DFHEIV0,
 21263           DFHEIV11,
 21264           PB-C-LAST-NAME,
 21265           DFHEIV99,
 21266           DFHEIV99
 21267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21268
 21269
 21270
 21271* EXEC CICS ENTER
 21272*         TRACEID (002)
 21273*         FROM (CM-INSURED-LAST-NAME)
 21274*    END-EXEC.
 21275     MOVE 002
 21276       TO DFHEIV11
 21277*    MOVE ':$F                   %   #00019851' TO DFHEIV0
 21278     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21280     MOVE X'2020233030303139383531' TO DFHEIV0(25:11)
 21281     CALL 'kxdfhei1' USING DFHEIV0,
 21282           DFHEIV11,
 21283           CM-INSURED-LAST-NAME,
 21284           DFHEIV99,
 21285           DFHEIV99
 21286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21287
 21288
 21289     IF PB-CERT-NO NOT = CM-CERT-NO
 21290         GO TO 8730-END-BROWSE.
 21291
 21292     IF PB-ACCOUNT = CM-ACCOUNT
 21293         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21294             MOVE ER-2799        TO WS-ERROR
 21295             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21296             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21297             GO TO 8730-END-BROWSE.
 21298
 21299     GO TO 8710-READ-NEXT.
 21300
 21301 8730-END-BROWSE.
 21302
 21303* EXEC CICS ENDBR
 21304*         DATASET    ('ELCERT5')
 21305*    END-EXEC.
 21306     MOVE 'ELCERT5' TO DFHEIV1
 21307     MOVE 0
 21308       TO DFHEIV11
 21309*    MOVE '&2                    $   #00019869' TO DFHEIV0
 21310     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 394
* EL050.cbl
 21312     MOVE X'2020233030303139383639' TO DFHEIV0(25:11)
 21313     CALL 'kxdfhei1' USING DFHEIV0,
 21314           DFHEIV1,
 21315           DFHEIV11,
 21316           DFHEIV99
 21317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21318
 21319
 21320 8740-NOT-FOUND.
 21321     GO TO 0299-CERT-NOT-FOUND.
 21322
 21323 8750-START-ELSTAT.
 21324
 21325* EXEC CICS STARTBR
 21326*       DATASET   (STAT-ID)
 21327*       RIDFLD    (ELSTAT-KEY)
 21328*       GTEQ
 21329*       RESP      (WS-RESPONSE)
 21330*    END-EXEC
 21331     MOVE 0
 21332       TO DFHEIV11
 21333*    MOVE '&,         G          &  N#00019877' TO DFHEIV0
 21334     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21335     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21336     MOVE X'204E233030303139383737' TO DFHEIV0(25:11)
 21337     CALL 'kxdfhei1' USING DFHEIV0,
 21338           STAT-ID,
 21339           ELSTAT-KEY,
 21340           DFHEIV99,
 21341           DFHEIV11,
 21342           DFHEIV99
 21343     MOVE EIBRESP  TO WS-RESPONSE
 21344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21345     IF WS-RESP-NORMAL
 21346        MOVE 'Y'                 TO STAT-MASTER-SW
 21347     ELSE
 21348        MOVE 'N'                 TO STAT-MASTER-SW
 21349     END-IF
 21350     .
 21351 8750-EXIT.
 21352     EXIT.
 21353 8752-READ-ELSTAT.
 21354
 21355* EXEC CICS READNEXT
 21356*       DATASET   (STAT-ID)
 21357*       RIDFLD    (ELSTAT-KEY)
 21358*       INTO      (STATE-FILE)
 21359*       RESP      (WS-RESPONSE)
 21360*    END-EXEC
 21361     MOVE LENGTH OF
 21362      STATE-FILE
 21363       TO DFHEIV12
 21364     MOVE 0
 21365       TO DFHEIV11
 21366*    MOVE '&.IL                  )  N#00019892' TO DFHEIV0
 21367     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21368     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21369     MOVE X'204E233030303139383932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 395
* EL050.cbl
 21370     CALL 'kxdfhei1' USING DFHEIV0,
 21371           STAT-ID,
 21372           STATE-FILE,
 21373           DFHEIV12,
 21374           ELSTAT-KEY,
 21375           DFHEIV99,
 21376           DFHEIV11,
 21377           DFHEIV99,
 21378           DFHEIV99
 21379     MOVE EIBRESP  TO WS-RESPONSE
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21381     IF WS-RESP-NORMAL
 21382        MOVE 'Y'                 TO STAT-MASTER-SW
 21383     ELSE
 21384        MOVE 'N'                 TO STAT-MASTER-SW
 21385     END-IF
 21386     .
 21387 8752-EXIT.
 21388     EXIT.
 21389 8800-GET-COMP-RATE.
 21390     MOVE +1 TO IB.
 21391     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21392         ADD +9 TO IB
 21393         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21394             ADD +9 TO IB
 21395             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21396                MOVE ZEROS       TO WS-WK-RATE
 21397                GO TO 8800-EXIT.
 21398
 21399     IF PB-I-AGE GREATER CT-AGE (1)
 21400         ADD +3 TO IB
 21401         IF PB-I-AGE GREATER CT-AGE (2)
 21402             ADD +3 TO IB
 21403             IF PB-I-AGE GREATER CT-AGE (3)
 21404                MOVE ZEROS       TO WS-WK-RATE
 21405                GO TO 8800-EXIT.
 21406
 21407     IF WS-WORK-TERM GREATER CT-TRM (1)
 21408         ADD +1 TO IB
 21409         IF WS-WORK-TERM GREATER CT-TRM (2)
 21410             ADD +1 TO IB
 21411             IF WS-WORK-TERM GREATER CT-TRM (3)
 21412                MOVE ZEROS       TO WS-WK-RATE
 21413                GO TO 8800-EXIT.
 21414
 21415     IF CT-RT (IB) NOT NUMERIC
 21416         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21417         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21418         GO TO 8800-GET-COMP-RATE.
 21419
 21420     MOVE CT-RT (IB) TO WS-WK-RATE.
 21421
 21422 8800-EXIT.
 21423     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 396
* EL050.cbl
 21425 8900-ADDRESS-FILE.
 21426     IF ERACCT-FILE-ADDRESSED
 21427         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21428         GO TO 8900-ADDRESS-EXIT.
 21429
 21430     IF ELCNTL-FILE-ADDRESSED
 21431         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21432         GO TO 8900-ADDRESS-EXIT.
 21433
 21434     IF ERPLAN-FILE-ADDRESSED
 21435         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21436         GO TO 8900-ADDRESS-EXIT.
 21437
 21438     IF ERFORM-FILE-ADDRESSED
 21439         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21440         GO TO 8900-ADDRESS-EXIT.
 21441
 21442 8900-ADDRESS-EXIT.
 21443     EXIT.
 21444
 21445 9000-READ-CONTROL.
 21446
 21447* EXEC CICS HANDLE CONDITION
 21448*        NOTFND    (9000-NOTFND)
 21449*    END-EXEC.
 21450*    MOVE '"$I                   ! ? #00019963' TO DFHEIV0
 21451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21453     MOVE X'3F20233030303139393633' TO DFHEIV0(25:11)
 21454     CALL 'kxdfhei1' USING DFHEIV0
 21455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21456
 21457
 21458
 21459* EXEC CICS READ
 21460*        DATASET     (CNTL-ID)
 21461*        SET         (ADDRESS OF CONTROL-FILE)
 21462*        RIDFLD      (ELCNTL-KEY)
 21463*        GTEQ
 21464*    END-EXEC.
 21465*    MOVE '&"S        G          (   #00019967' TO DFHEIV0
 21466     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21468     MOVE X'2020233030303139393637' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0,
 21470           CNTL-ID,
 21471           DFHEIV20,
 21472           DFHEIV99,
 21473           ELCNTL-KEY,
 21474           DFHEIV99,
 21475           DFHEIV99,
 21476           DFHEIV99
 21477     SET ADDRESS OF CONTROL-FILE TO
 21478         DFHEIV20
 21479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21480
 21481
 21482     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 397
* EL050.cbl
 21483
 21484 9000-NOTFND.
 21485     IF RC-SW-1 = '1'
 21486        MOVE ER-2616              TO WS-ERROR
 21487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21488        GO TO 9000-EXIT.
 21489
 21490     IF RC-SW-1 = '2'
 21491        MOVE ER-2602              TO WS-ERROR
 21492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21493
 21494 9000-EXIT.
 21495      EXIT.
 21496
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 398
* EL050.cbl
 21498 9100-READ-CONTROL.
 21499
 21500* EXEC CICS HANDLE CONDITION
 21501*        NOTFND  (9100-NOTFND)
 21502*        ENDFILE (9100-NOTFND)
 21503*    END-EXEC.
 21504*    MOVE '"$I''                  ! @ #00019991' TO DFHEIV0
 21505     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21507     MOVE X'4020233030303139393931' TO DFHEIV0(25:11)
 21508     CALL 'kxdfhei1' USING DFHEIV0
 21509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21510
 21511
 21512
 21513* EXEC CICS READ
 21514*        DATASET     (CNTL-ID)
 21515*        INTO        (CONTROL-FILE)
 21516*        RIDFLD      (ELCNTL-KEY)
 21517*        GTEQ
 21518*    END-EXEC.
 21519     MOVE LENGTH OF
 21520      CONTROL-FILE
 21521       TO DFHEIV11
 21522*    MOVE '&"IL       G          (   #00019996' TO DFHEIV0
 21523     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21524     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21525     MOVE X'2020233030303139393936' TO DFHEIV0(25:11)
 21526     CALL 'kxdfhei1' USING DFHEIV0,
 21527           CNTL-ID,
 21528           CONTROL-FILE,
 21529           DFHEIV11,
 21530           ELCNTL-KEY,
 21531           DFHEIV99,
 21532           DFHEIV99,
 21533           DFHEIV99
 21534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21535
 21536
 21537     GO TO 9100-EXIT.
 21538
 21539 9100-NOTFND.
 21540     IF RC-SW-2 = '0'
 21541        MOVE '1'                  TO STATE-RECORD-ERROR
 21542        GO TO 9100-EXIT
 21543     END-IF
 21544     IF RC-SW-2 = '1'
 21545        MOVE '1'                  TO LF-BENEFIT-ERROR
 21546        MOVE ER-2604              TO WS-ERROR
 21547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21548        GO TO 9100-EXIT.
 21549
 21550     IF RC-SW-2 = '2'
 21551        MOVE '1'                  TO AH-BENEFIT-ERROR
 21552        MOVE ER-2605              TO WS-ERROR
 21553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21554        GO TO 9100-EXIT.
 21555
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 399
* EL050.cbl
 21556     IF RC-SW-2 = '3'
 21557         MOVE ER-2603           TO WS-ERROR
 21558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21559         GO TO 9100-EXIT.
 21560
 21561     IF RC-SW-2 = '4'
 21562         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21563         GO TO 9100-EXIT.
 21564
 21565     IF RC-SW-2 = '5'
 21566         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21567         IF WS-AH-INPUT-CD-1 = SPACE
 21568             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21569         ELSE
 21570             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21571
 21572 9100-EXIT.
 21573      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 400
* EL050.cbl
 21575 9200-CONTROL-GETMAIN.
 21576
 21577* EXEC CICS GETMAIN
 21578*         LENGTH   (750)
 21579*         SET      (ADDRESS OF CONTROL-FILE)
 21580*    END-EXEC.
 21581     MOVE 750
 21582       TO DFHEIV11
 21583*    MOVE '," L                  $   #00020042' TO DFHEIV0
 21584     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21585     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21586     MOVE X'2020233030303230303432' TO DFHEIV0(25:11)
 21587     CALL 'kxdfhei1' USING DFHEIV0,
 21588           DFHEIV20,
 21589           DFHEIV11,
 21590           DFHEIV99
 21591     SET ADDRESS OF CONTROL-FILE TO
 21592         DFHEIV20
 21593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21594
 21595
 21596     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21597
 21598 9200-EXIT.
 21599     EXIT.
 21600
 21601 9250-UNLOCK-RETURN.
 21602
 21603* EXEC CICS UNLOCK
 21604*        DATASET   (CERT-ID)
 21605*    END-EXEC.
 21606*    MOVE '&*                    #   #00020053' TO DFHEIV0
 21607     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21609     MOVE X'2020233030303230303533' TO DFHEIV0(25:11)
 21610     CALL 'kxdfhei1' USING DFHEIV0,
 21611           CERT-ID,
 21612           DFHEIV99
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21614
 21615
 21616 9300-ABEND.
 21617     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21618
 21619
 21620* EXEC CICS LINK
 21621*        PROGRAM   ('EL004')
 21622*        COMMAREA  (WS-ERROR-LINE)
 21623*        LENGTH    (72)
 21624*    END-EXEC.
 21625     MOVE 'EL004' TO DFHEIV1
 21626     MOVE 72
 21627       TO DFHEIV11
 21628*    MOVE '."C                   (   #00020060' TO DFHEIV0
 21629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21631     MOVE X'2020233030303230303630' TO DFHEIV0(25:11)
 21632     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 401
* EL050.cbl
 21633           DFHEIV1,
 21634           WS-ERROR-LINE,
 21635           DFHEIV11,
 21636           DFHEIV99,
 21637           DFHEIV99,
 21638           DFHEIV99,
 21639           DFHEIV99
 21640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21641
 21642
 21643     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21644
 21645
 21646* EXEC CICS ABEND
 21647*        ABCODE ('EL50')
 21648*    END-EXEC.
 21649     MOVE 'EL50' TO DFHEIV5
 21650*    MOVE '.,A                   "   #00020068' TO DFHEIV0
 21651     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21652     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21653     MOVE X'2020233030303230303638' TO DFHEIV0(25:11)
 21654     CALL 'kxdfhei1' USING DFHEIV0,
 21655           DFHEIV5
 21656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21657
 21658
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 402
* EL050.cbl
 21660
 21661******************************************************************
 21662*                                                                *
 21663*            E R R O R   F O R M A T   R O U T I N E             *
 21664*                                                                *
 21665******************************************************************
 21666
 21667 9900-ERROR-FORMAT.
 21668
 21669     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21670                    PB-COMMON-ERROR (2) OR
 21671                    PB-COMMON-ERROR (3) OR
 21672                    PB-COMMON-ERROR (4) OR
 21673                    PB-COMMON-ERROR (5) OR
 21674                    PB-COMMON-ERROR (6) OR
 21675                    PB-COMMON-ERROR (7) OR
 21676                    PB-COMMON-ERROR (8) OR
 21677                    PB-COMMON-ERROR (9) OR
 21678                    PB-COMMON-ERROR (10)
 21679        GO TO 9900-EXIT.
 21680
 21681     IF PB-NO-OF-ERRORS = +10
 21682        GO TO 9900-EXIT.
 21683
 21684     ADD +1  TO PB-NO-OF-ERRORS.
 21685     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21686                                       (PB-NO-OF-ERRORS).
 21687 9900-EXIT.
 21688     EXIT.
 21689
 21690 9990-RETURN.
 21691     IF BROWSE-STARTED
 21692
 21693* EXEC CICS ENDBR
 21694*            DATASET  (ACCT-ID)
 21695*       END-EXEC.
 21696     MOVE 0
 21697       TO DFHEIV11
 21698*    MOVE '&2                    $   #00020105' TO DFHEIV0
 21699     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21701     MOVE X'2020233030303230313035' TO DFHEIV0(25:11)
 21702     CALL 'kxdfhei1' USING DFHEIV0,
 21703           ACCT-ID,
 21704           DFHEIV11,
 21705           DFHEIV99
 21706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21707
 21708
 21709 9990-EXIT.
 21710     EXIT.
 21711
 21712
 21713****Check for CRTO record, add one if not found.
 21714 9991-CHECK-FOR-ELCRTO.
 21715
 21716* EXEC CICS HANDLE CONDITION
 21717*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 403
* EL050.cbl
 21718*         ENDFILE (9991-CRTO-NOT-FOUND)
 21719*     END-EXEC.
 21720*    MOVE '"$I''                  ! A #00020115' TO DFHEIV0
 21721     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21723     MOVE X'4120233030303230313135' TO DFHEIV0(25:11)
 21724     CALL 'kxdfhei1' USING DFHEIV0
 21725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21726
 21727     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21728     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21729     MOVE +0                     TO ELCRTO-SEQ-NO
 21730
 21731
 21732* EXEC CICS READ
 21733*       DATASET   ('ELCRTO')
 21734*       INTO      (ORIGINAL-CERTIFICATE)
 21735*       RIDFLD    (ELCRTO-KEY)
 21736*       GTEQ
 21737*       RESP      (WS-RESPONSE)
 21738*    END-EXEC
 21739     MOVE LENGTH OF
 21740      ORIGINAL-CERTIFICATE
 21741       TO DFHEIV11
 21742     MOVE 'ELCRTO' TO DFHEIV1
 21743*    MOVE '&"IL       G          (  N#00020123' TO DFHEIV0
 21744     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21746     MOVE X'204E233030303230313233' TO DFHEIV0(25:11)
 21747     CALL 'kxdfhei1' USING DFHEIV0,
 21748           DFHEIV1,
 21749           ORIGINAL-CERTIFICATE,
 21750           DFHEIV11,
 21751           ELCRTO-KEY,
 21752           DFHEIV99,
 21753           DFHEIV99,
 21754           DFHEIV99
 21755     MOVE EIBRESP  TO WS-RESPONSE
 21756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21757
 21758     IF WS-RESP-NORMAL
 21759        AND (OC-CONTROL-PRIMARY (1:33) =
 21760                 PB-CONTROL-BY-ACCOUNT (1:33))
 21761        AND (OC-RECORD-TYPE =  'I')
 21762           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21763               GO TO 9991-CHECK-INDICATORS
 21764           ELSE
 21765               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21766               GO TO 9991-CRTO-ADD-REC
 21767           END-IF
 21768     END-IF.
 21769
 21770 9991-CRTO-NOT-FOUND.
 21771
 21772     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21773     MOVE 'OC'                TO OC-RECORD-ID
 21774     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21775                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 404
* EL050.cbl
 21776     MOVE +4096               TO OC-KEY-SEQ-NO.
 21777
 21778 9991-CRTO-ADD-REC.
 21779
 21780     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21781     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21782     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21783     MOVE 'I'                 TO OC-RECORD-TYPE
 21784     IF PB-ISSUE
 21785         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21786         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21787         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21788         MOVE PB-I-AGE               TO OC-INS-AGE
 21789         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21790         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21791         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21792         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21793         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21794         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21795         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21796         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21797         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21798         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21799         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21800         IF PB-I-JOINT-COMMISSION > +0
 21801             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21802         ELSE
 21803             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21804         END-IF
 21805         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21806         MOVE +0                     TO OC-LF-CANCEL-AMT
 21807                                        OC-LF-ITD-CANCEL-AMT
 21808         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21809         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21810         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21811         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21812         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21813         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21814         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21815         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21816         MOVE +0                     TO OC-AH-CANCEL-AMT
 21817                                        OC-AH-ITD-CANCEL-AMT
 21818         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21819         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21820         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21821     ELSE
 21822         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21823         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21824         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21825         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21826         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21827         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21828         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21829         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21830         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21831          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21832             MOVE SPACES             TO OC-LF-BENCD
 21833             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 405
* EL050.cbl
 21834                                        OC-LF-BEN-AMT
 21835                                        OC-LF-PRM-AMT
 21836                                        OC-LF-ALT-BEN-AMT
 21837                                        OC-LF-ALT-PRM-AMT
 21838                                        OC-LF-COMM-PCT
 21839                                        OC-LF-CANCEL-AMT
 21840             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21841             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21842         ELSE
 21843             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21844             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21845             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21846             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21847             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21848             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21849             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21850             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21851             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21852             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21853         END-IF
 21854         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21855         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21856          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21857             MOVE SPACES             TO OC-AH-BENCD
 21858             MOVE ZEROS              TO OC-AH-TERM
 21859                                        OC-AH-BEN-AMT
 21860                                        OC-AH-PRM-AMT
 21861                                        OC-AH-COMM-PCT
 21862                                        OC-AH-CANCEL-AMT
 21863                                        OC-AH-CP
 21864             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21865             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21866         ELSE
 21867             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21868             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21869             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21870             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21871             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21872             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21873             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21874             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21875             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21876         END-IF
 21877         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21878         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21879         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21880         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21881     END-IF
 21882     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21883
 21884     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21885
 21886
 21887* EXEC CICS READ
 21888*         DATASET   (FILE-ERMAIL)
 21889*         RIDFLD    (MA-CONTROL-PRIMARY)
 21890*         INTO      (MAILING-DATA)
 21891*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 406
* EL050.cbl
 21892*    END-EXEC
 21893     MOVE LENGTH OF
 21894      MAILING-DATA
 21895       TO DFHEIV11
 21896*    MOVE '&"IL       E          (  N#00020259' TO DFHEIV0
 21897     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21899     MOVE X'204E233030303230323539' TO DFHEIV0(25:11)
 21900     CALL 'kxdfhei1' USING DFHEIV0,
 21901           FILE-ERMAIL,
 21902           MAILING-DATA,
 21903           DFHEIV11,
 21904           MA-CONTROL-PRIMARY,
 21905           DFHEIV99,
 21906           DFHEIV99,
 21907           DFHEIV99
 21908     MOVE EIBRESP  TO WS-RESPONSE
 21909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21910
 21911     IF WS-RESP-NORMAL
 21912         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21913     END-IF.
 21914
 21915     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21916     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21917
 21918
 21919* EXEC CICS READ
 21920*         DATASET  (CRTT-ID)
 21921*         RIDFLD   (WS-ELCRTT-KEY)
 21922*         INTO     (CERTIFICATE-TRAILERS)
 21923*         RESP     (WS-RESPONSE)
 21924*    END-EXEC
 21925     MOVE LENGTH OF
 21926      CERTIFICATE-TRAILERS
 21927       TO DFHEIV11
 21928*    MOVE '&"IL       E          (  N#00020273' TO DFHEIV0
 21929     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21931     MOVE X'204E233030303230323733' TO DFHEIV0(25:11)
 21932     CALL 'kxdfhei1' USING DFHEIV0,
 21933           CRTT-ID,
 21934           CERTIFICATE-TRAILERS,
 21935           DFHEIV11,
 21936           WS-ELCRTT-KEY,
 21937           DFHEIV99,
 21938           DFHEIV99,
 21939           DFHEIV99
 21940     MOVE EIBRESP  TO WS-RESPONSE
 21941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21942
 21943     IF WS-RESP-NORMAL
 21944         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21945         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21946     END-IF.
 21947
 21948
 21949* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 407
* EL050.cbl
 21950*       DATASET   ('ELCRTO')
 21951*       FROM      (ORIGINAL-CERTIFICATE)
 21952*       RIDFLD    (OC-CONTROL-PRIMARY)
 21953*       RESP      (WS-RESPONSE)
 21954*    END-EXEC.
 21955     MOVE LENGTH OF
 21956      ORIGINAL-CERTIFICATE
 21957       TO DFHEIV11
 21958     MOVE 'ELCRTO' TO DFHEIV1
 21959*    MOVE '&$ L                  ''  N#00020285' TO DFHEIV0
 21960     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21962     MOVE X'204E233030303230323835' TO DFHEIV0(25:11)
 21963     CALL 'kxdfhei1' USING DFHEIV0,
 21964           DFHEIV1,
 21965           ORIGINAL-CERTIFICATE,
 21966           DFHEIV11,
 21967           OC-CONTROL-PRIMARY,
 21968           DFHEIV99,
 21969           DFHEIV99
 21970     MOVE EIBRESP  TO WS-RESPONSE
 21971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21972
 21973
 21974     GO TO 9991-EXIT.
 21975
 21976 9991-CHECK-INDICATORS.
 21977
 21978     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21979         GO TO 9991-EXIT
 21980     END-IF.
 21981
 21982     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21983         GO TO 9991-EXIT
 21984     END-IF.
 21985
 21986
 21987* EXEC CICS READ
 21988*       DATASET   ('ELCRTO')
 21989*       INTO      (ORIGINAL-CERTIFICATE)
 21990*       RIDFLD    (OC-CONTROL-PRIMARY)
 21991*       UPDATE
 21992*       RESP      (WS-RESPONSE)
 21993*    END-EXEC
 21994     MOVE LENGTH OF
 21995      ORIGINAL-CERTIFICATE
 21996       TO DFHEIV11
 21997     MOVE 'ELCRTO' TO DFHEIV1
 21998*    MOVE '&"IL       EU         (  N#00020304' TO DFHEIV0
 21999     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22000     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22001     MOVE X'204E233030303230333034' TO DFHEIV0(25:11)
 22002     CALL 'kxdfhei1' USING DFHEIV0,
 22003           DFHEIV1,
 22004           ORIGINAL-CERTIFICATE,
 22005           DFHEIV11,
 22006           OC-CONTROL-PRIMARY,
 22007           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 408
* EL050.cbl
 22008           DFHEIV99,
 22009           DFHEIV99
 22010     MOVE EIBRESP  TO WS-RESPONSE
 22011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22012     IF WS-RESP-NORMAL
 22013        IF PB-ISSUE
 22014          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22015          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22016          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22017          MOVE PB-I-AGE               TO OC-INS-AGE
 22018          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22019          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22020          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22021          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22022          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22023          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22024          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22025          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22026          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22027          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22028          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22029          IF PB-I-JOINT-COMMISSION > +0
 22030              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22031          ELSE
 22032              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22033          END-IF
 22034          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22035          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22036          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22037          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22038          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22039          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22040          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22041          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22042          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22043
 22044          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22045
 22046* EXEC CICS READ
 22047*             DATASET   (FILE-ERMAIL)
 22048*             RIDFLD    (MA-CONTROL-PRIMARY)
 22049*             INTO      (MAILING-DATA)
 22050*             RESP      (WS-RESPONSE)
 22051*         END-EXEC
 22052     MOVE LENGTH OF
 22053      MAILING-DATA
 22054       TO DFHEIV11
 22055*    MOVE '&"IL       E          (  N#00020344' TO DFHEIV0
 22056     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22058     MOVE X'204E233030303230333434' TO DFHEIV0(25:11)
 22059     CALL 'kxdfhei1' USING DFHEIV0,
 22060           FILE-ERMAIL,
 22061           MAILING-DATA,
 22062           DFHEIV11,
 22063           MA-CONTROL-PRIMARY,
 22064           DFHEIV99,
 22065           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 409
* EL050.cbl
 22066           DFHEIV99
 22067     MOVE EIBRESP  TO WS-RESPONSE
 22068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22069          IF WS-RESP-NORMAL
 22070             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22071          END-IF
 22072
 22073          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22074          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22075
 22076* EXEC CICS READ
 22077*             DATASET  (CRTT-ID)
 22078*             RIDFLD   (WS-ELCRTT-KEY)
 22079*             INTO     (CERTIFICATE-TRAILERS)
 22080*             RESP     (WS-RESPONSE)
 22081*         END-EXEC
 22082     MOVE LENGTH OF
 22083      CERTIFICATE-TRAILERS
 22084       TO DFHEIV11
 22085*    MOVE '&"IL       E          (  N#00020356' TO DFHEIV0
 22086     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22088     MOVE X'204E233030303230333536' TO DFHEIV0(25:11)
 22089     CALL 'kxdfhei1' USING DFHEIV0,
 22090           CRTT-ID,
 22091           CERTIFICATE-TRAILERS,
 22092           DFHEIV11,
 22093           WS-ELCRTT-KEY,
 22094           DFHEIV99,
 22095           DFHEIV99,
 22096           DFHEIV99
 22097     MOVE EIBRESP  TO WS-RESPONSE
 22098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22099          IF WS-RESP-NORMAL
 22100             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22101                               OC-INS-AGE-DEFAULT-FLAG
 22102             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22103                               OC-JNT-AGE-DEFAULT-FLAG
 22104          END-IF
 22105
 22106        ELSE
 22107          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22108             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22109             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22110             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22111          END-IF
 22112          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22113             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22114             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22115             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22116          END-IF
 22117          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22118        END-IF
 22119
 22120* EXEC CICS REWRITE
 22121*          DATASET   ('ELCRTO')
 22122*          FROM      (ORIGINAL-CERTIFICATE)
 22123*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 410
* EL050.cbl
 22124*       END-EXEC
 22125     MOVE LENGTH OF
 22126      ORIGINAL-CERTIFICATE
 22127       TO DFHEIV11
 22128     MOVE 'ELCRTO' TO DFHEIV1
 22129*    MOVE '&& L                  %  N#00020382' TO DFHEIV0
 22130     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22131     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22132     MOVE X'204E233030303230333832' TO DFHEIV0(25:11)
 22133     CALL 'kxdfhei1' USING DFHEIV0,
 22134           DFHEIV1,
 22135           ORIGINAL-CERTIFICATE,
 22136           DFHEIV11,
 22137           DFHEIV99
 22138     MOVE EIBRESP  TO WS-RESPONSE
 22139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22140     END-IF.
 22141
 22142 9991-EXIT.
 22143     EXIT.
 22144
 22145
 22146 9999-RETURN.
 22147     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22148
 22149
 22150* EXEC CICS RETURN
 22151*    END-EXEC.
 22152*    MOVE '.(                    ''   #00020396' TO DFHEIV0
 22153     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22155     MOVE X'2020233030303230333936' TO DFHEIV0(25:11)
 22156     CALL 'kxdfhei1' USING DFHEIV0,
 22157           DFHEIV99,
 22158           DFHEIV99,
 22159           DFHEIV99,
 22160           DFHEIV99,
 22161           DFHEIV99,
 22162           DFHEIV99
 22163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22164
 22165
 22166
 22167* GOBACK.
 22168     MOVE '9%                    "   ' TO DFHEIV0
 22169     MOVE 'EL050' TO DFHEIV1
 22170     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22171     GOBACK.
 22172
 22173 9999-DFHBACK SECTION.
 22174     MOVE '9%                    "   ' TO DFHEIV0
 22175     MOVE 'EL050' TO DFHEIV1
 22176     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22177     GOBACK.
 22178 9999-DFHEXIT.
 22179     IF DFHEIGDJ EQUAL 0001
 22180         NEXT SENTENCE
 22181     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 411
* EL050.cbl
 22182         GO TO 9300-ABEND,
 22183               3990-FILES-NOT-OPEN
 22184         DEPENDING ON DFHEIGDI
 22185     ELSE IF DFHEIGDJ EQUAL 3
 22186         GO TO 6610-START-BROWSE,
 22187               6630-ERRESS-PROBLEM,
 22188               6630-END-OF-FILE
 22189         DEPENDING ON DFHEIGDI
 22190     ELSE IF DFHEIGDJ EQUAL 4
 22191         GO TO 6630-END-OF-FILE,
 22192               6630-ERRESS-PROBLEM,
 22193               6630-ERRESS-PROBLEM,
 22194               6630-END-OF-FILE
 22195         DEPENDING ON DFHEIGDI
 22196     ELSE IF DFHEIGDJ EQUAL 5
 22197         GO TO 6630-END-OF-FILE,
 22198               6630-END-OF-FILE,
 22199               6630-ERRESS-PROBLEM,
 22200               6630-ERRESS-PROBLEM
 22201         DEPENDING ON DFHEIGDI
 22202     ELSE IF DFHEIGDJ EQUAL 6
 22203         GO TO 6660-START-BROWSE,
 22204               6690-ERRESC-PROBLEM,
 22205               6690-ERRESC-PROBLEM,
 22206               6690-END-OF-FILE
 22207         DEPENDING ON DFHEIGDI
 22208     ELSE IF DFHEIGDJ EQUAL 7
 22209         GO TO 6690-END-OF-FILE,
 22210               6690-ERRESC-PROBLEM,
 22211               6690-ERRESC-PROBLEM,
 22212               6690-END-OF-FILE
 22213         DEPENDING ON DFHEIGDI
 22214     ELSE IF DFHEIGDJ EQUAL 8
 22215         GO TO 6690-END-OF-FILE,
 22216               6690-ERRESC-PROBLEM,
 22217               6690-ERRESC-PROBLEM,
 22218               6690-END-OF-FILE
 22219         DEPENDING ON DFHEIGDI
 22220     ELSE IF DFHEIGDJ EQUAL 9
 22221         GO TO 7250-CONTINUE,
 22222               7250-CONTINUE
 22223         DEPENDING ON DFHEIGDI
 22224     ELSE IF DFHEIGDJ EQUAL 10
 22225         GO TO 7300-CONTINUE,
 22226               7300-CONTINUE
 22227         DEPENDING ON DFHEIGDI
 22228     ELSE IF DFHEIGDJ EQUAL 11
 22229         GO TO 8000-FREE-MAIN
 22230         DEPENDING ON DFHEIGDI
 22231     ELSE IF DFHEIGDJ EQUAL 12
 22232         GO TO 8100-NOTFND,
 22233               8100-NOTFND
 22234         DEPENDING ON DFHEIGDI
 22235     ELSE IF DFHEIGDJ EQUAL 13
 22236         GO TO 8110-NOTFND,
 22237               8110-NOTFND
 22238         DEPENDING ON DFHEIGDI
 22239     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 412
* EL050.cbl
 22240         GO TO 8130-EXIT
 22241         DEPENDING ON DFHEIGDI
 22242     ELSE IF DFHEIGDJ EQUAL 15
 22243         GO TO 8150-exit
 22244         DEPENDING ON DFHEIGDI
 22245     ELSE IF DFHEIGDJ EQUAL 16
 22246         GO TO 8180-NOTFND
 22247         DEPENDING ON DFHEIGDI
 22248     ELSE IF DFHEIGDJ EQUAL 17
 22249         GO TO 8190-NOTFND
 22250         DEPENDING ON DFHEIGDI
 22251     ELSE IF DFHEIGDJ EQUAL 18
 22252         GO TO 8195-NOTFND
 22253         DEPENDING ON DFHEIGDI
 22254     ELSE IF DFHEIGDJ EQUAL 19
 22255         GO TO 8200-NOTFND
 22256         DEPENDING ON DFHEIGDI
 22257     ELSE IF DFHEIGDJ EQUAL 20
 22258         GO TO 8300-NOTFND,
 22259               8300-ERRESS-PROBLEM,
 22260               8300-ERRESS-PROBLEM,
 22261               8300-NOTFND
 22262         DEPENDING ON DFHEIGDI
 22263     ELSE IF DFHEIGDJ EQUAL 21
 22264         GO TO 8450-FORM-NOT-FOUND,
 22265               8450-FORM-NOT-FOUND
 22266         DEPENDING ON DFHEIGDI
 22267     ELSE IF DFHEIGDJ EQUAL 22
 22268         GO TO 0199-ACCT-NOT-FOUND,
 22269               0199-ACCT-NOT-FOUND
 22270         DEPENDING ON DFHEIGDI
 22271     ELSE IF DFHEIGDJ EQUAL 23
 22272         GO TO 0199-ACCT-NOT-FOUND,
 22273               0199-ACCT-NOT-FOUND
 22274         DEPENDING ON DFHEIGDI
 22275     ELSE IF DFHEIGDJ EQUAL 24
 22276         GO TO 8582-COMP-NOT-FOUND,
 22277               8582-COMP-NOT-FOUND
 22278         DEPENDING ON DFHEIGDI
 22279     ELSE IF DFHEIGDJ EQUAL 25
 22280         GO TO 8583-AGTC-NOT-FOUND,
 22281               8583-AGTC-NOT-FOUND
 22282         DEPENDING ON DFHEIGDI
 22283     ELSE IF DFHEIGDJ EQUAL 26
 22284         GO TO 8584-BXRF-NOT-FOUND,
 22285               8584-BXRF-NOT-FOUND
 22286         DEPENDING ON DFHEIGDI
 22287     ELSE IF DFHEIGDJ EQUAL 27
 22288         GO TO 8585-PLAN-NOT-FOUND,
 22289               8585-PLAN-NOT-FOUND
 22290         DEPENDING ON DFHEIGDI
 22291     ELSE IF DFHEIGDJ EQUAL 28
 22292         GO TO 0299-CERT-NOT-FOUND
 22293         DEPENDING ON DFHEIGDI
 22294     ELSE IF DFHEIGDJ EQUAL 29
 22295         GO TO 8700-READ-CERT-MASTER
 22296         DEPENDING ON DFHEIGDI
 22297     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 21-Dec-15 09:29 Page 413
* EL050.cbl
 22298         GO TO 8720-COMP-ACCOUNTS,
 22299               8730-END-BROWSE,
 22300               8740-NOT-FOUND
 22301         DEPENDING ON DFHEIGDI
 22302     ELSE IF DFHEIGDJ EQUAL 31
 22303         GO TO 9000-NOTFND
 22304         DEPENDING ON DFHEIGDI
 22305     ELSE IF DFHEIGDJ EQUAL 32
 22306         GO TO 9100-NOTFND,
 22307               9100-NOTFND
 22308         DEPENDING ON DFHEIGDI
 22309     ELSE IF DFHEIGDJ EQUAL 33
 22310         GO TO 9991-CRTO-NOT-FOUND,
 22311               9991-CRTO-NOT-FOUND
 22312         DEPENDING ON DFHEIGDI.
 22313     MOVE '9%                    "   ' TO DFHEIV0
 22314     MOVE 'EL050' TO DFHEIV1
 22315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22316     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40688     Code:       90197
