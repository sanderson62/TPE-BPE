* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40*-----------------------------------------------------------------
    41*REMARKS.
    42*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   3
* EL6318.cbl
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    51 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    53 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    57 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    58     88  ACCT-FOUND                 VALUE 'Y'.
    59 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    60 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    61 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    62 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    63 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    64 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    65 77  WS-REASON-SW                PIC X  VALUE ' '.
    66     88  REASONS-FOUND                  VALUE 'Y'.
    67     88  REASONS-NOT-FOUND              VALUE 'N'.
    68 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    69     88  NO-CERT-RW                 VALUE 'N'.
    70     88  CERT-RW                    VALUE 'Y'.
    71 01  P pointer.
    72 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    73 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    74 01  var-ptr pointer.
    75 01  env-var-len                 pic 9(4)  binary.
    76 01  rc                          pic 9(9)  binary.
    77 01  WS-KIXHOST                  PIC X(10).
    78 01  WS-KIXSYS.
    79     05  WS-KIX-FIL1             PIC X(10).
    80     05  WS-KIX-APPS             PIC X(10).
    81     05  WS-KIX-ENV              PIC X(10).
    82     05  WS-KIX-MYENV            PIC X(10).
    83     05  WS-KIX-SYS              PIC X(10).
    84*                                COPY ELCSCTM.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCTM                             *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-MESSAGE.
    95     12  FILLER                          PIC X(30)
    96            VALUE '** LOGIC SECURITY VIOLATION -'.
    97     12  SM-READ                         PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' PGM='.
   100     12  SM-PGM                          PIC X(6).
   101     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   4
* EL6318.cbl
   102            VALUE ' OPR='.
   103     12  SM-PROCESSOR-ID                 PIC X(4).
   104     12  FILLER                          PIC X(6)
   105            VALUE ' TERM='.
   106     12  SM-TERMID                       PIC X(4).
   107     12  FILLER                          PIC XX   VALUE SPACE.
   108     12  SM-JUL-DATE                     PIC 9(5).
   109     12  FILLER                          PIC X    VALUE SPACE.
   110     12  SM-TIME                         PIC 99.99.
   111
   112*                                COPY ELCSCRTY.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCRTY                            *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   120*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   121*        SAVED IN PI-SECURITY-ADDRESS.                           *
   122*                                                                *
   123******************************************************************
   124 01  SECURITY-CONTROL.
   125     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   126     12  FILLER                       PIC XX    VALUE 'SC'.
   127     12  SC-CREDIT-CODES.
   128         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   129             20  SC-CREDIT-DISPLAY    PIC X.
   130             20  SC-CREDIT-UPDATE     PIC X.
   131     12  SC-CLAIMS-CODES.
   132         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   133             20  SC-CLAIMS-DISPLAY    PIC X.
   134             20  SC-CLAIMS-UPDATE     PIC X.
   135 01 srch-commarea.
   136*                                copy ELCADLTRSPI.
   137******************************************************************
   138*                   C H A N G E   L O G
   139*
   140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   141*-----------------------------------------------------------------
   142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   143* EFFECTIVE    NUMBER
   144*-----------------------------------------------------------------
   145* 060611    2011022800001  PEMA  NEW COPYBOOK
   146* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   147* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   148******************************************************************
   149****************************************
   150*  commarea for NaperSoft On Demand Admin services letters
   151*  (business logic input & output)
   152****************************************
   153     03  BL-INPUT.
   154         05  BL-DATA-SRCE        PIC X.
   155         05  BL-LETTER-ID        PIC XXXX.
   156         05  BL-CARRIER          PIC X.
   157         05  BL-GROUP            PIC X(6).
   158         05  BL-STATE            PIC XX.
   159         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   5
* EL6318.cbl
   160         05  BL-EFF-DT           PIC X(10).
   161         05  BL-CERT-NO          PIC X(11).
   162         05  BL-BATCH-NO         PIC X(6).
   163         05  BL-BATCH-SEQ        PIC 9(8).
   164         05  BL-RESP-NO          PIC X(10).
   165         05  BL-NO-OF-COPIES     PIC 99.
   166         05  BL-PROC-ID          PIC XXXX.
   167         05  BL-COMP-ID          PIC XXX.
   168         05  BL-PRINT-NOW-SW     PIC X.
   169         05  BL-ENC-CD           PIC XXX.
   170         05  BL-RESEND-DT        PIC X(10).
   171         05  BL-FOLLOW-UP-DT     PIC X(10).
   172         05  BL-ARCHIVE-NO       PIC 9(8).
   173         05  BL-FUNC             PIC X(8).
   174         05  BL-COMMENTS         PIC X(100).
   175         05  FILLER REDEFINES BL-COMMENTS.
   176             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   177             10  BL-LETTER-TO-ACCT PIC X.
   178             10  BL-LETTER-TO-BENE PIC X.
   179             10  BL-WRITE-ERARCH   PIC X.
   180                 88  ERARCH-QWS      VALUE 'Q'.
   181                 88  ERARCH-BATCH    VALUE 'B'.
   182                 88  ERARCH-TEMP     VALUE 'T'.
   183             10  BL-PROCESS-TYPE PIC X(07).
   184             10  BL-CERT-FORM-ID PIC X(05).
   185             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   186             10  BL-SOURCE-SCREEN PIC X(8).
   187             10  FILLER          PIC X(25).
   188     03  BL-OUTPUT.
   189         05  BL-STATUS                   PIC X.
   190             88  BL-OK                      VALUE "P".
   191             88  BL-FAIL                  VALUE "F".
   192         05  BL-MESSAGE          PIC X(50).
   193     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   194     03  FILLER                  PIC X(31).
   195
   196*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   197*                                COPY ELCZREC.
   198******************************************************************
   199*                                                                *
   200*                                                                *
   201*                            ELCZREC.                            *
   202*                                                                *
   203*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   204*                                                                *
   205******************************************************************
   206*-----------------------------------------------------------------
   207*                   C H A N G E   L O G
   208*
   209* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   210*-----------------------------------------------------------------
   211*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   212* EFFECTIVE    NUMBER
   213*-----------------------------------------------------------------
   214* 122011    2011022800001  AJRA  NEW FILE
   215* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   216* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   217* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   6
* EL6318.cbl
   218* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   219*-----------------------------------------------------------------
   220 01  W-Z-CONTROL-DATA.
   221     05  W-NUMBER-OF-COPIES      PIC  9.
   222     05  FILLER                  PIC  X.
   223     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   224     05  FILLER                  PIC  X.
   225     05  W-DAYS-TO-RESEND        PIC  999.
   226     05  FILLER                  PIC  X.
   227     05  W-FORM-TO-RESEND        PIC  X(4).
   228     05  W-ADD-BAR-CODE          PIC  X.
   229     05  W-PROMPT-LETTER         PIC  X.
   230     05  W-HAS-RETURN-ENV        PIC  X.
   231     05  W-ENCLOSURE-CD          PIC  XXX.
   232     05  W-SIG-FLAG-DEFAULT      PIC  X.
   233     05  W-AUTO-CLOSE-IND        PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-LETTER-TO-BENE        PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-LETTER-TO-ACCT        PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-LETTER-TYPE           PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-PRINT-CERTIFICATE     PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-REFUND-REQUIRED       PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-ONBASE-CODE           PIC  XX.
   246     05  FILLER                  PIC  X.
   247     05  W-ACCT-SUMM             PIC  X.
   248     05  FILLER                  PIC  X.
   249     05  W-CSO-SUMM              PIC  X.
   250     05  FILLER                  PIC  X.
   251     05  W-REASONS-REQUIRED      PIC  X.
   252     05  FILLER                  PIC  X(29).
   253 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   254 01  STANDARD-AREAS.
   255     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   256     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   257                                 PIC  X(08).
   258     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   259     12  QID.
   260         16  QID-TERM        PIC X(4)    VALUE SPACES.
   261         16  FILLER          PIC X(4)    VALUE '631K'.
   262     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   263     12  TIME-MT                 PIC S9(7).
   264     12  TIME-MT-R  REDEFINES TIME-MT.
   265         16  FILLER              PIC X.
   266         16  TIME-LMT            PIC 99V99.
   267         16  FILLER              PIC X(2).
   268     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   269     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   270     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   271     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   272     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   273     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   274     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   275     12  W-CNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   7
* EL6318.cbl
   276         16  W-CNTL-COMPANY-ID   PIC  X(03).
   277         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   278         16  W-CNTL-GENL.
   279             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   280             20  W-CNTL-GEN2.
   281                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   282                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   283         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   284     12  WS-ELCERT-KEY.
   285         16  W-CERT-COMPANY-CD   PIC X.
   286         16  W-CERT-CARRIER      PIC X.
   287         16  W-CERT-GROUPING     PIC X(6).
   288         16  W-CERT-STATE        PIC XX.
   289         16  W-CERT-ACCOUNT      PIC X(10).
   290         16  W-CERT-CERT-EFF-DT  PIC XX.
   291         16  W-CERT-CERT-PRIME   PIC X(10).
   292         16  W-CERT-CERT-SFX     PIC X.
   293     12  WS-ELEOBC-KEY.
   294         16  WS-EOBC-COMPANY-CD  PIC X.
   295         16  WS-EOBC-REC-TYPE    PIC X.
   296         16  WS-EOBC-CODE        PIC X(4).
   297         16  FILLER              PIC X(9).
   298     12  WS-ERNOTE-KEY.
   299         16  W-NOTE-COMPANY-CD   PIC X.
   300         16  W-NOTE-CARRIER      PIC X.
   301         16  W-NOTE-GROUPING     PIC X(6).
   302         16  W-NOTE-STATE        PIC XX.
   303         16  W-NOTE-ACCOUNT      PIC X(10).
   304         16  W-NOTE-CERT-EFF-DT  PIC XX.
   305         16  W-NOTE-CERT-PRIME   PIC X(10).
   306         16  W-NOTE-CERT-SFX     PIC X.
   307     12  ELLETR-KEY.
   308         16  LETR-PART-KEY.
   309             20  LETR-COMPANY-CD PIC X.
   310             20  LETR-LETTER-ID  PIC X(4).
   311         16  LETR-FILLER         PIC X(8).
   312         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   313     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   314     12  ERPNDB2-KEY.
   315         16  PNDB2-COMPANY-CD    PIC X.
   316         16  PNDB2-CARRIER       PIC X.
   317         16  PNDB2-GROUPING      PIC X(6).
   318         16  PNDB2-STATE         PIC XX.
   319         16  PNDB2-ACCOUNT       PIC X(10).
   320         16  PNDB2-CERT-EFF-DT   PIC XX.
   321         16  PNDB2-CERT-PRIME    PIC X(10).
   322         16  PNDB2-CERT-SFX      PIC X.
   323         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   324         16  PNDB2-RECORD-TYPE   PIC X.
   325     12  ERPNDB-KEY.
   326         16  PNDB-COMPANY-CD     PIC X.
   327         16  PNDB-BATCH-NO       PIC X(6).
   328         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   329         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   330     12  ERENDT-KEY.
   331         16  ENDT-COMPANY-CD       PIC X.
   332         16  ENDT-CARRIER          PIC X.
   333         16  ENDT-GROUPING         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   8
* EL6318.cbl
   334         16  ENDT-STATE            PIC XX.
   335         16  ENDT-ACCOUNT          PIC X(10).
   336         16  ENDT-CERT-EFF-DT      PIC XX.
   337         16  ENDT-CERT-PRIME       PIC X(10).
   338         16  ENDT-CERT-SFX         PIC X.
   339         16  ENDT-RECORD-TYPE      PIC X.
   340         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   341     12  ELCRTO-KEY.
   342         16  CRTO-COMPANY-CD     PIC X.
   343         16  CRTO-CARRIER        PIC X.
   344         16  CRTO-GROUPING       PIC X(6).
   345         16  CRTO-STATE          PIC XX.
   346         16  CRTO-ACCOUNT        PIC X(10).
   347         16  CRTO-CERT-EFF-DT    PIC XX.
   348         16  CRTO-CERT-PRIME     PIC X(10).
   349         16  CRTO-CERT-SFX       PIC X.
   350         16  CRTO-RECORD-TYPE    PIC X.
   351         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   352     12  WS-ELCRTT-KEY.
   353         16  WS-ELCRTT-PRIMARY   PIC X(33).
   354         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   355     12  WS-ERMAIL-KEY.
   356         16  MAIL-COMPANY-CD     PIC X.
   357         16  MAIL-CARRIER        PIC X.
   358         16  MAIL-GROUPING       PIC X(6).
   359         16  MAIL-STATE          PIC XX.
   360         16  MAIL-ACCOUNT        PIC X(10).
   361         16  MAIL-CERT-EFF-DT    PIC XX.
   362         16  MAIL-CERT-PRIME     PIC X(10).
   363         16  MAIL-CERT-SFX       PIC X.
   364     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   365     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   366     12  WS-CURRENT-DT.
   367         16  FILLER              PIC X(6)    VALUE SPACES.
   368         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   369     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   370     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   371         88  CANCEL-REC            VALUE 'C'.
   372         88  ISSUE-REC             VALUE 'I'.
   373     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   374     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   375     12  ELCNTL-KEY.
   376         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   377         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   378         16  CNTL-ACCESS.
   379             20  CNTL-STATE      PIC XX    VALUE SPACES.
   380             20  FILLER          PIC X     VALUE SPACES.
   381             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   382         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   383     12  WS-ERACCT-KEY.
   384         16  ACCT-COMPANY-CD     PIC X.
   385         16  ACCT-CARRIER        PIC X.
   386         16  ACCT-GROUPING       PIC X(6).
   387         16  ACCT-STATE          PIC XX.
   388         16  ACCT-ACCOUNT        PIC X(10).
   389         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   390         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   391     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   9
* EL6318.cbl
   392     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   393     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   394     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   395     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   396     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   397     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   398     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   399     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   400     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   401     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   402     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   403     12  WS-RESPONSE             PIC S9(8)   COMP.
   404         88  RESP-NORMAL                  VALUE +00.
   405         88  RESP-NOTFND                  VALUE +13.
   406         88  RESP-DUPREC                  VALUE +14.
   407         88  RESP-DUPKEY                  VALUE +15.
   408         88  RESP-NOTOPEN                 VALUE +19.
   409         88  RESP-ENDFILE                 VALUE +20.
   410     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   411     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   412     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   413     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   414     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   415     12  PGM-NAME            PIC X(8).
   416     12  TIME-IN             PIC S9(7).
   417     12  TIME-OUT-R  REDEFINES TIME-IN.
   418         16  FILLER          PIC X.
   419         16  TIME-OUT        PIC 99V99.
   420         16  FILLER          PIC X(2).
   421     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   422     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   423     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   424     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   425     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   426     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   427     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   428     12  WS-PHONE.
   429         16  WS-PH1              PIC XXX.
   430         16  WS-PH2              PIC XXX.
   431         16  WS-PH3              PIC XXXX.
   432     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   433     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   434
   435     12  WS-BILLING-NOTE.
   436         16  WS-BN-NOTE          PIC X(25).
   437         16  WS-BN-LTRID         PIC X(4).
   438         16  FILLER              PIC X(3).
   439         16  WS-BN-DATE          PIC X(8).
   440         16  FILLER              PIC X(3).
   441         16  WS-BN-USERID        PIC X(4).
   442         16  FILLER              PIC X(30).
   443     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   444         16  WS-MAN-BN-NOTE      PIC X(63).
   445         16  FILLER              PIC X(14).
   446     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   447
   448     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   449
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  10
* EL6318.cbl
   450 01  NEW-ELCRTO-REC.
   451     12  NEW-ELCRTO-KEY.
   452         16  NCRTO-COMPANY-CD      PIC X.
   453         16  NCRTO-CARRIER         PIC X.
   454         16  NCRTO-GROUPING        PIC X(6).
   455         16  NCRTO-STATE           PIC XX.
   456         16  NCRTO-ACCOUNT         PIC X(10).
   457         16  NCRTO-CERT-EFF-DT     PIC XX.
   458         16  NCRTO-CERT-PRIME      PIC X(10).
   459         16  NCRTO-CERT-SFX        PIC X.
   460         16  NCRTO-RECORD-TYPE     PIC X.
   461         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   462     12  NEW-ORIG-REC.
   463         16  NCRTO-INS-LAST-NAME   PIC X(15).
   464         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   465         16  NCRTO-INS-MIDDLE-INIT PIC X.
   466         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   467         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   468         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   469         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   470         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   471         16  NCRTO-LF-BENCD        PIC XX.
   472         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   473         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   474         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   475         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   476         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   477         16  NCRTO-LF-EXP-DT       PIC XX.
   478         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   479         16  NCRTO-LF-CANCEL-DT    PIC XX.
   480         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   481         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   482         16  NCRTO-AH-BENCD        PIC XX.
   483         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   484         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   485         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   486         16  NCRTO-AH-EXP-DT       PIC XX.
   487         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   488         16  NCRTO-AH-CP           PIC 99.
   489         16  NCRTO-AH-CANCEL-DT    PIC XX.
   490         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   491         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   492         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   493         16  NCRTO-1ST-PMT-DT      PIC XX.
   494         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   495         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   496         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   497         16  NCRTO-CANCEL-TRAN-IND PIC X.
   498         16  FILLER                PIC X(235).
   499
   500 01  CERT-NOTE-ENTRIES.
   501     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   502         16  CERT-NT-TEXT                PIC X(63).
   503         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   504         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   505         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   506
   507 01  ERCNOT-AREA.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  11
* EL6318.cbl
   508     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   509     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   510     12  ERCNOT-KEY.
   511         16  ERCNOT-PARTIAL-KEY.
   512             20 ERCNOT-COMPANY-CD    PIC X.
   513             20 ERCNOT-CARRIER       PIC X.
   514             20 ERCNOT-GROUPING      PIC X(06).
   515             20 ERCNOT-STATE         PIC XX.
   516             20 ERCNOT-ACCOUNT       PIC X(10).
   517             20 ERCNOT-EFF-DT        PIC XX.
   518             20 ERCNOT-CERT-NO.
   519                25 ERCNOT-CERT-PRIME PIC X(10).
   520                25 ERCNOT-CERT-SFX   PIC X.
   521             20 ERCNOT-REC-TYP       PIC X.
   522         16 ERCNOT-SEQ           PIC S9(4) COMP.
   523     12  SV-PARTIAL-KEY.
   524         20 SV-COMPANY-CD            PIC X.
   525         20 SV-CARRIER               PIC X.
   526         20 SV-GROUPING              PIC X(06).
   527         20 SV-STATE                 PIC XX.
   528         20 SV-ACCOUNT               PIC X(10).
   529         20 SV-EFF-DT                PIC XX.
   530         20 SV-CERT-NO.
   531            25 SV-CERT-PRIME         PIC X(10).
   532            25 SV-CERT-SFX           PIC X(1).
   533         20 SV-REC-TYP               PIC X.
   534 01  ERROR-MESSAGES.
   535     12  ER-0000                 PIC X(4)  VALUE '0000'.
   536     12  ER-0004                 PIC X(4)  VALUE '0004'.
   537     12  ER-0008                 PIC X(4)  VALUE '0008'.
   538     12  ER-0023                 PIC X(4)  VALUE '0023'.
   539     12  ER-0029                 PIC X(4)  VALUE '0029'.
   540     12  ER-0068                 PIC X(4)  VALUE '0068'.
   541     12  ER-0132                 PIC X(4)  VALUE '0132'.
   542     12  ER-0142                 PIC X(4)  VALUE '0142'.
   543     12  ER-0148                 PIC X(4)  VALUE '0148'.
   544     12  ER-0215                 PIC X(4)  VALUE '0215'.
   545     12  ER-0280                 PIC X(4)  VALUE '0280'.
   546     12  ER-0348                 PIC X(4)  VALUE '0348'.
   547     12  ER-0419                 PIC X(4)  VALUE '0419'.
   548     12  ER-0715                 PIC X(4)  VALUE '0715'.
   549     12  ER-0894                 PIC X(4)  VALUE '0894'.
   550     12  ER-1101                 PIC X(4)  VALUE '1101'.
   551     12  ER-1236                 PIC X(4)  VALUE '1236'.
   552     12  ER-1664                 PIC X(4)  VALUE '1664'.
   553     12  ER-1778                 PIC X(4)  VALUE '1778'.
   554     12  ER-1818                 PIC X(4)  VALUE '1818'.
   555     12  ER-1820                 PIC X(4)  VALUE '1820'.
   556     12  ER-1821                 PIC X(4)  VALUE '1821'.
   557     12  ER-2056                 PIC X(4)  VALUE '2056'.
   558     12  ER-2079                 PIC X(4)  VALUE '2079'.
   559     12  ER-2208                 PIC X(4)  VALUE '2208'.
   560     12  ER-2209                 PIC X(4)  VALUE '2209'.
   561     12  ER-2237                 PIC X(4)  VALUE '2237'.
   562     12  ER-2238                 PIC X(4)  VALUE '2238'.
   563     12  ER-2253                 PIC X(4)  VALUE '2253'.
   564     12  ER-2619                 PIC X(4)  VALUE '2619'.
   565     12  ER-2651                 PIC X(4)  VALUE '2651'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  12
* EL6318.cbl
   566     12  ER-2784                 PIC X(4)  VALUE '2784'.
   567     12  ER-2785                 PIC X(4)  VALUE '2785'.
   568     12  ER-2786                 PIC X(4)  VALUE '2786'.
   569     12  ER-2791                 PIC X(4)  VALUE '2791'.
   570     12  ER-2845                 PIC X(4)  VALUE '2845'.
   571     12  ER-2848                 PIC X(4)  VALUE '2848'.
   572     12  ER-2851                 PIC X(4)  VALUE '2851'.
   573     12  ER-3830                 PIC X(4)  VALUE '3830'.
   574     12  ER-3833                 PIC X(4)  VALUE '3833'.
   575     12  ER-7345                 PIC X(4)  VALUE '7345'.
   576     12  ER-7638                 PIC X(4)  VALUE '7638'.
   577     12  ER-8888                 PIC X(4)  VALUE '8888'.
   578     12  ER-9999                 PIC X(4)  VALUE '9999'.
   579*    COPY ELCDATE.
   580******************************************************************
   581*                                                                *
   582*                                                                *
   583*                            ELCDATE.                            *
   584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   585*                            VMOD=2.003
   586*                                                                *
   587*                                                                *
   588*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   589*                 LENGTH = 200                                   *
   590******************************************************************
   591
   592 01  DATE-CONVERSION-DATA.
   593     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   594     12  DC-OPTION-CODE                PIC X.
   595         88  BIN-TO-GREG                VALUE ' '.
   596         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   597         88  EDIT-GREG-TO-BIN           VALUE '2'.
   598         88  YMD-GREG-TO-BIN            VALUE '3'.
   599         88  MDY-GREG-TO-BIN            VALUE '4'.
   600         88  JULIAN-TO-BIN              VALUE '5'.
   601         88  BIN-PLUS-ELAPSED           VALUE '6'.
   602         88  FIND-CENTURY               VALUE '7'.
   603         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   604         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   605         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   606         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   607         88  JULIAN-TO-BIN-3            VALUE 'C'.
   608         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   609         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   610         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   611         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   612         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   613         88  CHECK-LEAP-YEAR            VALUE 'H'.
   614         88  BIN-3-TO-GREG              VALUE 'I'.
   615         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   616         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   617         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   618         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   619         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   620         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   621         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   622         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   623         88  THREE-CHARACTER-BIN
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  13
* EL6318.cbl
   624                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   625         88  GREGORIAN-TO-BIN
   626                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   627         88  BIN-TO-GREGORIAN
   628                  VALUES ' ' '1' 'I' '8' 'G'.
   629         88  JULIAN-TO-BINARY
   630                  VALUES '5' 'C' 'E' 'F'.
   631     12  DC-ERROR-CODE                 PIC X.
   632         88  NO-CONVERSION-ERROR        VALUE ' '.
   633         88  DATE-CONVERSION-ERROR
   634                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   635         88  DATE-IS-ZERO               VALUE '1'.
   636         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   637         88  DATE-IS-INVALID            VALUE '3'.
   638         88  DATE1-GREATER-DATE2        VALUE '4'.
   639         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   640         88  DATE-INVALID-OPTION        VALUE '9'.
   641         88  INVALID-CENTURY            VALUE 'A'.
   642         88  ONLY-CENTURY               VALUE 'B'.
   643         88  ONLY-LEAP-YEAR             VALUE 'C'.
   644         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   645     12  DC-END-OF-MONTH               PIC X.
   646         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   647     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   648         88  USE-NORMAL-PROCESS         VALUE ' '.
   649         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   650         88  ADJUST-UP-100-YRS          VALUE '2'.
   651     12  FILLER                        PIC X.
   652     12  DC-CONVERSION-DATES.
   653         16  DC-BIN-DATE-1             PIC XX.
   654         16  DC-BIN-DATE-2             PIC XX.
   655         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   656         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   657                       DC-GREG-DATE-1-EDIT.
   658             20  DC-EDIT1-MONTH        PIC 99.
   659             20  SLASH1-1              PIC X.
   660             20  DC-EDIT1-DAY          PIC 99.
   661             20  SLASH1-2              PIC X.
   662             20  DC-EDIT1-YEAR         PIC 99.
   663         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   664         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   665                     DC-GREG-DATE-2-EDIT.
   666             20  DC-EDIT2-MONTH        PIC 99.
   667             20  SLASH2-1              PIC X.
   668             20  DC-EDIT2-DAY          PIC 99.
   669             20  SLASH2-2              PIC X.
   670             20  DC-EDIT2-YEAR         PIC 99.
   671         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   672         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   673                     DC-GREG-DATE-1-YMD.
   674             20  DC-YMD-YEAR           PIC 99.
   675             20  DC-YMD-MONTH          PIC 99.
   676             20  DC-YMD-DAY            PIC 99.
   677         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   678         16  DC-GREG-DATE-1-MDY-R REDEFINES
   679                      DC-GREG-DATE-1-MDY.
   680             20  DC-MDY-MONTH          PIC 99.
   681             20  DC-MDY-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  14
* EL6318.cbl
   682             20  DC-MDY-YEAR           PIC 99.
   683         16  DC-GREG-DATE-1-ALPHA.
   684             20  DC-ALPHA-MONTH        PIC X(10).
   685             20  DC-ALPHA-DAY          PIC 99.
   686             20  FILLER                PIC XX.
   687             20  DC-ALPHA-CENTURY.
   688                 24 DC-ALPHA-CEN-N     PIC 99.
   689             20  DC-ALPHA-YEAR         PIC 99.
   690         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   691         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   692         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   693         16  DC-JULIAN-DATE            PIC 9(05).
   694         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   695                                       PIC 9(05).
   696         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   697             20  DC-JULIAN-YEAR        PIC 99.
   698             20  DC-JULIAN-DAYS        PIC 999.
   699         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   700         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   701         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   702     12  DATE-CONVERSION-VARIBLES.
   703         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   704         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   705             20  FILLER                PIC 9(3).
   706             20  HOLD-CEN-1-CCYY.
   707                 24  HOLD-CEN-1-CC     PIC 99.
   708                 24  HOLD-CEN-1-YY     PIC 99.
   709             20  HOLD-CEN-1-MO         PIC 99.
   710             20  HOLD-CEN-1-DA         PIC 99.
   711         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   712             20  HOLD-CEN-1-R-MO       PIC 99.
   713             20  HOLD-CEN-1-R-DA       PIC 99.
   714             20  HOLD-CEN-1-R-CCYY.
   715                 24  HOLD-CEN-1-R-CC   PIC 99.
   716                 24  HOLD-CEN-1-R-YY   PIC 99.
   717             20  FILLER                PIC 9(3).
   718         16  HOLD-CENTURY-1-X.
   719             20  FILLER                PIC X(3)  VALUE SPACES.
   720             20  HOLD-CEN-1-X-CCYY.
   721                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   722                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   723             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   724             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   725         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   726             20  HOLD-CEN-1-R-X-MO     PIC XX.
   727             20  HOLD-CEN-1-R-X-DA     PIC XX.
   728             20  HOLD-CEN-1-R-X-CCYY.
   729                 24  HOLD-CEN-1-R-X-CC PIC XX.
   730                 24  HOLD-CEN-1-R-X-YY PIC XX.
   731             20  FILLER                PIC XXX.
   732         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   733         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   734         16  DC-JULIAN-DATE-1          PIC 9(07).
   735         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   736             20  DC-JULIAN-1-CCYY.
   737                 24  DC-JULIAN-1-CC    PIC 99.
   738                 24  DC-JULIAN-1-YR    PIC 99.
   739             20  DC-JULIAN-DA-1        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  15
* EL6318.cbl
   740         16  DC-JULIAN-DATE-2          PIC 9(07).
   741         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   742             20  DC-JULIAN-2-CCYY.
   743                 24  DC-JULIAN-2-CC    PIC 99.
   744                 24  DC-JULIAN-2-YR    PIC 99.
   745             20  DC-JULIAN-DA-2        PIC 999.
   746         16  DC-GREG-DATE-A-EDIT.
   747             20  DC-EDITA-MONTH        PIC 99.
   748             20  SLASHA-1              PIC X VALUE '/'.
   749             20  DC-EDITA-DAY          PIC 99.
   750             20  SLASHA-2              PIC X VALUE '/'.
   751             20  DC-EDITA-CCYY.
   752                 24  DC-EDITA-CENT     PIC 99.
   753                 24  DC-EDITA-YEAR     PIC 99.
   754         16  DC-GREG-DATE-B-EDIT.
   755             20  DC-EDITB-MONTH        PIC 99.
   756             20  SLASHB-1              PIC X VALUE '/'.
   757             20  DC-EDITB-DAY          PIC 99.
   758             20  SLASHB-2              PIC X VALUE '/'.
   759             20  DC-EDITB-CCYY.
   760                 24  DC-EDITB-CENT     PIC 99.
   761                 24  DC-EDITB-YEAR     PIC 99.
   762         16  DC-GREG-DATE-CYMD         PIC 9(08).
   763         16  DC-GREG-DATE-CYMD-R REDEFINES
   764                              DC-GREG-DATE-CYMD.
   765             20  DC-CYMD-CEN           PIC 99.
   766             20  DC-CYMD-YEAR          PIC 99.
   767             20  DC-CYMD-MONTH         PIC 99.
   768             20  DC-CYMD-DAY           PIC 99.
   769         16  DC-GREG-DATE-MDCY         PIC 9(08).
   770         16  DC-GREG-DATE-MDCY-R REDEFINES
   771                              DC-GREG-DATE-MDCY.
   772             20  DC-MDCY-MONTH         PIC 99.
   773             20  DC-MDCY-DAY           PIC 99.
   774             20  DC-MDCY-CEN           PIC 99.
   775             20  DC-MDCY-YEAR          PIC 99.
   776    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   777        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   778    12  DC-EL310-DATE                  PIC X(21).
   779    12  FILLER                         PIC X(28).
   780*    COPY ELCTEXT.
   781******************************************************************
   782*                                                                *
   783*                                                                *
   784*                            ELCTEXT.                            *
   785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   786*                            VMOD=2.008                          *
   787*                                                                *
   788*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   789*                                     FORM LETTERS,              *
   790*                                     CERT FORM DISPLAY.
   791*                                                                *
   792*   FILE TYPE = VSAM,KSDS                                        *
   793*   RECORD SIZE = 100   RECFORM = FIXED                          *
   794*                                                                *
   795*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   796*       ALTERNATE INDEX = NONE                                   *
   797*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  16
* EL6318.cbl
   798*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   799*       ALTERNATE INDEX = NONE                                   *
   800*                                                                *
   801*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   802*       ALTERNATE INDEX = NONE                                   *
   803*                                                                *
   804*   LOG = NO                                                     *
   805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   806******************************************************************
   807 01  TEXT-FILES.
   808     12  TEXT-FILE-ID                PIC XX.
   809         88  FORMS-FILE-TEXT            VALUE 'TF'.
   810         88  LETTER-FILE-TEXT           VALUE 'TL'.
   811         88  HELP-FILE-TEXT             VALUE 'TH'.
   812
   813     12  TX-CONTROL-PRIMARY.
   814         16  TX-COMPANY-CD           PIC X.
   815             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   816         16  TX-ACCESS-CD-GENL       PIC X(12).
   817
   818         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   819             20  TX-LETTER-NO        PIC X(4).
   820             20  FILLER              PIC X(8).
   821
   822         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   823             20  TX-FORM-NO          PIC X(12).
   824
   825         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   826             20  TX-HELP-TYPE        PIC X.
   827                 88  HELP-FOR-GENERAL   VALUE ' '.
   828                 88  HELP-BY-SCREEN     VALUE 'S'.
   829                 88  HELP-BY-ERROR      VALUE 'E'.
   830             20  TX-SCREEN-OR-ERROR  PIC X(4).
   831                 88  GENERAL-INFO-HELP  VALUE '0000'.
   832             20  TX-HELP-FOR-COMPANY  PIC XXX.
   833                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   834             20  FILLER              PIC X(4).
   835
   836         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   837
   838     12  TX-PROCESS-CONTROL          PIC XX.
   839         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   840
   841     12  TX-TEXT-LINE                PIC X(70).
   842
   843     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   844         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   845         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   846         88  TX-VALID-FORM-SQUEEZE-VALUE
   847                                        VALUE 'Y' ' '.
   848
   849     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   850         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   851         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   852         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   853         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   854         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   855         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  17
* EL6318.cbl
   856         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   857                                              'K' 'N' ' '
   858                                              'Z'.
   859
   860     12  TX-ARCHIVE-SW               PIC X.
   861         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   862         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   863         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   864
   865     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   866     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   867
   868     12  TX-BSR-CODE                 PIC X.
   869         88  TX-BSR-LETTER              VALUE 'B'.
   870         88  TX-NON-BSR-LETTER          VALUE ' '.
   871
   872     12  FILLER                      PIC X.
   873*****************************************************************
   874*    COPY ELCLOGOF.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                            ELCLOGOF.                           *
   879*                            VMOD=2.001                          *
   880*                                                                *
   881*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   882*                                                                *
   883******************************************************************
   884 01  CLASIC-LOGOFF.
   885     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   886     12  LOGOFF-TEXT.
   887         16  FILLER          PIC X(5)    VALUE SPACES.
   888         16  LOGOFF-MSG.
   889             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   890             20  FILLER      PIC X       VALUE SPACES.
   891             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   892         16  FILLER          PIC X(80)
   893           VALUE '* YOU ARE NOW LOGGED OFF'.
   894         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   895         16  FILLER          PIC X       VALUE QUOTE.
   896         16  LOGOFF-SYS-MSG  PIC X(17)
   897           VALUE 'S CLAS-IC SYSTEM '.
   898     12  TEXT-MESSAGES.
   899         16  UNACCESS-MSG    PIC X(29)
   900             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   901         16  PGMIDERR-MSG    PIC X(17)
   902             VALUE 'PROGRAM NOT FOUND'.
   903*    COPY ELCATTR.
   904******************************************************************
   905*                                                                *
   906*                            ELCATTR.                            *
   907*                            VMOD=2.001                          *
   908*                                                                *
   909*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   910*                                                                *
   911*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   912*                                                                *
   913*                   POS 1   P=PROTECTED                          *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  18
* EL6318.cbl
   914*                           U=UNPROTECTED                        *
   915*                           S=ASKIP                              *
   916*                   POS 2   A=ALPHA/NUMERIC                      *
   917*                           N=NUMERIC                            *
   918*                   POS 3   N=NORMAL                             *
   919*                           B=BRIGHT                             *
   920*                           D=DARK                               *
   921*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   922*                           OF=MODIFIED DATA TAG OFF             *
   923*                                                                *
   924*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   925******************************************************************
   926 01  ATTRIBUTE-LIST.
   927     12  AL-PABOF            PIC X       VALUE 'Y'.
   928     12  AL-PABON            PIC X       VALUE 'Z'.
   929     12  AL-PADOF            PIC X       VALUE '%'.
   930     12  AL-PADON            PIC X       VALUE '_'.
   931     12  AL-PANOF            PIC X       VALUE '-'.
   932     12  AL-PANON            PIC X       VALUE '/'.
   933     12  AL-SABOF            PIC X       VALUE '8'.
   934     12  AL-SABON            PIC X       VALUE '9'.
   935     12  AL-SADOF            PIC X       VALUE '@'.
   936     12  AL-SADON            PIC X       VALUE QUOTE.
   937     12  AL-SANOF            PIC X       VALUE '0'.
   938     12  AL-SANON            PIC X       VALUE '1'.
   939     12  AL-UABOF            PIC X       VALUE 'H'.
   940     12  AL-UABON            PIC X       VALUE 'I'.
   941     12  AL-UADOF            PIC X       VALUE '<'.
   942     12  AL-UADON            PIC X       VALUE '('.
   943     12  AL-UANOF            PIC X       VALUE ' '.
   944     12  AL-UANON            PIC X       VALUE 'A'.
   945     12  AL-UNBOF            PIC X       VALUE 'Q'.
   946     12  AL-UNBON            PIC X       VALUE 'R'.
   947     12  AL-UNDOF            PIC X       VALUE '*'.
   948     12  AL-UNDON            PIC X       VALUE ')'.
   949     12  AL-UNNOF            PIC X       VALUE '&'.
   950     12  AL-UNNON            PIC X       VALUE 'J'.
   951*    COPY ELCEMIB.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ELCEMIB.                            *
   956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   957*                            VMOD=2.005                          *
   958*                                                                *
   959*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   960*                                                                *
   961******************************************************************
   962 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   963     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   964     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   965     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   966     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   967     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   968     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   969     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   970     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   971     12  EMI-SWITCH1             PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  19
* EL6318.cbl
   972         88  EMI-NO-ERRORS                    VALUE '1'.
   973         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   974         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   975     12  EMI-SWITCH2             PIC X        VALUE '1'.
   976         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   977     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   978         88  EMI-AREA1-EMPTY                  VALUE '1'.
   979         88  EMI-AREA1-FULL                   VALUE '2'.
   980     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   981         88  EMI-AREA2-EMPTY                  VALUE '1'.
   982         88  EMI-AREA2-FULL                   VALUE '2'.
   983     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   984         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   985         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   986         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   987         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   988         88  EMI-BYPASS-FATALS                VALUE 'X'.
   989     12  EMI-ERROR-LINES.
   990         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   991         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   992         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   993         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   994             20  EMI-ERR-CODES OCCURS 10 TIMES.
   995                 24  EMI-ERR-NUM         PIC X(4).
   996                 24  EMI-FILLER          PIC X.
   997                 24  EMI-SEV             PIC X.
   998                 24  FILLER              PIC X.
   999             20  FILLER                  PIC X(02).
  1000     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1001         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1002             20  EMI-ERROR-NUMBER    PIC X(4).
  1003             20  EMI-FILL            PIC X.
  1004             20  EMI-SEVERITY        PIC X.
  1005             20  FILLER              PIC X.
  1006             20  EMI-ERROR-TEXT.
  1007                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1008                 24  FILLER          PIC X(55).
  1009     12  EMI-SEVERITY-SAVE           PIC X.
  1010         88  EMI-NOTE                    VALUE 'N'.
  1011         88  EMI-WARNING                 VALUE 'W'.
  1012         88  EMI-FORCABLE                VALUE 'F'.
  1013         88  EMI-FATAL                   VALUE 'X'.
  1014     12  EMI-MESSAGE-FLAG            PIC X.
  1015         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1016         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1017     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1018     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1019         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1020         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1021         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1022     12  emi-claim-no                pic x(7).
  1023     12  emi-claim-type              pic x(6).
  1024     12  FILLER                      PIC X(124)  VALUE SPACES.
  1025     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1026     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1027     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1028     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1029*    COPY ELCINTF.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  20
* EL6318.cbl
  1030******************************************************************
  1031*                                                                *
  1032*                                                                *
  1033*                            ELCINTF.                            *
  1034*                            VMOD=2.017                          *
  1035*                                                                *
  1036*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1037*                                                                *
  1038*       LENGTH = 1024                                            *
  1039*                                                                *
  1040******************************************************************
  1041*                   C H A N G E   L O G
  1042*
  1043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1044*-----------------------------------------------------------------
  1045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1046* EFFECTIVE    NUMBER
  1047*-----------------------------------------------------------------
  1048* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1049******************************************************************
  1050 01  PROGRAM-INTERFACE-BLOCK.
  1051     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1052     12  PI-CALLING-PROGRAM              PIC X(8).
  1053     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1054     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1055     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1056     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1057     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1058     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1059     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1060     12  PI-COMPANY-ID                   PIC XXX.
  1061     12  PI-COMPANY-CD                   PIC X.
  1062
  1063     12  PI-COMPANY-PASSWORD             PIC X(8).
  1064
  1065     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1066
  1067     12  PI-CONTROL-IN-PROGRESS.
  1068         16  PI-CARRIER                  PIC X.
  1069         16  PI-GROUPING                 PIC X(6).
  1070         16  PI-STATE                    PIC XX.
  1071         16  PI-ACCOUNT                  PIC X(10).
  1072         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1073                                         PIC X(10).
  1074         16  PI-CLAIM-CERT-GRP.
  1075             20  PI-CLAIM-NO             PIC X(7).
  1076             20  PI-CERT-NO.
  1077                 25  PI-CERT-PRIME       PIC X(10).
  1078                 25  PI-CERT-SFX         PIC X.
  1079             20  PI-CERT-EFF-DT          PIC XX.
  1080         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1081             20  PI-PLAN-CODE            PIC X(2).
  1082             20  PI-REVISION-NUMBER      PIC X(3).
  1083             20  PI-PLAN-EFF-DT          PIC X(2).
  1084             20  PI-PLAN-EXP-DT          PIC X(2).
  1085             20  FILLER                  PIC X(11).
  1086         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1087             20  PI-OE-REFERENCE-1.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  21
* EL6318.cbl
  1088                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1089                 25  PI-OE-REF-1-SUFF    PIC XX.
  1090
  1091     12  PI-SESSION-IN-PROGRESS          PIC X.
  1092         88  CLAIM-SESSION                   VALUE '1'.
  1093         88  CREDIT-SESSION                  VALUE '2'.
  1094         88  WARRANTY-SESSION                VALUE '3'.
  1095         88  MORTGAGE-SESSION                VALUE '4'.
  1096         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1097
  1098
  1099*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1100
  1101     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1102     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1103
  1104     12  PI-CREDIT-USER                  PIC X.
  1105         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1106         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1107
  1108     12  PI-CLAIM-USER                   PIC X.
  1109         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1110         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1111
  1112     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1113         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1114         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1115         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1116         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1117         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1118
  1119     12  PI-PROCESSOR-ID                 PIC X(4).
  1120
  1121     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1122
  1123     12  PI-MEMBER-CAPTION               PIC X(10).
  1124
  1125     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1126         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1127
  1128     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1129     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1130     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1131     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1132
  1133     12  PI-AH-OVERRIDE-L1               PIC X.
  1134     12  PI-AH-OVERRIDE-L2               PIC XX.
  1135     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1136     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1137
  1138     12  PI-NEW-SYSTEM                   PIC X(2).
  1139
  1140     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1141     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1142         88  PI-USES-PAID-TO                 VALUE '1'.
  1143     12  PI-CRDTCRD-SYSTEM.
  1144         16  PI-CRDTCRD-USER             PIC X.
  1145             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  22
* EL6318.cbl
  1146             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1147         16  PI-CC-MONTH-END-DT          PIC XX.
  1148     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1149
  1150     12  PI-OE-REFERENCE-2.
  1151         16  PI-OE-REF-2-PRIME           PIC X(10).
  1152         16  PI-OE-REF-2-SUFF            PIC X.
  1153
  1154     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1155
  1156     12  PI-LANGUAGE-TYPE                PIC X.
  1157             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1158             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1159             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1160
  1161     12  PI-POLICY-LINKAGE-IND           PIC X.
  1162         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1163         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1164                                                   LOW-VALUES.
  1165
  1166     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1167     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1168         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1169         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1170
  1171     12  PI-PROCESSOR-CSR-IND            PIC X.
  1172         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1173         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1174
  1175     12  FILLER                          PIC X(3).
  1176
  1177     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1178
  1179     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1180         PI-SYSTEM-LEVEL.
  1181
  1182         16  PI-ENTRY-CODES.
  1183             20  PI-ENTRY-CD-1           PIC X.
  1184             20  PI-ENTRY-CD-2           PIC X.
  1185
  1186         16  PI-RETURN-CODES.
  1187             20  PI-RETURN-CD-1          PIC X.
  1188             20  PI-RETURN-CD-2          PIC X.
  1189
  1190         16  PI-UPDATE-STATUS-SAVE.
  1191             20  PI-UPDATE-BY            PIC X(4).
  1192             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1193
  1194         16  PI-LOWER-CASE-LETTERS       PIC X.
  1195             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1196
  1197*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1198*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1199*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1200
  1201         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1202             88  ST-ACCNT-CNTL               VALUE ' '.
  1203             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  23
* EL6318.cbl
  1204             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1205             88  ACCNT-CNTL                  VALUE '3'.
  1206             88  CARR-ACCNT-CNTL             VALUE '4'.
  1207
  1208         16  PI-PROCESSOR-CAP-LIST.
  1209             20  PI-SYSTEM-CONTROLS.
  1210                24 PI-SYSTEM-DISPLAY     PIC X.
  1211                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1212                24 PI-SYSTEM-MODIFY      PIC X.
  1213                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1214             20  FILLER                  PIC XX.
  1215             20  PI-DISPLAY-CAP          PIC X.
  1216                 88  DISPLAY-CAP             VALUE 'Y'.
  1217             20  PI-MODIFY-CAP           PIC X.
  1218                 88  MODIFY-CAP              VALUE 'Y'.
  1219             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1220                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1221             20  PI-FORCE-CAP            PIC X.
  1222                 88  FORCE-CAP               VALUE 'Y'.
  1223
  1224         16  PI-PROGRAM-CONTROLS.
  1225             20  PI-PGM-PRINT-OPT        PIC X.
  1226             20  PI-PGM-FORMAT-OPT       PIC X.
  1227             20  PI-PGM-PROCESS-OPT      PIC X.
  1228             20  PI-PGM-TOTALS-OPT       PIC X.
  1229
  1230         16  PI-HELP-INTERFACE.
  1231             20  PI-LAST-ERROR-NO        PIC X(4).
  1232             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1233
  1234         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1235             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1236
  1237         16  PI-CR-CONTROL-IN-PROGRESS.
  1238             20  PI-CR-CARRIER           PIC X.
  1239             20  PI-CR-GROUPING          PIC X(6).
  1240             20  PI-CR-STATE             PIC XX.
  1241             20  PI-CR-ACCOUNT           PIC X(10).
  1242             20  PI-CR-FIN-RESP          PIC X(10).
  1243             20  PI-CR-TYPE              PIC X.
  1244
  1245         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1246
  1247         16  PI-CR-MONTH-END-DT          PIC XX.
  1248
  1249         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1250             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1251             88  PI-ZERO-CARRIER             VALUE '1'.
  1252             88  PI-ZERO-GROUPING            VALUE '2'.
  1253             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1254
  1255         16  PI-CARRIER-SECURITY         PIC X.
  1256             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1257
  1258         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1259             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1260             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1261
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  24
* EL6318.cbl
  1262         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1263             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1264                                         INDEXED BY PI-ACCESS-NDX
  1265                                         PIC X.
  1266
  1267         16  PI-GA-BILLING-CONTROL       PIC X.
  1268             88  PI-GA-BILLING               VALUE '1'.
  1269
  1270         16  PI-MAIL-PROCESSING          PIC X.
  1271             88  PI-MAIL-YES                 VALUE 'Y'.
  1272
  1273         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1274
  1275         16  PI-AR-SYSTEM.
  1276             20  PI-AR-PROCESSING-CNTL   PIC X.
  1277                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1278             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1279             20  PI-AR-MONTH-END-DT      PIC XX.
  1280
  1281         16  PI-MP-SYSTEM.
  1282             20  PI-MORTGAGE-USER            PIC X.
  1283                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1284                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1285             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1286                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1287                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1288                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1289                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1290                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1291             20  PI-MP-MONTH-END-DT          PIC XX.
  1292             20  PI-MP-REFERENCE-NO.
  1293                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1294                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1295
  1296         16  PI-LABEL-CONTROL            PIC X(01).
  1297             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1298             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1299
  1300         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1301             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1302
  1303         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1304             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1305             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1306
  1307         16  FILLER                      PIC X(14).
  1308
  1309     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1310******************************************************************
  1311     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1312        16  PI-ISS-CAN-SW           PIC X.
  1313        16  PI-ERENDT-KEY.
  1314            20  PI-ENDT-COMPANY-CD  PIC X.
  1315            20  PI-ENDT-CARRIER     PIC X.
  1316            20  PI-ENDT-GROUPING    PIC X(6).
  1317            20  PI-ENDT-STATE       PIC XX.
  1318            20  PI-ENDT-ACCOUNT     PIC X(10).
  1319            20  PI-ENDT-CERT-EFF-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  25
* EL6318.cbl
  1320            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1321            20  PI-ENDT-CERT-SFX    PIC X.
  1322            20  PI-ENDT-RECORD-TYPE PIC X.
  1323            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1324        16  PI-ELCRTO-KEY.
  1325            20  PI-CRTO-COMPANY-CD  PIC X.
  1326            20  PI-CRTO-CARRIER     PIC X.
  1327            20  PI-CRTO-GROUPING    PIC X(6).
  1328            20  PI-CRTO-STATE       PIC XX.
  1329            20  PI-CRTO-ACCOUNT     PIC X(10).
  1330            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1331            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1332            20  PI-CRTO-CERT-SFX    PIC X.
  1333            20  PI-CRTO-RECORD-TYPE PIC X.
  1334            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1335        16  PI-ERPNDB-KEY           PIC X(11).
  1336        16  PI-DOCUMENT-PROCESSED   PIC X.
  1337            88  PI-VERI-PROCESSED      VALUE 'V'.
  1338            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1339        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1340        16  PI-RES-REF-CLM-TYPE     PIC X.
  1341        16  PI-CLM-REFORM-IND       PIC X.
  1342            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1343        16  PI-CLEAR-ERROR-SW       PIC X.
  1344            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1345        16  PI-PRINT-CERTIFICATE    PIC X.
  1346        16  PI-ENTERED.
  1347            20  PI-PRTSW-ENTERED    PIC X.
  1348            20  PI-SIGREQ-ENTERED   PIC X.
  1349            20  PI-MONEY-ENTERED    PIC X.
  1350            20  PI-LTRID-ENTERED    PIC X(4).
  1351            20  PI-VOUCHER-ENTERED  PIC X.
  1352            20  PI-HLTHAPP-ENTERED  PIC X.
  1353            20  PI-PAYEE-ENTERED    PIC X(10).
  1354            20  PI-CERTID-ENTERED   PIC X(5).
  1355            20  PI-REASONS-ENTERED  PIC X(84).
  1356            20  PI-CERTNT1-ENTERED  PIC X(63).
  1357            20  PI-CERTNT2-ENTERED  PIC X(63).
  1358        16  PI-FINALIZED-IND        PIC X.
  1359        16  PI-CERTNT3-ENTERED      PIC X(63).
  1360        16  PI-CERTNT4-ENTERED      PIC X(63).
  1361        16  PI-BILLNT1-ENTERED      PIC X(63).
  1362        16  PI-BILLNT2-ENTERED      PIC X(63).
  1363        16  PI-REASON-CODE-IND      PIC X(26).
  1364        16  FILLER                  PIC X(2).
  1365    12  FILLER                      PIC X(276).
  1366*    COPY ELCAID.
  1367******************************************************************
  1368*                                                                *
  1369*                            ELCAID.                             *
  1370*                            VMOD=2.001                          *
  1371*                                                                *
  1372*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1373*                                                                *
  1374*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1375*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1376******************************************************************
  1377
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  26
* EL6318.cbl
  1378 01  DFHAID.
  1379   02  DFHNULL   PIC  X  VALUE  ' '.
  1380   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1381   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1382   02  DFHPEN    PIC  X  VALUE  '='.
  1383   02  DFHOPID   PIC  X  VALUE  'W'.
  1384   02  DFHPA1    PIC  X  VALUE  '%'.
  1385   02  DFHPA2    PIC  X  VALUE  '>'.
  1386   02  DFHPA3    PIC  X  VALUE  ','.
  1387   02  DFHPF1    PIC  X  VALUE  '1'.
  1388   02  DFHPF2    PIC  X  VALUE  '2'.
  1389   02  DFHPF3    PIC  X  VALUE  '3'.
  1390   02  DFHPF4    PIC  X  VALUE  '4'.
  1391   02  DFHPF5    PIC  X  VALUE  '5'.
  1392   02  DFHPF6    PIC  X  VALUE  '6'.
  1393   02  DFHPF7    PIC  X  VALUE  '7'.
  1394   02  DFHPF8    PIC  X  VALUE  '8'.
  1395   02  DFHPF9    PIC  X  VALUE  '9'.
  1396   02  DFHPF10   PIC  X  VALUE  ':'.
  1397   02  DFHPF11   PIC  X  VALUE  '#'.
  1398   02  DFHPF12   PIC  X  VALUE  '@'.
  1399   02  DFHPF13   PIC  X  VALUE  'A'.
  1400   02  DFHPF14   PIC  X  VALUE  'B'.
  1401   02  DFHPF15   PIC  X  VALUE  'C'.
  1402   02  DFHPF16   PIC  X  VALUE  'D'.
  1403   02  DFHPF17   PIC  X  VALUE  'E'.
  1404   02  DFHPF18   PIC  X  VALUE  'F'.
  1405   02  DFHPF19   PIC  X  VALUE  'G'.
  1406   02  DFHPF20   PIC  X  VALUE  'H'.
  1407   02  DFHPF21   PIC  X  VALUE  'I'.
  1408*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1409   02  DFHPF22   PIC  X  VALUE  '['.
  1410   02  DFHPF23   PIC  X  VALUE  '.'.
  1411   02  DFHPF24   PIC  X  VALUE  '<'.
  1412   02  DFHMSRE   PIC  X  VALUE  'X'.
  1413   02  DFHSTRF   PIC  X  VALUE  'h'.
  1414   02  DFHTRIG   PIC  X  VALUE  '"'.
  1415 01  FILLER    REDEFINES DFHAID.
  1416     12  FILLER              PIC X(8).
  1417     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1418     12  FILLER              PIC X(3).
  1419*   COPY EL6318S.
  1420 01  EL631KI.
  1421     05  FILLER            PIC  X(0012).
  1422*    -------------------------------
  1423     05  DATEL PIC S9(0004) COMP.
  1424     05  DATEF PIC  X(0001).
  1425     05  FILLER REDEFINES DATEF.
  1426         10  DATEA PIC  X(0001).
  1427     05  DATEI PIC  X(0008).
  1428*    -------------------------------
  1429     05  TIMEL PIC S9(0004) COMP.
  1430     05  TIMEF PIC  X(0001).
  1431     05  FILLER REDEFINES TIMEF.
  1432         10  TIMEA PIC  X(0001).
  1433     05  TIMEI PIC  X(0005).
  1434*    -------------------------------
  1435     05  PROCIDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  27
* EL6318.cbl
  1436     05  PROCIDF PIC  X(0001).
  1437     05  FILLER REDEFINES PROCIDF.
  1438         10  PROCIDA PIC  X(0001).
  1439     05  PROCIDI PIC  X(0004).
  1440*    -------------------------------
  1441     05  HOSTL PIC S9(0004) COMP.
  1442     05  HOSTF PIC  X(0001).
  1443     05  FILLER REDEFINES HOSTF.
  1444         10  HOSTA PIC  X(0001).
  1445     05  HOSTI PIC  X(0009).
  1446*    -------------------------------
  1447     05  SYSL PIC S9(0004) COMP.
  1448     05  SYSF PIC  X(0001).
  1449     05  FILLER REDEFINES SYSF.
  1450         10  SYSA PIC  X(0001).
  1451     05  SYSI PIC  X(0005).
  1452*    -------------------------------
  1453     05  COMPANYL PIC S9(0004) COMP.
  1454     05  COMPANYF PIC  X(0001).
  1455     05  FILLER REDEFINES COMPANYF.
  1456         10  COMPANYA PIC  X(0001).
  1457     05  COMPANYI PIC  X(0003).
  1458*    -------------------------------
  1459     05  DATASORL PIC S9(0004) COMP.
  1460     05  DATASORF PIC  X(0001).
  1461     05  FILLER REDEFINES DATASORF.
  1462         10  DATASORA PIC  X(0001).
  1463     05  DATASORI PIC  X(0001).
  1464*    -------------------------------
  1465     05  BATCHNOL PIC S9(0004) COMP.
  1466     05  BATCHNOF PIC  X(0001).
  1467     05  FILLER REDEFINES BATCHNOF.
  1468         10  BATCHNOA PIC  X(0001).
  1469     05  BATCHNOI PIC  X(0006).
  1470*    -------------------------------
  1471     05  BSEQNOL PIC S9(0004) COMP.
  1472     05  BSEQNOF PIC  X(0001).
  1473     05  FILLER REDEFINES BSEQNOF.
  1474         10  BSEQNOA PIC  X(0001).
  1475     05  BSEQNOI PIC  X(0008).
  1476*    -------------------------------
  1477     05  ARCHNOL PIC S9(0004) COMP.
  1478     05  ARCHNOF PIC  X(0001).
  1479     05  FILLER REDEFINES ARCHNOF.
  1480         10  ARCHNOA PIC  X(0001).
  1481     05  ARCHNOI PIC  X(0008).
  1482*    -------------------------------
  1483     05  PRTSWL PIC S9(0004) COMP.
  1484     05  PRTSWF PIC  X(0001).
  1485     05  FILLER REDEFINES PRTSWF.
  1486         10  PRTSWA PIC  X(0001).
  1487     05  PRTSWI PIC  X(0001).
  1488*    -------------------------------
  1489     05  CARRL PIC S9(0004) COMP.
  1490     05  CARRF PIC  X(0001).
  1491     05  FILLER REDEFINES CARRF.
  1492         10  CARRA PIC  X(0001).
  1493     05  CARRI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  28
* EL6318.cbl
  1494*    -------------------------------
  1495     05  GROUPL PIC S9(0004) COMP.
  1496     05  GROUPF PIC  X(0001).
  1497     05  FILLER REDEFINES GROUPF.
  1498         10  GROUPA PIC  X(0001).
  1499     05  GROUPI PIC  X(0006).
  1500*    -------------------------------
  1501     05  STATEL PIC S9(0004) COMP.
  1502     05  STATEF PIC  X(0001).
  1503     05  FILLER REDEFINES STATEF.
  1504         10  STATEA PIC  X(0001).
  1505     05  STATEI PIC  X(0002).
  1506*    -------------------------------
  1507     05  ACCTL PIC S9(0004) COMP.
  1508     05  ACCTF PIC  X(0001).
  1509     05  FILLER REDEFINES ACCTF.
  1510         10  ACCTA PIC  X(0001).
  1511     05  ACCTI PIC  X(0010).
  1512*    -------------------------------
  1513     05  EFFDTL PIC S9(0004) COMP.
  1514     05  EFFDTF PIC  X(0001).
  1515     05  FILLER REDEFINES EFFDTF.
  1516         10  EFFDTA PIC  X(0001).
  1517     05  EFFDTI PIC  X(0008).
  1518*    -------------------------------
  1519     05  CERTNOL PIC S9(0004) COMP.
  1520     05  CERTNOF PIC  X(0001).
  1521     05  FILLER REDEFINES CERTNOF.
  1522         10  CERTNOA PIC  X(0001).
  1523     05  CERTNOI PIC  X(0010).
  1524*    -------------------------------
  1525     05  CRTSFXL PIC S9(0004) COMP.
  1526     05  CRTSFXF PIC  X(0001).
  1527     05  FILLER REDEFINES CRTSFXF.
  1528         10  CRTSFXA PIC  X(0001).
  1529     05  CRTSFXI PIC  X(0001).
  1530*    -------------------------------
  1531     05  SEQNOL PIC S9(0004) COMP.
  1532     05  SEQNOF PIC  X(0001).
  1533     05  FILLER REDEFINES SEQNOF.
  1534         10  SEQNOA PIC  X(0001).
  1535     05  SEQNOI PIC  X(0006).
  1536*    -------------------------------
  1537     05  SIGREQL PIC S9(0004) COMP.
  1538     05  SIGREQF PIC  X(0001).
  1539     05  FILLER REDEFINES SIGREQF.
  1540         10  SIGREQA PIC  X(0001).
  1541     05  SIGREQI PIC  X(0001).
  1542*    -------------------------------
  1543     05  LTRIDL PIC S9(0004) COMP.
  1544     05  LTRIDF PIC  X(0001).
  1545     05  FILLER REDEFINES LTRIDF.
  1546         10  LTRIDA PIC  X(0001).
  1547     05  LTRIDI PIC  X(0004).
  1548*    -------------------------------
  1549     05  HLTHAPPL PIC S9(0004) COMP.
  1550     05  HLTHAPPF PIC  X(0001).
  1551     05  FILLER REDEFINES HLTHAPPF.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  29
* EL6318.cbl
  1552         10  HLTHAPPA PIC  X(0001).
  1553     05  HLTHAPPI PIC  X(0001).
  1554*    -------------------------------
  1555     05  VOUCHL PIC S9(0004) COMP.
  1556     05  VOUCHF PIC  X(0001).
  1557     05  FILLER REDEFINES VOUCHF.
  1558         10  VOUCHA PIC  X(0001).
  1559     05  VOUCHI PIC  X(0001).
  1560*    -------------------------------
  1561     05  PAYEEL PIC S9(0004) COMP.
  1562     05  PAYEEF PIC  X(0001).
  1563     05  FILLER REDEFINES PAYEEF.
  1564         10  PAYEEA PIC  X(0001).
  1565     05  PAYEEI PIC  X(0010).
  1566*    -------------------------------
  1567     05  CERTIDL PIC S9(0004) COMP.
  1568     05  CERTIDF PIC  X(0001).
  1569     05  FILLER REDEFINES CERTIDF.
  1570         10  CERTIDA PIC  X(0001).
  1571     05  CERTIDI PIC  X(0005).
  1572*    -------------------------------
  1573     05  RCD01L PIC S9(0004) COMP.
  1574     05  RCD01F PIC  X(0001).
  1575     05  FILLER REDEFINES RCD01F.
  1576         10  RCD01A PIC  X(0001).
  1577     05  RCD01I PIC  X(0004).
  1578*    -------------------------------
  1579     05  RCD02L PIC S9(0004) COMP.
  1580     05  RCD02F PIC  X(0001).
  1581     05  FILLER REDEFINES RCD02F.
  1582         10  RCD02A PIC  X(0001).
  1583     05  RCD02I PIC  X(0004).
  1584*    -------------------------------
  1585     05  RCD03L PIC S9(0004) COMP.
  1586     05  RCD03F PIC  X(0001).
  1587     05  FILLER REDEFINES RCD03F.
  1588         10  RCD03A PIC  X(0001).
  1589     05  RCD03I PIC  X(0004).
  1590*    -------------------------------
  1591     05  RCD04L PIC S9(0004) COMP.
  1592     05  RCD04F PIC  X(0001).
  1593     05  FILLER REDEFINES RCD04F.
  1594         10  RCD04A PIC  X(0001).
  1595     05  RCD04I PIC  X(0004).
  1596*    -------------------------------
  1597     05  RCD05L PIC S9(0004) COMP.
  1598     05  RCD05F PIC  X(0001).
  1599     05  FILLER REDEFINES RCD05F.
  1600         10  RCD05A PIC  X(0001).
  1601     05  RCD05I PIC  X(0004).
  1602*    -------------------------------
  1603     05  RCD06L PIC S9(0004) COMP.
  1604     05  RCD06F PIC  X(0001).
  1605     05  FILLER REDEFINES RCD06F.
  1606         10  RCD06A PIC  X(0001).
  1607     05  RCD06I PIC  X(0004).
  1608*    -------------------------------
  1609     05  RCD07L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  30
* EL6318.cbl
  1610     05  RCD07F PIC  X(0001).
  1611     05  FILLER REDEFINES RCD07F.
  1612         10  RCD07A PIC  X(0001).
  1613     05  RCD07I PIC  X(0004).
  1614*    -------------------------------
  1615     05  RCD08L PIC S9(0004) COMP.
  1616     05  RCD08F PIC  X(0001).
  1617     05  FILLER REDEFINES RCD08F.
  1618         10  RCD08A PIC  X(0001).
  1619     05  RCD08I PIC  X(0004).
  1620*    -------------------------------
  1621     05  RCD09L PIC S9(0004) COMP.
  1622     05  RCD09F PIC  X(0001).
  1623     05  FILLER REDEFINES RCD09F.
  1624         10  RCD09A PIC  X(0001).
  1625     05  RCD09I PIC  X(0004).
  1626*    -------------------------------
  1627     05  RCD10L PIC S9(0004) COMP.
  1628     05  RCD10F PIC  X(0001).
  1629     05  FILLER REDEFINES RCD10F.
  1630         10  RCD10A PIC  X(0001).
  1631     05  RCD10I PIC  X(0004).
  1632*    -------------------------------
  1633     05  RCD11L PIC S9(0004) COMP.
  1634     05  RCD11F PIC  X(0001).
  1635     05  FILLER REDEFINES RCD11F.
  1636         10  RCD11A PIC  X(0001).
  1637     05  RCD11I PIC  X(0004).
  1638*    -------------------------------
  1639     05  RCD12L PIC S9(0004) COMP.
  1640     05  RCD12F PIC  X(0001).
  1641     05  FILLER REDEFINES RCD12F.
  1642         10  RCD12A PIC  X(0001).
  1643     05  RCD12I PIC  X(0004).
  1644*    -------------------------------
  1645     05  CRTNT1L PIC S9(0004) COMP.
  1646     05  CRTNT1F PIC  X(0001).
  1647     05  FILLER REDEFINES CRTNT1F.
  1648         10  CRTNT1A PIC  X(0001).
  1649     05  CRTNT1I PIC  X(0063).
  1650*    -------------------------------
  1651     05  CRTNT2L PIC S9(0004) COMP.
  1652     05  CRTNT2F PIC  X(0001).
  1653     05  FILLER REDEFINES CRTNT2F.
  1654         10  CRTNT2A PIC  X(0001).
  1655     05  CRTNT2I PIC  X(0063).
  1656*    -------------------------------
  1657     05  CRTNT3L PIC S9(0004) COMP.
  1658     05  CRTNT3F PIC  X(0001).
  1659     05  FILLER REDEFINES CRTNT3F.
  1660         10  CRTNT3A PIC  X(0001).
  1661     05  CRTNT3I PIC  X(0063).
  1662*    -------------------------------
  1663     05  CRTNT4L PIC S9(0004) COMP.
  1664     05  CRTNT4F PIC  X(0001).
  1665     05  FILLER REDEFINES CRTNT4F.
  1666         10  CRTNT4A PIC  X(0001).
  1667     05  CRTNT4I PIC  X(0063).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  31
* EL6318.cbl
  1668*    -------------------------------
  1669     05  BILNT1L PIC S9(0004) COMP.
  1670     05  BILNT1F PIC  X(0001).
  1671     05  FILLER REDEFINES BILNT1F.
  1672         10  BILNT1A PIC  X(0001).
  1673     05  BILNT1I PIC  X(0063).
  1674*    -------------------------------
  1675     05  BILNT2L PIC S9(0004) COMP.
  1676     05  BILNT2F PIC  X(0001).
  1677     05  FILLER REDEFINES BILNT2F.
  1678         10  BILNT2A PIC  X(0001).
  1679     05  BILNT2I PIC  X(0063).
  1680*    -------------------------------
  1681     05  ERRMSG1L PIC S9(0004) COMP.
  1682     05  ERRMSG1F PIC  X(0001).
  1683     05  FILLER REDEFINES ERRMSG1F.
  1684         10  ERRMSG1A PIC  X(0001).
  1685     05  ERRMSG1I PIC  X(0075).
  1686*    -------------------------------
  1687     05  ERRMSG2L PIC S9(0004) COMP.
  1688     05  ERRMSG2F PIC  X(0001).
  1689     05  FILLER REDEFINES ERRMSG2F.
  1690         10  ERRMSG2A PIC  X(0001).
  1691     05  ERRMSG2I PIC  X(0075).
  1692*    -------------------------------
  1693     05  PFENTRL PIC S9(0004) COMP.
  1694     05  PFENTRF PIC  X(0001).
  1695     05  FILLER REDEFINES PFENTRF.
  1696         10  PFENTRA PIC  X(0001).
  1697     05  PFENTRI PIC  9(2).
  1698 01  EL631KO REDEFINES EL631KI.
  1699     05  FILLER            PIC  X(0012).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  DATEO PIC  X(0008).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  TIMEO PIC  99.99.
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  PROCIDO PIC  X(0004).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  HOSTO PIC  X(0009).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  SYSO PIC  X(0005).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  COMPANYO PIC  X(0003).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  DATASORO PIC  X(0001).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  BATCHNOO PIC  X(0006).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  32
* EL6318.cbl
  1726     05  BSEQNOO PIC  X(0008).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  ARCHNOO PIC  X(0008).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  PRTSWO PIC  X(0001).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  CARRO PIC  X(0001).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  GROUPO PIC  X(0006).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  STATEO PIC  X(0002).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  ACCTO PIC  X(0010).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  EFFDTO PIC  X(0008).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  CERTNOO PIC  X(0010).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  CRTSFXO PIC  X(0001).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  SEQNOO PIC  999999.
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  SIGREQO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  LTRIDO PIC  X(0004).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  HLTHAPPO PIC  X(0001).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  VOUCHO PIC  X(0001).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  PAYEEO PIC  X(0010).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  CERTIDO PIC  X(0005).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  RCD01O PIC  X(0004).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  RCD02O PIC  X(0004).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  RCD03O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  33
* EL6318.cbl
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  RCD04O PIC  X(0004).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  RCD05O PIC  X(0004).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  RCD06O PIC  X(0004).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  RCD07O PIC  X(0004).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  RCD08O PIC  X(0004).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  RCD09O PIC  X(0004).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  RCD10O PIC  X(0004).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  RCD11O PIC  X(0004).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  RCD12O PIC  X(0004).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  CRTNT1O PIC  X(0063).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  CRTNT2O PIC  X(0063).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  CRTNT3O PIC  X(0063).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  CRTNT4O PIC  X(0063).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  BILNT1O PIC  X(0063).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  BILNT2O PIC  X(0063).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  ERRMSG1O PIC  X(0075).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  ERRMSG2O PIC  X(0075).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  PFENTRO PIC  X(0002).
  1838*    -------------------------------
  1839 01  FILLER REDEFINES EL631KI.
  1840     12  FILLER             PIC X(211).
  1841     12  REASONCDS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  34
* EL6318.cbl
  1842         16  FILLER OCCURS 12.
  1843           20  REACDL       PIC S9(4) COMP.
  1844           20  REACDA       PIC X.
  1845           20  REACD-IN     PIC X(4).
  1846     12  FILLER             PIC X(293).
  1847****************************************************************
  1848*
  1849* Copyright (c) 2007 by Clerity Solutions, Inc.
  1850* All rights reserved.
  1851*
  1852****************************************************************
  1853 01  DFHEIV.
  1854   02  DFHEIV0               PIC X(35).
  1855   02  DFHEIV1               PIC X(08).
  1856   02  DFHEIV2               PIC X(08).
  1857   02  DFHEIV3               PIC X(08).
  1858   02  DFHEIV4               PIC X(06).
  1859   02  DFHEIV5               PIC X(04).
  1860   02  DFHEIV6               PIC X(04).
  1861   02  DFHEIV7               PIC X(02).
  1862   02  DFHEIV8               PIC X(02).
  1863   02  DFHEIV9               PIC X(01).
  1864   02  DFHEIV10              PIC S9(7) COMP-3.
  1865   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1866   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1867   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1868   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1869   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1870   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1871   02  DFHEIV17              PIC X(04).
  1872   02  DFHEIV18              PIC X(04).
  1873   02  DFHEIV19              PIC X(04).
  1874   02  DFHEIV20              USAGE IS POINTER.
  1875   02  DFHEIV21              USAGE IS POINTER.
  1876   02  DFHEIV22              USAGE IS POINTER.
  1877   02  DFHEIV23              USAGE IS POINTER.
  1878   02  DFHEIV24              USAGE IS POINTER.
  1879   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1880   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1881   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1882   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1883   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1884   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1885   02  FILLER                PIC X(02).
  1886   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1887   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1888   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1889   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1890   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1891 LINKAGE  SECTION.
  1892*****************************************************************
  1893*                                                               *
  1894* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1895* All rights reserved.                                          *
  1896*                                                               *
  1897*****************************************************************
  1898 01  dfheiblk.
  1899     02  eibtime          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  35
* EL6318.cbl
  1900     02  eibdate          pic s9(7) comp-3.
  1901     02  eibtrnid         pic x(4).
  1902     02  eibtaskn         pic s9(7) comp-3.
  1903     02  eibtrmid         pic x(4).
  1904     02  dfheigdi         pic s9(4) comp.
  1905     02  eibcposn         pic s9(4) comp.
  1906     02  eibcalen         pic s9(4) comp.
  1907     02  eibaid           pic x(1).
  1908     02  eibfiller1       pic x(1).
  1909     02  eibfn            pic x(2).
  1910     02  eibfiller2       pic x(2).
  1911     02  eibrcode         pic x(6).
  1912     02  eibfiller3       pic x(2).
  1913     02  eibds            pic x(8).
  1914     02  eibreqid         pic x(8).
  1915     02  eibrsrce         pic x(8).
  1916     02  eibsync          pic x(1).
  1917     02  eibfree          pic x(1).
  1918     02  eibrecv          pic x(1).
  1919     02  eibsend          pic x(1).
  1920     02  eibatt           pic x(1).
  1921     02  eibeoc           pic x(1).
  1922     02  eibfmh           pic x(1).
  1923     02  eibcompl         pic x(1).
  1924     02  eibsig           pic x(1).
  1925     02  eibconf          pic x(1).
  1926     02  eiberr           pic x(1).
  1927     02  eibrldbk         pic x(1).
  1928     02  eiberrcd         pic x(4).
  1929     02  eibsynrb         pic x(1).
  1930     02  eibnodat         pic x(1).
  1931     02  eibfiller5       pic x(2).
  1932     02  eibresp          pic 9(09) comp.
  1933     02  eibresp2         pic 9(09) comp.
  1934     02  dfheigdj         pic s9(4) comp.
  1935     02  dfheigdk         pic s9(4) comp.
  1936 01  DFHCOMMAREA                 PIC X(1300).
  1937 01  var  pic x(30).
  1938*                                COPY ERCACCT.
  1939******************************************************************
  1940*                                                                *
  1941*                                                                *
  1942*                            ERCACCT                             *
  1943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1944*                            VMOD=2.031                          *
  1945*                                                                *
  1946*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1947*                                                                *
  1948*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1949*   VSAM ACCOUNT MASTER FILES.                                   *
  1950*                                                                *
  1951*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1952*                                                                *
  1953*   FILE TYPE = VSAM,KSDS                                        *
  1954*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1955*                                                                *
  1956*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1957*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  36
* EL6318.cbl
  1958*                                                                *
  1959*   LOG = NO                                                     *
  1960*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1961*                                                                *
  1962*                                                                *
  1963******************************************************************
  1964*                   C H A N G E   L O G
  1965*
  1966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1967*-----------------------------------------------------------------
  1968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1969* EFFECTIVE    NUMBER
  1970*-----------------------------------------------------------------
  1971* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1972* 092705    2005050300006  PEMA  ADD SPP LEASES
  1973* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1974* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1975* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1976* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1977* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1978******************************************************************
  1979
  1980 01  ACCOUNT-MASTER.
  1981     12  AM-RECORD-ID                      PIC XX.
  1982         88  VALID-AM-ID                      VALUE 'AM'.
  1983
  1984     12  AM-CONTROL-PRIMARY.
  1985         16  AM-COMPANY-CD                 PIC X.
  1986         16  AM-MSTR-CNTRL.
  1987             20  AM-CONTROL-A.
  1988                 24  AM-CARRIER            PIC X.
  1989                 24  AM-GROUPING.
  1990                     28 AM-GROUPING-PREFIX PIC XXX.
  1991                     28 AM-GROUPING-PRIME  PIC XXX.
  1992                 24  AM-STATE              PIC XX.
  1993                 24  AM-ACCOUNT.
  1994                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1995                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1996             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1997                                           PIC X(19).
  1998             20  AM-CNTRL-B.
  1999                 24  AM-EXPIRATION-DT      PIC XX.
  2000                 24  FILLER                PIC X(4).
  2001             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2002                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2003
  2004     12  AM-CONTROL-BY-VAR-GRP.
  2005         16  AM-COMPANY-CD-A1              PIC X.
  2006         16  AM-VG-CARRIER                 PIC X.
  2007         16  AM-VG-GROUPING                PIC X(6).
  2008         16  AM-VG-STATE                   PIC XX.
  2009         16  AM-VG-ACCOUNT                 PIC X(10).
  2010         16  AM-VG-DATE.
  2011             20  AM-VG-EXPIRATION-DT       PIC XX.
  2012             20  FILLER                    PIC X(4).
  2013         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2014                                           PIC 9(11)      COMP-3.
  2015     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  37
* EL6318.cbl
  2016         16  FILLER                        PIC X(10).
  2017         16  AM-VG-KEY3.
  2018             20  AM-VG3-ACCOUNT            PIC X(10).
  2019             20  AM-VG3-EXP-DT             PIC XX.
  2020         16  FILLER                        PIC X(4).
  2021     12  AM-MAINT-INFORMATION.
  2022         16  AM-LAST-MAINT-DT              PIC XX.
  2023         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2024         16  AM-LAST-MAINT-USER            PIC X(4).
  2025         16  FILLER                        PIC XX.
  2026
  2027     12  AM-EFFECTIVE-DT                   PIC XX.
  2028     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2029
  2030     12  AM-PREV-DATES  COMP-3.
  2031         16  AM-PREV-EXP-DT                PIC 9(11).
  2032         16  AM-PREV-EFF-DT                PIC 9(11).
  2033
  2034     12  AM-REPORT-CODE-1                  PIC X(10).
  2035     12  AM-REPORT-CODE-2                  PIC X(10).
  2036
  2037     12  AM-CITY-CODE                      PIC X(4).
  2038     12  AM-COUNTY-PARISH                  PIC X(6).
  2039
  2040     12  AM-NAME                           PIC X(30).
  2041     12  AM-PERSON                         PIC X(30).
  2042     12  AM-ADDRS                          PIC X(30).
  2043     12  AM-CITY.
  2044         16  AM-ADDR-CITY                  PIC X(28).
  2045         16  AM-ADDR-STATE                 PIC XX.
  2046     12  AM-ZIP.
  2047         16  AM-ZIP-PRIME.
  2048             20  AM-ZIP-PRI-1ST            PIC X.
  2049                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2050             20  FILLER                    PIC X(4).
  2051         16  AM-ZIP-PLUS4                  PIC X(4).
  2052     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2053         16  AM-CAN-POSTAL-1               PIC XXX.
  2054         16  AM-CAN-POSTAL-2               PIC XXX.
  2055         16  FILLER                        PIC XXX.
  2056     12  AM-TEL-NO.
  2057         16  AM-AREA-CODE                  PIC 999.
  2058         16  AM-TEL-PRE                    PIC 999.
  2059         16  AM-TEL-NBR                    PIC 9(4).
  2060     12  AM-TEL-LOC                        PIC X.
  2061         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2062         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2063
  2064     12  AM-COMM-STRUCTURE.
  2065         16  AM-DEFN-1.
  2066             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2067                 24  AM-AGT.
  2068                     28  AM-AGT-PREFIX     PIC X(4).
  2069                     28  AM-AGT-PRIME      PIC X(6).
  2070                 24  AM-COM-TYP            PIC X.
  2071                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2072                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2073                 24  AM-A-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  38
* EL6318.cbl
  2074                 24  AM-RECALC-LV-INDIC    PIC X.
  2075                 24  AM-RETRO-LV-INDIC     PIC X.
  2076                 24  AM-GL-CODES           PIC X.
  2077                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2078                 24  FILLER                PIC X(01).
  2079         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2080             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2081                 24  FILLER                PIC X(11).
  2082                 24  AM-L-COMA             PIC XXX.
  2083                 24  AM-J-COMA             PIC XXX.
  2084                 24  AM-A-COMA             PIC XXX.
  2085                 24  FILLER                PIC X(6).
  2086
  2087     12  AM-COMM-CHANGE-STATUS             PIC X.
  2088         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2089
  2090     12  AM-CSR-CODE                       PIC X(4).
  2091
  2092     12  AM-BILLING-STATUS                 PIC X.
  2093         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2094         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2095     12  AM-AUTO-REFUND-SW                 PIC X.
  2096         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2097         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2098     12  AM-GPCD                           PIC 99.
  2099     12  AM-IG                             PIC X.
  2100         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2101         88  AM-HAS-GROUP                     VALUE '2'.
  2102     12  AM-STATUS                         PIC X.
  2103         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2104         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2105         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2106         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2107         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2108         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2109     12  AM-REMIT-TO                       PIC 99.
  2110     12  AM-ID-NO                          PIC X(11).
  2111
  2112     12  AM-CAL-TABLE                      PIC XX.
  2113     12  AM-LF-DEVIATION                   PIC XXX.
  2114     12  AM-AH-DEVIATION                   PIC XXX.
  2115     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2116     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2117     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2118     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2119     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2120     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2121
  2122     12  AM-USER-FIELDS.
  2123         16  AM-FLD-1                      PIC XX.
  2124         16  AM-FLD-2                      PIC XX.
  2125         16  AM-FLD-3                      PIC XX.
  2126         16  AM-FLD-4                      PIC XX.
  2127         16  AM-FLD-5                      PIC XX.
  2128
  2129     12  AM-1ST-PROD-DATE.
  2130         16  AM-1ST-PROD-YR                PIC XX.
  2131         16  AM-1ST-PROD-MO                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  39
* EL6318.cbl
  2132         16  AM-1ST-PROD-DA                PIC XX.
  2133     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2134     12  AM-CERTS-PURGED-DATE.
  2135         16  AM-PUR-YR                     PIC XX.
  2136         16  AM-PUR-MO                     PIC XX.
  2137         16  AM-PUR-DA                     PIC XX.
  2138     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2139     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2140     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2141     12  AM-INACTIVE-DATE.
  2142         16  AM-INA-MO                     PIC 99.
  2143         16  AM-INA-DA                     PIC 99.
  2144         16  AM-INA-YR                     PIC 99.
  2145     12  AM-AR-HI-CERT-DATE                PIC XX.
  2146
  2147     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2148     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2149
  2150     12  AM-OB-PAYMENT-MODE                PIC X.
  2151         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2152         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2153         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2154         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2155
  2156     12  AM-AH-ONLY-INDICATOR              PIC X.
  2157         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2158         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2159
  2160     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2161
  2162     12  AM-OVER-SHORT.
  2163         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2164         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2165
  2166     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2167     12  AM-DCC-CLP-STATE                  PIC XX.
  2168
  2169     12  AM-RECALC-COMM                    PIC X.
  2170     12  AM-RECALC-REIN                    PIC X.
  2171
  2172     12  AM-REI-TABLE                      PIC XXX.
  2173     12  AM-REI-ET-LF                      PIC X.
  2174     12  AM-REI-ET-AH                      PIC X.
  2175     12  AM-REI-PE-LF                      PIC X.
  2176     12  AM-REI-PE-AH                      PIC X.
  2177     12  AM-REI-PRT-ST                     PIC X.
  2178     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2179     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2180     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2181     12  AM-REI-GROUP-A                    PIC X(6).
  2182     12  AM-REI-MORT                       PIC X(4).
  2183     12  AM-REI-PRT-OW                     PIC X.
  2184     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2185     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2186     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2187     12  AM-REI-GROUP-B                    PIC X(6).
  2188
  2189     12  AM-TRUST-TYPE                     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  40
* EL6318.cbl
  2190
  2191     12  AM-EMPLOYER-STMT-USED             PIC X.
  2192     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2193
  2194     12  AM-STD-AH-TYPE                    PIC XX.
  2195     12  AM-EARN-METHODS.
  2196         16  AM-EARN-METHOD-R              PIC X.
  2197             88 AM-REF-RL-R78                 VALUE 'R'.
  2198             88 AM-REF-RL-PR                  VALUE 'P'.
  2199             88 AM-REF-RL-MEAN                VALUE 'M'.
  2200             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2201         16  AM-EARN-METHOD-L              PIC X.
  2202             88 AM-REF-LL-R78                 VALUE 'R'.
  2203             88 AM-REF-LL-PR                  VALUE 'P'.
  2204             88 AM-REF-LL-MEAN                VALUE 'M'.
  2205             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2206         16  AM-EARN-METHOD-A              PIC X.
  2207             88 AM-REF-AH-R78                 VALUE 'R'.
  2208             88 AM-REF-AH-PR                  VALUE 'P'.
  2209             88 AM-REF-AH-MEAN                VALUE 'M'.
  2210             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2211             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2212             88 AM-REF-AH-NET                 VALUE 'N'.
  2213
  2214     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2215     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2216     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2217
  2218     12  AM-RET-Y-N                        PIC X.
  2219     12  AM-RET-P-E                        PIC X.
  2220     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2221     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2222     12  AM-RET-GRP                        PIC X(6).
  2223     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2224         16  AM-POOL-PRIME                 PIC XXX.
  2225         16  AM-POOL-SUB                   PIC XXX.
  2226     12  AM-RETRO-EARNINGS.
  2227         16  AM-RET-EARN-R                 PIC X.
  2228         16  AM-RET-EARN-L                 PIC X.
  2229         16  AM-RET-EARN-A                 PIC X.
  2230     12  AM-RET-ST-TAX-USE                 PIC X.
  2231         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2232         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2233     12  AM-RETRO-BEG-EARNINGS.
  2234         16  AM-RET-BEG-EARN-R             PIC X.
  2235         16  AM-RET-BEG-EARN-L             PIC X.
  2236         16  AM-RET-BEG-EARN-A             PIC X.
  2237     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2238     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2239
  2240     12  AM-USER-SELECT-OPTIONS.
  2241         16  AM-USER-SELECT-1              PIC X(10).
  2242         16  AM-USER-SELECT-2              PIC X(10).
  2243         16  AM-USER-SELECT-3              PIC X(10).
  2244         16  AM-USER-SELECT-4              PIC X(10).
  2245         16  AM-USER-SELECT-5              PIC X(10).
  2246
  2247     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  41
* EL6318.cbl
  2248
  2249     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2250
  2251     12  AM-RPT045A-SWITCH                 PIC X.
  2252         88  RPT045A-OFF                   VALUE 'N'.
  2253
  2254     12  AM-INSURANCE-LIMITS.
  2255         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2256         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2257
  2258     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2259         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2260
  2261     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2262         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2263         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2264
  2265     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2266
  2267     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2268     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2269     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2270     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2271     12  AM-DCC-UEF-STATE                  PIC XX.
  2272     12  FILLER                            PIC XXX.
  2273     12  AM-REPORT-CODE-3                  PIC X(10).
  2274*    12  FILLER                            PIC X(22).
  2275
  2276     12  AM-RESERVE-DATE.
  2277         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2278         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2279         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2280
  2281     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2282     12  AM-NOTIFICATION-TYPES.
  2283         16  AM-NOTIF-OF-LETTERS           PIC X.
  2284         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2285         16  AM-NOTIF-OF-REPORTS           PIC X.
  2286         16  AM-NOTIF-OF-STATUS            PIC X.
  2287
  2288     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2289         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2290         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2291         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2292         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2293
  2294     12  AM-BENEFIT-CONTROLS.
  2295         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2296             20  AM-BENEFIT-CODE           PIC XX.
  2297             20  AM-BENEFIT-TYPE           PIC X.
  2298             20  AM-BENEFIT-REVISION       PIC XXX.
  2299             20  AM-BENEFIT-REM-TERM       PIC X.
  2300             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2301             20  FILLER                    PIC XX.
  2302         16  FILLER                        PIC X(80).
  2303
  2304     12  AM-TRANSFER-DATA.
  2305         16  AM-TRANSFERRED-FROM.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  42
* EL6318.cbl
  2306             20  AM-TRNFROM-CARRIER        PIC X.
  2307             20  AM-TRNFROM-GROUPING.
  2308                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2309                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2310             20  AM-TRNFROM-STATE          PIC XX.
  2311             20  AM-TRNFROM-ACCOUNT.
  2312                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2313                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2314             20  AM-TRNFROM-DTE            PIC XX.
  2315         16  AM-TRANSFERRED-TO.
  2316             20  AM-TRNTO-CARRIER          PIC X.
  2317             20  AM-TRNTO-GROUPING.
  2318                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2319                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2320             20  AM-TRNTO-STATE            PIC XX.
  2321             20  AM-TRNTO-ACCOUNT.
  2322                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2323                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2324             20  AM-TRNTO-DTE              PIC XX.
  2325         16  FILLER                        PIC X(10).
  2326
  2327     12  AM-SAVED-REMIT-TO                 PIC 99.
  2328
  2329     12  AM-COMM-STRUCTURE-SAVED.
  2330         16  AM-DEFN-1-SAVED.
  2331             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2332                 24  AM-AGT-SV             PIC X(10).
  2333                 24  AM-COM-TYP-SV         PIC X.
  2334                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2335                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2336                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2337                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2338                 24  FILLER                PIC X.
  2339                 24  AM-GL-CODES-SV        PIC X.
  2340                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2341                 24  FILLER                PIC X.
  2342         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2343             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2344                 24  FILLER                PIC X(11).
  2345                 24  AM-L-COMA-SV          PIC XXX.
  2346                 24  AM-J-COMA-SV          PIC XXX.
  2347                 24  AM-A-COMA-SV          PIC XXX.
  2348                 24  FILLER                PIC X(6).
  2349
  2350     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2351         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2352            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2353            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2354            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2355
  2356     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2357     12  FILLER                            PIC X(120).
  2358
  2359     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2360         16  AM-CONTROL-NAME               PIC X(30).
  2361         16  AM-EXECUTIVE-ONE.
  2362             20  AM-EXEC1-NAME             PIC X(15).
  2363             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  43
* EL6318.cbl
  2364                                                          COMP-3.
  2365             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2366                                                          COMP-3.
  2367         16  AM-EXECUTIVE-TWO.
  2368             20  AM-EXEC2-NAME             PIC X(15).
  2369             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2370                                                          COMP-3.
  2371             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2372                                                          COMP-3.
  2373
  2374     12  AM-RETRO-ADDITIONAL-DATA.
  2375         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2376         16  AM-RETRO-PREM-P-E             PIC X.
  2377         16  AM-RETRO-CLMS-P-I             PIC X.
  2378         16  AM-RETRO-RET-BRACKET-LF.
  2379             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2380                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2381                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2382             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2383                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2384                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2385             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2386                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2387                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2388         16  AM-RETRO-RET-BRACKET-AH.
  2389             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2390                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2391                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2392                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2393             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2394                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2395                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2396             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2397                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2398                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2399
  2400     12  AM-COMMENTS.
  2401         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2402
  2403     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2404         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2405         16  AM-FLI-BILLING-CODE           PIC X.
  2406         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2407         16  AM-FLI-UNITED-IDENT           PIC X.
  2408         16  AM-FLI-INTEREST-LOST-DATA.
  2409             20  AM-FLI-BANK-NO            PIC X(5).
  2410             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2411             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2412             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2413         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2414             20  AM-FLI-AGT                PIC X(9).
  2415             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2416             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2417         16  FILLER                        PIC X(102).
  2418
  2419     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2420         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2421             20  AM-BENEFIT-DMD-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  44
* EL6318.cbl
  2422             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2423             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2424             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2425             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2426         16  FILLER                          PIC X(10).
  2427******************************************************************
  2428*                                COPY ELCCNTL.
  2429******************************************************************
  2430*                                                                *
  2431*                                                                *
  2432*                            ELCCNTL.                            *
  2433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2434*                            VMOD=2.059                          *
  2435*                                                                *
  2436*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2437*                                                                *
  2438*   FILE TYPE = VSAM,KSDS                                        *
  2439*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2440*                                                                *
  2441*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2442*       ALTERNATE INDEX = NONE                                   *
  2443*                                                                *
  2444*   LOG = YES                                                    *
  2445*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2446******************************************************************
  2447*                   C H A N G E   L O G
  2448*
  2449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2450*-----------------------------------------------------------------
  2451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2452* EFFECTIVE    NUMBER
  2453*-----------------------------------------------------------------
  2454* 082503                   PEMA  ADD BENEFIT GROUP
  2455* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2456* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2457* 092705    2005050300006  PEMA  ADD SPP LEASES
  2458* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2459* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2460* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2461* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2462* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2463* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2464* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2465* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2466* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2467******************************************************************
  2468*
  2469 01  CONTROL-FILE.
  2470     12  CF-RECORD-ID                       PIC XX.
  2471         88  VALID-CF-ID                        VALUE 'CF'.
  2472
  2473     12  CF-CONTROL-PRIMARY.
  2474         16  CF-COMPANY-ID                  PIC XXX.
  2475         16  CF-RECORD-TYPE                 PIC X.
  2476             88  CF-COMPANY-MASTER              VALUE '1'.
  2477             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2478             88  CF-STATE-MASTER                VALUE '3'.
  2479             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  45
* EL6318.cbl
  2480             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2481             88  CF-CARRIER-MASTER              VALUE '6'.
  2482             88  CF-MORTALITY-MASTER            VALUE '7'.
  2483             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2484             88  CF-TERMINAL-MASTER             VALUE '9'.
  2485             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2486             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2487             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2488             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2489             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2490             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2491             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2492             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2493             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2494         16  CF-ACCESS-CD-GENL              PIC X(4).
  2495         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2496             20  CF-PROCESSOR               PIC X(4).
  2497         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2498             20  CF-STATE-CODE              PIC XX.
  2499             20  FILLER                     PIC XX.
  2500         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2501             20  FILLER                     PIC XX.
  2502             20  CF-HI-BEN-IN-REC           PIC XX.
  2503         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2504             20  FILLER                     PIC XXX.
  2505             20  CF-CARRIER-CNTL            PIC X.
  2506         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2507             20  FILLER                     PIC XX.
  2508             20  CF-HI-TYPE-IN-REC          PIC 99.
  2509         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2510             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2511                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2512             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2513             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2514         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2515             20  FILLER                     PIC X.
  2516             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2517         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2518             20  FILLER                     PIC XX.
  2519             20  CF-MORTGAGE-PLAN           PIC XX.
  2520         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2521
  2522     12  CF-LAST-MAINT-DT                   PIC XX.
  2523     12  CF-LAST-MAINT-BY                   PIC X(4).
  2524     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2525
  2526     12  CF-RECORD-BODY                     PIC X(728).
  2527
  2528
  2529****************************************************************
  2530*             COMPANY MASTER RECORD                            *
  2531****************************************************************
  2532
  2533     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2534         16  CF-COMPANY-ADDRESS.
  2535             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2536             20  CF-CL-IN-CARE-OF           PIC X(30).
  2537             20  CF-CL-ADDR-LINE-1          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  46
* EL6318.cbl
  2538             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2539             20  CF-CL-CITY-STATE           PIC X(30).
  2540             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2541             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2542         16  CF-COMPANY-CD                  PIC X.
  2543         16  CF-COMPANY-PASSWORD            PIC X(8).
  2544         16  CF-SECURITY-OPTION             PIC X.
  2545             88  ALL-SECURITY                   VALUE '1'.
  2546             88  COMPANY-VERIFY                 VALUE '2'.
  2547             88  PROCESSOR-VERIFY               VALUE '3'.
  2548             88  NO-SECURITY                    VALUE '4'.
  2549             88  ALL-BUT-TERM                   VALUE '5'.
  2550         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2551             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2552         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2553             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2554         16  CF-INFORCE-LOCATION            PIC X.
  2555             88  CERTS-ARE-ONLINE               VALUE '1'.
  2556             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2557             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2558         16  CF-LOWER-CASE-LETTERS          PIC X.
  2559         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2560             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2561             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2562             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2563             88  CF-ACCNT-CNTL                  VALUE '3'.
  2564             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2565
  2566         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2567         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2568
  2569         16  CF-LGX-CREDIT-USER             PIC X.
  2570             88  CO-IS-NOT-USER                 VALUE 'N'.
  2571             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2572
  2573         16 CF-CREDIT-CALC-CODES.
  2574             20  CF-CR-REM-TERM-CALC PIC X.
  2575               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2576               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2577               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2578               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2579               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2580               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2581               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2582             20  CF-CR-R78-METHOD           PIC X.
  2583               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2584               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2585
  2586         16  CF-CLAIM-CONTROL-COUNTS.
  2587             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2588                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2589
  2590             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2591                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2592
  2593             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2594                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2595
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  47
* EL6318.cbl
  2596             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2597                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2598
  2599         16  CF-CURRENT-MONTH-END           PIC XX.
  2600
  2601         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2602             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2603             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2604             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2605             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2606                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2607                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2608             20  CF-CO-PREM-REJECT-SW       PIC X.
  2609                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2610                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2611             20  CF-CO-REF-REJECT-SW        PIC X.
  2612                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2613                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2614
  2615         16  CF-CO-REPORTING-DT             PIC XX.
  2616         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2617         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2618           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2619           88  CF-CO-MONTH-END                  VALUE '1'.
  2620
  2621         16  CF-LGX-CLAIM-USER              PIC X.
  2622             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2623             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2624
  2625         16  CF-CREDIT-EDIT-CONTROLS.
  2626             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2627             20  CF-MIN-AGE                 PIC 99.
  2628             20  CF-DEFAULT-AGE             PIC 99.
  2629             20  CF-MIN-TERM                PIC S999      COMP-3.
  2630             20  CF-MAX-TERM                PIC S999      COMP-3.
  2631             20  CF-DEFAULT-SEX             PIC X.
  2632             20  CF-JOINT-AGE-INPUT         PIC X.
  2633                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2634             20  CF-BIRTH-DATE-INPUT        PIC X.
  2635                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2636             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2637                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2638                 88  CF-ZERO-CARRIER            VALUE '1'.
  2639                 88  CF-ZERO-GROUPING           VALUE '2'.
  2640                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2641             20  CF-EDIT-SW                 PIC X.
  2642                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2643             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2644             20  CF-CR-PR-METHOD            PIC X.
  2645               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2646               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2647             20  FILLER                     PIC X.
  2648
  2649         16  CF-CREDIT-MISC-CONTROLS.
  2650             20  CF-REIN-TABLE-SW           PIC X.
  2651                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2652             20  CF-COMP-TABLE-SW           PIC X.
  2653                 88 COMP-TABLES-ARE-USED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  48
* EL6318.cbl
  2654             20  CF-EXPERIENCE-RETENTION-AGE
  2655                                            PIC S9        COMP-3.
  2656             20  CF-CONVERSION-DT           PIC XX.
  2657             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2658             20  CF-RUN-FREQUENCY-SW        PIC X.
  2659                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2660                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2661
  2662             20  CF-CR-CHECK-NO-CONTROL.
  2663                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2664                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2665                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2666                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2667                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2668                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2669
  2670                 24  CF-CR-CHECK-COUNT       REDEFINES
  2671                     CF-CR-CHECK-COUNTER      PIC X(4).
  2672
  2673                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2674                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2675
  2676                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2677                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2678                 24  CF-MAIL-PROCESSING       PIC X.
  2679                     88  MAIL-PROCESSING          VALUE 'Y'.
  2680
  2681         16  CF-MISC-SYSTEM-CONTROL.
  2682             20  CF-SYSTEM-C                 PIC X.
  2683                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2684             20  CF-SYSTEM-D                 PIC X.
  2685                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2686             20  CF-SOC-SEC-NO-SW            PIC X.
  2687                 88  SOC-SEC-NO-USED             VALUE '1'.
  2688             20  CF-MEMBER-NO-SW             PIC X.
  2689                 88  MEMBER-NO-USED              VALUE '1'.
  2690             20  CF-TAX-ID-NUMBER            PIC X(11).
  2691             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2692             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2693                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2694                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2695                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2696                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2697             20  CF-SYSTEM-E                 PIC X.
  2698                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2699
  2700         16  CF-LGX-LIFE-USER               PIC X.
  2701             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2702             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2703
  2704         16  CF-CR-MONTH-END-DT             PIC XX.
  2705
  2706         16  CF-FILE-MAINT-DATES.
  2707             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2708                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2709             20  CF-LAST-BATCH       REDEFINES
  2710                 CF-LAST-BATCH-NO               PIC X(4).
  2711             20  CF-RATES-FILE-MAINT-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  49
* EL6318.cbl
  2712             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2713             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2714             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2715             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2716             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2717             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2718             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2719             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2720             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2721
  2722         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2723         16  FILLER                         PIC X.
  2724
  2725         16  CF-ALT-MORT-CODE               PIC X(4).
  2726         16  CF-MEMBER-CAPTION              PIC X(10).
  2727
  2728         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2729             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2730             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2731             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2732             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2733             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2734
  2735         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2736
  2737         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2738         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2739         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2740         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2741
  2742         16  CF-AH-OVERRIDE-L1              PIC X.
  2743         16  CF-AH-OVERRIDE-L2              PIC XX.
  2744         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2745         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2746
  2747         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2748         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2749
  2750         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2751         16  CF-AR-LAST-EL860-DT            PIC XX.
  2752         16  CF-MP-MONTH-END-DT             PIC XX.
  2753
  2754         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2755         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2756             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2757
  2758         16  CF-AR-MONTH-END-DT             PIC XX.
  2759
  2760         16  CF-CRDTCRD-USER                PIC X.
  2761             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2762             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2763
  2764         16  CF-CC-MONTH-END-DT             PIC XX.
  2765
  2766         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2767
  2768         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2769             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  50
* EL6318.cbl
  2770             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2771             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2772         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2773         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2774         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2775         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2776             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2777             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2778         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2779         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2780         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2781             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2782         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2783
  2784         16  CF-CL-ZIP-CODE.
  2785             20  CF-CL-ZIP-PRIME.
  2786                 24  CF-CL-ZIP-1ST          PIC X.
  2787                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2788                 24  FILLER                 PIC X(4).
  2789             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2790         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2791             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2792             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2793             20  FILLER                     PIC XXX.
  2794
  2795         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2796         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2797         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2798         16  CF-CO-OPTION-START-DATE        PIC XX.
  2799         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2800           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2801                                                      '3' '4'.
  2802           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2803           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2804           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2805           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2806           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2807           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2808
  2809         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2810
  2811         16  CF-PAYMENT-APPROVAL-LEVELS.
  2812             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2813             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2814             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2815             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2816             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2817             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2818
  2819         16  CF-END-USER-REPORTING-USER     PIC X.
  2820             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2821             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2822
  2823         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2824             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2825             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2826
  2827         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  51
* EL6318.cbl
  2828
  2829         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2830         16  FILLER                         PIC X.
  2831
  2832         16  CF-CREDIT-ARCHIVE-CNTL.
  2833             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2834             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2835             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2836
  2837         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2838
  2839         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2840             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2841             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2842
  2843         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2844             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2845             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2846
  2847         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2848
  2849         16  CF-CO-ACH-ID-CODE              PIC  X.
  2850             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2851             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2852             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2853         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2854         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2855         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2856         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2857         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2858         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2859         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2860         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2861         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2862                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2863         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2864                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2865
  2866         16  CF-CO-OVER-SHORT.
  2867             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2868             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2869
  2870*         16  FILLER                         PIC X(102).
  2871         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2872             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2873             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2874
  2875         16  CF-AH-APPROVAL-DAYS.
  2876             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2877             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2878             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2879             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2880
  2881         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2882
  2883         16  CF-APPROV-LEV-5.
  2884             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2885             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  52
* EL6318.cbl
  2886             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2887
  2888         16  FILLER                         PIC X(68).
  2889****************************************************************
  2890*             PROCESSOR/USER RECORD                            *
  2891****************************************************************
  2892
  2893     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2894         16  CF-PROCESSOR-NAME              PIC X(30).
  2895         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2896         16  CF-PROCESSOR-TITLE             PIC X(26).
  2897         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2898                 88  MESSAGE-YES                VALUE 'Y'.
  2899                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2900
  2901*****************************************************
  2902****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2903****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2904****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2905****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2906*****************************************************
  2907
  2908         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2909             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2910             20  CF-APPLICATION-FORCE       PIC X.
  2911             20  CF-INDIVIDUAL-APP.
  2912                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2913                     28  CF-BROWSE-APP      PIC X.
  2914                     28  CF-UPDATE-APP      PIC X.
  2915
  2916         16  CF-CURRENT-TERM-ON             PIC X(4).
  2917         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2918             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2919             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2920             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2921             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2922             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2923             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2924             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2925         16  CF-PROCESSOR-CARRIER           PIC X.
  2926             88  NO-CARRIER-SECURITY            VALUE ' '.
  2927         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2928             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2929         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2930             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2931         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2932             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2933
  2934         16  CF-PROC-SYS-ACCESS-SW.
  2935             20  CF-PROC-CREDIT-CLAIMS-SW.
  2936                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2937                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2938                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2939                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2940             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2941                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2942                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2943             20  CF-PROC-LIFE-GNRLDGR-SW.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  53
* EL6318.cbl
  2944                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2945                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2946                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2947                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2948             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2949                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2950                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2951         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2952             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2953             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2954         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2955
  2956         16  CF-APPROVAL-LEVEL                  PIC X.
  2957             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2958             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2959             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2960             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2961             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2962
  2963         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2964
  2965         16  CF-LANGUAGE-TYPE                   PIC X.
  2966             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2967             88  CF-LANG-IS-FR                      VALUE 'F'.
  2968
  2969         16  CF-CSR-IND                         PIC X.
  2970         16  FILLER                             PIC X(239).
  2971
  2972****************************************************************
  2973*             PROCESSOR/REMINDERS RECORD                       *
  2974****************************************************************
  2975
  2976     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2977         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2978             20  CF-START-REMIND-DT         PIC XX.
  2979             20  CF-END-REMIND-DT           PIC XX.
  2980             20  CF-REMINDER-TEXT           PIC X(50).
  2981         16  FILLER                         PIC X(296).
  2982
  2983
  2984****************************************************************
  2985*             STATE MASTER RECORD                              *
  2986****************************************************************
  2987
  2988     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2989         16  CF-STATE-ABBREVIATION          PIC XX.
  2990         16  CF-STATE-NAME                  PIC X(25).
  2991         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2992         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2993             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2994             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2995             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2996             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2997                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2998                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2999             20  CF-ST-PREM-REJECT-SW       PIC X.
  3000                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3001                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  54
* EL6318.cbl
  3002             20  CF-ST-REF-REJECT-SW        PIC X.
  3003                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3004                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3005         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3006         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3007         16  CF-ST-REFUND-RULES.
  3008             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3009             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3010             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3011         16  CF-ST-FST-PMT-EXTENSION.
  3012             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3013             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3014                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3015                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3016                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3017                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3018         16  CF-ST-STATE-CALL.
  3019             20  CF-ST-CALL-UNEARNED        PIC X.
  3020             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3021             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3022         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3023             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3024             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3025         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3026         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3027         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3028         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3029         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3030         16  FILLER                         PIC X.
  3031         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3032             20  CF-ST-BENEFIT-CD           PIC XX.
  3033             20  CF-ST-BENEFIT-KIND         PIC X.
  3034                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3035                 88  CF-ST-AH-KIND              VALUE 'A'.
  3036             20  CF-ST-REM-TERM-CALC        PIC X.
  3037                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3038                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3039                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3040                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3041                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3042                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3043                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3044                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3045
  3046             20  CF-ST-REFUND-CALC          PIC X.
  3047                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3048                 88  ST-REFD-BY-R78             VALUE '1'.
  3049                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3050                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3051                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3052                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3053                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3054                 88  ST-REFD-UTAH               VALUE '7'.
  3055                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3056                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3057                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3058
  3059             20  CF-ST-EARNING-CALC         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  55
* EL6318.cbl
  3060                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3061                 88  ST-EARN-BY-R78             VALUE '1'.
  3062                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3063                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3064                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3065                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3066                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3067                 88  ST-EARN-MEAN               VALUE '8'.
  3068                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3069
  3070             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3071                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3072                 88  ST-OVRD-BY-R78             VALUE '1'.
  3073                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3074                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3075                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3076                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3077                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3078                 88  ST-OVRD-MEAN               VALUE '8'.
  3079                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3080             20  FILLER                     PIC X.
  3081
  3082         16  CF-ST-COMMISSION-CAPS.
  3083             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3084             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3085             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3086             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3087         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3088                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3089
  3090         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3091
  3092         16  CF-ST-STATUTORY-INTEREST.
  3093             20  CF-ST-STAT-DATE-FROM       PIC X.
  3094                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3095                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3096             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3097             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3098             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3099             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3100             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3101
  3102         16  CF-ST-OVER-SHORT.
  3103             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3104             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3105
  3106         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3107
  3108         16  CF-ST-RT-CALC                  PIC X.
  3109
  3110         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3111         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3112         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3113         16  CF-ST-RF-LR-CALC               PIC X.
  3114         16  CF-ST-RF-LL-CALC               PIC X.
  3115         16  CF-ST-RF-LN-CALC               PIC X.
  3116         16  CF-ST-RF-AH-CALC               PIC X.
  3117         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  56
* EL6318.cbl
  3118*        16  FILLER                         PIC X(206).
  3119*CIDMOD         16  FILLER                         PIC X(192).
  3120         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3121             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3122         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3123         16  CF-ST-VFY-2ND-BENE             PIC X.
  3124         16  CF-ST-CAUSAL-STATE             PIC X.
  3125         16  FILLER                         PIC X(185).
  3126
  3127****************************************************************
  3128*             BENEFIT MASTER RECORD                            *
  3129****************************************************************
  3130
  3131     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3132         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3133             20  CF-BENEFIT-CODE            PIC XX.
  3134             20  CF-BENEFIT-NUMERIC  REDEFINES
  3135                 CF-BENEFIT-CODE            PIC XX.
  3136             20  CF-BENEFIT-ALPHA           PIC XXX.
  3137             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3138             20  CF-BENEFIT-COMMENT         PIC X(10).
  3139
  3140             20  CF-LF-COVERAGE-TYPE        PIC X.
  3141                 88  CF-REDUCING                VALUE 'R'.
  3142                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3143
  3144             20  CF-SPECIAL-CALC-CD         PIC X.
  3145                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3146                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3147                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3148                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3149                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3150                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3151                 88  CF-FARM-PLAN               VALUE 'F'.
  3152                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3153                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3154                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3155                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3156                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3157                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3158                 88  CF-PRUDENTIAL              VALUE 'P'.
  3159                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3160                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3161                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3162                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3163                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3164                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3165
  3166             20  CF-JOINT-INDICATOR         PIC X.
  3167                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3168
  3169*            20  FILLER                     PIC X(12).
  3170             20  FILLER                     PIC X(11).
  3171             20  CF-BENEFIT-CATEGORY        PIC X.
  3172             20  CF-LOAN-TYPE               PIC X(8).
  3173
  3174             20  CF-CO-REM-TERM-CALC        PIC X.
  3175                 88  CO-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  57
* EL6318.cbl
  3176                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3177                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3178                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3179                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3180
  3181             20  CF-CO-EARNINGS-CALC        PIC X.
  3182                 88  CO-EARN-BY-R78             VALUE '1'.
  3183                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3184                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3185                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3186                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3187                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3188                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3189                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3190
  3191             20  CF-CO-REFUND-CALC          PIC X.
  3192                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3193                 88  CO-REFD-BY-R78             VALUE '1'.
  3194                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3195                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3196                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3197                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3198                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3199                 88  CO-REFD-MEAN               VALUE '8'.
  3200                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3201                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3202                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3203
  3204             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3205                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3206                 88  CO-OVRD-BY-R78             VALUE '1'.
  3207                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3208                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3209                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3210                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3211                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3212                 88  CO-OVRD-MEAN               VALUE '8'.
  3213                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3214
  3215             20  CF-CO-BEN-I-G-CD           PIC X.
  3216                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3217                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3218                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3219
  3220         16  FILLER                         PIC X(304).
  3221
  3222
  3223****************************************************************
  3224*             CARRIER MASTER RECORD                            *
  3225****************************************************************
  3226
  3227     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3228         16  CF-ADDRESS-DATA.
  3229             20  CF-MAIL-TO-NAME            PIC X(30).
  3230             20  CF-IN-CARE-OF              PIC X(30).
  3231             20  CF-ADDRESS-LINE-1          PIC X(30).
  3232             20  CF-ADDRESS-LINE-2          PIC X(30).
  3233             20  CF-CITY-STATE              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  58
* EL6318.cbl
  3234             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3235             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3236
  3237         16  CF-CLAIM-NO-CONTROL.
  3238             20  CF-CLAIM-NO-METHOD         PIC X.
  3239                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3240                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3241                 88  CLAIM-NO-SEQ               VALUE '3'.
  3242                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3243             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3244                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3245                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3246                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3247
  3248         16  CF-CHECK-NO-CONTROL.
  3249             20  CF-CHECK-NO-METHOD         PIC X.
  3250                 88  CHECK-NO-MANUAL            VALUE '1'.
  3251                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3252                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3253                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3254             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3255                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3256
  3257         16  CF-DOMICILE-STATE              PIC XX.
  3258
  3259         16  CF-EXPENSE-CONTROLS.
  3260             20  CF-EXPENSE-METHOD          PIC X.
  3261                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3262                 88  DOLLARS-PER-PMT            VALUE '2'.
  3263                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3264                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3265             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3266             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3267
  3268         16  CF-CORRESPONDENCE-CONTROL.
  3269             20  CF-LETTER-RESEND-OPT       PIC X.
  3270                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3271                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3272             20  FILLER                     PIC X(4).
  3273
  3274         16  CF-RESERVE-CONTROLS.
  3275             20  CF-MANUAL-SW               PIC X.
  3276                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3277             20  CF-FUTURE-SW               PIC X.
  3278                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3279             20  CF-PTC-SW                  PIC X.
  3280                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3281             20  CF-IBNR-SW                 PIC X.
  3282                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3283             20  CF-PTC-LF-SW               PIC X.
  3284                 88  CF-LF-PTC-USED             VALUE '1'.
  3285             20  CF-CDT-ACCESS-METHOD       PIC X.
  3286                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3287                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3288                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3289             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3290
  3291         16  CF-CLAIM-CALC-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  59
* EL6318.cbl
  3292             88  360-PLUS-MONTHS                VALUE '1'.
  3293             88  365-PLUS-MONTHS                VALUE '2'.
  3294             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3295             88  360-DAILY                      VALUE '4'.
  3296             88  365-DAILY                      VALUE '5'.
  3297
  3298         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3299         16  FILLER                         PIC X(11).
  3300
  3301         16  CF-LIMIT-AMOUNTS.
  3302             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3303             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3304             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3305             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3306             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3307             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3308             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3309             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3310             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3311             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3312
  3313         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3314         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3315         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3316
  3317         16  CF-ZIP-CODE.
  3318             20  CF-ZIP-PRIME.
  3319                 24  CF-ZIP-1ST             PIC X.
  3320                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3321                 24  FILLER                 PIC X(4).
  3322             20  CF-ZIP-PLUS4               PIC X(4).
  3323         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3324             20  CF-CAN-POSTAL-1            PIC XXX.
  3325             20  CF-CAN-POSTAL-2            PIC XXX.
  3326             20  FILLER                     PIC XXX.
  3327
  3328         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3329         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3330         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3331
  3332         16  CF-RATING-SWITCH               PIC X.
  3333             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3334             88  CF-NO-RATING                   VALUE 'N'.
  3335
  3336         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3337
  3338         16  CF-CARRIER-OVER-SHORT.
  3339             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3340             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3341
  3342         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3343         16  CF-SECPAY-SWITCH               PIC X.
  3344             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3345             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3346         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3347         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3348         16  FILLER                         PIC X(444).
  3349*        16  FILLER                         PIC X(452).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  60
* EL6318.cbl
  3350
  3351
  3352****************************************************************
  3353*             MORTALITY MASTER RECORD                          *
  3354****************************************************************
  3355
  3356     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3357         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3358                                INDEXED BY CF-MORT-NDX.
  3359             20  CF-MORT-TABLE              PIC X(5).
  3360             20  CF-MORT-TABLE-TYPE         PIC X.
  3361                 88  CF-MORT-JOINT              VALUE 'J'.
  3362                 88  CF-MORT-SINGLE             VALUE 'S'.
  3363                 88  CF-MORT-COMBINED           VALUE 'C'.
  3364                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3365                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3366             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3367             20  CF-MORT-AGE-METHOD         PIC XX.
  3368                 88  CF-AGE-LAST                VALUE 'AL'.
  3369                 88  CF-AGE-NEAR                VALUE 'AN'.
  3370             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3371             20  CF-MORT-ADJUSTMENT-DIRECTION
  3372                                            PIC X.
  3373                 88  CF-MINUS                   VALUE '-'.
  3374                 88  CF-PLUS                    VALUE '+'.
  3375             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3376             20  CF-MORT-JOINT-CODE         PIC X.
  3377                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3378             20  CF-MORT-PC-Q               PIC X.
  3379                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3380             20  CF-MORT-TABLE-CODE         PIC X(4).
  3381             20  CF-MORT-COMMENTS           PIC X(15).
  3382             20  FILLER                     PIC X(14).
  3383
  3384         16  FILLER                         PIC X(251).
  3385
  3386
  3387****************************************************************
  3388*             BUSSINESS TYPE MASTER RECORD                     *
  3389****************************************************************
  3390
  3391     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3392* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3393* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3394* AND RECORD 05 IS TYPES 81-99
  3395         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3396             20  CF-BUSINESS-TITLE          PIC  X(19).
  3397             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3398                                            PIC S9V9(4) COMP-3.
  3399             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3400             20  FILLER                     PIC  X.
  3401         16  FILLER                         PIC  X(248).
  3402
  3403
  3404****************************************************************
  3405*             TERMINAL MASTER RECORD                           *
  3406****************************************************************
  3407
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  61
* EL6318.cbl
  3408     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3409
  3410         16  CF-COMPANY-TERMINALS.
  3411             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3412                                  PIC X(4).
  3413         16  FILLER               PIC X(248).
  3414
  3415
  3416****************************************************************
  3417*             LIFE EDIT MASTER RECORD                          *
  3418****************************************************************
  3419
  3420     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3421         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3422             20  CF-LIFE-CODE-IN            PIC XX.
  3423             20  CF-LIFE-CODE-OUT           PIC XX.
  3424         16  FILLER                         PIC X(248).
  3425
  3426
  3427****************************************************************
  3428*             AH EDIT MASTER RECORD                            *
  3429****************************************************************
  3430
  3431     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3432         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3433             20  CF-AH-CODE-IN              PIC XXX.
  3434             20  CF-AH-CODE-OUT             PIC XX.
  3435         16  FILLER                         PIC X(248).
  3436
  3437
  3438****************************************************************
  3439*             CREDIBILITY TABLES                               *
  3440****************************************************************
  3441
  3442     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3443         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3444                             INDEXED BY CF-CRDB-NDX.
  3445             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3446             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3447             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3448         16  FILLER                         PIC  X(332).
  3449
  3450
  3451****************************************************************
  3452*             REPORT CUSTOMIZATION RECORD                      *
  3453****************************************************************
  3454
  3455     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3456         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3457             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3458             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3459             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3460**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3461****       A T-TRANSFER.                                   ****
  3462             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3463
  3464         16  FILLER                         PIC XX.
  3465
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  62
* EL6318.cbl
  3466         16  CF-CARRIER-CNTL-OPT.
  3467             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3468                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3469                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3470             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3471                                            PIC X.
  3472         16  CF-GROUP-CNTL-OPT.
  3473             20  CF-GROUP-OPT-SEQ           PIC 9.
  3474                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3475                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3476             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3477                                            PIC X(6).
  3478         16  CF-STATE-CNTL-OPT.
  3479             20  CF-STATE-OPT-SEQ           PIC 9.
  3480                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3481                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3482             20  CF-STATE-SELECT OCCURS 3 TIMES
  3483                                            PIC XX.
  3484         16  CF-ACCOUNT-CNTL-OPT.
  3485             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3486                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3487                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3488             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3489                                            PIC X(10).
  3490         16  CF-BUS-TYP-CNTL-OPT.
  3491             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3492                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3493                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3494             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3495                                            PIC XX.
  3496         16  CF-LF-TYP-CNTL-OPT.
  3497             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3498                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3499                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3500             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3501                                            PIC XX.
  3502         16  CF-AH-TYP-CNTL-OPT.
  3503             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3504                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3505                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3506             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3507                                            PIC XX.
  3508         16  CF-REPTCD1-CNTL-OPT.
  3509             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3510                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3511                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3512             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3513                                            PIC X(10).
  3514         16  CF-REPTCD2-CNTL-OPT.
  3515             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3516                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3517                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3518             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3519                                            PIC X(10).
  3520         16  CF-USER1-CNTL-OPT.
  3521             20  CF-USER1-OPT-SEQ           PIC 9.
  3522                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3523                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  63
* EL6318.cbl
  3524             20  CF-USER1-SELECT OCCURS 3 TIMES
  3525                                            PIC X(10).
  3526         16  CF-USER2-CNTL-OPT.
  3527             20  CF-USER2-OPT-SEQ           PIC 9.
  3528                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3529                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3530             20  CF-USER2-SELECT OCCURS 3 TIMES
  3531                                            PIC X(10).
  3532         16  CF-USER3-CNTL-OPT.
  3533             20  CF-USER3-OPT-SEQ           PIC 9.
  3534                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3535                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3536             20  CF-USER3-SELECT OCCURS 3 TIMES
  3537                                            PIC X(10).
  3538         16  CF-USER4-CNTL-OPT.
  3539             20  CF-USER4-OPT-SEQ           PIC 9.
  3540                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3541                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3542             20  CF-USER4-SELECT OCCURS 3 TIMES
  3543                                            PIC X(10).
  3544         16  CF-USER5-CNTL-OPT.
  3545             20  CF-USER5-OPT-SEQ           PIC 9.
  3546                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3547                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3548             20  CF-USER5-SELECT OCCURS 3 TIMES
  3549                                            PIC X(10).
  3550         16  CF-REINS-CNTL-OPT.
  3551             20  CF-REINS-OPT-SEQ           PIC 9.
  3552                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3553                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3554             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3555                 24  CF-REINS-PRIME         PIC XXX.
  3556                 24  CF-REINS-SUB           PIC XXX.
  3557
  3558         16  CF-AGENT-CNTL-OPT.
  3559             20  CF-AGENT-OPT-SEQ           PIC 9.
  3560                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3561                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3562             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3563                                            PIC X(10).
  3564
  3565         16  FILLER                         PIC X(43).
  3566
  3567         16  CF-LOSS-RATIO-SELECT.
  3568             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3569             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3570         16  CF-ENTRY-DATE-SELECT.
  3571             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3572             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3573         16  CF-EFFECTIVE-DATE-SELECT.
  3574             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3575             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3576
  3577         16  CF-EXCEPTION-LIST-IND          PIC X.
  3578             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3579
  3580         16  FILLER                         PIC X(318).
  3581
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  64
* EL6318.cbl
  3582****************************************************************
  3583*                  EXCEPTION REPORTING RECORD                  *
  3584****************************************************************
  3585
  3586     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3587         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3588             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3589
  3590         16  CF-COMBINED-LIFE-AH-OPT.
  3591             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3592             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3593             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3594             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3595
  3596         16  CF-LIFE-OPT.
  3597             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3598             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3599             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3600             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3601             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3602             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3603             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3604             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3605             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3606             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3607
  3608         16  CF-AH-OPT.
  3609             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3610             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3611             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3612             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3613             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3614             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3615             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3616             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3617             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3618             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3619
  3620         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3621             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3622             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3623             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3624
  3625         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3626
  3627         16  FILLER                         PIC X(673).
  3628
  3629
  3630****************************************************************
  3631*             MORTGAGE SYSTEM PLAN RECORD                      *
  3632****************************************************************
  3633
  3634     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-PLAN-TYPE                   PIC X.
  3636             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3637             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3638             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3639         16  CF-PLAN-ABBREV                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  65
* EL6318.cbl
  3640         16  CF-PLAN-DESCRIPT               PIC X(10).
  3641         16  CF-PLAN-NOTES                  PIC X(20).
  3642         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3643         16  CF-PLAN-UNDERWRITING.
  3644             20  CF-PLAN-TERM-DATA.
  3645                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3646                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3647             20  CF-PLAN-AGE-DATA.
  3648                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3649                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3650                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3651             20  CF-PLAN-BENEFIT-DATA.
  3652                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3653                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3654                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3655                                            PIC S9(7)V99  COMP-3.
  3656         16  CF-PLAN-POLICY-FORMS.
  3657             20  CF-POLICY-FORM             PIC X(12).
  3658             20  CF-MASTER-APPLICATION      PIC X(12).
  3659             20  CF-MASTER-POLICY           PIC X(12).
  3660         16  CF-PLAN-RATING.
  3661             20  CF-RATE-CODE               PIC X(5).
  3662             20  CF-SEX-RATING              PIC X.
  3663                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3664                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3665             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3666             20  CF-SUB-STD-TYPE            PIC X.
  3667                 88  CF-PCT-OF-PREM            VALUE '1'.
  3668                 88  CF-PCT-OF-BENE            VALUE '2'.
  3669         16  CF-PLAN-PREM-TOLERANCES.
  3670             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3671             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3672         16  CF-PLAN-PYMT-TOLERANCES.
  3673             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3674             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3675         16  CF-PLAN-MISC-DATA.
  3676             20  FILLER                     PIC X.
  3677             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3678             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3679         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3680         16  CF-PLAN-IND-GRP                PIC X.
  3681             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3682                                                     '1'.
  3683             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3684                                                     '2'.
  3685         16  CF-MIB-SEARCH-SW               PIC X.
  3686             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3687             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3688             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3689             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3690         16  CF-ALPHA-SEARCH-SW             PIC X.
  3691             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3692             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3693             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3694             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3695             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3696             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3697             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  66
* EL6318.cbl
  3698             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3699             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3700             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3701                                                     'A' 'B' 'C'
  3702                                                     'X' 'Y' 'Z'.
  3703         16  CF-EFF-DT-RULE-SW              PIC X.
  3704             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3705             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3706             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3707             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3708             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3709         16  FILLER                         PIC X(4).
  3710         16  CF-HEALTH-QUESTIONS            PIC X.
  3711             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3712         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3713         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3714         16  CF-PLAN-SNGL-JNT               PIC X.
  3715             88  CF-COMBINED-PLAN              VALUE 'C'.
  3716             88  CF-JNT-PLAN                   VALUE 'J'.
  3717             88  CF-SNGL-PLAN                  VALUE 'S'.
  3718         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3719         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3720         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3721         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3722         16  CF-RERATE-CNTL                 PIC  X.
  3723             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3724             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3725             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3726             88  CF-AUTO-RECALC                 VALUE '4'.
  3727         16  CF-BENEFIT-TYPE                PIC  X.
  3728             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3729             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3730         16  CF-POLICY-FEE                  PIC S999V99
  3731                                                    COMP-3.
  3732         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3733         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3734         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3735         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3736         16  FILLER                         PIC  X(32).
  3737         16  CF-TERMINATION-FORM            PIC  X(04).
  3738         16  FILLER                         PIC  X(08).
  3739         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3740                                                       COMP-3.
  3741         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3742         16  CF-ISSUE-LETTER                PIC  X(4).
  3743         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3744         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3745             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3746             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3747         16  CF-MP-REFUND-CALC              PIC X.
  3748             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3749             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3750             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3751             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3752             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3753             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3754             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3755             88  CF-MP-REFD-MEAN                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  67
* EL6318.cbl
  3756         16  CF-ALT-RATE-CODE               PIC  X(5).
  3757
  3758
  3759         16  FILLER                         PIC X(498).
  3760****************************************************************
  3761*             MORTGAGE COMPANY MASTER RECORD                   *
  3762****************************************************************
  3763
  3764     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3765         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3766         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3767             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3768             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3769             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3770             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3771             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3772
  3773         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3774         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3775         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3776         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3777         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3778
  3779         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3780             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3781         16  CF-MP-RECON-USE-IND            PIC X(1).
  3782             88  CF-MP-USE-RECON             VALUE 'Y'.
  3783         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3784             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3785         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3786             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3787             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3788         16  FILLER                         PIC X(1).
  3789         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3790             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3791         16  CF-MORTG-MIB-VERSION           PIC X.
  3792             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3793             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3794             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3795         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3796             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3797                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3798             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3799                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3800             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3801                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3802             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3803                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3804             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3805                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3806             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3807                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3808         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3809         16  FILLER                         PIC X(7).
  3810         16  CF-MORTG-DESTINATION-SYMBOL.
  3811             20  CF-MORTG-MIB-COMM          PIC X(5).
  3812             20  CF-MORTG-MIB-TERM          PIC X(5).
  3813         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  68
* EL6318.cbl
  3814             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3815         16  FILLER                         PIC X(03).
  3816         16  CF-MP-CHECK-NO-CONTROL.
  3817             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3818                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3819                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3820                                                ' ' LOW-VALUES.
  3821                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3822                                               VALUE '3'.
  3823         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3824         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3825         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3826             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3827                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3828             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3829                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3830             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3831                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3832             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3833                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3834             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3835                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3836             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3837                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3838         16  CF-MORTG-BILLING-AREA.
  3839             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3840                                            PIC X.
  3841         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3842         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3843         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3844         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3845             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3846             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3847         16  FILLER                         PIC X.
  3848         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3849             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3850             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3851         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3852         16  FILLER                         PIC X(8).
  3853         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3854         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3855         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3856         16  CF-ACH-COMPANY-ID.
  3857             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3858                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3859                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3860                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3861             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3862         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3863             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3864         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3865             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3866             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3867         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3868         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3869         16  FILLER                         PIC X(536).
  3870
  3871****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  69
* EL6318.cbl
  3872*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3873****************************************************************
  3874
  3875     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3876         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3877             20  CF-FEMALE-HEIGHT.
  3878                 24  CF-FEMALE-FT           PIC 99.
  3879                 24  CF-FEMALE-IN           PIC 99.
  3880             20  CF-FEMALE-MIN-WT           PIC 999.
  3881             20  CF-FEMALE-MAX-WT           PIC 999.
  3882         16  FILLER                         PIC X(428).
  3883
  3884     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3885         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3886             20  CF-MALE-HEIGHT.
  3887                 24  CF-MALE-FT             PIC 99.
  3888                 24  CF-MALE-IN             PIC 99.
  3889             20  CF-MALE-MIN-WT             PIC 999.
  3890             20  CF-MALE-MAX-WT             PIC 999.
  3891         16  FILLER                         PIC X(428).
  3892******************************************************************
  3893*             AUTOMATIC ACTIVITY RECORD                          *
  3894******************************************************************
  3895     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3896         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3897             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3898             20  CF-SYS-LETTER-ID           PIC X(04).
  3899             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3900             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3901             20  CF-SYS-RESET-SW            PIC X(01).
  3902             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3903             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3904
  3905         16  FILLER                         PIC X(50).
  3906
  3907         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3908             20  CF-USER-ACTIVE-SW          PIC X(01).
  3909             20  CF-USER-LETTER-ID          PIC X(04).
  3910             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3911             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3912             20  CF-USER-RESET-SW           PIC X(01).
  3913             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3914             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3915             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3916
  3917         16  FILLER                         PIC X(246).
  3918*                                COPY ERCPNDB.
  3919******************************************************************
  3920*                                                                *
  3921*                                                                *
  3922*                            ERCPNDB.                            *
  3923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3924*                            VMOD=2.025                          *
  3925*                                                                *
  3926*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3927*                                                                *
  3928******************************************************************
  3929*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  70
* EL6318.cbl
  3930*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3931******************************************************************
  3932*                                                                *
  3933*                                                                *
  3934*   FILE TYPE = VSAM,KSDS                                        *
  3935*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3936*                                                                *
  3937*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3938*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3939*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3940*                                                 RKP=13,LEN=36  *
  3941*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3942*                                      AND CHG-SEQ.)             *
  3943*                                                RKP=49,LEN=11   *
  3944*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3945*                                      AND CHG-SEQ.)             *
  3946*                                                RKP=60,LEN=15   *
  3947*                                                                *
  3948*   LOG = NO                                                     *
  3949*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3950******************************************************************
  3951******************************************************************
  3952*                   C H A N G E   L O G
  3953*
  3954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3955*-----------------------------------------------------------------
  3956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3957* EFFECTIVE    NUMBER
  3958*-----------------------------------------------------------------
  3959* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3960* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3961* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3962* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3963* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3964* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3965* 032306                   PEMA  ADD BOW LOAN NUMBER
  3966* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3967* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3968* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3969* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3970* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3971* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3972* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3973* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3974******************************************************************
  3975
  3976 01  PENDING-BUSINESS.
  3977     12  PB-RECORD-ID                     PIC XX.
  3978         88  VALID-PB-ID                        VALUE 'PB'.
  3979
  3980     12  PB-CONTROL-PRIMARY.
  3981         16  PB-COMPANY-CD                PIC X.
  3982         16  PB-ENTRY-BATCH               PIC X(6).
  3983         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3984         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3985
  3986     12  PB-CONTROL-BY-ACCOUNT.
  3987         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  71
* EL6318.cbl
  3988         16  PB-CARRIER                   PIC X.
  3989         16  PB-GROUPING.
  3990             20  PB-GROUPING-PREFIX       PIC XXX.
  3991             20  PB-GROUPING-PRIME        PIC XXX.
  3992         16  PB-STATE                     PIC XX.
  3993         16  PB-ACCOUNT.
  3994             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3995             20  PB-ACCOUNT-PRIME         PIC X(6).
  3996         16  PB-CERT-EFF-DT               PIC XX.
  3997         16  PB-CERT-NO.
  3998             20  PB-CERT-PRIME            PIC X(10).
  3999             20  PB-CERT-SFX              PIC X.
  4000         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4001
  4002         16  PB-RECORD-TYPE               PIC X.
  4003             88  PB-MAILING-DATA                VALUE '0'.
  4004             88  PB-ISSUE                       VALUE '1'.
  4005             88  PB-CANCELLATION                VALUE '2'.
  4006             88  PB-BATCH-TRAILER               VALUE '9'.
  4007
  4008     12  PB-CONTROL-BY-ORIG-BATCH.
  4009         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4010         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4011         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4012         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4013
  4014     12  PB-CONTROL-BY-CSR.
  4015         16  PB-CSR-COMPANY-CD            PIC X.
  4016         16  PB-CSR-ID                    PIC X(4).
  4017         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4018         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4019         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4020******************************************************************
  4021*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4022******************************************************************
  4023
  4024     12  PB-LAST-MAINT-DT                 PIC XX.
  4025     12  PB-LAST-MAINT-BY                 PIC X(4).
  4026     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4027
  4028     12  PB-RECORD-BODY                   PIC X(375).
  4029
  4030     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4031         16  PB-CERT-ORIGIN               PIC X.
  4032             88  CLASIC-CREATED-CERT         VALUE '1'.
  4033         16  PB-I-NAME.
  4034             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4035             20  PB-I-INSURED-FIRST-NAME.
  4036                 24  PB-I-INSURED-1ST-INIT PIC X.
  4037                 24  FILLER                PIC X(9).
  4038             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4039         16  PB-I-AGE                     PIC S99   COMP-3.
  4040         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4041         16  PB-I-BIRTHDAY                PIC XX.
  4042         16  PB-I-INSURED-SEX             PIC X.
  4043             88  PB-SEX-MALE     VALUE 'M'.
  4044             88  PB-SEX-FEMALE   VALUE 'F'.
  4045
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  72
* EL6318.cbl
  4046         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4047         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4048         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4049         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4050         16  PB-I-SKIP-CODE               PIC X.
  4051             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4052             88  PB-SKIP-JULY              VALUE '1'.
  4053             88  PB-SKIP-AUGUST            VALUE '2'.
  4054             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4055             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4056             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4057             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4058             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4059             88  PB-SKIP-JUNE              VALUE '8'.
  4060             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4061             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4062             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4063         16  PB-I-TERM-TYPE               PIC X.
  4064             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4065             88  PB-PAID-WEEKLY            VALUE 'W'.
  4066             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4067             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4068             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4069         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4070         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4071         16  PB-I-DATA-ENTRY-SW           PIC X.
  4072             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4073             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4074             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4075             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4076         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4077         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4078*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4079         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4080         16  FILLER                       PIC X.
  4081
  4082         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4083             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4084             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4085                                                   '90' THRU '99'.
  4086         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4087                                          PIC XX.
  4088         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4089         16  PB-I-AMOUNT-FINANCED REDEFINES
  4090                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4091         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4092         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4093                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4094         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4095         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4096         16  PB-I-CLP-AMOUNT REDEFINES
  4097                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4098         16  PB-I-LF-CALC-FLAG            PIC X.
  4099             88 PB-COMP-LF-PREM               VALUE '?'.
  4100         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4101         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4102         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4103         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  73
* EL6318.cbl
  4104         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4105         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4106         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4107         16  PB-I-LF-ABBR                 PIC XXX.
  4108         16  PB-I-LF-INPUT-CD             PIC XX.
  4109
  4110         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4111             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4112             88  PB-INVALID-AH               VALUE '  ' '00'
  4113                                                   '90' THRU '99'.
  4114         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4115         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-AH-CALC-FLAG            PIC X.
  4117             88 PB-COMP-AH-PREM                  VALUE '?'.
  4118         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4119         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4120         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4121         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4122         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4123         16  PB-I-AH-ABBR                 PIC XXX.
  4124         16  PB-I-AH-INPUT-CD             PIC XXX.
  4125
  4126         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4127         16  PB-I-REIN-TABLE              PIC XXX.
  4128         16  PB-I-BUSINESS-TYPE           PIC 99.
  4129         16  PB-I-INDV-GRP-CD             PIC X.
  4130         16  PB-I-MORT-CODE.
  4131             20  PB-I-TABLE               PIC X.
  4132             20  PB-I-INTEREST            PIC XX.
  4133             20  PB-I-MORT-TYP            PIC X.
  4134         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4135         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4136         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4137         16  PB-I-INDV-GRP-OVRD           PIC X.
  4138         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4139         16  PB-I-SIG-SW                  PIC X.
  4140             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4141         16  PB-I-RATE-CLASS              PIC XX.
  4142         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4143         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4144         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4145         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4146         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4147         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4148         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4149         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4150         16  PB-I-OB-FLAG                 PIC X.
  4151             88  PB-I-OB                      VALUE 'B'.
  4152             88  PB-I-SUMMARY                 VALUE 'Z'.
  4153         16  PB-I-ENTRY-STATUS            PIC X.
  4154             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4155                                              'M' '5' '9' '2'.
  4156             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4157             88  PB-I-POLICY-PENDING          VALUE '2'.
  4158             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4159             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4160             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4161             88  PB-I-REIN-ONLY               VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  74
* EL6318.cbl
  4162             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4163             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4164             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4165             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4166         16  PB-I-INT-CODE                PIC X.
  4167             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4168             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4169         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4170         16  PB-I-SOC-SEC-NO              PIC X(11).
  4171         16  PB-I-MEMBER-NO               PIC X(12).
  4172         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4173*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4174         16  PB-I-OLD-LOF                 PIC XXX.
  4175         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4176         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4177         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4178         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4179         16  PB-I-LIFE-INDICATOR          PIC X.
  4180             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4181         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4182         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4183                                          PIC S9(5)V99    COMP-3.
  4184         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4185             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4186             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4187         16  PB-I-1ST-PMT-DT              PIC XX.
  4188         16  PB-I-JOINT-INSURED.
  4189             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4190             20 PB-I-JOINT-FIRST-NAME.
  4191                24  PB-I-JOINT-FIRST-INIT PIC X.
  4192                24  FILLER                PIC X(9).
  4193             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4194*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4195         16  PB-I-BENEFICIARY-NAME.
  4196             20  PB-I-BANK-NUMBER         PIC X(10).
  4197             20  FILLER                   PIC X(15).
  4198         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4199         16  PB-I-REFERENCE               PIC X(12).
  4200         16  FILLER REDEFINES PB-I-REFERENCE.
  4201             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4202             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4203             20  PB-I-CLP-STATE           PIC XX.
  4204         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4205             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4206             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4207             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4208         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4209         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4210         16  PB-I-RESIDENT-STATE          PIC XX.
  4211         16  PB-I-RATE-CODE               PIC X(4).
  4212         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4213         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4214         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4215         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4216         16  PB-I-BANK-NOCHRGB            PIC 99.
  4217         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4218         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4219
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  75
* EL6318.cbl
  4220     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4221         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4222             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4223         16  PB-C-CANCEL-ORIGIN           PIC X.
  4224             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4225         16  PB-C-LF-CANCEL-DT            PIC XX.
  4226         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4227         16  PB-C-LF-CALC-REQ             PIC X.
  4228             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4229         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4230         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4231         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4232             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4233         16  PB-C-AH-CANCEL-DT            PIC XX.
  4234         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4235         16  PB-C-AH-CALC-REQ             PIC X.
  4236             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4237         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4238         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4239         16  PB-C-LAST-NAME               PIC X(15).
  4240         16  PB-C-REFUND-SW               PIC X.
  4241             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4242             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4243         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4244         16  PB-C-PAYEE-CODE              PIC X(6).
  4245         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4246         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4247         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4248         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4249         16  PB-C-REFERENCE               PIC X(12).
  4250         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4251         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4252         16  PB-C-POST-CARD-IND           PIC X.
  4253         16  PB-C-CANCEL-REASON           PIC X.
  4254         16  PB-C-REF-INTERFACE-SW        PIC X.
  4255         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4256         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4257         16  FILLER                       PIC X(01).
  4258*        16  FILLER                       PIC X(18).
  4259         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4260*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4261         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4262         16  PB-CANCELED-CERT-DATA.
  4263             20  PB-CI-INSURED-NAME.
  4264                 24  PB-CI-LAST-NAME      PIC X(15).
  4265                 24  PB-CI-INITIALS       PIC XX.
  4266             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4267             20  PB-CI-INSURED-SEX        PIC X.
  4268             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4269             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4270             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4271             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4272             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4273             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4274             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4275             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4276             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4277             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  76
* EL6318.cbl
  4278             20  PB-CI-RATE-CLASS         PIC XX.
  4279             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4280             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4281             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4282             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4283             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4284             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4285             20  PB-CI-LF-ABBR            PIC X(3).
  4286             20  PB-CI-AH-ABBR            PIC X(3).
  4287             20  PB-CI-OB-FLAG            PIC X.
  4288                 88  PB-CI-OB                VALUE 'B'.
  4289             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4290                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4291                                           'M' '4' '5' '9' '2'.
  4292                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4293                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4294                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4295                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4296                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4297                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4298                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4299                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4300                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4301                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4302                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4303                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4304             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4305                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4306                                           'M' '4' '5' '9' '2'.
  4307                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4308                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4309                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4310                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4311                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4312                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4313                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4314                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4315                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4316                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4317                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4318                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4319             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4320             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4321             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4322             20  PB-CI-MEMBER-NO          PIC X(12).
  4323             20  PB-CI-INT-CODE           PIC X.
  4324                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4325                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4326             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4327             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4328             20  PB-CI-COMP-EXCP-SW       PIC X.
  4329                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4330                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4331             20  PB-CI-ENTRY-STATUS       PIC X.
  4332             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4333             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4334             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4335             20  PB-CI-DEATH-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  77
* EL6318.cbl
  4336             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4337             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4338             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4339             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4340             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4341             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4342             20  PB-CI-ENTRY-DT              PIC XX.
  4343             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4344             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4345             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4346             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4347             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4348             20  PB-CI-OLD-LOF               PIC XXX.
  4349*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4350             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4351             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4352             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4353             20  PB-CI-INDV-GRP-CD           PIC X.
  4354             20  PB-CI-BENEFICIARY-NAME.
  4355                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4356                 24  FILLER                  PIC X(15).
  4357             20  PB-CI-NOTE-SW               PIC X.
  4358             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4359             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4360             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4361             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4362             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4363             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4364             20  PB-CI-FIRST-NAME            PIC X(10).
  4365             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4366
  4367         16  FILLER                       PIC X(13).
  4368*032306  16  FILLER                       PIC X(27).
  4369*        16  FILLER                       PIC X(46).
  4370
  4371     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4372         16  FILLER                       PIC X(10).
  4373         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4374         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4375         16  PB-M-INSURED-MID-INIT        PIC X.
  4376         16  PB-M-INSURED-AGE             PIC 99.
  4377         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4378         16  PB-M-INSURED-SEX             PIC X.
  4379         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4380         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4381         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4382         16  PB-M-INSURED-CITY-STATE.
  4383             20  PB-M-INSURED-CITY        PIC X(28).
  4384             20  PB-M-INSURED-STATE       PIC XX.
  4385         16  PB-M-INSURED-ZIP-CODE.
  4386             20  PB-M-INSURED-ZIP-PRIME.
  4387                 24  PB-M-INSURED-ZIP-1   PIC X.
  4388                     88  PB-M-CANADIAN-POST-CODE
  4389                                             VALUE 'A' THRU 'Z'.
  4390                 24  FILLER               PIC X(4).
  4391             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4392         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4393                                        PB-M-INSURED-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  78
* EL6318.cbl
  4394             20  PM-M-INS-CAN-POST1       PIC XXX.
  4395             20  PM-M-INS-CAN-POST2       PIC XXX.
  4396             20  FILLER                   PIC XXX.
  4397         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4398         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4399         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4400         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4401         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4402         16  PB-M-CRED-BENE-CITYST.
  4403             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4404             20  PB-M-CRED-BENE-STATE     PIC XX.
  4405         16  FILLER                       PIC X(92).
  4406
  4407     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4408         16  FILLER                       PIC X(10).
  4409         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4410         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4411         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4412         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4413         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4414         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4415         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4416         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4417         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4418         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4419         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4420         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4422         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4423         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4424         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4425         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4426         16  PB-ACCOUNT-NAME              PIC X(30).
  4427         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4428         16  PB-REFERENCE                 PIC X(12).
  4429         16  PB-B-RECEIVED-DT             PIC XX.
  4430         16  FILLER                       PIC X(234).
  4431
  4432     12  PB-RECORD-STATUS.
  4433         16  PB-CREDIT-SELECT-DT          PIC XX.
  4434         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4435         16  PB-BILLED-DT                 PIC XX.
  4436         16  PB-BILLING-STATUS            PIC X.
  4437             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4438             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4439             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4440         16  PB-RECORD-BILL               PIC X.
  4441             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4442             88  PB-RECORD-RETURNED           VALUE 'R'.
  4443             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4444             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4445             88  PB-OVERRIDE-AH               VALUE 'A'.
  4446             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4447         16  PB-BATCH-ENTRY               PIC X.
  4448             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4449             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4450             88  PB-REISSUED-CERT             VALUE 'E'.
  4451             88  PB-MONTHLY-CERT              VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  79
* EL6318.cbl
  4452             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4453             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4454             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4455         16  PB-FORCE-CODE                PIC X.
  4456             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4457             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4458             88  PB-CANCEL-FORCE              VALUE '8'.
  4459             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4460             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4461             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4462             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4463             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4464             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4465             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4466         16  PB-FATAL-FLAG                PIC X.
  4467             88  PB-FATAL-ERRORS              VALUE 'X'.
  4468         16  PB-FORCE-ER-CD               PIC X.
  4469             88  PB-FORCE-ERRORS              VALUE 'F'.
  4470             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4471         16  PB-WARN-ER-CD                PIC X.
  4472             88  PB-WARNING-ERRORS            VALUE 'W'.
  4473         16  FILLER                       PIC X.
  4474         16  PB-OUT-BAL-CD                PIC X.
  4475             88  PB-OUT-OF-BAL                VALUE 'O'.
  4476         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4477         16  PB-AH-OVERRIDE-L1            PIC X.
  4478         16  PB-INPUT-DT                  PIC XX.
  4479         16  PB-INPUT-BY                  PIC X(4).
  4480         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4481         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4482         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4483         16  PB-LF-EARNING-METHOD         PIC X.
  4484         16  PB-AH-EARNING-METHOD         PIC X.
  4485         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4486         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4487         16  PB-REIN-CD                   PIC XXX.
  4488         16  PB-LF-REFUND-TYPE            PIC X.
  4489         16  PB-AH-REFUND-TYPE            PIC X.
  4490         16  PB-ACCT-EFF-DT               PIC XX.
  4491         16  PB-ACCT-EXP-DT               PIC XX.
  4492         16  PB-COMPANY-ID                PIC X(3).
  4493         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4494         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4495         16  PB-SV-CARRIER                PIC X.
  4496         16  PB-SV-GROUPING               PIC X(6).
  4497         16  PB-SV-STATE                  PIC XX.
  4498         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4499         16  PB-GA-BILLING-INFO.
  4500             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4501                                          PIC XX.
  4502         16  PB-SV-REMIT-TO  REDEFINES
  4503             PB-GA-BILLING-INFO           PIC X(10).
  4504         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4505         16  PB-I-LOAN-OFFICER            PIC X(5).
  4506         16  PB-I-VIN                     PIC X(17).
  4507
  4508         16  FILLER                       PIC X(04).
  4509         16  IMNET-BYPASS-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  80
* EL6318.cbl
  4510
  4511******************************************************************
  4512*                COMMON EDIT ERRORS                              *
  4513******************************************************************
  4514
  4515     12  PB-COMMON-ERRORS.
  4516         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4517                                           PIC S9(4)     COMP.
  4518
  4519******************************************************************
  4520*                                COPY ELCCERT.
  4521******************************************************************
  4522*                                                                *
  4523*                            ELCCERT.                            *
  4524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4525*                            VMOD=2.013                          *
  4526*                                                                *
  4527*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4528*                                                                *
  4529*   FILE TYPE = VSAM,KSDS                                        *
  4530*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4531*                                                                *
  4532*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4533*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4534*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4535*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4536*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4537*                                                                *
  4538*   LOG = YES                                                    *
  4539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4540******************************************************************
  4541*                   C H A N G E   L O G
  4542*
  4543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4544*-----------------------------------------------------------------
  4545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4546* EFFECTIVE    NUMBER
  4547*-----------------------------------------------------------------
  4548* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4549* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4550* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4551* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4552* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4553* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4554* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4555* 032612  CR2011110200001  PEMA  AHL CHANGES
  4556******************************************************************
  4557
  4558 01  CERTIFICATE-MASTER.
  4559     12  CM-RECORD-ID                      PIC XX.
  4560         88  VALID-CM-ID                      VALUE 'CM'.
  4561
  4562     12  CM-CONTROL-PRIMARY.
  4563         16  CM-COMPANY-CD                 PIC X.
  4564         16  CM-CARRIER                    PIC X.
  4565         16  CM-GROUPING.
  4566             20  CM-GROUPING-PREFIX        PIC X(3).
  4567             20  CM-GROUPING-PRIME         PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  81
* EL6318.cbl
  4568         16  CM-STATE                      PIC XX.
  4569         16  CM-ACCOUNT.
  4570             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4571             20  CM-ACCOUNT-PRIME          PIC X(6).
  4572         16  CM-CERT-EFF-DT                PIC XX.
  4573         16  CM-CERT-NO.
  4574             20  CM-CERT-PRIME             PIC X(10).
  4575             20  CM-CERT-SFX               PIC X.
  4576
  4577     12  CM-CONTROL-BY-NAME.
  4578         16  CM-COMPANY-CD-A1              PIC X.
  4579         16  CM-INSURED-LAST-NAME          PIC X(15).
  4580         16  CM-INSURED-INITIALS.
  4581             20  CM-INSURED-INITIAL1       PIC X.
  4582             20  CM-INSURED-INITIAL2       PIC X.
  4583
  4584     12  CM-CONTROL-BY-SSN.
  4585         16  CM-COMPANY-CD-A2              PIC X.
  4586         16  CM-SOC-SEC-NO.
  4587             20  CM-SSN-STATE              PIC XX.
  4588             20  CM-SSN-ACCOUNT            PIC X(6).
  4589             20  CM-SSN-LN3.
  4590                 25  CM-INSURED-INITIALS-A2.
  4591                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4592                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4593                 25 CM-PART-LAST-NAME-A2         PIC X.
  4594
  4595     12  CM-CONTROL-BY-CERT-NO.
  4596         16  CM-COMPANY-CD-A4              PIC X.
  4597         16  CM-CERT-NO-A4                 PIC X(11).
  4598
  4599     12  CM-CONTROL-BY-MEMB.
  4600         16  CM-COMPANY-CD-A5              PIC X.
  4601         16  CM-MEMBER-NO.
  4602             20  CM-MEMB-STATE             PIC XX.
  4603             20  CM-MEMB-ACCOUNT           PIC X(6).
  4604             20  CM-MEMB-LN4.
  4605                 25  CM-INSURED-INITIALS-A5.
  4606                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4607                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4608                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4609
  4610     12  CM-INSURED-PROFILE-DATA.
  4611         16  CM-INSURED-FIRST-NAME.
  4612             20  CM-INSURED-1ST-INIT       PIC X.
  4613             20  FILLER                    PIC X(9).
  4614         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4615         16  CM-INSURED-SEX                PIC X.
  4616             88  CM-SEX-MALE                  VALUE 'M'.
  4617             88  CM-SEX-FEMAL                 VALUE 'F'.
  4618         16  CM-INSURED-JOINT-AGE          PIC 99.
  4619         16  CM-JOINT-INSURED-NAME.
  4620             20  CM-JT-LAST-NAME           PIC X(15).
  4621             20  CM-JT-FIRST-NAME.
  4622                 24  CM-JT-1ST-INIT        PIC X.
  4623                 24  FILLER                PIC X(9).
  4624             20  CM-JT-INITIAL             PIC X.
  4625
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  82
* EL6318.cbl
  4626     12  CM-LIFE-DATA.
  4627         16  CM-LF-BENEFIT-CD              PIC XX.
  4628         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4629         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4630         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4631         16  CM-LF-DEV-CODE                PIC XXX.
  4632         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4633         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4634         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4635         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4636         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4637         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4638         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4639         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4640         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4641         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4642         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4643         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4644         16  FILLER                        PIC XX.
  4645
  4646     12  CM-AH-DATA.
  4647         16  CM-AH-BENEFIT-CD              PIC XX.
  4648         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4649         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4650         16  CM-AH-DEV-CODE                PIC XXX.
  4651         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4652         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4653         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4654         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4655         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4656         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4657         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4658         16  CM-AH-PAID-THRU-DT            PIC XX.
  4659             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4660         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4661         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4662         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4663         16  FILLER                        PIC X.
  4664
  4665     12  CM-LOAN-INFORMATION.
  4666         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4667         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4668                                           PIC S9(5)V99  COMP-3.
  4669         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4670         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4671         16  CM-PAY-FREQUENCY              PIC S99.
  4672         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4673         16  CM-RATE-CLASS                 PIC XX.
  4674         16  CM-BENEFICIARY                PIC X(25).
  4675         16  CM-POLICY-FORM-NO             PIC X(12).
  4676         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4677         16  CM-LAST-ADD-ON-DT             PIC XX.
  4678         16  CM-DEDUCTIBLE-AMOUNTS.
  4679             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4680             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4681         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4682             20  CM-RESIDENT-STATE         PIC XX.
  4683             20  CM-RATE-CODE              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  83
* EL6318.cbl
  4684             20  FILLER                    PIC XX.
  4685         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4686             20  CM-LOAN-OFFICER           PIC X(5).
  4687             20  FILLER                    PIC XXX.
  4688         16  CM-CSR-CODE                   PIC XXX.
  4689         16  CM-UNDERWRITING-CODE          PIC X.
  4690             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4691         16  CM-POST-CARD-IND              PIC X.
  4692         16  CM-NH-INTERFACE-SW            PIC X.
  4693         16  CM-PREMIUM-TYPE               PIC X.
  4694             88  CM-SING-PRM                  VALUE '1'.
  4695             88  CM-O-B-COVERAGE              VALUE '2'.
  4696             88  CM-OPEN-END                  VALUE '3'.
  4697         16  CM-IND-GRP-TYPE               PIC X.
  4698             88  CM-INDIVIDUAL                VALUE 'I'.
  4699             88  CM-GROUP                     VALUE 'G'.
  4700         16  CM-SKIP-CODE                  PIC X.
  4701             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4702             88  SKIP-JULY                    VALUE '1'.
  4703             88  SKIP-AUGUST                  VALUE '2'.
  4704             88  SKIP-SEPTEMBER               VALUE '3'.
  4705             88  SKIP-JULY-AUG                VALUE '4'.
  4706             88  SKIP-AUG-SEPT                VALUE '5'.
  4707             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4708             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4709             88  SKIP-JUNE                    VALUE '8'.
  4710             88  SKIP-JUNE-JULY               VALUE '9'.
  4711             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4712             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4713         16  CM-PAYMENT-MODE               PIC X.
  4714             88  PAY-MONTHLY                  VALUE SPACE.
  4715             88  PAY-WEEKLY                   VALUE '1'.
  4716             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4717             88  PAY-BI-WEEKLY                VALUE '3'.
  4718             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4719         16  CM-LOAN-NUMBER                PIC X(8).
  4720         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4721         16  CM-OLD-LOF                    PIC XXX.
  4722*        16  CM-LOAN-OFFICER               PIC XXX.
  4723         16  CM-REIN-TABLE                 PIC XXX.
  4724         16  CM-SPECIAL-REIN-CODE          PIC X.
  4725         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4726         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4727         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4728
  4729     12  CM-STATUS-DATA.
  4730         16  CM-ENTRY-STATUS               PIC X.
  4731         16  CM-ENTRY-DT                   PIC XX.
  4732
  4733         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4734         16  CM-LF-CANCEL-DT               PIC XX.
  4735         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4736
  4737         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4738         16  CM-LF-DEATH-DT                PIC XX.
  4739         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4740
  4741         16  CM-LF-CURRENT-STATUS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  84
* EL6318.cbl
  4742             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4743                                                'M' '4' '5' '9'.
  4744             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4745             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4746             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4747             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4748             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4749             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4750             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4751             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4752             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4753             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4754             88  CM-LF-DECLINED               VALUE 'D'.
  4755             88  CM-LF-VOIDED                 VALUE 'V'.
  4756
  4757         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4758         16  CM-AH-CANCEL-DT               PIC XX.
  4759         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4760
  4761         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4762         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4763         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4764
  4765         16  CM-AH-CURRENT-STATUS          PIC X.
  4766             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4767                                                'M' '4' '5' '9'.
  4768             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4769             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4770             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4771             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4772             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4773             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4774             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4775             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4776             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4777             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4778             88  CM-AH-DECLINED               VALUE 'D'.
  4779             88  CM-AH-VOIDED                 VALUE 'V'.
  4780
  4781         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4782             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4783             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4784             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4785         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4786
  4787         16  CM-ENTRY-BATCH                PIC X(6).
  4788         16  CM-LF-EXIT-BATCH              PIC X(6).
  4789         16  CM-AH-EXIT-BATCH              PIC X(6).
  4790         16  CM-LAST-MONTH-END             PIC XX.
  4791
  4792     12  CM-NOTE-SW                        PIC X.
  4793         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4794         88  CERT-NOTES-PRESENT               VALUE '1'.
  4795         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4796         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4797         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4798         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4799         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  85
* EL6318.cbl
  4800         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4801     12  CM-COMP-EXCP-SW                   PIC X.
  4802         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4803         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4804     12  CM-INSURED-ADDRESS-SW             PIC X.
  4805         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4806         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4807
  4808*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4809     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4810     12  FILLER                            PIC X.
  4811
  4812*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4813     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4814     12  FILLER                            PIC X.
  4815*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4816     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4817
  4818     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4819         88  CERT-ADDED-BATCH                 VALUE ' '.
  4820         88  CERT-ADDED-ONLINE                VALUE '1'.
  4821         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4822         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4823         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4824     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4825         88  CERT-AS-LOADED                   VALUE ' '.
  4826         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4827         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4828         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4829         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4830         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4831         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4832         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4833
  4834     12  CM-ACCOUNT-COMM-PCTS.
  4835         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4836         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4837
  4838     12  CM-USER-FIELD                     PIC X.
  4839     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4840     12  CM-CLP-STATE                      PIC XX.
  4841     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4842     12  CM-USER-RESERVED                  PIC XXX.
  4843     12  FILLER REDEFINES CM-USER-RESERVED.
  4844         16  CM-AH-CLASS-CD                PIC XX.
  4845         16  F                             PIC X.
  4846******************************************************************
  4847*                                COPY ELCCRTO.
  4848******************************************************************
  4849*                                                                *
  4850*                            ELCCRTO.                            *
  4851*                                                                *
  4852*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4853*                                                                *
  4854*   FILE TYPE = VSAM,KSDS                                        *
  4855*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4856*                                                                *
  4857*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  86
* EL6318.cbl
  4858*                                                                *
  4859*   LOG = YES                                                    *
  4860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4861******************************************************************
  4862*                   C H A N G E   L O G
  4863*
  4864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4865*-----------------------------------------------------------------
  4866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4867* EFFECTIVE    NUMBER
  4868*-----------------------------------------------------------------
  4869* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4870* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4871* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4872* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4873* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4874******************************************************************
  4875 01  ORIGINAL-CERTIFICATE.
  4876     12  OC-RECORD-ID                      PIC XX.
  4877         88  VALID-OC-ID                      VALUE 'OC'.
  4878     12  OC-CONTROL-PRIMARY.
  4879         16  OC-COMPANY-CD                 PIC X.
  4880         16  OC-CARRIER                    PIC X.
  4881         16  OC-GROUPING                   PIC X(6).
  4882         16  OC-STATE                      PIC XX.
  4883         16  OC-ACCOUNT                    PIC X(10).
  4884         16  OC-CERT-EFF-DT                PIC XX.
  4885         16  OC-CERT-NO.
  4886             20  OC-CERT-PRIME             PIC X(10).
  4887             20  OC-CERT-SFX               PIC X.
  4888         16  OC-RECORD-TYPE                PIC X.
  4889         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4890     12  OC-LAST-MAINT-DT                  PIC XX.
  4891     12  OC-LAST-MAINT-BY                  PIC X(4).
  4892     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4893     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4894     12  FILLER                            PIC X(49).
  4895     12  OC-ORIG-REC.
  4896         16  OC-INS-LAST-NAME              PIC X(15).
  4897         16  OC-INS-FIRST-NAME             PIC X(10).
  4898         16  OC-INS-MIDDLE-INIT            PIC X.
  4899         16  OC-INS-AGE                    PIC S999     COMP-3.
  4900         16  OC-JNT-LAST-NAME              PIC X(15).
  4901         16  OC-JNT-FIRST-NAME             PIC X(10).
  4902         16  OC-JNT-MIDDLE-INIT            PIC X.
  4903         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4904         16  OC-LF-BENCD                   PIC XX.
  4905         16  OC-LF-TERM                    PIC S999      COMP-3.
  4906         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4907         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4908         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4909         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4910         16  OC-LF-EXP-DT                  PIC XX.
  4911         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4912         16  OC-LF-CANCEL-DT               PIC XX.
  4913         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4914         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4915         16  OC-AH-BENCD                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  87
* EL6318.cbl
  4916         16  OC-AH-TERM                    PIC S999      COMP-3.
  4917         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4918         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4919         16  OC-AH-EXP-DT                  PIC XX.
  4920         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4921         16  OC-AH-CP                      PIC 99.
  4922         16  OC-AH-CANCEL-DT               PIC XX.
  4923         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4924         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4925         16  OC-CRED-BENE-NAME             PIC X(25).
  4926         16  OC-1ST-PMT-DT                 PIC XX.
  4927         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4928         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4929         16  OC-ISSUE-TRAN-IND             PIC X.
  4930         16  OC-CANCEL-TRAN-IND            PIC X.
  4931         16  FILLER                        PIC X(211).
  4932
  4933     12  FILLER                            PIC X(50).
  4934******************************************************************
  4935*                                COPY ERCENDT.
  4936******************************************************************
  4937*                                                                *
  4938*                                                                *
  4939*                            ERCENDT.                            *
  4940*                            VMOD=2.001                          *
  4941*                                                                *
  4942*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4943*                                                                *
  4944*   FILE TYPE = VSAM,KSDS                                        *
  4945*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4946*                                                                *
  4947*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4948*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4949*                                                                *
  4950*   LOG = NO                                                     *
  4951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4952******************************************************************
  4953*-----------------------------------------------------------------
  4954*                   C H A N G E   L O G
  4955*
  4956* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4957*-----------------------------------------------------------------
  4958*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4959* EFFECTIVE    NUMBER
  4960*-----------------------------------------------------------------
  4961* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4962*                                WITH OPEN CLAIMS
  4963* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4964* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4965* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4966*-----------------------------------------------------------------
  4967 01  ENDORSEMENT-RECORD.
  4968     12  EN-RECORD-ID                PIC XX.
  4969         88  VALID-EN-ID                VALUE 'EN'.
  4970     12  EN-CONTROL-PRIMARY.
  4971         16  EN-COMPANY-CD           PIC X.
  4972         16  EN-CARRIER              PIC X.
  4973         16  EN-GROUPING             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  88
* EL6318.cbl
  4974         16  EN-STATE                PIC XX.
  4975         16  EN-ACCOUNT              PIC X(10).
  4976         16  EN-CERT-EFF-DT          PIC XX.
  4977         16  EN-CERT-NO.
  4978             20  EN-CERT-PRIME       PIC X(10).
  4979             20  EN-CERT-SFX         PIC X.
  4980         16  EN-REC-TYPE             PIC X.
  4981             88  EN-ISSUE               VALUE 'I'.
  4982             88  EN-CANCELLATION        VALUE 'C'.
  4983         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4984     12  EN-CONTROL-BY-ARCH-NO.
  4985         16  EN-COMPANY-CD-A1              PIC X.
  4986         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4987     12  EN-LAST-MAINT-DT            PIC XX.
  4988     12  EN-LAST-MAINT-BY            PIC X(4).
  4989     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4990     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4991     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4992         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4993         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4994         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4995         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4996         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4997         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4998         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4999         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5000         16  EN-LF-ORIG-BENCD        PIC XX.
  5001         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5002         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5003         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5004         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5005         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5006         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5007*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5008         16  EN-ORIG-CRED-BENE       PIC X(25).
  5009         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5010         16  FILLER                  PIC X.
  5011         16  EN-AH-ORIG-BENCD        PIC XX.
  5012         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5013         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5014         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5015         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5016*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5017*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5018         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5019         16  F                       PIC X(09).
  5020         16  EN-AH-ORIG-CP           PIC 99.
  5021         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5022         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5023         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5024         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5025         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5026         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5027         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5028         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5029         16  EN-LF-NEW-BENCD         PIC XX.
  5030         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5031         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  89
* EL6318.cbl
  5032         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5033         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5034         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5035         16  EN-LF-NEW-EXP-DT        PIC XX.
  5036         16  EN-NEW-CRED-BENE        PIC X(25).
  5037         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5038         16  FILLER                  PIC X.
  5039         16  EN-AH-NEW-BENCD         PIC XX.
  5040         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5041         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5042         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5043         16  EN-AH-NEW-EXP-DT        PIC XX.
  5044*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5045*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5046*        16  F                       PIC X(12).
  5047         16  EN-AH-NEW-CP            PIC 99.
  5048         16  EN-SIG-SW               PIC X.
  5049         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5050         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5051         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5052         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5053         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5054         16  FILLER                  PIC X(33).
  5055     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5056         16  EN-LF-ORIG-REF-DT       PIC XX.
  5057         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5058         16  EN-AH-ORIG-REF-DT       PIC XX.
  5059         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5060         16  EN-LF-NEW-REF-DT        PIC XX.
  5061         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5062         16  EN-AH-NEW-REF-DT        PIC XX.
  5063         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5064         16  EN-FLAG-CERT            PIC X.
  5065         16  EN-INS-LAST-NAME        PIC X(15).
  5066         16  EN-INS-FIRST-NAME       PIC X(10).
  5067         16  EN-INS-MIDDLE-INIT      PIC X.
  5068         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5069         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5070         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5071         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5072         16  FILLER                  PIC X(262).
  5073     12  EN-MONEY-SW             PIC X.
  5074     12  EN-HEALTH-APP           PIC X.
  5075     12  EN-VOUCHER-SW           PIC X.
  5076     12  EN-PAYEE                PIC X(14).
  5077     12  EN-INPUT-DT             PIC XX.
  5078     12  EN-PROCESS-DT           PIC XX.
  5079     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5080     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5081     12  EN-REASON-CODES.
  5082         16  F OCCURS 12.
  5083             20  EN-REASON-CODE  PIC X(4).
  5084     12  EN-TEMPLATE-USED        PIC X(8).
  5085     12  EN-DOCU-TYPE            PIC X.
  5086         88  EN-VERI-DOCU          VALUE 'V'.
  5087         88  EN-GCE-DOCU           VALUE 'G'.
  5088         88  EN-CANC-DOCU          VALUE 'C'.
  5089     12  EN-COMMENTS1            PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  90
* EL6318.cbl
  5090     12  EN-COMMENTS2            PIC X(70).
  5091     12  EN-COMM-CHGBK           PIC X.
  5092         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5093         88  EN-CHG-ACCT           VALUE 'Y'.
  5094     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5095     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5096     12  EN-BATCH-NUMBER         PIC X(6).
  5097     12  EN-ACCT-SUMM            PIC X.
  5098     12  EN-CSO-SUMM             PIC X.
  5099     12  FILLER                  PIC X(13).
  5100******************************************************************
  5101*                                COPY ERCNOTE.
  5102******************************************************************
  5103*                                                                *
  5104*                                                                *
  5105*                            ERCNOTE                             *
  5106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5107*                            VMOD=2.003                          *
  5108*                                                                *
  5109*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5110*                                                                *
  5111*        FILE TYPE= VSAM,KSDS                                    *
  5112*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5113*                                                                *
  5114*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5115*                                                                *
  5116*        LOG = YES                                               *
  5117*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5118*                                                                *
  5119******************************************************************
  5120*                   C H A N G E   L O G
  5121*
  5122* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5123*-----------------------------------------------------------------
  5124*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5125* EFFECTIVE    NUMBER
  5126*-----------------------------------------------------------------
  5127* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5128*                                FILE WILL CONTAIN BILLING NOTES O
  5129******************************************************************
  5130
  5131 01  CERTIFICATE-NOTE.
  5132     12  CN-RECORD-ID                PIC  XX.
  5133         88  VALID-CN-ID                  VALUE 'CN'.
  5134
  5135     12  CN-CONTROL-PRIMARY.
  5136         16  CN-COMPANY-CD           PIC X.
  5137         16  CN-CARRIER              PIC X.
  5138         16  CN-GROUPING.
  5139             20 CN-GROUPING-PREFIX   PIC XXX.
  5140             20 CN-GROUPING-PRIME    PIC XXX.
  5141         16  CN-STATE                PIC XX.
  5142         16  CN-ACCOUNT.
  5143             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5144             20 CN-ACCOUNT-PRIME     PIC X(6).
  5145         16  CN-CERT-EFF-DT          PIC XX.
  5146         16  CN-CERT-NO.
  5147             20  CN-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  91
* EL6318.cbl
  5148             20  CN-CERT-SFX         PIC X.
  5149
  5150     12  CN-BILLING-START-LINE-NO    PIC 99.
  5151     12  CN-BILLING-END-LINE-NO      PIC 99.
  5152
  5153     12  CN-LINES.
  5154         16  CN-LINE OCCURS 10       PIC X(77).
  5155
  5156     12  CN-LAST-MAINT-DT            PIC XX.
  5157     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5158     12  CN-LAST-MAINT-USER          PIC X(4).
  5159     12  FILLER                      PIC X(6).
  5160******************************************************************
  5161*                                COPY ERCMAIL.
  5162******************************************************************
  5163*                                                                *
  5164*                                                                *
  5165*                            ERCMAIL                             *
  5166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5167*                            VMOD=2.003                          *
  5168*                                                                *
  5169*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5170*                                                                *
  5171*   FILE TYPE = VSAM,KSDS                                        *
  5172*   RECORD SIZE = 374   RECFORM = FIX                            *
  5173*                                                                *
  5174*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5175*   ALTERNATE PATH    = NOT USED                                 *
  5176*                                                                *
  5177*   LOG = YES                                                    *
  5178*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5179******************************************************************
  5180*                   C H A N G E   L O G
  5181*
  5182* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5183*-----------------------------------------------------------------
  5184*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5185* EFFECTIVE    NUMBER
  5186*-----------------------------------------------------------------
  5187* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5188* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5189* 111108                   PEMA  ADD CRED BENE ADDR2
  5190******************************************************************
  5191
  5192 01  MAILING-DATA.
  5193     12  MA-RECORD-ID                      PIC XX.
  5194         88  VALID-MA-ID                       VALUE 'MA'.
  5195
  5196     12  MA-CONTROL-PRIMARY.
  5197         16  MA-COMPANY-CD                 PIC X.
  5198         16  MA-CARRIER                    PIC X.
  5199         16  MA-GROUPING.
  5200             20  MA-GROUPING-PREFIX        PIC XXX.
  5201             20  MA-GROUPING-PRIME         PIC XXX.
  5202         16  MA-STATE                      PIC XX.
  5203         16  MA-ACCOUNT.
  5204             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5205             20  MA-ACCOUNT-PRIME          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  92
* EL6318.cbl
  5206         16  MA-CERT-EFF-DT                PIC XX.
  5207         16  MA-CERT-NO.
  5208             20  MA-CERT-PRIME             PIC X(10).
  5209             20  MA-CERT-SFX               PIC X.
  5210
  5211     12  FILLER                            PIC XX.
  5212
  5213     12  MA-ACCESS-CONTROL.
  5214         16  MA-SOURCE-SYSTEM              PIC XX.
  5215             88  MA-FROM-CREDIT                VALUE 'CR'.
  5216             88  MA-FROM-VSI                   VALUE 'VS'.
  5217             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5218             88  MA-FROM-OTHER                 VALUE 'OT'.
  5219         16  MA-RECORD-ADD-DT              PIC XX.
  5220         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5221         16  MA-LAST-MAINT-DT              PIC XX.
  5222         16  MA-LAST-MAINT-BY              PIC XXXX.
  5223         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5224
  5225     12  MA-PROFILE-INFO.
  5226         16  MA-QUALIFY-CODE-1             PIC XX.
  5227         16  MA-QUALIFY-CODE-2             PIC XX.
  5228         16  MA-QUALIFY-CODE-3             PIC XX.
  5229         16  MA-QUALIFY-CODE-4             PIC XX.
  5230         16  MA-QUALIFY-CODE-5             PIC XX.
  5231
  5232         16  MA-INSURED-LAST-NAME          PIC X(15).
  5233         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5234         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5235         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5236         16  MA-INSURED-BIRTH-DT           PIC XX.
  5237         16  MA-INSURED-SEX                PIC X.
  5238             88  MA-SEX-MALE                   VALUE 'M'.
  5239             88  MA-SEX-FEMALE                 VALUE 'F'.
  5240         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5241
  5242         16  MA-ADDRESS-CORRECTED          PIC X.
  5243         16  MA-JOINT-BIRTH-DT             PIC XX.
  5244*        16  FILLER                        PIC X(12).
  5245
  5246         16  MA-ADDRESS-LINE-1             PIC X(30).
  5247         16  MA-ADDRESS-LINE-2             PIC X(30).
  5248         16  MA-CITY-STATE.
  5249             20  MA-CITY                   PIC X(28).
  5250             20  MA-ADDR-STATE             PIC XX.
  5251         16  MA-ZIP.
  5252             20  MA-ZIP-CODE.
  5253                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5254                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5255                 24  FILLER                PIC X(4).
  5256             20  MA-ZIP-PLUS4              PIC X(4).
  5257         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5258             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5259             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5260             20  FILLER                    PIC X(3).
  5261
  5262         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5263
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  93
* EL6318.cbl
  5264         16  FILLER                        PIC XXX.
  5265*        16  FILLER                        PIC X(10).
  5266
  5267     12  MA-CRED-BENE-INFO.
  5268         16  MA-CRED-BENE-NAME                 PIC X(25).
  5269         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5270         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5271         16  MA-CRED-BENE-CTYST.
  5272             20  MA-CRED-BENE-CITY             PIC X(28).
  5273             20  MA-CRED-BENE-STATE            PIC XX.
  5274         16  MA-CRED-BENE-ZIP.
  5275             20  MA-CB-ZIP-CODE.
  5276                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5277                     88  MA-CB-CANADIAN-POST-CODE
  5278                                           VALUE 'A' THRU 'Z'.
  5279                 24  FILLER                    PIC X(4).
  5280             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5281         16  MA-CB-CANADIAN-POSTAL-CODE
  5282                            REDEFINES MA-CRED-BENE-ZIP.
  5283             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5284             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5285             20  FILLER                        PIC X(3).
  5286     12  MA-POST-CARD-MAIL-DATA.
  5287         16  MA-MAIL-DATA OCCURS 7.
  5288             20  MA-MAIL-TYPE              PIC X.
  5289                 88  MA-12MO-MAILING           VALUE '1'.
  5290                 88  MA-EXP-MAILING            VALUE '2'.
  5291             20  MA-MAIL-STATUS            PIC X.
  5292                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5293                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5294                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5295             20  MA-MAIL-DATE              PIC XX.
  5296     12  FILLER                            PIC XX.
  5297     12  FILLER                            PIC XX.
  5298*    12  FILLER                            PIC X(30).
  5299******************************************************************
  5300*                                COPY ERCARCH.
  5301******************************************************************
  5302*                                                                *
  5303*                            ERCARCH.                            *
  5304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5305*                            VMOD=2.002                          *
  5306*                                                                *
  5307*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5308*                                                                *
  5309*   FILE TYPE = VSAM,KSDS                                        *
  5310*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5311*                                                                *
  5312*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5313*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5314*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5315*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5316*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5317*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5318*                                                                *
  5319*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5320******************************************************************
  5321*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  94
* EL6318.cbl
  5322*
  5323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5324*-----------------------------------------------------------------
  5325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5326* EFFECTIVE    NUMBER
  5327*-----------------------------------------------------------------
  5328* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5329* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5330* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5331******************************************************************
  5332 01  LETTER-ARCHIVE.
  5333     12  LA-RECORD-ID                PIC  X(02).
  5334         88  LA-VALID-ID                VALUE 'LA'.
  5335
  5336     12  LA-CONTROL-PRIMARY.
  5337         16  LA-COMPANY-CD           PIC  X(01).
  5338         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5339
  5340     12  LA-CONTROL-BY-CERT-RESP.
  5341         16  LA-COMPANY-CD-A2        PIC  X(01).
  5342         16  LA-CERT-NO-A2.
  5343             20  LA-CERT-PRIME-A2    PIC  X(10).
  5344             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5345         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5346             20  LA-RESP-PERSON-A2   PIC  X(10).
  5347             20  LA-TYPE-A2          PIC  X(01).
  5348         16  LA-CARRIER-A2           PIC  X(01).
  5349         16  LA-GROUPING-A2          PIC  X(06).
  5350         16  LA-STATE-A2             PIC  X(02).
  5351         16  LA-ACCOUNT-A2           PIC  X(10).
  5352         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5353         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5354
  5355     12  LA-CONTROL-BY-FORM.
  5356         16  LA-COMPANY-CD-A3        PIC  X(01).
  5357         16  LA-FORM-A3              PIC  X(04).
  5358         16  LA-CARRIER-A3           PIC  X(01).
  5359         16  LA-GROUPING-A3          PIC  X(06).
  5360         16  LA-STATE-A3             PIC  X(02).
  5361         16  LA-ACCOUNT-A3           PIC  X(10).
  5362         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5363
  5364     12  LA-CONTROL-BY-PROCESSOR.
  5365         16  LA-COMPANY-CD-A4        PIC  X(01).
  5366         16  LA-PROCESSOR-CD         PIC  X(04).
  5367         16  LA-CARRIER-A4           PIC  X(01).
  5368         16  LA-GROUPING-A4          PIC  X(06).
  5369         16  LA-STATE-A4             PIC  X(02).
  5370         16  LA-ACCOUNT-A4           PIC  X(10).
  5371         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5372
  5373     12  LA-CONTROL-BY-KEY-FIELDS.
  5374         16  LA-COMPANY-CD-A5        PIC  X(01).
  5375         16  LA-CARRIER-A5           PIC  X(01).
  5376         16  LA-GROUPING-A5          PIC  X(06).
  5377         16  LA-STATE-A5             PIC  X(02).
  5378         16  LA-ACCOUNT-A5           PIC  X(10).
  5379         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  95
* EL6318.cbl
  5380
  5381     12  LA-CONTROL-BY-GROUP-CODE.
  5382         16  LA-COMPANY-CD-A6        PIC  X(01).
  5383         16  LA-ENTRY-A6.
  5384             20  LA-FILLER           PIC  X(02).
  5385             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5386         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5387
  5388     12  FILLER                      PIC  X(09).
  5389
  5390     12  LA-HEADER-RECORD.
  5391         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5392         16  LA-CREATION-DATE        PIC  X(02).
  5393         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5394         16  LA-FINAL-ACT-DATE       REDEFINES
  5395               LA-FOLLOW-UP-DATE     PIC  X(02).
  5396         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5397         16  LA-NO-OF-COPIES         PIC S9(01).
  5398         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5399         16  LA-REPLY-DATE           PIC  X(02).
  5400         16  LA-RESEND-DATES.
  5401             20  LA-RESEND-DATE      PIC  X(02).
  5402             20  LA-SENT-DATE        PIC  X(02).
  5403             20  FILLER              PIC  X(08).
  5404         16  LA-SOURCE-INFORMATION.
  5405             20  LA-DATA-SOURCE      PIC  X(01).
  5406             20  LA-ADDR-SOURCE      PIC  X(01).
  5407         16  LA-STATUS               PIC  X(01).
  5408             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5409             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5410             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5411             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5412             88  LA-STATUS-PURGED         VALUE 'P'.
  5413             88  LA-STATUS-VOIDED         VALUE 'V'.
  5414         16  LA-LAST-RESENT-PRINT-DATE
  5415                                     PIC  X(02).
  5416         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5417             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5418                                          VALUE 'C'.
  5419             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5420                                          VALUE 'F'.
  5421             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5422                                          VALUE 'P'.
  5423         16  LA-PURGED-DATE          PIC  X(02).
  5424         16  LA-VOIDED-DATE          PIC  X(02).
  5425         16  LA-RESEND-LETR          PIC  X(4).
  5426         16  FILLER                  PIC  X(08).
  5427*        16  LA-RESEND-LETR-2        PIC  X(4).
  5428*        16  LA-RESEND-LETR-3        PIC  X(4).
  5429*        16  FILLER                  PIC  X(59).
  5430         16  LA-ARCHIVE-STATUS       PIC  X.
  5431             88  LA-TEMP                VALUE 'T'.
  5432             88  LA-QWS                 VALUE 'Q'.
  5433             88  LA-BATCH               VALUE 'B'.
  5434         16  LA-FINAL-ACT-IND        PIC  X(1).
  5435         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5436         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5437         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  96
* EL6318.cbl
  5438                                     PIC X(4).
  5439         16  FILLER                  PIC  X(42).
  5440*        16  FILLER                  PIC  X(71).
  5441         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5442         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5443         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5444                                     PIC  X(4).
  5445         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5446
  5447******************************************************************
  5448*                                COPY ERCCNOT.
  5449******************************************************************
  5450*                                                                *
  5451*                            ERCCNOT                             *
  5452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5453*                            VMOD=2.003                          *
  5454*                                                                *
  5455*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5456*                                                                *
  5457*        FILE TYPE= VSAM,KSDS                                    *
  5458*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5459*                                                                *
  5460*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5461*                                                                *
  5462*        LOG = YES                                               *
  5463*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5464*                                                                *
  5465******************************************************************
  5466*                   C H A N G E   L O G
  5467*
  5468* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5469*-----------------------------------------------------------------
  5470*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5471* EFFECTIVE    NUMBER
  5472*-----------------------------------------------------------------
  5473* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5474******************************************************************
  5475
  5476 01  CERT-NOTE-FILE.
  5477     12  CZ-RECORD-ID                PIC  XX.
  5478         88  VALID-CZ-ID                  VALUE 'CZ'.
  5479
  5480     12  CZ-CONTROL-PRIMARY.
  5481         16  CZ-COMPANY-CD           PIC X.
  5482         16  CZ-CARRIER              PIC X.
  5483         16  CZ-GROUPING.
  5484             20 CZ-GROUPING-PREFIX   PIC XXX.
  5485             20 CZ-GROUPING-PRIME    PIC XXX.
  5486         16  CZ-STATE                PIC XX.
  5487         16  CZ-ACCOUNT.
  5488             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5489             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5490         16  CZ-CERT-EFF-DT          PIC XX.
  5491         16  CZ-CERT-NO.
  5492             20  CZ-CERT-PRIME       PIC X(10).
  5493             20  CZ-CERT-SFX         PIC X.
  5494         16  CZ-RECORD-TYPE          PIC X.
  5495             88  CERT-NOTE           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  97
* EL6318.cbl
  5496             88  CLAIM-CERT-NOTE     VALUE '2'.
  5497         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5498
  5499     12  CZ-LAST-MAINT-DT            PIC XX.
  5500     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5501     12  CZ-LAST-MAINT-USER          PIC X(4).
  5502
  5503     12  CZ-NOTE-INFORMATION.
  5504         16  CZ-NOTE                 PIC X(63).
  5505         16  FILLER                  PIC X(39).
  5506******************************************************************
  5507*                                COPY ELCEOBC.
  5508******************************************************************
  5509*                                                                *
  5510*                                                                *
  5511*                            ELCEOBC                             *
  5512*                            VMOD=2.001                          *
  5513*                                                                *
  5514*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5515*                                                                *
  5516*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5517*   VSAM EOB CODE TABLE                                          *
  5518*                                                                *
  5519*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5520*                                                                *
  5521*   FILE TYPE = VSAM,KSDS                                        *
  5522*   RECORD SIZE = 350   RECFORM = FIX                            *
  5523*                                                                *
  5524*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5525*                                                                *
  5526*   LOG = NO                                                     *
  5527*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5528*                                                                *
  5529*                                                                *
  5530******************************************************************
  5531*                   C H A N G E   L O G
  5532*
  5533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5534*-----------------------------------------------------------------
  5535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5536* EFFECTIVE    NUMBER
  5537*-----------------------------------------------------------------
  5538* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5539* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5540* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5541******************************************************************
  5542 01  EOB-CODES.
  5543     12  EO-RECORD-ID                      PIC XX.
  5544         88  VALID-DN-ID                      VALUE 'EO'.
  5545     12  EO-CONTROL-PRIMARY.
  5546         16  EO-COMPANY-CD                 PIC X.
  5547         16  EO-RECORD-TYPE                PIC X.
  5548             88  EO-EOB-RECS                  VALUE '1'.
  5549             88  EO-VERIF-RECS                VALUE '2'.
  5550             88  EO-GCE-RECS                  VALUE '3'.
  5551             88  EO-CANC-RECS                 VALUE '4'.
  5552             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5553         16  EO-EOB-CODE                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  98
* EL6318.cbl
  5554         16  FILLER                        PIC X(9).
  5555     12  EO-MAINT-INFORMATION.
  5556         16  EO-LAST-MAINT-DT              PIC XX.
  5557         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5558         16  EO-LAST-MAINT-USER            PIC X(4).
  5559         16  FILLER                        PIC XX.
  5560     12  EO-DESCRIPTION                    PIC X(275).
  5561     12  FILLER                            PIC X(46).
  5562******************************************************************
  5563*                                COPY ELCCRTT.
  5564******************************************************************
  5565*                                                                *
  5566*                            ELCCRTT.                            *
  5567*                                                                *
  5568*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5569*                                                                *
  5570*   FILE TYPE = VSAM,KSDS                                        *
  5571*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5572*                                                                *
  5573*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5574*                                                                *
  5575*   LOG = YES                                                    *
  5576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5577******************************************************************
  5578*                   C H A N G E   L O G
  5579*
  5580* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5581*-----------------------------------------------------------------
  5582*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5583* EFFECTIVE    NUMBER
  5584*-----------------------------------------------------------------
  5585* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5586* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5587* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5588* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5589* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5590******************************************************************
  5591
  5592 01  CERTIFICATE-TRAILERS.
  5593     12  CS-RECORD-ID                      PIC XX.
  5594         88  VALID-CS-ID                      VALUE 'CS'.
  5595
  5596     12  CS-CONTROL-PRIMARY.
  5597         16  CS-COMPANY-CD                 PIC X.
  5598         16  CS-CARRIER                    PIC X.
  5599         16  CS-GROUPING                   PIC X(6).
  5600         16  CS-STATE                      PIC XX.
  5601         16  CS-ACCOUNT                    PIC X(10).
  5602         16  CS-CERT-EFF-DT                PIC XX.
  5603         16  CS-CERT-NO.
  5604             20  CS-CERT-PRIME             PIC X(10).
  5605             20  CS-CERT-SFX               PIC X.
  5606         16  CS-TRAILER-TYPE               PIC X.
  5607             88  COMM-TRLR           VALUE 'A'.
  5608             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5609             88  CERT-DATA-TRLR      VALUE 'C'.
  5610
  5611     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  99
* EL6318.cbl
  5612
  5613     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5614         16  CS-BANK-COMMISSION-AREA.
  5615             20  CS-BANK-COMMS       OCCURS 10.
  5616                 24  CS-AGT                PIC X(10).
  5617                 24  CS-COM-TYP            PIC X.
  5618                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5619                 24  CS-RECALC-LV-INDIC    PIC X.
  5620                 24  FILLER                PIC X(10).
  5621         16  FILLER                        PIC X(256).
  5622
  5623     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5624****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5625****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5626         16  CS-MB-CLAIM-DATA OCCURS 2.
  5627             20  FILLER OCCURS 10.
  5628                 24  CS-CLAIM-TYPE         PIC X.
  5629                     88  CS-AH-CLM           VALUE 'A'.
  5630                     88  CS-IU-CLM           VALUE 'I'.
  5631                     88  CS-GP-CLM           VALUE 'G'.
  5632                     88  CS-LF-CLM           VALUE 'L'.
  5633                     88  CS-PR-CLM           VALUE 'P'.
  5634                 24  CS-BANK               PIC S999 COMP-3.
  5635                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5636                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5637                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5638         16  FILLER                        PIC X(216).
  5639     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5640         16  CS-VIN-NUMBER                 PIC X(17).
  5641         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5642         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5643         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5644         16  FILLER                        PIC X(496).
  5645******************************************************************
  5646 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5647                          ACCOUNT-MASTER CONTROL-FILE
  5648                          PENDING-BUSINESS CERTIFICATE-MASTER
  5649                          ORIGINAL-CERTIFICATE
  5650                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5651                          MAILING-DATA LETTER-ARCHIVE
  5652                          CERT-NOTE-FILE EOB-CODES
  5653                          CERTIFICATE-TRAILERS.
  5654 0000-DFHEXIT SECTION.
  5655     MOVE '9#                    $   ' TO DFHEIV0.
  5656     MOVE 'EL6318' TO DFHEIV1.
  5657     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5658     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5659     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5660     MOVE '5'                    TO DC-OPTION-CODE
  5661     PERFORM 9700-DATE-LINK
  5662     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5663     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5664     MOVE EIBTRMID               TO QID-TERM
  5665     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5666     IF EIBCALEN = 0
  5667        GO TO 8800-UNAUTHORIZED-ACCESS
  5668     END-IF
  5669     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 100
* EL6318.cbl
  5670     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5671        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5672           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5673           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5674           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5675           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5676           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5677           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5678           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5679           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5680           MOVE LOW-VALUES           TO EL631KI
  5681           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5682           GO TO 0350-BUILD-INIT-MAP
  5683        END-IF
  5684     END-IF
  5685     IF PI-CALLING-PROGRAM = 'EL614'
  5686        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5687                                 TO WS-PASSED-REASON-CODES
  5688        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5689        IF WS-PASSED-REASON-CODES NOT = SPACES
  5690           MOVE 'Y'                TO WS-SET-CODES-MDT
  5691        ELSE
  5692           MOVE 'N'                TO WS-SET-CODES-MDT
  5693        END-IF
  5694        PERFORM 0600-RECOVER-TEMP-STORAGE
  5695                                 THRU 0600-EXIT
  5696        GO TO 0350-BUILD-INIT-MAP
  5697     END-IF
  5698     IF EIBAID = DFHCLEAR
  5699        IF PI-CLEAR-ERROR
  5700           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5701           MOVE ER-3833           TO EMI-ERROR
  5702           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5703           GO TO 0350-BUILD-INIT-MAP
  5704        ELSE
  5705           GO TO 9400-CLEAR
  5706        END-IF
  5707     END-IF
  5708     .
  5709 0200-RECEIVE.
  5710     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5711        MOVE ER-0008             TO EMI-ERROR
  5712        PERFORM 9900-ERROR-FORMAT
  5713                                 THRU 9900-EXIT
  5714        MOVE -1                  TO PFENTRL
  5715        GO TO 8100-SEND-INITIAL-MAP
  5716     END-IF
  5717
  5718* EXEC CICS RECEIVE
  5719*        MAP      (MAP-NAME)
  5720*        MAPSET   (MAPSET-NAME)
  5721*        INTO     (EL631KI)
  5722*    END-EXEC
  5723     MOVE LENGTH OF
  5724      EL631KI
  5725       TO DFHEIV11
  5726*    MOVE '8"T I  L              ''   #00005713' TO DFHEIV0
  5727     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 101
* EL6318.cbl
  5728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5729     MOVE X'2020233030303035373133' TO DFHEIV0(25:11)
  5730     CALL 'kxdfhei1' USING DFHEIV0,
  5731           MAP-NAME,
  5732           EL631KI,
  5733           DFHEIV11,
  5734           MAPSET-NAME,
  5735           DFHEIV99,
  5736           DFHEIV99
  5737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5738     IF PFENTRL = 0
  5739         GO TO 0300-CHECK-PFKEYS
  5740     END-IF
  5741     IF EIBAID NOT = DFHENTER
  5742         MOVE ER-0004            TO EMI-ERROR
  5743         GO TO 0320-INPUT-ERROR
  5744     END-IF
  5745     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5746        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5747     ELSE
  5748        MOVE ER-0029            TO EMI-ERROR
  5749        GO TO 0320-INPUT-ERROR
  5750     END-IF
  5751     .
  5752 0300-CHECK-PFKEYS.
  5753     IF EIBAID = DFHPF3
  5754        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5755        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5756        MOVE 'EL614'             TO PGM-NAME
  5757        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5758        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5759        move +1                  to s2
  5760        perform varying s1 from +1 by +1 until s1 > +12
  5761           if reacd-in (s1) not = spaces and low-values
  5762              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5763              add +5 to s2
  5764           end-if
  5765        END-perform
  5766        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5767        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5768        GO TO 9300-XCTL
  5769     END-IF
  5770     IF EIBAID = DFHPF4 OR DFHPF8
  5771        GO TO 0360-FINALIZE
  5772     END-IF
  5773     IF EIBAID = DFHPF23
  5774        IF PI-CLEAR-ERROR
  5775           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5776           MOVE ER-3833           TO EMI-ERROR
  5777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5778           GO TO 0350-BUILD-INIT-MAP
  5779        ELSE
  5780           GO TO 8810-PF23
  5781        END-IF
  5782     END-IF
  5783     IF EIBAID = DFHPF24
  5784        IF PI-CLEAR-ERROR
  5785           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 102
* EL6318.cbl
  5786           MOVE ER-3833           TO EMI-ERROR
  5787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5788           GO TO 0350-BUILD-INIT-MAP
  5789        ELSE
  5790           GO TO 9200-RETURN-MAIN-MENU
  5791        END-IF
  5792     END-IF
  5793     IF EIBAID = DFHPF12
  5794        GO TO 9500-PF12
  5795     END-IF
  5796     IF EIBAID = DFHENTER
  5797        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5798        GO TO 0325-EDIT-SCREEN
  5799     END-IF
  5800     MOVE ER-0029                TO EMI-ERROR
  5801     .
  5802 0320-INPUT-ERROR.
  5803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5804     MOVE AL-UNBON               TO PFENTRA
  5805     MOVE -1                     TO PFENTRL
  5806     GO TO 8200-SEND-DATAONLY
  5807     .
  5808 0325-EDIT-SCREEN.
  5809     IF PRTSWL > ZEROS
  5810       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5811*          MOVE AL-UANON       TO PRTSWA
  5812*          IF PRTSWI = ' '
  5813*             MOVE 'N'         TO PRTSWI
  5814              MOVE 'P'         TO PRTSWI
  5815*          END-IF
  5816*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5817        END-IF
  5818     END-IF
  5819     IF LTRIDL > ZEROS
  5820        AND LTRIDI > SPACES
  5821        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5822        MOVE LTRIDI              TO LETR-LETTER-ID
  5823                                    PI-LTRID-ENTERED
  5824        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5825        MOVE SPACES              TO LETR-FILLER
  5826        MOVE 0                   TO LETR-SEQ-NO
  5827        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5828     ELSE
  5829        MOVE ER-1236          TO EMI-ERROR
  5830        MOVE -1               TO LTRIDL
  5831        MOVE AL-UABON         TO LTRIDA
  5832        PERFORM 9900-ERROR-FORMAT
  5833                                 THRU 9900-EXIT
  5834     END-IF
  5835
  5836     IF W-SIG-FLAG-DEFAULT > ' '
  5837        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  5838             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  5839             MOVE +1 TO SIGREQL
  5840             MOVE ER-1664     TO EMI-ERROR
  5841             MOVE AL-UABON    TO SIGREQA
  5842             PERFORM 9900-ERROR-FORMAT
  5843                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 103
* EL6318.cbl
  5844        ELSE
  5845             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  5846             MOVE +1 TO SIGREQL
  5847             MOVE AL-UANON    TO SIGREQA
  5848        END-IF
  5849     END-IF
  5850
  5851     IF (SIGREQL > ZEROS)
  5852        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5853        MOVE AL-UANON         TO SIGREQA
  5854        IF SIGREQI = ' '
  5855           MOVE 'N'           TO SIGREQI
  5856        END-IF
  5857        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5858     ELSE
  5859        MOVE ER-2651          TO EMI-ERROR
  5860        MOVE -1               TO SIGREQL
  5861        MOVE AL-UABON         TO SIGREQA
  5862        PERFORM 9900-ERROR-FORMAT
  5863                                 THRU 9900-EXIT
  5864     END-IF
  5865
  5866     IF W-PROMPT-LETTER EQUAL 'Y'
  5867         MOVE ER-0894            TO EMI-ERROR
  5868         MOVE -1                 TO LTRIDL
  5869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5870     END-IF
  5871     IF VOUCHL > ZEROS
  5872        IF VOUCHI = 'Y' OR 'N'
  5873           MOVE AL-UANON         TO VOUCHA
  5874           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5875        ELSE
  5876           MOVE ER-9999          TO EMI-ERROR
  5877           MOVE -1               TO VOUCHL
  5878           MOVE AL-UABON         TO VOUCHA
  5879           PERFORM 9900-ERROR-FORMAT
  5880                                 THRU 9900-EXIT
  5881        END-IF
  5882     END-IF
  5883     IF HLTHAPPL > ZEROS
  5884        IF HLTHAPPI = 'Y' OR 'N'
  5885           MOVE AL-UANON         TO HLTHAPPA
  5886           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5887        ELSE
  5888           MOVE ER-9999          TO EMI-ERROR
  5889           MOVE -1               TO HLTHAPPL
  5890           MOVE AL-UABON         TO HLTHAPPA
  5891           PERFORM 9900-ERROR-FORMAT
  5892                                 THRU 9900-EXIT
  5893        END-IF
  5894     END-IF
  5895     IF PAYEEL > ZEROS
  5896        IF PAYEEI > SPACES
  5897           MOVE AL-UANON         TO PAYEEA
  5898           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5899        ELSE
  5900           MOVE ER-9999          TO EMI-ERROR
  5901           MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 104
* EL6318.cbl
  5902           MOVE AL-UABON         TO PAYEEA
  5903           PERFORM 9900-ERROR-FORMAT
  5904                                 THRU 9900-EXIT
  5905        END-IF
  5906     END-IF
  5907     IF CERTIDL > ZEROS
  5908         IF CERTIDI NUMERIC
  5909            MOVE AL-UANON      TO CERTIDA
  5910            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5911         ELSE
  5912            MOVE ER-1778       TO EMI-ERROR
  5913            MOVE -1            TO CERTIDL
  5914            MOVE AL-UABON      TO CERTIDA
  5915            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5916        END-IF
  5917     ELSE
  5918        IF PI-PRINT-CERTIFICATE = 'Y'
  5919            MOVE ER-0715       TO EMI-ERROR
  5920            MOVE -1            TO CERTIDL
  5921            MOVE AL-UABON      TO CERTIDA
  5922            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5923        END-IF
  5924     END-IF
  5925     SET REASONS-NOT-FOUND TO TRUE
  5926     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5927        IF REACDL (S1) = +4 OR
  5928          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5929              MOVE AL-SANON     TO REACDA (S1)
  5930              SET REASONS-FOUND TO TRUE
  5931        END-IF
  5932     END-PERFORM
  5933
  5934     IF REASONS-NOT-FOUND
  5935        MOVE ER-1820             TO EMI-ERROR
  5936        MOVE -1                  TO PFENTRL
  5937        PERFORM 9900-ERROR-FORMAT
  5938                                 THRU 9900-EXIT
  5939     ELSE
  5940        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5941     END-IF
  5942
  5943     IF CRTNT1L > ZEROS
  5944        IF CRTNT1I > SPACES
  5945           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5946        END-IF
  5947     END-IF
  5948
  5949     IF CRTNT2L > ZEROS
  5950        IF CRTNT2I > SPACES
  5951           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5952        END-IF
  5953     END-IF
  5954
  5955     IF CRTNT3L > ZEROS
  5956        IF CRTNT3I > SPACES
  5957           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5958        END-IF
  5959     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 105
* EL6318.cbl
  5960
  5961     IF CRTNT4L > ZEROS
  5962        IF CRTNT4I > SPACES
  5963           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5964        END-IF
  5965     END-IF
  5966
  5967     IF BILNT1L > ZEROS
  5968        IF BILNT1I > SPACES
  5969           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5970        END-IF
  5971     END-IF
  5972
  5973     IF BILNT2L > ZEROS
  5974        IF BILNT2I > SPACES
  5975           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5976        END-IF
  5977     END-IF
  5978
  5979     .
  5980 0325-EXIT.
  5981     EXIT.
  5982
  5983 0326-GET-Z-RECORD.
  5984
  5985     MOVE SPACES  TO W-Z-CONTROL-DATA
  5986
  5987
  5988* EXEC CICS STARTBR
  5989*         DATASET    ('ELLETR')
  5990*         RIDFLD     (ELLETR-KEY)
  5991*         GTEQ
  5992*         RESP      (WS-RESPONSE)
  5993*    END-EXEC.
  5994     MOVE 'ELLETR' TO DFHEIV1
  5995     MOVE 0
  5996       TO DFHEIV11
  5997*    MOVE '&,         G          &  N#00005967' TO DFHEIV0
  5998     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6000     MOVE X'204E233030303035393637' TO DFHEIV0(25:11)
  6001     CALL 'kxdfhei1' USING DFHEIV0,
  6002           DFHEIV1,
  6003           ELLETR-KEY,
  6004           DFHEIV99,
  6005           DFHEIV11,
  6006           DFHEIV99
  6007     MOVE EIBRESP  TO WS-RESPONSE
  6008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6009
  6010     IF NOT RESP-NORMAL
  6011         MOVE ER-1236          TO EMI-ERROR
  6012         MOVE -1               TO LTRIDL
  6013         MOVE AL-UABON         TO LTRIDA
  6014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6015         GO TO 0326-ENDBR
  6016     END-IF.
  6017
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 106
* EL6318.cbl
  6018 0326-READNEXT.
  6019
  6020
  6021* EXEC CICS READNEXT
  6022*        DATASET   ('ELLETR')
  6023*        INTO      (TEXT-FILES)
  6024*        RIDFLD    (ELLETR-KEY)
  6025*        RESP      (WS-RESPONSE)
  6026*    END-EXEC
  6027     MOVE LENGTH OF
  6028      TEXT-FILES
  6029       TO DFHEIV12
  6030     MOVE 'ELLETR' TO DFHEIV1
  6031     MOVE 0
  6032       TO DFHEIV11
  6033*    MOVE '&.IL                  )  N#00005983' TO DFHEIV0
  6034     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6036     MOVE X'204E233030303035393833' TO DFHEIV0(25:11)
  6037     CALL 'kxdfhei1' USING DFHEIV0,
  6038           DFHEIV1,
  6039           TEXT-FILES,
  6040           DFHEIV12,
  6041           ELLETR-KEY,
  6042           DFHEIV99,
  6043           DFHEIV11,
  6044           DFHEIV99,
  6045           DFHEIV99
  6046     MOVE EIBRESP  TO WS-RESPONSE
  6047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6048     IF RESP-NORMAL
  6049        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6050           MOVE ER-1236          TO EMI-ERROR
  6051           MOVE -1               TO LTRIDL
  6052           MOVE AL-UABON         TO LTRIDA
  6053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6054           GO TO 0326-ENDBR
  6055        END-IF
  6056
  6057        MOVE AL-UANON         TO LTRIDA
  6058        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6059           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6060        ELSE
  6061           GO TO 0326-READNEXT
  6062        END-IF
  6063     ELSE
  6064        MOVE ER-1236          TO EMI-ERROR
  6065        MOVE -1               TO LTRIDL
  6066        MOVE AL-UABON         TO LTRIDA
  6067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6068        GO TO 0326-ENDBR
  6069     END-IF.
  6070
  6071     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6072
  6073 0326-ENDBR.
  6074
  6075
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 107
* EL6318.cbl
  6076* EXEC CICS ENDBR
  6077*        DATASET     ('ELLETR')
  6078*    END-EXEC.
  6079     MOVE 'ELLETR' TO DFHEIV1
  6080     MOVE 0
  6081       TO DFHEIV11
  6082*    MOVE '&2                    $   #00006016' TO DFHEIV0
  6083     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6084     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6085     MOVE X'2020233030303036303136' TO DFHEIV0(25:11)
  6086     CALL 'kxdfhei1' USING DFHEIV0,
  6087           DFHEIV1,
  6088           DFHEIV11,
  6089           DFHEIV99
  6090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6091
  6092
  6093 0326-EXIT.
  6094      EXIT.
  6095 0330-CHECK-ERRORS.
  6096     IF EMI-NO-ERRORS
  6097        GO TO 0350-BUILD-INIT-MAP
  6098     ELSE
  6099        GO TO 8200-SEND-DATAONLY
  6100     END-IF
  6101     .
  6102 0330-EXIT.
  6103     EXIT.
  6104 0350-BUILD-INIT-MAP.
  6105     MOVE PI-CRTO-CARRIER        TO CARRO
  6106     MOVE PI-CRTO-GROUPING       TO GROUPO
  6107     MOVE PI-CRTO-STATE          TO STATEO
  6108     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6109     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6110     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6111     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6112     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6113     MOVE ' '                    TO DC-OPTION-CODE
  6114     PERFORM 9700-DATE-LINK
  6115     IF NO-CONVERSION-ERROR
  6116        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6117     END-IF
  6118*     IF PI-PRTSW-ENTERED > SPACES
  6119*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6120*        MOVE AL-UANON            TO PRTSWA
  6121*        MOVE +1                  TO PRTSWL
  6122*     END-IF
  6123
  6124     IF PI-SIGREQ-ENTERED > SPACES
  6125        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6126        MOVE AL-UANON            TO SIGREQA
  6127        MOVE +1                  TO SIGREQL
  6128     ELSE
  6129        IF PI-CLAIM-REFORMATION
  6130            MOVE 'Y'             TO SIGREQI
  6131            MOVE AL-UANON        TO SIGREQA
  6132            MOVE +1              TO SIGREQL
  6133        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 108
* EL6318.cbl
  6134     END-IF
  6135
  6136     IF PI-LTRID-ENTERED > SPACES
  6137        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6138        MOVE AL-UANON            TO LTRIDA
  6139        MOVE +4                  TO LTRIDL
  6140     ELSE
  6141        IF PI-CLAIM-REFORMATION
  6142            MOVE 'CLRF'          TO LTRIDI
  6143            MOVE AL-UANON        TO LTRIDA
  6144            MOVE +4              TO LTRIDL
  6145        END-IF
  6146     END-IF
  6147
  6148     IF PI-VOUCHER-ENTERED > SPACES
  6149        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6150        MOVE AL-UANON            TO VOUCHA
  6151        MOVE +1                  TO VOUCHL
  6152     END-IF
  6153
  6154     IF PI-HLTHAPP-ENTERED > SPACES
  6155        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6156        MOVE AL-UANON            TO HLTHAPPA
  6157        MOVE +1                  TO HLTHAPPL
  6158     END-IF
  6159
  6160     IF PI-PAYEE-ENTERED > SPACES
  6161        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6162        MOVE AL-UANON            TO PAYEEA
  6163        MOVE +10                 TO PAYEEL
  6164     END-IF
  6165
  6166     IF PI-CERTID-ENTERED > SPACES
  6167        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6168        MOVE AL-UANON            TO CERTIDA
  6169        MOVE +5                  TO CERTIDL
  6170     END-IF
  6171
  6172     SET REASONS-NOT-FOUND TO TRUE
  6173     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6174     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6175        IF REACDL (S1) = +4 OR
  6176          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6177              MOVE AL-SANON      TO REACDA (S1)
  6178              MOVE +4            TO REACDL (S1)
  6179              SET REASONS-FOUND  TO TRUE
  6180        END-IF
  6181     END-PERFORM
  6182
  6183     IF REASONS-NOT-FOUND
  6184         IF PI-CLAIM-REFORMATION
  6185            MOVE 'CRNA'          TO REACD-IN (1)
  6186            MOVE AL-SANON        TO REACDA (1)
  6187            MOVE +4              TO REACDL (1)
  6188            SET REASONS-FOUND    TO TRUE
  6189        END-IF
  6190     END-IF
  6191
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 109
* EL6318.cbl
  6192     IF PI-CERTNT1-ENTERED > SPACES
  6193        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6194        MOVE AL-UANON            TO CRTNT1A
  6195        MOVE +63                 TO CRTNT1L
  6196     END-IF
  6197
  6198     IF PI-CERTNT2-ENTERED > SPACES
  6199        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6200        MOVE AL-UANON            TO CRTNT2A
  6201        MOVE +63                 TO CRTNT2L
  6202     END-IF
  6203
  6204     IF PI-CERTNT3-ENTERED > SPACES
  6205        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6206        MOVE AL-UANON            TO CRTNT3A
  6207        MOVE +63                 TO CRTNT3L
  6208     END-IF
  6209
  6210     IF PI-CERTNT4-ENTERED > SPACES
  6211        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6212        MOVE AL-UANON            TO CRTNT4A
  6213        MOVE +63                 TO CRTNT4L
  6214     END-IF
  6215
  6216     IF PI-BILLNT1-ENTERED > SPACES
  6217        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6218        MOVE AL-UANON            TO BILNT1A
  6219        MOVE +63                 TO BILNT1L
  6220     END-IF
  6221
  6222     IF PI-BILLNT2-ENTERED > SPACES
  6223        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6224        MOVE AL-UANON            TO BILNT2A
  6225        MOVE +63                 TO BILNT2L
  6226     END-IF
  6227
  6228     GO TO 8100-SEND-INITIAL-MAP
  6229     .
  6230 0360-FINALIZE.
  6231     display ' made it to 0360 '
  6232     set P to address of KIXSYS
  6233     CALL "getenv" using by value P returning var-ptr
  6234     if var-ptr = null then
  6235        display ' kixsys not set '
  6236     else
  6237        set address of var to var-ptr
  6238        move 0 to env-var-len
  6239        inspect var tallying env-var-len
  6240          for characters before X'00'
  6241*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6242        unstring var (1:env-var-len) delimited by '/'
  6243           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6244              WS-KIX-SYS
  6245        end-unstring
  6246*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6247*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6248     end-if
  6249     set P to address of KIXHOST
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 110
* EL6318.cbl
  6250     CALL "getenv" using by value P returning var-ptr
  6251     if var-ptr = null then
  6252        display ' kixhost not set '
  6253     else
  6254        set address of var to var-ptr
  6255        move 0 to env-var-len
  6256        inspect var tallying env-var-len
  6257          for characters before X'00'
  6258*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6259        MOVE var(1:env-var-len)  to ws-kixhost
  6260        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6261     end-if
  6262     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6263     IF NOT EMI-NO-ERRORS
  6264       AND EIBAID = DFHPF4
  6265        GO TO 8200-SEND-DATAONLY
  6266     END-IF
  6267     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6268     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6269                                    NEW-ELCRTO-KEY
  6270     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6271     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6272     IF RESP-NORMAL
  6273        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6274        DISPLAY ' RESP NORMAL AND = '
  6275        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6276*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6277        PERFORM 1100-CALL-NS-BUS-LOGIC
  6278                                 THRU 1100-EXIT
  6279        IF BL-OK
  6280           CONTINUE
  6281        ELSE
  6282           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6283           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6284           MOVE -1               TO SIGREQL
  6285        END-IF
  6286     ELSE
  6287        MOVE ER-9999             TO EMI-ERROR
  6288        PERFORM 9900-ERROR-FORMAT
  6289                                 THRU 9900-EXIT
  6290        MOVE -1                  TO SIGREQL
  6291        GO TO 8100-SEND-INITIAL-MAP
  6292     END-IF
  6293     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6294                                 TO SYSO
  6295     MOVE WS-KIXHOST             TO HOSTO
  6296     MOVE PI-COMPANY-ID          TO COMPANYO
  6297     MOVE '4'                    TO DATASORO
  6298     MOVE BL-BATCH-NO            TO BATCHNOO
  6299     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6300     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6301     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6302*    MOVE 'N'                    TO PRTSWO
  6303*    MOVE -1                     TO PRTSWL
  6304*    MOVE AL-UANON               TO PRTSWA
  6305     MOVE -1                     TO SIGREQL
  6306     MOVE AL-UANON               TO SIGREQA
  6307     IF EIBAID = DFHPF4
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 111
* EL6318.cbl
  6308        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6309        MOVE ER-0280             TO EMI-ERROR
  6310        PERFORM 9900-ERROR-FORMAT
  6311                                 THRU 9900-EXIT
  6312        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6313        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6314        MOVE 'Y'                 TO PI-FINALIZED-IND
  6315        GO TO 9400-CLEAR
  6316     ELSE
  6317        MOVE ER-1818             TO EMI-ERROR
  6318        PERFORM 9900-ERROR-FORMAT
  6319                                 THRU 9900-EXIT
  6320     END-IF
  6321     GO TO 0350-BUILD-INIT-MAP
  6322     .
  6323 0360-EXIT.
  6324     EXIT.
  6325 0362-READ-ELCRTO.
  6326     display ' made it to 0362 '
  6327
  6328* EXEC CICS READ
  6329*        DATASET   (WS-ELCRTO-FILE-ID)
  6330*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6331*        RIDFLD    (ELCRTO-KEY)
  6332*        RESP      (WS-RESPONSE)
  6333*    END-EXEC
  6334*    MOVE '&"S        E          (  N#00006254' TO DFHEIV0
  6335     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6336     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6337     MOVE X'204E233030303036323534' TO DFHEIV0(25:11)
  6338     CALL 'kxdfhei1' USING DFHEIV0,
  6339           WS-ELCRTO-FILE-ID,
  6340           DFHEIV20,
  6341           DFHEIV99,
  6342           ELCRTO-KEY,
  6343           DFHEIV99,
  6344           DFHEIV99,
  6345           DFHEIV99
  6346     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6347         DFHEIV20
  6348     MOVE EIBRESP  TO WS-RESPONSE
  6349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6350     .
  6351 0362-EXIT.
  6352     EXIT.
  6353 0363-READ-ELCRTO-UPD.
  6354     display ' made it to 0363 '
  6355
  6356* EXEC CICS READ
  6357*        DATASET   (WS-ELCRTO-FILE-ID)
  6358*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6359*        RIDFLD    (ELCRTO-KEY)
  6360*        UPDATE
  6361*        RESP      (WS-RESPONSE)
  6362*    END-EXEC
  6363*    MOVE '&"S        EU         (  N#00006265' TO DFHEIV0
  6364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 112
* EL6318.cbl
  6366     MOVE X'204E233030303036323635' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0,
  6368           WS-ELCRTO-FILE-ID,
  6369           DFHEIV20,
  6370           DFHEIV99,
  6371           ELCRTO-KEY,
  6372           DFHEIV99,
  6373           DFHEIV99,
  6374           DFHEIV99
  6375     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6376         DFHEIV20
  6377     MOVE EIBRESP  TO WS-RESPONSE
  6378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6379     .
  6380 0363-EXIT.
  6381     EXIT.
  6382 0365-READ-ERENDT.
  6383
  6384* EXEC CICS READ
  6385*        DATASET   (WS-ERENDT-FILE-ID)
  6386*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6387*        RIDFLD    (ERENDT-KEY)
  6388*        RESP      (WS-RESPONSE)
  6389*    END-EXEC
  6390*    MOVE '&"S        E          (  N#00006276' TO DFHEIV0
  6391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6393     MOVE X'204E233030303036323736' TO DFHEIV0(25:11)
  6394     CALL 'kxdfhei1' USING DFHEIV0,
  6395           WS-ERENDT-FILE-ID,
  6396           DFHEIV20,
  6397           DFHEIV99,
  6398           ERENDT-KEY,
  6399           DFHEIV99,
  6400           DFHEIV99,
  6401           DFHEIV99
  6402     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6403         DFHEIV20
  6404     MOVE EIBRESP  TO WS-RESPONSE
  6405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6406     .
  6407 0365-EXIT.
  6408     EXIT.
  6409 0400-ADD-ERENDT.
  6410     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6411     display ' made it to 0400 '
  6412
  6413* EXEC CICS GETMAIN
  6414*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6415*         LENGTH   (ERENDT-LENGTH)
  6416*         INITIMG  (GETMAIN-SPACE)
  6417*    END-EXEC
  6418*    MOVE ',"IL                  $   #00006288' TO DFHEIV0
  6419     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6421     MOVE X'2020233030303036323838' TO DFHEIV0(25:11)
  6422     CALL 'kxdfhei1' USING DFHEIV0,
  6423           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 113
* EL6318.cbl
  6424           ERENDT-LENGTH,
  6425           GETMAIN-SPACE
  6426     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6427         DFHEIV20
  6428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6429     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6430     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6431     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6432     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6433                                    EN-INPUT-DT
  6434                                    EN-PROCESS-DT
  6435
  6436     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6437     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6438     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6439     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6440     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6441     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6442     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6443     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6444     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6445     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6446     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6447     IF OC-LF-BENCD NOT = '00' AND '  '
  6448        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6449        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6450        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6451        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6452        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6453        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6454        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6455     END-IF
  6456     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6457     IF OC-AH-BENCD NOT = '00' AND '  '
  6458        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6459        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6460        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6461        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6462        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6463        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6464     END-IF
  6465     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6466
  6467* EXEC CICS GETMAIN
  6468*         SET      (ADDRESS OF PENDING-BUSINESS)
  6469*         LENGTH   (ERPNDB-LENGTH)
  6470*         INITIMG  (GETMAIN-SPACE)
  6471*    END-EXEC
  6472*    MOVE ',"IL                  $   #00006330' TO DFHEIV0
  6473     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6474     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6475     MOVE X'2020233030303036333330' TO DFHEIV0(25:11)
  6476     CALL 'kxdfhei1' USING DFHEIV0,
  6477           DFHEIV20,
  6478           ERPNDB-LENGTH,
  6479           GETMAIN-SPACE
  6480     SET ADDRESS OF PENDING-BUSINESS TO
  6481         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 114
* EL6318.cbl
  6482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6483     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6484     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6485
  6486* EXEC CICS READ
  6487*        DATASET   (WS-ERPNDB-FILE-ID)
  6488*        INTO      (PENDING-BUSINESS)
  6489*        RIDFLD    (ERPNDB-KEY)
  6490*        RESP      (WS-RESPONSE)
  6491*    END-EXEC
  6492     MOVE LENGTH OF
  6493      PENDING-BUSINESS
  6494       TO DFHEIV11
  6495*    MOVE '&"IL       E          (  N#00006337' TO DFHEIV0
  6496     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6498     MOVE X'204E233030303036333337' TO DFHEIV0(25:11)
  6499     CALL 'kxdfhei1' USING DFHEIV0,
  6500           WS-ERPNDB-FILE-ID,
  6501           PENDING-BUSINESS,
  6502           DFHEIV11,
  6503           ERPNDB-KEY,
  6504           DFHEIV99,
  6505           DFHEIV99,
  6506           DFHEIV99
  6507     MOVE EIBRESP  TO WS-RESPONSE
  6508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6509     IF NOT RESP-NORMAL
  6510        GO TO 0400-EXIT
  6511     END-IF
  6512*    set found-pndb to true
  6513     display ' good read on erpndb '
  6514     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6515                                      NCRTO-INS-FIRST-NAME
  6516     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6517                                      NCRTO-INS-MIDDLE-INIT
  6518     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6519                                      NCRTO-INS-LAST-NAME
  6520     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6521                                      NCRTO-INS-AGE
  6522     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6523                                      NCRTO-JNT-FIRST-NAME
  6524     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6525                                      NCRTO-JNT-MIDDLE-INIT
  6526     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6527                                      NCRTO-JNT-LAST-NAME
  6528     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6529                                      NCRTO-JNT-AGE
  6530     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6531                                      NCRTO-LF-BENCD
  6532     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6533        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6534                                      NCRTO-LF-BEN-AMT
  6535        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6536                                      NCRTO-LF-PRM-AMT
  6537        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6538                                      NCRTO-LF-ALT-BEN-AMT
  6539        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 115
* EL6318.cbl
  6540                                      NCRTO-LF-ALT-PRM-AMT
  6541        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6542                                      NCRTO-LF-TERM
  6543        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6544                                      NCRTO-LF-EXP-DT
  6545        IF PB-I-JOINT-COMMISSION > +0
  6546           MOVE PB-I-JOINT-COMMISSION
  6547                                   TO EN-LF-NEW-COMM-PCT
  6548                                      NCRTO-LF-COMM-PCT
  6549        ELSE
  6550           MOVE PB-I-LIFE-COMMISSION
  6551                                   TO EN-LF-NEW-COMM-PCT
  6552                                      NCRTO-LF-COMM-PCT
  6553        END-IF
  6554     END-IF
  6555     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6556                                      NCRTO-AH-BENCD
  6557     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6558        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6559                                      NCRTO-AH-BEN-AMT
  6560        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6561                                      NCRTO-AH-PRM-AMT
  6562        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6563                                      NCRTO-AH-TERM
  6564        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6565                                      NCRTO-AH-EXP-DT
  6566        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6567                                      NCRTO-AH-CP
  6568        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6569                                      NCRTO-AH-COMM-PCT
  6570     END-IF
  6571     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6572     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6573     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6574     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6575*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6576     MOVE 'Y'                    TO EN-COMM-CHGBK
  6577
  6578     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6579        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6580        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6581        EN-AH-NEW-PRM-AMT)
  6582     COMPUTE EN-ACCT-PORTION ROUNDED =
  6583        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6584        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6585        * EN-LF-NEW-COMM-PCT)
  6586                       +
  6587        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6588        * EN-AH-NEW-COMM-PCT)
  6589     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6590        EN-ACCT-PORTION
  6591     move pb-control-by-account (1:33)
  6592                                 to ws-ermail-key
  6593
  6594* EXEC CICS READ
  6595*        DATASET   ('ERMAIL')
  6596*        SET       (ADDRESS OF MAILING-DATA)
  6597*        RIDFLD    (WS-ERMAIL-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 116
* EL6318.cbl
  6598*        RESP      (WS-RESPONSE)
  6599*    END-EXEC
  6600     MOVE 'ERMAIL' TO DFHEIV1
  6601*    MOVE '&"S        E          (  N#00006427' TO DFHEIV0
  6602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6604     MOVE X'204E233030303036343237' TO DFHEIV0(25:11)
  6605     CALL 'kxdfhei1' USING DFHEIV0,
  6606           DFHEIV1,
  6607           DFHEIV20,
  6608           DFHEIV99,
  6609           WS-ERMAIL-KEY,
  6610           DFHEIV99,
  6611           DFHEIV99,
  6612           DFHEIV99
  6613     SET ADDRESS OF MAILING-DATA TO
  6614         DFHEIV20
  6615     MOVE EIBRESP  TO WS-RESPONSE
  6616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6617     IF RESP-NORMAL
  6618        DISPLAY ' FOUND ERMAIL '
  6619        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6620                                    NCRTO-CRED-BENE-NAME
  6621     ELSE
  6622        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6623     END-IF
  6624
  6625     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6626     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6627
  6628
  6629* EXEC CICS READ
  6630*         DATASET  (WS-ELCRTT-FILE-ID)
  6631*         RIDFLD   (WS-ELCRTT-KEY)
  6632*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6633*         RESP     (WS-RESPONSE)
  6634*    END-EXEC
  6635*    MOVE '&"S        E          (  N#00006444' TO DFHEIV0
  6636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6638     MOVE X'204E233030303036343434' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           WS-ELCRTT-FILE-ID,
  6641           DFHEIV20,
  6642           DFHEIV99,
  6643           WS-ELCRTT-KEY,
  6644           DFHEIV99,
  6645           DFHEIV99,
  6646           DFHEIV99
  6647     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6648         DFHEIV20
  6649     MOVE EIBRESP  TO WS-RESPONSE
  6650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6651
  6652     IF RESP-NORMAL
  6653        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6654                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6655        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 117
* EL6318.cbl
  6656                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6657     END-IF.
  6658     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6659        IF REACD-IN (S1) NOT = LOW-VALUES
  6660           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6661        END-IF
  6662     END-PERFORM
  6663     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6664     MOVE 'G'                    TO EN-DOCU-TYPE
  6665     MOVE 'Y'                    TO EN-MONEY-SW
  6666     MOVE SIGREQI                TO EN-SIG-SW
  6667     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6668     MOVE PAYEEI                 TO EN-PAYEE
  6669     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6670     DISPLAY ' 0400 EXIT '
  6671     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6672     .
  6673 0400-EXIT.
  6674     EXIT.
  6675 0410-INIT-ERENDT.
  6676     display ' made it to 0410 '
  6677     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6678     MOVE ZEROS                  TO ENDT-SEQ-NO
  6679
  6680* EXEC CICS READ
  6681*        DATASET    (WS-ERENDT-FILE-ID)
  6682*        RIDFLD     (ERENDT-KEY)
  6683*        INTO       (ENDORSEMENT-RECORD)
  6684*        RESP       (WS-RESPONSE)
  6685*        GTEQ
  6686*    END-EXEC
  6687     MOVE LENGTH OF
  6688      ENDORSEMENT-RECORD
  6689       TO DFHEIV11
  6690*    MOVE '&"IL       G          (  N#00006478' TO DFHEIV0
  6691     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6693     MOVE X'204E233030303036343738' TO DFHEIV0(25:11)
  6694     CALL 'kxdfhei1' USING DFHEIV0,
  6695           WS-ERENDT-FILE-ID,
  6696           ENDORSEMENT-RECORD,
  6697           DFHEIV11,
  6698           ERENDT-KEY,
  6699           DFHEIV99,
  6700           DFHEIV99,
  6701           DFHEIV99
  6702     MOVE EIBRESP  TO WS-RESPONSE
  6703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6704     IF RESP-NORMAL
  6705        AND (EN-CONTROL-PRIMARY (1:34) =
  6706           OC-CONTROL-PRIMARY (1:34))
  6707        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6708     ELSE
  6709        MOVE +4096               TO WS-SEQ-NO
  6710     END-IF
  6711     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6712     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6713     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 118
* EL6318.cbl
  6714     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6715     INITIALIZE EN-ISSUE-RECORD
  6716     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6717                                    EN-AH-ORIG-EXP-DT
  6718                                    EN-LF-NEW-EXP-DT
  6719                                    EN-AH-NEW-EXP-DT
  6720                                    EN-PROCESS-DT
  6721     .
  6722 0410-EXIT.
  6723     EXIT.
  6724 0420-UPDATE-ELCRTO.
  6725     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6726     IF RESP-NORMAL
  6727        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6728                                    OC-LAST-MAINT-DT
  6729        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6730        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6731
  6732* EXEC CICS REWRITE
  6733*          FROM     (ORIGINAL-CERTIFICATE)
  6734*          DATASET  ('ELCRTO')
  6735*       END-EXEC
  6736     MOVE LENGTH OF
  6737      ORIGINAL-CERTIFICATE
  6738       TO DFHEIV11
  6739     MOVE 'ELCRTO' TO DFHEIV1
  6740*    MOVE '&& L                  %   #00006512' TO DFHEIV0
  6741     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6742     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6743     MOVE X'2020233030303036353132' TO DFHEIV0(25:11)
  6744     CALL 'kxdfhei1' USING DFHEIV0,
  6745           DFHEIV1,
  6746           ORIGINAL-CERTIFICATE,
  6747           DFHEIV11,
  6748           DFHEIV99
  6749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6750     END-IF
  6751     .
  6752 0420-EXIT.
  6753     EXIT.
  6754
  6755 0425-ADD-NEW-ELCRTO.
  6756     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6757     MOVE 'OC'                   TO OC-RECORD-ID
  6758     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6759     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6760     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6761     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6762     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6763     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6764     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6765     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6766     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6767     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6768     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6769     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6770     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6771     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 119
* EL6318.cbl
  6772     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6773     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6774     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6775     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6776     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6777     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6778     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6779     MOVE +0                     TO OC-LF-CANCEL-AMT
  6780                                    OC-LF-ITD-CANCEL-AMT
  6781     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6782     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6783     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6784     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6785     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6786     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6787     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6788     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6789     MOVE +0                     TO OC-AH-CANCEL-AMT
  6790                                    OC-AH-ITD-CANCEL-AMT
  6791     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6792     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6793     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6794     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6795     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6796     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6797     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6798     .
  6799 0425-WRITE-ELCRTO.
  6800
  6801
  6802* EXEC CICS WRITE
  6803*       DATASET   ('ELCRTO')
  6804*       FROM      (ORIGINAL-CERTIFICATE)
  6805*       RIDFLD    (OC-CONTROL-PRIMARY)
  6806*       RESP      (WS-RESPONSE)
  6807*    END-EXEC
  6808     MOVE LENGTH OF
  6809      ORIGINAL-CERTIFICATE
  6810       TO DFHEIV11
  6811     MOVE 'ELCRTO' TO DFHEIV1
  6812*    MOVE '&$ L                  ''  N#00006567' TO DFHEIV0
  6813     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6814     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6815     MOVE X'204E233030303036353637' TO DFHEIV0(25:11)
  6816     CALL 'kxdfhei1' USING DFHEIV0,
  6817           DFHEIV1,
  6818           ORIGINAL-CERTIFICATE,
  6819           DFHEIV11,
  6820           OC-CONTROL-PRIMARY,
  6821           DFHEIV99,
  6822           DFHEIV99
  6823     MOVE EIBRESP  TO WS-RESPONSE
  6824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6825
  6826     display ' just wrote new crto ' ws-response
  6827     IF RESP-DUPKEY
  6828        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6829        GO TO 0425-WRITE-ELCRTO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 120
* EL6318.cbl
  6830     ELSE
  6831        IF NOT RESP-NORMAL
  6832           MOVE -1               TO SIGREQL
  6833           MOVE ER-3830          TO EMI-ERROR
  6834           PERFORM 9900-ERROR-FORMAT
  6835                                 THRU 9900-EXIT
  6836        ELSE
  6837           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6838        END-IF
  6839     END-IF
  6840
  6841     .
  6842 0425-EXIT.
  6843     EXIT.
  6844
  6845 0426-ADD-CERT-NOTES.
  6846
  6847     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6848     SET TB-INDX TO 1
  6849
  6850     IF PI-CERTNT1-ENTERED > SPACES
  6851         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6852         MOVE PI-PROCESSOR-ID    TO
  6853                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6854         MOVE EIBTIME            TO
  6855                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6856         MOVE WS-CURRENT-BIN-DT  TO
  6857                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6858         SET TB-INDX UP BY +1
  6859     END-IF
  6860
  6861     IF PI-CERTNT2-ENTERED > SPACES
  6862         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6863         MOVE PI-PROCESSOR-ID    TO
  6864                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6865         MOVE EIBTIME            TO
  6866                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6867         MOVE WS-CURRENT-BIN-DT  TO
  6868                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6869         SET TB-INDX UP BY +1
  6870     END-IF
  6871
  6872     IF PI-CERTNT3-ENTERED > SPACES
  6873         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6874         MOVE PI-PROCESSOR-ID    TO
  6875                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6876         MOVE EIBTIME            TO
  6877                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6878         MOVE WS-CURRENT-BIN-DT  TO
  6879                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6880         SET TB-INDX UP BY +1
  6881     END-IF
  6882
  6883     IF PI-CERTNT4-ENTERED > SPACES
  6884         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6885         MOVE PI-PROCESSOR-ID    TO
  6886                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6887         MOVE EIBTIME            TO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 121
* EL6318.cbl
  6888                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6889         MOVE WS-CURRENT-BIN-DT  TO
  6890                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6891         SET TB-INDX UP BY +1
  6892     END-IF
  6893
  6894     IF CERT-NOTE-ENTRIES > SPACES
  6895         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6896         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6897     END-IF
  6898
  6899     IF PI-BILLNT1-ENTERED > SPACES
  6900         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6901         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6902         MOVE +63 TO WS-LEN
  6903         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6904     END-IF
  6905
  6906     IF PI-BILLNT2-ENTERED > SPACES
  6907         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6908         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6909         MOVE +63 TO WS-LEN
  6910         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6911     END-IF
  6912
  6913     .
  6914 0426-EXIT.
  6915     EXIT.
  6916
  6917 0427-LOAD-CURRENT-CERT-NOTES.
  6918
  6919     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6920     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6921     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6922     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6923     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6924     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6925     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6926     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6927     MOVE '1'                 TO ERCNOT-REC-TYP
  6928     MOVE +0                  TO ERCNOT-SEQ
  6929     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6930
  6931
  6932* EXEC CICS STARTBR
  6933*         DATASET(WS-ERCNOT-FILE-ID)
  6934*         RIDFLD(ERCNOT-KEY)
  6935*         KEYLENGTH(ERCNOT-START-LENGTH)
  6936*         RESP      (WS-RESPONSE)
  6937*         GENERIC
  6938*         GTEQ
  6939*    END-EXEC.
  6940     MOVE 0
  6941       TO DFHEIV11
  6942*    MOVE '&,   KG    G          &  N#00006679' TO DFHEIV0
  6943     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6944     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6945     MOVE X'204E233030303036363739' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 122
* EL6318.cbl
  6946     CALL 'kxdfhei1' USING DFHEIV0,
  6947           WS-ERCNOT-FILE-ID,
  6948           ERCNOT-KEY,
  6949           ERCNOT-START-LENGTH,
  6950           DFHEIV11,
  6951           DFHEIV99
  6952     MOVE EIBRESP  TO WS-RESPONSE
  6953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6954
  6955
  6956     IF NOT RESP-NORMAL
  6957        GO TO 0427-ENDBR
  6958     END-IF.
  6959
  6960 0427-LOOP.
  6961
  6962* EXEC CICS READNEXT
  6963*         SET(ADDRESS OF CERT-NOTE-FILE)
  6964*         DATASET(WS-ERCNOT-FILE-ID)
  6965*         RIDFLD(ERCNOT-KEY)
  6966*    END-EXEC.
  6967     MOVE 0
  6968       TO DFHEIV11
  6969*    MOVE '&.S                   )   #00006693' TO DFHEIV0
  6970     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6971     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6972     MOVE X'2020233030303036363933' TO DFHEIV0(25:11)
  6973     CALL 'kxdfhei1' USING DFHEIV0,
  6974           WS-ERCNOT-FILE-ID,
  6975           DFHEIV20,
  6976           DFHEIV99,
  6977           ERCNOT-KEY,
  6978           DFHEIV99,
  6979           DFHEIV11,
  6980           DFHEIV99,
  6981           DFHEIV99
  6982     SET ADDRESS OF CERT-NOTE-FILE TO
  6983         DFHEIV20
  6984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6985
  6986
  6987     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6988         GO TO 0427-ENDBR
  6989     END-IF.
  6990
  6991     IF (CZ-CARRIER = SV-CARRIER)
  6992        AND (CZ-GROUPING = SV-GROUPING)
  6993        AND (CZ-STATE = SV-STATE)
  6994        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6995        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6996        AND (CZ-CERT-NO = SV-CERT-NO)
  6997        AND (CZ-RECORD-TYPE = '1')
  6998          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6999          MOVE CZ-LAST-MAINT-USER TO
  7000                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7001          MOVE CZ-LAST-MAINT-DT TO
  7002                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7003          MOVE CZ-LAST-MAINT-HHMMSS TO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 123
* EL6318.cbl
  7004                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7005          SET TB-INDX UP BY 1
  7006          GO TO 0427-LOOP
  7007     END-IF.
  7008
  7009 0427-ENDBR.
  7010
  7011
  7012* EXEC CICS ENDBR
  7013*         DATASET(WS-ERCNOT-FILE-ID)
  7014*    END-EXEC.
  7015     MOVE 0
  7016       TO DFHEIV11
  7017*    MOVE '&2                    $   #00006723' TO DFHEIV0
  7018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7020     MOVE X'2020233030303036373233' TO DFHEIV0(25:11)
  7021     CALL 'kxdfhei1' USING DFHEIV0,
  7022           WS-ERCNOT-FILE-ID,
  7023           DFHEIV11,
  7024           DFHEIV99
  7025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7026
  7027
  7028     .
  7029 0427-EXIT.
  7030     EXIT.
  7031
  7032 0430-WRITE-ERENDT.
  7033     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7034     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7035     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7036
  7037* EXEC CICS WRITE
  7038*         DATASET   (WS-ERENDT-FILE-ID)
  7039*         FROM      (ENDORSEMENT-RECORD)
  7040*         RIDFLD    (EN-CONTROL-PRIMARY)
  7041*         RESP      (WS-RESPONSE)
  7042*    END-EXEC
  7043     MOVE LENGTH OF
  7044      ENDORSEMENT-RECORD
  7045       TO DFHEIV11
  7046*    MOVE '&$ L                  ''  N#00006735' TO DFHEIV0
  7047     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7049     MOVE X'204E233030303036373335' TO DFHEIV0(25:11)
  7050     CALL 'kxdfhei1' USING DFHEIV0,
  7051           WS-ERENDT-FILE-ID,
  7052           ENDORSEMENT-RECORD,
  7053           DFHEIV11,
  7054           EN-CONTROL-PRIMARY,
  7055           DFHEIV99,
  7056           DFHEIV99
  7057     MOVE EIBRESP  TO WS-RESPONSE
  7058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7059     IF RESP-NORMAL
  7060        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7061        display ' good write erendt '
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 124
* EL6318.cbl
  7062        IF EIBAID = DFHPF4
  7063           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7064           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7065           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7066           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7067        END-IF
  7068     ELSE
  7069        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7070        MOVE -1                  TO SIGREQL
  7071        MOVE ER-0132             TO EMI-ERROR
  7072        MOVE AL-UABON            TO SIGREQA
  7073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7074     END-IF
  7075     .
  7076 0430-EXIT.
  7077     EXIT.
  7078
  7079
  7080 0440-ADD-BILLING-NOTE.
  7081
  7082* EXEC CICS GETMAIN
  7083*         SET      (ADDRESS OF EOB-CODES)
  7084*         LENGTH   (ELEOBC-LENGTH)
  7085*         INITIMG  (GETMAIN-SPACE)
  7086*    END-EXEC
  7087*    MOVE ',"IL                  $   #00006763' TO DFHEIV0
  7088     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7090     MOVE X'2020233030303036373633' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0,
  7092           DFHEIV20,
  7093           ELEOBC-LENGTH,
  7094           GETMAIN-SPACE
  7095     SET ADDRESS OF EOB-CODES TO
  7096         DFHEIV20
  7097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7098
  7099     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7100     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7101     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7102
  7103
  7104* EXEC CICS STARTBR
  7105*        DATASET   ('ELEOBC')
  7106*        RIDFLD    (WS-ELEOBC-KEY)
  7107*        GTEQ
  7108*        RESP      (WS-RESPONSE)
  7109*    END-EXEC
  7110     MOVE 'ELEOBC' TO DFHEIV1
  7111     MOVE 0
  7112       TO DFHEIV11
  7113*    MOVE '&,         G          &  N#00006773' TO DFHEIV0
  7114     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7116     MOVE X'204E233030303036373733' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           DFHEIV1,
  7119           WS-ELEOBC-KEY,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 125
* EL6318.cbl
  7120           DFHEIV99,
  7121           DFHEIV11,
  7122           DFHEIV99
  7123     MOVE EIBRESP  TO WS-RESPONSE
  7124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7125
  7126     IF NOT RESP-NORMAL
  7127        GO TO 0440-EXIT
  7128     END-IF
  7129      .
  7130 0440-READNEXT-ELEOBC.
  7131
  7132
  7133* EXEC CICS READNEXT
  7134*       INTO    (EOB-CODES)
  7135*       DATASET ('ELEOBC')
  7136*       RIDFLD  (WS-ELEOBC-KEY)
  7137*       RESP    (WS-RESPONSE)
  7138*    END-EXEC
  7139     MOVE LENGTH OF
  7140      EOB-CODES
  7141       TO DFHEIV12
  7142     MOVE 'ELEOBC' TO DFHEIV1
  7143     MOVE 0
  7144       TO DFHEIV11
  7145*    MOVE '&.IL                  )  N#00006786' TO DFHEIV0
  7146     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7147     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7148     MOVE X'204E233030303036373836' TO DFHEIV0(25:11)
  7149     CALL 'kxdfhei1' USING DFHEIV0,
  7150           DFHEIV1,
  7151           EOB-CODES,
  7152           DFHEIV12,
  7153           WS-ELEOBC-KEY,
  7154           DFHEIV99,
  7155           DFHEIV11,
  7156           DFHEIV99,
  7157           DFHEIV99
  7158     MOVE EIBRESP  TO WS-RESPONSE
  7159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7160
  7161     IF RESP-NORMAL
  7162         IF EO-RECORD-TYPE NOT = '5'
  7163             GO TO 0440-EXIT
  7164         END-IF
  7165     ELSE
  7166         GO TO 0440-EXIT
  7167     END-IF
  7168
  7169     IF EO-RECORD-TYPE = '5' AND
  7170        EO-EOB-CODE = PI-LTRID-ENTERED
  7171           CONTINUE
  7172     ELSE
  7173         GO TO 0440-READNEXT-ELEOBC
  7174     END-IF
  7175
  7176     MOVE SPACES TO WS-BILLING-NOTE
  7177     MOVE EO-DESCRIPTION TO WS-BN-NOTE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 126
* EL6318.cbl
  7178     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7179     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7180     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7181     MOVE +25 TO WS-LEN
  7182
  7183     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7184     .
  7185 0440-EXIT.
  7186     EXIT.
  7187
  7188 0441-UPDATE-BILLING-NOTE.
  7189
  7190* EXEC CICS GETMAIN
  7191*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7192*         LENGTH   (ERNOTE-LENGTH)
  7193*         INITIMG  (GETMAIN-SPACE)
  7194*    END-EXEC
  7195*    MOVE ',"IL                  $   #00006821' TO DFHEIV0
  7196     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7197     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7198     MOVE X'2020233030303036383231' TO DFHEIV0(25:11)
  7199     CALL 'kxdfhei1' USING DFHEIV0,
  7200           DFHEIV20,
  7201           ERNOTE-LENGTH,
  7202           GETMAIN-SPACE
  7203     SET ADDRESS OF CERTIFICATE-NOTE TO
  7204         DFHEIV20
  7205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7206
  7207     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7208
  7209
  7210* EXEC CICS READ
  7211*       DATASET    (WS-ERNOTE-FILE-ID)
  7212*       RIDFLD     (WS-ERNOTE-KEY)
  7213*       INTO       (CERTIFICATE-NOTE)
  7214*       RESP       (WS-RESPONSE)
  7215*       UPDATE
  7216*    END-EXEC
  7217     MOVE LENGTH OF
  7218      CERTIFICATE-NOTE
  7219       TO DFHEIV11
  7220*    MOVE '&"IL       EU         (  N#00006829' TO DFHEIV0
  7221     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7222     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7223     MOVE X'204E233030303036383239' TO DFHEIV0(25:11)
  7224     CALL 'kxdfhei1' USING DFHEIV0,
  7225           WS-ERNOTE-FILE-ID,
  7226           CERTIFICATE-NOTE,
  7227           DFHEIV11,
  7228           WS-ERNOTE-KEY,
  7229           DFHEIV99,
  7230           DFHEIV99,
  7231           DFHEIV99
  7232     MOVE EIBRESP  TO WS-RESPONSE
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7234
  7235     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 127
* EL6318.cbl
  7236       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7237          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7238       END-IF
  7239       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7240          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7241       END-IF
  7242       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7243           (NOTE-SUB > +10) OR
  7244           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7245                             WS-BILLING-NOTE (1:WS-LEN))
  7246       END-PERFORM
  7247       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7248                              WS-BILLING-NOTE (1:WS-LEN)
  7249
  7250* EXEC CICS UNLOCK
  7251*           DATASET    (WS-ERNOTE-FILE-ID)
  7252*        END-EXEC
  7253*    MOVE '&*                    #   #00006851' TO DFHEIV0
  7254     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7255     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7256     MOVE X'2020233030303036383531' TO DFHEIV0(25:11)
  7257     CALL 'kxdfhei1' USING DFHEIV0,
  7258           WS-ERNOTE-FILE-ID,
  7259           DFHEIV99
  7260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7261       ELSE
  7262         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7263           (NOTE-SUB > +10) OR
  7264           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7265         END-PERFORM
  7266         IF (NOTE-SUB < +11)
  7267           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7268              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7269                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7270           ELSE
  7271             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7272              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7273                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7274                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7275             ELSE
  7276               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7277                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7278                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7279                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7280               ELSE
  7281                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7282                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7283                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7284                                       CN-BILLING-START-LINE-NO
  7285                 ELSE
  7286                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7287                 END-IF
  7288               END-IF
  7289             END-IF
  7290           END-IF
  7291           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7292           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7293           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 128
* EL6318.cbl
  7294
  7295* EXEC CICS REWRITE
  7296*             DATASET    (WS-ERNOTE-FILE-ID)
  7297*             FROM       (CERTIFICATE-NOTE)
  7298*             RESP       (WS-RESPONSE)
  7299*          END-EXEC
  7300     MOVE LENGTH OF
  7301      CERTIFICATE-NOTE
  7302       TO DFHEIV11
  7303*    MOVE '&& L                  %  N#00006887' TO DFHEIV0
  7304     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7306     MOVE X'204E233030303036383837' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0,
  7308           WS-ERNOTE-FILE-ID,
  7309           CERTIFICATE-NOTE,
  7310           DFHEIV11,
  7311           DFHEIV99
  7312     MOVE EIBRESP  TO WS-RESPONSE
  7313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7314           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7315         END-IF
  7316       END-IF
  7317     ELSE
  7318        MOVE SPACES              TO CERTIFICATE-NOTE
  7319        MOVE 'CN'                TO CN-RECORD-ID
  7320        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7321                                     WS-ERNOTE-KEY
  7322        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7323                                    CN-BILLING-END-LINE-NO
  7324        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7325        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7326        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7327        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7328
  7329* EXEC CICS WRITE
  7330*          DATASET    (WS-ERNOTE-FILE-ID)
  7331*          FROM       (CERTIFICATE-NOTE)
  7332*          RIDFLD     (WS-ERNOTE-KEY)
  7333*          RESP       (WS-RESPONSE)
  7334*       END-EXEC
  7335     MOVE LENGTH OF
  7336      CERTIFICATE-NOTE
  7337       TO DFHEIV11
  7338*    MOVE '&$ L                  ''  N#00006906' TO DFHEIV0
  7339     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7340     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7341     MOVE X'204E233030303036393036' TO DFHEIV0(25:11)
  7342     CALL 'kxdfhei1' USING DFHEIV0,
  7343           WS-ERNOTE-FILE-ID,
  7344           CERTIFICATE-NOTE,
  7345           DFHEIV11,
  7346           WS-ERNOTE-KEY,
  7347           DFHEIV99,
  7348           DFHEIV99
  7349     MOVE EIBRESP  TO WS-RESPONSE
  7350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7351
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 129
* EL6318.cbl
  7352        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7353     END-IF
  7354
  7355     .
  7356 0441-EXIT.
  7357     EXIT.
  7358
  7359
  7360 0442-SQUEEZE-IT-IN.
  7361
  7362     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7363        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7364           NOTE-SUB = +10
  7365           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7366           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7367             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7368             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7369             MOVE +9 TO NOTE-SUB
  7370           END-IF
  7371        END-PERFORM
  7372     ELSE
  7373        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7374           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7375             UNTIL NOTE-SUB = +1
  7376             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7377             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7378                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7379                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7380                MOVE +2          TO NOTE-SUB
  7381             END-IF
  7382           END-PERFORM
  7383        END-IF
  7384     END-IF
  7385
  7386     .
  7387 0442-EXIT.
  7388     EXIT.
  7389
  7390 0445-CERTIFICATE-UPDATE.
  7391    display 'billing note written, updating cert'
  7392     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7393     IF RESP-NORMAL
  7394        EVALUATE CM-NOTE-SW
  7395           WHEN '2'
  7396           WHEN '3'
  7397           WHEN '6'
  7398           WHEN '7'
  7399              SET NO-CERT-RW     TO TRUE
  7400           WHEN ' '
  7401              MOVE '2'           TO CM-NOTE-SW
  7402           WHEN '1'
  7403              MOVE '3'           TO CM-NOTE-SW
  7404           WHEN '4'
  7405              MOVE '6'           TO CM-NOTE-SW
  7406           WHEN '5'
  7407              MOVE '7'           TO CM-NOTE-SW
  7408        END-EVALUATE
  7409     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 130
* EL6318.cbl
  7410     IF NOT NO-CERT-RW
  7411        PERFORM 1810-REWRITE-ELCERT
  7412                                 THRU 1810-EXIT
  7413     ELSE
  7414
  7415* EXEC CICS UNLOCK
  7416*          DATASET    (WS-ELCERT-FILE-ID)
  7417*       END-EXEC
  7418*    MOVE '&*                    #   #00006975' TO DFHEIV0
  7419     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7421     MOVE X'2020233030303036393735' TO DFHEIV0(25:11)
  7422     CALL 'kxdfhei1' USING DFHEIV0,
  7423           WS-ELCERT-FILE-ID,
  7424           DFHEIV99
  7425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7426     END-IF
  7427
  7428     .
  7429 0445-EXIT.
  7430     EXIT.
  7431
  7432 0450-GET-ERACCT.
  7433     MOVE ' '                    TO WS-ERACCT-SW
  7434     MOVE ZEROS                  TO WS-CHGBACK
  7435                                    WS-CSO-PORTION
  7436                                    WS-ACCT-PORTION
  7437                                    WS-DIFF
  7438     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7439     IF RESP-NORMAL
  7440        PERFORM 0470-READNEXT-ERACCT
  7441                                 THRU 0470-EXIT
  7442     END-IF
  7443     IF RESP-NORMAL
  7444        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7445           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7446              AND >= AM-EFFECTIVE-DT
  7447              SET ACCT-FOUND TO TRUE
  7448           ELSE
  7449              PERFORM 0470-READNEXT-ERACCT
  7450                                 THRU 0470-EXIT
  7451              IF RESP-NORMAL
  7452                 IF AM-CONTROL-PRIMARY (1:20)
  7453                    = EN-CONTROL-PRIMARY (1:20)
  7454                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7455                       AND >= AM-EFFECTIVE-DT
  7456                       SET ACCT-FOUND TO TRUE
  7457                    END-IF
  7458                 END-IF
  7459              END-IF
  7460           END-IF
  7461        END-IF
  7462     END-IF
  7463     IF ACCT-FOUND
  7464        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7465           (AM-COM-TYP (S1) = 'C' OR 'D')
  7466           OR (S1 > +10)
  7467        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 131
* EL6318.cbl
  7468        IF S1 < +11
  7469           MOVE AM-COMM-CHARGEBACK (S1)
  7470                                 TO WS-CHGBACK
  7471        END-IF
  7472     END-IF
  7473    .
  7474 0450-EXIT.
  7475     EXIT.
  7476 0460-STARTBR-ERACCT.
  7477     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7478     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7479     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7480
  7481* EXEC CICS STARTBR
  7482*        DATASET   ('ERACCT')
  7483*        RIDFLD    (WS-ERACCT-KEY)
  7484*        GTEQ
  7485*        RESP      (WS-RESPONSE)
  7486*    END-EXEC
  7487     MOVE 'ERACCT' TO DFHEIV1
  7488     MOVE 0
  7489       TO DFHEIV11
  7490*    MOVE '&,         G          &  N#00007032' TO DFHEIV0
  7491     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7493     MOVE X'204E233030303037303332' TO DFHEIV0(25:11)
  7494     CALL 'kxdfhei1' USING DFHEIV0,
  7495           DFHEIV1,
  7496           WS-ERACCT-KEY,
  7497           DFHEIV99,
  7498           DFHEIV11,
  7499           DFHEIV99
  7500     MOVE EIBRESP  TO WS-RESPONSE
  7501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7502     .
  7503 0460-EXIT.
  7504     EXIT.
  7505 0470-READNEXT-ERACCT.
  7506
  7507* EXEC CICS READNEXT
  7508*       INTO    (ACCOUNT-MASTER)
  7509*       DATASET ('ERACCT')
  7510*       RIDFLD  (WS-ERACCT-KEY)
  7511*       RESP    (WS-RESPONSE)
  7512*    END-EXEC
  7513     MOVE LENGTH OF
  7514      ACCOUNT-MASTER
  7515       TO DFHEIV12
  7516     MOVE 'ERACCT' TO DFHEIV1
  7517     MOVE 0
  7518       TO DFHEIV11
  7519*    MOVE '&.IL                  )  N#00007042' TO DFHEIV0
  7520     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7521     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7522     MOVE X'204E233030303037303432' TO DFHEIV0(25:11)
  7523     CALL 'kxdfhei1' USING DFHEIV0,
  7524           DFHEIV1,
  7525           ACCOUNT-MASTER,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 132
* EL6318.cbl
  7526           DFHEIV12,
  7527           WS-ERACCT-KEY,
  7528           DFHEIV99,
  7529           DFHEIV11,
  7530           DFHEIV99,
  7531           DFHEIV99
  7532     MOVE EIBRESP  TO WS-RESPONSE
  7533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7534     .
  7535 0470-EXIT.
  7536     EXIT.
  7537 0500-CREATE-TEMP-STORAGE.
  7538     display ' about to write pi ' program-interface-block
  7539
  7540* EXEC CICS WRITEQ TS
  7541*        QUEUE (QID)
  7542*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7543*        LENGTH(PI-COMM-LENGTH)
  7544*    END-EXEC
  7545*    MOVE '*"                    ''   #00007053' TO DFHEIV0
  7546     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7548     MOVE X'2020233030303037303533' TO DFHEIV0(25:11)
  7549     CALL 'kxdfhei1' USING DFHEIV0,
  7550           QID,
  7551           PROGRAM-INTERFACE-BLOCK,
  7552           PI-COMM-LENGTH,
  7553           DFHEIV99,
  7554           DFHEIV99,
  7555           DFHEIV99
  7556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7557     display ' about to write map ' el631ki
  7558
  7559* EXEC CICS WRITEQ TS
  7560*        QUEUE (QID)
  7561*        FROM  (EL631KI)
  7562*        LENGTH(MAP-LENGTH)
  7563*    END-EXEC.
  7564*    MOVE '*"                    ''   #00007059' TO DFHEIV0
  7565     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7567     MOVE X'2020233030303037303539' TO DFHEIV0(25:11)
  7568     CALL 'kxdfhei1' USING DFHEIV0,
  7569           QID,
  7570           EL631KI,
  7571           MAP-LENGTH,
  7572           DFHEIV99,
  7573           DFHEIV99,
  7574           DFHEIV99
  7575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7576
  7577 0500-EXIT.
  7578      EXIT.
  7579 0600-RECOVER-TEMP-STORAGE.
  7580     display ' about to recover pi '
  7581
  7582* EXEC CICS READQ TS
  7583*        QUEUE (QID)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 133
* EL6318.cbl
  7584*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7585*        LENGTH(PI-COMM-LENGTH)
  7586*    END-EXEC
  7587*    MOVE '*$I    L              ''   #00007068' TO DFHEIV0
  7588     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7590     MOVE X'2020233030303037303638' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0,
  7592           QID,
  7593           PROGRAM-INTERFACE-BLOCK,
  7594           PI-COMM-LENGTH,
  7595           DFHEIV99,
  7596           DFHEIV99,
  7597           DFHEIV99
  7598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7599     display ' pi ' pi-program-work-area
  7600     display ' about to recover map '
  7601
  7602* EXEC CICS READQ TS
  7603*        QUEUE (QID)
  7604*        INTO  (EL631KI)
  7605*        LENGTH(MAP-LENGTH)
  7606*    END-EXEC
  7607*    MOVE '*$I    L              ''   #00007075' TO DFHEIV0
  7608     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303037303735' TO DFHEIV0(25:11)
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           QID,
  7613           EL631KI,
  7614           MAP-LENGTH,
  7615           DFHEIV99,
  7616           DFHEIV99,
  7617           DFHEIV99
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7619     display ' map ' el631ki
  7620     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7621     MOVE AL-UANON            TO SIGREQA
  7622     MOVE AL-UANON            TO LTRIDA
  7623     MOVE AL-UANON            TO VOUCHA
  7624     MOVE AL-UANON            TO HLTHAPPA
  7625     MOVE AL-UANON            TO PAYEEA
  7626     IF WS-SET-CODES-MDT = 'Y'
  7627        move +1                  to s2
  7628        perform varying s1 from +1 by +5 until s1 > +60
  7629           MOVE WS-PASSED-REASON-CODES (s1:4)
  7630                                 TO reacd-in (s2)
  7631           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7632               MOVE AL-SANON     TO REACDA (S2)
  7633               MOVE +4           TO REACDL (S2)
  7634           END-IF
  7635           add +1                to s2
  7636        end-perform
  7637        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7638     END-IF
  7639     IF CERTIDI > SPACES
  7640         MOVE AL-UANON       TO CERTIDA
  7641     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 134
* EL6318.cbl
  7642
  7643     IF CRTNT1I > SPACES
  7644         MOVE AL-UANON       TO CRTNT1A
  7645     END-IF
  7646
  7647     IF CRTNT2I > SPACES
  7648         MOVE AL-UANON       TO CRTNT2A
  7649     END-IF
  7650
  7651     IF CRTNT3I > SPACES
  7652         MOVE AL-UANON       TO CRTNT3A
  7653     END-IF
  7654
  7655     IF CRTNT4I > SPACES
  7656         MOVE AL-UANON       TO CRTNT4A
  7657     END-IF
  7658
  7659     IF BILNT1I > SPACES
  7660         MOVE AL-UANON       TO BILNT1A
  7661     END-IF
  7662
  7663     IF BILNT2I > SPACES
  7664         MOVE AL-UANON       TO BILNT2A
  7665     END-IF
  7666     .
  7667 0600-EXIT.
  7668      EXIT.
  7669 0800-DELETE-TS.
  7670
  7671* EXEC CICS DELETEQ TS
  7672*        QUEUE(QID)
  7673*    END-EXEC
  7674*    MOVE '*&                    #   #00007131' TO DFHEIV0
  7675     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7676     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7677     MOVE X'2020233030303037313331' TO DFHEIV0(25:11)
  7678     CALL 'kxdfhei1' USING DFHEIV0,
  7679           QID,
  7680           DFHEIV99
  7681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7682     .
  7683 0800-EXIT.
  7684      EXIT.
  7685 1000-BUILD-ERARCH.
  7686     display ' made it to 1000 '
  7687     MOVE SPACES                 TO W-CNTL-KEY
  7688     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7689     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7690     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7691
  7692* EXEC CICS READ
  7693*         DATASET    (WS-ELCNTL-FILE-ID)
  7694*         SET        (ADDRESS OF CONTROL-FILE)
  7695*         RIDFLD     (W-CNTL-KEY)
  7696*         UPDATE
  7697*         RESP       (WS-RESPONSE)
  7698*    END-EXEC
  7699*    MOVE '&"S        EU         (  N#00007143' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 135
* EL6318.cbl
  7700     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7701     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7702     MOVE X'204E233030303037313433' TO DFHEIV0(25:11)
  7703     CALL 'kxdfhei1' USING DFHEIV0,
  7704           WS-ELCNTL-FILE-ID,
  7705           DFHEIV20,
  7706           DFHEIV99,
  7707           W-CNTL-KEY,
  7708           DFHEIV99,
  7709           DFHEIV99,
  7710           DFHEIV99
  7711     SET ADDRESS OF CONTROL-FILE TO
  7712         DFHEIV20
  7713     MOVE EIBRESP  TO WS-RESPONSE
  7714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7715     IF RESP-NORMAL
  7716        display ' good read elcntl '
  7717        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7718           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7719        END-IF
  7720        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7721        MOVE CF-CREDIT-LAST-ARCH-NUM
  7722                                 TO W-ARCH-NUMBER
  7723
  7724* EXEC CICS REWRITE
  7725*          FROM      (CONTROL-FILE)
  7726*          DATASET   (WS-ELCNTL-FILE-ID)
  7727*       END-EXEC
  7728     MOVE LENGTH OF
  7729      CONTROL-FILE
  7730       TO DFHEIV11
  7731*    MOVE '&& L                  %   #00007158' TO DFHEIV0
  7732     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7733     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7734     MOVE X'2020233030303037313538' TO DFHEIV0(25:11)
  7735     CALL 'kxdfhei1' USING DFHEIV0,
  7736           WS-ELCNTL-FILE-ID,
  7737           CONTROL-FILE,
  7738           DFHEIV11,
  7739           DFHEIV99
  7740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7741     END-IF
  7742
  7743* EXEC CICS GETMAIN
  7744*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7745*       LENGTH   (W-ARCH-LENGTH)
  7746*    END-EXEC
  7747*    MOVE '," L                  $   #00007163' TO DFHEIV0
  7748     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7750     MOVE X'2020233030303037313633' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0,
  7752           DFHEIV20,
  7753           W-ARCH-LENGTH,
  7754           DFHEIV99
  7755     SET ADDRESS OF LETTER-ARCHIVE TO
  7756         DFHEIV20
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 136
* EL6318.cbl
  7758     MOVE 'LA'                   TO LETTER-ARCHIVE
  7759     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7760                                    LA-ARCHIVE-NO-A2
  7761                                    LA-ARCHIVE-NO-A3
  7762                                    LA-ARCHIVE-NO-A4
  7763                                    LA-ARCHIVE-NO-A5
  7764                                    LA-ARCHIVE-NO-A6
  7765     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7766                                    LA-COMPANY-CD-A2
  7767                                    LA-COMPANY-CD-A3
  7768                                    LA-COMPANY-CD-A4
  7769                                    LA-COMPANY-CD-A5
  7770                                    LA-COMPANY-CD-A6
  7771     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7772                                    LA-CARRIER-A3
  7773                                    LA-CARRIER-A4
  7774                                    LA-CARRIER-A5
  7775     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7776     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7777                                    LA-GROUPING-A3
  7778                                    LA-GROUPING-A4
  7779                                    LA-GROUPING-A5
  7780     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7781                                    LA-ACCOUNT-A3
  7782                                    LA-ACCOUNT-A4
  7783                                    LA-ACCOUNT-A5
  7784     MOVE PB-STATE               TO LA-STATE-A2
  7785                                    LA-STATE-A3
  7786                                    LA-STATE-A4
  7787                                    LA-STATE-A5
  7788     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7789     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7790     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7791     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7792     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7793                                    LA-INITIAL-PRINT-DATE
  7794                                    LA-SENT-DATE
  7795                                    LA-REPLY-DATE
  7796                                    LA-RESEND-DATE
  7797                                    LA-FOLLOW-UP-DATE
  7798     MOVE 'A'                    TO LA-STATUS
  7799     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7800     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7801     MOVE LTRIDI                 TO LA-FORM-A3
  7802     MOVE '4'                    TO LA-DATA-SOURCE
  7803     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7804     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7805                                    LA-NO-OF-TEXT-RECORDS
  7806
  7807* EXEC CICS WRITE
  7808*         DATASET   ('ERARCH')
  7809*         FROM      (LETTER-ARCHIVE)
  7810*         RIDFLD    (LA-CONTROL-PRIMARY)
  7811*         RESP      (WS-RESPONSE)
  7812*    END-EXEC
  7813     MOVE LENGTH OF
  7814      LETTER-ARCHIVE
  7815       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 137
* EL6318.cbl
  7816     MOVE 'ERARCH' TO DFHEIV1
  7817*    MOVE '&$ L                  ''  N#00007215' TO DFHEIV0
  7818     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7819     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7820     MOVE X'204E233030303037323135' TO DFHEIV0(25:11)
  7821     CALL 'kxdfhei1' USING DFHEIV0,
  7822           DFHEIV1,
  7823           LETTER-ARCHIVE,
  7824           DFHEIV11,
  7825           LA-CONTROL-PRIMARY,
  7826           DFHEIV99,
  7827           DFHEIV99
  7828     MOVE EIBRESP  TO WS-RESPONSE
  7829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7830     IF RESP-NORMAL
  7831        display ' good write erarch '
  7832        MOVE ER-0280             TO EMI-ERROR
  7833        MOVE -1                  TO SIGREQL
  7834        PERFORM 9900-ERROR-FORMAT
  7835                                 THRU 9900-EXIT
  7836        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7837        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7838     ELSE
  7839        MOVE ER-7345             TO EMI-ERROR
  7840        MOVE -1                  TO SIGREQL
  7841        PERFORM 9900-ERROR-FORMAT
  7842                                 THRU 9900-EXIT
  7843     END-IF
  7844     .
  7845 1000-EXIT.
  7846     EXIT.
  7847 1100-CALL-NS-BUS-LOGIC.
  7848     DISPLAY ' MADE IT TO 1100 '
  7849     MOVE SPACES                 TO BL-INPUT
  7850     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7851     MOVE '4'                    TO BL-DATA-SRCE
  7852     MOVE PB-CARRIER             TO BL-CARRIER
  7853     MOVE PB-GROUPING            TO BL-GROUP
  7854     MOVE PB-STATE               TO BL-STATE
  7855     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7856     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7857        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7858        MOVE ' '                 TO DC-OPTION-CODE
  7859        PERFORM 9700-date-link
  7860        IF NO-CONVERSION-ERROR
  7861           MOVE DC-GREG-DATE-B-EDIT
  7862                                 TO BL-EFF-DT
  7863        END-IF
  7864     END-IF
  7865     MOVE PB-CERT-NO             TO BL-CERT-NO
  7866     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7867     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7868     MOVE SPACES                 TO BL-RESP-NO
  7869     MOVE LTRIDI                 TO BL-LETTER-ID
  7870     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7871     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7872*    MOVE 'ALWA'                 TO BL-PROC-ID
  7873     MOVE PI-COMPANY-ID          TO BL-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 138
* EL6318.cbl
  7874*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7875*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7876     IF EIBAID = DFHPF4
  7877        MOVE 'B'                 TO BL-WRITE-ERARCH
  7878     ELSE
  7879        MOVE 'T'                 TO BL-WRITE-ERARCH
  7880     END-IF
  7881     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7882     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7883     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  7884     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7885        IF REACD-IN (S1) NOT = LOW-VALUES
  7886           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7887        END-IF
  7888     END-PERFORM
  7889    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7890*****************************************
  7891* Invoke the LETTER business logic
  7892*****************************************
  7893
  7894* exec cics link
  7895*       program('NSRASBL')
  7896*       commarea(srch-commarea)
  7897*    end-exec.
  7898     MOVE LENGTH OF
  7899      srch-commarea
  7900       TO DFHEIV11
  7901     MOVE 'NSRASBL' TO DFHEIV1
  7902*    MOVE '."C                   (   #00007284' TO DFHEIV0
  7903     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7905     MOVE X'2020233030303037323834' TO DFHEIV0(25:11)
  7906     CALL 'kxdfhei1' USING DFHEIV0,
  7907           DFHEIV1,
  7908           srch-commarea,
  7909           DFHEIV11,
  7910           DFHEIV99,
  7911           DFHEIV99,
  7912           DFHEIV99,
  7913           DFHEIV99
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7915
  7916     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7917        BL-MESSAGE
  7918     .
  7919 1100-EXIT.
  7920     EXIT.
  7921 1500-GET-ARCH-NO.
  7922     display ' made it to 1500 '
  7923     MOVE SPACES                 TO ELCNTL-KEY
  7924     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7925     MOVE '1'                    TO CNTL-REC-TYPE
  7926     MOVE ZEROS                  TO CNTL-SEQ
  7927
  7928* EXEC CICS READ
  7929*         DATASET    (WS-ELCNTL-FILE-ID)
  7930*         SET        (ADDRESS OF CONTROL-FILE)
  7931*         RIDFLD     (ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 139
* EL6318.cbl
  7932*         UPDATE
  7933*         RESP       (WS-RESPONSE)
  7934*    END-EXEC
  7935*    MOVE '&"S        EU         (  N#00007299' TO DFHEIV0
  7936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7938     MOVE X'204E233030303037323939' TO DFHEIV0(25:11)
  7939     CALL 'kxdfhei1' USING DFHEIV0,
  7940           WS-ELCNTL-FILE-ID,
  7941           DFHEIV20,
  7942           DFHEIV99,
  7943           ELCNTL-KEY,
  7944           DFHEIV99,
  7945           DFHEIV99,
  7946           DFHEIV99
  7947     SET ADDRESS OF CONTROL-FILE TO
  7948         DFHEIV20
  7949     MOVE EIBRESP  TO WS-RESPONSE
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7951     IF RESP-NORMAL
  7952        display ' good read elcntl '
  7953        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7954           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7955        END-IF
  7956        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7957        MOVE CF-CREDIT-LAST-ARCH-NUM
  7958                                 TO W-ARCH-NUMBER
  7959        display ' new arch number ' w-arch-number
  7960
  7961* EXEC CICS REWRITE
  7962*          FROM      (CONTROL-FILE)
  7963*          DATASET   (WS-ELCNTL-FILE-ID)
  7964*       END-EXEC
  7965     MOVE LENGTH OF
  7966      CONTROL-FILE
  7967       TO DFHEIV11
  7968*    MOVE '&& L                  %   #00007315' TO DFHEIV0
  7969     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7970     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7971     MOVE X'2020233030303037333135' TO DFHEIV0(25:11)
  7972     CALL 'kxdfhei1' USING DFHEIV0,
  7973           WS-ELCNTL-FILE-ID,
  7974           CONTROL-FILE,
  7975           DFHEIV11,
  7976           DFHEIV99
  7977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7978     END-IF
  7979     .
  7980 1500-EXIT.
  7981     EXIT.
  7982
  7983
  7984 1700-WRITE-CERT-NOTE      SECTION.
  7985
  7986     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7987     MOVE ZERO           TO ERCNOT-SEQ.
  7988     SET TB-INDX         DOWN BY 1.
  7989     SET TB-INDX1        TO TB-INDX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 140
* EL6318.cbl
  7990
  7991****DELETE CURRENT CERT NOTES
  7992 1700-LOOP.
  7993
  7994* EXEC CICS READ
  7995*        DATASET (WS-ERCNOT-FILE-ID)
  7996*        RIDFLD  (ERCNOT-KEY)
  7997*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7998*        RESP    (WS-RESPONSE)
  7999*        GTEQ
  8000*    END-EXEC.
  8001*    MOVE '&"S        G          (  N#00007334' TO DFHEIV0
  8002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8004     MOVE X'204E233030303037333334' TO DFHEIV0(25:11)
  8005     CALL 'kxdfhei1' USING DFHEIV0,
  8006           WS-ERCNOT-FILE-ID,
  8007           DFHEIV20,
  8008           DFHEIV99,
  8009           ERCNOT-KEY,
  8010           DFHEIV99,
  8011           DFHEIV99,
  8012           DFHEIV99
  8013     SET ADDRESS OF CERT-NOTE-FILE TO
  8014         DFHEIV20
  8015     MOVE EIBRESP  TO WS-RESPONSE
  8016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8017
  8018
  8019     IF NOT RESP-NORMAL
  8020        GO TO 1700-ENDDEL
  8021     END-IF
  8022
  8023     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8024
  8025     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8026         GO TO 1700-ENDDEL
  8027     END-IF.
  8028
  8029
  8030* EXEC CICS DELETE
  8031*        DATASET (WS-ERCNOT-FILE-ID)
  8032*        RIDFLD  (ERCNOT-KEY)
  8033*    END-EXEC.
  8034*    MOVE '&(  R                 &   #00007352' TO DFHEIV0
  8035     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8036     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8037     MOVE X'2020233030303037333532' TO DFHEIV0(25:11)
  8038     CALL 'kxdfhei1' USING DFHEIV0,
  8039           WS-ERCNOT-FILE-ID,
  8040           ERCNOT-KEY,
  8041           DFHEIV99,
  8042           DFHEIV99,
  8043           DFHEIV99
  8044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8045
  8046
  8047     GO TO 1700-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 141
* EL6318.cbl
  8048
  8049 1700-ENDDEL.
  8050
  8051
  8052* EXEC CICS GETMAIN
  8053*         LENGTH(ERCNOT-LENGTH)
  8054*         SET(ADDRESS OF CERT-NOTE-FILE)
  8055*         INITIMG(GETMAIN-SPACE)
  8056*    END-EXEC.
  8057*    MOVE ',"IL                  $   #00007361' TO DFHEIV0
  8058     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8060     MOVE X'2020233030303037333631' TO DFHEIV0(25:11)
  8061     CALL 'kxdfhei1' USING DFHEIV0,
  8062           DFHEIV20,
  8063           ERCNOT-LENGTH,
  8064           GETMAIN-SPACE
  8065     SET ADDRESS OF CERT-NOTE-FILE TO
  8066         DFHEIV20
  8067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8068
  8069
  8070     SET TB-INDX TO 1.
  8071     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8072     MOVE +0             TO ERCNOT-SEQ
  8073
  8074     PERFORM VARYING TB-INDX FROM 1 BY 1
  8075             UNTIL TB-INDX > TB-INDX1
  8076        MOVE SPACES                 TO  CERT-NOTE-FILE
  8077        ADD 1                       TO  ERCNOT-SEQ
  8078        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8079        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8080        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8081        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8082                                    TO  CZ-LAST-MAINT-USER
  8083        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8084                                    TO  CZ-LAST-MAINT-HHMMSS
  8085        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8086                                    TO  CZ-LAST-MAINT-DT
  8087
  8088
  8089* EXEC CICS WRITE
  8090*            DATASET(WS-ERCNOT-FILE-ID)
  8091*            FROM(CERT-NOTE-FILE)
  8092*            RIDFLD(ERCNOT-KEY)
  8093*       END-EXEC
  8094     MOVE LENGTH OF
  8095      CERT-NOTE-FILE
  8096       TO DFHEIV11
  8097*    MOVE '&$ L                  ''   #00007385' TO DFHEIV0
  8098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8100     MOVE X'2020233030303037333835' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0,
  8102           WS-ERCNOT-FILE-ID,
  8103           CERT-NOTE-FILE,
  8104           DFHEIV11,
  8105           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 142
* EL6318.cbl
  8106           DFHEIV99,
  8107           DFHEIV99
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8109     END-PERFORM
  8110
  8111     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8112     IF RESP-NORMAL
  8113        EVALUATE CM-NOTE-SW
  8114           WHEN '1'
  8115           WHEN '3'
  8116           WHEN '5'
  8117           WHEN '7'
  8118              SET NO-CERT-RW     TO TRUE
  8119           WHEN ' '
  8120              MOVE '1'           TO CM-NOTE-SW
  8121           WHEN '2'
  8122              MOVE '3'           TO CM-NOTE-SW
  8123           WHEN '4'
  8124              MOVE '5'           TO CM-NOTE-SW
  8125           WHEN '6'
  8126              MOVE '7'           TO CM-NOTE-SW
  8127        END-EVALUATE
  8128     END-IF
  8129     IF NOT NO-CERT-RW
  8130        PERFORM 1810-REWRITE-ELCERT
  8131                                 THRU 1810-EXIT
  8132     ELSE
  8133
  8134* EXEC CICS UNLOCK
  8135*          DATASET    (WS-ELCERT-FILE-ID)
  8136*       END-EXEC
  8137*    MOVE '&*                    #   #00007414' TO DFHEIV0
  8138     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8139     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8140     MOVE X'2020233030303037343134' TO DFHEIV0(25:11)
  8141     CALL 'kxdfhei1' USING DFHEIV0,
  8142           WS-ELCERT-FILE-ID,
  8143           DFHEIV99
  8144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8145     END-IF
  8146
  8147     .
  8148 1799-EXIT.
  8149     EXIT.
  8150
  8151 1800-READ-ELCERT-UPDATE.
  8152
  8153     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8154     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8155     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8156     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8157     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8158     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8159     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8160     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8161
  8162
  8163* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 143
* EL6318.cbl
  8164*        UPDATE
  8165*        DATASET  (WS-ELCERT-FILE-ID)
  8166*        RIDFLD   (WS-ELCERT-KEY)
  8167*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8168*        RESP     (WS-RESPONSE)
  8169*    END-EXEC
  8170*    MOVE '&"S        EU         (  N#00007434' TO DFHEIV0
  8171     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8172     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8173     MOVE X'204E233030303037343334' TO DFHEIV0(25:11)
  8174     CALL 'kxdfhei1' USING DFHEIV0,
  8175           WS-ELCERT-FILE-ID,
  8176           DFHEIV20,
  8177           DFHEIV99,
  8178           WS-ELCERT-KEY,
  8179           DFHEIV99,
  8180           DFHEIV99,
  8181           DFHEIV99
  8182     SET ADDRESS OF CERTIFICATE-MASTER TO
  8183         DFHEIV20
  8184     MOVE EIBRESP  TO WS-RESPONSE
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8186
  8187     .
  8188 1800-EXIT.
  8189     EXIT.
  8190
  8191 1810-REWRITE-ELCERT.
  8192
  8193
  8194* EXEC CICS REWRITE
  8195*        FROM     (CERTIFICATE-MASTER)
  8196*        DATASET  (WS-ELCERT-FILE-ID)
  8197*        RESP     (WS-RESPONSE)
  8198*    END-EXEC.
  8199     MOVE LENGTH OF
  8200      CERTIFICATE-MASTER
  8201       TO DFHEIV11
  8202*    MOVE '&& L                  %  N#00007448' TO DFHEIV0
  8203     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8204     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8205     MOVE X'204E233030303037343438' TO DFHEIV0(25:11)
  8206     CALL 'kxdfhei1' USING DFHEIV0,
  8207           WS-ELCERT-FILE-ID,
  8208           CERTIFICATE-MASTER,
  8209           DFHEIV11,
  8210           DFHEIV99
  8211     MOVE EIBRESP  TO WS-RESPONSE
  8212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8213
  8214
  8215     .
  8216 1810-EXIT.
  8217     EXIT.
  8218
  8219 8100-SEND-INITIAL-MAP.
  8220     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8221     MOVE '5'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 144
* EL6318.cbl
  8222     PERFORM 9700-DATE-LINK.
  8223     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8224     MOVE EIBTIME                TO TIME-IN.
  8225     MOVE TIME-OUT               TO TIMEO.
  8226     MOVE -1                     TO SIGREQL
  8227     IF PI-PROCESSOR-IS-CSR-SUPER
  8228        perform varying s1 from +1 by +1 until
  8229           s1 > +12
  8230           MOVE AL-UANON            TO reacda (s1)
  8231        end-perform
  8232     END-IF
  8233     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8234     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8235
  8236* EXEC CICS SEND
  8237*        MAP      (MAP-NAME)
  8238*        MAPSET   (MAPSET-NAME)
  8239*        FROM     (EL631KO)
  8240*        ERASE
  8241*        CURSOR
  8242*    END-EXEC.
  8243     MOVE LENGTH OF
  8244      EL631KO
  8245       TO DFHEIV12
  8246     MOVE -1
  8247       TO DFHEIV11
  8248*    MOVE '8$     CT  E    H L F ,   #00007474' TO DFHEIV0
  8249     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8250     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8251     MOVE X'2020233030303037343734' TO DFHEIV0(25:11)
  8252     CALL 'kxdfhei1' USING DFHEIV0,
  8253           MAP-NAME,
  8254           EL631KO,
  8255           DFHEIV12,
  8256           MAPSET-NAME,
  8257           DFHEIV99,
  8258           DFHEIV99,
  8259           DFHEIV99,
  8260           DFHEIV11,
  8261           DFHEIV99,
  8262           DFHEIV99,
  8263           DFHEIV99
  8264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8265
  8266     GO TO 9100-RETURN-TRAN.
  8267 8200-SEND-DATAONLY.
  8268     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8269     MOVE '5'                    TO DC-OPTION-CODE.
  8270     PERFORM 9700-DATE-LINK.
  8271     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8272     MOVE EIBTIME                TO TIME-IN.
  8273     MOVE TIME-OUT               TO TIMEO.
  8274     MOVE -1                     TO PFENTRL
  8275     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8276     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8277
  8278* EXEC CICS SEND
  8279*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 145
* EL6318.cbl
  8280*        MAPSET   (MAPSET-NAME)
  8281*        FROM     (EL631KO)
  8282*        DATAONLY
  8283*        ERASEAUP
  8284*        CURSOR
  8285*    END-EXEC.
  8286     MOVE LENGTH OF
  8287      EL631KO
  8288       TO DFHEIV12
  8289     MOVE -1
  8290       TO DFHEIV11
  8291*    MOVE '8$D    CT  A    H L F ,   #00007492' TO DFHEIV0
  8292     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8293     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8294     MOVE X'2020233030303037343932' TO DFHEIV0(25:11)
  8295     CALL 'kxdfhei1' USING DFHEIV0,
  8296           MAP-NAME,
  8297           EL631KO,
  8298           DFHEIV12,
  8299           MAPSET-NAME,
  8300           DFHEIV99,
  8301           DFHEIV99,
  8302           DFHEIV99,
  8303           DFHEIV11,
  8304           DFHEIV99,
  8305           DFHEIV99,
  8306           DFHEIV99
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309     GO TO 9100-RETURN-TRAN.
  8310 8300-SEND-TEXT.
  8311
  8312* EXEC CICS SEND TEXT
  8313*        FROM     (LOGOFF-TEXT)
  8314*        LENGTH   (LOGOFF-LENGTH)
  8315*        ERASE
  8316*        FREEKB
  8317*    END-EXEC.
  8318*    MOVE '8&      T  E F  H   F -   #00007502' TO DFHEIV0
  8319     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8320     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8321     MOVE X'2020233030303037353032' TO DFHEIV0(25:11)
  8322     CALL 'kxdfhei1' USING DFHEIV0,
  8323           LOGOFF-TEXT,
  8324           LOGOFF-LENGTH,
  8325           DFHEIV99,
  8326           DFHEIV99,
  8327           DFHEIV99,
  8328           DFHEIV99,
  8329           DFHEIV99,
  8330           DFHEIV99,
  8331           DFHEIV99,
  8332           DFHEIV99,
  8333           DFHEIV99,
  8334           DFHEIV99
  8335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8336
  8337
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 146
* EL6318.cbl
  8338* EXEC CICS RETURN
  8339*    END-EXEC.
  8340*    MOVE '.(                    ''   #00007508' TO DFHEIV0
  8341     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8342     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8343     MOVE X'2020233030303037353038' TO DFHEIV0(25:11)
  8344     CALL 'kxdfhei1' USING DFHEIV0,
  8345           DFHEIV99,
  8346           DFHEIV99,
  8347           DFHEIV99,
  8348           DFHEIV99,
  8349           DFHEIV99,
  8350           DFHEIV99
  8351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8352
  8353 8800-UNAUTHORIZED-ACCESS.
  8354     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8355     GO TO 8300-SEND-TEXT.
  8356 8810-PF23.
  8357     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8358     MOVE XCTL-005               TO PGM-NAME.
  8359     GO TO 9300-XCTL.
  8360 9000-RETURN-CICS.
  8361
  8362* EXEC CICS RETURN
  8363*    END-EXEC.
  8364*    MOVE '.(                    ''   #00007518' TO DFHEIV0
  8365     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8366     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8367     MOVE X'2020233030303037353138' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0,
  8369           DFHEIV99,
  8370           DFHEIV99,
  8371           DFHEIV99,
  8372           DFHEIV99,
  8373           DFHEIV99,
  8374           DFHEIV99
  8375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8376
  8377 9100-RETURN-TRAN.
  8378     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8379     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8380
  8381* EXEC CICS RETURN
  8382*        TRANSID    (TRANS-ID)
  8383*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8384*        LENGTH     (PI-COMM-LENGTH)
  8385*    END-EXEC.
  8386*    MOVE '.(CT                  ''   #00007523' TO DFHEIV0
  8387     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8389     MOVE X'2020233030303037353233' TO DFHEIV0(25:11)
  8390     CALL 'kxdfhei1' USING DFHEIV0,
  8391           TRANS-ID,
  8392           PROGRAM-INTERFACE-BLOCK,
  8393           PI-COMM-LENGTH,
  8394           DFHEIV99,
  8395           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 147
* EL6318.cbl
  8396           DFHEIV99
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8398
  8399 9200-RETURN-MAIN-MENU.
  8400     MOVE XCTL-626               TO PGM-NAME.
  8401     GO TO 9300-XCTL.
  8402 9300-XCTL.
  8403
  8404* EXEC CICS XCTL
  8405*        PROGRAM    (PGM-NAME)
  8406*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8407*        LENGTH     (PI-COMM-LENGTH)
  8408*    END-EXEC.
  8409*    MOVE '.$C                   %   #00007532' TO DFHEIV0
  8410     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8412     MOVE X'2020233030303037353332' TO DFHEIV0(25:11)
  8413     CALL 'kxdfhei1' USING DFHEIV0,
  8414           PGM-NAME,
  8415           PROGRAM-INTERFACE-BLOCK,
  8416           PI-COMM-LENGTH,
  8417           DFHEIV99
  8418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8419
  8420 9400-CLEAR.
  8421     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8422
  8423* EXEC CICS XCTL
  8424*        PROGRAM    (PGM-NAME)
  8425*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8426*        LENGTH     (PI-COMM-LENGTH)
  8427*    END-EXEC.
  8428*    MOVE '.$C                   %   #00007539' TO DFHEIV0
  8429     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8431     MOVE X'2020233030303037353339' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0,
  8433           PGM-NAME,
  8434           PROGRAM-INTERFACE-BLOCK,
  8435           PI-COMM-LENGTH,
  8436           DFHEIV99
  8437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8438
  8439 9500-PF12.
  8440     MOVE XCTL-010               TO PGM-NAME.
  8441     GO TO 9300-XCTL.
  8442 9600-PGMID-ERROR.
  8443
  8444* EXEC CICS HANDLE CONDITION
  8445*        PGMIDERR    (8300-SEND-TEXT)
  8446*    END-EXEC.
  8447*    MOVE '"$L                   ! " #00007548' TO DFHEIV0
  8448     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8450     MOVE X'2220233030303037353438' TO DFHEIV0(25:11)
  8451     CALL 'kxdfhei1' USING DFHEIV0
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 148
* EL6318.cbl
  8454     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8455     MOVE ' '                    TO PI-ENTRY-CD-1.
  8456     MOVE XCTL-005               TO PGM-NAME.
  8457     MOVE PGM-NAME               TO LOGOFF-PGM.
  8458     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8459     GO TO 9300-XCTL.
  8460 9700-DATE-LINK.
  8461     MOVE LINK-ELDATCV           TO PGM-NAME.
  8462
  8463* EXEC CICS LINK
  8464*        PROGRAM    (PGM-NAME)
  8465*        COMMAREA   (DATE-CONVERSION-DATA)
  8466*        LENGTH     (DC-COMM-LENGTH)
  8467*    END-EXEC.
  8468*    MOVE '."C                   (   #00007559' TO DFHEIV0
  8469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8471     MOVE X'2020233030303037353539' TO DFHEIV0(25:11)
  8472     CALL 'kxdfhei1' USING DFHEIV0,
  8473           PGM-NAME,
  8474           DATE-CONVERSION-DATA,
  8475           DC-COMM-LENGTH,
  8476           DFHEIV99,
  8477           DFHEIV99,
  8478           DFHEIV99,
  8479           DFHEIV99
  8480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8481
  8482 9900-ERROR-FORMAT.
  8483     IF NOT EMI-ERRORS-COMPLETE
  8484        MOVE LINK-001            TO PGM-NAME
  8485
  8486* EXEC CICS LINK
  8487*           PROGRAM    (PGM-NAME)
  8488*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8489*           LENGTH     (EMI-COMM-LENGTH)
  8490*       END-EXEC
  8491*    MOVE '."C                   (   #00007567' TO DFHEIV0
  8492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8494     MOVE X'2020233030303037353637' TO DFHEIV0(25:11)
  8495     CALL 'kxdfhei1' USING DFHEIV0,
  8496           PGM-NAME,
  8497           ERROR-MESSAGE-INTERFACE-BLOCK,
  8498           EMI-COMM-LENGTH,
  8499           DFHEIV99,
  8500           DFHEIV99,
  8501           DFHEIV99,
  8502           DFHEIV99
  8503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8504     END-IF
  8505     .
  8506 9900-EXIT.
  8507     EXIT.
  8508 9990-ABEND.
  8509     MOVE LINK-004               TO PGM-NAME.
  8510     MOVE DFHEIBLK               TO EMI-LINE1.
  8511
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 149
* EL6318.cbl
  8512* EXEC CICS LINK
  8513*        PROGRAM   (PGM-NAME)
  8514*        COMMAREA  (EMI-LINE1)
  8515*        LENGTH    (72)
  8516*    END-EXEC.
  8517     MOVE 72
  8518       TO DFHEIV11
  8519*    MOVE '."C                   (   #00007579' TO DFHEIV0
  8520     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8522     MOVE X'2020233030303037353739' TO DFHEIV0(25:11)
  8523     CALL 'kxdfhei1' USING DFHEIV0,
  8524           PGM-NAME,
  8525           EMI-LINE1,
  8526           DFHEIV11,
  8527           DFHEIV99,
  8528           DFHEIV99,
  8529           DFHEIV99,
  8530           DFHEIV99
  8531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8532
  8533     GO TO 8200-SEND-DATAONLY.
  8534
  8535* GOBACK.
  8536     MOVE '9%                    "   ' TO DFHEIV0
  8537     MOVE 'EL6318' TO DFHEIV1
  8538     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8539     GOBACK.
  8540 9995-SECURITY-VIOLATION.
  8541*                            COPY ELCSCTP.
  8542******************************************************************
  8543*                                                                *
  8544*                            ELCSCTP                             *
  8545*                            VMOD=2.001                          *
  8546*                                                                *
  8547*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8548******************************************************************
  8549
  8550
  8551     MOVE EIBDATE          TO SM-JUL-DATE.
  8552     MOVE EIBTRMID         TO SM-TERMID.
  8553     MOVE THIS-PGM         TO SM-PGM.
  8554     MOVE EIBTIME          TO TIME-IN.
  8555     MOVE TIME-OUT         TO SM-TIME.
  8556     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8557
  8558
  8559* EXEC CICS LINK
  8560*         PROGRAM  ('EL003')
  8561*         COMMAREA (SECURITY-MESSAGE)
  8562*         LENGTH   (80)
  8563*    END-EXEC.
  8564     MOVE 'EL003' TO DFHEIV1
  8565     MOVE 80
  8566       TO DFHEIV11
  8567*    MOVE '."C                   (   #00007604' TO DFHEIV0
  8568     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page 150
* EL6318.cbl
  8570     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  8571     CALL 'kxdfhei1' USING DFHEIV0,
  8572           DFHEIV1,
  8573           SECURITY-MESSAGE,
  8574           DFHEIV11,
  8575           DFHEIV99,
  8576           DFHEIV99,
  8577           DFHEIV99,
  8578           DFHEIV99
  8579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8580
  8581
  8582******************************************************************
  8583
  8584 9995-EXIT.
  8585     EXIT.
  8586
  8587 9999-DFHBACK SECTION.
  8588     MOVE '9%                    "   ' TO DFHEIV0
  8589     MOVE 'EL6318' TO DFHEIV1
  8590     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8591     GOBACK.
  8592 9999-DFHEXIT.
  8593     IF DFHEIGDJ EQUAL 0001
  8594         NEXT SENTENCE
  8595     ELSE IF DFHEIGDJ EQUAL 2
  8596         GO TO 8300-SEND-TEXT
  8597         DEPENDING ON DFHEIGDI.
  8598     MOVE '9%                    "   ' TO DFHEIV0
  8599     MOVE 'EL6318' TO DFHEIV1
  8600     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8601     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34808     Code:       19590
