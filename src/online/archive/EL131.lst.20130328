* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29******************************************************************
    30
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL131.cbl
    32 ENVIRONMENT DIVISION.
    33
    34 DATA DIVISION.
    35
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 01  LCP-TIME-OF-DAY-XX.
    39     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    40     05  FILLER                    PIC 99.
    41 01  LCP-CICS-TIME                 PIC 9(15).
    42
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    46
    47*                            COPY ELCSCTM.
    48******************************************************************
    49*                                                                *
    50*                                                                *
    51*                            ELCSCTM                             *
    52*                            VMOD=2.001                          *
    53*                                                                *
    54*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    55*                                                                *
    56******************************************************************
    57 01  SECURITY-MESSAGE.
    58     12  FILLER                          PIC X(30)
    59            VALUE '** LOGIC SECURITY VIOLATION -'.
    60     12  SM-READ                         PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' PGM='.
    63     12  SM-PGM                          PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' OPR='.
    66     12  SM-PROCESSOR-ID                 PIC X(4).
    67     12  FILLER                          PIC X(6)
    68            VALUE ' TERM='.
    69     12  SM-TERMID                       PIC X(4).
    70     12  FILLER                          PIC XX   VALUE SPACE.
    71     12  SM-JUL-DATE                     PIC 9(5).
    72     12  FILLER                          PIC X    VALUE SPACE.
    73     12  SM-TIME                         PIC 99.99.
    74
    75
    76*                            COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL131.cbl
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    97             20  SC-CLAIMS-DISPLAY    PIC X.
    98             20  SC-CLAIMS-UPDATE     PIC X.
    99
   100*                            COPY ELCNWA.
   101*****************************************************************
   102*                                                               *
   103*                                                               *
   104*                            ELCNWA.                            *
   105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   106*                            VMOD=2.003                         *
   107*                                                               *
   108*            M O V E   N A M E   W O R K   A R E A.             *
   109*                                                               *
   110*****************************************************************.
   111
   112 01  WS-NAME-WORK-AREA.
   113     05  WS-INSURED-LAST-NAME        PIC X(15).
   114     05  WS-INSURED-1ST-NAME         PIC X(12).
   115     05  WS-INSURED-MID-INIT         PIC X.
   116
   117     05  WS-NAME-WORK.
   118         10  WS-NW                   PIC X
   119             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   120
   121     05  WS-NAME-WORK2.
   122         10  WS-NW2                  PIC X
   123             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   124                                        NWA-INDEX0.
   125
   126     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   127                                     COMP-3.
   128
   129
   130 01  WS-DATE-AREA.
   131     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   132     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   133     12  SAVE-DATE-CCYYMMDD.
   134         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   135         16  SAVE-DATE-YMD.
   136             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   137             20  FILLER         PIC X(4)    VALUE SPACES.
   138
   139 01  WS-BLANK                   PIC X       VALUE ' '.
   140
   141 01  CSO-WORK-FIELDS.
   142     05  WS-HOLD-CLAIM-STATUS    PIC X.
   143
   144 01  LITERALS-NUMBERS.
   145     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   146     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   147     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL131.cbl
   148     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   149     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   150     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   151     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   152
   153     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   154     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   155     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   156     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   157     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   158     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   159     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   160     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   161     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   162
   163     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   164
   165     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   166
   167     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   168     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   169     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   170     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   171     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   172     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   173     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   174     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   175     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   176     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   177     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   178
   179     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   180     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   181     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   182     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   183         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   184     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   185     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   186     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   187     12  WS-CLAIM-SEQU.
   188         16  FILLER              PIC X VALUE '('.
   189         16  WS-CURRENT-SEQU     PIC Z9.
   190         16  FILLER              PIC X(04) VALUE ' OF '.
   191         16  WS-OF-SEQU          PIC Z9.
   192         16  FILLER              PIC X VALUE ')'.
   193     12  WS-EDIT-BEN-CODE        PIC XX.
   194         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   195                                          '90' THRU '99'.
   196
   197     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   198     12  WS-EDIT-NUMBER          PIC ZZZ9.
   199
   200     12  WS-RESPONSE             PIC S9(8)   COMP.
   201         88  WS-RESP-NORMAL                  VALUE +00.
   202         88  WS-RESP-NOTFND                  VALUE +13.
   203
   204     12  WS-MOS-PAID             PIC 999.
   205     12  WS-ODD-DAYS             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL131.cbl
   206     12  WS-REM-MOS              PIC 999.
   207     12  WS-REM-DAYS             PIC 99.
   208     12  WS-TERM-IN-DAYS         PIC 9(4).
   209     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   210
   211     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   212     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   213     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   214     12  WS-RESET-SW             PIC X       VALUE 'N'.
   215     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   216     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   217     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   218
   219 01  DMD-DATE-YYYYMMDD.
   220     12  DMD-DECADE          PIC XX      VALUE SPACES.
   221     12  DMD-YYMMDD.
   222         16  DMD-YY          PIC XX      VALUE SPACES.
   223         16  DMD-MM          PIC XX      VALUE SPACES.
   224         16  DMD-DD          PIC XX      VALUE SPACES.
   225
   226 01  DMD-DATE-MMDDYYYY.
   227     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   228     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   229     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   230     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   231     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   232     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   233
   234 01  WS-MAIL-CODE.
   235     12  FILLER              PIC X.
   236     12  DMD-MAIL-CODE.
   237         16  WS-MAIL-4       PIC X(4).
   238         16  WS-MAIL-5       PIC X.
   239     12  FILLER              PIC X(4).
   240
   241     12  W-NAME-LAST             PIC  X(15).
   242     12  W-NAME-FIRST            PIC  X(15).
   243     12  W-NAME-MIDDLE.
   244         16  FILLER              PIC  X.
   245         16  W-NAME-MIDDLE-2     PIC  X.
   246         16  FILLER              PIC  X(13).
   247
   248*    COPY ELCDCTB.
   249******************************************************************
   250*                                                                *
   251*                                                                *
   252*                            ELCDCTB.                            *
   253*                            VMOD=2.002                          *
   254*                                                                *
   255*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   256*       COMMUNICATIONS AREA                                      *
   257*                                                                *
   258******************************************************************
   259 01  DCT-COMMUNICATION-AREA.
   260     12  DCT-BILLING-BANK-ID      PIC  X(05).
   261     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   262     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   263     12  DCT-PRODUCT-CODE         PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL131.cbl
   264     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   265     12  DCT-RETURN-CODE          PIC  X(02).
   266     12  DCT-MAIL-CODE            PIC  X(05).
   267     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   268     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL131.cbl
   270 01  ERROR-SWITCHES.
   271     12  ERROR-SWITCH            PIC X.
   272         88  SCREEN-ERROR                    VALUE 'X'.
   273     12  MSTR-KEY-SWITCH         PIC X.
   274         88  MSTR-KEY-CHANGED                VALUE 'X'.
   275     12  CERT-KEY-SWITCH         PIC X.
   276*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   277         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   278*********SET TO Y IF PRIMARY KEY WILL CHANGE
   279         88  CERT-KEY-CHANGED                VALUE 'Y'.
   280     12  MSTR-SWITCH             PIC X.
   281         88  MSTR-UPDATES                    VALUE 'X'.
   282     12  CERT-SWITCH             PIC X.
   283         88  CERT-UPDATES                    VALUE 'X'.
   284     12  UPDATE-SWITCH           PIC X.
   285         88  UPDATES-PRESENT                 VALUE 'X'.
   286     12  TRLR-SWITCH             PIC X.
   287         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   288         88  UPDATE-MADE                     VALUE 'Y'.
   289     12  NINETY-TRLR-SWITCH      PIC X.
   290         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   291     12  EARNINGS-CALC-SWITCH    PIC X.
   292         88  TEX-REG                         VALUE '4'.
   293         88  NET-PAY                         VALUE '5'.
   294     12  DLYACTV-SW              PIC X       VALUE 'N'.
   295         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL131.cbl
   297 01  EDIT-WORK-AREA.
   298     12  COUNT-2                 PIC 9.
   299     12  CALL-PGM                PIC X(8).
   300     12  TRANS-ID                PIC X(4).
   301     12  CHECK-PFKEYS            PIC 99.
   302     12  CHECK-MAINT             PIC X.
   303         88  ADD-ALPHA-RECORD                VALUE 'A'.
   304         88  CHANGE-CLAIM                    VALUE 'C'.
   305         88  DELETE-CLAIM                    VALUE 'D'.
   306         88  CHANGE-NAME                     VALUE 'N'.
   307         88  VALID-OPTIONS                   VALUE 'A' 'C'
   308                                                   'D' 'N'.
   309
   310     12  HOLD-BENEFIT            PIC XX.
   311     12  HOLD-FREQ               PIC XX.
   312     12  HOLD-REPORTED           PIC XX.
   313     12  HOLD-INCUR              PIC XX.
   314     12  HOLD-PDTHRU             PIC XX.
   315     12  HOLD-ADDON              PIC XX.
   316     12  HOLD-NODAYS             PIC 9(4).
   317     12  HOLD-NOPMTS             PIC 9(3).
   318     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   319     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   320     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   321     12  HOLD-BIRTH              PIC XX.
   322     12  HOLD-END                PIC XX.
   323     12  HOLD-EFF                PIC XX.
   324     12  HOLD-ENTRY              PIC XX.
   325     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   326     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   327     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   328     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   329     12  HOLD-LF-CV-CAN          PIC XX.
   330     12  HOLD-AH-CV-CAN          PIC XX.
   331     12  DIVIDE-QUOT             PIC 9(3).
   332     12  DIVIDE-REM              PIC 9(3).
   333
   334     12  WS-ALPHA-DATE.
   335         16  WS-ALPHA-YEAR.
   336             20  WS-ALPHA-YY-1   PIC 99.
   337             20  WS-ALPHA-YY-2   PIC 99.
   338         16  WS-ALPHA-MM         PIC 99.
   339         16  WS-ALPHA-DD         PIC 99.
   340
   341     12  BUILD-VALID-DATE.
   342         16  BUILD-MONTH         PIC 99.
   343         16  BUILD-DAY           PIC 99.
   344         16  BUILD-YEAR          PIC 99.
   345     12  DEEDIT-MMYY-INPUT.
   346         16  FILLER              PIC X.
   347         16  DEEDIT-MONTH        PIC XX.
   348         16  DEEDIT-YEAR         PIC XX.
   349     12  DEEDIT-BEN              PIC 9(9)V99.
   350     12  DEEDIT-DATE-INPUT.
   351         16  FILLER              PIC XX.
   352         16  DEEDIT-DATE         PIC X(6).
   353     12  WORK-DATE-MDY.
   354         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL131.cbl
   355         16  FILLER              PIC X(4).
   356         16  YEAR-WORK           PIC XX.
   357     12  WORK-DATE-MY.
   358         16  WORK-MONTH          PIC XX.
   359         16  WORK-SLASH          PIC X       VALUE '/'.
   360         16  WORK-YEAR           PIC XX.
   361     12  HOLD-DATE.
   362         16  HOLD-MONTH          PIC 99.
   363         16  FILLER              PIC X(4).
   364         16  HOLD-YEAR           PIC 99.
   365     12  SPLIT-INFO-LINE-1.
   366         16  SPLIT-INFO-DESC     PIC X(15).
   367         16  FILLER              PIC X(5)    VALUE ' OLD='.
   368         16  SPLIT-INFO-OLD      PIC X(40).
   369     12  EFF-TERM-MO             PIC 9(4).
   370     12  CURR-MO                 PIC 9(4).
   371     12  WS-BIN-CURRENT-DT       PIC XX.
   372     12  WS-CALC-METHOD          PIC X.
   373     12  WS-INITIALS.
   374         16  WS-INIT-1           PIC X.
   375         16  WS-INIT-2           PIC X.
   376     12  WS-REIN-TABLE.
   377         16  WS-REIN-1           PIC X.
   378         16  WS-REIN-2           PIC X.
   379         16  WS-REIN-3           PIC X.
   380     12  PI-KEY.
   381         16  PI-TERM             PIC X(4).
   382         16  PI-QUAL             PIC X(4).
   383     12  CHECK-KEY               PIC X(20).
   384     12  SAVE-ACCT-KEY           PIC X(20).
   385     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   386     12  WS-SOC-SEC-NUMBER.
   387         16  WS-SOC-SEC-NO       PIC 9(9).
   388         16  WS-SOC-SEC-BLANK    PIC X(2).
   389     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   390         16  WS-SSN-1-3          PIC 9(3).
   391         16  WS-SSN-DASH1        PIC X(1).
   392         16  WS-SSN-4-5          PIC 9(2).
   393         16  WS-SSN-DASH2        PIC X(1).
   394         16  WS-SSN-6-9          PIC 9(4).
   395
   396 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   397     12  M                   PIC S9(7)V99           VALUE ZEROS.
   398     12  L                   PIC S9(7)V99           VALUE ZEROS.
   399     12  N                   PIC S9(3)              VALUE ZEROS.
   400     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   401     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   402     12  I                   PIC S99V9(5)           VALUE ZEROS.
   403     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   404     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   405     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   406     12  R                   PIC S9(3)              VALUE ZEROS.
   407     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   408     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   409     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   410     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   411     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   412     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL131.cbl
   413     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   414     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   415     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   416
   417 01  TERM-CALC-WORK-AREA.
   418     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   419     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   420     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   421     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   422     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   423     12  V-EXPONENTS.
   424        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   425     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   426
   427 01  TIME-IN.
   428     12  UN-HOURS                PIC XX.
   429     12  UN-MINUTES              PIC XX.
   430     12  FILLER                  PIC XX.
   431
   432 01  TIME-OUT.
   433     12  FOR-HOURS               PIC XX.
   434     12  FILLER                  PIC X       VALUE '.'.
   435     12  FOR-MINUTES             PIC XX.
   436
   437 01  ERROR-NUMBERS.
   438     12  ER-0000                 PIC X(4)    VALUE '0000'.
   439     12  ER-0004                 PIC X(4)    VALUE '0004'.
   440     12  ER-0008                 PIC X(4)    VALUE '0008'.
   441     12  ER-0023                 PIC X(4)    VALUE '0023'.
   442     12  ER-0029                 PIC X(4)    VALUE '0029'.
   443     12  ER-0068                 PIC X(4)    VALUE '0068'.
   444     12  ER-0070                 PIC X(4)    VALUE '0070'.
   445     12  ER-0149                 PIC X(4)    VALUE '0149'.
   446     12  ER-0154                 PIC X(4)    VALUE '0154'.
   447     12  ER-0169                 PIC X(4)    VALUE '0169'.
   448     12  ER-0192                 PIC X(4)    VALUE '0192'.
   449     12  ER-0199                 PIC X(4)    VALUE '0199'.
   450     12  ER-0203                 PIC X(4)    VALUE '0203'.
   451     12  ER-0204                 PIC X(4)    VALUE '0204'.
   452     12  ER-0205                 PIC X(4)    VALUE '0205'.
   453     12  ER-0206                 PIC X(4)    VALUE '0206'.
   454     12  ER-0208                 PIC X(4)    VALUE '0208'.
   455     12  ER-0210                 PIC X(4)    VALUE '0210'.
   456     12  ER-0215                 PIC X(4)    VALUE '0215'.
   457     12  ER-0219                 PIC X(4)    VALUE '0219'.
   458     12  ER-0220                 PIC X(4)    VALUE '0220'.
   459     12  ER-0222                 PIC X(4)    VALUE '0222'.
   460     12  ER-0223                 PIC X(4)    VALUE '0223'.
   461     12  ER-0224                 PIC X(4)    VALUE '0224'.
   462     12  ER-0227                 PIC X(4)    VALUE '0227'.
   463     12  ER-0230                 PIC X(4)    VALUE '0230'.
   464     12  ER-0232                 PIC X(4)    VALUE '0232'.
   465     12  ER-0233                 PIC X(4)    VALUE '0233'.
   466     12  ER-0236                 PIC X(4)    VALUE '0236'.
   467     12  ER-0237                 PIC X(4)    VALUE '0237'.
   468     12  ER-0238                 PIC X(4)    VALUE '0238'.
   469     12  ER-0240                 PIC X(4)    VALUE '0240'.
   470     12  ER-0241                 PIC X(4)    VALUE '0241'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL131.cbl
   471     12  ER-0243                 PIC X(4)    VALUE '0243'.
   472     12  ER-0244                 PIC X(4)    VALUE '0244'.
   473     12  ER-0246                 PIC X(4)    VALUE '0246'.
   474     12  ER-0247                 PIC X(4)    VALUE '0247'.
   475     12  ER-0248                 PIC X(4)    VALUE '0248'.
   476     12  ER-0250                 PIC X(4)    VALUE '0250'.
   477     12  ER-0251                 PIC X(4)    VALUE '0251'.
   478     12  ER-0253                 PIC X(4)    VALUE '0253'.
   479     12  ER-0256                 PIC X(4)    VALUE '0256'.
   480     12  ER-0257                 PIC X(4)    VALUE '0257'.
   481     12  ER-0258                 PIC X(4)    VALUE '0258'.
   482     12  ER-0259                 PIC X(4)    VALUE '0259'.
   483     12  ER-0260                 PIC X(4)    VALUE '0260'.
   484     12  ER-0261                 PIC X(4)    VALUE '0261'.
   485     12  ER-0262                 PIC X(4)    VALUE '0262'.
   486     12  ER-0263                 PIC X(4)    VALUE '0263'.
   487     12  ER-0273                 PIC X(4)    VALUE '0273'.
   488     12  ER-0274                 PIC X(4)    VALUE '0274'.
   489     12  ER-0276                 PIC X(4)    VALUE '0276'.
   490     12  ER-0282                 PIC X(4)    VALUE '0282'.
   491     12  ER-0283                 PIC X(4)    VALUE '0283'.
   492     12  ER-0309                 PIC X(4)    VALUE '0309'.
   493     12  ER-0310                 PIC X(4)    VALUE '0310'.
   494     12  ER-0311                 PIC X(4)    VALUE '0311'.
   495     12  ER-0333                 PIC X(4)    VALUE '0333'.
   496     12  ER-0360                 PIC X(4)    VALUE '0360'.
   497     12  ER-0377                 PIC X(4)    VALUE '0377'.
   498     12  ER-0402                 PIC X(4)    VALUE '0402'.
   499     12  ER-0416                 PIC X(4)    VALUE '0416'.
   500     12  ER-0426                 PIC X(4)    VALUE '0426'.
   501     12  ER-0427                 PIC X(4)    VALUE '0427'.
   502     12  ER-0428                 PIC X(4)    VALUE '0428'.
   503     12  ER-0429                 PIC X(4)    VALUE '0429'.
   504     12  ER-0430                 PIC X(4)    VALUE '0430'.
   505     12  ER-0475                 PIC X(4)    VALUE '0475'.
   506     12  ER-0491                 PIC X(4)    VALUE '0491'.
   507     12  ER-0509                 PIC X(4)    VALUE '0509'.
   508     12  ER-0510                 PIC X(4)    VALUE '0510'.
   509     12  ER-0519                 PIC X(4)    VALUE '0519'.
   510     12  ER-0520                 PIC X(4)    VALUE '0520'.
   511     12  ER-0521                 PIC X(4)    VALUE '0521'.
   512     12  ER-0547                 PIC X(4)    VALUE '0547'.
   513     12  ER-0548                 PIC X(4)    VALUE '0548'.
   514     12  ER-0549                 PIC X(4)    VALUE '0549'.
   515     12  ER-0565                 PIC X(4)    VALUE '0565'.
   516     12  ER-0598                 PIC X(4)    VALUE '0598'.
   517     12  ER-0639                 PIC X(4)    VALUE '0639'.
   518     12  ER-0797                 PIC X(4)    VALUE '0797'.
   519     12  ER-0802                 PIC X(4)    VALUE '0802'.
   520     12  ER-0803                 PIC X(4)    VALUE '0803'.
   521     12  ER-0849                 PIC X(4)    VALUE '0849'.
   522     12  ER-0885                 PIC X(4)    VALUE '0885'.
   523     12  ER-0887                 PIC X(4)    VALUE '0887'.
   524     12  ER-0919                 PIC X(4)    VALUE '0919'.
   525     12  ER-0921                 PIC X(4)    VALUE '0921'.
   526     12  ER-0938                 PIC X(4)    VALUE '0938'.
   527     12  ER-0946                 PIC X(4)    VALUE '0946'.
   528     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL131.cbl
   529     12  ER-0948                 PIC X(4)    VALUE '0948'.
   530     12  ER-0949                 PIC X(4)    VALUE '0949'.
   531     12  ER-0950                 PIC X(4)    VALUE '0950'.
   532     12  ER-0951                 PIC X(4)    VALUE '0951'.
   533     12  ER-0954                 PIC X(4)    VALUE '0954'.
   534     12  ER-0974                 PIC X(4)    VALUE '0974'.
   535     12  ER-0975                 PIC X(4)    VALUE '0975'.
   536     12  ER-2280                 PIC X(4)    VALUE '2280'.
   537     12  ER-2878                 PIC X(4)    VALUE '2878'.
   538     12  ER-7641                 PIC X(4)    VALUE '7641'.
   539     12  ER-7642                 PIC X(4)    VALUE '7642'.
   540     12  ER-7650                 PIC X(4)    VALUE '7650'.
   541     12  ER-7651                 PIC X(4)    VALUE '7651'.
   542     12  ER-7687                 PIC X(4)    VALUE '7687'.
   543     12  ER-7689                 PIC X(4)    VALUE '7689'.
   544     12  ER-7690                 PIC X(4)    VALUE '7690'.
   545     12  ER-7691                 PIC X(4)    VALUE '7691'.
   546     12  ER-8003                 PIC X(4)    VALUE '8003'.
   547     12  ER-8051                 PIC X(4)    VALUE '8051'.
   548     12  ER-8052                 PIC X(4)    VALUE '8052'.
   549     12  ER-8053                 PIC X(4)    VALUE '8053'.
   550     12  ER-8054                 PIC X(4)    VALUE '8054'.
   551     12  ER-8055                 PIC X(4)    VALUE '8055'.
   552     12  ER-8056                 PIC X(4)    VALUE '8056'.
   553     12  ER-8057                 PIC X(4)    VALUE '8057'.
   554     12  ER-8058                 PIC X(4)    VALUE '8058'.
   555     12  ER-8059                 PIC X(4)    VALUE '8059'.
   556     12  ER-8060                 PIC X(4)    VALUE '8060'.
   557     12  ER-8061                 PIC X(4)    VALUE '8061'.
   558     12  ER-8062                 PIC X(4)    VALUE '8062'.
   559     12  ER-8063                 PIC X(4)    VALUE '8063'.
   560     12  ER-8064                 PIC X(4)    VALUE '8064'.
   561     12  ER-8065                 PIC X(4)    VALUE '8065'.
   562     12  ER-8066                 PIC X(4)    VALUE '8066'.
   563     12  ER-8152                 PIC X(4)    VALUE '8152'.
   564     12  ER-8153                 PIC X(4)    VALUE '8153'.
   565     12  ER-8154                 PIC X(4)    VALUE '8154'.
   566     12  ER-8155                 PIC X(4)    VALUE '8155'.
   567
   568 01  MSTR-KEY.
   569     12  COMPANY-CODE            PIC X.
   570     12  CARRIER-CODE            PIC X.
   571     12  CLAIM-NO                PIC X(7).
   572     12  CERT-NO.
   573         16  CERT-NO-PRIME       PIC X(10).
   574         16  CERT-NO-SUFX        PIC X.
   575
   576 01  WS-SAVE-CLAIM-KEY.
   577     12  WS-SAVE-COMPANY-CD      PIC X.
   578     12  WS-SAVE-CARRIER         PIC X.
   579     12  WS-SAVE-CLAIM-NO        PIC X(7).
   580     12  WS-SAVE-CERT-NO.
   581         16  WS-CERT-NO-PRIME    PIC X(10).
   582         16  WS-CERT-NO-SUFX     PIC X.
   583
   584 01  CERT-KEY.
   585     12  CERT-COMPANY-CODE       PIC X.
   586     12  CERT-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL131.cbl
   587     12  CERT-GROUP              PIC X(6).
   588     12  CERT-STATE              PIC XX.
   589     12  CERT-ACCOUNT            PIC X(10).
   590     12  CERT-DATE               PIC XX.
   591     12  CERT-CERT.
   592         16  CERT-CERT-PRIME     PIC X(10).
   593         16  CERT-CERT-SUFX      PIC X.
   594
   595 01  NOTE-KEY.
   596     12  NOTE-COMP-CD            PIC X.
   597     12  NOTE-CERT-KEY.
   598         16  NOTE-CARRIER        PIC X.
   599         16  NOTE-GROUP          PIC X(6).
   600         16  NOTE-STATE          PIC XX.
   601         16  NOTE-ACCOUNT        PIC X(10).
   602         16  NOTE-DATE           PIC XX.
   603         16  NOTE-CERT-NO        PIC X(11).
   604
   605 01  TRLR-KEY.
   606     12  TRLR-MAIN-KEY.
   607         16  TRLR-COMPANY-CD     PIC X.
   608         16  TRLR-CARRIER        PIC X.
   609         16  TRLR-CLAIM-NO       PIC X(07).
   610         16  TRLR-CERT-NO        PIC X(11).
   611     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   612
   613 01  BENEFIT-KEY.
   614     12  BEN-CO-ID               PIC X(3).
   615     12  BEN-REC-TYPE            PIC X.
   616     12  FILLER                  PIC XX.
   617     12  BEN-ACC-CD              PIC XX.
   618     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   619
   620 01  CNTL-KEY.
   621     12  CNTL-CO-ID              PIC X(3).
   622     12  CNTL-REC-TYPE           PIC X.
   623     12  CNTL-PROC-ID            PIC X(4).
   624     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   625         16  CNTL-STATE-NUMBER   PIC XX.
   626         16  FILLER              PIC XX.
   627     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   628         16  FILLER              PIC X(3).
   629         16  CNTL-CARRIER        PIC X.
   630     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   631
   632 01  ACTQ-KEY                    PIC X(20).
   633
   634 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   635
   636 01  CHKQ-KEY.
   637     12  CHKQ-COMPANY-CODE       PIC X.
   638     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   639     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   640
   641 01  ARCH-KEY.
   642     12  ARCH-COMPANY-CODE       PIC X.
   643     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   644     12  ARCH-RECORD-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL131.cbl
   645     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   646
   647 01  ACCT-KEY.
   648     05  ACCT-PARTIAL-KEY.
   649         12  ACCT-COMPANY-CODE   PIC X.
   650         12  ACCT-CARRIER        PIC X.
   651         12  ACCT-GROUP          PIC X(6).
   652         12  ACCT-STATE          PIC XX.
   653         12  ACCT-ACCOUNT        PIC X(10).
   654     05  ACCT-DATE               PIC XX.
   655
   656 01  WS-ELBENE-KEY.
   657     12  WS-ELBENE-COMPANY-CD    PIC X.
   658     12  WS-ELBENE-RECORD-TYPE   PIC X.
   659     12  WS-ELBENE-ID            PIC X(10).
   660
   661 01  ELALPH-KEY.
   662     12  ELALPH-COMPANY-CD       PIC X.
   663     12  ELALPH-SOURCE           PIC X.
   664     12  ELALPH-NAME.
   665         16  ELALPH-LAST-NAME    PIC X(15).
   666         16  ELALPH-FIRST-NAME.
   667             20  ELALPH-FIRST-INIT   PIC X.
   668             20  FILLER              PIC X(11).
   669         16  ELALPH-MIDDLE-INIT  PIC X.
   670     12  ELALPH-DATE             PIC X(08).
   671     12  ELALPH-TIME             PIC S9(04)    COMP.
   672
   673 01  COMP-LENGTHS.
   674     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   675     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   676     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   677     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   678     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   679     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   680     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   681     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   682     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   683     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   684     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   685     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   686     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   687     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL131.cbl
   689*                                COPY ELCLNKLT.
   690******************************************************************
   691*                                                                *
   692*                                                                *
   693*                           ELCLNKLT                             *
   694*                            VMOD=2.003                          *
   695*                                                                *
   696*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   697*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   698*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   699*                                                                *
   700*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   701*   COMPLETING THE REQUIRED FIELDS.                              *
   702*                                                                *
   703*   THE CALLING PROGRAM SHOULD CHECK:                            *
   704*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   705*                              9999 INDICATES AN UNKNOWN ABEND   *
   706*                                   WAS DETECTED.                *
   707*                              ALL OTHER VALUES ARE NORMAL ERROR *
   708*                              CODES FOUND IN THE ERROR FILE.    *
   709******************************************************************
   710 01  W-1523-LINKDATA.
   711     12  W-1523-COMMON-PI-DATA.
   712         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   713         16  FILLER              PIC  X(67).
   714         16  W-1523-COMPANY-CD   PIC  X(01).
   715         16  FILLER              PIC  X(10).
   716         16  W-1523-CONTROL-IN-PROGRESS.
   717             20  W-1523-CARRIER  PIC  X(01).
   718             20  W-1523-GROUPING PIC  X(06).
   719             20  W-1523-STATE    PIC  X(02).
   720             20  W-1523-ACCOUNT  PIC  X(10).
   721             20  W-1523-CLAIM-CERT-GRP.
   722                 24  W-1523-CLAIM-NO
   723                                 PIC  X(07).
   724                 24  W-1523-CERT-NO.
   725                     28  W-1523-CERT-PRIME
   726                                 PIC  X(10).
   727                     28  W-1523-CERT-SFX
   728                                 PIC  X(01).
   729                 24  W-1523-CERT-EFF-DT
   730                                 PIC  X(02).
   731         16  FILLER              PIC X(265).
   732
   733     12  W-1523-WORK-AREA.
   734         16  W-1523-FORM-NUMBER  PIC  X(04).
   735         16  W-1523-NUMBER-COPIES
   736                                 PIC  9(01).
   737         16  W-1523-ADDR-TYPE    PIC  X(02).
   738         16  W-1523-FOLLOW-UP-DATE
   739                                 PIC  X(02).
   740         16  W-1523-RESEND-DATE  PIC  X(02).
   741         16  W-1523-ERROR-CODE   PIC  9(04).
   742             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   743             88  W-1523-FATAL-ERROR
   744                                    VALUES  0006 0013 0042
   745                                            0154 0168 0169
   746                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL131.cbl
   747                                            0179 0186 0281
   748                                            0332 2055 3697
   749                                            3698 3699 3770
   750                                            3771 3772 7675
   751                                            9106 9808 9883
   752                                            9887.
   753             88  W-1523-STOP-ERRORS
   754                                    VALUES  0013 0042 0154
   755                                            0168 0169 0172
   756                                            0281 0332 2055
   757                                            3698 3699 7675
   758                                            9106 9808 9883
   759                                            9999.
   760         16  W-1523-REASON       PIC  X(70).
   761         16  W-1523-ARCHIVE-NUMBER
   762                                 PIC  9(08).
   763     12  W-1523-POINTER-AREA.
   764         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   765         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   766         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   767         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   768         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL131.cbl
   770*                                COPY ELCINTF.
   771******************************************************************
   772*                                                                *
   773*                                                                *
   774*                            ELCINTF.                            *
   775*                            VMOD=2.017                          *
   776*                                                                *
   777*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   778*                                                                *
   779*       LENGTH = 1024                                            *
   780*                                                                *
   781******************************************************************
   782 01  PROGRAM-INTERFACE-BLOCK.
   783     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   784     12  PI-CALLING-PROGRAM              PIC X(8).
   785     12  PI-SAVED-PROGRAM-1              PIC X(8).
   786     12  PI-SAVED-PROGRAM-2              PIC X(8).
   787     12  PI-SAVED-PROGRAM-3              PIC X(8).
   788     12  PI-SAVED-PROGRAM-4              PIC X(8).
   789     12  PI-SAVED-PROGRAM-5              PIC X(8).
   790     12  PI-SAVED-PROGRAM-6              PIC X(8).
   791     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   792     12  PI-COMPANY-ID                   PIC XXX.
   793     12  PI-COMPANY-CD                   PIC X.
   794
   795     12  PI-COMPANY-PASSWORD             PIC X(8).
   796
   797     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   798
   799     12  PI-CONTROL-IN-PROGRESS.
   800         16  PI-CARRIER                  PIC X.
   801         16  PI-GROUPING                 PIC X(6).
   802         16  PI-STATE                    PIC XX.
   803         16  PI-ACCOUNT                  PIC X(10).
   804         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   805                                         PIC X(10).
   806         16  PI-CLAIM-CERT-GRP.
   807             20  PI-CLAIM-NO             PIC X(7).
   808             20  PI-CERT-NO.
   809                 25  PI-CERT-PRIME       PIC X(10).
   810                 25  PI-CERT-SFX         PIC X.
   811             20  PI-CERT-EFF-DT          PIC XX.
   812         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   813             20  PI-PLAN-CODE            PIC X(2).
   814             20  PI-REVISION-NUMBER      PIC X(3).
   815             20  PI-PLAN-EFF-DT          PIC X(2).
   816             20  PI-PLAN-EXP-DT          PIC X(2).
   817             20  FILLER                  PIC X(11).
   818         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   819             20  PI-OE-REFERENCE-1.
   820                 25  PI-OE-REF-1-PRIME   PIC X(18).
   821                 25  PI-OE-REF-1-SUFF    PIC XX.
   822
   823     12  PI-SESSION-IN-PROGRESS          PIC X.
   824         88  CLAIM-SESSION                   VALUE '1'.
   825         88  CREDIT-SESSION                  VALUE '2'.
   826         88  WARRANTY-SESSION                VALUE '3'.
   827         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL131.cbl
   828         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   829
   830
   831*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   832
   833     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   834     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   835
   836     12  PI-CREDIT-USER                  PIC X.
   837         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   838         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   839
   840     12  PI-CLAIM-USER                   PIC X.
   841         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   842         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   843
   844     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   845         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   846         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   847         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   848         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   849         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   850
   851     12  PI-PROCESSOR-ID                 PIC X(4).
   852
   853     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   854
   855     12  PI-MEMBER-CAPTION               PIC X(10).
   856
   857     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   858         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   859
   860     12  PI-LIFE-OVERRIDE-L1             PIC X.
   861     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   862     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   863     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   864
   865     12  PI-AH-OVERRIDE-L1               PIC X.
   866     12  PI-AH-OVERRIDE-L2               PIC XX.
   867     12  PI-AH-OVERRIDE-L6               PIC X(6).
   868     12  PI-AH-OVERRIDE-L12              PIC X(12).
   869
   870     12  PI-NEW-SYSTEM                   PIC X(2).
   871
   872     12  PI-PRIMARY-CERT-NO              PIC X(11).
   873     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   874         88  PI-USES-PAID-TO                 VALUE '1'.
   875     12  PI-CRDTCRD-SYSTEM.
   876         16  PI-CRDTCRD-USER             PIC X.
   877             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   878             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   879         16  PI-CC-MONTH-END-DT          PIC XX.
   880     12  PI-PROCESSOR-PRINTER            PIC X(4).
   881
   882     12  PI-OE-REFERENCE-2.
   883         16  PI-OE-REF-2-PRIME           PIC X(10).
   884         16  PI-OE-REF-2-SUFF            PIC X.
   885
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL131.cbl
   886     12  PI-REM-TRM-CALC-OPTION          PIC X.
   887
   888     12  PI-LANGUAGE-TYPE                PIC X.
   889             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   890             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   891             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   892
   893     12  PI-POLICY-LINKAGE-IND           PIC X.
   894         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   895         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   896                                                   LOW-VALUES.
   897
   898     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   899     12  PI-CLAIM-PW-SESSION             PIC X(1).
   900         88  PI-CLAIM-CREDIT                 VALUE '1'.
   901         88  PI-CLAIM-CONVEN                 VALUE '2'.
   902     12  FILLER                          PIC X(4).
   903
   904     12  PI-SYSTEM-LEVEL                 PIC X(145).
   905
   906     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   907         PI-SYSTEM-LEVEL.
   908
   909         16  PI-ENTRY-CODES.
   910             20  PI-ENTRY-CD-1           PIC X.
   911             20  PI-ENTRY-CD-2           PIC X.
   912
   913         16  PI-RETURN-CODES.
   914             20  PI-RETURN-CD-1          PIC X.
   915             20  PI-RETURN-CD-2          PIC X.
   916
   917         16  PI-UPDATE-STATUS-SAVE.
   918             20  PI-UPDATE-BY            PIC X(4).
   919             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   920
   921         16  PI-LOWER-CASE-LETTERS       PIC X.
   922             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   923
   924*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   925*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   926*            88  CARRIER-CLM-CNTL            VALUE '2'.
   927
   928         16  PI-CERT-ACCESS-CONTROL      PIC X.
   929             88  ST-ACCNT-CNTL               VALUE ' '.
   930             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   931             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   932             88  ACCNT-CNTL                  VALUE '3'.
   933             88  CARR-ACCNT-CNTL             VALUE '4'.
   934
   935         16  PI-PROCESSOR-CAP-LIST.
   936             20  PI-SYSTEM-CONTROLS.
   937                24 PI-SYSTEM-DISPLAY     PIC X.
   938                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   939                24 PI-SYSTEM-MODIFY      PIC X.
   940                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   941             20  FILLER                  PIC XX.
   942             20  PI-DISPLAY-CAP          PIC X.
   943                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL131.cbl
   944             20  PI-MODIFY-CAP           PIC X.
   945                 88  MODIFY-CAP              VALUE 'Y'.
   946             20  PI-MSG-AT-LOGON-CAP     PIC X.
   947                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   948             20  PI-FORCE-CAP            PIC X.
   949                 88  FORCE-CAP               VALUE 'Y'.
   950
   951         16  PI-PROGRAM-CONTROLS.
   952             20  PI-PGM-PRINT-OPT        PIC X.
   953             20  PI-PGM-FORMAT-OPT       PIC X.
   954             20  PI-PGM-PROCESS-OPT      PIC X.
   955             20  PI-PGM-TOTALS-OPT       PIC X.
   956
   957         16  PI-HELP-INTERFACE.
   958             20  PI-LAST-ERROR-NO        PIC X(4).
   959             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   960
   961         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   962             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   963
   964         16  PI-CR-CONTROL-IN-PROGRESS.
   965             20  PI-CR-CARRIER           PIC X.
   966             20  PI-CR-GROUPING          PIC X(6).
   967             20  PI-CR-STATE             PIC XX.
   968             20  PI-CR-ACCOUNT           PIC X(10).
   969             20  PI-CR-FIN-RESP          PIC X(10).
   970             20  PI-CR-TYPE              PIC X.
   971
   972         16  PI-CR-BATCH-NUMBER          PIC X(6).
   973
   974         16  PI-CR-MONTH-END-DT          PIC XX.
   975
   976         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   977             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   978             88  PI-ZERO-CARRIER             VALUE '1'.
   979             88  PI-ZERO-GROUPING            VALUE '2'.
   980             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   981
   982         16  PI-CARRIER-SECURITY         PIC X.
   983             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   984
   985         16  PI-ACCOUNT-SECURITY         PIC X(10).
   986             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   987             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   988
   989         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   990             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   991                                         INDEXED BY PI-ACCESS-NDX
   992                                         PIC X.
   993
   994         16  PI-GA-BILLING-CONTROL       PIC X.
   995             88  PI-GA-BILLING               VALUE '1'.
   996
   997         16  PI-MAIL-PROCESSING          PIC X.
   998             88  PI-MAIL-YES                 VALUE 'Y'.
   999
  1000         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1001
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL131.cbl
  1002         16  PI-AR-SYSTEM.
  1003             20  PI-AR-PROCESSING-CNTL   PIC X.
  1004                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1005             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1006             20  PI-AR-MONTH-END-DT      PIC XX.
  1007
  1008         16  PI-MP-SYSTEM.
  1009             20  PI-MORTGAGE-USER            PIC X.
  1010                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1011                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1012             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1013                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1014                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1015                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1016                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1017                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1018             20  PI-MP-MONTH-END-DT          PIC XX.
  1019             20  PI-MP-REFERENCE-NO.
  1020                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1021                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1022
  1023         16  PI-LABEL-CONTROL            PIC X(01).
  1024             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1025             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1026
  1027         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1028             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1029
  1030         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1031             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1032             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1033
  1034         16  FILLER                      PIC X(14).
  1035
  1036     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1037******************************************************************
  1038     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1039         16  PI-NO-PMTS                    PIC 9(4).
  1040         16  PI-CERT-SWITCH                PIC X.
  1041             88  CREATED-CERT              VALUE '2'.
  1042         16  PI-PREM-TYPE                  PIC X.
  1043         16  PI-SAVE-CERT-NO.
  1044             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1045             20  PI-SAVE-CERT-NO-SUFX      PIC X.
  1046         16  FILLER                        PIC X(46).
  1047         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1048         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1049         16  PI-REC-FOUND-SW               PIC X.
  1050         16  PI-LETTER-SW                  PIC X.
  1051         16  PI-PREV-TRLR-KEY              PIC X(22).
  1052         16  FILLER                        PIC X(547).
  1053
  1054 01  SAVE-RECORD                 PIC X(450).
  1055
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL131.cbl
  1057*                                COPY ELCLOGOF SUPPRESS.
  1058******************************************************************
  1059*                                                                *
  1060*                                                                *
  1061*                            ELCLOGOF.                           *
  1062*                            VMOD=2.001                          *
  1063*                                                                *
  1064*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1065*                                                                *
  1066******************************************************************
  1067 01  CLASIC-LOGOFF.
  1068     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1069     12  LOGOFF-TEXT.
  1070         16  FILLER          PIC X(5)    VALUE SPACES.
  1071         16  LOGOFF-MSG.
  1072             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1073             20  FILLER      PIC X       VALUE SPACES.
  1074             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1075         16  FILLER          PIC X(80)
  1076           VALUE '* YOU ARE NOW LOGGED OFF'.
  1077         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1078         16  FILLER          PIC X       VALUE QUOTE.
  1079         16  LOGOFF-SYS-MSG  PIC X(17)
  1080           VALUE 'S CLAS-IC SYSTEM '.
  1081     12  TEXT-MESSAGES.
  1082         16  UNACCESS-MSG    PIC X(29)
  1083             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1084         16  PGMIDERR-MSG    PIC X(17)
  1085             VALUE 'PROGRAM NOT FOUND'.
  1086
  1087*                                COPY ELCATTR SUPPRESS.
  1088******************************************************************
  1089*                                                                *
  1090*                            ELCATTR.                            *
  1091*                            VMOD=2.001                          *
  1092*                                                                *
  1093*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1094*                                                                *
  1095*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1096*                                                                *
  1097*                   POS 1   P=PROTECTED                          *
  1098*                           U=UNPROTECTED                        *
  1099*                           S=ASKIP                              *
  1100*                   POS 2   A=ALPHA/NUMERIC                      *
  1101*                           N=NUMERIC                            *
  1102*                   POS 3   N=NORMAL                             *
  1103*                           B=BRIGHT                             *
  1104*                           D=DARK                               *
  1105*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1106*                           OF=MODIFIED DATA TAG OFF             *
  1107*                                                                *
  1108*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1109******************************************************************
  1110 01  ATTRIBUTE-LIST.
  1111     12  AL-PABOF            PIC X       VALUE 'Y'.
  1112     12  AL-PABON            PIC X       VALUE 'Z'.
  1113     12  AL-PADOF            PIC X       VALUE '%'.
  1114     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL131.cbl
  1115     12  AL-PANOF            PIC X       VALUE '-'.
  1116     12  AL-PANON            PIC X       VALUE '/'.
  1117     12  AL-SABOF            PIC X       VALUE '8'.
  1118     12  AL-SABON            PIC X       VALUE '9'.
  1119     12  AL-SADOF            PIC X       VALUE '@'.
  1120     12  AL-SADON            PIC X       VALUE QUOTE.
  1121     12  AL-SANOF            PIC X       VALUE '0'.
  1122     12  AL-SANON            PIC X       VALUE '1'.
  1123     12  AL-UABOF            PIC X       VALUE 'H'.
  1124     12  AL-UABON            PIC X       VALUE 'I'.
  1125     12  AL-UADOF            PIC X       VALUE '<'.
  1126     12  AL-UADON            PIC X       VALUE '('.
  1127     12  AL-UANOF            PIC X       VALUE ' '.
  1128     12  AL-UANON            PIC X       VALUE 'A'.
  1129     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1130     12  AL-UNBON            PIC X       VALUE 'R'.
  1131     12  AL-UNDOF            PIC X       VALUE '*'.
  1132     12  AL-UNDON            PIC X       VALUE ')'.
  1133     12  AL-UNNOF            PIC X       VALUE '&'.
  1134     12  AL-UNNON            PIC X       VALUE 'J'.
  1135
  1136*                                COPY ELCAID SUPPRESS.
  1137******************************************************************
  1138*                                                                *
  1139*                            ELCAID.                             *
  1140*                            VMOD=2.001                          *
  1141*                                                                *
  1142*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1143*                                                                *
  1144*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1145*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1146******************************************************************
  1147
  1148 01  DFHAID.
  1149   02  DFHNULL   PIC  X  VALUE  ' '.
  1150   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1151   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1152   02  DFHPEN    PIC  X  VALUE  '='.
  1153   02  DFHOPID   PIC  X  VALUE  'W'.
  1154   02  DFHPA1    PIC  X  VALUE  '%'.
  1155   02  DFHPA2    PIC  X  VALUE  '>'.
  1156   02  DFHPA3    PIC  X  VALUE  ','.
  1157   02  DFHPF1    PIC  X  VALUE  '1'.
  1158   02  DFHPF2    PIC  X  VALUE  '2'.
  1159   02  DFHPF3    PIC  X  VALUE  '3'.
  1160   02  DFHPF4    PIC  X  VALUE  '4'.
  1161   02  DFHPF5    PIC  X  VALUE  '5'.
  1162   02  DFHPF6    PIC  X  VALUE  '6'.
  1163   02  DFHPF7    PIC  X  VALUE  '7'.
  1164   02  DFHPF8    PIC  X  VALUE  '8'.
  1165   02  DFHPF9    PIC  X  VALUE  '9'.
  1166   02  DFHPF10   PIC  X  VALUE  ':'.
  1167   02  DFHPF11   PIC  X  VALUE  '#'.
  1168   02  DFHPF12   PIC  X  VALUE  '@'.
  1169   02  DFHPF13   PIC  X  VALUE  'A'.
  1170   02  DFHPF14   PIC  X  VALUE  'B'.
  1171   02  DFHPF15   PIC  X  VALUE  'C'.
  1172   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL131.cbl
  1173   02  DFHPF17   PIC  X  VALUE  'E'.
  1174   02  DFHPF18   PIC  X  VALUE  'F'.
  1175   02  DFHPF19   PIC  X  VALUE  'G'.
  1176   02  DFHPF20   PIC  X  VALUE  'H'.
  1177   02  DFHPF21   PIC  X  VALUE  'I'.
  1178*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1179   02  DFHPF22   PIC  X  VALUE  '['.
  1180   02  DFHPF23   PIC  X  VALUE  '.'.
  1181   02  DFHPF24   PIC  X  VALUE  '<'.
  1182   02  DFHMSRE   PIC  X  VALUE  'X'.
  1183   02  DFHSTRF   PIC  X  VALUE  'h'.
  1184   02  DFHTRIG   PIC  X  VALUE  '"'.
  1185 01  FILLER REDEFINES DFHAID.
  1186     12  FILLER                  PIC X(8).
  1187     12  AID-KEYS OCCURS 24 TIMES.
  1188         16  FILLER              PIC X.
  1189
  1190*                                COPY EL131S.
  1191 01  EL131AI.
  1192     05  FILLER            PIC  X(0012).
  1193*    -------------------------------
  1194     05  DATEL PIC S9(0004) COMP.
  1195     05  DATEF PIC  X(0001).
  1196     05  FILLER REDEFINES DATEF.
  1197         10  DATEA PIC  X(0001).
  1198     05  DATEI PIC  X(0008).
  1199*    -------------------------------
  1200     05  TIMEL PIC S9(0004) COMP.
  1201     05  TIMEF PIC  X(0001).
  1202     05  FILLER REDEFINES TIMEF.
  1203         10  TIMEA PIC  X(0001).
  1204     05  TIMEI PIC  X(0005).
  1205*    -------------------------------
  1206     05  SEQUL PIC S9(0004) COMP.
  1207     05  SEQUF PIC  X(0001).
  1208     05  FILLER REDEFINES SEQUF.
  1209         10  SEQUA PIC  X(0001).
  1210     05  SEQUI PIC  X(0010).
  1211*    -------------------------------
  1212     05  COMPL PIC S9(0004) COMP.
  1213     05  COMPF PIC  X(0001).
  1214     05  FILLER REDEFINES COMPF.
  1215         10  COMPA PIC  X(0001).
  1216     05  COMPI PIC  X(0003).
  1217*    -------------------------------
  1218     05  USERIDL PIC S9(0004) COMP.
  1219     05  USERIDF PIC  X(0001).
  1220     05  FILLER REDEFINES USERIDF.
  1221         10  USERIDA PIC  X(0001).
  1222     05  USERIDI PIC  X(0004).
  1223*    -------------------------------
  1224     05  CCNOL PIC S9(0004) COMP.
  1225     05  CCNOF PIC  X(0001).
  1226     05  FILLER REDEFINES CCNOF.
  1227         10  CCNOA PIC  X(0001).
  1228     05  CCNOI PIC  X(0016).
  1229*    -------------------------------
  1230     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL131.cbl
  1231     05  MAINTF PIC  X(0001).
  1232     05  FILLER REDEFINES MAINTF.
  1233         10  MAINTA PIC  X(0001).
  1234     05  MAINTI PIC  X(0001).
  1235*    -------------------------------
  1236     05  CLAIML PIC S9(0004) COMP.
  1237     05  CLAIMF PIC  X(0001).
  1238     05  FILLER REDEFINES CLAIMF.
  1239         10  CLAIMA PIC  X(0001).
  1240     05  CLAIMI PIC  X(0007).
  1241*    -------------------------------
  1242     05  CARRL PIC S9(0004) COMP.
  1243     05  CARRF PIC  X(0001).
  1244     05  FILLER REDEFINES CARRF.
  1245         10  CARRA PIC  X(0001).
  1246     05  CARRI PIC  X(0001).
  1247*    -------------------------------
  1248     05  CERTL PIC S9(0004) COMP.
  1249     05  CERTF PIC  X(0001).
  1250     05  FILLER REDEFINES CERTF.
  1251         10  CERTA PIC  X(0001).
  1252     05  CERTI PIC  X(0010).
  1253*    -------------------------------
  1254     05  SUFXL PIC S9(0004) COMP.
  1255     05  SUFXF PIC  X(0001).
  1256     05  FILLER REDEFINES SUFXF.
  1257         10  SUFXA PIC  X(0001).
  1258     05  SUFXI PIC  X(0001).
  1259*    -------------------------------
  1260     05  TYPEL PIC S9(0004) COMP.
  1261     05  TYPEF PIC  X(0001).
  1262     05  FILLER REDEFINES TYPEF.
  1263         10  TYPEA PIC  X(0001).
  1264     05  TYPEI PIC  X(0001).
  1265*    -------------------------------
  1266     05  LABEL1L PIC S9(0004) COMP.
  1267     05  LABEL1F PIC  X(0001).
  1268     05  FILLER REDEFINES LABEL1F.
  1269         10  LABEL1A PIC  X(0001).
  1270     05  LABEL1I PIC  X(0011).
  1271*    -------------------------------
  1272     05  PCERTNOL PIC S9(0004) COMP.
  1273     05  PCERTNOF PIC  X(0001).
  1274     05  FILLER REDEFINES PCERTNOF.
  1275         10  PCERTNOA PIC  X(0001).
  1276     05  PCERTNOI PIC  X(0010).
  1277*    -------------------------------
  1278     05  PSUFXL PIC S9(0004) COMP.
  1279     05  PSUFXF PIC  X(0001).
  1280     05  FILLER REDEFINES PSUFXF.
  1281         10  PSUFXA PIC  X(0001).
  1282     05  PSUFXI PIC  X(0001).
  1283*    -------------------------------
  1284     05  STATUSL PIC S9(0004) COMP.
  1285     05  STATUSF PIC  X(0001).
  1286     05  FILLER REDEFINES STATUSF.
  1287         10  STATUSA PIC  X(0001).
  1288     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL131.cbl
  1289*    -------------------------------
  1290     05  INCL PIC S9(0004) COMP.
  1291     05  INCF PIC  X(0001).
  1292     05  FILLER REDEFINES INCF.
  1293         10  INCA PIC  X(0001).
  1294     05  INCI PIC  X(0008).
  1295*    -------------------------------
  1296     05  REPL PIC S9(0004) COMP.
  1297     05  REPF PIC  X(0001).
  1298     05  FILLER REDEFINES REPF.
  1299         10  REPA PIC  X(0001).
  1300     05  REPI PIC  X(0008).
  1301*    -------------------------------
  1302     05  CAUSEL PIC S9(0004) COMP.
  1303     05  CAUSEF PIC  X(0001).
  1304     05  FILLER REDEFINES CAUSEF.
  1305         10  CAUSEA PIC  X(0001).
  1306     05  CAUSEI PIC  X(0006).
  1307*    -------------------------------
  1308     05  ENDL PIC S9(0004) COMP.
  1309     05  ENDF PIC  X(0001).
  1310     05  FILLER REDEFINES ENDF.
  1311         10  ENDA PIC  X(0001).
  1312     05  ENDI PIC  X(0008).
  1313*    -------------------------------
  1314     05  DIAGL PIC S9(0004) COMP.
  1315     05  DIAGF PIC  X(0001).
  1316     05  FILLER REDEFINES DIAGF.
  1317         10  DIAGA PIC  X(0001).
  1318     05  DIAGI PIC  X(0060).
  1319*    -------------------------------
  1320     05  BENEL PIC S9(0004) COMP.
  1321     05  BENEF PIC  X(0001).
  1322     05  FILLER REDEFINES BENEF.
  1323         10  BENEA PIC  X(0001).
  1324     05  BENEI PIC  X(0010).
  1325*    -------------------------------
  1326     05  BIRTHL PIC S9(0004) COMP.
  1327     05  BIRTHF PIC  X(0001).
  1328     05  FILLER REDEFINES BIRTHF.
  1329         10  BIRTHA PIC  X(0001).
  1330     05  BIRTHI PIC  X(0008).
  1331*    -------------------------------
  1332     05  SOCIALL PIC S9(0004) COMP.
  1333     05  SOCIALF PIC  X(0001).
  1334     05  FILLER REDEFINES SOCIALF.
  1335         10  SOCIALA PIC  X(0001).
  1336     05  SOCIALI PIC  X(0011).
  1337*    -------------------------------
  1338     05  SEXL PIC S9(0004) COMP.
  1339     05  SEXF PIC  X(0001).
  1340     05  FILLER REDEFINES SEXF.
  1341         10  SEXA PIC  X(0001).
  1342     05  SEXI PIC  X(0001).
  1343*    -------------------------------
  1344     05  MLNAMEL PIC S9(0004) COMP.
  1345     05  MLNAMEF PIC  X(0001).
  1346     05  FILLER REDEFINES MLNAMEF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL131.cbl
  1347         10  MLNAMEA PIC  X(0001).
  1348     05  MLNAMEI PIC  X(0015).
  1349*    -------------------------------
  1350     05  MFNAMEL PIC S9(0004) COMP.
  1351     05  MFNAMEF PIC  X(0001).
  1352     05  FILLER REDEFINES MFNAMEF.
  1353         10  MFNAMEA PIC  X(0001).
  1354     05  MFNAMEI PIC  X(0012).
  1355*    -------------------------------
  1356     05  MMINITL PIC S9(0004) COMP.
  1357     05  MMINITF PIC  X(0001).
  1358     05  FILLER REDEFINES MMINITF.
  1359         10  MMINITA PIC  X(0001).
  1360     05  MMINITI PIC  X(0001).
  1361*    -------------------------------
  1362     05  LOANNOL PIC S9(0004) COMP.
  1363     05  LOANNOF PIC  X(0001).
  1364     05  FILLER REDEFINES LOANNOF.
  1365         10  LOANNOA PIC  X(0001).
  1366     05  LOANNOI PIC  X(0008).
  1367*    -------------------------------
  1368     05  CRTLNMEL PIC S9(0004) COMP.
  1369     05  CRTLNMEF PIC  X(0001).
  1370     05  FILLER REDEFINES CRTLNMEF.
  1371         10  CRTLNMEA PIC  X(0001).
  1372     05  CRTLNMEI PIC  X(0015).
  1373*    -------------------------------
  1374     05  CRTFNMEL PIC S9(0004) COMP.
  1375     05  CRTFNMEF PIC  X(0001).
  1376     05  FILLER REDEFINES CRTFNMEF.
  1377         10  CRTFNMEA PIC  X(0001).
  1378     05  CRTFNMEI PIC  X(0012).
  1379*    -------------------------------
  1380     05  CRTINITL PIC S9(0004) COMP.
  1381     05  CRTINITF PIC  X(0001).
  1382     05  FILLER REDEFINES CRTINITF.
  1383         10  CRTINITA PIC  X(0001).
  1384     05  CRTINITI PIC  X(0001).
  1385*    -------------------------------
  1386     05  LOANBALL PIC S9(0004) COMP.
  1387     05  LOANBALF PIC  X(0001).
  1388     05  FILLER REDEFINES LOANBALF.
  1389         10  LOANBALA PIC  X(0001).
  1390     05  LOANBALI PIC  9(7)V99.
  1391*    -------------------------------
  1392     05  PROCL PIC S9(0004) COMP.
  1393     05  PROCF PIC  X(0001).
  1394     05  FILLER REDEFINES PROCF.
  1395         10  PROCA PIC  X(0001).
  1396     05  PROCI PIC  X(0004).
  1397*    -------------------------------
  1398     05  SUPVL PIC S9(0004) COMP.
  1399     05  SUPVF PIC  X(0001).
  1400     05  FILLER REDEFINES SUPVF.
  1401         10  SUPVA PIC  X(0001).
  1402     05  SUPVI PIC  X(0001).
  1403*    -------------------------------
  1404     05  PRICDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL131.cbl
  1405     05  PRICDF PIC  X(0001).
  1406     05  FILLER REDEFINES PRICDF.
  1407         10  PRICDA PIC  X(0001).
  1408     05  PRICDI PIC  X(0001).
  1409*    -------------------------------
  1410     05  FILETOL PIC S9(0004) COMP.
  1411     05  FILETOF PIC  X(0001).
  1412     05  FILLER REDEFINES FILETOF.
  1413         10  FILETOA PIC  X(0001).
  1414     05  FILETOI PIC  X(0004).
  1415*    -------------------------------
  1416     05  PTHRHDGL PIC S9(0004) COMP.
  1417     05  PTHRHDGF PIC  X(0001).
  1418     05  FILLER REDEFINES PTHRHDGF.
  1419         10  PTHRHDGA PIC  X(0001).
  1420     05  PTHRHDGI PIC  X(0010).
  1421*    -------------------------------
  1422     05  PDTHRUL PIC S9(0004) COMP.
  1423     05  PDTHRUF PIC  X(0001).
  1424     05  FILLER REDEFINES PDTHRUF.
  1425         10  PDTHRUA PIC  X(0001).
  1426     05  PDTHRUI PIC  X(0008).
  1427*    -------------------------------
  1428     05  PDAMTL PIC S9(0004) COMP.
  1429     05  PDAMTF PIC  X(0001).
  1430     05  FILLER REDEFINES PDAMTF.
  1431         10  PDAMTA PIC  X(0001).
  1432     05  PDAMTI PIC  9(7)V99.
  1433*    -------------------------------
  1434     05  NODAYSL PIC S9(0004) COMP.
  1435     05  NODAYSF PIC  X(0001).
  1436     05  FILLER REDEFINES NODAYSF.
  1437         10  NODAYSA PIC  X(0001).
  1438     05  NODAYSI PIC  9(5).
  1439*    -------------------------------
  1440     05  NOPMTSL PIC S9(0004) COMP.
  1441     05  NOPMTSF PIC  X(0001).
  1442     05  FILLER REDEFINES NOPMTSF.
  1443         10  NOPMTSA PIC  X(0001).
  1444     05  NOPMTSI PIC  9(4).
  1445*    -------------------------------
  1446     05  FORMTYPL PIC S9(0004) COMP.
  1447     05  FORMTYPF PIC  X(0001).
  1448     05  FILLER REDEFINES FORMTYPF.
  1449         10  FORMTYPA PIC  X(0001).
  1450     05  FORMTYPI PIC  X(0001).
  1451*    -------------------------------
  1452     05  ESTL PIC S9(0004) COMP.
  1453     05  ESTF PIC  X(0001).
  1454     05  FILLER REDEFINES ESTF.
  1455         10  ESTA PIC  X(0001).
  1456     05  ESTI PIC  X(0008).
  1457*    -------------------------------
  1458     05  AUIDL PIC S9(0004) COMP.
  1459     05  AUIDF PIC  X(0001).
  1460     05  FILLER REDEFINES AUIDF.
  1461         10  AUIDA PIC  X(0001).
  1462     05  AUIDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL131.cbl
  1463*    -------------------------------
  1464     05  OCCL PIC S9(0004) COMP.
  1465     05  OCCF PIC  X(0001).
  1466     05  FILLER REDEFINES OCCF.
  1467         10  OCCA PIC  X(0001).
  1468     05  OCCI PIC  X(0006).
  1469*    -------------------------------
  1470     05  MNTDTL PIC S9(0004) COMP.
  1471     05  MNTDTF PIC  X(0001).
  1472     05  FILLER REDEFINES MNTDTF.
  1473         10  MNTDTA PIC  X(0001).
  1474     05  MNTDTI PIC  X(0008).
  1475*    -------------------------------
  1476     05  MNTTYPEL PIC S9(0004) COMP.
  1477     05  MNTTYPEF PIC  X(0001).
  1478     05  FILLER REDEFINES MNTTYPEF.
  1479         10  MNTTYPEA PIC  X(0001).
  1480     05  MNTTYPEI PIC  X(0006).
  1481*    -------------------------------
  1482     05  CERTCARL PIC S9(0004) COMP.
  1483     05  CERTCARF PIC  X(0001).
  1484     05  FILLER REDEFINES CERTCARF.
  1485         10  CERTCARA PIC  X(0001).
  1486     05  CERTCARI PIC  X(0001).
  1487*    -------------------------------
  1488     05  CERTGRPL PIC S9(0004) COMP.
  1489     05  CERTGRPF PIC  X(0001).
  1490     05  FILLER REDEFINES CERTGRPF.
  1491         10  CERTGRPA PIC  X(0001).
  1492     05  CERTGRPI PIC  X(0006).
  1493*    -------------------------------
  1494     05  CERTSTL PIC S9(0004) COMP.
  1495     05  CERTSTF PIC  X(0001).
  1496     05  FILLER REDEFINES CERTSTF.
  1497         10  CERTSTA PIC  X(0001).
  1498     05  CERTSTI PIC  X(0002).
  1499*    -------------------------------
  1500     05  CERTACTL PIC S9(0004) COMP.
  1501     05  CERTACTF PIC  X(0001).
  1502     05  FILLER REDEFINES CERTACTF.
  1503         10  CERTACTA PIC  X(0001).
  1504     05  CERTACTI PIC  X(0010).
  1505*    -------------------------------
  1506     05  CERTEFFL PIC S9(0004) COMP.
  1507     05  CERTEFFF PIC  X(0001).
  1508     05  FILLER REDEFINES CERTEFFF.
  1509         10  CERTEFFA PIC  X(0001).
  1510     05  CERTEFFI PIC  X(0008).
  1511*    -------------------------------
  1512     05  ISSAGEL PIC S9(0004) COMP.
  1513     05  ISSAGEF PIC  X(0001).
  1514     05  FILLER REDEFINES ISSAGEF.
  1515         10  ISSAGEA PIC  X(0001).
  1516     05  ISSAGEI PIC  X(0002).
  1517*    -------------------------------
  1518     05  APRL PIC S9(0004) COMP.
  1519     05  APRF PIC  X(0001).
  1520     05  FILLER REDEFINES APRF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL131.cbl
  1521         10  APRA PIC  X(0001).
  1522     05  APRI PIC  9(4)V9(4).
  1523*    -------------------------------
  1524     05  PMTFREQL PIC S9(0004) COMP.
  1525     05  PMTFREQF PIC  X(0001).
  1526     05  FILLER REDEFINES PMTFREQF.
  1527         10  PMTFREQA PIC  X(0001).
  1528     05  PMTFREQI PIC  99.
  1529*    -------------------------------
  1530     05  INDGRPL PIC S9(0004) COMP.
  1531     05  INDGRPF PIC  X(0001).
  1532     05  FILLER REDEFINES INDGRPF.
  1533         10  INDGRPA PIC  X(0001).
  1534     05  INDGRPI PIC  X(0001).
  1535*    -------------------------------
  1536     05  PREMTYPL PIC S9(0004) COMP.
  1537     05  PREMTYPF PIC  X(0001).
  1538     05  FILLER REDEFINES PREMTYPF.
  1539         10  PREMTYPA PIC  X(0001).
  1540     05  PREMTYPI PIC  X(0001).
  1541*    -------------------------------
  1542     05  REINCDL PIC S9(0004) COMP.
  1543     05  REINCDF PIC  X(0001).
  1544     05  FILLER REDEFINES REINCDF.
  1545         10  REINCDA PIC  X(0001).
  1546     05  REINCDI PIC  X(0001).
  1547*    -------------------------------
  1548     05  JNTLNMEL PIC S9(0004) COMP.
  1549     05  JNTLNMEF PIC  X(0001).
  1550     05  FILLER REDEFINES JNTLNMEF.
  1551         10  JNTLNMEA PIC  X(0001).
  1552     05  JNTLNMEI PIC  X(0015).
  1553*    -------------------------------
  1554     05  JNTFNMEL PIC S9(0004) COMP.
  1555     05  JNTFNMEF PIC  X(0001).
  1556     05  FILLER REDEFINES JNTFNMEF.
  1557         10  JNTFNMEA PIC  X(0001).
  1558     05  JNTFNMEI PIC  X(0012).
  1559*    -------------------------------
  1560     05  JNTINITL PIC S9(0004) COMP.
  1561     05  JNTINITF PIC  X(0001).
  1562     05  FILLER REDEFINES JNTINITF.
  1563         10  JNTINITA PIC  X(0001).
  1564     05  JNTINITI PIC  X(0001).
  1565*    -------------------------------
  1566     05  JNTAGEL PIC S9(0004) COMP.
  1567     05  JNTAGEF PIC  X(0001).
  1568     05  FILLER REDEFINES JNTAGEF.
  1569         10  JNTAGEA PIC  X(0001).
  1570     05  JNTAGEI PIC  X(0002).
  1571*    -------------------------------
  1572     05  ADDONDTL PIC S9(0004) COMP.
  1573     05  ADDONDTF PIC  X(0001).
  1574     05  FILLER REDEFINES ADDONDTF.
  1575         10  ADDONDTA PIC  X(0001).
  1576     05  ADDONDTI PIC  X(0008).
  1577*    -------------------------------
  1578     05  LCVDSCRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL131.cbl
  1579     05  LCVDSCRF PIC  X(0001).
  1580     05  FILLER REDEFINES LCVDSCRF.
  1581         10  LCVDSCRA PIC  X(0001).
  1582     05  LCVDSCRI PIC  X(0006).
  1583*    -------------------------------
  1584     05  LCVKINDL PIC S9(0004) COMP.
  1585     05  LCVKINDF PIC  X(0001).
  1586     05  FILLER REDEFINES LCVKINDF.
  1587         10  LCVKINDA PIC  X(0001).
  1588     05  LCVKINDI PIC  X(0003).
  1589*    -------------------------------
  1590     05  LCVCDL PIC S9(0004) COMP.
  1591     05  LCVCDF PIC  X(0001).
  1592     05  FILLER REDEFINES LCVCDF.
  1593         10  LCVCDA PIC  X(0001).
  1594     05  LCVCDI PIC  X(0002).
  1595*    -------------------------------
  1596     05  LCVOTRML PIC S9(0004) COMP.
  1597     05  LCVOTRMF PIC  X(0001).
  1598     05  FILLER REDEFINES LCVOTRMF.
  1599         10  LCVOTRMA PIC  X(0001).
  1600     05  LCVOTRMI PIC  999.
  1601*    -------------------------------
  1602     05  LCVRTRML PIC S9(0004) COMP.
  1603     05  LCVRTRMF PIC  X(0001).
  1604     05  FILLER REDEFINES LCVRTRMF.
  1605         10  LCVRTRMA PIC  X(0001).
  1606     05  LCVRTRMI PIC  X(0003).
  1607*    -------------------------------
  1608     05  LCVRATEL PIC S9(0004) COMP.
  1609     05  LCVRATEF PIC  X(0001).
  1610     05  FILLER REDEFINES LCVRATEF.
  1611         10  LCVRATEA PIC  X(0001).
  1612     05  LCVRATEI PIC  9999V99.
  1613*    -------------------------------
  1614     05  LCVBENEL PIC S9(0004) COMP.
  1615     05  LCVBENEF PIC  X(0001).
  1616     05  FILLER REDEFINES LCVBENEF.
  1617         10  LCVBENEA PIC  X(0001).
  1618     05  LCVBENEI PIC  9(9)V99.
  1619*    -------------------------------
  1620     05  LCVFORML PIC S9(0004) COMP.
  1621     05  LCVFORMF PIC  X(0001).
  1622     05  FILLER REDEFINES LCVFORMF.
  1623         10  LCVFORMA PIC  X(0001).
  1624     05  LCVFORMI PIC  X(0012).
  1625*    -------------------------------
  1626     05  LCVCNDTL PIC S9(0004) COMP.
  1627     05  LCVCNDTF PIC  X(0001).
  1628     05  FILLER REDEFINES LCVCNDTF.
  1629         10  LCVCNDTA PIC  X(0001).
  1630     05  LCVCNDTI PIC  X(0008).
  1631*    -------------------------------
  1632     05  LCVEXITL PIC S9(0004) COMP.
  1633     05  LCVEXITF PIC  X(0001).
  1634     05  FILLER REDEFINES LCVEXITF.
  1635         10  LCVEXITA PIC  X(0001).
  1636     05  LCVEXITI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL131.cbl
  1637*    -------------------------------
  1638     05  LCVSTATL PIC S9(0004) COMP.
  1639     05  LCVSTATF PIC  X(0001).
  1640     05  FILLER REDEFINES LCVSTATF.
  1641         10  LCVSTATA PIC  X(0001).
  1642     05  LCVSTATI PIC  X(0006).
  1643*    -------------------------------
  1644     05  ACVDSCRL PIC S9(0004) COMP.
  1645     05  ACVDSCRF PIC  X(0001).
  1646     05  FILLER REDEFINES ACVDSCRF.
  1647         10  ACVDSCRA PIC  X(0001).
  1648     05  ACVDSCRI PIC  X(0006).
  1649*    -------------------------------
  1650     05  ACVKINDL PIC S9(0004) COMP.
  1651     05  ACVKINDF PIC  X(0001).
  1652     05  FILLER REDEFINES ACVKINDF.
  1653         10  ACVKINDA PIC  X(0001).
  1654     05  ACVKINDI PIC  X(0003).
  1655*    -------------------------------
  1656     05  ACVCDL PIC S9(0004) COMP.
  1657     05  ACVCDF PIC  X(0001).
  1658     05  FILLER REDEFINES ACVCDF.
  1659         10  ACVCDA PIC  X(0001).
  1660     05  ACVCDI PIC  X(0002).
  1661*    -------------------------------
  1662     05  ACVOTRML PIC S9(0004) COMP.
  1663     05  ACVOTRMF PIC  X(0001).
  1664     05  FILLER REDEFINES ACVOTRMF.
  1665         10  ACVOTRMA PIC  X(0001).
  1666     05  ACVOTRMI PIC  999.
  1667*    -------------------------------
  1668     05  ACVRTRML PIC S9(0004) COMP.
  1669     05  ACVRTRMF PIC  X(0001).
  1670     05  FILLER REDEFINES ACVRTRMF.
  1671         10  ACVRTRMA PIC  X(0001).
  1672     05  ACVRTRMI PIC  X(0003).
  1673*    -------------------------------
  1674     05  ACVRATEL PIC S9(0004) COMP.
  1675     05  ACVRATEF PIC  X(0001).
  1676     05  FILLER REDEFINES ACVRATEF.
  1677         10  ACVRATEA PIC  X(0001).
  1678     05  ACVRATEI PIC  9999V99.
  1679*    -------------------------------
  1680     05  ACVBENEL PIC S9(0004) COMP.
  1681     05  ACVBENEF PIC  X(0001).
  1682     05  FILLER REDEFINES ACVBENEF.
  1683         10  ACVBENEA PIC  X(0001).
  1684     05  ACVBENEI PIC  9(9)V99.
  1685*    -------------------------------
  1686     05  ACVFORML PIC S9(0004) COMP.
  1687     05  ACVFORMF PIC  X(0001).
  1688     05  FILLER REDEFINES ACVFORMF.
  1689         10  ACVFORMA PIC  X(0001).
  1690     05  ACVFORMI PIC  X(0012).
  1691*    -------------------------------
  1692     05  ACVCNDTL PIC S9(0004) COMP.
  1693     05  ACVCNDTF PIC  X(0001).
  1694     05  FILLER REDEFINES ACVCNDTF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL131.cbl
  1695         10  ACVCNDTA PIC  X(0001).
  1696     05  ACVCNDTI PIC  X(0008).
  1697*    -------------------------------
  1698     05  ACVEXITL PIC S9(0004) COMP.
  1699     05  ACVEXITF PIC  X(0001).
  1700     05  FILLER REDEFINES ACVEXITF.
  1701         10  ACVEXITA PIC  X(0001).
  1702     05  ACVEXITI PIC  X(0008).
  1703*    -------------------------------
  1704     05  ACVSTATL PIC S9(0004) COMP.
  1705     05  ACVSTATF PIC  X(0001).
  1706     05  FILLER REDEFINES ACVSTATF.
  1707         10  ACVSTATA PIC  X(0001).
  1708     05  ACVSTATI PIC  X(0006).
  1709*    -------------------------------
  1710     05  DAYSPL PIC S9(0004) COMP.
  1711     05  DAYSPF PIC  X(0001).
  1712     05  FILLER REDEFINES DAYSPF.
  1713         10  DAYSPA PIC  X(0001).
  1714     05  DAYSPI PIC  X(0003).
  1715*    -------------------------------
  1716     05  LABEL2L PIC S9(0004) COMP.
  1717     05  LABEL2F PIC  X(0001).
  1718     05  FILLER REDEFINES LABEL2F.
  1719         10  LABEL2A PIC  X(0001).
  1720     05  LABEL2I PIC  X(0014).
  1721*    -------------------------------
  1722     05  BCERT1L PIC S9(0004) COMP.
  1723     05  BCERT1F PIC  X(0001).
  1724     05  FILLER REDEFINES BCERT1F.
  1725         10  BCERT1A PIC  X(0001).
  1726     05  BCERT1I PIC  X(0010).
  1727*    -------------------------------
  1728     05  BSUFX1L PIC S9(0004) COMP.
  1729     05  BSUFX1F PIC  X(0001).
  1730     05  FILLER REDEFINES BSUFX1F.
  1731         10  BSUFX1A PIC  X(0001).
  1732     05  BSUFX1I PIC  X(0001).
  1733*    -------------------------------
  1734     05  BCERT2L PIC S9(0004) COMP.
  1735     05  BCERT2F PIC  X(0001).
  1736     05  FILLER REDEFINES BCERT2F.
  1737         10  BCERT2A PIC  X(0001).
  1738     05  BCERT2I PIC  X(0010).
  1739*    -------------------------------
  1740     05  BSUFX2L PIC S9(0004) COMP.
  1741     05  BSUFX2F PIC  X(0001).
  1742     05  FILLER REDEFINES BSUFX2F.
  1743         10  BSUFX2A PIC  X(0001).
  1744     05  BSUFX2I PIC  X(0001).
  1745*    -------------------------------
  1746     05  BCERT3L PIC S9(0004) COMP.
  1747     05  BCERT3F PIC  X(0001).
  1748     05  FILLER REDEFINES BCERT3F.
  1749         10  BCERT3A PIC  X(0001).
  1750     05  BCERT3I PIC  X(0010).
  1751*    -------------------------------
  1752     05  BSUFX3L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL131.cbl
  1753     05  BSUFX3F PIC  X(0001).
  1754     05  FILLER REDEFINES BSUFX3F.
  1755         10  BSUFX3A PIC  X(0001).
  1756     05  BSUFX3I PIC  X(0001).
  1757*    -------------------------------
  1758     05  BCERT4L PIC S9(0004) COMP.
  1759     05  BCERT4F PIC  X(0001).
  1760     05  FILLER REDEFINES BCERT4F.
  1761         10  BCERT4A PIC  X(0001).
  1762     05  BCERT4I PIC  X(0010).
  1763*    -------------------------------
  1764     05  BSUFX4L PIC S9(0004) COMP.
  1765     05  BSUFX4F PIC  X(0001).
  1766     05  FILLER REDEFINES BSUFX4F.
  1767         10  BSUFX4A PIC  X(0001).
  1768     05  BSUFX4I PIC  X(0001).
  1769*    -------------------------------
  1770     05  BCERT5L PIC S9(0004) COMP.
  1771     05  BCERT5F PIC  X(0001).
  1772     05  FILLER REDEFINES BCERT5F.
  1773         10  BCERT5A PIC  X(0001).
  1774     05  BCERT5I PIC  X(0010).
  1775*    -------------------------------
  1776     05  BSUFX5L PIC S9(0004) COMP.
  1777     05  BSUFX5F PIC  X(0001).
  1778     05  FILLER REDEFINES BSUFX5F.
  1779         10  BSUFX5A PIC  X(0001).
  1780     05  BSUFX5I PIC  X(0001).
  1781*    -------------------------------
  1782     05  MSG1L PIC S9(0004) COMP.
  1783     05  MSG1F PIC  X(0001).
  1784     05  FILLER REDEFINES MSG1F.
  1785         10  MSG1A PIC  X(0001).
  1786     05  MSG1I PIC  X(0072).
  1787*    -------------------------------
  1788     05  PFKEYL PIC S9(0004) COMP.
  1789     05  PFKEYF PIC  X(0001).
  1790     05  FILLER REDEFINES PFKEYF.
  1791         10  PFKEYA PIC  X(0001).
  1792     05  PFKEYI PIC  99.
  1793*    -------------------------------
  1794     05  PFKEY6L PIC S9(0004) COMP.
  1795     05  PFKEY6F PIC  X(0001).
  1796     05  FILLER REDEFINES PFKEY6F.
  1797         10  PFKEY6A PIC  X(0001).
  1798     05  PFKEY6I PIC  X(0016).
  1799 01  EL131AO REDEFINES EL131AI.
  1800     05  FILLER            PIC  X(0012).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  DATEO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  TIMEO PIC  99.99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  SEQUO PIC  X(0010).
  1810*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL131.cbl
  1811     05  FILLER            PIC  X(0003).
  1812     05  COMPO PIC  X(0003).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  USERIDO PIC  X(0004).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CCNOO PIC  X(0016).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  MAINTO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CLAIMO PIC  X(0007).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CARRO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  CERTO PIC  X(0010).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  SUFXO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  TYPEO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  LABEL1O PIC  X(0011).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  PCERTNOO PIC  X(0010).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PSUFXO PIC  X(0001).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  STATUSO PIC  X(0006).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  INCO PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  REPO PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  CAUSEO PIC  X(0006).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ENDO PIC  X(0008).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  DIAGO PIC  X(0060).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  BENEO PIC  X(0010).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL131.cbl
  1869     05  BIRTHO PIC  X(0008).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  SOCIALO PIC  X(0011).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  SEXO PIC  X(0001).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  MLNAMEO PIC  X(0015).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  MFNAMEO PIC  X(0012).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  MMINITO PIC  X(0001).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  LOANNOO PIC  X(0008).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  CRTLNMEO PIC  X(0015).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  CRTFNMEO PIC  X(0012).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  CRTINITO PIC  X(0001).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  LOANBALO PIC  ZZZZZ9.99.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PROCO PIC  X(0004).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  SUPVO PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  PRICDO PIC  X(0001).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  FILETOO PIC  X(0004).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  PTHRHDGO PIC  X(0010).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  PDTHRUO PIC  X(0008).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  PDAMTO PIC  Z(06).99.
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  NODAYSO PIC  ZZZ99.
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  NOPMTSO PIC  ZZ99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL131.cbl
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  FORMTYPO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ESTO PIC  X(0008).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  AUIDO PIC  X(0004).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  OCCO PIC  X(0006).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  MNTDTO PIC  X(0008).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  MNTTYPEO PIC  X(0006).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  CERTCARO PIC  X(0001).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  CERTGRPO PIC  X(0006).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  CERTSTO PIC  X(0002).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  CERTACTO PIC  X(0010).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  CERTEFFO PIC  X(0008).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  ISSAGEO PIC  X(0002).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  APRO PIC  9(3).9(4).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  PMTFREQO PIC  99.
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  INDGRPO PIC  X(0001).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  PREMTYPO PIC  X(0001).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  REINCDO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  JNTLNMEO PIC  X(0015).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  JNTFNMEO PIC  X(0012).
  1984*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL131.cbl
  1985     05  FILLER            PIC  X(0003).
  1986     05  JNTINITO PIC  X(0001).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  JNTAGEO PIC  X(0002).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  ADDONDTO PIC  X(0008).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVDSCRO PIC  X(0006).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVKINDO PIC  X(0003).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVCDO PIC  X(0002).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVOTRMO PIC  999.
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVRTRMO PIC  999.
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVRATEO PIC  ZZZ.ZZ.
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVFORMO PIC  X(0012).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LCVCNDTO PIC  X(0008).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  LCVEXITO PIC  X(0008).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  LCVSTATO PIC  X(0006).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVDSCRO PIC  X(0006).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVKINDO PIC  X(0003).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVCDO PIC  X(0002).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVOTRMO PIC  999.
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVRTRMO PIC  999.
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL131.cbl
  2043     05  ACVRATEO PIC  ZZZ.ZZ.
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVFORMO PIC  X(0012).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ACVCNDTO PIC  X(0008).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ACVEXITO PIC  X(0008).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  ACVSTATO PIC  X(0006).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  DAYSPO PIC  X(0003).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  LABEL2O PIC  X(0014).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BCERT1O PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BSUFX1O PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BCERT2O PIC  X(0010).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BSUFX2O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BCERT3O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BSUFX3O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BCERT4O PIC  X(0010).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BSUFX4O PIC  X(0001).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BCERT5O PIC  X(0010).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BSUFX5O PIC  X(0001).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  MSG1O PIC  X(0072).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  PFKEYO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL131.cbl
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  PFKEY6O PIC  X(0016).
  2104*    -------------------------------
  2105
  2106*                                COPY ELCEMIB SUPPRESS.
  2107******************************************************************
  2108*                                                                *
  2109*                                                                *
  2110*                            ELCEMIB.                            *
  2111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2112*                            VMOD=2.005                          *
  2113*                                                                *
  2114*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2115*                                                                *
  2116******************************************************************
  2117 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2118     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2119     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2120     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2121     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2122     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2123     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2124     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2125     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2126     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2127         88  EMI-NO-ERRORS                    VALUE '1'.
  2128         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2129         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2130     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2131         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2132     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2133         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2134         88  EMI-AREA1-FULL                   VALUE '2'.
  2135     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2136         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2137         88  EMI-AREA2-FULL                   VALUE '2'.
  2138     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2139         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2140         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2141         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2142         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2143         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2144     12  EMI-ERROR-LINES.
  2145         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2146         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2147         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2148         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2149             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2150                 24  EMI-ERR-NUM         PIC X(4).
  2151                 24  EMI-FILLER          PIC X.
  2152                 24  EMI-SEV             PIC X.
  2153                 24  FILLER              PIC X.
  2154             20  FILLER                  PIC X(02).
  2155     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2156         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2157             20  EMI-ERROR-NUMBER    PIC X(4).
  2158             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL131.cbl
  2159             20  EMI-SEVERITY        PIC X.
  2160             20  FILLER              PIC X.
  2161             20  EMI-ERROR-TEXT.
  2162                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2163                 24  FILLER          PIC X(55).
  2164     12  EMI-SEVERITY-SAVE           PIC X.
  2165         88  EMI-NOTE                    VALUE 'N'.
  2166         88  EMI-WARNING                 VALUE 'W'.
  2167         88  EMI-FORCABLE                VALUE 'F'.
  2168         88  EMI-FATAL                   VALUE 'X'.
  2169     12  EMI-MESSAGE-FLAG            PIC X.
  2170         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2171         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2172     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2173     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2174         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2175         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2176         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2177     12  FILLER                      PIC X(137)  VALUE SPACES.
  2178     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2179     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2180     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2181     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2182
  2183*                                COPY ELCJPFX SUPPRESS.
  2184******************************************************************
  2185*                                                                *
  2186*                                                                *
  2187*                            ELCJPFX.                            *
  2188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2189*                            VMOD=2.002                          *
  2190*                                                                *
  2191*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2192*                                                                *
  2193*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2194*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2195*        ELCNTL - CONTROL FILE                                   *
  2196*        ELMSTR - CLAIM MASTERS                                  *
  2197*        ELTRLR - ACTIVITY TRAILERS                              *
  2198*        ELCHKQ - CHECK QUE                                      *
  2199******************************************************************
  2200 01  JOURNAL-RECORD.
  2201     12  JP-USER-ID                  PIC X(4).
  2202     12  JP-FILE-ID                  PIC X(8).
  2203     12  JP-PROGRAM-ID               PIC X(8).
  2204     12  JP-RECORD-TYPE              PIC X.
  2205         88 JP-ADD              VALUE 'A'.
  2206         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2207         88 JP-AFTER-CHANGE     VALUE 'C'.
  2208         88 JP-DELETE           VALUE 'D'.
  2209         88 JP-GENERIC-DELETE   VALUE 'G'.
  2210         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2211         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2212     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2213     12  JP-RECORD-AREA
  2214
  2215
  2216                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL131.cbl
  2217
  2218*                                COPY ELCCALC SUPPRESS.
  2219******************************************************************
  2220*                                                                *
  2221*                           ELCCALC.                            *
  2222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2223*                            VMOD=2.025                          *
  2224*                                                                *
  2225*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2226*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2227*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2228*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2229*                                                                *
  2230*  PASSED TO ELRTRM                                              *
  2231*  -----------------                                             *
  2232*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2233*  ORIGINAL TERM                                                 *
  2234*  BEGINNING DATE                                                *
  2235*  ENDING DATE                                                   *
  2236*  COMPANY I.D.                                                  *
  2237*  ACCOUNT MASTER USER FIELD                                     *
  2238*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2239*  FREE LOOK DAYS                                                *
  2240*                                                                *
  2241*  RETURNED FROM ELRTRM                                          *
  2242*  ---------------------                                         *
  2243*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2244*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2245*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2246*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2247*----------------------------------------------------------------*
  2248*  PASSED TO ELRAMT                                              *
  2249*  ----------------                                              *
  2250*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2251*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2252*  ORIGINAL AMOUNT                                               *
  2253*  ALTERNATE BENEFIT (BALLON)                                    *
  2254*  A.P.R. - NET PAY ONLY                                         *
  2255*  METHOD
  2256*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2257*  COMPANY I.D.                                                  *
  2258*  BENEFIT TYPE                                                  *
  2259*                                                                *
  2260*  RETURNED FROM ELRAMT                                          *
  2261*  --------------------                                          *
  2262*  REMAINING AMOUNT 1 - CURRENT                                  *
  2263*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2264*  REMAINING AMOUNT FACTOR
  2265*----------------------------------------------------------------*
  2266*  PASSED TO ELRESV                                              *
  2267*  -----------------                                             *
  2268*  CERTIFICATE EFFECTIVE DATE                                    *
  2269*  VALUATION DATE                                                *
  2270*  PAID THRU DATE                                                *
  2271*  BENEFIT                                                       *
  2272*  INCURRED DATE                                                 *
  2273*  REPORTED DATE                                                 *
  2274*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL131.cbl
  2275*  TERM                                                          *
  2276*  CDT PERCENT                                                   *
  2277*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2278* *CLAIM TYPE (LIFE, A/H)                                        *
  2279* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2280* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2281*                                                                *
  2282*  RETURNED FROM ELRESV                                          *
  2283*  --------------------                                          *
  2284*  CDT TABLE USED                                                *
  2285*  CDT FACTOR USED                                               *
  2286*  PAY TO CURRENT RESERVE                                        *
  2287*  I.B.N.R. - A/H ONLY                                           *
  2288*  FUTURE (ACCRUED) AH ONLY                                      *
  2289*----------------------------------------------------------------*
  2290*  PASSED TO ELRATE                                              *
  2291*  ----------------                                              *
  2292*  CERT ISSUE DATE                                               *
  2293*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2294*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2295*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2296*  STATE CODE (CLIENT DEFINED)                                   *
  2297*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2298*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2299*  DEVIATION CODE                                                *
  2300*  ISSUE AGE                                                     *
  2301*  ORIGINAL BENEFIT AMOUNT                                       *
  2302*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2303*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2304*  BENEFIT KIND (LIFE OR A/H)                                    *
  2305*  A.P.R.                                                        *
  2306*  METHOD
  2307*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2308*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2309*  COMPANY I.D. (3 CHARACTER)                                    *
  2310*  BENEFIT CODE                                                  *
  2311*  BENEFIT OVERRIDE CODE                                         *
  2312*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2313*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2314*  JOINT INDICATOR (CSL ONLY)                                    *
  2315*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2316*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2317*                                                                *
  2318*  RETURNED FROM ELRATE                                          *
  2319*  --------------------                                          *
  2320*  CALCULATED PREMIUM                                            *
  2321*  PREMIUM RATE                                                  *
  2322*  MORTALITY CODE                                                *
  2323*  MAX ATTAINED AGE                                              *
  2324*  MAX AGE                                                       *
  2325*  MAX TERM                                                      *
  2326*  MAX MONTHLY BENEFIT                                           *
  2327*  MAX TOTAL BENIFIT                                             *
  2328*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2329*----------------------------------------------------------------*
  2330*  PASSED TO ELRFND                                              *
  2331*  ----------------                                              *
  2332*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL131.cbl
  2333*  REFUND DATE                                                   *
  2334*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2335*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2336*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2337*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2338*  STATE CODE (CLIENT DEFINED)                                   *
  2339*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2340*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2341*  DEVIATION CODE                                                *
  2342*  ISSUE AGE                                                     *
  2343*  ORIGINAL BENEFIT AMOUNT                                       *
  2344*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2345*  PROCESS TYPE (CANCEL)                                         *
  2346*  BENEFIT KIND (LIFE OR A/H)                                    *
  2347*  A.P.R.                                                        *
  2348*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2349*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2350*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2351*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2352*  COMPANY I.D. (3 CHARACTER)                                    *
  2353*  BENEFIT CODE                                                  *
  2354*  BENEFIT OVERRIDE CODE                                         *
  2355*                                                                *
  2356*  RETURNED FROM ELRFND                                          *
  2357*  --------------------                                          *
  2358*  CALCULATED REFUND                                             *
  2359*----------------------------------------------------------------*
  2360*  PASSED TO ELEARN                                              *
  2361*  ----------------                                              *
  2362*  CERT ISSUE DATE                                               *
  2363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2364*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2365*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2366*  STATE CODE (CLIENT DEFINED)                                   *
  2367*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2368*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2369*  DEVIATION CODE                                                *
  2370*  ISSUE AGE                                                     *
  2371*  ORIGINAL BENEFIT AMOUNT                                       *
  2372*  BENEFIT KIND (LIFE OR A/H)                                    *
  2373*  A.P.R.                                                        *
  2374*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2375*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2376*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2377*  COMPANY I.D. (3 CHARACTER)                                    *
  2378*  BENEFIT CODE                                                  *
  2379*  BENEFIT OVERRIDE CODE                                         *
  2380*                                                                *
  2381*  RETURNED FROM ELEARN                                          *
  2382*  --------------------                                          *
  2383*  INDICATED  EARNINGS                                           *
  2384*----------------------------------------------------------------*
  2385*                 LENGTH = 450                                   *
  2386*                                                                *
  2387******************************************************************
  2388******************************************************************
  2389*                   C H A N G E   L O G
  2390*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL131.cbl
  2391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2392*-----------------------------------------------------------------
  2393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2394* EFFECTIVE    NUMBER
  2395*-----------------------------------------------------------------
  2396* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2397* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2398* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2399* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2400* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2401* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2402* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2403* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2404* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2405******************************************************************
  2406
  2407 01  CALCULATION-PASS-AREA.
  2408     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2409                                     COMP.
  2410
  2411     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2412       88  NO-CP-ERROR                             VALUE ZERO.
  2413       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2414                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2415       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2416       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2417       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2418       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2419       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2420       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2421       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2422       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2423       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2424       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2425       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2426       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2427       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2428       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2429       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2430       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2431       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2432
  2433     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2434       88  NO-CP-ERROR-2                           VALUE ZERO.
  2435***********************  INPUT AREAS ****************************
  2436
  2437     12  CP-CALCULATION-AREA.
  2438         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2439         16  CP-CERT-EFF-DT        PIC XX.
  2440         16  CP-VALUATION-DT       PIC XX.
  2441         16  CP-PAID-THRU-DT       PIC XX.
  2442         16  CP-BENEFIT-TYPE       PIC X.
  2443           88  CP-AH                               VALUE 'A' 'D'
  2444                                                   'I' 'U'.
  2445           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2446           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2447         16  CP-INCURRED-DT        PIC XX.
  2448         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL131.cbl
  2449         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2450         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2451         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2452                                     COMP-3.
  2453         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2454                                     COMP-3.
  2455         16  CP-CDT-METHOD         PIC X.
  2456           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2457           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2458           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2459         16  CP-CLAIM-TYPE         PIC X.
  2460           88  CP-AH-CLAIM                         VALUE 'A'.
  2461           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2462         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2463                                     COMP-3.
  2464         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2469                                     COMP-3.
  2470         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2471                                     COMP-3.
  2472         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2473                                     COMP-3.
  2474         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2475                                     COMP-3.
  2476         16  CP-REM-TERM-METHOD    PIC X.
  2477           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2478           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2479           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2480           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2481           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2482           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2483           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2484         16  CP-EARNING-METHOD     PIC X.
  2485           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2486           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2487           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2488           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2489           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2490           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2491           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2492           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2493           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2494           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2495           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2496           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2497           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2498           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2499         16  CP-PROCESS-TYPE       PIC X.
  2500           88  CP-CLAIM                            VALUE '1'.
  2501           88  CP-CANCEL                           VALUE '2'.
  2502           88  CP-ISSUE                            VALUE '3'.
  2503         16  CP-SPECIAL-CALC-CD    PIC X.
  2504           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2505           88  CP-1-MTH-INTEREST               VALUE ' '.
  2506           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL131.cbl
  2507           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2508           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2509           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2510           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2511           88  CP-FARM-PLAN                    VALUE 'F'.
  2512           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2513           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2514           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2515           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2516           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2517           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2518           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2519           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2520           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2521           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2522                                                     'W' 'X'.
  2523           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2524           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2525           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2526           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2527           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2528           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2529           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2530           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2531           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2532           88  CP-CSL-METH-1                   VALUE '5'.
  2533           88  CP-CSL-METH-2                   VALUE '6'.
  2534           88  CP-CSL-METH-3                   VALUE '7'.
  2535           88  CP-CSL-METH-4                   VALUE '8'.
  2536
  2537         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2538                                     COMP-3.
  2539         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2540         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2541         16  CP-STATE              PIC XX          VALUE SPACE.
  2542         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2543         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2544           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2545               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2546         16  CP-R78-OPTION         PIC X.
  2547           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2548           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2549
  2550         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2551         16  CP-IBNR-RESERVE-SW    PIC X.
  2552         16  CP-CLAIM-STATUS       PIC X.
  2553         16  CP-RATE-FILE          PIC X.
  2554         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2555                                     COMP-3.
  2556
  2557         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2558         16  CP-AH-OVERRIDE-CODE   PIC X.
  2559
  2560         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2563                                   PIC S9(5)V99 COMP-3.
  2564         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL131.cbl
  2565                                     COMP-3.
  2566         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2567                                     COMP-3.
  2568         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2569                                     COMP-3.
  2570         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2571                                  PIC S9(7)V99 COMP-3.
  2572
  2573         16  CP-PAID-FROM-DATE     PIC X(02).
  2574         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2575         16  CP-EXT-DAYS-CALC      PIC X.
  2576           88  CP-EXT-NO-CHG                   VALUE ' '.
  2577           88  CP-EXT-CHG-LF                   VALUE '1'.
  2578           88  CP-EXT-CHG-AH                   VALUE '2'.
  2579           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2580         16  CP-DOMICILE-STATE     PIC XX.
  2581         16  CP-CARRIER            PIC X.
  2582         16  CP-REIN-FLAG          PIC X.
  2583         16  CP-REM-TRM-CALC-OPTION PIC X.
  2584           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2585                      '2' '3' '4' '5'.
  2586           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2587           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2588           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2589           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2590           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2591           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2592           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2593           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2594         16  CP-SIG-SWITCH         PIC X.
  2595         16  CP-RATING-METHOD      PIC X.
  2596           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2597           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2598           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2599           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2600           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2601           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2602           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2603           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2604           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2605         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2606                                     COMP-3.
  2607         16  CP-BEN-CATEGORY       PIC X.
  2608         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2609         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2610                                   PIC S99V9(5) COMP-3.
  2611         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2612         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2613                                   PIC S99V9(5) COMP-3.
  2614         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2615         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2616         16  CP-EXPIRE-DT          PIC XX.
  2617         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2618         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2619         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2620         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2621         16  CP-DDF-SPEC-CALC      PIC X.
  2622             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL131.cbl
  2623             88  CP-CALC-CLP              VALUE 'C'.
  2624         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2625         16  CP-CANCEL-REASON      PIC X.
  2626         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2627         16  CP-PMT-MODE           PIC X.
  2628         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2629         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2630         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2631         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2632         16  FILLER                PIC X.
  2633
  2634***************    OUTPUT FROM ELRESV   ************************
  2635
  2636         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2637
  2638         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2639                                     COMP-3.
  2640         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2641                                     COMP-3.
  2642         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2643                                     COMP-3.
  2644         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2645                                     COMP-3.
  2646         16  FILLER                PIC X(09).
  2647***************    OUTPUT FROM ELRTRM   *************************
  2648
  2649         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2650                                     COMP-3.
  2651         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2652                                     COMP-3.
  2653         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2656                                     COMP-3.
  2657         16  FILLER                PIC X(12).
  2658
  2659***************    OUTPUT FROM ELRAMT   *************************
  2660
  2661         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2662                                     COMP-3.
  2663         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2664                                     COMP-3.
  2665         16  FILLER                PIC X(12).
  2666
  2667***************    OUTPUT FROM ELRATE   *************************
  2668
  2669         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2670                                     COMP-3.
  2671         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2672                                     COMP-3.
  2673         16  CP-MORTALITY-CODE     PIC X(4).
  2674         16  CP-RATE-EDIT-FLAG     PIC X.
  2675             88  CP-RATES-NEED-APR                  VALUE '1'.
  2676         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2679         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2680         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL131.cbl
  2681                                   PIC S9(7)V99 COMP-3.
  2682         16  FILLER                PIC X(07).
  2683
  2684***************    OUTPUT FROM ELRFND   *************************
  2685
  2686         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2687                                     COMP-3.
  2688         16  CP-REFUND-TYPE-USED   PIC X.
  2689           88  CP-R-AS-R78                         VALUE '1'.
  2690           88  CP-R-AS-PRORATA                     VALUE '2'.
  2691           88  CP-R-AS-CALIF                       VALUE '3'.
  2692           88  CP-R-AS-TEXAS                       VALUE '4'.
  2693           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2694           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2695           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2696           88  CP-R-AS-MEAN                        VALUE '8'.
  2697           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2698           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2699           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2700           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2701           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2702           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2703         16  FILLER                PIC X(12).
  2704
  2705***************    OUTPUT FROM ELEARN   *************************
  2706
  2707         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-EARNING-TYPE-USED  PIC X.
  2720           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2721           88  CP-E-AS-R78                         VALUE '1'.
  2722           88  CP-E-AS-PRORATA                     VALUE '2'.
  2723           88  CP-E-AS-TEXAS                       VALUE '4'.
  2724           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2725           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2726           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2727           88  CP-E-AS-MEAN                        VALUE '8'.
  2728           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2729         16  FILLER                PIC X(12).
  2730
  2731***************    OUTPUT FROM ELPMNT   *************************
  2732
  2733         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2736                                     COMP-3.
  2737         16  FILLER                PIC X(12).
  2738
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL131.cbl
  2739***************   MISC WORK AREAS    *****************************
  2740         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2743                                     COMP-3.
  2744         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2745                                     COMP-3.
  2746         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2747                                     COMP-3.
  2748         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2751                                     COMP-3.
  2752         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2753             88  OPEN-RATE-FILE                   VALUE 'O'.
  2754             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2755             88  IO-ERROR                         VALUE 'E'.
  2756
  2757         16  CP-FIRST-PAY-DATE     PIC XX.
  2758
  2759         16  CP-JOINT-INDICATOR    PIC X.
  2760
  2761         16  CP-RESERVE-REMAINING-TERM
  2762                                   PIC S9(4)V9    VALUE ZERO
  2763                                     COMP-3.
  2764
  2765         16  CP-INSURED-BIRTH-DT   PIC XX.
  2766
  2767         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2768                                     COMP-3.
  2769
  2770         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2771                                     COMP-3.
  2772
  2773         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2774                                     COMP-3.
  2775
  2776         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2777                                     COMP-3.
  2778
  2779         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2780                                     COMP-3.
  2781
  2782         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2783                                     COMP-3.
  2784
  2785         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2786                                     COMP-3.
  2787
  2788         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2789             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2790
  2791         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2796         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL131.cbl
  2797******************************************************************
  2798
  2799*                                COPY ELCDATE SUPPRESS.
  2800******************************************************************
  2801*                                                                *
  2802*                                                                *
  2803*                            ELCDATE.                            *
  2804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2805*                            VMOD=2.003
  2806*                                                                *
  2807*                                                                *
  2808*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2809*                 LENGTH = 200                                   *
  2810******************************************************************
  2811
  2812 01  DATE-CONVERSION-DATA.
  2813     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2814     12  DC-OPTION-CODE                PIC X.
  2815         88  BIN-TO-GREG                VALUE ' '.
  2816         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2817         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2818         88  YMD-GREG-TO-BIN            VALUE '3'.
  2819         88  MDY-GREG-TO-BIN            VALUE '4'.
  2820         88  JULIAN-TO-BIN              VALUE '5'.
  2821         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2822         88  FIND-CENTURY               VALUE '7'.
  2823         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2824         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2825         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2826         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2827         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2828         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2829         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2830         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2831         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2832         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2833         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2834         88  BIN-3-TO-GREG              VALUE 'I'.
  2835         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2836         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2837         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2838         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2839         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2840         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2841         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2842         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2843         88  THREE-CHARACTER-BIN
  2844                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2845         88  GREGORIAN-TO-BIN
  2846                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2847         88  BIN-TO-GREGORIAN
  2848                  VALUES ' ' '1' 'I' '8' 'G'.
  2849         88  JULIAN-TO-BINARY
  2850                  VALUES '5' 'C' 'E' 'F'.
  2851     12  DC-ERROR-CODE                 PIC X.
  2852         88  NO-CONVERSION-ERROR        VALUE ' '.
  2853         88  DATE-CONVERSION-ERROR
  2854                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL131.cbl
  2855         88  DATE-IS-ZERO               VALUE '1'.
  2856         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2857         88  DATE-IS-INVALID            VALUE '3'.
  2858         88  DATE1-GREATER-DATE2        VALUE '4'.
  2859         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2860         88  DATE-INVALID-OPTION        VALUE '9'.
  2861         88  INVALID-CENTURY            VALUE 'A'.
  2862         88  ONLY-CENTURY               VALUE 'B'.
  2863         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2864         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2865     12  DC-END-OF-MONTH               PIC X.
  2866         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2867     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2868         88  USE-NORMAL-PROCESS         VALUE ' '.
  2869         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2870         88  ADJUST-UP-100-YRS          VALUE '2'.
  2871     12  FILLER                        PIC X.
  2872     12  DC-CONVERSION-DATES.
  2873         16  DC-BIN-DATE-1             PIC XX.
  2874         16  DC-BIN-DATE-2             PIC XX.
  2875         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2876         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2877                       DC-GREG-DATE-1-EDIT.
  2878             20  DC-EDIT1-MONTH        PIC 99.
  2879             20  SLASH1-1              PIC X.
  2880             20  DC-EDIT1-DAY          PIC 99.
  2881             20  SLASH1-2              PIC X.
  2882             20  DC-EDIT1-YEAR         PIC 99.
  2883         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2884         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2885                     DC-GREG-DATE-2-EDIT.
  2886             20  DC-EDIT2-MONTH        PIC 99.
  2887             20  SLASH2-1              PIC X.
  2888             20  DC-EDIT2-DAY          PIC 99.
  2889             20  SLASH2-2              PIC X.
  2890             20  DC-EDIT2-YEAR         PIC 99.
  2891         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2892         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2893                     DC-GREG-DATE-1-YMD.
  2894             20  DC-YMD-YEAR           PIC 99.
  2895             20  DC-YMD-MONTH          PIC 99.
  2896             20  DC-YMD-DAY            PIC 99.
  2897         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2898         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2899                      DC-GREG-DATE-1-MDY.
  2900             20  DC-MDY-MONTH          PIC 99.
  2901             20  DC-MDY-DAY            PIC 99.
  2902             20  DC-MDY-YEAR           PIC 99.
  2903         16  DC-GREG-DATE-1-ALPHA.
  2904             20  DC-ALPHA-MONTH        PIC X(10).
  2905             20  DC-ALPHA-DAY          PIC 99.
  2906             20  FILLER                PIC XX.
  2907             20  DC-ALPHA-CENTURY.
  2908                 24 DC-ALPHA-CEN-N     PIC 99.
  2909             20  DC-ALPHA-YEAR         PIC 99.
  2910         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2911         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2912         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL131.cbl
  2913         16  DC-JULIAN-DATE            PIC 9(05).
  2914         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2915                                       PIC 9(05).
  2916         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2917             20  DC-JULIAN-YEAR        PIC 99.
  2918             20  DC-JULIAN-DAYS        PIC 999.
  2919         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2920         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2921         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2922     12  DATE-CONVERSION-VARIBLES.
  2923         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2924         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2925             20  FILLER                PIC 9(3).
  2926             20  HOLD-CEN-1-CCYY.
  2927                 24  HOLD-CEN-1-CC     PIC 99.
  2928                 24  HOLD-CEN-1-YY     PIC 99.
  2929             20  HOLD-CEN-1-MO         PIC 99.
  2930             20  HOLD-CEN-1-DA         PIC 99.
  2931         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2932             20  HOLD-CEN-1-R-MO       PIC 99.
  2933             20  HOLD-CEN-1-R-DA       PIC 99.
  2934             20  HOLD-CEN-1-R-CCYY.
  2935                 24  HOLD-CEN-1-R-CC   PIC 99.
  2936                 24  HOLD-CEN-1-R-YY   PIC 99.
  2937             20  FILLER                PIC 9(3).
  2938         16  HOLD-CENTURY-1-X.
  2939             20  FILLER                PIC X(3)  VALUE SPACES.
  2940             20  HOLD-CEN-1-X-CCYY.
  2941                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2942                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2943             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2944             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2945         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2946             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2947             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2948             20  HOLD-CEN-1-R-X-CCYY.
  2949                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2950                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2951             20  FILLER                PIC XXX.
  2952         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2953         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2954         16  DC-JULIAN-DATE-1          PIC 9(07).
  2955         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2956             20  DC-JULIAN-1-CCYY.
  2957                 24  DC-JULIAN-1-CC    PIC 99.
  2958                 24  DC-JULIAN-1-YR    PIC 99.
  2959             20  DC-JULIAN-DA-1        PIC 999.
  2960         16  DC-JULIAN-DATE-2          PIC 9(07).
  2961         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2962             20  DC-JULIAN-2-CCYY.
  2963                 24  DC-JULIAN-2-CC    PIC 99.
  2964                 24  DC-JULIAN-2-YR    PIC 99.
  2965             20  DC-JULIAN-DA-2        PIC 999.
  2966         16  DC-GREG-DATE-A-EDIT.
  2967             20  DC-EDITA-MONTH        PIC 99.
  2968             20  SLASHA-1              PIC X VALUE '/'.
  2969             20  DC-EDITA-DAY          PIC 99.
  2970             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL131.cbl
  2971             20  DC-EDITA-CCYY.
  2972                 24  DC-EDITA-CENT     PIC 99.
  2973                 24  DC-EDITA-YEAR     PIC 99.
  2974         16  DC-GREG-DATE-B-EDIT.
  2975             20  DC-EDITB-MONTH        PIC 99.
  2976             20  SLASHB-1              PIC X VALUE '/'.
  2977             20  DC-EDITB-DAY          PIC 99.
  2978             20  SLASHB-2              PIC X VALUE '/'.
  2979             20  DC-EDITB-CCYY.
  2980                 24  DC-EDITB-CENT     PIC 99.
  2981                 24  DC-EDITB-YEAR     PIC 99.
  2982         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2983         16  DC-GREG-DATE-CYMD-R REDEFINES
  2984                              DC-GREG-DATE-CYMD.
  2985             20  DC-CYMD-CEN           PIC 99.
  2986             20  DC-CYMD-YEAR          PIC 99.
  2987             20  DC-CYMD-MONTH         PIC 99.
  2988             20  DC-CYMD-DAY           PIC 99.
  2989         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2990         16  DC-GREG-DATE-MDCY-R REDEFINES
  2991                              DC-GREG-DATE-MDCY.
  2992             20  DC-MDCY-MONTH         PIC 99.
  2993             20  DC-MDCY-DAY           PIC 99.
  2994             20  DC-MDCY-CEN           PIC 99.
  2995             20  DC-MDCY-YEAR          PIC 99.
  2996    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2997        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2998    12  DC-EL310-DATE                  PIC X(21).
  2999    12  FILLER                         PIC X(28).
  3000
  3001*                                COPY ELCDMO.
  3002******************************************************************
  3003*                                                                *
  3004*                                                                *
  3005*                            ELCDMO.                             *
  3006*                            VMOD=2.004                          *
  3007*                                                                *
  3008*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3009*        COMMUNICATION AREA                                      *
  3010*   FILE TYPE = NA                                               *
  3011*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3012*                                                                *
  3013******************************************************************
  3014 01  DMO-COMMUNICATION-AREA.
  3015     12  DM-RECORD-TYPE                  PIC  X(02).
  3016             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3017             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3018             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3019     12  DM-DIST-CODE                    PIC  X(04).
  3020     12  DM-MAIL-CODE                    PIC  X(05).
  3021     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3022     12  DM-INSURED-NAME                 PIC  X(30).
  3023     12  DM-CLAIM-NO                     PIC  X(07).
  3024     12  DM-CLAIM-TYPE                   PIC  X.
  3025
  3026     12  DM-STATUS-DATA-AREA.
  3027         16  DM-CLAIM-STATUS             PIC  X.
  3028             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL131.cbl
  3029             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3030             88  DM-CLOSED                        VALUE '3'.
  3031             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3032             88  DM-DEFAULT                       VALUE '9'.
  3033         16  DM-STATUS-DATE              PIC  X(08).
  3034******YYYYMMDD
  3035         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3036             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3037             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3038             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3039             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3040             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3041             88  DM-RE-OPENED                     VALUE 'R'.
  3042             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3043             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3044             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3045         16  DM-STAT-CARRIER             PIC X.
  3046
  3047     12  DM-DRAFT-DATA-AREA.
  3048         16  DM-PAYMENT-TYPE             PIC  X.
  3049             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3050         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3051         16  DM-PAYMENT-DATE             PIC  X(08).
  3052******YYYYMMDD
  3053         16  DM-CERT-NO                  PIC  X(11).
  3054         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3055         16  DM-CARRIER                  PIC  X.
  3056
  3057     12  DM-RETURN-CODE                  PIC  XX.
  3058
  3059****************************************************************
  3060*
  3061* Copyright (c) 2007 by Clerity Solutions, Inc.
  3062* All rights reserved.
  3063*
  3064****************************************************************
  3065 01  DFHEIV.
  3066   02  DFHEIV0               PIC X(35).
  3067   02  DFHEIV1               PIC X(08).
  3068   02  DFHEIV2               PIC X(08).
  3069   02  DFHEIV3               PIC X(08).
  3070   02  DFHEIV4               PIC X(06).
  3071   02  DFHEIV5               PIC X(04).
  3072   02  DFHEIV6               PIC X(04).
  3073   02  DFHEIV7               PIC X(02).
  3074   02  DFHEIV8               PIC X(02).
  3075   02  DFHEIV9               PIC X(01).
  3076   02  DFHEIV10              PIC S9(7) COMP-3.
  3077   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3078   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3079   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3080   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3081   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3082   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3083   02  DFHEIV17              PIC X(04).
  3084   02  DFHEIV18              PIC X(04).
  3085   02  DFHEIV19              PIC X(04).
  3086   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL131.cbl
  3087   02  DFHEIV21              USAGE IS POINTER.
  3088   02  DFHEIV22              USAGE IS POINTER.
  3089   02  DFHEIV23              USAGE IS POINTER.
  3090   02  DFHEIV24              USAGE IS POINTER.
  3091   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3092   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3093   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3094   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3095   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3096   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3097   02  FILLER                PIC X(02).
  3098   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3099   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3100   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3101   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3102   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3103 LINKAGE  SECTION.
  3104*****************************************************************
  3105*                                                               *
  3106* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3107* All rights reserved.                                          *
  3108*                                                               *
  3109*****************************************************************
  3110 01  dfheiblk.
  3111     02  eibtime          pic s9(7) comp-3.
  3112     02  eibdate          pic s9(7) comp-3.
  3113     02  eibtrnid         pic x(4).
  3114     02  eibtaskn         pic s9(7) comp-3.
  3115     02  eibtrmid         pic x(4).
  3116     02  dfheigdi         pic s9(4) comp.
  3117     02  eibcposn         pic s9(4) comp.
  3118     02  eibcalen         pic s9(4) comp.
  3119     02  eibaid           pic x(1).
  3120     02  eibfiller1       pic x(1).
  3121     02  eibfn            pic x(2).
  3122     02  eibfiller2       pic x(2).
  3123     02  eibrcode         pic x(6).
  3124     02  eibfiller3       pic x(2).
  3125     02  eibds            pic x(8).
  3126     02  eibreqid         pic x(8).
  3127     02  eibrsrce         pic x(8).
  3128     02  eibsync          pic x(1).
  3129     02  eibfree          pic x(1).
  3130     02  eibrecv          pic x(1).
  3131     02  eibsend          pic x(1).
  3132     02  eibatt           pic x(1).
  3133     02  eibeoc           pic x(1).
  3134     02  eibfmh           pic x(1).
  3135     02  eibcompl         pic x(1).
  3136     02  eibsig           pic x(1).
  3137     02  eibconf          pic x(1).
  3138     02  eiberr           pic x(1).
  3139     02  eibrldbk         pic x(1).
  3140     02  eiberrcd         pic x(4).
  3141     02  eibsynrb         pic x(1).
  3142     02  eibnodat         pic x(1).
  3143     02  eibfiller5       pic x(2).
  3144     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL131.cbl
  3145     02  eibresp2         pic 9(09) comp.
  3146     02  dfheigdj         pic s9(4) comp.
  3147     02  dfheigdk         pic s9(4) comp.
  3148 01  DFHCOMMAREA                 PIC X(1024).
  3149
  3150*                                COPY ELCMSTR.
  3151******************************************************************
  3152*                                                                *
  3153*                            ELCMSTR.                            *
  3154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3155*                            VMOD=2.012                          *
  3156*                                                                *
  3157*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3158*                                                                *
  3159*   FILE TYPE = VSAM,KSDS                                        *
  3160*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3161*                                                                *
  3162*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3163*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3164*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3165*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3166*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3167*                                                 RKP=75,LEN=21  *
  3168*                                                                *
  3169*   **** NOTE ****                                               *
  3170*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3171*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3172*                                                                *
  3173*   LOG = YES                                                    *
  3174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3175******************************************************************
  3176*                   C H A N G E   L O G
  3177*
  3178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3179*-----------------------------------------------------------------
  3180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3181* EFFECTIVE    NUMBER
  3182*-----------------------------------------------------------------
  3183* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3184* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3185******************************************************************
  3186 01  CLAIM-MASTER.
  3187     12  CL-RECORD-ID                PIC XX.
  3188         88  VALID-CL-ID         VALUE 'CL'.
  3189
  3190     12  CL-CONTROL-PRIMARY.
  3191         16  CL-COMPANY-CD           PIC X.
  3192         16  CL-CARRIER              PIC X.
  3193         16  CL-CLAIM-NO             PIC X(7).
  3194         16  CL-CERT-NO.
  3195             20  CL-CERT-PRIME       PIC X(10).
  3196             20  CL-CERT-SFX         PIC X.
  3197
  3198     12  CL-CONTROL-BY-NAME.
  3199         16  CL-COMPANY-CD-A1        PIC X.
  3200         16  CL-INSURED-LAST-NAME    PIC X(15).
  3201         16  CL-INSURED-NAME.
  3202             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL131.cbl
  3203             20  CL-INSURED-MID-INIT PIC X.
  3204
  3205     12  CL-CONTROL-BY-SSN.
  3206         16  CL-COMPANY-CD-A2        PIC X.
  3207         16  CL-SOC-SEC-NO.
  3208             20  CL-SSN-STATE        PIC XX.
  3209             20  CL-SSN-ACCOUNT      PIC X(6).
  3210             20  CL-SSN-LN3          PIC X(3).
  3211
  3212     12  CL-CONTROL-BY-CERT-NO.
  3213         16  CL-COMPANY-CD-A4        PIC X.
  3214         16  CL-CERT-NO-A4.
  3215             20  CL-CERT-A4-PRIME    PIC X(10).
  3216             20  CL-CERT-A4-SFX      PIC X.
  3217
  3218     12  CL-CONTROL-BY-CCN.
  3219         16  CL-COMPANY-CD-A5        PIC X.
  3220         16  CL-CCN-A5.
  3221             20  CL-CCN.
  3222                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3223                 24  CL-CCN-PRIME-A5 PIC X(12).
  3224             20  CL-CCN-FILLER-A5    PIC X(4).
  3225
  3226     12  CL-INSURED-PROFILE-DATA.
  3227         16  CL-INSURED-BIRTH-DT     PIC XX.
  3228         16  CL-INSURED-SEX-CD       PIC X.
  3229             88  INSURED-IS-MALE        VALUE 'M'.
  3230             88  INSURED-IS-FEMALE      VALUE 'F'.
  3231             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3232         16  CL-INSURED-OCC-CD       PIC X(6).
  3233         16  FILLER                  PIC X(5).
  3234
  3235     12  CL-PROCESSING-INFO.
  3236         16  CL-PROCESSOR-ID         PIC X(4).
  3237         16  CL-CLAIM-STATUS         PIC X.
  3238             88  CLAIM-IS-OPEN          VALUE 'O'.
  3239             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3240         16  CL-CLAIM-TYPE           PIC X.
  3241*            88  AH-CLAIM               VALUE 'A'.
  3242*            88  LIFE-CLAIM             VALUE 'L'.
  3243*            88  PROPERTY-CLAIM         VALUE 'P'.
  3244*            88  IUI-CLAIM              VALUE 'I'.
  3245*            88  GAP-CLAIM              VALUE 'G'.
  3246         16  CL-CLAIM-PREM-TYPE      PIC X.
  3247             88  SINGLE-PREMIUM         VALUE '1'.
  3248             88  O-B-COVERAGE           VALUE '2'.
  3249             88  OPEN-END-COVERAGE      VALUE '3'.
  3250         16  CL-INCURRED-DT          PIC XX.
  3251         16  CL-REPORTED-DT          PIC XX.
  3252         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3253         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3254         16  CL-LAST-PMT-DT          PIC XX.
  3255         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3256         16  CL-PAID-THRU-DT         PIC XX.
  3257         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3258         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3259         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3260         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL131.cbl
  3261             88  CL-360-DAY-YR          VALUE '1'.
  3262             88  CL-365-DAY-YR          VALUE '2'.
  3263             88  CL-FULL-MONTHS         VALUE '3'.
  3264         16  CL-CAUSE-CD             PIC X(6).
  3265
  3266         16  CL-PRIME-CERT-NO.
  3267             20  CL-PRIME-CERT-PRIME PIC X(10).
  3268             20  CL-PRIME-CERT-SFX   PIC X.
  3269
  3270         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3271             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3272             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3273
  3274         16  CL-MICROFILM-NO         PIC X(10).
  3275         16  CL-PROG-FORM-TYPE       PIC X.
  3276         16  CL-LAST-ADD-ON-DT       PIC XX.
  3277
  3278         16  CL-LAST-REOPEN-DT       PIC XX.
  3279         16  CL-LAST-CLOSE-DT        PIC XX.
  3280         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3281             88  FINAL-PAID             VALUE '1'.
  3282             88  CLAIM-DENIED           VALUE '2'.
  3283             88  AUTO-CLOSE             VALUE '3'.
  3284             88  MANUAL-CLOSE           VALUE '4'.
  3285             88  BENEFITS-CHANGED       VALUE 'C'.
  3286             88  SETUP-ERRORS           VALUE 'E'.
  3287         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3288         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3289         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3290             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3291         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3292         16  FILLER                  PIC X.
  3293
  3294     12  CL-CERTIFICATE-DATA.
  3295         16  CL-CERT-ORIGIN          PIC X.
  3296             88  CERT-WAS-ONLINE        VALUE '1'.
  3297             88  CERT-WAS-CREATED       VALUE '2'.
  3298             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3299         16  CL-CERT-KEY-DATA.
  3300             20  CL-CERT-CARRIER     PIC X.
  3301             20  CL-CERT-GROUPING    PIC X(6).
  3302             20  CL-CERT-STATE       PIC XX.
  3303             20  CL-CERT-ACCOUNT.
  3304                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3305                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3306             20  CL-CERT-EFF-DT      PIC XX.
  3307
  3308     12  CL-STATUS-CONTROLS.
  3309         16  CL-PRIORITY-CD          PIC X.
  3310             88  CONFIDENTIAL-DATA      VALUE '8'.
  3311             88  HIGHEST-PRIORITY       VALUE '9'.
  3312         16  CL-SUPV-ATTN-CD         PIC X.
  3313             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3314             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3315         16  CL-PURGED-DT            PIC XX.
  3316         16  CL-RESTORED-DT          PIC XX.
  3317         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3318         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL131.cbl
  3319         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3320         16  FILLER                  PIC XX.
  3321         16  CL-LAST-MAINT-DT        PIC XX.
  3322         16  CL-LAST-MAINT-USER      PIC X(4).
  3323         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3324         16  CL-LAST-MAINT-TYPE      PIC X.
  3325             88  CLAIM-SET-UP           VALUE ' '.
  3326             88  PAYMENT-MADE           VALUE '1'.
  3327             88  LETTER-SENT            VALUE '2'.
  3328             88  MASTER-WAS-ALTERED     VALUE '3'.
  3329             88  MASTER-WAS-RESTORED    VALUE '4'.
  3330             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3331             88  FILE-CONVERTED         VALUE '6'.
  3332             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3333             88  ERROR-CORRECTION       VALUE 'E'.
  3334         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3335         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3336         16  CL-BENEFICIARY          PIC X(10).
  3337         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3338         16  CL-DENIAL-TYPE          PIC X.
  3339             88  CL-TYPE-DENIAL          VALUE '1'.
  3340             88  CL-TYPE-RESCISSION      VALUE '2'.
  3341             88  CL-TYPE-REFORMATION     VALUE '3'.
  3342             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3343             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3344         16  FILLER                  PIC X(5).
  3345
  3346     12  CL-TRAILER-CONTROLS.
  3347         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3348             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3349             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3350             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3351         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3352         16  FILLER                  PIC XX.
  3353         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3354         16  CL-ADDRESS-TRAILER-CNT.
  3355             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3356                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3357             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3358                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3359             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3360                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3361             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3362                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3363             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3364                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3365             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3366                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3367             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3368                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3369
  3370     12  CL-CV-REFERENCE-NO.
  3371         16  CL-CV-REFNO-PRIME       PIC X(18).
  3372         16  CL-CV-REFNO-SFX         PIC XX.
  3373
  3374     12  CL-FILE-LOCATION            PIC X(4).
  3375
  3376     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL131.cbl
  3377         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3378             88  NO-FATAL-ERRORS        VALUE ZERO.
  3379         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3380             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3381
  3382     12  CL-PRODUCT-CD               PIC X.
  3383
  3384     12  CL-CURRENT-KEY-DATA.
  3385         16  CL-CURRENT-CARRIER      PIC X.
  3386         16  CL-CURRENT-GROUPING     PIC X(6).
  3387         16  CL-CURRENT-STATE        PIC XX.
  3388         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3389
  3390     12  CL-ASSOCIATES               PIC X.
  3391         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3392         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3393         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3394         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3395
  3396     12  CL-ACTIVITY-CODE            PIC 99.
  3397     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3398     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3399
  3400     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3401     12  CL-LAG-REPORT-CODE          PIC 9.
  3402     12  CL-LOAN-TYPE                PIC XX.
  3403     12  CL-LEGAL-STATE              PIC XX.
  3404
  3405*    12  FILLER                      PIC X(5).
  3406     12  CL-YESNOSW                  PIC X.
  3407     12  FILLER                      PIC X(4).
  3408
  3409*                                COPY ELCCERT.
  3410******************************************************************
  3411*                                                                *
  3412*                            ELCCERT.                            *
  3413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3414*                            VMOD=2.013                          *
  3415*                                                                *
  3416*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3417*                                                                *
  3418*   FILE TYPE = VSAM,KSDS                                        *
  3419*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3420*                                                                *
  3421*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3422*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3423*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3424*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3425*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3426*                                                                *
  3427*   LOG = YES                                                    *
  3428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3429******************************************************************
  3430*                   C H A N G E   L O G
  3431*
  3432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3433*-----------------------------------------------------------------
  3434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL131.cbl
  3435* EFFECTIVE    NUMBER
  3436*-----------------------------------------------------------------
  3437* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3438* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3439* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3440* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3441* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3442* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3443* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3444* 032612  CR2011110200001  PEMA  AHL CHANGES
  3445******************************************************************
  3446
  3447 01  CERTIFICATE-MASTER.
  3448     12  CM-RECORD-ID                      PIC XX.
  3449         88  VALID-CM-ID                      VALUE 'CM'.
  3450
  3451     12  CM-CONTROL-PRIMARY.
  3452         16  CM-COMPANY-CD                 PIC X.
  3453         16  CM-CARRIER                    PIC X.
  3454         16  CM-GROUPING.
  3455             20  CM-GROUPING-PREFIX        PIC X(3).
  3456             20  CM-GROUPING-PRIME         PIC X(3).
  3457         16  CM-STATE                      PIC XX.
  3458         16  CM-ACCOUNT.
  3459             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3460             20  CM-ACCOUNT-PRIME          PIC X(6).
  3461         16  CM-CERT-EFF-DT                PIC XX.
  3462         16  CM-CERT-NO.
  3463             20  CM-CERT-PRIME             PIC X(10).
  3464             20  CM-CERT-SFX               PIC X.
  3465
  3466     12  CM-CONTROL-BY-NAME.
  3467         16  CM-COMPANY-CD-A1              PIC X.
  3468         16  CM-INSURED-LAST-NAME          PIC X(15).
  3469         16  CM-INSURED-INITIALS.
  3470             20  CM-INSURED-INITIAL1       PIC X.
  3471             20  CM-INSURED-INITIAL2       PIC X.
  3472
  3473     12  CM-CONTROL-BY-SSN.
  3474         16  CM-COMPANY-CD-A2              PIC X.
  3475         16  CM-SOC-SEC-NO.
  3476             20  CM-SSN-STATE              PIC XX.
  3477             20  CM-SSN-ACCOUNT            PIC X(6).
  3478             20  CM-SSN-LN3.
  3479                 25  CM-INSURED-INITIALS-A2.
  3480                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3481                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3482                 25 CM-PART-LAST-NAME-A2         PIC X.
  3483
  3484     12  CM-CONTROL-BY-CERT-NO.
  3485         16  CM-COMPANY-CD-A4              PIC X.
  3486         16  CM-CERT-NO-A4                 PIC X(11).
  3487
  3488     12  CM-CONTROL-BY-MEMB.
  3489         16  CM-COMPANY-CD-A5              PIC X.
  3490         16  CM-MEMBER-NO.
  3491             20  CM-MEMB-STATE             PIC XX.
  3492             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL131.cbl
  3493             20  CM-MEMB-LN4.
  3494                 25  CM-INSURED-INITIALS-A5.
  3495                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3496                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3497                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3498
  3499     12  CM-INSURED-PROFILE-DATA.
  3500         16  CM-INSURED-FIRST-NAME.
  3501             20  CM-INSURED-1ST-INIT       PIC X.
  3502             20  FILLER                    PIC X(9).
  3503         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3504         16  CM-INSURED-SEX                PIC X.
  3505             88  CM-SEX-MALE                  VALUE 'M'.
  3506             88  CM-SEX-FEMAL                 VALUE 'F'.
  3507         16  CM-INSURED-JOINT-AGE          PIC 99.
  3508         16  CM-JOINT-INSURED-NAME.
  3509             20  CM-JT-LAST-NAME           PIC X(15).
  3510             20  CM-JT-FIRST-NAME.
  3511                 24  CM-JT-1ST-INIT        PIC X.
  3512                 24  FILLER                PIC X(9).
  3513             20  CM-JT-INITIAL             PIC X.
  3514
  3515     12  CM-LIFE-DATA.
  3516         16  CM-LF-BENEFIT-CD              PIC XX.
  3517         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3518         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3519         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3520         16  CM-LF-DEV-CODE                PIC XXX.
  3521         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3522         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3523         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3524         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3525         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3526         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3527         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3528         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3529         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3530         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3531         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3532         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3533         16  FILLER                        PIC XX.
  3534
  3535     12  CM-AH-DATA.
  3536         16  CM-AH-BENEFIT-CD              PIC XX.
  3537         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3538         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3539         16  CM-AH-DEV-CODE                PIC XXX.
  3540         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3541         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3542         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3543         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3544         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3545         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3546         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3547         16  CM-AH-PAID-THRU-DT            PIC XX.
  3548             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3549         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3550         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL131.cbl
  3551         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3552         16  FILLER                        PIC X.
  3553
  3554     12  CM-LOAN-INFORMATION.
  3555         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3556         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3557                                           PIC S9(5)V99  COMP-3.
  3558         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3559         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3560         16  CM-PAY-FREQUENCY              PIC S99.
  3561         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3562         16  CM-RATE-CLASS                 PIC XX.
  3563         16  CM-BENEFICIARY                PIC X(25).
  3564         16  CM-POLICY-FORM-NO             PIC X(12).
  3565         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3566         16  CM-LAST-ADD-ON-DT             PIC XX.
  3567         16  CM-DEDUCTIBLE-AMOUNTS.
  3568             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3569             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3570         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3571             20  CM-RESIDENT-STATE         PIC XX.
  3572             20  CM-RATE-CODE              PIC X(4).
  3573             20  FILLER                    PIC XX.
  3574         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3575             20  CM-LOAN-OFFICER           PIC X(5).
  3576             20  FILLER                    PIC XXX.
  3577         16  CM-CSR-CODE                   PIC XXX.
  3578         16  CM-UNDERWRITING-CODE          PIC X.
  3579             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3580         16  CM-POST-CARD-IND              PIC X.
  3581         16  CM-NH-INTERFACE-SW            PIC X.
  3582         16  CM-PREMIUM-TYPE               PIC X.
  3583             88  CM-SING-PRM                  VALUE '1'.
  3584             88  CM-O-B-COVERAGE              VALUE '2'.
  3585             88  CM-OPEN-END                  VALUE '3'.
  3586         16  CM-IND-GRP-TYPE               PIC X.
  3587             88  CM-INDIVIDUAL                VALUE 'I'.
  3588             88  CM-GROUP                     VALUE 'G'.
  3589         16  CM-SKIP-CODE                  PIC X.
  3590             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3591             88  SKIP-JULY                    VALUE '1'.
  3592             88  SKIP-AUGUST                  VALUE '2'.
  3593             88  SKIP-SEPTEMBER               VALUE '3'.
  3594             88  SKIP-JULY-AUG                VALUE '4'.
  3595             88  SKIP-AUG-SEPT                VALUE '5'.
  3596             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3597             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3598             88  SKIP-JUNE                    VALUE '8'.
  3599             88  SKIP-JUNE-JULY               VALUE '9'.
  3600             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3601             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3602         16  CM-PAYMENT-MODE               PIC X.
  3603             88  PAY-MONTHLY                  VALUE SPACE.
  3604             88  PAY-WEEKLY                   VALUE '1'.
  3605             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3606             88  PAY-BI-WEEKLY                VALUE '3'.
  3607             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3608         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL131.cbl
  3609         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3610         16  CM-OLD-LOF                    PIC XXX.
  3611*        16  CM-LOAN-OFFICER               PIC XXX.
  3612         16  CM-REIN-TABLE                 PIC XXX.
  3613         16  CM-SPECIAL-REIN-CODE          PIC X.
  3614         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3615         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3616         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3617
  3618     12  CM-STATUS-DATA.
  3619         16  CM-ENTRY-STATUS               PIC X.
  3620         16  CM-ENTRY-DT                   PIC XX.
  3621
  3622         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3623         16  CM-LF-CANCEL-DT               PIC XX.
  3624         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3625
  3626         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3627         16  CM-LF-DEATH-DT                PIC XX.
  3628         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3629
  3630         16  CM-LF-CURRENT-STATUS          PIC X.
  3631             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3632                                                'M' '4' '5' '9'.
  3633             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3634             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3635             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3636             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3637             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3638             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3639             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3640             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3641             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3642             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3643             88  CM-LF-DECLINED               VALUE 'D'.
  3644             88  CM-LF-VOIDED                 VALUE 'V'.
  3645
  3646         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3647         16  CM-AH-CANCEL-DT               PIC XX.
  3648         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3649
  3650         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3651         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3652         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3653
  3654         16  CM-AH-CURRENT-STATUS          PIC X.
  3655             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3656                                                'M' '4' '5' '9'.
  3657             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3658             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3659             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3660             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3661             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3662             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3663             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3664             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3665             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3666             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL131.cbl
  3667             88  CM-AH-DECLINED               VALUE 'D'.
  3668             88  CM-AH-VOIDED                 VALUE 'V'.
  3669
  3670         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3671             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3672             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3673             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3674         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3675
  3676         16  CM-ENTRY-BATCH                PIC X(6).
  3677         16  CM-LF-EXIT-BATCH              PIC X(6).
  3678         16  CM-AH-EXIT-BATCH              PIC X(6).
  3679         16  CM-LAST-MONTH-END             PIC XX.
  3680
  3681     12  CM-NOTE-SW                        PIC X.
  3682         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3683         88  CERT-NOTES-PRESENT               VALUE '1'.
  3684         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3685         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3686         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3687         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3688         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3689         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3690     12  CM-COMP-EXCP-SW                   PIC X.
  3691         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3692         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3693     12  CM-INSURED-ADDRESS-SW             PIC X.
  3694         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3695         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3696
  3697*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3698     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3699     12  FILLER                            PIC X.
  3700
  3701*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3702     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3703     12  FILLER                            PIC X.
  3704*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3705     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3706
  3707     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3708         88  CERT-ADDED-BATCH                 VALUE ' '.
  3709         88  CERT-ADDED-ONLINE                VALUE '1'.
  3710         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3711         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3712         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3713     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3714         88  CERT-AS-LOADED                   VALUE ' '.
  3715         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3716         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3717         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3718         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3719         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3720         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3721         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3722
  3723     12  CM-ACCOUNT-COMM-PCTS.
  3724         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL131.cbl
  3725         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3726
  3727     12  CM-USER-FIELD                     PIC X.
  3728     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3729     12  CM-CLP-STATE                      PIC XX.
  3730     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3731     12  CM-USER-RESERVED                  PIC XXX.
  3732     12  FILLER REDEFINES CM-USER-RESERVED.
  3733         16  CM-AH-CLASS-CD                PIC XX.
  3734         16  F                             PIC X.
  3735******************************************************************
  3736
  3737*                                COPY ELCTRLR.
  3738******************************************************************
  3739*                                                                *
  3740*                            ELCTRLR.                            *
  3741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3742*                            VMOD=2.014                          *
  3743*                                                                *
  3744*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3745*                                                                *
  3746*   FILE TYPE = VSAM,KSDS                                        *
  3747*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3748*                                                                *
  3749*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3750*       ALTERNATE INDEX = NONE                                   *
  3751*                                                                *
  3752*   LOG = YES                                                    *
  3753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3754******************************************************************
  3755*                   C H A N G E   L O G
  3756*
  3757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3758*-----------------------------------------------------------------
  3759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3760* EFFECTIVE    NUMBER
  3761*-----------------------------------------------------------------
  3762* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3763* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3764* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3765* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3766* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3767* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3768* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3769* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3770* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3771* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3772* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3773* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3774* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  3775******************************************************************
  3776 01  ACTIVITY-TRAILERS.
  3777     12  AT-RECORD-ID                    PIC XX.
  3778         88  VALID-AT-ID                       VALUE 'AT'.
  3779
  3780     12  AT-CONTROL-PRIMARY.
  3781         16  AT-COMPANY-CD               PIC X.
  3782         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL131.cbl
  3783         16  AT-CLAIM-NO                 PIC X(7).
  3784         16  AT-CERT-NO.
  3785             20  AT-CERT-PRIME           PIC X(10).
  3786             20  AT-CERT-SFX             PIC X.
  3787         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3788             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3789             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3790             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3791             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3792             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3793             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3794             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3795             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  3796             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3797             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3798             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3799             88  AT-BENEFICIARY-TRL           VALUE +91.
  3800             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3801             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  3802
  3803     12  AT-TRAILER-TYPE                 PIC X.
  3804         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3805         88  PAYMENT-TR                       VALUE '2'.
  3806         88  AUTO-PAY-TR                      VALUE '3'.
  3807         88  CORRESPONDENCE-TR                VALUE '4'.
  3808         88  ADDRESS-TR                       VALUE '5'.
  3809         88  GENERAL-INFO-TR                  VALUE '6'.
  3810         88  AUTO-PROMPT-TR                   VALUE '7'.
  3811         88  DENIAL-TR                        VALUE '8'.
  3812         88  INCURRED-CHG-TR                  VALUE '9'.
  3813         88  FORM-CONTROL-TR                  VALUE 'A'.
  3814
  3815     12  AT-RECORDED-DT                  PIC XX.
  3816     12  AT-RECORDED-BY                  PIC X(4).
  3817     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3818
  3819     12  AT-TRAILER-BODY                 PIC X(165).
  3820
  3821     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3822         16  AT-RESERVE-CONTROLS.
  3823             20  AT-MANUAL-SW            PIC X.
  3824                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3825             20  AT-FUTURE-SW            PIC X.
  3826                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3827             20  AT-PTC-SW               PIC X.
  3828                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3829             20  AT-IBNR-SW              PIC X.
  3830                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3831             20  AT-PTC-LF-SW            PIC X.
  3832                 88  AT-LF-PTC-USED          VALUE '1'.
  3833             20  AT-CDT-ACCESS-METHOD    PIC X.
  3834                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3835                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3836                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3837             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  3838         16  AT-LAST-COMPUTED-DT         PIC XX.
  3839         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3840         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL131.cbl
  3841         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3842         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3843         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3844         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3845         16  AT-EXPENSE-CONTROLS.
  3846             20  AT-EXPENSE-METHOD       PIC X.
  3847                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3848                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3849                 88  PERCENT-OF-PMT           VALUE '3'.
  3850                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3851             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3852             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3853         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3854         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  3855
  3856         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  3857         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  3858
  3859*        16  FILLER                      PIC X(53).
  3860         16  FILLER                      PIC X(47).
  3861
  3862         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  3863         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  3864
  3865         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  3866             20  AT-OPEN-CLOSE-DATE      PIC XX.
  3867             20  AT-OPEN-CLOSE-TYPE      PIC X.
  3868*                    C = CLOSED
  3869*                    O = OPEN
  3870             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  3871*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  3872
  3873     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  3874         16  AT-PAYMENT-TYPE             PIC X.
  3875             88  PARTIAL-PAYMENT                VALUE '1'.
  3876             88  FINAL-PAYMENT                  VALUE '2'.
  3877             88  LUMP-SUM-PAYMENT               VALUE '3'.
  3878             88  ADDITIONAL-PAYMENT             VALUE '4'.
  3879             88  CHARGEABLE-EXPENSE             VALUE '5'.
  3880             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  3881             88  VOIDED-PAYMENT                 VALUE '9'.
  3882             88  TRANSFER                       VALUE 'T'.
  3883             88  LIFE-INTEREST                  VALUE 'I'.
  3884
  3885         16  AT-CLAIM-TYPE               PIC X.
  3886             88  PAID-FOR-AH                    VALUE 'A'.
  3887             88  PAID-FOR-LIFE                  VALUE 'L'.
  3888             88  PAID-FOR-IUI                   VALUE 'I'.
  3889             88  PAID-FOR-GAP                   VALUE 'G'.
  3890         16  AT-CLAIM-PREM-TYPE          PIC X.
  3891             88  AT-SINGLE-PREMIUM              VALUE '1'.
  3892             88  AT-O-B-COVERAGE                VALUE '2'.
  3893             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  3894         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  3895         16  AT-CHECK-NO                 PIC X(7).
  3896         16  AT-PAID-FROM-DT             PIC XX.
  3897         16  AT-PAID-THRU-DT             PIC XX.
  3898         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL131.cbl
  3899         16  FILLER                      PIC X.
  3900         16  AT-PAYEES-NAME              PIC X(30).
  3901         16  AT-PAYMENT-ORIGIN           PIC X.
  3902             88  ONLINE-MANUAL-PMT              VALUE '1'.
  3903             88  ONLINE-AUTO-PMT                VALUE '2'.
  3904             88  OFFLINE-PMT                    VALUE '3'.
  3905         16  AT-CHECK-WRITTEN-DT         PIC XX.
  3906         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  3907         16  AT-VOID-DATA.
  3908             20  AT-VOID-DT              PIC XX.
  3909*00144       20  AT-VOID-REASON          PIC X(30).
  3910             20  AT-VOID-REASON          PIC X(26).
  3911         16  AT-PMT-APPROVED-BY          PIC X(04).
  3912         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  3913         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  3914         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  3915                                         PIC S99V9(5)  COMP-3.
  3916         16  AT-CREDIT-INTERFACE.
  3917             20  AT-PMT-SELECT-DT        PIC XX.
  3918                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  3919             20  AT-PMT-ACCEPT-DT        PIC XX.
  3920                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  3921             20  AT-VOID-SELECT-DT       PIC XX.
  3922                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  3923             20  AT-VOID-ACCEPT-DT       PIC XX.
  3924                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  3925
  3926         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  3927                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3928                 88  CONVERSION-PAYMENT           VALUE +99999999.
  3929         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  3930
  3931         16  AT-FORCE-CONTROL            PIC X.
  3932             88  PAYMENT-WAS-FORCED           VALUE '1'.
  3933         16  AT-PREV-LAST-PMT-DT         PIC XX.
  3934         16  AT-PREV-PAID-THRU-DT        PIC XX.
  3935         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3936         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  3937         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  3938         16  AT-BENEFIT-TYPE             PIC X.
  3939
  3940         16  AT-EXPENSE-TYPE             PIC X.
  3941         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  3942
  3943         16  AT-PAYEE-TYPE-CD.
  3944             20  AT-PAYEE-TYPE           PIC X.
  3945                 88  INSURED-PAID           VALUE 'I'.
  3946                 88  BENEFICIARY-PAID       VALUE 'B'.
  3947                 88  ACCOUNT-PAID           VALUE 'A'.
  3948                 88  OTHER-1-PAID           VALUE 'O'.
  3949                 88  OTHER-2-PAID           VALUE 'Q'.
  3950                 88  DOCTOR-PAID            VALUE 'P'.
  3951                 88  EMPLOYER-PAID          VALUE 'E'.
  3952             20  AT-PAYEE-SEQ            PIC X.
  3953
  3954         16  AT-CASH-PAYMENT             PIC X.
  3955         16  AT-GROUPED-PAYMENT          PIC X.
  3956         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL131.cbl
  3957         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  3958         16  AT-APPROVED-LEVEL           PIC X.
  3959         16  AT-VOID-TYPE                PIC X.
  3960             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  3961             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  3962         16  AT-AIG-UNEMP-IND            PIC X.
  3963             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  3964         16  AT-ASSOCIATES               PIC X.
  3965             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  3966             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  3967
  3968         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  3969         16  AT-CV-PMT-CODE              PIC X.
  3970             88  FULL-DEATH-PAYMENT         VALUE '1'.
  3971             88  HALF-DEATH-PAYMENT         VALUE '2'.
  3972             88  FULL-ADD-PAYMENT           VALUE '3'.
  3973             88  HALF-ADD-PAYMENT           VALUE '4'.
  3974             88  FULL-RIDER-PAYMENT         VALUE '5'.
  3975             88  HALF-RIDER-PAYMENT         VALUE '6'.
  3976             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  3977             88  ADDL-PAYMENT               VALUE '8'.
  3978
  3979         16  AT-EOB-CODE1                PIC XXX.
  3980         16  AT-EOB-CODE2                PIC XXX.
  3981         16  AT-EOB-CODE3                PIC XXX.
  3982         16  AT-EOB-CODE4                PIC XXX.
  3983         16  FILLER REDEFINES AT-EOB-CODE4.
  3984             20  AT-INT-PMT-SELECT-DT    PIC XX.
  3985             20  FILLER                  PIC X.
  3986         16  AT-EOB-CODE5                PIC XXX.
  3987         16  FILLER REDEFINES AT-EOB-CODE5.
  3988             20  AT-PMT-PROOF-DT         PIC XX.
  3989             20  FILLER                  PIC X.
  3990
  3991         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  3992             88  AT-PRINT-EOB            VALUE 'Y'.
  3993
  3994         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  3995         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  3996
  3997     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  3998         16  AT-SCHEDULE-START-DT        PIC XX.
  3999         16  AT-SCHEDULE-END-DT          PIC XX.
  4000         16  AT-TERMINATED-DT            PIC XX.
  4001         16  AT-LAST-PMT-TYPE            PIC X.
  4002             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4003             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4004         16  AT-FIRST-PMT-DATA.
  4005             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4006             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4007             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4008         16  AT-REGULAR-PMT-DATA.
  4009             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4010             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4011             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4012         16  AT-AUTO-PAYEE-CD.
  4013             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4014                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL131.cbl
  4015                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4016                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4017                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4018                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4019             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4020         16  AT-AUTO-PAY-DAY             PIC 99.
  4021         16  AT-AUTO-CASH                PIC X.
  4022             88  AT-CASH                      VALUE 'Y'.
  4023             88  AT-NON-CASH                  VALUE 'N'.
  4024*        16  FILLER                      PIC X(129).
  4025         16  AT-AUTO-END-LETTER          PIC X(4).
  4026         16  FILLER                      PIC X(125).
  4027
  4028         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4029         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4030
  4031     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4032         16  AT-LETTER-SENT-DT           PIC XX.
  4033         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4034         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4035         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4036         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4037         16  AT-LETTER-ORIGIN            PIC X.
  4038             88  ONLINE-CREATION              VALUE '1' '3'.
  4039             88  OFFLINE-CREATION             VALUE '2' '4'.
  4040             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4041             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4042         16  AT-STD-LETTER-FORM          PIC X(4).
  4043         16  AT-REASON-TEXT              PIC X(70).
  4044         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4045         16  AT-ADDRESEE-TYPE            PIC X.
  4046              88  INSURED-ADDRESEE            VALUE 'I'.
  4047              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4048              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4049              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4050              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4051              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4052              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4053         16  AT-ADDRESSEE-NAME           PIC X(30).
  4054         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4055         16  AT-RESEND-PRINT-DATE        PIC XX.
  4056         16  AT-CORR-SOL-UNSOL           PIC X.
  4057         16  AT-LETTER-PURGED-DT         PIC XX.
  4058*
  4059*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4060*
  4061         16  AT-CSO-REDEFINITION.
  4062             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4063             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4064             20  AT-LETTER-TO-BENE       PIC X(1).
  4065             20  AT-STOP-LETTER-DT       PIC X(2).
  4066             20  FILLER                  PIC X(19).
  4067*             20  FILLER                  PIC X(27).
  4068             20  AT-CSO-LETTER-STATUS    PIC X.
  4069                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4070                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4071                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4072             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL131.cbl
  4073             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4074*
  4075*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4076*
  4077*        16  FILLER                      PIC X(26).
  4078*
  4079*        16  AT-DMD-BSR-CODE             PIC X.
  4080*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4081*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4082*
  4083*        16  AT-DMD-LETTER-STATUS        PIC X.
  4084*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4085*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4086*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4087*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4088*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4089
  4090         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4091         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4092
  4093     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4094         16  AT-ADDRESS-TYPE             PIC X.
  4095             88  INSURED-ADDRESS               VALUE 'I'.
  4096             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4097             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4098             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4099             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4100             88  OTHER-ADDRESS-1               VALUE 'O'.
  4101             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4102         16  AT-MAIL-TO-NAME             PIC X(30).
  4103         16  AT-ADDRESS-LINE-1           PIC X(30).
  4104         16  AT-ADDRESS-LINE-2           PIC X(30).
  4105         16  AT-CITY-STATE.
  4106             20  AT-CITY                 PIC X(28).
  4107             20  AT-STATE                PIC XX.
  4108         16  AT-ZIP.
  4109             20  AT-ZIP-CODE.
  4110                 24  AT-ZIP-1ST          PIC X.
  4111                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4112                 24  FILLER              PIC X(4).
  4113             20  AT-ZIP-PLUS4            PIC X(4).
  4114         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4115             20  AT-CAN-POSTAL-1         PIC XXX.
  4116             20  AT-CAN-POSTAL-2         PIC XXX.
  4117             20  FILLER                  PIC XXX.
  4118         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4119*         16  FILLER                      PIC X(23).
  4120         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4121         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4122         16  FILLER                      PIC X(13).
  4123         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4124         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4125
  4126     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4127         16  AT-INFO-LINE-1              PIC X(60).
  4128         16  AT-INFO-LINE-2              PIC X(60).
  4129         16  AT-INFO-TRAILER-TYPE        PIC X.
  4130             88  AT-PAYMENT-NOTE         VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL131.cbl
  4131             88  AT-CALL-NOTE            VALUE 'C'.
  4132             88  AT-MAINT-NOTE           VALUE 'M'.
  4133             88  AT-CERT-CHANGE          VALUE 'X'.
  4134             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4135             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4136         16  AT-CALL-TYPE                PIC X.
  4137             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4138             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4139         16  AT-NOTE-CONTINUATION        PIC X.
  4140             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4141         16  AT-EOB-CODES-EXIST          PIC X.
  4142             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4143         16  FILLER                      PIC X(35).
  4144         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4145         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4146
  4147     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4148         16  AT-PROMPT-LINE-1            PIC X(60).
  4149         16  AT-PROMPT-LINE-2            PIC X(60).
  4150         16  AT-PROMPT-START-DT          PIC XX.
  4151         16  AT-PROMPT-END-DT            PIC XX.
  4152         16  FILLER                      PIC X(35).
  4153         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4154         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4155
  4156     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4157         16  AT-DENIAL-INFO-1            PIC X(60).
  4158         16  AT-DENIAL-INFO-2            PIC X(60).
  4159         16  AT-DENIAL-DT                PIC XX.
  4160         16  AT-RETRACTION-DT            PIC XX.
  4161         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4162*         16  FILLER                      PIC X(31).
  4163         16  AT-DENIAL-PROOF-DT          PIC XX.
  4164         16  FILLER                      PIC X(29).
  4165         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4166         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4167
  4168     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4169         16  AT-OLD-INCURRED-DT          PIC XX.
  4170         16  AT-OLD-REPORTED-DT          PIC XX.
  4171         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4172         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4173         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4174         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4175         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4176         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4177         16  FILLER                      PIC X(26).
  4178         16  AT-OLD-DIAG-CODE            PIC X(6).
  4179         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4180         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4181         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4182         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4183         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4184         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4185         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4186         16  FILLER                      PIC X(25).
  4187         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4188
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL131.cbl
  4189     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4190         16  AT-FORM-SEND-ON-DT          PIC XX.
  4191         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4192         16  AT-FORM-RE-SEND-DT          PIC XX.
  4193         16  AT-FORM-ANSWERED-DT         PIC XX.
  4194         16  AT-FORM-PRINTED-DT          PIC XX.
  4195         16  AT-FORM-REPRINT-DT          PIC XX.
  4196         16  AT-FORM-TYPE                PIC X.
  4197             88  INITIAL-FORM                  VALUE '1'.
  4198             88  PROGRESS-FORM                 VALUE '2'.
  4199         16  AT-INSTRUCT-LN-1            PIC X(28).
  4200         16  AT-INSTRUCT-LN-2            PIC X(28).
  4201         16  AT-INSTRUCT-LN-3            PIC X(28).
  4202         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4203         16  AT-FORM-ADDRESS             PIC X.
  4204             88  FORM-TO-INSURED              VALUE 'I'.
  4205             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4206             88  FORM-TO-OTHER-1              VALUE 'O'.
  4207             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4208         16  AT-RELATED-1.
  4209             20 AT-REL-CARR-1            PIC X.
  4210             20 AT-REL-CLAIM-1           PIC X(7).
  4211             20 AT-REL-CERT-1            PIC X(11).
  4212         16  AT-RELATED-2.
  4213             20 AT-REL-CARR-2            PIC X.
  4214             20 AT-REL-CLAIM-2           PIC X(7).
  4215             20 AT-REL-CERT-2            PIC X(11).
  4216         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4217         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4218         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4219         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4220         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4221         16  AT-STOP-FORM-DT             PIC X(2).
  4222
  4223         16  FILLER                      PIC X(09).
  4224         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4225         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4226******************************************************************
  4227
  4228*                                COPY ELCCNTL.
  4229******************************************************************
  4230*                                                                *
  4231*                                                                *
  4232*                            ELCCNTL.                            *
  4233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4234*                            VMOD=2.059                          *
  4235*                                                                *
  4236*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4237*                                                                *
  4238*   FILE TYPE = VSAM,KSDS                                        *
  4239*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4240*                                                                *
  4241*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4242*       ALTERNATE INDEX = NONE                                   *
  4243*                                                                *
  4244*   LOG = YES                                                    *
  4245*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4246******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL131.cbl
  4247*                   C H A N G E   L O G
  4248*
  4249* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4250*-----------------------------------------------------------------
  4251*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4252* EFFECTIVE    NUMBER
  4253*-----------------------------------------------------------------
  4254* 082503                   PEMA  ADD BENEFIT GROUP
  4255* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4256* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4257* 092705    2005050300006  PEMA  ADD SPP LEASES
  4258* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4259* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4260* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4261* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4262* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4263******************************************************************
  4264*
  4265 01  CONTROL-FILE.
  4266     12  CF-RECORD-ID                       PIC XX.
  4267         88  VALID-CF-ID                        VALUE 'CF'.
  4268
  4269     12  CF-CONTROL-PRIMARY.
  4270         16  CF-COMPANY-ID                  PIC XXX.
  4271         16  CF-RECORD-TYPE                 PIC X.
  4272             88  CF-COMPANY-MASTER              VALUE '1'.
  4273             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4274             88  CF-STATE-MASTER                VALUE '3'.
  4275             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4276             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4277             88  CF-CARRIER-MASTER              VALUE '6'.
  4278             88  CF-MORTALITY-MASTER            VALUE '7'.
  4279             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4280             88  CF-TERMINAL-MASTER             VALUE '9'.
  4281             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4282             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4283             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4284             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4285             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4286             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4287             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4288             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4289             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4290         16  CF-ACCESS-CD-GENL              PIC X(4).
  4291         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4292             20  CF-PROCESSOR               PIC X(4).
  4293         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4294             20  CF-STATE-CODE              PIC XX.
  4295             20  FILLER                     PIC XX.
  4296         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4297             20  FILLER                     PIC XX.
  4298             20  CF-HI-BEN-IN-REC           PIC XX.
  4299         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4300             20  FILLER                     PIC XXX.
  4301             20  CF-CARRIER-CNTL            PIC X.
  4302         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4303             20  FILLER                     PIC XX.
  4304             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL131.cbl
  4305         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4306             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4307                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4308             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4309             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4310         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4311             20  FILLER                     PIC X.
  4312             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4313         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4314             20  FILLER                     PIC XX.
  4315             20  CF-MORTGAGE-PLAN           PIC XX.
  4316         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4317
  4318     12  CF-LAST-MAINT-DT                   PIC XX.
  4319     12  CF-LAST-MAINT-BY                   PIC X(4).
  4320     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4321
  4322     12  CF-RECORD-BODY                     PIC X(728).
  4323
  4324
  4325****************************************************************
  4326*             COMPANY MASTER RECORD                            *
  4327****************************************************************
  4328
  4329     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4330         16  CF-COMPANY-ADDRESS.
  4331             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4332             20  CF-CL-IN-CARE-OF           PIC X(30).
  4333             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4334             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4335             20  CF-CL-CITY-STATE           PIC X(30).
  4336             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4337             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4338         16  CF-COMPANY-CD                  PIC X.
  4339         16  CF-COMPANY-PASSWORD            PIC X(8).
  4340         16  CF-SECURITY-OPTION             PIC X.
  4341             88  ALL-SECURITY                   VALUE '1'.
  4342             88  COMPANY-VERIFY                 VALUE '2'.
  4343             88  PROCESSOR-VERIFY               VALUE '3'.
  4344             88  NO-SECURITY                    VALUE '4'.
  4345             88  ALL-BUT-TERM                   VALUE '5'.
  4346         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4347             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4348         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4349             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4350         16  CF-INFORCE-LOCATION            PIC X.
  4351             88  CERTS-ARE-ONLINE               VALUE '1'.
  4352             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4353             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4354         16  CF-LOWER-CASE-LETTERS          PIC X.
  4355         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4356             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4357             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4358             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4359             88  CF-ACCNT-CNTL                  VALUE '3'.
  4360             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4361
  4362         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL131.cbl
  4363         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4364
  4365         16  CF-LGX-CREDIT-USER             PIC X.
  4366             88  CO-IS-NOT-USER                 VALUE 'N'.
  4367             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4368
  4369         16 CF-CREDIT-CALC-CODES.
  4370             20  CF-CR-REM-TERM-CALC PIC X.
  4371               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4372               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4373               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4374               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4375               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4376               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4377               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4378             20  CF-CR-R78-METHOD           PIC X.
  4379               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4380               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4381
  4382         16  CF-CLAIM-CONTROL-COUNTS.
  4383             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4384                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4385
  4386             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4387                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4388
  4389             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4390                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4391
  4392             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4393                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4394
  4395         16  CF-CURRENT-MONTH-END           PIC XX.
  4396
  4397         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4398             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4399             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4400             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4401             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4402                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4403                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4404             20  CF-CO-PREM-REJECT-SW       PIC X.
  4405                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4406                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4407             20  CF-CO-REF-REJECT-SW        PIC X.
  4408                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4409                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4410
  4411         16  CF-CO-REPORTING-DT             PIC XX.
  4412         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4413         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4414           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4415           88  CF-CO-MONTH-END                  VALUE '1'.
  4416
  4417         16  CF-LGX-CLAIM-USER              PIC X.
  4418             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4419             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4420
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL131.cbl
  4421         16  CF-CREDIT-EDIT-CONTROLS.
  4422             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4423             20  CF-MIN-AGE                 PIC 99.
  4424             20  CF-DEFAULT-AGE             PIC 99.
  4425             20  CF-MIN-TERM                PIC S999      COMP-3.
  4426             20  CF-MAX-TERM                PIC S999      COMP-3.
  4427             20  CF-DEFAULT-SEX             PIC X.
  4428             20  CF-JOINT-AGE-INPUT         PIC X.
  4429                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4430             20  CF-BIRTH-DATE-INPUT        PIC X.
  4431                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4432             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4433                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4434                 88  CF-ZERO-CARRIER            VALUE '1'.
  4435                 88  CF-ZERO-GROUPING           VALUE '2'.
  4436                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4437             20  CF-EDIT-SW                 PIC X.
  4438                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4439             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4440             20  CF-CR-PR-METHOD            PIC X.
  4441               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4442               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4443             20  FILLER                     PIC X.
  4444
  4445         16  CF-CREDIT-MISC-CONTROLS.
  4446             20  CF-REIN-TABLE-SW           PIC X.
  4447                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4448             20  CF-COMP-TABLE-SW           PIC X.
  4449                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4450             20  CF-EXPERIENCE-RETENTION-AGE
  4451                                            PIC S9        COMP-3.
  4452             20  CF-CONVERSION-DT           PIC XX.
  4453             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4454             20  CF-RUN-FREQUENCY-SW        PIC X.
  4455                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4456                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4457
  4458             20  CF-CR-CHECK-NO-CONTROL.
  4459                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4460                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4461                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4462                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4463                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4464                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4465
  4466                 24  CF-CR-CHECK-COUNT       REDEFINES
  4467                     CF-CR-CHECK-COUNTER      PIC X(4).
  4468
  4469                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4470                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4471
  4472                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4473                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4474                 24  CF-MAIL-PROCESSING       PIC X.
  4475                     88  MAIL-PROCESSING          VALUE 'Y'.
  4476
  4477         16  CF-MISC-SYSTEM-CONTROL.
  4478             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL131.cbl
  4479                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4480             20  CF-SYSTEM-D                 PIC X.
  4481                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4482             20  CF-SOC-SEC-NO-SW            PIC X.
  4483                 88  SOC-SEC-NO-USED             VALUE '1'.
  4484             20  CF-MEMBER-NO-SW             PIC X.
  4485                 88  MEMBER-NO-USED              VALUE '1'.
  4486             20  CF-TAX-ID-NUMBER            PIC X(11).
  4487             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4488             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4489                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4490                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4491                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4492                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4493             20  CF-SYSTEM-E                 PIC X.
  4494                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4495
  4496         16  CF-LGX-LIFE-USER               PIC X.
  4497             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4498             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4499
  4500         16  CF-CR-MONTH-END-DT             PIC XX.
  4501
  4502         16  CF-FILE-MAINT-DATES.
  4503             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4504                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4505             20  CF-LAST-BATCH       REDEFINES
  4506                 CF-LAST-BATCH-NO               PIC X(4).
  4507             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4508             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4509             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4510             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4511             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4512             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4513             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4514             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4515             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4516             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4517
  4518         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4519         16  FILLER                         PIC X.
  4520
  4521         16  CF-ALT-MORT-CODE               PIC X(4).
  4522         16  CF-MEMBER-CAPTION              PIC X(10).
  4523
  4524         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4525             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4526             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4527             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4528             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4529             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4530
  4531         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4532
  4533         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4534         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4535         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4536         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL131.cbl
  4537
  4538         16  CF-AH-OVERRIDE-L1              PIC X.
  4539         16  CF-AH-OVERRIDE-L2              PIC XX.
  4540         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4541         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4542
  4543         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4544         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4545
  4546         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4547         16  CF-AR-LAST-EL860-DT            PIC XX.
  4548         16  CF-MP-MONTH-END-DT             PIC XX.
  4549
  4550         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4551         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4552             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4553
  4554         16  CF-AR-MONTH-END-DT             PIC XX.
  4555
  4556         16  CF-CRDTCRD-USER                PIC X.
  4557             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4558             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4559
  4560         16  CF-CC-MONTH-END-DT             PIC XX.
  4561
  4562         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4563
  4564         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4565             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4566             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4567             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4568         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4569         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4570         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4571         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4572             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4573             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4574         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4575         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4576         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4577             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4578         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4579
  4580         16  CF-CL-ZIP-CODE.
  4581             20  CF-CL-ZIP-PRIME.
  4582                 24  CF-CL-ZIP-1ST          PIC X.
  4583                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4584                 24  FILLER                 PIC X(4).
  4585             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4586         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4587             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4588             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4589             20  FILLER                     PIC XXX.
  4590
  4591         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4592         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4593         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4594         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL131.cbl
  4595         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4596           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4597                                                      '3' '4'.
  4598           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4599           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4600           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4601           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4602           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4603           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4604
  4605         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4606
  4607         16  CF-PAYMENT-APPROVAL-LEVELS.
  4608             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4609             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4610             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4611             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4612             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4613             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4614
  4615         16  CF-END-USER-REPORTING-USER     PIC X.
  4616             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4617             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4618
  4619         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4620             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4621             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4622
  4623         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4624
  4625         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4626         16  FILLER                         PIC X.
  4627
  4628         16  CF-CREDIT-ARCHIVE-CNTL.
  4629             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4630             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4631             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4632
  4633         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4634
  4635         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4636             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4637             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4638
  4639         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4640             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4641             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4642
  4643         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4644
  4645         16  CF-CO-ACH-ID-CODE              PIC  X.
  4646             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4647             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4648             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4649         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4650         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4651         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4652         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL131.cbl
  4653         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4654         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4655         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4656         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4657         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4658                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4659         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4660                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4661
  4662         16  CF-CO-OVER-SHORT.
  4663             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4664             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4665
  4666*         16  FILLER                         PIC X(102).
  4667         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4668             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4669             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4670
  4671         16  CF-AH-APPROVAL-DAYS.
  4672             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4673             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4674             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4675             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4676
  4677         16  FILLER                         PIC X(82).
  4678****************************************************************
  4679*             PROCESSOR/USER RECORD                            *
  4680****************************************************************
  4681
  4682     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4683         16  CF-PROCESSOR-NAME              PIC X(30).
  4684         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4685         16  CF-PROCESSOR-TITLE             PIC X(26).
  4686         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4687                 88  MESSAGE-YES                VALUE 'Y'.
  4688                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4689
  4690*****************************************************
  4691****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4692****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4693****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4694****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4695*****************************************************
  4696
  4697         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4698             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4699             20  CF-APPLICATION-FORCE       PIC X.
  4700             20  CF-INDIVIDUAL-APP.
  4701                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4702                     28  CF-BROWSE-APP      PIC X.
  4703                     28  CF-UPDATE-APP      PIC X.
  4704
  4705         16  CF-CURRENT-TERM-ON             PIC X(4).
  4706         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4707             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4708             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4709             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4710             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL131.cbl
  4711             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4712             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4713             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4714         16  CF-PROCESSOR-CARRIER           PIC X.
  4715             88  NO-CARRIER-SECURITY            VALUE ' '.
  4716         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4717             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4718         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4719             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4720         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4721             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4722
  4723         16  CF-PROC-SYS-ACCESS-SW.
  4724             20  CF-PROC-CREDIT-CLAIMS-SW.
  4725                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4726                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4727                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4728                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4729             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4730                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4731                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4732             20  CF-PROC-LIFE-GNRLDGR-SW.
  4733                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4734                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4735                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4736                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4737             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4738                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4739                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4740         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4741             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4742             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4743         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4744
  4745         16  CF-APPROVAL-LEVEL                  PIC X.
  4746             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4747             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4748             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4749             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4750
  4751         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4752
  4753         16  CF-LANGUAGE-TYPE                   PIC X.
  4754             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4755             88  CF-LANG-IS-FR                      VALUE 'F'.
  4756         16  FILLER                             PIC  X(240).
  4757
  4758****************************************************************
  4759*             PROCESSOR/REMINDERS RECORD                       *
  4760****************************************************************
  4761
  4762     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4763         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4764             20  CF-START-REMIND-DT         PIC XX.
  4765             20  CF-END-REMIND-DT           PIC XX.
  4766             20  CF-REMINDER-TEXT           PIC X(50).
  4767         16  FILLER                         PIC X(296).
  4768
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL131.cbl
  4769
  4770****************************************************************
  4771*             STATE MASTER RECORD                              *
  4772****************************************************************
  4773
  4774     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4775         16  CF-STATE-ABBREVIATION          PIC XX.
  4776         16  CF-STATE-NAME                  PIC X(25).
  4777         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4778         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4779             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4780             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4781             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4782             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4783                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4784                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4785             20  CF-ST-PREM-REJECT-SW       PIC X.
  4786                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4787                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4788             20  CF-ST-REF-REJECT-SW        PIC X.
  4789                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4790                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4791         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4792         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4793         16  CF-ST-REFUND-RULES.
  4794             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4795             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4796             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4797         16  CF-ST-FST-PMT-EXTENSION.
  4798             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4799             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4800                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4801                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4802                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4803                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4804         16  CF-ST-STATE-CALL.
  4805             20  CF-ST-CALL-UNEARNED        PIC X.
  4806             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4807             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4808         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4809             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4810             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4811         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4812         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4813         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4814         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4815         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4816         16  FILLER                         PIC X.
  4817         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4818             20  CF-ST-BENEFIT-CD           PIC XX.
  4819             20  CF-ST-BENEFIT-KIND         PIC X.
  4820                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4821                 88  CF-ST-AH-KIND              VALUE 'A'.
  4822             20  CF-ST-REM-TERM-CALC        PIC X.
  4823                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4824                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4825                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4826                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL131.cbl
  4827                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4828                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4829                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4830                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4831
  4832             20  CF-ST-REFUND-CALC          PIC X.
  4833                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4834                 88  ST-REFD-BY-R78             VALUE '1'.
  4835                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4836                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4837                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4838                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4839                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4840                 88  ST-REFD-UTAH               VALUE '7'.
  4841                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4842                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4843                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4844
  4845             20  CF-ST-EARNING-CALC         PIC X.
  4846                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4847                 88  ST-EARN-BY-R78             VALUE '1'.
  4848                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4849                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4850                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4851                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4852                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4853                 88  ST-EARN-MEAN               VALUE '8'.
  4854                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4855
  4856             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4857                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4858                 88  ST-OVRD-BY-R78             VALUE '1'.
  4859                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4860                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4861                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4862                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4863                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4864                 88  ST-OVRD-MEAN               VALUE '8'.
  4865                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4866             20  FILLER                     PIC X.
  4867
  4868         16  CF-ST-COMMISSION-CAPS.
  4869             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4870             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4871             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4872             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4873         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4874                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4875
  4876         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4877
  4878         16  CF-ST-STATUTORY-INTEREST.
  4879             20  CF-ST-STAT-DATE-FROM       PIC X.
  4880                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4881                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4882             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4883             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4884             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL131.cbl
  4885             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4886             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4887
  4888         16  CF-ST-OVER-SHORT.
  4889             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4890             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4891
  4892         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4893
  4894         16  CF-ST-RT-CALC                  PIC X.
  4895
  4896         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4897         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4898         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4899         16  CF-ST-RF-LR-CALC               PIC X.
  4900         16  CF-ST-RF-LL-CALC               PIC X.
  4901         16  CF-ST-RF-LN-CALC               PIC X.
  4902         16  CF-ST-RF-AH-CALC               PIC X.
  4903         16  CF-ST-RF-CP-CALC               PIC X.
  4904*        16  FILLER                         PIC X(206).
  4905*CIDMOD         16  FILLER                         PIC X(192).
  4906         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4907             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4908         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4909         16  CF-ST-VFY-2ND-BENE             PIC X.
  4910         16  FILLER                         PIC X(186).
  4911
  4912****************************************************************
  4913*             BENEFIT MASTER RECORD                            *
  4914****************************************************************
  4915
  4916     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4917         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4918             20  CF-BENEFIT-CODE            PIC XX.
  4919             20  CF-BENEFIT-NUMERIC  REDEFINES
  4920                 CF-BENEFIT-CODE            PIC XX.
  4921             20  CF-BENEFIT-ALPHA           PIC XXX.
  4922             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4923             20  CF-BENEFIT-COMMENT         PIC X(10).
  4924
  4925             20  CF-LF-COVERAGE-TYPE        PIC X.
  4926                 88  CF-REDUCING                VALUE 'R'.
  4927                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4928
  4929             20  CF-SPECIAL-CALC-CD         PIC X.
  4930                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4931                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4932                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4933                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4934                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4935                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4936                 88  CF-FARM-PLAN               VALUE 'F'.
  4937                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4938                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4939                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4940                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4941                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4942                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL131.cbl
  4943                 88  CF-PRUDENTIAL              VALUE 'P'.
  4944                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4945                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4946                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4947                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4948                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4949                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4950
  4951             20  CF-JOINT-INDICATOR         PIC X.
  4952                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4953
  4954*            20  FILLER                     PIC X(12).
  4955             20  FILLER                     PIC X(11).
  4956             20  CF-BENEFIT-CATEGORY        PIC X.
  4957             20  CF-LOAN-TYPE               PIC X(8).
  4958
  4959             20  CF-CO-REM-TERM-CALC        PIC X.
  4960                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4961                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4962                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4963                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4964                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4965
  4966             20  CF-CO-EARNINGS-CALC        PIC X.
  4967                 88  CO-EARN-BY-R78             VALUE '1'.
  4968                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4969                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4970                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4971                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4972                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4973                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4974                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4975
  4976             20  CF-CO-REFUND-CALC          PIC X.
  4977                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4978                 88  CO-REFD-BY-R78             VALUE '1'.
  4979                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4980                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4981                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4982                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4983                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4984                 88  CO-REFD-MEAN               VALUE '8'.
  4985                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4986                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4987                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4988
  4989             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4990                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4991                 88  CO-OVRD-BY-R78             VALUE '1'.
  4992                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4993                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4994                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4995                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4996                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4997                 88  CO-OVRD-MEAN               VALUE '8'.
  4998                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4999
  5000             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL131.cbl
  5001                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5002                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5003                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5004
  5005         16  FILLER                         PIC X(304).
  5006
  5007
  5008****************************************************************
  5009*             CARRIER MASTER RECORD                            *
  5010****************************************************************
  5011
  5012     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5013         16  CF-ADDRESS-DATA.
  5014             20  CF-MAIL-TO-NAME            PIC X(30).
  5015             20  CF-IN-CARE-OF              PIC X(30).
  5016             20  CF-ADDRESS-LINE-1          PIC X(30).
  5017             20  CF-ADDRESS-LINE-2          PIC X(30).
  5018             20  CF-CITY-STATE              PIC X(30).
  5019             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5020             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5021
  5022         16  CF-CLAIM-NO-CONTROL.
  5023             20  CF-CLAIM-NO-METHOD         PIC X.
  5024                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5025                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5026                 88  CLAIM-NO-SEQ               VALUE '3'.
  5027                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5028             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5029                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5030                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5031                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5032
  5033         16  CF-CHECK-NO-CONTROL.
  5034             20  CF-CHECK-NO-METHOD         PIC X.
  5035                 88  CHECK-NO-MANUAL            VALUE '1'.
  5036                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5037                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5038                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5039             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5040                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5041
  5042         16  CF-DOMICILE-STATE              PIC XX.
  5043
  5044         16  CF-EXPENSE-CONTROLS.
  5045             20  CF-EXPENSE-METHOD          PIC X.
  5046                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5047                 88  DOLLARS-PER-PMT            VALUE '2'.
  5048                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5049                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5050             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5051             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5052
  5053         16  CF-CORRESPONDENCE-CONTROL.
  5054             20  CF-LETTER-RESEND-OPT       PIC X.
  5055                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5056                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5057             20  FILLER                     PIC X(4).
  5058
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL131.cbl
  5059         16  CF-RESERVE-CONTROLS.
  5060             20  CF-MANUAL-SW               PIC X.
  5061                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5062             20  CF-FUTURE-SW               PIC X.
  5063                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5064             20  CF-PTC-SW                  PIC X.
  5065                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5066             20  CF-IBNR-SW                 PIC X.
  5067                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5068             20  CF-PTC-LF-SW               PIC X.
  5069                 88  CF-LF-PTC-USED             VALUE '1'.
  5070             20  CF-CDT-ACCESS-METHOD       PIC X.
  5071                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5072                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5073                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5074             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5075
  5076         16  CF-CLAIM-CALC-METHOD           PIC X.
  5077             88  360-PLUS-MONTHS                VALUE '1'.
  5078             88  365-PLUS-MONTHS                VALUE '2'.
  5079             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5080             88  360-DAILY                      VALUE '4'.
  5081             88  365-DAILY                      VALUE '5'.
  5082
  5083         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5084         16  FILLER                         PIC X(11).
  5085
  5086         16  CF-LIMIT-AMOUNTS.
  5087             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5088             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5089             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5090             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5091             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5092             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5093             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5094             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5095             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5096             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5097
  5098         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5099         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5100         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5101
  5102         16  CF-ZIP-CODE.
  5103             20  CF-ZIP-PRIME.
  5104                 24  CF-ZIP-1ST             PIC X.
  5105                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5106                 24  FILLER                 PIC X(4).
  5107             20  CF-ZIP-PLUS4               PIC X(4).
  5108         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5109             20  CF-CAN-POSTAL-1            PIC XXX.
  5110             20  CF-CAN-POSTAL-2            PIC XXX.
  5111             20  FILLER                     PIC XXX.
  5112
  5113         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5114         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5115         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5116
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL131.cbl
  5117         16  CF-RATING-SWITCH               PIC X.
  5118             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5119             88  CF-NO-RATING                   VALUE 'N'.
  5120
  5121         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5122
  5123         16  CF-CARRIER-OVER-SHORT.
  5124             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5125             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5126
  5127         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5128         16  CF-SECPAY-SWITCH               PIC X.
  5129             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5130             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5131         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5132         16  FILLER                         PIC X(448).
  5133*        16  FILLER                         PIC X(452).
  5134
  5135
  5136****************************************************************
  5137*             MORTALITY MASTER RECORD                          *
  5138****************************************************************
  5139
  5140     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5141         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5142                                INDEXED BY CF-MORT-NDX.
  5143             20  CF-MORT-TABLE              PIC X(5).
  5144             20  CF-MORT-TABLE-TYPE         PIC X.
  5145                 88  CF-MORT-JOINT              VALUE 'J'.
  5146                 88  CF-MORT-SINGLE             VALUE 'S'.
  5147                 88  CF-MORT-COMBINED           VALUE 'C'.
  5148                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5149                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5150             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5151             20  CF-MORT-AGE-METHOD         PIC XX.
  5152                 88  CF-AGE-LAST                VALUE 'AL'.
  5153                 88  CF-AGE-NEAR                VALUE 'AN'.
  5154             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5155             20  CF-MORT-ADJUSTMENT-DIRECTION
  5156                                            PIC X.
  5157                 88  CF-MINUS                   VALUE '-'.
  5158                 88  CF-PLUS                    VALUE '+'.
  5159             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5160             20  CF-MORT-JOINT-CODE         PIC X.
  5161                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5162             20  CF-MORT-PC-Q               PIC X.
  5163                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5164             20  CF-MORT-TABLE-CODE         PIC X(4).
  5165             20  CF-MORT-COMMENTS           PIC X(15).
  5166             20  FILLER                     PIC X(14).
  5167
  5168         16  FILLER                         PIC X(251).
  5169
  5170
  5171****************************************************************
  5172*             BUSSINESS TYPE MASTER RECORD                     *
  5173****************************************************************
  5174
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL131.cbl
  5175     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5176* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5177* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5178* AND RECORD 05 IS TYPES 81-99
  5179         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5180             20  CF-BUSINESS-TITLE          PIC  X(19).
  5181             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5182                                            PIC S9V9(4) COMP-3.
  5183             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5184             20  FILLER                     PIC  X.
  5185         16  FILLER                         PIC  X(248).
  5186
  5187
  5188****************************************************************
  5189*             TERMINAL MASTER RECORD                           *
  5190****************************************************************
  5191
  5192     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5193
  5194         16  CF-COMPANY-TERMINALS.
  5195             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5196                                  PIC X(4).
  5197         16  FILLER               PIC X(248).
  5198
  5199
  5200****************************************************************
  5201*             LIFE EDIT MASTER RECORD                          *
  5202****************************************************************
  5203
  5204     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5205         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5206             20  CF-LIFE-CODE-IN            PIC XX.
  5207             20  CF-LIFE-CODE-OUT           PIC XX.
  5208         16  FILLER                         PIC X(248).
  5209
  5210
  5211****************************************************************
  5212*             AH EDIT MASTER RECORD                            *
  5213****************************************************************
  5214
  5215     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5216         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5217             20  CF-AH-CODE-IN              PIC XXX.
  5218             20  CF-AH-CODE-OUT             PIC XX.
  5219         16  FILLER                         PIC X(248).
  5220
  5221
  5222****************************************************************
  5223*             CREDIBILITY TABLES                               *
  5224****************************************************************
  5225
  5226     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5227         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5228                             INDEXED BY CF-CRDB-NDX.
  5229             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5230             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5231             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5232         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL131.cbl
  5233
  5234
  5235****************************************************************
  5236*             REPORT CUSTOMIZATION RECORD                      *
  5237****************************************************************
  5238
  5239     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5240         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5241             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5242             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5243             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5244**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5245****       A T-TRANSFER.                                   ****
  5246             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5247
  5248         16  FILLER                         PIC XX.
  5249
  5250         16  CF-CARRIER-CNTL-OPT.
  5251             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5252                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5253                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5254             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5255                                            PIC X.
  5256         16  CF-GROUP-CNTL-OPT.
  5257             20  CF-GROUP-OPT-SEQ           PIC 9.
  5258                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5259                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5260             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5261                                            PIC X(6).
  5262         16  CF-STATE-CNTL-OPT.
  5263             20  CF-STATE-OPT-SEQ           PIC 9.
  5264                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5265                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5266             20  CF-STATE-SELECT OCCURS 3 TIMES
  5267                                            PIC XX.
  5268         16  CF-ACCOUNT-CNTL-OPT.
  5269             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5270                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5271                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5272             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5273                                            PIC X(10).
  5274         16  CF-BUS-TYP-CNTL-OPT.
  5275             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5276                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5277                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5278             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5279                                            PIC XX.
  5280         16  CF-LF-TYP-CNTL-OPT.
  5281             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5282                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5283                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5284             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5285                                            PIC XX.
  5286         16  CF-AH-TYP-CNTL-OPT.
  5287             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5288                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5289                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5290             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL131.cbl
  5291                                            PIC XX.
  5292         16  CF-REPTCD1-CNTL-OPT.
  5293             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5294                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5295                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5296             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5297                                            PIC X(10).
  5298         16  CF-REPTCD2-CNTL-OPT.
  5299             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5300                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5301                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5302             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5303                                            PIC X(10).
  5304         16  CF-USER1-CNTL-OPT.
  5305             20  CF-USER1-OPT-SEQ           PIC 9.
  5306                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5307                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5308             20  CF-USER1-SELECT OCCURS 3 TIMES
  5309                                            PIC X(10).
  5310         16  CF-USER2-CNTL-OPT.
  5311             20  CF-USER2-OPT-SEQ           PIC 9.
  5312                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5313                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5314             20  CF-USER2-SELECT OCCURS 3 TIMES
  5315                                            PIC X(10).
  5316         16  CF-USER3-CNTL-OPT.
  5317             20  CF-USER3-OPT-SEQ           PIC 9.
  5318                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5319                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5320             20  CF-USER3-SELECT OCCURS 3 TIMES
  5321                                            PIC X(10).
  5322         16  CF-USER4-CNTL-OPT.
  5323             20  CF-USER4-OPT-SEQ           PIC 9.
  5324                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5325                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5326             20  CF-USER4-SELECT OCCURS 3 TIMES
  5327                                            PIC X(10).
  5328         16  CF-USER5-CNTL-OPT.
  5329             20  CF-USER5-OPT-SEQ           PIC 9.
  5330                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5331                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5332             20  CF-USER5-SELECT OCCURS 3 TIMES
  5333                                            PIC X(10).
  5334         16  CF-REINS-CNTL-OPT.
  5335             20  CF-REINS-OPT-SEQ           PIC 9.
  5336                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5337                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5338             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5339                 24  CF-REINS-PRIME         PIC XXX.
  5340                 24  CF-REINS-SUB           PIC XXX.
  5341
  5342         16  CF-AGENT-CNTL-OPT.
  5343             20  CF-AGENT-OPT-SEQ           PIC 9.
  5344                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5345                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5346             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5347                                            PIC X(10).
  5348
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL131.cbl
  5349         16  FILLER                         PIC X(43).
  5350
  5351         16  CF-LOSS-RATIO-SELECT.
  5352             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5353             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5354         16  CF-ENTRY-DATE-SELECT.
  5355             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5356             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5357         16  CF-EFFECTIVE-DATE-SELECT.
  5358             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5359             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5360
  5361         16  CF-EXCEPTION-LIST-IND          PIC X.
  5362             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5363
  5364         16  FILLER                         PIC X(318).
  5365
  5366****************************************************************
  5367*                  EXCEPTION REPORTING RECORD                  *
  5368****************************************************************
  5369
  5370     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5371         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5372             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5373
  5374         16  CF-COMBINED-LIFE-AH-OPT.
  5375             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5376             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5377             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5378             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5379
  5380         16  CF-LIFE-OPT.
  5381             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5382             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5383             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5384             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5385             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5386             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5387             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5388             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5389             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5390             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5391
  5392         16  CF-AH-OPT.
  5393             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5394             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5395             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5396             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5397             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5398             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5399             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5400             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5401             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5402             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5403
  5404         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5405             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5406             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL131.cbl
  5407             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5408
  5409         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5410
  5411         16  FILLER                         PIC X(673).
  5412
  5413
  5414****************************************************************
  5415*             MORTGAGE SYSTEM PLAN RECORD                      *
  5416****************************************************************
  5417
  5418     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5419         16  CF-PLAN-TYPE                   PIC X.
  5420             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5421             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5422             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5423         16  CF-PLAN-ABBREV                 PIC XXX.
  5424         16  CF-PLAN-DESCRIPT               PIC X(10).
  5425         16  CF-PLAN-NOTES                  PIC X(20).
  5426         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5427         16  CF-PLAN-UNDERWRITING.
  5428             20  CF-PLAN-TERM-DATA.
  5429                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5430                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5431             20  CF-PLAN-AGE-DATA.
  5432                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5433                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5434                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5435             20  CF-PLAN-BENEFIT-DATA.
  5436                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5437                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5438                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5439                                            PIC S9(7)V99  COMP-3.
  5440         16  CF-PLAN-POLICY-FORMS.
  5441             20  CF-POLICY-FORM             PIC X(12).
  5442             20  CF-MASTER-APPLICATION      PIC X(12).
  5443             20  CF-MASTER-POLICY           PIC X(12).
  5444         16  CF-PLAN-RATING.
  5445             20  CF-RATE-CODE               PIC X(5).
  5446             20  CF-SEX-RATING              PIC X.
  5447                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5448                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5449             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5450             20  CF-SUB-STD-TYPE            PIC X.
  5451                 88  CF-PCT-OF-PREM            VALUE '1'.
  5452                 88  CF-PCT-OF-BENE            VALUE '2'.
  5453         16  CF-PLAN-PREM-TOLERANCES.
  5454             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5455             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5456         16  CF-PLAN-PYMT-TOLERANCES.
  5457             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5458             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5459         16  CF-PLAN-MISC-DATA.
  5460             20  FILLER                     PIC X.
  5461             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5462             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5463         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5464         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL131.cbl
  5465             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5466                                                     '1'.
  5467             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5468                                                     '2'.
  5469         16  CF-MIB-SEARCH-SW               PIC X.
  5470             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5471             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5472             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5473             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5474         16  CF-ALPHA-SEARCH-SW             PIC X.
  5475             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5476             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5477             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5478             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5479             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5480             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5481             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5482             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5483             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5484             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5485                                                     'A' 'B' 'C'
  5486                                                     'X' 'Y' 'Z'.
  5487         16  CF-EFF-DT-RULE-SW              PIC X.
  5488             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5489             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5490             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5491             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5492             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5493         16  FILLER                         PIC X(4).
  5494         16  CF-HEALTH-QUESTIONS            PIC X.
  5495             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5496         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5497         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5498         16  CF-PLAN-SNGL-JNT               PIC X.
  5499             88  CF-COMBINED-PLAN              VALUE 'C'.
  5500             88  CF-JNT-PLAN                   VALUE 'J'.
  5501             88  CF-SNGL-PLAN                  VALUE 'S'.
  5502         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5503         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5504         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5505         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5506         16  CF-RERATE-CNTL                 PIC  X.
  5507             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5508             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5509             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5510             88  CF-AUTO-RECALC                 VALUE '4'.
  5511         16  CF-BENEFIT-TYPE                PIC  X.
  5512             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5513             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5514         16  CF-POLICY-FEE                  PIC S999V99
  5515                                                    COMP-3.
  5516         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5517         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5518         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5519         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5520         16  FILLER                         PIC  X(32).
  5521         16  CF-TERMINATION-FORM            PIC  X(04).
  5522         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL131.cbl
  5523         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5524                                                       COMP-3.
  5525         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5526         16  CF-ISSUE-LETTER                PIC  X(4).
  5527         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5528         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5529             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5530             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5531         16  CF-MP-REFUND-CALC              PIC X.
  5532             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5533             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5534             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5535             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5536             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5537             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5538             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5539             88  CF-MP-REFD-MEAN                VALUE '8'.
  5540         16  CF-ALT-RATE-CODE               PIC  X(5).
  5541
  5542
  5543         16  FILLER                         PIC X(498).
  5544****************************************************************
  5545*             MORTGAGE COMPANY MASTER RECORD                   *
  5546****************************************************************
  5547
  5548     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5549         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5550         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5551             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5552             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5553             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5554             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5555             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5556
  5557         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5558         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5559         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5560         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5561         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5562
  5563         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5564             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5565         16  CF-MP-RECON-USE-IND            PIC X(1).
  5566             88  CF-MP-USE-RECON             VALUE 'Y'.
  5567         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5568             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5569         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5570             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5571             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5572         16  FILLER                         PIC X(1).
  5573         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5574             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5575         16  CF-MORTG-MIB-VERSION           PIC X.
  5576             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5577             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5578             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5579         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5580             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL131.cbl
  5581                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5582             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5583                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5584             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5585                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5586             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5587                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5588             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5589                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5590             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5591                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5592         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5593         16  FILLER                         PIC X(7).
  5594         16  CF-MORTG-DESTINATION-SYMBOL.
  5595             20  CF-MORTG-MIB-COMM          PIC X(5).
  5596             20  CF-MORTG-MIB-TERM          PIC X(5).
  5597         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5598             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5599         16  FILLER                         PIC X(03).
  5600         16  CF-MP-CHECK-NO-CONTROL.
  5601             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5602                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5603                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5604                                                ' ' LOW-VALUES.
  5605                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5606                                               VALUE '3'.
  5607         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5608         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5609         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5610             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5611                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5612             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5613                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5614             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5615                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5616             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5617                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5618             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5619                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5620             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5621                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5622         16  CF-MORTG-BILLING-AREA.
  5623             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5624                                            PIC X.
  5625         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5626         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5627         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5628         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5629             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5630             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5631         16  FILLER                         PIC X.
  5632         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5633             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5634             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5635         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5636         16  FILLER                         PIC X(8).
  5637         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5638         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL131.cbl
  5639         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5640         16  CF-ACH-COMPANY-ID.
  5641             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5642                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5643                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5644                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5645             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5646         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5647             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5648         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5649             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5650             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5651         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5652         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5653         16  FILLER                         PIC X(536).
  5654
  5655****************************************************************
  5656*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5657****************************************************************
  5658
  5659     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5660         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5661             20  CF-FEMALE-HEIGHT.
  5662                 24  CF-FEMALE-FT           PIC 99.
  5663                 24  CF-FEMALE-IN           PIC 99.
  5664             20  CF-FEMALE-MIN-WT           PIC 999.
  5665             20  CF-FEMALE-MAX-WT           PIC 999.
  5666         16  FILLER                         PIC X(428).
  5667
  5668     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5669         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5670             20  CF-MALE-HEIGHT.
  5671                 24  CF-MALE-FT             PIC 99.
  5672                 24  CF-MALE-IN             PIC 99.
  5673             20  CF-MALE-MIN-WT             PIC 999.
  5674             20  CF-MALE-MAX-WT             PIC 999.
  5675         16  FILLER                         PIC X(428).
  5676******************************************************************
  5677*             AUTOMATIC ACTIVITY RECORD                          *
  5678******************************************************************
  5679     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5680         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5681             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5682             20  CF-SYS-LETTER-ID           PIC X(04).
  5683             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5684             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5685             20  CF-SYS-RESET-SW            PIC X(01).
  5686             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5687             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5688
  5689         16  FILLER                         PIC X(50).
  5690
  5691         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5692             20  CF-USER-ACTIVE-SW          PIC X(01).
  5693             20  CF-USER-LETTER-ID          PIC X(04).
  5694             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5695             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5696             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL131.cbl
  5697             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5698             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5699             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5700
  5701         16  FILLER                         PIC X(246).
  5702
  5703*                                COPY ELCACTQ.
  5704******************************************************************
  5705*                                                                *
  5706*                            ELCACTQ.                            *
  5707*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5708*                            VMOD=2.004                          *
  5709*                                                                *
  5710*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5711*                                                                *
  5712*   FILE TYPE = VSAM,KSDS                                        *
  5713*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5714*                                                                *
  5715*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5716*       ALTERNATE INDEX = NONE                                   *
  5717*                                                                *
  5718*   LOG = YES                                                    *
  5719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5720*                                                                *
  5721*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5722******************************************************************
  5723
  5724 01  ACTIVITY-QUE.
  5725     12  AQ-RECORD-ID                PIC XX.
  5726         88  VALID-AQ-ID                VALUE 'AQ'.
  5727
  5728     12  AQ-CONTROL-PRIMARY.
  5729         16  AQ-COMPANY-CD           PIC X.
  5730         16  AQ-CARRIER              PIC X.
  5731         16  AQ-CLAIM-NO             PIC X(7).
  5732         16  AQ-CERT-NO.
  5733             20  AQ-CERT-PRIME       PIC X(10).
  5734             20  AQ-CERT-SFX         PIC X.
  5735
  5736     12  AQ-PENDING-ACTIVITY-FLAGS.
  5737         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5738         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5739             88  PENDING-PAYMENTS       VALUE '1'.
  5740         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5741             88  PENDING-FULL-PRINT     VALUE '1'.
  5742             88  PENDING-PART-PRINT     VALUE '2'.
  5743         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5744             88  PENDING-LETTERS        VALUE '1'.
  5745         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5746             88  PENDING-RESTORE        VALUE 'C'.
  5747             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5748
  5749     12  FILLER                      PIC X(20).
  5750
  5751     12  AQ-RESEND-DATE              PIC XX.
  5752     12  AQ-FOLLOWUP-DATE            PIC XX.
  5753     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5754     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL131.cbl
  5755     12  AQ-AUTO-LETTER              PIC X(4).
  5756     12  FILLER                      PIC XX.
  5757     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5758*****************************************************************
  5759
  5760*                                COPY ERCACCT.
  5761******************************************************************
  5762*                                                                *
  5763*                                                                *
  5764*                            ERCACCT                             *
  5765*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5766*                            VMOD=2.031                          *
  5767*                                                                *
  5768*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5769*                                                                *
  5770*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5771*   VSAM ACCOUNT MASTER FILES.                                   *
  5772*                                                                *
  5773*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5774*                                                                *
  5775*   FILE TYPE = VSAM,KSDS                                        *
  5776*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5777*                                                                *
  5778*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5779*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5780*                                                                *
  5781*   LOG = NO                                                     *
  5782*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5783*                                                                *
  5784*                                                                *
  5785******************************************************************
  5786*                   C H A N G E   L O G
  5787*
  5788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5789*-----------------------------------------------------------------
  5790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5791* EFFECTIVE    NUMBER
  5792*-----------------------------------------------------------------
  5793* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5794* 092705    2005050300006  PEMA  ADD SPP LEASES
  5795* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5796* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5797* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5798* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5799* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5800******************************************************************
  5801
  5802 01  ACCOUNT-MASTER.
  5803     12  AM-RECORD-ID                      PIC XX.
  5804         88  VALID-AM-ID                      VALUE 'AM'.
  5805
  5806     12  AM-CONTROL-PRIMARY.
  5807         16  AM-COMPANY-CD                 PIC X.
  5808         16  AM-MSTR-CNTRL.
  5809             20  AM-CONTROL-A.
  5810                 24  AM-CARRIER            PIC X.
  5811                 24  AM-GROUPING.
  5812                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL131.cbl
  5813                     28 AM-GROUPING-PRIME  PIC XXX.
  5814                 24  AM-STATE              PIC XX.
  5815                 24  AM-ACCOUNT.
  5816                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5817                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5818             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5819                                           PIC X(19).
  5820             20  AM-CNTRL-B.
  5821                 24  AM-EXPIRATION-DT      PIC XX.
  5822                 24  FILLER                PIC X(4).
  5823             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5824                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5825
  5826     12  AM-CONTROL-BY-VAR-GRP.
  5827         16  AM-COMPANY-CD-A1              PIC X.
  5828         16  AM-VG-CARRIER                 PIC X.
  5829         16  AM-VG-GROUPING                PIC X(6).
  5830         16  AM-VG-STATE                   PIC XX.
  5831         16  AM-VG-ACCOUNT                 PIC X(10).
  5832         16  AM-VG-DATE.
  5833             20  AM-VG-EXPIRATION-DT       PIC XX.
  5834             20  FILLER                    PIC X(4).
  5835         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5836                                           PIC 9(11)      COMP-3.
  5837     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5838         16  FILLER                        PIC X(10).
  5839         16  AM-VG-KEY3.
  5840             20  AM-VG3-ACCOUNT            PIC X(10).
  5841             20  AM-VG3-EXP-DT             PIC XX.
  5842         16  FILLER                        PIC X(4).
  5843     12  AM-MAINT-INFORMATION.
  5844         16  AM-LAST-MAINT-DT              PIC XX.
  5845         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5846         16  AM-LAST-MAINT-USER            PIC X(4).
  5847         16  FILLER                        PIC XX.
  5848
  5849     12  AM-EFFECTIVE-DT                   PIC XX.
  5850     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5851
  5852     12  AM-PREV-DATES  COMP-3.
  5853         16  AM-PREV-EXP-DT                PIC 9(11).
  5854         16  AM-PREV-EFF-DT                PIC 9(11).
  5855
  5856     12  AM-REPORT-CODE-1                  PIC X(10).
  5857     12  AM-REPORT-CODE-2                  PIC X(10).
  5858
  5859     12  AM-CITY-CODE                      PIC X(4).
  5860     12  AM-COUNTY-PARISH                  PIC X(6).
  5861
  5862     12  AM-NAME                           PIC X(30).
  5863     12  AM-PERSON                         PIC X(30).
  5864     12  AM-ADDRS                          PIC X(30).
  5865     12  AM-CITY.
  5866         16  AM-ADDR-CITY                  PIC X(28).
  5867         16  AM-ADDR-STATE                 PIC XX.
  5868     12  AM-ZIP.
  5869         16  AM-ZIP-PRIME.
  5870             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL131.cbl
  5871                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5872             20  FILLER                    PIC X(4).
  5873         16  AM-ZIP-PLUS4                  PIC X(4).
  5874     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5875         16  AM-CAN-POSTAL-1               PIC XXX.
  5876         16  AM-CAN-POSTAL-2               PIC XXX.
  5877         16  FILLER                        PIC XXX.
  5878     12  AM-TEL-NO.
  5879         16  AM-AREA-CODE                  PIC 999.
  5880         16  AM-TEL-PRE                    PIC 999.
  5881         16  AM-TEL-NBR                    PIC 9(4).
  5882     12  AM-TEL-LOC                        PIC X.
  5883         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5884         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5885
  5886     12  AM-COMM-STRUCTURE.
  5887         16  AM-DEFN-1.
  5888             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5889                 24  AM-AGT.
  5890                     28  AM-AGT-PREFIX     PIC X(4).
  5891                     28  AM-AGT-PRIME      PIC X(6).
  5892                 24  AM-COM-TYP            PIC X.
  5893                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5894                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5895                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5896                 24  AM-RECALC-LV-INDIC    PIC X.
  5897                 24  AM-RETRO-LV-INDIC     PIC X.
  5898                 24  AM-GL-CODES           PIC X.
  5899                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5900                 24  FILLER                PIC X(01).
  5901         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5902             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5903                 24  FILLER                PIC X(11).
  5904                 24  AM-L-COMA             PIC XXX.
  5905                 24  AM-J-COMA             PIC XXX.
  5906                 24  AM-A-COMA             PIC XXX.
  5907                 24  FILLER                PIC X(6).
  5908
  5909     12  AM-COMM-CHANGE-STATUS             PIC X.
  5910         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5911
  5912     12  AM-CSR-CODE                       PIC X(4).
  5913
  5914     12  AM-BILLING-STATUS                 PIC X.
  5915         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5916         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5917     12  AM-AUTO-REFUND-SW                 PIC X.
  5918         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5919         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5920     12  AM-GPCD                           PIC 99.
  5921     12  AM-IG                             PIC X.
  5922         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5923         88  AM-HAS-GROUP                     VALUE '2'.
  5924     12  AM-STATUS                         PIC X.
  5925         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5926         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5927         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5928         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL131.cbl
  5929         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5930         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5931     12  AM-REMIT-TO                       PIC 99.
  5932     12  AM-ID-NO                          PIC X(11).
  5933
  5934     12  AM-CAL-TABLE                      PIC XX.
  5935     12  AM-LF-DEVIATION                   PIC XXX.
  5936     12  AM-AH-DEVIATION                   PIC XXX.
  5937     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5938     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5939     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5940     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5941     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5942     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5943
  5944     12  AM-USER-FIELDS.
  5945         16  AM-FLD-1                      PIC XX.
  5946         16  AM-FLD-2                      PIC XX.
  5947         16  AM-FLD-3                      PIC XX.
  5948         16  AM-FLD-4                      PIC XX.
  5949         16  AM-FLD-5                      PIC XX.
  5950
  5951     12  AM-1ST-PROD-DATE.
  5952         16  AM-1ST-PROD-YR                PIC XX.
  5953         16  AM-1ST-PROD-MO                PIC XX.
  5954         16  AM-1ST-PROD-DA                PIC XX.
  5955     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5956     12  AM-CERTS-PURGED-DATE.
  5957         16  AM-PUR-YR                     PIC XX.
  5958         16  AM-PUR-MO                     PIC XX.
  5959         16  AM-PUR-DA                     PIC XX.
  5960     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5961     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5962     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5963     12  AM-INACTIVE-DATE.
  5964         16  AM-INA-MO                     PIC 99.
  5965         16  AM-INA-DA                     PIC 99.
  5966         16  AM-INA-YR                     PIC 99.
  5967     12  AM-AR-HI-CERT-DATE                PIC XX.
  5968
  5969     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5970     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5971
  5972     12  AM-OB-PAYMENT-MODE                PIC X.
  5973         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5974         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5975         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5976         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5977
  5978     12  AM-AH-ONLY-INDICATOR              PIC X.
  5979         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5980         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5981
  5982     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5983
  5984     12  AM-OVER-SHORT.
  5985         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5986         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL131.cbl
  5987
  5988     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5989     12  AM-DCC-CLP-STATE                  PIC XX.
  5990
  5991     12  AM-RECALC-COMM                    PIC X.
  5992     12  AM-RECALC-REIN                    PIC X.
  5993
  5994     12  AM-REI-TABLE                      PIC XXX.
  5995     12  AM-REI-ET-LF                      PIC X.
  5996     12  AM-REI-ET-AH                      PIC X.
  5997     12  AM-REI-PE-LF                      PIC X.
  5998     12  AM-REI-PE-AH                      PIC X.
  5999     12  AM-REI-PRT-ST                     PIC X.
  6000     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6001     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6002     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6003     12  AM-REI-GROUP-A                    PIC X(6).
  6004     12  AM-REI-MORT                       PIC X(4).
  6005     12  AM-REI-PRT-OW                     PIC X.
  6006     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6007     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6008     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6009     12  AM-REI-GROUP-B                    PIC X(6).
  6010
  6011     12  AM-TRUST-TYPE                     PIC X(2).
  6012
  6013     12  AM-EMPLOYER-STMT-USED             PIC X.
  6014     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6015
  6016     12  AM-STD-AH-TYPE                    PIC XX.
  6017     12  AM-EARN-METHODS.
  6018         16  AM-EARN-METHOD-R              PIC X.
  6019             88 AM-REF-RL-R78                 VALUE 'R'.
  6020             88 AM-REF-RL-PR                  VALUE 'P'.
  6021             88 AM-REF-RL-MEAN                VALUE 'M'.
  6022             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6023         16  AM-EARN-METHOD-L              PIC X.
  6024             88 AM-REF-LL-R78                 VALUE 'R'.
  6025             88 AM-REF-LL-PR                  VALUE 'P'.
  6026             88 AM-REF-LL-MEAN                VALUE 'M'.
  6027             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6028         16  AM-EARN-METHOD-A              PIC X.
  6029             88 AM-REF-AH-R78                 VALUE 'R'.
  6030             88 AM-REF-AH-PR                  VALUE 'P'.
  6031             88 AM-REF-AH-MEAN                VALUE 'M'.
  6032             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6033             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6034             88 AM-REF-AH-NET                 VALUE 'N'.
  6035
  6036     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6037     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6038     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6039
  6040     12  AM-RET-Y-N                        PIC X.
  6041     12  AM-RET-P-E                        PIC X.
  6042     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6043     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6044     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL131.cbl
  6045     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6046         16  AM-POOL-PRIME                 PIC XXX.
  6047         16  AM-POOL-SUB                   PIC XXX.
  6048     12  AM-RETRO-EARNINGS.
  6049         16  AM-RET-EARN-R                 PIC X.
  6050         16  AM-RET-EARN-L                 PIC X.
  6051         16  AM-RET-EARN-A                 PIC X.
  6052     12  AM-RET-ST-TAX-USE                 PIC X.
  6053         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6054         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6055     12  AM-RETRO-BEG-EARNINGS.
  6056         16  AM-RET-BEG-EARN-R             PIC X.
  6057         16  AM-RET-BEG-EARN-L             PIC X.
  6058         16  AM-RET-BEG-EARN-A             PIC X.
  6059     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6060     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6061
  6062     12  AM-USER-SELECT-OPTIONS.
  6063         16  AM-USER-SELECT-1              PIC X(10).
  6064         16  AM-USER-SELECT-2              PIC X(10).
  6065         16  AM-USER-SELECT-3              PIC X(10).
  6066         16  AM-USER-SELECT-4              PIC X(10).
  6067         16  AM-USER-SELECT-5              PIC X(10).
  6068
  6069     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6070
  6071     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6072
  6073     12  AM-RPT045A-SWITCH                 PIC X.
  6074         88  RPT045A-OFF                   VALUE 'N'.
  6075
  6076     12  AM-INSURANCE-LIMITS.
  6077         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6078         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6079
  6080     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6081         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6082
  6083     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6084         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6085         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6086
  6087     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6088
  6089     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6090     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6091     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6092     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6093     12  AM-DCC-UEF-STATE                  PIC XX.
  6094     12  FILLER                            PIC XXX.
  6095     12  AM-REPORT-CODE-3                  PIC X(10).
  6096*    12  FILLER                            PIC X(22).
  6097
  6098     12  AM-RESERVE-DATE.
  6099         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6100         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6101         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6102
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL131.cbl
  6103     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6104     12  AM-NOTIFICATION-TYPES.
  6105         16  AM-NOTIF-OF-LETTERS           PIC X.
  6106         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6107         16  AM-NOTIF-OF-REPORTS           PIC X.
  6108         16  AM-NOTIF-OF-STATUS            PIC X.
  6109
  6110     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6111         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6112         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6113         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6114         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6115
  6116     12  AM-BENEFIT-CONTROLS.
  6117         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6118             20  AM-BENEFIT-CODE           PIC XX.
  6119             20  AM-BENEFIT-TYPE           PIC X.
  6120             20  AM-BENEFIT-REVISION       PIC XXX.
  6121             20  AM-BENEFIT-REM-TERM       PIC X.
  6122             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6123             20  FILLER                    PIC XX.
  6124         16  FILLER                        PIC X(80).
  6125
  6126     12  AM-TRANSFER-DATA.
  6127         16  AM-TRANSFERRED-FROM.
  6128             20  AM-TRNFROM-CARRIER        PIC X.
  6129             20  AM-TRNFROM-GROUPING.
  6130                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6131                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6132             20  AM-TRNFROM-STATE          PIC XX.
  6133             20  AM-TRNFROM-ACCOUNT.
  6134                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6135                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6136             20  AM-TRNFROM-DTE            PIC XX.
  6137         16  AM-TRANSFERRED-TO.
  6138             20  AM-TRNTO-CARRIER          PIC X.
  6139             20  AM-TRNTO-GROUPING.
  6140                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6141                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6142             20  AM-TRNTO-STATE            PIC XX.
  6143             20  AM-TRNTO-ACCOUNT.
  6144                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6145                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6146             20  AM-TRNTO-DTE              PIC XX.
  6147         16  FILLER                        PIC X(10).
  6148
  6149     12  AM-SAVED-REMIT-TO                 PIC 99.
  6150
  6151     12  AM-COMM-STRUCTURE-SAVED.
  6152         16  AM-DEFN-1-SAVED.
  6153             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6154                 24  AM-AGT-SV             PIC X(10).
  6155                 24  AM-COM-TYP-SV         PIC X.
  6156                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6157                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6158                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6159                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6160                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL131.cbl
  6161                 24  AM-GL-CODES-SV        PIC X.
  6162                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6163                 24  FILLER                PIC X.
  6164         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6165             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6166                 24  FILLER                PIC X(11).
  6167                 24  AM-L-COMA-SV          PIC XXX.
  6168                 24  AM-J-COMA-SV          PIC XXX.
  6169                 24  AM-A-COMA-SV          PIC XXX.
  6170                 24  FILLER                PIC X(6).
  6171
  6172     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6173         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6174            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6175            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6176            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6177
  6178     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6179     12  FILLER                            PIC X(120).
  6180
  6181     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6182         16  AM-CONTROL-NAME               PIC X(30).
  6183         16  AM-EXECUTIVE-ONE.
  6184             20  AM-EXEC1-NAME             PIC X(15).
  6185             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6186                                                          COMP-3.
  6187             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6188                                                          COMP-3.
  6189         16  AM-EXECUTIVE-TWO.
  6190             20  AM-EXEC2-NAME             PIC X(15).
  6191             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6192                                                          COMP-3.
  6193             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6194                                                          COMP-3.
  6195
  6196     12  AM-RETRO-ADDITIONAL-DATA.
  6197         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6198         16  AM-RETRO-PREM-P-E             PIC X.
  6199         16  AM-RETRO-CLMS-P-I             PIC X.
  6200         16  AM-RETRO-RET-BRACKET-LF.
  6201             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6202                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6203                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6204             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6205                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6206                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6207             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6208                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6209                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6210         16  AM-RETRO-RET-BRACKET-AH.
  6211             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6212                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6213                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6214                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6215             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6216                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6217                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6218             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL131.cbl
  6219                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6220                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6221
  6222     12  AM-COMMENTS.
  6223         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6224
  6225     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6226         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6227         16  AM-FLI-BILLING-CODE           PIC X.
  6228         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6229         16  AM-FLI-UNITED-IDENT           PIC X.
  6230         16  AM-FLI-INTEREST-LOST-DATA.
  6231             20  AM-FLI-BANK-NO            PIC X(5).
  6232             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6233             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6234             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6235         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6236             20  AM-FLI-AGT                PIC X(9).
  6237             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6238             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6239         16  FILLER                        PIC X(102).
  6240
  6241     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6242         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6243             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6244             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6245             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6246             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6247             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6248         16  FILLER                          PIC X(10).
  6249******************************************************************
  6250
  6251*                                COPY ELCCHKQ.
  6252******************************************************************
  6253*                                                                *
  6254*                                                                *
  6255*                            ELCCHKQ.                            *
  6256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6257*                            VMOD=2.007                          *
  6258*                                                                *
  6259*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6260*                                                                *
  6261*   FILE TYPE = VSAM,KSDS                                        *
  6262*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6263*                                                                *
  6264*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6265*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6266*                                                                *
  6267*   LOG = YES                                                    *
  6268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6269******************************************************************
  6270 01  CHECK-QUE.
  6271     12  CQ-RECORD-ID                PIC XX.
  6272         88  VALID-CQ-ID         VALUE 'CQ'.
  6273
  6274     12  CQ-CONTROL-PRIMARY.
  6275         16  CQ-COMPANY-CD           PIC X.
  6276         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL131.cbl
  6277         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6278
  6279     12  CQ-CONTROL-BY-PAYEE.
  6280         16  CQ-CONTROL-BY-NUMBER.
  6281             20  CQ-COMPANY-CD-A1     PIC X.
  6282             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6283         16  CQ-PAYEE-CARRIER        PIC X.
  6284         16  CQ-PAYEE-GROUPING       PIC X(6).
  6285         16  CQ-PAYEE-STATE          PIC XX.
  6286         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6287         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6288
  6289     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6290         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6291         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6292         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6293         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6294         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6295         16  FILLER                  PIC X(3).
  6296
  6297     12  CQ-ENTRY-TYPE               PIC X.
  6298             88  CHECK-ON-QUE           VALUE 'Q'.
  6299             88  ALIGNMENT-CHECK        VALUE 'A'.
  6300             88  SPOILED-CHECK          VALUE 'S'.
  6301             88  PAYMENT-ABORTED        VALUE 'X'.
  6302
  6303     12  CQ-CLAIM-MAST-CNTL.
  6304         16  CQ-CARRIER              PIC X.
  6305         16  CQ-CLAIM-NO             PIC X(7).
  6306         16  CQ-CERT-NO.
  6307             20  CQ-CERT-PRIME       PIC X(10).
  6308             20  CQ-CERT-SFX         PIC X.
  6309         16  CQ-CLAIM-TYPE           PIC X.
  6310             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6311             88  CQ-AH-CLAIM            VALUE 'A'.
  6312         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6313             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6314             88  CQ-O-B-COVERAGE        VALUE '2'.
  6315             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6316
  6317     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6318     12  CQ-CHECK-NUMBER             PIC X(7).
  6319     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6320     12  CQ-PAYMENT-TYPE             PIC X.
  6321             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6322             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6323             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6324             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6325             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6326             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6327             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6328             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6329     12  CQ-VOID-INDICATOR           PIC X.
  6330             88  CHECK-IS-STOPPED          VALUE 'S'.
  6331             88  CHECK-IS-VOID             VALUE 'V'.
  6332     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6333     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6334     12  CQ-CHECK-BY-USER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL131.cbl
  6335     12  CQ-PRE-NUMBERING-SW         PIC X.
  6336       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6337       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6338
  6339     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6340     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6341     12  CQ-LEDGER-FLAG              PIC X(01).
  6342     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6343     12  CQ-LAST-UPDATED-DT          PIC XX.
  6344     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6345     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6346
  6347     12  FILLER                      PIC X(04).
  6348
  6349******************************************************************
  6350
  6351*                                COPY ELCARCH.
  6352******************************************************************
  6353*                                                                *
  6354*                            ELCARCH.                            *
  6355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6356*                            VMOD=2.007                          *
  6357*                                                                *
  6358*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6359*                                                                *
  6360*   FILE TYPE = VSAM,KSDS                                        *
  6361*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6362*                                                                *
  6363*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6364*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6365*                                                                *
  6366*   LOG = NO                                                     *
  6367*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6368*                                                                *
  6369*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6370******************************************************************
  6371 01  LETTER-ARCHIVE.
  6372     12  LA-RECORD-ID                PIC XX.
  6373         88  VALID-LA-ID                VALUE 'LA'.
  6374
  6375     12  LA-CONTROL-PRIMARY.
  6376         16  LA-COMPANY-CD           PIC X.
  6377         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6378         16  LA-RECORD-TYPE          PIC X.
  6379             88  LA-HEADER-DATA         VALUE '1'.
  6380             88  LA-ADDRESS-DATA        VALUE '2'.
  6381             88  LA-TEXT-DATA           VALUE '3'.
  6382             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6383         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6384
  6385     12  LA-CONTROL-BY-TYPE.
  6386         16  LA-COMPANY-CD-A1        PIC X.
  6387         16  LA-RECORD-TYPE-A1       PIC X.
  6388         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6389         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6390
  6391     12  LA-TEXT-RECORD.
  6392         16  LA-SKIP-CONTROL         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL131.cbl
  6393             88  NO-LINES-SKIPPED       VALUE SPACES.
  6394             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6395         16  LA-TEXT-LINE            PIC X(70).
  6396
  6397     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6398         16  FILLER                  PIC XX.
  6399         16  LA-ADDRESS-LINE         PIC X(30).
  6400         16  FILLER                  PIC X(40).
  6401
  6402     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6403         16  FILLER                  PIC XX.
  6404         16  LA-CARRIER              PIC X.
  6405         16  LA-CLAIM-NO             PIC X(7).
  6406         16  LA-CERT-NO.
  6407             20  LA-CERT-PRIME       PIC X(10).
  6408             20  LA-CERT-SFX         PIC X.
  6409         16  LA-NO-OF-COPIES         PIC S9.
  6410         16  LA-RESEND-DATE          PIC XX.
  6411         16  LA-PROCESSOR-CD         PIC X(4).
  6412         16  LA-CREATION-DT          PIC XX.
  6413         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6414         16  LA-RESEND-PRINT-DATE    PIC XX.
  6415         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6416         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6417*
  6418* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6419*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6420*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6421*   I        20  LA-DMD-RES-ST           PIC XX.
  6422*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6423*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6424*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6425*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6426*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6427*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6428*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6429*   I        20  LA-DMD-UND-CODE         PIC XX.
  6430*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6431*   V    16  FILLER                  PIC X(15).
  6432* -----
  6433*
  6434* REINSERTED  CSO  MODS
  6435*
  6436         16  FILLER.
  6437             20  FILLER                  PIC X(29).
  6438             20  LA-CSO-LETTER-STATUS    PIC X.
  6439                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6440                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6441                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6442             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6443             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6444*
  6445
  6446     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6447         16  FILLER                  PIC XX.
  6448         16  LA4-CARRIER             PIC X.
  6449         16  LA4-CLAIM-NO            PIC X(7).
  6450         16  LA4-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL131.cbl
  6451             20  LA4-CERT-PRIME      PIC X(10).
  6452             20  LA4-CERT-SFX        PIC X.
  6453         16  LA4-NO-OF-COPIES        PIC S9.
  6454         16  LA4-RESEND-DATE         PIC XX.
  6455         16  LA4-PROCESSOR-CD        PIC X(4).
  6456         16  LA4-CREATION-DT         PIC XX.
  6457         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6458         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6459         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6460         16  LA4-FORM-TYPE           PIC X.
  6461             88  LA4-INITIAL-FORM    VALUE '1'.
  6462             88  LA4-PROGRESS-FORM   VALUE '2'.
  6463         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6464         16  LA4-STATE               PIC X(02).
  6465         16  FILLER                  PIC X(31).
  6466******************************************************************
  6467
  6468*                                COPY ELCBENE.
  6469******************************************************************
  6470*                                                                *
  6471*                            ELCBENE.                            *
  6472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.006                          *
  6474*                                                                *
  6475*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6476*                                                                *
  6477*   FILE TYPE = VSAM,KSDS                                        *
  6478*   RECORD SIZE = 500   RECFORM = FIX                            *
  6479*                                                                *
  6480*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6481*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6482*                                                                *
  6483*   LOG = YES                                                    *
  6484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6485*                                                                *
  6486*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6487******************************************************************
  6488
  6489 01  BENEFICIARY-MASTER.
  6490     12  BE-RECORD-ID                PIC XX.
  6491         88  VALID-BE-ID                VALUE 'BE'.
  6492
  6493     12  BE-CONTROL-PRIMARY.
  6494         16  BE-COMPANY-CD           PIC X.
  6495         16  BE-RECORD-TYPE          PIC X.
  6496             88  BENEFICIARY-RECORD  VALUE 'B'.
  6497             88  ADJUSTOR-RECORD     VALUE 'A'.
  6498         16  BE-BENEFICIARY          PIC X(10).
  6499     12  BE-CONTROL-BY-NAME.
  6500         16  BE-COMPANY-CD-A1        PIC X.
  6501         16  BE-RECORD-TYPE-A1       PIC X.
  6502         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6503         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6504
  6505     12  BE-LAST-MAINT-DT            PIC XX.
  6506     12  BE-LAST-MAINT-BY            PIC X(4).
  6507     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6508
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL131.cbl
  6509     12  BE-ADDRESS-DATA.
  6510         16  BE-MAIL-TO-NAME         PIC X(30).
  6511         16  BE-ADDRESS-LINE-1       PIC X(30).
  6512         16  BE-ADDRESS-LINE-2       PIC X(30).
  6513         16  BE-ADDRESS-LINE-3       PIC X(30).
  6514         16  BE-CITY-STATE.
  6515             20  BE-CITY             PIC X(28).
  6516             20  BE-STATE            PIC XX.
  6517         16  BE-ZIP-CODE.
  6518             20  BE-ZIP-PRIME.
  6519                 24  BE-ZIP-1ST      PIC X.
  6520                     88  BE-CANADIAN-POST-CODE
  6521                                         VALUE 'A' THRU 'Z'.
  6522                 24  FILLER          PIC X(4).
  6523             20  BE-ZIP-PLUS4        PIC X(4).
  6524         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6525             20  BE-CAN-POSTAL-1     PIC XXX.
  6526             20  BE-CAN-POSTAL-2     PIC XXX.
  6527             20  FILLER              PIC XXX.
  6528         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6529         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6530
  6531******************************************************************
  6532*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6533*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6534******************************************************************
  6535     12  BE-CARRIER                  PIC X.
  6536
  6537     12  BE-ADDRESS-DATA2.
  6538         16  BE-MAIL-TO-NAME2        PIC X(30).
  6539         16  BE-ADDRESS-LINE-12      PIC X(30).
  6540         16  BE-ADDRESS-LINE-22      PIC X(30).
  6541         16  BE-ADDRESS-LINE-32      PIC X(30).
  6542         16  BE-CITY-STATE2.
  6543             20  BE-CITY2            PIC X(28).
  6544             20  BE-STATE2           PIC XX.
  6545         16  BE-ZIP-CODE2.
  6546             20  BE-ZIP-PRIME2.
  6547                 24  BE-ZIP-1ST2     PIC X.
  6548                     88  BE-CANADIAN-POST-CODE2
  6549                                         VALUE 'A' THRU 'Z'.
  6550                 24  FILLER          PIC X(4).
  6551             20  BE-ZIP-PLUS42       PIC X(4).
  6552         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6553             20  BE-CAN-POSTAL-12    PIC XXX.
  6554             20  BE-CAN-POSTAL-22    PIC XXX.
  6555             20  FILLER              PIC XXX.
  6556         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6557         16  BE-BILLING-STMT-DATA.
  6558             20  BE-BSR              PIC X.
  6559                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6560                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6561             20  BE-BSR-FROM         PIC X(30).
  6562             20  BE-BSR-DEPT         PIC X(30).
  6563             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6564             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6565             20  BE-OUTPUT-TYPE      PIC X.
  6566                 88  BE-FAX-OUTPUT         VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL131.cbl
  6567                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6568
  6569     12  FILLER                      PIC X(28).
  6570******************************************************************
  6571
  6572*                                COPY ELCDAR.
  6573******************************************************************
  6574*                                                                *
  6575*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6576*   FILE TYPE = VSAM,KSDS                                        *
  6577*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6578*   BASE CLUSTER = DLYACTV                                       *
  6579*   LOG = YES                                                    *
  6580*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6581*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6582*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6583*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6584*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6585*               BY PROGRAM "LGINFCE".                            *
  6586*                                                                *
  6587******************************************************************
  6588 01  DAILY-ACTIVITY-RECORD.
  6589     05  DA-KEY.
  6590         10  DA-COMP-CD          PIC X.
  6591         10  DA-CARRIER          PIC X.
  6592         10  DA-CLAIM-NO         PIC X(7).
  6593         10  DA-CERT-NO.
  6594             15  DA-CERT-PRIME   PIC X(10).
  6595             15  DA-CERT-SFX     PIC X.
  6596     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6597     05  DA-RECORD-TYPE          PIC X.
  6598     05  FILLER                  PIC X(2).
  6599******************************************************************
  6600
  6601*                                COPY ELCALPH.
  6602******************************************************************
  6603*                                                                *
  6604*                            ELCALPH.                            *
  6605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6606*                            VMOD=2.003                          *
  6607*                                                                *
  6608*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6609*                                                                *
  6610*   FILE TYPE = VSAM,KSDS                                        *
  6611*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6612*                                                                *
  6613*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6614*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6615*                                                                *
  6616*   LOG = YES                                                    *
  6617*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6618*                                                                *
  6619*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6620******************************************************************
  6621
  6622 01  ALPHA-INDEX.
  6623     12  AI-RECORD-ID                         PIC XX.
  6624         88  VALID-AI-ID                  VALUE 'AI'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL131.cbl
  6625     12  AI-CONTROL-PRIMARY.
  6626         16  AI-COMPANY-CD                     PIC X.
  6627         16  AI-SOURCE                         PIC X.
  6628             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6629             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6630         16  AI-NAME.
  6631             20  AI-LAST-NAME                  PIC X(15).
  6632             20  AI-FIRST-NAME.
  6633                 24  AI-FIRST-INITIAL          PIC X.
  6634                 24  FILLER                    PIC X(11).
  6635             20  AI-MIDDLE-INIT                PIC X.
  6636         16  AI-DATE                           PIC X(8).
  6637         16  AI-TIME                           PIC S9(07) COMP-3.
  6638
  6639     12  AI-CONTROL-BY-ADMIN-KEY.
  6640         16  AI-CM-COMPANY-CD                  PIC X.
  6641         16  AI-CM-SOURCE                      PIC X.
  6642         16  AI-CM-CARRIER                     PIC X.
  6643         16  AI-CM-GROUPING.
  6644             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6645             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6646         16  AI-CM-STATE                       PIC XX.
  6647         16  AI-CM-PRODUCER.
  6648             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6649             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6650         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6651         16  AI-CM-CERTIFICATE-NUMBER.
  6652             20  AI-CM-CERT-PRIME              PIC X(10).
  6653             20  AI-CM-CERT-SFX                PIC X.
  6654         16  AI-CM-DATE                        PIC X(8).
  6655         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6656         16  FILLER                            PIC X(11).
  6657
  6658     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6659         AI-CONTROL-BY-ADMIN-KEY.
  6660         16  AI-CL-COMPANY-CD                  PIC X.
  6661         16  AI-CL-SOURCE                      PIC X.
  6662         16  AI-CL-CARRIER                     PIC X.
  6663         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6664         16  AI-CL-CERTIFICATE-NUMBER.
  6665             20  AI-CL-CERT-PRIME              PIC X(10).
  6666             20  AI-CL-CERT-SFX                PIC X.
  6667         16  AI-CL-DATE                        PIC X(8).
  6668         16  AI-CL-INCURRED-DATE               PIC XX.
  6669         16  AI-CL-CLOSE-DATE                  PIC XX.
  6670         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6671         16  AI-CREDIT-CARD-NUMBER.
  6672             20  AI-CCN.
  6673                 24  AI-CCN-PREFIX             PIC X(4).
  6674                 24  AI-CCN-PRIME              PIC X(12).
  6675             20  AI-CCN-FILLER                 PIC X(4).
  6676
  6677     12  AI-MAINT-INFO.
  6678         16  AI-LAST-MAINT-BY                  PIC X(4).
  6679         16  AI-LAST-MAINT-DT                  PIC XX.
  6680         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6681
  6682     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL131.cbl
  6683
  6684     12  FILLER                                PIC X(15).
  6685
  6686
  6687*                                COPY ERCDMDNT.
  6688******************************************************************
  6689*                                                                *
  6690*                            ERCDMDNT                            *
  6691*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6692*                            VMOD=2.005                          *
  6693*                                                                *
  6694*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6695*                                                                *
  6696*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6697*                                                                *
  6698*        FILE TYPE= VSAM,KSDS                                    *
  6699*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6700*                                                                *
  6701*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6702*                                                                *
  6703*        LOG = YES                                               *
  6704*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6705*                                                                *
  6706******************************************************************
  6707
  6708 01  CERTIFICATE-NOTE.
  6709     12  CN-RECORD-ID                     PIC  XX.
  6710         88  VALID-CN-ID                      VALUE 'CN'.
  6711
  6712     12  CN-CONTROL-PRIMARY.
  6713         16  CN-COMPANY-CD                PIC X.
  6714         16  CN-CERT-KEY.
  6715             20  CN-CARRIER               PIC X.
  6716             20  CN-GROUPING.
  6717                 24  CN-GROUPING-PREFIX   PIC XXX.
  6718                 24  CN-GROUPING-PRIME    PIC XXX.
  6719             20  CN-STATE                 PIC XX.
  6720             20  CN-ACCOUNT.
  6721                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  6722                 24  CN-ACCOUNT-PRIME     PIC X(6).
  6723             20  CN-CERT-EFF-DT           PIC XX.
  6724             20  CN-CERT-NO.
  6725                 24  CN-CERT-PRIME        PIC X(10).
  6726                 24  CN-CERT-SFX          PIC X.
  6727
  6728     12  CN-BILLING-START-LINE-NO         PIC 99.
  6729     12  CN-BILLING-END-LINE-NO           PIC 99.
  6730
  6731     12  CN-LINES.
  6732         16  CN-LINE                      PIC X(77)  OCCURS 10.
  6733
  6734     12  CN-CSI-NOTES REDEFINES CN-LINES.
  6735         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  6736         16  CN-CSI-GENERAL-DATA-AREA.
  6737             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  6738
  6739         16  CN-CSI-GENERAL-DATA-R REDEFINES
  6740             CN-CSI-GENERAL-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL131.cbl
  6741             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  6742             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  6743             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  6744             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  6745             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  6746             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  6747             20  CN-CSI-GEN-INFRM-MI          PIC X.
  6748             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  6749             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  6750             20  FILLER                       PIC XX.
  6751             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  6752             20  FILLER                       PIC X(38).
  6753
  6754         16  CN-CSI-PRODUCT-DATA-AREA.
  6755             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  6756
  6757         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  6758             CN-CSI-PRODUCT-DATA-AREA.
  6759             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  6760             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  6761             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  6762             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  6763             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  6764             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  6765             20  FILLER                   PIC XX.
  6766             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6767             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6768             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  6769             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  6770             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6771             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6772             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6773             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6774             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  6775             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  6776             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  6777             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  6778             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  6779             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  6780             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  6781             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  6782             20  CN-CSI-CC-TERM-AGE       PIC 999.
  6783             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6784             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  6785             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  6786             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  6787             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  6788             20  FILLER                   PIC X(25).
  6789
  6790         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  6791             CN-CSI-CREDIT-CARD-DATA.
  6792             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  6793             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  6794             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  6795             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  6796             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  6797             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  6798             20  FILLER                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL131.cbl
  6799             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6800             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6801             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  6802             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  6803             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6804             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6805             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6806             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6807             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  6808             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  6809             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  6810             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  6811             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  6812             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  6813             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  6814             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  6815             20  CN-CSI-FL-TERM-AGE       PIC 999.
  6816             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6817             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  6818             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  6819             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  6820             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  6821             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  6822             20  FILLER                   PIC X(17).
  6823
  6824         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  6825             CN-CSI-FAMILY-LEAVE-DATA.
  6826             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  6827             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  6828             20  CN-CSI-SL-BENE-REL       PIC X(8).
  6829             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  6830             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  6831             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  6832             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  6833             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  6834             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  6835             20  CN-CSI-SL-INT-ON-PROCEEDS
  6836                                          PIC S9(5)V99  COMP-3.
  6837             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  6838             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  6839             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  6840             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  6841             20  CN-CSI-SL-POLICY-BENEFITS
  6842                                          PIC S9(5)V99  COMP-3.
  6843             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  6844             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  6845             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  6846             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  6847             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  6848             20  CN-CSI-SL-PREM-MODE      PIC 99.
  6849             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  6850             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  6851             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  6852             20  CN-CSI-SL-STATE-NOT      PIC X.
  6853             20  FILLER                   PIC XX.
  6854
  6855         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  6856             CN-CSI-SENIOR-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL131.cbl
  6857             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  6858             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  6859             20  CN-CSI-PP-BEN-PAID-TO-DATE
  6860                                          PIC S9(5)V99  COMP-3.
  6861             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  6862             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  6863             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  6864             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  6865             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  6866             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  6867             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  6868             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  6869             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  6870             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  6871             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  6872             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  6873             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  6874             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6875             20  CN-CSI-PP-REPAIR         PIC X.
  6876             20  CN-CSI-PP-REPLACE        PIC X.
  6877             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  6878             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  6879             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  6880             20  CN-CSI-PP-TERM-AGE       PIC 999.
  6881             20  FILLER                   PIC X(5).
  6882
  6883         16  CN-CSI-EXT-WARR-DATA REDEFINES
  6884             CN-CSI-PURCH-PROP-DATA.
  6885             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  6886             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  6887             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  6888             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  6889             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  6890             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  6891             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  6892             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  6893             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  6894             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  6895             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  6896             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  6897             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  6898             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  6899             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  6900             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6901             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  6902             20  CN-CSI-EW-REPLACE        PIC X.
  6903             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  6904             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  6905             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  6906             20  CN-CSI-EW-TERM-AGE       PIC 999.
  6907             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  6908             20  FILLER                   PIC X(4).
  6909
  6910     12  CN-LAST-MAINT-DT                 PIC XX.
  6911     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  6912     12  CN-LAST-MAINT-USER               PIC X(4).
  6913     12  FILLER                           PIC X(6).
  6914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL131.cbl
  6915******************************************************************
  6916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL131.cbl
  6918 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6919                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  6920                          CONTROL-FILE ACTIVITY-QUE
  6921                          ACCOUNT-MASTER CHECK-QUE
  6922                          LETTER-ARCHIVE BENEFICIARY-MASTER
  6923                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  6924                          CERTIFICATE-NOTE.
  6925 0000-DFHEXIT SECTION.
  6926     MOVE '9#                    $   ' TO DFHEIV0.
  6927     MOVE 'EL131' TO DFHEIV1.
  6928     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6929
  6930     IF EIBCALEN = ZERO
  6931         GO TO 8800-UNAUTHORIZED-ACCESS.
  6932
  6933     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6934     MOVE '5'                    TO DC-OPTION-CODE.
  6935     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  6936     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6937     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  6938     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6939
  6940     IF SAVE-DATE-YY GREATER 70
  6941         MOVE 19                 TO SAVE-DATE-CC
  6942      ELSE
  6943         MOVE 20                 TO SAVE-DATE-CC.
  6944
  6945
  6946* EXEC CICS HANDLE CONDITION
  6947*        PGMIDERR (8820-XCTL-ERROR)
  6948*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  6949*        ERROR    (9990-ABEND)
  6950*    END-EXEC.
  6951*    MOVE '"$LI.                 ! " #00006941' TO DFHEIV0
  6952     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  6953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6954     MOVE X'2220233030303036393431' TO DFHEIV0(25:11)
  6955     CALL 'kxdfhei1' USING DFHEIV0
  6956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6957
  6958
  6959     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6960     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6961     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6962
  6963     INITIALIZE    EDIT-WORK-AREA.
  6964     MOVE '/'                    TO WORK-SLASH.
  6965     MOVE SPACES                 TO ERROR-SWITCHES.
  6966
  6967     MOVE TRAN-ID                TO TRANS-ID.
  6968     MOVE EIBTRMID               TO PI-TERM.
  6969     MOVE MAP-ID                 TO PI-QUAL.
  6970
  6971     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  6972
  6973     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6974         MOVE LOW-VALUES         TO EL131AO
  6975         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL131.cbl
  6976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6977         MOVE -1                 TO MAINTL
  6978         GO TO 8110-SEND-DATA.
  6979
  6980     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  6981         MOVE LOW-VALUES         TO EL131AO
  6982         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  6983         MOVE 'X'                TO PI-RETURN-CD-1
  6984         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  6985         MOVE -1                 TO MAINTL
  6986         GO TO 8100-SEND-MAP.
  6987
  6988     IF EIBAID = DFHCLEAR
  6989         GO TO 8200-RETURN-PRIOR.
  6990
  6991     IF PI-PROCESSOR-ID = 'LGXX'
  6992         NEXT SENTENCE
  6993     ELSE
  6994
  6995* EXEC CICS READQ TS
  6996*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6997*            INTO    (SECURITY-CONTROL)
  6998*            LENGTH  (SC-COMM-LENGTH)
  6999*            ITEM    (SC-ITEM)
  7000*        END-EXEC
  7001*    MOVE '*$II   L              ''   #00006982' TO DFHEIV0
  7002     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7004     MOVE X'2020233030303036393832' TO DFHEIV0(25:11)
  7005     CALL 'kxdfhei1' USING DFHEIV0,
  7006           PI-SECURITY-TEMP-STORE-ID,
  7007           SECURITY-CONTROL,
  7008           SC-COMM-LENGTH,
  7009           SC-ITEM,
  7010           DFHEIV99,
  7011           DFHEIV99
  7012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7013         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7014         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7015         IF NOT DISPLAY-CAP
  7016             MOVE 'READ'               TO  SM-READ
  7017             PERFORM 9995-SECURITY-VIOLATION
  7018             MOVE ER-0070              TO  EMI-ERROR
  7019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7020             GO TO 8100-SEND-MAP.
  7021
  7022
  7023* EXEC CICS RECEIVE
  7024*        MAP    ('EL131A')
  7025*        MAPSET ('EL131S')
  7026*    END-EXEC.
  7027     MOVE 'EL131A' TO DFHEIV1
  7028     MOVE 'EL131S' TO DFHEIV2
  7029*    MOVE '8"T                   ''   #00006997' TO DFHEIV0
  7030     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7031     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7032     MOVE X'2020233030303036393937' TO DFHEIV0(25:11)
  7033     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL131.cbl
  7034           DFHEIV1,
  7035           EL131AI,
  7036           DFHEIV99,
  7037           DFHEIV2,
  7038           DFHEIV99,
  7039           DFHEIV99
  7040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7041
  7042
  7043     IF PFKEYL GREATER THAN ZERO
  7044         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7045
  7046     IF SCREEN-ERROR
  7047         MOVE ER-0004 TO EMI-ERROR
  7048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7049         MOVE -1 TO MAINTL
  7050         GO TO 8110-SEND-DATA.
  7051
  7052     IF EIBAID = DFHPF3
  7053         GO TO 8500-TRLR-MNT.
  7054
  7055     IF EIBAID = DFHPF4
  7056         GO TO 8600-ADDR-MNT.
  7057
  7058     IF EIBAID = DFHPF5
  7059         GO TO 8700-CERT-MNT.
  7060
  7061     IF PI-COMPANY-ID = 'DMD'
  7062       IF EIBAID = DFHPF6
  7063         GO TO 8750-DMD-CLM-FIX.
  7064
  7065     IF EIBAID = DFHPF7
  7066         GO TO 4000-FORCE-ERRORS.
  7067
  7068     IF EIBAID = DFHPF12
  7069         GO TO 8300-GET-HELP.
  7070
  7071     IF EIBAID = DFHPF23
  7072         GO TO 8810-PF23-ENTERED.
  7073
  7074     IF EIBAID = DFHPF24
  7075         GO TO 8400-RETURN-MASTER.
  7076
  7077     IF EIBAID NOT = DFHENTER
  7078         MOVE ER-0029            TO EMI-ERROR
  7079         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7080         MOVE -1                 TO MAINTL
  7081         GO TO 8110-SEND-DATA.
  7082
  7083     IF PI-RETURN-CD-1 =  'X'
  7084         MOVE ER-0311            TO EMI-ERROR
  7085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7086         MOVE -1                 TO MAINTL
  7087         GO TO 8110-SEND-DATA.
  7088
  7089     IF MAINTI = 'A'
  7090         GO TO 0500-ADD-ALPHA-ONLY.
  7091
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL131.cbl
  7092     IF MAINTI = 'N'
  7093         GO TO 0600-CHANGE-NAME.
  7094
  7095     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7096
  7097     IF SCREEN-ERROR
  7098         GO TO 8110-SEND-DATA.
  7099
  7100     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7101         MOVE ER-0276            TO EMI-ERROR
  7102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7103         MOVE -1                 TO MAINTL
  7104         GO TO 8110-SEND-DATA.
  7105
  7106     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7107
  7108     IF SCREEN-ERROR
  7109         GO TO 8110-SEND-DATA.
  7110
  7111     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7112
  7113     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7114
  7115     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7116         GO TO 8110-SEND-DATA.
  7117
  7118     IF EMI-FATAL-CTR GREATER THAN ZERO
  7119         GO TO 8110-SEND-DATA.
  7120
  7121     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7122
  7123     IF WS-OPEN-CLOSE-SW = 'Y'
  7124         IF PI-LETTER-SW = 'Y'
  7125             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7126             MOVE 'T'            TO  CNTL-REC-TYPE
  7127             MOVE SPACES         TO  CNTL-PROC-ID
  7128             MOVE +0             TO  CNTL-SEQ-NO
  7129
  7130* EXEC CICS READ
  7131*                DATASET   (CNTL-FILE-ID)
  7132*                RIDFLD    (CNTL-KEY)
  7133*                SET       (ADDRESS OF CONTROL-FILE)
  7134*            END-EXEC
  7135*    MOVE '&"S        E          (   #00007088' TO DFHEIV0
  7136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7138     MOVE X'2020233030303037303838' TO DFHEIV0(25:11)
  7139     CALL 'kxdfhei1' USING DFHEIV0,
  7140           CNTL-FILE-ID,
  7141           DFHEIV20,
  7142           DFHEIV99,
  7143           CNTL-KEY,
  7144           DFHEIV99,
  7145           DFHEIV99,
  7146           DFHEIV99
  7147     SET ADDRESS OF CONTROL-FILE TO
  7148         DFHEIV20
  7149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL131.cbl
  7150             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7151
  7152     MOVE ER-0000                TO EMI-ERROR.
  7153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7154
  7155     MOVE SPACE                  TO MAINTO.
  7156     MOVE -1                     TO MAINTL.
  7157     GO TO 8100-SEND-MAP.
  7158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL131.cbl
  7160 0100-UPDATE-PI.
  7161     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7162         GO TO 0110-UPDATE-UP.
  7163
  7164     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7165     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7166     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7167     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7168     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7169     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7170     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7171     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7172     GO TO 0120-UPDATE-PI-EXIT.
  7173
  7174 0110-UPDATE-UP.
  7175     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7176     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7177     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7178     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7179     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7180     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7181     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7182     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7183
  7184
  7185* EXEC CICS HANDLE CONDITION
  7186*         QIDERR    (0130-TS-ERROR)
  7187*         ITEMERR   (0130-TS-ERROR)
  7188*    END-EXEC.
  7189*    MOVE '"$N<                  ! # #00007127' TO DFHEIV0
  7190     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7192     MOVE X'2320233030303037313237' TO DFHEIV0(25:11)
  7193     CALL 'kxdfhei1' USING DFHEIV0
  7194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7195
  7196
  7197
  7198* EXEC CICS READQ TS
  7199*         QUEUE    (PI-KEY)
  7200*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7201*         LENGTH   (PI-COMM-LENGTH)
  7202*    END-EXEC.
  7203*    MOVE '*$I    L              ''   #00007132' TO DFHEIV0
  7204     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7206     MOVE X'2020233030303037313332' TO DFHEIV0(25:11)
  7207     CALL 'kxdfhei1' USING DFHEIV0,
  7208           PI-KEY,
  7209           PROGRAM-INTERFACE-BLOCK,
  7210           PI-COMM-LENGTH,
  7211           DFHEIV99,
  7212           DFHEIV99,
  7213           DFHEIV99
  7214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7215
  7216
  7217
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL131.cbl
  7218* EXEC CICS DELETEQ TS
  7219*         QUEUE    (PI-KEY)
  7220*    END-EXEC.
  7221*    MOVE '*&                    #   #00007138' TO DFHEIV0
  7222     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7224     MOVE X'2020233030303037313338' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           PI-KEY,
  7227           DFHEIV99
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7229
  7230
  7231 0120-UPDATE-PI-EXIT.
  7232     EXIT.
  7233
  7234 0130-TS-ERROR.
  7235     MOVE LOW-VALUES             TO EL131AO.
  7236     MOVE ER-0192                TO EMI-ERROR.
  7237
  7238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7239
  7240     GO TO 8100-SEND-MAP.
  7241
  7242 0200-TRANS-PF.
  7243     IF EIBAID NOT = DFHENTER
  7244         MOVE 'X'                TO ERROR-SWITCH
  7245         GO TO 0210-EXIT.
  7246
  7247     IF PFKEYI NOT NUMERIC
  7248         MOVE 'X'                TO ERROR-SWITCH
  7249         GO TO 0210-EXIT.
  7250
  7251     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7252
  7253     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7254         MOVE 'X' TO ERROR-SWITCH
  7255         GO TO 0210-EXIT.
  7256
  7257     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7258
  7259 0210-EXIT.
  7260     EXIT.
  7261
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL131.cbl
  7263 0500-ADD-ALPHA-ONLY.
  7264******************************************************************
  7265*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7266*    RECORD.                                                     *
  7267******************************************************************
  7268
  7269     IF MLNAMEL = +0 AND
  7270        MFNAMEL = +0 AND
  7271        MMINITL = +0
  7272         MOVE ER-0797                TO  EMI-ERROR
  7273         MOVE -1                     TO  MAINTL
  7274         MOVE AL-UABON               TO  MAINTA
  7275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7276         GO TO 8110-SEND-DATA.
  7277
  7278     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7279     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7280     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7281     MOVE PI-CERT-NO                 TO  CERT-NO.
  7282
  7283
  7284* EXEC CICS READ
  7285*        DATASET   (CLMS-FILE-ID)
  7286*        RIDFLD    (MSTR-KEY)
  7287*        SET       (ADDRESS OF CLAIM-MASTER)
  7288*    END-EXEC.
  7289*    MOVE '&"S        E          (   #00007194' TO DFHEIV0
  7290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7292     MOVE X'2020233030303037313934' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0,
  7294           CLMS-FILE-ID,
  7295           DFHEIV20,
  7296           DFHEIV99,
  7297           MSTR-KEY,
  7298           DFHEIV99,
  7299           DFHEIV99,
  7300           DFHEIV99
  7301     SET ADDRESS OF CLAIM-MASTER TO
  7302         DFHEIV20
  7303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7304
  7305
  7306
  7307* EXEC CICS GETMAIN
  7308*        SET       (ADDRESS OF ALPHA-INDEX)
  7309*        LENGTH    (ALPH-LENGTH)
  7310*        INITIMG   (GETMAIN-SPACE)
  7311*    END-EXEC.
  7312*    MOVE ',"IL                  $   #00007200' TO DFHEIV0
  7313     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7315     MOVE X'2020233030303037323030' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0,
  7317           DFHEIV20,
  7318           ALPH-LENGTH,
  7319           GETMAIN-SPACE
  7320     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL131.cbl
  7321         DFHEIV20
  7322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7323
  7324
  7325     MOVE 'AI'                       TO  AI-RECORD-ID.
  7326     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7327                                         AI-CL-COMPANY-CD.
  7328     MOVE 'C'                        TO  AI-SOURCE
  7329                                         AI-CL-SOURCE.
  7330
  7331     IF MLNAMEL IS GREATER THAN +0
  7332         MOVE MLNAMEI                TO  AI-LAST-NAME
  7333     ELSE
  7334         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7335
  7336     IF MFNAMEL IS GREATER THAN +0
  7337         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7338     ELSE
  7339         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7340
  7341     IF MMINITL IS GREATER THAN +0
  7342         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7343     ELSE
  7344         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7345
  7346     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7347     MOVE '5'                        TO  DC-OPTION-CODE.
  7348     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7349     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7350     IF BUILD-YEAR IS GREATER THAN 50
  7351         MOVE '19'                   TO  WS-ALPHA-YY-1
  7352         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7353         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7354         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7355     ELSE
  7356         MOVE '20'                   TO  WS-ALPHA-YY-1
  7357         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7358         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7359         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7360
  7361     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7362                                         AI-CL-DATE.
  7363
  7364     MOVE EIBTIME                    TO  AI-TIME
  7365                                         AI-CL-TIME.
  7366
  7367     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7368     MOVE 'C'                        TO  AI-CL-SOURCE.
  7369     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7370     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7371     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7372     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7373     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7374
  7375     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7376     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7377     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL131.cbl
  7379
  7380* EXEC CICS WRITE
  7381*        DATASET   (ALPH-FILE-ID)
  7382*        RIDFLD    (AI-CONTROL-PRIMARY)
  7383*        FROM      (ALPHA-INDEX)
  7384*    END-EXEC.
  7385     MOVE LENGTH OF
  7386      ALPHA-INDEX
  7387       TO DFHEIV11
  7388*    MOVE '&$ L                  ''   #00007260' TO DFHEIV0
  7389     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7391     MOVE X'2020233030303037323630' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0,
  7393           ALPH-FILE-ID,
  7394           ALPHA-INDEX,
  7395           DFHEIV11,
  7396           AI-CONTROL-PRIMARY,
  7397           DFHEIV99,
  7398           DFHEIV99
  7399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7400
  7401
  7402     MOVE LOW-VALUES                 TO  EL131AO.
  7403     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7404     MOVE ER-0000                    TO  EMI-ERROR.
  7405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7406     MOVE -1                         TO  MAINTL.
  7407     GO TO 8100-SEND-MAP.
  7408
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL131.cbl
  7410 0600-CHANGE-NAME.
  7411******************************************************************
  7412*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7413*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7414******************************************************************
  7415
  7416     IF MLNAMEL = +0 AND
  7417        MFNAMEL = +0 AND
  7418        MMINITL = +0
  7419         MOVE ER-0276                TO  EMI-ERROR
  7420         MOVE -1                     TO  MAINTL
  7421         MOVE AL-UABON               TO  MAINTA
  7422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7423         GO TO 8110-SEND-DATA.
  7424
  7425     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7426     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7427     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7428     MOVE PI-CERT-NO                 TO  CERT-NO.
  7429
  7430
  7431* EXEC CICS READ
  7432*        DATASET   (CLMS-FILE-ID)
  7433*        RIDFLD    (MSTR-KEY)
  7434*        SET       (ADDRESS OF CLAIM-MASTER)
  7435*    END-EXEC.
  7436*    MOVE '&"S        E          (   #00007294' TO DFHEIV0
  7437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7439     MOVE X'2020233030303037323934' TO DFHEIV0(25:11)
  7440     CALL 'kxdfhei1' USING DFHEIV0,
  7441           CLMS-FILE-ID,
  7442           DFHEIV20,
  7443           DFHEIV99,
  7444           MSTR-KEY,
  7445           DFHEIV99,
  7446           DFHEIV99,
  7447           DFHEIV99
  7448     SET ADDRESS OF CLAIM-MASTER TO
  7449         DFHEIV20
  7450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7451
  7452
  7453
  7454* EXEC CICS GETMAIN
  7455*        SET       (ADDRESS OF ALPHA-INDEX)
  7456*        LENGTH    (ALPH-LENGTH)
  7457*        INITIMG   (GETMAIN-SPACE)
  7458*    END-EXEC.
  7459*    MOVE ',"IL                  $   #00007300' TO DFHEIV0
  7460     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7461     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7462     MOVE X'2020233030303037333030' TO DFHEIV0(25:11)
  7463     CALL 'kxdfhei1' USING DFHEIV0,
  7464           DFHEIV20,
  7465           ALPH-LENGTH,
  7466           GETMAIN-SPACE
  7467     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL131.cbl
  7468         DFHEIV20
  7469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7470
  7471
  7472     MOVE 'AI'                       TO  AI-RECORD-ID.
  7473     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7474                                         AI-CL-COMPANY-CD.
  7475     MOVE 'C'                        TO  AI-SOURCE
  7476                                         AI-CL-SOURCE.
  7477
  7478     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7479     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7480     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7481
  7482     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7483     MOVE '5'                        TO  DC-OPTION-CODE.
  7484     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7485     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7486     IF BUILD-YEAR IS GREATER THAN 50
  7487         MOVE '19'                   TO  WS-ALPHA-YY-1
  7488         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7489         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7490         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7491     ELSE
  7492         MOVE '20'                   TO  WS-ALPHA-YY-1
  7493         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7494         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7495         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7496
  7497     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7498                                         AI-CL-DATE.
  7499
  7500     MOVE EIBTIME                    TO  AI-TIME
  7501                                         AI-CL-TIME.
  7502
  7503     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7504     MOVE 'C'                        TO  AI-CL-SOURCE.
  7505     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7506     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7507     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7508     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7509     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7510
  7511     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7512     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7513     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7514
  7515     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7516         MOVE 'Y'                TO CL-YESNOSW
  7517     END-IF.
  7518
  7519
  7520* EXEC CICS WRITE
  7521*        DATASET   (ALPH-FILE-ID)
  7522*        RIDFLD    (AI-CONTROL-PRIMARY)
  7523*        FROM      (ALPHA-INDEX)
  7524*    END-EXEC.
  7525     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL131.cbl
  7526      ALPHA-INDEX
  7527       TO DFHEIV11
  7528*    MOVE '&$ L                  ''   #00007353' TO DFHEIV0
  7529     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7530     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7531     MOVE X'2020233030303037333533' TO DFHEIV0(25:11)
  7532     CALL 'kxdfhei1' USING DFHEIV0,
  7533           ALPH-FILE-ID,
  7534           ALPHA-INDEX,
  7535           DFHEIV11,
  7536           AI-CONTROL-PRIMARY,
  7537           DFHEIV99,
  7538           DFHEIV99
  7539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7540
  7541
  7542
  7543* EXEC CICS READ
  7544*        DATASET   (CLMS-FILE-ID)
  7545*        RIDFLD    (MSTR-KEY)
  7546*        SET       (ADDRESS OF CLAIM-MASTER)
  7547*        UPDATE
  7548*    END-EXEC.
  7549*    MOVE '&"S        EU         (   #00007359' TO DFHEIV0
  7550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7552     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
  7554           CLMS-FILE-ID,
  7555           DFHEIV20,
  7556           DFHEIV99,
  7557           MSTR-KEY,
  7558           DFHEIV99,
  7559           DFHEIV99,
  7560           DFHEIV99
  7561     SET ADDRESS OF CLAIM-MASTER TO
  7562         DFHEIV20
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7564
  7565
  7566     if (cl-priority-cd = '8')
  7567        and (pi-processor-id not = 'PEMA'and 'JMS '
  7568             AND 'AMWA')
  7569        MOVE ER-8003             TO EMI-ERROR
  7570        PERFORM 9900-ERROR-FORMAT
  7571                                 THRU 9900-EXIT
  7572        MOVE -1                  TO MAINTL
  7573        GO TO 8110-SEND-DATA
  7574     end-if
  7575
  7576     IF MLNAMEL IS GREATER THAN +0
  7577         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7578
  7579     IF MFNAMEL IS GREATER THAN +0
  7580         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7581
  7582     IF MMINITL IS GREATER THAN +0
  7583         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL131.cbl
  7584
  7585     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7586     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7587     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7588     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7589
  7590     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7591         MOVE 'Y'                TO CL-YESNOSW
  7592     END-IF.
  7593
  7594
  7595* EXEC CICS HANDLE CONDITION
  7596*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7597*    END-EXEC.
  7598*    MOVE '"$$                   ! $ #00007394' TO DFHEIV0
  7599     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7601     MOVE X'2420233030303037333934' TO DFHEIV0(25:11)
  7602     CALL 'kxdfhei1' USING DFHEIV0
  7603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7604
  7605
  7606
  7607* EXEC CICS REWRITE
  7608*        DATASET   (CLMS-FILE-ID)
  7609*        FROM      (CLAIM-MASTER)
  7610*    END-EXEC.
  7611     MOVE LENGTH OF
  7612      CLAIM-MASTER
  7613       TO DFHEIV11
  7614*    MOVE '&& L                  %   #00007398' TO DFHEIV0
  7615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7617     MOVE X'2020233030303037333938' TO DFHEIV0(25:11)
  7618     CALL 'kxdfhei1' USING DFHEIV0,
  7619           CLMS-FILE-ID,
  7620           CLAIM-MASTER,
  7621           DFHEIV11,
  7622           DFHEIV99
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625
  7626 0600-CONTINUE-NAME-UPDATE.
  7627
  7628     MOVE LOW-VALUES                 TO  EL131AO.
  7629     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7630     MOVE ER-0000                    TO  EMI-ERROR.
  7631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7632     MOVE -1                         TO  MAINTL.
  7633     GO TO 8100-SEND-MAP.
  7634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL131.cbl
  7636 1000-EDIT-SCREEN.
  7637
  7638     MOVE MAINTI                 TO CHECK-MAINT.
  7639
  7640     IF NOT VALID-OPTIONS
  7641         MOVE 'X'                TO ERROR-SWITCH
  7642         MOVE -1                 TO MAINTL
  7643         MOVE AL-UABON           TO MAINTA
  7644         MOVE ER-0023            TO EMI-ERROR
  7645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7646         GO TO 1010-EXIT.
  7647
  7648     IF NOT MODIFY-CAP
  7649         MOVE 'UPDATE'           TO  SM-READ
  7650         PERFORM 9995-SECURITY-VIOLATION
  7651         MOVE ER-0070               TO  EMI-ERROR
  7652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7653         GO TO 8100-SEND-MAP.
  7654
  7655     IF DELETE-CLAIM
  7656         MOVE AL-UANON TO MAINTA
  7657         GO TO 1010-EXIT.
  7658
  7659     MOVE AL-UANON               TO MAINTA.
  7660
  7661     IF CCNOI GREATER THAN LOW-VALUES
  7662         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7663
  7664     IF PI-COMPANY-ID = 'CSL'
  7665        CONTINUE
  7666     ELSE
  7667        IF TYPEL > ZERO
  7668           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7669              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7670                    PI-LIFE-OVERRIDE-L1))
  7671                       OR
  7672              ((PI-COMPANY-ID = 'DCC')
  7673              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7674                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7675              MOVE AL-UANON      TO TYPEA
  7676              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7677           ELSE
  7678              MOVE ER-0199       TO EMI-ERROR
  7679              PERFORM 9900-ERROR-FORMAT
  7680                                 THRU 9900-EXIT
  7681              MOVE AL-UABON      TO TYPEA
  7682              MOVE -1            TO TYPEL
  7683              MOVE 'X'           TO ERROR-SWITCH
  7684           END-IF
  7685        ELSE
  7686           MOVE AL-UANOF         TO TYPEA
  7687        END-IF
  7688     END-IF
  7689     IF STATUSI GREATER THAN LOW-VALUES
  7690         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7691             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7692             MOVE AL-UANON       TO STATUSA
  7693             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL131.cbl
  7694             MOVE 'Y'            TO DLYACTV-SW
  7695         ELSE
  7696             MOVE ER-0333        TO EMI-ERROR
  7697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7698             MOVE AL-UABON       TO STATUSA
  7699             MOVE -1             TO STATUSL
  7700             MOVE 'X'            TO ERROR-SWITCH
  7701         END-IF
  7702     ELSE
  7703         MOVE SPACE              TO TRLR-SWITCH
  7704         MOVE 'N'                TO DLYACTV-SW
  7705         MOVE AL-UANOF           TO STATUSA.
  7706
  7707     IF PROCI GREATER THAN LOW-VALUES
  7708         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  7709     ELSE
  7710         MOVE AL-UANOF TO PROCA.
  7711
  7712     IF SEXI GREATER THAN LOW-VALUES
  7713         IF SEXI = 'F' OR 'M'
  7714             MOVE AL-UANON       TO SEXA
  7715             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7716           ELSE
  7717             MOVE ER-0219        TO EMI-ERROR
  7718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7719             MOVE AL-UABON       TO SEXA
  7720             MOVE -1             TO SEXL
  7721             MOVE 'X'            TO ERROR-SWITCH
  7722       ELSE
  7723         MOVE AL-UANOF           TO SEXA.
  7724
  7725     IF BIRTHL = +0
  7726         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7727         MOVE AL-UANOF           TO  BIRTHA
  7728         GO TO 1000-CONTINUE-EDITS.
  7729
  7730     IF BIRTHI = SPACES
  7731         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7732         MOVE 'X'                TO  UPDATE-SWITCH
  7733                                     MSTR-SWITCH
  7734         GO TO 1000-CONTINUE-EDITS.
  7735
  7736     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  7737     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  7738     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  7739     MOVE '4'                    TO  DC-OPTION-CODE.
  7740     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7741     IF DATE-CONVERSION-ERROR
  7742         MOVE ER-0220            TO  EMI-ERROR
  7743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7744         MOVE AL-UABON           TO  BIRTHA
  7745         MOVE -1                 TO  BIRTHL
  7746         MOVE 'X'                TO  ERROR-SWITCH
  7747         GO TO 1000-CONTINUE-EDITS.
  7748
  7749******************************************************************
  7750**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  7751**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL131.cbl
  7752**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  7753******************************************************************
  7754     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  7755         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  7756         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  7757         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  7758         MOVE '4'                TO  DC-OPTION-CODE
  7759         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  7760         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7761                                     DC-ELAPSED-DAYS
  7762         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7763         IF DATE-CONVERSION-ERROR
  7764             MOVE ER-0220        TO  EMI-ERROR
  7765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7766             MOVE AL-UABON       TO  BIRTHA
  7767             MOVE -1             TO  BIRTHL
  7768             MOVE 'X'            TO  ERROR-SWITCH
  7769             GO TO 1000-CONTINUE-EDITS.
  7770
  7771     MOVE AL-UANON               TO  BIRTHA.
  7772     MOVE 'X'                    TO  UPDATE-SWITCH
  7773                                     MSTR-SWITCH.
  7774     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  7775     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  7776     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  7777
  7778 1000-CONTINUE-EDITS.
  7779
  7780     IF SOCIALI GREATER THAN LOW-VALUES
  7781         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  7782         IF WS-SOC-SEC-NO NUMERIC AND
  7783           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  7784             NEXT SENTENCE
  7785         ELSE
  7786            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  7787               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  7788               WS-SSN-DASH2 = '-'
  7789                 NEXT SENTENCE
  7790            ELSE
  7791                 MOVE ER-0887        TO  EMI-ERROR
  7792                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7793                 MOVE AL-UABON       TO  SOCIALA
  7794                 MOVE -1             TO  SOCIALL
  7795                 MOVE 'X'            TO  ERROR-SWITCH
  7796            END-IF
  7797        END-IF
  7798     END-IF.
  7799
  7800     IF SOCIALI GREATER THAN LOW-VALUES
  7801         MOVE AL-UANON           TO SOCIALA
  7802         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  7803     ELSE
  7804         MOVE AL-UANOF           TO SOCIALA.
  7805
  7806     IF OCCI GREATER THAN LOW-VALUES
  7807         MOVE AL-UANON           TO OCCA
  7808         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7809     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL131.cbl
  7810         MOVE AL-UANOF           TO OCCA.
  7811
  7812     IF BENEL NOT GREATER THAN ZERO
  7813            GO TO 1005-CONTINUE-EDITS.
  7814
  7815     IF BENEI = SPACES
  7816        MOVE 'X'                 TO UPDATE-SWITCH MSTR-SWITCH
  7817        GO TO 1005-CONTINUE-EDITS.
  7818
  7819
  7820* EXEC CICS HANDLE CONDITION
  7821*        NOTFND (1004-BENE-NOT-FOUND)
  7822*    END-EXEC.
  7823*    MOVE '"$I                   ! % #00007596' TO DFHEIV0
  7824     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7826     MOVE X'2520233030303037353936' TO DFHEIV0(25:11)
  7827     CALL 'kxdfhei1' USING DFHEIV0
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  7832     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  7833     MOVE BENEI                  TO  WS-ELBENE-ID.
  7834
  7835
  7836* EXEC CICS READ
  7837*        DATASET ('ELBENE')
  7838*        RIDFLD  (WS-ELBENE-KEY)
  7839*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  7840*    END-EXEC.
  7841     MOVE 'ELBENE' TO DFHEIV1
  7842*    MOVE '&"S        E          (   #00007604' TO DFHEIV0
  7843     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7845     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  7846     CALL 'kxdfhei1' USING DFHEIV0,
  7847           DFHEIV1,
  7848           DFHEIV20,
  7849           DFHEIV99,
  7850           WS-ELBENE-KEY,
  7851           DFHEIV99,
  7852           DFHEIV99,
  7853           DFHEIV99
  7854     SET ADDRESS OF BENEFICIARY-MASTER TO
  7855         DFHEIV20
  7856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7857
  7858
  7859     MOVE AL-UANON               TO  BENEA.
  7860     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7861
  7862     GO TO 1005-CONTINUE-EDITS.
  7863
  7864 1004-BENE-NOT-FOUND.
  7865     MOVE ER-0565                TO  EMI-ERROR.
  7866
  7867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL131.cbl
  7868     MOVE 'X'                    TO ERROR-SWITCH.
  7869     MOVE AL-UABON               TO BENEA.
  7870     MOVE -1                     TO BENEL.
  7871
  7872 1005-CONTINUE-EDITS.
  7873
  7874     IF DIAGI GREATER THAN LOW-VALUES
  7875         MOVE AL-UANON           TO DIAGA
  7876         MOVE 'X'                TO UPDATE-SWITCH
  7877                                    NINETY-TRLR-SWITCH
  7878     ELSE
  7879         MOVE AL-UANOF           TO DIAGA.
  7880
  7881     IF CAUSEI GREATER THAN LOW-VALUES
  7882         MOVE AL-UANON           TO CAUSEA
  7883         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7884     ELSE
  7885         MOVE AL-UANOF           TO CAUSEA.
  7886
  7887     IF ENDL GREATER THAN ZERO
  7888         MOVE LOW-VALUES         TO HOLD-END
  7889         IF ENDI = SPACES
  7890             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7891         ELSE
  7892             MOVE ENDI           TO DEEDIT-DATE-INPUT
  7893
  7894* EXEC CICS BIF DEEDIT
  7895*                FIELD    (DEEDIT-DATE-INPUT)
  7896*                LENGTH   (DATE-LENGTH)
  7897*            END-EXEC
  7898*    MOVE '@"L                   #   #00007644' TO DFHEIV0
  7899     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7900     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7901     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7902     CALL 'kxdfhei1' USING DFHEIV0,
  7903           DEEDIT-DATE-INPUT,
  7904           DATE-LENGTH
  7905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7906             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7907             MOVE '4'            TO DC-OPTION-CODE
  7908             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7909             IF NOT DATE-CONVERSION-ERROR
  7910                 MOVE DC-BIN-DATE-1      TO HOLD-END
  7911                 MOVE AL-UANON   TO ENDA
  7912                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7913                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  7914             ELSE
  7915                 MOVE ER-0224    TO EMI-ERROR
  7916                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7917                 MOVE AL-UABON   TO ENDA
  7918                 MOVE -1         TO ENDL
  7919                 MOVE 'X'        TO ERROR-SWITCH
  7920       ELSE
  7921           MOVE AL-UANOF         TO ENDA.
  7922
  7923     IF INCL GREATER THAN ZERO
  7924         MOVE LOW-VALUES         TO HOLD-INCUR
  7925         IF INCI = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL131.cbl
  7926             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7927         ELSE
  7928             MOVE INCI           TO DEEDIT-DATE-INPUT
  7929
  7930* EXEC CICS BIF DEEDIT
  7931*                FIELD    (DEEDIT-DATE-INPUT)
  7932*                LENGTH   (DATE-LENGTH)
  7933*            END-EXEC
  7934*    MOVE '@"L                   #   #00007671' TO DFHEIV0
  7935     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7936     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7937     MOVE X'2020233030303037363731' TO DFHEIV0(25:11)
  7938     CALL 'kxdfhei1' USING DFHEIV0,
  7939           DEEDIT-DATE-INPUT,
  7940           DATE-LENGTH
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7942             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7943             MOVE '4'            TO DC-OPTION-CODE
  7944             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7945             IF NOT DATE-CONVERSION-ERROR
  7946                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  7947                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7948                 MOVE AL-UANON           TO INCA
  7949                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  7950             ELSE
  7951                 MOVE ER-0222    TO EMI-ERROR
  7952                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7953                 MOVE AL-UABON   TO INCA
  7954                 MOVE -1         TO INCL
  7955                 MOVE 'X'        TO ERROR-SWITCH
  7956       ELSE
  7957           IF PI-NO-PMTS = ZEROS
  7958               MOVE AL-UANOF     TO INCA.
  7959
  7960     IF REPL GREATER THAN ZERO
  7961         MOVE LOW-VALUES         TO HOLD-REPORTED
  7962         IF REPI = SPACES
  7963             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7964         ELSE
  7965             MOVE REPI           TO DEEDIT-DATE-INPUT
  7966
  7967* EXEC CICS BIF DEEDIT
  7968*                FIELD    (DEEDIT-DATE-INPUT)
  7969*                LENGTH   (DATE-LENGTH)
  7970*            END-EXEC
  7971*    MOVE '@"L                   #   #00007699' TO DFHEIV0
  7972     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7973     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7974     MOVE X'2020233030303037363939' TO DFHEIV0(25:11)
  7975     CALL 'kxdfhei1' USING DFHEIV0,
  7976           DEEDIT-DATE-INPUT,
  7977           DATE-LENGTH
  7978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7979             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7980             MOVE '4'            TO DC-OPTION-CODE
  7981             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7982             IF NOT DATE-CONVERSION-ERROR
  7983                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL131.cbl
  7984                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7985                 MOVE AL-UANON   TO REPA
  7986                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  7987             ELSE
  7988                 MOVE ER-0223    TO EMI-ERROR
  7989                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7990                 MOVE AL-UABON   TO REPA
  7991                 MOVE -1         TO REPL
  7992                 MOVE 'X'        TO ERROR-SWITCH
  7993       ELSE
  7994         MOVE AL-UANOF TO REPA.
  7995
  7996     IF PDTHRUI GREATER THAN LOW-VALUES
  7997        MOVE LOW-VALUES         TO HOLD-PDTHRU
  7998        IF PDTHRUI = SPACES
  7999           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8000        ELSE
  8001           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8002
  8003* EXEC CICS BIF DEEDIT
  8004*               FIELD    (DEEDIT-DATE-INPUT)
  8005*               LENGTH   (DATE-LENGTH)
  8006*          END-EXEC
  8007*    MOVE '@"L                   #   #00007726' TO DFHEIV0
  8008     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8009     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8010     MOVE X'2020233030303037373236' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0,
  8012           DEEDIT-DATE-INPUT,
  8013           DATE-LENGTH
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8015           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8016           MOVE '4'            TO DC-OPTION-CODE
  8017           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8018           IF NOT DATE-CONVERSION-ERROR
  8019              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8020              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8021              MOVE AL-UANON   TO PDTHRUA
  8022              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8023              IF PI-USES-PAID-TO
  8024                 MOVE '6'            TO DC-OPTION-CODE
  8025                 MOVE -1             TO DC-ELAPSED-DAYS
  8026                 MOVE +0             TO DC-ELAPSED-MONTHS
  8027                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8028                 IF NO-CONVERSION-ERROR
  8029                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8030                 ELSE
  8031                    NEXT SENTENCE
  8032              ELSE
  8033                 NEXT SENTENCE
  8034           ELSE
  8035              MOVE ER-0475    TO EMI-ERROR
  8036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8037              MOVE AL-UABON   TO PDTHRUA
  8038              MOVE -1         TO PDTHRUL
  8039              MOVE 'X'        TO ERROR-SWITCH
  8040     ELSE
  8041        IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL131.cbl
  8042           MOVE AL-UANOF        TO PDTHRUA.
  8043
  8044     IF PDAMTL GREATER THAN +0
  8045         MOVE ZEROS              TO HOLD-PDAMT
  8046
  8047* EXEC CICS BIF DEEDIT
  8048*            FIELD    (PDAMTI)
  8049*            LENGTH   (9)
  8050*        END-EXEC
  8051     MOVE 9
  8052       TO DFHEIV11
  8053*    MOVE '@"L                   #   #00007761' TO DFHEIV0
  8054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8056     MOVE X'2020233030303037373631' TO DFHEIV0(25:11)
  8057     CALL 'kxdfhei1' USING DFHEIV0,
  8058           PDAMTI,
  8059           DFHEIV11
  8060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8061         IF PDAMTI NUMERIC
  8062             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8063             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8064             MOVE AL-UNNON       TO PDAMTA
  8065         ELSE
  8066             MOVE ER-0547        TO EMI-ERROR
  8067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8068             MOVE AL-UNBON       TO PDAMTA
  8069             MOVE -1             TO PDAMTL
  8070             MOVE 'X'            TO ERROR-SWITCH
  8071     ELSE
  8072         IF MODIFY-CAP
  8073            MOVE AL-UNNOF        TO PDAMTA.
  8074
  8075     IF NODAYSI GREATER THAN LOW-VALUES
  8076         MOVE ZEROS              TO HOLD-NODAYS
  8077
  8078* EXEC CICS BIF DEEDIT
  8079*            FIELD (NODAYSI)
  8080*            LENGTH (5)
  8081*        END-EXEC
  8082     MOVE 5
  8083       TO DFHEIV11
  8084*    MOVE '@"L                   #   #00007781' TO DFHEIV0
  8085     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8086     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8087     MOVE X'2020233030303037373831' TO DFHEIV0(25:11)
  8088     CALL 'kxdfhei1' USING DFHEIV0,
  8089           NODAYSI,
  8090           DFHEIV11
  8091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8092         IF NODAYSI NUMERIC
  8093             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8094             MOVE AL-UNNON       TO NODAYSA
  8095             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8096         ELSE
  8097             MOVE ER-0491        TO EMI-ERROR
  8098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8099             MOVE AL-UNBON       TO NODAYSA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL131.cbl
  8100             MOVE -1             TO NODAYSL
  8101             MOVE 'X'            TO ERROR-SWITCH
  8102     ELSE
  8103         IF MODIFY-CAP
  8104            MOVE AL-UNNOF        TO NODAYSA.
  8105
  8106     IF NOPMTSI GREATER THAN LOW-VALUES
  8107         MOVE ZEROS              TO HOLD-NOPMTS
  8108
  8109* EXEC CICS BIF DEEDIT
  8110*            FIELD (NOPMTSI)
  8111*            LENGTH (4)
  8112*        END-EXEC
  8113     MOVE 4
  8114       TO DFHEIV11
  8115*    MOVE '@"L                   #   #00007801' TO DFHEIV0
  8116     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8117     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8118     MOVE X'2020233030303037383031' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           NOPMTSI,
  8121           DFHEIV11
  8122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8123         IF NOPMTSI NUMERIC
  8124             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8125             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8126             MOVE AL-UNNON       TO NOPMTSA
  8127           ELSE
  8128             MOVE ER-0548        TO EMI-ERROR
  8129             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8130             MOVE AL-UNBON       TO NOPMTSA
  8131             MOVE -1             TO NOPMTSL
  8132             MOVE 'X'            TO ERROR-SWITCH
  8133       ELSE
  8134         IF MODIFY-CAP
  8135            MOVE AL-UNNOF        TO NOPMTSA.
  8136
  8137     IF FORMTYPI GREATER THAN LOW-VALUES
  8138         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8139             MOVE AL-UANON       TO FORMTYPA
  8140             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8141           ELSE
  8142             MOVE ER-7650        TO EMI-ERROR
  8143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8144             MOVE AL-UABON       TO FORMTYPA
  8145             MOVE -1             TO FORMTYPL
  8146             MOVE 'X'            TO ERROR-SWITCH
  8147       ELSE
  8148         MOVE AL-UANOF           TO FORMTYPA.
  8149
  8150     IF PRICDL GREATER THAN ZERO
  8151         IF (PRICDI = ' ') OR
  8152            (PRICDI GREATER THAN ZERO   AND
  8153             PRICDI NOT GREATER THAN '9')
  8154             MOVE AL-UANON       TO PRICDA
  8155             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8156         ELSE
  8157             MOVE ER-0274        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL131.cbl
  8158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8159             MOVE AL-UABON       TO PRICDA
  8160             MOVE -1             TO PRICDL
  8161             MOVE 'X'            TO ERROR-SWITCH
  8162     ELSE
  8163         MOVE AL-UANOF TO PRICDA.
  8164
  8165     IF PI-COMPANY-ID = 'DMD'
  8166     IF PRICDL GREATER THAN ZERO
  8167       IF SYSTEM-MODIFY-CAP  OR
  8168          PI-PROCESSOR-ID = 'LGXX'
  8169             NEXT SENTENCE
  8170           ELSE
  8171            IF CL-PRIORITY-CD = '9'  OR
  8172               PRICDI         = '9'
  8173                  MOVE ER-0938        TO EMI-ERROR
  8174                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8175                  MOVE AL-UABON       TO PRICDA
  8176                  MOVE -1             TO PRICDL
  8177                  MOVE 'X'            TO ERROR-SWITCH.
  8178
  8179     IF FILETOL GREATER THAN ZERO
  8180         MOVE AL-UANON           TO FILETOA
  8181         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8182     ELSE
  8183         MOVE AL-UANOF TO FILETOA.
  8184
  8185     IF SUPVL GREATER THAN ZERO
  8186         IF SUPVI = 'Y' OR 'N' OR SPACE
  8187             MOVE AL-UANON       TO SUPVA
  8188             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8189         ELSE
  8190             MOVE ER-0230        TO EMI-ERROR
  8191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8192             MOVE AL-UABON       TO SUPVA
  8193             MOVE -1             TO SUPVL
  8194             MOVE 'X'            TO ERROR-SWITCH
  8195     ELSE
  8196         MOVE AL-UANOF           TO SUPVA.
  8197
  8198     IF MLNAMEL GREATER THAN ZERO
  8199         IF MLNAMEI GREATER THAN SPACES
  8200            MOVE AL-UANON        TO MLNAMEA
  8201            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8202                                     MSTR-KEY-SWITCH
  8203         ELSE
  8204            MOVE ER-0236         TO EMI-ERROR
  8205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8206            MOVE AL-UABON        TO MLNAMEA
  8207            MOVE -1              TO MLNAMEL
  8208            MOVE 'X'             TO ERROR-SWITCH
  8209     ELSE
  8210         MOVE AL-UANOF           TO MLNAMEA.
  8211
  8212     IF MFNAMEI GREATER THAN LOW-VALUES
  8213         MOVE AL-UANON           TO MFNAMEA
  8214         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8215     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL131.cbl
  8216         MOVE AL-UANOF           TO MFNAMEA.
  8217
  8218     IF MMINITI GREATER THAN LOW-VALUES
  8219         MOVE AL-UANON           TO MMINITA
  8220         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8221     ELSE
  8222         MOVE AL-UANOF           TO MMINITA.
  8223
  8224     IF CRTLNMEI GREATER THAN LOW-VALUES
  8225         IF CRTLNMEI NOT = SPACES
  8226            MOVE AL-UANON        TO CRTLNMEA
  8227            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8228                                     CERT-KEY-SWITCH
  8229        ELSE
  8230            MOVE ER-0236         TO EMI-ERROR
  8231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8232            MOVE AL-UABON        TO CRTLNMEA
  8233            MOVE -1              TO CRTLNMEL
  8234            MOVE 'X'             TO ERROR-SWITCH
  8235     ELSE
  8236         MOVE AL-UANOF           TO CRTLNMEA.
  8237
  8238     IF CRTFNMEI GREATER THAN LOW-VALUES
  8239         MOVE AL-UANON           TO CRTFNMEA
  8240         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8241     ELSE
  8242         MOVE AL-UANOF           TO CRTFNMEA.
  8243
  8244     IF CRTINITI GREATER THAN LOW-VALUES
  8245         MOVE AL-UANON           TO CRTINITA
  8246         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8247     ELSE
  8248         MOVE AL-UANOF           TO CRTINITA.
  8249
  8250     IF ISSAGEL GREATER THAN ZERO
  8251         IF ISSAGEI NUMERIC
  8252            MOVE AL-UANON        TO ISSAGEA
  8253            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8254         ELSE
  8255            MOVE ER-0237         TO EMI-ERROR
  8256            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257            MOVE AL-UABON        TO ISSAGEA
  8258            MOVE -1              TO ISSAGEL
  8259            MOVE 'X'             TO ERROR-SWITCH
  8260     ELSE
  8261         MOVE AL-UANOF           TO ISSAGEA.
  8262
  8263     IF JNTFNMEI GREATER THAN LOW-VALUES
  8264         MOVE AL-UANON           TO JNTFNMEA
  8265         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8266     ELSE
  8267         MOVE AL-UANOF           TO JNTFNMEA.
  8268
  8269     IF JNTLNMEI GREATER THAN LOW-VALUES
  8270         MOVE AL-UANON           TO JNTLNMEA
  8271         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8272     ELSE
  8273         MOVE AL-UANOF           TO JNTLNMEA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL131.cbl
  8274
  8275     IF JNTINITI GREATER THAN LOW-VALUES
  8276         MOVE AL-UANON           TO JNTINITA
  8277         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8278     ELSE
  8279         MOVE AL-UANOF           TO JNTINITA.
  8280
  8281     IF JNTAGEL GREATER THAN ZERO
  8282         IF JNTAGEI NUMERIC
  8283            MOVE AL-UANON        TO JNTAGEA
  8284            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8285         ELSE
  8286            MOVE ER-0238         TO EMI-ERROR
  8287            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8288            MOVE AL-UABON        TO JNTAGEA
  8289            MOVE -1              TO JNTAGEL
  8290            MOVE 'X'             TO ERROR-SWITCH
  8291     ELSE
  8292         MOVE AL-UANOF           TO JNTAGEA.
  8293
  8294     IF ADDONDTI GREATER THAN LOW-VALUES
  8295         MOVE LOW-VALUES         TO HOLD-ADDON
  8296         IF ADDONDTI = SPACES
  8297             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8298         ELSE
  8299             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8300
  8301* EXEC CICS BIF DEEDIT
  8302*                FIELD    (DEEDIT-DATE-INPUT)
  8303*                LENGTH   (DATE-LENGTH)
  8304*            END-EXEC
  8305*    MOVE '@"L                   #   #00007982' TO DFHEIV0
  8306     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8307     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8308     MOVE X'2020233030303037393832' TO DFHEIV0(25:11)
  8309     CALL 'kxdfhei1' USING DFHEIV0,
  8310           DEEDIT-DATE-INPUT,
  8311           DATE-LENGTH
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8313             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8314             MOVE '4'            TO DC-OPTION-CODE
  8315             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8316             IF NOT DATE-CONVERSION-ERROR
  8317                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8318                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8319                                                  CERT-SWITCH
  8320                 MOVE AL-UANON   TO ADDONDTA
  8321                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8322             ELSE
  8323                 MOVE ER-7651    TO EMI-ERROR
  8324                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8325                 MOVE AL-UABON   TO ADDONDTA
  8326                 MOVE -1         TO ADDONDTL
  8327                 MOVE 'X'        TO ERROR-SWITCH
  8328       ELSE
  8329         MOVE AL-UANOF TO ADDONDTA.
  8330
  8331     IF LCVCDI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL131.cbl
  8332         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8333         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8334     ELSE
  8335         MOVE AL-UANOF           TO LCVCDA.
  8336
  8337     IF ACVCDI GREATER THAN LOW-VALUES
  8338         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8339         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8340     ELSE
  8341         MOVE AL-UANOF           TO ACVCDA.
  8342
  8343     IF LCVOTRMI GREATER THAN LOW-VALUES
  8344
  8345* EXEC CICS BIF DEEDIT
  8346*            FIELD (LCVOTRMI)
  8347*            LENGTH(3)
  8348*        END-EXEC
  8349     MOVE 3
  8350       TO DFHEIV11
  8351*    MOVE '@"L                   #   #00008017' TO DFHEIV0
  8352     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8353     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8354     MOVE X'2020233030303038303137' TO DFHEIV0(25:11)
  8355     CALL 'kxdfhei1' USING DFHEIV0,
  8356           LCVOTRMI,
  8357           DFHEIV11
  8358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8359         IF LCVOTRMI IS NUMERIC
  8360             MOVE LCVOTRMI       TO LCVOTRMO
  8361             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8362             MOVE AL-UANON       TO LCVOTRMA
  8363         ELSE
  8364             MOVE ER-0241        TO EMI-ERROR
  8365             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8366             MOVE AL-UNBON       TO LCVOTRMA
  8367             MOVE 'X'            TO ERROR-SWITCH
  8368             MOVE -1             TO LCVOTRML
  8369     ELSE
  8370         MOVE AL-UANOF           TO LCVOTRMA.
  8371
  8372     IF ACVOTRMI GREATER THAN LOW-VALUES
  8373
  8374* EXEC CICS BIF DEEDIT
  8375*            FIELD (ACVOTRMI)
  8376*            LENGTH(3)
  8377*        END-EXEC
  8378     MOVE 3
  8379       TO DFHEIV11
  8380*    MOVE '@"L                   #   #00008035' TO DFHEIV0
  8381     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8382     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8383     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  8384     CALL 'kxdfhei1' USING DFHEIV0,
  8385           ACVOTRMI,
  8386           DFHEIV11
  8387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8388         IF ACVOTRMI IS NUMERIC
  8389             MOVE ACVOTRMI       TO ACVOTRMO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL131.cbl
  8390             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8391             MOVE AL-UANON       TO ACVOTRMA
  8392         ELSE
  8393             MOVE ER-0241        TO EMI-ERROR
  8394             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8395             MOVE AL-UNBON       TO ACVOTRMA
  8396             MOVE 'X'            TO ERROR-SWITCH
  8397             MOVE -1             TO ACVOTRML
  8398     ELSE
  8399         MOVE AL-UANOF           TO ACVOTRMA.
  8400
  8401     IF LCVRATEL GREATER THAN +0
  8402
  8403* EXEC CICS BIF DEEDIT
  8404*            FIELD (LCVRATEI)
  8405*            LENGTH(6)
  8406*        END-EXEC
  8407     MOVE 6
  8408       TO DFHEIV11
  8409*    MOVE '@"L                   #   #00008053' TO DFHEIV0
  8410     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8411     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8412     MOVE X'2020233030303038303533' TO DFHEIV0(25:11)
  8413     CALL 'kxdfhei1' USING DFHEIV0,
  8414           LCVRATEI,
  8415           DFHEIV11
  8416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8417         IF LCVRATEI IS NUMERIC
  8418             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8419             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8420             MOVE AL-UNNON       TO LCVRATEA
  8421         ELSE
  8422             MOVE ER-2280        TO EMI-ERROR
  8423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8424             MOVE AL-UNBON       TO LCVRATEA
  8425             MOVE 'X'            TO ERROR-SWITCH
  8426             MOVE -1             TO LCVRATEL
  8427     ELSE
  8428         MOVE AL-UNNOF           TO LCVRATEA.
  8429
  8430     IF ACVRATEL GREATER THAN +0
  8431
  8432* EXEC CICS BIF DEEDIT
  8433*            FIELD (ACVRATEI)
  8434*            LENGTH(6)
  8435*        END-EXEC
  8436     MOVE 6
  8437       TO DFHEIV11
  8438*    MOVE '@"L                   #   #00008071' TO DFHEIV0
  8439     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8440     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8441     MOVE X'2020233030303038303731' TO DFHEIV0(25:11)
  8442     CALL 'kxdfhei1' USING DFHEIV0,
  8443           ACVRATEI,
  8444           DFHEIV11
  8445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8446         IF ACVRATEI IS NUMERIC
  8447             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL131.cbl
  8448             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8449             MOVE AL-UNNON       TO ACVRATEA
  8450         ELSE
  8451             MOVE ER-2280        TO EMI-ERROR
  8452             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8453             MOVE AL-UNBON       TO ACVRATEA
  8454             MOVE 'X'            TO ERROR-SWITCH
  8455             MOVE -1             TO ACVRATEL
  8456     ELSE
  8457         MOVE AL-UNNOF           TO ACVRATEA.
  8458
  8459     IF LCVBENEL GREATER THAN ZERO
  8460
  8461* EXEC CICS BIF DEEDIT
  8462*            FIELD (LCVBENEI)
  8463*            LENGTH (11)
  8464*        END-EXEC
  8465     MOVE 11
  8466       TO DFHEIV11
  8467*    MOVE '@"L                   #   #00008089' TO DFHEIV0
  8468     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8469     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8470     MOVE X'2020233030303038303839' TO DFHEIV0(25:11)
  8471     CALL 'kxdfhei1' USING DFHEIV0,
  8472           LCVBENEI,
  8473           DFHEIV11
  8474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8475         IF LCVBENEI IS NUMERIC
  8476            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8477            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8478            MOVE AL-UNNON        TO LCVBENEA
  8479         ELSE
  8480            MOVE ER-0243         TO EMI-ERROR
  8481            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8482            MOVE AL-UNBON        TO LCVBENEA
  8483            MOVE -1              TO LCVBENEL
  8484            MOVE 'X'             TO ERROR-SWITCH
  8485     ELSE
  8486         MOVE AL-UANOF           TO LCVBENEA.
  8487
  8488     IF ACVBENEL GREATER THAN ZERO
  8489
  8490* EXEC CICS BIF DEEDIT
  8491*            FIELD (ACVBENEI)
  8492*            LENGTH (11)
  8493*        END-EXEC
  8494     MOVE 11
  8495       TO DFHEIV11
  8496*    MOVE '@"L                   #   #00008107' TO DFHEIV0
  8497     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8498     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8499     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8500     CALL 'kxdfhei1' USING DFHEIV0,
  8501           ACVBENEI,
  8502           DFHEIV11
  8503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8504         IF ACVBENEI IS NUMERIC
  8505            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL131.cbl
  8506            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8507            MOVE AL-UNNON        TO ACVBENEA
  8508         ELSE
  8509            MOVE ER-0243         TO EMI-ERROR
  8510            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8511            MOVE AL-UNBON        TO ACVBENEA
  8512            MOVE -1              TO ACVBENEL
  8513            MOVE 'X'             TO ERROR-SWITCH
  8514     ELSE
  8515         MOVE AL-UANOF           TO ACVBENEA.
  8516
  8517     IF LCVFORMI GREATER THAN LOW-VALUES
  8518        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8519        MOVE AL-UANON            TO LCVFORMA
  8520     ELSE
  8521        MOVE AL-UANOF            TO LCVFORMA.
  8522
  8523     IF ACVFORMI GREATER THAN LOW-VALUES
  8524        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8525        MOVE AL-UANON            TO ACVFORMA
  8526     ELSE
  8527        MOVE AL-UANOF            TO ACVFORMA.
  8528
  8529     IF LCVCNDTL GREATER THAN ZERO
  8530         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8531         IF LCVCNDTI = SPACES
  8532             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8533         ELSE
  8534             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8535             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8536             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8537             MOVE '4'            TO DC-OPTION-CODE
  8538             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8539             IF NOT DATE-CONVERSION-ERROR
  8540                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8541                 MOVE AL-UANON   TO LCVCNDTA
  8542                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8543                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8544             ELSE
  8545                 MOVE ER-0246    TO EMI-ERROR
  8546                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8547                 MOVE AL-UABON   TO LCVCNDTA
  8548                 MOVE -1         TO LCVCNDTL
  8549                 MOVE 'X'        TO ERROR-SWITCH
  8550     ELSE
  8551         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8552         MOVE AL-UANOF           TO LCVCNDTA.
  8553
  8554     IF ACVCNDTL GREATER THAN ZERO
  8555         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8556         IF ACVCNDTI = SPACES
  8557             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8558         ELSE
  8559             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8560             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8561             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8562             MOVE '4'            TO DC-OPTION-CODE
  8563             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL131.cbl
  8564             IF NOT DATE-CONVERSION-ERROR
  8565                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8566                 MOVE AL-UANON   TO ACVCNDTA
  8567                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8568                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8569             ELSE
  8570                 MOVE ER-0246    TO EMI-ERROR
  8571                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8572                 MOVE AL-UABON   TO ACVCNDTA
  8573                 MOVE -1         TO ACVCNDTL
  8574                 MOVE 'X'        TO ERROR-SWITCH
  8575     ELSE
  8576         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8577         MOVE AL-UANOF           TO ACVCNDTA.
  8578
  8579     IF APRL GREATER THAN +0
  8580
  8581* EXEC CICS BIF DEEDIT
  8582*            FIELD    (APRI)
  8583*            LENGTH   (8)
  8584*        END-EXEC
  8585     MOVE 8
  8586       TO DFHEIV11
  8587*    MOVE '@"L                   #   #00008187' TO DFHEIV0
  8588     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8590     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8591     CALL 'kxdfhei1' USING DFHEIV0,
  8592           APRI,
  8593           DFHEIV11
  8594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8595         IF APRI NUMERIC
  8596            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8597            MOVE APRI            TO HOLD-APR APRO
  8598            MOVE AL-UANON        TO APRA
  8599          ELSE
  8600            MOVE ER-0259         TO EMI-ERROR
  8601            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8602            MOVE AL-UABON        TO APRA
  8603            MOVE -1              TO APRL
  8604            MOVE 'X'             TO ERROR-SWITCH
  8605     ELSE
  8606         MOVE AL-UANOF           TO APRA.
  8607
  8608     IF PMTFREQL GREATER THAN ZERO
  8609
  8610* EXEC CICS BIF DEEDIT
  8611*            FIELD    (PMTFREQI)
  8612*            LENGTH   (2)
  8613*        END-EXEC
  8614     MOVE 2
  8615       TO DFHEIV11
  8616*    MOVE '@"L                   #   #00008205' TO DFHEIV0
  8617     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8618     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8619     MOVE X'2020233030303038323035' TO DFHEIV0(25:11)
  8620     CALL 'kxdfhei1' USING DFHEIV0,
  8621           PMTFREQI,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL131.cbl
  8622           DFHEIV11
  8623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8624         IF PMTFREQI NUMERIC
  8625            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8626            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8627            MOVE AL-UANON        TO PMTFREQA
  8628          ELSE
  8629            MOVE ER-0427         TO EMI-ERROR
  8630            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8631            MOVE AL-UABON        TO PMTFREQA
  8632            MOVE -1              TO PMTFREQL
  8633            MOVE 'X'             TO ERROR-SWITCH
  8634     ELSE
  8635         MOVE AL-UANOF           TO PMTFREQA.
  8636
  8637     IF INDGRPL GREATER THAN ZERO
  8638         IF INDGRPI = 'I' OR 'G' OR SPACE
  8639             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8640             MOVE AL-UANON       TO INDGRPA
  8641          ELSE
  8642             MOVE ER-0260        TO EMI-ERROR
  8643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8644             MOVE AL-UABON       TO INDGRPA
  8645             MOVE -1             TO INDGRPL
  8646             MOVE 'X'            TO ERROR-SWITCH
  8647     ELSE
  8648         MOVE AL-UANOF           TO INDGRPA.
  8649
  8650     IF PREMTYPL GREATER THAN ZERO
  8651         IF PREMTYPI = '1' OR '2' OR '3'
  8652            MOVE PREMTYPI        TO PI-PREM-TYPE
  8653            MOVE AL-UNNON        TO PREMTYPA
  8654            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8655          ELSE
  8656            MOVE ER-0227         TO EMI-ERROR
  8657            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658            MOVE AL-UNBON        TO PREMTYPA
  8659            MOVE -1              TO PREMTYPL
  8660            MOVE 'X'             TO ERROR-SWITCH
  8661     ELSE
  8662         MOVE AL-UANOF           TO PREMTYPA.
  8663
  8664     IF LOANBALL GREATER THAN ZERO
  8665
  8666* EXEC CICS BIF DEEDIT
  8667*             FIELD    (LOANBALI)
  8668*             LENGTH   (9)
  8669*        END-EXEC
  8670     MOVE 9
  8671       TO DFHEIV11
  8672*    MOVE '@"L                   #   #00008250' TO DFHEIV0
  8673     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8674     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8675     MOVE X'2020233030303038323530' TO DFHEIV0(25:11)
  8676     CALL 'kxdfhei1' USING DFHEIV0,
  8677           LOANBALI,
  8678           DFHEIV11
  8679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL131.cbl
  8680         IF LOANBALI NUMERIC
  8681             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8682             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8683             MOVE AL-UNNON TO LOANBALA
  8684         ELSE
  8685             MOVE ER-0639        TO EMI-ERROR
  8686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8687             MOVE AL-UNBON       TO LOANBALA
  8688             MOVE -1             TO LOANBALL
  8689             MOVE 'X'            TO ERROR-SWITCH
  8690     ELSE
  8691         MOVE AL-UNNOF           TO LOANBALA.
  8692
  8693     IF LOANNOL GREATER THAN ZERO
  8694        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8695        MOVE AL-UANON            TO LOANNOA
  8696     ELSE
  8697        MOVE AL-UANOF            TO LOANNOA.
  8698
  8699     IF REINCDI GREATER THAN LOW-VALUES
  8700        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8701        MOVE AL-UANON            TO REINCDA
  8702     ELSE
  8703        MOVE AL-UANOF            TO REINCDA.
  8704
  8705     IF CERTI GREATER THAN LOW-VALUES
  8706         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  8707     ELSE
  8708         MOVE AL-UANOF           TO CERTA.
  8709
  8710     IF CERTEFFI GREATER THAN LOW-VALUES
  8711         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  8712     ELSE
  8713         MOVE AL-UANOF           TO CERTEFFA.
  8714
  8715     IF CERTACTI GREATER THAN LOW-VALUES
  8716         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  8717     ELSE
  8718         MOVE AL-UANOF           TO CERTACTA.
  8719
  8720     IF CERTSTI GREATER THAN LOW-VALUES
  8721         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  8722     ELSE
  8723         MOVE AL-UANOF           TO CERTSTA.
  8724
  8725     IF CERTCARI GREATER THAN LOW-VALUES
  8726         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  8727     ELSE
  8728         MOVE AL-UANOF           TO CERTCARA.
  8729
  8730     IF DLYACTV-RECORD-NEEDED
  8731         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  8732                 1150-EXIT
  8733     END-IF.
  8734
  8735     IF CERTEFFI GREATER LOW-VALUES OR
  8736        CERTACTI GREATER LOW-VALUES OR
  8737        CERTSTI  GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL131.cbl
  8738        CERTCARI GREATER LOW-VALUES OR
  8739        CERTGRPI GREATER LOW-VALUES
  8740        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8741
  8742*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  8743*      IF PI-PREM-TYPE NOT = '1'  AND
  8744*         PI-NO-PMTS = ZEROS
  8745*          IF LOANBALL GREATER +0 OR
  8746*             ACVBENEL GREATER +0
  8747*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8748
  8749     IF CERTL = ZEROS AND
  8750        SUFXL = ZEROS
  8751          GO TO 1010-EXIT.
  8752
  8753     IF CERTL GREATER THAN ZEROS
  8754         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  8755             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  8756             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8757             MOVE 'X'            TO ERROR-SWITCH
  8758             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8759
  8760     IF SUFXL GREATER THAN ZEROS
  8761         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  8762             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  8763             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8764             MOVE 'X'            TO ERROR-SWITCH
  8765             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8766
  8767 1010-EXIT.
  8768     EXIT.
  8769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL131.cbl
  8771 1120-EDIT-PROC.
  8772     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  8773     MOVE '2'                    TO CNTL-REC-TYPE.
  8774     MOVE PROCI                  TO CNTL-PROC-ID.
  8775     MOVE ZERO                   TO CNTL-SEQ-NO.
  8776
  8777
  8778* EXEC CICS HANDLE CONDITION
  8779*         NOTFND    (1120-CNTL-NOTFND)
  8780*    END-EXEC.
  8781*    MOVE '"$I                   ! & #00008351' TO DFHEIV0
  8782     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8784     MOVE X'2620233030303038333531' TO DFHEIV0(25:11)
  8785     CALL 'kxdfhei1' USING DFHEIV0
  8786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8787
  8788
  8789
  8790* EXEC CICS READ
  8791*         SET      (ADDRESS OF CONTROL-FILE)
  8792*         DATASET  (CNTL-FILE-ID)
  8793*         RIDFLD   (CNTL-KEY)
  8794*    END-EXEC.
  8795*    MOVE '&"S        E          (   #00008355' TO DFHEIV0
  8796     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8798     MOVE X'2020233030303038333535' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0,
  8800           CNTL-FILE-ID,
  8801           DFHEIV20,
  8802           DFHEIV99,
  8803           CNTL-KEY,
  8804           DFHEIV99,
  8805           DFHEIV99,
  8806           DFHEIV99
  8807     SET ADDRESS OF CONTROL-FILE TO
  8808         DFHEIV20
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8810
  8811
  8812     MOVE AL-UANON               TO PROCA.
  8813     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  8814     GO TO 1120-EXIT.
  8815
  8816 1120-CNTL-NOTFND.
  8817     MOVE ER-0273                TO EMI-ERROR.
  8818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8819     MOVE AL-UABON               TO PROCA.
  8820     MOVE -1                     TO PROCL.
  8821     MOVE 'X'                    TO ERROR-SWITCH.
  8822
  8823 1120-EXIT.
  8824     EXIT.
  8825
  8826*************************************************************
  8827*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  8828*************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL131.cbl
  8829
  8830 1150-OUTPUT-ACTIVITY-RECORD.
  8831
  8832
  8833* EXEC CICS GETMAIN
  8834*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  8835*        LENGTH (25)
  8836*        INITIMG (WS-BLANK)
  8837*    END-EXEC.
  8838     MOVE 25
  8839       TO DFHEIV11
  8840*    MOVE ',"IL                  $   #00008381' TO DFHEIV0
  8841     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8843     MOVE X'2020233030303038333831' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
  8845           DFHEIV20,
  8846           DFHEIV11,
  8847           WS-BLANK
  8848     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8849         DFHEIV20
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8851
  8852
  8853     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8854     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  8855     MOVE PI-CARRIER             TO DA-CARRIER.
  8856     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  8857     MOVE PI-CERT-NO             TO DA-CERT-NO.
  8858     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  8859     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  8860
  8861
  8862* EXEC CICS HANDLE CONDITION
  8863*        NOTOPEN (1150-NOTOPEN-ERROR)
  8864*        DUPREC (1150-EXIT)
  8865*    END-EXEC.
  8866*    MOVE '"$J%                  ! '' #00008395' TO DFHEIV0
  8867     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8869     MOVE X'2720233030303038333935' TO DFHEIV0(25:11)
  8870     CALL 'kxdfhei1' USING DFHEIV0
  8871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8872
  8873     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  8874     MOVE 'DLYACTV'              TO JP-FILE-ID.
  8875     MOVE 'A'                    TO JP-RECORD-TYPE.
  8876     MOVE +48                    TO JOURNAL-LENGTH.
  8877
  8878
  8879* EXEC CICS WRITE
  8880*        DATASET ('DLYACTV')
  8881*        RIDFLD (DA-KEY)
  8882*        FROM (DAILY-ACTIVITY-RECORD)
  8883*        LENGTH (25)
  8884*    END-EXEC.
  8885     MOVE 'DLYACTV' TO DFHEIV1
  8886     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL131.cbl
  8887       TO DFHEIV11
  8888*    MOVE '&$ L                  ''   #00008404' TO DFHEIV0
  8889     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           DFHEIV1,
  8894           DAILY-ACTIVITY-RECORD,
  8895           DFHEIV11,
  8896           DA-KEY,
  8897           DFHEIV99,
  8898           DFHEIV99
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901
  8902     GO TO 1150-EXIT.
  8903
  8904 1150-NOTOPEN-ERROR.
  8905
  8906     MOVE '2955'                 TO EMI-ERROR.
  8907     MOVE -1                     TO MAINTL.
  8908     MOVE AL-UANON               TO MAINTA.
  8909     MOVE 'X'                    TO ERROR-SWITCH.
  8910     PERFORM 9900-ERROR-FORMAT THRU
  8911             9900-EXIT.
  8912
  8913 1150-EXIT.
  8914     EXIT.
  8915
  8916*************************************************************
  8917*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  8918*************************************************************
  8919
  8920 1240-EDIT-LIFE-CODE.
  8921
  8922     IF INVALID-BENEFIT-CODE
  8923         GO TO 1240-SET-ERROR.
  8924
  8925     MOVE SPACES                 TO BENEFIT-KEY.
  8926     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8927     MOVE '4'                    TO BEN-REC-TYPE.
  8928     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8929     MOVE ZERO                   TO BEN-SEQ-NO.
  8930
  8931
  8932* EXEC CICS READ GTEQ
  8933*         DATASET  (CNTL-FILE-ID)
  8934*         RIDFLD   (BENEFIT-KEY)
  8935*         SET      (ADDRESS OF CONTROL-FILE)
  8936*    END-EXEC.
  8937*    MOVE '&"S        G          (   #00008440' TO DFHEIV0
  8938     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038343430' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           CNTL-FILE-ID,
  8943           DFHEIV20,
  8944           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL131.cbl
  8945           BENEFIT-KEY,
  8946           DFHEIV99,
  8947           DFHEIV99,
  8948           DFHEIV99
  8949     SET ADDRESS OF CONTROL-FILE TO
  8950         DFHEIV20
  8951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8952
  8953
  8954     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  8955        CF-RECORD-TYPE NOT = '4'
  8956         GO TO 1240-SET-ERROR.
  8957
  8958     MOVE ZERO                   TO COUNT-2.
  8959     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  8960
  8961     IF SCREEN-ERROR
  8962         GO TO 1240-SET-ERROR.
  8963
  8964 1240-SET-CODE-SWITCHES.
  8965     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  8966     MOVE AL-UANON               TO LCVCDA.
  8967     GO TO 1240-EXIT.
  8968
  8969 1240-SET-ERROR.
  8970     MOVE ER-0240                TO EMI-ERROR.
  8971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8972     MOVE 'X'                    TO ERROR-SWITCH.
  8973     MOVE AL-UABON               TO LCVCDA.
  8974     MOVE -1                     TO LCVCDL.
  8975
  8976 1240-EXIT.
  8977     EXIT.
  8978
  8979 1310-EDIT-AH-CODE.
  8980     IF INVALID-BENEFIT-CODE
  8981         GO TO 1310-SET-ERROR.
  8982
  8983     MOVE SPACES                 TO BENEFIT-KEY.
  8984     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8985     MOVE '5'                    TO BEN-REC-TYPE.
  8986     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8987     MOVE ZERO                   TO BEN-SEQ-NO.
  8988
  8989
  8990* EXEC CICS READ GTEQ
  8991*         DATASET  (CNTL-FILE-ID)
  8992*         RIDFLD   (BENEFIT-KEY)
  8993*         SET      (ADDRESS OF CONTROL-FILE)
  8994*    END-EXEC.
  8995*    MOVE '&"S        G          (   #00008481' TO DFHEIV0
  8996     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8998     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  8999     CALL 'kxdfhei1' USING DFHEIV0,
  9000           CNTL-FILE-ID,
  9001           DFHEIV20,
  9002           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL131.cbl
  9003           BENEFIT-KEY,
  9004           DFHEIV99,
  9005           DFHEIV99,
  9006           DFHEIV99
  9007     SET ADDRESS OF CONTROL-FILE TO
  9008         DFHEIV20
  9009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9010
  9011
  9012     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9013        CF-RECORD-TYPE NOT = '5'
  9014         GO TO 1310-SET-ERROR.
  9015
  9016     MOVE ZERO                   TO COUNT-2.
  9017     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9018     IF SCREEN-ERROR
  9019         GO TO 1310-SET-ERROR.
  9020
  9021 1310-SET-CODE-SWITCHES.
  9022     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9023     MOVE AL-UANON               TO ACVCDA.
  9024     GO TO 1310-EXIT.
  9025
  9026 1310-SET-ERROR.
  9027     MOVE ER-0250                TO EMI-ERROR.
  9028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9029     MOVE AL-UABON               TO ACVCDA.
  9030     MOVE 'X'                    TO ERROR-SWITCH.
  9031     MOVE -1                     TO ACVCDL.
  9032
  9033 1310-EXIT.
  9034     EXIT.
  9035
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL131.cbl
  9037 1460-EDIT-CERT-NO.
  9038     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9039     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9040
  9041     IF WS-SAVE-CERT-NO = SPACES
  9042         MOVE ER-0203            TO EMI-ERROR
  9043         GO TO 1460-CERT-NO-ERROR.
  9044
  9045     IF WS-CERT-NO-PRIME = SPACES AND
  9046        WS-CERT-NO-SUFX GREATER THAN SPACE
  9047            MOVE ER-0210         TO EMI-ERROR
  9048            GO TO 1460-CERT-NO-ERROR.
  9049
  9050     MOVE 'X'                    TO UPDATE-SWITCH.
  9051     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9052     MOVE AL-UANON               TO CERTA.
  9053
  9054     IF SUFXL IS GREATER THAN 0
  9055         MOVE AL-UANON           TO SUFXA.
  9056
  9057     GO TO 1460-EXIT.
  9058
  9059 1460-CERT-NO-ERROR.
  9060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9061     MOVE AL-UABON               TO SUFXA.
  9062     MOVE AL-UABON               TO CERTA.
  9063     MOVE -1                     TO CERTL.
  9064     MOVE 'X'                    TO ERROR-SWITCH.
  9065
  9066 1460-EXIT.
  9067     EXIT.
  9068
  9069 1470-EDIT-EFF.
  9070     IF CERTEFFI = SPACES
  9071         GO TO 1470-DATE-ERROR.
  9072
  9073     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9074     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9075     IF DEEDIT-DATE = ZERO
  9076         GO TO 1470-DATE-ERROR.
  9077
  9078     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9079     MOVE '4'                    TO DC-OPTION-CODE.
  9080     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9081     IF NOT DATE-CONVERSION-ERROR
  9082         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9083         MOVE AL-UANON           TO CERTEFFA
  9084         MOVE 'X'                TO UPDATE-SWITCH
  9085         MOVE 'Y'                TO CERT-KEY-SWITCH
  9086         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9087         GO TO 1470-EXIT.
  9088
  9089 1470-DATE-ERROR.
  9090     MOVE ER-0215                TO EMI-ERROR.
  9091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9092     MOVE AL-UABON               TO CERTEFFA.
  9093     MOVE -1                     TO CERTEFFL.
  9094     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL131.cbl
  9095
  9096 1470-EXIT.
  9097     EXIT.
  9098
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL131.cbl
  9100 1480-EDIT-ACCT.
  9101     IF CERTACTI = SPACES
  9102         MOVE ER-0232            TO EMI-ERROR
  9103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9104         MOVE AL-UABON           TO CERTACTA
  9105         MOVE -1                 TO CERTACTL
  9106         MOVE 'X'                TO ERROR-SWITCH
  9107     ELSE
  9108         MOVE 'X'                TO UPDATE-SWITCH
  9109         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9110
  9111 1480-EXIT.
  9112     EXIT.
  9113
  9114 1490-EDIT-STATE.
  9115     IF CERTSTI = SPACES
  9116         MOVE ER-0233            TO EMI-ERROR
  9117         GO TO 1490-STATE-ERROR.
  9118
  9119     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9120     MOVE '3'                    TO CNTL-REC-TYPE.
  9121     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9122     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9123     MOVE ZERO                   TO CNTL-SEQ-NO.
  9124
  9125
  9126* EXEC CICS HANDLE CONDITION
  9127*         NOTFND (1490-STATE-NOTFND)
  9128*    END-EXEC.
  9129*    MOVE '"$I                   ! ( #00008600' TO DFHEIV0
  9130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9132     MOVE X'2820233030303038363030' TO DFHEIV0(25:11)
  9133     CALL 'kxdfhei1' USING DFHEIV0
  9134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9135
  9136
  9137
  9138* EXEC CICS READ
  9139*         SET        (ADDRESS OF CONTROL-FILE)
  9140*         DATASET    ('ELCNTL')
  9141*         RIDFLD     (CNTL-KEY)
  9142*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9143*         GENERIC
  9144*    END-EXEC.
  9145     MOVE 'ELCNTL' TO DFHEIV1
  9146*    MOVE '&"S  KG    E          (   #00008604' TO DFHEIV0
  9147     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9149     MOVE X'2020233030303038363034' TO DFHEIV0(25:11)
  9150     CALL 'kxdfhei1' USING DFHEIV0,
  9151           DFHEIV1,
  9152           DFHEIV20,
  9153           DFHEIV99,
  9154           CNTL-KEY,
  9155           CNTL-GENERIC-LENGTH,
  9156           DFHEIV99,
  9157           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL131.cbl
  9158     SET ADDRESS OF CONTROL-FILE TO
  9159         DFHEIV20
  9160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9161
  9162
  9163     MOVE AL-UANON               TO CERTSTA.
  9164     MOVE 'X'                    TO UPDATE-SWITCH.
  9165     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9166     GO TO 1490-EXIT.
  9167
  9168 1490-STATE-NOTFND.
  9169     MOVE ER-0149                TO EMI-ERROR.
  9170
  9171 1490-STATE-ERROR.
  9172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9173     MOVE AL-UABON               TO CERTSTA.
  9174     MOVE -1                     TO CERTSTL.
  9175     MOVE 'X'                    TO ERROR-SWITCH.
  9176
  9177 1490-EXIT.
  9178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL131.cbl
  9180 1500-EDIT-CARR.
  9181     IF CERTCARI = SPACES
  9182         GO TO 1500-CARR-NOTFND.
  9183
  9184     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9185     MOVE '6'                    TO CNTL-REC-TYPE.
  9186     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9187     MOVE CERTCARI               TO CNTL-CARRIER.
  9188     MOVE ZERO                   TO CNTL-SEQ-NO.
  9189
  9190
  9191* EXEC CICS HANDLE CONDITION
  9192*         NOTFND   (1500-CARR-NOTFND)
  9193*    END-EXEC.
  9194*    MOVE '"$I                   ! ) #00008639' TO DFHEIV0
  9195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9197     MOVE X'2920233030303038363339' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0
  9199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9200
  9201
  9202
  9203* EXEC CICS READ
  9204*         SET        (ADDRESS OF CONTROL-FILE)
  9205*         DATASET    ('ELCNTL')
  9206*         RIDFLD     (CNTL-KEY)
  9207*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9208*         GENERIC
  9209*    END-EXEC.
  9210     MOVE 'ELCNTL' TO DFHEIV1
  9211*    MOVE '&"S  KG    E          (   #00008643' TO DFHEIV0
  9212     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9214     MOVE X'2020233030303038363433' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0,
  9216           DFHEIV1,
  9217           DFHEIV20,
  9218           DFHEIV99,
  9219           CNTL-KEY,
  9220           CNTL-GENERIC-LENGTH,
  9221           DFHEIV99,
  9222           DFHEIV99
  9223     SET ADDRESS OF CONTROL-FILE TO
  9224         DFHEIV20
  9225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9226
  9227
  9228     MOVE AL-UANON               TO CERTCARA.
  9229     MOVE 'X'                    TO UPDATE-SWITCH.
  9230     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9231     GO TO 1500-EXIT.
  9232
  9233 1500-CARR-NOTFND.
  9234     MOVE ER-0360                TO EMI-ERROR.
  9235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9236     MOVE AL-UABON               TO CERTCARA.
  9237     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL131.cbl
  9238     MOVE 'X'                    TO ERROR-SWITCH.
  9239
  9240 1500-EXIT.
  9241     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL131.cbl
  9243 1510-DEEDIT-DATE.
  9244
  9245* EXEC CICS BIF DEEDIT
  9246*         FIELD    (DEEDIT-DATE-INPUT)
  9247*         LENGTH   (DATE-LENGTH)
  9248*    END-EXEC.
  9249*    MOVE '@"L                   #   #00008667' TO DFHEIV0
  9250     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9252     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           DEEDIT-DATE-INPUT,
  9255           DATE-LENGTH
  9256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9257
  9258
  9259 1510-EXIT.
  9260     EXIT.
  9261
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL131.cbl
  9263 1620-VERIFY-ACCT.
  9264
  9265     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9266     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9267     MOVE PI-GROUPING            TO ACCT-GROUP.
  9268     MOVE PI-STATE               TO ACCT-STATE.
  9269     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9270
  9271     IF CERTEFFI GREATER THAN LOW-VALUES
  9272         MOVE HOLD-EFF           TO ACCT-DATE
  9273     ELSE
  9274         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9275
  9276     IF CERTACTI GREATER THAN LOW-VALUES
  9277         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9278     IF CERTSTI GREATER THAN LOW-VALUES
  9279         MOVE CERTSTI            TO  ACCT-STATE.
  9280     IF CERTCARI GREATER THAN LOW-VALUES
  9281         MOVE CERTCARI           TO  ACCT-CARRIER.
  9282     IF CERTGRPI GREATER THAN LOW-VALUES
  9283         MOVE CERTGRPI           TO ACCT-GROUP.
  9284
  9285     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9286
  9287
  9288* EXEC CICS HANDLE CONDITION
  9289*         NOTFND  (1620-ACCT-NOTFND)
  9290*    END-EXEC.
  9291*    MOVE '"$I                   ! * #00008700' TO DFHEIV0
  9292     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9294     MOVE X'2A20233030303038373030' TO DFHEIV0(25:11)
  9295     CALL 'kxdfhei1' USING DFHEIV0
  9296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9297
  9298
  9299
  9300* EXEC CICS STARTBR
  9301*         DATASET   (ACCT-FILE-ID)
  9302*         RIDFLD    (ACCT-KEY)
  9303*    END-EXEC.
  9304     MOVE 0
  9305       TO DFHEIV11
  9306*    MOVE '&,         G          &   #00008704' TO DFHEIV0
  9307     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9308     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9309     MOVE X'2020233030303038373034' TO DFHEIV0(25:11)
  9310     CALL 'kxdfhei1' USING DFHEIV0,
  9311           ACCT-FILE-ID,
  9312           ACCT-KEY,
  9313           DFHEIV99,
  9314           DFHEIV11,
  9315           DFHEIV99
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9317
  9318
  9319 1620-ACCT-LOOP.
  9320
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL131.cbl
  9321
  9322* EXEC CICS READNEXT
  9323*         DATASET  (ACCT-FILE-ID)
  9324*         RIDFLD   (ACCT-KEY)
  9325*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9326*    END-EXEC.
  9327     MOVE 0
  9328       TO DFHEIV11
  9329*    MOVE '&.S                   )   #00008711' TO DFHEIV0
  9330     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9331     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9332     MOVE X'2020233030303038373131' TO DFHEIV0(25:11)
  9333     CALL 'kxdfhei1' USING DFHEIV0,
  9334           ACCT-FILE-ID,
  9335           DFHEIV20,
  9336           DFHEIV99,
  9337           ACCT-KEY,
  9338           DFHEIV99,
  9339           DFHEIV11,
  9340           DFHEIV99,
  9341           DFHEIV99
  9342     SET ADDRESS OF ACCOUNT-MASTER TO
  9343         DFHEIV20
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9348         GO TO 1620-ACCT-NOTFND.
  9349
  9350     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9351        HOLD-EFF     LESS AM-EXPIRATION-DT
  9352         NEXT SENTENCE
  9353     ELSE
  9354         GO TO 1620-ACCT-LOOP.
  9355
  9356     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9357         GO TO 1620-ACCT-END-BROWSE.
  9358
  9359     IF LOANBALL GREATER THAN +0
  9360         IF AM-MAX-TOT-BEN NUMERIC  AND
  9361            AM-MAX-TOT-BEN GREATER THAN ZERO
  9362             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9363                 MOVE AL-UNBON     TO LOANBALA
  9364                 MOVE -1           TO LOANBALL
  9365                 MOVE 'X'          TO ERROR-SWITCH
  9366                 MOVE ER-7641      TO EMI-ERROR
  9367                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9368
  9369     IF ACVBENEL GREATER THAN +0
  9370         IF AM-MAX-MON-BEN NUMERIC  AND
  9371            AM-MAX-MON-BEN GREATER THAN ZERO
  9372             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9373                 MOVE AL-UNBON     TO ACVBENEA
  9374                 MOVE -1           TO ACVBENEL
  9375                 MOVE 'X'          TO ERROR-SWITCH
  9376                 MOVE ER-7642      TO EMI-ERROR
  9377                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL131.cbl
  9379 1620-ACCT-END-BROWSE.
  9380
  9381
  9382* EXEC CICS ENDBR
  9383*         DATASET (ACCT-FILE-ID)
  9384*    END-EXEC.
  9385     MOVE 0
  9386       TO DFHEIV11
  9387*    MOVE '&2                    $   #00008751' TO DFHEIV0
  9388     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9389     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9390     MOVE X'2020233030303038373531' TO DFHEIV0(25:11)
  9391     CALL 'kxdfhei1' USING DFHEIV0,
  9392           ACCT-FILE-ID,
  9393           DFHEIV11,
  9394           DFHEIV99
  9395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9396
  9397
  9398     GO TO 1620-EXIT.
  9399
  9400 1620-ACCT-NOTFND.
  9401
  9402     MOVE -1                     TO MAINTL.
  9403     MOVE 'X'                    TO ERROR-SWITCH.
  9404     MOVE ER-0426                TO EMI-ERROR.
  9405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9406
  9407 1620-EXIT.
  9408     EXIT.
  9409
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL131.cbl
  9411 2000-UPDATE-CLAIM.
  9412
  9413     MOVE SPACES                 TO ERROR-SWITCH.
  9414     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9415     MOVE PI-CARRIER             TO CARRIER-CODE.
  9416     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9417     MOVE PI-CERT-NO             TO CERT-NO.
  9418
  9419     IF DELETE-CLAIM
  9420         GO TO 3000-DELETE-CLAIM.
  9421
  9422     IF  NOT MODIFY-CAP
  9423         MOVE ER-0070            TO EMI-ERROR
  9424         MOVE 'X'                TO ERROR-SWITCH
  9425         MOVE -1                 TO MAINTL
  9426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9427         GO TO 2000-EXIT.
  9428
  9429     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9430     MOVE ZERO                   TO TRLR-SEQ-NO.
  9431
  9432
  9433* EXEC CICS READ UPDATE
  9434*         SET       (ADDRESS OF CLAIM-MASTER)
  9435*         DATASET   (CLMS-FILE-ID)
  9436*         RIDFLD    (MSTR-KEY)
  9437*    END-EXEC.
  9438*    MOVE '&"S        EU         (   #00008789' TO DFHEIV0
  9439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9440     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9441     MOVE X'2020233030303038373839' TO DFHEIV0(25:11)
  9442     CALL 'kxdfhei1' USING DFHEIV0,
  9443           CLMS-FILE-ID,
  9444           DFHEIV20,
  9445           DFHEIV99,
  9446           MSTR-KEY,
  9447           DFHEIV99,
  9448           DFHEIV99,
  9449           DFHEIV99
  9450     SET ADDRESS OF CLAIM-MASTER TO
  9451         DFHEIV20
  9452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9453
  9454
  9455     if (cl-priority-cd = '8')
  9456        and (pi-processor-id not = 'PEMA' and 'JMS '
  9457             AND 'AMWA')
  9458        MOVE ER-8003             TO EMI-ERROR
  9459        PERFORM 9900-ERROR-FORMAT
  9460                                 THRU 9900-EXIT
  9461        MOVE -1                  TO MAINTL
  9462        GO TO 8110-SEND-DATA
  9463     end-if
  9464
  9465     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9466         MOVE ER-0068            TO EMI-ERROR
  9467         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9468         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL131.cbl
  9469
  9470     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9471         MOVE ER-0068            TO EMI-ERROR
  9472         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9473         GO TO 2000-EXIT.
  9474
  9475     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9476         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9477
  9478     IF CL-PURGED-DT NOT = LOW-VALUES
  9479         MOVE ER-7691            TO EMI-ERROR
  9480         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9481         GO TO 2000-EXIT.
  9482
  9483     IF CERT-KEY-CHANGED
  9484         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9485
  9486     IF SCREEN-ERROR
  9487         MOVE ER-0068            TO EMI-ERROR
  9488         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9489         GO TO 2000-EXIT.
  9490
  9491     IF NINETY-TRLR-UPDATED
  9492         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9493
  9494     IF MSTR-KEY-CHANGED
  9495         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9496        ELSE
  9497         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9498
  9499     IF TRLR-UPDATE-REQUIRED
  9500         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9501
  9502 2000-CHECK-CERT.
  9503     IF NOT CERT-UPDATES
  9504         GO TO 2000-EXIT.
  9505
  9506     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9507     MOVE PI-CARRIER             TO CERT-CARRIER.
  9508     MOVE PI-GROUPING            TO CERT-GROUP.
  9509     MOVE PI-STATE               TO CERT-STATE.
  9510     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9511     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9512     MOVE PI-CERT-NO             TO CERT-CERT.
  9513
  9514     IF CERT-ALT-KEY-CHANGED
  9515         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9516     ELSE
  9517         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9518
  9519 2000-EXIT.
  9520     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL131.cbl
  9522 2010-RELEASE-REC.
  9523
  9524* EXEC CICS UNLOCK
  9525*         DATASET  (CLMS-FILE-ID)
  9526*    END-EXEC
  9527*    MOVE '&*                    #   #00008863' TO DFHEIV0
  9528     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9530     MOVE X'2020233030303038383633' TO DFHEIV0(25:11)
  9531     CALL 'kxdfhei1' USING DFHEIV0,
  9532           CLMS-FILE-ID,
  9533           DFHEIV99
  9534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9535
  9536     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9537     MOVE 'X'                    TO ERROR-SWITCH.
  9538
  9539 2010-EXIT.
  9540     EXIT.
  9541
  9542 2020-NORMAL-UPDATE.
  9543     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9544
  9545     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9546
  9547     IF WS-OPEN-CLOSE-SW = 'Y'
  9548       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9549       IF PI-REC-FOUND-SW = 'Y'
  9550         IF CL-ACTIVITY-CODE = 09
  9551           NEXT SENTENCE
  9552         ELSE
  9553           IF WS-RESET-SW = 'Y'
  9554             IF CL-CLAIM-STATUS = 'C'
  9555               MOVE 07               TO  CL-ACTIVITY-CODE
  9556               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9557               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9558             ELSE
  9559               MOVE 08               TO  CL-ACTIVITY-CODE
  9560               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9561               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9562
  9563     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9564         MOVE 'Y'                TO CL-YESNOSW
  9565     END-IF.
  9566
  9567
  9568* EXEC CICS HANDLE CONDITION
  9569*         DUPKEY   (2020-EXIT)
  9570*    END-EXEC.
  9571*    MOVE '"$$                   ! + #00008898' TO DFHEIV0
  9572     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9574     MOVE X'2B20233030303038383938' TO DFHEIV0(25:11)
  9575     CALL 'kxdfhei1' USING DFHEIV0
  9576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9577
  9578
  9579
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL131.cbl
  9580* EXEC CICS REWRITE
  9581*         DATASET   (CLMS-FILE-ID)
  9582*         FROM      (CLAIM-MASTER)
  9583*    END-EXEC.
  9584     MOVE LENGTH OF
  9585      CLAIM-MASTER
  9586       TO DFHEIV11
  9587*    MOVE '&& L                  %   #00008902' TO DFHEIV0
  9588     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9589     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9590     MOVE X'2020233030303038393032' TO DFHEIV0(25:11)
  9591     CALL 'kxdfhei1' USING DFHEIV0,
  9592           CLMS-FILE-ID,
  9593           CLAIM-MASTER,
  9594           DFHEIV11,
  9595           DFHEIV99
  9596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9597
  9598
  9599 2020-EXIT.
  9600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL131.cbl
  9602 2030-KEY-UPDATE.
  9603     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9604
  9605
  9606* EXEC CICS DELETE
  9607*        DATASET  (CLMS-FILE-ID)
  9608*    END-EXEC.
  9609*    MOVE '&(                    &   #00008913' TO DFHEIV0
  9610     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9612     MOVE X'2020233030303038393133' TO DFHEIV0(25:11)
  9613     CALL 'kxdfhei1' USING DFHEIV0,
  9614           CLMS-FILE-ID,
  9615           DFHEIV99,
  9616           DFHEIV99,
  9617           DFHEIV99,
  9618           DFHEIV99
  9619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9620
  9621
  9622
  9623* EXEC CICS GETMAIN
  9624*         SET      (ADDRESS OF CLAIM-MASTER)
  9625*         LENGTH   (MSTR-LENGTH)
  9626*         INITIMG  (GETMAIN-SPACE)
  9627*    END-EXEC.
  9628*    MOVE ',"IL                  $   #00008917' TO DFHEIV0
  9629     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9630     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9631     MOVE X'2020233030303038393137' TO DFHEIV0(25:11)
  9632     CALL 'kxdfhei1' USING DFHEIV0,
  9633           DFHEIV20,
  9634           MSTR-LENGTH,
  9635           GETMAIN-SPACE
  9636     SET ADDRESS OF CLAIM-MASTER TO
  9637         DFHEIV20
  9638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9639
  9640
  9641     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9642
  9643     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9644
  9645     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9646
  9647     IF WS-OPEN-CLOSE-SW = 'Y'
  9648       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9649         IF PI-REC-FOUND-SW = 'Y'
  9650           IF CL-ACTIVITY-CODE = 09
  9651             NEXT SENTENCE
  9652           ELSE
  9653             IF WS-RESET-SW = 'Y'
  9654               IF CL-CLAIM-STATUS = 'C'
  9655                 MOVE 07             TO  CL-ACTIVITY-CODE
  9656                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9657                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9658               ELSE
  9659                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL131.cbl
  9660                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9661                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9662
  9663
  9664* EXEC CICS HANDLE CONDITION
  9665*         DUPKEY    (2030-EXIT)
  9666*    END-EXEC.
  9667*    MOVE '"$$                   ! , #00008945' TO DFHEIV0
  9668     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9670     MOVE X'2C20233030303038393435' TO DFHEIV0(25:11)
  9671     CALL 'kxdfhei1' USING DFHEIV0
  9672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9673
  9674
  9675** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
  9676*    MOVE CL-CERT-NO             TO CL-CCN-A5.
  9677
  9678     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  9679         MOVE 'Y'                TO CL-YESNOSW
  9680     END-IF.
  9681
  9682
  9683* EXEC CICS WRITE
  9684*         DATASET   (CLMS-FILE-ID)
  9685*         RIDFLD    (MSTR-KEY)
  9686*         FROM      (CLAIM-MASTER)
  9687*    END-EXEC.
  9688     MOVE LENGTH OF
  9689      CLAIM-MASTER
  9690       TO DFHEIV11
  9691*    MOVE '&$ L                  ''   #00008956' TO DFHEIV0
  9692     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9693     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9694     MOVE X'2020233030303038393536' TO DFHEIV0(25:11)
  9695     CALL 'kxdfhei1' USING DFHEIV0,
  9696           CLMS-FILE-ID,
  9697           CLAIM-MASTER,
  9698           DFHEIV11,
  9699           MSTR-KEY,
  9700           DFHEIV99,
  9701           DFHEIV99
  9702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9703
  9704
  9705 2030-EXIT.
  9706     EXIT.
  9707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL131.cbl
  9709 2040-NORMAL-UPDATE.
  9710
  9711* EXEC CICS READ UPDATE
  9712*         DATASET  (CERT-FILE-ID)
  9713*         RIDFLD   (CERT-KEY)
  9714*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9715*    END-EXEC.
  9716*    MOVE '&"S        EU         (   #00008967' TO DFHEIV0
  9717     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9718     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303038393637' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           CERT-FILE-ID,
  9722           DFHEIV20,
  9723           DFHEIV99,
  9724           CERT-KEY,
  9725           DFHEIV99,
  9726           DFHEIV99,
  9727           DFHEIV99
  9728     SET ADDRESS OF CERTIFICATE-MASTER TO
  9729         DFHEIV20
  9730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9731
  9732
  9733     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9734
  9735
  9736* EXEC CICS HANDLE CONDITION
  9737*         DUPKEY   (2040-EXIT)
  9738*    END-EXEC.
  9739*    MOVE '"$$                   ! - #00008975' TO DFHEIV0
  9740     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9742     MOVE X'2D20233030303038393735' TO DFHEIV0(25:11)
  9743     CALL 'kxdfhei1' USING DFHEIV0
  9744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9745
  9746
  9747
  9748* EXEC CICS REWRITE
  9749*         DATASET  (CERT-FILE-ID)
  9750*         FROM     (CERTIFICATE-MASTER)
  9751*    END-EXEC.
  9752     MOVE LENGTH OF
  9753      CERTIFICATE-MASTER
  9754       TO DFHEIV11
  9755*    MOVE '&& L                  %   #00008979' TO DFHEIV0
  9756     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9757     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9758     MOVE X'2020233030303038393739' TO DFHEIV0(25:11)
  9759     CALL 'kxdfhei1' USING DFHEIV0,
  9760           CERT-FILE-ID,
  9761           CERTIFICATE-MASTER,
  9762           DFHEIV11,
  9763           DFHEIV99
  9764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9765
  9766
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL131.cbl
  9767 2040-EXIT.
  9768     EXIT.
  9769
  9770 2050-KEY-UPDATE.
  9771
  9772* EXEC CICS READ UPDATE
  9773*         DATASET  (CERT-FILE-ID)
  9774*         RIDFLD   (CERT-KEY)
  9775*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9776*    END-EXEC.
  9777*    MOVE '&"S        EU         (   #00008988' TO DFHEIV0
  9778     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9779     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9780     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0,
  9782           CERT-FILE-ID,
  9783           DFHEIV20,
  9784           DFHEIV99,
  9785           CERT-KEY,
  9786           DFHEIV99,
  9787           DFHEIV99,
  9788           DFHEIV99
  9789     SET ADDRESS OF CERTIFICATE-MASTER TO
  9790         DFHEIV20
  9791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9792
  9793
  9794     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
  9795
  9796
  9797* EXEC CICS DELETE
  9798*         DATASET   (CERT-FILE-ID)
  9799*    END-EXEC.
  9800*    MOVE '&(                    &   #00008996' TO DFHEIV0
  9801     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9803     MOVE X'2020233030303038393936' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0,
  9805           CERT-FILE-ID,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV99,
  9809           DFHEIV99
  9810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9811
  9812
  9813
  9814* EXEC CICS GETMAIN
  9815*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9816*         LENGTH    (CERT-LENGTH)
  9817*         INITIMG   (GETMAIN-SPACE)
  9818*    END-EXEC.
  9819*    MOVE ',"IL                  $   #00009000' TO DFHEIV0
  9820     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9821     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9822     MOVE X'2020233030303039303030' TO DFHEIV0(25:11)
  9823     CALL 'kxdfhei1' USING DFHEIV0,
  9824           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL131.cbl
  9825           CERT-LENGTH,
  9826           GETMAIN-SPACE
  9827     SET ADDRESS OF CERTIFICATE-MASTER TO
  9828         DFHEIV20
  9829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9830
  9831
  9832     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
  9833
  9834     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9835
  9836
  9837* EXEC CICS HANDLE CONDITION
  9838*         DUPKEY (2050-EXIT)
  9839*    END-EXEC.
  9840*    MOVE '"$$                   ! . #00009010' TO DFHEIV0
  9841     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9843     MOVE X'2E20233030303039303130' TO DFHEIV0(25:11)
  9844     CALL 'kxdfhei1' USING DFHEIV0
  9845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9846
  9847
  9848
  9849* EXEC CICS WRITE
  9850*         DATASET  (CERT-FILE-ID)
  9851*         RIDFLD   (CERT-KEY)
  9852*         FROM     (CERTIFICATE-MASTER)
  9853*    END-EXEC.
  9854     MOVE LENGTH OF
  9855      CERTIFICATE-MASTER
  9856       TO DFHEIV11
  9857*    MOVE '&$ L                  ''   #00009014' TO DFHEIV0
  9858     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9860     MOVE X'2020233030303039303134' TO DFHEIV0(25:11)
  9861     CALL 'kxdfhei1' USING DFHEIV0,
  9862           CERT-FILE-ID,
  9863           CERTIFICATE-MASTER,
  9864           DFHEIV11,
  9865           CERT-KEY,
  9866           DFHEIV99,
  9867           DFHEIV99
  9868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9869
  9870
  9871 2050-EXIT.
  9872     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL131.cbl
  9874 2060-CHANGE-CERT.
  9875     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9876     MOVE PI-CARRIER             TO CERT-CARRIER.
  9877     MOVE PI-GROUPING            TO CERT-GROUP.
  9878     MOVE PI-STATE               TO CERT-STATE.
  9879     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9880     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9881     MOVE PI-CERT-NO             TO CERT-CERT.
  9882     IF CERTEFFI GREATER THAN LOW-VALUES
  9883         MOVE HOLD-EFF           TO CERT-DATE.
  9884     IF CERTACTI GREATER THAN LOW-VALUES
  9885         MOVE CERTACTI           TO CERT-ACCOUNT.
  9886     IF CERTSTI GREATER THAN LOW-VALUES
  9887         MOVE CERTSTI            TO CERT-STATE.
  9888     IF CERTCARI GREATER THAN LOW-VALUES
  9889         MOVE CERTCARI           TO CERT-CARRIER.
  9890     IF CERTGRPI GREATER THAN LOW-VALUES
  9891         MOVE CERTGRPI           TO CERT-GROUP.
  9892     IF CERTI GREATER THAN LOW-VALUES
  9893         MOVE CERTI              TO CERT-CERT-PRIME.
  9894     IF SUFXI GREATER THAN LOW-VALUES
  9895         MOVE SUFXI              TO CERT-CERT-SUFX.
  9896
  9897
  9898* EXEC CICS HANDLE CONDITION
  9899*         NOTFND   (2060-CERT-NOTFND)
  9900*    END-EXEC.
  9901*    MOVE '"$I                   ! / #00009046' TO DFHEIV0
  9902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9904     MOVE X'2F20233030303039303436' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0
  9906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9907
  9908
  9909
  9910* EXEC CICS READ UPDATE
  9911*         DATASET  (CERT-FILE-ID)
  9912*         RIDFLD   (CERT-KEY)
  9913*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9914*    END-EXEC.
  9915*    MOVE '&"S        EU         (   #00009050' TO DFHEIV0
  9916     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9917     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9918     MOVE X'2020233030303039303530' TO DFHEIV0(25:11)
  9919     CALL 'kxdfhei1' USING DFHEIV0,
  9920           CERT-FILE-ID,
  9921           DFHEIV20,
  9922           DFHEIV99,
  9923           CERT-KEY,
  9924           DFHEIV99,
  9925           DFHEIV99,
  9926           DFHEIV99
  9927     SET ADDRESS OF CERTIFICATE-MASTER TO
  9928         DFHEIV20
  9929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9930
  9931
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL131.cbl
  9932     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
  9933
  9934     IF CM-CLAIM-INTERFACE-SW = SPACES
  9935        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
  9936
  9937
  9938* EXEC CICS HANDLE CONDITION
  9939*         DUPKEY   (2060-DUPKEY)
  9940*    END-EXEC.
  9941*    MOVE '"$$                   ! 0 #00009061' TO DFHEIV0
  9942     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9944     MOVE X'3020233030303039303631' TO DFHEIV0(25:11)
  9945     CALL 'kxdfhei1' USING DFHEIV0
  9946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9947
  9948
  9949
  9950* EXEC CICS REWRITE
  9951*         DATASET  (CERT-FILE-ID)
  9952*         FROM     (CERTIFICATE-MASTER)
  9953*    END-EXEC.
  9954     MOVE LENGTH OF
  9955      CERTIFICATE-MASTER
  9956       TO DFHEIV11
  9957*    MOVE '&& L                  %   #00009065' TO DFHEIV0
  9958     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9960     MOVE X'2020233030303039303635' TO DFHEIV0(25:11)
  9961     CALL 'kxdfhei1' USING DFHEIV0,
  9962           CERT-FILE-ID,
  9963           CERTIFICATE-MASTER,
  9964           DFHEIV11,
  9965           DFHEIV99
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
  9968
  9969 2060-DUPKEY.
  9970
  9971     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9972
  9973 2060-CHANGE-TRLR-ACTQ.
  9974     IF SCREEN-ERROR
  9975         GO TO 2060-EXIT.
  9976
  9977     IF CERTI    GREATER LOW-VALUES OR
  9978        SUFXI    GREATER LOW-VALUES OR
  9979        CERTCARI GREATER LOW-VALUES
  9980         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
  9981         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
  9982
  9983     MOVE SPACES                 TO CERT-KEY-SWITCH
  9984                                    CERT-SWITCH
  9985                                    TRLR-SWITCH
  9986                                    NINETY-TRLR-SWITCH.
  9987     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
  9988     GO TO 2060-EXIT.
  9989
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL131.cbl
  9990 2060-CERT-NOTFND.
  9991     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9992
  9993     IF WS-REC-FOUND-SW = 'N'
  9994         MOVE ER-0206            TO  EMI-ERROR
  9995         MOVE -1                 TO  MAINTL
  9996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9997
  9998* EXEC CICS UNLOCK
  9999*            DATASET   (CLMS-FILE-ID)
 10000*        END-EXEC
 10001*    MOVE '&*                    #   #00009098' TO DFHEIV0
 10002     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10003     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10004     MOVE X'2020233030303039303938' TO DFHEIV0(25:11)
 10005     CALL 'kxdfhei1' USING DFHEIV0,
 10006           CLMS-FILE-ID,
 10007           DFHEIV99
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10009         GO TO 8110-SEND-DATA.
 10010
 10011     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10012
 10013     GO TO 2060-CHANGE-TRLR-ACTQ.
 10014
 10015 2060-EXIT.
 10016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL131.cbl
 10018 2070-CHECK-OLD.
 10019
 10020
 10021* EXEC CICS HANDLE CONDITION
 10022*        NOTFND   (2070-NOT-FOUND)
 10023*    END-EXEC.
 10024*    MOVE '"$I                   ! 1 #00009112' TO DFHEIV0
 10025     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10027     MOVE X'3120233030303039313132' TO DFHEIV0(25:11)
 10028     CALL 'kxdfhei1' USING DFHEIV0
 10029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10030
 10031
 10032     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10033     MOVE PI-CARRIER             TO CERT-CARRIER.
 10034     MOVE PI-GROUPING            TO CERT-GROUP.
 10035     MOVE PI-STATE               TO CERT-STATE.
 10036     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10037     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10038     MOVE PI-CERT-NO             TO CERT-CERT.
 10039
 10040
 10041* EXEC CICS READ UPDATE
 10042*         DATASET  (CERT-FILE-ID)
 10043*         RIDFLD   (CERT-KEY)
 10044*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10045*    END-EXEC.
 10046*    MOVE '&"S        EU         (   #00009124' TO DFHEIV0
 10047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10048     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10049     MOVE X'2020233030303039313234' TO DFHEIV0(25:11)
 10050     CALL 'kxdfhei1' USING DFHEIV0,
 10051           CERT-FILE-ID,
 10052           DFHEIV20,
 10053           DFHEIV99,
 10054           CERT-KEY,
 10055           DFHEIV99,
 10056           DFHEIV99,
 10057           DFHEIV99
 10058     SET ADDRESS OF CERTIFICATE-MASTER TO
 10059         DFHEIV20
 10060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10061
 10062
 10063     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10064     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10065     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10066
 10067     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10068         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10069
 10070     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10071       AND
 10072        CERT-WAS-CREATED-FOR-CLAIM
 10073         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10074
 10075* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL131.cbl
 10076*             DATASET   (CERT-FILE-ID)
 10077*        END-EXEC
 10078*    MOVE '&(                    &   #00009141' TO DFHEIV0
 10079     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10081     MOVE X'2020233030303039313431' TO DFHEIV0(25:11)
 10082     CALL 'kxdfhei1' USING DFHEIV0,
 10083           CERT-FILE-ID,
 10084           DFHEIV99,
 10085           DFHEIV99,
 10086           DFHEIV99,
 10087           DFHEIV99
 10088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10089         GO TO 2070-EXIT.
 10090
 10091     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10092         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10093
 10094
 10095* EXEC CICS HANDLE CONDITION
 10096*         DUPKEY   (2070-EXIT)
 10097*    END-EXEC.
 10098*    MOVE '"$$                   ! 2 #00009149' TO DFHEIV0
 10099     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10101     MOVE X'3220233030303039313439' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0
 10103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10104
 10105
 10106
 10107* EXEC CICS REWRITE
 10108*         DATASET  (CERT-FILE-ID)
 10109*         FROM     (CERTIFICATE-MASTER)
 10110*    END-EXEC.
 10111     MOVE LENGTH OF
 10112      CERTIFICATE-MASTER
 10113       TO DFHEIV11
 10114*    MOVE '&& L                  %   #00009153' TO DFHEIV0
 10115     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10117     MOVE X'2020233030303039313533' TO DFHEIV0(25:11)
 10118     CALL 'kxdfhei1' USING DFHEIV0,
 10119           CERT-FILE-ID,
 10120           CERTIFICATE-MASTER,
 10121           DFHEIV11,
 10122           DFHEIV99
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126     GO TO 2070-EXIT.
 10127
 10128 2070-NOT-FOUND.
 10129     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10130
 10131 2070-EXIT.
 10132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL131.cbl
 10134 2080-CREATE-CERT.
 10135
 10136* EXEC CICS GETMAIN
 10137*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10138*         LENGTH    (CERT-LENGTH)
 10139*         INITIMG   (GETMAIN-SPACE)
 10140*    END-EXEC.
 10141*    MOVE ',"IL                  $   #00009167' TO DFHEIV0
 10142     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10143     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10144     MOVE X'2020233030303039313637' TO DFHEIV0(25:11)
 10145     CALL 'kxdfhei1' USING DFHEIV0,
 10146           DFHEIV20,
 10147           CERT-LENGTH,
 10148           GETMAIN-SPACE
 10149     SET ADDRESS OF CERTIFICATE-MASTER TO
 10150         DFHEIV20
 10151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10152
 10153
 10154     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10155
 10156     IF CERTEFFI GREATER THAN LOW-VALUES
 10157         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10158                                    DC-BIN-DATE-1
 10159         MOVE '6'                TO DC-OPTION-CODE
 10160         MOVE +1                 TO DC-ELAPSED-MONTHS
 10161         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10162         IF NO-CONVERSION-ERROR
 10163             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10164
 10165     IF CERTACTI GREATER THAN LOW-VALUES
 10166         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10167     IF CERTSTI GREATER THAN LOW-VALUES
 10168         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10169     IF CERTCARI GREATER THAN LOW-VALUES
 10170         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10171     IF CERTGRPI GREATER THAN LOW-VALUES
 10172         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10173     IF CERTI GREATER THAN LOW-VALUES
 10174         MOVE CERTI              TO CERT-CERT-PRIME
 10175                                    CM-CERT-PRIME
 10176         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10177
 10178     IF SUFXI GREATER THAN LOW-VALUES
 10179         MOVE SUFXI              TO CERT-CERT-SUFX
 10180                                    CM-CERT-SFX
 10181         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10182
 10183     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10184
 10185     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10186
 10187     MOVE SPACES                 TO CM-ENTRY-BATCH
 10188                                    CM-LF-EXIT-BATCH
 10189                                    CM-AH-EXIT-BATCH
 10190                                    CM-CREDIT-INTERFACE-SW-1
 10191                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL131.cbl
 10192
 10193     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10194                               '9' OR 'D' OR 'V'
 10195         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10196
 10197     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10198                               '9' OR 'D' OR 'V'
 10199         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10200
 10201     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10202                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10203     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10204
 10205
 10206* EXEC CICS HANDLE CONDITION
 10207*         DUPKEY (2080-EXIT)
 10208*    END-EXEC.
 10209*    MOVE '"$$                   ! 3 #00009224' TO DFHEIV0
 10210     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10212     MOVE X'3320233030303039323234' TO DFHEIV0(25:11)
 10213     CALL 'kxdfhei1' USING DFHEIV0
 10214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10215
 10216
 10217
 10218* EXEC CICS WRITE
 10219*         DATASET  (CERT-FILE-ID)
 10220*         RIDFLD   (CERT-KEY)
 10221*         FROM     (CERTIFICATE-MASTER)
 10222*    END-EXEC.
 10223     MOVE LENGTH OF
 10224      CERTIFICATE-MASTER
 10225       TO DFHEIV11
 10226*    MOVE '&$ L                  ''   #00009228' TO DFHEIV0
 10227     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10229     MOVE X'2020233030303039323238' TO DFHEIV0(25:11)
 10230     CALL 'kxdfhei1' USING DFHEIV0,
 10231           CERT-FILE-ID,
 10232           CERTIFICATE-MASTER,
 10233           DFHEIV11,
 10234           CERT-KEY,
 10235           DFHEIV99,
 10236           DFHEIV99
 10237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10238
 10239
 10240 2080-EXIT.
 10241     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL131.cbl
 10243 2100-MOVE-MSTR.
 10244     IF TYPEI GREATER THAN LOW-VALUES
 10245         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10246
 10247     IF STATUSI = LOW-VALUES
 10248         GO TO 2100-NO-STATUS-CHANGE.
 10249
 10250     IF STATUSI = 'OPEN' OR 'O'
 10251         IF CL-CLAIM-STATUS = 'O'
 10252             MOVE SPACES         TO TRLR-SWITCH
 10253                 GO TO 2100-NO-STATUS-CHANGE.
 10254
 10255     IF STATUSI = 'CLOSED' OR 'C'
 10256         IF CL-CLAIM-STATUS = 'C'
 10257             MOVE SPACES         TO TRLR-SWITCH
 10258                 GO TO 2100-NO-STATUS-CHANGE.
 10259
 10260     IF PI-COMPANY-ID = 'DMD'
 10261        IF STATUSI = 'OPEN' OR 'O'
 10262           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10263              MOVE ZERO       TO STATUSL
 10264              MOVE LOW-VALUES TO STATUSI
 10265              GO TO 2100-NO-STATUS-CHANGE.
 10266
 10267     IF PI-COMPANY-ID = 'DMD'
 10268         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10269
 10270     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10271
 10272 2100-NO-STATUS-CHANGE.
 10273
 10274     IF CCNOI GREATER THAN LOW-VALUES
 10275         MOVE CCNOI              TO CL-CCN.
 10276
 10277     IF PROCI GREATER THAN LOW-VALUES
 10278         MOVE PROCI              TO CL-PROCESSOR-ID.
 10279
 10280     IF SEXI GREATER THAN LOW-VALUES
 10281         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10282
 10283     IF BIRTHI GREATER THAN LOW-VALUES
 10284         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10285
 10286     IF SOCIALI GREATER THAN LOW-VALUES
 10287       AND
 10288        SOCIALI = SPACES
 10289         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10290         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10291         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10292     ELSE
 10293         IF SOCIALI GREATER THAN LOW-VALUES
 10294             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10295
 10296     IF OCCI GREATER THAN LOW-VALUES
 10297         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10298
 10299     IF BENEL GREATER THAN ZERO
 10300         MOVE BENEI              TO CL-BENEFICIARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL131.cbl
 10301
 10302     IF DIAGI GREATER THAN LOW-VALUES
 10303         MOVE DIAGI              TO WS-DIAGNOSIS.
 10304
 10305     IF PREMTYPI GREATER THAN LOW-VALUES
 10306         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10307
 10308     IF CAUSEI GREATER THAN LOW-VALUES
 10309         MOVE CAUSEI             TO CL-CAUSE-CD.
 10310
 10311     IF ENDI GREATER THAN LOW-VALUES
 10312         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10313
 10314     IF PDTHRUI GREATER THAN LOW-VALUES
 10315        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10316
 10317     IF PDAMTL GREATER THAN +0
 10318        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10319
 10320     IF NODAYSI GREATER THAN LOW-VALUES
 10321        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10322
 10323     IF NOPMTSI GREATER THAN LOW-VALUES
 10324        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10325
 10326     IF FORMTYPI GREATER THAN LOW-VALUES
 10327        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10328
 10329     IF INCI GREATER THAN LOW-VALUES
 10330        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10331
 10332     IF REPI GREATER THAN LOW-VALUES
 10333        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10334
 10335     IF ADDONDTI GREATER THAN LOW-VALUES
 10336        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10337
 10338     IF PRICDI GREATER THAN LOW-VALUES
 10339         MOVE PRICDI             TO CL-PRIORITY-CD.
 10340
 10341     IF FILETOI GREATER THAN LOW-VALUES
 10342         MOVE FILETOI            TO CL-FILE-LOCATION.
 10343
 10344     IF SUPVI GREATER THAN LOW-VALUES
 10345         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10346
 10347     IF MLNAMEI GREATER THAN LOW-VALUES
 10348         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10349
 10350     IF MFNAMEI GREATER THAN LOW-VALUES
 10351         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10352
 10353     IF MMINITI GREATER THAN LOW-VALUES
 10354         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10355
 10356     IF CERTEFFI GREATER THAN LOW-VALUES
 10357         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10358
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL131.cbl
 10359     IF CERTACTI GREATER THAN LOW-VALUES
 10360         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10361
 10362     IF CERTSTI GREATER THAN LOW-VALUES
 10363         MOVE CERTSTI            TO CL-CERT-STATE.
 10364
 10365     IF CERTCARI GREATER THAN LOW-VALUES
 10366         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10367                                    CL-CARRIER.
 10368
 10369     IF CERTGRPI GREATER THAN LOW-VALUES
 10370         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10371
 10372     IF CERTI GREATER THAN LOW-VALUES
 10373         MOVE CERTI              TO CERT-NO-PRIME.
 10374
 10375     IF SUFXI GREATER THAN LOW-VALUES
 10376         MOVE SUFXI              TO CERT-NO-SUFX.
 10377
 10378     MOVE CERT-NO                TO CL-CERT-NO
 10379                                    CL-CERT-NO-A4.
 10380
 10381     IF PI-COMPANY-ID = 'FLA'
 10382          NEXT SENTENCE
 10383     ELSE
 10384         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10385         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10386         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10387         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10388
 10389     IF TRLR-UPDATE-REQUIRED
 10390        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10391        MOVE ZEROS              TO TRLR-SEQ-NO
 10392
 10393* EXEC CICS READ
 10394*            DATASET   (TRLR-FILE-ID)
 10395*            RIDFLD    (TRLR-KEY)
 10396*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10397*       END-EXEC
 10398*    MOVE '&"S        E          (   #00009386' TO DFHEIV0
 10399     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10401     MOVE X'2020233030303039333836' TO DFHEIV0(25:11)
 10402     CALL 'kxdfhei1' USING DFHEIV0,
 10403           TRLR-FILE-ID,
 10404           DFHEIV20,
 10405           DFHEIV99,
 10406           TRLR-KEY,
 10407           DFHEIV99,
 10408           DFHEIV99,
 10409           DFHEIV99
 10410     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10411         DFHEIV20
 10412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10413        IF AT-TRAILER-TYPE = '1'
 10414           MOVE +1 TO MISC-SUB
 10415           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10416           MISC-SUB GREATER THAN +6 OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL131.cbl
 10417           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10418           IF MISC-SUB GREATER THAN +1
 10419              SUBTRACT +1 FROM MISC-SUB
 10420              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10421                 GO TO 2100-BYPASS-LAST-UPDATE.
 10422
 10423     IF TRLR-UPDATE-REQUIRED AND
 10424        CLAIM-IS-OPEN
 10425         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10426     ELSE
 10427         IF TRLR-UPDATE-REQUIRED AND
 10428            CLAIM-IS-CLOSED
 10429             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10430             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10431
 10432 2100-BYPASS-LAST-UPDATE.
 10433     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10434     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10435
 10436     GO TO 2100-EXIT.
 10437
 10438 2100-BUMP-OPEN-CLOSE-HIST.
 10439     ADD +1                      TO MISC-SUB.
 10440
 10441 2100-EXIT.
 10442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL131.cbl
 10444 2200-MOVE-CERT.
 10445     IF CRTLNMEI GREATER THAN LOW-VALUES
 10446         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 10447
 10448     IF CRTFNMEI GREATER THAN LOW-VALUES
 10449         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 10450         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 10451
 10452     IF CRTINITI GREATER THAN LOW-VALUES
 10453         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 10454
 10455     IF CM-INSURED-INITIALS = SPACES
 10456         MOVE '**'               TO CM-INSURED-INITIALS.
 10457
 10458     IF ISSAGEI GREATER THAN LOW-VALUES
 10459         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 10460
 10461     IF JNTFNMEI GREATER THAN LOW-VALUES
 10462         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 10463
 10464     IF JNTLNMEI GREATER THAN LOW-VALUES
 10465         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 10466
 10467     IF JNTINITI GREATER THAN LOW-VALUES
 10468         MOVE JNTINITI           TO CM-JT-INITIAL.
 10469
 10470     IF JNTAGEI GREATER THAN LOW-VALUES
 10471         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 10472
 10473     IF ADDONDTI GREATER THAN LOW-VALUES
 10474        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 10475
 10476     IF LCVCDI GREATER THAN LOW-VALUES
 10477        IF LCVCDI = SPACES OR ZEROS
 10478           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 10479        ELSE
 10480           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 10481
 10482     IF LCVOTRMI GREATER THAN LOW-VALUES
 10483         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 10484
 10485     IF LCVRATEL GREATER THAN +0
 10486         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 10487
 10488     IF LCVBENEL GREATER THAN +0
 10489         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 10490
 10491     IF LCVFORMI GREATER THAN LOW-VALUES
 10492         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 10493
 10494     IF LCVCNDTI = LOW-VALUES
 10495        GO TO 2210-SET-STATUS.
 10496
 10497     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 10498        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10499        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 10500        GO TO 2210-SET-STATUS.
 10501
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL131.cbl
 10502     IF CM-LF-CURRENT-STATUS = '7'
 10503        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 10504        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10505        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10506                                    CM-LF-DEATH-DT
 10507        GO TO 2210-SET-STATUS.
 10508
 10509     IF CM-LF-CURRENT-STATUS = '8'
 10510        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10511        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10512                                    CM-LF-CANCEL-DT.
 10513
 10514 2210-SET-STATUS.
 10515
 10516     IF CM-LF-CURRENT-STATUS = SPACES
 10517         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10518
 10519     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 10520         MOVE '6'                TO DC-OPTION-CODE
 10521         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10522         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10523         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10524         IF NO-CONVERSION-ERROR
 10525             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 10526         ELSE
 10527             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 10528     ELSE
 10529         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 10530
 10531 2215-PROCESS-AH-SIDE.
 10532
 10533     IF ACVCDI GREATER THAN LOW-VALUES
 10534        IF ACVCDI = SPACES OR ZEROS
 10535           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 10536        ELSE
 10537           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 10538
 10539     IF ACVOTRMI GREATER THAN LOW-VALUES
 10540         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 10541
 10542     IF ACVRATEL GREATER THAN +0
 10543         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 10544
 10545     IF ACVBENEL GREATER THAN +0
 10546         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 10547                                    PI-PAYMENT-AMT.
 10548
 10549     IF ACVFORMI GREATER THAN LOW-VALUES
 10550         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 10551
 10552     IF ACVCNDTI = LOW-VALUES
 10553        GO TO 2220-SET-STATUS.
 10554
 10555     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 10556        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10557        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 10558        GO TO 2220-SET-STATUS.
 10559
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL131.cbl
 10560     IF CM-AH-CURRENT-STATUS = '6'
 10561        MOVE CM-AH-STATUS-AT-SETTLEMENT
 10562                                 TO CM-AH-CURRENT-STATUS
 10563        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10564        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10565                                    CM-AH-SETTLEMENT-DT
 10566        GO TO 2220-SET-STATUS.
 10567
 10568     IF CM-AH-CURRENT-STATUS = '8'
 10569        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10570        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10571                                    CM-AH-CANCEL-DT.
 10572
 10573 2220-SET-STATUS.
 10574     IF CM-AH-CURRENT-STATUS = SPACES
 10575         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10576
 10577     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 10578         MOVE '6'                TO DC-OPTION-CODE
 10579         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10580         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10581         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10582         IF NO-CONVERSION-ERROR
 10583             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 10584         ELSE
 10585             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 10586     ELSE
 10587         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 10588
 10589 2225-FINISH-CERT.
 10590     IF APRL GREATER THAN +0
 10591         MOVE HOLD-APR           TO CM-LOAN-APR.
 10592
 10593     IF PMTFREQI GREATER THAN LOW-VALUES
 10594         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 10595
 10596     IF INDGRPI GREATER THAN LOW-VALUES
 10597         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 10598
 10599     IF LOANNOI GREATER THAN LOW-VALUES
 10600        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 10601
 10602     IF LOANBALL GREATER THAN +0
 10603        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 10604
 10605     IF PREMTYPI GREATER THAN LOW-VALUES
 10606         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 10607
 10608     IF REINCDI GREATER THAN LOW-VALUES
 10609         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10610                                    WS-REIN-1
 10611                                    WS-REIN-2
 10612                                    WS-REIN-3
 10613         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 10614
 10615     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 10616
 10617     MOVE ZEROS                  TO CM-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL131.cbl
 10618                                    CM-LIFE-COMM-PCT
 10619                                    CM-AH-COMM-PCT.
 10620
 10621*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 10622*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 10623*         PI-NO-PMTS = ZEROS
 10624*          IF LOANBALL GREATER THAN +0          OR
 10625*             ACVBENEL GREATER THAN +0          OR
 10626*             APRL     GREATER THAN +0          OR
 10627*             LCVRATEL GREATER THAN +0          OR
 10628*             ACVRATEL GREATER THAN +0
 10629*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 10630
 10631 2200-EXIT.
 10632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL131.cbl
 10634 2300-UPDATE-TRLR.
 10635
 10636
 10637* EXEC CICS READ UPDATE
 10638*         DATASET  (TRLR-FILE-ID)
 10639*         RIDFLD   (TRLR-KEY)
 10640*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10641*    END-EXEC.
 10642*    MOVE '&"S        EU         (   #00009614' TO DFHEIV0
 10643     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10645     MOVE X'2020233030303039363134' TO DFHEIV0(25:11)
 10646     CALL 'kxdfhei1' USING DFHEIV0,
 10647           TRLR-FILE-ID,
 10648           DFHEIV20,
 10649           DFHEIV99,
 10650           TRLR-KEY,
 10651           DFHEIV99,
 10652           DFHEIV99,
 10653           DFHEIV99
 10654     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10655         DFHEIV20
 10656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10657
 10658
 10659     MOVE ZERO                   TO COUNT-2.
 10660
 10661     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10662         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10663
 10664     IF NOT UPDATE-MADE
 10665         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10666
 10667
 10668* EXEC CICS REWRITE
 10669*         DATASET  (TRLR-FILE-ID)
 10670*         FROM     (ACTIVITY-TRAILERS)
 10671*    END-EXEC.
 10672     MOVE LENGTH OF
 10673      ACTIVITY-TRAILERS
 10674       TO DFHEIV11
 10675*    MOVE '&& L                  %   #00009628' TO DFHEIV0
 10676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10678     MOVE X'2020233030303039363238' TO DFHEIV0(25:11)
 10679     CALL 'kxdfhei1' USING DFHEIV0,
 10680           TRLR-FILE-ID,
 10681           ACTIVITY-TRAILERS,
 10682           DFHEIV11,
 10683           DFHEIV99
 10684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10685
 10686
 10687 2300-EXIT.
 10688     EXIT.
 10689
 10690 2310-INS-STATUS.
 10691     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL131.cbl
 10692     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 10693         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 10694         MOVE 'Y'                TO TRLR-SWITCH.
 10695
 10696 2310-EXIT.
 10697     EXIT.
 10698
 10699 2320-SHIFT-STATUS.
 10700     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 10701        MOVE 6                   TO COUNT-2
 10702        GO TO 2320-EXIT.
 10703
 10704     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 10705     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 10706     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 10707     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 10708     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 10709     MOVE 6       TO COUNT-2.
 10710     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 10711
 10712 2320-EXIT.
 10713     EXIT.
 10714
 10715 2330-ADD-UPDATE.
 10716
 10717     IF COUNT-2 GREATER THAN 1
 10718        COMPUTE MISC-SUB = (COUNT-2 - 1)
 10719        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10720           GO TO 2330-EXIT.
 10721
 10722     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 10723                                   AT-RESERVES-LAST-MAINT-DT
 10724
 10725     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 10726     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 10727     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 10728     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 10729
 10730 2330-EXIT.
 10731     EXIT.
 10732
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL131.cbl
 10734 2400-UPDATE-TRLR.
 10735
 10736* EXEC CICS HANDLE CONDITION
 10737*         NOTFND    (2400-TRLR-NOTFND)
 10738*         ENDFILE   (2410-EXIT)
 10739*    END-EXEC.
 10740*    MOVE '"$I''                  ! 4 #00009681' TO DFHEIV0
 10741     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10743     MOVE X'3420233030303039363831' TO DFHEIV0(25:11)
 10744     CALL 'kxdfhei1' USING DFHEIV0
 10745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10746
 10747
 10748
 10749* EXEC CICS STARTBR
 10750*        DATASET (TRLR-FILE-ID)
 10751*        RIDFLD  (TRLR-KEY)
 10752*    END-EXEC.
 10753     MOVE 0
 10754       TO DFHEIV11
 10755*    MOVE '&,         G          &   #00009686' TO DFHEIV0
 10756     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10758     MOVE X'2020233030303039363836' TO DFHEIV0(25:11)
 10759     CALL 'kxdfhei1' USING DFHEIV0,
 10760           TRLR-FILE-ID,
 10761           TRLR-KEY,
 10762           DFHEIV99,
 10763           DFHEIV11,
 10764           DFHEIV99
 10765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10766
 10767
 10768
 10769* EXEC CICS GETMAIN
 10770*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10771*         LENGTH    (TRLR-LENGTH)
 10772*         INITIMG   (GETMAIN-SPACE)
 10773*    END-EXEC.
 10774*    MOVE ',"IL                  $   #00009691' TO DFHEIV0
 10775     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10776     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10777     MOVE X'2020233030303039363931' TO DFHEIV0(25:11)
 10778     CALL 'kxdfhei1' USING DFHEIV0,
 10779           DFHEIV20,
 10780           TRLR-LENGTH,
 10781           GETMAIN-SPACE
 10782     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10783         DFHEIV20
 10784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10785
 10786
 10787     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 10788
 10789
 10790* EXEC CICS ENDBR
 10791*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL131.cbl
 10792*    END-EXEC.
 10793     MOVE 0
 10794       TO DFHEIV11
 10795*    MOVE '&2                    $   #00009699' TO DFHEIV0
 10796     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10797     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10798     MOVE X'2020233030303039363939' TO DFHEIV0(25:11)
 10799     CALL 'kxdfhei1' USING DFHEIV0,
 10800           TRLR-FILE-ID,
 10801           DFHEIV11,
 10802           DFHEIV99
 10803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10804
 10805
 10806     GO TO 2400-EXIT.
 10807
 10808 2400-TRLR-NOTFND.
 10809     MOVE ER-0205                TO EMI-ERROR.
 10810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10811     MOVE 'X'                    TO ERROR-SWITCH.
 10812
 10813 2400-EXIT.
 10814     EXIT.
 10815
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL131.cbl
 10817 2410-CHANGE-TRLR.
 10818
 10819* EXEC CICS READNEXT
 10820*        DATASET (TRLR-FILE-ID)
 10821*        RIDFLD  (TRLR-KEY)
 10822*        INTO    (ACTIVITY-TRAILERS)
 10823*    END-EXEC.
 10824     MOVE LENGTH OF
 10825      ACTIVITY-TRAILERS
 10826       TO DFHEIV12
 10827     MOVE 0
 10828       TO DFHEIV11
 10829*    MOVE '&.IL                  )   #00009715' TO DFHEIV0
 10830     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10832     MOVE X'2020233030303039373135' TO DFHEIV0(25:11)
 10833     CALL 'kxdfhei1' USING DFHEIV0,
 10834           TRLR-FILE-ID,
 10835           ACTIVITY-TRAILERS,
 10836           DFHEIV12,
 10837           TRLR-KEY,
 10838           DFHEIV99,
 10839           DFHEIV11,
 10840           DFHEIV99,
 10841           DFHEIV99
 10842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10843
 10844
 10845     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 10846        GO TO 2410-CHANGE-TRLR.
 10847
 10848     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 10849                                    CHECK-KEY.
 10850
 10851     IF CHECK-KEY NOT = MSTR-KEY
 10852         GO TO 2410-EXIT.
 10853
 10854
 10855* EXEC CICS ENDBR
 10856*        DATASET (TRLR-FILE-ID)
 10857*    END-EXEC.
 10858     MOVE 0
 10859       TO DFHEIV11
 10860*    MOVE '&2                    $   #00009730' TO DFHEIV0
 10861     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10863     MOVE X'2020233030303039373330' TO DFHEIV0(25:11)
 10864     CALL 'kxdfhei1' USING DFHEIV0,
 10865           TRLR-FILE-ID,
 10866           DFHEIV11,
 10867           DFHEIV99
 10868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10869
 10870
 10871
 10872* EXEC CICS READ UPDATE
 10873*        DATASET (TRLR-FILE-ID)
 10874*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL131.cbl
 10875*        INTO    (ACTIVITY-TRAILERS)
 10876*    END-EXEC.
 10877     MOVE LENGTH OF
 10878      ACTIVITY-TRAILERS
 10879       TO DFHEIV11
 10880*    MOVE '&"IL       EU         (   #00009734' TO DFHEIV0
 10881     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10883     MOVE X'2020233030303039373334' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           TRLR-FILE-ID,
 10886           ACTIVITY-TRAILERS,
 10887           DFHEIV11,
 10888           TRLR-KEY,
 10889           DFHEIV99,
 10890           DFHEIV99,
 10891           DFHEIV99
 10892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10893
 10894
 10895
 10896* EXEC CICS DELETE
 10897*        DATASET (TRLR-FILE-ID)
 10898*    END-EXEC.
 10899*    MOVE '&(                    &   #00009740' TO DFHEIV0
 10900     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10902     MOVE X'2020233030303039373430' TO DFHEIV0(25:11)
 10903     CALL 'kxdfhei1' USING DFHEIV0,
 10904           TRLR-FILE-ID,
 10905           DFHEIV99,
 10906           DFHEIV99,
 10907           DFHEIV99,
 10908           DFHEIV99
 10909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10910
 10911
 10912     IF AT-SEQUENCE-NO = ZERO AND
 10913        TRLR-UPDATE-REQUIRED
 10914         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 10915
 10916     IF CERTI GREATER THAN LOW-VALUES
 10917        MOVE CERTI               TO AT-CERT-PRIME.
 10918
 10919     IF SUFXI GREATER THAN LOW-VALUES
 10920        MOVE SUFXI               TO AT-CERT-SFX.
 10921
 10922     IF CERTCARI GREATER THAN LOW-VALUES
 10923        MOVE CERTCARI            TO AT-CARRIER.
 10924
 10925     IF PAYMENT-TR
 10926        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 10927           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 10928              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 10929
 10930     IF CORRESPONDENCE-TR
 10931        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 10932           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL131.cbl
 10933
 10934
 10935* EXEC CICS WRITE
 10936*         DATASET  (TRLR-FILE-ID)
 10937*         RIDFLD   (AT-CONTROL-PRIMARY)
 10938*         FROM     (ACTIVITY-TRAILERS)
 10939*    END-EXEC.
 10940     MOVE LENGTH OF
 10941      ACTIVITY-TRAILERS
 10942       TO DFHEIV11
 10943*    MOVE '&$ L                  ''   #00009766' TO DFHEIV0
 10944     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10945     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10946     MOVE X'2020233030303039373636' TO DFHEIV0(25:11)
 10947     CALL 'kxdfhei1' USING DFHEIV0,
 10948           TRLR-FILE-ID,
 10949           ACTIVITY-TRAILERS,
 10950           DFHEIV11,
 10951           AT-CONTROL-PRIMARY,
 10952           DFHEIV99,
 10953           DFHEIV99
 10954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10955
 10956
 10957
 10958* EXEC CICS STARTBR
 10959*         DATASET  (TRLR-FILE-ID)
 10960*         RIDFLD   (TRLR-KEY)
 10961*    END-EXEC.
 10962     MOVE 0
 10963       TO DFHEIV11
 10964*    MOVE '&,         G          &   #00009772' TO DFHEIV0
 10965     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10967     MOVE X'2020233030303039373732' TO DFHEIV0(25:11)
 10968     CALL 'kxdfhei1' USING DFHEIV0,
 10969           TRLR-FILE-ID,
 10970           TRLR-KEY,
 10971           DFHEIV99,
 10972           DFHEIV11,
 10973           DFHEIV99
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977     GO TO 2410-CHANGE-TRLR.
 10978
 10979 2410-EXIT.
 10980     EXIT.
 10981
 10982 2420-UPDATE-TRLR.
 10983     MOVE ZERO TO COUNT-2.
 10984     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10985         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10986
 10987     IF NOT UPDATE-MADE
 10988         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10989
 10990 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL131.cbl
 10991     EXIT.
 10992
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL131.cbl
 10994 2425-UPDATE-NINETY-TRLR.
 10995
 10996     MOVE +90                    TO TRLR-SEQ-NO.
 10997
 10998
 10999* EXEC CICS HANDLE CONDITION
 11000*         NOTFND    (2425-NINETY-NOTFND)
 11001*         ENDFILE   (2425-NINETY-NOTFND)
 11002*    END-EXEC.
 11003*    MOVE '"$I''                  ! 5 #00009798' TO DFHEIV0
 11004     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11006     MOVE X'3520233030303039373938' TO DFHEIV0(25:11)
 11007     CALL 'kxdfhei1' USING DFHEIV0
 11008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11009
 11010
 11011
 11012* EXEC CICS READ UPDATE
 11013*        DATASET (TRLR-FILE-ID)
 11014*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11015*        RIDFLD  (TRLR-KEY)
 11016*    END-EXEC.
 11017*    MOVE '&"S        EU         (   #00009803' TO DFHEIV0
 11018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11020     MOVE X'2020233030303039383033' TO DFHEIV0(25:11)
 11021     CALL 'kxdfhei1' USING DFHEIV0,
 11022           TRLR-FILE-ID,
 11023           DFHEIV20,
 11024           DFHEIV99,
 11025           TRLR-KEY,
 11026           DFHEIV99,
 11027           DFHEIV99,
 11028           DFHEIV99
 11029     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11030         DFHEIV20
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11035
 11036     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11037
 11038
 11039* EXEC CICS REWRITE
 11040*        DATASET (TRLR-FILE-ID)
 11041*        FROM    (ACTIVITY-TRAILERS)
 11042*    END-EXEC.
 11043     MOVE LENGTH OF
 11044      ACTIVITY-TRAILERS
 11045       TO DFHEIV11
 11046*    MOVE '&& L                  %   #00009813' TO DFHEIV0
 11047     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11048     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11049     MOVE X'2020233030303039383133' TO DFHEIV0(25:11)
 11050     CALL 'kxdfhei1' USING DFHEIV0,
 11051           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL131.cbl
 11052           ACTIVITY-TRAILERS,
 11053           DFHEIV11,
 11054           DFHEIV99
 11055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11056
 11057
 11058     IF DIAGI NOT = WS-DIAGNOSIS
 11059         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11060         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11061         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11062
 11063     GO TO 2425-EXIT.
 11064
 11065 2425-NINETY-NOTFND.
 11066
 11067
 11068* EXEC CICS GETMAIN
 11069*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11070*         LENGTH    (TRLR-LENGTH)
 11071*         INITIMG   (GETMAIN-SPACE)
 11072*    END-EXEC.
 11073*    MOVE ',"IL                  $   #00009827' TO DFHEIV0
 11074     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11076     MOVE X'2020233030303039383237' TO DFHEIV0(25:11)
 11077     CALL 'kxdfhei1' USING DFHEIV0,
 11078           DFHEIV20,
 11079           TRLR-LENGTH,
 11080           GETMAIN-SPACE
 11081     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11082         DFHEIV20
 11083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11084
 11085
 11086     MOVE +90                  TO TRLR-SEQ-NO.
 11087     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11088
 11089     MOVE 'AT'                 TO AT-RECORD-ID
 11090     MOVE '6'                  TO AT-TRAILER-TYPE
 11091     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11092                                  AT-GEN-INFO-LAST-MAINT-DT
 11093     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11094                                  AT-GEN-INFO-LAST-UPDATED-BY
 11095     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11096     MOVE DIAGI                TO AT-INFO-LINE-1.
 11097
 11098
 11099* EXEC CICS WRITE
 11100*        DATASET (TRLR-FILE-ID)
 11101*        FROM    (ACTIVITY-TRAILERS)
 11102*        RIDFLD  (TRLR-KEY)
 11103*    END-EXEC.
 11104     MOVE LENGTH OF
 11105      ACTIVITY-TRAILERS
 11106       TO DFHEIV11
 11107*    MOVE '&$ L                  ''   #00009845' TO DFHEIV0
 11108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL131.cbl
 11110     MOVE X'2020233030303039383435' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0,
 11112           TRLR-FILE-ID,
 11113           ACTIVITY-TRAILERS,
 11114           DFHEIV11,
 11115           TRLR-KEY,
 11116           DFHEIV99,
 11117           DFHEIV99
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11119
 11120
 11121 2425-EXIT.
 11122     EXIT.
 11123
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL131.cbl
 11125 2430-UPDATE-ACTQ.
 11126
 11127* EXEC CICS HANDLE CONDITION
 11128*         NOTFND    (2430-EXIT)
 11129*         ENDFILE   (2440-EXIT)
 11130*    END-EXEC.
 11131*    MOVE '"$I''                  ! 6 #00009856' TO DFHEIV0
 11132     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11134     MOVE X'3620233030303039383536' TO DFHEIV0(25:11)
 11135     CALL 'kxdfhei1' USING DFHEIV0
 11136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11137
 11138
 11139
 11140* EXEC CICS STARTBR
 11141*         DATASET  (ACTQ-FILE-ID)
 11142*         RIDFLD   (ACTQ-KEY)
 11143*    END-EXEC.
 11144     MOVE 0
 11145       TO DFHEIV11
 11146*    MOVE '&,         G          &   #00009861' TO DFHEIV0
 11147     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11148     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11149     MOVE X'2020233030303039383631' TO DFHEIV0(25:11)
 11150     CALL 'kxdfhei1' USING DFHEIV0,
 11151           ACTQ-FILE-ID,
 11152           ACTQ-KEY,
 11153           DFHEIV99,
 11154           DFHEIV11,
 11155           DFHEIV99
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159
 11160* EXEC CICS GETMAIN
 11161*         SET      (ADDRESS OF ACTIVITY-QUE)
 11162*         LENGTH   (ACTQ-LENGTH)
 11163*         INITIMG  (GETMAIN-SPACE)
 11164*    END-EXEC.
 11165*    MOVE ',"IL                  $   #00009866' TO DFHEIV0
 11166     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11167     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11168     MOVE X'2020233030303039383636' TO DFHEIV0(25:11)
 11169     CALL 'kxdfhei1' USING DFHEIV0,
 11170           DFHEIV20,
 11171           ACTQ-LENGTH,
 11172           GETMAIN-SPACE
 11173     SET ADDRESS OF ACTIVITY-QUE TO
 11174         DFHEIV20
 11175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11176
 11177
 11178     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11179
 11180 2430-EXIT.
 11181     EXIT.
 11182
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL131.cbl
 11183 2440-CHANGE-ACTQ.
 11184
 11185
 11186* EXEC CICS READNEXT
 11187*         DATASET  (ACTQ-FILE-ID)
 11188*         RIDFLD   (ACTQ-KEY)
 11189*         INTO     (ACTIVITY-QUE)
 11190*    END-EXEC.
 11191     MOVE LENGTH OF
 11192      ACTIVITY-QUE
 11193       TO DFHEIV12
 11194     MOVE 0
 11195       TO DFHEIV11
 11196*    MOVE '&.IL                  )   #00009879' TO DFHEIV0
 11197     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11198     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11199     MOVE X'2020233030303039383739' TO DFHEIV0(25:11)
 11200     CALL 'kxdfhei1' USING DFHEIV0,
 11201           ACTQ-FILE-ID,
 11202           ACTIVITY-QUE,
 11203           DFHEIV12,
 11204           ACTQ-KEY,
 11205           DFHEIV99,
 11206           DFHEIV11,
 11207           DFHEIV99,
 11208           DFHEIV99
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11210
 11211
 11212
 11213* EXEC CICS ENDBR
 11214*         DATASET (ACTQ-FILE-ID)
 11215*    END-EXEC.
 11216     MOVE 0
 11217       TO DFHEIV11
 11218*    MOVE '&2                    $   #00009885' TO DFHEIV0
 11219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11221     MOVE X'2020233030303039383835' TO DFHEIV0(25:11)
 11222     CALL 'kxdfhei1' USING DFHEIV0,
 11223           ACTQ-FILE-ID,
 11224           DFHEIV11,
 11225           DFHEIV99
 11226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11227
 11228
 11229     IF ACTQ-KEY NOT = MSTR-KEY
 11230         GO TO 2440-EXIT.
 11231
 11232
 11233* EXEC CICS READ UPDATE
 11234*         DATASET  (ACTQ-FILE-ID)
 11235*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11236*         SET      (ADDRESS OF ACTIVITY-QUE)
 11237*    END-EXEC.
 11238*    MOVE '&"S        EU         (   #00009892' TO DFHEIV0
 11239     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL131.cbl
 11241     MOVE X'2020233030303039383932' TO DFHEIV0(25:11)
 11242     CALL 'kxdfhei1' USING DFHEIV0,
 11243           ACTQ-FILE-ID,
 11244           DFHEIV20,
 11245           DFHEIV99,
 11246           AQ-CONTROL-PRIMARY,
 11247           DFHEIV99,
 11248           DFHEIV99,
 11249           DFHEIV99
 11250     SET ADDRESS OF ACTIVITY-QUE TO
 11251         DFHEIV20
 11252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11253
 11254
 11255     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11256
 11257
 11258* EXEC CICS DELETE
 11259*         DATASET (ACTQ-FILE-ID)
 11260*    END-EXEC.
 11261*    MOVE '&(                    &   #00009900' TO DFHEIV0
 11262     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11264     MOVE X'2020233030303039393030' TO DFHEIV0(25:11)
 11265     CALL 'kxdfhei1' USING DFHEIV0,
 11266           ACTQ-FILE-ID,
 11267           DFHEIV99,
 11268           DFHEIV99,
 11269           DFHEIV99,
 11270           DFHEIV99
 11271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11272
 11273
 11274     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11275     IF CERTI GREATER THAN LOW-VALUES
 11276        MOVE CERTI               TO AQ-CERT-PRIME.
 11277     IF SUFXI GREATER THAN LOW-VALUES
 11278        MOVE SUFXI               TO AQ-CERT-SFX.
 11279     IF CERTCARI GREATER THAN LOW-VALUES
 11280        MOVE CERTCARI            TO AQ-CARRIER.
 11281
 11282
 11283* EXEC CICS HANDLE CONDITION
 11284*         DUPREC   (2440-EXIT)
 11285*    END-EXEC.
 11286*    MOVE '"$%                   ! 7 #00009912' TO DFHEIV0
 11287     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11289     MOVE X'3720233030303039393132' TO DFHEIV0(25:11)
 11290     CALL 'kxdfhei1' USING DFHEIV0
 11291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11292
 11293
 11294
 11295* EXEC CICS WRITE
 11296*         DATASET  (ACTQ-FILE-ID)
 11297*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11298*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL131.cbl
 11299*    END-EXEC.
 11300     MOVE LENGTH OF
 11301      ACTIVITY-QUE
 11302       TO DFHEIV11
 11303*    MOVE '&$ L                  ''   #00009916' TO DFHEIV0
 11304     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11305     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11306     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 11307     CALL 'kxdfhei1' USING DFHEIV0,
 11308           ACTQ-FILE-ID,
 11309           ACTIVITY-QUE,
 11310           DFHEIV11,
 11311           AQ-CONTROL-PRIMARY,
 11312           DFHEIV99,
 11313           DFHEIV99
 11314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11315
 11316
 11317 2440-EXIT.
 11318     EXIT.
 11319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL131.cbl
 11321 2460-UPDATE-CHECKQ.
 11322
 11323* EXEC CICS HANDLE CONDITION
 11324*         NOTFND   (2460-EXIT)
 11325*    END-EXEC.
 11326*    MOVE '"$I                   ! 8 #00009927' TO DFHEIV0
 11327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11329     MOVE X'3820233030303039393237' TO DFHEIV0(25:11)
 11330     CALL 'kxdfhei1' USING DFHEIV0
 11331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11332
 11333
 11334     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11335     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11336     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11337
 11338
 11339* EXEC CICS READ UPDATE
 11340*         DATASET   (CHKQ-FILE-ID)
 11341*         RIDFLD    (CHKQ-KEY)
 11342*         SET       (ADDRESS OF CHECK-QUE)
 11343*    END-EXEC.
 11344*    MOVE '&"S        EU         (   #00009935' TO DFHEIV0
 11345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11346     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11347     MOVE X'2020233030303039393335' TO DFHEIV0(25:11)
 11348     CALL 'kxdfhei1' USING DFHEIV0,
 11349           CHKQ-FILE-ID,
 11350           DFHEIV20,
 11351           DFHEIV99,
 11352           CHKQ-KEY,
 11353           DFHEIV99,
 11354           DFHEIV99,
 11355           DFHEIV99
 11356     SET ADDRESS OF CHECK-QUE TO
 11357         DFHEIV20
 11358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11359
 11360
 11361     IF CERTI GREATER THAN LOW-VALUES
 11362        MOVE CERTI               TO CQ-CERT-PRIME.
 11363     IF SUFXI GREATER THAN LOW-VALUES
 11364        MOVE SUFXI               TO CQ-CERT-SFX.
 11365     IF CERTCARI GREATER THAN LOW-VALUES
 11366        MOVE CERTCARI            TO CQ-CARRIER.
 11367
 11368
 11369* EXEC CICS REWRITE
 11370*         DATASET  (CHKQ-FILE-ID)
 11371*         FROM     (CHECK-QUE)
 11372*    END-EXEC.
 11373     MOVE LENGTH OF
 11374      CHECK-QUE
 11375       TO DFHEIV11
 11376*    MOVE '&& L                  %   #00009948' TO DFHEIV0
 11377     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11378     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL131.cbl
 11379     MOVE X'2020233030303039393438' TO DFHEIV0(25:11)
 11380     CALL 'kxdfhei1' USING DFHEIV0,
 11381           CHKQ-FILE-ID,
 11382           CHECK-QUE,
 11383           DFHEIV11,
 11384           DFHEIV99
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11386
 11387
 11388 2460-EXIT.
 11389     EXIT.
 11390
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL131.cbl
 11392 2475-UPDATE-LETTER.
 11393
 11394* EXEC CICS HANDLE CONDITION
 11395*         NOTFND   (2475-EXIT)
 11396*    END-EXEC.
 11397*    MOVE '"$I                   ! 9 #00009958' TO DFHEIV0
 11398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11400     MOVE X'3920233030303039393538' TO DFHEIV0(25:11)
 11401     CALL 'kxdfhei1' USING DFHEIV0
 11402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11403
 11404
 11405     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11406     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11407     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11408     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11409
 11410
 11411* EXEC CICS READ UPDATE
 11412*         DATASET   (ARCH-FILE-ID)
 11413*         RIDFLD    (ARCH-KEY)
 11414*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11415*    END-EXEC.
 11416*    MOVE '&"S        EU         (   #00009967' TO DFHEIV0
 11417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11418     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11419     MOVE X'2020233030303039393637' TO DFHEIV0(25:11)
 11420     CALL 'kxdfhei1' USING DFHEIV0,
 11421           ARCH-FILE-ID,
 11422           DFHEIV20,
 11423           DFHEIV99,
 11424           ARCH-KEY,
 11425           DFHEIV99,
 11426           DFHEIV99,
 11427           DFHEIV99
 11428     SET ADDRESS OF LETTER-ARCHIVE TO
 11429         DFHEIV20
 11430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11431
 11432
 11433* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11434* TO THIS MASTER-KEY INFORMATION.
 11435
 11436     IF LA-CARRIER  = CARRIER-CODE AND
 11437        LA-CLAIM-NO = CLAIM-NO     AND
 11438        LA-CERT-NO  = CERT-NO
 11439        NEXT SENTENCE
 11440     ELSE
 11441        GO TO 2475-UNLOCK.
 11442
 11443     IF CERTI GREATER THAN LOW-VALUES
 11444        MOVE CERTI               TO LA-CERT-PRIME.
 11445     IF SUFXI GREATER THAN LOW-VALUES
 11446        MOVE SUFXI               TO LA-CERT-SFX.
 11447     IF CERTCARI GREATER THAN LOW-VALUES
 11448        MOVE CERTCARI            TO LA-CARRIER.
 11449
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL131.cbl
 11450
 11451* EXEC CICS REWRITE
 11452*         DATASET  (ARCH-FILE-ID)
 11453*         FROM     (LETTER-ARCHIVE)
 11454*    END-EXEC.
 11455     MOVE LENGTH OF
 11456      LETTER-ARCHIVE
 11457       TO DFHEIV11
 11458*    MOVE '&& L                  %   #00009990' TO DFHEIV0
 11459     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11460     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11461     MOVE X'2020233030303039393930' TO DFHEIV0(25:11)
 11462     CALL 'kxdfhei1' USING DFHEIV0,
 11463           ARCH-FILE-ID,
 11464           LETTER-ARCHIVE,
 11465           DFHEIV11,
 11466           DFHEIV99
 11467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11468
 11469
 11470     GO TO 2475-EXIT.
 11471
 11472 2475-UNLOCK.
 11473
 11474* EXEC CICS UNLOCK
 11475*         DATASET  (ARCH-FILE-ID)
 11476*    END-EXEC.
 11477*    MOVE '&*                    #   #00009998' TO DFHEIV0
 11478     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11479     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11480     MOVE X'2020233030303039393938' TO DFHEIV0(25:11)
 11481     CALL 'kxdfhei1' USING DFHEIV0,
 11482           ARCH-FILE-ID,
 11483           DFHEIV99
 11484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11485
 11486
 11487 2475-EXIT.
 11488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL131.cbl
 11490 2600-CREATE-MAINT-NOTE.
 11491     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 11492     MOVE '1'                    TO CNTL-REC-TYPE.
 11493     MOVE SPACES                 TO CNTL-PROC-ID.
 11494     MOVE ZERO                   TO CNTL-SEQ-NO.
 11495
 11496
 11497* EXEC CICS READ
 11498*         SET        (ADDRESS OF CONTROL-FILE)
 11499*         DATASET    ('ELCNTL')
 11500*         RIDFLD     (CNTL-KEY)
 11501*    END-EXEC.
 11502     MOVE 'ELCNTL' TO DFHEIV1
 11503*    MOVE '&"S        E          (   #00010011' TO DFHEIV0
 11504     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11506     MOVE X'2020233030303130303131' TO DFHEIV0(25:11)
 11507     CALL 'kxdfhei1' USING DFHEIV0,
 11508           DFHEIV1,
 11509           DFHEIV20,
 11510           DFHEIV99,
 11511           CNTL-KEY,
 11512           DFHEIV99,
 11513           DFHEIV99,
 11514           DFHEIV99
 11515     SET ADDRESS OF CONTROL-FILE TO
 11516         DFHEIV20
 11517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11518
 11519
 11520     IF CO-NO-USE-AUDIT-CHANGES
 11521         GO TO 2600-EXIT.
 11522
 11523     IF PROCL GREATER ZERO
 11524     IF PROCI NOT = LOW-VALUES
 11525     IF PROCI NOT = CL-PROCESSOR-ID
 11526         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 11527         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 11528         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11529
 11530     IF SEXL GREATER ZERO
 11531     IF SEXI NOT = LOW-VALUES
 11532     IF SEXI NOT = CL-INSURED-SEX-CD
 11533         MOVE 'SEX'                TO SPLIT-INFO-DESC
 11534         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 11535         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11536
 11537     IF BIRTHL GREATER ZERO
 11538     IF HOLD-BIRTH NOT = LOW-VALUES
 11539     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 11540         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 11541         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 11542         MOVE SPACES               TO DC-OPTION-CODE
 11543         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11544         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11545         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11546
 11547     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL131.cbl
 11548     IF SOCIALI NOT = LOW-VALUES
 11549     IF SOCIALI NOT = CL-SOC-SEC-NO
 11550         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 11551         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 11552         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11553
 11554     IF OCCL GREATER ZERO
 11555     IF OCCI NOT = LOW-VALUES
 11556     IF OCCI NOT = CL-INSURED-OCC-CD
 11557         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 11558         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 11559         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11560
 11561     IF BENEL GREATER ZERO
 11562     IF BENEI NOT = LOW-VALUES
 11563     IF BENEI NOT = CL-BENEFICIARY
 11564         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 11565         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 11566         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11567
 11568     IF PREMTYPL GREATER ZERO
 11569     IF PREMTYPI NOT = LOW-VALUES
 11570     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 11571         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 11572         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 11573         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11574
 11575     IF CAUSEL GREATER ZERO
 11576     IF CAUSEI NOT = LOW-VALUES
 11577     IF CAUSEI NOT = CL-CAUSE-CD
 11578         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 11579         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 11580         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11581
 11582     IF ENDL GREATER ZERO
 11583     IF HOLD-END NOT = LOW-VALUES
 11584     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 11585         MOVE 'END DT'             TO SPLIT-INFO-DESC
 11586         MOVE CL-EST-END-OF-DISAB-DT
 11587                                   TO DC-BIN-DATE-1
 11588         MOVE SPACES               TO DC-OPTION-CODE
 11589         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11590         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11591         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11592
 11593     IF PDTHRUL GREATER ZERO
 11594     IF HOLD-PDTHRU NOT = LOW-VALUES
 11595     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 11596         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 11597         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 11598         MOVE SPACES               TO DC-OPTION-CODE
 11599         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11600         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11601         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11602
 11603     IF PDAMTL GREATER ZERO
 11604     IF HOLD-PDAMT NOT = ZEROS
 11605     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL131.cbl
 11606         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 11607         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 11608         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 11609         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11610
 11611     IF NODAYSL GREATER ZERO
 11612     IF HOLD-NODAYS NOT = ZEROS
 11613     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 11614         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 11615         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 11616         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11617         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11618
 11619     IF NOPMTSL GREATER ZERO
 11620     IF HOLD-NOPMTS NOT = ZEROS
 11621     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 11622         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 11623         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 11624         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11625         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11626
 11627     IF FORMTYPL GREATER ZERO
 11628     IF FORMTYPI NOT = LOW-VALUES
 11629     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 11630         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 11631         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 11632         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11633
 11634     IF REPL GREATER ZERO
 11635     IF HOLD-REPORTED NOT = LOW-VALUES
 11636     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 11637         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 11638         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 11639         MOVE SPACES               TO DC-OPTION-CODE
 11640         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11641         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11642         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11643
 11644     IF ADDONDTL GREATER ZERO
 11645     IF HOLD-ADDON NOT = LOW-VALUES
 11646     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 11647         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 11648         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 11649         MOVE SPACES               TO DC-OPTION-CODE
 11650         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11651         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11652         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11653
 11654     IF PRICDL GREATER ZERO
 11655     IF PRICDI NOT = LOW-VALUES
 11656     IF PRICDI NOT = CL-PRIORITY-CD
 11657         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 11658         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 11659         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11660
 11661     IF FILETOL GREATER ZERO
 11662     IF FILETOI NOT = LOW-VALUES
 11663     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL131.cbl
 11664         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 11665         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 11666         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11667
 11668     IF SUPVL GREATER ZERO
 11669     IF SUPVI NOT = LOW-VALUES
 11670     IF SUPVI NOT = CL-SUPV-ATTN-CD
 11671         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 11672         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 11673         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11674
 11675     IF MLNAMEL GREATER ZERO
 11676     IF MLNAMEI NOT = LOW-VALUES
 11677     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 11678         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 11679         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 11680         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11681
 11682     IF MFNAMEL GREATER ZERO
 11683     IF MFNAMEI NOT = LOW-VALUES
 11684     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 11685         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 11686         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 11687         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11688
 11689     IF MMINITL GREATER ZERO
 11690     IF MMINITI NOT = LOW-VALUES
 11691     IF MMINITI NOT = CL-INSURED-MID-INIT
 11692         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 11693         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 11694         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11695
 11696     IF CERTEFFL GREATER ZERO
 11697     IF HOLD-EFF NOT = LOW-VALUES
 11698     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 11699         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 11700         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 11701         MOVE SPACES               TO DC-OPTION-CODE
 11702         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11703         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11704         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11705
 11706     IF CERTACTL GREATER ZERO
 11707     IF CERTACTI NOT = LOW-VALUES
 11708     IF CERTACTI NOT = CL-CERT-ACCOUNT
 11709         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 11710         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 11711         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11712
 11713     IF CERTSTL GREATER ZERO
 11714     IF CERTSTI NOT = LOW-VALUES
 11715     IF CERTSTI NOT = CL-CERT-STATE
 11716         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 11717         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 11718         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11719
 11720     IF CERTCARL GREATER ZERO
 11721     IF CERTCARI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL131.cbl
 11722     IF CERTCARI NOT = CL-CERT-CARRIER
 11723         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 11724         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 11725         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11726
 11727     IF CERTGRPL GREATER ZERO
 11728     IF CERTGRPI NOT = LOW-VALUES
 11729     IF CERTGRPI NOT = CL-CERT-GROUPING
 11730         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 11731         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 11732         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11733
 11734     IF CERTL GREATER ZERO OR
 11735        SUFXL GREATER ZERO
 11736     IF (CERTI NOT = LOW-VALUES AND
 11737                     CL-CERT-PRIME)
 11738                OR
 11739        (SUFXI NOT = LOW-VALUES AND
 11740                     CL-CERT-SFX)
 11741         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 11742         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 11743         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11744
 11745 2600-EXIT.
 11746      EXIT.
 11747
 11748 2650-WRITE-MAINT-NOTE.
 11749
 11750* EXEC CICS GETMAIN
 11751*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11752*         LENGTH   (TRLR-LENGTH)
 11753*         INITIMG  (GETMAIN-SPACE)
 11754*    END-EXEC.
 11755*    MOVE ',"IL                  $   #00010246' TO DFHEIV0
 11756     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11758     MOVE X'2020233030303130323436' TO DFHEIV0(25:11)
 11759     CALL 'kxdfhei1' USING DFHEIV0,
 11760           DFHEIV20,
 11761           TRLR-LENGTH,
 11762           GETMAIN-SPACE
 11763     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11764         DFHEIV20
 11765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11766
 11767
 11768
 11769* EXEC CICS HANDLE CONDITION
 11770*         DUPREC   (2650-EXIT)
 11771*    END-EXEC.
 11772*    MOVE '"$%                   ! : #00010252' TO DFHEIV0
 11773     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11775     MOVE X'3A20233030303130323532' TO DFHEIV0(25:11)
 11776     CALL 'kxdfhei1' USING DFHEIV0
 11777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11778
 11779
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL131.cbl
 11780     MOVE SPACES             TO ACTIVITY-TRAILERS.
 11781
 11782     IF CERTL GREATER ZERO
 11783         MOVE CERTI          TO CL-CERT-PRIME.
 11784
 11785     IF SUFXL GREATER ZERO
 11786         MOVE SUFXI          TO CL-CERT-SFX.
 11787
 11788     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 11789
 11790     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 11791     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 11792
 11793     MOVE 'AT'               TO AT-RECORD-ID.
 11794
 11795     MOVE '6'                TO AT-TRAILER-TYPE.
 11796     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 11797                                AT-GEN-INFO-LAST-MAINT-DT.
 11798     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 11799                                AT-GEN-INFO-LAST-UPDATED-BY.
 11800     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 11801     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 11802     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 11803
 11804
 11805* EXEC CICS WRITE
 11806*         DATASET  (TRLR-FILE-ID)
 11807*         RIDFLD   (AT-CONTROL-PRIMARY)
 11808*         FROM     (ACTIVITY-TRAILERS)
 11809*    END-EXEC.
 11810     MOVE LENGTH OF
 11811      ACTIVITY-TRAILERS
 11812       TO DFHEIV11
 11813*    MOVE '&$ L                  ''   #00010280' TO DFHEIV0
 11814     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11816     MOVE X'2020233030303130323830' TO DFHEIV0(25:11)
 11817     CALL 'kxdfhei1' USING DFHEIV0,
 11818           TRLR-FILE-ID,
 11819           ACTIVITY-TRAILERS,
 11820           DFHEIV11,
 11821           AT-CONTROL-PRIMARY,
 11822           DFHEIV99,
 11823           DFHEIV99
 11824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11825
 11826
 11827 2650-EXIT.
 11828      EXIT.
 11829
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL131.cbl
 11831 3000-DELETE-CLAIM.
 11832     IF  NOT MODIFY-CAP
 11833         MOVE ER-0070            TO EMI-ERROR
 11834         MOVE -1                 TO MAINTL
 11835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11836         GO TO 8110-SEND-DATA.
 11837
 11838
 11839* EXEC CICS READ
 11840*         SET      (ADDRESS OF CLAIM-MASTER)
 11841*         DATASET  (CLMS-FILE-ID)
 11842*         RIDFLD   (MSTR-KEY)
 11843*    END-EXEC.
 11844*    MOVE '&"S        E          (   #00010297' TO DFHEIV0
 11845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11847     MOVE X'2020233030303130323937' TO DFHEIV0(25:11)
 11848     CALL 'kxdfhei1' USING DFHEIV0,
 11849           CLMS-FILE-ID,
 11850           DFHEIV20,
 11851           DFHEIV99,
 11852           MSTR-KEY,
 11853           DFHEIV99,
 11854           DFHEIV99,
 11855           DFHEIV99
 11856     SET ADDRESS OF CLAIM-MASTER TO
 11857         DFHEIV20
 11858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11859
 11860
 11861     IF CL-1ST-TRL-AVAIL
 11862         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 11863     ELSE
 11864        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 11865        MOVE 0                   TO TRLR-SEQ-NO
 11866
 11867* EXEC CICS STARTBR
 11868*            DATASET (TRLR-FILE-ID)
 11869*            RIDFLD  (TRLR-KEY)
 11870*        END-EXEC
 11871     MOVE 0
 11872       TO DFHEIV11
 11873*    MOVE '&,         G          &   #00010308' TO DFHEIV0
 11874     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11875     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11876     MOVE X'2020233030303130333038' TO DFHEIV0(25:11)
 11877     CALL 'kxdfhei1' USING DFHEIV0,
 11878           TRLR-FILE-ID,
 11879           TRLR-KEY,
 11880           DFHEIV99,
 11881           DFHEIV11,
 11882           DFHEIV99
 11883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11884         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 11885
 11886* EXEC CICS ENDBR
 11887*            DATASET (TRLR-FILE-ID)
 11888*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL131.cbl
 11889     MOVE 0
 11890       TO DFHEIV11
 11891*    MOVE '&2                    $   #00010313' TO DFHEIV0
 11892     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11893     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11894     MOVE X'2020233030303130333133' TO DFHEIV0(25:11)
 11895     CALL 'kxdfhei1' USING DFHEIV0,
 11896           TRLR-FILE-ID,
 11897           DFHEIV11,
 11898           DFHEIV99
 11899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11900        IF SCREEN-ERROR
 11901            MOVE ER-0208         TO EMI-ERROR
 11902            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11903            MOVE -1              TO MAINTL
 11904            GO TO 8110-SEND-DATA
 11905        ELSE
 11906            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 11907
 11908     IF SCREEN-ERROR
 11909         MOVE -1                 TO MAINTL
 11910         GO TO 8110-SEND-DATA.
 11911
 11912     MOVE -1                     TO ONE-OR-MIN1.
 11913     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 11914
 11915     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 11916         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 11917                                    WS-SAVE-CLAIM-KEY
 11918         MOVE +1                 TO ONE-OR-MIN1
 11919         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 11920
 11921     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 11922
 11923     MOVE LOW-VALUES             TO EL131AO.
 11924     MOVE ER-0000                TO EMI-ERROR.
 11925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11926     MOVE 'X'                    TO PI-RETURN-CD-1.
 11927     MOVE -1                     TO MAINTL.
 11928     GO TO 8100-SEND-MAP.
 11929
 11930 3010-DEL-MSTR-TRLR.
 11931
 11932* EXEC CICS READ UPDATE
 11933*         SET       (ADDRESS OF CLAIM-MASTER)
 11934*         DATASET   (CLMS-FILE-ID)
 11935*         RIDFLD    (MSTR-KEY)
 11936*    END-EXEC.
 11937*    MOVE '&"S        EU         (   #00010347' TO DFHEIV0
 11938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11940     MOVE X'2020233030303130333437' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0,
 11942           CLMS-FILE-ID,
 11943           DFHEIV20,
 11944           DFHEIV99,
 11945           MSTR-KEY,
 11946           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL131.cbl
 11947           DFHEIV99,
 11948           DFHEIV99
 11949     SET ADDRESS OF CLAIM-MASTER TO
 11950         DFHEIV20
 11951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11952
 11953
 11954     if (cl-priority-cd = '8')
 11955        and (pi-processor-id not = 'PEMA' and 'JMS '
 11956             AND 'AMWA')
 11957        MOVE ER-8003             TO EMI-ERROR
 11958        PERFORM 9900-ERROR-FORMAT
 11959                                 THRU 9900-EXIT
 11960        MOVE -1                  TO MAINTL
 11961        GO TO 8110-SEND-DATA
 11962     end-if
 11963
 11964     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 11965     MOVE ZERO                   TO TRLR-SEQ-NO.
 11966
 11967
 11968* EXEC CICS HANDLE CONDITION
 11969*         NOTFND    (3010-DEL-ACTQ)
 11970*         ENDFILE   (3040-EXIT)
 11971*    END-EXEC.
 11972*    MOVE '"$I''                  ! ; #00010366' TO DFHEIV0
 11973     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11975     MOVE X'3B20233030303130333636' TO DFHEIV0(25:11)
 11976     CALL 'kxdfhei1' USING DFHEIV0
 11977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11978
 11979
 11980     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 11981
 11982 3010-DEL-ACTQ.
 11983
 11984
 11985* EXEC CICS HANDLE CONDITION
 11986*         NOTFND    (3010-NO-ACTIVITY)
 11987*         ENDFILE   (3050-EXIT)
 11988*    END-EXEC.
 11989*    MOVE '"$I''                  ! < #00010375' TO DFHEIV0
 11990     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11992     MOVE X'3C20233030303130333735' TO DFHEIV0(25:11)
 11993     CALL 'kxdfhei1' USING DFHEIV0
 11994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11995
 11996
 11997
 11998* EXEC CICS STARTBR
 11999*         DATASET  (ACTQ-FILE-ID)
 12000*         RIDFLD   (ACTQ-KEY)
 12001*    END-EXEC.
 12002     MOVE 0
 12003       TO DFHEIV11
 12004*    MOVE '&,         G          &   #00010380' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL131.cbl
 12005     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12007     MOVE X'2020233030303130333830' TO DFHEIV0(25:11)
 12008     CALL 'kxdfhei1' USING DFHEIV0,
 12009           ACTQ-FILE-ID,
 12010           ACTQ-KEY,
 12011           DFHEIV99,
 12012           DFHEIV11,
 12013           DFHEIV99
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017
 12018* EXEC CICS GETMAIN
 12019*         SET      (ADDRESS OF ACTIVITY-QUE)
 12020*         LENGTH   (ACTQ-LENGTH)
 12021*         INITIMG  (GETMAIN-SPACE)
 12022*    END-EXEC.
 12023*    MOVE ',"IL                  $   #00010385' TO DFHEIV0
 12024     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12026     MOVE X'2020233030303130333835' TO DFHEIV0(25:11)
 12027     CALL 'kxdfhei1' USING DFHEIV0,
 12028           DFHEIV20,
 12029           ACTQ-LENGTH,
 12030           GETMAIN-SPACE
 12031     SET ADDRESS OF ACTIVITY-QUE TO
 12032         DFHEIV20
 12033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12034
 12035
 12036     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12037
 12038
 12039* EXEC CICS ENDBR
 12040*         DATASET (ACTQ-FILE-ID)
 12041*    END-EXEC.
 12042     MOVE 0
 12043       TO DFHEIV11
 12044*    MOVE '&2                    $   #00010393' TO DFHEIV0
 12045     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12047     MOVE X'2020233030303130333933' TO DFHEIV0(25:11)
 12048     CALL 'kxdfhei1' USING DFHEIV0,
 12049           ACTQ-FILE-ID,
 12050           DFHEIV11,
 12051           DFHEIV99
 12052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12053
 12054
 12055 3010-NO-ACTIVITY.
 12056
 12057
 12058* EXEC CICS HANDLE CONDITION
 12059*        NOTFND   (3010-CERT-NOT-FOUND)
 12060*    END-EXEC.
 12061*    MOVE '"$I                   ! = #00010399' TO DFHEIV0
 12062     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL131.cbl
 12063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12064     MOVE X'3D20233030303130333939' TO DFHEIV0(25:11)
 12065     CALL 'kxdfhei1' USING DFHEIV0
 12066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12067
 12068
 12069     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12070     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12071     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12072     MOVE CL-CERT-STATE          TO CERT-STATE.
 12073     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12074     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12075     MOVE CL-CERT-NO             TO CERT-CERT.
 12076
 12077
 12078* EXEC CICS READ
 12079*        DATASET   (CERT-FILE-ID)
 12080*        RIDFLD    (CERT-KEY)
 12081*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12082*    END-EXEC.
 12083*    MOVE '&"S        E          (   #00010411' TO DFHEIV0
 12084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12086     MOVE X'2020233030303130343131' TO DFHEIV0(25:11)
 12087     CALL 'kxdfhei1' USING DFHEIV0,
 12088           CERT-FILE-ID,
 12089           DFHEIV20,
 12090           DFHEIV99,
 12091           CERT-KEY,
 12092           DFHEIV99,
 12093           DFHEIV99,
 12094           DFHEIV99
 12095     SET ADDRESS OF CERTIFICATE-MASTER TO
 12096         DFHEIV20
 12097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12098
 12099
 12100     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12101       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12102         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12103     ELSE
 12104         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12105
 12106 3010-CERT-NOT-FOUND.
 12107
 12108
 12109* EXEC CICS DELETE
 12110*        DATASET  (CLMS-FILE-ID)
 12111*    END-EXEC.
 12112*    MOVE '&(                    &   #00010425' TO DFHEIV0
 12113     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12114     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12115     MOVE X'2020233030303130343235' TO DFHEIV0(25:11)
 12116     CALL 'kxdfhei1' USING DFHEIV0,
 12117           CLMS-FILE-ID,
 12118           DFHEIV99,
 12119           DFHEIV99,
 12120           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL131.cbl
 12121           DFHEIV99
 12122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12123
 12124
 12125 3010-EXIT.
 12126      EXIT.
 12127
 12128 3020-UPDATE-CERT.
 12129
 12130* EXEC CICS READ UPDATE
 12131*         DATASET  (CERT-FILE-ID)
 12132*         RIDFLD   (CERT-KEY)
 12133*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12134*    END-EXEC.
 12135*    MOVE '&"S        EU         (   #00010433' TO DFHEIV0
 12136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12137     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12138     MOVE X'2020233030303130343333' TO DFHEIV0(25:11)
 12139     CALL 'kxdfhei1' USING DFHEIV0,
 12140           CERT-FILE-ID,
 12141           DFHEIV20,
 12142           DFHEIV99,
 12143           CERT-KEY,
 12144           DFHEIV99,
 12145           DFHEIV99,
 12146           DFHEIV99
 12147     SET ADDRESS OF CERTIFICATE-MASTER TO
 12148         DFHEIV20
 12149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12150
 12151
 12152     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12153
 12154
 12155* EXEC CICS HANDLE CONDITION
 12156*         DUPKEY   (3020-EXIT)
 12157*    END-EXEC.
 12158*    MOVE '"$$                   ! > #00010441' TO DFHEIV0
 12159     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12161     MOVE X'3E20233030303130343431' TO DFHEIV0(25:11)
 12162     CALL 'kxdfhei1' USING DFHEIV0
 12163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12164
 12165
 12166
 12167* EXEC CICS REWRITE
 12168*         DATASET  (CERT-FILE-ID)
 12169*         FROM     (CERTIFICATE-MASTER)
 12170*    END-EXEC.
 12171     MOVE LENGTH OF
 12172      CERTIFICATE-MASTER
 12173       TO DFHEIV11
 12174*    MOVE '&& L                  %   #00010445' TO DFHEIV0
 12175     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12176     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12177     MOVE X'2020233030303130343435' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL131.cbl
 12179           CERT-FILE-ID,
 12180           CERTIFICATE-MASTER,
 12181           DFHEIV11,
 12182           DFHEIV99
 12183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12184
 12185
 12186 3020-EXIT.
 12187     EXIT.
 12188
 12189 3030-DELETE-CERT.
 12190
 12191* EXEC CICS READ UPDATE
 12192*         DATASET  (CERT-FILE-ID)
 12193*         RIDFLD   (CERT-KEY)
 12194*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12195*    END-EXEC.
 12196*    MOVE '&"S        EU         (   #00010454' TO DFHEIV0
 12197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12199     MOVE X'2020233030303130343534' TO DFHEIV0(25:11)
 12200     CALL 'kxdfhei1' USING DFHEIV0,
 12201           CERT-FILE-ID,
 12202           DFHEIV20,
 12203           DFHEIV99,
 12204           CERT-KEY,
 12205           DFHEIV99,
 12206           DFHEIV99,
 12207           DFHEIV99
 12208     SET ADDRESS OF CERTIFICATE-MASTER TO
 12209         DFHEIV20
 12210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12211
 12212
 12213
 12214* EXEC CICS DELETE
 12215*         DATASET   (CERT-FILE-ID)
 12216*    END-EXEC.
 12217*    MOVE '&(                    &   #00010460' TO DFHEIV0
 12218     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12220     MOVE X'2020233030303130343630' TO DFHEIV0(25:11)
 12221     CALL 'kxdfhei1' USING DFHEIV0,
 12222           CERT-FILE-ID,
 12223           DFHEIV99,
 12224           DFHEIV99,
 12225           DFHEIV99,
 12226           DFHEIV99
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12228
 12229
 12230 3030-EXIT.
 12231     EXIT.
 12232
 12233 3040-DELETE-TRLR.
 12234
 12235* EXEC CICS READ
 12236*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL131.cbl
 12237*         DATASET  (TRLR-FILE-ID)
 12238*         RIDFLD   (TRLR-KEY)
 12239*         GTEQ
 12240*    END-EXEC.
 12241*    MOVE '&"S        G          (   #00010468' TO DFHEIV0
 12242     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12244     MOVE X'2020233030303130343638' TO DFHEIV0(25:11)
 12245     CALL 'kxdfhei1' USING DFHEIV0,
 12246           TRLR-FILE-ID,
 12247           DFHEIV20,
 12248           DFHEIV99,
 12249           TRLR-KEY,
 12250           DFHEIV99,
 12251           DFHEIV99,
 12252           DFHEIV99
 12253     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12254         DFHEIV20
 12255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12256
 12257
 12258     IF PI-COMPANY-CD = AT-COMPANY-CD
 12259        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12260        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12261           GO TO 3040-EXIT
 12262        ELSE
 12263           NEXT SENTENCE
 12264     ELSE
 12265        GO TO 3040-EXIT.
 12266
 12267
 12268* EXEC CICS DELETE
 12269*         DATASET  (TRLR-FILE-ID)
 12270*         RIDFLD   (TRLR-KEY)
 12271*    END-EXEC.
 12272*    MOVE '&(  R                 &   #00010484' TO DFHEIV0
 12273     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12275     MOVE X'2020233030303130343834' TO DFHEIV0(25:11)
 12276     CALL 'kxdfhei1' USING DFHEIV0,
 12277           TRLR-FILE-ID,
 12278           TRLR-KEY,
 12279           DFHEIV99,
 12280           DFHEIV99,
 12281           DFHEIV99
 12282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12283
 12284
 12285     GO TO 3040-DELETE-TRLR.
 12286
 12287 3040-EXIT.
 12288     EXIT.
 12289
 12290 3050-DELETE-ACTQ.
 12291
 12292* EXEC CICS READNEXT
 12293*         DATASET  (ACTQ-FILE-ID)
 12294*         RIDFLD   (ACTQ-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL131.cbl
 12295*         INTO     (ACTIVITY-QUE)
 12296*    END-EXEC.
 12297     MOVE LENGTH OF
 12298      ACTIVITY-QUE
 12299       TO DFHEIV12
 12300     MOVE 0
 12301       TO DFHEIV11
 12302*    MOVE '&.IL                  )   #00010495' TO DFHEIV0
 12303     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12304     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12305     MOVE X'2020233030303130343935' TO DFHEIV0(25:11)
 12306     CALL 'kxdfhei1' USING DFHEIV0,
 12307           ACTQ-FILE-ID,
 12308           ACTIVITY-QUE,
 12309           DFHEIV12,
 12310           ACTQ-KEY,
 12311           DFHEIV99,
 12312           DFHEIV11,
 12313           DFHEIV99,
 12314           DFHEIV99
 12315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12316
 12317
 12318     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 12319         GO TO 3050-EXIT.
 12320
 12321
 12322* EXEC CICS ENDBR
 12323*         DATASET  (ACTQ-FILE-ID)
 12324*    END-EXEC.
 12325     MOVE 0
 12326       TO DFHEIV11
 12327*    MOVE '&2                    $   #00010504' TO DFHEIV0
 12328     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12329     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12330     MOVE X'2020233030303130353034' TO DFHEIV0(25:11)
 12331     CALL 'kxdfhei1' USING DFHEIV0,
 12332           ACTQ-FILE-ID,
 12333           DFHEIV11,
 12334           DFHEIV99
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338
 12339* EXEC CICS DELETE
 12340*         DATASET   (ACTQ-FILE-ID)
 12341*         RIDFLD    (ACTQ-KEY)
 12342*    END-EXEC.
 12343*    MOVE '&(  R                 &   #00010508' TO DFHEIV0
 12344     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12345     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12346     MOVE X'2020233030303130353038' TO DFHEIV0(25:11)
 12347     CALL 'kxdfhei1' USING DFHEIV0,
 12348           ACTQ-FILE-ID,
 12349           ACTQ-KEY,
 12350           DFHEIV99,
 12351           DFHEIV99,
 12352           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL131.cbl
 12353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12354
 12355
 12356
 12357* EXEC CICS STARTBR
 12358*         DATASET   (ACTQ-FILE-ID)
 12359*         RIDFLD    (ACTQ-KEY)
 12360*    END-EXEC.
 12361     MOVE 0
 12362       TO DFHEIV11
 12363*    MOVE '&,         G          &   #00010513' TO DFHEIV0
 12364     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12366     MOVE X'2020233030303130353133' TO DFHEIV0(25:11)
 12367     CALL 'kxdfhei1' USING DFHEIV0,
 12368           ACTQ-FILE-ID,
 12369           ACTQ-KEY,
 12370           DFHEIV99,
 12371           DFHEIV11,
 12372           DFHEIV99
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376     GO TO 3050-DELETE-ACTQ.
 12377
 12378 3050-EXIT.
 12379     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL131.cbl
 12381 3060-READ-TRLR.
 12382
 12383* EXEC CICS HANDLE CONDITION
 12384*         NOTFND    (3060-EXIT)
 12385*         ENDFILE   (3060-EXIT)
 12386*    END-EXEC.
 12387*    MOVE '"$I''                  ! ? #00010524' TO DFHEIV0
 12388     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12390     MOVE X'3F20233030303130353234' TO DFHEIV0(25:11)
 12391     CALL 'kxdfhei1' USING DFHEIV0
 12392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12393
 12394
 12395 3060-LOOP.
 12396
 12397* EXEC CICS READNEXT
 12398*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12399*         DATASET  (TRLR-FILE-ID)
 12400*         RIDFLD   (TRLR-KEY)
 12401*    END-EXEC.
 12402     MOVE 0
 12403       TO DFHEIV11
 12404*    MOVE '&.S                   )   #00010530' TO DFHEIV0
 12405     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12406     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12407     MOVE X'2020233030303130353330' TO DFHEIV0(25:11)
 12408     CALL 'kxdfhei1' USING DFHEIV0,
 12409           TRLR-FILE-ID,
 12410           DFHEIV20,
 12411           DFHEIV99,
 12412           TRLR-KEY,
 12413           DFHEIV99,
 12414           DFHEIV11,
 12415           DFHEIV99,
 12416           DFHEIV99
 12417     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12418         DFHEIV20
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12420
 12421
 12422     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12423         GO TO 3060-EXIT.
 12424
 12425     IF FORM-CONTROL-TR
 12426         IF AT-RECORDED-DT = SAVE-BIN-DATE
 12427             NEXT SENTENCE
 12428         ELSE
 12429             MOVE 'X'            TO ERROR-SWITCH
 12430             GO TO 3060-EXIT
 12431     ELSE
 12432         IF PAYMENT-TR OR CORRESPONDENCE-TR
 12433            MOVE 'X'                 TO ERROR-SWITCH
 12434            GO TO 3060-EXIT.
 12435
 12436     GO TO 3060-LOOP.
 12437
 12438 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL131.cbl
 12439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL131.cbl
 12441 4000-FORCE-ERRORS.
 12442     IF PI-RETURN-CD-1 = 'X'
 12443         MOVE ER-0311            TO EMI-ERROR
 12444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12445         MOVE -1                 TO MAINTL
 12446         GO TO 8110-SEND-DATA.
 12447
 12448     IF NOT FORCE-CAP
 12449         MOVE ER-0416            TO EMI-ERROR
 12450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12451         MOVE -1                 TO MAINTL
 12452         GO TO 8110-SEND-DATA.
 12453
 12454     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 12455     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 12456     IF EMI-FATAL-CTR GREATER THAN ZERO
 12457         GO TO 4000-FATAL-ERRORS.
 12458
 12459     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 12460
 12461     IF EMI-FATAL-CTR GREATER THAN ZERO
 12462         GO TO 4000-FATAL-ERRORS.
 12463
 12464     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 12465
 12466     IF EMI-FATAL-CTR GREATER THAN ZERO
 12467         GO TO 4000-FATAL-ERRORS.
 12468
 12469     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 12470     MOVE AL-UANOF               TO CERTA.
 12471     MOVE ER-0000 TO EMI-ERROR.
 12472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473
 12474 4000-FATAL-ERRORS.
 12475     MOVE -1                     TO MAINTL.
 12476     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL131.cbl
 12478 5000-BUILD-MAP.
 12479     IF PI-RETURN-CD-1 = SPACE
 12480         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 12481
 12482     MOVE SPACE                  TO PI-RETURN-CD-1.
 12483
 12484     MOVE LOW-VALUES             TO EL131AI.
 12485
 12486     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 12487     MOVE PI-CARRIER             TO CARRIER-CODE.
 12488     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 12489     MOVE PI-CERT-NO             TO CERT-NO.
 12490
 12491 5000-READ-CLAIM-MASTER.
 12492
 12493
 12494* EXEC CICS READ
 12495*         SET      (ADDRESS OF CLAIM-MASTER)
 12496*         DATASET  (CLMS-FILE-ID)
 12497*         RIDFLD   (MSTR-KEY)
 12498*    END-EXEC.
 12499*    MOVE '&"S        E          (   #00010607' TO DFHEIV0
 12500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12502     MOVE X'2020233030303130363037' TO DFHEIV0(25:11)
 12503     CALL 'kxdfhei1' USING DFHEIV0,
 12504           CLMS-FILE-ID,
 12505           DFHEIV20,
 12506           DFHEIV99,
 12507           MSTR-KEY,
 12508           DFHEIV99,
 12509           DFHEIV99,
 12510           DFHEIV99
 12511     SET ADDRESS OF CLAIM-MASTER TO
 12512         DFHEIV20
 12513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12514
 12515
 12516     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 12517
 12518 5000-READ-DIAGNOSIS-TRAILER.
 12519
 12520
 12521* EXEC CICS HANDLE CONDITION
 12522*         NOTFND (5000-TRLR-NOT-FOUND)
 12523*    END-EXEC.
 12524*    MOVE '"$I                   ! @ #00010617' TO DFHEIV0
 12525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12527     MOVE X'4020233030303130363137' TO DFHEIV0(25:11)
 12528     CALL 'kxdfhei1' USING DFHEIV0
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532     MOVE MSTR-KEY               TO TRLR-KEY.
 12533     MOVE NINETY                 TO TRLR-SEQ-NO.
 12534
 12535
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL131.cbl
 12536* EXEC CICS READ
 12537*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12538*         DATASET  (TRLR-FILE-ID)
 12539*         RIDFLD   (TRLR-KEY)
 12540*    END-EXEC.
 12541*    MOVE '&"S        E          (   #00010624' TO DFHEIV0
 12542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12544     MOVE X'2020233030303130363234' TO DFHEIV0(25:11)
 12545     CALL 'kxdfhei1' USING DFHEIV0,
 12546           TRLR-FILE-ID,
 12547           DFHEIV20,
 12548           DFHEIV99,
 12549           TRLR-KEY,
 12550           DFHEIV99,
 12551           DFHEIV99,
 12552           DFHEIV99
 12553     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12554         DFHEIV20
 12555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12556
 12557
 12558     MOVE AT-INFO-LINE-1         TO DIAGO.
 12559
 12560 5000-READ-CERTIFICATE-MASTER.
 12561
 12562     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 12563     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 12564     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 12565     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 12566     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 12567     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 12568     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 12569
 12570
 12571* EXEC CICS HANDLE CONDITION
 12572*         NOTFND (5000-CERT-NOT-FOUND)
 12573*    END-EXEC.
 12574*    MOVE '"$I                   ! A #00010642' TO DFHEIV0
 12575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12577     MOVE X'4120233030303130363432' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582
 12583* EXEC CICS READ
 12584*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12585*         DATASET  (CERT-FILE-ID)
 12586*         RIDFLD   (CERT-KEY)
 12587*    END-EXEC.
 12588*    MOVE '&"S        E          (   #00010646' TO DFHEIV0
 12589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12591     MOVE X'2020233030303130363436' TO DFHEIV0(25:11)
 12592     CALL 'kxdfhei1' USING DFHEIV0,
 12593           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL131.cbl
 12594           DFHEIV20,
 12595           DFHEIV99,
 12596           CERT-KEY,
 12597           DFHEIV99,
 12598           DFHEIV99,
 12599           DFHEIV99
 12600     SET ADDRESS OF CERTIFICATE-MASTER TO
 12601         DFHEIV20
 12602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12603
 12604
 12605     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 12606     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 12607
 12608     GO TO 5000-EXIT.
 12609
 12610 5000-TRLR-NOT-FOUND.
 12611     MOVE ER-7687                TO EMI-ERROR.
 12612     MOVE -1                     TO DIAGL.
 12613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12614     GO TO 5000-EXIT.
 12615
 12616 5000-CERT-NOT-FOUND.
 12617     MOVE ER-0206                TO EMI-ERROR.
 12618     MOVE -1                     TO CERTL.
 12619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12620
 12621 5000-EXIT.
 12622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL131.cbl
 12624 5010-RESET-PI-AREA.
 12625     IF CERTI GREATER THAN LOW-VALUES
 12626         MOVE CERTI              TO PI-CERT-PRIME.
 12627
 12628     IF SUFXI GREATER THAN LOW-VALUES
 12629         MOVE SUFXI              TO PI-CERT-SFX.
 12630
 12631     IF CERTEFFI GREATER THAN LOW-VALUES
 12632         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 12633
 12634     IF CERTACTI GREATER THAN LOW-VALUES
 12635         MOVE CERTACTI           TO PI-ACCOUNT.
 12636
 12637     IF CERTSTI GREATER THAN LOW-VALUES
 12638         MOVE CERTSTI            TO PI-STATE.
 12639
 12640     IF CERTCARI GREATER THAN LOW-VALUES
 12641         MOVE CERTCARI           TO PI-CARRIER.
 12642
 12643     IF CERTGRPI GREATER THAN LOW-VALUES
 12644         MOVE CERTGRPI           TO PI-GROUPING.
 12645
 12646 5010-EXIT.
 12647     EXIT.
 12648
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL131.cbl
 12650 5020-MOVE-MSTR.
 12651
 12652     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 12653     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 12654     MOVE WS-CLAIM-SEQU          TO SEQUO.
 12655     MOVE AL-SABON               TO SEQUA.
 12656     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 12657     MOVE CL-CLAIM-TYPE          TO TYPEO.
 12658
 12659     IF CL-TOTAL-PAID-AMT  = +0 AND
 12660        CL-LAST-PMT-AMT    = +0 AND
 12661        CL-NO-OF-PMTS-MADE = +0
 12662          MOVE AL-UANON          TO TYPEA.
 12663
 12664     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 12665     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 12666     MOVE CL-CERT-PRIME          TO CERTO.
 12667     MOVE CL-CERT-SFX            TO SUFXO.
 12668     MOVE CL-CERT-CARRIER        TO CARRO.
 12669
 12670     IF CL-CLAIM-STATUS = 'C'
 12671         MOVE 'CLOSED'           TO STATUSO
 12672     ELSE
 12673         MOVE 'OPEN  '           TO STATUSO.
 12674
 12675     MOVE CL-PROCESSOR-ID        TO PROCO.
 12676
 12677     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 12678     MOVE CL-CCN                 TO CCNOO.
 12679
 12680     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 12681     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 12682     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 12683     MOVE CL-INSURED-SEX-CD      TO SEXO.
 12684
 12685     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 12686         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 12687         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12688         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12689         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 12690     ELSE
 12691         MOVE SPACES             TO BIRTHO.
 12692
 12693     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 12694        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 12695         NEXT SENTENCE
 12696       ELSE
 12697         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 12698
 12699     IF PI-COMPANY-ID = 'DMD'
 12700       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 12701          IF SOCIALO = SPACES OR LOW-VALUES
 12702            MOVE ER-0885         TO EMI-ERROR
 12703            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12704
 12705     MOVE CL-INSURED-OCC-CD      TO OCCO.
 12706     MOVE CL-CAUSE-CD            TO CAUSEO.
 12707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL131.cbl
 12708     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 12709         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 12710         MOVE SPACES                 TO DC-OPTION-CODE
 12711         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12712         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 12713     ELSE
 12714         MOVE SPACES             TO ENDO.
 12715
 12716     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 12717        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12718        MOVE SPACES             TO DC-OPTION-CODE
 12719        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12720        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12721        IF PI-USES-PAID-TO
 12722           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12723           MOVE '6'                TO DC-OPTION-CODE
 12724           MOVE +1                 TO DC-ELAPSED-DAYS
 12725           MOVE +0                 TO DC-ELAPSED-MONTHS
 12726           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12727           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12728        ELSE
 12729           NEXT SENTENCE
 12730     ELSE
 12731        MOVE SPACES             TO PDTHRUO.
 12732
 12733     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 12734     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 12735     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 12736     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 12737
 12738     IF MODIFY-CAP
 12739        MOVE AL-UNNOF            TO PDAMTA
 12740                                    NODAYSA
 12741                                    NOPMTSA
 12742        MOVE AL-UANOF            TO PDTHRUA.
 12743
 12744     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 12745         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12746         MOVE SPACES             TO DC-OPTION-CODE
 12747         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12748         MOVE DC-GREG-DATE-1-EDIT TO INCO
 12749     ELSE
 12750         MOVE SPACES             TO INCO.
 12751
 12752     IF CL-NO-OF-PMTS-MADE = ZEROS
 12753        MOVE AL-UANOF            TO INCA.
 12754
 12755     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 12756
 12757     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 12758         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 12759         MOVE SPACES             TO DC-OPTION-CODE
 12760         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12761         MOVE DC-GREG-DATE-1-EDIT TO REPO
 12762     ELSE
 12763         MOVE SPACES             TO REPO.
 12764
 12765     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL131.cbl
 12766         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 12767         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12768         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12769         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 12770     ELSE
 12771         MOVE SPACES             TO ESTO.
 12772
 12773     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 12774         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 12775         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12776         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12777         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 12778     ELSE
 12779         MOVE SPACES             TO MNTDTO.
 12780
 12781
 12782     IF CL-LAST-MAINT-TYPE = SPACE
 12783         MOVE 'SET-UP'           TO MNTTYPEO
 12784     ELSE
 12785     IF CL-LAST-MAINT-TYPE = '1'
 12786         MOVE 'PAYMNT'           TO MNTTYPEO
 12787     ELSE
 12788     IF CL-LAST-MAINT-TYPE = '2'
 12789         MOVE 'LETTER'           TO MNTTYPEO
 12790     ELSE
 12791     IF CL-LAST-MAINT-TYPE = '3'
 12792         MOVE 'UPDATE'           TO MNTTYPEO
 12793     ELSE
 12794     IF CL-LAST-MAINT-TYPE = '4'
 12795         MOVE 'RESTOR'           TO MNTTYPEO
 12796     ELSE
 12797     IF CL-LAST-MAINT-TYPE = '5'
 12798         MOVE 'INC DT'           TO MNTTYPEO
 12799     ELSE
 12800     IF CL-LAST-MAINT-TYPE = '6'
 12801         MOVE ' CONV'            TO MNTTYPEO
 12802     ELSE
 12803     IF CL-LAST-MAINT-TYPE = 'C'
 12804         MOVE 'CHGBEN'           TO MNTTYPEO
 12805     ELSE
 12806     IF CL-LAST-MAINT-TYPE = 'E'
 12807         MOVE 'ERRCOR'           TO MNTTYPEO
 12808     ELSE
 12809         MOVE SPACES             TO MNTTYPEO.
 12810
 12811     MOVE CL-BENEFICIARY         TO BENEO.
 12812     MOVE CL-FILE-LOCATION       TO FILETOO.
 12813     MOVE CL-PRIORITY-CD         TO PRICDO.
 12814     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 12815     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 12816     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 12817
 12818 5020-EXIT.
 12819     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL131.cbl
 12821 5030-MOVE-CERT.
 12822
 12823     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 12824         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12825         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12826         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12827         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 12828       ELSE
 12829         MOVE SPACES             TO CERTEFFO
 12830         MOVE ZERO               TO HOLD-DATE.
 12831
 12832     MOVE CM-ACCOUNT             TO CERTACTO.
 12833     MOVE CM-STATE               TO CERTSTO PI-STATE.
 12834     MOVE CM-GROUPING            TO CERTGRPO.
 12835     MOVE CM-CARRIER             TO CERTCARO.
 12836     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 12837     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 12838     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 12839     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 12840     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 12841     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 12842     MOVE CM-JT-INITIAL          TO JNTINITO.
 12843     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 12844
 12845*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 12846     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12847     MOVE '3'                    TO CNTL-REC-TYPE.
 12848     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 12849     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 12850     MOVE ZERO                   TO CNTL-SEQ-NO.
 12851
 12852
 12853* EXEC CICS READ
 12854*         SET        (ADDRESS OF CONTROL-FILE)
 12855*         DATASET    ('ELCNTL')
 12856*         RIDFLD     (CNTL-KEY)
 12857*         RESP       (WS-RESPONSE)
 12858*    END-EXEC.
 12859     MOVE 'ELCNTL' TO DFHEIV1
 12860*    MOVE '&"S        E          (  N#00010899' TO DFHEIV0
 12861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12863     MOVE X'204E233030303130383939' TO DFHEIV0(25:11)
 12864     CALL 'kxdfhei1' USING DFHEIV0,
 12865           DFHEIV1,
 12866           DFHEIV20,
 12867           DFHEIV99,
 12868           CNTL-KEY,
 12869           DFHEIV99,
 12870           DFHEIV99,
 12871           DFHEIV99
 12872     SET ADDRESS OF CONTROL-FILE TO
 12873         DFHEIV20
 12874     MOVE EIBRESP  TO WS-RESPONSE
 12875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12876
 12877
 12878     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL131.cbl
 12879        MOVE ZERO                TO CP-FREE-LOOK
 12880     ELSE
 12881        MOVE CF-ST-FREE-LOOK-PERIOD
 12882                                 TO CP-FREE-LOOK.
 12883
 12884     IF CM-LF-BENEFIT-CD = '00'
 12885        GO TO 5030-MOVE-CERT-AH.
 12886
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL131.cbl
 12888     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 12889     MOVE '5'                    TO DC-OPTION-CODE
 12890     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12891     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 12892     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 12893     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 12894     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 12895     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12896     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12897     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 12898     MOVE '4'                    TO CP-REM-TERM-METHOD
 12899     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 12900     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12901     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 12902
 12903     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 12904     IF CM-LF-PREMIUM-RATE NUMERIC
 12905         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 12906     ELSE
 12907         MOVE ZEROS              TO LCVRATEO.
 12908
 12909     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 12910         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 12911
 12912     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 12913
 12914     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 12915
 12916     IF CM-LF-CURRENT-STATUS = '8'
 12917        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 12918            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 12919            MOVE ' '             TO DC-OPTION-CODE
 12920            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12921            IF NOT DATE-CONVERSION-ERROR
 12922                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12923
 12924     IF CM-LF-CURRENT-STATUS = '7'
 12925        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12926            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 12927            MOVE ' '             TO DC-OPTION-CODE
 12928            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12929            IF NOT DATE-CONVERSION-ERROR
 12930                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12931
 12932     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 12933         MOVE ' '                TO DC-OPTION-CODE
 12934         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 12935         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12936         IF NOT DATE-CONVERSION-ERROR
 12937             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 12938             MOVE HOLD-MONTH     TO WORK-MONTH
 12939             MOVE HOLD-YEAR      TO WORK-YEAR
 12940             MOVE WORK-DATE-MY   TO LCVEXITO.
 12941
 12942     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 12943        IF CP-REMAINING-TERM-3 = ZEROS
 12944           MOVE 'EXPIRED'        TO LCVSTATO
 12945        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL131.cbl
 12946           MOVE 'ACTIVE'         TO LCVSTATO.
 12947
 12948     IF CM-LF-CURRENT-STATUS = '2'
 12949        MOVE 'PEND   '           TO LCVSTATO.
 12950     IF CM-LF-CURRENT-STATUS = '3'
 12951        MOVE 'RESTORE'           TO LCVSTATO.
 12952     IF CM-LF-CURRENT-STATUS = '5'
 12953        MOVE 'REISSUE'           TO LCVSTATO.
 12954     IF CM-LF-CURRENT-STATUS = '6'
 12955        MOVE 'LMP DIS'           TO LCVSTATO.
 12956     IF CM-LF-CURRENT-STATUS = '7'
 12957        MOVE 'DEATH  '           TO LCVSTATO.
 12958     IF CM-LF-CURRENT-STATUS = '8'
 12959        MOVE 'CANCEL '           TO LCVSTATO.
 12960     IF CM-LF-CURRENT-STATUS = '9'
 12961        MOVE 'RE-ONLY'           TO LCVSTATO.
 12962     IF CM-LF-CURRENT-STATUS = 'V'
 12963        MOVE 'VOID   '           TO LCVSTATO.
 12964     IF CM-LF-CURRENT-STATUS = 'D'
 12965        MOVE 'DECLINE'           TO LCVSTATO.
 12966
 12967     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 12968     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 12969     MOVE '4'                    TO BEN-REC-TYPE.
 12970     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 12971     MOVE ZERO                   TO BEN-SEQ-NO.
 12972
 12973
 12974* EXEC CICS READ GTEQ
 12975*         DATASET  (CNTL-FILE-ID)
 12976*         RIDFLD   (BENEFIT-KEY)
 12977*         SET      (ADDRESS OF CONTROL-FILE)
 12978*    END-EXEC.
 12979*    MOVE '&"S        G          (   #00011001' TO DFHEIV0
 12980     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12982     MOVE X'2020233030303131303031' TO DFHEIV0(25:11)
 12983     CALL 'kxdfhei1' USING DFHEIV0,
 12984           CNTL-FILE-ID,
 12985           DFHEIV20,
 12986           DFHEIV99,
 12987           BENEFIT-KEY,
 12988           DFHEIV99,
 12989           DFHEIV99,
 12990           DFHEIV99
 12991     SET ADDRESS OF CONTROL-FILE TO
 12992         DFHEIV20
 12993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12994
 12995
 12996     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 12997        CF-RECORD-TYPE NOT = '4'
 12998         MOVE ER-0240            TO EMI-ERROR
 12999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13000         GO TO 5030-MOVE-CERT-FINISH.
 13001
 13002     MOVE ZERO                   TO COUNT-2.
 13003     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL131.cbl
 13004
 13005     IF SCREEN-ERROR
 13006         MOVE ER-0282            TO EMI-ERROR
 13007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13008        ELSE
 13009         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13010
 13011 5030-MOVE-CERT-AH.
 13012
 13013     IF CM-LF-BENEFIT-CD = '00'
 13014         IF CM-AH-BENEFIT-CD = '00'
 13015             GO TO 5030-MOVE-CERT-FINISH.
 13016
 13017     IF CM-AH-BENEFIT-CD = '00'
 13018        MOVE SPACES             TO ACVKINDO
 13019        COMPUTE PI-PAYMENT-AMT =
 13020                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13021        GO TO 5030-MOVE-CERT-FINISH.
 13022
 13023     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13024     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13025     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13026     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13027     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13028     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13029     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13030     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13031
 13032**DMD **********************************************
 13033     IF PI-COMPANY-ID = 'DMD'
 13034         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13035                                   CM-PMT-EXTENSION-DAYS
 13036         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13037                                      CL-NO-OF-DAYS-PAID
 13038         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13039             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13040         MOVE WS-REM-MOS         TO ACVRTRMO
 13041                                    CP-REMAINING-TERM-3
 13042         MOVE WS-REM-DAYS        TO DAYSPO
 13043         GO TO 5030-SKIP-RTRM.
 13044**DMD **********************************************
 13045
 13046     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13047     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13048     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13049     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13050
 13051 5030-SKIP-RTRM.
 13052     IF CM-AH-PREMIUM-RATE NUMERIC
 13053         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13054     ELSE
 13055         MOVE ZEROS              TO ACVRATEO.
 13056
 13057     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13058     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13059
 13060     IF CM-AH-CURRENT-STATUS = '8'
 13061        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL131.cbl
 13062            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13063            MOVE ' '             TO DC-OPTION-CODE
 13064            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13065            IF NOT DATE-CONVERSION-ERROR
 13066                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13067
 13068     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13069        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13070            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13071            MOVE ' '             TO DC-OPTION-CODE
 13072            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13073            IF NOT DATE-CONVERSION-ERROR
 13074                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13075
 13076     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13077        IF CP-REMAINING-TERM-3 = ZEROS
 13078           MOVE 'EXPIRED'        TO ACVSTATO
 13079        ELSE
 13080           MOVE 'ACTIVE'         TO ACVSTATO.
 13081
 13082     IF CM-AH-CURRENT-STATUS = '2'
 13083        MOVE 'PEND   '           TO ACVSTATO.
 13084     IF CM-AH-CURRENT-STATUS = '3'
 13085        MOVE 'RESTORE'           TO ACVSTATO.
 13086     IF CM-AH-CURRENT-STATUS = '5'
 13087        MOVE 'REISSUE'           TO ACVSTATO.
 13088     IF CM-AH-CURRENT-STATUS = '6'
 13089        MOVE 'LMP DIS'           TO ACVSTATO.
 13090     IF CM-AH-CURRENT-STATUS = '7'
 13091        MOVE 'DEATH  '           TO ACVSTATO.
 13092     IF CM-AH-CURRENT-STATUS = '8'
 13093        MOVE 'CANCEL '           TO ACVSTATO.
 13094     IF CM-AH-CURRENT-STATUS = '9'
 13095        MOVE 'RE-ONLY'           TO ACVSTATO.
 13096     IF CM-AH-CURRENT-STATUS = 'V'
 13097        MOVE 'VOID   '           TO ACVSTATO.
 13098     IF CM-AH-CURRENT-STATUS = '9'
 13099        MOVE 'DECLINE'           TO ACVSTATO.
 13100
 13101     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13102         MOVE ' '                TO DC-OPTION-CODE
 13103         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13104         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13105         IF NOT DATE-CONVERSION-ERROR
 13106             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13107             MOVE HOLD-MONTH     TO WORK-MONTH
 13108             MOVE HOLD-YEAR      TO WORK-YEAR
 13109             MOVE WORK-DATE-MY   TO ACVEXITO.
 13110
 13111     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13112
 13113     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13114     MOVE '5'                    TO BEN-REC-TYPE.
 13115     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13116     MOVE ZERO                   TO BEN-SEQ-NO.
 13117
 13118
 13119* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL131.cbl
 13120*         DATASET  (CNTL-FILE-ID)
 13121*         RIDFLD   (BENEFIT-KEY)
 13122*         SET      (ADDRESS OF CONTROL-FILE)
 13123*    END-EXEC.
 13124*    MOVE '&"S        G          (   #00011129' TO DFHEIV0
 13125     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13127     MOVE X'2020233030303131313239' TO DFHEIV0(25:11)
 13128     CALL 'kxdfhei1' USING DFHEIV0,
 13129           CNTL-FILE-ID,
 13130           DFHEIV20,
 13131           DFHEIV99,
 13132           BENEFIT-KEY,
 13133           DFHEIV99,
 13134           DFHEIV99,
 13135           DFHEIV99
 13136     SET ADDRESS OF CONTROL-FILE TO
 13137         DFHEIV20
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13142        CF-RECORD-TYPE NOT = '5'
 13143         MOVE ER-0250            TO EMI-ERROR
 13144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13145         GO TO 5030-MOVE-CERT-FINISH.
 13146
 13147     MOVE ZERO                   TO COUNT-2.
 13148     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 13149
 13150     IF SCREEN-ERROR
 13151         MOVE ER-0283            TO EMI-ERROR
 13152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13153       ELSE
 13154         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 13155
 13156 5030-MOVE-CERT-FINISH.
 13157
 13158     MOVE CM-LOAN-APR            TO APRO.
 13159     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13160     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13161     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 13162     MOVE CM-LOAN-NUMBER         TO LOANNOO
 13163     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 13164     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 13165
 13166     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 13167         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13168         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13169         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13170         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 13171     ELSE
 13172         MOVE SPACES               TO ADDONDTO.
 13173
 13174     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 13175
 13176 5030-EXIT.
 13177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL131.cbl
 13179 5040-FIND-BENEFIT.
 13180     ADD 1                       TO COUNT-2.
 13181     IF COUNT-2 GREATER THAN 8
 13182         GO TO 5050-BENEFIT-NOTFND.
 13183
 13184     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 13185         GO TO 5060-EXIT.
 13186
 13187     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 13188         GO TO 5050-BENEFIT-NOTFND.
 13189
 13190     GO TO 5040-FIND-BENEFIT.
 13191
 13192 5050-BENEFIT-NOTFND.
 13193     MOVE 'X'                    TO ERROR-SWITCH.
 13194
 13195 5060-EXIT.
 13196     EXIT.
 13197
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL131.cbl
 13199 6000-CALCULATE-CERT-TERM.
 13200
 13201     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 13202         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 13203     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 13204         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 13205     IF CM-LOAN-APR NOT NUMERIC
 13206         MOVE ZEROS              TO CM-LOAN-APR.
 13207
 13208*    IF WS-CALC-METHOD  = 'G'
 13209         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 13210*     ELSE
 13211*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 13212
 13213     IF N GREATER 120
 13214         MOVE 120                TO N.
 13215
 13216     MOVE '6'                    TO DC-OPTION-CODE.
 13217     MOVE N                      TO DC-ELAPSED-MONTHS.
 13218     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13219     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13220
 13221     IF CM-LF-BENEFIT-CD NOT = ZERO
 13222         MOVE N                  TO CM-LF-ORIG-TERM
 13223         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 13224         IF NO-CONVERSION-ERROR
 13225             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 13226
 13227     IF CM-AH-BENEFIT-CD NOT = ZERO
 13228         MOVE N                  TO CM-AH-ORIG-TERM
 13229         IF NO-CONVERSION-ERROR
 13230             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 13231
 13232 6000-EXIT.
 13233      EXIT.
 13234
 13235 6100-CALC-GROSS-TERM.
 13236     MOVE CM-LOAN-BALANCE         TO L.
 13237     MOVE PI-PAYMENT-AMT          TO M.
 13238
 13239     COMPUTE N = L / M.
 13240     IF N LESS 1
 13241         MOVE 1  TO N.
 13242
 13243     IF CM-LF-BENEFIT-CD NOT = ZERO
 13244         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 13245     ELSE
 13246         MOVE ZEROS               TO WS-LF-RATE.
 13247
 13248     IF CM-AH-BENEFIT-CD NOT = ZERO
 13249         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 13250     ELSE
 13251         MOVE ZEROS               TO WS-AH-RATE.
 13252
 13253     COMPUTE I = CM-LOAN-APR / +1200.
 13254
 13255 6105-LOOP.
 13256     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL131.cbl
 13257         GO TO 6200-EXIT.
 13258     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 13259     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 13260         ADD 1 TO N
 13261         GO TO 6105-LOOP.
 13262
 13263 6200-EXIT.
 13264      EXIT.
 13265
 13266 6210-CALC-LEFT-RIGHTONE.
 13267      MOVE L         TO LEFT-TOT-1.
 13268      SUBTRACT 1 FROM N.
 13269      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13270      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 13271      ADD 1 TO N.
 13272 6211-CALC-TERM1.
 13273      MOVE N         TO TERM1.
 13274      MULTIPLY M BY TERM1.
 13275 6212-LOOP.
 13276      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 13277      ADD 1 TO A-N.
 13278      MULTIPLY A-N BY TERM1.
 13279      SUBTRACT 1 FROM A-N.
 13280      ADD TERM1 TO LEFT-TOT-1.
 13281 6213-CALC-TERM2.
 13282      MOVE M         TO TERM2.
 13283      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 13284      MULTIPLY IA-N BY TERM2.
 13285      SUBTRACT TERM2 FROM LEFT-TOT-1.
 13286 6215-CALC-RIGHTONE.
 13287      MOVE M         TO RIGHT-TOT-1.
 13288      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13289      MULTIPLY A-N BY RIGHT-TOT-1.
 13290 6220-EXIT.
 13291      EXIT.
 13292
 13293 6300-CALC-A-N.
 13294     IF N LESS 1
 13295         MOVE 0     TO A-N
 13296         GO TO 6300-EXIT.
 13297     IF I = 0
 13298         MOVE .00001 TO I.
 13299     ADD 1 TO I.
 13300     DIVIDE I INTO 1 GIVING V.
 13301     SUBTRACT 1 FROM I.
 13302     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13303     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 13304     DIVIDE I INTO TERM3 GIVING A-N.
 13305 6300-EXIT.
 13306      EXIT.
 13307
 13308 6350-CALC-IA-N.
 13309     IF N LESS 1
 13310         MOVE 0      TO IA-N
 13311         GO TO 6400-EXIT.
 13312     ADD 1 TO N.
 13313     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13314     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL131.cbl
 13315     MULTIPLY N BY V-EX-N GIVING TERM3.
 13316     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 13317     SUBTRACT V FROM 1 GIVING TERM4.
 13318     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 13319 6400-EXIT.
 13320      EXIT.
 13321
 13322 6450-CALC-V-EX-N.
 13323     IF N LESS 1
 13324         MOVE 1    TO V-EX-N
 13325         GO TO 6490-EXIT.
 13326     MOVE N        TO NV-STORE.
 13327     IF V-EX-ONETIME = 1  OR
 13328        V NOT = V-EXPONENT (1)
 13329          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 13330 6460-LOOP.
 13331     IF N GREATER 248
 13332         MOVE 248 TO N.
 13333     IF N = 1
 13334         MOVE V               TO V-EX-N
 13335      ELSE
 13336         MOVE V-EXPONENT (N)  TO V-EX-N.
 13337     GO TO 6490-EXIT.
 13338
 13339 6470-BUILD-V-EX-TABLE.
 13340     MOVE 2      TO N.
 13341     MOVE V      TO V-EXPONENT (1)
 13342                    V-EX-N.
 13343 6471-LOOP.
 13344     MULTIPLY V BY V-EX-N.
 13345     MOVE V-EX-N   TO V-EXPONENT (N).
 13346     ADD 1 TO N.
 13347     IF N LESS 248
 13348         GO TO 6471-LOOP.
 13349     MOVE NV-STORE     TO N.
 13350     MOVE 0            TO V-EX-ONETIME.
 13351 6480-EXIT.
 13352      EXIT.
 13353
 13354 6490-EXIT.
 13355      EXIT.
 13356
 13357 6500-CALC-NET-TERM.
 13358     MOVE CM-LOAN-BALANCE         TO L.
 13359     MOVE PI-PAYMENT-AMT          TO M.
 13360
 13361     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 13362     IF WS-REMAIN GREATER ZERO
 13363         ADD 1 TO N.
 13364     IF N = 0
 13365         MOVE 1 TO N.
 13366
 13367 6700-EXIT.
 13368      EXIT.
 13369
 13370 6999-CALC-TERM-EXIT.
 13371     EXIT.
 13372
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL131.cbl
 13374 7000-RESET-ATTRIBUTE.
 13375
 13376     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 13377                                    CERTSTA   CERTCARA
 13378                                    CERTGRPA.
 13379     MOVE -1                     TO CERTCARL.
 13380
 13381 7000-EXIT.
 13382     EXIT.
 13383
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL131.cbl
 13385 7600-BROWSE-CLAIM.
 13386
 13387
 13388* EXEC CICS READ
 13389*        DATASET(CLMS-FILE-ID)
 13390*        SET    (ADDRESS OF CLAIM-MASTER)
 13391*        RIDFLD (MSTR-KEY)
 13392*        GENERIC
 13393*        EQUAL
 13394*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13395*    END-EXEC.
 13396*    MOVE '&"S  KG    E          (   #00011381' TO DFHEIV0
 13397     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13399     MOVE X'2020233030303131333831' TO DFHEIV0(25:11)
 13400     CALL 'kxdfhei1' USING DFHEIV0,
 13401           CLMS-FILE-ID,
 13402           DFHEIV20,
 13403           DFHEIV99,
 13404           MSTR-KEY,
 13405           ELMSTR-GENERIC-LENGTH,
 13406           DFHEIV99,
 13407           DFHEIV99
 13408     SET ADDRESS OF CLAIM-MASTER TO
 13409         DFHEIV20
 13410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13411
 13412
 13413     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 13414
 13415     if cl-assoc-cert-total = 0
 13416        move 1 to cl-assoc-cert-total
 13417     end-if
 13418     IF CL-ASSOC-CERT-SEQU = 0
 13419        MOVE 1 TO CL-ASSOC-CERT-SEQU
 13420     END-IF
 13421
 13422     IF CL-ASSOC-CERT-TOTAL = 1
 13423         MOVE AL-SADOF           TO BCERT1A
 13424                                    BSUFX1A
 13425                                    BCERT2A
 13426                                    BSUFX2A
 13427                                    BCERT3A
 13428                                    BSUFX3A
 13429                                    BCERT4A
 13430                                    BSUFX4A
 13431                                    BCERT5A
 13432                                    BSUFX5A
 13433                                    PCERTNOA
 13434                                    PSUFXA
 13435                                    LABEL1A
 13436                                    LABEL2A
 13437         GO TO 7699-EXIT.
 13438
 13439 7610-BROWSE-CLAIM-LOOP.
 13440
 13441     MOVE LOW-VALUES             TO BCERT1O
 13442                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL131.cbl
 13443                                    BCERT2O
 13444                                    BSUFX2O
 13445                                    BCERT3O
 13446                                    BSUFX3O
 13447                                    BCERT4O
 13448                                    BSUFX4O
 13449                                    BCERT5O
 13450                                    BSUFX5O.
 13451
 13452
 13453* EXEC CICS HANDLE CONDITION
 13454*        ENDFILE  (7630-END-BROWSE)
 13455*    END-EXEC.
 13456*    MOVE '"$''                   ! B #00011429' TO DFHEIV0
 13457     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13459     MOVE X'4220233030303131343239' TO DFHEIV0(25:11)
 13460     CALL 'kxdfhei1' USING DFHEIV0
 13461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13462
 13463
 13464
 13465* EXEC CICS STARTBR
 13466*        DATASET    (CLMS-FILE-ID)
 13467*        RIDFLD     (MSTR-KEY)
 13468*    END-EXEC.
 13469     MOVE 0
 13470       TO DFHEIV11
 13471*    MOVE '&,         G          &   #00011433' TO DFHEIV0
 13472     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13473     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13474     MOVE X'2020233030303131343333' TO DFHEIV0(25:11)
 13475     CALL 'kxdfhei1' USING DFHEIV0,
 13476           CLMS-FILE-ID,
 13477           MSTR-KEY,
 13478           DFHEIV99,
 13479           DFHEIV11,
 13480           DFHEIV99
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13482
 13483
 13484     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 13485
 13486 7620-READ-CLAIM-LOOP.
 13487
 13488
 13489* EXEC CICS READNEXT
 13490*        DATASET   (CLMS-FILE-ID)
 13491*        SET       (ADDRESS OF CLAIM-MASTER)
 13492*        RIDFLD    (MSTR-KEY)
 13493*    END-EXEC.
 13494     MOVE 0
 13495       TO DFHEIV11
 13496*    MOVE '&.S                   )   #00011442' TO DFHEIV0
 13497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13499     MOVE X'2020233030303131343432' TO DFHEIV0(25:11)
 13500     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL131.cbl
 13501           CLMS-FILE-ID,
 13502           DFHEIV20,
 13503           DFHEIV99,
 13504           MSTR-KEY,
 13505           DFHEIV99,
 13506           DFHEIV11,
 13507           DFHEIV99,
 13508           DFHEIV99
 13509     SET ADDRESS OF CLAIM-MASTER TO
 13510         DFHEIV20
 13511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13512
 13513
 13514     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 13515        CL-CARRIER     NOT = CARRI           OR
 13516        CL-CLAIM-NO    NOT = CLAIMI
 13517        GO TO 7630-END-BROWSE.
 13518
 13519     IF WS-ASSOCIATED-CERTS = 1
 13520         MOVE CL-CERT-PRIME      TO BCERT1O
 13521         MOVE CL-CERT-SFX        TO BSUFX1O.
 13522
 13523     IF WS-ASSOCIATED-CERTS = 2
 13524         MOVE CL-CERT-PRIME      TO BCERT2O
 13525         MOVE CL-CERT-SFX        TO BSUFX2O.
 13526
 13527     IF WS-ASSOCIATED-CERTS = 3
 13528         MOVE CL-CERT-PRIME      TO BCERT3O
 13529         MOVE CL-CERT-SFX        TO BSUFX3O.
 13530
 13531     IF WS-ASSOCIATED-CERTS = 4
 13532         MOVE CL-CERT-PRIME      TO BCERT4O
 13533         MOVE CL-CERT-SFX        TO BSUFX4O.
 13534
 13535     IF WS-ASSOCIATED-CERTS = 5
 13536         MOVE CL-CERT-PRIME      TO BCERT5O
 13537         MOVE CL-CERT-SFX        TO BSUFX5O
 13538     ELSE
 13539         ADD +1                  TO WS-ASSOCIATED-CERTS
 13540         GO TO 7620-READ-CLAIM-LOOP.
 13541
 13542 7630-END-BROWSE.
 13543
 13544
 13545* EXEC CICS ENDBR
 13546*        DATASET   (CLMS-FILE-ID)
 13547*    END-EXEC.
 13548     MOVE 0
 13549       TO DFHEIV11
 13550*    MOVE '&2                    $   #00011478' TO DFHEIV0
 13551     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13553     MOVE X'2020233030303131343738' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0,
 13555           CLMS-FILE-ID,
 13556           DFHEIV11,
 13557           DFHEIV99
 13558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL131.cbl
 13559
 13560
 13561 7640-HIGHLIGHT-CERT-DISPLAYED.
 13562
 13563     MOVE AL-SANON               TO BCERT1A
 13564                                    BSUFX1A
 13565                                    BCERT2A
 13566                                    BSUFX2A
 13567                                    BCERT3A
 13568                                    BSUFX3A
 13569                                    BCERT4A
 13570                                    BSUFX4A
 13571                                    BCERT5A
 13572                                    BSUFX5A.
 13573
 13574     IF BCERT1O = CERTI AND
 13575        BSUFX1O = SUFXI
 13576            MOVE AL-SABON        TO BCERT1A
 13577                                    BSUFX1A.
 13578
 13579     IF BCERT2O = CERTI AND
 13580        BSUFX2O = SUFXI
 13581            MOVE AL-SABON        TO BCERT2A
 13582                                    BSUFX2A.
 13583
 13584     IF BCERT3O = CERTI AND
 13585        BSUFX3O = SUFXI
 13586            MOVE AL-SABON        TO BCERT3A
 13587                                    BSUFX3A.
 13588
 13589     IF BCERT4O = CERTI AND
 13590        BSUFX4O = SUFXI
 13591            MOVE AL-SABON        TO BCERT4A
 13592                                    BSUFX4A.
 13593
 13594     IF BCERT5O = CERTI AND
 13595        BSUFX5O = SUFXI
 13596            MOVE AL-SABON        TO BCERT5A
 13597                                    BSUFX5A.
 13598
 13599 7699-EXIT.
 13600     EXIT.
 13601
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL131.cbl
 13603 7700-CHECK-SEQUENCE.
 13604
 13605
 13606* EXEC CICS HANDLE CONDITION
 13607*        ENDFILE  (7799-EXIT)
 13608*        NOTFND   (7799-EXIT)
 13609*    END-EXEC.
 13610*    MOVE '"$''I                  ! C #00011526' TO DFHEIV0
 13611     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13613     MOVE X'4320233030303131353236' TO DFHEIV0(25:11)
 13614     CALL 'kxdfhei1' USING DFHEIV0
 13615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13616
 13617
 13618
 13619* EXEC CICS READ
 13620*        DATASET(CLMS-FILE-ID)
 13621*        SET    (ADDRESS OF CLAIM-MASTER)
 13622*        RIDFLD (MSTR-KEY)
 13623*        GENERIC
 13624*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13625*    END-EXEC.
 13626*    MOVE '&"S  KG    E          (   #00011531' TO DFHEIV0
 13627     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13629     MOVE X'2020233030303131353331' TO DFHEIV0(25:11)
 13630     CALL 'kxdfhei1' USING DFHEIV0,
 13631           CLMS-FILE-ID,
 13632           DFHEIV20,
 13633           DFHEIV99,
 13634           MSTR-KEY,
 13635           ELMSTR-GENERIC-LENGTH,
 13636           DFHEIV99,
 13637           DFHEIV99
 13638     SET ADDRESS OF CLAIM-MASTER TO
 13639         DFHEIV20
 13640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13641
 13642
 13643     COMPUTE WS-ASSOC-CERT-TOTAL =
 13644             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 13645
 13646     GO TO 7799-EXIT.
 13647
 13648 7710-RESEQUENCE-CLAIMS.
 13649
 13650
 13651* EXEC CICS HANDLE CONDITION
 13652*        ENDFILE  (7799-EXIT)
 13653*    END-EXEC.
 13654*    MOVE '"$''                   ! D #00011546' TO DFHEIV0
 13655     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13657     MOVE X'4420233030303131353436' TO DFHEIV0(25:11)
 13658     CALL 'kxdfhei1' USING DFHEIV0
 13659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13660
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL131.cbl
 13661
 13662
 13663* EXEC CICS STARTBR
 13664*        DATASET(CLMS-FILE-ID)
 13665*        RIDFLD (MSTR-KEY)
 13666*    END-EXEC.
 13667     MOVE 0
 13668       TO DFHEIV11
 13669*    MOVE '&,         G          &   #00011550' TO DFHEIV0
 13670     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13672     MOVE X'2020233030303131353530' TO DFHEIV0(25:11)
 13673     CALL 'kxdfhei1' USING DFHEIV0,
 13674           CLMS-FILE-ID,
 13675           MSTR-KEY,
 13676           DFHEIV99,
 13677           DFHEIV11,
 13678           DFHEIV99
 13679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13680
 13681
 13682     COMPUTE WS-ASSOC-CERT-SEQU =
 13683             WS-ASSOC-CERT-SEQU + 1.
 13684
 13685     COMPUTE WS-READNEXT-SWITCH =
 13686             WS-READNEXT-SWITCH + 1.
 13687
 13688 7720-READ-CLAIM-LOOP.
 13689
 13690
 13691* EXEC CICS READNEXT
 13692*        DATASET(CLMS-FILE-ID)
 13693*        SET    (ADDRESS OF CLAIM-MASTER)
 13694*        RIDFLD (MSTR-KEY)
 13695*    END-EXEC.
 13696     MOVE 0
 13697       TO DFHEIV11
 13698*    MOVE '&.S                   )   #00011563' TO DFHEIV0
 13699     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13700     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13701     MOVE X'2020233030303131353633' TO DFHEIV0(25:11)
 13702     CALL 'kxdfhei1' USING DFHEIV0,
 13703           CLMS-FILE-ID,
 13704           DFHEIV20,
 13705           DFHEIV99,
 13706           MSTR-KEY,
 13707           DFHEIV99,
 13708           DFHEIV11,
 13709           DFHEIV99,
 13710           DFHEIV99
 13711     SET ADDRESS OF CLAIM-MASTER TO
 13712         DFHEIV20
 13713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13714
 13715
 13716     IF WS-READNEXT-SWITCH = 1
 13717         ADD 1                   TO WS-READNEXT-SWITCH
 13718         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL131.cbl
 13719
 13720 7730-END-BROWSE.
 13721
 13722
 13723* EXEC CICS ENDBR
 13724*        DATASET(CLMS-FILE-ID)
 13725*    END-EXEC.
 13726     MOVE 0
 13727       TO DFHEIV11
 13728*    MOVE '&2                    $   #00011575' TO DFHEIV0
 13729     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13730     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13731     MOVE X'2020233030303131353735' TO DFHEIV0(25:11)
 13732     CALL 'kxdfhei1' USING DFHEIV0,
 13733           CLMS-FILE-ID,
 13734           DFHEIV11,
 13735           DFHEIV99
 13736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13737
 13738
 13739 7740-READ-CLAIM-UPDATE.
 13740
 13741     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 13742        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 13743        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 13744        GO TO 7799-EXIT
 13745     ELSE
 13746        MOVE ZERO                TO WS-READNEXT-SWITCH.
 13747
 13748
 13749* EXEC CICS READ
 13750*        DATASET(CLMS-FILE-ID)
 13751*        SET    (ADDRESS OF CLAIM-MASTER)
 13752*        RIDFLD (MSTR-KEY)
 13753*        UPDATE
 13754*    END-EXEC.
 13755*    MOVE '&"S        EU         (   #00011588' TO DFHEIV0
 13756     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13757     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13758     MOVE X'2020233030303131353838' TO DFHEIV0(25:11)
 13759     CALL 'kxdfhei1' USING DFHEIV0,
 13760           CLMS-FILE-ID,
 13761           DFHEIV20,
 13762           DFHEIV99,
 13763           MSTR-KEY,
 13764           DFHEIV99,
 13765           DFHEIV99,
 13766           DFHEIV99
 13767     SET ADDRESS OF CLAIM-MASTER TO
 13768         DFHEIV20
 13769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13770
 13771
 13772     if (cl-priority-cd = '8')
 13773        and (pi-processor-id not = 'PEMA' and 'JMS '
 13774             AND 'AMWA')
 13775        MOVE ER-8003             TO EMI-ERROR
 13776        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL131.cbl
 13777                                 THRU 9900-EXIT
 13778        MOVE -1                  TO MAINTL
 13779        GO TO 8110-SEND-DATA
 13780     end-if
 13781
 13782     IF PI-COMPANY-ID = 'CID' or 'AHL'
 13783         MOVE 'Y'                TO CL-YESNOSW
 13784     END-IF.
 13785
 13786     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 13787     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 13788
 13789
 13790* EXEC CICS REWRITE
 13791*         DATASET(CLMS-FILE-ID)
 13792*         FROM   (CLAIM-MASTER)
 13793*    END-EXEC.
 13794     MOVE LENGTH OF
 13795      CLAIM-MASTER
 13796       TO DFHEIV11
 13797*    MOVE '&& L                  %   #00011612' TO DFHEIV0
 13798     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13800     MOVE X'2020233030303131363132' TO DFHEIV0(25:11)
 13801     CALL 'kxdfhei1' USING DFHEIV0,
 13802           CLMS-FILE-ID,
 13803           CLAIM-MASTER,
 13804           DFHEIV11,
 13805           DFHEIV99
 13806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13807
 13808
 13809     GO TO 7710-RESEQUENCE-CLAIMS.
 13810
 13811 7799-EXIT.
 13812     EXIT.
 13813
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL131.cbl
 13815 7800-CHECK-AUTO-ACTIVITY.
 13816
 13817
 13818* EXEC CICS HANDLE CONDITION
 13819*        NOTFND   (7800-NOT-FOUND)
 13820*    END-EXEC.
 13821*    MOVE '"$I                   ! E #00011625' TO DFHEIV0
 13822     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13824     MOVE X'4520233030303131363235' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13827
 13828
 13829     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 13830     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13831     MOVE SPACES                     TO  CNTL-PROC-ID.
 13832     MOVE +0                         TO  CNTL-SEQ-NO.
 13833
 13834
 13835* EXEC CICS READ
 13836*        DATASET   (CNTL-FILE-ID)
 13837*        RIDFLD    (CNTL-KEY)
 13838*        SET       (ADDRESS OF CONTROL-FILE)
 13839*    END-EXEC.
 13840*    MOVE '&"S        E          (   #00011634' TO DFHEIV0
 13841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13843     MOVE X'2020233030303131363334' TO DFHEIV0(25:11)
 13844     CALL 'kxdfhei1' USING DFHEIV0,
 13845           CNTL-FILE-ID,
 13846           DFHEIV20,
 13847           DFHEIV99,
 13848           CNTL-KEY,
 13849           DFHEIV99,
 13850           DFHEIV99,
 13851           DFHEIV99
 13852     SET ADDRESS OF CONTROL-FILE TO
 13853         DFHEIV20
 13854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13855
 13856
 13857     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 13858         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 13859
 13860     IF CL-ACTIVITY-CODE NOT = ZEROS
 13861         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 13862         IF MISC-SUB IS GREATER THAN +9
 13863             SUBTRACT +9 FROM MISC-SUB
 13864             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 13865         ELSE
 13866             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 13867     ELSE
 13868         MOVE 'Y'                              TO  WS-RESET-SW.
 13869
 13870     IF STATUSI = 'C' OR 'CLOSED'
 13871         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 13872             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL131.cbl
 13873                                         PI-LETTER-SW
 13874             GO TO 7800-EXIT.
 13875
 13876     IF STATUSI = 'C' OR 'CLOSED'
 13877         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 13878             MOVE 'N'                TO  PI-LETTER-SW
 13879         ELSE
 13880             MOVE 'Y'                TO  PI-LETTER-SW.
 13881
 13882     IF STATUSI = 'O' OR 'OPEN'
 13883         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 13884             MOVE 'N'                TO  PI-REC-FOUND-SW
 13885                                         PI-LETTER-SW
 13886             GO TO 7800-EXIT.
 13887
 13888     IF STATUSI = 'O' OR 'OPEN'
 13889         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 13890             MOVE 'N'                TO  PI-LETTER-SW
 13891         ELSE
 13892             MOVE 'Y'                TO  PI-LETTER-SW.
 13893
 13894     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 13895     GO TO 7800-EXIT.
 13896
 13897 7800-NOT-FOUND.
 13898
 13899     MOVE 'N'                        TO  PI-REC-FOUND-SW
 13900                                         PI-LETTER-SW.
 13901
 13902 7800-EXIT.
 13903     EXIT.
 13904
 13905 7850-AUTO-LETTER-WRITER.
 13906
 13907     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 13908     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 13909
 13910     IF STATUSI = 'C' OR 'CLOSED'
 13911         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 13912     ELSE
 13913         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 13914
 13915     IF STATUSI = 'C' OR 'CLOSED'
 13916         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 13917             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13918             MOVE '6'                TO  DC-OPTION-CODE
 13919             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 13920             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13921             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13922             IF NO-CONVERSION-ERROR
 13923                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13924             ELSE
 13925                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13926
 13927     IF STATUSI = 'C' OR 'CLOSED'
 13928         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 13929             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13930             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL131.cbl
 13931             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 13932             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13933             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13934             IF NO-CONVERSION-ERROR
 13935                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13936             ELSE
 13937                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13938
 13939     IF STATUSI = 'O' OR 'OPEN'
 13940         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 13941             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13942             MOVE '6'                TO  DC-OPTION-CODE
 13943             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 13944             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13945             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13946             IF NO-CONVERSION-ERROR
 13947                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13948             ELSE
 13949                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13950
 13951     IF STATUSI = 'O' OR 'OPEN'
 13952         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 13953             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13954             MOVE '6'                TO  DC-OPTION-CODE
 13955             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 13956             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13957             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13958             IF NO-CONVERSION-ERROR
 13959                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13960             ELSE
 13961                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13962
 13963
 13964* EXEC CICS LINK
 13965*        PROGRAM    (LINK-1523)
 13966*        COMMAREA   (W-1523-LINKDATA)
 13967*        LENGTH     (W-1523-COMM-LENGTH)
 13968*    END-EXEC.
 13969*    MOVE '."C                   ''   #00011746' TO DFHEIV0
 13970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13972     MOVE X'2020233030303131373436' TO DFHEIV0(25:11)
 13973     CALL 'kxdfhei1' USING DFHEIV0,
 13974           LINK-1523,
 13975           W-1523-LINKDATA,
 13976           W-1523-COMM-LENGTH,
 13977           DFHEIV99,
 13978           DFHEIV99,
 13979           DFHEIV99
 13980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13981
 13982
 13983     IF W-1523-ERROR-CODE = ZEROS
 13984         GO TO 7850-EXIT.
 13985
 13986     IF W-1523-FATAL-ERROR
 13987         MOVE ER-0802                TO  EMI-ERROR
 13988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL131.cbl
 13989
 13990     IF W-1523-ERROR-CODE = 0191
 13991         MOVE ER-0803                TO  EMI-ERROR
 13992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13993
 13994 7850-EXIT.
 13995     EXIT.
 13996
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL131.cbl
 13998 8000-CREATE-DMO-REC.
 13999     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14000     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14001     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14002
 14003
 14004* EXEC CICS HANDLE CONDITION
 14005*         NOTFND   (8000-NOTE-NOT-FOUND)
 14006*    END-EXEC.
 14007*    MOVE '"$I                   ! F #00011772' TO DFHEIV0
 14008     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14010     MOVE X'4620233030303131373732' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0
 14012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14013
 14014
 14015
 14016* EXEC CICS READ
 14017*         DATASET(NOTE-FILE-ID)
 14018*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14019*         RIDFLD (NOTE-KEY)
 14020*    END-EXEC.
 14021*    MOVE '&"S        E          (   #00011776' TO DFHEIV0
 14022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14024     MOVE X'2020233030303131373736' TO DFHEIV0(25:11)
 14025     CALL 'kxdfhei1' USING DFHEIV0,
 14026           NOTE-FILE-ID,
 14027           DFHEIV20,
 14028           DFHEIV99,
 14029           NOTE-KEY,
 14030           DFHEIV99,
 14031           DFHEIV99,
 14032           DFHEIV99
 14033     SET ADDRESS OF CERTIFICATE-NOTE TO
 14034         DFHEIV20
 14035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14036
 14037
 14038     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14039     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14040     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14041
 14042     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14043         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14044     ELSE
 14045         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14046
 14047     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14048     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14049
 14050
 14051* EXEC CICS LINK
 14052*        PROGRAM    ('DLO006')
 14053*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14054*        LENGTH     (WS-DCT-LENGTH)
 14055*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL131.cbl
 14056     MOVE 'DLO006' TO DFHEIV1
 14057*    MOVE '."C                   ''   #00011794' TO DFHEIV0
 14058     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14060     MOVE X'2020233030303131373934' TO DFHEIV0(25:11)
 14061     CALL 'kxdfhei1' USING DFHEIV0,
 14062           DFHEIV1,
 14063           DCT-COMMUNICATION-AREA,
 14064           WS-DCT-LENGTH,
 14065           DFHEIV99,
 14066           DFHEIV99,
 14067           DFHEIV99
 14068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14069
 14070
 14071     IF  DCT-RETURN-CODE = 'OK'
 14072         GO TO 8000-CONT.
 14073
 14074     IF DCT-RETURN-CODE = '01' OR '02'
 14075         GO TO 8000-EXIT.
 14076
 14077     IF DCT-RETURN-CODE = '03'
 14078         MOVE ER-0951            TO EMI-ERROR
 14079         MOVE -1                 TO MAINTL
 14080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14081         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14082         GO TO 8110-SEND-DATA.
 14083
 14084     IF DCT-RETURN-CODE = '04'
 14085         MOVE ER-0946            TO EMI-ERROR
 14086         MOVE -1                 TO MAINTL
 14087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14088         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14089         GO TO 8110-SEND-DATA.
 14090
 14091     IF DCT-RETURN-CODE = '05'
 14092         MOVE ER-0947            TO EMI-ERROR
 14093         MOVE -1                 TO MAINTL
 14094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14095         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14096         GO TO 8110-SEND-DATA.
 14097
 14098     IF DCT-RETURN-CODE = '06'
 14099         MOVE ER-0921            TO EMI-ERROR
 14100         MOVE -1                 TO MAINTL
 14101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14102         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14103         GO TO 8110-SEND-DATA.
 14104
 14105     IF DCT-RETURN-CODE = '07'
 14106         MOVE ER-0919            TO EMI-ERROR
 14107         MOVE -1                 TO MAINTL
 14108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14109         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14110         GO TO 8110-SEND-DATA.
 14111
 14112     IF DCT-RETURN-CODE = '08'
 14113         MOVE ER-0948            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL131.cbl
 14114         MOVE -1                 TO MAINTL
 14115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14116         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14117         GO TO 8110-SEND-DATA.
 14118
 14119     IF DCT-RETURN-CODE = 'N1'
 14120         MOVE ER-0950            TO EMI-ERROR
 14121         MOVE -1                 TO MAINTL
 14122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14123         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14124         GO TO 8110-SEND-DATA.
 14125
 14126     IF DCT-RETURN-CODE = 'E1'
 14127         MOVE ER-0974            TO EMI-ERROR
 14128         MOVE -1                 TO MAINTL
 14129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14130         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14131         GO TO 8110-SEND-DATA.
 14132
 14133     IF DCT-RETURN-CODE = 'E2'
 14134         MOVE ER-0975            TO EMI-ERROR
 14135         MOVE -1                 TO MAINTL
 14136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14137         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14138         GO TO 8110-SEND-DATA.
 14139
 14140     IF DCT-RETURN-CODE NOT = 'OK'
 14141         MOVE ER-0949            TO EMI-ERROR
 14142         MOVE -1                 TO MAINTL
 14143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14145         GO TO 8110-SEND-DATA.
 14146
 14147 8000-CONT.
 14148
 14149     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14150     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14151     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14152     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14153     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14154     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14155     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14156     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14157
 14158     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14159     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14160     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14161     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 14162     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14163
 14164     IF STATUSI = 'OPEN' OR 'O'
 14165         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 14166      ELSE
 14167         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 14168
 14169     IF STATUSI = 'OPEN' OR 'O'
 14170        IF CL-NO-OF-PMTS-MADE = 0
 14171         MOVE '1'                TO DM-CLAIM-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL131.cbl
 14172      ELSE
 14173         MOVE '2'                TO DM-CLAIM-STATUS.
 14174
 14175     IF STATUSI = 'CLOSED' OR 'C'
 14176        IF NOT FINAL-PAID
 14177         MOVE '3'                TO DM-CLAIM-STATUS
 14178      ELSE
 14179         MOVE '4'                TO DM-CLAIM-STATUS.
 14180
 14181     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14182
 14183
 14184* EXEC CICS LINK
 14185*        PROGRAM    ('DLO025')
 14186*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14187*        LENGTH     (WS-DMO-LENGTH)
 14188*    END-EXEC.
 14189     MOVE 'DLO025' TO DFHEIV1
 14190*    MOVE '."C                   ''   #00011912' TO DFHEIV0
 14191     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14192     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14193     MOVE X'2020233030303131393132' TO DFHEIV0(25:11)
 14194     CALL 'kxdfhei1' USING DFHEIV0,
 14195           DFHEIV1,
 14196           DMO-COMMUNICATION-AREA,
 14197           WS-DMO-LENGTH,
 14198           DFHEIV99,
 14199           DFHEIV99,
 14200           DFHEIV99
 14201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14202
 14203
 14204     IF  DM-RETURN-CODE = 'OK'
 14205         GO TO 8000-EXIT.
 14206
 14207     IF DM-RETURN-CODE = '01'
 14208         MOVE ER-8051            TO EMI-ERROR
 14209         MOVE -1                 TO MAINTL
 14210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14211         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14212         GO TO 8110-SEND-DATA.
 14213
 14214     IF DM-RETURN-CODE = '02'
 14215         MOVE ER-8052            TO EMI-ERROR
 14216         MOVE -1                 TO MAINTL
 14217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14218         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14219         GO TO 8110-SEND-DATA.
 14220
 14221     IF DM-RETURN-CODE = '03'
 14222         MOVE ER-8053            TO EMI-ERROR
 14223         MOVE -1                 TO MAINTL
 14224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14225         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14226         GO TO 8110-SEND-DATA.
 14227
 14228     IF DM-RETURN-CODE = '04'
 14229         MOVE ER-8054            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL131.cbl
 14230         MOVE -1                 TO MAINTL
 14231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14232         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14233         GO TO 8110-SEND-DATA.
 14234
 14235     IF DM-RETURN-CODE = '05'
 14236         MOVE ER-8055            TO EMI-ERROR
 14237         MOVE -1                 TO MAINTL
 14238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14239         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14240         GO TO 8110-SEND-DATA.
 14241
 14242     IF DM-RETURN-CODE = '06'
 14243         MOVE ER-8056            TO EMI-ERROR
 14244         MOVE -1                 TO MAINTL
 14245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14247         GO TO 8110-SEND-DATA.
 14248
 14249     IF DM-RETURN-CODE = '07'
 14250         MOVE ER-8057            TO EMI-ERROR
 14251         MOVE -1                 TO MAINTL
 14252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14253         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14254         GO TO 8110-SEND-DATA.
 14255
 14256     IF DM-RETURN-CODE = '08'
 14257         MOVE ER-8058            TO EMI-ERROR
 14258         MOVE -1                 TO MAINTL
 14259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14260         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14261         GO TO 8110-SEND-DATA.
 14262
 14263     IF DM-RETURN-CODE = '09'
 14264         MOVE ER-8059            TO EMI-ERROR
 14265         MOVE -1                 TO MAINTL
 14266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14267         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14268         GO TO 8110-SEND-DATA.
 14269
 14270     IF DM-RETURN-CODE = '10'
 14271         MOVE ER-8060            TO EMI-ERROR
 14272         MOVE -1                 TO MAINTL
 14273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14274         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14275         GO TO 8110-SEND-DATA.
 14276
 14277     IF DM-RETURN-CODE = '11'
 14278         MOVE ER-8061            TO EMI-ERROR
 14279         MOVE -1                 TO MAINTL
 14280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14281         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14282         GO TO 8110-SEND-DATA.
 14283
 14284     IF DM-RETURN-CODE = '12'
 14285         MOVE ER-8062            TO EMI-ERROR
 14286         MOVE -1                 TO MAINTL
 14287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL131.cbl
 14288         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14289         GO TO 8110-SEND-DATA.
 14290
 14291     IF DM-RETURN-CODE = '13'
 14292         MOVE ER-8063            TO EMI-ERROR
 14293         MOVE -1                 TO MAINTL
 14294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14295         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14296         GO TO 8110-SEND-DATA.
 14297
 14298     IF DM-RETURN-CODE = '14'
 14299         MOVE ER-8064            TO EMI-ERROR
 14300         MOVE -1                 TO MAINTL
 14301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14302         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14303         GO TO 8110-SEND-DATA.
 14304
 14305     IF DM-RETURN-CODE = '15'
 14306         MOVE ER-8065            TO EMI-ERROR
 14307         MOVE -1                 TO MAINTL
 14308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14309         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14310         GO TO 8110-SEND-DATA.
 14311
 14312     IF DM-RETURN-CODE = '16'
 14313         MOVE ER-8154            TO EMI-ERROR
 14314         MOVE -1                 TO MAINTL
 14315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14316         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14317         GO TO 8110-SEND-DATA.
 14318
 14319     IF DM-RETURN-CODE = '17'
 14320         MOVE ER-8155            TO EMI-ERROR
 14321         MOVE -1                 TO MAINTL
 14322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14323         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14324         GO TO 8110-SEND-DATA.
 14325
 14326     IF DM-RETURN-CODE = 'N1'
 14327         MOVE ER-8152            TO EMI-ERROR
 14328         MOVE -1                 TO MAINTL
 14329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14330         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14331         GO TO 8110-SEND-DATA.
 14332
 14333     IF DM-RETURN-CODE = 'E1'
 14334         MOVE ER-8153            TO EMI-ERROR
 14335         MOVE -1                 TO MAINTL
 14336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14337         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14338         GO TO 8110-SEND-DATA.
 14339
 14340     MOVE ER-8066                TO EMI-ERROR.
 14341     MOVE -1                     TO MAINTL.
 14342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14343     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
 14344     GO TO 8110-SEND-DATA.
 14345
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL131.cbl
 14346 8000-NOTE-NOT-FOUND.
 14347
 14348* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14349*    MOVE '6"R                   !   #00012061' TO DFHEIV0
 14350     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14352     MOVE X'2020233030303132303631' TO DFHEIV0(25:11)
 14353     CALL 'kxdfhei1' USING DFHEIV0
 14354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14355
 14356     MOVE ER-0954                TO EMI-ERROR.
 14357     MOVE -1                     TO MAINTL.
 14358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14359     GO TO 8110-SEND-DATA.
 14360
 14361 8000-EXIT.
 14362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL131.cbl
 14364 8050-FORMAT-LAST-NAME-1ST.
 14365*****************************************************************
 14366*             M O V E   N A M E   R O U T I N E                 *
 14367*                                                               *
 14368*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14369*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14370*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 14371*                                                               *
 14372*                  FIELD               VALUE                    *
 14373*                  -----               -----                    *
 14374*           W-NAME-LAST    (CL15)      SMITH                    *
 14375*           W-NAME-FIRST   (CL15)      JOHN                     *
 14376*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14377*                                                               *
 14378*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 14379*                SMITH, JOHN ALLEN                              *
 14380*                     OR                                        *
 14381*                SMITH, JOHN A.                                 *
 14382*                                                               *
 14383*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 14384*     COPYBOOK, ELCNWA.                                         *
 14385*****************************************************************.
 14386
 14387     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14388     MOVE ZERO                   TO WS-NAME-SW.
 14389     SET NWA-INDEX               TO +1.
 14390
 14391     IF W-NAME-LAST   = SPACES  AND
 14392        W-NAME-MIDDLE = SPACES
 14393          MOVE +1                TO WS-NAME-SW.
 14394
 14395     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14396     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14397
 14398     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14399     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14400
 14401     SET NWA-INDEX UP BY +1.
 14402
 14403     IF W-NAME-MIDDLE NOT = SPACES
 14404         IF W-NAME-MIDDLE-2 = SPACES
 14405             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14406             SET NWA-INDEX UP BY +1
 14407             MOVE '.'            TO WS-NW (NWA-INDEX)
 14408             SET NWA-INDEX UP BY +2
 14409         ELSE
 14410             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14411             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14412
 14413 8050-EXIT.
 14414     EXIT.
 14415
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL131.cbl
 14417 8060-MOVE-NAME.
 14418     IF WS-NAME-SW GREATER THAN +1
 14419         GO TO 8060-EXIT.
 14420
 14421     IF WS-NAME-WORK2 = SPACES
 14422         GO TO 8060-EXIT.
 14423
 14424     SET NWA-INDEX2            TO +1.
 14425     SET NWA-INDEX3            TO +2.
 14426
 14427 8060-MOVE-NAME-CYCLE.
 14428     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14429
 14430     IF NWA-INDEX LESS THAN +30
 14431         SET NWA-INDEX UP BY +1
 14432     ELSE
 14433         ADD +2 TO  WS-NAME-SW
 14434         GO TO 8060-EXIT.
 14435
 14436     IF NWA-INDEX2 LESS THAN +20
 14437         SET NWA-INDEX3 UP BY +1
 14438         SET NWA-INDEX2 UP BY +1.
 14439
 14440     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 14441        WS-NW2 (NWA-INDEX3) = SPACES
 14442         IF WS-NAME-SW = ZERO
 14443             MOVE ','            TO WS-NW (NWA-INDEX)
 14444             SET NWA-INDEX UP BY +2
 14445             MOVE +1             TO WS-NAME-SW
 14446             GO TO 8060-EXIT
 14447         ELSE
 14448             GO TO 8060-EXIT.
 14449
 14450     GO TO 8060-MOVE-NAME-CYCLE.
 14451
 14452 8060-EXIT.
 14453     EXIT.
 14454
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL131.cbl
 14456
 14457 8070-UNLOCK-CLAIM-MSTR.
 14458
 14459* EXEC CICS UNLOCK
 14460*        DATASET   (CLMS-FILE-ID)
 14461*    END-EXEC.
 14462*    MOVE '&*                    #   #00012164' TO DFHEIV0
 14463     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14464     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14465     MOVE X'2020233030303132313634' TO DFHEIV0(25:11)
 14466     CALL 'kxdfhei1' USING DFHEIV0,
 14467           CLMS-FILE-ID,
 14468           DFHEIV99
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472 8070-EXIT.
 14473      EXIT.
 14474
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL131.cbl
 14476 8100-SEND-MAP.
 14477     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14478
 14479     IF NOT PI-NO-CARRIER-SECURITY
 14480        MOVE AL-SANOF            TO CERTCARA.
 14481     IF NOT PI-NO-ACCOUNT-SECURITY
 14482        MOVE AL-SANOF            TO CERTACTA.
 14483
 14484     IF PI-PROCESSOR-ID = 'LGXX'
 14485        MOVE AL-UANON            TO CCNOA.
 14486
 14487     IF PI-COMPANY-ID = 'DMD'
 14488        NEXT SENTENCE
 14489     ELSE
 14490        MOVE AL-SADOF            TO PFKEY6A.
 14491
 14492     IF PI-USES-PAID-TO
 14493        MOVE 'PAID TO  :' TO PTHRHDGO.
 14494
 14495
 14496* EXEC CICS SEND
 14497*         MAP     ('EL131A')
 14498*         MAPSET  ('EL131S')
 14499*         ERASE
 14500*         FREEKB
 14501*         CURSOR
 14502*    END-EXEC.
 14503     MOVE 'EL131A' TO DFHEIV1
 14504     MOVE -1
 14505       TO DFHEIV11
 14506     MOVE 'EL131S' TO DFHEIV2
 14507*    MOVE '8$     CT  E F  H     ,   #00012191' TO DFHEIV0
 14508     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14509     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14510     MOVE X'2020233030303132313931' TO DFHEIV0(25:11)
 14511     CALL 'kxdfhei1' USING DFHEIV0,
 14512           DFHEIV1,
 14513           EL131AO,
 14514           DFHEIV99,
 14515           DFHEIV2,
 14516           DFHEIV99,
 14517           DFHEIV99,
 14518           DFHEIV99,
 14519           DFHEIV11,
 14520           DFHEIV99,
 14521           DFHEIV99,
 14522           DFHEIV99
 14523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14524
 14525
 14526     GO TO 9000-RETURN-TRANS.
 14527
 14528 8110-SEND-DATA.
 14529     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14530
 14531     IF PI-USES-PAID-TO
 14532        MOVE 'PAID TO  :' TO PTHRHDGO.
 14533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL131.cbl
 14534     IF PI-PROCESSOR-ID = 'LGXX'
 14535        MOVE AL-UANON            TO CCNOA.
 14536
 14537     IF PI-COMPANY-ID = 'DMD'
 14538        NEXT SENTENCE
 14539     ELSE
 14540        MOVE AL-SADOF            TO PFKEY6A.
 14541
 14542
 14543* EXEC CICS SEND
 14544*         MAP      ('EL131A')
 14545*         MAPSET   ('EL131S')
 14546*         DATAONLY
 14547*         FREEKB
 14548*         CURSOR
 14549*    END-EXEC.
 14550     MOVE 'EL131A' TO DFHEIV1
 14551     MOVE -1
 14552       TO DFHEIV11
 14553     MOVE 'EL131S' TO DFHEIV2
 14554*    MOVE '8$D    CT    F  H     ,   #00012215' TO DFHEIV0
 14555     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 14556     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14557     MOVE X'2020233030303132323135' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0,
 14559           DFHEIV1,
 14560           EL131AO,
 14561           DFHEIV99,
 14562           DFHEIV2,
 14563           DFHEIV99,
 14564           DFHEIV99,
 14565           DFHEIV99,
 14566           DFHEIV11,
 14567           DFHEIV99,
 14568           DFHEIV99,
 14569           DFHEIV99
 14570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14571
 14572
 14573     GO TO 9000-RETURN-TRANS.
 14574
 14575 8120-FORMAT-TIME-DATE.
 14576
 14577     IF SKIP-ATTRIBUTE = 'Y'
 14578        MOVE SPACES              TO SKIP-ATTRIBUTE
 14579        MOVE ER-0598             TO EMI-ERROR
 14580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14581        GO TO 8125-SKIP-ATTRIBUTE.
 14582
 14583     IF PI-COMPANY-ID = 'DMD'
 14584         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 14585                                    CERTCARA  CERTGRPA.
 14586
 14587     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 14588                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 14589                                    JNTINITA  JNTAGEA   APRA
 14590                                    LCVCDA    LCVOTRMA  LCVRTRMA
 14591                                    LCVBENEA  LCVFORMA  LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL131.cbl
 14592                                    LCVEXITA  LCVSTATA  LCVKINDA
 14593                                    ACVCDA    ACVOTRMA  ACVRTRMA
 14594                                    ACVBENEA  ACVFORMA  ACVCNDTA
 14595                                    ACVEXITA  ACVSTATA  ACVKINDA
 14596                                    PMTFREQA  INDGRPA   PREMTYPA
 14597                                    REINCDA   LCVRATEA  ACVRATEA
 14598                                    ADDONDTA.
 14599
 14600*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 14601*       IF PI-COMPANY-ID = 'DMD'
 14602*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 14603*                                   SUFXA
 14604*                                   PDAMTA    NODAYSA   NOPMTSA
 14605*                                   INCA      OCCA
 14606*          IF NOT SYSTEM-MODIFY-CAP
 14607*              MOVE AL-SANOF         TO PDTHRUA.
 14608
 14609     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 14610         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14611
 14612 8125-SKIP-ATTRIBUTE.
 14613
 14614     MOVE SAVE-DATE              TO DATEO.
 14615
 14616* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 14617*    END-EXEC
 14618*    MOVE '0"A                   "   #00012265' TO DFHEIV0
 14619     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 14620     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 14621     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 14622     CALL 'kxdfhei1' USING DFHEIV0,
 14623           LCP-CICS-TIME
 14624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14625
 14626* EXEC CICS FORMATTIME
 14627*              ABSTIME(LCP-CICS-TIME)
 14628*              TIME(LCP-TIME-OF-DAY-XX)
 14629*    END-EXEC
 14630*    MOVE 'j$(     (             #   #00012267' TO DFHEIV0
 14631     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 14632     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14633     MOVE X'2020233030303132323637' TO DFHEIV0(25:11)
 14634     CALL 'kxdfhei1' USING DFHEIV0,
 14635           LCP-CICS-TIME,
 14636           LCP-TIME-OF-DAY-XX
 14637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14638     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 14639     MOVE UN-HOURS               TO FOR-HOURS.
 14640     MOVE UN-MINUTES             TO FOR-MINUTES.
 14641     MOVE TIME-OUT               TO TIMEO.
 14642     MOVE PI-COMPANY-ID          TO COMPO.
 14643     MOVE PI-PROCESSOR-ID        TO USERIDO.
 14644     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 14645     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 14646     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 14647
 14648 8130-EXIT.
 14649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL131.cbl
 14650
 14651 8150-ENTERED-CLAIM-NOTFOUND.
 14652
 14653     MOVE ER-0204                TO EMI-ERROR.
 14654     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14655     MOVE -1                     TO MAINTL.
 14656     GO TO 8100-SEND-MAP.
 14657
 14658 8200-RETURN-PRIOR.
 14659     MOVE SPACE                  TO PI-RETURN-CD-1.
 14660     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 14661     GO TO 9200-XCTL.
 14662
 14663 8300-GET-HELP.
 14664     MOVE XCTL-EL010             TO CALL-PGM.
 14665     GO TO 9200-XCTL.
 14666
 14667 8400-RETURN-MASTER.
 14668     MOVE SPACE                  TO PI-RETURN-CD-1.
 14669     MOVE XCTL-EL126             TO CALL-PGM.
 14670     GO TO 9200-XCTL.
 14671
 14672 8500-TRLR-MNT.
 14673     IF PI-RETURN-CD-1 = 'X'
 14674         MOVE ER-0311            TO EMI-ERROR
 14675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14676         MOVE -1                 TO MAINTL
 14677         GO TO 8110-SEND-DATA.
 14678
 14679
 14680* EXEC CICS WRITEQ TS
 14681*         QUEUE     (PI-KEY)
 14682*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14683*         LENGTH    (PI-COMM-LENGTH)
 14684*    END-EXEC.
 14685*    MOVE '*"                    ''   #00012312' TO DFHEIV0
 14686     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14688     MOVE X'2020233030303132333132' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0,
 14690           PI-KEY,
 14691           PROGRAM-INTERFACE-BLOCK,
 14692           PI-COMM-LENGTH,
 14693           DFHEIV99,
 14694           DFHEIV99,
 14695           DFHEIV99
 14696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14697
 14698
 14699     MOVE XCTL-EL142             TO CALL-PGM.
 14700     GO TO 9200-XCTL.
 14701
 14702 8600-ADDR-MNT.
 14703     IF PI-RETURN-CD-1 = 'X'
 14704         MOVE ER-0311            TO EMI-ERROR
 14705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14706         MOVE -1                 TO MAINTL
 14707         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL131.cbl
 14708
 14709
 14710* EXEC CICS WRITEQ TS
 14711*         QUEUE     (PI-KEY)
 14712*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14713*         LENGTH    (PI-COMM-LENGTH)
 14714*    END-EXEC.
 14715*    MOVE '*"                    ''   #00012328' TO DFHEIV0
 14716     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14718     MOVE X'2020233030303132333238' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0,
 14720           PI-KEY,
 14721           PROGRAM-INTERFACE-BLOCK,
 14722           PI-COMM-LENGTH,
 14723           DFHEIV99,
 14724           DFHEIV99,
 14725           DFHEIV99
 14726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14727
 14728
 14729     MOVE XCTL-EL141             TO CALL-PGM.
 14730     GO TO 9200-XCTL.
 14731
 14732 8700-CERT-MNT.
 14733     IF PI-RETURN-CD-1 = 'X'
 14734         MOVE ER-7690            TO EMI-ERROR
 14735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14736         MOVE -1                 TO MAINTL
 14737         GO TO 8110-SEND-DATA.
 14738
 14739
 14740* EXEC CICS WRITEQ TS
 14741*         QUEUE     (PI-KEY)
 14742*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14743*         LENGTH    (PI-COMM-LENGTH)
 14744*    END-EXEC.
 14745*    MOVE '*"                    ''   #00012344' TO DFHEIV0
 14746     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14747     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14748     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 14749     CALL 'kxdfhei1' USING DFHEIV0,
 14750           PI-KEY,
 14751           PROGRAM-INTERFACE-BLOCK,
 14752           PI-COMM-LENGTH,
 14753           DFHEIV99,
 14754           DFHEIV99,
 14755           DFHEIV99
 14756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14757
 14758
 14759     MOVE XCTL-EL1273            TO CALL-PGM.
 14760     GO TO 9200-XCTL.
 14761
 14762 8750-DMD-CLM-FIX.
 14763
 14764* EXEC CICS WRITEQ TS
 14765*         QUEUE     (PI-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL131.cbl
 14766*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14767*         LENGTH    (PI-COMM-LENGTH)
 14768*    END-EXEC.
 14769*    MOVE '*"                    ''   #00012354' TO DFHEIV0
 14770     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14772     MOVE X'2020233030303132333534' TO DFHEIV0(25:11)
 14773     CALL 'kxdfhei1' USING DFHEIV0,
 14774           PI-KEY,
 14775           PROGRAM-INTERFACE-BLOCK,
 14776           PI-COMM-LENGTH,
 14777           DFHEIV99,
 14778           DFHEIV99,
 14779           DFHEIV99
 14780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14781
 14782
 14783     MOVE XCTL-EL400DMD          TO CALL-PGM.
 14784     GO TO 9200-XCTL.
 14785
 14786 8800-UNAUTHORIZED-ACCESS.
 14787     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 14788     GO TO 8990-SEND-TEXT.
 14789
 14790 8810-PF23-ENTERED.
 14791     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 14792     MOVE XCTL-EL005             TO CALL-PGM.
 14793     GO TO 9200-XCTL.
 14794
 14795 8820-XCTL-ERROR.
 14796
 14797* EXEC CICS HANDLE CONDITION
 14798*        PGMIDERR (8990-SEND-TEXT)
 14799*    END-EXEC.
 14800*    MOVE '"$L                   ! G #00012373' TO DFHEIV0
 14801     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14803     MOVE X'4720233030303132333733' TO DFHEIV0(25:11)
 14804     CALL 'kxdfhei1' USING DFHEIV0
 14805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14806
 14807
 14808     MOVE SPACE                 TO PI-ENTRY-CD-1.
 14809     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 14810     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 14811     MOVE XCTL-EL005            TO CALL-PGM.
 14812     GO TO 9200-XCTL.
 14813
 14814 8990-SEND-TEXT.
 14815
 14816* EXEC CICS SEND TEXT
 14817*         FROM      (LOGOFF-TEXT)
 14818*         LENGTH    (LOGOFF-LENGTH)
 14819*         ERASE
 14820*         FREEKB
 14821*    END-EXEC.
 14822*    MOVE '8&      T  E F  H   F -   #00012384' TO DFHEIV0
 14823     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL131.cbl
 14824     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 14825     MOVE X'2020233030303132333834' TO DFHEIV0(25:11)
 14826     CALL 'kxdfhei1' USING DFHEIV0,
 14827           LOGOFF-TEXT,
 14828           LOGOFF-LENGTH,
 14829           DFHEIV99,
 14830           DFHEIV99,
 14831           DFHEIV99,
 14832           DFHEIV99,
 14833           DFHEIV99,
 14834           DFHEIV99,
 14835           DFHEIV99,
 14836           DFHEIV99,
 14837           DFHEIV99,
 14838           DFHEIV99
 14839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14840
 14841
 14842     GO TO 9100-RETURN-CICS.
 14843
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL131.cbl
 14845 9000-RETURN-TRANS.
 14846
 14847* EXEC CICS RETURN
 14848*         TRANSID   (TRANS-ID)
 14849*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 14850*         LENGTH    (PI-COMM-LENGTH)
 14851*    END-EXEC.
 14852*    MOVE '.(CT                  &   #00012395' TO DFHEIV0
 14853     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 14854     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14855     MOVE X'2020233030303132333935' TO DFHEIV0(25:11)
 14856     CALL 'kxdfhei1' USING DFHEIV0,
 14857           TRANS-ID,
 14858           PROGRAM-INTERFACE-BLOCK,
 14859           PI-COMM-LENGTH,
 14860           DFHEIV99,
 14861           DFHEIV99
 14862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14863
 14864
 14865
 14866* GOBACK.
 14867     MOVE '9%                    "   ' TO DFHEIV0
 14868     MOVE 'EL131' TO DFHEIV1
 14869     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14870     GOBACK.
 14871
 14872 9100-RETURN-CICS.
 14873
 14874* EXEC CICS RETURN
 14875*    END-EXEC.
 14876*    MOVE '.(                    &   #00012404' TO DFHEIV0
 14877     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14879     MOVE X'2020233030303132343034' TO DFHEIV0(25:11)
 14880     CALL 'kxdfhei1' USING DFHEIV0,
 14881           DFHEIV99,
 14882           DFHEIV99,
 14883           DFHEIV99,
 14884           DFHEIV99,
 14885           DFHEIV99
 14886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14887
 14888
 14889
 14890* GOBACK.
 14891     MOVE '9%                    "   ' TO DFHEIV0
 14892     MOVE 'EL131' TO DFHEIV1
 14893     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14894     GOBACK.
 14895
 14896 9200-XCTL.
 14897
 14898* EXEC CICS XCTL
 14899*         PROGRAM    (CALL-PGM)
 14900*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 14901*         LENGTH     (PI-COMM-LENGTH)
 14902*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL131.cbl
 14903*    MOVE '.$C                   $   #00012410' TO DFHEIV0
 14904     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 14905     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14906     MOVE X'2020233030303132343130' TO DFHEIV0(25:11)
 14907     CALL 'kxdfhei1' USING DFHEIV0,
 14908           CALL-PGM,
 14909           PROGRAM-INTERFACE-BLOCK,
 14910           PI-COMM-LENGTH
 14911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14912
 14913
 14914 9700-LINK-RTRM-FILE-ID.
 14915
 14916* EXEC CICS LINK
 14917*        PROGRAM  (RTRM-FILE-ID)
 14918*        COMMAREA (CALCULATION-PASS-AREA)
 14919*        LENGTH   (CP-COMM-LENGTH)
 14920*    END-EXEC.
 14921*    MOVE '."C                   ''   #00012417' TO DFHEIV0
 14922     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14923     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14924     MOVE X'2020233030303132343137' TO DFHEIV0(25:11)
 14925     CALL 'kxdfhei1' USING DFHEIV0,
 14926           RTRM-FILE-ID,
 14927           CALCULATION-PASS-AREA,
 14928           CP-COMM-LENGTH,
 14929           DFHEIV99,
 14930           DFHEIV99,
 14931           DFHEIV99
 14932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14933
 14934
 14935 9700-EXIT.
 14936      EXIT.
 14937
 14938 9800-CONVERT-DATE.
 14939     MOVE SPACES TO DC-ERROR-CODE.
 14940
 14941* EXEC CICS LINK
 14942*         PROGRAM    (DATE-CONV)
 14943*         COMMAREA   (DATE-CONVERSION-DATA)
 14944*         LENGTH     (DC-COMM-LENGTH)
 14945*    END-EXEC.
 14946*    MOVE '."C                   ''   #00012428' TO DFHEIV0
 14947     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14948     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14949     MOVE X'2020233030303132343238' TO DFHEIV0(25:11)
 14950     CALL 'kxdfhei1' USING DFHEIV0,
 14951           DATE-CONV,
 14952           DATE-CONVERSION-DATA,
 14953           DC-COMM-LENGTH,
 14954           DFHEIV99,
 14955           DFHEIV99,
 14956           DFHEIV99
 14957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14958
 14959
 14960 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL131.cbl
 14961     EXIT.
 14962
 14963 9900-ERROR-FORMAT.
 14964
 14965* EXEC CICS LINK
 14966*         PROGRAM    (XCTL-EL001)
 14967*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 14968*         LENGTH     (EMI-COMM-LENGTH)
 14969*    END-EXEC.
 14970*    MOVE '."C                   ''   #00012438' TO DFHEIV0
 14971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14973     MOVE X'2020233030303132343338' TO DFHEIV0(25:11)
 14974     CALL 'kxdfhei1' USING DFHEIV0,
 14975           XCTL-EL001,
 14976           ERROR-MESSAGE-INTERFACE-BLOCK,
 14977           EMI-COMM-LENGTH,
 14978           DFHEIV99,
 14979           DFHEIV99,
 14980           DFHEIV99
 14981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14982
 14983
 14984 9900-EXIT.
 14985     EXIT.
 14986
 14987 9990-ABEND.
 14988     MOVE DFHEIBLK               TO EMI-LINE1.
 14989
 14990* EXEC CICS LINK
 14991*         PROGRAM   (XCTL-EL004)
 14992*         COMMAREA  (EMI-LINE1)
 14993*         LENGTH    (72)
 14994*     END-EXEC.
 14995     MOVE 72
 14996       TO DFHEIV11
 14997*    MOVE '."C                   ''   #00012449' TO DFHEIV0
 14998     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15000     MOVE X'2020233030303132343439' TO DFHEIV0(25:11)
 15001     CALL 'kxdfhei1' USING DFHEIV0,
 15002           XCTL-EL004,
 15003           EMI-LINE1,
 15004           DFHEIV11,
 15005           DFHEIV99,
 15006           DFHEIV99,
 15007           DFHEIV99
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011     MOVE -1                     TO  MAINTL
 15012
 15013     GO TO 8110-SEND-DATA.
 15014
 15015 9995-SECURITY-VIOLATION.
 15016*           COPY ELCSCTP.
 15017******************************************************************
 15018*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL131.cbl
 15019*                            ELCSCTP                             *
 15020*                            VMOD=2.001                          *
 15021*                                                                *
 15022*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15023******************************************************************
 15024
 15025
 15026     MOVE EIBDATE          TO SM-JUL-DATE.
 15027     MOVE EIBTRMID         TO SM-TERMID.
 15028     MOVE THIS-PGM         TO SM-PGM.
 15029     MOVE EIBTIME          TO TIME-IN.
 15030     MOVE TIME-OUT         TO SM-TIME.
 15031     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15032
 15033
 15034* EXEC CICS LINK
 15035*         PROGRAM  ('EL003')
 15036*         COMMAREA (SECURITY-MESSAGE)
 15037*         LENGTH   (80)
 15038*    END-EXEC.
 15039     MOVE 'EL003' TO DFHEIV1
 15040     MOVE 80
 15041       TO DFHEIV11
 15042*    MOVE '."C                   ''   #00012477' TO DFHEIV0
 15043     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15044     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15045     MOVE X'2020233030303132343737' TO DFHEIV0(25:11)
 15046     CALL 'kxdfhei1' USING DFHEIV0,
 15047           DFHEIV1,
 15048           SECURITY-MESSAGE,
 15049           DFHEIV11,
 15050           DFHEIV99,
 15051           DFHEIV99,
 15052           DFHEIV99
 15053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15054
 15055
 15056******************************************************************
 15057
 15058
 15059
 15060 9999-DFHBACK SECTION.
 15061     MOVE '9%                    "   ' TO DFHEIV0
 15062     MOVE 'EL131' TO DFHEIV1
 15063     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15064     GOBACK.
 15065 9999-DFHEXIT.
 15066     IF DFHEIGDJ EQUAL 0001
 15067         NEXT SENTENCE
 15068     ELSE IF DFHEIGDJ EQUAL 2
 15069         GO TO 8820-XCTL-ERROR,
 15070               8150-ENTERED-CLAIM-NOTFOUND,
 15071               9990-ABEND
 15072         DEPENDING ON DFHEIGDI
 15073     ELSE IF DFHEIGDJ EQUAL 3
 15074         GO TO 0130-TS-ERROR,
 15075               0130-TS-ERROR
 15076         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL131.cbl
 15077     ELSE IF DFHEIGDJ EQUAL 4
 15078         GO TO 0600-CONTINUE-NAME-UPDATE
 15079         DEPENDING ON DFHEIGDI
 15080     ELSE IF DFHEIGDJ EQUAL 5
 15081         GO TO 1004-BENE-NOT-FOUND
 15082         DEPENDING ON DFHEIGDI
 15083     ELSE IF DFHEIGDJ EQUAL 6
 15084         GO TO 1120-CNTL-NOTFND
 15085         DEPENDING ON DFHEIGDI
 15086     ELSE IF DFHEIGDJ EQUAL 7
 15087         GO TO 1150-NOTOPEN-ERROR,
 15088               1150-EXIT
 15089         DEPENDING ON DFHEIGDI
 15090     ELSE IF DFHEIGDJ EQUAL 8
 15091         GO TO 1490-STATE-NOTFND
 15092         DEPENDING ON DFHEIGDI
 15093     ELSE IF DFHEIGDJ EQUAL 9
 15094         GO TO 1500-CARR-NOTFND
 15095         DEPENDING ON DFHEIGDI
 15096     ELSE IF DFHEIGDJ EQUAL 10
 15097         GO TO 1620-ACCT-NOTFND
 15098         DEPENDING ON DFHEIGDI
 15099     ELSE IF DFHEIGDJ EQUAL 11
 15100         GO TO 2020-EXIT
 15101         DEPENDING ON DFHEIGDI
 15102     ELSE IF DFHEIGDJ EQUAL 12
 15103         GO TO 2030-EXIT
 15104         DEPENDING ON DFHEIGDI
 15105     ELSE IF DFHEIGDJ EQUAL 13
 15106         GO TO 2040-EXIT
 15107         DEPENDING ON DFHEIGDI
 15108     ELSE IF DFHEIGDJ EQUAL 14
 15109         GO TO 2050-EXIT
 15110         DEPENDING ON DFHEIGDI
 15111     ELSE IF DFHEIGDJ EQUAL 15
 15112         GO TO 2060-CERT-NOTFND
 15113         DEPENDING ON DFHEIGDI
 15114     ELSE IF DFHEIGDJ EQUAL 16
 15115         GO TO 2060-DUPKEY
 15116         DEPENDING ON DFHEIGDI
 15117     ELSE IF DFHEIGDJ EQUAL 17
 15118         GO TO 2070-NOT-FOUND
 15119         DEPENDING ON DFHEIGDI
 15120     ELSE IF DFHEIGDJ EQUAL 18
 15121         GO TO 2070-EXIT
 15122         DEPENDING ON DFHEIGDI
 15123     ELSE IF DFHEIGDJ EQUAL 19
 15124         GO TO 2080-EXIT
 15125         DEPENDING ON DFHEIGDI
 15126     ELSE IF DFHEIGDJ EQUAL 20
 15127         GO TO 2400-TRLR-NOTFND,
 15128               2410-EXIT
 15129         DEPENDING ON DFHEIGDI
 15130     ELSE IF DFHEIGDJ EQUAL 21
 15131         GO TO 2425-NINETY-NOTFND,
 15132               2425-NINETY-NOTFND
 15133         DEPENDING ON DFHEIGDI
 15134     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL131.cbl
 15135         GO TO 2430-EXIT,
 15136               2440-EXIT
 15137         DEPENDING ON DFHEIGDI
 15138     ELSE IF DFHEIGDJ EQUAL 23
 15139         GO TO 2440-EXIT
 15140         DEPENDING ON DFHEIGDI
 15141     ELSE IF DFHEIGDJ EQUAL 24
 15142         GO TO 2460-EXIT
 15143         DEPENDING ON DFHEIGDI
 15144     ELSE IF DFHEIGDJ EQUAL 25
 15145         GO TO 2475-EXIT
 15146         DEPENDING ON DFHEIGDI
 15147     ELSE IF DFHEIGDJ EQUAL 26
 15148         GO TO 2650-EXIT
 15149         DEPENDING ON DFHEIGDI
 15150     ELSE IF DFHEIGDJ EQUAL 27
 15151         GO TO 3010-DEL-ACTQ,
 15152               3040-EXIT
 15153         DEPENDING ON DFHEIGDI
 15154     ELSE IF DFHEIGDJ EQUAL 28
 15155         GO TO 3010-NO-ACTIVITY,
 15156               3050-EXIT
 15157         DEPENDING ON DFHEIGDI
 15158     ELSE IF DFHEIGDJ EQUAL 29
 15159         GO TO 3010-CERT-NOT-FOUND
 15160         DEPENDING ON DFHEIGDI
 15161     ELSE IF DFHEIGDJ EQUAL 30
 15162         GO TO 3020-EXIT
 15163         DEPENDING ON DFHEIGDI
 15164     ELSE IF DFHEIGDJ EQUAL 31
 15165         GO TO 3060-EXIT,
 15166               3060-EXIT
 15167         DEPENDING ON DFHEIGDI
 15168     ELSE IF DFHEIGDJ EQUAL 32
 15169         GO TO 5000-TRLR-NOT-FOUND
 15170         DEPENDING ON DFHEIGDI
 15171     ELSE IF DFHEIGDJ EQUAL 33
 15172         GO TO 5000-CERT-NOT-FOUND
 15173         DEPENDING ON DFHEIGDI
 15174     ELSE IF DFHEIGDJ EQUAL 34
 15175         GO TO 7630-END-BROWSE
 15176         DEPENDING ON DFHEIGDI
 15177     ELSE IF DFHEIGDJ EQUAL 35
 15178         GO TO 7799-EXIT,
 15179               7799-EXIT
 15180         DEPENDING ON DFHEIGDI
 15181     ELSE IF DFHEIGDJ EQUAL 36
 15182         GO TO 7799-EXIT
 15183         DEPENDING ON DFHEIGDI
 15184     ELSE IF DFHEIGDJ EQUAL 37
 15185         GO TO 7800-NOT-FOUND
 15186         DEPENDING ON DFHEIGDI
 15187     ELSE IF DFHEIGDJ EQUAL 38
 15188         GO TO 8000-NOTE-NOT-FOUND
 15189         DEPENDING ON DFHEIGDI
 15190     ELSE IF DFHEIGDJ EQUAL 39
 15191         GO TO 8990-SEND-TEXT
 15192         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL131.cbl
 15193     MOVE '9%                    "   ' TO DFHEIV0
 15194     MOVE 'EL131' TO DFHEIV1
 15195     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15196     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10884     Code:       50452
