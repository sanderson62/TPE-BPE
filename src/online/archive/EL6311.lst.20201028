* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    90* 052020  CR2019111300001  PEMA  Include all files in "K" trans
    91* 072120  CR2020072100002  PEMA  Allow deletion of dup pend iss re
    92******************************************************************
    93
    94 ENVIRONMENT DIVISION.
    95
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   4
* EL6311.cbl
    97 DATA DIVISION.
    98 WORKING-STORAGE SECTION.
    99 01  DFH-START PIC X(04).
   100 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
   101 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
   102 77  FILLER  PIC X(32)  VALUE '********************************'.
   103 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   104 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   105 77  A1                          PIC S999 COMP-3 VALUE +0.
   106 77  N1                          PIC S999 COMP-3 VALUE +0.
   107 77  N2                          PIC S999 COMP-3 VALUE +0.
   108 77  N3                          PIC S999 COMP-3 VALUE +0.
   109 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   110 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   111 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   112     88  REVERSAL                    VALUE 'Y'.
   113 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   114 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   115 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   116 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   117 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   118     88  ERMAIL-FOUND                 VALUE 'Y'.
   119 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   120 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   121 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   122 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   123     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   124 77  ws-stop-sw                  pic x value ' '.
   125     88  i-say-stop                 value 'Y'.
   126 77  ws-check-sw                 pic x value ' '.
   127     88  i-have-checks              value 'Y'.
   128 77  ws-proc-check-sw            pic x value ' '.
   129     88  i-have-processed-checks    value 'Y'.
   130 77  ws-any-check-sw             pic x value ' '.
   131     88  i-have-a-check-period      value 'Y'.
   132 77  ws-chek-browse-sw           pic x value ' '.
   133 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   134 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   135 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   136 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   137 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   138 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   139 77  ws-elcrtt-update-sw         pic x value ' '.
   140     88  update-elcrtt              value 'Y'.
   141 01  P pointer.
   142 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   143 01  var-ptr pointer.
   144 01  env-var-len                 pic 9(4)  binary.
   145 01  rc                          pic 9(9)  binary.
   146 01  WS-KIXSYS.
   147     05  WS-KIX-FIL1             PIC X(10).
   148     05  WS-KIX-APPS             PIC X(10).
   149     05  WS-KIX-ENV              PIC X(10).
   150     05  WS-KIX-MYENV            PIC X(10).
   151     05  WS-KIX-SYS              PIC X(10).
   152*    COPY ELCSCTM.
   153******************************************************************
   154*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   5
* EL6311.cbl
   155*                                                                *
   156*                            ELCSCTM                             *
   157*                            VMOD=2.001                          *
   158*                                                                *
   159*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   160*                                                                *
   161******************************************************************
   162 01  SECURITY-MESSAGE.
   163     12  FILLER                          PIC X(30)
   164            VALUE '** LOGIC SECURITY VIOLATION -'.
   165     12  SM-READ                         PIC X(6).
   166     12  FILLER                          PIC X(5)
   167            VALUE ' PGM='.
   168     12  SM-PGM                          PIC X(6).
   169     12  FILLER                          PIC X(5)
   170            VALUE ' OPR='.
   171     12  SM-PROCESSOR-ID                 PIC X(4).
   172     12  FILLER                          PIC X(6)
   173            VALUE ' TERM='.
   174     12  SM-TERMID                       PIC X(4).
   175     12  FILLER                          PIC XX   VALUE SPACE.
   176     12  SM-JUL-DATE                     PIC 9(5).
   177     12  FILLER                          PIC X    VALUE SPACE.
   178     12  SM-TIME                         PIC 99.99.
   179
   180
   181*    COPY ELCSCRTY.
   182******************************************************************
   183*                                                                *
   184*                                                                *
   185*                            ELCSCRTY                            *
   186*                            VMOD=2.001                          *
   187*                                                                *
   188*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   189*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   190*        SAVED IN PI-SECURITY-ADDRESS.                           *
   191*                                                                *
   192******************************************************************
   193 01  SECURITY-CONTROL.
   194     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   195     12  FILLER                       PIC XX    VALUE 'SC'.
   196     12  SC-CREDIT-CODES.
   197         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   198             20  SC-CREDIT-DISPLAY    PIC X.
   199             20  SC-CREDIT-UPDATE     PIC X.
   200     12  SC-CLAIMS-CODES.
   201         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   202             20  SC-CLAIMS-DISPLAY    PIC X.
   203             20  SC-CLAIMS-UPDATE     PIC X.
   204
   205 01  WS-VA-NO-COMM-MESS.
   206     12  FILLER                  PIC X(41) VALUE
   207        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   208 01  WS-OC-MESSAGE.
   209     12  FILLER                  PIC X(43) VALUE
   210        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   211     12  WS-OC-DIS-AMT           PIC -----9.99.
   212     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   6
* EL6311.cbl
   213     12  WS-OC-DATE              PIC X(10).
   214 01  WS-DATE-AREA.
   215     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   216     12  WS-CURRENT-DT.
   217         16  FILLER              PIC X(6)    VALUE SPACES.
   218         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   219     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   220     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   221     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   222
   223 01  STANDARD-AREAS.
   224     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   225     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   226     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   227     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   228     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   229     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   230     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   231     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   232     12  PGM-NAME                PIC X(8).
   233     12  TIME-IN                 PIC S9(7).
   234     12  TIME-OUT-R  REDEFINES TIME-IN.
   235         16  FILLER              PIC X.
   236         16  TIME-OUT            PIC 99V99.
   237         16  FILLER              PIC XX.
   238     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   239     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   240     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   241     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   242     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   243     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   244     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   245     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   246     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   247     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   248     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   249     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   250     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   251     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   252     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   253     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   254     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   255     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   256     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   257     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   258     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   259     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   260     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   261     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   262     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   263     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   264     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   265     12  FILE-ID                 PIC X(8).
   266     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   267     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   268     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   269     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   270     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   7
* EL6311.cbl
   271     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   272     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   273     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   274     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   275     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   276     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   277     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   278     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   279     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   280     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   281
   282 01  WS-PASS-AREA.
   283     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   284     05  WS-PASS-VADS-REC    PIC X(350).
   285*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   286*                                COPY ELCZREC.
   287******************************************************************
   288*                                                                *
   289*                                                                *
   290*                            ELCZREC.                            *
   291*                                                                *
   292*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   293*                                                                *
   294******************************************************************
   295*-----------------------------------------------------------------
   296*                   C H A N G E   L O G
   297*
   298* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   299*-----------------------------------------------------------------
   300*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   301* EFFECTIVE    NUMBER
   302*-----------------------------------------------------------------
   303* 122011    2011022800001  AJRA  NEW FILE
   304* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   305* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   306* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   307* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   308*-----------------------------------------------------------------
   309 01  W-Z-CONTROL-DATA.
   310     05  W-NUMBER-OF-COPIES      PIC  9.
   311     05  FILLER                  PIC  X.
   312     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   313     05  FILLER                  PIC  X.
   314     05  W-DAYS-TO-RESEND        PIC  999.
   315     05  FILLER                  PIC  X.
   316     05  W-FORM-TO-RESEND        PIC  X(4).
   317     05  W-ADD-BAR-CODE          PIC  X.
   318     05  W-PROMPT-LETTER         PIC  X.
   319     05  W-HAS-RETURN-ENV        PIC  X.
   320     05  W-ENCLOSURE-CD          PIC  XXX.
   321     05  W-SIG-FLAG-DEFAULT      PIC  X.
   322     05  W-AUTO-CLOSE-IND        PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-LETTER-TO-BENE        PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-LETTER-TO-ACCT        PIC  X.
   327     05  FILLER                  PIC  X.
   328     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   8
* EL6311.cbl
   329     05  FILLER                  PIC  X.
   330     05  W-PRINT-CERTIFICATE     PIC  X.
   331     05  FILLER                  PIC  X.
   332     05  W-REFUND-REQUIRED       PIC  X.
   333     05  FILLER                  PIC  X.
   334     05  W-ONBASE-CODE           PIC  XX.
   335     05  FILLER                  PIC  X.
   336     05  W-ACCT-SUMM             PIC  X.
   337     05  FILLER                  PIC  X.
   338     05  W-CSO-SUMM              PIC  X.
   339     05  FILLER                  PIC  X.
   340     05  W-REASONS-REQUIRED      PIC  X.
   341     05  FILLER                  PIC  X(29).
   342******************************************************************
   343*                                                                *
   344*              A C C E S S   K E Y S                             *
   345*                                                                *
   346******************************************************************
   347
   348 01  ACCESS-KEYS.
   349     12  ERPYAJ-KEY.
   350         16  ERPYAJ-COMPANY-CD       PIC X.
   351         16  ERPYAJ-CARRIER          PIC X.
   352         16  ERPYAJ-GROUPING         PIC X(6).
   353         16  ERPYAJ-FIN-RESP         PIC X(10).
   354         16  ERPYAJ-ACCOUNT          PIC X(10).
   355         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   356         16  ERPYAJ-TYPE             PIC X.
   357     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   358     12  ELCERT-KEY.
   359         16  ELCERT-COMPANY-CD       PIC X.
   360         16  ELCERT-CARRIER          PIC X.
   361         16  ELCERT-GROUPING         PIC X(6).
   362         16  ELCERT-STATE            PIC XX.
   363         16  ELCERT-ACCOUNT          PIC X(10).
   364         16  ELCERT-CERT-EFF-DT      PIC XX.
   365         16  ELCERT-CERT-NO.
   366             20  ELCERT-CERT-PRIME   PIC X(10).
   367             20  ELCERT-CERT-SFX     PIC X.
   368
   369     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   370     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   371     12  ELCRTO-KEY.
   372         16  ELCRTO-COMPANY-CD       PIC X.
   373         16  ELCRTO-CARRIER          PIC X.
   374         16  ELCRTO-GROUPING         PIC X(6).
   375         16  ELCRTO-STATE            PIC XX.
   376         16  ELCRTO-ACCOUNT          PIC X(10).
   377         16  ELCRTO-CERT-EFF-DT      PIC XX.
   378         16  ELCRTO-CERT-NO.
   379             20  ELCRTO-CERT-PRIME   PIC X(10).
   380             20  ELCRTO-CERT-SFX     PIC X.
   381         16  ELCRTO-RECORD-TYPE      PIC X.
   382         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   383
   384     12  ELCRTT-KEY.
   385         16  ELCRTT-PRIMARY          PIC X(33).
   386         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   9
* EL6311.cbl
   387     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   388     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   389
   390     12  ERPNDB-KEY.
   391         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   392         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   393         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   394         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   395             ERPNDB-BATCH-SEQ-NO     PIC XX.
   396         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   397
   398     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   399     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   400     12  ERCHEK-KEY.
   401         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   402         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   403         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   404         16  CHEK-STATE              PIC XX      VALUE SPACES.
   405         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   406         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   407         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   408         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   409         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   410     12  ELLETR-KEY.
   411         16  LETR-COMPANY-CD     PIC X.
   412         16  LETR-LETTER-ID      PIC X(4).
   413         16  LETR-FILLER         PIC X(8).
   414         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   415     12  ERPNDM-KEY.
   416         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   417         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   418         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   419         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   420
   421*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   422     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   423*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   424     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   425
   426     12  ERPNDB-ALT-KEY.
   427         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   428         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   429         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   430         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   431         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   432         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   433         16  ERPNDB-CERT-NO.
   434             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   435             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   436         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   437         16  ERPNDB-RECORD-TYPE      PIC X.
   438
   439      12  ERPNDB-CSR-KEY.
   440          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   441          20  ERPNDB-CSR-ID                PIC X(4).
   442          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   443          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   444          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  10
* EL6311.cbl
   445
   446     12  ERNOTE-KEY.
   447         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   448         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   449         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   450         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   451         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   452         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   453         16  ERNOTE-CERT-NO.
   454             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   455             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   456         16  ernote-record-type      pic x        value spaces.
   457
   458     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   459     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   460
   461     12  ERCNOT-KEY.
   462         16  ERCNOT-PART-KEY.
   463             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   464             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   465             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   466             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   467             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   468             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   469             20  ERCNOT-CERT-NO.
   470                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   471                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   472         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   473         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   474
   475     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   476     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   477
   478     12  ERMAIL-KEY.
   479         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   480         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   481         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   482         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   483         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   484         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   485         16  ERMAIL-CERT-NO.
   486             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   487             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   488
   489     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   490     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   491
   492     12  ERRQST-KEY.
   493         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   494         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   495
   496     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   497     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   498
   499     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   500
   501     12  ERLOFC-KEY.
   502         16  ERLOFC-COMPANY-CD          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  11
* EL6311.cbl
   503         16  ERLOFC-CARRIER             PIC  X.
   504         16  ERLOFC-GROUPING            PIC  X(6).
   505         16  ERLOFC-STATE               PIC  XX.
   506         16  ERLOFC-ACCOUNT             PIC  X(10).
   507         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   508*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   509
   510     12  ERACCT-KEY.
   511         16  ERACCT-COMPANY-CD          PIC  X.
   512         16  ERACCT-CARRIER             PIC  X.
   513         16  ERACCT-GROUPING            PIC  X(6).
   514         16  ERACCT-STATE               PIC  XX.
   515         16  ERACCT-ACCOUNT             PIC  X(10).
   516         16  ERACCT-EXP-DT.
   517             20  ERACCT-DT              PIC  XX.
   518             20  ERACCT-FILL            PIC  X(4).
   519     12  ERACNT-KEY.
   520         16  ERACNT-COMPANY-CD          PIC  X.
   521         16  ERACNT-CARRIER             PIC  X.
   522         16  ERACNT-GROUPING            PIC  X(6).
   523         16  ERACNT-STATE               PIC  XX.
   524         16  ERACNT-ACCOUNT             PIC  X(10).
   525         16  ERACNT-REC-TYPE            PIC  X.
   526         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   527     12  ERENDT-KEY.
   528         16  ENDT-COMPANY-CD       PIC X.
   529         16  ENDT-CARRIER          PIC X.
   530         16  ENDT-GROUPING         PIC X(6).
   531         16  ENDT-STATE            PIC XX.
   532         16  ENDT-ACCOUNT          PIC X(10).
   533         16  ENDT-CERT-EFF-DT      PIC XX.
   534         16  ENDT-CERT-PRIME       PIC X(10).
   535         16  ENDT-CERT-SFX         PIC X.
   536         16  ENDT-RECORD-TYPE      PIC X.
   537         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   538
   539 01  WS-ELMSTR-WORK.
   540     12  ELMSTR-KEY.
   541         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   542         16  MSTR-CERT-NO.
   543             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   544             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   545     12  W-CLAIM-KEY.
   546         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   547         16  W-CL-CERT-NO.
   548             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   549             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   550      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   551 01  EL055-PASS-AREA.
   552     05  PA-CURRENT-KEY          PIC X(11).
   553     05  PA-NEW-ALT-KEY          PIC X(36).
   554     05  PA-RETURN-AREA.
   555         10  ra-status-code      pic 9(4).
   556         10  ra-message          pic x(205).
   557 01  CANCEL-GEN-PASS-AREA.
   558     05  CG-OPTION-CODE          PIC X.
   559         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   560         88  CG-FLAT-CANCEL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  12
* EL6311.cbl
   561         88  CG-CANCEL             VALUE '2'.
   562         88  CG-CANCEL-REISSUE     VALUE '3'.
   563     05  CG-ERROR-CODE           PIC 99.
   564         88  CG-SUCCESS            VALUE 00.
   565         88  CG-DATE-ERROR         VALUE 01.
   566         88  CG-CERT-NOT-FOUND     VALUE 02.
   567         88  CG-AMOUNT-ERROR       VALUE 04.
   568         88  CG-OPTION-ERROR       VALUE 05.
   569         88  CG-PREV-CAN           VALUE 06.
   570         88  CG-INVALID-DATA       VALUE 07.
   571         88  CG-NO-ACCT-MSTR       VALUE 08.
   572         88  CG-SFX-A-EXIST        VALUE 09.
   573         88  CG-MISC-ERROR         VALUE 99.
   574     05  CG-COMPANY-ID           PIC XXX.
   575     05  CG-PROC-ID              PIC XXXX.
   576     05  CG-CURRENT-DT           PIC XX.
   577     05  CG-MONTH-END-DT         PIC XX.
   578     05  CG-CERT-KEY.
   579         10  CG-CERT-COMPANY-CD  PIC X.
   580         10  CG-CERT-CARRIER     PIC X.
   581         10  CG-CERT-GROUP       PIC X(6).
   582         10  CG-CERT-STATE       PIC XX.
   583         10  CG-CERT-ACCOUNT     PIC X(10).
   584         10  CG-CERT-EFF-DT      PIC XX.
   585         10  CG-CERT-CERT-NO     PIC X(11).
   586     05  CG-LF-CAN-DATA.
   587         10  CG-LF-CAN-DT        PIC XX.
   588         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   589     05  CG-AH-CAN-DATA.
   590         10  CG-AH-CAN-DT        PIC XX.
   591         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   592     05  CG-CERT-PROFILE-DATA.
   593         10  CG-INS-LNAME        PIC X(15).
   594         10  CG-INS-FNAME        PIC X(10).
   595         10  CG-INS-MID-INIT     PIC X.
   596         10  CG-INS-AGE          PIC 99.
   597         10  CG-JNT-LNAME        PIC X(15).
   598         10  CG-JNT-FNAME        PIC X(10).
   599         10  CG-JNT-MID-INIT     PIC X.
   600         10  CG-JNT-AGE          PIC 99.
   601     05  CG-LF-ISS-DATA.
   602         10  CG-LF-BENCD         PIC XX.
   603         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   604         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   605     05  CG-AH-ISS-DATA.
   606         10  CG-AH-BENCD         PIC XX.
   607         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   608     05  CG-BATCH-NO             PIC X(6).
   609     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   610     05  FILLER                  PIC X(306).
   611******************************************************************
   612*                                                                *
   613*            G E N E R A L   W O R K   A R E A                   *
   614*                                                                *
   615******************************************************************
   616
   617 01  WORK-AREA.
   618     12  WS-RESPONSE             PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  13
* EL6311.cbl
   619         88  RESP-NORMAL           VALUE +0.
   620         88  resp-file-notfnd      value +12.
   621         88  RESP-NOTFND           VALUE +13.
   622         88  resp-duprec           value +14.
   623         88  resp-dupkey           value +15.
   624         88  resp-invreq           value +16.
   625         88  RESP-NOTOPEN          VALUE +19.
   626         88  RESP-ENDFILE          VALUE +20.
   627         88  resp-lengtherr        value +22.
   628     12  DEEDIT-FIELD            PIC X(15).
   629     12  FILLER          REDEFINES DEEDIT-FIELD.
   630         16  FILLER              PIC X(4).
   631         16  DEEDIT-FIELD-X11    PIC X(11).
   632     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   633                                 PIC S9(15).
   634     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   635                                 PIC S9(13)V99.
   636     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   637                                 PIC S9(11)V9999.
   638     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   639     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   640     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   641         16  WS-CALC-TERM-WHOLE  PIC S999.
   642         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   643
   644     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   645     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   646         16  WS-HR-MINS          PIC 99V99.
   647         16  FILLER              PIC XX.
   648
   649     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   650     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   651
   652     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   653     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   654
   655     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   656     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   657     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   658     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   659     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   660     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   661     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   662
   663     12  QID.
   664         16  QID-TERM            PIC X(4).
   665         16  FILLER              PIC X(4)    VALUE '607B'.
   666
   667     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   668         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   669
   670     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   671         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   672
   673     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   674         88 WS-MODE-CODE-VALID     VALUE ' '
   675                                         'W'     *> Weekly
   676                                         'B'     *> Bi-weekly
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  14
* EL6311.cbl
   677                                         'S'     *> Semi-monthly
   678                                         'M'     *> Monthly (Def)
   679                                         'Q'     *> Quarterly
   680                                         'N'     *> Bi-Monthly??
   681                                         'T'     *> Semi-annual
   682                                         'A'.    *> Annual Pay
   683
   684     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   685
   686     12  WS-NUMERIC-SW           PIC X.
   687        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   688
   689     12  WS-EDIT-CSO-FIELD.
   690         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   691                                 PIC X.
   692     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   693     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   694        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   695        88  CALLED-FROM-6315          VALUE '5'.
   696
   697     12  WS-SAVE-INPUT-FIELDS.
   698         16  WS-BAGE             PIC 99       VALUE ZERO.
   699*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   700         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   701         16  FILLER REDEFINES WS-BAPR.
   702             20  WS-APR-WHOLE-NUM    PIC 99.
   703             20  WS-APR-DEC          PIC 9999.
   704         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   705         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   706
   707         16  WS-B-COVERAGE OCCURS 2 TIMES.
   708             20  WS-TERM-IN-DAYS-SW  PIC X.
   709                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   710             20  WS-BTERM        PIC 999       COMP-3.
   711             20  WS-BALT-TERM    PIC 999       COMP-3.
   712             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   713             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   714             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   715             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   716             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   717             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   718
   719         16  WS-C-FIELDS COMP-3.
   720             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   721             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   722             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   723
   724         16  WS-D-FIELDS COMP-3.
   725             20  WS-DRISS        PIC S9(5)    VALUE +0.
   726             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   727             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   728             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   729             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   730             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   731
   732     12  WS-SAVE-BIRTH-DATE.
   733         16  FILLER              PIC X(4)   VALUE SPACES.
   734         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  15
* EL6311.cbl
   735
   736     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   737     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   738     12  FILLER REDEFINES WS-WORK-BIN-RED.
   739         16  FILLER              PIC X(02).
   740         16  WS-WORK-BIN-DT      PIC X(02).
   741     12  WS-SW-1                 PIC X     VALUE SPACE.
   742     12  WS-SW-2                 PIC X     VALUE SPACE.
   743     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   744         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   745     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   746         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   747
   748     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   749     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   750     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   751     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   752     12  WS-CONVERTED-CANCEL-DATES.
   753         16  WS-CONVERTED-CANDT1                  PIC XX.
   754         16  WS-CONVERTED-CANDT2                  PIC XX.
   755
   756     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   757
   758     12  WS-REC-FOUND-SW         PIC X.
   759         88  RECORD-NOT-FOUND    VALUE 'N'.
   760
   761     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   762         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   763         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   764
   765     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   766         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   767         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   768
   769     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   770         88  BROWSE-STARTED      VALUE 'Y'.
   771
   772     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   773         88  FIRST-TIME          VALUE 'Y'.
   774
   775     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   776         88  FIRST-ENTRY         VALUE 'Y'.
   777
   778     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   779         88  REC-BILLED          VALUE 'Y'.
   780
   781     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   782         88  NO-CURSOR-SET       VALUE +0.
   783         88  CURSOR-SET          VALUE +1.
   784
   785     12  WS-ERR-SW               PIC X.
   786         88  STD-ERRORS          VALUE 'S'.
   787         88  TRN-ERRORS          VALUE 'T'.
   788
   789     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   790         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   791
   792     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  16
* EL6311.cbl
   793         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   794
   795     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   796         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   797
   798     12  WS-ERR-CODE.
   799         16  FILLER              PIC 99.
   800         16  WS-ERROR-SUB        PIC 99.
   801
   802     12  WS-DATE-WORK.
   803         16  WS-WORK-MM          PIC XX.
   804         16  WS-WORK-DD          PIC XX.
   805         16  WS-WORK-YY          PIC XX.
   806
   807     12  WS-MM-YY.
   808         16  WS-MM               PIC XX.
   809         16  FILLER              PIC X     VALUE '/'.
   810         16  WS-YY               PIC XX.
   811
   812     12  WS-CERT-EFF-DT          PIC XX.
   813
   814     12  WS-MEMBER-NO            PIC X(12).
   815     12  FILLER  REDEFINES  WS-MEMBER-NO.
   816         16  WS-MEMBER-NO-1-8    PIC 9(8).
   817         16  FILLER              PIC X(4).
   818
   819     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   820
   821     12  WS-ERPNDB-ALT-KEY.
   822         16  WS-PB-COMPANY-CD-A1         PIC X.
   823         16  WS-PB-CARRIER               PIC X.
   824         16  WS-PB-GROUPING              PIC X(6).
   825         16  WS-PB-STATE                 PIC XX.
   826         16  WS-PB-ACCOUNT               PIC X(10).
   827         16  WS-PB-CERT-EFF-DT           PIC XX.
   828         16  WS-PB-CERT-NO.
   829             20  WS-PB-CERT-PRIME        PIC X(10).
   830             20  WS-PB-CERT-SFX          PIC X.
   831         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   832         16  WS-PB-RECORD-TYPE           PIC X.
   833
   834     12  WS-SHOW-SAVE-AREAS.
   835         16  WS-NEW-CERT-NO.
   836             20  WS-NEW-PRIME    PIC X(10).
   837             20  WS-NEW-SUFFIX   PIC X.
   838         16  WS-NEW-CERT-EFF-DT  PIC XX.
   839         16  WS-NEW-RECORD-TYPE  PIC X.
   840         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   841             88   SHOW-RECORD            VALUE 'Y'.
   842
   843     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   844
   845     12  WS-BATCH-NO.
   846         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   847         16  FILLER              PIC X(5) VALUE SPACES.
   848
   849     12  WS-FIRST-NAME.
   850         16  WS-1ST-INIT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  17
* EL6311.cbl
   851         16  FILLER              PIC X(9).
   852
   853     12  WS-INITIALS.
   854         16  WS-INITIAL-1        PIC X.
   855         16  WS-INITIAL-2        PIC X.
   856
   857     12  WS-C-HDG.
   858         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   859         16  FILLER              PIC X(4) VALUE '-REF'.
   860
   861     12  WS-D-PREM-HDG.
   862         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   863         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   864
   865     12  WS-D-REFUND-HDG.
   866         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   867         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   868
   869     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   870
   871     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   872     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   873     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   874     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   875     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   876     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   877     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   878
   879     12  WS-01-CANCEL-ERR        PIC X(25)
   880         VALUE 'CANCEL DATE ERROR'.
   881     12  WS-02-CANCEL-ERR        PIC X(25)
   882         VALUE 'CERT NOT FOUND'.
   883     12  WS-04-CANCEL-ERR        PIC X(25)
   884         VALUE 'CANCEL AMOUNT ERROR'.
   885     12  WS-05-CANCEL-ERR        PIC X(25)
   886         VALUE 'CANCEL OPTION ERROR'.
   887     12  WS-06-CANCEL-ERR        PIC X(25)
   888         VALUE 'PREVIOUSLY CANCELLED'.
   889     12  WS-07-CANCEL-ERR        PIC X(25)
   890         VALUE 'INVALID DATA'.
   891     12  WS-08-CANCEL-ERR        PIC X(25)
   892         VALUE 'NO ACCOUNT MASTER'.
   893     12  WS-09-CANCEL-ERR        PIC X(25)
   894         VALUE 'SUFFIX ALREADY EXISTS'.
   895     12  WS-99-CANCEL-ERR        PIC X(25)
   896         VALUE 'MISC CANCEL ERROR'.
   897
   898     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   899     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   900
   901     12  WS-AGE-FIELDS.
   902         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   903         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   904         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   905         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   906
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  18
* EL6311.cbl
   908
   909******************************************************************
   910*                                                                *
   911*                 B A T C H   T O T A L S                        *
   912*                                                                *
   913******************************************************************
   914
   915     12  WS-BATCH-RECORD.
   916         16  FILLER                       PIC X(10).
   917         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   918         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   919         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   920         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   921         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   922         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   923         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   924         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   925         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   926         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   927         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   928         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   929         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   930         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   931         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   932         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   933         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   934         16  WS-ACCOUNT-NAME              PIC X(30).
   935         16  FILLER                       PIC X.
   936         16  WS-REFERENCE                 PIC X(12).
   937         16  FILLER                       PIC X(197).
   938
   939     12  WS-BATCH-TOTALS.
   940         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   941         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   945         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   946         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   947         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   948         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   949         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   950         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   951         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   952         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   953         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   954         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   955         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   956         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   957         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   958         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   959
   960     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   961
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  19
* EL6311.cbl
   963
   964******************************************************************
   965*                                                                *
   966*                E R R O R   M E S S A G E S                     *
   967*                                                                *
   968******************************************************************
   969
   970 01  ERROR-MESSAGES.
   971     12  ER-0004                 PIC  9(4) VALUE 0004.
   972     12  ER-0008                 PIC  9(4) VALUE 0008.
   973     12  ER-0023                 PIC  9(4) VALUE 0023.
   974     12  ER-0029                 PIC  9(4) VALUE 0029.
   975     12  ER-0033                 PIC  9(4) VALUE 0033.
   976     12  ER-0070                 PIC  9(4) VALUE 0070.
   977     12  ER-0220                 PIC  9(4) VALUE 0220.
   978     12  er-0229                 pic  9(4) value 0229.
   979     12  ER-0248                 PIC  9(4) VALUE 0248.
   980     12  ER-0280                 PIC  9(4) VALUE 0280.
   981     12  ER-0348                 PIC  9(4) VALUE 0348.
   982     12  ER-0582                 PIC  9(4) VALUE 0582.
   983     12  ER-0877                 PIC  9(4) VALUE 0877.
   984     12  ER-1236                 PIC  9(4) VALUE 1236.
   985     12  ER-1570                 PIC  9(4) VALUE 1570.
   986     12  ER-1575                 PIC  9(4) VALUE 1575.
   987     12  ER-1577                 PIC  9(4) VALUE 1577.
   988     12  ER-1584                 PIC  9(4) VALUE 1584.
   989     12  ER-1585                 PIC  9(4) VALUE 1585.
   990     12  ER-1609                 PIC  9(4) VALUE 1609.
   991     12  er-1762                 pic  9(4) value 1762.
   992     12  ER-1819                 PIC  9(4) VALUE 1819.
   993     12  ER-2077                 PIC  9(4) VALUE 2077.
   994     12  ER-2129                 PIC  9(4) VALUE 2129.
   995     12  ER-2188                 PIC  9(4) VALUE 2188.
   996     12  ER-2192                 PIC  9(4) VALUE 2192.
   997     12  ER-2196                 PIC  9(4) VALUE 2196.
   998     12  ER-2197                 PIC  9(4) VALUE 2197.
   999     12  ER-2198                 PIC  9(4) VALUE 2198.
  1000     12  ER-2200                 PIC  9(4) VALUE 2200.
  1001     12  ER-2212                 PIC  9(4) VALUE 2212.
  1002     12  ER-2218                 PIC  9(4) VALUE 2218.
  1003     12  ER-2220                 PIC  9(4) VALUE 2220.
  1004     12  ER-2222                 PIC  9(4) VALUE 2222.
  1005     12  ER-2223                 PIC  9(4) VALUE 2223.
  1006     12  ER-2224                 PIC  9(4) VALUE 2224.
  1007     12  ER-2225                 PIC  9(4) VALUE 2225.
  1008     12  ER-2226                 PIC  9(4) VALUE 2226.
  1009     12  ER-2227                 PIC  9(4) VALUE 2227.
  1010     12  ER-2228                 PIC  9(4) VALUE 2228.
  1011     12  ER-2240                 PIC  9(4) VALUE 2240.
  1012     12  ER-2241                 PIC  9(4) VALUE 2241.
  1013     12  ER-2242                 PIC  9(4) VALUE 2242.
  1014     12  ER-2243                 PIC  9(4) VALUE 2243.
  1015     12  ER-2244                 PIC  9(4) VALUE 2244.
  1016     12  ER-2245                 PIC  9(4) VALUE 2245.
  1017     12  ER-2246                 PIC  9(4) VALUE 2246.
  1018     12  ER-2247                 PIC  9(4) VALUE 2247.
  1019     12  ER-2251                 PIC  9(4) VALUE 2251.
  1020     12  ER-2252                 PIC  9(4) VALUE 2252.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  20
* EL6311.cbl
  1021     12  ER-2253                 PIC  9(4) VALUE 2253.
  1022     12  ER-2254                 PIC  9(4) VALUE 2254.
  1023     12  ER-2255                 PIC  9(4) VALUE 2255.
  1024     12  ER-2256                 PIC  9(4) VALUE 2256.
  1025     12  ER-2257                 PIC  9(4) VALUE 2257.
  1026     12  ER-2258                 PIC  9(4) VALUE 2258.
  1027     12  ER-2259                 PIC  9(4) VALUE 2259.
  1028     12  ER-2260                 PIC  9(4) VALUE 2260.
  1029     12  ER-2261                 PIC  9(4) VALUE 2261.
  1030     12  ER-2287                 PIC  9(4) VALUE 2287.
  1031     12  ER-2336                 PIC  9(4) VALUE 2336.
  1032     12  ER-2337                 PIC  9(4) VALUE 2337.
  1033     12  ER-2437                 PIC  9(4) VALUE 2437.
  1034     12  ER-2471                 PIC  9(4) VALUE 2471.
  1035     12  ER-2530                 PIC  9(4) VALUE 2530.
  1036     12  ER-2531                 PIC  9(4) VALUE 2531.
  1037     12  ER-2532                 PIC  9(4) VALUE 2532.
  1038     12  ER-2533                 PIC  9(4) VALUE 2533.
  1039     12  ER-2547                 PIC  9(4) VALUE 2547.
  1040     12  ER-2591                 PIC  9(4) VALUE 2591.
  1041     12  ER-2592                 PIC  9(4) VALUE 2592.
  1042     12  ER-2593                 PIC  9(4) VALUE 2593.
  1043     12  ER-2600                 PIC  9(4) VALUE 2600.
  1044     12  ER-2601                 PIC  9(4) VALUE 2601.
  1045     12  ER-2604                 PIC  9(4) VALUE 2604.
  1046     12  ER-2605                 PIC  9(4) VALUE 2605.
  1047     12  ER-2606                 PIC  9(4) VALUE 2606.
  1048     12  ER-2607                 PIC  9(4) VALUE 2607.
  1049     12  ER-2622                 PIC  9(4) VALUE 2622.
  1050     12  ER-2625                 PIC  9(4) VALUE 2625.
  1051     12  ER-2626                 PIC  9(4) VALUE 2626.
  1052     12  ER-2627                 PIC  9(4) VALUE 2627.
  1053     12  ER-2628                 PIC  9(4) VALUE 2628.
  1054     12  ER-2629                 PIC  9(4) VALUE 2629.
  1055     12  ER-2630                 PIC  9(4) VALUE 2630.
  1056     12  ER-2631                 PIC  9(4) VALUE 2631.
  1057     12  ER-2632                 PIC  9(4) VALUE 2632.
  1058     12  ER-2633                 PIC  9(4) VALUE 2633.
  1059     12  ER-2634                 PIC  9(4) VALUE 2634.
  1060     12  ER-2635                 PIC  9(4) VALUE 2635.
  1061     12  ER-2636                 PIC  9(4) VALUE 2636.
  1062     12  ER-2639                 PIC  9(4) VALUE 2639.
  1063     12  ER-2640                 PIC  9(4) VALUE 2640.
  1064     12  ER-2647                 PIC  9(4) VALUE 2647.
  1065     12  ER-2648                 PIC  9(4) VALUE 2648.
  1066     12  ER-2649                 PIC  9(4) VALUE 2649.
  1067     12  ER-2650                 PIC  9(4) VALUE 2650.
  1068     12  ER-2651                 PIC  9(4) VALUE 2651.
  1069     12  ER-2653                 PIC  9(4) VALUE 2653.
  1070     12  ER-2654                 PIC  9(4) VALUE 2654.
  1071     12  ER-2655                 PIC  9(4) VALUE 2655.
  1072     12  ER-2656                 PIC  9(4) VALUE 2656.
  1073     12  ER-2657                 PIC  9(4) VALUE 2657.
  1074     12  ER-2660                 PIC  9(4) VALUE 2660.
  1075     12  ER-2661                 PIC  9(4) VALUE 2661.
  1076     12  ER-2662                 PIC  9(4) VALUE 2662.
  1077     12  ER-2663                 PIC  9(4) VALUE 2663.
  1078     12  ER-2664                 PIC  9(4) VALUE 2664.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  21
* EL6311.cbl
  1079     12  ER-2667                 PIC  9(4) VALUE 2667.
  1080     12  ER-2668                 PIC  9(4) VALUE 2668.
  1081     12  ER-2669                 PIC  9(4) VALUE 2669.
  1082     12  ER-2670                 PIC  9(4) VALUE 2670.
  1083     12  ER-2671                 PIC  9(4) VALUE 2671.
  1084     12  ER-2672                 PIC  9(4) VALUE 2672.
  1085     12  ER-2673                 PIC  9(4) VALUE 2673.
  1086     12  ER-2677                 PIC  9(4) VALUE 2677.
  1087     12  ER-2678                 PIC  9(4) VALUE 2678.
  1088     12  ER-2679                 PIC  9(4) VALUE 2679.
  1089     12  ER-2680                 PIC  9(4) VALUE 2680.
  1090     12  ER-2681                 PIC  9(4) VALUE 2681.
  1091     12  ER-2682                 PIC  9(4) VALUE 2682.
  1092     12  ER-2683                 PIC  9(4) VALUE 2683.
  1093     12  ER-2684                 PIC  9(4) VALUE 2684.
  1094     12  ER-2686                 PIC  9(4) VALUE 2686.
  1095     12  ER-2689                 PIC  9(4) VALUE 2689.
  1096     12  ER-2690                 PIC  9(4) VALUE 2690.
  1097     12  ER-2693                 PIC  9(4) VALUE 2693.
  1098     12  ER-2695                 PIC  9(4) VALUE 2695.
  1099     12  ER-2701                 PIC  9(4) VALUE 2701.
  1100     12  ER-2720                 PIC  9(4) VALUE 2720.
  1101     12  ER-2709                 PIC  9(4) VALUE 2709.
  1102     12  ER-2704                 PIC  9(4) VALUE 2704.
  1103     12  ER-2725                 PIC  9(4) VALUE 2725.
  1104     12  ER-2726                 PIC  9(4) VALUE 2726.
  1105     12  ER-2728                 PIC  9(4) VALUE 2728.
  1106     12  ER-2729                 PIC  9(4) VALUE 2729.
  1107     12  ER-2731                 PIC  9(4) VALUE 2731.
  1108     12  ER-2732                 PIC  9(4) VALUE 2732.
  1109     12  ER-2733                 PIC  9(4) VALUE 2733.
  1110     12  ER-2735                 PIC  9(4) VALUE 2735.
  1111     12  ER-2738                 PIC  9(4) VALUE 2738.
  1112     12  ER-2742                 PIC  9(4) VALUE 2742.
  1113     12  ER-2743                 PIC  9(4) VALUE 2743.
  1114     12  ER-2744                 PIC  9(4) VALUE 2744.
  1115     12  ER-2747                 PIC  9(4) VALUE 2747.
  1116     12  ER-2749                 PIC  9(4) VALUE 2749.
  1117     12  ER-2753                 PIC  9(4) VALUE 2753.
  1118     12  ER-2755                 PIC  9(4) VALUE 2755.
  1119     12  ER-2757                 PIC  9(4) VALUE 2757.
  1120     12  ER-2771                 PIC  9(4) VALUE 2771.
  1121     12  ER-2774                 PIC  9(4) VALUE 2774.
  1122     12  ER-2775                 PIC  9(4) VALUE 2775.
  1123     12  ER-2776                 PIC  9(4) VALUE 2776.
  1124     12  ER-2777                 PIC  9(4) VALUE 2777.
  1125     12  ER-2794                 PIC  9(4) VALUE 2794.
  1126     12  ER-2799                 PIC  9(4) VALUE 2799.
  1127     12  er-2878                 pic  9(4) value 2878.
  1128     12  ER-2900                 PIC  9(4) VALUE 2900.
  1129     12  ER-2902                 PIC  9(4) VALUE 2902.
  1130     12  ER-2945                 PIC  9(4) VALUE 2945.
  1131     12  ER-3000                 PIC  9(4) VALUE 3000.
  1132     12  ER-3006                 PIC  9(4) VALUE 3006.
  1133     12  ER-3054                 PIC  9(4) VALUE 3054.
  1134     12  er-3070                 pic  9(4) value 3070.
  1135     12  ER-3224                 PIC  9(4) VALUE 3224.
  1136     12  ER-3269                 PIC  9(4) VALUE 3269.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  22
* EL6311.cbl
  1137     12  er-3444                 pic  9(4) value 3444.
  1138     12  er-3446                 pic  9(4) value 3446.
  1139     12  er-3447                 pic  9(4) value 3447.
  1140     12  er-3448                 pic  9(4) value 3448.
  1141     12  er-3449                 pic  9(4) value 3449.
  1142     12  ER-3456                 PIC  9(4) VALUE 3456.
  1143     12  ER-3457                 PIC  9(4) VALUE 3457.
  1144     12  ER-3458                 PIC  9(4) VALUE 3458.
  1145     12  ER-3504                 PIC  9(4) VALUE 3504.
  1146     12  ER-3513                 PIC  9(4) VALUE 3513.
  1147     12  ER-3831                 PIC  9(4) VALUE 3831.
  1148     12  ER-3834                 PIC  9(4) VALUE 3834.
  1149     12  ER-3835                 PIC  9(4) VALUE 3835.
  1150     12  ER-4005                 PIC  9(4) VALUE 4005.
  1151     12  ER-7144                 PIC  9(4) VALUE 7144.
  1152     12  ER-7401                 PIC  9(4) VALUE 7401.
  1153     12  ER-7402                 PIC  9(4) VALUE 7402.
  1154     12  ER-7403                 PIC  9(4) VALUE 7403.
  1155     12  ER-7404                 PIC  9(4) VALUE 7404.
  1156     12  ER-7423                 PIC  9(4) VALUE 7423.
  1157     12  ER-7424                 PIC  9(4) VALUE 7424.
  1158     12  ER-7433                 PIC  9(4) VALUE 7433.
  1159     12  ER-7450                 PIC  9(4) VALUE 7450.
  1160     12  ER-7451                 PIC  9(4) VALUE 7451.
  1161     12  ER-7530                 PIC  9(4) VALUE 7530.
  1162     12  ER-7573                 PIC  9(4) VALUE 7573.
  1163     12  ER-7631                 PIC  9(4) VALUE 7631.
  1164     12  ER-7632                 PIC  9(4) VALUE 7632.
  1165     12  ER-7633                 PIC  9(4) VALUE 7633.
  1166     12  ER-7537                 PIC  9(4) VALUE 7537.
  1167     12  ER-7538                 PIC  9(4) VALUE 7538.
  1168     12  ER-7574                 PIC  9(4) VALUE 7574.
  1169     12  ER-7997                 PIC  9(4) VALUE 7997.
  1170     12  ER-7998                 PIC  9(4) VALUE 7998.
  1171     12  ER-8148                 PIC  9(4) VALUE 8148.
  1172     12  ER-9063                 PIC  9(4) VALUE 9063.
  1173     12  ER-9076                 PIC  9(4) VALUE 9076.
  1174     12  ER-9618                 PIC  9(4) VALUE 9618.
  1175     12  ER-9841                 PIC  9(4) VALUE 9841.
  1176     12  er-9853                 pic  9(4) value 9853.
  1177
  1178*                                COPY ELCTEXT.
  1179******************************************************************
  1180*                                                                *
  1181*                                                                *
  1182*                            ELCTEXT.                            *
  1183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1184*                            VMOD=2.008                          *
  1185*                                                                *
  1186*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1187*                                     FORM LETTERS,              *
  1188*                                     CERT FORM DISPLAY.
  1189*                                                                *
  1190*   FILE TYPE = VSAM,KSDS                                        *
  1191*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1192*                                                                *
  1193*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1194*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  23
* EL6311.cbl
  1195*                                                                *
  1196*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1197*       ALTERNATE INDEX = NONE                                   *
  1198*                                                                *
  1199*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1200*       ALTERNATE INDEX = NONE                                   *
  1201*                                                                *
  1202*   LOG = NO                                                     *
  1203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1204******************************************************************
  1205 01  TEXT-FILES.
  1206     12  TEXT-FILE-ID                PIC XX.
  1207         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1208         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1209         88  HELP-FILE-TEXT             VALUE 'TH'.
  1210
  1211     12  TX-CONTROL-PRIMARY.
  1212         16  TX-COMPANY-CD           PIC X.
  1213             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1214         16  TX-ACCESS-CD-GENL       PIC X(12).
  1215
  1216         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1217             20  TX-LETTER-NO        PIC X(4).
  1218             20  FILLER              PIC X(8).
  1219
  1220         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1221             20  TX-FORM-NO          PIC X(12).
  1222
  1223         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1224             20  TX-HELP-TYPE        PIC X.
  1225                 88  HELP-FOR-GENERAL   VALUE ' '.
  1226                 88  HELP-BY-SCREEN     VALUE 'S'.
  1227                 88  HELP-BY-ERROR      VALUE 'E'.
  1228             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1229                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1230             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1231                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1232             20  FILLER              PIC X(4).
  1233
  1234         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1235
  1236     12  TX-PROCESS-CONTROL          PIC XX.
  1237         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1238
  1239     12  TX-TEXT-LINE                PIC X(70).
  1240
  1241     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1242         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1243         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1244         88  TX-VALID-FORM-SQUEEZE-VALUE
  1245                                        VALUE 'Y' ' '.
  1246
  1247     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1248         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1249         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1250         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1251         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1252         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  24
* EL6311.cbl
  1253         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1254         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1255                                              'K' 'N' ' '
  1256                                              'Z'.
  1257
  1258     12  TX-ARCHIVE-SW               PIC X.
  1259         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1260         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1261         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1262
  1263     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1264     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1265
  1266     12  TX-BSR-CODE                 PIC X.
  1267         88  TX-BSR-LETTER              VALUE 'B'.
  1268         88  TX-NON-BSR-LETTER          VALUE ' '.
  1269
  1270     12  FILLER                      PIC X.
  1271*****************************************************************
  1272*                                COPY ELCCRTO.
  1273******************************************************************
  1274*                                                                *
  1275*                            ELCCRTO.                            *
  1276*                                                                *
  1277*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1278*                                                                *
  1279*   FILE TYPE = VSAM,KSDS                                        *
  1280*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1281*                                                                *
  1282*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1283*                                                                *
  1284*   LOG = YES                                                    *
  1285*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1286******************************************************************
  1287*                   C H A N G E   L O G
  1288*
  1289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1290*-----------------------------------------------------------------
  1291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1292* EFFECTIVE    NUMBER
  1293*-----------------------------------------------------------------
  1294* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1295* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1296* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1297* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1298* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1299******************************************************************
  1300 01  ORIGINAL-CERTIFICATE.
  1301     12  OC-RECORD-ID                      PIC XX.
  1302         88  VALID-OC-ID                      VALUE 'OC'.
  1303     12  OC-CONTROL-PRIMARY.
  1304         16  OC-COMPANY-CD                 PIC X.
  1305         16  OC-CARRIER                    PIC X.
  1306         16  OC-GROUPING                   PIC X(6).
  1307         16  OC-STATE                      PIC XX.
  1308         16  OC-ACCOUNT                    PIC X(10).
  1309         16  OC-CERT-EFF-DT                PIC XX.
  1310         16  OC-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  25
* EL6311.cbl
  1311             20  OC-CERT-PRIME             PIC X(10).
  1312             20  OC-CERT-SFX               PIC X.
  1313         16  OC-RECORD-TYPE                PIC X.
  1314         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1315     12  OC-LAST-MAINT-DT                  PIC XX.
  1316     12  OC-LAST-MAINT-BY                  PIC X(4).
  1317     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1318     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1319     12  FILLER                            PIC X(49).
  1320     12  OC-ORIG-REC.
  1321         16  OC-INS-LAST-NAME              PIC X(15).
  1322         16  OC-INS-FIRST-NAME             PIC X(10).
  1323         16  OC-INS-MIDDLE-INIT            PIC X.
  1324         16  OC-INS-AGE                    PIC S999     COMP-3.
  1325         16  OC-JNT-LAST-NAME              PIC X(15).
  1326         16  OC-JNT-FIRST-NAME             PIC X(10).
  1327         16  OC-JNT-MIDDLE-INIT            PIC X.
  1328         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1329         16  OC-LF-BENCD                   PIC XX.
  1330         16  OC-LF-TERM                    PIC S999      COMP-3.
  1331         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1332         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1333         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1334         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1335         16  OC-LF-EXP-DT                  PIC XX.
  1336         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1337         16  OC-LF-CANCEL-DT               PIC XX.
  1338         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1339         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1340         16  OC-AH-BENCD                   PIC XX.
  1341         16  OC-AH-TERM                    PIC S999      COMP-3.
  1342         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1343         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1344         16  OC-AH-EXP-DT                  PIC XX.
  1345         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1346         16  OC-AH-CP                      PIC 99.
  1347         16  OC-AH-CANCEL-DT               PIC XX.
  1348         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1349         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1350         16  OC-CRED-BENE-NAME             PIC X(25).
  1351         16  OC-1ST-PMT-DT                 PIC XX.
  1352         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1353         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1354         16  OC-ISSUE-TRAN-IND             PIC X.
  1355         16  OC-CANCEL-TRAN-IND            PIC X.
  1356         16  FILLER                        PIC X(211).
  1357
  1358     12  FILLER                            PIC X(50).
  1359******************************************************************
  1360*                                COPY ERCACCT.
  1361******************************************************************
  1362*                                                                *
  1363*                                                                *
  1364*                            ERCACCT                             *
  1365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1366*                            VMOD=2.031                          *
  1367*                                                                *
  1368*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  26
* EL6311.cbl
  1369*                                                                *
  1370*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1371*   VSAM ACCOUNT MASTER FILES.                                   *
  1372*                                                                *
  1373*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1374*                                                                *
  1375*   FILE TYPE = VSAM,KSDS                                        *
  1376*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1377*                                                                *
  1378*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1379*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1380*                                                                *
  1381*   LOG = NO                                                     *
  1382*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1383*                                                                *
  1384*                                                                *
  1385******************************************************************
  1386*                   C H A N G E   L O G
  1387*
  1388* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1389*-----------------------------------------------------------------
  1390*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1391* EFFECTIVE    NUMBER
  1392*-----------------------------------------------------------------
  1393* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1394* 092705    2005050300006  PEMA  ADD SPP LEASES
  1395* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1396* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1397* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1398* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1399* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1400* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1401******************************************************************
  1402
  1403 01  ACCOUNT-MASTER.
  1404     12  AM-RECORD-ID                      PIC XX.
  1405         88  VALID-AM-ID                      VALUE 'AM'.
  1406
  1407     12  AM-CONTROL-PRIMARY.
  1408         16  AM-COMPANY-CD                 PIC X.
  1409         16  AM-MSTR-CNTRL.
  1410             20  AM-CONTROL-A.
  1411                 24  AM-CARRIER            PIC X.
  1412                 24  AM-GROUPING.
  1413                     28 AM-GROUPING-PREFIX PIC XXX.
  1414                     28 AM-GROUPING-PRIME  PIC XXX.
  1415                 24  AM-STATE              PIC XX.
  1416                 24  AM-ACCOUNT.
  1417                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1418                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1419             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1420                                           PIC X(19).
  1421             20  AM-CNTRL-B.
  1422                 24  AM-EXPIRATION-DT      PIC XX.
  1423                 24  FILLER                PIC X(4).
  1424             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1425                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1426
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  27
* EL6311.cbl
  1427     12  AM-CONTROL-BY-VAR-GRP.
  1428         16  AM-COMPANY-CD-A1              PIC X.
  1429         16  AM-VG-CARRIER                 PIC X.
  1430         16  AM-VG-GROUPING                PIC X(6).
  1431         16  AM-VG-STATE                   PIC XX.
  1432         16  AM-VG-ACCOUNT                 PIC X(10).
  1433         16  AM-VG-DATE.
  1434             20  AM-VG-EXPIRATION-DT       PIC XX.
  1435             20  FILLER                    PIC X(4).
  1436         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1437                                           PIC 9(11)      COMP-3.
  1438     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1439         16  FILLER                        PIC X(10).
  1440         16  AM-VG-KEY3.
  1441             20  AM-VG3-ACCOUNT            PIC X(10).
  1442             20  AM-VG3-EXP-DT             PIC XX.
  1443         16  FILLER                        PIC X(4).
  1444     12  AM-MAINT-INFORMATION.
  1445         16  AM-LAST-MAINT-DT              PIC XX.
  1446         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1447         16  AM-LAST-MAINT-USER            PIC X(4).
  1448         16  FILLER                        PIC XX.
  1449
  1450     12  AM-EFFECTIVE-DT                   PIC XX.
  1451     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1452
  1453     12  AM-PREV-DATES  COMP-3.
  1454         16  AM-PREV-EXP-DT                PIC 9(11).
  1455         16  AM-PREV-EFF-DT                PIC 9(11).
  1456
  1457     12  AM-REPORT-CODE-1                  PIC X(10).
  1458     12  AM-REPORT-CODE-2                  PIC X(10).
  1459
  1460     12  AM-CITY-CODE                      PIC X(4).
  1461     12  AM-COUNTY-PARISH                  PIC X(6).
  1462
  1463     12  AM-NAME                           PIC X(30).
  1464     12  AM-PERSON                         PIC X(30).
  1465     12  AM-ADDRS                          PIC X(30).
  1466     12  AM-CITY.
  1467         16  AM-ADDR-CITY                  PIC X(28).
  1468         16  AM-ADDR-STATE                 PIC XX.
  1469     12  AM-ZIP.
  1470         16  AM-ZIP-PRIME.
  1471             20  AM-ZIP-PRI-1ST            PIC X.
  1472                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1473             20  FILLER                    PIC X(4).
  1474         16  AM-ZIP-PLUS4                  PIC X(4).
  1475     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1476         16  AM-CAN-POSTAL-1               PIC XXX.
  1477         16  AM-CAN-POSTAL-2               PIC XXX.
  1478         16  FILLER                        PIC XXX.
  1479     12  AM-TEL-NO.
  1480         16  AM-AREA-CODE                  PIC 999.
  1481         16  AM-TEL-PRE                    PIC 999.
  1482         16  AM-TEL-NBR                    PIC 9(4).
  1483     12  AM-TEL-LOC                        PIC X.
  1484         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  28
* EL6311.cbl
  1485         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1486
  1487     12  AM-COMM-STRUCTURE.
  1488         16  AM-DEFN-1.
  1489             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1490                 24  AM-AGT.
  1491                     28  AM-AGT-PREFIX     PIC X(4).
  1492                     28  AM-AGT-PRIME      PIC X(6).
  1493                 24  AM-COM-TYP            PIC X.
  1494                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1495                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1496                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1497                 24  AM-RECALC-LV-INDIC    PIC X.
  1498                 24  AM-RETRO-LV-INDIC     PIC X.
  1499                 24  AM-GL-CODES           PIC X.
  1500                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1501                 24  FILLER                PIC X(01).
  1502         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1503             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1504                 24  FILLER                PIC X(11).
  1505                 24  AM-L-COMA             PIC XXX.
  1506                 24  AM-J-COMA             PIC XXX.
  1507                 24  AM-A-COMA             PIC XXX.
  1508                 24  FILLER                PIC X(6).
  1509
  1510     12  AM-COMM-CHANGE-STATUS             PIC X.
  1511         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1512
  1513     12  AM-CSR-CODE                       PIC X(4).
  1514
  1515     12  AM-BILLING-STATUS                 PIC X.
  1516         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1517         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1518     12  AM-AUTO-REFUND-SW                 PIC X.
  1519         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1520         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1521     12  AM-GPCD                           PIC 99.
  1522     12  AM-IG                             PIC X.
  1523         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1524         88  AM-HAS-GROUP                     VALUE '2'.
  1525     12  AM-STATUS                         PIC X.
  1526         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1527         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1528         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1529         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1530         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1531         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1532         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1533         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1534         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1535         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1536     12  AM-REMIT-TO                       PIC 99.
  1537     12  AM-ID-NO                          PIC X(11).
  1538
  1539     12  AM-CAL-TABLE                      PIC XX.
  1540     12  AM-LF-DEVIATION                   PIC XXX.
  1541     12  AM-AH-DEVIATION                   PIC XXX.
  1542     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  29
* EL6311.cbl
  1543     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1544     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1545     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1546     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1547     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1548
  1549     12  AM-USER-FIELDS.
  1550         16  AM-FLD-1                      PIC XX.
  1551         16  AM-FLD-2                      PIC XX.
  1552         16  AM-FLD-3                      PIC XX.
  1553         16  AM-FLD-4                      PIC XX.
  1554         16  AM-FLD-5                      PIC XX.
  1555
  1556     12  AM-1ST-PROD-DATE.
  1557         16  AM-1ST-PROD-YR                PIC XX.
  1558         16  AM-1ST-PROD-MO                PIC XX.
  1559         16  AM-1ST-PROD-DA                PIC XX.
  1560     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1561     12  AM-CERTS-PURGED-DATE.
  1562         16  AM-PUR-YR                     PIC XX.
  1563         16  AM-PUR-MO                     PIC XX.
  1564         16  AM-PUR-DA                     PIC XX.
  1565     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1566     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1567     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1568     12  AM-INACTIVE-DATE.
  1569         16  AM-INA-MO                     PIC 99.
  1570         16  AM-INA-DA                     PIC 99.
  1571         16  AM-INA-YR                     PIC 99.
  1572     12  AM-AR-HI-CERT-DATE                PIC XX.
  1573
  1574     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1575     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1576
  1577     12  AM-OB-PAYMENT-MODE                PIC X.
  1578         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1579         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1580         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1581         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1582
  1583     12  AM-AH-ONLY-INDICATOR              PIC X.
  1584         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1585         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1586
  1587     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1588
  1589     12  AM-OVER-SHORT.
  1590         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1591         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1592
  1593     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1594     12  AM-DCC-CLP-STATE                  PIC XX.
  1595
  1596     12  AM-RECALC-COMM                    PIC X.
  1597     12  AM-RECALC-REIN                    PIC X.
  1598
  1599     12  AM-REI-TABLE                      PIC XXX.
  1600     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  30
* EL6311.cbl
  1601     12  AM-REI-ET-AH                      PIC X.
  1602     12  AM-REI-PE-LF                      PIC X.
  1603     12  AM-REI-PE-AH                      PIC X.
  1604     12  AM-REI-PRT-ST                     PIC X.
  1605     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1606     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1607     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1608     12  AM-REI-GROUP-A                    PIC X(6).
  1609     12  AM-REI-MORT                       PIC X(4).
  1610     12  AM-REI-PRT-OW                     PIC X.
  1611     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1612     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1613     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1614     12  AM-REI-GROUP-B                    PIC X(6).
  1615
  1616     12  AM-TRUST-TYPE                     PIC X(2).
  1617
  1618     12  AM-EMPLOYER-STMT-USED             PIC X.
  1619     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1620
  1621     12  AM-STD-AH-TYPE                    PIC XX.
  1622     12  AM-EARN-METHODS.
  1623         16  AM-EARN-METHOD-R              PIC X.
  1624             88 AM-REF-RL-R78                 VALUE 'R'.
  1625             88 AM-REF-RL-PR                  VALUE 'P'.
  1626             88 AM-REF-RL-MEAN                VALUE 'M'.
  1627             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1628         16  AM-EARN-METHOD-L              PIC X.
  1629             88 AM-REF-LL-R78                 VALUE 'R'.
  1630             88 AM-REF-LL-PR                  VALUE 'P'.
  1631             88 AM-REF-LL-MEAN                VALUE 'M'.
  1632             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1633         16  AM-EARN-METHOD-A              PIC X.
  1634             88 AM-REF-AH-R78                 VALUE 'R'.
  1635             88 AM-REF-AH-PR                  VALUE 'P'.
  1636             88 AM-REF-AH-MEAN                VALUE 'M'.
  1637             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1638             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1639             88 AM-REF-AH-NET                 VALUE 'N'.
  1640
  1641     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1642     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1643     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1644
  1645     12  AM-RET-Y-N                        PIC X.
  1646     12  AM-RET-P-E                        PIC X.
  1647     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1648     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1649     12  AM-RET-GRP                        PIC X(6).
  1650     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1651         16  AM-POOL-PRIME                 PIC XXX.
  1652         16  AM-POOL-SUB                   PIC XXX.
  1653     12  AM-RETRO-EARNINGS.
  1654         16  AM-RET-EARN-R                 PIC X.
  1655         16  AM-RET-EARN-L                 PIC X.
  1656         16  AM-RET-EARN-A                 PIC X.
  1657     12  AM-RET-ST-TAX-USE                 PIC X.
  1658         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  31
* EL6311.cbl
  1659         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1660     12  AM-RETRO-BEG-EARNINGS.
  1661         16  AM-RET-BEG-EARN-R             PIC X.
  1662         16  AM-RET-BEG-EARN-L             PIC X.
  1663         16  AM-RET-BEG-EARN-A             PIC X.
  1664     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1665     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1666
  1667     12  AM-USER-SELECT-OPTIONS.
  1668         16  AM-USER-SELECT-1              PIC X(10).
  1669         16  AM-USER-SELECT-2              PIC X(10).
  1670         16  AM-USER-SELECT-3              PIC X(10).
  1671         16  AM-USER-SELECT-4              PIC X(10).
  1672         16  AM-USER-SELECT-5              PIC X(10).
  1673
  1674     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1675
  1676     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1677
  1678     12  AM-RPT045A-SWITCH                 PIC X.
  1679         88  RPT045A-OFF                   VALUE 'N'.
  1680
  1681     12  AM-INSURANCE-LIMITS.
  1682         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1683         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1684
  1685     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1686         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1687
  1688     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1689         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1690         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1691
  1692     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1693
  1694     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1695     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1696     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1697     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1698     12  AM-DCC-UEF-STATE                  PIC XX.
  1699     12  FILLER                            PIC XXX.
  1700     12  AM-REPORT-CODE-3                  PIC X(10).
  1701*    12  FILLER                            PIC X(22).
  1702
  1703     12  AM-RESERVE-DATE.
  1704         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1705         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1706         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1707
  1708     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1709     12  AM-NOTIFICATION-TYPES.
  1710         16  AM-NOTIF-OF-LETTERS           PIC X.
  1711         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1712         16  AM-NOTIF-OF-REPORTS           PIC X.
  1713         16  AM-NOTIF-OF-STATUS            PIC X.
  1714
  1715     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1716         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  32
* EL6311.cbl
  1717         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1718         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1719         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1720
  1721     12  AM-BENEFIT-CONTROLS.
  1722         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1723             20  AM-BENEFIT-CODE           PIC XX.
  1724             20  AM-BENEFIT-TYPE           PIC X.
  1725             20  AM-BENEFIT-REVISION       PIC XXX.
  1726             20  AM-BENEFIT-REM-TERM       PIC X.
  1727             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1728             20  FILLER                    PIC XX.
  1729         16  FILLER                        PIC X(80).
  1730
  1731     12  AM-TRANSFER-DATA.
  1732         16  AM-TRANSFERRED-FROM.
  1733             20  AM-TRNFROM-CARRIER        PIC X.
  1734             20  AM-TRNFROM-GROUPING.
  1735                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1736                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1737             20  AM-TRNFROM-STATE          PIC XX.
  1738             20  AM-TRNFROM-ACCOUNT.
  1739                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1740                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1741             20  AM-TRNFROM-DTE            PIC XX.
  1742         16  AM-TRANSFERRED-TO.
  1743             20  AM-TRNTO-CARRIER          PIC X.
  1744             20  AM-TRNTO-GROUPING.
  1745                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1746                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1747             20  AM-TRNTO-STATE            PIC XX.
  1748             20  AM-TRNTO-ACCOUNT.
  1749                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1750                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1751             20  AM-TRNTO-DTE              PIC XX.
  1752         16  FILLER                        PIC X(10).
  1753
  1754     12  AM-SAVED-REMIT-TO                 PIC 99.
  1755
  1756     12  AM-COMM-STRUCTURE-SAVED.
  1757         16  AM-DEFN-1-SAVED.
  1758             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1759                 24  AM-AGT-SV             PIC X(10).
  1760                 24  AM-COM-TYP-SV         PIC X.
  1761                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1762                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1763                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1764                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1765                 24  FILLER                PIC X.
  1766                 24  AM-GL-CODES-SV        PIC X.
  1767                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1768                 24  FILLER                PIC X.
  1769         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1770             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1771                 24  FILLER                PIC X(11).
  1772                 24  AM-L-COMA-SV          PIC XXX.
  1773                 24  AM-J-COMA-SV          PIC XXX.
  1774                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  33
* EL6311.cbl
  1775                 24  FILLER                PIC X(6).
  1776
  1777     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1778         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1779            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1780            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1781            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1782
  1783     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1784     12  FILLER                            PIC X(120).
  1785
  1786     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1787         16  AM-CONTROL-NAME               PIC X(30).
  1788         16  AM-EXECUTIVE-ONE.
  1789             20  AM-EXEC1-NAME             PIC X(15).
  1790             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1791                                                          COMP-3.
  1792             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1793                                                          COMP-3.
  1794         16  AM-EXECUTIVE-TWO.
  1795             20  AM-EXEC2-NAME             PIC X(15).
  1796             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1797                                                          COMP-3.
  1798             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1799                                                          COMP-3.
  1800
  1801     12  AM-RETRO-ADDITIONAL-DATA.
  1802         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1803         16  AM-RETRO-PREM-P-E             PIC X.
  1804         16  AM-RETRO-CLMS-P-I             PIC X.
  1805         16  AM-RETRO-RET-BRACKET-LF.
  1806             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1807                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1808                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1809             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1810                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1811                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1812             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1813                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1814                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1815         16  AM-RETRO-RET-BRACKET-AH.
  1816             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1817                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1818                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1819                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1820             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1821                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1822                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1823             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1824                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1825                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1826
  1827     12  AM-COMMENTS.
  1828         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1829
  1830     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1831         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1832         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  34
* EL6311.cbl
  1833         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1834         16  AM-FLI-UNITED-IDENT           PIC X.
  1835         16  AM-FLI-INTEREST-LOST-DATA.
  1836             20  AM-FLI-BANK-NO            PIC X(5).
  1837             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1838             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1839             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1840         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1841             20  AM-FLI-AGT                PIC X(9).
  1842             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1843             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1844         16  FILLER                        PIC X(102).
  1845
  1846     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1847         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1848             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1849             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1850             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1851             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1852             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1853         16  FILLER                          PIC X(10).
  1854******************************************************************
  1855*                                copy ERCACNT.
  1856******************************************************************
  1857*                                                                *
  1858*                                                                *
  1859*                            ERCACNT.                            *
  1860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1861*                            VMOD=2.002                          *
  1862*                                                                *
  1863*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1867*                                                                *
  1868*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1869*       ALTERNATE INDEX = NONE                                   *
  1870*                                                                *
  1871*                                                                *
  1872*   LOG = YES                                                    *
  1873*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1874******************************************************************
  1875*                   C H A N G E   L O G
  1876*
  1877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1878*-----------------------------------------------------------------
  1879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1880* EFFECTIVE    NUMBER
  1881*-----------------------------------------------------------------
  1882* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1883*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1884******************************************************************
  1885 01  NOTE-FILE.
  1886     12  NT-FILE-ID                  PIC XX.
  1887         88  VALID-NOTE-ID              VALUE 'NT'.
  1888
  1889     12  NT-CONTROL-PRIMARY.
  1890         16  NT-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  35
* EL6311.cbl
  1891         16  NT-ACCT-NOTE-KEY.
  1892             18  NT-CARRIER              PIC X.
  1893             18  NT-GROUPING             PIC X(06).
  1894             18  NT-STATE                PIC XX.
  1895             18  NT-ACCOUNT              PIC X(10).
  1896         16  NT-RECORD-TYPE          PIC X.
  1897              88  ACCT-NOTE          VALUE '1'.
  1898              88  ACCT-BRANCH-LOC    VALUE '2'.
  1899              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1900         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1901
  1902     12  NT-LAST-MAINT-DT            PIC XX.
  1903     12  NT-LAST-MAINT-BY            PIC X(4).
  1904     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1905
  1906*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1907*     SEQUENCE NUMBERS
  1908     12  NT-NOTE-INFORMATION.
  1909         16  NT-NOTE-LINE            PIC X(60).
  1910         16  FILLER                  PIC X(25).
  1911*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1912     12  NT-LOCATION-INFORMATION REDEFINES
  1913                         NT-NOTE-INFORMATION.
  1914         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1915         16  FILLER                  PIC X(25).
  1916* Account special indicator is record type '2', sequence 3
  1917     12  filler REDEFINES NT-NOTE-INFORMATION.
  1918         16  nt-account-special      PIC X.
  1919         16  FILLER                  PIC X(84).
  1920*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1921*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1922*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1923*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1924*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1925*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1926*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1927     12  NT-SHIPPING-INFORMATION REDEFINES
  1928                         NT-NOTE-INFORMATION.
  1929         16  NT-SHIPPING-LINE        PIC X(60).
  1930         16  NT-SHIP-STATE           PIC XX.
  1931         16  NT-SHIP-ZIP             PIC X(10).
  1932         16  FILLER                  PIC X(13).
  1933*****************************************************************
  1934*                                COPY ELCVADS.
  1935******************************************************************
  1936*                                                                *
  1937*                                                                *
  1938*                            ELCVADS.                            *
  1939*                                                                *
  1940*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1941*   ELVADS                  LENGTH = 350                         *
  1942******************************************************************
  1943******************************************************************
  1944*                   C H A N G E   L O G
  1945*
  1946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1947*-----------------------------------------------------------------
  1948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  36
* EL6311.cbl
  1949* EFFECTIVE    NUMBER
  1950*-----------------------------------------------------------------
  1951* 100111    2011022800001  AJRA  NAPERSOFT
  1952******************************************************************
  1953
  1954 01  VIRGINIA-DISCLOSURE.
  1955     12  VD-COMPANY-CD              PIC X.
  1956     12  VD-CARRIER                 PIC X.
  1957     12  VD-GROUPING.
  1958         20  VD-GROUPING-PREFIX     PIC XXX.
  1959         20  VD-GROUPING-PRIME      PIC XXX.
  1960     12  VD-STATE                   PIC XX.
  1961     12  VD-ACCOUNT.
  1962         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1963         20  VD-ACCOUNT-PRIME       PIC X(6).
  1964     12  VD-CERT-EFF-DT             PIC XX.
  1965     12  VD-CERT-NO.
  1966         20  VD-CERT-PRIME          PIC X(10).
  1967         20  VD-CERT-SFX            PIC X.
  1968     12  VD-ENTRY-BATCH             PIC X(6).
  1969     12  VD-CSR-ID                  PIC X(4).
  1970     12  VD-NAME.
  1971         20  VD-INSURED-LAST-NAME   PIC X(15).
  1972         20  VD-INSURED-FIRST-NAME.
  1973             24  VD-INSURED-1ST-INIT PIC X.
  1974             24  FILLER             PIC X(9).
  1975         20  VD-INSURED-MIDDLE-INIT PIC X.
  1976     12  VD-JOINT-INSURED.
  1977         20 VD-JOINT-LAST-NAME      PIC X(15).
  1978         20 VD-JOINT-FIRST-NAME.
  1979            24  VD-JOINT-FIRST-INIT PIC X.
  1980            24  FILLER              PIC X(9).
  1981         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1982     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1983     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1984     12  VD-INSURED-CITY-STATE.
  1985         20  VD-INSURED-CITY        PIC X(28).
  1986         20  VD-INSURED-STATE       PIC XX.
  1987     12  VD-INSURED-ZIP-CODE.
  1988         20  VD-INSURED-ZIP-PRIME.
  1989             24  VD-INSURED-ZIP-1   PIC X.
  1990                 88  VD-CANADIAN-POST-CODE
  1991                                       VALUE 'A' THRU 'Z'.
  1992             24  FILLER             PIC X(4).
  1993         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1994     12  VD-BENEFICIARY-NAME        PIC X(30).
  1995     12  VD-ACCOUNT-NAME            PIC X(30).
  1996     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1997     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1998     12  VD-1ST-PMT-DT              PIC XX.
  1999     12  VD-LIFE-BENEFIT-CD         PIC XX.
  2000         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  2001         88  VD-INVALID-LIFE           VALUE '  ' '00'
  2002                                             '90' THRU '99'.
  2003     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  2004                                    PIC XX.
  2005     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2006     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  37
* EL6311.cbl
  2007     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  2008     12  VD-LF-TERM                 PIC S999   COMP-3.
  2009     12  VD-AH-BENEFIT-CD           PIC XX.
  2010         88  VD-VALID-AH               VALUE '01' THRU '89'.
  2011         88  VD-INVALID-AH             VALUE '  ' '00'
  2012                                             '90' THRU '99'.
  2013     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2014     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2015     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2016     12  VD-AH-TERM                 PIC S999   COMP-3.
  2017     12  VD-LETTER-ID               PIC X(4).
  2018     12  VD-PROC-ID                 PIC X(4).
  2019     12  VD-COMP-ID                 PIC X(3).
  2020     12  VD-CURRENT-DATE            PIC XX.
  2021     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2022     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2023     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  38
* EL6311.cbl
  2025*    COPY ELCDATE.
  2026******************************************************************
  2027*                                                                *
  2028*                                                                *
  2029*                            ELCDATE.                            *
  2030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2031*                            VMOD=2.003
  2032*                                                                *
  2033*                                                                *
  2034*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2035*                 LENGTH = 200                                   *
  2036******************************************************************
  2037
  2038 01  DATE-CONVERSION-DATA.
  2039     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2040     12  DC-OPTION-CODE                PIC X.
  2041         88  BIN-TO-GREG                VALUE ' '.
  2042         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2043         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2044         88  YMD-GREG-TO-BIN            VALUE '3'.
  2045         88  MDY-GREG-TO-BIN            VALUE '4'.
  2046         88  JULIAN-TO-BIN              VALUE '5'.
  2047         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2048         88  FIND-CENTURY               VALUE '7'.
  2049         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2050         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2051         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2052         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2053         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2054         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2055         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2056         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2057         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2058         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2059         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2060         88  BIN-3-TO-GREG              VALUE 'I'.
  2061         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2062         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2063         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2064         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2065         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2066         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2067         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2068         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2069         88  THREE-CHARACTER-BIN
  2070                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2071         88  GREGORIAN-TO-BIN
  2072                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2073         88  BIN-TO-GREGORIAN
  2074                  VALUES ' ' '1' 'I' '8' 'G'.
  2075         88  JULIAN-TO-BINARY
  2076                  VALUES '5' 'C' 'E' 'F'.
  2077     12  DC-ERROR-CODE                 PIC X.
  2078         88  NO-CONVERSION-ERROR        VALUE ' '.
  2079         88  DATE-CONVERSION-ERROR
  2080                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2081         88  DATE-IS-ZERO               VALUE '1'.
  2082         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  39
* EL6311.cbl
  2083         88  DATE-IS-INVALID            VALUE '3'.
  2084         88  DATE1-GREATER-DATE2        VALUE '4'.
  2085         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2086         88  DATE-INVALID-OPTION        VALUE '9'.
  2087         88  INVALID-CENTURY            VALUE 'A'.
  2088         88  ONLY-CENTURY               VALUE 'B'.
  2089         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2090         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2091     12  DC-END-OF-MONTH               PIC X.
  2092         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2093     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2094         88  USE-NORMAL-PROCESS         VALUE ' '.
  2095         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2096         88  ADJUST-UP-100-YRS          VALUE '2'.
  2097     12  FILLER                        PIC X.
  2098     12  DC-CONVERSION-DATES.
  2099         16  DC-BIN-DATE-1             PIC XX.
  2100         16  DC-BIN-DATE-2             PIC XX.
  2101         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2102         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2103                       DC-GREG-DATE-1-EDIT.
  2104             20  DC-EDIT1-MONTH        PIC 99.
  2105             20  SLASH1-1              PIC X.
  2106             20  DC-EDIT1-DAY          PIC 99.
  2107             20  SLASH1-2              PIC X.
  2108             20  DC-EDIT1-YEAR         PIC 99.
  2109         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2110         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2111                     DC-GREG-DATE-2-EDIT.
  2112             20  DC-EDIT2-MONTH        PIC 99.
  2113             20  SLASH2-1              PIC X.
  2114             20  DC-EDIT2-DAY          PIC 99.
  2115             20  SLASH2-2              PIC X.
  2116             20  DC-EDIT2-YEAR         PIC 99.
  2117         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2118         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2119                     DC-GREG-DATE-1-YMD.
  2120             20  DC-YMD-YEAR           PIC 99.
  2121             20  DC-YMD-MONTH          PIC 99.
  2122             20  DC-YMD-DAY            PIC 99.
  2123         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2124         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2125                      DC-GREG-DATE-1-MDY.
  2126             20  DC-MDY-MONTH          PIC 99.
  2127             20  DC-MDY-DAY            PIC 99.
  2128             20  DC-MDY-YEAR           PIC 99.
  2129         16  DC-GREG-DATE-1-ALPHA.
  2130             20  DC-ALPHA-MONTH        PIC X(10).
  2131             20  DC-ALPHA-DAY          PIC 99.
  2132             20  FILLER                PIC XX.
  2133             20  DC-ALPHA-CENTURY.
  2134                 24 DC-ALPHA-CEN-N     PIC 99.
  2135             20  DC-ALPHA-YEAR         PIC 99.
  2136         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2137         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2138         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2139         16  DC-JULIAN-DATE            PIC 9(05).
  2140         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  40
* EL6311.cbl
  2141                                       PIC 9(05).
  2142         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2143             20  DC-JULIAN-YEAR        PIC 99.
  2144             20  DC-JULIAN-DAYS        PIC 999.
  2145         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2146         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2147         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2148     12  DATE-CONVERSION-VARIBLES.
  2149         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2150         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2151             20  FILLER                PIC 9(3).
  2152             20  HOLD-CEN-1-CCYY.
  2153                 24  HOLD-CEN-1-CC     PIC 99.
  2154                 24  HOLD-CEN-1-YY     PIC 99.
  2155             20  HOLD-CEN-1-MO         PIC 99.
  2156             20  HOLD-CEN-1-DA         PIC 99.
  2157         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2158             20  HOLD-CEN-1-R-MO       PIC 99.
  2159             20  HOLD-CEN-1-R-DA       PIC 99.
  2160             20  HOLD-CEN-1-R-CCYY.
  2161                 24  HOLD-CEN-1-R-CC   PIC 99.
  2162                 24  HOLD-CEN-1-R-YY   PIC 99.
  2163             20  FILLER                PIC 9(3).
  2164         16  HOLD-CENTURY-1-X.
  2165             20  FILLER                PIC X(3)  VALUE SPACES.
  2166             20  HOLD-CEN-1-X-CCYY.
  2167                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2168                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2169             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2170             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2171         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2172             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2173             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2174             20  HOLD-CEN-1-R-X-CCYY.
  2175                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2176                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2177             20  FILLER                PIC XXX.
  2178         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2179         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2180         16  DC-JULIAN-DATE-1          PIC 9(07).
  2181         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2182             20  DC-JULIAN-1-CCYY.
  2183                 24  DC-JULIAN-1-CC    PIC 99.
  2184                 24  DC-JULIAN-1-YR    PIC 99.
  2185             20  DC-JULIAN-DA-1        PIC 999.
  2186         16  DC-JULIAN-DATE-2          PIC 9(07).
  2187         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2188             20  DC-JULIAN-2-CCYY.
  2189                 24  DC-JULIAN-2-CC    PIC 99.
  2190                 24  DC-JULIAN-2-YR    PIC 99.
  2191             20  DC-JULIAN-DA-2        PIC 999.
  2192         16  DC-GREG-DATE-A-EDIT.
  2193             20  DC-EDITA-MONTH        PIC 99.
  2194             20  SLASHA-1              PIC X VALUE '/'.
  2195             20  DC-EDITA-DAY          PIC 99.
  2196             20  SLASHA-2              PIC X VALUE '/'.
  2197             20  DC-EDITA-CCYY.
  2198                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  41
* EL6311.cbl
  2199                 24  DC-EDITA-YEAR     PIC 99.
  2200         16  DC-GREG-DATE-B-EDIT.
  2201             20  DC-EDITB-MONTH        PIC 99.
  2202             20  SLASHB-1              PIC X VALUE '/'.
  2203             20  DC-EDITB-DAY          PIC 99.
  2204             20  SLASHB-2              PIC X VALUE '/'.
  2205             20  DC-EDITB-CCYY.
  2206                 24  DC-EDITB-CENT     PIC 99.
  2207                 24  DC-EDITB-YEAR     PIC 99.
  2208         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2209         16  DC-GREG-DATE-CYMD-R REDEFINES
  2210                              DC-GREG-DATE-CYMD.
  2211             20  DC-CYMD-CEN           PIC 99.
  2212             20  DC-CYMD-YEAR          PIC 99.
  2213             20  DC-CYMD-MONTH         PIC 99.
  2214             20  DC-CYMD-DAY           PIC 99.
  2215         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2216         16  DC-GREG-DATE-MDCY-R REDEFINES
  2217                              DC-GREG-DATE-MDCY.
  2218             20  DC-MDCY-MONTH         PIC 99.
  2219             20  DC-MDCY-DAY           PIC 99.
  2220             20  DC-MDCY-CEN           PIC 99.
  2221             20  DC-MDCY-YEAR          PIC 99.
  2222    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2223        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2224    12  DC-EL310-DATE                  PIC X(21).
  2225    12  FILLER                         PIC X(28).
  2226
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  42
* EL6311.cbl
  2228*    COPY ELCLOGOF.
  2229******************************************************************
  2230*                                                                *
  2231*                                                                *
  2232*                            ELCLOGOF.                           *
  2233*                            VMOD=2.001                          *
  2234*                                                                *
  2235*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2236*                                                                *
  2237******************************************************************
  2238 01  CLASIC-LOGOFF.
  2239     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2240     12  LOGOFF-TEXT.
  2241         16  FILLER          PIC X(5)    VALUE SPACES.
  2242         16  LOGOFF-MSG.
  2243             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2244             20  FILLER      PIC X       VALUE SPACES.
  2245             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2246         16  FILLER          PIC X(80)
  2247           VALUE '* YOU ARE NOW LOGGED OFF'.
  2248         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2249         16  FILLER          PIC X       VALUE QUOTE.
  2250         16  LOGOFF-SYS-MSG  PIC X(17)
  2251           VALUE 'S CLAS-IC SYSTEM '.
  2252     12  TEXT-MESSAGES.
  2253         16  UNACCESS-MSG    PIC X(29)
  2254             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2255         16  PGMIDERR-MSG    PIC X(17)
  2256             VALUE 'PROGRAM NOT FOUND'.
  2257
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  43
* EL6311.cbl
  2259*    COPY ELCATTR.
  2260******************************************************************
  2261*                                                                *
  2262*                            ELCATTR.                            *
  2263*                            VMOD=2.001                          *
  2264*                                                                *
  2265*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2266*                                                                *
  2267*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2268*                                                                *
  2269*                   POS 1   P=PROTECTED                          *
  2270*                           U=UNPROTECTED                        *
  2271*                           S=ASKIP                              *
  2272*                   POS 2   A=ALPHA/NUMERIC                      *
  2273*                           N=NUMERIC                            *
  2274*                   POS 3   N=NORMAL                             *
  2275*                           B=BRIGHT                             *
  2276*                           D=DARK                               *
  2277*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2278*                           OF=MODIFIED DATA TAG OFF             *
  2279*                                                                *
  2280*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2281******************************************************************
  2282 01  ATTRIBUTE-LIST.
  2283     12  AL-PABOF            PIC X       VALUE 'Y'.
  2284     12  AL-PABON            PIC X       VALUE 'Z'.
  2285     12  AL-PADOF            PIC X       VALUE '%'.
  2286     12  AL-PADON            PIC X       VALUE '_'.
  2287     12  AL-PANOF            PIC X       VALUE '-'.
  2288     12  AL-PANON            PIC X       VALUE '/'.
  2289     12  AL-SABOF            PIC X       VALUE '8'.
  2290     12  AL-SABON            PIC X       VALUE '9'.
  2291     12  AL-SADOF            PIC X       VALUE '@'.
  2292     12  AL-SADON            PIC X       VALUE QUOTE.
  2293     12  AL-SANOF            PIC X       VALUE '0'.
  2294     12  AL-SANON            PIC X       VALUE '1'.
  2295     12  AL-UABOF            PIC X       VALUE 'H'.
  2296     12  AL-UABON            PIC X       VALUE 'I'.
  2297     12  AL-UADOF            PIC X       VALUE '<'.
  2298     12  AL-UADON            PIC X       VALUE '('.
  2299     12  AL-UANOF            PIC X       VALUE ' '.
  2300     12  AL-UANON            PIC X       VALUE 'A'.
  2301     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2302     12  AL-UNBON            PIC X       VALUE 'R'.
  2303     12  AL-UNDOF            PIC X       VALUE '*'.
  2304     12  AL-UNDON            PIC X       VALUE ')'.
  2305     12  AL-UNNOF            PIC X       VALUE '&'.
  2306     12  AL-UNNON            PIC X       VALUE 'J'.
  2307
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  44
* EL6311.cbl
  2309*    COPY ELCEMIB.
  2310******************************************************************
  2311*                                                                *
  2312*                                                                *
  2313*                            ELCEMIB.                            *
  2314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2315*                            VMOD=2.005                          *
  2316*                                                                *
  2317*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2318*                                                                *
  2319******************************************************************
  2320 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2321     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2322     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2323     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2324     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2325     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2326     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2327     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2328     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2329     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2330         88  EMI-NO-ERRORS                    VALUE '1'.
  2331         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2332         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2333     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2334         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2335     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2336         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2337         88  EMI-AREA1-FULL                   VALUE '2'.
  2338     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2339         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2340         88  EMI-AREA2-FULL                   VALUE '2'.
  2341     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2342         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2343         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2344         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2345         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2346         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2347     12  EMI-ERROR-LINES.
  2348         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2349         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2350         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2351         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2352             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2353                 24  EMI-ERR-NUM         PIC X(4).
  2354                 24  EMI-FILLER          PIC X.
  2355                 24  EMI-SEV             PIC X.
  2356                 24  FILLER              PIC X.
  2357             20  FILLER                  PIC X(02).
  2358     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2359         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2360             20  EMI-ERROR-NUMBER    PIC X(4).
  2361             20  EMI-FILL            PIC X.
  2362             20  EMI-SEVERITY        PIC X.
  2363             20  FILLER              PIC X.
  2364             20  EMI-ERROR-TEXT.
  2365                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2366                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  45
* EL6311.cbl
  2367     12  EMI-SEVERITY-SAVE           PIC X.
  2368         88  EMI-NOTE                    VALUE 'N'.
  2369         88  EMI-WARNING                 VALUE 'W'.
  2370         88  EMI-FORCABLE                VALUE 'F'.
  2371         88  EMI-FATAL                   VALUE 'X'.
  2372     12  EMI-MESSAGE-FLAG            PIC X.
  2373         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2374         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2375     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2376     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2377         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2378         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2379         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2380     12  emi-claim-no                pic x(7).
  2381     12  emi-claim-type              pic x(6).
  2382     12  FILLER                      PIC X(124)  VALUE SPACES.
  2383     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2384     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2385     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2386     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2387
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  46
* EL6311.cbl
  2389*    COPY ELCINTF.
  2390******************************************************************
  2391*                                                                *
  2392*                                                                *
  2393*                            ELCINTF.                            *
  2394*                            VMOD=2.017                          *
  2395*                                                                *
  2396*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2397*                                                                *
  2398*       LENGTH = 1024                                            *
  2399*                                                                *
  2400******************************************************************
  2401*                   C H A N G E   L O G
  2402*
  2403* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2404*-----------------------------------------------------------------
  2405*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2406* EFFECTIVE    NUMBER
  2407*-----------------------------------------------------------------
  2408* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2409******************************************************************
  2410 01  PROGRAM-INTERFACE-BLOCK.
  2411     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2412     12  PI-CALLING-PROGRAM              PIC X(8).
  2413     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2414     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2415     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2416     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2417     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2418     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2419     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2420     12  PI-COMPANY-ID                   PIC XXX.
  2421     12  PI-COMPANY-CD                   PIC X.
  2422
  2423     12  PI-COMPANY-PASSWORD             PIC X(8).
  2424
  2425     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2426
  2427     12  PI-CONTROL-IN-PROGRESS.
  2428         16  PI-CARRIER                  PIC X.
  2429         16  PI-GROUPING                 PIC X(6).
  2430         16  PI-STATE                    PIC XX.
  2431         16  PI-ACCOUNT                  PIC X(10).
  2432         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2433                                         PIC X(10).
  2434         16  PI-CLAIM-CERT-GRP.
  2435             20  PI-CLAIM-NO             PIC X(7).
  2436             20  PI-CERT-NO.
  2437                 25  PI-CERT-PRIME       PIC X(10).
  2438                 25  PI-CERT-SFX         PIC X.
  2439             20  PI-CERT-EFF-DT          PIC XX.
  2440         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2441             20  PI-PLAN-CODE            PIC X(2).
  2442             20  PI-REVISION-NUMBER      PIC X(3).
  2443             20  PI-PLAN-EFF-DT          PIC X(2).
  2444             20  PI-PLAN-EXP-DT          PIC X(2).
  2445             20  FILLER                  PIC X(11).
  2446         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  47
* EL6311.cbl
  2447             20  PI-OE-REFERENCE-1.
  2448                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2449                 25  PI-OE-REF-1-SUFF    PIC XX.
  2450
  2451     12  PI-SESSION-IN-PROGRESS          PIC X.
  2452         88  CLAIM-SESSION                   VALUE '1'.
  2453         88  CREDIT-SESSION                  VALUE '2'.
  2454         88  WARRANTY-SESSION                VALUE '3'.
  2455         88  MORTGAGE-SESSION                VALUE '4'.
  2456         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2457
  2458
  2459*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2460
  2461     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2462     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2463
  2464     12  PI-CREDIT-USER                  PIC X.
  2465         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2466         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2467
  2468     12  PI-CLAIM-USER                   PIC X.
  2469         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2470         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2471
  2472     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2473         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2474         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2475         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2476         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2477         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2478
  2479     12  PI-PROCESSOR-ID                 PIC X(4).
  2480
  2481     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2482
  2483     12  PI-MEMBER-CAPTION               PIC X(10).
  2484
  2485     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2486         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2487
  2488     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2489     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2490     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2491     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2492
  2493     12  PI-AH-OVERRIDE-L1               PIC X.
  2494     12  PI-AH-OVERRIDE-L2               PIC XX.
  2495     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2496     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2497
  2498     12  PI-NEW-SYSTEM                   PIC X(2).
  2499
  2500     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2501     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2502         88  PI-USES-PAID-TO                 VALUE '1'.
  2503     12  PI-CRDTCRD-SYSTEM.
  2504         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  48
* EL6311.cbl
  2505             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2506             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2507         16  PI-CC-MONTH-END-DT          PIC XX.
  2508     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2509
  2510     12  PI-OE-REFERENCE-2.
  2511         16  PI-OE-REF-2-PRIME           PIC X(10).
  2512         16  PI-OE-REF-2-SUFF            PIC X.
  2513
  2514     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2515
  2516     12  PI-LANGUAGE-TYPE                PIC X.
  2517             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2518             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2519             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2520
  2521     12  PI-POLICY-LINKAGE-IND           PIC X.
  2522         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2523         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2524                                                   LOW-VALUES.
  2525
  2526     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2527     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2528         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2529         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2530
  2531     12  PI-PROCESSOR-CSR-IND            PIC X.
  2532         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2533         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2534
  2535     12  FILLER                          PIC X(3).
  2536
  2537     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2538
  2539     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2540         PI-SYSTEM-LEVEL.
  2541
  2542         16  PI-ENTRY-CODES.
  2543             20  PI-ENTRY-CD-1           PIC X.
  2544             20  PI-ENTRY-CD-2           PIC X.
  2545
  2546         16  PI-RETURN-CODES.
  2547             20  PI-RETURN-CD-1          PIC X.
  2548             20  PI-RETURN-CD-2          PIC X.
  2549
  2550         16  PI-UPDATE-STATUS-SAVE.
  2551             20  PI-UPDATE-BY            PIC X(4).
  2552             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2553
  2554         16  PI-LOWER-CASE-LETTERS       PIC X.
  2555             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2556
  2557*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2558*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2559*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2560
  2561         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2562             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  49
* EL6311.cbl
  2563             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2564             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2565             88  ACCNT-CNTL                  VALUE '3'.
  2566             88  CARR-ACCNT-CNTL             VALUE '4'.
  2567
  2568         16  PI-PROCESSOR-CAP-LIST.
  2569             20  PI-SYSTEM-CONTROLS.
  2570                24 PI-SYSTEM-DISPLAY     PIC X.
  2571                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2572                24 PI-SYSTEM-MODIFY      PIC X.
  2573                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2574             20  FILLER                  PIC XX.
  2575             20  PI-DISPLAY-CAP          PIC X.
  2576                 88  DISPLAY-CAP             VALUE 'Y'.
  2577             20  PI-MODIFY-CAP           PIC X.
  2578                 88  MODIFY-CAP              VALUE 'Y'.
  2579             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2580                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2581             20  PI-FORCE-CAP            PIC X.
  2582                 88  FORCE-CAP               VALUE 'Y'.
  2583
  2584         16  PI-PROGRAM-CONTROLS.
  2585             20  PI-PGM-PRINT-OPT        PIC X.
  2586             20  PI-PGM-FORMAT-OPT       PIC X.
  2587             20  PI-PGM-PROCESS-OPT      PIC X.
  2588             20  PI-PGM-TOTALS-OPT       PIC X.
  2589
  2590         16  PI-HELP-INTERFACE.
  2591             20  PI-LAST-ERROR-NO        PIC X(4).
  2592             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2593
  2594         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2595             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2596
  2597         16  PI-CR-CONTROL-IN-PROGRESS.
  2598             20  PI-CR-CARRIER           PIC X.
  2599             20  PI-CR-GROUPING          PIC X(6).
  2600             20  PI-CR-STATE             PIC XX.
  2601             20  PI-CR-ACCOUNT           PIC X(10).
  2602             20  PI-CR-FIN-RESP          PIC X(10).
  2603             20  PI-CR-TYPE              PIC X.
  2604
  2605         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2606
  2607         16  PI-CR-MONTH-END-DT          PIC XX.
  2608
  2609         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2610             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2611             88  PI-ZERO-CARRIER             VALUE '1'.
  2612             88  PI-ZERO-GROUPING            VALUE '2'.
  2613             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2614
  2615         16  PI-CARRIER-SECURITY         PIC X.
  2616             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2617
  2618         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2619             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2620             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  50
* EL6311.cbl
  2621
  2622         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2623             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2624                                         INDEXED BY PI-ACCESS-NDX
  2625                                         PIC X.
  2626
  2627         16  PI-GA-BILLING-CONTROL       PIC X.
  2628             88  PI-GA-BILLING               VALUE '1'.
  2629
  2630         16  PI-MAIL-PROCESSING          PIC X.
  2631             88  PI-MAIL-YES                 VALUE 'Y'.
  2632
  2633         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2634
  2635         16  PI-AR-SYSTEM.
  2636             20  PI-AR-PROCESSING-CNTL   PIC X.
  2637                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2638             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2639             20  PI-AR-MONTH-END-DT      PIC XX.
  2640
  2641         16  PI-MP-SYSTEM.
  2642             20  PI-MORTGAGE-USER            PIC X.
  2643                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2644                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2645             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2646                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2647                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2648                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2649                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2650                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2651             20  PI-MP-MONTH-END-DT          PIC XX.
  2652             20  PI-MP-REFERENCE-NO.
  2653                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2654                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2655
  2656         16  PI-LABEL-CONTROL            PIC X(01).
  2657             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2658             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2659
  2660         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2661             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2662
  2663         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2664             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2665             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2666
  2667         16  FILLER                      PIC X(14).
  2668
  2669     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2670******************************************************************
  2671
  2672     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2673*    COPY ELC631PI.
  2674******************************************************************
  2675*                                                                *
  2676*                                                                *
  2677*                            ELC631PI                            *
  2678*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  51
* EL6311.cbl
  2679*                                                                *
  2680*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2681*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2682*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2683*                                                                *
  2684*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2685*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2686*    BETWEEN PROGRAMS.                                           *
  2687*                                                                *
  2688*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2689*                                                                *
  2690*               EL631 - EL6311 - EL6312 - EL6313                 *
  2691*                                                                *
  2692******************************************************************
  2693*                   C H A N G E   L O G
  2694*
  2695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2696*-----------------------------------------------------------------
  2697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2698* EFFECTIVE    NUMBER
  2699*-----------------------------------------------------------------
  2700* 021414    2003053000001  PEMA  changes for auto chk request
  2701******************************************************************
  2702
  2703         16  PI-631-DATA.
  2704             20  PI-ERPNDB-KEY.
  2705                 24  PI-PB-COMPANY-CD     PIC X.
  2706                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2707                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2708                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2709
  2710             20  PI-ERPNDB-ALT-KEY.
  2711                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2712                 24  PI-PB-CARRIER        PIC X.
  2713                 24  PI-PB-GROUPING       PIC X(6).
  2714                 24  PI-PB-STATE          PIC XX.
  2715                 24  PI-PB-ACCOUNT        PIC X(10).
  2716                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2717                 24  PI-PB-CERT-NO.
  2718                     28  PI-PB-CERT-PRIME PIC X(10).
  2719                     28  PI-PB-CERT-SFX   PIC X.
  2720                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2721                 24  PI-PB-RECORD-TYPE    PIC X.
  2722
  2723             20  PI-ERPNDB-CSR-KEY.
  2724                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2725                 24  PI-PB-CSR-ID             PIC X(4).
  2726                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2727                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2728                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2729
  2730             20  PI-BROWSE-TYPE               PIC X.
  2731                 88  PI-FILE-BROWSE             VALUE ' '.
  2732                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2733                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2734                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2735                 88  PI-CSR-BROWSE              VALUE '4'.
  2736
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  52
* EL6311.cbl
  2737             20  PI-MAINT-FUNCTION            PIC X.
  2738                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2739                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2740                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2741                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2742                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2743                 88  PI-PF5-FUNCTION            VALUE '5'.
  2744                 88  PI-PF6-FUNCTION            VALUE '6'.
  2745
  2746             20  PI-FILE-SWITCHES.
  2747                 24  PI-ALL-ISSUES-SW         PIC X.
  2748                     88  ALL-ISSUES             VALUE 'Y'.
  2749                 24  PI-ALL-CANCELS-SW        PIC X.
  2750                     88  ALL-CANCELS            VALUE 'Y'.
  2751                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2752                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2753                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2754                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2755                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2756                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2757                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2758                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2759                 24  PI-HOLD-REC-SW           PIC X.
  2760                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2761                 24  PI-CHANGE-REC-SW         PIC X.
  2762                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2763                 24  PI-CHK-REQ-REC-SW        PIC X.
  2764                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2765                 24  PI-ISSUE-WARNING-SW      PIC X.
  2766                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2767                 24  PI-CANCEL-WARNING-SW     PIC X.
  2768                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2769             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2770                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2771             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2772                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2773
  2774             20  PI-MAP-NAME                  PIC X(8).
  2775
  2776             20  PI-CURSOR                    PIC S9(4) COMP.
  2777
  2778             20  PI-PREV-ALT-KEY              PIC X(36).
  2779             20  PI-PREV-CSR-KEY              PIC X(15).
  2780             20  PI-PREV-KEY.
  2781                 24  PI-PREV-COMPANY-CD       PIC X.
  2782                 24  PI-PREV-BATCH            PIC X(6).
  2783                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2784                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2785             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2786             20  PI-BROWSE-SW                 PIC X.
  2787                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2788                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2789             20  PI-SV-CARRIER                PIC X.
  2790             20  PI-SV-GROUPING               PIC X(6).
  2791             20  PI-SV-STATE                  PIC XX.
  2792             20  PI-EDIT-SW                   PIC X.
  2793             20  PI-DISPLAY-SW                PIC XX.
  2794                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  53
* EL6311.cbl
  2795                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2796             20  PI-CRITERIA-DATA             PIC X(350).
  2797             20  PI-BMODE                     PIC X.
  2798             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2799             20  PI-BPMTS                     PIC S999     COMP-3.
  2800             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2801             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2802             20  PI-CSR-SESSION-SW            PIC X.
  2803                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2804             20  PI-ERRORS-SW                 PIC X.
  2805                 88  FATAL-ERRORS               VALUE 'X'.
  2806*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2807             20  pi-unforced-sw               pic x.
  2808                 88  unforced-errors            value 'X'.
  2809             20  FILLER                       PIC X(4).
  2810
  2811        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2812        16  FILLER             PIC X(92).
  2813
  2814 01  W-LETTER-COMMUNICATION-AREAS.
  2815*    COPY ELC1042.
  2816******************************************************************
  2817*                                                                *
  2818*                                                                *
  2819*                           ELC1042                              *
  2820*                            VMOD=2.002                          *
  2821*                                                                *
  2822*    NOTE                                                        *
  2823*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2824*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2825*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2826*        TO THESE PROGRAMS.                                      *
  2827*                                                                *
  2828*    NOTE                                                        *
  2829*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2830*        USE ONLY!                                               *
  2831*                                                                *
  2832******************************************************************
  2833
  2834         16  PI-1042-WA.
  2835             20  PI-ACTION       PIC  X(01).
  2836                 88 PI-SHOW-MODE           VALUE '1'.
  2837                 88 PI-CLEAR-MODE          VALUE '2'.
  2838                 88 PI-CREATE-MODE         VALUE '3'.
  2839             20  PI-COMM-CONTROL PIC  X(12).
  2840             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2841             20  PI-EOF-SW       PIC  X(01).
  2842                 88  PI-FILE-EOF           VALUE 'Y'.
  2843             20  PI-FILETYP      PIC  X(01).
  2844             20  PI-FORM-SQUEEZE-CONTROL
  2845                                 PIC  X(01).
  2846                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2847                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2848             20  PI-LAST-CONTROL PIC  X(12).
  2849             20  PI-TEMP-STOR-ITEMS
  2850                                 PIC S9(04) COMP.
  2851             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2852             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  54
* EL6311.cbl
  2853                 88 ANY-UPDATES            VALUE 1.
  2854             20  PI-104-SCREEN-SENT-IND
  2855                                 PIC  X(01).
  2856                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2857                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2858             20  PI-1042-SCREEN-SENT-IND
  2859                                 PIC  X(01).
  2860                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2861                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2862             20  PI-1042-ARCHIVE-IND
  2863                                 PIC  X(01).
  2864                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2865             20  FILLER          PIC  X(29).
  2866*    COPY ELC689PI.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELC689PI                            *
  2870*                            VMOD=2.003                          *
  2871*                                                                *
  2872*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2873*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2874*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2875*                                                                *
  2876*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2877*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2878*    BETWEEN PROGRAMS.                                           *
  2879*                                                                *
  2880*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2881*                                                                *
  2882*               EL631 - EL689  - EL6891 - EL6892                 *
  2883*                                                                *
  2884******************************************************************
  2885*                   C H A N G E   L O G
  2886*
  2887* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2888*-----------------------------------------------------------------
  2889*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2890* EFFECTIVE    NUMBER
  2891*-----------------------------------------------------------------
  2892* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2893* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2894* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2895******************************************************************
  2896
  2897
  2898         16  PI-689-WORK-AREA.
  2899             20  PI-689-ALT-PRINTER-ID
  2900                                 PIC  X(04).
  2901             20  PI-689-ARCHIVE-NUMBER
  2902                                 PIC  9(08).
  2903             20  PI-689-ARCHIVE-SW
  2904                                 PIC  X(01).
  2905                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2906             20  PI-689-DATA-SOURCE
  2907                                 PIC  X(01).
  2908                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2909                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2910                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  55
* EL6311.cbl
  2911                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2912                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2913             20  PI-689-ERROR-IND
  2914                                 PIC  X(01).
  2915                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2916             20  PI-689-ERROR    PIC  9(04).
  2917                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2918                 88  PI-689-FATAL-ERROR
  2919                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2920                            0042 0047 0051 0066 0067 0070
  2921                            0168 0169 0174 0175 0176 0177 0179
  2922                            0180 0181 0182 0184 0185 0189 0190
  2923                            0191
  2924                            0215 0279 0280
  2925                            0412 0413 0454
  2926                            0533 0537
  2927                            2055 2114 2208 2209 2216 2232 2369
  2928                            2398 2433 2908 2999
  2929                            3000 3770 3771 3775
  2930                            7250 7365 7367 7368 7369 7370 7371
  2931                            7272 7373 7374 7376 7377 7378 7379
  2932                            7381 7388 7390 7393 7395 7396 7398
  2933                            9095 9096 9281 9298 9299 9320 9327
  2934                            9426 9427.
  2935                 88  PI-689-STOP-ERROR
  2936                     VALUES 0004 0008 0013 0023 0029 0033
  2937                            0042 0047 0066 0067 0070
  2938                            0168 0169 0174 0175 0176 0177
  2939                            0181 0182 0184 0185 0189 0190
  2940                            0279 0280
  2941                            0412 0413 0454
  2942                            2055 2208 2209 2216 2232
  2943                            2398 2999
  2944                            3000 3770 3771 3775
  2945                            7250 7365 7369 7370 7371
  2946                            7272 7373 7374 7376 7377 7378 7379
  2947                            7381 7388 7390 7393 7396 7398
  2948                            9095 9096 9299 9320 9426.
  2949             20  PI-689-FOLLOW-UP-DATE
  2950                                 PIC  X(02).
  2951             20  PI-689-FORM-NUMBER
  2952                                 PIC  X(04).
  2953             20  PI-689-LABEL-SOURCE
  2954                                 PIC X(01).
  2955                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2956                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2957                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2958                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2959                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2960                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2961                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2962             20  PI-689-NUMBER-COPIES
  2963                                 PIC  9(01).
  2964             20  PI-689-NUMBER-LABEL-LINES
  2965                                 PIC  9(01).
  2966             20  PI-689-NUMBER-TEXT-RECORDS
  2967                                 PIC  9(03).
  2968             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  56
* EL6311.cbl
  2969                                 PIC  X(01).
  2970                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2971                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2972                 88  PI-689-PRINT-LATER     VALUE '3'.
  2973                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2974             20  PI-689-PRINT-RESTRICTION
  2975                                 PIC  X(01).
  2976                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2977                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2978                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2979             20  PI-689-PRINT-SW PIC  X(01).
  2980                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2981             20  PI-689-RESEND-DATE-1
  2982                                 PIC  X(02).
  2983             20  PI-689-RESEND-LETR-1
  2984                                 PIC X(4).
  2985             20  PI-689-TEMP-STOR-ID
  2986                                 PIC  X(08).
  2987             20  PI-689-USE-SCREEN-IND
  2988                                 PIC  X(01).
  2989                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2990             20  PI-689-ARCH-POINTER
  2991                                 PIC S9(08) COMP.
  2992                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2993             20  PI-689-ARCT-POINTER
  2994                                 PIC S9(08) COMP.
  2995                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2996             20  PI-689-VARIABLE-DATA-GRP.
  2997                 24  PI-689-VARIABLE-DATA-1
  2998                                 PIC  X(30).
  2999                 24  PI-689-VARIABLE-DATA-2
  3000                                 PIC  X(30).
  3001                 24  PI-689-VARIABLE-DATA-3
  3002                                 PIC  X(30).
  3003                 24  PI-689-VARIABLE-DATA-4
  3004                                 PIC  X(30).
  3005
  3006         16  PI-689-KEY-DATA-FIELDS.
  3007             20  PI-689-ACCOUNT  PIC  X(10).
  3008             20  PI-689-CARRIER  PIC  X(01).
  3009             20  PI-689-CERT-NO.
  3010                 24  PI-689-CERT-PRIME
  3011                                 PIC  X(10).
  3012                 24  PI-689-CERT-SFX
  3013                                 PIC  X(01).
  3014             20  PI-689-CHG-SEQ-NO
  3015                                 PIC S9(04)    COMP.
  3016             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3017                                 PIC  X(02).
  3018             20  PI-689-ENTRY-BATCH
  3019                                 PIC  X(06).
  3020             20  PI-689-EFF-DATE PIC  X(02).
  3021             20  PI-689-EXP-DATE PIC  X(02).
  3022             20  PI-689-GROUPING PIC  X(06).
  3023             20  PI-689-RESP-PERSON
  3024                                 PIC  X(10).
  3025             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3026             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  57
* EL6311.cbl
  3027                                 PIC  X(04).
  3028             20  PI-689-STATE    PIC  X(02).
  3029             20  PI-689-TYPE     PIC  X(01).
  3030             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3031             20  PI-689-ALT-SEQ-NO
  3032                                 PIC S9(04)    COMP.
  3033         16  PI-689-DATE-EDIT    PIC  X(08).
  3034         16  PI-689-FOLLOW-UP-EDIT
  3035                                 PIC  X(08).
  3036         16  PI-689-RESEND1-EDIT PIC  X(08).
  3037         16  PI-689-SEQ-EDIT     PIC  X(08).
  3038         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3039         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3040             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3041         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3042         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  58
* EL6311.cbl
  3044
  3045 01  WS-EL6315-PASS-AREA.
  3046        16  PI-6315-ISS-CAN-SW      PIC X.
  3047        16  FILLER                  PIC X(120).
  3048        16  PI-RES-REF-CLM-TYPE     PIC X.
  3049        16  FILLER                  PIC X.
  3050        16  PI-6315-PASS-AREA.
  3051            20 FILLER               PIC X(236).
  3052            20 PI-6315-FINALIZED    PIC X.
  3053            20 FILLER               PIC X(280).
  3054
  3055 01  WS-EL6316-PASS-AREA.
  3056        16  PI-ISS-CAN-SW           PIC X.
  3057        16  FILLER                  PIC X(121).
  3058        16  PI-CLM-RESC-IND         PIC X.
  3059        16  PI-6316-PASS-AREA.
  3060            20 FILLER               PIC X(236).
  3061            20 PI-6316-FINALIZED    PIC X.
  3062            20 FILLER               PIC X(280).
  3063
  3064******************************************************************
  3065*                                                                *
  3066*         P A S S   A R E A   F O R   E D I T                    *
  3067*                                                                *
  3068******************************************************************
  3069
  3070 01  PASSED-RECORD.
  3071     12  RECORD-SAVE                  PIC X(585).
  3072* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3073*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3074*                    BY  WK-CURRENT-DATE.
  3075******************************************************************
  3076*                                                                *
  3077*                                                                *
  3078*                             ELC50W1                            *
  3079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3080*                            VMOD=2.004                          *
  3081*                                                                *
  3082*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3083*                                                                *
  3084*                                                                *
  3085******************************************************************
  3086
  3087     12  WK-WORK-AREA.
  3088         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3089         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3090         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3091         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3092         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3093         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3094         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3095         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3096         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3097         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3098         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3099         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3100         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3101         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  59
* EL6311.cbl
  3102         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3103         16  WK-CREDIT-EDIT-CONTROLS.
  3104             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3105             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3106             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3107             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3108             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3109             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3110         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3111         16  WK-SAVE-REIN-DATA.
  3112             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3113             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3114             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3115         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3116             88  ENTRY-FROM-EL6311       VALUE '6'.
  3117         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3118         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3119     12  WK-RECORD-ADDRESSES.
  3120         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3121         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3122         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3123         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3124         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3125         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3126         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3127         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3128     12  WK-OVER-SHORT-AREA.
  3129         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3130         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3131         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3132             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3133         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  60
* EL6311.cbl
  3135
  3136*    COPY ELCEDITC.
  3137******************************************************************
  3138*                                                                *
  3139*                                                                *
  3140*                            ELCEDITC                            *
  3141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3142*                            VMOD=2.012                          *
  3143*                                                                *
  3144*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3145*                     EL6313, EL050 AND EL517.                   *
  3146*                                                                *
  3147******************************************************************
  3148******************************************************************
  3149*                   C H A N G E   L O G
  3150*
  3151* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3152*-----------------------------------------------------------------
  3153*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3154* EFFECTIVE    NUMBER
  3155*-----------------------------------------------------------------
  3156* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3157******************************************************************
  3158
  3159     12  EDIT-CRITERIA-DATA.
  3160         16  EC-CO-MONTH-END-DT       PIC XX.
  3161         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3162         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3163         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3164         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3165         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3166         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3167         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3168         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3169         16  EC-CO-REM-TERM-CALC      PIC X.
  3170               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3171               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3172               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3173               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3174
  3175         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3176               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3177               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3178               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3179               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3180               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3181               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3182               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3183               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3184               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3185               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3186
  3187         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3188               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3189               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3190               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3191               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3192               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  61
* EL6311.cbl
  3193               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3194               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3195               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3196
  3197         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3198                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3199                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3200
  3201         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3202                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3203                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3204                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3205                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3206                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3207                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3208                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3209                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3210
  3211         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3212               88  EC-BR-REDUCING                   VALUE 'R'.
  3213               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3214
  3215         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3216         16  EC-BR-LF-DESC             PIC X(10).
  3217         16  EC-BR-AH-DESC             PIC X(10).
  3218         16  EC-BR-LF-COMMENT          PIC X(10).
  3219         16  EC-BR-AH-COMMENT          PIC X(10).
  3220
  3221         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3222               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3223               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3224               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3225               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3226
  3227         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3228               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3229               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3230               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3231               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3232
  3233         16  EC-BR-LF-REFUND-CALC      PIC X.
  3234                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3235                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3236                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3237                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3238                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3239                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3240                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3241
  3242         16  EC-BR-AH-REFUND-CALC      PIC X.
  3243                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3244                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3245                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3246                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3247                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3248                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3249                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3250                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  62
* EL6311.cbl
  3251
  3252         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3253                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3254                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3255                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3256
  3257         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3258                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3259                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3260                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3261
  3262         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3263         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3264         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3265         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3266
  3267         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3268         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3269                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3270                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3271                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3272                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3273
  3274         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3275               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3276               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3277               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3278               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3279               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3280
  3281         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3282               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3283               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3284               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3285               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3286               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3287
  3288         16  EC-ST-LF-REFUND-CALC      PIC X.
  3289                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3290                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3291                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3292                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3293                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3294                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3295                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3296                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3297
  3298         16  EC-ST-AH-REFUND-CALC      PIC X.
  3299                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3300                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3301                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3302                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3303                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3304                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3305                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3306                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3307
  3308         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  63
* EL6311.cbl
  3309         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3310         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3311         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3312         16  EC-AM-EXPIRATION-DT       PIC XX.
  3313         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3314         16  EC-AM-CLASS-CD            PIC XX.
  3315         16  EC-AM-LF-DEVIATION        PIC XXX.
  3316         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3317         16  EC-AM-AH-DEVIATION        PIC XXX.
  3318         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3319         16  EC-AM-PHONE-NO            PIC X(10).
  3320
  3321         16  EC-AM-LF-REFUND-CALC      PIC X.
  3322                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3323                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3324                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3325                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3326                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3327                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3328                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3329
  3330         16  EC-AM-AH-REFUND-CALC      PIC X.
  3331                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3332                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3333                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3334                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3335                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3336                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3337                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3338
  3339         16  EC-AM-BEN-I-G-CD          PIC X.
  3340                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3341                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3342                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3343
  3344         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3345         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3346         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3347         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3348         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3349         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3350         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3351         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3352         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3353
  3354         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3355         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3356         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3357         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3358         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3359         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3360         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3361         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3362         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3363         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3364         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3365         16  EC-RT-LF-NSP-ST           PIC XX.
  3366         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  64
* EL6311.cbl
  3367         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3368         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3369
  3370         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3371             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3372                                             'M' '5' '9' '2'.
  3373             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3374             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3375             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3376             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3377             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3378             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3379             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3380             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3381             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3382             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3383
  3384         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3385             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3386                                             'M' '5' '9' '2'.
  3387             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3388             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3389             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3390             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3391             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3392             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3393             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3394             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3395             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3396             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3397
  3398         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3399         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3400         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3401         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3402         16  EC-CM-DEATH-DT            PIC XX.
  3403
  3404*DMD CUSTOM CODING FIELDS BELOW
  3405*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3406         16  EC-BR-DMD-RATING-SW       PIC X.
  3407                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3408                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3409                 88  NO-DMD-RATING               VALUE 'N'.
  3410
  3411         16  EC-NEW-CERT               PIC X(11).
  3412         16  EC-NEW-STATE              PIC XX.
  3413         16  FILLER                    PIC X.
  3414*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3415         16  OVER-SHORT-EDIT-FIELDS.
  3416             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3417             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3418             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3419             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3420             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3421             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3422             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3423             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3424             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  65
* EL6311.cbl
  3425         16  FILLER                    PIC X(71).
  3426
  3427******************************************************************
  3428
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  66
* EL6311.cbl
  3430
  3431*    COPY ELCJPFX.
  3432******************************************************************
  3433*                                                                *
  3434*                                                                *
  3435*                            ELCJPFX.                            *
  3436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3437*                            VMOD=2.002                          *
  3438*                                                                *
  3439*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3440*                                                                *
  3441*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3442*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3443*        ELCNTL - CONTROL FILE                                   *
  3444*        ELMSTR - CLAIM MASTERS                                  *
  3445*        ELTRLR - ACTIVITY TRAILERS                              *
  3446*        ELCHKQ - CHECK QUE                                      *
  3447******************************************************************
  3448 01  JOURNAL-RECORD.
  3449     12  jp-date                     pic s9(5) comp-3.
  3450     12  jp-time                     pic s9(7) comp-3.
  3451     12  JP-USER-ID                  PIC X(4).
  3452     12  JP-FILE-ID                  PIC X(8).
  3453     12  JP-PROGRAM-ID               PIC X(8).
  3454     12  JP-RECORD-TYPE              PIC X.
  3455         88 JP-ADD              VALUE 'A'.
  3456         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3457         88 JP-AFTER-CHANGE     VALUE 'C'.
  3458         88 JP-DELETE           VALUE 'D'.
  3459         88 JP-GENERIC-DELETE   VALUE 'G'.
  3460         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3461         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3462     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3463     12  JP-RECORD-AREA
  3464
  3465
  3466                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  67
* EL6311.cbl
  3468*    COPY ELCAID.
  3469******************************************************************
  3470*                                                                *
  3471*                            ELCAID.                             *
  3472*                            VMOD=2.001                          *
  3473*                                                                *
  3474*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3475*                                                                *
  3476*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3477*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3478******************************************************************
  3479
  3480 01  DFHAID.
  3481   02  DFHNULL   PIC  X  VALUE  ' '.
  3482   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3483   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3484   02  DFHPEN    PIC  X  VALUE  '='.
  3485   02  DFHOPID   PIC  X  VALUE  'W'.
  3486   02  DFHPA1    PIC  X  VALUE  '%'.
  3487   02  DFHPA2    PIC  X  VALUE  '>'.
  3488   02  DFHPA3    PIC  X  VALUE  ','.
  3489   02  DFHPF1    PIC  X  VALUE  '1'.
  3490   02  DFHPF2    PIC  X  VALUE  '2'.
  3491   02  DFHPF3    PIC  X  VALUE  '3'.
  3492   02  DFHPF4    PIC  X  VALUE  '4'.
  3493   02  DFHPF5    PIC  X  VALUE  '5'.
  3494   02  DFHPF6    PIC  X  VALUE  '6'.
  3495   02  DFHPF7    PIC  X  VALUE  '7'.
  3496   02  DFHPF8    PIC  X  VALUE  '8'.
  3497   02  DFHPF9    PIC  X  VALUE  '9'.
  3498   02  DFHPF10   PIC  X  VALUE  ':'.
  3499   02  DFHPF11   PIC  X  VALUE  '#'.
  3500   02  DFHPF12   PIC  X  VALUE  '@'.
  3501   02  DFHPF13   PIC  X  VALUE  'A'.
  3502   02  DFHPF14   PIC  X  VALUE  'B'.
  3503   02  DFHPF15   PIC  X  VALUE  'C'.
  3504   02  DFHPF16   PIC  X  VALUE  'D'.
  3505   02  DFHPF17   PIC  X  VALUE  'E'.
  3506   02  DFHPF18   PIC  X  VALUE  'F'.
  3507   02  DFHPF19   PIC  X  VALUE  'G'.
  3508   02  DFHPF20   PIC  X  VALUE  'H'.
  3509   02  DFHPF21   PIC  X  VALUE  'I'.
  3510*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3511   02  DFHPF22   PIC  X  VALUE  '['.
  3512   02  DFHPF23   PIC  X  VALUE  '.'.
  3513   02  DFHPF24   PIC  X  VALUE  '<'.
  3514   02  DFHMSRE   PIC  X  VALUE  'X'.
  3515   02  DFHSTRF   PIC  X  VALUE  'h'.
  3516   02  DFHTRIG   PIC  X  VALUE  '"'.
  3517
  3518 01  FILLER    REDEFINES DFHAID.
  3519     12  FILLER              PIC X(8).
  3520     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3521
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  68
* EL6311.cbl
  3523*    COPY EL6311S.
  3524 01  EL631BI.
  3525     05  FILLER            PIC  X(0012).
  3526*    -------------------------------
  3527     05  BDATEL PIC S9(0004) COMP.
  3528     05  BDATEF PIC  X(0001).
  3529     05  FILLER REDEFINES BDATEF.
  3530         10  BDATEA PIC  X(0001).
  3531     05  BDATEI PIC  X(0008).
  3532*    -------------------------------
  3533     05  BTIMEL PIC S9(0004) COMP.
  3534     05  BTIMEF PIC  X(0001).
  3535     05  FILLER REDEFINES BTIMEF.
  3536         10  BTIMEA PIC  X(0001).
  3537     05  BTIMEI PIC  X(0005).
  3538*    -------------------------------
  3539     05  BHEADL PIC S9(0004) COMP.
  3540     05  BHEADF PIC  X(0001).
  3541     05  FILLER REDEFINES BHEADF.
  3542         10  BHEADA PIC  X(0001).
  3543     05  BHEADI PIC  X(0038).
  3544*    -------------------------------
  3545     05  BNCERTLL PIC S9(0004) COMP.
  3546     05  BNCERTLF PIC  X(0001).
  3547     05  FILLER REDEFINES BNCERTLF.
  3548         10  BNCERTLA PIC  X(0001).
  3549     05  BNCERTLI PIC  X(0008).
  3550*    -------------------------------
  3551     05  BNCERTL PIC S9(0004) COMP.
  3552     05  BNCERTF PIC  X(0001).
  3553     05  FILLER REDEFINES BNCERTF.
  3554         10  BNCERTA PIC  X(0001).
  3555     05  BNCERTI PIC  X(0011).
  3556*    -------------------------------
  3557     05  BNSTATLL PIC S9(0004) COMP.
  3558     05  BNSTATLF PIC  X(0001).
  3559     05  FILLER REDEFINES BNSTATLF.
  3560         10  BNSTATLA PIC  X(0001).
  3561     05  BNSTATLI PIC  X(0009).
  3562*    -------------------------------
  3563     05  BNSTATL PIC S9(0004) COMP.
  3564     05  BNSTATF PIC  X(0001).
  3565     05  FILLER REDEFINES BNSTATF.
  3566         10  BNSTATA PIC  X(0001).
  3567     05  BNSTATI PIC  X(0002).
  3568*    -------------------------------
  3569     05  BCHGTL PIC S9(0004) COMP.
  3570     05  BCHGTF PIC  X(0001).
  3571     05  FILLER REDEFINES BCHGTF.
  3572         10  BCHGTA PIC  X(0001).
  3573     05  BCHGTI PIC  X(0004).
  3574*    -------------------------------
  3575     05  BCHGL PIC S9(0004) COMP.
  3576     05  BCHGF PIC  X(0001).
  3577     05  FILLER REDEFINES BCHGF.
  3578         10  BCHGA PIC  X(0001).
  3579     05  BCHGI PIC  X(0004).
  3580*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  69
* EL6311.cbl
  3581     05  BCOMPIDL PIC S9(0004) COMP.
  3582     05  BCOMPIDF PIC  X(0001).
  3583     05  FILLER REDEFINES BCOMPIDF.
  3584         10  BCOMPIDA PIC  X(0001).
  3585     05  BCOMPIDI PIC  X(0003).
  3586*    -------------------------------
  3587     05  BREGIONL PIC S9(0004) COMP.
  3588     05  BREGIONF PIC  X(0001).
  3589     05  FILLER REDEFINES BREGIONF.
  3590         10  BREGIONA PIC  X(0001).
  3591     05  BREGIONI PIC  X(0006).
  3592*    -------------------------------
  3593     05  BUSERL PIC S9(0004) COMP.
  3594     05  BUSERF PIC  X(0001).
  3595     05  FILLER REDEFINES BUSERF.
  3596         10  BUSERA PIC  X(0001).
  3597     05  BUSERI PIC  X(0004).
  3598*    -------------------------------
  3599     05  BMAINTL PIC S9(0004) COMP.
  3600     05  BMAINTF PIC  X(0001).
  3601     05  FILLER REDEFINES BMAINTF.
  3602         10  BMAINTA PIC  X(0001).
  3603     05  BMAINTI PIC  X(0001).
  3604*    -------------------------------
  3605     05  BMANTBYL PIC S9(0004) COMP.
  3606     05  BMANTBYF PIC  X(0001).
  3607     05  FILLER REDEFINES BMANTBYF.
  3608         10  BMANTBYA PIC  X(0001).
  3609     05  BMANTBYI PIC  X(0004).
  3610*    -------------------------------
  3611     05  BCHGHDGL PIC S9(0004) COMP.
  3612     05  BCHGHDGF PIC  X(0001).
  3613     05  FILLER REDEFINES BCHGHDGF.
  3614         10  BCHGHDGA PIC  X(0001).
  3615     05  BCHGHDGI PIC  X(0003).
  3616*    -------------------------------
  3617     05  BMANTDTL PIC S9(0004) COMP.
  3618     05  BMANTDTF PIC  X(0001).
  3619     05  FILLER REDEFINES BMANTDTF.
  3620         10  BMANTDTA PIC  X(0001).
  3621     05  BMANTDTI PIC  X(0008).
  3622*    -------------------------------
  3623     05  BMANTATL PIC S9(0004) COMP.
  3624     05  BMANTATF PIC  X(0001).
  3625     05  FILLER REDEFINES BMANTATF.
  3626         10  BMANTATA PIC  X(0001).
  3627     05  BMANTATI PIC  X(0005).
  3628*    -------------------------------
  3629     05  BCSRL PIC S9(0004) COMP.
  3630     05  BCSRF PIC  X(0001).
  3631     05  FILLER REDEFINES BCSRF.
  3632         10  BCSRA PIC  X(0001).
  3633     05  BCSRI PIC  X(0004).
  3634*    -------------------------------
  3635     05  BBATCHL PIC S9(0004) COMP.
  3636     05  BBATCHF PIC  X(0001).
  3637     05  FILLER REDEFINES BBATCHF.
  3638         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  70
* EL6311.cbl
  3639     05  BBATCHI PIC  X(0006).
  3640*    -------------------------------
  3641     05  BSEQL PIC S9(0004) COMP.
  3642     05  BSEQF PIC  X(0001).
  3643     05  FILLER REDEFINES BSEQF.
  3644         10  BSEQA PIC  X(0001).
  3645     05  BSEQI PIC  X(0004).
  3646*    -------------------------------
  3647     05  BMOENDTL PIC S9(0004) COMP.
  3648     05  BMOENDTF PIC  X(0001).
  3649     05  FILLER REDEFINES BMOENDTF.
  3650         10  BMOENDTA PIC  X(0001).
  3651     05  BMOENDTI PIC  X(0008).
  3652*    -------------------------------
  3653     05  BCARRL PIC S9(0004) COMP.
  3654     05  BCARRF PIC  X(0001).
  3655     05  FILLER REDEFINES BCARRF.
  3656         10  BCARRA PIC  X(0001).
  3657     05  BCARRI PIC  X(0001).
  3658*    -------------------------------
  3659     05  BGROUPL PIC S9(0004) COMP.
  3660     05  BGROUPF PIC  X(0001).
  3661     05  FILLER REDEFINES BGROUPF.
  3662         10  BGROUPA PIC  X(0001).
  3663     05  BGROUPI PIC  X(0006).
  3664*    -------------------------------
  3665     05  BSTATEL PIC S9(0004) COMP.
  3666     05  BSTATEF PIC  X(0001).
  3667     05  FILLER REDEFINES BSTATEF.
  3668         10  BSTATEA PIC  X(0001).
  3669     05  BSTATEI PIC  X(0002).
  3670*    -------------------------------
  3671     05  BACCTL PIC S9(0004) COMP.
  3672     05  BACCTF PIC  X(0001).
  3673     05  FILLER REDEFINES BACCTF.
  3674         10  BACCTA PIC  X(0001).
  3675     05  BACCTI PIC  X(0010).
  3676*    -------------------------------
  3677     05  BVINHL PIC S9(0004) COMP.
  3678     05  BVINHF PIC  X(0001).
  3679     05  FILLER REDEFINES BVINHF.
  3680         10  BVINHA PIC  X(0001).
  3681     05  BVINHI PIC  X(0004).
  3682*    -------------------------------
  3683     05  BVINL PIC S9(0004) COMP.
  3684     05  BVINF PIC  X(0001).
  3685     05  FILLER REDEFINES BVINF.
  3686         10  BVINA PIC  X(0001).
  3687     05  BVINI PIC  X(0017).
  3688*    -------------------------------
  3689     05  BREFHDGL PIC S9(0004) COMP.
  3690     05  BREFHDGF PIC  X(0001).
  3691     05  FILLER REDEFINES BREFHDGF.
  3692         10  BREFHDGA PIC  X(0001).
  3693     05  BREFHDGI PIC  X(0004).
  3694*    -------------------------------
  3695     05  BREFL PIC S9(0004) COMP.
  3696     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  71
* EL6311.cbl
  3697     05  FILLER REDEFINES BREFF.
  3698         10  BREFA PIC  X(0001).
  3699     05  BREFI PIC  X(0012).
  3700*    -------------------------------
  3701     05  LETRREQL PIC S9(0004) COMP.
  3702     05  LETRREQF PIC  X(0001).
  3703     05  FILLER REDEFINES LETRREQF.
  3704         10  LETRREQA PIC  X(0001).
  3705     05  LETRREQI PIC  X(0001).
  3706*    -------------------------------
  3707     05  BAGEDEFL PIC S9(0004) COMP.
  3708     05  BAGEDEFF PIC  X(0001).
  3709     05  FILLER REDEFINES BAGEDEFF.
  3710         10  BAGEDEFA PIC  X(0001).
  3711     05  BAGEDEFI PIC  X(0004).
  3712*    -------------------------------
  3713     05  BCERTNOL PIC S9(0004) COMP.
  3714     05  BCERTNOF PIC  X(0001).
  3715     05  FILLER REDEFINES BCERTNOF.
  3716         10  BCERTNOA PIC  X(0001).
  3717     05  BCERTNOI PIC  X(0010).
  3718*    -------------------------------
  3719     05  BSUFIXL PIC S9(0004) COMP.
  3720     05  BSUFIXF PIC  X(0001).
  3721     05  FILLER REDEFINES BSUFIXF.
  3722         10  BSUFIXA PIC  X(0001).
  3723     05  BSUFIXI PIC  X(0001).
  3724*    -------------------------------
  3725     05  BEFFDTL PIC S9(0004) COMP.
  3726     05  BEFFDTF PIC  X(0001).
  3727     05  FILLER REDEFINES BEFFDTF.
  3728         10  BEFFDTA PIC  X(0001).
  3729     05  BEFFDTI PIC  X(0008).
  3730*    -------------------------------
  3731     05  BLSTNML PIC S9(0004) COMP.
  3732     05  BLSTNMF PIC  X(0001).
  3733     05  FILLER REDEFINES BLSTNMF.
  3734         10  BLSTNMA PIC  X(0001).
  3735     05  BLSTNMI PIC  X(0015).
  3736*    -------------------------------
  3737     05  B1STNML PIC S9(0004) COMP.
  3738     05  B1STNMF PIC  X(0001).
  3739     05  FILLER REDEFINES B1STNMF.
  3740         10  B1STNMA PIC  X(0001).
  3741     05  B1STNMI PIC  X(0010).
  3742*    -------------------------------
  3743     05  BINITL PIC S9(0004) COMP.
  3744     05  BINITF PIC  X(0001).
  3745     05  FILLER REDEFINES BINITF.
  3746         10  BINITA PIC  X(0001).
  3747     05  BINITI PIC  X(0001).
  3748*    -------------------------------
  3749     05  BSEXL PIC S9(0004) COMP.
  3750     05  BSEXF PIC  X(0001).
  3751     05  FILLER REDEFINES BSEXF.
  3752         10  BSEXA PIC  X(0001).
  3753     05  BSEXI PIC  X(0001).
  3754*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  72
* EL6311.cbl
  3755     05  BAGEL PIC S9(0004) COMP.
  3756     05  BAGEF PIC  X(0001).
  3757     05  FILLER REDEFINES BAGEF.
  3758         10  BAGEA PIC  X(0001).
  3759     05  BAGEI PIC  X(0002).
  3760*    -------------------------------
  3761     05  BBIRTHL PIC S9(0004) COMP.
  3762     05  BBIRTHF PIC  X(0001).
  3763     05  FILLER REDEFINES BBIRTHF.
  3764         10  BBIRTHA PIC  X(0001).
  3765     05  BBIRTHI PIC  X(0008).
  3766*    -------------------------------
  3767     05  B1STPMTL PIC S9(0004) COMP.
  3768     05  B1STPMTF PIC  X(0001).
  3769     05  FILLER REDEFINES B1STPMTF.
  3770         10  B1STPMTA PIC  X(0001).
  3771     05  B1STPMTI PIC  X(0008).
  3772*    -------------------------------
  3773     05  BDAYSL PIC S9(0004) COMP.
  3774     05  BDAYSF PIC  X(0001).
  3775     05  FILLER REDEFINES BDAYSF.
  3776         10  BDAYSA PIC  X(0001).
  3777     05  BDAYSI PIC  X(0003).
  3778*    -------------------------------
  3779     05  BLNTRML PIC S9(0004) COMP.
  3780     05  BLNTRMF PIC  X(0001).
  3781     05  FILLER REDEFINES BLNTRMF.
  3782         10  BLNTRMA PIC  X(0001).
  3783     05  BLNTRMI PIC  X(0003).
  3784*    -------------------------------
  3785     05  BLNOFCRL PIC S9(0004) COMP.
  3786     05  BLNOFCRF PIC  X(0001).
  3787     05  FILLER REDEFINES BLNOFCRF.
  3788         10  BLNOFCRA PIC  X(0001).
  3789     05  BLNOFCRI PIC  X(0005).
  3790*    -------------------------------
  3791     05  BMODEL PIC S9(0004) COMP.
  3792     05  BMODEF PIC  X(0001).
  3793     05  FILLER REDEFINES BMODEF.
  3794         10  BMODEA PIC  X(0001).
  3795     05  BMODEI PIC  X(0001).
  3796*    -------------------------------
  3797     05  BFREQL PIC S9(0004) COMP.
  3798     05  BFREQF PIC  X(0001).
  3799     05  FILLER REDEFINES BFREQF.
  3800         10  BFREQA PIC  X(0001).
  3801     05  BFREQI PIC  X(0002).
  3802*    -------------------------------
  3803     05  BPMTSL PIC S9(0004) COMP.
  3804     05  BPMTSF PIC  X(0001).
  3805     05  FILLER REDEFINES BPMTSF.
  3806         10  BPMTSA PIC  X(0001).
  3807     05  BPMTSI PIC  999.
  3808*    -------------------------------
  3809     05  BPMTAMTL PIC S9(0004) COMP.
  3810     05  BPMTAMTF PIC  X(0001).
  3811     05  FILLER REDEFINES BPMTAMTF.
  3812         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  73
* EL6311.cbl
  3813     05  BPMTAMTI PIC  9(7)V99.
  3814*    -------------------------------
  3815     05  BAPRL PIC S9(0004) COMP.
  3816     05  BAPRF PIC  X(0001).
  3817     05  FILLER REDEFINES BAPRF.
  3818         10  BAPRA PIC  X(0001).
  3819     05  BAPRI PIC  X(7).
  3820*    -------------------------------
  3821     05  BLIVESL PIC S9(0004) COMP.
  3822     05  BLIVESF PIC  X(0001).
  3823     05  FILLER REDEFINES BLIVESF.
  3824         10  BLIVESA PIC  X(0001).
  3825     05  BLIVESI PIC  X(0009).
  3826*    -------------------------------
  3827     05  BMEMCAPL PIC S9(0004) COMP.
  3828     05  BMEMCAPF PIC  X(0001).
  3829     05  FILLER REDEFINES BMEMCAPF.
  3830         10  BMEMCAPA PIC  X(0001).
  3831     05  BMEMCAPI PIC  X(0011).
  3832*    -------------------------------
  3833     05  BORIGHDL PIC S9(0004) COMP.
  3834     05  BORIGHDF PIC  X(0001).
  3835     05  FILLER REDEFINES BORIGHDF.
  3836         10  BORIGHDA PIC  X(0001).
  3837     05  BORIGHDI PIC  X(0009).
  3838*    -------------------------------
  3839     05  DMDBILL PIC S9(0004) COMP.
  3840     05  DMDBILF PIC  X(0001).
  3841     05  FILLER REDEFINES DMDBILF.
  3842         10  DMDBILA PIC  X(0001).
  3843     05  DMDBILI PIC  X(0006).
  3844*    -------------------------------
  3845     05  BFORCEL PIC S9(0004) COMP.
  3846     05  BFORCEF PIC  X(0001).
  3847     05  FILLER REDEFINES BFORCEF.
  3848         10  BFORCEA PIC  X(0001).
  3849     05  BFORCEI PIC  X(0001).
  3850*    -------------------------------
  3851     05  BENTRYL PIC S9(0004) COMP.
  3852     05  BENTRYF PIC  X(0001).
  3853     05  FILLER REDEFINES BENTRYF.
  3854         10  BENTRYA PIC  X(0001).
  3855     05  BENTRYI PIC  X(0001).
  3856*    -------------------------------
  3857     05  BREINL PIC S9(0004) COMP.
  3858     05  BREINF PIC  X(0001).
  3859     05  FILLER REDEFINES BREINF.
  3860         10  BREINA PIC  X(0001).
  3861     05  BREINI PIC  X(0001).
  3862*    -------------------------------
  3863     05  BBILCDL PIC S9(0004) COMP.
  3864     05  BBILCDF PIC  X(0001).
  3865     05  FILLER REDEFINES BBILCDF.
  3866         10  BBILCDA PIC  X(0001).
  3867     05  BBILCDI PIC  X(0001).
  3868*    -------------------------------
  3869     05  BUNWRITL PIC S9(0004) COMP.
  3870     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  74
* EL6311.cbl
  3871     05  FILLER REDEFINES BUNWRITF.
  3872         10  BUNWRITA PIC  X(0001).
  3873     05  BUNWRITI PIC  X(0001).
  3874*    -------------------------------
  3875     05  BSKPCDL PIC S9(0004) COMP.
  3876     05  BSKPCDF PIC  X(0001).
  3877     05  FILLER REDEFINES BSKPCDF.
  3878         10  BSKPCDA PIC  X(0001).
  3879     05  BSKPCDI PIC  X(0001).
  3880*    -------------------------------
  3881     05  BINDGRPL PIC S9(0004) COMP.
  3882     05  BINDGRPF PIC  X(0001).
  3883     05  FILLER REDEFINES BINDGRPF.
  3884         10  BINDGRPA PIC  X(0001).
  3885     05  BINDGRPI PIC  X(0001).
  3886*    -------------------------------
  3887     05  BSIGL PIC S9(0004) COMP.
  3888     05  BSIGF PIC  X(0001).
  3889     05  FILLER REDEFINES BSIGF.
  3890         10  BSIGA PIC  X(0001).
  3891     05  BSIGI PIC  X(0001).
  3892*    -------------------------------
  3893     05  BRTCLSL PIC S9(0004) COMP.
  3894     05  BRTCLSF PIC  X(0001).
  3895     05  FILLER REDEFINES BRTCLSF.
  3896         10  BRTCLSA PIC  X(0001).
  3897     05  BRTCLSI PIC  X(0002).
  3898*    -------------------------------
  3899     05  BCHGCNTL PIC S9(0004) COMP.
  3900     05  BCHGCNTF PIC  X(0001).
  3901     05  FILLER REDEFINES BCHGCNTF.
  3902         10  BCHGCNTA PIC  X(0001).
  3903     05  BCHGCNTI PIC  X(0003).
  3904*    -------------------------------
  3905     05  BMEMBERL PIC S9(0004) COMP.
  3906     05  BMEMBERF PIC  X(0001).
  3907     05  FILLER REDEFINES BMEMBERF.
  3908         10  BMEMBERA PIC  X(0001).
  3909     05  BMEMBERI PIC  X(0012).
  3910*    -------------------------------
  3911     05  BORGNOL PIC S9(0004) COMP.
  3912     05  BORGNOF PIC  X(0001).
  3913     05  FILLER REDEFINES BORGNOF.
  3914         10  BORGNOA PIC  X(0001).
  3915     05  BORGNOI PIC  X(0006).
  3916*    -------------------------------
  3917     05  BORGSEQL PIC S9(0004) COMP.
  3918     05  BORGSEQF PIC  X(0001).
  3919     05  FILLER REDEFINES BORGSEQF.
  3920         10  BORGSEQA PIC  X(0001).
  3921     05  BORGSEQI PIC  X(0004).
  3922*    -------------------------------
  3923     05  BBILLEDL PIC S9(0004) COMP.
  3924     05  BBILLEDF PIC  X(0001).
  3925     05  FILLER REDEFINES BBILLEDF.
  3926         10  BBILLEDA PIC  X(0001).
  3927     05  BBILLEDI PIC  9(9).
  3928*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  75
* EL6311.cbl
  3929     05  BKIND1L PIC S9(0004) COMP.
  3930     05  BKIND1F PIC  X(0001).
  3931     05  FILLER REDEFINES BKIND1F.
  3932         10  BKIND1A PIC  X(0001).
  3933     05  BKIND1I PIC  X(0002).
  3934*    -------------------------------
  3935     05  BTYPE1L PIC S9(0004) COMP.
  3936     05  BTYPE1F PIC  X(0001).
  3937     05  FILLER REDEFINES BTYPE1F.
  3938         10  BTYPE1A PIC  X(0001).
  3939     05  BTYPE1I PIC  X(0003).
  3940*    -------------------------------
  3941     05  BTERM1L PIC S9(0004) COMP.
  3942     05  BTERM1F PIC  X(0001).
  3943     05  FILLER REDEFINES BTERM1F.
  3944         10  BTERM1A PIC  X(0001).
  3945     05  BTERM1I PIC  X(0003).
  3946*    -------------------------------
  3947     05  BBEN1L PIC S9(0004) COMP.
  3948     05  BBEN1F PIC  X(0001).
  3949     05  FILLER REDEFINES BBEN1F.
  3950         10  BBEN1A PIC  X(0001).
  3951     05  BBEN1I PIC  X(0012).
  3952*    -------------------------------
  3953     05  BPREM1L PIC S9(0004) COMP.
  3954     05  BPREM1F PIC  X(0001).
  3955     05  FILLER REDEFINES BPREM1F.
  3956         10  BPREM1A PIC  X(0001).
  3957     05  BPREM1I PIC  X(0011).
  3958*    -------------------------------
  3959     05  BEXPIR1L PIC S9(0004) COMP.
  3960     05  BEXPIR1F PIC  X(0001).
  3961     05  FILLER REDEFINES BEXPIR1F.
  3962         10  BEXPIR1A PIC  X(0001).
  3963     05  BEXPIR1I PIC  X(0008).
  3964*    -------------------------------
  3965     05  BCP1L PIC S9(0004) COMP.
  3966     05  BCP1F PIC  X(0001).
  3967     05  FILLER REDEFINES BCP1F.
  3968         10  BCP1A PIC  X(0001).
  3969     05  BCP1I PIC  X(0002).
  3970*    -------------------------------
  3971     05  BALTBN1L PIC S9(0004) COMP.
  3972     05  BALTBN1F PIC  X(0001).
  3973     05  FILLER REDEFINES BALTBN1F.
  3974         10  BALTBN1A PIC  X(0001).
  3975     05  BALTBN1I PIC  X(0012).
  3976*    -------------------------------
  3977     05  BALTPR1L PIC S9(0004) COMP.
  3978     05  BALTPR1F PIC  X(0001).
  3979     05  FILLER REDEFINES BALTPR1F.
  3980         10  BALTPR1A PIC  X(0001).
  3981     05  BALTPR1I PIC  X(0011).
  3982*    -------------------------------
  3983     05  BBNCD1L PIC S9(0004) COMP.
  3984     05  BBNCD1F PIC  X(0001).
  3985     05  FILLER REDEFINES BBNCD1F.
  3986         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  76
* EL6311.cbl
  3987     05  BBNCD1I PIC  X(0003).
  3988*    -------------------------------
  3989     05  BCPRM1L PIC S9(0004) COMP.
  3990     05  BCPRM1F PIC  X(0001).
  3991     05  FILLER REDEFINES BCPRM1F.
  3992         10  BCPRM1A PIC  X(0001).
  3993     05  BCPRM1I PIC  X(0011).
  3994*    -------------------------------
  3995     05  BCAPRM1L PIC S9(0004) COMP.
  3996     05  BCAPRM1F PIC  X(0001).
  3997     05  FILLER REDEFINES BCAPRM1F.
  3998         10  BCAPRM1A PIC  X(0001).
  3999     05  BCAPRM1I PIC  X(0011).
  4000*    -------------------------------
  4001     05  BENABR1L PIC S9(0004) COMP.
  4002     05  BENABR1F PIC  X(0001).
  4003     05  FILLER REDEFINES BENABR1F.
  4004         10  BENABR1A PIC  X(0001).
  4005     05  BENABR1I PIC  X(0005).
  4006*    -------------------------------
  4007     05  BDIFF1L PIC S9(0004) COMP.
  4008     05  BDIFF1F PIC  X(0001).
  4009     05  FILLER REDEFINES BDIFF1F.
  4010         10  BDIFF1A PIC  X(0001).
  4011     05  BDIFF1I PIC  X(0011).
  4012*    -------------------------------
  4013     05  BBILIT1L PIC S9(0004) COMP.
  4014     05  BBILIT1F PIC  X(0001).
  4015     05  FILLER REDEFINES BBILIT1F.
  4016         10  BBILIT1A PIC  X(0001).
  4017     05  BBILIT1I PIC  X(0008).
  4018*    -------------------------------
  4019     05  BADIFF1L PIC S9(0004) COMP.
  4020     05  BADIFF1F PIC  X(0001).
  4021     05  FILLER REDEFINES BADIFF1F.
  4022         10  BADIFF1A PIC  X(0001).
  4023     05  BADIFF1I PIC  X(0011).
  4024*    -------------------------------
  4025     05  BKIND2L PIC S9(0004) COMP.
  4026     05  BKIND2F PIC  X(0001).
  4027     05  FILLER REDEFINES BKIND2F.
  4028         10  BKIND2A PIC  X(0001).
  4029     05  BKIND2I PIC  X(0002).
  4030*    -------------------------------
  4031     05  BTYPE2L PIC S9(0004) COMP.
  4032     05  BTYPE2F PIC  X(0001).
  4033     05  FILLER REDEFINES BTYPE2F.
  4034         10  BTYPE2A PIC  X(0001).
  4035     05  BTYPE2I PIC  X(0003).
  4036*    -------------------------------
  4037     05  BTERM2L PIC S9(0004) COMP.
  4038     05  BTERM2F PIC  X(0001).
  4039     05  FILLER REDEFINES BTERM2F.
  4040         10  BTERM2A PIC  X(0001).
  4041     05  BTERM2I PIC  X(0003).
  4042*    -------------------------------
  4043     05  BBEN2L PIC S9(0004) COMP.
  4044     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  77
* EL6311.cbl
  4045     05  FILLER REDEFINES BBEN2F.
  4046         10  BBEN2A PIC  X(0001).
  4047     05  BBEN2I PIC  X(0012).
  4048*    -------------------------------
  4049     05  BPREM2L PIC S9(0004) COMP.
  4050     05  BPREM2F PIC  X(0001).
  4051     05  FILLER REDEFINES BPREM2F.
  4052         10  BPREM2A PIC  X(0001).
  4053     05  BPREM2I PIC  X(0011).
  4054*    -------------------------------
  4055     05  BEXPIR2L PIC S9(0004) COMP.
  4056     05  BEXPIR2F PIC  X(0001).
  4057     05  FILLER REDEFINES BEXPIR2F.
  4058         10  BEXPIR2A PIC  X(0001).
  4059     05  BEXPIR2I PIC  X(0008).
  4060*    -------------------------------
  4061     05  BCP2L PIC S9(0004) COMP.
  4062     05  BCP2F PIC  X(0001).
  4063     05  FILLER REDEFINES BCP2F.
  4064         10  BCP2A PIC  X(0001).
  4065     05  BCP2I PIC  X(0002).
  4066*    -------------------------------
  4067     05  BALTBN2L PIC S9(0004) COMP.
  4068     05  BALTBN2F PIC  X(0001).
  4069     05  FILLER REDEFINES BALTBN2F.
  4070         10  BALTBN2A PIC  X(0001).
  4071     05  BALTBN2I PIC  X(0012).
  4072*    -------------------------------
  4073     05  BALTPR2L PIC S9(0004) COMP.
  4074     05  BALTPR2F PIC  X(0001).
  4075     05  FILLER REDEFINES BALTPR2F.
  4076         10  BALTPR2A PIC  X(0001).
  4077     05  BALTPR2I PIC  X(0011).
  4078*    -------------------------------
  4079     05  BBNCD2L PIC S9(0004) COMP.
  4080     05  BBNCD2F PIC  X(0001).
  4081     05  FILLER REDEFINES BBNCD2F.
  4082         10  BBNCD2A PIC  X(0001).
  4083     05  BBNCD2I PIC  X(0003).
  4084*    -------------------------------
  4085     05  BCPRM2L PIC S9(0004) COMP.
  4086     05  BCPRM2F PIC  X(0001).
  4087     05  FILLER REDEFINES BCPRM2F.
  4088         10  BCPRM2A PIC  X(0001).
  4089     05  BCPRM2I PIC  X(0011).
  4090*    -------------------------------
  4091     05  BCAPRM2L PIC S9(0004) COMP.
  4092     05  BCAPRM2F PIC  X(0001).
  4093     05  FILLER REDEFINES BCAPRM2F.
  4094         10  BCAPRM2A PIC  X(0001).
  4095     05  BCAPRM2I PIC  X(0011).
  4096*    -------------------------------
  4097     05  BENABR2L PIC S9(0004) COMP.
  4098     05  BENABR2F PIC  X(0001).
  4099     05  FILLER REDEFINES BENABR2F.
  4100         10  BENABR2A PIC  X(0001).
  4101     05  BENABR2I PIC  X(0005).
  4102*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  78
* EL6311.cbl
  4103     05  BDIFF2L PIC S9(0004) COMP.
  4104     05  BDIFF2F PIC  X(0001).
  4105     05  FILLER REDEFINES BDIFF2F.
  4106         10  BDIFF2A PIC  X(0001).
  4107     05  BDIFF2I PIC  X(0011).
  4108*    -------------------------------
  4109     05  BBILIT2L PIC S9(0004) COMP.
  4110     05  BBILIT2F PIC  X(0001).
  4111     05  FILLER REDEFINES BBILIT2F.
  4112         10  BBILIT2A PIC  X(0001).
  4113     05  BBILIT2I PIC  X(0008).
  4114*    -------------------------------
  4115     05  BADIFF2L PIC S9(0004) COMP.
  4116     05  BADIFF2F PIC  X(0001).
  4117     05  FILLER REDEFINES BADIFF2F.
  4118         10  BADIFF2A PIC  X(0001).
  4119     05  BADIFF2I PIC  X(0011).
  4120*    -------------------------------
  4121     05  BERMSG1L PIC S9(0004) COMP.
  4122     05  BERMSG1F PIC  X(0001).
  4123     05  FILLER REDEFINES BERMSG1F.
  4124         10  BERMSG1A PIC  X(0001).
  4125     05  BERMSG1I PIC  X(0078).
  4126*    -------------------------------
  4127     05  BERMSG2L PIC S9(0004) COMP.
  4128     05  BERMSG2F PIC  X(0001).
  4129     05  FILLER REDEFINES BERMSG2F.
  4130         10  BERMSG2A PIC  X(0001).
  4131     05  BERMSG2I PIC  X(0078).
  4132*    -------------------------------
  4133     05  BERMSG3L PIC S9(0004) COMP.
  4134     05  BERMSG3F PIC  X(0001).
  4135     05  FILLER REDEFINES BERMSG3F.
  4136         10  BERMSG3A PIC  X(0001).
  4137     05  BERMSG3I PIC  X(0078).
  4138*    -------------------------------
  4139     05  BPFENTRL PIC S9(0004) COMP.
  4140     05  BPFENTRF PIC  X(0001).
  4141     05  FILLER REDEFINES BPFENTRF.
  4142         10  BPFENTRA PIC  X(0001).
  4143     05  BPFENTRI PIC  9(2).
  4144*    -------------------------------
  4145     05  BPF5HDRL PIC S9(0004) COMP.
  4146     05  BPF5HDRF PIC  X(0001).
  4147     05  FILLER REDEFINES BPF5HDRF.
  4148         10  BPF5HDRA PIC  X(0001).
  4149     05  BPF5HDRI PIC  X(0005).
  4150*    -------------------------------
  4151     05  BPF4HDRL PIC S9(0004) COMP.
  4152     05  BPF4HDRF PIC  X(0001).
  4153     05  FILLER REDEFINES BPF4HDRF.
  4154         10  BPF4HDRA PIC  X(0001).
  4155     05  BPF4HDRI PIC  X(0013).
  4156*    -------------------------------
  4157     05  BF15HDRL PIC S9(0004) COMP.
  4158     05  BF15HDRF PIC  X(0001).
  4159     05  FILLER REDEFINES BF15HDRF.
  4160         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  79
* EL6311.cbl
  4161     05  BF15HDRI PIC  X(0010).
  4162 01  EL631BO REDEFINES EL631BI.
  4163     05  FILLER            PIC  X(0012).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BDATEO PIC  X(0008).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BTIMEO PIC  99.99.
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BHEADO PIC  X(0038).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BNCERTLO PIC  X(0008).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BNCERTO PIC  X(0011).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BNSTATLO PIC  X(0009).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BNSTATO PIC  X(0002).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BCHGTO PIC  X(0004).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BCHGO PIC  ZZZ9.
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BCOMPIDO PIC  X(0003).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BREGIONO PIC  X(0006).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BUSERO PIC  X(0004).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BMAINTO PIC  X(0001).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BMANTBYO PIC  X(0004).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BCHGHDGO PIC  X(0003).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BMANTDTO PIC  X(0008).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BMANTATO PIC  99.99.
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BCSRO PIC  X(0004).
  4218*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  80
* EL6311.cbl
  4219     05  FILLER            PIC  X(0003).
  4220     05  BBATCHO PIC  X(0006).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BSEQO PIC  X(0004).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BMOENDTO PIC  X(0008).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BCARRO PIC  X(0001).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BGROUPO PIC  X(0006).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BSTATEO PIC  X(0002).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BACCTO PIC  X(0010).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BVINHO PIC  X(0004).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BVINO PIC  X(0017).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BREFHDGO PIC  X(0004).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BREFO PIC  X(0012).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  LETRREQO PIC  X(0001).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BAGEDEFO PIC  X(0004).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BCERTNOO PIC  X(0010).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BSUFIXO PIC  X(0001).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BEFFDTO PIC  X(0008).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BLSTNMO PIC  X(0015).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  B1STNMO PIC  X(0010).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BINITO PIC  X(0001).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  81
* EL6311.cbl
  4277     05  BSEXO PIC  X(0001).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BAGEO PIC  X(0002).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BBIRTHO PIC  X(0008).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  B1STPMTO PIC  X(0008).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BDAYSO PIC  X(0003).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BLNTRMO PIC  X(0003).
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BLNOFCRO PIC  X(0005).
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BMODEO PIC  X(0001).
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BFREQO PIC  X(0002).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BPMTSO PIC  X(0003).
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
  4307     05  BPMTAMTO PIC  ZZZZZ9.99.
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BAPRO PIC  99.9999.
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BMEMCAPO PIC  X(0011).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  BORIGHDO PIC  X(0009).
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  DMDBILO PIC  X(0006).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
  4325     05  BFORCEO PIC  X(0001).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
  4328     05  BENTRYO PIC  X(0001).
  4329*    -------------------------------
  4330     05  FILLER            PIC  X(0003).
  4331     05  BREINO PIC  X(0001).
  4332*    -------------------------------
  4333     05  FILLER            PIC  X(0003).
  4334     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  82
* EL6311.cbl
  4335*    -------------------------------
  4336     05  FILLER            PIC  X(0003).
  4337     05  BUNWRITO PIC  X(0001).
  4338*    -------------------------------
  4339     05  FILLER            PIC  X(0003).
  4340     05  BSKPCDO PIC  X(0001).
  4341*    -------------------------------
  4342     05  FILLER            PIC  X(0003).
  4343     05  BINDGRPO PIC  X(0001).
  4344*    -------------------------------
  4345     05  FILLER            PIC  X(0003).
  4346     05  BSIGO PIC  X(0001).
  4347*    -------------------------------
  4348     05  FILLER            PIC  X(0003).
  4349     05  BRTCLSO PIC  X(0002).
  4350*    -------------------------------
  4351     05  FILLER            PIC  X(0003).
  4352     05  BCHGCNTO PIC  X(0003).
  4353*    -------------------------------
  4354     05  FILLER            PIC  X(0003).
  4355     05  BMEMBERO PIC  X(0012).
  4356*    -------------------------------
  4357     05  FILLER            PIC  X(0003).
  4358     05  BORGNOO PIC  X(0006).
  4359*    -------------------------------
  4360     05  FILLER            PIC  X(0003).
  4361     05  BORGSEQO PIC  X(0004).
  4362*    -------------------------------
  4363     05  FILLER            PIC  X(0003).
  4364     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4365*    -------------------------------
  4366     05  FILLER            PIC  X(0003).
  4367     05  BKIND1O PIC  X(0002).
  4368*    -------------------------------
  4369     05  FILLER            PIC  X(0003).
  4370     05  BTYPE1O PIC  X(0003).
  4371*    -------------------------------
  4372     05  FILLER            PIC  X(0003).
  4373     05  BTERM1O PIC  X(0003).
  4374*    -------------------------------
  4375     05  FILLER            PIC  X(0003).
  4376     05  BBEN1O PIC  X(0012).
  4377*    -------------------------------
  4378     05  FILLER            PIC  X(0003).
  4379     05  BPREM1O PIC  X(0011).
  4380*    -------------------------------
  4381     05  FILLER            PIC  X(0003).
  4382     05  BEXPIR1O PIC  X(0008).
  4383*    -------------------------------
  4384     05  FILLER            PIC  X(0003).
  4385     05  BCP1O PIC  X(0002).
  4386*    -------------------------------
  4387     05  FILLER            PIC  X(0003).
  4388     05  BALTBN1O PIC  X(0012).
  4389*    -------------------------------
  4390     05  FILLER            PIC  X(0003).
  4391     05  BALTPR1O PIC  X(0011).
  4392*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  83
* EL6311.cbl
  4393     05  FILLER            PIC  X(0003).
  4394     05  BBNCD1O PIC  X(0003).
  4395*    -------------------------------
  4396     05  FILLER            PIC  X(0003).
  4397     05  BCPRM1O PIC  X(0011).
  4398*    -------------------------------
  4399     05  FILLER            PIC  X(0003).
  4400     05  BCAPRM1O PIC  X(0011).
  4401*    -------------------------------
  4402     05  FILLER            PIC  X(0003).
  4403     05  BENABR1O PIC  X(0005).
  4404*    -------------------------------
  4405     05  FILLER            PIC  X(0003).
  4406     05  BDIFF1O PIC  X(0011).
  4407*    -------------------------------
  4408     05  FILLER            PIC  X(0003).
  4409     05  BBILIT1O PIC  X(0008).
  4410*    -------------------------------
  4411     05  FILLER            PIC  X(0003).
  4412     05  BADIFF1O PIC  X(0011).
  4413*    -------------------------------
  4414     05  FILLER            PIC  X(0003).
  4415     05  BKIND2O PIC  X(0002).
  4416*    -------------------------------
  4417     05  FILLER            PIC  X(0003).
  4418     05  BTYPE2O PIC  X(0003).
  4419*    -------------------------------
  4420     05  FILLER            PIC  X(0003).
  4421     05  BTERM2O PIC  X(0003).
  4422*    -------------------------------
  4423     05  FILLER            PIC  X(0003).
  4424     05  BBEN2O PIC  X(0012).
  4425*    -------------------------------
  4426     05  FILLER            PIC  X(0003).
  4427     05  BPREM2O PIC  X(0011).
  4428*    -------------------------------
  4429     05  FILLER            PIC  X(0003).
  4430     05  BEXPIR2O PIC  X(0008).
  4431*    -------------------------------
  4432     05  FILLER            PIC  X(0003).
  4433     05  BCP2O PIC  X(0002).
  4434*    -------------------------------
  4435     05  FILLER            PIC  X(0003).
  4436     05  BALTBN2O PIC  X(0012).
  4437*    -------------------------------
  4438     05  FILLER            PIC  X(0003).
  4439     05  BALTPR2O PIC  X(0011).
  4440*    -------------------------------
  4441     05  FILLER            PIC  X(0003).
  4442     05  BBNCD2O PIC  X(0003).
  4443*    -------------------------------
  4444     05  FILLER            PIC  X(0003).
  4445     05  BCPRM2O PIC  X(0011).
  4446*    -------------------------------
  4447     05  FILLER            PIC  X(0003).
  4448     05  BCAPRM2O PIC  X(0011).
  4449*    -------------------------------
  4450     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  84
* EL6311.cbl
  4451     05  BENABR2O PIC  X(0005).
  4452*    -------------------------------
  4453     05  FILLER            PIC  X(0003).
  4454     05  BDIFF2O PIC  X(0011).
  4455*    -------------------------------
  4456     05  FILLER            PIC  X(0003).
  4457     05  BBILIT2O PIC  X(0008).
  4458*    -------------------------------
  4459     05  FILLER            PIC  X(0003).
  4460     05  BADIFF2O PIC  X(0011).
  4461*    -------------------------------
  4462     05  FILLER            PIC  X(0003).
  4463     05  BERMSG1O PIC  X(0078).
  4464*    -------------------------------
  4465     05  FILLER            PIC  X(0003).
  4466     05  BERMSG2O PIC  X(0078).
  4467*    -------------------------------
  4468     05  FILLER            PIC  X(0003).
  4469     05  BERMSG3O PIC  X(0078).
  4470*    -------------------------------
  4471     05  FILLER            PIC  X(0003).
  4472     05  BPFENTRO PIC  X(0002).
  4473*    -------------------------------
  4474     05  FILLER            PIC  X(0003).
  4475     05  BPF5HDRO PIC  X(0005).
  4476*    -------------------------------
  4477     05  FILLER            PIC  X(0003).
  4478     05  BPF4HDRO PIC  X(0013).
  4479*    -------------------------------
  4480     05  FILLER            PIC  X(0003).
  4481     05  BF15HDRO PIC  X(0010).
  4482*    -------------------------------
  4483 01  EL631CI REDEFINES EL631BI.
  4484     05  FILLER            PIC  X(0012).
  4485*    -------------------------------
  4486     05  CDATEL PIC S9(0004) COMP.
  4487     05  CDATEF PIC  X(0001).
  4488     05  FILLER REDEFINES CDATEF.
  4489         10  CDATEA PIC  X(0001).
  4490     05  CDATEI PIC  X(0008).
  4491*    -------------------------------
  4492     05  CTIMEL PIC S9(0004) COMP.
  4493     05  CTIMEF PIC  X(0001).
  4494     05  FILLER REDEFINES CTIMEF.
  4495         10  CTIMEA PIC  X(0001).
  4496     05  CTIMEI PIC  X(0005).
  4497*    -------------------------------
  4498     05  CHEADL PIC S9(0004) COMP.
  4499     05  CHEADF PIC  X(0001).
  4500     05  FILLER REDEFINES CHEADF.
  4501         10  CHEADA PIC  X(0001).
  4502     05  CHEADI PIC  X(0038).
  4503*    -------------------------------
  4504     05  CCHGTL PIC S9(0004) COMP.
  4505     05  CCHGTF PIC  X(0001).
  4506     05  FILLER REDEFINES CCHGTF.
  4507         10  CCHGTA PIC  X(0001).
  4508     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  85
* EL6311.cbl
  4509*    -------------------------------
  4510     05  CCHGL PIC S9(0004) COMP.
  4511     05  CCHGF PIC  X(0001).
  4512     05  FILLER REDEFINES CCHGF.
  4513         10  CCHGA PIC  X(0001).
  4514     05  CCHGI PIC  X(0004).
  4515*    -------------------------------
  4516     05  CMAINTL PIC S9(0004) COMP.
  4517     05  CMAINTF PIC  X(0001).
  4518     05  FILLER REDEFINES CMAINTF.
  4519         10  CMAINTA PIC  X(0001).
  4520     05  CMAINTI PIC  X(0001).
  4521*    -------------------------------
  4522     05  CMANTBYL PIC S9(0004) COMP.
  4523     05  CMANTBYF PIC  X(0001).
  4524     05  FILLER REDEFINES CMANTBYF.
  4525         10  CMANTBYA PIC  X(0001).
  4526     05  CMANTBYI PIC  X(0004).
  4527*    -------------------------------
  4528     05  CCHGHDGL PIC S9(0004) COMP.
  4529     05  CCHGHDGF PIC  X(0001).
  4530     05  FILLER REDEFINES CCHGHDGF.
  4531         10  CCHGHDGA PIC  X(0001).
  4532     05  CCHGHDGI PIC  X(0003).
  4533*    -------------------------------
  4534     05  CMANTDTL PIC S9(0004) COMP.
  4535     05  CMANTDTF PIC  X(0001).
  4536     05  FILLER REDEFINES CMANTDTF.
  4537         10  CMANTDTA PIC  X(0001).
  4538     05  CMANTDTI PIC  X(0008).
  4539*    -------------------------------
  4540     05  CMANTATL PIC S9(0004) COMP.
  4541     05  CMANTATF PIC  X(0001).
  4542     05  FILLER REDEFINES CMANTATF.
  4543         10  CMANTATA PIC  X(0001).
  4544     05  CMANTATI PIC  X(0005).
  4545*    -------------------------------
  4546     05  CCSRL PIC S9(0004) COMP.
  4547     05  CCSRF PIC  X(0001).
  4548     05  FILLER REDEFINES CCSRF.
  4549         10  CCSRA PIC  X(0001).
  4550     05  CCSRI PIC  X(0004).
  4551*    -------------------------------
  4552     05  CBATCHL PIC S9(0004) COMP.
  4553     05  CBATCHF PIC  X(0001).
  4554     05  FILLER REDEFINES CBATCHF.
  4555         10  CBATCHA PIC  X(0001).
  4556     05  CBATCHI PIC  X(0006).
  4557*    -------------------------------
  4558     05  CSEQL PIC S9(0004) COMP.
  4559     05  CSEQF PIC  X(0001).
  4560     05  FILLER REDEFINES CSEQF.
  4561         10  CSEQA PIC  X(0001).
  4562     05  CSEQI PIC  X(0004).
  4563*    -------------------------------
  4564     05  CMOENDTL PIC S9(0004) COMP.
  4565     05  CMOENDTF PIC  X(0001).
  4566     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  86
* EL6311.cbl
  4567         10  CMOENDTA PIC  X(0001).
  4568     05  CMOENDTI PIC  X(0008).
  4569*    -------------------------------
  4570     05  CCARRL PIC S9(0004) COMP.
  4571     05  CCARRF PIC  X(0001).
  4572     05  FILLER REDEFINES CCARRF.
  4573         10  CCARRA PIC  X(0001).
  4574     05  CCARRI PIC  X(0001).
  4575*    -------------------------------
  4576     05  CGROUPL PIC S9(0004) COMP.
  4577     05  CGROUPF PIC  X(0001).
  4578     05  FILLER REDEFINES CGROUPF.
  4579         10  CGROUPA PIC  X(0001).
  4580     05  CGROUPI PIC  X(0006).
  4581*    -------------------------------
  4582     05  CSTATEL PIC S9(0004) COMP.
  4583     05  CSTATEF PIC  X(0001).
  4584     05  FILLER REDEFINES CSTATEF.
  4585         10  CSTATEA PIC  X(0001).
  4586     05  CSTATEI PIC  X(0002).
  4587*    -------------------------------
  4588     05  CACCTL PIC S9(0004) COMP.
  4589     05  CACCTF PIC  X(0001).
  4590     05  FILLER REDEFINES CACCTF.
  4591         10  CACCTA PIC  X(0001).
  4592     05  CACCTI PIC  X(0010).
  4593*    -------------------------------
  4594     05  CORIGHDL PIC S9(0004) COMP.
  4595     05  CORIGHDF PIC  X(0001).
  4596     05  FILLER REDEFINES CORIGHDF.
  4597         10  CORIGHDA PIC  X(0001).
  4598     05  CORIGHDI PIC  X(0011).
  4599*    -------------------------------
  4600     05  CORGNOL PIC S9(0004) COMP.
  4601     05  CORGNOF PIC  X(0001).
  4602     05  FILLER REDEFINES CORGNOF.
  4603         10  CORGNOA PIC  X(0001).
  4604     05  CORGNOI PIC  X(0006).
  4605*    -------------------------------
  4606     05  CORGSEQL PIC S9(0004) COMP.
  4607     05  CORGSEQF PIC  X(0001).
  4608     05  FILLER REDEFINES CORGSEQF.
  4609         10  CORGSEQA PIC  X(0001).
  4610     05  CORGSEQI PIC  X(0004).
  4611*    -------------------------------
  4612     05  CREFHDGL PIC S9(0004) COMP.
  4613     05  CREFHDGF PIC  X(0001).
  4614     05  FILLER REDEFINES CREFHDGF.
  4615         10  CREFHDGA PIC  X(0001).
  4616     05  CREFHDGI PIC  X(0010).
  4617*    -------------------------------
  4618     05  CREFL PIC S9(0004) COMP.
  4619     05  CREFF PIC  X(0001).
  4620     05  FILLER REDEFINES CREFF.
  4621         10  CREFA PIC  X(0001).
  4622     05  CREFI PIC  X(0012).
  4623*    -------------------------------
  4624     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  87
* EL6311.cbl
  4625     05  CNHINTF PIC  X(0001).
  4626     05  FILLER REDEFINES CNHINTF.
  4627         10  CNHINTA PIC  X(0001).
  4628     05  CNHINTI PIC  9(7)V99.
  4629*    -------------------------------
  4630     05  CCERTNOL PIC S9(0004) COMP.
  4631     05  CCERTNOF PIC  X(0001).
  4632     05  FILLER REDEFINES CCERTNOF.
  4633         10  CCERTNOA PIC  X(0001).
  4634     05  CCERTNOI PIC  X(0010).
  4635*    -------------------------------
  4636     05  CSUFIXL PIC S9(0004) COMP.
  4637     05  CSUFIXF PIC  X(0001).
  4638     05  FILLER REDEFINES CSUFIXF.
  4639         10  CSUFIXA PIC  X(0001).
  4640     05  CSUFIXI PIC  X(0001).
  4641*    -------------------------------
  4642     05  CEFFDTL PIC S9(0004) COMP.
  4643     05  CEFFDTF PIC  X(0001).
  4644     05  FILLER REDEFINES CEFFDTF.
  4645         10  CEFFDTA PIC  X(0001).
  4646     05  CEFFDTI PIC  X(0008).
  4647*    -------------------------------
  4648     05  CLSTNML PIC S9(0004) COMP.
  4649     05  CLSTNMF PIC  X(0001).
  4650     05  FILLER REDEFINES CLSTNMF.
  4651         10  CLSTNMA PIC  X(0001).
  4652     05  CLSTNMI PIC  X(0015).
  4653*    -------------------------------
  4654     05  CINAMEL PIC S9(0004) COMP.
  4655     05  CINAMEF PIC  X(0001).
  4656     05  FILLER REDEFINES CINAMEF.
  4657         10  CINAMEA PIC  X(0001).
  4658     05  CINAMEI PIC  X(0015).
  4659*    -------------------------------
  4660     05  CINITSL PIC S9(0004) COMP.
  4661     05  CINITSF PIC  X(0001).
  4662     05  FILLER REDEFINES CINITSF.
  4663         10  CINITSA PIC  X(0001).
  4664     05  CINITSI PIC  X(0010).
  4665*    -------------------------------
  4666     05  CCANREAL PIC S9(0004) COMP.
  4667     05  CCANREAF PIC  X(0001).
  4668     05  FILLER REDEFINES CCANREAF.
  4669         10  CCANREAA PIC  X(0001).
  4670     05  CCANREAI PIC  X(0001).
  4671*    -------------------------------
  4672     05  ACTSPCL PIC S9(0004) COMP.
  4673     05  ACTSPCF PIC  X(0001).
  4674     05  FILLER REDEFINES ACTSPCF.
  4675         10  ACTSPCA PIC  X(0001).
  4676     05  ACTSPCI PIC  X(0001).
  4677*    -------------------------------
  4678     05  CKIND1L PIC S9(0004) COMP.
  4679     05  CKIND1F PIC  X(0001).
  4680     05  FILLER REDEFINES CKIND1F.
  4681         10  CKIND1A PIC  X(0001).
  4682     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  88
* EL6311.cbl
  4683*    -------------------------------
  4684     05  CCANDT1L PIC S9(0004) COMP.
  4685     05  CCANDT1F PIC  X(0001).
  4686     05  FILLER REDEFINES CCANDT1F.
  4687         10  CCANDT1A PIC  X(0001).
  4688     05  CCANDT1I PIC  X(0008).
  4689*    -------------------------------
  4690     05  CREFND1L PIC S9(0004) COMP.
  4691     05  CREFND1F PIC  X(0001).
  4692     05  FILLER REDEFINES CREFND1F.
  4693         10  CREFND1A PIC  X(0001).
  4694     05  CREFND1I PIC  S9(9)V99.
  4695*    -------------------------------
  4696     05  CMTHD1L PIC S9(0004) COMP.
  4697     05  CMTHD1F PIC  X(0001).
  4698     05  FILLER REDEFINES CMTHD1F.
  4699         10  CMTHD1A PIC  X(0001).
  4700     05  CMTHD1I PIC  X(0001).
  4701*    -------------------------------
  4702     05  CKIND2L PIC S9(0004) COMP.
  4703     05  CKIND2F PIC  X(0001).
  4704     05  FILLER REDEFINES CKIND2F.
  4705         10  CKIND2A PIC  X(0001).
  4706     05  CKIND2I PIC  X(0002).
  4707*    -------------------------------
  4708     05  CCANDT2L PIC S9(0004) COMP.
  4709     05  CCANDT2F PIC  X(0001).
  4710     05  FILLER REDEFINES CCANDT2F.
  4711         10  CCANDT2A PIC  X(0001).
  4712     05  CCANDT2I PIC  X(0008).
  4713*    -------------------------------
  4714     05  CREFND2L PIC S9(0004) COMP.
  4715     05  CREFND2F PIC  X(0001).
  4716     05  FILLER REDEFINES CREFND2F.
  4717         10  CREFND2A PIC  X(0001).
  4718     05  CREFND2I PIC  S9(9)V99.
  4719*    -------------------------------
  4720     05  CMTHD2L PIC S9(0004) COMP.
  4721     05  CMTHD2F PIC  X(0001).
  4722     05  FILLER REDEFINES CMTHD2F.
  4723         10  CMTHD2A PIC  X(0001).
  4724     05  CMTHD2I PIC  X(0001).
  4725*    -------------------------------
  4726     05  CLIVESL PIC S9(0004) COMP.
  4727     05  CLIVESF PIC  X(0001).
  4728     05  FILLER REDEFINES CLIVESF.
  4729         10  CLIVESA PIC  X(0001).
  4730     05  CLIVESI PIC  X(0003).
  4731*    -------------------------------
  4732     05  CFORCEL PIC S9(0004) COMP.
  4733     05  CFORCEF PIC  X(0001).
  4734     05  FILLER REDEFINES CFORCEF.
  4735         10  CFORCEA PIC  X(0001).
  4736     05  CFORCEI PIC  X(0001).
  4737*    -------------------------------
  4738     05  CBILCDL PIC S9(0004) COMP.
  4739     05  CBILCDF PIC  X(0001).
  4740     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  89
* EL6311.cbl
  4741         10  CBILCDA PIC  X(0001).
  4742     05  CBILCDI PIC  X(0001).
  4743*    -------------------------------
  4744     05  CCRFND1L PIC S9(0004) COMP.
  4745     05  CCRFND1F PIC  X(0001).
  4746     05  FILLER REDEFINES CCRFND1F.
  4747         10  CCRFND1A PIC  X(0001).
  4748     05  CCRFND1I PIC  X(0011).
  4749*    -------------------------------
  4750     05  CCRFND2L PIC S9(0004) COMP.
  4751     05  CCRFND2F PIC  X(0001).
  4752     05  FILLER REDEFINES CCRFND2F.
  4753         10  CCRFND2A PIC  X(0001).
  4754     05  CCRFND2I PIC  X(0011).
  4755*    -------------------------------
  4756     05  CBILIT1L PIC S9(0004) COMP.
  4757     05  CBILIT1F PIC  X(0001).
  4758     05  FILLER REDEFINES CBILIT1F.
  4759         10  CBILIT1A PIC  X(0001).
  4760     05  CBILIT1I PIC  X(0008).
  4761*    -------------------------------
  4762     05  CDRFND1L PIC S9(0004) COMP.
  4763     05  CDRFND1F PIC  X(0001).
  4764     05  FILLER REDEFINES CDRFND1F.
  4765         10  CDRFND1A PIC  X(0001).
  4766     05  CDRFND1I PIC  X(0011).
  4767*    -------------------------------
  4768     05  CBILIT2L PIC S9(0004) COMP.
  4769     05  CBILIT2F PIC  X(0001).
  4770     05  FILLER REDEFINES CBILIT2F.
  4771         10  CBILIT2A PIC  X(0001).
  4772     05  CBILIT2I PIC  X(0008).
  4773*    -------------------------------
  4774     05  CDRFND2L PIC S9(0004) COMP.
  4775     05  CDRFND2F PIC  X(0001).
  4776     05  FILLER REDEFINES CDRFND2F.
  4777         10  CDRFND2A PIC  X(0001).
  4778     05  CDRFND2I PIC  X(0011).
  4779*    -------------------------------
  4780     05  CCANTXTL PIC S9(0004) COMP.
  4781     05  CCANTXTF PIC  X(0001).
  4782     05  FILLER REDEFINES CCANTXTF.
  4783         10  CCANTXTA PIC  X(0001).
  4784     05  CCANTXTI PIC  X(0005).
  4785*    -------------------------------
  4786     05  CCANFEEL PIC S9(0004) COMP.
  4787     05  CCANFEEF PIC  X(0001).
  4788     05  FILLER REDEFINES CCANFEEF.
  4789         10  CCANFEEA PIC  X(0001).
  4790     05  CCANFEEI PIC  X(0002).
  4791*    -------------------------------
  4792     05  CTERM1L PIC S9(0004) COMP.
  4793     05  CTERM1F PIC  X(0001).
  4794     05  FILLER REDEFINES CTERM1F.
  4795         10  CTERM1A PIC  X(0001).
  4796     05  CTERM1I PIC  X(0003).
  4797*    -------------------------------
  4798     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  90
* EL6311.cbl
  4799     05  CRTERM1F PIC  X(0001).
  4800     05  FILLER REDEFINES CRTERM1F.
  4801         10  CRTERM1A PIC  X(0001).
  4802     05  CRTERM1I PIC  X(0003).
  4803*    -------------------------------
  4804     05  CPREM1L PIC S9(0004) COMP.
  4805     05  CPREM1F PIC  X(0001).
  4806     05  FILLER REDEFINES CPREM1F.
  4807         10  CPREM1A PIC  X(0001).
  4808     05  CPREM1I PIC  X(0011).
  4809*    -------------------------------
  4810     05  CTERM2L PIC S9(0004) COMP.
  4811     05  CTERM2F PIC  X(0001).
  4812     05  FILLER REDEFINES CTERM2F.
  4813         10  CTERM2A PIC  X(0001).
  4814     05  CTERM2I PIC  X(0003).
  4815*    -------------------------------
  4816     05  CRTERM2L PIC S9(0004) COMP.
  4817     05  CRTERM2F PIC  X(0001).
  4818     05  FILLER REDEFINES CRTERM2F.
  4819         10  CRTERM2A PIC  X(0001).
  4820     05  CRTERM2I PIC  X(0003).
  4821*    -------------------------------
  4822     05  CPREM2L PIC S9(0004) COMP.
  4823     05  CPREM2F PIC  X(0001).
  4824     05  FILLER REDEFINES CPREM2F.
  4825         10  CPREM2A PIC  X(0001).
  4826     05  CPREM2I PIC  X(0011).
  4827*    -------------------------------
  4828     05  CENTRDTL PIC S9(0004) COMP.
  4829     05  CENTRDTF PIC  X(0001).
  4830     05  FILLER REDEFINES CENTRDTF.
  4831         10  CENTRDTA PIC  X(0001).
  4832     05  CENTRDTI PIC  X(0008).
  4833*    -------------------------------
  4834     05  CPAYEEL PIC S9(0004) COMP.
  4835     05  CPAYEEF PIC  X(0001).
  4836     05  FILLER REDEFINES CPAYEEF.
  4837         10  CPAYEEA PIC  X(0001).
  4838     05  CPAYEEI PIC  X(0006).
  4839*    -------------------------------
  4840     05  CRFNDSWL PIC S9(0004) COMP.
  4841     05  CRFNDSWF PIC  X(0001).
  4842     05  FILLER REDEFINES CRFNDSWF.
  4843         10  CRFNDSWA PIC  X(0001).
  4844     05  CRFNDSWI PIC  X(0003).
  4845*    -------------------------------
  4846     05  CLFHDGL PIC S9(0004) COMP.
  4847     05  CLFHDGF PIC  X(0001).
  4848     05  FILLER REDEFINES CLFHDGF.
  4849         10  CLFHDGA PIC  X(0001).
  4850     05  CLFHDGI PIC  X(0006).
  4851*    -------------------------------
  4852     05  CAHHDGL PIC S9(0004) COMP.
  4853     05  CAHHDGF PIC  X(0001).
  4854     05  FILLER REDEFINES CAHHDGF.
  4855         10  CAHHDGA PIC  X(0001).
  4856     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  91
* EL6311.cbl
  4857*    -------------------------------
  4858     05  CENTDTL PIC S9(0004) COMP.
  4859     05  CENTDTF PIC  X(0001).
  4860     05  FILLER REDEFINES CENTDTF.
  4861         10  CENTDTA PIC  X(0001).
  4862     05  CENTDTI PIC  X(0008).
  4863*    -------------------------------
  4864     05  CENTBYL PIC S9(0004) COMP.
  4865     05  CENTBYF PIC  X(0001).
  4866     05  FILLER REDEFINES CENTBYF.
  4867         10  CENTBYA PIC  X(0001).
  4868     05  CENTBYI PIC  X(0004).
  4869*    -------------------------------
  4870     05  CCHGCNTL PIC S9(0004) COMP.
  4871     05  CCHGCNTF PIC  X(0001).
  4872     05  FILLER REDEFINES CCHGCNTF.
  4873         10  CCHGCNTA PIC  X(0001).
  4874     05  CCHGCNTI PIC  X(0003).
  4875*    -------------------------------
  4876     05  CLFREFNL PIC S9(0004) COMP.
  4877     05  CLFREFNF PIC  X(0001).
  4878     05  FILLER REDEFINES CLFREFNF.
  4879         10  CLFREFNA PIC  X(0001).
  4880     05  CLFREFNI PIC  X(0006).
  4881*    -------------------------------
  4882     05  CAHREFNL PIC S9(0004) COMP.
  4883     05  CAHREFNF PIC  X(0001).
  4884     05  FILLER REDEFINES CAHREFNF.
  4885         10  CAHREFNA PIC  X(0001).
  4886     05  CAHREFNI PIC  X(0006).
  4887*    -------------------------------
  4888     05  CREINCDL PIC S9(0004) COMP.
  4889     05  CREINCDF PIC  X(0001).
  4890     05  FILLER REDEFINES CREINCDF.
  4891         10  CREINCDA PIC  X(0001).
  4892     05  CREINCDI PIC  X(0003).
  4893*    -------------------------------
  4894     05  CAEFFDTL PIC S9(0004) COMP.
  4895     05  CAEFFDTF PIC  X(0001).
  4896     05  FILLER REDEFINES CAEFFDTF.
  4897         10  CAEFFDTA PIC  X(0001).
  4898     05  CAEFFDTI PIC  X(0008).
  4899*    -------------------------------
  4900     05  CAEXPDTL PIC S9(0004) COMP.
  4901     05  CAEXPDTF PIC  X(0001).
  4902     05  FILLER REDEFINES CAEXPDTF.
  4903         10  CAEXPDTA PIC  X(0001).
  4904     05  CAEXPDTI PIC  X(0008).
  4905*    -------------------------------
  4906     05  COMMLFL PIC S9(0004) COMP.
  4907     05  COMMLFF PIC  X(0001).
  4908     05  FILLER REDEFINES COMMLFF.
  4909         10  COMMLFA PIC  X(0001).
  4910     05  COMMLFI PIC  X(0006).
  4911*    -------------------------------
  4912     05  COMMAHL PIC S9(0004) COMP.
  4913     05  COMMAHF PIC  X(0001).
  4914     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  92
* EL6311.cbl
  4915         10  COMMAHA PIC  X(0001).
  4916     05  COMMAHI PIC  X(0006).
  4917*    -------------------------------
  4918     05  CERMSG1L PIC S9(0004) COMP.
  4919     05  CERMSG1F PIC  X(0001).
  4920     05  FILLER REDEFINES CERMSG1F.
  4921         10  CERMSG1A PIC  X(0001).
  4922     05  CERMSG1I PIC  X(0078).
  4923*    -------------------------------
  4924     05  CERMSG2L PIC S9(0004) COMP.
  4925     05  CERMSG2F PIC  X(0001).
  4926     05  FILLER REDEFINES CERMSG2F.
  4927         10  CERMSG2A PIC  X(0001).
  4928     05  CERMSG2I PIC  X(0078).
  4929*    -------------------------------
  4930     05  CERMSG3L PIC S9(0004) COMP.
  4931     05  CERMSG3F PIC  X(0001).
  4932     05  FILLER REDEFINES CERMSG3F.
  4933         10  CERMSG3A PIC  X(0001).
  4934     05  CERMSG3I PIC  X(0078).
  4935*    -------------------------------
  4936     05  CPFENTRL PIC S9(0004) COMP.
  4937     05  CPFENTRF PIC  X(0001).
  4938     05  FILLER REDEFINES CPFENTRF.
  4939         10  CPFENTRA PIC  X(0001).
  4940     05  CPFENTRI PIC  9(2).
  4941*    -------------------------------
  4942     05  CPF5HDRL PIC S9(0004) COMP.
  4943     05  CPF5HDRF PIC  X(0001).
  4944     05  FILLER REDEFINES CPF5HDRF.
  4945         10  CPF5HDRA PIC  X(0001).
  4946     05  CPF5HDRI PIC  X(0005).
  4947*    -------------------------------
  4948     05  CPF4HDRL PIC S9(0004) COMP.
  4949     05  CPF4HDRF PIC  X(0001).
  4950     05  FILLER REDEFINES CPF4HDRF.
  4951         10  CPF4HDRA PIC  X(0001).
  4952     05  CPF4HDRI PIC  X(0013).
  4953*    -------------------------------
  4954     05  CF15HDRL PIC S9(0004) COMP.
  4955     05  CF15HDRF PIC  X(0001).
  4956     05  FILLER REDEFINES CF15HDRF.
  4957         10  CF15HDRA PIC  X(0001).
  4958     05  CF15HDRI PIC  X(0022).
  4959 01  EL631CO REDEFINES EL631BI.
  4960     05  FILLER            PIC  X(0012).
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CDATEO PIC  X(0008).
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CTIMEO PIC  99.99.
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CHEADO PIC  X(0038).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  93
* EL6311.cbl
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CCHGO PIC  ZZZ9.
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CMAINTO PIC  X(0001).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CMANTBYO PIC  X(0004).
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CCHGHDGO PIC  X(0003).
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CMANTDTO PIC  X(0008).
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CMANTATO PIC  99.99.
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CCSRO PIC  X(0004).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CBATCHO PIC  X(0006).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CSEQO PIC  X(0004).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CMOENDTO PIC  X(0008).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CCARRO PIC  X(0001).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CGROUPO PIC  X(0006).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CSTATEO PIC  X(0002).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CACCTO PIC  X(0010).
  5015*    -------------------------------
  5016     05  FILLER            PIC  X(0003).
  5017     05  CORIGHDO PIC  X(0011).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  CORGNOO PIC  X(0006).
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  CORGSEQO PIC  X(0004).
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CREFHDGO PIC  X(0010).
  5027*    -------------------------------
  5028     05  FILLER            PIC  X(0003).
  5029     05  CREFO PIC  X(0012).
  5030*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  94
* EL6311.cbl
  5031     05  FILLER            PIC  X(0003).
  5032     05  CNHINTO PIC  ZZZZZ9.99.
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CCERTNOO PIC  X(0010).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  CSUFIXO PIC  X(0001).
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  CEFFDTO PIC  X(0008).
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  CLSTNMO PIC  X(0015).
  5045*    -------------------------------
  5046     05  FILLER            PIC  X(0003).
  5047     05  CINAMEO PIC  X(0015).
  5048*    -------------------------------
  5049     05  FILLER            PIC  X(0003).
  5050     05  CINITSO PIC  X(0010).
  5051*    -------------------------------
  5052     05  FILLER            PIC  X(0003).
  5053     05  CCANREAO PIC  X(0001).
  5054*    -------------------------------
  5055     05  FILLER            PIC  X(0003).
  5056     05  ACTSPCO PIC  X(0001).
  5057*    -------------------------------
  5058     05  FILLER            PIC  X(0003).
  5059     05  CKIND1O PIC  X(0002).
  5060*    -------------------------------
  5061     05  FILLER            PIC  X(0003).
  5062     05  CCANDT1O PIC  X(0008).
  5063*    -------------------------------
  5064     05  FILLER            PIC  X(0003).
  5065     05  CREFND1O PIC  Z(7).99-.
  5066*    -------------------------------
  5067     05  FILLER            PIC  X(0003).
  5068     05  CMTHD1O PIC  X(0001).
  5069*    -------------------------------
  5070     05  FILLER            PIC  X(0003).
  5071     05  CKIND2O PIC  X(0002).
  5072*    -------------------------------
  5073     05  FILLER            PIC  X(0003).
  5074     05  CCANDT2O PIC  X(0008).
  5075*    -------------------------------
  5076     05  FILLER            PIC  X(0003).
  5077     05  CREFND2O PIC  Z(7).99-.
  5078*    -------------------------------
  5079     05  FILLER            PIC  X(0003).
  5080     05  CMTHD2O PIC  X(0001).
  5081*    -------------------------------
  5082     05  FILLER            PIC  X(0003).
  5083     05  CLIVESO PIC  X(0003).
  5084*    -------------------------------
  5085     05  FILLER            PIC  X(0003).
  5086     05  CFORCEO PIC  X(0001).
  5087*    -------------------------------
  5088     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  95
* EL6311.cbl
  5089     05  CBILCDO PIC  X(0001).
  5090*    -------------------------------
  5091     05  FILLER            PIC  X(0003).
  5092     05  CCRFND1O PIC  Z(7).99-.
  5093*    -------------------------------
  5094     05  FILLER            PIC  X(0003).
  5095     05  CCRFND2O PIC  Z(7).99-.
  5096*    -------------------------------
  5097     05  FILLER            PIC  X(0003).
  5098     05  CBILIT1O PIC  X(0008).
  5099*    -------------------------------
  5100     05  FILLER            PIC  X(0003).
  5101     05  CDRFND1O PIC  Z(7).99-.
  5102*    -------------------------------
  5103     05  FILLER            PIC  X(0003).
  5104     05  CBILIT2O PIC  X(0008).
  5105*    -------------------------------
  5106     05  FILLER            PIC  X(0003).
  5107     05  CDRFND2O PIC  Z(7).99-.
  5108*    -------------------------------
  5109     05  FILLER            PIC  X(0003).
  5110     05  CCANTXTO PIC  X(0005).
  5111*    -------------------------------
  5112     05  FILLER            PIC  X(0003).
  5113     05  CCANFEEO PIC  Z9.
  5114*    -------------------------------
  5115     05  FILLER            PIC  X(0003).
  5116     05  CTERM1O PIC  ZZ9.
  5117*    -------------------------------
  5118     05  FILLER            PIC  X(0003).
  5119     05  CRTERM1O PIC  ZZ9.
  5120*    -------------------------------
  5121     05  FILLER            PIC  X(0003).
  5122     05  CPREM1O PIC  ZZZZZZ9.99-.
  5123*    -------------------------------
  5124     05  FILLER            PIC  X(0003).
  5125     05  CTERM2O PIC  ZZ9.
  5126*    -------------------------------
  5127     05  FILLER            PIC  X(0003).
  5128     05  CRTERM2O PIC  ZZ9.
  5129*    -------------------------------
  5130     05  FILLER            PIC  X(0003).
  5131     05  CPREM2O PIC  ZZZZZZ9.99-.
  5132*    -------------------------------
  5133     05  FILLER            PIC  X(0003).
  5134     05  CENTRDTO PIC  X(0008).
  5135*    -------------------------------
  5136     05  FILLER            PIC  X(0003).
  5137     05  CPAYEEO PIC  X(0006).
  5138*    -------------------------------
  5139     05  FILLER            PIC  X(0003).
  5140     05  CRFNDSWO PIC  X(0003).
  5141*    -------------------------------
  5142     05  FILLER            PIC  X(0003).
  5143     05  CLFHDGO PIC  X(0006).
  5144*    -------------------------------
  5145     05  FILLER            PIC  X(0003).
  5146     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  96
* EL6311.cbl
  5147*    -------------------------------
  5148     05  FILLER            PIC  X(0003).
  5149     05  CENTDTO PIC  X(0008).
  5150*    -------------------------------
  5151     05  FILLER            PIC  X(0003).
  5152     05  CENTBYO PIC  X(0004).
  5153*    -------------------------------
  5154     05  FILLER            PIC  X(0003).
  5155     05  CCHGCNTO PIC  X(0003).
  5156*    -------------------------------
  5157     05  FILLER            PIC  X(0003).
  5158     05  CLFREFNO PIC  X(0006).
  5159*    -------------------------------
  5160     05  FILLER            PIC  X(0003).
  5161     05  CAHREFNO PIC  X(0006).
  5162*    -------------------------------
  5163     05  FILLER            PIC  X(0003).
  5164     05  CREINCDO PIC  X(0003).
  5165*    -------------------------------
  5166     05  FILLER            PIC  X(0003).
  5167     05  CAEFFDTO PIC  X(0008).
  5168*    -------------------------------
  5169     05  FILLER            PIC  X(0003).
  5170     05  CAEXPDTO PIC  X(0008).
  5171*    -------------------------------
  5172     05  FILLER            PIC  X(0003).
  5173     05  COMMLFO PIC  .99999.
  5174*    -------------------------------
  5175     05  FILLER            PIC  X(0003).
  5176     05  COMMAHO PIC  .99999.
  5177*    -------------------------------
  5178     05  FILLER            PIC  X(0003).
  5179     05  CERMSG1O PIC  X(0078).
  5180*    -------------------------------
  5181     05  FILLER            PIC  X(0003).
  5182     05  CERMSG2O PIC  X(0078).
  5183*    -------------------------------
  5184     05  FILLER            PIC  X(0003).
  5185     05  CERMSG3O PIC  X(0078).
  5186*    -------------------------------
  5187     05  FILLER            PIC  X(0003).
  5188     05  CPFENTRO PIC  X(0002).
  5189*    -------------------------------
  5190     05  FILLER            PIC  X(0003).
  5191     05  CPF5HDRO PIC  X(0005).
  5192*    -------------------------------
  5193     05  FILLER            PIC  X(0003).
  5194     05  CPF4HDRO PIC  X(0013).
  5195*    -------------------------------
  5196     05  FILLER            PIC  X(0003).
  5197     05  CF15HDRO PIC  X(0022).
  5198*    -------------------------------
  5199 01  EL631DI REDEFINES EL631BI.
  5200     05  FILLER            PIC  X(0012).
  5201*    -------------------------------
  5202     05  DDATEL PIC S9(0004) COMP.
  5203     05  DDATEF PIC  X(0001).
  5204     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  97
* EL6311.cbl
  5205         10  DDATEA PIC  X(0001).
  5206     05  DDATEI PIC  X(0008).
  5207*    -------------------------------
  5208     05  DTIMEL PIC S9(0004) COMP.
  5209     05  DTIMEF PIC  X(0001).
  5210     05  FILLER REDEFINES DTIMEF.
  5211         10  DTIMEA PIC  X(0001).
  5212     05  DTIMEI PIC  X(0005).
  5213*    -------------------------------
  5214     05  DHEADL PIC S9(0004) COMP.
  5215     05  DHEADF PIC  X(0001).
  5216     05  FILLER REDEFINES DHEADF.
  5217         10  DHEADA PIC  X(0001).
  5218     05  DHEADI PIC  X(0038).
  5219*    -------------------------------
  5220     05  DLDATEL PIC S9(0004) COMP.
  5221     05  DLDATEF PIC  X(0001).
  5222     05  FILLER REDEFINES DLDATEF.
  5223         10  DLDATEA PIC  X(0001).
  5224     05  DLDATEI PIC  X(0010).
  5225*    -------------------------------
  5226     05  DBATCHL PIC S9(0004) COMP.
  5227     05  DBATCHF PIC  X(0001).
  5228     05  FILLER REDEFINES DBATCHF.
  5229         10  DBATCHA PIC  X(0001).
  5230     05  DBATCHI PIC  X(0011).
  5231*    -------------------------------
  5232     05  DACCTNML PIC S9(0004) COMP.
  5233     05  DACCTNMF PIC  X(0001).
  5234     05  FILLER REDEFINES DACCTNMF.
  5235         10  DACCTNMA PIC  X(0001).
  5236     05  DACCTNMI PIC  X(0030).
  5237*    -------------------------------
  5238     05  DPROCDTL PIC S9(0004) COMP.
  5239     05  DPROCDTF PIC  X(0001).
  5240     05  FILLER REDEFINES DPROCDTF.
  5241         10  DPROCDTA PIC  X(0001).
  5242     05  DPROCDTI PIC  X(0008).
  5243*    -------------------------------
  5244     05  DINPUTL PIC S9(0004) COMP.
  5245     05  DINPUTF PIC  X(0001).
  5246     05  FILLER REDEFINES DINPUTF.
  5247         10  DINPUTA PIC  X(0001).
  5248     05  DINPUTI PIC  X(0008).
  5249*    -------------------------------
  5250     05  DMAINDTL PIC S9(0004) COMP.
  5251     05  DMAINDTF PIC  X(0001).
  5252     05  FILLER REDEFINES DMAINDTF.
  5253         10  DMAINDTA PIC  X(0001).
  5254     05  DMAINDTI PIC  X(0008).
  5255*    -------------------------------
  5256     05  DCARRL PIC S9(0004) COMP.
  5257     05  DCARRF PIC  X(0001).
  5258     05  FILLER REDEFINES DCARRF.
  5259         10  DCARRA PIC  X(0001).
  5260     05  DCARRI PIC  X(0001).
  5261*    -------------------------------
  5262     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  98
* EL6311.cbl
  5263     05  DGROUPF PIC  X(0001).
  5264     05  FILLER REDEFINES DGROUPF.
  5265         10  DGROUPA PIC  X(0001).
  5266     05  DGROUPI PIC  X(0006).
  5267*    -------------------------------
  5268     05  DSTATEL PIC S9(0004) COMP.
  5269     05  DSTATEF PIC  X(0001).
  5270     05  FILLER REDEFINES DSTATEF.
  5271         10  DSTATEA PIC  X(0001).
  5272     05  DSTATEI PIC  X(0002).
  5273*    -------------------------------
  5274     05  DACCTL PIC S9(0004) COMP.
  5275     05  DACCTF PIC  X(0001).
  5276     05  FILLER REDEFINES DACCTF.
  5277         10  DACCTA PIC  X(0001).
  5278     05  DACCTI PIC  X(0010).
  5279*    -------------------------------
  5280     05  DRECVDTL PIC S9(0004) COMP.
  5281     05  DRECVDTF PIC  X(0001).
  5282     05  FILLER REDEFINES DRECVDTF.
  5283         10  DRECVDTA PIC  X(0001).
  5284     05  DRECVDTI PIC  X(0008).
  5285*    -------------------------------
  5286     05  DCSRL PIC S9(0004) COMP.
  5287     05  DCSRF PIC  X(0001).
  5288     05  FILLER REDEFINES DCSRF.
  5289         10  DCSRA PIC  X(0001).
  5290     05  DCSRI PIC  X(0004).
  5291*    -------------------------------
  5292     05  DREFHDGL PIC S9(0004) COMP.
  5293     05  DREFHDGF PIC  X(0001).
  5294     05  FILLER REDEFINES DREFHDGF.
  5295         10  DREFHDGA PIC  X(0001).
  5296     05  DREFHDGI PIC  X(0010).
  5297*    -------------------------------
  5298     05  DREFL PIC S9(0004) COMP.
  5299     05  DREFF PIC  X(0001).
  5300     05  FILLER REDEFINES DREFF.
  5301         10  DREFA PIC  X(0001).
  5302     05  DREFI PIC  X(0012).
  5303*    -------------------------------
  5304     05  DLFPHDGL PIC S9(0004) COMP.
  5305     05  DLFPHDGF PIC  X(0001).
  5306     05  FILLER REDEFINES DLFPHDGF.
  5307         10  DLFPHDGA PIC  X(0001).
  5308     05  DLFPHDGI PIC  X(0010).
  5309*    -------------------------------
  5310     05  DAHPHDGL PIC S9(0004) COMP.
  5311     05  DAHPHDGF PIC  X(0001).
  5312     05  FILLER REDEFINES DAHPHDGF.
  5313         10  DAHPHDGA PIC  X(0001).
  5314     05  DAHPHDGI PIC  X(0010).
  5315*    -------------------------------
  5316     05  DLFRHDGL PIC S9(0004) COMP.
  5317     05  DLFRHDGF PIC  X(0001).
  5318     05  FILLER REDEFINES DLFRHDGF.
  5319         10  DLFRHDGA PIC  X(0001).
  5320     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  99
* EL6311.cbl
  5321*    -------------------------------
  5322     05  DAHRHDGL PIC S9(0004) COMP.
  5323     05  DAHRHDGF PIC  X(0001).
  5324     05  FILLER REDEFINES DAHRHDGF.
  5325         10  DAHRHDGA PIC  X(0001).
  5326     05  DAHRHDGI PIC  X(0009).
  5327*    -------------------------------
  5328     05  DRISSL PIC S9(0004) COMP.
  5329     05  DRISSF PIC  X(0001).
  5330     05  FILLER REDEFINES DRISSF.
  5331         10  DRISSA PIC  X(0001).
  5332     05  DRISSI PIC  X(0005).
  5333*    -------------------------------
  5334     05  DRLFPRML PIC S9(0004) COMP.
  5335     05  DRLFPRMF PIC  X(0001).
  5336     05  FILLER REDEFINES DRLFPRMF.
  5337         10  DRLFPRMA PIC  X(0001).
  5338     05  DRLFPRMI PIC  S9(9)V99.
  5339*    -------------------------------
  5340     05  DRAHPRML PIC S9(0004) COMP.
  5341     05  DRAHPRMF PIC  X(0001).
  5342     05  FILLER REDEFINES DRAHPRMF.
  5343         10  DRAHPRMA PIC  X(0001).
  5344     05  DRAHPRMI PIC  S9(9)V99.
  5345*    -------------------------------
  5346     05  DRCANCL PIC S9(0004) COMP.
  5347     05  DRCANCF PIC  X(0001).
  5348     05  FILLER REDEFINES DRCANCF.
  5349         10  DRCANCA PIC  X(0001).
  5350     05  DRCANCI PIC  X(0005).
  5351*    -------------------------------
  5352     05  DRLFRFDL PIC S9(0004) COMP.
  5353     05  DRLFRFDF PIC  X(0001).
  5354     05  FILLER REDEFINES DRLFRFDF.
  5355         10  DRLFRFDA PIC  X(0001).
  5356     05  DRLFRFDI PIC  S9(9)V99.
  5357*    -------------------------------
  5358     05  DRAHRFDL PIC S9(0004) COMP.
  5359     05  DRAHRFDF PIC  X(0001).
  5360     05  FILLER REDEFINES DRAHRFDF.
  5361         10  DRAHRFDA PIC  X(0001).
  5362     05  DRAHRFDI PIC  S9(9)V99.
  5363*    -------------------------------
  5364     05  DEISSL PIC S9(0004) COMP.
  5365     05  DEISSF PIC  X(0001).
  5366     05  FILLER REDEFINES DEISSF.
  5367         10  DEISSA PIC  X(0001).
  5368     05  DEISSI PIC  X(0005).
  5369*    -------------------------------
  5370     05  DELFPRML PIC S9(0004) COMP.
  5371     05  DELFPRMF PIC  X(0001).
  5372     05  FILLER REDEFINES DELFPRMF.
  5373         10  DELFPRMA PIC  X(0001).
  5374     05  DELFPRMI PIC  X(0011).
  5375*    -------------------------------
  5376     05  DEAHPRML PIC S9(0004) COMP.
  5377     05  DEAHPRMF PIC  X(0001).
  5378     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 100
* EL6311.cbl
  5379         10  DEAHPRMA PIC  X(0001).
  5380     05  DEAHPRMI PIC  X(0011).
  5381*    -------------------------------
  5382     05  DECANCL PIC S9(0004) COMP.
  5383     05  DECANCF PIC  X(0001).
  5384     05  FILLER REDEFINES DECANCF.
  5385         10  DECANCA PIC  X(0001).
  5386     05  DECANCI PIC  X(0005).
  5387*    -------------------------------
  5388     05  DELFRFDL PIC S9(0004) COMP.
  5389     05  DELFRFDF PIC  X(0001).
  5390     05  FILLER REDEFINES DELFRFDF.
  5391         10  DELFRFDA PIC  X(0001).
  5392     05  DELFRFDI PIC  X(0011).
  5393*    -------------------------------
  5394     05  DEAHRFDL PIC S9(0004) COMP.
  5395     05  DEAHRFDF PIC  X(0001).
  5396     05  FILLER REDEFINES DEAHRFDF.
  5397         10  DEAHRFDA PIC  X(0001).
  5398     05  DEAHRFDI PIC  X(0011).
  5399*    -------------------------------
  5400     05  DCISSL PIC S9(0004) COMP.
  5401     05  DCISSF PIC  X(0001).
  5402     05  FILLER REDEFINES DCISSF.
  5403         10  DCISSA PIC  X(0001).
  5404     05  DCISSI PIC  X(0005).
  5405*    -------------------------------
  5406     05  DCLFPRML PIC S9(0004) COMP.
  5407     05  DCLFPRMF PIC  X(0001).
  5408     05  FILLER REDEFINES DCLFPRMF.
  5409         10  DCLFPRMA PIC  X(0001).
  5410     05  DCLFPRMI PIC  X(0011).
  5411*    -------------------------------
  5412     05  DCAHPRML PIC S9(0004) COMP.
  5413     05  DCAHPRMF PIC  X(0001).
  5414     05  FILLER REDEFINES DCAHPRMF.
  5415         10  DCAHPRMA PIC  X(0001).
  5416     05  DCAHPRMI PIC  X(0011).
  5417*    -------------------------------
  5418     05  DCCANCL PIC S9(0004) COMP.
  5419     05  DCCANCF PIC  X(0001).
  5420     05  FILLER REDEFINES DCCANCF.
  5421         10  DCCANCA PIC  X(0001).
  5422     05  DCCANCI PIC  X(0005).
  5423*    -------------------------------
  5424     05  DCLFRFDL PIC S9(0004) COMP.
  5425     05  DCLFRFDF PIC  X(0001).
  5426     05  FILLER REDEFINES DCLFRFDF.
  5427         10  DCLFRFDA PIC  X(0001).
  5428     05  DCLFRFDI PIC  X(0011).
  5429*    -------------------------------
  5430     05  DCAHRFDL PIC S9(0004) COMP.
  5431     05  DCAHRFDF PIC  X(0001).
  5432     05  FILLER REDEFINES DCAHRFDF.
  5433         10  DCAHRFDA PIC  X(0001).
  5434     05  DCAHRFDI PIC  X(0011).
  5435*    -------------------------------
  5436     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 101
* EL6311.cbl
  5437     05  DOISSF PIC  X(0001).
  5438     05  FILLER REDEFINES DOISSF.
  5439         10  DOISSA PIC  X(0001).
  5440     05  DOISSI PIC  X(0005).
  5441*    -------------------------------
  5442     05  DOLFPRML PIC S9(0004) COMP.
  5443     05  DOLFPRMF PIC  X(0001).
  5444     05  FILLER REDEFINES DOLFPRMF.
  5445         10  DOLFPRMA PIC  X(0001).
  5446     05  DOLFPRMI PIC  X(0011).
  5447*    -------------------------------
  5448     05  DOAHPRML PIC S9(0004) COMP.
  5449     05  DOAHPRMF PIC  X(0001).
  5450     05  FILLER REDEFINES DOAHPRMF.
  5451         10  DOAHPRMA PIC  X(0001).
  5452     05  DOAHPRMI PIC  X(0011).
  5453*    -------------------------------
  5454     05  DOCANCL PIC S9(0004) COMP.
  5455     05  DOCANCF PIC  X(0001).
  5456     05  FILLER REDEFINES DOCANCF.
  5457         10  DOCANCA PIC  X(0001).
  5458     05  DOCANCI PIC  X(0005).
  5459*    -------------------------------
  5460     05  DOLFRFDL PIC S9(0004) COMP.
  5461     05  DOLFRFDF PIC  X(0001).
  5462     05  FILLER REDEFINES DOLFRFDF.
  5463         10  DOLFRFDA PIC  X(0001).
  5464     05  DOLFRFDI PIC  X(0011).
  5465*    -------------------------------
  5466     05  DOAHRFDL PIC S9(0004) COMP.
  5467     05  DOAHRFDF PIC  X(0001).
  5468     05  FILLER REDEFINES DOAHRFDF.
  5469         10  DOAHRFDA PIC  X(0001).
  5470     05  DOAHRFDI PIC  X(0011).
  5471*    -------------------------------
  5472     05  DITOTALL PIC S9(0004) COMP.
  5473     05  DITOTALF PIC  X(0001).
  5474     05  FILLER REDEFINES DITOTALF.
  5475         10  DITOTALA PIC  X(0001).
  5476     05  DITOTALI PIC  X(0005).
  5477*    -------------------------------
  5478     05  DIFATALL PIC S9(0004) COMP.
  5479     05  DIFATALF PIC  X(0001).
  5480     05  FILLER REDEFINES DIFATALF.
  5481         10  DIFATALA PIC  X(0001).
  5482     05  DIFATALI PIC  X(0005).
  5483*    -------------------------------
  5484     05  DIFORCEL PIC S9(0004) COMP.
  5485     05  DIFORCEF PIC  X(0001).
  5486     05  FILLER REDEFINES DIFORCEF.
  5487         10  DIFORCEA PIC  X(0001).
  5488     05  DIFORCEI PIC  X(0005).
  5489*    -------------------------------
  5490     05  DIHOLDL PIC S9(0004) COMP.
  5491     05  DIHOLDF PIC  X(0001).
  5492     05  FILLER REDEFINES DIHOLDF.
  5493         10  DIHOLDA PIC  X(0001).
  5494     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 102
* EL6311.cbl
  5495*    -------------------------------
  5496     05  DIAVAILL PIC S9(0004) COMP.
  5497     05  DIAVAILF PIC  X(0001).
  5498     05  FILLER REDEFINES DIAVAILF.
  5499         10  DIAVAILA PIC  X(0001).
  5500     05  DIAVAILI PIC  X(0005).
  5501*    -------------------------------
  5502     05  DIGPREML PIC S9(0004) COMP.
  5503     05  DIGPREMF PIC  X(0001).
  5504     05  FILLER REDEFINES DIGPREMF.
  5505         10  DIGPREMA PIC  X(0001).
  5506     05  DIGPREMI PIC  X(0011).
  5507*    -------------------------------
  5508     05  DIBPREML PIC S9(0004) COMP.
  5509     05  DIBPREMF PIC  X(0001).
  5510     05  FILLER REDEFINES DIBPREMF.
  5511         10  DIBPREMA PIC  X(0001).
  5512     05  DIBPREMI PIC  X(0011).
  5513*    -------------------------------
  5514     05  DCTOTALL PIC S9(0004) COMP.
  5515     05  DCTOTALF PIC  X(0001).
  5516     05  FILLER REDEFINES DCTOTALF.
  5517         10  DCTOTALA PIC  X(0001).
  5518     05  DCTOTALI PIC  X(0005).
  5519*    -------------------------------
  5520     05  DCFATALL PIC S9(0004) COMP.
  5521     05  DCFATALF PIC  X(0001).
  5522     05  FILLER REDEFINES DCFATALF.
  5523         10  DCFATALA PIC  X(0001).
  5524     05  DCFATALI PIC  X(0005).
  5525*    -------------------------------
  5526     05  DCFORCEL PIC S9(0004) COMP.
  5527     05  DCFORCEF PIC  X(0001).
  5528     05  FILLER REDEFINES DCFORCEF.
  5529         10  DCFORCEA PIC  X(0001).
  5530     05  DCFORCEI PIC  X(0005).
  5531*    -------------------------------
  5532     05  DCHOLDL PIC S9(0004) COMP.
  5533     05  DCHOLDF PIC  X(0001).
  5534     05  FILLER REDEFINES DCHOLDF.
  5535         10  DCHOLDA PIC  X(0001).
  5536     05  DCHOLDI PIC  X(0005).
  5537*    -------------------------------
  5538     05  DCAVAILL PIC S9(0004) COMP.
  5539     05  DCAVAILF PIC  X(0001).
  5540     05  FILLER REDEFINES DCAVAILF.
  5541         10  DCAVAILA PIC  X(0001).
  5542     05  DCAVAILI PIC  X(0005).
  5543*    -------------------------------
  5544     05  DCGPREML PIC S9(0004) COMP.
  5545     05  DCGPREMF PIC  X(0001).
  5546     05  FILLER REDEFINES DCGPREMF.
  5547         10  DCGPREMA PIC  X(0001).
  5548     05  DCGPREMI PIC  X(0011).
  5549*    -------------------------------
  5550     05  DCBPREML PIC S9(0004) COMP.
  5551     05  DCBPREMF PIC  X(0001).
  5552     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 103
* EL6311.cbl
  5553         10  DCBPREMA PIC  X(0001).
  5554     05  DCBPREMI PIC  X(0011).
  5555*    -------------------------------
  5556     05  DNTOTALL PIC S9(0004) COMP.
  5557     05  DNTOTALF PIC  X(0001).
  5558     05  FILLER REDEFINES DNTOTALF.
  5559         10  DNTOTALA PIC  X(0001).
  5560     05  DNTOTALI PIC  X(0005).
  5561*    -------------------------------
  5562     05  DNFATALL PIC S9(0004) COMP.
  5563     05  DNFATALF PIC  X(0001).
  5564     05  FILLER REDEFINES DNFATALF.
  5565         10  DNFATALA PIC  X(0001).
  5566     05  DNFATALI PIC  X(0005).
  5567*    -------------------------------
  5568     05  DNFORCEL PIC S9(0004) COMP.
  5569     05  DNFORCEF PIC  X(0001).
  5570     05  FILLER REDEFINES DNFORCEF.
  5571         10  DNFORCEA PIC  X(0001).
  5572     05  DNFORCEI PIC  X(0005).
  5573*    -------------------------------
  5574     05  DNHOLDL PIC S9(0004) COMP.
  5575     05  DNHOLDF PIC  X(0001).
  5576     05  FILLER REDEFINES DNHOLDF.
  5577         10  DNHOLDA PIC  X(0001).
  5578     05  DNHOLDI PIC  X(0005).
  5579*    -------------------------------
  5580     05  DNAVAILL PIC S9(0004) COMP.
  5581     05  DNAVAILF PIC  X(0001).
  5582     05  FILLER REDEFINES DNAVAILF.
  5583         10  DNAVAILA PIC  X(0001).
  5584     05  DNAVAILI PIC  X(0005).
  5585*    -------------------------------
  5586     05  DNGPREML PIC S9(0004) COMP.
  5587     05  DNGPREMF PIC  X(0001).
  5588     05  FILLER REDEFINES DNGPREMF.
  5589         10  DNGPREMA PIC  X(0001).
  5590     05  DNGPREMI PIC  X(0011).
  5591*    -------------------------------
  5592     05  DNBPREML PIC S9(0004) COMP.
  5593     05  DNBPREMF PIC  X(0001).
  5594     05  FILLER REDEFINES DNBPREMF.
  5595         10  DNBPREMA PIC  X(0001).
  5596     05  DNBPREMI PIC  X(0011).
  5597*    -------------------------------
  5598     05  DERMSGL PIC S9(0004) COMP.
  5599     05  DERMSGF PIC  X(0001).
  5600     05  FILLER REDEFINES DERMSGF.
  5601         10  DERMSGA PIC  X(0001).
  5602     05  DERMSGI PIC  X(0075).
  5603*    -------------------------------
  5604     05  DPFENTRL PIC S9(0004) COMP.
  5605     05  DPFENTRF PIC  X(0001).
  5606     05  FILLER REDEFINES DPFENTRF.
  5607         10  DPFENTRA PIC  X(0001).
  5608     05  DPFENTRI PIC  9(2).
  5609 01  EL631DO REDEFINES EL631BI.
  5610     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 104
* EL6311.cbl
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DDATEO PIC  X(0008).
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DTIMEO PIC  99.99.
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DHEADO PIC  X(0038).
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DLDATEO PIC  X(0010).
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DBATCHO PIC  X(0011).
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DACCTNMO PIC  X(0030).
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DPROCDTO PIC  X(0008).
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DINPUTO PIC  X(0008).
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DMAINDTO PIC  X(0008).
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DCARRO PIC  X(0001).
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DGROUPO PIC  X(0006).
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DSTATEO PIC  X(0002).
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DACCTO PIC  X(0010).
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DRECVDTO PIC  X(0008).
  5653*    -------------------------------
  5654     05  FILLER            PIC  X(0003).
  5655     05  DCSRO PIC  X(0004).
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DREFHDGO PIC  X(0010).
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DREFO PIC  X(0012).
  5662*    -------------------------------
  5663     05  FILLER            PIC  X(0003).
  5664     05  DLFPHDGO PIC  X(0010).
  5665*    -------------------------------
  5666     05  FILLER            PIC  X(0003).
  5667     05  DAHPHDGO PIC  X(0010).
  5668*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 105
* EL6311.cbl
  5669     05  FILLER            PIC  X(0003).
  5670     05  DLFRHDGO PIC  X(0009).
  5671*    -------------------------------
  5672     05  FILLER            PIC  X(0003).
  5673     05  DAHRHDGO PIC  X(0009).
  5674*    -------------------------------
  5675     05  FILLER            PIC  X(0003).
  5676     05  DRISSO PIC  ZZ99-.
  5677*    -------------------------------
  5678     05  FILLER            PIC  X(0003).
  5679     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5680*    -------------------------------
  5681     05  FILLER            PIC  X(0003).
  5682     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5683*    -------------------------------
  5684     05  FILLER            PIC  X(0003).
  5685     05  DRCANCO PIC  ZZ99-.
  5686*    -------------------------------
  5687     05  FILLER            PIC  X(0003).
  5688     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5689*    -------------------------------
  5690     05  FILLER            PIC  X(0003).
  5691     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5692*    -------------------------------
  5693     05  FILLER            PIC  X(0003).
  5694     05  DEISSO PIC  ZZ99-.
  5695*    -------------------------------
  5696     05  FILLER            PIC  X(0003).
  5697     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5698*    -------------------------------
  5699     05  FILLER            PIC  X(0003).
  5700     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5701*    -------------------------------
  5702     05  FILLER            PIC  X(0003).
  5703     05  DECANCO PIC  ZZ99-.
  5704*    -------------------------------
  5705     05  FILLER            PIC  X(0003).
  5706     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5707*    -------------------------------
  5708     05  FILLER            PIC  X(0003).
  5709     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5710*    -------------------------------
  5711     05  FILLER            PIC  X(0003).
  5712     05  DCISSO PIC  ZZ99-.
  5713*    -------------------------------
  5714     05  FILLER            PIC  X(0003).
  5715     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5716*    -------------------------------
  5717     05  FILLER            PIC  X(0003).
  5718     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5719*    -------------------------------
  5720     05  FILLER            PIC  X(0003).
  5721     05  DCCANCO PIC  ZZ99-.
  5722*    -------------------------------
  5723     05  FILLER            PIC  X(0003).
  5724     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5725*    -------------------------------
  5726     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 106
* EL6311.cbl
  5727     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5728*    -------------------------------
  5729     05  FILLER            PIC  X(0003).
  5730     05  DOISSO PIC  ZZ99-.
  5731*    -------------------------------
  5732     05  FILLER            PIC  X(0003).
  5733     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5734*    -------------------------------
  5735     05  FILLER            PIC  X(0003).
  5736     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5737*    -------------------------------
  5738     05  FILLER            PIC  X(0003).
  5739     05  DOCANCO PIC  ZZ99-.
  5740*    -------------------------------
  5741     05  FILLER            PIC  X(0003).
  5742     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5743*    -------------------------------
  5744     05  FILLER            PIC  X(0003).
  5745     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5746*    -------------------------------
  5747     05  FILLER            PIC  X(0003).
  5748     05  DITOTALO PIC  ZZZ99.
  5749*    -------------------------------
  5750     05  FILLER            PIC  X(0003).
  5751     05  DIFATALO PIC  ZZZ99.
  5752*    -------------------------------
  5753     05  FILLER            PIC  X(0003).
  5754     05  DIFORCEO PIC  ZZZ99.
  5755*    -------------------------------
  5756     05  FILLER            PIC  X(0003).
  5757     05  DIHOLDO PIC  ZZZ99.
  5758*    -------------------------------
  5759     05  FILLER            PIC  X(0003).
  5760     05  DIAVAILO PIC  ZZZ99.
  5761*    -------------------------------
  5762     05  FILLER            PIC  X(0003).
  5763     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5764*    -------------------------------
  5765     05  FILLER            PIC  X(0003).
  5766     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5767*    -------------------------------
  5768     05  FILLER            PIC  X(0003).
  5769     05  DCTOTALO PIC  ZZZ99.
  5770*    -------------------------------
  5771     05  FILLER            PIC  X(0003).
  5772     05  DCFATALO PIC  ZZZ99.
  5773*    -------------------------------
  5774     05  FILLER            PIC  X(0003).
  5775     05  DCFORCEO PIC  ZZZ99.
  5776*    -------------------------------
  5777     05  FILLER            PIC  X(0003).
  5778     05  DCHOLDO PIC  ZZZ99.
  5779*    -------------------------------
  5780     05  FILLER            PIC  X(0003).
  5781     05  DCAVAILO PIC  ZZZ99.
  5782*    -------------------------------
  5783     05  FILLER            PIC  X(0003).
  5784     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 107
* EL6311.cbl
  5785*    -------------------------------
  5786     05  FILLER            PIC  X(0003).
  5787     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5788*    -------------------------------
  5789     05  FILLER            PIC  X(0003).
  5790     05  DNTOTALO PIC  ---99.
  5791*    -------------------------------
  5792     05  FILLER            PIC  X(0003).
  5793     05  DNFATALO PIC  ---99.
  5794*    -------------------------------
  5795     05  FILLER            PIC  X(0003).
  5796     05  DNFORCEO PIC  ---99.
  5797*    -------------------------------
  5798     05  FILLER            PIC  X(0003).
  5799     05  DNHOLDO PIC  ---99.
  5800*    -------------------------------
  5801     05  FILLER            PIC  X(0003).
  5802     05  DNAVAILO PIC  ---99.
  5803*    -------------------------------
  5804     05  FILLER            PIC  X(0003).
  5805     05  DNGPREMO PIC  -------9.99.
  5806*    -------------------------------
  5807     05  FILLER            PIC  X(0003).
  5808     05  DNBPREMO PIC  -------9.99.
  5809*    -------------------------------
  5810     05  FILLER            PIC  X(0003).
  5811     05  DERMSGO PIC  X(0075).
  5812*    -------------------------------
  5813     05  FILLER            PIC  X(0003).
  5814     05  DPFENTRO PIC  X(0002).
  5815*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 108
* EL6311.cbl
  5817 01  MAP-B REDEFINES EL631BI.
  5818     12  FILLER                  PIC X(595).
  5819*    12  FILLER                  PIC X(591).
  5820*    12  FILLER                  PIC X(512).
  5821*    12  FILLER                  PIC X(510).
  5822     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5823         16  BKIND-LEN               PIC S9(4)  COMP.
  5824         16  BKIND-ATTRB             PIC X.
  5825         16  BKIND                   PIC XX.
  5826         16  BTYPE-LEN               PIC S9(4)  COMP.
  5827         16  BTYPE-ATTRB             PIC X.
  5828         16  BTYPE                   PIC X(3).
  5829         16  BTERM-LEN               PIC S9(4)  COMP.
  5830         16  BTERM-ATTRB             PIC X.
  5831         16  BTERMI                  PIC 999.
  5832         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5833         16  BBEN-LEN                PIC S9(4)  COMP.
  5834         16  BBEN-ATTRB              PIC X.
  5835         16  BBENI                   PIC 9(10)V99.
  5836*        16  BBENI                   PIC 9(12).
  5837         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5838         16  BPREM-LEN               PIC S9(4)  COMP.
  5839         16  BPREM-ATTRB             PIC X.
  5840         16  BPREMI                  PIC S9(9)V99.
  5841*        16  BPREMI                  PIC 9(11).
  5842         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5843         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5844         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5845         16  BEXPIRE-ATTRB           PIC X.
  5846         16  BEXPIRE                 PIC X(8).
  5847         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5848         16  BCRIT-PERD-ATTRB        PIC X.
  5849         16  BCRIT-PERDI             PIC 99.
  5850         16  BCRIT-PERDO REDEFINES
  5851                         BCRIT-PERDI PIC ZZ.
  5852         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5853         16  BALT-BEN-ATTRB          PIC X.
  5854         16  BALT-BENI               PIC 9(10)V99.
  5855*        16  BALT-BENI               PIC 9(12).
  5856         16  BALT-BENO REDEFINES
  5857                           BALT-BENI PIC Z(9).ZZ.
  5858         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5859         16  BALT-PREM-ATTRB         PIC X.
  5860         16  BALT-PREMI              PIC 9(9)V99.
  5861*        16  BALT-PREMI              PIC 9(11).
  5862         16  BALT-PREMO REDEFINES
  5863                          BALT-PREMI PIC Z(7).ZZ-.
  5864         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5865         16  BBEN-CD-ATTRB           PIC X.
  5866         16  BBEN-CD                 PIC XXX.
  5867         16  BCPREM-LEN              PIC S9(4)  COMP.
  5868         16  BCPREM-ATTRB            PIC X.
  5869         16  BCPREMI                 PIC S9(9)V99.
  5870*        16  BCPREMI                 PIC X(11).
  5871         16  BCPREMO REDEFINES BCPREMI
  5872                                     PIC Z(7).99-.
  5873         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5874         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 109
* EL6311.cbl
  5875         16  BCALT-PREM              PIC Z(7).99-.
  5876         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5877         16  BBEN-ABBR-ATTRB         PIC X.
  5878         16  BBEN-ABBR               PIC X(5).
  5879         16  BDIFF-LEN               PIC S9(4)  COMP.
  5880         16  BDIFF-ATTRB             PIC X.
  5881         16  BDIFFO                  PIC Z(7).99-.
  5882         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5883         16  BBILL-LIT-ATTRB         PIC X.
  5884         16  BBILL-LIT               PIC X(8).
  5885         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5886         16  BDALT-PREM-ATTRB        PIC X.
  5887         16  BDALT-PREM              PIC Z(7).99-.
  5888
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 110
* EL6311.cbl
  5890
  5891****************************************************************
  5892*
  5893* Copyright (c) 2007-2013 Dell Inc.
  5894* All rights reserved.
  5895*
  5896****************************************************************
  5897 01  DFHEIV.
  5898   02  DFHEIV0               PIC X(35).
  5899   02  DFHEIV1               PIC X(08).
  5900   02  DFHEIV2               PIC X(08).
  5901   02  DFHEIV3               PIC X(08).
  5902   02  DFHEIV4               PIC X(06).
  5903   02  DFHEIV5               PIC X(04).
  5904   02  DFHEIV6               PIC X(04).
  5905   02  DFHEIV7               PIC X(02).
  5906   02  DFHEIV8               PIC X(02).
  5907   02  DFHEIV9               PIC X(01).
  5908   02  DFHEIV10              PIC S9(7) COMP-3.
  5909   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5910   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5911   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5912   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5913   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5914   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5915   02  DFHEIV17              PIC X(04).
  5916   02  DFHEIV18              PIC X(04).
  5917   02  DFHEIV19              PIC X(04).
  5918   02  DFHEIV20              USAGE IS POINTER.
  5919   02  DFHEIV21              USAGE IS POINTER.
  5920   02  DFHEIV22              USAGE IS POINTER.
  5921   02  DFHEIV23              USAGE IS POINTER.
  5922   02  DFHEIV24              USAGE IS POINTER.
  5923   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5924   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5925   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5926   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5927   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5928   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5929   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5930   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5931   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5932   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5933   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5934   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5935   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5936   02  FILLER                PIC X(02).
  5937   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5938   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5939   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5940   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5941   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5942   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5943   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5944 LINKAGE  SECTION.
  5945*****************************************************************
  5946*                                                               *
  5947* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 111
* EL6311.cbl
  5948* All rights reserved.                                          *
  5949*                                                               *
  5950*****************************************************************
  5951 01  dfheiblk.
  5952     02  eibtime          pic s9(7) comp-3.
  5953     02  eibdate          pic s9(7) comp-3.
  5954     02  eibtrnid         pic x(4).
  5955     02  eibtaskn         pic s9(7) comp-3.
  5956     02  eibtrmid         pic x(4).
  5957     02  dfheigdi         pic s9(4) comp.
  5958     02  eibcposn         pic s9(4) comp.
  5959     02  eibcalen         pic s9(4) comp.
  5960     02  eibaid           pic x(1).
  5961     02  eibfiller1       pic x(1).
  5962     02  eibfn            pic x(2).
  5963     02  eibfiller2       pic x(2).
  5964     02  eibrcode         pic x(6).
  5965     02  eibfiller3       pic x(2).
  5966     02  eibds            pic x(8).
  5967     02  eibreqid         pic x(8).
  5968     02  eibrsrce         pic x(8).
  5969     02  eibsync          pic x(1).
  5970     02  eibfree          pic x(1).
  5971     02  eibrecv          pic x(1).
  5972     02  eibsend          pic x(1).
  5973     02  eibatt           pic x(1).
  5974     02  eibeoc           pic x(1).
  5975     02  eibfmh           pic x(1).
  5976     02  eibcompl         pic x(1).
  5977     02  eibsig           pic x(1).
  5978     02  eibconf          pic x(1).
  5979     02  eiberr           pic x(1).
  5980     02  eibrldbk         pic x(1).
  5981     02  eiberrcd         pic x(4).
  5982     02  eibsynrb         pic x(1).
  5983     02  eibnodat         pic x(1).
  5984     02  eibfiller5       pic x(2).
  5985     02  eibresp          pic s9(8) comp.
  5986     02  eibresp2         pic s9(8) comp.
  5987     02  dfheigdj         pic s9(4) comp.
  5988     02  dfheigdk         pic s9(4) comp.
  5989 01  DFHCOMMAREA                 PIC X(1300).
  5990*                                COPY ERCPNDB.
  5991******************************************************************
  5992*                                                                *
  5993*                                                                *
  5994*                            ERCPNDB.                            *
  5995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5996*                            VMOD=2.025                          *
  5997*                                                                *
  5998*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5999*                                                                *
  6000******************************************************************
  6001*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6002*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6003******************************************************************
  6004*                                                                *
  6005*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 112
* EL6311.cbl
  6006*   FILE TYPE = VSAM,KSDS                                        *
  6007*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6008*                                                                *
  6009*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6010*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6011*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6012*                                                 RKP=13,LEN=36  *
  6013*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6014*                                      AND CHG-SEQ.)             *
  6015*                                                RKP=49,LEN=11   *
  6016*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6017*                                      AND CHG-SEQ.)             *
  6018*                                                RKP=60,LEN=15   *
  6019*                                                                *
  6020*   LOG = NO                                                     *
  6021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6022******************************************************************
  6023******************************************************************
  6024*                   C H A N G E   L O G
  6025*
  6026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6027*-----------------------------------------------------------------
  6028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6029* EFFECTIVE    NUMBER
  6030*-----------------------------------------------------------------
  6031* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6032* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6033* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6034* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6035* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6036* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6037* 032306                   PEMA  ADD BOW LOAN NUMBER
  6038* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6039* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6040* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6041* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6042* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6043* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6044* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6045* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6046* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6047* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6048* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6049* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6050* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6051******************************************************************
  6052
  6053 01  PENDING-BUSINESS.
  6054     12  PB-RECORD-ID                     PIC XX.
  6055         88  VALID-PB-ID                        VALUE 'PB'.
  6056
  6057     12  PB-CONTROL-PRIMARY.
  6058         16  PB-COMPANY-CD                PIC X.
  6059         16  PB-ENTRY-BATCH               PIC X(6).
  6060         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6061         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6062
  6063     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 113
* EL6311.cbl
  6064         16  PB-COMPANY-CD-A1             PIC X.
  6065         16  PB-CARRIER                   PIC X.
  6066         16  PB-GROUPING.
  6067             20  PB-GROUPING-PREFIX       PIC XXX.
  6068             20  PB-GROUPING-PRIME        PIC XXX.
  6069         16  PB-STATE                     PIC XX.
  6070         16  PB-ACCOUNT.
  6071             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6072             20  PB-ACCOUNT-PRIME         PIC X(6).
  6073         16  PB-CERT-EFF-DT               PIC XX.
  6074         16  PB-CERT-NO.
  6075             20  PB-CERT-PRIME            PIC X(10).
  6076             20  PB-CERT-SFX              PIC X.
  6077         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6078
  6079         16  PB-RECORD-TYPE               PIC X.
  6080             88  PB-MAILING-DATA                VALUE '0'.
  6081             88  PB-ISSUE                       VALUE '1'.
  6082             88  PB-CANCELLATION                VALUE '2'.
  6083             88  PB-BATCH-TRAILER               VALUE '9'.
  6084
  6085     12  PB-CONTROL-BY-ORIG-BATCH.
  6086         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6087         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6088         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6089         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6090
  6091     12  PB-CONTROL-BY-CSR.
  6092         16  PB-CSR-COMPANY-CD            PIC X.
  6093         16  PB-CSR-ID                    PIC X(4).
  6094         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6095         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6096         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6097******************************************************************
  6098*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6099******************************************************************
  6100
  6101     12  PB-LAST-MAINT-DT                 PIC XX.
  6102     12  PB-LAST-MAINT-BY                 PIC X(4).
  6103     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6104
  6105     12  PB-RECORD-BODY                   PIC X(375).
  6106
  6107     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6108         16  PB-CERT-ORIGIN               PIC X.
  6109             88  CLASIC-CREATED-CERT         VALUE '1'.
  6110         16  PB-I-NAME.
  6111             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6112             20  PB-I-INSURED-FIRST-NAME.
  6113                 24  PB-I-INSURED-1ST-INIT PIC X.
  6114                 24  FILLER                PIC X(9).
  6115             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6116         16  PB-I-AGE                     PIC S99   COMP-3.
  6117         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6118         16  PB-I-BIRTHDAY                PIC XX.
  6119         16  PB-I-INSURED-SEX             PIC X.
  6120             88  PB-SEX-MALE     VALUE 'M'.
  6121             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 114
* EL6311.cbl
  6122
  6123         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6124         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6125         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6126         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6127         16  PB-I-SKIP-CODE               PIC X.
  6128             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6129             88  PB-SKIP-JULY              VALUE '1'.
  6130             88  PB-SKIP-AUGUST            VALUE '2'.
  6131             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6132             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6133             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6134             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6135             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6136             88  PB-SKIP-JUNE              VALUE '8'.
  6137             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6138             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6139             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6140         16  PB-I-TERM-TYPE               PIC X.
  6141             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6142             88  PB-PAID-WEEKLY            VALUE 'W'.
  6143             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6144             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6145             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6146         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6147         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6148         16  PB-I-DATA-ENTRY-SW           PIC X.
  6149             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6150             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6151             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6152             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6153         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6154         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6155*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6156         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6157         16  PB-I-LETTER-REQD             PIC X.
  6158
  6159         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6160             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6161             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6162                                                   '90' THRU '99'.
  6163         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6164                                          PIC XX.
  6165         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6166         16  PB-I-AMOUNT-FINANCED REDEFINES
  6167                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6168         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6169         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6170                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6171         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6172         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6173         16  PB-I-CLP-AMOUNT REDEFINES
  6174                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6175         16  PB-I-LF-CALC-FLAG            PIC X.
  6176             88 PB-COMP-LF-PREM               VALUE '?'.
  6177         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6178         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6179         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 115
* EL6311.cbl
  6180         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6181         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6182         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6183         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6184         16  PB-I-LF-ABBR                 PIC XXX.
  6185         16  PB-I-LF-INPUT-CD             PIC XX.
  6186
  6187         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6188             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6189             88  PB-INVALID-AH               VALUE '  ' '00'
  6190                                                   '90' THRU '99'.
  6191         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6192         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6193         16  PB-I-AH-CALC-FLAG            PIC X.
  6194             88 PB-COMP-AH-PREM                  VALUE '?'.
  6195         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6196         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6197         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6198         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6199         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6200         16  PB-I-AH-ABBR                 PIC XXX.
  6201         16  PB-I-AH-INPUT-CD             PIC XXX.
  6202
  6203         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6204         16  PB-I-REIN-TABLE              PIC XXX.
  6205         16  PB-I-BUSINESS-TYPE           PIC 99.
  6206         16  PB-I-INDV-GRP-CD             PIC X.
  6207         16  PB-I-MORT-CODE.
  6208             20  PB-I-TABLE               PIC X.
  6209             20  PB-I-INTEREST            PIC XX.
  6210             20  PB-I-MORT-TYP            PIC X.
  6211         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6212         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6213         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6214         16  PB-I-INDV-GRP-OVRD           PIC X.
  6215         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6216         16  PB-I-SIG-SW                  PIC X.
  6217             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6218         16  PB-I-RATE-CLASS              PIC XX.
  6219         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6220         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6221         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6222         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6223         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6224         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6225         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6226         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6227         16  PB-I-OB-FLAG                 PIC X.
  6228             88  PB-I-OB                      VALUE 'B'.
  6229             88  PB-I-SUMMARY                 VALUE 'Z'.
  6230         16  PB-I-ENTRY-STATUS            PIC X.
  6231             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6232                                              'M' '5' '9' '2'.
  6233             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6234             88  PB-I-POLICY-PENDING          VALUE '2'.
  6235             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6236             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6237             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 116
* EL6311.cbl
  6238             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6239             88  PB-I-REIN-ONLY               VALUE '9'.
  6240             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6241             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6242             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6243             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6244         16  PB-I-INT-CODE                PIC X.
  6245             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6246             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6247         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6248         16  PB-I-SOC-SEC-NO              PIC X(11).
  6249         16  PB-I-MEMBER-NO               PIC X(12).
  6250         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6251*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6252         16  PB-I-OLD-LOF                 PIC XXX.
  6253         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6254         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6255         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6256         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6257         16  PB-I-LIFE-INDICATOR          PIC X.
  6258             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6259         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6260         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6261                                          PIC S9(5)V99    COMP-3.
  6262         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6263             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6264             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6265         16  PB-I-1ST-PMT-DT              PIC XX.
  6266         16  PB-I-JOINT-INSURED.
  6267             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6268             20 PB-I-JOINT-FIRST-NAME.
  6269                24  PB-I-JOINT-FIRST-INIT PIC X.
  6270                24  FILLER                PIC X(9).
  6271             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6272*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6273         16  PB-I-BENEFICIARY-NAME.
  6274             20  PB-I-BANK-NUMBER         PIC X(10).
  6275             20  FILLER                   PIC X(15).
  6276         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6277         16  PB-I-REFERENCE               PIC X(12).
  6278         16  FILLER REDEFINES PB-I-REFERENCE.
  6279             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6280             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6281             20  PB-I-CLP-STATE           PIC XX.
  6282         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6283             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6284             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6285             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6286         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6287         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6288         16  PB-I-RESIDENT-STATE          PIC XX.
  6289         16  PB-I-RATE-CODE               PIC X(4).
  6290         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6291         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6292         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6293         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6294         16  PB-I-BANK-NOCHRGB            PIC 99.
  6295         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 117
* EL6311.cbl
  6296         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6297
  6298     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6299         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6300             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6301         16  PB-C-CANCEL-ORIGIN           PIC X.
  6302             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6303         16  PB-C-LF-CANCEL-DT            PIC XX.
  6304         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6305         16  PB-C-LF-CALC-REQ             PIC X.
  6306             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6307         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6308         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6309         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6310             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6311         16  PB-C-AH-CANCEL-DT            PIC XX.
  6312         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6313         16  PB-C-AH-CALC-REQ             PIC X.
  6314             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6315         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6316         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6317         16  PB-C-LAST-NAME               PIC X(15).
  6318         16  PB-C-REFUND-SW               PIC X.
  6319             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6320             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6321         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6322         16  PB-C-PAYEE-CODE              PIC X(6).
  6323         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6324         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6325         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6326         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6327         16  PB-C-REFERENCE               PIC X(12).
  6328         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6329         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6330         16  PB-C-POST-CARD-IND           PIC X.
  6331         16  PB-C-CANCEL-REASON           PIC X.
  6332         16  PB-C-REF-INTERFACE-SW        PIC X.
  6333         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6334         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6335         16  FILLER                       PIC X(01).
  6336*        16  FILLER                       PIC X(18).
  6337         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6338*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6339         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6340         16  PB-CANCELED-CERT-DATA.
  6341             20  PB-CI-INSURED-NAME.
  6342                 24  PB-CI-LAST-NAME      PIC X(15).
  6343                 24  PB-CI-INITIALS       PIC XX.
  6344             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6345             20  PB-CI-INSURED-SEX        PIC X.
  6346             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6347             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6348             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6349             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6350             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6351             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6352             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6353             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 118
* EL6311.cbl
  6354             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6355             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6356             20  PB-CI-RATE-CLASS         PIC XX.
  6357             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6358             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6359             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6360             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6361             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6362             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6363             20  PB-CI-LF-ABBR            PIC X(3).
  6364             20  PB-CI-AH-ABBR            PIC X(3).
  6365             20  PB-CI-OB-FLAG            PIC X.
  6366                 88  PB-CI-OB                VALUE 'B'.
  6367             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6368                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6369                                           'M' '4' '5' '9' '2'.
  6370                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6371                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6372                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6373                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6374                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6375                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6376                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6377                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6378                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6379                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6380                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6381                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6382                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6383             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6384                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6385                                           'M' '4' '5' '9' '2'.
  6386                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6387                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6388                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6389                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6390                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6391                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6392                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6393                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6394                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6395                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6396                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6397                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6398                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6399             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6400             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6401             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6402             20  PB-CI-MEMBER-NO          PIC X(12).
  6403             20  PB-CI-INT-CODE           PIC X.
  6404                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6405                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6406             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6407             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6408             20  PB-CI-COMP-EXCP-SW       PIC X.
  6409                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6410                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6411             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 119
* EL6311.cbl
  6412             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6413             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6414             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6415             20  PB-CI-DEATH-DT           PIC XX.
  6416             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6417             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6418             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6419             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6420             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6421             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6422             20  PB-CI-ENTRY-DT              PIC XX.
  6423             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6424             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6425             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6426             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6427             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6428             20  PB-CI-OLD-LOF               PIC XXX.
  6429*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6430             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6431             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6432             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6433             20  PB-CI-INDV-GRP-CD           PIC X.
  6434             20  PB-CI-BENEFICIARY-NAME.
  6435                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6436                 24  FILLER                  PIC X(15).
  6437             20  PB-CI-NOTE-SW               PIC X.
  6438             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6439             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6440             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6441             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6442             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6443             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6444             20  PB-CI-FIRST-NAME            PIC X(10).
  6445             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6446
  6447         16  FILLER                       PIC X(13).
  6448*032306  16  FILLER                       PIC X(27).
  6449*        16  FILLER                       PIC X(46).
  6450
  6451     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6452         16  FILLER                       PIC X(10).
  6453         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6454         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6455         16  PB-M-INSURED-MID-INIT        PIC X.
  6456         16  PB-M-INSURED-AGE             PIC 99.
  6457         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6458         16  PB-M-INSURED-SEX             PIC X.
  6459         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6460         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6461         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6462         16  PB-M-INSURED-CITY-STATE.
  6463             20  PB-M-INSURED-CITY        PIC X(28).
  6464             20  PB-M-INSURED-STATE       PIC XX.
  6465         16  PB-M-INSURED-ZIP-CODE.
  6466             20  PB-M-INSURED-ZIP-PRIME.
  6467                 24  PB-M-INSURED-ZIP-1   PIC X.
  6468                     88  PB-M-CANADIAN-POST-CODE
  6469                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 120
* EL6311.cbl
  6470                 24  FILLER               PIC X(4).
  6471             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6472         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6473                                        PB-M-INSURED-ZIP-CODE.
  6474             20  PM-M-INS-CAN-POST1       PIC XXX.
  6475             20  PM-M-INS-CAN-POST2       PIC XXX.
  6476             20  FILLER                   PIC XXX.
  6477         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6478         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6479         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6480         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6481         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6482         16  PB-M-CRED-BENE-CITYST.
  6483             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6484             20  PB-M-CRED-BENE-STATE     PIC XX.
  6485         16  FILLER                       PIC X(92).
  6486
  6487     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6488         16  FILLER                       PIC X(10).
  6489         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6490         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6491         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6492         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6494         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6495         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6496         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6497         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6498         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6499         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6500         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6501         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6502         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6503         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6504         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6505         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6506         16  PB-ACCOUNT-NAME              PIC X(30).
  6507         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6508         16  PB-REFERENCE                 PIC X(12).
  6509         16  PB-B-RECEIVED-DT             PIC XX.
  6510         16  FILLER                       PIC X(234).
  6511
  6512     12  PB-RECORD-STATUS.
  6513         16  PB-CREDIT-SELECT-DT          PIC XX.
  6514         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6515         16  PB-BILLED-DT                 PIC XX.
  6516         16  PB-BILLING-STATUS            PIC X.
  6517             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6518             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6519             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6520         16  PB-RECORD-BILL               PIC X.
  6521             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6522             88  PB-RECORD-RETURNED           VALUE 'R'.
  6523             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6524             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6525             88  PB-OVERRIDE-AH               VALUE 'A'.
  6526             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6527         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 121
* EL6311.cbl
  6528             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6529             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6530             88  PB-REISSUED-CERT             VALUE 'E'.
  6531             88  PB-CASH-CERT                 VALUE 'C'.
  6532             88  PB-MONTHLY-CERT              VALUE 'M'.
  6533             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6534             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6535             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6536         16  PB-FORCE-CODE                PIC X.
  6537             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6538             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6539             88  PB-CANCEL-FORCE              VALUE '8'.
  6540             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6541             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6542             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6543             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6544             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6545             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6546             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6547             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6548         16  PB-FATAL-FLAG                PIC X.
  6549             88  PB-FATAL-ERRORS              VALUE 'X'.
  6550         16  PB-FORCE-ER-CD               PIC X.
  6551             88  PB-FORCE-ERRORS              VALUE 'F'.
  6552             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6553         16  PB-WARN-ER-CD                PIC X.
  6554             88  PB-WARNING-ERRORS            VALUE 'W'.
  6555         16  FILLER                       PIC X.
  6556         16  PB-OUT-BAL-CD                PIC X.
  6557             88  PB-OUT-OF-BAL                VALUE 'O'.
  6558         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6559         16  PB-AH-OVERRIDE-L1            PIC X.
  6560         16  PB-INPUT-DT                  PIC XX.
  6561         16  PB-INPUT-BY                  PIC X(4).
  6562         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6563         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6564         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6565         16  PB-LF-EARNING-METHOD         PIC X.
  6566         16  PB-AH-EARNING-METHOD         PIC X.
  6567         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6568         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6569         16  PB-REIN-CD                   PIC XXX.
  6570         16  PB-LF-REFUND-TYPE            PIC X.
  6571         16  PB-AH-REFUND-TYPE            PIC X.
  6572         16  PB-ACCT-EFF-DT               PIC XX.
  6573         16  PB-ACCT-EXP-DT               PIC XX.
  6574         16  PB-COMPANY-ID                PIC X(3).
  6575         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6576         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6577         16  PB-SV-CARRIER                PIC X.
  6578         16  PB-SV-GROUPING               PIC X(6).
  6579         16  PB-SV-STATE                  PIC XX.
  6580         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6581         16  PB-GA-BILLING-INFO.
  6582             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6583                                          PIC XX.
  6584         16  PB-SV-REMIT-TO  REDEFINES
  6585             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 122
* EL6311.cbl
  6586         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6587         16  PB-I-LOAN-OFFICER            PIC X(5).
  6588         16  PB-I-VIN                     PIC X(17).
  6589
  6590         16  FILLER                       PIC X(04).
  6591         16  IMNET-BYPASS-SW              PIC X.
  6592
  6593******************************************************************
  6594*                COMMON EDIT ERRORS                              *
  6595******************************************************************
  6596
  6597     12  PB-COMMON-ERRORS.
  6598         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6599                                           PIC S9(4)     COMP.
  6600
  6601******************************************************************
  6602*                                COPY ELCCERT.
  6603******************************************************************
  6604*                                                                *
  6605*                            ELCCERT.                            *
  6606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6607*                            VMOD=2.013                          *
  6608*                                                                *
  6609*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6610*                                                                *
  6611*   FILE TYPE = VSAM,KSDS                                        *
  6612*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6613*                                                                *
  6614*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6615*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6616*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6617*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6618*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6619*                                                                *
  6620*   LOG = YES                                                    *
  6621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6622******************************************************************
  6623*                   C H A N G E   L O G
  6624*
  6625* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6626*-----------------------------------------------------------------
  6627*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6628* EFFECTIVE    NUMBER
  6629*-----------------------------------------------------------------
  6630* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6631* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6632* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6633* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6634* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6635* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6636* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6637* 032612  CR2011110200001  PEMA  AHL CHANGES
  6638* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6639* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6640* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6641******************************************************************
  6642
  6643 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 123
* EL6311.cbl
  6644     12  CM-RECORD-ID                      PIC XX.
  6645         88  VALID-CM-ID                      VALUE 'CM'.
  6646
  6647     12  CM-CONTROL-PRIMARY.
  6648         16  CM-COMPANY-CD                 PIC X.
  6649         16  CM-CARRIER                    PIC X.
  6650         16  CM-GROUPING.
  6651             20  CM-GROUPING-PREFIX        PIC X(3).
  6652             20  CM-GROUPING-PRIME         PIC X(3).
  6653         16  CM-STATE                      PIC XX.
  6654         16  CM-ACCOUNT.
  6655             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6656             20  CM-ACCOUNT-PRIME          PIC X(6).
  6657         16  CM-CERT-EFF-DT                PIC XX.
  6658         16  CM-CERT-NO.
  6659             20  CM-CERT-PRIME             PIC X(10).
  6660             20  CM-CERT-SFX               PIC X.
  6661
  6662     12  CM-CONTROL-BY-NAME.
  6663         16  CM-COMPANY-CD-A1              PIC X.
  6664         16  CM-INSURED-LAST-NAME          PIC X(15).
  6665         16  CM-INSURED-INITIALS.
  6666             20  CM-INSURED-INITIAL1       PIC X.
  6667             20  CM-INSURED-INITIAL2       PIC X.
  6668
  6669     12  CM-CONTROL-BY-SSN.
  6670         16  CM-COMPANY-CD-A2              PIC X.
  6671         16  CM-SOC-SEC-NO.
  6672             20  CM-SSN-STATE              PIC XX.
  6673             20  CM-SSN-ACCOUNT            PIC X(6).
  6674             20  CM-SSN-LN3.
  6675                 25  CM-INSURED-INITIALS-A2.
  6676                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6677                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6678                 25 CM-PART-LAST-NAME-A2         PIC X.
  6679
  6680     12  CM-CONTROL-BY-CERT-NO.
  6681         16  CM-COMPANY-CD-A4              PIC X.
  6682         16  CM-CERT-NO-A4                 PIC X(11).
  6683
  6684     12  CM-CONTROL-BY-MEMB.
  6685         16  CM-COMPANY-CD-A5              PIC X.
  6686         16  CM-MEMBER-NO.
  6687             20  CM-MEMB-STATE             PIC XX.
  6688             20  CM-MEMB-ACCOUNT           PIC X(6).
  6689             20  CM-MEMB-LN4.
  6690                 25  CM-INSURED-INITIALS-A5.
  6691                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6692                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6693                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6694
  6695     12  CM-INSURED-PROFILE-DATA.
  6696         16  CM-INSURED-FIRST-NAME.
  6697             20  CM-INSURED-1ST-INIT       PIC X.
  6698             20  FILLER                    PIC X(9).
  6699         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6700         16  CM-INSURED-SEX                PIC X.
  6701             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 124
* EL6311.cbl
  6702             88  CM-SEX-FEMAL                 VALUE 'F'.
  6703         16  CM-INSURED-JOINT-AGE          PIC 99.
  6704         16  CM-JOINT-INSURED-NAME.
  6705             20  CM-JT-LAST-NAME           PIC X(15).
  6706             20  CM-JT-FIRST-NAME.
  6707                 24  CM-JT-1ST-INIT        PIC X.
  6708                 24  FILLER                PIC X(9).
  6709             20  CM-JT-INITIAL             PIC X.
  6710
  6711     12  CM-LIFE-DATA.
  6712         16  CM-LF-BENEFIT-CD              PIC XX.
  6713         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6714         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6715         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6716         16  CM-LF-DEV-CODE                PIC XXX.
  6717         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6718         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6719         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6720         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6721         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6722         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6723         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6724         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6725         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6726         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6727         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6728         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6729         16  cm-temp-epiq                  pic xx.
  6730             88  EPIQ-CLASS                  value 'EQ'.
  6731*        16  FILLER                        PIC XX.
  6732
  6733     12  CM-AH-DATA.
  6734         16  CM-AH-BENEFIT-CD              PIC XX.
  6735         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6736         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6737         16  CM-AH-DEV-CODE                PIC XXX.
  6738         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6739         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6740         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6741         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6742         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6743         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6744         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6745         16  CM-AH-PAID-THRU-DT            PIC XX.
  6746             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6747         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6748         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6749         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6750         16  FILLER                        PIC X.
  6751
  6752     12  CM-LOAN-INFORMATION.
  6753         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6754         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6755                                           PIC S9(5)V99  COMP-3.
  6756         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6757         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6758         16  CM-PAY-FREQUENCY              PIC S99.
  6759         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 125
* EL6311.cbl
  6760         16  CM-RATE-CLASS                 PIC XX.
  6761         16  CM-BENEFICIARY                PIC X(25).
  6762         16  CM-POLICY-FORM-NO             PIC X(12).
  6763         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6764         16  CM-LAST-ADD-ON-DT             PIC XX.
  6765         16  CM-DEDUCTIBLE-AMOUNTS.
  6766             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6767             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6768         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6769             20  CM-RESIDENT-STATE         PIC XX.
  6770             20  CM-RATE-CODE              PIC X(4).
  6771             20  FILLER                    PIC XX.
  6772         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6773             20  CM-LOAN-OFFICER           PIC X(5).
  6774             20  FILLER                    PIC XXX.
  6775         16  CM-CSR-CODE                   PIC XXX.
  6776         16  CM-UNDERWRITING-CODE          PIC X.
  6777             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6778         16  CM-POST-CARD-IND              PIC X.
  6779         16  CM-REF-INTERFACE-SW           PIC X.
  6780         16  CM-PREMIUM-TYPE               PIC X.
  6781             88  CM-SING-PRM                  VALUE '1'.
  6782             88  CM-O-B-COVERAGE              VALUE '2'.
  6783             88  CM-OPEN-END                  VALUE '3'.
  6784         16  CM-IND-GRP-TYPE               PIC X.
  6785             88  CM-INDIVIDUAL                VALUE 'I'.
  6786             88  CM-GROUP                     VALUE 'G'.
  6787         16  CM-SKIP-CODE                  PIC X.
  6788             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6789             88  SKIP-JULY                    VALUE '1'.
  6790             88  SKIP-AUGUST                  VALUE '2'.
  6791             88  SKIP-SEPTEMBER               VALUE '3'.
  6792             88  SKIP-JULY-AUG                VALUE '4'.
  6793             88  SKIP-AUG-SEPT                VALUE '5'.
  6794             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6795             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6796             88  SKIP-JUNE                    VALUE '8'.
  6797             88  SKIP-JUNE-JULY               VALUE '9'.
  6798             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6799             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6800         16  CM-PAYMENT-MODE               PIC X.
  6801             88  PAY-MONTHLY                  VALUE SPACE.
  6802             88  PAY-WEEKLY                   VALUE '1'.
  6803             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6804             88  PAY-BI-WEEKLY                VALUE '3'.
  6805             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6806         16  CM-LOAN-NUMBER                PIC X(8).
  6807         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6808         16  CM-OLD-LOF                    PIC XXX.
  6809*        16  CM-LOAN-OFFICER               PIC XXX.
  6810         16  CM-REIN-TABLE                 PIC XXX.
  6811         16  CM-SPECIAL-REIN-CODE          PIC X.
  6812         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6813         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6814         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6815
  6816     12  CM-STATUS-DATA.
  6817         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 126
* EL6311.cbl
  6818         16  CM-ENTRY-DT                   PIC XX.
  6819
  6820         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6821         16  CM-LF-CANCEL-DT               PIC XX.
  6822         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6823
  6824         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6825         16  CM-LF-DEATH-DT                PIC XX.
  6826         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6827
  6828         16  CM-LF-CURRENT-STATUS          PIC X.
  6829             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6830                                                'M' '4' '5' '9'.
  6831             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6832             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6833             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6834             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6835             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6836             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6837             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6838             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6839             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6840             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6841             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6842             88  CM-LF-DECLINED               VALUE 'D'.
  6843             88  CM-LF-VOIDED                 VALUE 'V'.
  6844
  6845         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6846         16  CM-AH-CANCEL-DT               PIC XX.
  6847         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6848
  6849         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6850         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6851         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6852
  6853         16  CM-AH-CURRENT-STATUS          PIC X.
  6854             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6855                                                'M' '4' '5' '9'.
  6856             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6857             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6858             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6859             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6860             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6861             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6862             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6863             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6864             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6865             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6866             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6867             88  CM-AH-DECLINED               VALUE 'D'.
  6868             88  CM-AH-VOIDED                 VALUE 'V'.
  6869
  6870         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6871             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6872             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6873             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6874         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6875
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 127
* EL6311.cbl
  6876         16  CM-ENTRY-BATCH                PIC X(6).
  6877         16  CM-LF-EXIT-BATCH              PIC X(6).
  6878         16  CM-AH-EXIT-BATCH              PIC X(6).
  6879         16  CM-LAST-MONTH-END             PIC XX.
  6880
  6881     12  CM-NOTE-SW                        PIC X.
  6882         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6883         88  CERT-NOTES-PRESENT               VALUE '1'.
  6884         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6885         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6886         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6887         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6888         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6889         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6890     12  CM-COMP-EXCP-SW                   PIC X.
  6891         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6892         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6893     12  CM-INSURED-ADDRESS-SW             PIC X.
  6894         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6895         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6896
  6897*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6898     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6899     12  FILLER                            PIC X.
  6900
  6901*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6902     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6903     12  FILLER                            PIC X.
  6904*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6905     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6906
  6907     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6908         88  CERT-ADDED-BATCH                 VALUE ' '.
  6909         88  CERT-ADDED-ONLINE                VALUE '1'.
  6910         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6911         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6912         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6913     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6914         88  CERT-AS-LOADED                   VALUE ' '.
  6915         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6916         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6917         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6918         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6919         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6920         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6921         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6922
  6923     12  CM-ACCOUNT-COMM-PCTS.
  6924         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6925         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6926
  6927     12  CM-USER-FIELD                     PIC X.
  6928     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6929     12  CM-CLP-STATE                      PIC XX.
  6930     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6931     12  CM-USER-RESERVED                  PIC XXX.
  6932     12  FILLER REDEFINES CM-USER-RESERVED.
  6933         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 128
* EL6311.cbl
  6934         16  F                             PIC X.
  6935******************************************************************
  6936*                                COPY ERCNOTE.
  6937******************************************************************
  6938*                                                                *
  6939*                                                                *
  6940*                            ERCNOTE                             *
  6941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6942*                            VMOD=2.003                          *
  6943*                                                                *
  6944*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6945*                                                                *
  6946*        FILE TYPE= VSAM,KSDS                                    *
  6947*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6948*                                                                *
  6949*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  6950*                                                                *
  6951*        LOG = YES                                               *
  6952*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6953*                                                                *
  6954******************************************************************
  6955*                   C H A N G E   L O G
  6956*
  6957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6958*-----------------------------------------------------------------
  6959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6960* EFFECTIVE    NUMBER
  6961*-----------------------------------------------------------------
  6962* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6963*                                FILE WILL CONTAIN BILLING NOTES O
  6964* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  6965******************************************************************
  6966
  6967 01  CERTIFICATE-NOTE.
  6968     12  CN-RECORD-ID                PIC  XX.
  6969         88  VALID-CN-ID                  VALUE 'CN'.
  6970
  6971     12  CN-CONTROL-PRIMARY.
  6972         16  CN-COMPANY-CD           PIC X.
  6973         16  CN-CARRIER              PIC X.
  6974         16  CN-GROUPING.
  6975             20 CN-GROUPING-PREFIX   PIC XXX.
  6976             20 CN-GROUPING-PRIME    PIC XXX.
  6977         16  CN-STATE                PIC XX.
  6978         16  CN-ACCOUNT.
  6979             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6980             20 CN-ACCOUNT-PRIME     PIC X(6).
  6981         16  CN-CERT-EFF-DT          PIC XX.
  6982         16  CN-CERT-NO.
  6983             20  CN-CERT-PRIME       PIC X(10).
  6984             20  CN-CERT-SFX         PIC X.
  6985         16  CN-RECORD-TYPE          PIC X.
  6986             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  6987             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  6988     12  CN-BILLING-START-LINE-NO    PIC 99.
  6989     12  CN-BILLING-END-LINE-NO      PIC 99.
  6990
  6991     12  CN-LINES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 129
* EL6311.cbl
  6992         16  CN-LINE OCCURS 10       PIC X(77).
  6993
  6994     12  CN-LAST-MAINT-DT            PIC XX.
  6995     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6996     12  CN-LAST-MAINT-USER          PIC X(4).
  6997     12  FILLER                      PIC X(5).
  6998******************************************************************
  6999*                                COPY ERCPNDM.
  7000******************************************************************
  7001*                                                                *
  7002*                                                                *
  7003*                            ERCPNDM                             *
  7004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7005*                            VMOD=2.003                          *
  7006*                                                                *
  7007*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  7008*                                                                *
  7009*   FILE TYPE = VSAM,KSDS                                        *
  7010*   RECORD SIZE = 374   RECFORM = FIX                            *
  7011*                                                                *
  7012*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7013*   ALTERNATE PATH    = NOT USED                                 *
  7014*                                                                *
  7015*   LOG = YES                                                    *
  7016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7017******************************************************************
  7018*                   C H A N G E   L O G
  7019*
  7020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7021*-----------------------------------------------------------------
  7022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7023* EFFECTIVE    NUMBER
  7024*-----------------------------------------------------------------
  7025* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7026* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7027* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7028* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7029******************************************************************
  7030
  7031 01  PENDING-MAILING-DATA.
  7032     12  PM-RECORD-ID                      PIC XX.
  7033         88  VALID-MA-ID                       VALUE 'PM'.
  7034
  7035     12  PM-CONTROL-PRIMARY.
  7036         16  PM-COMPANY-CD                 PIC X.
  7037         16  PM-ENTRY-BATCH                PIC X(6).
  7038         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7039         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7040
  7041     12  FILLER                            PIC X(14).
  7042
  7043     12  PM-ACCESS-CONTROL.
  7044         16  PM-SOURCE-SYSTEM              PIC XX.
  7045             88  PM-FROM-CREDIT                VALUE 'CR'.
  7046             88  PM-FROM-VSI                   VALUE 'VS'.
  7047             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7048             88  PM-FROM-OTHER                 VALUE 'OT'.
  7049         16  PM-RECORD-ADD-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 130
* EL6311.cbl
  7050         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7051         16  PM-LAST-MAINT-DT              PIC XX.
  7052         16  PM-LAST-MAINT-BY              PIC XXXX.
  7053         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7054
  7055     12  PM-PROFILE-INFO.
  7056         16  PM-QUALIFY-CODE-1             PIC XX.
  7057         16  PM-QUALIFY-CODE-2             PIC XX.
  7058         16  PM-QUALIFY-CODE-3             PIC XX.
  7059         16  PM-QUALIFY-CODE-4             PIC XX.
  7060         16  PM-QUALIFY-CODE-5             PIC XX.
  7061
  7062         16  PM-INSURED-LAST-NAME          PIC X(15).
  7063         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7064         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7065         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7066         16  PM-INSURED-BIRTH-DT           PIC XX.
  7067         16  PM-INSURED-SEX                PIC X.
  7068             88  PM-SEX-MALE                   VALUE 'M'.
  7069             88  PM-SEX-FEMALE                 VALUE 'F'.
  7070         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7071
  7072         16  PM-ADDRESS-CORRECTED          PIC X.
  7073         16  PM-JOINT-BIRTH-DT             PIC XX.
  7074*        16  FILLER                        PIC X(12).
  7075
  7076         16  PM-ADDRESS-LINE-1             PIC X(30).
  7077         16  PM-ADDRESS-LINE-2             PIC X(30).
  7078         16  PM-CITY-STATE.
  7079             20  PM-CITY                   PIC X(28).
  7080             20  PM-STATE                  PIC XX.
  7081         16  PM-ZIP.
  7082             20  PM-ZIP-CODE.
  7083                 24  PM-ZIP-1              PIC X.
  7084                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7085                 24  FILLER                PIC X(4).
  7086             20  PM-ZIP-PLUS4              PIC X(4).
  7087         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7088             20  PM-CAN-POST1              PIC XXX.
  7089             20  PM-CAN-POST2              PIC XXX.
  7090             20  FILLER                    PIC XXX.
  7091
  7092         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7093         16  pm-city-st-zip-verified       pic x.
  7094         16  FILLER                        PIC XX.
  7095
  7096     12  PM-CRED-BENE-INFO.
  7097         16  PM-CRED-BENE-NAME             PIC X(25).
  7098         16  PM-CRED-BENE-ADDR             PIC X(30).
  7099         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7100         16  PM-CRED-BENE-CTYST.
  7101             20  PM-CRED-BENE-CITY         PIC X(28).
  7102             20  PM-CRED-BENE-STATE        PIC XX.
  7103         16  PM-CRED-BENE-ZIP.
  7104             20  PM-CB-ZIP-CODE.
  7105                 24  PM-CB-ZIP-1           PIC X.
  7106                     88  PM-CB-CANADIAN-POST-CODE
  7107                                  VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 131
* EL6311.cbl
  7108                 24  FILLER                PIC X(4).
  7109             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7110         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  7111             20  PM-CB-CAN-POST1           PIC XXX.
  7112             20  PM-CB-CAN-POST2           PIC XXX.
  7113             20  FILLER                    PIC XXX.
  7114     12  PM-POST-CARD-MAIL-DATA.
  7115         16  PM-MAIL-DATA OCCURS 7.
  7116             20  PM-MAIL-TYPE              PIC X.
  7117                 88  PM-12MO-MAILING           VALUE '1'.
  7118                 88  PM-EXP-MAILING            VALUE '2'.
  7119             20  PM-MAIL-STATUS            PIC X.
  7120                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7121                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7122                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7123             20  PM-MAIL-DATE              PIC XX.
  7124     12  FILLER                            PIC XX.
  7125     12  FILLER                            PIC X(12).
  7126*    12  FILLER                            PIC X(30).
  7127
  7128******************************************************************
  7129*                                COPY ERCMAIL.
  7130******************************************************************
  7131*                                                                *
  7132*                                                                *
  7133*                            ERCMAIL                             *
  7134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7135*                            VMOD=2.003                          *
  7136*                                                                *
  7137*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7138*                                                                *
  7139*   FILE TYPE = VSAM,KSDS                                        *
  7140*   RECORD SIZE = 374   RECFORM = FIX                            *
  7141*                                                                *
  7142*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7143*   ALTERNATE PATH    = NOT USED                                 *
  7144*                                                                *
  7145*   LOG = YES                                                    *
  7146*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7147******************************************************************
  7148*                   C H A N G E   L O G
  7149*
  7150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7151*-----------------------------------------------------------------
  7152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7153* EFFECTIVE    NUMBER
  7154*-----------------------------------------------------------------
  7155* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7156* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7157* 111108                   PEMA  ADD CRED BENE ADDR2
  7158******************************************************************
  7159
  7160 01  MAILING-DATA.
  7161     12  MA-RECORD-ID                      PIC XX.
  7162         88  VALID-MA-ID                       VALUE 'MA'.
  7163
  7164     12  MA-CONTROL-PRIMARY.
  7165         16  MA-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 132
* EL6311.cbl
  7166         16  MA-CARRIER                    PIC X.
  7167         16  MA-GROUPING.
  7168             20  MA-GROUPING-PREFIX        PIC XXX.
  7169             20  MA-GROUPING-PRIME         PIC XXX.
  7170         16  MA-STATE                      PIC XX.
  7171         16  MA-ACCOUNT.
  7172             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7173             20  MA-ACCOUNT-PRIME          PIC X(6).
  7174         16  MA-CERT-EFF-DT                PIC XX.
  7175         16  MA-CERT-NO.
  7176             20  MA-CERT-PRIME             PIC X(10).
  7177             20  MA-CERT-SFX               PIC X.
  7178
  7179     12  FILLER                            PIC XX.
  7180
  7181     12  MA-ACCESS-CONTROL.
  7182         16  MA-SOURCE-SYSTEM              PIC XX.
  7183             88  MA-FROM-CREDIT                VALUE 'CR'.
  7184             88  MA-FROM-VSI                   VALUE 'VS'.
  7185             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7186             88  MA-FROM-OTHER                 VALUE 'OT'.
  7187         16  MA-RECORD-ADD-DT              PIC XX.
  7188         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7189         16  MA-LAST-MAINT-DT              PIC XX.
  7190         16  MA-LAST-MAINT-BY              PIC XXXX.
  7191         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7192
  7193     12  MA-PROFILE-INFO.
  7194         16  MA-QUALIFY-CODE-1             PIC XX.
  7195         16  MA-QUALIFY-CODE-2             PIC XX.
  7196         16  MA-QUALIFY-CODE-3             PIC XX.
  7197         16  MA-QUALIFY-CODE-4             PIC XX.
  7198         16  MA-QUALIFY-CODE-5             PIC XX.
  7199
  7200         16  MA-INSURED-LAST-NAME          PIC X(15).
  7201         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7202         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7203         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7204         16  MA-INSURED-BIRTH-DT           PIC XX.
  7205         16  MA-INSURED-SEX                PIC X.
  7206             88  MA-SEX-MALE                   VALUE 'M'.
  7207             88  MA-SEX-FEMALE                 VALUE 'F'.
  7208         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7209
  7210         16  MA-ADDRESS-CORRECTED          PIC X.
  7211         16  MA-JOINT-BIRTH-DT             PIC XX.
  7212*        16  FILLER                        PIC X(12).
  7213
  7214         16  MA-ADDRESS-LINE-1             PIC X(30).
  7215         16  MA-ADDRESS-LINE-2             PIC X(30).
  7216         16  MA-CITY-STATE.
  7217             20  MA-CITY                   PIC X(28).
  7218             20  MA-ADDR-STATE             PIC XX.
  7219         16  MA-ZIP.
  7220             20  MA-ZIP-CODE.
  7221                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7222                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7223                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 133
* EL6311.cbl
  7224             20  MA-ZIP-PLUS4              PIC X(4).
  7225         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7226             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7227             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7228             20  FILLER                    PIC X(3).
  7229
  7230         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7231
  7232         16  FILLER                        PIC XXX.
  7233*        16  FILLER                        PIC X(10).
  7234
  7235     12  MA-CRED-BENE-INFO.
  7236         16  MA-CRED-BENE-NAME                 PIC X(25).
  7237         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7238         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7239         16  MA-CRED-BENE-CTYST.
  7240             20  MA-CRED-BENE-CITY             PIC X(28).
  7241             20  MA-CRED-BENE-STATE            PIC XX.
  7242         16  MA-CRED-BENE-ZIP.
  7243             20  MA-CB-ZIP-CODE.
  7244                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7245                     88  MA-CB-CANADIAN-POST-CODE
  7246                                           VALUE 'A' THRU 'Z'.
  7247                 24  FILLER                    PIC X(4).
  7248             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7249         16  MA-CB-CANADIAN-POSTAL-CODE
  7250                            REDEFINES MA-CRED-BENE-ZIP.
  7251             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7252             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7253             20  FILLER                        PIC X(3).
  7254     12  MA-POST-CARD-MAIL-DATA.
  7255         16  MA-MAIL-DATA OCCURS 7.
  7256             20  MA-MAIL-TYPE              PIC X.
  7257                 88  MA-12MO-MAILING           VALUE '1'.
  7258                 88  MA-EXP-MAILING            VALUE '2'.
  7259             20  MA-MAIL-STATUS            PIC X.
  7260                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7261                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7262                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7263             20  MA-MAIL-DATE              PIC XX.
  7264     12  FILLER                            PIC XX.
  7265     12  FILLER                            PIC XX.
  7266*    12  FILLER                            PIC X(30).
  7267******************************************************************
  7268*                                COPY ERCRQST.
  7269******************************************************************
  7270*                                                                *
  7271*                                                                *
  7272*                            ERCRQST.                            *
  7273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7274*                            VMOD=2.002                          *
  7275*                                                                *
  7276*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7277*                                                                *
  7278*   FILE TYPE = VSAM,KSDS                                        *
  7279*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7280*                                                                *
  7281*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 134
* EL6311.cbl
  7282*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7283*                                   ACCOUNT, REF, BATCH)         *
  7284*                                                RKP=9, LEN=38   *
  7285*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7286*                                   ACCOUNT, REF, BATCH)         *
  7287*                                                RKP=47, LEN=46  *
  7288*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7289*                                   BATCH)                       *
  7290*                                                RKP=93, LEN=24  *
  7291*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7292*                                   REF, BATCH)                  *
  7293*                                                RKP=117, LEN=35 *
  7294*   LOG = NO                                                     *
  7295*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7296******************************************************************
  7297
  7298 01  AR-REQUEST-RECORD.
  7299     12  RQ-RECORD-ID                     PIC XX.
  7300         88  VALID-RQ-ID                        VALUE 'RQ'.
  7301
  7302     12  RQ-CONTROL-PRIMARY.
  7303         16  RQ-COMPANY-CD                PIC X.
  7304         16  RQ-ENTRY-BATCH               PIC X(6).
  7305
  7306     12  RQ-CONTROL-BY-ACCT-REF.
  7307         16  RQ-COMPANY-CD-A1             PIC X.
  7308         16  RQ-CARRIER-A1                PIC X.
  7309         16  RQ-GROUPING-A1               PIC X(6).
  7310         16  RQ-STATE-A1                  PIC XX.
  7311         16  RQ-ACCOUNT-A1                PIC X(10).
  7312         16  RQ-REFERENCE-A1              PIC X(12).
  7313         16  RQ-BATCH-A1                  PIC X(6).
  7314
  7315     12  RQ-CONTROL-BY-FIN-RESP.
  7316         16  RQ-COMPANY-CD-A2             PIC X.
  7317         16  RQ-CARRIER-A2                PIC X.
  7318         16  RQ-GROUPING-A2               PIC X(6).
  7319         16  RQ-FIN-RESP-A2               PIC X(10).
  7320         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7321         16  RQ-REFERENCE-A2              PIC X(12).
  7322         16  RQ-BATCH-A2                  PIC X(6).
  7323
  7324     12  RQ-CONTROL-BY-ACCT-AGENT.
  7325         16  RQ-COMPANY-CD-A3             PIC X.
  7326         16  RQ-CARRIER-A3                PIC X.
  7327         16  RQ-GROUPING-A3               PIC X(6).
  7328         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7329         16  RQ-BATCH-A3                  PIC X(6).
  7330
  7331     12  RQ-CONTROL-BY-SUMMARY.
  7332         16  RQ-COMPANY-CD-A4             PIC X.
  7333         16  RQ-SUMMARY-CODE              PIC X(6).
  7334         16  RQ-ACCOUNT-A4                PIC X(10).
  7335         16  RQ-REFERENCE-A4              PIC X(12).
  7336         16  RQ-BATCH-A4                  PIC X(6).
  7337
  7338     12  RQ-REQUEST-METHOD                PIC X.
  7339         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 135
* EL6311.cbl
  7340         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7341         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7342         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7343     12  FILLER                           PIC X.
  7344     12  RQ-STATUS                        PIC X.
  7345         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7346         88  RQ-RESUBMIT                      VALUE 'R'.
  7347     12  RQ-PROCESSOR-ID                  PIC X(4).
  7348     12  RQ-ENTRY-DT                      PIC XX.
  7349     12  RQ-MO-END-DT                     PIC XX.
  7350     12  RQ-REQUEST-DT                    PIC XX.
  7351     12  RQ-STMT-DT                       PIC XX.
  7352     12  RQ-REVERSAL-DT                   PIC XX.
  7353     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7354     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7355
  7356     12  FILLER                           PIC X(27).
  7357
  7358******************************************************************
  7359
  7360*                                COPY ERCLOFC.
  7361******************************************************************
  7362*                                                                *
  7363*                                                                *
  7364*                            ERCLOFC                             *
  7365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7366*                            VMOD=2.003                          *
  7367*                                                                *
  7368*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7369*                                                                *
  7370*   FILE TYPE = VSAM,KSDS                                        *
  7371*   RECORD SIZE = 670   RECFORM = FIX                            *
  7372*                                                                *
  7373*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7374*                                                                *
  7375*   LOG = YES                                                    *
  7376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7377*                                                                *
  7378******************************************************************
  7379
  7380 01  LOAN-OFFICER-MASTER.
  7381     12  LO-RECORD-ID                PIC XX.
  7382         88  VALID-LO-ID                VALUE 'LO'.
  7383
  7384     12  LO-CONTROL-PRIMARY.
  7385         16  LO-COMPANY-CD           PIC X.
  7386         16  LO-CARRIER              PIC X.
  7387         16  LO-GROUPING.
  7388             20  LO-GROUPING-PREFIX  PIC XXX.
  7389             20  LO-GROUPING-PRIME   PIC XXX.
  7390         16  LO-STATE                PIC XX.
  7391         16  LO-ACCOUNT.
  7392             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7393             20  LO-ACCOUNT-PRIME    PIC X(6).
  7394         16  LO-OFFICER-CODE         PIC X(5).
  7395
  7396     12  LO-OFFICER-NAME             PIC X(30).
  7397
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 136
* EL6311.cbl
  7398     12  LO-LAST-MAINT-DT            PIC XX.
  7399     12  LO-LAST-USER                PIC X(4).
  7400     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7401
  7402     12  LO-COMP-CONTROL             PIC X.
  7403             88  LO-SHOW-COMP           VALUE 'Y'.
  7404             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7405     12  LO-DETAIL-CONTROL           PIC X.
  7406             88  LO-PRINT-DETAIL        VALUE 'D'.
  7407             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7408
  7409     12  LO-SV-CARRIER               PIC X.
  7410     12  LO-SV-GROUPING              PIC X(6).
  7411     12  LO-SV-STATE                 PIC XX.
  7412
  7413     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7414     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7415
  7416     12  LO-OFFICER-INFO.
  7417         16  FILLER OCCURS 12 TIMES.
  7418             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7419             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7420             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7421             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7422             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7423             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7424             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7425             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7426     12  FILLER                      PIC X(198).
  7427******************************************************************
  7428*                                COPY ERCPYAJ.
  7429******************************************************************
  7430*                                                                *
  7431*                            ERCPYAJ                             *
  7432*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7433*                            VMOD=2.015                          *
  7434*                                                                *
  7435*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7436*                                                                *
  7437*                                                                *
  7438*   FILE TYPE = VSAM,KSDS                                        *
  7439*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7440*                                                                *
  7441*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7442*       ALTERNATE PATHS = NONE                                   *
  7443*                                                                *
  7444*   LOG = YES                                                    *
  7445*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7446******************************************************************
  7447******************************************************************
  7448*                   C H A N G E   L O G
  7449*
  7450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7451*-----------------------------------------------------------------
  7452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7453* EFFECTIVE    NUMBER
  7454*-----------------------------------------------------------------
  7455* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 137
* EL6311.cbl
  7456* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7457******************************************************************
  7458
  7459 01  PENDING-PAY-ADJ.
  7460     12  PY-RECORD-ID                     PIC XX.
  7461         88  VALID-PY-ID                        VALUE 'PY'.
  7462
  7463     12  PY-CONTROL-PRIMARY.
  7464         16  PY-COMPANY-CD                PIC X.
  7465         16  PY-CARRIER                   PIC X.
  7466         16  PY-GROUPING                  PIC X(6).
  7467         16  PY-FIN-RESP                  PIC X(10).
  7468         16  PY-ACCOUNT                   PIC X(10).
  7469         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7470                                          PIC X(10).
  7471         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7472         16  PY-RECORD-TYPE               PIC X.
  7473             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7474             88  PY-DEPOSIT                   VALUE 'D'.
  7475             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7476             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7477             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7478             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7479             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7480             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7481             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7482             88  PY-FICA-ENTRY                VALUE 'F'.
  7483             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7484             88  PY-POLICY-FEE                VALUE 'W'.
  7485             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7486
  7487     12  PY-PYMT-TYPE                     PIC X.
  7488             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7489             88  PY-REINS-PYMT                VALUE 'R'.
  7490             88  PY-EXP-PYMT                  VALUE 'E'.
  7491
  7492     12  PY-BIL-INV                       PIC X(6).
  7493     12  PY-REF-NO                        PIC X(12).
  7494
  7495     12  PY-LAST-MAINT-DT                 PIC XX.
  7496     12  PY-LAST-MAINT-BY                 PIC X(4).
  7497     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7498
  7499     12  PY-PYADJ-RECORD.
  7500         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7501         16  PY-ENTRY-COMMENT             PIC X(30).
  7502         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7503             20  PY-GL-ACCOUNT            PIC X(10).
  7504             20  PY-GL-STATE              PIC X(02).
  7505             20  PY-GL-CANC-SW            PIC X(01).
  7506                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7507                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7508             20  PY-GL-COMMENT            PIC X(10).
  7509             20  FILLER      REDEFINES PY-GL-COMMENT.
  7510                 24  PY-GL-CHECK-NO       PIC 9(06).
  7511                 24  FILLER               PIC X(04).
  7512             20  FILLER                   PIC X(07).
  7513         16  PY-SAVE-ACCOUNT              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 138
* EL6311.cbl
  7514         16  PY-SAVE-TYPE                 PIC X(01).
  7515
  7516         16  PY-LETTERS.
  7517             20  PY-LETTER OCCURS 3 TIMES
  7518                           INDEXED BY PY-LET-NDX
  7519                                          PIC X(04).
  7520
  7521         16  PY-ERCOMP-TYPE               PIC X.
  7522             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7523             88  PY-GA-TYPE                   VALUE 'G'.
  7524             88  PY-BANK-TYPE                 VALUE 'B'.
  7525         16  FILLER                       PIC X(05).
  7526
  7527     12  PY-RECORD-STATUS.
  7528         16  PY-CREDIT-SELECT-DT          PIC XX.
  7529         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7530         16  PY-BILLED-DATE               PIC XX.
  7531         16  PY-REPORTED-DT               PIC XX.
  7532         16  PY-PMT-APPLIED               PIC X.
  7533             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7534             88  PY-GA-PMT                    VALUE 'G'.
  7535             88  PY-OVWRITE-PMT               VALUE 'O'.
  7536             88  PY-NON-AR-PMT                VALUE 'N'.
  7537         16  FILLER                       PIC X(5).
  7538         16  PY-INPUT-DT                  PIC XX.
  7539         16  PY-CHECK-NUMBER              PIC X(6).
  7540         16  PY-VOID-SW                   PIC X.
  7541             88  PY-CHECK-VOIDED              VALUE 'V'.
  7542         16  PY-CHECK-ORIGIN-SW           PIC X.
  7543             88  PY-BILLING-CHECK             VALUE 'B'.
  7544             88  PY-REFUND-CHECK              VALUE 'R'.
  7545             88  PY-GA-CHECK                  VALUE 'G'.
  7546             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7547             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7548         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7549         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7550         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7551         16  PY-BILL-FLAG                 PIC X.
  7552             88  PY-BILLED                    VALUE 'B'.
  7553         16  PY-AR-FLAG                   PIC X.
  7554             88  PY-AR-CYCLE                  VALUE 'C'.
  7555             88  PY-AR-MONTH-END              VALUE 'M'.
  7556         16  PY-AR-DATE                   PIC XX.
  7557
  7558     12  PY-GL-CODES.
  7559         16  PY-GL-DB                     PIC X(14).
  7560         16  PY-GL-CR                     PIC X(14).
  7561         16  PY-GL-FLAG                   PIC X.
  7562         16  PY-GL-DATE                   PIC XX.
  7563
  7564     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7565     12  FILLER                           PIC X(3).
  7566******************************************************************
  7567*                                COPY ERCCNOT.
  7568******************************************************************
  7569*                                                                *
  7570*                            ERCCNOT                             *
  7571*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 139
* EL6311.cbl
  7572*                            VMOD=2.003                          *
  7573*                                                                *
  7574*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7575*                                                                *
  7576*        FILE TYPE= VSAM,KSDS                                    *
  7577*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7578*                                                                *
  7579*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7580*                                                                *
  7581*        LOG = YES                                               *
  7582*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7583*                                                                *
  7584******************************************************************
  7585*                   C H A N G E   L O G
  7586*
  7587* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7588*-----------------------------------------------------------------
  7589*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7590* EFFECTIVE    NUMBER
  7591*-----------------------------------------------------------------
  7592* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7593******************************************************************
  7594
  7595 01  CERT-NOTE-FILE.
  7596     12  CZ-RECORD-ID                PIC  XX.
  7597         88  VALID-CZ-ID                  VALUE 'CZ'.
  7598
  7599     12  CZ-CONTROL-PRIMARY.
  7600         16  CZ-COMPANY-CD           PIC X.
  7601         16  CZ-CARRIER              PIC X.
  7602         16  CZ-GROUPING.
  7603             20 CZ-GROUPING-PREFIX   PIC XXX.
  7604             20 CZ-GROUPING-PRIME    PIC XXX.
  7605         16  CZ-STATE                PIC XX.
  7606         16  CZ-ACCOUNT.
  7607             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7608             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7609         16  CZ-CERT-EFF-DT          PIC XX.
  7610         16  CZ-CERT-NO.
  7611             20  CZ-CERT-PRIME       PIC X(10).
  7612             20  CZ-CERT-SFX         PIC X.
  7613         16  CZ-RECORD-TYPE          PIC X.
  7614             88  CERT-NOTE           VALUE '1'.
  7615             88  CLAIM-CERT-NOTE     VALUE '2'.
  7616         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7617
  7618     12  CZ-LAST-MAINT-DT            PIC XX.
  7619     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7620     12  CZ-LAST-MAINT-USER          PIC X(4).
  7621
  7622     12  CZ-NOTE-INFORMATION.
  7623         16  CZ-NOTE                 PIC X(63).
  7624         16  FILLER                  PIC X(39).
  7625******************************************************************
  7626*                                COPY ELCMSTR.
  7627******************************************************************
  7628*                                                                *
  7629*                            ELCMSTR.                            *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 140
* EL6311.cbl
  7630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7631*                            VMOD=2.012                          *
  7632*                                                                *
  7633*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7634*                                                                *
  7635*   FILE TYPE = VSAM,KSDS                                        *
  7636*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7637*                                                                *
  7638*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7639*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7640*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7641*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7642*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7643*                                                 RKP=75,LEN=21  *
  7644*                                                                *
  7645*   **** NOTE ****                                               *
  7646*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7647*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7648*                                                                *
  7649*   LOG = YES                                                    *
  7650*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7651******************************************************************
  7652*                   C H A N G E   L O G
  7653*
  7654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7655*-----------------------------------------------------------------
  7656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7657* EFFECTIVE    NUMBER
  7658*-----------------------------------------------------------------
  7659* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7660* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7661* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7662* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7663* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7664* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7665* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7666******************************************************************
  7667 01  CLAIM-MASTER.
  7668     12  CL-RECORD-ID                PIC XX.
  7669         88  VALID-CL-ID         VALUE 'CL'.
  7670
  7671     12  CL-CONTROL-PRIMARY.
  7672         16  CL-COMPANY-CD           PIC X.
  7673         16  CL-CARRIER              PIC X.
  7674         16  CL-CLAIM-NO             PIC X(7).
  7675         16  CL-CERT-NO.
  7676             20  CL-CERT-PRIME       PIC X(10).
  7677             20  CL-CERT-SFX         PIC X.
  7678
  7679     12  CL-CONTROL-BY-NAME.
  7680         16  CL-COMPANY-CD-A1        PIC X.
  7681         16  CL-INSURED-LAST-NAME    PIC X(15).
  7682         16  CL-INSURED-NAME.
  7683             20  CL-INSURED-1ST-NAME PIC X(12).
  7684             20  CL-INSURED-MID-INIT PIC X.
  7685
  7686     12  CL-CONTROL-BY-SSN.
  7687         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 141
* EL6311.cbl
  7688         16  CL-SOC-SEC-NO.
  7689             20  CL-SSN-STATE        PIC XX.
  7690             20  CL-SSN-ACCOUNT      PIC X(6).
  7691             20  CL-SSN-LN3          PIC X(3).
  7692
  7693     12  CL-CONTROL-BY-CERT-NO.
  7694         16  CL-COMPANY-CD-A4        PIC X.
  7695         16  CL-CERT-NO-A4.
  7696             20  CL-CERT-A4-PRIME    PIC X(10).
  7697             20  CL-CERT-A4-SFX      PIC X.
  7698
  7699     12  CL-CONTROL-BY-CCN.
  7700         16  CL-COMPANY-CD-A5        PIC X.
  7701         16  CL-CCN-A5.
  7702             20  CL-CCN.
  7703                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7704                 24  CL-CCN-PRIME-A5 PIC X(12).
  7705             20  CL-CCN-FILLER-A5    PIC X(4).
  7706
  7707     12  CL-INSURED-PROFILE-DATA.
  7708         16  CL-INSURED-BIRTH-DT     PIC XX.
  7709         16  CL-INSURED-SEX-CD       PIC X.
  7710             88  INSURED-IS-MALE        VALUE 'M'.
  7711             88  INSURED-IS-FEMALE      VALUE 'F'.
  7712             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7713         16  CL-INSURED-OCC-CD       PIC X(6).
  7714         16  FILLER                  PIC X(5).
  7715
  7716     12  CL-PROCESSING-INFO.
  7717         16  CL-PROCESSOR-ID         PIC X(4).
  7718         16  CL-CLAIM-STATUS         PIC X.
  7719             88  CLAIM-IS-OPEN          VALUE 'O'.
  7720             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7721         16  CL-CLAIM-TYPE           PIC X.
  7722*            88  AH-CLAIM               VALUE 'A'.
  7723*            88  LIFE-CLAIM             VALUE 'L'.
  7724*            88  PROPERTY-CLAIM         VALUE 'P'.
  7725*            88  IUI-CLAIM              VALUE 'I'.
  7726*            88  GAP-CLAIM              VALUE 'G'.
  7727*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7728*            88  OTHER-CLAIM            VALUE 'O'.
  7729         16  CL-CLAIM-PREM-TYPE      PIC X.
  7730             88  SINGLE-PREMIUM         VALUE '1'.
  7731             88  O-B-COVERAGE           VALUE '2'.
  7732             88  OPEN-END-COVERAGE      VALUE '3'.
  7733         16  CL-INCURRED-DT          PIC XX.
  7734         16  CL-REPORTED-DT          PIC XX.
  7735         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7736         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7737         16  CL-LAST-PMT-DT          PIC XX.
  7738         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7739         16  CL-PAID-THRU-DT         PIC XX.
  7740         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7741         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7742         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7743         16  CL-PMT-CALC-METHOD      PIC X.
  7744             88  CL-360-DAY-YR          VALUE '1'.
  7745             88  CL-365-DAY-YR          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 142
* EL6311.cbl
  7746             88  CL-FULL-MONTHS         VALUE '3'.
  7747         16  CL-CAUSE-CD             PIC X(6).
  7748
  7749         16  CL-PRIME-CERT-NO.
  7750             20  CL-PRIME-CERT-PRIME PIC X(10).
  7751             20  CL-PRIME-CERT-SFX   PIC X.
  7752
  7753         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7754             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7755             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7756
  7757         16  CL-MICROFILM-NO         PIC X(10).
  7758         16  FILLER REDEFINES CL-MICROFILM-NO.
  7759             20  CL-BENEFIT-PERIOD   PIC 99.
  7760             20  FILLER              PIC X(8).
  7761         16  CL-PROG-FORM-TYPE       PIC X.
  7762         16  CL-LAST-ADD-ON-DT       PIC XX.
  7763
  7764         16  CL-LAST-REOPEN-DT       PIC XX.
  7765         16  CL-LAST-CLOSE-DT        PIC XX.
  7766         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7767             88  FINAL-PAID             VALUE '1'.
  7768             88  CLAIM-DENIED           VALUE '2'.
  7769             88  AUTO-CLOSE             VALUE '3'.
  7770             88  MANUAL-CLOSE           VALUE '4'.
  7771             88  BENEFITS-CHANGED       VALUE 'C'.
  7772             88  SETUP-ERRORS           VALUE 'E'.
  7773         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7774         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7775         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7776             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7777         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7778         16  FILLER                  PIC X.
  7779
  7780     12  CL-CERTIFICATE-DATA.
  7781         16  CL-CERT-ORIGIN          PIC X.
  7782             88  CERT-WAS-ONLINE        VALUE '1'.
  7783             88  CERT-WAS-CREATED       VALUE '2'.
  7784             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7785         16  CL-CERT-KEY-DATA.
  7786             20  CL-CERT-CARRIER     PIC X.
  7787             20  CL-CERT-GROUPING    PIC X(6).
  7788             20  CL-CERT-STATE       PIC XX.
  7789             20  CL-CERT-ACCOUNT.
  7790                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7791                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7792             20  CL-CERT-EFF-DT      PIC XX.
  7793
  7794     12  CL-STATUS-CONTROLS.
  7795         16  CL-PRIORITY-CD          PIC X.
  7796             88  CONFIDENTIAL-DATA      VALUE '8'.
  7797             88  HIGHEST-PRIORITY       VALUE '9'.
  7798         16  CL-SUPV-ATTN-CD         PIC X.
  7799             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7800             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7801         16  CL-PURGED-DT            PIC XX.
  7802         16  CL-RESTORED-DT          PIC XX.
  7803         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 143
* EL6311.cbl
  7804         16  CL-NEXT-RESEND-DT       PIC XX.
  7805         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7806         16  CL-CRITICAL-PERIOD      PIC 99.
  7807*        16  FILLER                  PIC XX.
  7808         16  CL-LAST-MAINT-DT        PIC XX.
  7809         16  CL-LAST-MAINT-USER      PIC X(4).
  7810         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7811         16  CL-LAST-MAINT-TYPE      PIC X.
  7812             88  CLAIM-SET-UP           VALUE ' '.
  7813             88  PAYMENT-MADE           VALUE '1'.
  7814             88  LETTER-SENT            VALUE '2'.
  7815             88  MASTER-WAS-ALTERED     VALUE '3'.
  7816             88  MASTER-WAS-RESTORED    VALUE '4'.
  7817             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7818             88  FILE-CONVERTED         VALUE '6'.
  7819             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7820             88  ERROR-CORRECTION       VALUE 'E'.
  7821         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7822         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7823         16  CL-BENEFICIARY          PIC X(10).
  7824         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7825         16  CL-DENIAL-TYPE          PIC X.
  7826             88  CL-TYPE-DENIAL          VALUE '1'.
  7827             88  CL-TYPE-RESCISSION      VALUE '2'.
  7828             88  CL-TYPE-REFORMATION     VALUE '3'.
  7829             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7830             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7831         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7832         16  filler                  pic x(3).
  7833*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7834*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7835*        16  CL-RTW-DT               PIC XX.
  7836
  7837     12  CL-TRAILER-CONTROLS.
  7838         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7839             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7840             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7841             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7842         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7843         16  FILLER                  PIC XX.
  7844         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7845         16  CL-ADDRESS-TRAILER-CNT.
  7846             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7847                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7848             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7849                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7850             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7851                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7852             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7853                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7854             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7855                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7856             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7857                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7858             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7859                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7860
  7861     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 144
* EL6311.cbl
  7862         16  CL-CV-REFNO-PRIME       PIC X(18).
  7863         16  CL-CV-REFNO-SFX         PIC XX.
  7864
  7865     12  CL-FILE-LOCATION            PIC X(4).
  7866
  7867     12  CL-PROCESS-ERRORS.
  7868         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7869             88  NO-FATAL-ERRORS        VALUE ZERO.
  7870         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7871             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7872
  7873     12  CL-PRODUCT-CD               PIC X.
  7874
  7875     12  CL-CURRENT-KEY-DATA.
  7876         16  CL-CURRENT-CARRIER      PIC X.
  7877         16  CL-CURRENT-GROUPING     PIC X(6).
  7878         16  CL-CURRENT-STATE        PIC XX.
  7879         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7880
  7881     12  CL-ASSOCIATES               PIC X.
  7882         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7883         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7884         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7885         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7886
  7887     12  CL-ACTIVITY-CODE            PIC 99.
  7888     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7889     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7890
  7891     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7892     12  CL-LAG-REPORT-CODE          PIC 9.
  7893     12  CL-LOAN-TYPE                PIC XX.
  7894     12  CL-LEGAL-STATE              PIC XX.
  7895
  7896     12  CL-YESNOSW                  PIC X.
  7897     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7898         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7899         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7900         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7901     12  cl-insured-type             pic x.
  7902         88  cl-claim-on-primary         value 'P'.
  7903         88  cl-claim-on-co-borrower     value 'C'.
  7904     12  cl-benefit-expiration-dt    PIC XX.
  7905*                                COPY ERCENDT.
  7906******************************************************************
  7907*                                                                *
  7908*                                                                *
  7909*                            ERCENDT.                            *
  7910*                            VMOD=2.001                          *
  7911*                                                                *
  7912*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7913*                                                                *
  7914*   FILE TYPE = VSAM,KSDS                                        *
  7915*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7916*                                                                *
  7917*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7918*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7919*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 145
* EL6311.cbl
  7920*   LOG = NO                                                     *
  7921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7922******************************************************************
  7923*-----------------------------------------------------------------
  7924*                   C H A N G E   L O G
  7925*
  7926* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7927*-----------------------------------------------------------------
  7928*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7929* EFFECTIVE    NUMBER
  7930*-----------------------------------------------------------------
  7931* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7932*                                WITH OPEN CLAIMS
  7933* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7934* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7935* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7936* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7937*-----------------------------------------------------------------
  7938 01  ENDORSEMENT-RECORD.
  7939     12  EN-RECORD-ID                PIC XX.
  7940         88  VALID-EN-ID                VALUE 'EN'.
  7941     12  EN-CONTROL-PRIMARY.
  7942         16  EN-COMPANY-CD           PIC X.
  7943         16  EN-CARRIER              PIC X.
  7944         16  EN-GROUPING             PIC X(6).
  7945         16  EN-STATE                PIC XX.
  7946         16  EN-ACCOUNT              PIC X(10).
  7947         16  EN-CERT-EFF-DT          PIC XX.
  7948         16  EN-CERT-NO.
  7949             20  EN-CERT-PRIME       PIC X(10).
  7950             20  EN-CERT-SFX         PIC X.
  7951         16  EN-REC-TYPE             PIC X.
  7952             88  EN-ISSUE               VALUE 'I'.
  7953             88  EN-CANCELLATION        VALUE 'C'.
  7954         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7955     12  EN-CONTROL-BY-ARCH-NO.
  7956         16  EN-COMPANY-CD-A1              PIC X.
  7957         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7958     12  EN-LAST-MAINT-DT            PIC XX.
  7959     12  EN-LAST-MAINT-BY            PIC X(4).
  7960     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7961     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7962     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7963         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7964         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7965         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7966         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7967         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7968         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7969         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7970         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7971         16  EN-LF-ORIG-BENCD        PIC XX.
  7972         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7973         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7974         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7975         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7976         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7977         16  EN-LF-ORIG-EXP-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 146
* EL6311.cbl
  7978*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7979         16  EN-ORIG-CRED-BENE       PIC X(25).
  7980         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7981         16  FILLER                  PIC X.
  7982         16  EN-AH-ORIG-BENCD        PIC XX.
  7983         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7984         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7985         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7986         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7987*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7988*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7989         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7990         16  F                       PIC X(09).
  7991         16  EN-AH-ORIG-CP           PIC 99.
  7992         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7993         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7994         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7995         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7996         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7997         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7998         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7999         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8000         16  EN-LF-NEW-BENCD         PIC XX.
  8001         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8002         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8003         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8004         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8005         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8006         16  EN-LF-NEW-EXP-DT        PIC XX.
  8007         16  EN-NEW-CRED-BENE        PIC X(25).
  8008         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8009         16  FILLER                  PIC X.
  8010         16  EN-AH-NEW-BENCD         PIC XX.
  8011         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8012         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8013         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8014         16  EN-AH-NEW-EXP-DT        PIC XX.
  8015*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8016*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8017*        16  F                       PIC X(12).
  8018         16  EN-AH-NEW-CP            PIC 99.
  8019         16  EN-SIG-SW               PIC X.
  8020         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8021         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8022         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8023         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8024         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8025         16  FILLER                  PIC X(33).
  8026     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8027         16  EN-LF-ORIG-REF-DT       PIC XX.
  8028         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8029         16  EN-AH-ORIG-REF-DT       PIC XX.
  8030         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8031         16  EN-LF-NEW-REF-DT        PIC XX.
  8032         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8033         16  EN-AH-NEW-REF-DT        PIC XX.
  8034         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8035         16  EN-FLAG-CERT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 147
* EL6311.cbl
  8036         16  EN-INS-LAST-NAME        PIC X(15).
  8037         16  EN-INS-FIRST-NAME       PIC X(10).
  8038         16  EN-INS-MIDDLE-INIT      PIC X.
  8039         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8040         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8041         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8042         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8043         16  FILLER                  PIC X(262).
  8044     12  EN-MONEY-SW             PIC X.
  8045     12  EN-HEALTH-APP           PIC X.
  8046     12  EN-VOUCHER-SW           PIC X.
  8047     12  EN-PAYEE                PIC X(14).
  8048     12  EN-INPUT-DT             PIC XX.
  8049     12  EN-PROCESS-DT           PIC XX.
  8050     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8051     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8052     12  EN-REASON-CODES.
  8053         16  F OCCURS 12.
  8054             20  EN-REASON-CODE  PIC X(4).
  8055     12  EN-TEMPLATE-USED        PIC X(8).
  8056     12  EN-DOCU-TYPE            PIC X.
  8057         88  EN-VERI-DOCU          VALUE 'V'.
  8058         88  EN-GCE-DOCU           VALUE 'G'.
  8059         88  EN-CANC-DOCU          VALUE 'C'.
  8060     12  EN-COMMENTS1            PIC X(13).
  8061     12  EN-COMMENTS2            PIC X(70).
  8062     12  EN-COMM-CHGBK           PIC X.
  8063         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8064         88  EN-CHG-ACCT           VALUE 'Y'.
  8065     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8066     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8067     12  EN-BATCH-NUMBER         PIC X(6).
  8068     12  EN-ACCT-SUMM            PIC X.
  8069     12  EN-CSO-SUMM             PIC X.
  8070     12  en-check-type           pic x.
  8071     12  FILLER                  PIC X(12).
  8072******************************************************************
  8073*                                COPY ELCCRTT.
  8074******************************************************************
  8075*                                                                *
  8076*                            ELCCRTT.                            *
  8077*                                                                *
  8078*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8079*                                                                *
  8080*   FILE TYPE = VSAM,KSDS                                        *
  8081*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8082*                                                                *
  8083*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8084*                                                                *
  8085*   LOG = YES                                                    *
  8086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8087******************************************************************
  8088*                   C H A N G E   L O G
  8089*
  8090* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8091*-----------------------------------------------------------------
  8092*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8093* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 148
* EL6311.cbl
  8094*-----------------------------------------------------------------
  8095* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8096* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8097* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8098* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8099* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8100* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8101* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8102* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8103* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8104* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8105* 091318  CR2018073000001  PEMA  ADD Refund methods
  8106* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8107******************************************************************
  8108
  8109 01  CERTIFICATE-TRAILERS.
  8110     12  CS-RECORD-ID                      PIC XX.
  8111         88  VALID-CS-ID                      VALUE 'CS'.
  8112
  8113     12  CS-CONTROL-PRIMARY.
  8114         16  CS-COMPANY-CD                 PIC X.
  8115         16  CS-CARRIER                    PIC X.
  8116         16  CS-GROUPING                   PIC X(6).
  8117         16  CS-STATE                      PIC XX.
  8118         16  CS-ACCOUNT                    PIC X(10).
  8119         16  CS-CERT-EFF-DT                PIC XX.
  8120         16  CS-CERT-NO.
  8121             20  CS-CERT-PRIME             PIC X(10).
  8122             20  CS-CERT-SFX               PIC X.
  8123         16  CS-TRAILER-TYPE               PIC X.
  8124             88  COMM-TRLR           VALUE 'A'.
  8125             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8126             88  CERT-DATA-TRLR      VALUE 'C'.
  8127
  8128     12  CS-DATA-AREA                      PIC X(516).
  8129
  8130     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8131         16  CS-BANK-COMMISSION-AREA.
  8132             20  CS-BANK-COMMS       OCCURS 10.
  8133                 24  CS-AGT                PIC X(10).
  8134                 24  CS-COM-TYP            PIC X.
  8135                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8136                 24  CS-RECALC-LV-INDIC    PIC X.
  8137                 24  FILLER                PIC X(10).
  8138         16  FILLER                        PIC X(256).
  8139
  8140     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8141****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8142         16  CS-MB-CLAIM-DATA OCCURS 24.
  8143             20  CS-CLAIM-NO               PIC X(7).
  8144             20  CS-CLAIM-TYPE             PIC X.
  8145                 88  CS-AH-CLM               VALUE 'A'.
  8146                 88  CS-IU-CLM               VALUE 'I'.
  8147                 88  CS-GP-CLM               VALUE 'G'.
  8148                 88  CS-LF-CLM               VALUE 'L'.
  8149                 88  CS-PR-CLM               VALUE 'P'.
  8150                 88  CS-FL-CLM               VALUE 'F'.
  8151                 88  CS-OT-CLM               VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 149
* EL6311.cbl
  8152             20  CS-INSURED-TYPE           PIC X.
  8153                 88  CS-PRIM-INSURED          VALUE 'P'.
  8154                 88  CS-CO-BORROWER           VALUE 'C'.
  8155             20  CS-BENEFIT-PERIOD         PIC 99.
  8156             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8157             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8158             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8159         16  FILLER                        PIC X(12).
  8160     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8161         16  CS-VIN-NUMBER                 PIC X(17).
  8162         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8163         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8164         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8165         16  cs-agent-name.
  8166             20  cs-agent-fname            pic x(20).
  8167             20  cs-agent-mi               pic x.
  8168             20  cs-agent-lname            pic x(25).
  8169         16  cs-license-no                 pic x(15).
  8170         16  cs-npn-number                 pic x(10).
  8171         16  cs-agent-edit-status          pic x.
  8172             88  cs-ae-refer-to-manager      value 'M'.
  8173             88  cs-ae-cover-sheet           value 'C'.
  8174             88  cs-ae-sig-form              value 'S'.
  8175             88  cs-ae-verified              value 'V'.
  8176             88  cs-unidentified-signature   value 'U'.
  8177             88  cs-cert-returned            value 'R'.
  8178             88  cs-accept-no-commission     value 'N'.
  8179         16  cs-year                       pic 9999.
  8180         16  cs-make                       pic x(20).
  8181         16  cs-model                      pic x(20).
  8182         16  cs-future                     pic x(20).
  8183         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8184         16  cs-claim-verification-status  pic x.
  8185             88  cs-clm-ver-eligible         value 'A'.
  8186             88  cs-clm-ver-partial-elig     value 'B'.
  8187             88  cs-clm-ver-not-eligible     value 'C'.
  8188             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8189             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8190             88  cs-clm-ver-ND-CERT          value 'F'.
  8191             88  cs-clm-ver-spec-other       value 'G'.
  8192             88  cs-clam-ver-pratial-corrected
  8193                                             value 'H'.
  8194             88  cs-clm-ver-no-matches       value 'I'.
  8195             88  cs-clm-ver-not-elig-corrected
  8196                                             value 'J'.
  8197             88  cs-clm-ver-needs-review     value 'R'.
  8198             88  cs-clm-ver-sent-to-claims   value 'W'.
  8199         16  CS-LF-REFUND-METHOD           PIC X.
  8200         16  CS-AH-REFUND-METHOD           PIC X.
  8201         16  FILLER                        PIC X(353). *> was 420
  8202*        16  FILLER                        PIC X(496).
  8203*                                COPY ERCCHEK.
  8204******************************************************************
  8205*                                                                *
  8206*                                                                *
  8207*                            ERCCHEK                             *
  8208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8209*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 150
* EL6311.cbl
  8210*                                                                *
  8211*   FILE DESCRIPTION = CHECK RECORDS                             *
  8212*                                                                *
  8213*   FILE TYPE = VSAM,KSDS                                        *
  8214*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8215*                                                                *
  8216*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8217*       ALTERNATE INDEX = NONE                                   *
  8218*                                                                *
  8219*   LOG = YES                                                    *
  8220*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8221******************************************************************
  8222*                   C H A N G E   L O G
  8223*
  8224* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8225*-----------------------------------------------------------------
  8226*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8227* EFFECTIVE    NUMBER
  8228*-----------------------------------------------------------------
  8229* 021414    2003053000001  PEMA  changes for auto chk request
  8230******************************************************************
  8231 01  CHECK-RECORDS.
  8232     12  CH-RECORD-ID                      PIC XX.
  8233         88  VALID-CH-ID                      VALUE 'CH'.
  8234
  8235     12  CH-CONTROL-PRIMARY.
  8236         16  CH-COMPANY-CD                 PIC X.
  8237         16  CH-CARRIER                    PIC X.
  8238         16  CH-GROUPING                   PIC X(6).
  8239         16  CH-STATE                      PIC XX.
  8240         16  CH-ACCOUNT                    PIC X(10).
  8241         16  CH-CERT-EFF-DT                PIC XX.
  8242         16  CH-CERT-NO.
  8243             20  CH-CERT-PRIME             PIC X(10).
  8244             20  CH-CERT-SFX               PIC X.
  8245         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8246
  8247     12  CH-RECORDED-DT                    PIC XX.
  8248     12  CH-RECORDED-BY                    PIC X(4).
  8249     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8250
  8251     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8252     12  CH-CHECK-NO                       PIC X(7).
  8253     12  CH-REASON-FOR-CHECK               PIC X(25).
  8254     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8255     12  FILLER                            PIC X.
  8256
  8257     12  CH-PAYEE-INFO.
  8258         16  CH-PAYEE-NAME-1               PIC X(30).
  8259         16  CH-PAYEE-NAME-2               PIC X(30).
  8260         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8261         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8262         16  CH-PAYEE-CITY-ST.
  8263             20  CH-PAYEE-CITY             PIC X(28).
  8264             20  CH-PAYEE-STATE            PIC XX.
  8265         16  CH-PAYEE-ZIP-CODE.
  8266             20  CH-PAYEE-ZIP.
  8267                 24  CH-ZIP-PRI-1ST        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 151
* EL6311.cbl
  8268                     88  CH-CANADIAN-POST-CODE
  8269                                           VALUES 'A' THRU 'Z'.
  8270                 24  FILLER                PIC X(4).
  8271             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8272         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8273             20  CH-CAN-POSTAL-1           PIC XXX.
  8274             20  CH-CAN-POSTAL-2           PIC XXX.
  8275             20  FILLER                    PIC XXX.
  8276
  8277     12  CH-CHECK-STUB-TEXT.
  8278         16  CH-STUB-LINE-1                PIC X(30).
  8279         16  CH-TEXT-LINE-1                PIC X(50).
  8280         16  CH-TEXT-LINE-2                PIC X(50).
  8281         16  CH-TEXT-LINE-3                PIC X(40).
  8282     12  CH-RETURN-TO                      PIC X(30).
  8283
  8284     12  CH-COMPENSATION-CONTROL.
  8285         16  CH-COMP-CARRIER               PIC X.
  8286         16  CH-COMP-GROUPING              PIC X(6).
  8287         16  CH-COMP-FIN-RESP              PIC X(10).
  8288         16  CH-COMP-ACCOUNT               PIC X(10).
  8289
  8290     12  CH-CREDIT-SELECT-DT               PIC XX.
  8291     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8292     12  CH-PAYEE-CODE                     PIC X(6).
  8293
  8294     12  CH-VOID-DATA.
  8295         20  CH-VOID-DT                    PIC XX.
  8296         20  CH-VOID-BY                    PIC X(4).
  8297         20  CH-VOID-REASON                PIC X(25).
  8298
  8299     12  CH-APPROVAL-DATA.
  8300         20  CH-APPROVAL-DT                PIC XX.
  8301         20  CH-APPROVAL-STATUS            PIC X.
  8302             88  CH-IN-LIMBO                  VALUE ' '.
  8303             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8304             88  CH-APPROVED                  VALUE 'A'.
  8305             88  CH-DENIED                    VALUE 'D'.
  8306         20  CH-APPROVED-BY                PIC XXXX.
  8307     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8308             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8309     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8310
  8311     12  ch-released-dt                    pic xx.
  8312     12  ch-check-cashed-dt                pic xx.
  8313     12  FILLER                            PIC X.
  8314*    12  CH-CHECK-REFERENCE                PIC X(12).
  8315     12  CH-CHECK-ORIGIN-SW                PIC X.
  8316             88  CH-REFUND-CHECK              VALUE 'R'.
  8317             88  CH-MAINT-CHECK               VALUE 'M'.
  8318
  8319     12  CH-CANC-DT                        PIC XX.
  8320     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8321     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8322
  8323     12  CH-INSURED-NAME                   PIC X(28).
  8324
  8325     12  ch-released-by                    pic x(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 152
* EL6311.cbl
  8326     12  ch-csr                            pic x(4).
  8327     12  ch-deduct-commission              pic x.
  8328         88  ch-deduct-comm                  value 'Y'.
  8329         88  ch-do-not-deduct-comm           value 'N'.
  8330
  8331     12  FILLER                            PIC X(11).
  8332*    12  CH-LETTER-TABLE.
  8333*        16  CH-LETTERS OCCURS 3 TIMES
  8334*                       INDEXED BY CH-LT-NDX
  8335*                                          PIC X(04).
  8336
  8337     12  FILLER                            PIC X(07).
  8338
  8339 01  var                         pic x(30).
  8340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8341                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8342                          PENDING-MAILING-DATA MAILING-DATA
  8343                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8344                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8345                          CLAIM-MASTER ENDORSEMENT-RECORD
  8346                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8347                          VAR.
  8348 0000-DFHEXIT SECTION.
  8349     MOVE '9#                    $   ' TO DFHEIV0.
  8350     MOVE 'EL6311' TO DFHEIV1.
  8351     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8352
  8353     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8354     MOVE EIBTRMID               TO QID-TERM.
  8355     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8356     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8357     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8358     MOVE 2                      TO EMI-SWITCH2.
  8359
  8360     move spaces to ws-kix-myenv
  8361     set P to address of KIXSYS
  8362     CALL "getenv" using by value P returning var-ptr
  8363     if var-ptr = null then
  8364        display ' kixsys not set '
  8365     else
  8366        set address of var to var-ptr
  8367        move 0 to env-var-len
  8368        inspect var tallying env-var-len
  8369          for characters before X'00'
  8370        unstring var (1:env-var-len) delimited by '/'
  8371           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8372              WS-KIX-SYS
  8373        end-unstring
  8374     end-if
  8375     perform varying a1 from +1 by +1 until a1 > +10
  8376        if ws-kix-myenv (a1:1) = low-values or high-values
  8377           display ' found low or hi val '
  8378           move spaces to ws-kix-myenv (a1:1)
  8379        end-if
  8380     end-perform
  8381*    display ' env *' ws-kix-myenv '*'
  8382     IF EIBCALEN = 0
  8383         GO TO 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 153
* EL6311.cbl
  8384
  8385     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8386     MOVE '5'                   TO DC-OPTION-CODE.
  8387     PERFORM 9700-DATE-LINK.
  8388     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8389     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8390
  8391     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8392     MOVE SPACE                  TO DC-OPTION-CODE.
  8393     PERFORM 9700-DATE-LINK.
  8394     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8395     MOVE LOW-VALUES             TO EL631BI.
  8396
  8397
  8398* EXEC CICS HANDLE CONDITION
  8399*        PGMIDERR  (9600-PGMID-ERROR)
  8400*        ERROR     (9990-ABEND)
  8401*        INVREQ    (9990-ABEND)
  8402*        QIDERR    (0010-MAIN-LOGIC)
  8403*    END-EXEC.
  8404*    MOVE '"$L.8N                ! " #00008393' TO DFHEIV0
  8405     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8407     MOVE X'2220233030303038333933' TO DFHEIV0(25:11)
  8408     CALL 'kxdfhei1' USING DFHEIV0
  8409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8410
  8411
  8412     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8413         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8414             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8415             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8416             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8417             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8418             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8419             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8420             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8421             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8422
  8423             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8424                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8425
  8426             ELSE
  8427                 NEXT SENTENCE
  8428
  8429         ELSE
  8430             IF PI-CALLING-PROGRAM = 'EL6315'
  8431                SET CALLED-FROM-6315 TO TRUE
  8432             END-IF
  8433             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8434             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8435             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8436             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8437             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8438             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8439             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8440             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8441             MOVE SPACES               TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 154
* EL6311.cbl
  8442             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8443             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8444             GO TO 3900-RE-DISPLAY-RECORD
  8445     ELSE
  8446         GO TO 0020-MAIN-LOGIC.
  8447
  8448 0010-MAIN-LOGIC.
  8449     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8450                                    WS-FIRST-ENTRY-SW.
  8451
  8452     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8453
  8454     MOVE LOW-VALUES             TO EC-NEW-CERT
  8455                                    EC-NEW-STATE.
  8456
  8457     IF PI-DISPLAY-ORIGINAL-BATCH
  8458         NEXT SENTENCE
  8459     ELSE
  8460         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8461             GO TO 5000-BROWSE-BATCH-HEADERS.
  8462
  8463     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8464         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8465
  8466     IF PI-CSR-BROWSE
  8467        GO TO 4200-BROWSE-CSR-FORWARD.
  8468
  8469     IF PI-FILE-BROWSE
  8470         GO TO 4300-BROWSE-FILE-FORWARD.
  8471
  8472     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8473
  8474 0020-MAIN-LOGIC.
  8475     IF EIBAID = DFHCLEAR
  8476         GO TO 9400-CLEAR.
  8477
  8478     MOVE LOW-VALUES             TO EC-NEW-CERT
  8479                                    EC-NEW-STATE.
  8480
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 155
* EL6311.cbl
  8482
  8483******************************************************************
  8484*                                                                *
  8485*              R E C E I V E   M A P                             *
  8486*                                                                *
  8487******************************************************************
  8488
  8489 0200-RECEIVE.
  8490     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8491         MOVE ER-0008            TO EMI-ERROR
  8492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8493         IF PI-MAP-NAME = EL631B
  8494             MOVE -1                 TO BMAINTL
  8495             GO TO 8200-SEND-DATAONLY
  8496         ELSE
  8497             IF PI-MAP-NAME = EL631C
  8498                 MOVE -1                 TO CMAINTL
  8499                 GO TO 8200-SEND-DATAONLY
  8500             ELSE
  8501                 IF PI-MAP-NAME = EL631D
  8502                     MOVE -1                 TO DPFENTRL
  8503                     GO TO 8200-SEND-DATAONLY.
  8504
  8505
  8506* EXEC CICS RECEIVE
  8507*        MAP      (PI-MAP-NAME)
  8508*        MAPSET   (MAPSET-EL6311S)
  8509*        INTO     (EL631BI)
  8510*    END-EXEC.
  8511     MOVE LENGTH OF
  8512      EL631BI
  8513       TO DFHEIV11
  8514*    MOVE '8"T I  L              ''   #00008493' TO DFHEIV0
  8515     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8516     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8517     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  8518     CALL 'kxdfhei1' USING DFHEIV0,
  8519           PI-MAP-NAME,
  8520           EL631BI,
  8521           DFHEIV11,
  8522           MAPSET-EL6311S,
  8523           DFHEIV99,
  8524           DFHEIV99
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8526
  8527
  8528******************************************************************
  8529*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8530******************************************************************
  8531
  8532     IF BTYPE-LEN (1) EQUAL +3
  8533        IF BTYPE (1) EQUAL ALL ' '
  8534            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8535
  8536     IF BTYPE-LEN (2) EQUAL +3
  8537        IF BTYPE (2) EQUAL ALL ' '
  8538            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8539
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 156
* EL6311.cbl
  8540     INSPECT EL631BI CONVERTING '_' TO ' '.
  8541
  8542     IF PI-MAP-NAME = EL631B
  8543         IF BPFENTRL GREATER THAN ZEROS
  8544             IF EIBAID NOT = DFHENTER
  8545                 MOVE ER-0004       TO EMI-ERROR
  8546                 MOVE -1            TO BPFENTRL
  8547                 MOVE AL-UNBOF      TO BPFENTRA
  8548                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8549                 GO TO 8200-SEND-DATAONLY
  8550             ELSE
  8551                 IF BPFENTRI NUMERIC AND
  8552                   (BPFENTRI GREATER 0 AND LESS 25)
  8553                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8554                 ELSE
  8555                     MOVE ER-0029  TO EMI-ERROR
  8556                     MOVE AL-UNBON TO BPFENTRA
  8557                     MOVE -1       TO BPFENTRL
  8558                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8559                     GO TO 8200-SEND-DATAONLY
  8560         ELSE
  8561             NEXT SENTENCE
  8562     ELSE
  8563         IF PI-MAP-NAME = EL631C
  8564            IF CPFENTRL GREATER THAN ZEROS
  8565                IF EIBAID NOT = DFHENTER
  8566                 MOVE ER-0004         TO EMI-ERROR
  8567                 MOVE -1              TO CPFENTRL
  8568                 MOVE AL-UNBOF        TO CPFENTRA
  8569                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8570                 GO TO 8200-SEND-DATAONLY
  8571             ELSE
  8572                 IF CPFENTRI NUMERIC AND
  8573                   (CPFENTRI GREATER 0 AND LESS 25)
  8574                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8575                 ELSE
  8576                     MOVE ER-0029      TO EMI-ERROR
  8577                     MOVE AL-UNBON     TO CPFENTRA
  8578                     MOVE -1           TO CPFENTRL
  8579                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580                     GO TO 8200-SEND-DATAONLY
  8581         ELSE
  8582             NEXT SENTENCE
  8583     ELSE
  8584     IF PI-MAP-NAME = EL631D
  8585         IF DPFENTRL GREATER THAN ZEROS
  8586             IF EIBAID NOT = DFHENTER
  8587                 MOVE ER-0004         TO EMI-ERROR
  8588                 MOVE -1              TO DPFENTRL
  8589                 MOVE AL-UNBOF        TO DPFENTRA
  8590                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8591                 GO TO 8200-SEND-DATAONLY
  8592             ELSE
  8593                 IF DPFENTRI NUMERIC AND
  8594                   (DPFENTRI GREATER 0 AND LESS 25)
  8595                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8596                 ELSE
  8597                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 157
* EL6311.cbl
  8598                     MOVE AL-UNBON     TO DPFENTRA
  8599                     MOVE -1           TO DPFENTRL
  8600                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8601                     GO TO 8200-SEND-DATAONLY.
  8602
  8603     IF EIBAID = DFHPF23
  8604         GO TO 8810-PF23.
  8605
  8606     IF EIBAID = DFHPF24
  8607         GO TO 9200-RETURN-MAIN-MENU.
  8608
  8609     IF EIBAID = DFHPF12
  8610         GO TO 9500-PF12.
  8611
  8612     IF PI-MAP-NAME = EL631B
  8613        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8614
  8615     IF PI-MAP-NAME = EL631C
  8616        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8617
  8618     IF PI-MAP-NAME = EL631D
  8619        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8620
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 158
* EL6311.cbl
  8622
  8623******************************************************************
  8624*                                                                *
  8625*      ISSUE SCREEN PF KEY CHECKING                              *
  8626*                                                                *
  8627******************************************************************
  8628
  8629******************************************************************
  8630*                                                                *
  8631*      PF KEY FUNCTIONS:                                         *
  8632*                                                                *
  8633*      PF1  = BROWSE FORWARD                                     *
  8634*      PF2  = BROWSE BACKWARD                                    *
  8635*      PF3  = CERTIFICATE LOOKUP                                 *
  8636*      PF4  = DISPLAY BATCH HEADER                               *
  8637*      PF5  = ADD ISSUE  SCREEN                                  *
  8638*      PF6  = ADD CANCEL SCREEN                                  *
  8639*      PF7  = CERTIFICATE DISPLAY                                *
  8640*      PF8  = CERTIFICATE NOTES                                  *
  8641*      PF9  = EDIT CONTROL                                       *
  8642*      PF10 = DISPLAY LETTER SCREEN                              *
  8643*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8644*      PF12 = HELP SCREEN                                        *
  8645*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8646*      PF14 = ACCOUNT MASTER                                     *
  8647*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8648*      PF16 = DISPLAY LETTER REVIEW                              *
  8649*                                                                *
  8650******************************************************************
  8651
  8652 0300-CHECK-ISSUE-PF-KEYS.
  8653     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8654        MOVE ER-2337            TO EMI-ERROR
  8655        MOVE -1                  TO BMAINTL
  8656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8657        GO TO 8200-SEND-DATAONLY.
  8658
  8659     IF EIBAID = DFHPF1
  8660        MOVE '0'                TO PI-EDIT-SW
  8661        IF PI-PRIMARY-BROWSE
  8662           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8663        ELSE
  8664           IF PI-PRIMARY-WITH-SELECT
  8665              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8666           ELSE
  8667              IF PI-FILE-BROWSE
  8668                 GO TO 4300-BROWSE-FILE-FORWARD
  8669              ELSE
  8670                 IF PI-CSR-BROWSE
  8671                    GO TO 4200-BROWSE-CSR-FORWARD
  8672                 ELSE
  8673                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8674
  8675     IF EIBAID = DFHPF2
  8676        MOVE '0'                TO PI-EDIT-SW
  8677        IF PI-PRIMARY-BROWSE
  8678           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8679        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 159
* EL6311.cbl
  8680           IF PI-PRIMARY-WITH-SELECT
  8681              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8682           ELSE
  8683              IF PI-FILE-BROWSE
  8684                 GO TO 4800-BROWSE-FILE-BACKWARD
  8685              ELSE
  8686                 IF PI-CSR-BROWSE
  8687                    GO TO 4900-BROWSE-CSR-BACKWARD
  8688                 ELSE
  8689                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8690
  8691     IF EIBAID = DFHPF3
  8692        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8693        MOVE XCTL-EL127         TO PGM-NAME
  8694        GO TO 9300-XCTL.
  8695
  8696     IF (EIBAID = DFHPF15 OR DFHPF6)
  8697        AND (CSR-EDIT-SESSION)
  8698*       AND (FATAL-OR-UNFORCED)
  8699*       AND (FATAL-ERRORS)
  8700        and (pi-6311-fatal-ctr <> +0)
  8701        MOVE ER-1819             TO EMI-ERROR
  8702        MOVE -1                  TO BMAINTL
  8703        MOVE AL-UANON            TO BMAINTA
  8704        PERFORM 9900-ERROR-FORMAT
  8705                                 THRU 9900-EXIT
  8706        GO TO 8200-SEND-DATAONLY
  8707     END-IF
  8708     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8709      OR (EIBAID = DFHPF10)
  8710        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8711        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8712        IF (RESP-NORMAL)
  8713           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8714              AM-CONTROL-PRIMARY (1:20))
  8715            IF AM-NAME NOT GREATER THAN SPACES OR
  8716               AM-ADDRS NOT GREATER THAN SPACES  OR
  8717               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8718               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8719               AM-ZIP NOT GREATER THAN SPACES
  8720               MOVE ER-3834             TO EMI-ERROR
  8721               MOVE -1                  TO BMAINTL
  8722               MOVE AL-UANON            TO BMAINTA
  8723               PERFORM 9900-ERROR-FORMAT
  8724                                 THRU 9900-EXIT
  8725               GO TO 8200-SEND-DATAONLY
  8726            END-IF
  8727        ELSE
  8728           MOVE ER-1609             TO EMI-ERROR
  8729           MOVE -1                  TO BMAINTL
  8730           MOVE AL-UANON            TO BMAINTA
  8731           PERFORM 9900-ERROR-FORMAT
  8732                                THRU 9900-EXIT
  8733           GO TO 8200-SEND-DATAONLY
  8734        END-IF
  8735
  8736        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8737        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 160
* EL6311.cbl
  8738        IF (ERMAIL-FOUND)
  8739            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8740               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8741               MA-CITY NOT GREATER THAN SPACES OR
  8742               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8743               MA-ZIP-CODE NOT GREATER THAN SPACES
  8744               MOVE ER-3835             TO EMI-ERROR
  8745               MOVE -1                  TO BMAINTL
  8746               MOVE AL-UANON            TO BMAINTA
  8747               PERFORM 9900-ERROR-FORMAT
  8748                                 THRU 9900-EXIT
  8749               GO TO 8200-SEND-DATAONLY
  8750            END-IF
  8751        ELSE
  8752           MOVE ER-3000             TO EMI-ERROR
  8753           MOVE -1                  TO BMAINTL
  8754           MOVE AL-UANON            TO BMAINTA
  8755           PERFORM 9900-ERROR-FORMAT
  8756                                THRU 9900-EXIT
  8757           GO TO 8200-SEND-DATAONLY
  8758        END-IF
  8759
  8760     END-IF
  8761     IF (EIBAID = DFHPF15)
  8762        AND (CSR-EDIT-SESSION)
  8763        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8764        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8765        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8766        MOVE PI-SV-STATE         TO PI-STATE
  8767        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8768        MOVE BCERTNOI            TO PI-CERT-PRIME
  8769        MOVE BSUFIXI             TO PI-CERT-SFX
  8770        MOVE BEFFDTI             TO DEEDIT-FIELD
  8771        PERFORM 8600-DEEDIT
  8772        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8773        MOVE '4'                 TO DC-OPTION-CODE
  8774        PERFORM 9700-DATE-LINK
  8775        IF DATE-CONVERSION-ERROR
  8776           MOVE ER-0348          TO EMI-ERROR
  8777           MOVE -1               TO BEFFDTL
  8778           MOVE AL-UABON         TO BEFFDTA
  8779           PERFORM 9900-ERROR-FORMAT
  8780                                 THRU 9900-EXIT
  8781           GO TO 8200-SEND-DATAONLY
  8782        ELSE
  8783           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8784           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8785           MOVE XCTL-EL6315      TO PGM-NAME
  8786           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8787           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8788           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8789           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8790           GO TO 9300-XCTL
  8791        END-IF
  8792     END-IF
  8793
  8794     IF EIBAID = DFHPF4
  8795        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 161
* EL6311.cbl
  8796        IF PI-DISPLAY-ORIGINAL-BATCH
  8797           NEXT SENTENCE
  8798        ELSE
  8799           GO TO 7200-DISPLAY-BATCHES.
  8800
  8801     IF EIBAID = DFHPF5
  8802        MOVE ER-0029                TO EMI-ERROR
  8803        MOVE -1                     TO BPFENTRL
  8804        MOVE AL-UNBON               TO BPFENTRA
  8805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8806        GO TO 8200-SEND-DATAONLY.
  8807*        MOVE '0'                TO PI-EDIT-SW
  8808*        IF PI-DISPLAY-ORIGINAL-BATCH
  8809*           NEXT SENTENCE
  8810*        ELSE
  8811*           MOVE EL631B              TO PI-MAP-NAME
  8812*           MOVE LOW-VALUES          TO EL631BI
  8813*           MOVE 'A'                 TO BMAINTO
  8814*           MOVE AL-UANON            TO BMAINTA
  8815*           MOVE -1                  TO BMAINTL
  8816*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8817*           GO TO 8100-SEND-INITIAL-MAP.
  8818
  8819     IF EIBAID = DFHPF6
  8820        IF NOT CSR-EDIT-SESSION
  8821           MOVE ER-0029                TO EMI-ERROR
  8822           MOVE -1                     TO BPFENTRL
  8823           MOVE AL-UNBON               TO BPFENTRA
  8824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8825           GO TO 8200-SEND-DATAONLY
  8826*           MOVE '0'              TO PI-EDIT-SW
  8827*           IF PI-DISPLAY-ORIGINAL-BATCH
  8828*              NEXT SENTENCE
  8829*           ELSE
  8830*              MOVE EL631C        TO PI-MAP-NAME
  8831*              MOVE LOW-VALUES    TO EL631CI
  8832*              MOVE 'A'           TO CMAINTO
  8833*              MOVE AL-UANON      TO CMAINTA
  8834*              MOVE -1            TO CMAINTL
  8835*              MOVE '6'           TO PI-MAINT-FUNCTION
  8836*              GO TO 8100-SEND-INITIAL-MAP
  8837*           END-IF
  8838        ELSE
  8839           PERFORM 5100-PROCESS-POL-RESC
  8840                                 THRU 5100-EXIT
  8841           MOVE  PI-PREV-CONTROL-PRIMARY
  8842                                 TO ERPNDB-KEY
  8843
  8844* EXEC CICS READ
  8845*              SET     (ADDRESS OF PENDING-BUSINESS)
  8846*              DATASET (FILE-ID-ERPNDB)
  8847*              RIDFLD  (ERPNDB-KEY)
  8848*          END-EXEC
  8849*    MOVE '&"S        E          (   #00008814' TO DFHEIV0
  8850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8852     MOVE X'2020233030303038383134' TO DFHEIV0(25:11)
  8853     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 162
* EL6311.cbl
  8854           FILE-ID-ERPNDB,
  8855           DFHEIV20,
  8856           DFHEIV99,
  8857           ERPNDB-KEY,
  8858           DFHEIV99,
  8859           DFHEIV99,
  8860           DFHEIV99
  8861     SET ADDRESS OF PENDING-BUSINESS TO
  8862         DFHEIV20
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8864           PERFORM 9800-LINK-PENDING-EDIT
  8865                                 THRU 9800-EXIT
  8866           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8867           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8868                                    PI-PREV-SEQ-NO
  8869           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8870*                                    WS-CANCEL-LETTER-SW
  8871                                    PI-ALL-ISSUES-SW
  8872                                    PI-ALL-CANCELS-SW
  8873           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8874        END-IF
  8875     END-IF
  8876     IF EIBAID = DFHPF7
  8877        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8878        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8879        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8880        MOVE PI-SV-STATE            TO PI-STATE
  8881        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8882        MOVE BCERTNOI               TO PI-CERT-PRIME
  8883        MOVE BSUFIXI                TO PI-CERT-SFX
  8884        MOVE BEFFDTI                TO DEEDIT-FIELD
  8885        PERFORM 8600-DEEDIT
  8886        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8887        MOVE '4'                    TO DC-OPTION-CODE
  8888        PERFORM 9700-DATE-LINK
  8889        IF DATE-CONVERSION-ERROR
  8890           MOVE ER-0348            TO EMI-ERROR
  8891           MOVE -1                  TO BEFFDTL
  8892           MOVE AL-UABON            TO BEFFDTA
  8893           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8894           GO TO 8200-SEND-DATAONLY
  8895        ELSE
  8896           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8897           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8898           MOVE XCTL-EL1273        TO PGM-NAME
  8899           GO TO 9300-XCTL.
  8900
  8901     IF EIBAID = DFHPF8
  8902        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8903        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8904        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8905        MOVE PI-SV-STATE            TO PI-STATE
  8906        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8907        MOVE BCERTNOI               TO PI-CERT-PRIME
  8908        MOVE BSUFIXI                TO PI-CERT-SFX
  8909        MOVE BEFFDTI                TO DEEDIT-FIELD
  8910        PERFORM 8600-DEEDIT
  8911        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 163
* EL6311.cbl
  8912        MOVE '4'                    TO DC-OPTION-CODE
  8913        PERFORM 9700-DATE-LINK
  8914        IF DATE-CONVERSION-ERROR
  8915           MOVE ER-0348            TO EMI-ERROR
  8916           MOVE -1                  TO BEFFDTL
  8917           MOVE AL-UABON            TO BEFFDTA
  8918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8919           GO TO 8200-SEND-DATAONLY
  8920        ELSE
  8921           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8922           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8923           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  8924           IF PI-COMPANY-ID = 'DMD'
  8925               MOVE XCTL-EL401DMD      TO PGM-NAME
  8926             ELSE
  8927               MOVE XCTL-EL1279        TO PGM-NAME
  8928           END-IF
  8929           GO TO 9300-XCTL.
  8930
  8931     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8932        MOVE XCTL-EL6312         TO PGM-NAME
  8933
  8934* EXEC CICS XCTL
  8935*           PROGRAM   (PGM-NAME)
  8936*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8937*           LENGTH    (WS-COMM-LENGTH)
  8938*       END-EXEC
  8939*    MOVE '.$C                   %   #00008888' TO DFHEIV0
  8940     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8941     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8942     MOVE X'2020233030303038383838' TO DFHEIV0(25:11)
  8943     CALL 'kxdfhei1' USING DFHEIV0,
  8944           PGM-NAME,
  8945           PROGRAM-INTERFACE-BLOCK,
  8946           WS-COMM-LENGTH,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8949     ELSE
  8950        MOVE '0'                 TO  PI-EDIT-SW.
  8951
  8952     IF  EIBAID = DFHPF10
  8953         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8954         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8955         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8956                                    PI-1042-WA
  8957         MOVE 4                  TO PI-689-DATA-SOURCE
  8958         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8959         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8960         MOVE PI-SV-STATE        TO PI-689-STATE
  8961         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8962         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8963         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8964         MOVE PI-PB-ALT-CHG-SEQ-NO
  8965                                 TO PI-689-ALT-SEQ-NO
  8966         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8967         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8968         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8969         MOVE +0                 TO PI-689-CONTROL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 164
* EL6311.cbl
  8970         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8971                                    PI-689-EXP-DATE
  8972                                    PI-689-RESP-PERSON
  8973                                    PI-689-TYPE
  8974                                    PI-689-FOLLOW-UP-EDIT
  8975                                    PI-689-RESEND1-EDIT
  8976                                    PI-689-SEQ-EDIT
  8977                                    PI-689-BCSEQ-EDIT
  8978                                    PI-689-LBL-OVERRIDE
  8979         MOVE W-LETTER-COMMUNICATION-AREAS
  8980                                 TO PI-PROGRAM-WORK-AREA
  8981         MOVE XCTL-EL689         TO PGM-NAME
  8982         GO TO 9300-XCTL.
  8983
  8984     IF  EIBAID = DFHPF16
  8985         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8986         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8987         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8988                                    PI-1042-WA
  8989         MOVE 4                  TO PI-689-DATA-SOURCE
  8990         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8991         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8992         MOVE PI-SV-STATE        TO PI-689-STATE
  8993         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8994         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8995         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8996         MOVE PI-PB-ALT-CHG-SEQ-NO
  8997                                 TO PI-689-ALT-SEQ-NO
  8998         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8999         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9000         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9001         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9002         MOVE W-LETTER-COMMUNICATION-AREAS
  9003                                 TO PI-PROGRAM-WORK-AREA
  9004         MOVE XCTL-EL690         TO PGM-NAME
  9005         GO TO 9300-XCTL.
  9006
  9007     IF EIBAID = DFHPF13
  9008         MOVE XCTL-EL6313        TO PGM-NAME
  9009         GO TO 9300-XCTL.
  9010
  9011     IF EIBAID = DFHPF17
  9012        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9013        IF (PB-I-LOAN-APR numeric)
  9014           and (pb-i-loan-apr < 99.9999)
  9015           AND (PB-I-BENEFICIARY-NAME NOT
  9016              = SPACES AND LOW-VALUES)
  9017
  9018           MOVE LINK-ELVADS          TO PGM-NAME
  9019
  9020* EXEC CICS LINK
  9021*              PROGRAM    (PGM-NAME)
  9022*              COMMAREA   (WS-PASS-AREA)
  9023*              LENGTH     (WS-PASS-AREA-LENGTH)
  9024*          END-EXEC
  9025*    MOVE '."C                   (   #00008963' TO DFHEIV0
  9026     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 165
* EL6311.cbl
  9028     MOVE X'2020233030303038393633' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           PGM-NAME,
  9031           WS-PASS-AREA,
  9032           WS-PASS-AREA-LENGTH,
  9033           DFHEIV99,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99
  9037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9038
  9039           MOVE 0000             TO EMI-ERROR
  9040           MOVE -1               TO BMAINTL
  9041           PERFORM 9900-ERROR-FORMAT
  9042                                 THRU 9900-EXIT
  9043           GO TO 8200-SEND-DATAONLY
  9044        ELSE
  9045           MOVE ER-0877            TO EMI-ERROR
  9046           MOVE -1                  TO BEFFDTL
  9047           MOVE AL-UABON            TO BEFFDTA
  9048           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9049           GO TO 8200-SEND-DATAONLY
  9050        END-IF
  9051     END-IF
  9052     IF EIBAID = DFHPF14
  9053        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9054        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9055        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9056        MOVE PI-SV-STATE            TO PI-CR-STATE
  9057        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9058        MOVE SPACE                  TO PI-EDIT-SW
  9059        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9060        MOVE XCTL-EL650             TO PGM-NAME
  9061        GO TO 9300-XCTL.
  9062
  9063     IF EIBAID = DFHPF15
  9064        IF PI-COMPANY-ID  =  'HER'
  9065            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9066            MOVE XCTL-EL680         TO PGM-NAME
  9067            GO TO 9300-XCTL.
  9068
  9069     IF EIBAID = DFHENTER OR DFHPF11
  9070        GO TO 1000-ISSUE-MAINLINE.
  9071
  9072     MOVE ER-0029                TO EMI-ERROR
  9073     MOVE -1                     TO BPFENTRL
  9074     MOVE AL-UNBON               TO BPFENTRA
  9075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9076     GO TO 8200-SEND-DATAONLY.
  9077
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 166
* EL6311.cbl
  9079
  9080******************************************************************
  9081*                                                                *
  9082*      CANCEL SCREEN PF KEY CHECKING                             *
  9083*                                                                *
  9084******************************************************************
  9085
  9086******************************************************************
  9087*                                                                *
  9088*      PF KEY FUNCTIONS:                                         *
  9089*                                                                *
  9090*      PF1  = BROWSE FORWARD                                     *
  9091*      PF2  = BROWSE BACKWARD                                    *
  9092*      PF3  = CERTIFICATE LOOKUP                                 *
  9093*      PF4  = DISPLAY BATCH HEADER                               *
  9094*      PF5  = ADD ISSUE SCREEN                                   *
  9095*      PF6  = ADD CANCEL SCREEN                                  *
  9096*      PF7  = CERTIFICATE DISPLAY                                *
  9097*      PF8  = CERTIFICATE NOTES                                  *
  9098*      PF9  = EDIT CONTROL                                       *
  9099*      PF10 = DISPLAY LETTER SCREEN                              *
  9100*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9101*      PF12 = DISPLAY HELP SCREEN                                *
  9102*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9103*      PF14 = ACCOUNT MASTER                                     *
  9104*      PF16 = LETTER REVIEW                                      *
  9105*                                                                *
  9106******************************************************************
  9107
  9108 0400-CHECK-CANCEL-PF-KEYS.
  9109     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9110        MOVE ER-2337             TO EMI-ERROR
  9111        MOVE -1                  TO CMAINTL
  9112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113        GO TO 8200-SEND-DATAONLY.
  9114
  9115     IF EIBAID = DFHPF1
  9116        MOVE '0'                TO PI-EDIT-SW
  9117        IF PI-PRIMARY-BROWSE
  9118           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9119        ELSE
  9120           IF PI-PRIMARY-WITH-SELECT
  9121              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9122           ELSE
  9123              IF PI-FILE-BROWSE
  9124                 GO TO 4300-BROWSE-FILE-FORWARD
  9125              ELSE
  9126                 IF PI-CSR-BROWSE
  9127                    GO TO 4200-BROWSE-CSR-FORWARD
  9128                 ELSE
  9129                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9130
  9131     IF EIBAID = DFHPF2
  9132        MOVE '0'                TO PI-EDIT-SW
  9133        IF PI-PRIMARY-BROWSE
  9134           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9135        ELSE
  9136           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 167
* EL6311.cbl
  9137              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9138           ELSE
  9139              IF PI-FILE-BROWSE
  9140                 GO TO 4800-BROWSE-FILE-BACKWARD
  9141              ELSE
  9142                 IF PI-CSR-BROWSE
  9143                    GO TO 4900-BROWSE-CSR-BACKWARD
  9144                 ELSE
  9145                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9146
  9147     IF EIBAID = DFHPF3
  9148        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9149        MOVE XCTL-EL127         TO PGM-NAME
  9150        GO TO 9300-XCTL.
  9151
  9152     IF (EIBAID = DFHPF15 OR DFHPF17)
  9153        AND (CSR-EDIT-SESSION)
  9154*       AND (FATAL-OR-UNFORCED)
  9155        AND (FATAL-ERRORS)
  9156        MOVE ER-1819             TO EMI-ERROR
  9157        MOVE -1                  TO CMAINTL
  9158        MOVE AL-UANON            TO CMAINTA
  9159        PERFORM 9900-ERROR-FORMAT
  9160                                 THRU 9900-EXIT
  9161        GO TO 8200-SEND-DATAONLY
  9162     END-IF
  9163     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9164       AND (CSR-EDIT-SESSION)
  9165        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9166        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9167        IF (RESP-NORMAL)
  9168           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9169              AM-CONTROL-PRIMARY (1:20))
  9170            IF AM-NAME NOT GREATER THAN SPACES OR
  9171               AM-ADDRS NOT GREATER THAN SPACES  OR
  9172               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9173               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9174               AM-ZIP NOT GREATER THAN SPACES
  9175               MOVE ER-3834             TO EMI-ERROR
  9176               MOVE -1                  TO BMAINTL
  9177               MOVE AL-UANON            TO BMAINTA
  9178               PERFORM 9900-ERROR-FORMAT
  9179                                 THRU 9900-EXIT
  9180               GO TO 8200-SEND-DATAONLY
  9181            END-IF
  9182        ELSE
  9183           MOVE ER-1609             TO EMI-ERROR
  9184           MOVE -1                  TO BMAINTL
  9185           MOVE AL-UANON            TO BMAINTA
  9186           PERFORM 9900-ERROR-FORMAT
  9187                                THRU 9900-EXIT
  9188           GO TO 8200-SEND-DATAONLY
  9189        END-IF
  9190
  9191        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9192        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9193        IF (ERMAIL-FOUND)
  9194            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 168
* EL6311.cbl
  9195               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9196               MA-CITY NOT GREATER THAN SPACES OR
  9197               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9198               MA-ZIP-CODE NOT GREATER THAN SPACES
  9199               MOVE ER-3835             TO EMI-ERROR
  9200               MOVE -1                  TO BMAINTL
  9201               MOVE AL-UANON            TO BMAINTA
  9202               PERFORM 9900-ERROR-FORMAT
  9203                                 THRU 9900-EXIT
  9204               GO TO 8200-SEND-DATAONLY
  9205            END-IF
  9206        ELSE
  9207           MOVE ER-3000             TO EMI-ERROR
  9208           MOVE -1                  TO BMAINTL
  9209           MOVE AL-UANON            TO BMAINTA
  9210           PERFORM 9900-ERROR-FORMAT
  9211                                THRU 9900-EXIT
  9212           GO TO 8200-SEND-DATAONLY
  9213        END-IF
  9214
  9215     END-IF
  9216     IF (EIBAID = DFHPF15 OR DFHPF17)
  9217        AND (CSR-EDIT-SESSION)
  9218        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9219        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9220        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9221        MOVE PI-SV-STATE         TO PI-STATE
  9222        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9223        MOVE CCERTNOI            TO PI-CERT-PRIME
  9224        MOVE CSUFIXI             TO PI-CERT-SFX
  9225        MOVE CEFFDTI             TO DEEDIT-FIELD
  9226        PERFORM 8600-DEEDIT
  9227        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9228        MOVE '4'                 TO DC-OPTION-CODE
  9229        PERFORM 9700-DATE-LINK
  9230        IF DATE-CONVERSION-ERROR
  9231           MOVE ER-0348          TO EMI-ERROR
  9232           MOVE -1               TO CEFFDTL
  9233           MOVE AL-UABON         TO CEFFDTA
  9234           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9235           GO TO 8200-SEND-DATAONLY
  9236        ELSE
  9237           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9238           PERFORM 6000-CREATE-TEMP-STORAGE
  9239                                 THRU 6000-EXIT
  9240           IF EIBAID = DFHPF17
  9241               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9242                                  THRU 6400-EXIT
  9243               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9244                                 '2' AND '3' AND '4'
  9245                  MOVE ER-3831     TO  EMI-ERROR
  9246                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9247                  GO TO 8200-SEND-DATAONLY
  9248               END-IF
  9249               MOVE 'Y'          TO PI-CLM-RESC-IND
  9250           ELSE
  9251               MOVE 'N'          TO PI-CLM-RESC-IND
  9252           END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 169
* EL6311.cbl
  9253           MOVE XCTL-EL6316      TO PGM-NAME
  9254           MOVE '2'              TO PI-ISS-CAN-SW
  9255           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9256           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9257           GO TO 9300-XCTL
  9258        END-IF
  9259     END-IF
  9260
  9261     IF EIBAID = DFHPF4
  9262        MOVE '0'                TO PI-EDIT-SW
  9263        IF PI-DISPLAY-ORIGINAL-BATCH
  9264           NEXT SENTENCE
  9265        ELSE
  9266           GO TO 7200-DISPLAY-BATCHES.
  9267
  9268     IF EIBAID = DFHPF5
  9269        MOVE ER-0029                TO EMI-ERROR
  9270        MOVE -1                     TO BPFENTRL
  9271        MOVE AL-UNBON               TO BPFENTRA
  9272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273        GO TO 8200-SEND-DATAONLY.
  9274*        MOVE '0'                TO PI-EDIT-SW
  9275*        IF PI-DISPLAY-ORIGINAL-BATCH
  9276*           NEXT SENTENCE
  9277*        ELSE
  9278*           MOVE EL631B              TO PI-MAP-NAME
  9279*           MOVE LOW-VALUES          TO EL631BI
  9280*           MOVE 'A'                 TO BMAINTO
  9281*           MOVE AL-UANON            TO BMAINTA
  9282*           MOVE -1                  TO BMAINTL
  9283*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9284*           GO TO 8100-SEND-INITIAL-MAP.
  9285
  9286     IF EIBAID = DFHPF6
  9287        MOVE ER-0029                TO EMI-ERROR
  9288        MOVE -1                     TO BPFENTRL
  9289        MOVE AL-UNBON               TO BPFENTRA
  9290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9291        GO TO 8200-SEND-DATAONLY.
  9292*        MOVE '0'                TO PI-EDIT-SW
  9293*        IF PI-DISPLAY-ORIGINAL-BATCH
  9294*           NEXT SENTENCE
  9295*        ELSE
  9296*           MOVE EL631C              TO PI-MAP-NAME
  9297*           MOVE LOW-VALUES          TO EL631CI
  9298*           MOVE 'A'                 TO CMAINTO
  9299*           MOVE AL-UANON            TO CMAINTA
  9300*           MOVE -1                  TO CMAINTL
  9301*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9302*           GO TO 8100-SEND-INITIAL-MAP.
  9303
  9304     IF EIBAID = DFHPF7
  9305        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9306        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9307        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9308        MOVE PI-SV-STATE            TO PI-STATE
  9309        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9310        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 170
* EL6311.cbl
  9311        MOVE CSUFIXI                TO PI-CERT-SFX
  9312        MOVE CEFFDTI                TO DEEDIT-FIELD
  9313        PERFORM 8600-DEEDIT
  9314        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9315        MOVE '4'                    TO DC-OPTION-CODE
  9316        PERFORM 9700-DATE-LINK
  9317        IF DATE-CONVERSION-ERROR
  9318           MOVE ER-0348            TO EMI-ERROR
  9319           MOVE -1                  TO BEFFDTL
  9320           MOVE AL-UABON            TO BEFFDTA
  9321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322           GO TO 8200-SEND-DATAONLY
  9323        ELSE
  9324           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9325           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9326           MOVE XCTL-EL1273        TO PGM-NAME
  9327           GO TO 9300-XCTL.
  9328
  9329     IF EIBAID = DFHPF8
  9330        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9331        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9332        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9333        MOVE PI-SV-STATE            TO PI-STATE
  9334        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9335        MOVE CCERTNOI               TO PI-CERT-PRIME
  9336        MOVE CSUFIXI                TO PI-CERT-SFX
  9337        MOVE CEFFDTI                TO DEEDIT-FIELD
  9338        PERFORM 8600-DEEDIT
  9339        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9340        MOVE '4'                    TO DC-OPTION-CODE
  9341        PERFORM 9700-DATE-LINK
  9342        IF DATE-CONVERSION-ERROR
  9343           MOVE ER-0348             TO EMI-ERROR
  9344           MOVE -1                  TO BEFFDTL
  9345           MOVE AL-UABON            TO BEFFDTA
  9346           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9347           GO TO 8200-SEND-DATAONLY
  9348        ELSE
  9349           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9350           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9351           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  9352           IF PI-COMPANY-ID = 'DMD'
  9353               MOVE XCTL-EL401DMD      TO PGM-NAME
  9354             ELSE
  9355               MOVE XCTL-EL1279        TO PGM-NAME
  9356           END-IF
  9357           GO TO 9300-XCTL.
  9358
  9359     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9360        MOVE XCTL-EL6312     TO PGM-NAME
  9361
  9362* EXEC CICS XCTL
  9363*           PROGRAM  (PGM-NAME)
  9364*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9365*           LENGTH   (WS-COMM-LENGTH)
  9366*       END-EXEC
  9367*    MOVE '.$C                   %   #00009291' TO DFHEIV0
  9368     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 171
* EL6311.cbl
  9369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9370     MOVE X'2020233030303039323931' TO DFHEIV0(25:11)
  9371     CALL 'kxdfhei1' USING DFHEIV0,
  9372           PGM-NAME,
  9373           PROGRAM-INTERFACE-BLOCK,
  9374           WS-COMM-LENGTH,
  9375           DFHEIV99
  9376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9377     ELSE
  9378        MOVE '0'                 TO  PI-EDIT-SW.
  9379
  9380     IF EIBAID = DFHPF10
  9381         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9382         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9383         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9384         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9385                                    PI-1042-WA
  9386         MOVE 4                  TO PI-689-DATA-SOURCE
  9387         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9388         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9389         MOVE PI-SV-STATE        TO PI-689-STATE
  9390         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9391         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9392         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9393         MOVE PI-PB-ALT-CHG-SEQ-NO
  9394                                 TO PI-689-ALT-SEQ-NO
  9395         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9396         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9397         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9398         MOVE +0                 TO PI-689-CONTROL
  9399         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9400                                    PI-689-EXP-DATE
  9401                                    PI-689-RESP-PERSON
  9402                                    PI-689-TYPE
  9403                                    PI-689-FOLLOW-UP-EDIT
  9404                                    PI-689-RESEND1-EDIT
  9405                                    PI-689-SEQ-EDIT
  9406                                    PI-689-BCSEQ-EDIT
  9407                                    PI-689-LBL-OVERRIDE
  9408         MOVE W-LETTER-COMMUNICATION-AREAS
  9409                                 TO PI-PROGRAM-WORK-AREA
  9410         MOVE XCTL-EL689         TO PGM-NAME
  9411         GO TO 9300-XCTL.
  9412
  9413     IF  EIBAID = DFHPF16
  9414         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9415         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9416         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9417                                    PI-1042-WA
  9418         MOVE 4                  TO PI-689-DATA-SOURCE
  9419         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9420         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9421         MOVE PI-SV-STATE        TO PI-689-STATE
  9422         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9423         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9424         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9425         MOVE PI-PB-ALT-CHG-SEQ-NO
  9426                                 TO PI-689-ALT-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 172
* EL6311.cbl
  9427         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  9428         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9429         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9430         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9431         MOVE W-LETTER-COMMUNICATION-AREAS
  9432                                 TO PI-PROGRAM-WORK-AREA
  9433         MOVE XCTL-EL690         TO PGM-NAME
  9434         GO TO 9300-XCTL.
  9435     IF (EIBAID = DFHPF13)
  9436        if (not fatal-errors)
  9437           and (not unforced-errors)
  9438           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9439           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9440           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9441           MOVE PI-SV-STATE      TO PI-STATE
  9442           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9443           MOVE CCERTNOI         TO PI-CERT-PRIME
  9444           MOVE CSUFIXI          TO PI-CERT-SFX
  9445           MOVE CEFFDTI          TO DEEDIT-FIELD
  9446           PERFORM 8600-DEEDIT
  9447           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9448           MOVE '4'              TO DC-OPTION-CODE
  9449           PERFORM 9700-DATE-LINK
  9450           IF DATE-CONVERSION-ERROR
  9451              MOVE ER-0348       TO EMI-ERROR
  9452              MOVE -1            TO CEFFDTL
  9453              MOVE AL-UABON      TO CEFFDTA
  9454              PERFORM 9900-ERROR-FORMAT
  9455                                 THRU 9900-EXIT
  9456              GO TO 8200-SEND-DATAONLY
  9457           ELSE
  9458              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9459              MOVE AL-UANON      TO CEFFDTA
  9460              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9461              PERFORM 6000-CREATE-TEMP-STORAGE
  9462                                 THRU 6000-EXIT
  9463              MOVE XCTL-EL677    TO PGM-NAME
  9464              GO TO 9300-XCTL
  9465           end-if
  9466        else
  9467           MOVE ER-3444          TO EMI-ERROR
  9468           MOVE -1               TO CPFENTRL
  9469           MOVE AL-UNBON         TO CPFENTRA
  9470           PERFORM 9900-ERROR-FORMAT
  9471                                 THRU 9900-EXIT
  9472           GO TO 8200-SEND-DATAONLY
  9473        end-if
  9474     end-if
  9475
  9476     IF EIBAID = DFHPF14
  9477        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9478        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9479        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9480        MOVE PI-SV-STATE            TO PI-CR-STATE
  9481        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9482        MOVE SPACE                  TO PI-EDIT-SW
  9483        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9484        MOVE XCTL-EL650             TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 173
* EL6311.cbl
  9485        GO TO 9300-XCTL.
  9486
  9487     IF EIBAID = DFHENTER OR DFHPF11
  9488        GO TO 2000-CANCEL-MAINLINE.
  9489
  9490     MOVE ER-0029                TO EMI-ERROR.
  9491     MOVE -1                     TO CPFENTRL.
  9492     MOVE AL-UNBON               TO CPFENTRA.
  9493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9494     GO TO 8200-SEND-DATAONLY.
  9495
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 174
* EL6311.cbl
  9497
  9498******************************************************************
  9499*                                                                *
  9500*      BATCH SCREEN PF KEY CHECKING                              *
  9501*                                                                *
  9502******************************************************************
  9503
  9504******************************************************************
  9505*                                                                *
  9506*      PF KEY FUNCTIONS:                                         *
  9507*                                                                *
  9508*      PF1 = BROWSE FORWARD                                      *
  9509*      PF2 = BROWSE BACKWARD                                     *
  9510*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9511*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9512*                                                                *
  9513*                                                                *
  9514******************************************************************
  9515
  9516 0500-CHECK-BATCH-PF-KEYS.
  9517     IF EIBAID = DFHPF1
  9518        MOVE '0'                TO PI-EDIT-SW
  9519        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9520           GO TO 5000-BROWSE-BATCH-HEADERS
  9521        ELSE
  9522           IF PI-GOOD-BROWSE
  9523              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9524                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9525              ELSE
  9526                 IF PI-FILE-BROWSE
  9527                    GO TO 4300-BROWSE-FILE-FORWARD
  9528                 ELSE
  9529                    IF PI-CSR-BROWSE
  9530                       GO TO 4200-BROWSE-CSR-FORWARD
  9531                    ELSE
  9532                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9533           ELSE
  9534              GO TO 0800-BROWSE-ERROR.
  9535
  9536     IF EIBAID = DFHPF2
  9537        MOVE '0'                TO PI-EDIT-SW
  9538        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9539           GO TO 5500-BROWSE-BATCH-BACKWARD
  9540        ELSE
  9541           IF PI-GOOD-BROWSE
  9542              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9543                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9544              ELSE
  9545                 IF PI-FILE-BROWSE
  9546                    GO TO 4800-BROWSE-FILE-BACKWARD
  9547                 ELSE
  9548                    IF PI-CSR-BROWSE
  9549                       GO TO 4900-BROWSE-CSR-BACKWARD
  9550                    ELSE
  9551                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9552           ELSE
  9553              GO TO 0800-BROWSE-ERROR.
  9554
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 175
* EL6311.cbl
  9555     IF EIBAID = DFHPF3
  9556        GO TO 3000-BATCH-MAINLINE.
  9557
  9558     IF  EIBAID = DFHPF4
  9559        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9560        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9561        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9562        MOVE PI-SV-STATE            TO PI-CR-STATE
  9563        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9564                                       PI-CR-FIN-RESP
  9565        MOVE 'A'                    TO PI-CR-TYPE
  9566        MOVE SPACE                  TO PI-EDIT-SW
  9567        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9568        MOVE XCTL-EL640             TO PGM-NAME
  9569        GO TO 9300-XCTL.
  9570
  9571     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9572       AND
  9573        (EIBAID = DFHENTER)
  9574           GO TO 3500-EDIT-BATCH-DATA.
  9575
  9576     IF EIBAID = DFHENTER
  9577        GO TO 3500-EDIT-BATCH-DATA.
  9578
  9579     MOVE ER-0029             TO EMI-ERROR.
  9580     MOVE -1                  TO DPFENTRL.
  9581     MOVE AL-UNBON            TO DPFENTRA.
  9582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583     GO TO 8200-SEND-DATAONLY.
  9584
  9585 0800-BROWSE-ERROR.
  9586     MOVE ER-2258                TO EMI-ERROR.
  9587     MOVE -1                     TO DPFENTRL.
  9588     MOVE AL-UNBON               TO DPFENTRA.
  9589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9590     GO TO 8200-SEND-DATAONLY.
  9591
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 176
* EL6311.cbl
  9593
  9594******************************************************************
  9595*                                                                *
  9596*                I S S U E   M A I N L I N E                     *
  9597*                                                                *
  9598******************************************************************
  9599
  9600 1000-ISSUE-MAINLINE.
  9601     IF PI-DISPLAY-ORIGINAL-BATCH
  9602        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9603           MOVE ER-0023             TO EMI-ERROR
  9604           MOVE -1                  TO BMAINTL
  9605           MOVE AL-UABON            TO BMAINTA
  9606           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9607           GO TO 8200-SEND-DATAONLY
  9608        ELSE
  9609           NEXT SENTENCE
  9610     ELSE
  9611        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9612           MOVE ER-0023             TO EMI-ERROR
  9613           MOVE -1                  TO BMAINTL
  9614           MOVE AL-UABON            TO BMAINTA
  9615           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9616           GO TO 8200-SEND-DATAONLY.
  9617
  9618     IF BMAINTI = 'S'
  9619        GO TO 1100-SHOW-REQUEST.
  9620
  9621     IF NOT MODIFY-CAP
  9622         MOVE 'UPDATE'       TO SM-READ
  9623         PERFORM 9995-SECURITY-VIOLATION
  9624         MOVE ER-0070        TO EMI-ERROR
  9625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9626         GO TO 8100-SEND-INITIAL-MAP.
  9627
  9628     IF BMAINTL GREATER THAN ZEROS
  9629        IF PI-PF5-FUNCTION
  9630           IF BMAINTI NOT = 'A'
  9631              MOVE AL-UABON  TO BMAINTA
  9632              MOVE -1        TO BMAINTL
  9633              MOVE ER-2260   TO EMI-ERROR
  9634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9635              GO TO 8200-SEND-DATAONLY.
  9636
  9637     IF BCERTNOL = ZEROS
  9638       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9639         NEXT SENTENCE
  9640     ELSE
  9641         IF BCERTNOL NOT = ZEROS
  9642             MOVE AL-UANON       TO BCERTNOA
  9643         ELSE
  9644             MOVE -1             TO BCERTNOL
  9645             MOVE  1             TO SET-CURSOR-SW
  9646             MOVE ER-2218        TO EMI-ERROR
  9647             MOVE AL-UABON       TO BCERTNOA
  9648             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9649
  9650     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 177
* EL6311.cbl
  9651         MOVE AL-UANON       TO BSUFIXA
  9652     ELSE
  9653         MOVE AL-SANOF       TO BSUFIXA.
  9654
  9655
  9656* EXEC CICS READ
  9657*        DATASET (FILE-ID-ERPNDB)
  9658*        INTO    (PENDING-BUSINESS)
  9659*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9660*    END-EXEC.
  9661     MOVE LENGTH OF
  9662      PENDING-BUSINESS
  9663       TO DFHEIV11
  9664*    MOVE '&"IL       E          (   #00009574' TO DFHEIV0
  9665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9667     MOVE X'2020233030303039353734' TO DFHEIV0(25:11)
  9668     CALL 'kxdfhei1' USING DFHEIV0,
  9669           FILE-ID-ERPNDB,
  9670           PENDING-BUSINESS,
  9671           DFHEIV11,
  9672           PI-PREV-CONTROL-PRIMARY,
  9673           DFHEIV99,
  9674           DFHEIV99,
  9675           DFHEIV99
  9676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9677
  9678
  9679     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9680        NEXT SENTENCE
  9681     ELSE
  9682        IF BEFFDTL NOT = ZEROS
  9683           MOVE AL-UNNON             TO BEFFDTA
  9684           MOVE BEFFDTI              TO DEEDIT-FIELD
  9685           PERFORM 8600-DEEDIT
  9686           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9687           MOVE 4                    TO DC-OPTION-CODE
  9688           PERFORM 9700-DATE-LINK
  9689           IF NO-CONVERSION-ERROR
  9690              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9691              ELSE
  9692              MOVE -1                TO BEFFDTL
  9693              MOVE  1                TO SET-CURSOR-SW
  9694              MOVE ER-2226           TO EMI-ERROR
  9695              MOVE AL-UNBON          TO BEFFDTA
  9696              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9697           ELSE
  9698              MOVE -1                TO BEFFDTL
  9699              MOVE  1                TO SET-CURSOR-SW
  9700              MOVE ER-2220           TO EMI-ERROR
  9701              MOVE AL-UNBON          TO BEFFDTA
  9702              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9703
  9704     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9705
  9706     IF BCERTNOL NOT = ZEROS
  9707        MOVE BCERTNOI                TO WS-NEW-PRIME
  9708     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 178
* EL6311.cbl
  9709        MOVE SPACES                  TO WS-NEW-PRIME.
  9710
  9711     IF BSUFIXL NOT = ZEROS
  9712        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9713     ELSE
  9714        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9715
  9716     IF BEFFDTL NOT = ZEROS
  9717        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9718     ELSE
  9719        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9720
  9721     IF BMAINTI = 'A' OR 'K' OR 'S'
  9722        NEXT SENTENCE
  9723     ELSE
  9724        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9725        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9726           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9727           WS-PB-RECORD-TYPE NOT = '1'
  9728           IF BMAINTI = 'C'
  9729               MOVE ER-2287          TO EMI-ERROR
  9730               MOVE -1               TO BCERTNOL
  9731               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9732               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9733               GO TO 8200-SEND-DATAONLY
  9734             ELSE
  9735               MOVE ER-2260          TO EMI-ERROR
  9736               MOVE -1               TO BCERTNOL
  9737               MOVE AL-UABON         TO BCERTNOA
  9738               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9739               GO TO 8200-SEND-DATAONLY.
  9740
  9741     IF BMAINTI = 'D'
  9742         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9743
  9744*    IF BMICRNOL  NOT =  ZEROS
  9745*        IF BMICRNOI  NUMERIC
  9746*            MOVE AL-UNNON       TO  BMICRNOA
  9747*        ELSE
  9748*            MOVE -1             TO  BMICRNOL
  9749*            MOVE 1              TO  SET-CURSOR-SW
  9750*            MOVE AL-UNBON       TO  BMICRNOA
  9751*            MOVE ER-2701        TO  EMI-ERROR
  9752*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9753     IF BVINL NOT = ZEROS
  9754        MOVE AL-UANON            TO BVINA
  9755     END-IF
  9756
  9757     IF LETRREQL   GREATER THAN ZEROS
  9758        IF LETRREQI = 'Y'
  9759          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9760           CONTINUE
  9761        ELSE
  9762        IF LETRREQI = 'N'
  9763          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9764           CONTINUE
  9765        ELSE
  9766           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 179
* EL6311.cbl
  9767           MOVE ER-1585          TO EMI-ERROR
  9768           MOVE AL-UABON         TO LETRREQA
  9769           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9770        END-IF
  9771     END-IF.
  9772     IF B1STNML NOT = ZEROS
  9773         MOVE AL-UANON                TO B1STNMA.
  9774
  9775     IF BINITL  NOT = ZEROS
  9776        MOVE AL-UANON                TO BINITA.
  9777
  9778     IF BSEXL NOT = ZEROS
  9779        IF BSEXI = 'M' OR 'F'
  9780           MOVE AL-UANON             TO BSEXA
  9781        ELSE
  9782           MOVE -1               TO BSEXL
  9783           MOVE ER-2629          TO EMI-ERROR
  9784           MOVE AL-UABON         TO BSEXA
  9785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9786
  9787     IF BAGEL NOT = ZEROS
  9788         IF BAGEI NUMERIC
  9789             MOVE BAGEI              TO WS-BAGE
  9790             MOVE AL-UNNON           TO BAGEA
  9791         ELSE
  9792             MOVE -1                 TO BAGEL
  9793             MOVE  1                 TO SET-CURSOR-SW
  9794             MOVE ER-2223            TO EMI-ERROR
  9795             MOVE AL-UNBON           TO BAGEA
  9796             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9797
  9798     IF BLSTNML NOT = ZERO  OR
  9799        B1STNML NOT = ZERO  OR
  9800        BINITL NOT = ZERO
  9801         IF BAGEL = ZEROS
  9802             MOVE -1                 TO BAGEL
  9803             MOVE  1                 TO SET-CURSOR-SW
  9804             MOVE ER-3269            TO EMI-ERROR
  9805             MOVE AL-UNBON           TO BAGEA
  9806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9807         END-IF
  9808     END-IF.
  9809
  9810     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9811
  9812     IF (BBIRTHL GREATER THAN +0) AND
  9813        (BBIRTHI NOT EQUAL SPACES)
  9814        NEXT SENTENCE
  9815     ELSE
  9816        GO TO 1010-CHECK-AGE.
  9817
  9818     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9819     PERFORM 8600-DEEDIT.
  9820     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9821     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9822     MOVE AL-UNNON               TO BBIRTHA.
  9823     MOVE '4'                    TO DC-OPTION-CODE.
  9824     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 180
* EL6311.cbl
  9825     IF DATE-CONVERSION-ERROR
  9826        MOVE -1                  TO BBIRTHL
  9827        MOVE  1                  TO SET-CURSOR-SW
  9828        MOVE ER-2228             TO EMI-ERROR
  9829        MOVE AL-UNBON            TO BBIRTHA
  9830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9831        GO TO 1010-CHECK-AGE.
  9832
  9833     IF (NO-CONVERSION-ERROR) AND
  9834        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9835        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9836        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9837        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9838                                    WS-CONVERTED-BIRTH
  9839        MOVE AL-UANON            TO BBIRTHA
  9840     ELSE
  9841        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9842        MOVE AL-UANON            TO BBIRTHA.
  9843
  9844 1010-CHECK-AGE.
  9845
  9846*    IF BAGEL = ZERO
  9847*       IF BBIRTHL GREATER THAN ZERO
  9848*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9849
  9850     IF B1STPMTL NOT = ZEROS
  9851        IF B1STPMTI = SPACES
  9852           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9853        ELSE
  9854           MOVE B1STPMTI             TO DEEDIT-FIELD
  9855           PERFORM 8600-DEEDIT
  9856           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9857           MOVE AL-UNNON             TO B1STPMTA
  9858           MOVE 4                    TO DC-OPTION-CODE
  9859           PERFORM 9700-DATE-LINK
  9860           IF NO-CONVERSION-ERROR
  9861              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9862              MOVE AL-UANON          TO B1STPMTA
  9863           ELSE
  9864              MOVE -1                TO B1STPMTL
  9865              MOVE  1                TO SET-CURSOR-SW
  9866              MOVE ER-2200           TO EMI-ERROR
  9867              MOVE AL-UNBON          TO B1STPMTA
  9868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9869
  9870     IF BDAYSL NOT = ZEROS
  9871         IF BDAYSI NUMERIC
  9872             MOVE AL-UNNON           TO BDAYSA
  9873         ELSE
  9874             MOVE -1                 TO BDAYSL
  9875             MOVE ER-2530            TO EMI-ERROR
  9876             MOVE AL-UNBON           TO BDAYSA
  9877             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9878
  9879     IF BLNTRML NOT = ZEROS
  9880         IF BLNTRMI NUMERIC
  9881             MOVE AL-UNNON       TO BLNTRMA
  9882         ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 181
* EL6311.cbl
  9883             MOVE -1             TO BLNTRML
  9884             MOVE ER-2533        TO EMI-ERROR
  9885             MOVE AL-UNBON       TO BLNTRMA
  9886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9887
  9888**   IF PI-COMPANY-ID = 'DMD'
  9889     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9890        NEXT SENTENCE
  9891     ELSE
  9892         IF BLNOFCRL NOT = ZEROS
  9893            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9894            IF LOAN-OFFICER-FOUND
  9895                MOVE AL-UANON        TO BLNOFCRA
  9896             ELSE
  9897                 MOVE SPACE          TO WS-LOAN-OFFICER
  9898                 MOVE -1             TO BLNOFCRL
  9899                 MOVE  1             TO SET-CURSOR-SW
  9900                 MOVE ER-3006        TO EMI-ERROR
  9901                 MOVE AL-UNBON       TO BLNOFCRA
  9902                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9903
  9904     IF BFREQL NOT = ZEROS
  9905         IF BFREQI NUMERIC
  9906             MOVE AL-UNNON       TO BFREQA
  9907         ELSE
  9908             MOVE -1             TO BFREQL
  9909             MOVE  1             TO SET-CURSOR-SW
  9910             MOVE ER-2223        TO EMI-ERROR
  9911             MOVE AL-UNBON       TO BFREQA
  9912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9913
  9914     IF BMODEL NOT = ZEROS
  9915         MOVE BMODEI             TO WS-MODE-CODE
  9916                                    PI-BMODE
  9917         IF WS-MODE-CODE-VALID
  9918             MOVE AL-UANON       TO BMODEA
  9919         ELSE
  9920             MOVE -1             TO BMODEL
  9921             MOVE ER-2591        TO EMI-ERROR
  9922             MOVE AL-UABON       TO BMODEA
  9923             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9924
  9925     IF BPMTSL NOT = ZEROS
  9926         IF BPMTSI NUMERIC
  9927             MOVE AL-UNNON           TO BPMTSA
  9928             MOVE BPMTSI             TO PI-BPMTS
  9929         ELSE
  9930             MOVE -1                 TO BPMTSL
  9931             MOVE ER-2592            TO EMI-ERROR
  9932             MOVE AL-UNBON           TO BPMTSA
  9933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9934
  9935     IF BPMTAMTL NOT = ZEROS
  9936
  9937* EXEC CICS BIF DEEDIT
  9938*            FIELD  (BPMTAMTI)
  9939*            LENGTH (9)
  9940*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 182
* EL6311.cbl
  9941     MOVE 9
  9942       TO DFHEIV11
  9943*    MOVE '@"L                   #   #00009837' TO DFHEIV0
  9944     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9945     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9946     MOVE X'2020233030303039383337' TO DFHEIV0(25:11)
  9947     CALL 'kxdfhei1' USING DFHEIV0,
  9948           BPMTAMTI,
  9949           DFHEIV11
  9950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9951        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9952*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9953*        PERFORM 8600-DEEDIT
  9954*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9955
  9956*    IF BAPRL NOT = ZEROS
  9957*        EXEC CICS BIF DEEDIT
  9958*            FIELD  (BAPRI)
  9959*            LENGTH (7)
  9960*        END-EXEC
  9961*        MOVE BAPRI              TO WS-BAPR.
  9962
  9963     IF BAPRL > 0
  9964        MOVE +0                  TO  WS-BAPR
  9965        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9966           (WS-SUB > 7)
  9967           OR (BAPRI (WS-SUB:1) NUMERIC)
  9968           OR (BAPRI (WS-SUB:1) = '.')
  9969        END-PERFORM
  9970        IF WS-SUB > 7
  9971           MOVE ER-2471       TO EMI-ERROR
  9972           MOVE -1            TO BAPRL
  9973           MOVE AL-UNBON      TO BAPRA
  9974           PERFORM 9900-ERROR-FORMAT
  9975                                 THRU 9900-EXIT
  9976        ELSE
  9977           IF BAPRI (WS-SUB:1) NUMERIC
  9978              MOVE WS-SUB           TO WS-BEG
  9979              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9980                 (WS-SUB > 7)
  9981                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9982              END-PERFORM
  9983              COMPUTE WS-END = WS-SUB - WS-BEG
  9984              MOVE BAPRI (WS-BEG:WS-END)
  9985                                 TO WS-APR-WHOLE-NUM
  9986           END-IF
  9987           IF BAPRI (WS-SUB:1) = '.'
  9988              COMPUTE WS-BEG = WS-SUB + 1
  9989              IF (WS-BEG < 8)
  9990                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9991                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9992                    (WS-SUB > 7)
  9993                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9994                 END-PERFORM
  9995                 COMPUTE WS-END = WS-SUB - WS-BEG
  9996                 MOVE BAPRI (WS-BEG:WS-END)
  9997                                 TO WS-APR-DEC (1:WS-END)
  9998              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 183
* EL6311.cbl
  9999           END-IF
 10000           MOVE AL-UNNON      TO BAPRA
 10001           MOVE WS-BAPR       TO BAPRO
 10002        END-IF
 10003     END-IF
 10004*     IF BAPRL NOT = ZEROS
 10005*        MOVE BAPRI              TO DEEDIT-FIELD-V4
 10006*        PERFORM 8600-DEEDIT
 10007*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
 10008
 10009     IF BLIVESL NOT = ZEROS
 10010        MOVE BLIVESI             TO DEEDIT-FIELD
 10011        PERFORM 8600-DEEDIT
 10012        IF DEEDIT-FIELD-V0 NUMERIC
 10013           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10014           MOVE AL-UNNON         TO BLIVESA
 10015        ELSE
 10016           MOVE -1               TO BLIVESL
 10017           MOVE AL-UNBON         TO BLIVESA
 10018           MOVE ER-2223          TO EMI-ERROR
 10019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10020
 10021*DMD CUSTOM CODING*************START
 10022*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10023     IF PI-COMPANY-ID NOT = 'DMD'
 10024         MOVE ZEROS               TO BBILLEDL
 10025         GO TO 1010-EDIT-CONT.
 10026
 10027     IF BBILLEDL NOT = ZEROS
 10028        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10029        MOVE 'Y'                 TO WS-NUMERIC-SW
 10030        MOVE +1                  TO WS-CSO-SUB
 10031        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10032        IF CSO-NUMERIC-FIELD
 10033
 10034* EXEC CICS BIF DEEDIT
 10035*              FIELD  (BBILLEDI)
 10036*              LENGTH (9)
 10037*          END-EXEC
 10038     MOVE 9
 10039       TO DFHEIV11
 10040*    MOVE '@"L                   #   #00009923' TO DFHEIV0
 10041     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10042     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10043     MOVE X'2020233030303039393233' TO DFHEIV0(25:11)
 10044     CALL 'kxdfhei1' USING DFHEIV0,
 10045           BBILLEDI,
 10046           DFHEIV11
 10047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10048           MOVE BBILLEDI         TO WS-BILLED
 10049           MOVE AL-UNNON         TO BBILLEDA
 10050        ELSE
 10051           MOVE -1               TO BBILLEDL
 10052           MOVE AL-UNBON         TO BBILLEDA
 10053           MOVE ER-2547          TO EMI-ERROR
 10054           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10055     ELSE
 10056        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 184
* EL6311.cbl
 10057           MOVE -1               TO BBILLEDL
 10058           MOVE AL-UNBON         TO BBILLEDA
 10059           MOVE ER-8148          TO EMI-ERROR
 10060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10061
 10062 1010-EDIT-CONT.
 10063
 10064     IF BFORCEL  NOT = ZEROS
 10065         IF FORCE-CAP
 10066            MOVE AL-UANON            TO BFORCEA
 10067         ELSE
 10068            MOVE ER-2945             TO EMI-ERROR
 10069            MOVE AL-UABON            TO BFORCEA
 10070            MOVE -1                  TO BFORCEL
 10071            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10072
 10073     if (bforcel not = zeros)
 10074        and (bforcei = 'L')
 10075        and (not csr-edit-session)
 10076        and (emi-error <> er-2945)
 10077        MOVE ER-2670             TO EMI-ERROR
 10078        MOVE AL-UABON            TO BFORCEA
 10079        MOVE -1                  TO BFORCEL
 10080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10081     end-if
 10082     IF BENTRYL NOT = ZEROS
 10083        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10084                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10085           MOVE ER-2224              TO EMI-ERROR
 10086           MOVE AL-UABON             TO BENTRYA
 10087           MOVE -1                   TO BENTRYL
 10088           MOVE  1                   TO SET-CURSOR-SW
 10089           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10090        ELSE
 10091           MOVE AL-UANON             TO BENTRYA.
 10092
 10093     IF BUNWRITL NOT = ZEROS
 10094        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10095           MOVE ER-7574              TO EMI-ERROR
 10096           MOVE AL-UABON             TO BUNWRITA
 10097           MOVE -1                   TO BUNWRITL
 10098           MOVE  1                   TO SET-CURSOR-SW
 10099           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10100        ELSE
 10101           MOVE AL-UANON             TO BUNWRITA.
 10102
 10103     IF BREINL  NOT = ZEROS
 10104         MOVE AL-UANON               TO BREINA.
 10105
 10106     IF BBILCDL NOT = ZEROS
 10107        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10108                             AND 'A' AND 'B' AND 'E'
 10109           MOVE ER-2225              TO EMI-ERROR
 10110           MOVE AL-UABON             TO BBILCDA
 10111           MOVE -1                   TO BBILCDL
 10112           MOVE  1                   TO SET-CURSOR-SW
 10113           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10114        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 185
* EL6311.cbl
 10115           MOVE AL-UANON             TO BBILCDA.
 10116
 10117     IF BSKPCDL NOT = ZEROS
 10118         MOVE AL-UANON               TO BSKPCDA.
 10119
 10120     IF BINDGRPL NOT = ZEROS
 10121         MOVE AL-UANON               TO BINDGRPA.
 10122
 10123     IF BSIGL   NOT = ZEROS
 10124         MOVE AL-UANON               TO BSIGA.
 10125
 10126     IF BRTCLSL NOT = ZEROS
 10127         MOVE AL-UANON               TO BRTCLSA.
 10128
 10129     IF BMEMBERL NOT = ZEROS
 10130         MOVE AL-UANON               TO BMEMBERA.
 10131
 10132     MOVE +0                         TO WS-SUB1.
 10133
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 186
* EL6311.cbl
 10135
 10136******************************************************************
 10137*                                                                *
 10138*           E D I T   I S S U E   C O V E R A G E S              *
 10139*                                                                *
 10140******************************************************************
 10141
 10142 1020-EDIT-COVERAGES.
 10143     ADD +1                      TO WS-SUB1.
 10144
 10145     IF WS-SUB1 GREATER +2
 10146        GO TO 1025-EDIT-CONTINUE
 10147     END-IF
 10148
 10149     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10150       IF (BMODEL   GREATER ZERO  OR
 10151            BPMTSL   GREATER ZERO  OR
 10152            BPMTAMTL GREATER ZERO)
 10153          AND
 10154            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10155               GO TO 1021-CONT-EDIT.
 10156
 10157     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10158        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10159        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10160        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10161        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10162        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10163        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10164        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10165        NEXT SENTENCE
 10166         ELSE
 10167            GO TO 1020-EDIT-COVERAGES.
 10168
 10169 1021-CONT-EDIT.
 10170
 10171     IF BMAINTI = 'A'
 10172        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10173           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10174        ELSE
 10175           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10176           MOVE ER-7404          TO EMI-ERROR
 10177           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10179     ELSE
 10180        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10181           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10182
 10183     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10184        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10185        PERFORM 8600-DEEDIT
 10186        IF DEEDIT-FIELD-V0 NUMERIC
 10187           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10188        ELSE
 10189           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10190
 10191     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10192*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 187
* EL6311.cbl
 10193        IF BMODEL  GREATER THAN ZEROS  AND
 10194           BPMTSL  GREATER THAN ZEROS
 10195           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10196
 10197     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10198         IF BMODEL   GREATER THAN ZEROS  OR
 10199            BPMTSL   GREATER THAN ZEROS  OR
 10200            BPMTAMTL GREATER THAN ZEROS
 10201             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10202
 10203     IF BMAINTI = ('C' OR 'K')
 10204        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10205           NEXT SENTENCE
 10206        ELSE
 10207           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10208           PERFORM 8600-DEEDIT
 10209           IF DEEDIT-FIELD-V0 NUMERIC
 10210              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10211              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10212                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10213              ELSE
 10214                    MOVE ER-2241      TO EMI-ERROR
 10215                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10216                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10217                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10218           ELSE
 10219              MOVE ER-2223          TO EMI-ERROR
 10220              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10221              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10222              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10223     ELSE
 10224        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10225            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10226            PERFORM 8600-DEEDIT
 10227            IF DEEDIT-FIELD-V0      NUMERIC
 10228               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10229                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10230                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10231               ELSE
 10232                  MOVE ER-2241         TO EMI-ERROR
 10233                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10234                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10235                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10236            ELSE
 10237              MOVE ER-2223             TO EMI-ERROR
 10238              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10239              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10240              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10241        ELSE
 10242            MOVE ER-2240               TO EMI-ERROR
 10243            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10244            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10245*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10246*        IF BMODEL  GREATER THAN ZEROS  AND
 10247*           BPMTSL  GREATER THAN ZEROS
 10248*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10249
 10250     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 188
* EL6311.cbl
 10251        AND BMAINTI = ('C' OR 'K')
 10252           NEXT SENTENCE
 10253     ELSE
 10254        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10255           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10256
 10257* EXEC CICS BIF DEEDIT
 10258*              FIELD  (BBENI (WS-SUB1))
 10259*              LENGTH (12)
 10260*          END-EXEC
 10261     MOVE 12
 10262       TO DFHEIV11
 10263*    MOVE '@"L                   #   #00010135' TO DFHEIV0
 10264     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10265     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10266     MOVE X'2020233030303130313335' TO DFHEIV0(25:11)
 10267     CALL 'kxdfhei1' USING DFHEIV0,
 10268           BBENI(WS-SUB1),
 10269           DFHEIV11
 10270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10271           IF BBENI (WS-SUB1)  NUMERIC
 10272              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10273                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10274*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10275*          PERFORM 8600-DEEDIT
 10276*          IF DEEDIT-FIELD-V2  NUMERIC
 10277*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10278*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10279              ELSE
 10280                 MOVE ER-7632    TO EMI-ERROR
 10281                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10282                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10283                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10284           ELSE
 10285              MOVE ER-2223         TO EMI-ERROR
 10286              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10287              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10289        ELSE
 10290           MOVE ER-7632    TO EMI-ERROR
 10291           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10292           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10294
 10295     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10296        AND (BMAINTI = ('C' OR 'K'))
 10297        CONTINUE
 10298     ELSE
 10299        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10300           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10301           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10302              FOR ALL '.'
 10303           IF WS-TALLY > 1
 10304              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10305                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10306              END-PERFORM
 10307              IF A1 < 9
 10308                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 189
* EL6311.cbl
 10309                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10310              END-IF
 10311           ELSE
 10312              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10313                (A1 > 11)
 10314                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10315                  LOW-VALUES OR SPACES)
 10316              END-PERFORM
 10317              IF A1 > 1 AND < 12
 10318                 MOVE SPACES
 10319                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10320              END-IF
 10321           END-IF
 10322
 10323* EXEC CICS BIF DEEDIT
 10324*              FIELD  (BPREMI (WS-SUB1))
 10325*              LENGTH (11)
 10326*          END-EXEC
 10327     MOVE 11
 10328       TO DFHEIV11
 10329*    MOVE '@"L                   #   #00010190' TO DFHEIV0
 10330     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10331     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10332     MOVE X'2020233030303130313930' TO DFHEIV0(25:11)
 10333     CALL 'kxdfhei1' USING DFHEIV0,
 10334           BPREMI(WS-SUB1),
 10335           DFHEIV11
 10336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10337           IF BPREMI (WS-SUB1) NUMERIC
 10338              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10339                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10340*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10341*          PERFORM 8600-DEEDIT
 10342*          IF DEEDIT-FIELD-V2  NUMERIC
 10343*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10344*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10345              ELSE
 10346                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10347                    MOVE ER-7633    TO EMI-ERROR
 10348                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10349                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10350                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10351                 END-IF
 10352              END-IF
 10353           ELSE
 10354              MOVE ER-2223         TO EMI-ERROR
 10355              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10356              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10358           END-IF
 10359        ELSE
 10360           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10361              MOVE ER-7633         TO EMI-ERROR
 10362              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10363              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10365           END-IF
 10366        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 190
* EL6311.cbl
 10367     END-IF
 10368
 10369     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10370        NEXT SENTENCE
 10371     ELSE
 10372        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10373
 10374* EXEC CICS BIF DEEDIT
 10375*           FIELD  (BCPREMI (WS-SUB1))
 10376*           LENGTH (11)
 10377*       END-EXEC
 10378     MOVE 11
 10379       TO DFHEIV11
 10380*    MOVE '@"L                   #   #00010230' TO DFHEIV0
 10381     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10382     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10383     MOVE X'2020233030303130323330' TO DFHEIV0(25:11)
 10384     CALL 'kxdfhei1' USING DFHEIV0,
 10385           BCPREMI(WS-SUB1),
 10386           DFHEIV11
 10387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10388        IF BCPREMI (WS-SUB1) NUMERIC
 10389           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10390*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10391*       PERFORM 8600-DEEDIT
 10392*       IF DEEDIT-FIELD-V2  NUMERIC
 10393*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10394        ELSE
 10395           MOVE ER-2223         TO EMI-ERROR
 10396           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10397           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10398           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10399
 10400     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10401        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10402        PERFORM 8600-DEEDIT
 10403        IF DEEDIT-FIELD-V0 NUMERIC
 10404           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10405           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10406         ELSE
 10407           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10408           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10409           MOVE ER-2223              TO EMI-ERROR
 10410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10411
 10412     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10413        IF BEXPIRE   (WS-SUB1) = SPACES
 10414           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10415        ELSE
 10416           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10417           PERFORM 8600-DEEDIT
 10418           IF DEEDIT-FIELD-V0        NUMERIC
 10419              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10420              MOVE 4                TO DC-OPTION-CODE
 10421              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10422              PERFORM 9700-DATE-LINK
 10423              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10424                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 191
* EL6311.cbl
 10425              IF NO-CONVERSION-ERROR
 10426                 NEXT SENTENCE
 10427              ELSE
 10428                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10429                 MOVE ER-2531    TO EMI-ERROR
 10430                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10431                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10432           ELSE
 10433             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10434             MOVE ER-2532        TO EMI-ERROR
 10435             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10437
 10438     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10439        NEXT SENTENCE
 10440     ELSE
 10441
 10442* EXEC CICS BIF DEEDIT
 10443*           FIELD  (BALT-BENI (WS-SUB1))
 10444*           LENGTH (12)
 10445*       END-EXEC
 10446     MOVE 12
 10447       TO DFHEIV11
 10448*    MOVE '@"L                   #   #00010287' TO DFHEIV0
 10449     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10450     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10451     MOVE X'2020233030303130323837' TO DFHEIV0(25:11)
 10452     CALL 'kxdfhei1' USING DFHEIV0,
 10453           BALT-BENI(WS-SUB1),
 10454           DFHEIV11
 10455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10456        IF BALT-BENI (WS-SUB1) NUMERIC
 10457           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10458*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10459*       PERFORM 8600-DEEDIT
 10460*       IF DEEDIT-FIELD-V0 NUMERIC
 10461*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10462        ELSE
 10463           MOVE ER-2223         TO EMI-ERROR
 10464           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10465           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10467
 10468     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10469        NEXT SENTENCE
 10470     ELSE
 10471
 10472* EXEC CICS BIF DEEDIT
 10473*           FIELD  (BALT-PREMI (WS-SUB1))
 10474*           LENGTH (11)
 10475*       END-EXEC
 10476     MOVE 11
 10477       TO DFHEIV11
 10478*    MOVE '@"L                   #   #00010306' TO DFHEIV0
 10479     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10480     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10481     MOVE X'2020233030303130333036' TO DFHEIV0(25:11)
 10482     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 192
* EL6311.cbl
 10483           BALT-PREMI(WS-SUB1),
 10484           DFHEIV11
 10485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10486        IF BALT-PREMI (WS-SUB1) NUMERIC
 10487           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10488*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10489*       PERFORM 8600-DEEDIT
 10490*       IF DEEDIT-FIELD-V0 NUMERIC
 10491*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10492        ELSE
 10493           MOVE ER-2223         TO EMI-ERROR
 10494           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10495           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10497
 10498      GO TO 1020-EDIT-COVERAGES.
 10499     .
 10500 1025-edit-continue.
 10501     IF PI-COMPANY-ID  =  'DMD'
 10502        MOVE LOW-VALUES             TO BNCERTI
 10503                                       BNSTATI.
 10504
 10505     IF EMI-ERROR = ZEROS
 10506         NEXT SENTENCE
 10507     ELSE
 10508         GO TO 8200-SEND-DATAONLY.
 10509
 10510     IF BMAINTI = 'A'
 10511         GO TO 1200-ADD-ISSUE-ROUTINE.
 10512
 10513     IF BMAINTI = 'C'
 10514         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10515**  This must be a 'K' transaction A,C,S & D spoke for
 10516
 10517     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10518
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 193
* EL6311.cbl
 10520
 10521 1030-EDIT-FOR-NUMERICS.
 10522     IF WS-CSO-SUB EQUAL 10
 10523        GO TO 1030-EDIT-EXIT.
 10524
 10525     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10526        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10527        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10528           ADD +1               TO WS-CSO-SUB
 10529           GO TO 1030-EDIT-FOR-NUMERICS.
 10530
 10531     MOVE 'N'                   TO WS-NUMERIC-SW.
 10532
 10533 1030-EDIT-EXIT.
 10534******************************************************************
 10535*                                                                *
 10536*                 C A L C U L A T E   A G E                      *
 10537*                                                                *
 10538******************************************************************
 10539
 10540
 10541 1095-CALC-AGE.
 10542
 10543     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10544     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10545     MOVE 1                  TO DC-OPTION-CODE.
 10546     PERFORM 9700-DATE-LINK
 10547     IF NO-CONVERSION-ERROR
 10548         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10549         MOVE WS-BAGE            TO BAGEI
 10550         MOVE +2                 TO BAGEL
 10551         MOVE AL-UNNON TO BAGEA.
 10552
 10553 1099-EXIT.
 10554     EXIT.
 10555
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 194
* EL6311.cbl
 10557
 10558******************************************************************
 10559*                                                                *
 10560*                   S H O W   I S S U E                          *
 10561*                                                                *
 10562******************************************************************
 10563
 10564 1100-SHOW-REQUEST.
 10565     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10566
 10567     IF BCERTNOL = ZEROS AND
 10568        BEFFDTL  = ZEROS
 10569        MOVE -1                  TO BMAINTL
 10570        GO TO 8200-SEND-DATAONLY.
 10571
 10572     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10573
 10574     IF BSUFIXL NOT = ZEROS
 10575        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10576     ELSE
 10577        MOVE SPACE               TO WS-NEW-SUFFIX.
 10578
 10579     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10580     PERFORM 8600-DEEDIT.
 10581     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10582     MOVE '4'                    TO DC-OPTION-CODE.
 10583     PERFORM 9700-DATE-LINK.
 10584     IF DATE-CONVERSION-ERROR
 10585        MOVE ER-0348             TO EMI-ERROR
 10586        MOVE -1                  TO BEFFDTL
 10587        MOVE AL-UABON            TO BEFFDTA
 10588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10589        GO TO 8200-SEND-DATAONLY
 10590     ELSE
 10591        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10592        MOVE AL-UANON            TO BEFFDTA
 10593        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10594
 10595     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10596
 10597     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10598        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10599          MOVE 'Y'                    TO WS-SHOW-SW
 10600          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10601             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10602           ELSE
 10603             IF PI-FILE-BROWSE
 10604                GO TO 4300-BROWSE-FILE-FORWARD
 10605              ELSE
 10606                IF PI-CSR-BROWSE
 10607                   GO TO 4200-BROWSE-CSR-FORWARD
 10608                ELSE
 10609                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10610        ELSE
 10611           GO TO 3900-RE-DISPLAY-RECORD.
 10612
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 195
* EL6311.cbl
 10614
 10615******************************************************************
 10616*                                                                *
 10617*            A D D   I S S U E   R O U T I N E                   *
 10618*                                                                *
 10619******************************************************************
 10620
 10621***************************************************************
 10622*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10623*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10624*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10625*     4. LINK TO THE EDIT ROUTINE.                            *
 10626*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10627*     6. WRITE THE NEW ISSUE RECORD.                          *
 10628*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10629*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10630*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10631*        ELSE                                                 *
 10632*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10633***************************************************************
 10634
 10635 1200-ADD-ISSUE-ROUTINE.
 10636     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10637
 10638
 10639* EXEC CICS GETMAIN
 10640*        SET     (ADDRESS OF PENDING-BUSINESS)
 10641*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10642*    END-EXEC.
 10643*    MOVE '," L                  $   #00010462' TO DFHEIV0
 10644     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10646     MOVE X'2020233030303130343632' TO DFHEIV0(25:11)
 10647     CALL 'kxdfhei1' USING DFHEIV0,
 10648           DFHEIV20,
 10649           ERPNDB-RECORD-LENGTH,
 10650           DFHEIV99
 10651     SET ADDRESS OF PENDING-BUSINESS TO
 10652         DFHEIV20
 10653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10654
 10655
 10656
 10657* EXEC CICS HANDLE CONDITION
 10658*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10659*    END-EXEC.
 10660*    MOVE '"$I                   ! # #00010467' TO DFHEIV0
 10661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10663     MOVE X'2320233030303130343637' TO DFHEIV0(25:11)
 10664     CALL 'kxdfhei1' USING DFHEIV0
 10665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10666
 10667
 10668     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10669     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10670     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10671
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 196
* EL6311.cbl
 10672
 10673* EXEC CICS READ
 10674*        INTO    (PENDING-BUSINESS)
 10675*        DATASET (FILE-ID-ERPNDB)
 10676*        RIDFLD  (ERPNDB-KEY)
 10677*    END-EXEC.
 10678     MOVE LENGTH OF
 10679      PENDING-BUSINESS
 10680       TO DFHEIV11
 10681*    MOVE '&"IL       E          (   #00010475' TO DFHEIV0
 10682     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10684     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 10685     CALL 'kxdfhei1' USING DFHEIV0,
 10686           FILE-ID-ERPNDB,
 10687           PENDING-BUSINESS,
 10688           DFHEIV11,
 10689           ERPNDB-KEY,
 10690           DFHEIV99,
 10691           DFHEIV99,
 10692           DFHEIV99
 10693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10694
 10695
 10696     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10697
 10698     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10699     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10700     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10701     MOVE SPACES                 TO PENDING-BUSINESS.
 10702     MOVE 'PB'                   TO PB-RECORD-ID.
 10703     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10704     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10705     MOVE SPACES                 TO PB-CERT-SFX.
 10706     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10707     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10708                                    PB-ALT-CHG-SEQ-NO.
 10709
 10710     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10711     MOVE '1'                    TO PB-RECORD-TYPE.
 10712
 10713     IF BSUFIXL NOT = ZEROS
 10714        MOVE BSUFIXI             TO PB-CERT-SFX.
 10715
 10716     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10717
 10718     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10719     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10720
 10721     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10722                                    PB-I-LF-PREM-CALC
 10723                                    PB-I-LF-ALT-PREM-CALC
 10724                                    PB-I-LF-RATE
 10725                                    PB-I-LF-ALT-RATE
 10726                                    PB-I-LF-REI-RATE
 10727                                    PB-I-LF-ALT-REI-RATE
 10728                                    PB-I-RATE-DEV-PCT-LF
 10729                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 197
* EL6311.cbl
 10730                                    PB-I-AH-RATE
 10731                                    PB-I-AH-REI-RATE
 10732                                    PB-I-AH-RATE-TRM
 10733                                    PB-I-RATE-DEV-PCT-AH
 10734                                    PB-I-BUSINESS-TYPE
 10735                                    PB-I-LIFE-COMMISSION
 10736                                    PB-I-JOINT-COMMISSION
 10737                                    PB-I-JOINT-AGE
 10738                                    PB-I-AH-COMMISSION
 10739                                    PB-I-CURR-SEQ
 10740                                    PB-CHG-COUNT
 10741                                    PB-LF-BILLED-AMTS
 10742                                    PB-AH-BILLED-AMTS
 10743                                    PB-CALC-TOLERANCE
 10744                                    PB-I-EXTENTION-DAYS
 10745*                                   PB-I-MICROFILM-NO
 10746                                    PB-I-TERM-IN-DAYS.
 10747
 10748     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10749                                    PB-I-LF-EXPIRE-DT
 10750                                    PB-I-AH-EXPIRE-DT
 10751                                    PB-BILLED-DT
 10752                                    PB-ACCT-EFF-DT
 10753                                    PB-ACCT-EXP-DT
 10754                                    PB-I-1ST-PMT-DT.
 10755
 10756     MOVE 'X'                    TO PB-FATAL-FLAG.
 10757
 10758     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10759
 10760     IF BLSTNML GREATER THAN ZEROS
 10761         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10762
 10763*    IF BMICRNOL  GREATER  ZEROS
 10764*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10765*    ELSE
 10766*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10767     IF BVINL > ZEROS
 10768        MOVE BVINI               TO PB-I-VIN
 10769     END-IF
 10770     IF B1STNML GREATER THAN ZEROS
 10771         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10772
 10773     IF BINITL  GREATER THAN ZEROS
 10774         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10775
 10776     IF BBIRTHL GREATER THAN ZERO
 10777         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10778     ELSE
 10779         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10780
 10781     IF B1STPMTL GREATER THAN ZERO
 10782         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10783     ELSE
 10784         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10785
 10786     IF BAGEL    GREATER THAN ZEROS
 10787         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 198
* EL6311.cbl
 10788        ELSE
 10789         MOVE ZEROS              TO PB-I-AGE.
 10790
 10791     IF BSEXL    GREATER THAN ZEROS
 10792         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10793
 10794     IF BTERM-LEN (1) GREATER THAN ZEROS
 10795        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10796     ELSE
 10797        MOVE ZEROS               TO PB-I-LF-TERM.
 10798
 10799     IF BTERM-LEN (2) GREATER THAN ZEROS
 10800        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10801     ELSE
 10802        MOVE ZEROS               TO PB-I-AH-TERM.
 10803
 10804     IF BLNTRML       GREATER THAN ZEROS
 10805         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10806        ELSE
 10807         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10808
 10809     IF BFREQL        GREATER THAN ZEROS
 10810         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10811        ELSE
 10812         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10813
 10814     IF BSKPCDL       GREATER THAN ZEROS
 10815         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10816
 10817     IF BMODEL        GREATER THAN ZEROS
 10818         MOVE BMODEI             TO PB-I-TERM-TYPE
 10819                                    PI-BMODE.
 10820
 10821     IF BPMTSL        GREATER THAN ZEROS
 10822         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10823                                    PI-BPMTS
 10824        ELSE
 10825         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10826                                    PI-BPMTS.
 10827
 10828     IF BPMTAMTL      GREATER THAN ZEROS
 10829         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10830        ELSE
 10831         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10832
 10833     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10834        IF BTYPE  (1)   NOT = ZEROS
 10835           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10836                                    PI-BTYPE (1)
 10837           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10838           MOVE SPACES           TO PB-I-LF-ABBR
 10839        ELSE
 10840           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10841                                    PB-I-LF-ABBR
 10842           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10843     ELSE
 10844        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10845                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 199
* EL6311.cbl
 10846        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10847
 10848     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10849         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10850     ELSE
 10851         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10852
 10853     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10854         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10855     ELSE
 10856         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10857
 10858     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10859         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10860            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10861            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10862         ELSE
 10863            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10864*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10865*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10866         END-IF
 10867     ELSE
 10868         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10869
 10870     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10871         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10872
 10873     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10874         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10875         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10876     ELSE
 10877         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10878
 10879     IF  BALT-PREM-LEN     (2) > ZEROS
 10880         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10881     ELSE
 10882         MOVE ZEROS            TO PB-I-TOT-FEES.
 10883
 10884     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10885        IF BTYPE      (2)   NOT = ZEROS
 10886           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10887                                  PI-BTYPE (2)
 10888           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10889           MOVE SPACES         TO PB-I-AH-ABBR
 10890        ELSE
 10891           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10892                                  PB-I-AH-ABBR
 10893           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10894     ELSE
 10895        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10896                                  PB-I-AH-ABBR
 10897        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10898
 10899     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10900         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10901     ELSE
 10902         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10903
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 200
* EL6311.cbl
 10904     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10905         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10906            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10907            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10908         ELSE
 10909            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10910*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10911*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10912         END-IF
 10913     ELSE
 10914         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10915
 10916     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10917         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10918
 10919     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10920        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10921     ELSE
 10922        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10923
 10924     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10925        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10926     ELSE
 10927        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10928
 10929     IF BINDGRPL  GREATER THAN ZEROS
 10930         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10931
 10932     IF BRTCLSL   GREATER THAN ZEROS
 10933         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10934
 10935     IF BSIGL     GREATER THAN ZEROS
 10936         MOVE BSIGI              TO PB-I-SIG-SW.
 10937     IF BAPRL > ZEROS
 10938         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10939     ELSE
 10940        if pi-company-id = 'CID'
 10941           move +99.9999         to pb-i-loan-apr
 10942        else
 10943           MOVE ZEROS            TO PB-I-LOAN-APR
 10944        end-if
 10945     end-if
 10946     IF BMEMBERL  GREATER THAN ZEROS
 10947         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10948
 10949     IF BLNOFCRL  GREATER THAN ZEROS
 10950         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10951
 10952     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10953        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10954     ELSE
 10955        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10956
 10957     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10958        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10959     ELSE
 10960        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10961
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 201
* EL6311.cbl
 10962     IF BDAYSL   GREATER THAN ZEROS
 10963        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10964                                    PB-I-EXTENTION-DAYS
 10965     ELSE
 10966        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10967                                    PB-I-EXTENTION-DAYS.
 10968
 10969     IF BDAYSL GREATER THAN ZEROS
 10970        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10971
 10972     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10973        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10974           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10975
 10976     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10977        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10978           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10979
 10980     IF B1STPMTL GREATER THAN ZEROS
 10981        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10982
 10983     IF PB-EXT-DAYS-PROCESSING
 10984        IF PB-I-EXTENTION-DAYS = ZEROS
 10985           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10986
 10987     IF PB-EXPIRE-DT-PROCESSING
 10988        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10989           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10990             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10991
 10992     IF PB-1ST-PMT-DT-PROCESSING
 10993        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10994           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10995
 10996     IF BREINL GREATER THAN ZEROS
 10997        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10998
 10999     IF BENTRYL NOT = ZEROS
 11000        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11001        IF PI-COMPANY-ID = 'CID'
 11002           AND (PB-BATCH-ENTRY = 'P')
 11003           AND (PB-STATE = 'VA')
 11004           PERFORM 1500-UPDATE-ERNOTE
 11005                                 THRU 1500-EXIT
 11006        END-IF
 11007     END-IF
 11008     IF BUNWRITL NOT = ZEROS
 11009        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11010
 11011     IF BFORCEL NOT = ZEROS
 11012        MOVE BFORCEI             TO PB-FORCE-CODE.
 11013
 11014     IF BBILCDL NOT = ZEROS
 11015        MOVE BBILCDI             TO PB-RECORD-BILL.
 11016
 11017     IF BLIVESL GREATER THAN ZEROS
 11018        MOVE WS-BLIVES           TO PB-I-LIVES
 11019     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 202
* EL6311.cbl
 11020        MOVE ZEROS               TO PB-I-LIVES.
 11021
 11022     IF BBILLEDL GREATER THAN ZEROS
 11023        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11024     ELSE
 11025        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11026
 11027*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11028
 11029 1260-WRITE-PB-RECORD.
 11030     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11031                                    PB-INPUT-BY.
 11032     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11033     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11034                                    PB-INPUT-DT.
 11035
 11036     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11037     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11038                                    PB-CONTROL-BY-ORIG-BATCH.
 11039
 11040
 11041     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11042     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11043     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11044     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11045     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11046
 11047     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11048
 11049     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11050
 11051     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11052     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11053     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11054
 11055     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11056     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11057
 11058 1275-WRITE-PENDING-BUSINESS.
 11059     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11060     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11061     MOVE 'A'                    TO JP-RECORD-TYPE.
 11062     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11063
 11064
 11065* EXEC CICS HANDLE CONDITION
 11066*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11067*    END-EXEC.
 11068*    MOVE '"$%                   ! $ #00010849' TO DFHEIV0
 11069     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11071     MOVE X'2420233030303130383439' TO DFHEIV0(25:11)
 11072     CALL 'kxdfhei1' USING DFHEIV0
 11073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11074
 11075
 11076
 11077* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 203
* EL6311.cbl
 11078*        DATASET (FILE-ID-ERPNDB)
 11079*        FROM    (PENDING-BUSINESS)
 11080*        RIDFLD  (PB-CONTROL-PRIMARY)
 11081*    END-EXEC.
 11082     MOVE LENGTH OF
 11083      PENDING-BUSINESS
 11084       TO DFHEIV11
 11085*    MOVE '&$ L                  ''   #00010853' TO DFHEIV0
 11086     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11088     MOVE X'2020233030303130383533' TO DFHEIV0(25:11)
 11089     CALL 'kxdfhei1' USING DFHEIV0,
 11090           FILE-ID-ERPNDB,
 11091           PENDING-BUSINESS,
 11092           DFHEIV11,
 11093           PB-CONTROL-PRIMARY,
 11094           DFHEIV99,
 11095           DFHEIV99
 11096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11097
 11098
 11099     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11100
 11101     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11102
 11103******************************************************************
 11104*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11105******************************************************************
 11106     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11107     MOVE ' '                    TO WS-ERMAIL-SW
 11108
 11109* EXEC CICS READ
 11110*       DATASET   (FILE-ID-ERMAIL)
 11111*       SET       (ADDRESS OF MAILING-DATA)
 11112*       RIDFLD    (ERMAIL-KEY)
 11113*       RESP      (WS-RESPONSE)
 11114*    END-EXEC
 11115*    MOVE '&"S        E          (  N#00010869' TO DFHEIV0
 11116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11118     MOVE X'204E233030303130383639' TO DFHEIV0(25:11)
 11119     CALL 'kxdfhei1' USING DFHEIV0,
 11120           FILE-ID-ERMAIL,
 11121           DFHEIV20,
 11122           DFHEIV99,
 11123           ERMAIL-KEY,
 11124           DFHEIV99,
 11125           DFHEIV99,
 11126           DFHEIV99
 11127     SET ADDRESS OF MAILING-DATA TO
 11128         DFHEIV20
 11129     MOVE EIBRESP  TO WS-RESPONSE
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11131     IF RESP-NORMAL
 11132        SET ERMAIL-FOUND TO TRUE
 11133     END-IF
 11134
 11135     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 204
* EL6311.cbl
 11136     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11137     MOVE 'OC'                   TO OC-RECORD-ID
 11138     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11139                                 TO OC-CONTROL-PRIMARY (1:33)
 11140     MOVE 'I'                    TO OC-RECORD-TYPE
 11141     MOVE +4096                  TO OC-KEY-SEQ-NO
 11142     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11143     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11144     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11145     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11146     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11147     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11148     MOVE PB-I-AGE               TO OC-INS-AGE
 11149     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11150     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11151     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11152     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11153     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11154     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11155     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11156     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11157     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11158     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11159     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11160     IF PB-I-JOINT-COMMISSION > +0
 11161         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11162     ELSE
 11163         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11164     END-IF
 11165     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11166     MOVE +0                     TO OC-LF-CANCEL-AMT
 11167                                    OC-LF-ITD-CANCEL-AMT
 11168     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11169     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11170     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11171     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11172     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11173     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11174     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11175     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11176     MOVE +0                     TO OC-AH-CANCEL-AMT
 11177                                    OC-AH-ITD-CANCEL-AMT
 11178     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11179     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11180     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11181     IF ERMAIL-FOUND
 11182        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11183     END-IF
 11184     IF NOT CERT-TRL-REC-NOT-FOUND
 11185        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11186                           OC-INS-AGE-DEFAULT-FLAG
 11187        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11188                           OC-JNT-AGE-DEFAULT-FLAG
 11189     END-IF
 11190     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11191     .
 11192 1275-WRITE-ELCRTO.
 11193
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 205
* EL6311.cbl
 11194* EXEC CICS WRITE
 11195*       DATASET   ('ELCRTO')
 11196*       FROM      (ORIGINAL-CERTIFICATE)
 11197*       RIDFLD    (OC-CONTROL-PRIMARY)
 11198*       RESP      (WS-RESPONSE)
 11199*    END-EXEC
 11200     MOVE LENGTH OF
 11201      ORIGINAL-CERTIFICATE
 11202       TO DFHEIV11
 11203     MOVE 'ELCRTO' TO DFHEIV1
 11204*    MOVE '&$ L                  ''  N#00010937' TO DFHEIV0
 11205     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11207     MOVE X'204E233030303130393337' TO DFHEIV0(25:11)
 11208     CALL 'kxdfhei1' USING DFHEIV0,
 11209           DFHEIV1,
 11210           ORIGINAL-CERTIFICATE,
 11211           DFHEIV11,
 11212           OC-CONTROL-PRIMARY,
 11213           DFHEIV99,
 11214           DFHEIV99
 11215     MOVE EIBRESP  TO WS-RESPONSE
 11216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11217*    display ' just wrote 1275 ' ws-response
 11218     IF RESP-DUPKEY
 11219        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11220        GO TO 1275-WRITE-ELCRTO
 11221     ELSE
 11222        IF NOT RESP-NORMAL
 11223           MOVE -1               TO BMAINTL
 11224           MOVE ER-7450          TO EMI-ERROR
 11225           PERFORM 9900-ERROR-FORMAT
 11226                                 THRU 9900-EXIT
 11227           GO TO 8200-SEND-DATAONLY
 11228        END-IF
 11229     END-IF
 11230******************************************************************
 11231*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11232******************************************************************
 11233
 11234
 11235* EXEC CICS READ
 11236*        INTO    (PENDING-BUSINESS)
 11237*        DATASET (FILE-ID-ERPNDB)
 11238*        RIDFLD  (ERPNDB-KEY)
 11239*        UPDATE
 11240*    END-EXEC.
 11241     MOVE LENGTH OF
 11242      PENDING-BUSINESS
 11243       TO DFHEIV11
 11244*    MOVE '&"IL       EU         (   #00010960' TO DFHEIV0
 11245     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11246     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11247     MOVE X'2020233030303130393630' TO DFHEIV0(25:11)
 11248     CALL 'kxdfhei1' USING DFHEIV0,
 11249           FILE-ID-ERPNDB,
 11250           PENDING-BUSINESS,
 11251           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 206
* EL6311.cbl
 11252           ERPNDB-KEY,
 11253           DFHEIV99,
 11254           DFHEIV99,
 11255           DFHEIV99
 11256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11257
 11258
 11259     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11260     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11261     MOVE 'B'                    TO JP-RECORD-TYPE.
 11262     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11263
 11264     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11265
 11266     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11267
 11268
 11269* EXEC CICS REWRITE
 11270*        DATASET (FILE-ID-ERPNDB)
 11271*        FROM    (PENDING-BUSINESS)
 11272*    END-EXEC.
 11273     MOVE LENGTH OF
 11274      PENDING-BUSINESS
 11275       TO DFHEIV11
 11276*    MOVE '&& L                  %   #00010976' TO DFHEIV0
 11277     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11278     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11279     MOVE X'2020233030303130393736' TO DFHEIV0(25:11)
 11280     CALL 'kxdfhei1' USING DFHEIV0,
 11281           FILE-ID-ERPNDB,
 11282           PENDING-BUSINESS,
 11283           DFHEIV11,
 11284           DFHEIV99
 11285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11286
 11287
 11288     MOVE 'C'                    TO JP-RECORD-TYPE.
 11289     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11290
 11291     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11292
 11293     IF WS-ERRORS-PRESENT
 11294         GO TO 3900-RE-DISPLAY-RECORD.
 11295
 11296     MOVE ZEROS                  TO EMI-ERROR.
 11297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298     MOVE LOW-VALUES             TO EL631BI.
 11299     MOVE  -1                    TO BMAINTL.
 11300     GO TO 8100-SEND-INITIAL-MAP.
 11301
 11302 1280-BATCH-HDR-NOT-FOUND.
 11303     MOVE -1                     TO BMAINTL.
 11304     MOVE ER-7450                TO EMI-ERROR.
 11305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11306     GO TO 8200-SEND-DATAONLY.
 11307
 11308 1290-DUPLICATE-ALT-INDEX.
 11309
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 207
* EL6311.cbl
 11310******************************************************************
 11311*                                                                *
 11312*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11313*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11314*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11315*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11316*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11317*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11318*                                                                *
 11319******************************************************************
 11320
 11321     IF LCP-ONCTR-01 =  0
 11322         ADD 1 TO LCP-ONCTR-01
 11323        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11324
 11325     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11326
 11327     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11328         NEXT SENTENCE
 11329     ELSE
 11330         ADD +1 TO PB-BATCH-SEQ-NO
 11331                   PB-CSR-BATCH-SEQ-NO
 11332         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11333         GO TO 1275-WRITE-PENDING-BUSINESS.
 11334
 11335     MOVE -1                     TO BCERTNOL.
 11336     MOVE AL-UABON               TO BCERTNOA.
 11337     MOVE AL-UNBON               TO BEFFDTA.
 11338
 11339     MOVE 1                      TO EMI-SUB
 11340                                    EMI-SWITCH1
 11341                                    EMI-SWITCH-AREA-1
 11342                                    EMI-SWITCH-AREA-2.
 11343
 11344     MOVE SPACES                 TO EMI-ERROR-LINES.
 11345
 11346
 11347* EXEC CICS SYNCPOINT ROLLBACK
 11348*    END-EXEC.
 11349*    MOVE '6"R                   !   #00011039' TO DFHEIV0
 11350     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11352     MOVE X'2020233030303131303339' TO DFHEIV0(25:11)
 11353     CALL 'kxdfhei1' USING DFHEIV0
 11354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11355
 11356
 11357     MOVE ER-2247                TO EMI-ERROR.
 11358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11359     GO TO 8200-SEND-DATAONLY.
 11360
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 208
* EL6311.cbl
 11362
 11363
 11364 1295-READ-CERT-TRAILER.
 11365
 11366
 11367* EXEC CICS GETMAIN
 11368*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11369*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11370*        INITIMG (GETMAIN-SPACE)
 11371*    END-EXEC
 11372*    MOVE ',"IL                  $   #00011051' TO DFHEIV0
 11373     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11375     MOVE X'2020233030303131303531' TO DFHEIV0(25:11)
 11376     CALL 'kxdfhei1' USING DFHEIV0,
 11377           DFHEIV20,
 11378           ELCRTT-RECORD-LENGTH,
 11379           GETMAIN-SPACE
 11380     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11381         DFHEIV20
 11382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11383
 11384     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11385     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11386     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11387
 11388
 11389* EXEC CICS HANDLE CONDITION
 11390*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11391*    END-EXEC.
 11392*    MOVE '"$I                   ! % #00011061' TO DFHEIV0
 11393     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11395     MOVE X'2520233030303131303631' TO DFHEIV0(25:11)
 11396     CALL 'kxdfhei1' USING DFHEIV0
 11397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11398
 11399
 11400
 11401* EXEC CICS READ
 11402*        DATASET  (CRTT-ID)
 11403*        RIDFLD   (ELCRTT-KEY)
 11404*        INTO     (CERTIFICATE-TRAILERS)
 11405*    END-EXEC.
 11406     MOVE LENGTH OF
 11407      CERTIFICATE-TRAILERS
 11408       TO DFHEIV11
 11409*    MOVE '&"IL       E          (   #00011065' TO DFHEIV0
 11410     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11412     MOVE X'2020233030303131303635' TO DFHEIV0(25:11)
 11413     CALL 'kxdfhei1' USING DFHEIV0,
 11414           CRTT-ID,
 11415           CERTIFICATE-TRAILERS,
 11416           DFHEIV11,
 11417           ELCRTT-KEY,
 11418           DFHEIV99,
 11419           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 209
* EL6311.cbl
 11420           DFHEIV99
 11421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11422
 11423
 11424     GO TO 1295-EXIT.
 11425
 11426 1295-CERT-TRL-REC-NOTFND.
 11427     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11428
 11429 1295-EXIT.
 11430     EXIT.
 11431
 11432******************************************************************
 11433*                                                                *
 11434*          C H A N G E   I S S U E   R O U T I N E               *
 11435*                                                                *
 11436******************************************************************
 11437
 11438***************************************************************
 11439*                                                             *
 11440*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11441*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11442*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11443*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11444*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11445*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11446*     5. LINK TO THE EDIT ROUTINE.                            *
 11447*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11448*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11449*              THE EDIT ROUTINE.                              *
 11450*     7. REWRITE THE NEW ISSUE                                *
 11451*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11452*                                                             *
 11453***************************************************************
 11454
 11455 1300-CHANGE-ISSUE-ROUTINE.
 11456     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11457
 11458     IF BCHGL NOT = ZEROS
 11459        MOVE ER-2196             TO EMI-ERROR
 11460        MOVE AL-UABON            TO BMAINTA
 11461        MOVE -1                  TO BMAINTL
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 8200-SEND-DATAONLY.
 11464
 11465     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11466
 11467     IF BSUFIXL NOT = ZEROS
 11468        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11469     ELSE
 11470        MOVE SPACE               TO WS-NEW-SUFFIX.
 11471
 11472     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11473     PERFORM 8600-DEEDIT.
 11474     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11475     MOVE '4'                    TO DC-OPTION-CODE.
 11476     PERFORM 9700-DATE-LINK.
 11477     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 210
* EL6311.cbl
 11478        MOVE ER-0348             TO EMI-ERROR
 11479        MOVE -1                  TO BEFFDTL
 11480        MOVE AL-UABON            TO BEFFDTA
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11482        GO TO 8200-SEND-DATAONLY
 11483     ELSE
 11484        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11485        MOVE AL-UANON            TO BEFFDTA
 11486        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11487
 11488 1325-PROCESS-ISSUE-CHANGES.
 11489
 11490* EXEC CICS HANDLE CONDITION
 11491*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11492*    END-EXEC.
 11493*    MOVE '"$I                   ! & #00011136' TO DFHEIV0
 11494     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11496     MOVE X'2620233030303131313336' TO DFHEIV0(25:11)
 11497     CALL 'kxdfhei1' USING DFHEIV0
 11498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11499
 11500
 11501     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11502     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11503     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11504
 11505
 11506* EXEC CICS GETMAIN
 11507*        SET      (ADDRESS OF PENDING-BUSINESS)
 11508*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11509*        INITIMG  (GETMAIN-SPACE)
 11510*     END-EXEC.
 11511*    MOVE ',"IL                  $   #00011144' TO DFHEIV0
 11512     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11514     MOVE X'2020233030303131313434' TO DFHEIV0(25:11)
 11515     CALL 'kxdfhei1' USING DFHEIV0,
 11516           DFHEIV20,
 11517           ERPNDB-RECORD-LENGTH,
 11518           GETMAIN-SPACE
 11519     SET ADDRESS OF PENDING-BUSINESS TO
 11520         DFHEIV20
 11521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11522
 11523
 11524
 11525* EXEC CICS READ
 11526*        INTO    (PENDING-BUSINESS)
 11527*        DATASET (FILE-ID-ERPNDB)
 11528*        RIDFLD  (ERPNDB-KEY)
 11529*    END-EXEC.
 11530     MOVE LENGTH OF
 11531      PENDING-BUSINESS
 11532       TO DFHEIV11
 11533*    MOVE '&"IL       E          (   #00011150' TO DFHEIV0
 11534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 211
* EL6311.cbl
 11536     MOVE X'2020233030303131313530' TO DFHEIV0(25:11)
 11537     CALL 'kxdfhei1' USING DFHEIV0,
 11538           FILE-ID-ERPNDB,
 11539           PENDING-BUSINESS,
 11540           DFHEIV11,
 11541           ERPNDB-KEY,
 11542           DFHEIV99,
 11543           DFHEIV99,
 11544           DFHEIV99
 11545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11546
 11547
 11548     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11549
 11550
 11551* EXEC CICS HANDLE CONDITION
 11552*         NOTFND     (1385-REC-NOT-FOUND)
 11553*    END-EXEC.
 11554*    MOVE '"$I                   ! '' #00011158' TO DFHEIV0
 11555     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11557     MOVE X'2720233030303131313538' TO DFHEIV0(25:11)
 11558     CALL 'kxdfhei1' USING DFHEIV0
 11559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11560
 11561
 11562**********************************************************
 11563*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11564*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11565**********************************************************
 11566
 11567
 11568* EXEC CICS READ
 11569*        DATASET (FILE-ID-ERPNDB)
 11570*        INTO    (PENDING-BUSINESS)
 11571*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11572*    END-EXEC.
 11573     MOVE LENGTH OF
 11574      PENDING-BUSINESS
 11575       TO DFHEIV11
 11576*    MOVE '&"IL       E          (   #00011167' TO DFHEIV0
 11577     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11579     MOVE X'2020233030303131313637' TO DFHEIV0(25:11)
 11580     CALL 'kxdfhei1' USING DFHEIV0,
 11581           FILE-ID-ERPNDB,
 11582           PENDING-BUSINESS,
 11583           DFHEIV11,
 11584           PI-PREV-CONTROL-PRIMARY,
 11585           DFHEIV99,
 11586           DFHEIV99,
 11587           DFHEIV99
 11588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11589
 11590
 11591********** DO NOT ALLOW CHANGES IF THRU A/R
 11592     IF BMAINTI = 'C'
 11593         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 212
* EL6311.cbl
 11594             MOVE ER-4005          TO EMI-ERROR
 11595             MOVE -1               TO BMAINTL
 11596             MOVE AL-UABON         TO BMAINTA
 11597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598             GO TO 8200-SEND-DATAONLY.
 11599**********
 11600     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11601
 11602     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11603        MOVE -1                 TO BMAINTL
 11604        MOVE ER-2197            TO EMI-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 8200-SEND-DATAONLY.
 11607
 11608     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11609        MOVE ER-2196             TO EMI-ERROR
 11610        MOVE AL-UABON            TO BMAINTA
 11611        MOVE -1                  TO BMAINTL
 11612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613        GO TO 8200-SEND-DATAONLY.
 11614
 11615     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11616
 11617     IF PB-BILLED-DT = LOW-VALUES AND
 11618        PB-CHG-COUNT = ZEROS
 11619        NEXT SENTENCE
 11620     ELSE
 11621        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11622            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11623           OR
 11624           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11625            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11626           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11627     move zeros                  to ws-check-amts
 11628     move ' '                    to ws-stop-sw
 11629                                    ws-check-sw
 11630                                    ws-proc-check-sw
 11631                                    ws-any-check-sw
 11632                                    ws-chek-browse-sw
 11633
 11634     perform 2500-browse-checks  thru 2500-exit
 11635
 11636     if i-have-processed-checks
 11637        or i-have-checks
 11638        continue
 11639     else
 11640        go to 1330-continue
 11641     end-if
 11642
 11643     compute ws-tot-orig-prem =
 11644        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11645        pb-i-lf-alt-premium-amt
 11646
 11647     if bprem1l <> zeros
 11648        MOVE AL-UNNON            TO bprem1a
 11649        move ws-bprem (1)        to ws-new-iss-total
 11650     else
 11651        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 213
* EL6311.cbl
 11652     end-if
 11653     display ' new iss totala ' ws-new-iss-total
 11654
 11655     if baltpr1l <> zeros
 11656        MOVE AL-UNNON            TO baltpr1a
 11657        compute ws-new-iss-total =
 11658           ws-new-iss-total + ws-balt-prem(1)
 11659     else
 11660        compute ws-new-iss-total =
 11661           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11662     end-if
 11663
 11664     if bprem2l <> zeros
 11665        MOVE AL-UNNON            TO bprem2a
 11666        compute ws-new-iss-total = ws-new-iss-total +
 11667           ws-bprem (2)
 11668     else
 11669        compute ws-new-iss-total = ws-new-iss-total +
 11670           pb-i-ah-premium-amt
 11671     end-if
 11672
 11673     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11674        if ((bprem1l <> zeros)
 11675           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11676                      or
 11677           ((bprem2l <> zeros)
 11678           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11679           move er-3456          to emi-error
 11680           perform 9900-error-format
 11681                                 thru 9900-exit
 11682           go to 1330-continue
 11683        end-if
 11684     end-if
 11685
 11686     if ws-new-iss-total > ws-tot-orig-prem
 11687        move er-3458             to emi-error
 11688        perform 9900-error-format thru 9900-exit
 11689        move al-uabon            to bmainta
 11690        move -1                  to bmaintl
 11691        go to 8200-send-dataonly
 11692     end-if
 11693
 11694     if ws-new-iss-total < ws-tot-orig-prem
 11695        move er-3457             to emi-error
 11696        move al-uabon            to bprem1a
 11697                                    bprem2a
 11698        move +0 to bprem1l bprem2l
 11699        perform 9900-error-format thru 9900-exit
 11700        move -1                  to bmaintl
 11701        go to 1330-continue
 11702     end-if
 11703
 11704     .
 11705 1330-continue.
 11706
 11707
 11708* EXEC CICS READ
 11709*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 214
* EL6311.cbl
 11710*        INTO    (PENDING-BUSINESS)
 11711*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11712*        UPDATE
 11713*    END-EXEC.
 11714     MOVE LENGTH OF
 11715      PENDING-BUSINESS
 11716       TO DFHEIV11
 11717*    MOVE '&"IL       EU         (   #00011289' TO DFHEIV0
 11718     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11719     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11720     MOVE X'2020233030303131323839' TO DFHEIV0(25:11)
 11721     CALL 'kxdfhei1' USING DFHEIV0,
 11722           FILE-ID-ERPNDB,
 11723           PENDING-BUSINESS,
 11724           DFHEIV11,
 11725           PI-PREV-CONTROL-PRIMARY,
 11726           DFHEIV99,
 11727           DFHEIV99,
 11728           DFHEIV99
 11729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11730
 11731
 11732     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11733     MOVE 'B'                    TO JP-RECORD-TYPE
 11734     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11735     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11736
 11737*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11738
 11739     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11740        PB-CHG-COUNT NOT = ZEROS
 11741        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11742            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11743           OR
 11744           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11745            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11746            MOVE LOW-VALUES             TO PB-BILLED-DT
 11747            ADD +1                      TO PB-CHG-COUNT.
 11748
 11749     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11750     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11751     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11752     MOVE '5'                    TO DC-OPTION-CODE.
 11753     PERFORM 9700-DATE-LINK
 11754     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11755
 11756*    IF BMICRNOL  GREATER  ZEROS
 11757*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11758
 11759     IF BVINL > ZEROS
 11760        MOVE BVINI               TO PB-I-VIN
 11761     END-IF
 11762     IF (BFORCEL NOT = ZEROS)
 11763        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11764        AND (BFORCEI = ' ')
 11765        AND (PB-FORCE-CODE = 'O')
 11766        COMPUTE PB-I-AH-PREMIUM-AMT =
 11767           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 215
* EL6311.cbl
 11768        PERFORM 1800-REMOVE-CERT-NOTES
 11769                                 THRU 1800-EXIT
 11770        PERFORM 1900-DELETE-ERPYAJ
 11771                                 THRU 1900-EXIT
 11772        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11773     END-IF
 11774     IF (BFORCEL NOT = ZEROS)
 11775        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11776        AND (BFORCEI = 'O')
 11777        AND (PB-FORCE-CODE NOT = 'O')
 11778        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11779           PB-I-AH-PREM-CALC
 11780        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11781        MOVE SPACE               TO DC-OPTION-CODE
 11782        PERFORM 9700-DATE-LINK
 11783        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11784        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11785        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11786        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11787        PERFORM 1500-UPDATE-ERNOTE
 11788                                 THRU 1500-EXIT
 11789        PERFORM 1600-UPDATE-ERPYAJ
 11790                                 THRU 1600-EXIT
 11791     END-IF
 11792     IF BLSTNML  GREATER THAN ZEROS
 11793         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11794
 11795     IF B1STNML  GREATER THAN ZEROS
 11796         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11797
 11798     IF BINITL   GREATER THAN ZEROS
 11799         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11800
 11801     IF BBIRTHL  GREATER THAN ZERO
 11802         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11803
 11804     IF B1STPMTL GREATER THAN ZERO
 11805         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11806
 11807     IF BAGEL    GREATER THAN ZEROS
 11808         MOVE BAGEI              TO PB-I-AGE.
 11809
 11810     MOVE 'N'                    TO WS-INS-AGE-SET
 11811                                    WS-JNT-AGE-SET.
 11812     IF BAGEL    GREATER THAN ZEROS
 11813        MOVE 'Y'                TO WS-INS-AGE-SET
 11814        IF BAGEI = ZERO AND
 11815             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11816           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11817           MOVE 'AGE*'          TO BAGEDEFO
 11818        ELSE
 11819           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11820           MOVE 'AGE '          TO BAGEDEFO
 11821        END-IF
 11822        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11823     END-IF.
 11824
 11825     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 216
* EL6311.cbl
 11826         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11827
 11828     IF LETRREQL   GREATER THAN ZEROS
 11829        MOVE LETRREQI TO PB-I-LETTER-REQD
 11830     END-IF.
 11831
 11832     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11833        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11834
 11835     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11836        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11837
 11838     IF BLNTRML  GREATER THAN ZEROS
 11839         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11840
 11841     IF BFREQL   GREATER THAN ZEROS
 11842         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11843
 11844     IF BSKPCDL  GREATER THAN ZEROS
 11845         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11846
 11847     IF BMODEL   GREATER THAN ZEROS
 11848         MOVE BMODEI             TO PB-I-TERM-TYPE
 11849                                    PI-BMODE.
 11850
 11851     IF BPMTSL   GREATER THAN ZEROS
 11852         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11853                                    PI-BPMTS.
 11854
 11855     IF BPMTAMTL GREATER THAN ZEROS
 11856         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11857
 11858     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11859         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11860
 11861     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11862         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11863
 11864     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11865
 11866     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11867         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11868            SUBTRACT PB-I-LF-PREMIUM-AMT
 11869                     FROM WS-B-LF-ISS-PRM-ENTERED
 11870            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11871            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11872            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11873         ELSE
 11874            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11875*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11876*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11877         END-IF
 11878     END-IF.
 11879
 11880     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11881            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11882                     FROM WS-B-LF-ISS-PRM-ENTERED
 11883         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 217
* EL6311.cbl
 11884         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11885
 11886     IF  BALT-PREM-LEN     (2)  > ZEROS
 11887         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11888
 11889     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11890         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11891
 11892     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11893         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11894            SUBTRACT PB-I-AH-PREMIUM-AMT
 11895                     FROM WS-B-AH-ISS-PRM-ENTERED
 11896            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11897            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11898            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11899         ELSE
 11900            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11901*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11902*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11903         END-IF
 11904     END-IF
 11905
 11906     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11907        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11908
 11909     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11910        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11911
 11912     IF BINDGRPL            GREATER THAN ZEROS
 11913         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11914
 11915     IF BRTCLSL             GREATER THAN ZEROS
 11916         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11917
 11918     IF BSIGL               GREATER THAN ZEROS
 11919         MOVE BSIGI              TO PB-I-SIG-SW.
 11920
 11921     IF BAPRL               GREATER THAN ZEROS
 11922         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11923
 11924     IF BMEMBERL            GREATER THAN ZEROS
 11925         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11926
 11927     IF BLNOFCRL            GREATER THAN ZEROS
 11928         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11929
 11930     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11931        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11932
 11933     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11934        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11935
 11936     IF BDAYSL              GREATER THAN ZEROS
 11937        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11938                                    PB-I-EXTENTION-DAYS.
 11939
 11940     IF BDAYSL GREATER THAN ZEROS
 11941        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 218
* EL6311.cbl
 11942
 11943     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11944        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11945           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11946
 11947     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11948        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11949           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11950
 11951     IF B1STPMTL GREATER THAN ZEROS
 11952        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11953
 11954     IF PB-EXT-DAYS-PROCESSING
 11955        IF PB-I-EXTENTION-DAYS = ZEROS
 11956           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11957
 11958     IF PB-EXPIRE-DT-PROCESSING
 11959        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11960           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11961             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11962
 11963     IF PB-1ST-PMT-DT-PROCESSING
 11964        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11965           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11966
 11967     IF BREINL GREATER THAN ZEROS
 11968        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11969
 11970     IF BFORCEL NOT = ZEROS
 11971        MOVE BFORCEI             TO PB-FORCE-CODE.
 11972     IF (BENTRYL NOT = ZEROS)
 11973        AND (PB-COMPANY-ID = 'CID')
 11974        AND (PB-STATE = 'VA')
 11975        AND (BENTRYI NOT = 'P')
 11976        AND (PB-BATCH-ENTRY = 'P')
 11977        PERFORM 1800-REMOVE-CERT-NOTES
 11978                                 THRU 1800-EXIT
 11979     END-IF
 11980     IF BENTRYL NOT = ZEROS
 11981        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11982        IF PI-COMPANY-ID = 'CID'
 11983           AND (PB-BATCH-ENTRY = 'P')
 11984           AND (PB-STATE = 'VA')
 11985           PERFORM 1500-UPDATE-ERNOTE
 11986                                 THRU 1500-EXIT
 11987        END-IF
 11988     END-IF
 11989
 11990     IF BUNWRITL NOT = ZEROS
 11991        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11992
 11993     IF BBILCDL NOT = ZEROS
 11994        MOVE BBILCDI             TO PB-RECORD-BILL.
 11995
 11996     IF BLIVESL GREATER THAN ZEROS
 11997        MOVE WS-BLIVES           TO PB-I-LIVES.
 11998
 11999
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 219
* EL6311.cbl
 12000*DMD CUSTOM CODING*************START
 12001     IF PI-COMPANY-ID NOT = 'DMD'
 12002         MOVE ZEROS               TO BBILLEDL.
 12003*DMD CUSTOM CODING*************END
 12004
 12005     IF BBILLEDL GREATER THAN ZEROS
 12006        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 12007
 12008
 12009*****************************************************************
 12010*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 12011*****************************************************************
 12012
 12013     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12014        IF BTYPE  (1)   = ZEROS OR SPACES
 12015           IF REMOVE-LF-COVERAGE
 12016               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12017                                        PI-BTYPE (1)
 12018               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12019                                        WS-B-LF-ISS-PRM-ENTERED
 12020               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12021                                        WS-B-LF-ISS-PRM-ENTERED
 12022               SUBTRACT PB-I-LF-PREM-CALC FROM
 12023                                        WS-B-LF-ISS-PRM-COMPUTED
 12024               MOVE ZEROS            TO PB-I-LF-TERM
 12025                                        PB-I-LF-BENEFIT-AMT
 12026                                        PB-I-LF-PREMIUM-AMT
 12027                                        PB-I-LF-BENEFIT-CD
 12028                                        PB-I-LF-PREM-CALC
 12029                                        PB-I-LF-CRIT-PER
 12030                                        PB-I-LF-ALT-BENEFIT-AMT
 12031                                        PB-I-LF-ALT-PREMIUM-AMT
 12032               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12033           ELSE
 12034               NEXT SENTENCE
 12035        ELSE
 12036           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12037                                    PI-BTYPE (1).
 12038     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12039        IF BTYPE  (2)   = ZEROS OR SPACES
 12040           IF  REMOVE-AH-COVERAGE
 12041               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12042                                        PI-BTYPE (2)
 12043               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12044                                        WS-B-AH-ISS-PRM-ENTERED
 12045               SUBTRACT PB-I-AH-PREM-CALC FROM
 12046                                        WS-B-AH-ISS-PRM-COMPUTED
 12047               MOVE ZEROS            TO PB-I-AH-TERM
 12048                                        PB-I-AH-BENEFIT-AMT
 12049                                        PB-I-AH-PREMIUM-AMT
 12050                                        PB-I-AH-BENEFIT-CD
 12051                                        PB-I-AH-PREM-CALC
 12052                                        PB-I-AH-CRIT-PER
 12053               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12054           ELSE
 12055               NEXT SENTENCE
 12056        ELSE
 12057           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 220
* EL6311.cbl
 12058                                    PI-BTYPE (2).
 12059 1360-REWRITE-PB-RECORD.
 12060     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12061
 12062     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12063     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12064
 12065     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12066
 12067     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12068     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12069
 12070     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12071         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12072
 12073     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12074         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12075
 12076     IF CSR-EDIT-SESSION
 12077        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12078     END-IF.
 12079
 12080     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12081
 12082     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12083
 12084     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12085
 12086     IF ARCHIVE-LETTER-RELEASED
 12087        MOVE 'C' TO PB-I-LETTER-REQD
 12088        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12089        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12090     END-IF
 12091
 12092     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12093     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12094     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12095
 12096     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12097     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12098
 12099 1375-REWRITE-PB-RECORD.
 12100     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12101     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12102     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12103     MOVE 'C'                    TO JP-RECORD-TYPE.
 12104     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12105
 12106
 12107* EXEC CICS REWRITE
 12108*        DATASET (FILE-ID-ERPNDB)
 12109*        FROM    (PENDING-BUSINESS)
 12110*    END-EXEC.
 12111     MOVE LENGTH OF
 12112      PENDING-BUSINESS
 12113       TO DFHEIV11
 12114*    MOVE '&& L                  %   #00011670' TO DFHEIV0
 12115     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 221
* EL6311.cbl
 12116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12117     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 12118     CALL 'kxdfhei1' USING DFHEIV0,
 12119           FILE-ID-ERPNDB,
 12120           PENDING-BUSINESS,
 12121           DFHEIV11,
 12122           DFHEIV99
 12123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12124
 12125
 12126     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12127******************************************************************
 12128*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12129******************************************************************
 12130     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12131     MOVE ' '                    TO WS-ERMAIL-SW
 12132
 12133* EXEC CICS READ
 12134*       DATASET   (FILE-ID-ERMAIL)
 12135*       SET       (ADDRESS OF MAILING-DATA)
 12136*       RIDFLD    (ERMAIL-KEY)
 12137*       RESP      (WS-RESPONSE)
 12138*    END-EXEC
 12139*    MOVE '&"S        E          (  N#00011681' TO DFHEIV0
 12140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12142     MOVE X'204E233030303131363831' TO DFHEIV0(25:11)
 12143     CALL 'kxdfhei1' USING DFHEIV0,
 12144           FILE-ID-ERMAIL,
 12145           DFHEIV20,
 12146           DFHEIV99,
 12147           ERMAIL-KEY,
 12148           DFHEIV99,
 12149           DFHEIV99,
 12150           DFHEIV99
 12151     SET ADDRESS OF MAILING-DATA TO
 12152         DFHEIV20
 12153     MOVE EIBRESP  TO WS-RESPONSE
 12154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12155     IF RESP-NORMAL
 12156        SET ERMAIL-FOUND TO TRUE
 12157     END-IF
 12158
 12159     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12160     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12161                                 TO ELCRTO-KEY
 12162     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12163     MOVE +0                     TO ELCRTO-SEQ-NO
 12164
 12165* EXEC CICS READ
 12166*       DATASET   ('ELCRTO')
 12167*       INTO      (ORIGINAL-CERTIFICATE)
 12168*       RIDFLD    (ELCRTO-KEY)
 12169*       GTEQ
 12170*       RESP      (WS-RESPONSE)
 12171*    END-EXEC
 12172     MOVE LENGTH OF
 12173      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 222
* EL6311.cbl
 12174       TO DFHEIV11
 12175     MOVE 'ELCRTO' TO DFHEIV1
 12176*    MOVE '&"IL       G          (  N#00011696' TO DFHEIV0
 12177     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12179     MOVE X'204E233030303131363936' TO DFHEIV0(25:11)
 12180     CALL 'kxdfhei1' USING DFHEIV0,
 12181           DFHEIV1,
 12182           ORIGINAL-CERTIFICATE,
 12183           DFHEIV11,
 12184           ELCRTO-KEY,
 12185           DFHEIV99,
 12186           DFHEIV99,
 12187           DFHEIV99
 12188     MOVE EIBRESP  TO WS-RESPONSE
 12189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12190*    display ' just read gteq ' ws-response
 12191     IF RESP-NORMAL
 12192        AND (OC-CONTROL-PRIMARY (1:33) =
 12193                 PB-CONTROL-BY-ACCOUNT (1:33))
 12194        AND (OC-RECORD-TYPE = 'I')
 12195        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12196           display ' csr edit session ' PI-CSR-SESSION-SW
 12197           IF NOT CSR-EDIT-SESSION
 12198
 12199* EXEC CICS READ
 12200*                DATASET   ('ELCRTO')
 12201*                INTO      (ORIGINAL-CERTIFICATE)
 12202*                RIDFLD    (OC-CONTROL-PRIMARY)
 12203*                UPDATE
 12204*                RESP      (WS-RESPONSE)
 12205*             END-EXEC
 12206     MOVE LENGTH OF
 12207      ORIGINAL-CERTIFICATE
 12208       TO DFHEIV11
 12209     MOVE 'ELCRTO' TO DFHEIV1
 12210*    MOVE '&"IL       EU         (  N#00011713' TO DFHEIV0
 12211     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12213     MOVE X'204E233030303131373133' TO DFHEIV0(25:11)
 12214     CALL 'kxdfhei1' USING DFHEIV0,
 12215           DFHEIV1,
 12216           ORIGINAL-CERTIFICATE,
 12217           DFHEIV11,
 12218           OC-CONTROL-PRIMARY,
 12219           DFHEIV99,
 12220           DFHEIV99,
 12221           DFHEIV99
 12222     MOVE EIBRESP  TO WS-RESPONSE
 12223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12224              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12225              IF RESP-NORMAL
 12226                 display ' good read upd '
 12227                 MOVE PB-I-INSURED-LAST-NAME TO
 12228                         OC-INS-LAST-NAME
 12229                 MOVE PB-I-INSURED-FIRST-NAME TO
 12230                         OC-INS-FIRST-NAME
 12231                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 223
* EL6311.cbl
 12232                         OC-INS-MIDDLE-INIT
 12233                 MOVE PB-I-AGE         TO OC-INS-AGE
 12234                 MOVE PB-I-JOINT-LAST-NAME   TO
 12235                         OC-JNT-LAST-NAME
 12236                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12237                         OC-JNT-FIRST-NAME
 12238                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12239                         OC-JNT-MIDDLE-INIT
 12240                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12241                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12242                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12243                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12244                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12245                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12246                         OC-LF-ALT-BEN-AMT
 12247                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12248                         OC-LF-ALT-PRM-AMT
 12249                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12250                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12251                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12252                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12253                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12254                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12255                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12256                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12257                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12258                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12259                 IF OC-CANCEL-TRAN-IND = 'N'
 12260                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12261                    MOVE +0            TO OC-LF-CANCEL-AMT
 12262                                          OC-LF-ITD-CANCEL-AMT
 12263                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12264                    MOVE +0            TO OC-AH-CANCEL-AMT
 12265                                          OC-AH-ITD-CANCEL-AMT
 12266                 END-IF
 12267                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12268                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12269                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12270                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12271                 IF ERMAIL-FOUND
 12272                    MOVE MA-CRED-BENE-NAME
 12273                                 TO OC-CRED-BENE-NAME
 12274                 END-IF
 12275                 IF NOT CERT-TRL-REC-NOT-FOUND
 12276                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12277                           OC-INS-AGE-DEFAULT-FLAG
 12278                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12279                           OC-JNT-AGE-DEFAULT-FLAG
 12280                 END-IF
 12281
 12282* EXEC CICS REWRITE
 12283*                   DATASET   ('ELCRTO')
 12284*                   FROM      (ORIGINAL-CERTIFICATE)
 12285*                   RESP      (WS-RESPONSE)
 12286*                END-EXEC
 12287     MOVE LENGTH OF
 12288      ORIGINAL-CERTIFICATE
 12289       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 224
* EL6311.cbl
 12290     MOVE 'ELCRTO' TO DFHEIV1
 12291*    MOVE '&& L                  %  N#00011777' TO DFHEIV0
 12292     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12293     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12294     MOVE X'204E233030303131373737' TO DFHEIV0(25:11)
 12295     CALL 'kxdfhei1' USING DFHEIV0,
 12296           DFHEIV1,
 12297           ORIGINAL-CERTIFICATE,
 12298           DFHEIV11,
 12299           DFHEIV99
 12300     MOVE EIBRESP  TO WS-RESPONSE
 12301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12302                 display ' just rewrote ' ws-response
 12303              END-IF
 12304           END-IF
 12305        ELSE
 12306           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12307           MOVE 'OC'             TO OC-RECORD-ID
 12308           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12309           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12310           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12311           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12312           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12313           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12314           MOVE PB-I-AGE         TO OC-INS-AGE
 12315           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12316           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12317           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12318           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12319           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12320           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12321           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12322           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12323           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12324           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12325           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12326           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12327           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12328           MOVE +0               TO OC-LF-CANCEL-AMT
 12329                                    OC-LF-ITD-CANCEL-AMT
 12330           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12331           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12332           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12333           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12334           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12335           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12336           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12337           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12338           MOVE +0               TO OC-AH-CANCEL-AMT
 12339                                    OC-AH-ITD-CANCEL-AMT
 12340           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12341           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12342           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12343           IF ERMAIL-FOUND
 12344              MOVE MA-CRED-BENE-NAME
 12345                                 TO OC-CRED-BENE-NAME
 12346           END-IF
 12347           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 225
* EL6311.cbl
 12348              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12349                           OC-INS-AGE-DEFAULT-FLAG
 12350              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12351                           OC-JNT-AGE-DEFAULT-FLAG
 12352           END-IF
 12353           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12354
 12355* EXEC CICS WRITE
 12356*             DATASET   ('ELCRTO')
 12357*             FROM      (ORIGINAL-CERTIFICATE)
 12358*             RIDFLD    (OC-CONTROL-PRIMARY)
 12359*             RESP      (WS-RESPONSE)
 12360*          END-EXEC
 12361     MOVE LENGTH OF
 12362      ORIGINAL-CERTIFICATE
 12363       TO DFHEIV11
 12364     MOVE 'ELCRTO' TO DFHEIV1
 12365*    MOVE '&$ L                  ''  N#00011834' TO DFHEIV0
 12366     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12368     MOVE X'204E233030303131383334' TO DFHEIV0(25:11)
 12369     CALL 'kxdfhei1' USING DFHEIV0,
 12370           DFHEIV1,
 12371           ORIGINAL-CERTIFICATE,
 12372           DFHEIV11,
 12373           OC-CONTROL-PRIMARY,
 12374           DFHEIV99,
 12375           DFHEIV99
 12376     MOVE EIBRESP  TO WS-RESPONSE
 12377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12378        END-IF
 12379     ELSE
 12380        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12381        MOVE 'OC'                TO OC-RECORD-ID
 12382        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12383                                 TO OC-CONTROL-PRIMARY (1:33)
 12384        MOVE 'I'                 TO OC-RECORD-TYPE
 12385        MOVE +4096               TO OC-KEY-SEQ-NO
 12386        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12387        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12388        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12389        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12390        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12391        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12392        MOVE PB-I-AGE            TO OC-INS-AGE
 12393        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12394        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12395        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12396        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12397        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12398        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12399        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12400        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12401        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12402        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12403        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12404        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12405        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 226
* EL6311.cbl
 12406        MOVE +0                  TO OC-LF-CANCEL-AMT
 12407                                    OC-LF-ITD-CANCEL-AMT
 12408        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12409        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12410        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12411        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12412        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12413        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12414        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12415        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12416        MOVE +0                  TO OC-AH-CANCEL-AMT
 12417                                    OC-AH-ITD-CANCEL-AMT
 12418        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12419        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12420        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12421        IF ERMAIL-FOUND
 12422           MOVE MA-CRED-BENE-NAME
 12423                                 TO OC-CRED-BENE-NAME
 12424        END-IF
 12425        IF NOT CERT-TRL-REC-NOT-FOUND
 12426           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12427                           OC-INS-AGE-DEFAULT-FLAG
 12428           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12429                           OC-JNT-AGE-DEFAULT-FLAG
 12430        END-IF
 12431        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12432
 12433* EXEC CICS WRITE
 12434*          DATASET   ('ELCRTO')
 12435*          FROM      (ORIGINAL-CERTIFICATE)
 12436*          RIDFLD    (OC-CONTROL-PRIMARY)
 12437*          RESP      (WS-RESPONSE)
 12438*       END-EXEC
 12439     MOVE LENGTH OF
 12440      ORIGINAL-CERTIFICATE
 12441       TO DFHEIV11
 12442     MOVE 'ELCRTO' TO DFHEIV1
 12443*    MOVE '&$ L                  ''  N#00011894' TO DFHEIV0
 12444     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12446     MOVE X'204E233030303131383934' TO DFHEIV0(25:11)
 12447     CALL 'kxdfhei1' USING DFHEIV0,
 12448           DFHEIV1,
 12449           ORIGINAL-CERTIFICATE,
 12450           DFHEIV11,
 12451           OC-CONTROL-PRIMARY,
 12452           DFHEIV99,
 12453           DFHEIV99
 12454     MOVE EIBRESP  TO WS-RESPONSE
 12455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12456     END-IF
 12457******************************************************************
 12458*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12459******************************************************************
 12460
 12461     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12462     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12463
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 227
* EL6311.cbl
 12464
 12465* EXEC CICS READ
 12466*        INTO    (PENDING-BUSINESS)
 12467*        DATASET (FILE-ID-ERPNDB)
 12468*        RIDFLD  (ERPNDB-KEY)
 12469*        UPDATE
 12470*    END-EXEC.
 12471     MOVE LENGTH OF
 12472      PENDING-BUSINESS
 12473       TO DFHEIV11
 12474*    MOVE '&"IL       EU         (   #00011908' TO DFHEIV0
 12475     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12476     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303131393038' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           FILE-ID-ERPNDB,
 12480           PENDING-BUSINESS,
 12481           DFHEIV11,
 12482           ERPNDB-KEY,
 12483           DFHEIV99,
 12484           DFHEIV99,
 12485           DFHEIV99
 12486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12487
 12488
 12489     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12490     MOVE 'B'                    TO JP-RECORD-TYPE.
 12491     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12492
 12493     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12494
 12495     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12496
 12497     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12498
 12499     MOVE 'C'                    TO JP-RECORD-TYPE.
 12500     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12501
 12502
 12503* EXEC CICS REWRITE
 12504*        DATASET    (FILE-ID-ERPNDB)
 12505*        FROM       (PENDING-BUSINESS)
 12506*    END-EXEC.
 12507     MOVE LENGTH OF
 12508      PENDING-BUSINESS
 12509       TO DFHEIV11
 12510*    MOVE '&& L                  %   #00011928' TO DFHEIV0
 12511     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12512     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12513     MOVE X'2020233030303131393238' TO DFHEIV0(25:11)
 12514     CALL 'kxdfhei1' USING DFHEIV0,
 12515           FILE-ID-ERPNDB,
 12516           PENDING-BUSINESS,
 12517           DFHEIV11,
 12518           DFHEIV99
 12519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12520
 12521
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 228
* EL6311.cbl
 12522     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12523
 12524     IF WS-ERRORS-PRESENT
 12525        GO TO 3900-RE-DISPLAY-RECORD.
 12526
 12527     MOVE ZEROS                  TO EMI-ERROR.
 12528     MOVE -1                     TO BMAINTL.
 12529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12530     GO TO 3900-RE-DISPLAY-RECORD.
 12531
 12532 1380-BATCH-HDR-NOT-FOUND.
 12533     MOVE -1                     TO BMAINTL.
 12534     MOVE ER-7450                TO EMI-ERROR.
 12535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12536     GO TO 8200-SEND-DATAONLY.
 12537
 12538 1385-REC-NOT-FOUND.
 12539     MOVE -1                     TO BMAINTL.
 12540     MOVE ER-7451                TO EMI-ERROR.
 12541     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12542     GO TO 8200-SEND-DATAONLY.
 12543
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 229
* EL6311.cbl
 12545
 12546 1386-UPDATE-AGE-FLAGS.
 12547
 12548
 12549* EXEC CICS GETMAIN
 12550*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12551*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12552*        INITIMG (GETMAIN-SPACE)
 12553*    END-EXEC
 12554*    MOVE ',"IL                  $   #00011959' TO DFHEIV0
 12555     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12557     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 12558     CALL 'kxdfhei1' USING DFHEIV0,
 12559           DFHEIV20,
 12560           ELCRTT-RECORD-LENGTH,
 12561           GETMAIN-SPACE
 12562     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12563         DFHEIV20
 12564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12565
 12566
 12567* EXEC CICS HANDLE CONDITION
 12568*        NOTFND   (1386-NOTFND)
 12569*    END-EXEC.
 12570*    MOVE '"$I                   ! ( #00011965' TO DFHEIV0
 12571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12573     MOVE X'2820233030303131393635' TO DFHEIV0(25:11)
 12574     CALL 'kxdfhei1' USING DFHEIV0
 12575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12576
 12577
 12578     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12579     MOVE 'C'                TO ELCRTT-REC-TYPE
 12580
 12581
 12582* EXEC CICS READ
 12583*        UPDATE
 12584*        DATASET  (CRTT-ID)
 12585*        RIDFLD   (ELCRTT-KEY)
 12586*        INTO     (CERTIFICATE-TRAILERS)
 12587*    END-EXEC.
 12588     MOVE LENGTH OF
 12589      CERTIFICATE-TRAILERS
 12590       TO DFHEIV11
 12591*    MOVE '&"IL       EU         (   #00011972' TO DFHEIV0
 12592     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12594     MOVE X'2020233030303131393732' TO DFHEIV0(25:11)
 12595     CALL 'kxdfhei1' USING DFHEIV0,
 12596           CRTT-ID,
 12597           CERTIFICATE-TRAILERS,
 12598           DFHEIV11,
 12599           ELCRTT-KEY,
 12600           DFHEIV99,
 12601           DFHEIV99,
 12602           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 230
* EL6311.cbl
 12603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12604
 12605
 12606     IF WS-INS-AGE-SET = 'Y'
 12607        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12608     END-IF
 12609     IF WS-JNT-AGE-SET = 'Y'
 12610        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12611     END-IF
 12612
 12613
 12614* EXEC CICS REWRITE
 12615*       DATASET  (CRTT-ID)
 12616*       FROM     (CERTIFICATE-TRAILERS)
 12617*    END-EXEC.
 12618     MOVE LENGTH OF
 12619      CERTIFICATE-TRAILERS
 12620       TO DFHEIV11
 12621*    MOVE '&& L                  %   #00011986' TO DFHEIV0
 12622     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12623     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12624     MOVE X'2020233030303131393836' TO DFHEIV0(25:11)
 12625     CALL 'kxdfhei1' USING DFHEIV0,
 12626           CRTT-ID,
 12627           CERTIFICATE-TRAILERS,
 12628           DFHEIV11,
 12629           DFHEIV99
 12630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12631
 12632
 12633     GO TO 1386-EXIT.
 12634
 12635 1386-NOTFND.
 12636
 12637     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12638     MOVE 'CS'         TO CS-RECORD-ID.
 12639     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12640     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12641     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12642     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12643     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12644
 12645* EXEC CICS WRITE
 12646*       DATASET  (CRTT-ID)
 12647*       RIDFLD   (ELCRTT-KEY)
 12648*       FROM     (CERTIFICATE-TRAILERS)
 12649*    END-EXEC.
 12650     MOVE LENGTH OF
 12651      CERTIFICATE-TRAILERS
 12652       TO DFHEIV11
 12653*    MOVE '&$ L                  ''   #00012002' TO DFHEIV0
 12654     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303132303032' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           CRTT-ID,
 12659           CERTIFICATE-TRAILERS,
 12660           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 231
* EL6311.cbl
 12661           ELCRTT-KEY,
 12662           DFHEIV99,
 12663           DFHEIV99
 12664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12665
 12666
 12667 1386-EXIT.
 12668     EXIT.
 12669
 12670 1390-UPDATE-ERPNDM.
 12671
 12672
 12673* EXEC CICS HANDLE CONDITION
 12674*        NOTFND (1399-EXIT)
 12675*    END-EXEC.
 12676*    MOVE '"$I                   ! ) #00012013' TO DFHEIV0
 12677     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12679     MOVE X'2920233030303132303133' TO DFHEIV0(25:11)
 12680     CALL 'kxdfhei1' USING DFHEIV0
 12681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12682
 12683
 12684     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12685
 12686
 12687* EXEC CICS READ
 12688*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12689*        DATASET (FILE-ID-ERPNDM)
 12690*        RIDFLD  (ERPNDM-KEY)
 12691*        UPDATE
 12692*    END-EXEC.
 12693*    MOVE '&"S        EU         (   #00012019' TO DFHEIV0
 12694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12696     MOVE X'2020233030303132303139' TO DFHEIV0(25:11)
 12697     CALL 'kxdfhei1' USING DFHEIV0,
 12698           FILE-ID-ERPNDM,
 12699           DFHEIV20,
 12700           DFHEIV99,
 12701           ERPNDM-KEY,
 12702           DFHEIV99,
 12703           DFHEIV99,
 12704           DFHEIV99
 12705     SET ADDRESS OF PENDING-MAILING-DATA TO
 12706         DFHEIV20
 12707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12708
 12709
 12710     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12711     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12712     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12713
 12714     IF BLSTNML GREATER THAN ZEROS
 12715         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12716
 12717     IF B1STNML GREATER  THAN ZEROS
 12718         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 232
* EL6311.cbl
 12719
 12720     IF BINITL GREATER THAN ZEROS
 12721         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12722
 12723     IF BAGEL GREATER THAN ZEROS
 12724         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12725
 12726     IF BBIRTHL GREATER THAN ZEROS
 12727         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12728
 12729     IF BSEXL GREATER THAN ZEROS
 12730         MOVE  BSEXI             TO PM-INSURED-SEX.
 12731
 12732
 12733* EXEC CICS REWRITE
 12734*        DATASET (FILE-ID-ERPNDM)
 12735*        FROM    (PENDING-MAILING-DATA)
 12736*    END-EXEC.
 12737     MOVE LENGTH OF
 12738      PENDING-MAILING-DATA
 12739       TO DFHEIV11
 12740*    MOVE '&& L                  %   #00012048' TO DFHEIV0
 12741     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12742     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12743     MOVE X'2020233030303132303438' TO DFHEIV0(25:11)
 12744     CALL 'kxdfhei1' USING DFHEIV0,
 12745           FILE-ID-ERPNDM,
 12746           PENDING-MAILING-DATA,
 12747           DFHEIV11,
 12748           DFHEIV99
 12749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12750
 12751
 12752 1399-EXIT.
 12753     EXIT.
 12754 139A-SET-LETTER-REQD.
 12755*  COMPARE BEFORE AND AFTER CHANGE
 12756     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12757        GO TO 139A-EXIT
 12758     END-IF
 12759
 12760*  READ ELCRTO
 12761     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12762                                 TO ELCRTO-KEY
 12763     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12764     MOVE +0                     TO ELCRTO-SEQ-NO
 12765
 12766
 12767* EXEC CICS READ
 12768*       DATASET   ('ELCRTO')
 12769*       INTO      (ORIGINAL-CERTIFICATE)
 12770*       RIDFLD    (ELCRTO-KEY)
 12771*       GTEQ
 12772*       RESP      (WS-RESPONSE)
 12773*    END-EXEC
 12774     MOVE LENGTH OF
 12775      ORIGINAL-CERTIFICATE
 12776       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 233
* EL6311.cbl
 12777     MOVE 'ELCRTO' TO DFHEIV1
 12778*    MOVE '&"IL       G          (  N#00012067' TO DFHEIV0
 12779     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12781     MOVE X'204E233030303132303637' TO DFHEIV0(25:11)
 12782     CALL 'kxdfhei1' USING DFHEIV0,
 12783           DFHEIV1,
 12784           ORIGINAL-CERTIFICATE,
 12785           DFHEIV11,
 12786           ELCRTO-KEY,
 12787           DFHEIV99,
 12788           DFHEIV99,
 12789           DFHEIV99
 12790     MOVE EIBRESP  TO WS-RESPONSE
 12791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12792
 12793*    display ' just read gteq ' ws-response
 12794     IF RESP-NORMAL
 12795        AND (OC-CONTROL-PRIMARY (1:33) =
 12796                 PB-CONTROL-BY-ACCOUNT (1:33))
 12797        AND (OC-RECORD-TYPE = 'I')
 12798*      compare individual fields
 12799        IF LETRREQL   GREATER THAN ZEROS
 12800           CONTINUE
 12801        ELSE
 12802        IF OC-CERT-NO = PB-CERT-NO
 12803          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12804          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12805          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12806          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12807          AND OC-INS-AGE = PB-I-AGE
 12808          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12809          AND OC-LF-TERM = PB-I-LF-TERM
 12810          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12811          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12812          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12813          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12814          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12815          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12816          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12817          AND PB-I-AH-TERM           = OC-AH-TERM
 12818          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12819          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12820          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12821          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12822          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12823           MOVE SPACE TO PB-I-LETTER-REQD
 12824        ELSE
 12825           MOVE 'Y' TO PB-I-LETTER-REQD
 12826        END-IF
 12827     END-IF.
 12828
 12829 139A-EXIT.
 12830     EXIT.
 12831
 12832******************************************************************
 12833*                                                                *
 12834*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 234
* EL6311.cbl
 12835*                                                                *
 12836******************************************************************
 12837
 12838 1400-DELETE-ISSUE-ROUTINE.
 12839     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12840
 12841     IF BCHGL NOT = ZEROS
 12842        MOVE ER-2196             TO EMI-ERROR
 12843        MOVE AL-UABON            TO BMAINTA
 12844        MOVE -1                  TO BMAINTL
 12845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12846        GO TO 8200-SEND-DATAONLY.
 12847
 12848
 12849* EXEC CICS HANDLE CONDITION
 12850*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12851*    END-EXEC.
 12852*    MOVE '"$I                   ! * #00012130' TO DFHEIV0
 12853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12855     MOVE X'2A20233030303132313330' TO DFHEIV0(25:11)
 12856     CALL 'kxdfhei1' USING DFHEIV0
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
 12860     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12861     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12862     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12863
 12864
 12865* EXEC CICS READ
 12866*        SET     (ADDRESS OF PENDING-BUSINESS)
 12867*        DATASET (FILE-ID-ERPNDB)
 12868*        RIDFLD  (ERPNDB-KEY)
 12869*    END-EXEC.
 12870*    MOVE '&"S        E          (   #00012138' TO DFHEIV0
 12871     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12873     MOVE X'2020233030303132313338' TO DFHEIV0(25:11)
 12874     CALL 'kxdfhei1' USING DFHEIV0,
 12875           FILE-ID-ERPNDB,
 12876           DFHEIV20,
 12877           DFHEIV99,
 12878           ERPNDB-KEY,
 12879           DFHEIV99,
 12880           DFHEIV99,
 12881           DFHEIV99
 12882     SET ADDRESS OF PENDING-BUSINESS TO
 12883         DFHEIV20
 12884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12885
 12886
 12887     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12888
 12889     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12890
 12891     IF BSUFIXL NOT = ZEROS
 12892        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 235
* EL6311.cbl
 12893     ELSE
 12894        MOVE SPACE               TO WS-NEW-SUFFIX.
 12895
 12896     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12897     PERFORM 8600-DEEDIT.
 12898     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12899     MOVE '4'                    TO DC-OPTION-CODE.
 12900     PERFORM 9700-DATE-LINK.
 12901     IF DATE-CONVERSION-ERROR
 12902        MOVE ER-0348             TO EMI-ERROR
 12903        MOVE -1                  TO BEFFDTL
 12904        MOVE AL-UABON            TO BEFFDTA
 12905        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12906        GO TO 8200-SEND-DATAONLY
 12907     ELSE
 12908        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12909        MOVE AL-UANON            TO BEFFDTA
 12910        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12911
 12912
 12913* EXEC CICS HANDLE CONDITION
 12914*         NOTFND    (1490-RECORD-NOT-FOUND)
 12915*    END-EXEC.
 12916*    MOVE '"$I                   ! + #00012169' TO DFHEIV0
 12917     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12919     MOVE X'2B20233030303132313639' TO DFHEIV0(25:11)
 12920     CALL 'kxdfhei1' USING DFHEIV0
 12921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12922
 12923
 12924
 12925* EXEC CICS READ
 12926*        SET     (ADDRESS OF PENDING-BUSINESS)
 12927*        DATASET (FILE-ID-ERPNDB)
 12928*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12929*        UPDATE
 12930*    END-EXEC.
 12931*    MOVE '&"S        EU         (   #00012173' TO DFHEIV0
 12932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12933     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12934     MOVE X'2020233030303132313733' TO DFHEIV0(25:11)
 12935     CALL 'kxdfhei1' USING DFHEIV0,
 12936           FILE-ID-ERPNDB,
 12937           DFHEIV20,
 12938           DFHEIV99,
 12939           PI-PREV-CONTROL-PRIMARY,
 12940           DFHEIV99,
 12941           DFHEIV99,
 12942           DFHEIV99
 12943     SET ADDRESS OF PENDING-BUSINESS TO
 12944         DFHEIV20
 12945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12946
 12947
 12948     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12949        MOVE -1                 TO BMAINTL
 12950        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 236
* EL6311.cbl
 12951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12952        GO TO 8200-SEND-DATAONLY.
 12953
 12954     IF PB-BILLED-DT NOT = LOW-VALUES
 12955        MOVE -1                 TO BMAINTL
 12956        MOVE ER-2129            TO EMI-ERROR
 12957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12958        GO TO 8200-SEND-DATAONLY.
 12959
 12960     IF PB-CHG-COUNT NOT = ZEROS
 12961        MOVE ER-2336            TO EMI-ERROR
 12962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12963        MOVE AL-UABON            TO BMAINTA
 12964        MOVE -1                  TO BMAINTL
 12965        GO TO 8200-SEND-DATAONLY.
 12966
 12967     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12968        PB-CHG-COUNT NOT = ZEROS
 12969        MOVE ER-2196             TO EMI-ERROR
 12970        MOVE AL-UABON            TO BMAINTA
 12971        MOVE -1                  TO BMAINTL
 12972        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12973        GO TO 8200-SEND-DATAONLY.
 12974******************************************************************
 12975*                                                                *
 12976*       Determine if this is a dup and we should allow the       *
 12977*       user to delete the pending issue record only.            *
 12978*                                                                *
 12979******************************************************************
 12980     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12981                                 TO ELCERT-KEY
 12982
 12983* EXEC CICS READ
 12984*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12985*        DATASET (FILE-ID-ELCERT)
 12986*        RIDFLD  (ELCERT-KEY)
 12987*        RESP    (WS-RESPONSE)
 12988*    END-EXEC
 12989*    MOVE '&"S        E          (  N#00012214' TO DFHEIV0
 12990     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12992     MOVE X'204E233030303132323134' TO DFHEIV0(25:11)
 12993     CALL 'kxdfhei1' USING DFHEIV0,
 12994           FILE-ID-ELCERT,
 12995           DFHEIV20,
 12996           DFHEIV99,
 12997           ELCERT-KEY,
 12998           DFHEIV99,
 12999           DFHEIV99,
 13000           DFHEIV99
 13001     SET ADDRESS OF CERTIFICATE-MASTER TO
 13002         DFHEIV20
 13003     MOVE EIBRESP  TO WS-RESPONSE
 13004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13005     if (resp-normal)
 13006        and (cert-added-batch)
 13007        and (valid-cm-id)
 13008        go to 1420-CONTINUE-DELETE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 237
* EL6311.cbl
 13009     end-if
 13010******************************************************************
 13011*                                                                *
 13012*       Determine if there have been any checks created          *
 13013*                                                                *
 13014******************************************************************
 13015
 13016     perform 2500-browse-checks  thru 2500-exit
 13017
 13018     if i-have-processed-checks
 13019        or i-have-checks
 13020        or i-have-a-check-period
 13021        move er-3446             to emi-error
 13022        perform 9900-error-format thru 9900-exit
 13023        move al-uabon            to bmainta
 13024        move -1                  to bmaintl
 13025        go to 8200-send-dataonly
 13026     end-if
 13027******************************************************************
 13028*                                                                *
 13029*       DELETE ORIGINAL CERTIFICATE INFO                         *
 13030*                                                                *
 13031******************************************************************
 13032     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 13033     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 13034     MOVE +0                     TO ELCRTO-SEQ-NO
 13035
 13036* EXEC CICS READ
 13037*       DATASET   ('ELCRTO')
 13038*       INTO      (ORIGINAL-CERTIFICATE)
 13039*       RIDFLD    (ELCRTO-KEY)
 13040*       GTEQ
 13041*       RESP      (WS-RESPONSE)
 13042*    END-EXEC
 13043     MOVE LENGTH OF
 13044      ORIGINAL-CERTIFICATE
 13045       TO DFHEIV11
 13046     MOVE 'ELCRTO' TO DFHEIV1
 13047*    MOVE '&"IL       G          (  N#00012250' TO DFHEIV0
 13048     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13050     MOVE X'204E233030303132323530' TO DFHEIV0(25:11)
 13051     CALL 'kxdfhei1' USING DFHEIV0,
 13052           DFHEIV1,
 13053           ORIGINAL-CERTIFICATE,
 13054           DFHEIV11,
 13055           ELCRTO-KEY,
 13056           DFHEIV99,
 13057           DFHEIV99,
 13058           DFHEIV99
 13059     MOVE EIBRESP  TO WS-RESPONSE
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13061     IF RESP-NORMAL
 13062        AND (OC-CONTROL-PRIMARY (1:33) =
 13063                 PB-CONTROL-BY-ACCOUNT (1:33))
 13064        AND (OC-RECORD-TYPE = 'I')
 13065
 13066* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 238
* EL6311.cbl
 13067*          DATASET   ('ELCRTO')
 13068*          INTO      (ORIGINAL-CERTIFICATE)
 13069*          RIDFLD    (ELCRTO-KEY)
 13070*          UPDATE
 13071*          RESP      (WS-RESPONSE)
 13072*       END-EXEC
 13073     MOVE LENGTH OF
 13074      ORIGINAL-CERTIFICATE
 13075       TO DFHEIV11
 13076     MOVE 'ELCRTO' TO DFHEIV1
 13077*    MOVE '&"IL       EU         (  N#00012261' TO DFHEIV0
 13078     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13079     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13080     MOVE X'204E233030303132323631' TO DFHEIV0(25:11)
 13081     CALL 'kxdfhei1' USING DFHEIV0,
 13082           DFHEIV1,
 13083           ORIGINAL-CERTIFICATE,
 13084           DFHEIV11,
 13085           ELCRTO-KEY,
 13086           DFHEIV99,
 13087           DFHEIV99,
 13088           DFHEIV99
 13089     MOVE EIBRESP  TO WS-RESPONSE
 13090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13091        IF RESP-NORMAL
 13092
 13093* EXEC CICS DELETE
 13094*             DATASET   ('ELCRTO')
 13095*          END-EXEC
 13096     MOVE 'ELCRTO' TO DFHEIV1
 13097*    MOVE '&(                    &   #00012269' TO DFHEIV0
 13098     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13100     MOVE X'2020233030303132323639' TO DFHEIV0(25:11)
 13101     CALL 'kxdfhei1' USING DFHEIV0,
 13102           DFHEIV1,
 13103           DFHEIV99,
 13104           DFHEIV99,
 13105           DFHEIV99,
 13106           DFHEIV99
 13107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13108        END-IF
 13109     END-IF
 13110******************************************************************
 13111*                                                                *
 13112*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13113*                                                                *
 13114******************************************************************
 13115
 13116* EXEC CICS HANDLE CONDITION
 13117*        NOTFND    (1405-DELETE-CERTIFICATE)
 13118*    END-EXEC.
 13119*    MOVE '"$I                   ! , #00012279' TO DFHEIV0
 13120     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13122     MOVE X'2C20233030303132323739' TO DFHEIV0(25:11)
 13123     CALL 'kxdfhei1' USING DFHEIV0
 13124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 239
* EL6311.cbl
 13125
 13126
 13127
 13128* EXEC CICS READ
 13129*        EQUAL
 13130*        DATASET   (FILE-ID-ERPNDM)
 13131*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13132*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13133*        UPDATE
 13134*    END-EXEC.
 13135*    MOVE '&"S        EU         (   #00012283' TO DFHEIV0
 13136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13137     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13138     MOVE X'2020233030303132323833' TO DFHEIV0(25:11)
 13139     CALL 'kxdfhei1' USING DFHEIV0,
 13140           FILE-ID-ERPNDM,
 13141           DFHEIV20,
 13142           DFHEIV99,
 13143           PI-PREV-CONTROL-PRIMARY,
 13144           DFHEIV99,
 13145           DFHEIV99,
 13146           DFHEIV99
 13147     SET ADDRESS OF PENDING-MAILING-DATA TO
 13148         DFHEIV20
 13149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13150
 13151
 13152     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13153     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13154     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13155
 13156     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13157
 13158
 13159* EXEC CICS DELETE
 13160*        DATASET   (FILE-ID-ERPNDM)
 13161*    END-EXEC.
 13162*    MOVE '&(                    &   #00012297' TO DFHEIV0
 13163     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13164     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13165     MOVE X'2020233030303132323937' TO DFHEIV0(25:11)
 13166     CALL 'kxdfhei1' USING DFHEIV0,
 13167           FILE-ID-ERPNDM,
 13168           DFHEIV99,
 13169           DFHEIV99,
 13170           DFHEIV99,
 13171           DFHEIV99
 13172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13173
 13174
 13175******************************************************************
 13176*                PROCESS   CERTIFICATE                           *
 13177******************************************************************
 13178
 13179 1405-DELETE-CERTIFICATE.
 13180
 13181* EXEC CICS HANDLE CONDITION
 13182*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 240
* EL6311.cbl
 13183*    END-EXEC.
 13184*    MOVE '"$I                   ! - #00012306' TO DFHEIV0
 13185     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13187     MOVE X'2D20233030303132333036' TO DFHEIV0(25:11)
 13188     CALL 'kxdfhei1' USING DFHEIV0
 13189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13190
 13191
 13192     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13193     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13194     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13195     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13196
 13197
 13198* EXEC CICS READ
 13199*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13200*        DATASET (FILE-ID-ELCERT)
 13201*        RIDFLD  (ELCERT-KEY)
 13202*        UPDATE
 13203*    END-EXEC.
 13204*    MOVE '&"S        EU         (   #00012315' TO DFHEIV0
 13205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13206     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13207     MOVE X'2020233030303132333135' TO DFHEIV0(25:11)
 13208     CALL 'kxdfhei1' USING DFHEIV0,
 13209           FILE-ID-ELCERT,
 13210           DFHEIV20,
 13211           DFHEIV99,
 13212           ELCERT-KEY,
 13213           DFHEIV99,
 13214           DFHEIV99,
 13215           DFHEIV99
 13216     SET ADDRESS OF CERTIFICATE-MASTER TO
 13217         DFHEIV20
 13218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13219
 13220
 13221     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13222
 13223     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13224     MOVE 'B'                    TO JP-RECORD-TYPE
 13225     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13226
 13227     PERFORM 8400-LOG-JOURNAL-RECORD.
 13228
 13229     IF CERT-NOTES-ARE-NOT-PRESENT
 13230        MOVE ' '                 TO WS-CERT-NOTE-SW
 13231     ELSE
 13232        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13233
 13234     IF INSURED-ADDR-PRESENT
 13235        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13236
 13237******************************************************************
 13238******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13239******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 241
* EL6311.cbl
 13241******************************************************************
 13242
 13243     IF CERT-ADDED-BATCH AND
 13244        (NOT NO-CLAIM-ATTACHED
 13245         OR
 13246         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13247        GO TO 1410-REWRITE-CERT.
 13248
 13249******************************************************************
 13250******************************************************************
 13251
 13252     IF CERT-ADDED-BATCH  AND
 13253        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13254        GO TO 1410-REWRITE-CERT.
 13255
 13256     IF NO-CLAIM-ATTACHED
 13257        NEXT SENTENCE
 13258     ELSE
 13259        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13260        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13261        GO TO 1410-REWRITE-CERT.
 13262
 13263     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13264     MOVE 'D'                      TO JP-RECORD-TYPE.
 13265     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13266
 13267
 13268* EXEC CICS DELETE
 13269*         DATASET    (FILE-ID-ELCERT)
 13270*    END-EXEC.
 13271*    MOVE '&(                    &   #00012368' TO DFHEIV0
 13272     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13273     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13274     MOVE X'2020233030303132333638' TO DFHEIV0(25:11)
 13275     CALL 'kxdfhei1' USING DFHEIV0,
 13276           FILE-ID-ELCERT,
 13277           DFHEIV99,
 13278           DFHEIV99,
 13279           DFHEIV99,
 13280           DFHEIV99
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13282
 13283
 13284     PERFORM 8400-LOG-JOURNAL-RECORD.
 13285
 13286******************************************************************
 13287*                                                                *
 13288*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13289*                                                                *
 13290******************************************************************
 13291
 13292     IF  CERT-NOTES-ARE-PRESENT
 13293         NEXT SENTENCE
 13294     ELSE
 13295         GO TO 1407-DELETE-MAILING.
 13296
 13297
 13298* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 242
* EL6311.cbl
 13299*         NOTFND  (1406-DELETE-ERNOTE)
 13300*    END-EXEC.
 13301*    MOVE '"$I                   ! . #00012385' TO DFHEIV0
 13302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13304     MOVE X'2E20233030303132333835' TO DFHEIV0(25:11)
 13305     CALL 'kxdfhei1' USING DFHEIV0
 13306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13307
 13308
 13309     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13310     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13311     MOVE 0                     TO ERCNOT-SEQUENCE.
 13312
 13313 1406-DELETE-ERCNOT-LOOP.
 13314
 13315
 13316* EXEC CICS READ
 13317*        GTEQ
 13318*        DATASET   (FILE-ID-ERCNOT)
 13319*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13320*        RIDFLD    (ERCNOT-KEY)
 13321*    END-EXEC.
 13322*    MOVE '&"S        G          (   #00012395' TO DFHEIV0
 13323     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13325     MOVE X'2020233030303132333935' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0,
 13327           FILE-ID-ERCNOT,
 13328           DFHEIV20,
 13329           DFHEIV99,
 13330           ERCNOT-KEY,
 13331           DFHEIV99,
 13332           DFHEIV99,
 13333           DFHEIV99
 13334     SET ADDRESS OF CERT-NOTE-FILE TO
 13335         DFHEIV20
 13336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13337
 13338
 13339     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13340     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13341         GO TO 1406-DELETE-ERNOTE
 13342     END-IF.
 13343
 13344     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13345     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13346     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13347
 13348     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13349
 13350
 13351* EXEC CICS DELETE
 13352*        DATASET   (FILE-ID-ERCNOT)
 13353*        RIDFLD    (ERCNOT-KEY)
 13354*        END-EXEC.
 13355*    MOVE '&(  R                 &   #00012413' TO DFHEIV0
 13356     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 243
* EL6311.cbl
 13357     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13358     MOVE X'2020233030303132343133' TO DFHEIV0(25:11)
 13359     CALL 'kxdfhei1' USING DFHEIV0,
 13360           FILE-ID-ERCNOT,
 13361           ERCNOT-KEY,
 13362           DFHEIV99,
 13363           DFHEIV99,
 13364           DFHEIV99
 13365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13366
 13367
 13368     PERFORM 8400-LOG-JOURNAL-RECORD.
 13369
 13370     GO TO 1406-DELETE-ERCNOT-LOOP.
 13371
 13372 1406-DELETE-ERNOTE.
 13373
 13374
 13375* EXEC CICS HANDLE CONDITION
 13376*         NOTFND  (1407-DELETE-MAILING)
 13377*    END-EXEC.
 13378*    MOVE '"$I                   ! / #00012424' TO DFHEIV0
 13379     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13381     MOVE X'2F20233030303132343234' TO DFHEIV0(25:11)
 13382     CALL 'kxdfhei1' USING DFHEIV0
 13383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13384
 13385
 13386*    EXEC CICS READ
 13387*        EQUAL
 13388*        DATASET   (FILE-ID-ERNOTE)
 13389*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13390*        RIDFLD    (ELCERT-KEY)
 13391*        UPDATE
 13392*    END-EXEC.
 13393
 13394     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13395     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13396     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13397
 13398     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13399
 13400
 13401* exec cics delete
 13402*       dataset       ('ERNOTE')
 13403*       keylength     (33)
 13404*       ridfld        (elcert-key)
 13405*       generic
 13406*    end-exec
 13407     MOVE 'ERNOTE' TO DFHEIV1
 13408     MOVE 33
 13409       TO DFHEIV11
 13410*    MOVE '&(  RKG               &   #00012442' TO DFHEIV0
 13411     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
 13412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13413     MOVE X'2020233030303132343432' TO DFHEIV0(25:11)
 13414     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 244
* EL6311.cbl
 13415           DFHEIV1,
 13416           elcert-key,
 13417           DFHEIV11,
 13418           DFHEIV99,
 13419           DFHEIV99
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13421*    EXEC CICS DELETE
 13422*        DATASET   (FILE-ID-ERNOTE)
 13423*        END-EXEC.
 13424
 13425     PERFORM 8400-LOG-JOURNAL-RECORD.
 13426
 13427******************************************************************
 13428*                                                                *
 13429*                DELETE MAILING ADDRESS RECORDS                  *
 13430*                                                                *
 13431******************************************************************
 13432
 13433 1407-DELETE-MAILING.
 13434     IF CERT-ADDRESS-PRESENT
 13435        NEXT SENTENCE
 13436     ELSE
 13437        GO TO 1420-CONTINUE-DELETE.
 13438
 13439
 13440* EXEC CICS HANDLE CONDITION
 13441*         NOTFND  (1420-CONTINUE-DELETE)
 13442*    END-EXEC.
 13443*    MOVE '"$I                   ! 0 #00012466' TO DFHEIV0
 13444     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13446     MOVE X'3020233030303132343636' TO DFHEIV0(25:11)
 13447     CALL 'kxdfhei1' USING DFHEIV0
 13448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13449
 13450
 13451
 13452* EXEC CICS READ
 13453*        EQUAL
 13454*        DATASET   (FILE-ID-ERMAIL)
 13455*        SET       (ADDRESS OF MAILING-DATA)
 13456*        RIDFLD    (ELCERT-KEY)
 13457*        UPDATE
 13458*    END-EXEC.
 13459*    MOVE '&"S        EU         (   #00012470' TO DFHEIV0
 13460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13461     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13462     MOVE X'2020233030303132343730' TO DFHEIV0(25:11)
 13463     CALL 'kxdfhei1' USING DFHEIV0,
 13464           FILE-ID-ERMAIL,
 13465           DFHEIV20,
 13466           DFHEIV99,
 13467           ELCERT-KEY,
 13468           DFHEIV99,
 13469           DFHEIV99,
 13470           DFHEIV99
 13471     SET ADDRESS OF MAILING-DATA TO
 13472         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 245
* EL6311.cbl
 13473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13474
 13475
 13476     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13477     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13478     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13479
 13480     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13481
 13482
 13483* EXEC CICS DELETE
 13484*        DATASET   (FILE-ID-ERMAIL)
 13485*    END-EXEC.
 13486*    MOVE '&(                    &   #00012484' TO DFHEIV0
 13487     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13488     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13489     MOVE X'2020233030303132343834' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           FILE-ID-ERMAIL,
 13492           DFHEIV99,
 13493           DFHEIV99,
 13494           DFHEIV99,
 13495           DFHEIV99
 13496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13497
 13498
 13499     GO TO 1420-CONTINUE-DELETE.
 13500
 13501 1410-REWRITE-CERT.
 13502     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13503     MOVE 'C'                      TO JP-RECORD-TYPE.
 13504     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13505     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13506
 13507
 13508* EXEC CICS REWRITE
 13509*         DATASET    (FILE-ID-ELCERT)
 13510*         FROM       (CERTIFICATE-MASTER)
 13511*         END-EXEC.
 13512     MOVE LENGTH OF
 13513      CERTIFICATE-MASTER
 13514       TO DFHEIV11
 13515*    MOVE '&& L                  %   #00012496' TO DFHEIV0
 13516     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13517     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13518     MOVE X'2020233030303132343936' TO DFHEIV0(25:11)
 13519     CALL 'kxdfhei1' USING DFHEIV0,
 13520           FILE-ID-ELCERT,
 13521           CERTIFICATE-MASTER,
 13522           DFHEIV11,
 13523           DFHEIV99
 13524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13525
 13526
 13527     PERFORM 8400-LOG-JOURNAL-RECORD.
 13528
 13529 1420-CONTINUE-DELETE.
 13530     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 246
* EL6311.cbl
 13531     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13532
 13533     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13534     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13535
 13536     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13537
 13538 1450-DELETE-PB-RECORD.
 13539     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13540     MOVE 'D'                      TO JP-RECORD-TYPE
 13541     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13542
 13543
 13544* EXEC CICS DELETE
 13545*        DATASET    (FILE-ID-ERPNDB)
 13546*    END-EXEC.
 13547*    MOVE '&(                    &   #00012517' TO DFHEIV0
 13548     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13549     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13550     MOVE X'2020233030303132353137' TO DFHEIV0(25:11)
 13551     CALL 'kxdfhei1' USING DFHEIV0,
 13552           FILE-ID-ERPNDB,
 13553           DFHEIV99,
 13554           DFHEIV99,
 13555           DFHEIV99,
 13556           DFHEIV99
 13557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13558
 13559
 13560     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13561
 13562     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13563
 13564     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13565     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13566     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13567
 13568
 13569* EXEC CICS HANDLE CONDITION
 13570*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13571*    END-EXEC.
 13572*    MOVE '"$I                   ! 1 #00012529' TO DFHEIV0
 13573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13575     MOVE X'3120233030303132353239' TO DFHEIV0(25:11)
 13576     CALL 'kxdfhei1' USING DFHEIV0
 13577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13578
 13579
 13580
 13581* EXEC CICS READ
 13582*        SET     (ADDRESS OF PENDING-BUSINESS)
 13583*        DATASET (FILE-ID-ERPNDB)
 13584*        RIDFLD  (ERPNDB-KEY)
 13585*        UPDATE
 13586*    END-EXEC.
 13587*    MOVE '&"S        EU         (   #00012533' TO DFHEIV0
 13588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 247
* EL6311.cbl
 13589     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13590     MOVE X'2020233030303132353333' TO DFHEIV0(25:11)
 13591     CALL 'kxdfhei1' USING DFHEIV0,
 13592           FILE-ID-ERPNDB,
 13593           DFHEIV20,
 13594           DFHEIV99,
 13595           ERPNDB-KEY,
 13596           DFHEIV99,
 13597           DFHEIV99,
 13598           DFHEIV99
 13599     SET ADDRESS OF PENDING-BUSINESS TO
 13600         DFHEIV20
 13601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13602
 13603
 13604     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13605
 13606     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13607
 13608     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13609        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13610        MOVE 'D'                   TO JP-RECORD-TYPE
 13611        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13612
 13613* EXEC CICS DELETE
 13614*            DATASET    (FILE-ID-ERPNDB)
 13615*       END-EXEC
 13616*    MOVE '&(                    &   #00012548' TO DFHEIV0
 13617     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13619     MOVE X'2020233030303132353438' TO DFHEIV0(25:11)
 13620     CALL 'kxdfhei1' USING DFHEIV0,
 13621           FILE-ID-ERPNDB,
 13622           DFHEIV99,
 13623           DFHEIV99,
 13624           DFHEIV99,
 13625           DFHEIV99
 13626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13627        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13628     ELSE
 13629        MOVE 'B'                 TO JP-RECORD-TYPE
 13630        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13631        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13632        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13633        MOVE 'C'                 TO JP-RECORD-TYPE
 13634        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13635
 13636* EXEC CICS REWRITE
 13637*            DATASET    (FILE-ID-ERPNDB)
 13638*            FROM       (PENDING-BUSINESS)
 13639*       END-EXEC
 13640     MOVE LENGTH OF
 13641      PENDING-BUSINESS
 13642       TO DFHEIV11
 13643*    MOVE '&& L                  %   #00012559' TO DFHEIV0
 13644     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13645     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13646     MOVE X'2020233030303132353539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 248
* EL6311.cbl
 13647     CALL 'kxdfhei1' USING DFHEIV0,
 13648           FILE-ID-ERPNDB,
 13649           PENDING-BUSINESS,
 13650           DFHEIV11,
 13651           DFHEIV99
 13652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13653        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13654     end-if
 13655******************************************************************
 13656*                                                                *
 13657*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13658*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13659*                                                                *
 13660******************************************************************
 13661
 13662     IF NOT PI-AR-PROCESSING
 13663        GO TO 1475-DELETE-FINISHED.
 13664
 13665     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13666        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13667        NEXT SENTENCE
 13668     ELSE
 13669        GO TO 1475-DELETE-FINISHED.
 13670
 13671
 13672* EXEC CICS HANDLE CONDITION
 13673*         NOTFND    (1475-DELETE-FINISHED)
 13674*         END-EXEC.
 13675*    MOVE '"$I                   ! 2 #00012581' TO DFHEIV0
 13676     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13678     MOVE X'3220233030303132353831' TO DFHEIV0(25:11)
 13679     CALL 'kxdfhei1' USING DFHEIV0
 13680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13681
 13682
 13683     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13684     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13685
 13686
 13687* EXEC CICS READ
 13688*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13689*        DATASET (FILE-ID-ERRQST)
 13690*        RIDFLD  (ERRQST-KEY)
 13691*        UPDATE
 13692*    END-EXEC.
 13693*    MOVE '&"S        EU         (   #00012588' TO DFHEIV0
 13694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13696     MOVE X'2020233030303132353838' TO DFHEIV0(25:11)
 13697     CALL 'kxdfhei1' USING DFHEIV0,
 13698           FILE-ID-ERRQST,
 13699           DFHEIV20,
 13700           DFHEIV99,
 13701           ERRQST-KEY,
 13702           DFHEIV99,
 13703           DFHEIV99,
 13704           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 249
* EL6311.cbl
 13705     SET ADDRESS OF AR-REQUEST-RECORD TO
 13706         DFHEIV20
 13707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13708
 13709
 13710     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13711
 13712     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13713
 13714     MOVE 'D'                      TO JP-RECORD-TYPE.
 13715     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13716
 13717
 13718* EXEC CICS DELETE
 13719*         DATASET    (FILE-ID-ERRQST)
 13720*    END-EXEC.
 13721*    MOVE '&(                    &   #00012602' TO DFHEIV0
 13722     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13723     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13724     MOVE X'2020233030303132363032' TO DFHEIV0(25:11)
 13725     CALL 'kxdfhei1' USING DFHEIV0,
 13726           FILE-ID-ERRQST,
 13727           DFHEIV99,
 13728           DFHEIV99,
 13729           DFHEIV99,
 13730           DFHEIV99
 13731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13732
 13733
 13734     PERFORM 8400-LOG-JOURNAL-RECORD.
 13735
 13736 1475-DELETE-FINISHED.
 13737     MOVE ZEROS                  TO EMI-ERROR.
 13738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13739     MOVE LOW-VALUES             TO EL631BI.
 13740     MOVE -1                     TO BMAINTL.
 13741     GO TO 8100-SEND-INITIAL-MAP.
 13742
 13743 1480-BATCH-HDR-NOT-FOUND.
 13744     MOVE -1                     TO BMAINTL.
 13745     MOVE ER-7450                TO EMI-ERROR.
 13746     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13747     GO TO 8200-SEND-DATAONLY.
 13748
 13749 1490-RECORD-NOT-FOUND.
 13750     MOVE -1                     TO BMAINTL.
 13751     MOVE ER-7451                TO EMI-ERROR.
 13752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13753     GO TO 8200-SEND-DATAONLY.
 13754
 13755******************************************************************
 13756*            O V E R   C H A R G E   P R O C E S S I N G         *
 13757******************************************************************
 13758 1500-UPDATE-ERNOTE.
 13759     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13760     MOVE 'A'                    TO WS-NOTE-SW
 13761     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13762     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 250
* EL6311.cbl
 13763 1500-EXIT.
 13764     EXIT.
 13765 1510-ADD-ERNOTE-REC.
 13766
 13767* EXEC CICS GETMAIN
 13768*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13769*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13770*        INITIMG (GETMAIN-SPACE)
 13771*    END-EXEC
 13772*    MOVE ',"IL                  $   #00012638' TO DFHEIV0
 13773     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13774     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13775     MOVE X'2020233030303132363338' TO DFHEIV0(25:11)
 13776     CALL 'kxdfhei1' USING DFHEIV0,
 13777           DFHEIV20,
 13778           ERNOTE-RECORD-LENGTH,
 13779           GETMAIN-SPACE
 13780     SET ADDRESS OF CERTIFICATE-NOTE TO
 13781         DFHEIV20
 13782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13783     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13784                                 TO ERNOTE-KEY
 13785     move '1'                    to ernote-record-type
 13786
 13787* EXEC CICS READ
 13788*       DATASET    (FILE-ID-ERNOTE)
 13789*       RIDFLD     (ERNOTE-KEY)
 13790*       INTO       (CERTIFICATE-NOTE)
 13791*       RESP       (WS-RESPONSE)
 13792*       UPDATE
 13793*    END-EXEC
 13794     MOVE LENGTH OF
 13795      CERTIFICATE-NOTE
 13796       TO DFHEIV11
 13797*    MOVE '&"IL       EU         (  N#00012646' TO DFHEIV0
 13798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13799     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13800     MOVE X'204E233030303132363436' TO DFHEIV0(25:11)
 13801     CALL 'kxdfhei1' USING DFHEIV0,
 13802           FILE-ID-ERNOTE,
 13803           CERTIFICATE-NOTE,
 13804           DFHEIV11,
 13805           ERNOTE-KEY,
 13806           DFHEIV99,
 13807           DFHEIV99,
 13808           DFHEIV99
 13809     MOVE EIBRESP  TO WS-RESPONSE
 13810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13811     IF RESP-NORMAL
 13812        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13813           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13814        END-IF
 13815        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13816           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13817        END-IF
 13818        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13819           (N1 > +10)
 13820           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 251
* EL6311.cbl
 13821           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13822        END-PERFORM
 13823        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13824          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13825
 13826* EXEC CICS UNLOCK
 13827*            DATASET    (FILE-ID-ERNOTE)
 13828*          END-EXEC
 13829*    MOVE '&*                    #   #00012667' TO DFHEIV0
 13830     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13832     MOVE X'2020233030303132363637' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0,
 13834           FILE-ID-ERNOTE,
 13835           DFHEIV99
 13836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13837        ELSE
 13838          PERFORM VARYING N1 FROM +1 BY +1
 13839           UNTIL (N1 > +10)
 13840           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13841          END-PERFORM
 13842          IF (N1 < +11)
 13843            IF N1 >= CN-BILLING-START-LINE-NO AND
 13844              N1 <= CN-BILLING-END-LINE-NO
 13845              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13846                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13847              ELSE
 13848                 MOVE WS-VA-NO-COMM-MESS
 13849                                    TO CN-LINE (N1)
 13850              END-IF
 13851            ELSE
 13852              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13853               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13854                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13855                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13856                ELSE
 13857                  MOVE WS-VA-NO-COMM-MESS
 13858                                    TO CN-LINE (N1)
 13859                END-IF
 13860                MOVE N1             TO CN-BILLING-END-LINE-NO
 13861              ELSE
 13862                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13863                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13864                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13865                  ELSE
 13866                     MOVE WS-VA-NO-COMM-MESS
 13867                                    TO CN-LINE (N1)
 13868                  END-IF
 13869                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13870                                      CN-BILLING-START-LINE-NO
 13871                ELSE
 13872                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13873                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13874                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13875                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13876                     ELSE
 13877                       MOVE WS-VA-NO-COMM-MESS
 13878                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 252
* EL6311.cbl
 13879                     END-IF
 13880                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13881                  ELSE
 13882                     PERFORM 1700-SQUEEZE-IT-IN
 13883                                 THRU 1700-EXIT
 13884                  END-IF
 13885                END-IF
 13886              END-IF
 13887            END-IF
 13888            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13889            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13890            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13891
 13892* EXEC CICS REWRITE
 13893*              DATASET    (FILE-ID-ERNOTE)
 13894*              FROM       (CERTIFICATE-NOTE)
 13895*              RESP       (WS-RESPONSE)
 13896*           END-EXEC
 13897     MOVE LENGTH OF
 13898      CERTIFICATE-NOTE
 13899       TO DFHEIV11
 13900*    MOVE '&& L                  %  N#00012724' TO DFHEIV0
 13901     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13902     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13903     MOVE X'204E233030303132373234' TO DFHEIV0(25:11)
 13904     CALL 'kxdfhei1' USING DFHEIV0,
 13905           FILE-ID-ERNOTE,
 13906           CERTIFICATE-NOTE,
 13907           DFHEIV11,
 13908           DFHEIV99
 13909     MOVE EIBRESP  TO WS-RESPONSE
 13910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13911          END-IF
 13912        END-IF
 13913     ELSE
 13914        MOVE SPACES              TO CERTIFICATE-NOTE
 13915        MOVE 'CN'                TO CN-RECORD-ID
 13916        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13917                                 TO CN-CONTROL-PRIMARY
 13918                                    ERNOTE-KEY
 13919        move '1'                 to cn-record-type
 13920                                    ernote-record-type
 13921        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13922                                    CN-BILLING-END-LINE-NO
 13923        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13924           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13925        ELSE
 13926           MOVE WS-VA-NO-COMM-MESS
 13927                                 TO CN-LINE (1)
 13928        END-IF
 13929        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13930        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13931        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13932
 13933* EXEC CICS WRITE
 13934*          DATASET    (FILE-ID-ERNOTE)
 13935*          FROM       (CERTIFICATE-NOTE)
 13936*          RIDFLD     (ERNOTE-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 253
* EL6311.cbl
 13937*          RESP       (WS-RESPONSE)
 13938*       END-EXEC
 13939     MOVE LENGTH OF
 13940      CERTIFICATE-NOTE
 13941       TO DFHEIV11
 13942*    MOVE '&$ L                  ''  N#00012750' TO DFHEIV0
 13943     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13945     MOVE X'204E233030303132373530' TO DFHEIV0(25:11)
 13946     CALL 'kxdfhei1' USING DFHEIV0,
 13947           FILE-ID-ERNOTE,
 13948           CERTIFICATE-NOTE,
 13949           DFHEIV11,
 13950           ERNOTE-KEY,
 13951           DFHEIV99,
 13952           DFHEIV99
 13953     MOVE EIBRESP  TO WS-RESPONSE
 13954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13955     END-IF
 13956     .
 13957 1510-EXIT.
 13958     EXIT.
 13959 1520-UPDATE-ELCERT.
 13960     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13961                                 TO ELCERT-KEY
 13962
 13963* EXEC CICS READ
 13964*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13965*        DATASET (FILE-ID-ELCERT)
 13966*        RIDFLD  (ELCERT-KEY)
 13967*        UPDATE
 13968*        RESP    (WS-RESPONSE)
 13969*    END-EXEC
 13970*    MOVE '&"S        EU         (  N#00012763' TO DFHEIV0
 13971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13972     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13973     MOVE X'204E233030303132373633' TO DFHEIV0(25:11)
 13974     CALL 'kxdfhei1' USING DFHEIV0,
 13975           FILE-ID-ELCERT,
 13976           DFHEIV20,
 13977           DFHEIV99,
 13978           ELCERT-KEY,
 13979           DFHEIV99,
 13980           DFHEIV99,
 13981           DFHEIV99
 13982     SET ADDRESS OF CERTIFICATE-MASTER TO
 13983         DFHEIV20
 13984     MOVE EIBRESP  TO WS-RESPONSE
 13985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13986     IF RESP-NORMAL
 13987        IF WS-NOTE-SW = 'A'
 13988           IF CM-NOTE-SW = ' '
 13989              MOVE '2'             TO CM-NOTE-SW
 13990           ELSE
 13991             IF CM-NOTE-SW = '1'
 13992                MOVE '3'           TO CM-NOTE-SW
 13993             ELSE
 13994               IF CM-NOTE-SW = '4'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 254
* EL6311.cbl
 13995                  MOVE '6'         TO CM-NOTE-SW
 13996               ELSE
 13997                 IF CM-NOTE-SW = '5'
 13998                    MOVE '7'       TO CM-NOTE-SW
 13999                 END-IF
 14000               END-IF
 14001             END-IF
 14002           END-IF
 14003        ELSE
 14004           IF CM-NOTE-SW = '2'
 14005              MOVE ' '             TO CM-NOTE-SW
 14006           ELSE
 14007             IF CM-NOTE-SW = '3'
 14008                MOVE '1'           TO CM-NOTE-SW
 14009             ELSE
 14010               IF CM-NOTE-SW = '6'
 14011                  MOVE '4'         TO CM-NOTE-SW
 14012               ELSE
 14013                 IF CM-NOTE-SW = '7'
 14014                    MOVE '5'       TO CM-NOTE-SW
 14015                 END-IF
 14016               END-IF
 14017             END-IF
 14018           END-IF
 14019        END-IF
 14020
 14021* EXEC CICS REWRITE
 14022*          DATASET    (FILE-ID-ELCERT)
 14023*          FROM       (CERTIFICATE-MASTER)
 14024*          RESP       (WS-RESPONSE)
 14025*       END-EXEC
 14026     MOVE LENGTH OF
 14027      CERTIFICATE-MASTER
 14028       TO DFHEIV11
 14029*    MOVE '&& L                  %  N#00012804' TO DFHEIV0
 14030     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14032     MOVE X'204E233030303132383034' TO DFHEIV0(25:11)
 14033     CALL 'kxdfhei1' USING DFHEIV0,
 14034           FILE-ID-ELCERT,
 14035           CERTIFICATE-MASTER,
 14036           DFHEIV11,
 14037           DFHEIV99
 14038     MOVE EIBRESP  TO WS-RESPONSE
 14039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14040        IF RESP-NORMAL
 14041           CONTINUE
 14042        ELSE
 14043           MOVE WS-RESPONSE TO EMI-ERROR
 14044           PERFORM 9900-ERROR-FORMAT
 14045                                 THRU 9900-EXIT
 14046           GO TO 8200-SEND-DATAONLY
 14047        END-IF
 14048     ELSE
 14049        MOVE -1                  TO BMAINTL
 14050        MOVE 0249                TO EMI-ERROR
 14051        PERFORM 9900-ERROR-FORMAT
 14052                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 255
* EL6311.cbl
 14053        GO TO 8200-SEND-DATAONLY
 14054     END-IF
 14055     .
 14056 1520-EXIT.
 14057     EXIT.
 14058 1600-UPDATE-ERPYAJ.
 14059     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14060                                 THRU 1610-EXIT
 14061     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14062                                 THRU 1620-EXIT
 14063     .
 14064 1600-EXIT.
 14065     EXIT.
 14066 1610-ADD-ERPYAJ-BANK-REC.
 14067
 14068* EXEC CICS GETMAIN
 14069*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14070*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14071*        INITIMG (GETMAIN-SPACE)
 14072*    END-EXEC
 14073*    MOVE ',"IL                  $   #00012836' TO DFHEIV0
 14074     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14076     MOVE X'2020233030303132383336' TO DFHEIV0(25:11)
 14077     CALL 'kxdfhei1' USING DFHEIV0,
 14078           DFHEIV20,
 14079           ERPYAJ-RECORD-LENGTH,
 14080           GETMAIN-SPACE
 14081     SET ADDRESS OF PENDING-PAY-ADJ TO
 14082         DFHEIV20
 14083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14084     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14085     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14086     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14087     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14088     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14089     MOVE +10                    TO ERPYAJ-SEQ-NO
 14090     MOVE 'R'                    TO ERPYAJ-TYPE
 14091     IF REVERSAL
 14092        MOVE 'C'                 TO ERPYAJ-TYPE
 14093     END-IF
 14094     MOVE SPACES                 TO PENDING-PAY-ADJ
 14095     MOVE 'PY'                   TO PY-RECORD-ID
 14096     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14097     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14098     IF REVERSAL
 14099        MOVE PB-I-DCC-OVER-CHG-AMT
 14100                                 TO PY-ENTRY-AMT
 14101     END-IF
 14102     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14103                                    PY-INPUT-DT
 14104*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14105*                                   PY-INPUT-DT
 14106     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14107     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14108     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14109     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14110     IF PB-CARRIER = '2'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 256
* EL6311.cbl
 14111        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14112     ELSE
 14113        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14114     END-IF
 14115     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14116                                    PY-BILLED-DATE
 14117                                    PY-AR-DATE
 14118                                    PY-REPORTED-DT
 14119                                    PY-CHECK-WRITTEN-DT
 14120     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14121                                    PY-CHECK-QUE-SEQUENCE
 14122     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14123     PERFORM WITH TEST AFTER
 14124        UNTIL (NOT RESP-DUPKEY)
 14125           AND (NOT RESP-DUPREC)
 14126
 14127* EXEC CICS WRITE
 14128*          DATASET    (FILE-ID-ERPYAJ)
 14129*          FROM       (PENDING-PAY-ADJ)
 14130*          RIDFLD     (ERPYAJ-KEY)
 14131*          RESP       (WS-RESPONSE)
 14132*       END-EXEC
 14133     MOVE LENGTH OF
 14134      PENDING-PAY-ADJ
 14135       TO DFHEIV11
 14136*    MOVE '&$ L                  ''  N#00012883' TO DFHEIV0
 14137     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14139     MOVE X'204E233030303132383833' TO DFHEIV0(25:11)
 14140     CALL 'kxdfhei1' USING DFHEIV0,
 14141           FILE-ID-ERPYAJ,
 14142           PENDING-PAY-ADJ,
 14143           DFHEIV11,
 14144           ERPYAJ-KEY,
 14145           DFHEIV99,
 14146           DFHEIV99
 14147     MOVE EIBRESP  TO WS-RESPONSE
 14148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14149        IF RESP-DUPKEY OR RESP-DUPREC
 14150           ADD +1                TO ERPYAJ-SEQ-NO
 14151           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14152        END-IF
 14153     END-PERFORM
 14154     .
 14155 1610-EXIT.
 14156     EXIT.
 14157 1620-ADD-ERPYAJ-DLR-REC.
 14158     MOVE 'C'                    TO ERPYAJ-TYPE
 14159     IF REVERSAL
 14160        MOVE 'R'                 TO ERPYAJ-TYPE
 14161     END-IF
 14162     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14163                                    ERPYAJ-ACCOUNT
 14164     ADD +1                      TO ERPYAJ-SEQ-NO
 14165     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14166     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14167     IF PB-CARRIER = '2'
 14168        MOVE '2725040330'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 257
* EL6311.cbl
 14169     ELSE
 14170        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14171     END-IF
 14172     PERFORM WITH TEST AFTER
 14173        UNTIL (NOT RESP-DUPKEY)
 14174           AND (NOT RESP-DUPREC)
 14175
 14176* EXEC CICS WRITE
 14177*          DATASET    (FILE-ID-ERPYAJ)
 14178*          FROM       (PENDING-PAY-ADJ)
 14179*          RIDFLD     (ERPYAJ-KEY)
 14180*          RESP       (WS-RESPONSE)
 14181*       END-EXEC
 14182     MOVE LENGTH OF
 14183      PENDING-PAY-ADJ
 14184       TO DFHEIV11
 14185*    MOVE '&$ L                  ''  N#00012915' TO DFHEIV0
 14186     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14187     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14188     MOVE X'204E233030303132393135' TO DFHEIV0(25:11)
 14189     CALL 'kxdfhei1' USING DFHEIV0,
 14190           FILE-ID-ERPYAJ,
 14191           PENDING-PAY-ADJ,
 14192           DFHEIV11,
 14193           ERPYAJ-KEY,
 14194           DFHEIV99,
 14195           DFHEIV99
 14196     MOVE EIBRESP  TO WS-RESPONSE
 14197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14198        IF RESP-DUPKEY OR RESP-DUPREC
 14199           ADD +1                TO ERPYAJ-SEQ-NO
 14200           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14201        END-IF
 14202     END-PERFORM
 14203     .
 14204 1620-EXIT.
 14205     EXIT.
 14206 1700-SQUEEZE-IT-IN.
 14207     IF (N1 > CN-BILLING-END-LINE-NO)
 14208        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14209           N1 = +1
 14210           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14211           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14212              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14213                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14214              ELSE
 14215                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14216              END-IF
 14217              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14218              MOVE +2 TO N1
 14219           END-IF
 14220        END-PERFORM
 14221     ELSE
 14222        IF (N1 < CN-BILLING-START-LINE-NO)
 14223           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14224              N1 = +10
 14225              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14226              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 258
* EL6311.cbl
 14227                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14228                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14229                 ELSE
 14230                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14231                 END-IF
 14232                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14233                 MOVE +9 TO N1
 14234              END-IF
 14235           END-PERFORM
 14236        END-IF
 14237     END-IF
 14238     .
 14239 1700-EXIT.
 14240     EXIT.
 14241 1800-REMOVE-CERT-NOTES.
 14242     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14243                                 TO ERNOTE-KEY
 14244     move '1'                    to ernote-record-type
 14245
 14246* EXEC CICS READ
 14247*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14248*       DATASET    (FILE-ID-ERNOTE)
 14249*       RIDFLD     (ERNOTE-KEY)
 14250*       RESP       (WS-RESPONSE)
 14251*       UPDATE
 14252*    END-EXEC
 14253*    MOVE '&"S        EU         (  N#00012968' TO DFHEIV0
 14254     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14255     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14256     MOVE X'204E233030303132393638' TO DFHEIV0(25:11)
 14257     CALL 'kxdfhei1' USING DFHEIV0,
 14258           FILE-ID-ERNOTE,
 14259           DFHEIV20,
 14260           DFHEIV99,
 14261           ERNOTE-KEY,
 14262           DFHEIV99,
 14263           DFHEIV99,
 14264           DFHEIV99
 14265     SET ADDRESS OF CERTIFICATE-NOTE TO
 14266         DFHEIV20
 14267     MOVE EIBRESP  TO WS-RESPONSE
 14268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14269     IF RESP-NORMAL
 14270        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14271           (N1 > +10)
 14272           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14273           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14274        END-PERFORM
 14275        IF N1 < +11
 14276           MOVE SPACES              TO CN-LINE (N1)
 14277           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14278              N1 <= CN-BILLING-END-LINE-NO
 14279              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14280              IF CN-BILLING-END-LINE-NO <
 14281                               CN-BILLING-START-LINE-NO
 14282                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14283                                     CN-BILLING-START-LINE-NO
 14284              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 259
* EL6311.cbl
 14285              PERFORM 1820-SQUEEZE-ERNOTE
 14286                                  THRU 1820-EXIT
 14287           END-IF
 14288           IF CN-LINES = SPACES
 14289
 14290* EXEC CICS DELETE
 14291*                DATASET    (FILE-ID-ERNOTE)
 14292*                RESP       (WS-RESPONSE)
 14293*             END-EXEC
 14294*    MOVE '&(                    &  N#00012995' TO DFHEIV0
 14295     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14297     MOVE X'204E233030303132393935' TO DFHEIV0(25:11)
 14298     CALL 'kxdfhei1' USING DFHEIV0,
 14299           FILE-ID-ERNOTE,
 14300           DFHEIV99,
 14301           DFHEIV99,
 14302           DFHEIV99,
 14303           DFHEIV99
 14304     MOVE EIBRESP  TO WS-RESPONSE
 14305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14306              IF RESP-NORMAL
 14307                 MOVE 'D'        TO WS-NOTE-SW
 14308                 PERFORM 1520-UPDATE-ELCERT
 14309                                 THRU 1520-EXIT
 14310              END-IF
 14311           ELSE
 14312
 14313* EXEC CICS REWRITE
 14314*                DATASET    (FILE-ID-ERNOTE)
 14315*                FROM       (CERTIFICATE-NOTE)
 14316*                RESP       (WS-RESPONSE)
 14317*             END-EXEC
 14318     MOVE LENGTH OF
 14319      CERTIFICATE-NOTE
 14320       TO DFHEIV11
 14321*    MOVE '&& L                  %  N#00013005' TO DFHEIV0
 14322     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14323     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14324     MOVE X'204E233030303133303035' TO DFHEIV0(25:11)
 14325     CALL 'kxdfhei1' USING DFHEIV0,
 14326           FILE-ID-ERNOTE,
 14327           CERTIFICATE-NOTE,
 14328           DFHEIV11,
 14329           DFHEIV99
 14330     MOVE EIBRESP  TO WS-RESPONSE
 14331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14332           END-IF
 14333        END-IF
 14334     END-IF
 14335     .
 14336 1800-EXIT.
 14337     EXIT.
 14338 1820-SQUEEZE-ERNOTE.
 14339     MOVE CN-BILLING-START-LINE-NO TO N2
 14340     IF N2 = 0
 14341         MOVE +1                 TO N2
 14342     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 260
* EL6311.cbl
 14343     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14344        (N1 > +9)
 14345        IF CN-LINE (N1) = SPACES
 14346           MOVE CN-LINE (N1 + +1)
 14347                                 TO CN-LINE (N1)
 14348           MOVE SPACES           TO CN-LINE (N1 + +1)
 14349        END-IF
 14350     END-PERFORM
 14351     .
 14352 1820-EXIT.
 14353     EXIT.
 14354 1900-DELETE-ERPYAJ.
 14355     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14356     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14357     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14358     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14359     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14360     MOVE +10                    TO ERPYAJ-SEQ-NO
 14361     MOVE 'R'                    TO ERPYAJ-TYPE
 14362     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14363
 14364* EXEC CICS STARTBR
 14365*       DATASET    (FILE-ID-ERPYAJ)
 14366*       RIDFLD     (ERPYAJ-KEY)
 14367*       RESP       (WS-RESPONSE)
 14368*    END-EXEC
 14369     MOVE 0
 14370       TO DFHEIV11
 14371*    MOVE '&,         G          &  N#00013041' TO DFHEIV0
 14372     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14374     MOVE X'204E233030303133303431' TO DFHEIV0(25:11)
 14375     CALL 'kxdfhei1' USING DFHEIV0,
 14376           FILE-ID-ERPYAJ,
 14377           ERPYAJ-KEY,
 14378           DFHEIV99,
 14379           DFHEIV11,
 14380           DFHEIV99
 14381     MOVE EIBRESP  TO WS-RESPONSE
 14382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14383     IF RESP-NORMAL
 14384        CONTINUE
 14385     ELSE
 14386        GO TO 1900-GET-DEALER
 14387     END-IF
 14388     .
 14389 1900-READNEXT-ERPYAJ-B.
 14390*  GET THE BANK ERPYAJ RECORD
 14391
 14392* EXEC CICS READNEXT
 14393*       DATASET    (FILE-ID-ERPYAJ)
 14394*       RIDFLD     (ERPYAJ-KEY)
 14395*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14396*       RESP       (WS-RESPONSE)
 14397*    END-EXEC
 14398     MOVE 0
 14399       TO DFHEIV11
 14400*    MOVE '&.S                   )  N#00013054' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 261
* EL6311.cbl
 14401     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14402     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14403     MOVE X'204E233030303133303534' TO DFHEIV0(25:11)
 14404     CALL 'kxdfhei1' USING DFHEIV0,
 14405           FILE-ID-ERPYAJ,
 14406           DFHEIV20,
 14407           DFHEIV99,
 14408           ERPYAJ-KEY,
 14409           DFHEIV99,
 14410           DFHEIV11,
 14411           DFHEIV99,
 14412           DFHEIV99
 14413     SET ADDRESS OF PENDING-PAY-ADJ TO
 14414         DFHEIV20
 14415     MOVE EIBRESP  TO WS-RESPONSE
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14417     IF RESP-NORMAL
 14418        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14419           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14420              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14421                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14422
 14423* EXEC CICS READ
 14424*                   DATASET    (FILE-ID-ERPYAJ)
 14425*                   RIDFLD     (ERPYAJ-KEY)
 14426*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14427*                   RESP       (WS-RESPONSE)
 14428*                   UPDATE
 14429*                END-EXEC
 14430*    MOVE '&"S        EU         (  N#00013065' TO DFHEIV0
 14431     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14432     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14433     MOVE X'204E233030303133303635' TO DFHEIV0(25:11)
 14434     CALL 'kxdfhei1' USING DFHEIV0,
 14435           FILE-ID-ERPYAJ,
 14436           DFHEIV20,
 14437           DFHEIV99,
 14438           ERPYAJ-KEY,
 14439           DFHEIV99,
 14440           DFHEIV99,
 14441           DFHEIV99
 14442     SET ADDRESS OF PENDING-PAY-ADJ TO
 14443         DFHEIV20
 14444     MOVE EIBRESP  TO WS-RESPONSE
 14445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14446                 IF RESP-NORMAL
 14447
 14448* EXEC CICS DELETE
 14449*                      DATASET   (FILE-ID-ERPYAJ)
 14450*                      RESP      (WS-RESPONSE)
 14451*                   END-EXEC
 14452*    MOVE '&(                    &  N#00013073' TO DFHEIV0
 14453     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14455     MOVE X'204E233030303133303733' TO DFHEIV0(25:11)
 14456     CALL 'kxdfhei1' USING DFHEIV0,
 14457           FILE-ID-ERPYAJ,
 14458           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 262
* EL6311.cbl
 14459           DFHEIV99,
 14460           DFHEIV99,
 14461           DFHEIV99
 14462     MOVE EIBRESP  TO WS-RESPONSE
 14463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14464                 END-IF
 14465              ELSE
 14466                 SET REVERSAL    TO TRUE
 14467                 PERFORM 1600-UPDATE-ERPYAJ
 14468                                 THRU 1600-EXIT
 14469                 GO TO 1900-EXIT
 14470              END-IF
 14471           ELSE
 14472              GO TO 1900-READNEXT-ERPYAJ-B
 14473           END-IF
 14474        END-IF
 14475
 14476* EXEC CICS ENDBR
 14477*          DATASET   (FILE-ID-ERPYAJ)
 14478*       END-EXEC
 14479     MOVE 0
 14480       TO DFHEIV11
 14481*    MOVE '&2                    $   #00013088' TO DFHEIV0
 14482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14484     MOVE X'2020233030303133303838' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0,
 14486           FILE-ID-ERPYAJ,
 14487           DFHEIV11,
 14488           DFHEIV99
 14489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14490     END-IF
 14491     .
 14492 1900-GET-DEALER.
 14493     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14494     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14495     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14496     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14497     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14498     MOVE +10                    TO ERPYAJ-SEQ-NO
 14499     MOVE 'C'                    TO ERPYAJ-TYPE
 14500     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14501
 14502* EXEC CICS STARTBR
 14503*       DATASET    (FILE-ID-ERPYAJ)
 14504*       RIDFLD     (ERPYAJ-KEY)
 14505*       RESP       (WS-RESPONSE)
 14506*    END-EXEC
 14507     MOVE 0
 14508       TO DFHEIV11
 14509*    MOVE '&,         G          &  N#00013102' TO DFHEIV0
 14510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14512     MOVE X'204E233030303133313032' TO DFHEIV0(25:11)
 14513     CALL 'kxdfhei1' USING DFHEIV0,
 14514           FILE-ID-ERPYAJ,
 14515           ERPYAJ-KEY,
 14516           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 263
* EL6311.cbl
 14517           DFHEIV11,
 14518           DFHEIV99
 14519     MOVE EIBRESP  TO WS-RESPONSE
 14520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14521     IF RESP-NORMAL
 14522        CONTINUE
 14523     ELSE
 14524        GO TO 1900-EXIT
 14525     END-IF
 14526     .
 14527 1900-READNEXT-ERPYAJ-D.
 14528*  GET THE DEALER ERPYAJ RECORD
 14529
 14530* EXEC CICS READNEXT
 14531*       DATASET    (FILE-ID-ERPYAJ)
 14532*       RIDFLD     (ERPYAJ-KEY)
 14533*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14534*       RESP       (WS-RESPONSE)
 14535*    END-EXEC
 14536     MOVE 0
 14537       TO DFHEIV11
 14538*    MOVE '&.S                   )  N#00013115' TO DFHEIV0
 14539     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14541     MOVE X'204E233030303133313135' TO DFHEIV0(25:11)
 14542     CALL 'kxdfhei1' USING DFHEIV0,
 14543           FILE-ID-ERPYAJ,
 14544           DFHEIV20,
 14545           DFHEIV99,
 14546           ERPYAJ-KEY,
 14547           DFHEIV99,
 14548           DFHEIV11,
 14549           DFHEIV99,
 14550           DFHEIV99
 14551     SET ADDRESS OF PENDING-PAY-ADJ TO
 14552         DFHEIV20
 14553     MOVE EIBRESP  TO WS-RESPONSE
 14554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14555     IF RESP-NORMAL
 14556        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14557           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14558              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14559                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14560
 14561* EXEC CICS READ
 14562*                   DATASET    (FILE-ID-ERPYAJ)
 14563*                   RIDFLD     (ERPYAJ-KEY)
 14564*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14565*                   RESP       (WS-RESPONSE)
 14566*                   UPDATE
 14567*                END-EXEC
 14568*    MOVE '&"S        EU         (  N#00013126' TO DFHEIV0
 14569     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14571     MOVE X'204E233030303133313236' TO DFHEIV0(25:11)
 14572     CALL 'kxdfhei1' USING DFHEIV0,
 14573           FILE-ID-ERPYAJ,
 14574           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 264
* EL6311.cbl
 14575           DFHEIV99,
 14576           ERPYAJ-KEY,
 14577           DFHEIV99,
 14578           DFHEIV99,
 14579           DFHEIV99
 14580     SET ADDRESS OF PENDING-PAY-ADJ TO
 14581         DFHEIV20
 14582     MOVE EIBRESP  TO WS-RESPONSE
 14583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14584                 IF RESP-NORMAL
 14585
 14586* EXEC CICS DELETE
 14587*                      DATASET   (FILE-ID-ERPYAJ)
 14588*                      RESP      (WS-RESPONSE)
 14589*                   END-EXEC
 14590*    MOVE '&(                    &  N#00013134' TO DFHEIV0
 14591     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14592     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14593     MOVE X'204E233030303133313334' TO DFHEIV0(25:11)
 14594     CALL 'kxdfhei1' USING DFHEIV0,
 14595           FILE-ID-ERPYAJ,
 14596           DFHEIV99,
 14597           DFHEIV99,
 14598           DFHEIV99,
 14599           DFHEIV99
 14600     MOVE EIBRESP  TO WS-RESPONSE
 14601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14602                 END-IF
 14603              ELSE
 14604                 SET REVERSAL    TO TRUE
 14605              END-IF
 14606           ELSE
 14607              GO TO 1900-READNEXT-ERPYAJ-D
 14608           END-IF
 14609        END-IF
 14610
 14611* EXEC CICS ENDBR
 14612*          DATASET   (FILE-ID-ERPYAJ)
 14613*       END-EXEC
 14614     MOVE 0
 14615       TO DFHEIV11
 14616*    MOVE '&2                    $   #00013146' TO DFHEIV0
 14617     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14619     MOVE X'2020233030303133313436' TO DFHEIV0(25:11)
 14620     CALL 'kxdfhei1' USING DFHEIV0,
 14621           FILE-ID-ERPYAJ,
 14622           DFHEIV11,
 14623           DFHEIV99
 14624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14625     END-IF
 14626     .
 14627 1900-EXIT.
 14628     EXIT.
 14629******************************************************************
 14630*            C A N C E L   M A I N L I N E                       *
 14631******************************************************************
 14632
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 265
* EL6311.cbl
 14633 2000-CANCEL-MAINLINE.
 14634     IF PI-DISPLAY-ORIGINAL-BATCH
 14635        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14636           MOVE ER-0023             TO EMI-ERROR
 14637           MOVE -1                  TO CMAINTL
 14638           MOVE AL-UABON            TO CMAINTA
 14639           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14640           GO TO 8200-SEND-DATAONLY
 14641        ELSE
 14642           NEXT SENTENCE
 14643     ELSE
 14644        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14645           MOVE ER-0023             TO EMI-ERROR
 14646           MOVE -1                  TO CMAINTL
 14647           MOVE AL-UABON            TO CMAINTA
 14648           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14649           GO TO 8200-SEND-DATAONLY.
 14650
 14651     IF CMAINTI = 'S'
 14652        GO TO 2100-SHOW-REQUEST.
 14653
 14654     IF NOT MODIFY-CAP
 14655         MOVE 'UPDATE'       TO SM-READ
 14656         PERFORM 9995-SECURITY-VIOLATION
 14657         MOVE ER-0070        TO EMI-ERROR
 14658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14659         GO TO 8100-SEND-INITIAL-MAP.
 14660
 14661     IF CMAINTL GREATER THAN ZEROS
 14662        IF PI-PF6-FUNCTION
 14663           IF CMAINTI NOT = 'A'
 14664              MOVE AL-UABON  TO CMAINTA
 14665              MOVE -1        TO CMAINTL
 14666              MOVE ER-2260   TO EMI-ERROR
 14667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14668              GO TO 8200-SEND-DATAONLY.
 14669
 14670     IF CCERTNOL = ZEROS
 14671       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14672         NEXT SENTENCE
 14673     ELSE
 14674         IF CCERTNOL NOT = ZEROS
 14675             MOVE AL-UANON       TO CCERTNOA
 14676         ELSE
 14677             MOVE -1             TO CCERTNOL
 14678             MOVE  1             TO SET-CURSOR-SW
 14679             MOVE ER-2218       TO EMI-ERROR
 14680             MOVE AL-UABON       TO CCERTNOA
 14681             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14682
 14683     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14684        NEXT SENTENCE
 14685     ELSE
 14686        IF CEFFDTL NOT = ZEROS
 14687           MOVE AL-UNNON         TO CEFFDTA
 14688           MOVE CEFFDTI TO DEEDIT-FIELD
 14689           PERFORM 8600-DEEDIT
 14690           MOVE 4                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 266
* EL6311.cbl
 14691           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14692           PERFORM 9700-DATE-LINK
 14693           IF NO-CONVERSION-ERROR
 14694              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14695              ELSE
 14696              MOVE -1            TO CEFFDTL
 14697              MOVE  1            TO SET-CURSOR-SW
 14698              MOVE ER-2226      TO EMI-ERROR
 14699              MOVE AL-UNBON      TO CEFFDTA
 14700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14701          ELSE
 14702          MOVE -1                 TO CEFFDTL
 14703          MOVE  1                 TO SET-CURSOR-SW
 14704          MOVE ER-2220            TO EMI-ERROR
 14705          MOVE AL-UNBON           TO CEFFDTA
 14706          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14707
 14708     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14709
 14710     IF CCERTNOL NOT = ZEROS
 14711        MOVE CCERTNOI                TO WS-NEW-PRIME
 14712     ELSE
 14713        MOVE SPACES                  TO WS-NEW-PRIME.
 14714
 14715     IF CSUFIXL NOT = ZEROS
 14716        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14717     ELSE
 14718        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14719
 14720     IF CEFFDTL NOT = ZEROS
 14721        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14722     ELSE
 14723        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14724
 14725     IF CMAINTI = 'A' OR 'K' OR 'S'
 14726        NEXT SENTENCE
 14727     ELSE
 14728        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14729        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14730           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14731           WS-PB-RECORD-TYPE NOT = '2'
 14732           IF CMAINTI = 'C'
 14733              MOVE ER-2287          TO EMI-ERROR
 14734              MOVE -1               TO CCERTNOL
 14735              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14736              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14737              GO TO 8200-SEND-DATAONLY
 14738             ELSE
 14739              MOVE ER-2260          TO EMI-ERROR
 14740              MOVE -1               TO CCERTNOL
 14741              MOVE AL-UABON         TO CCERTNOA
 14742              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14743              GO TO 8200-SEND-DATAONLY.
 14744
 14745     IF CMAINTI = 'D'
 14746        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14747
 14748     IF CLSTNML GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 267
* EL6311.cbl
 14749         MOVE AL-UANON           TO CLSTNMA.
 14750
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 268
* EL6311.cbl
 14752
 14753******************************************************************
 14754*                                                                *
 14755*           E D I T   C A N C E L   C O V E R A G E S            *
 14756*                                                                *
 14757******************************************************************
 14758
 14759 2015-EDIT-COVERAGES.
 14760     IF CCANDT1L      GREATER THAN ZEROS OR
 14761        CREFND1L      GREATER THAN ZEROS OR
 14762        CCANDT2L      GREATER THAN ZEROS OR
 14763        CREFND2L      GREATER THAN ZEROS OR
 14764        CMTHD1L       GREATER THAN ZEROS OR
 14765        CMTHD2L       GREATER THAN ZEROS OR
 14766        CLIVESL       GREATER THAN ZEROS OR
 14767        CPAYEEL       GREATER THAN ZEROS OR
 14768        CFORCEL       GREATER THAN ZEROS OR
 14769        CBILCDL       GREATER THAN ZEROS OR
 14770        CCANREAL      GREATER THAN ZEROS
 14771            NEXT SENTENCE
 14772         ELSE
 14773            GO TO 2030-EDIT-COMPLETE.
 14774
 14775     IF CCANDT1L = ZEROS
 14776        AND (CMAINTI = 'C' OR 'K')
 14777        NEXT SENTENCE
 14778     ELSE
 14779        IF CCANDT1L      GREATER THAN ZEROS
 14780            MOVE AL-UNNON            TO CCANDT1A
 14781            IF CCANDT1I = SPACES
 14782               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14783            ELSE
 14784               MOVE CCANDT1I            TO DEEDIT-FIELD
 14785               PERFORM 8600-DEEDIT
 14786               IF DEEDIT-FIELD-V0   NUMERIC
 14787                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14788                  MOVE 4                TO DC-OPTION-CODE
 14789                  PERFORM 9700-DATE-LINK
 14790                  IF NO-CONVERSION-ERROR
 14791                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14792                  ELSE
 14793                      MOVE -1        TO CCANDT1L
 14794                      MOVE ER-2227   TO EMI-ERROR
 14795                      MOVE AL-UNBON  TO CCANDT1A
 14796                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14797               ELSE
 14798                  MOVE -1         TO CCANDT1L
 14799                  MOVE ER-2223    TO EMI-ERROR
 14800                  MOVE AL-UNBON   TO CCANDT1A
 14801                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14802        ELSE
 14803            IF CREFND1L GREATER THAN ZEROS
 14804               MOVE -1             TO CCANDT1L
 14805               MOVE ER-2222        TO EMI-ERROR
 14806               MOVE AL-UNBOF       TO CCANDT1A
 14807               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14808
 14809     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 269
* EL6311.cbl
 14810        AND (CMAINTI = 'C' OR 'K')
 14811         NEXT SENTENCE
 14812     ELSE
 14813         IF CREFND1L NOT = ZEROS
 14814            MOVE AL-UNNON        TO CREFND1A
 14815
 14816* EXEC CICS BIF DEEDIT
 14817*               FIELD  (CREFND1I)
 14818*               LENGTH (11)
 14819*           END-EXEC
 14820     MOVE 11
 14821       TO DFHEIV11
 14822*    MOVE '@"L                   #   #00013339' TO DFHEIV0
 14823     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14825     MOVE X'2020233030303133333339' TO DFHEIV0(25:11)
 14826     CALL 'kxdfhei1' USING DFHEIV0,
 14827           CREFND1I,
 14828           DFHEIV11
 14829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14830            MOVE CREFND1I        TO WS-CREFND1
 14831*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14832*           PERFORM 8600-DEEDIT
 14833*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14834            IF WS-CREFND1  = ZEROS
 14835               AND CMAINTI = 'A'
 14836             MOVE ER-2437        TO EMI-ERROR
 14837             MOVE -1             TO CREFND1L
 14838             MOVE AL-UNBON       TO CREFND1A
 14839             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14840
 14841     IF CCANREAL > +0
 14842        MOVE AL-UANON            TO CCANREAA
 14843        IF CCANREAI = 'R' OR ' '
 14844           CONTINUE
 14845        ELSE
 14846           MOVE ER-9841        TO EMI-ERROR
 14847           MOVE -1             TO CCANREAL
 14848           MOVE AL-UABON       TO CCANREAA
 14849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14850        END-IF
 14851     END-IF
 14852     IF CMTHD1L EQUAL +0
 14853        NEXT SENTENCE
 14854     ELSE
 14855        IF CMTHD1L NOT = +0
 14856           MOVE AL-UNNON        TO CMTHD1A
 14857           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14858                         OR '5' OR '6' OR '8' OR '9'
 14859                         OR 'R' OR ' '
 14860              NEXT SENTENCE
 14861           ELSE
 14862              MOVE ER-0582        TO EMI-ERROR
 14863              MOVE -1             TO CMTHD1L
 14864              MOVE AL-UNBON       TO CMTHD1A
 14865              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14866
 14867     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 270
* EL6311.cbl
 14868        AND (CMAINTI = 'C' OR 'K')
 14869         NEXT SENTENCE
 14870     ELSE
 14871         IF CCANDT2L  GREATER THAN ZEROS
 14872             MOVE AL-UNNON       TO CCANDT2A
 14873             IF CCANDT2I = SPACES
 14874                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14875             ELSE
 14876                MOVE CCANDT2I       TO DEEDIT-FIELD
 14877                PERFORM 8600-DEEDIT
 14878                IF DEEDIT-FIELD-V0   NUMERIC
 14879                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14880                   MOVE 4                TO DC-OPTION-CODE
 14881                   PERFORM 9700-DATE-LINK
 14882                   IF NO-CONVERSION-ERROR
 14883                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14884                   ELSE
 14885                      MOVE -1       TO CCANDT2L
 14886                      MOVE ER-2227  TO EMI-ERROR
 14887                      MOVE AL-UNBON TO CCANDT2A
 14888                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14889                ELSE
 14890                   MOVE -1         TO CCANDT2L
 14891                   MOVE ER-2223    TO EMI-ERROR
 14892                   MOVE AL-UNBON   TO CCANDT2A
 14893                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14894         ELSE
 14895            IF CREFND2L GREATER THAN ZEROS
 14896               MOVE -1             TO CCANDT2L
 14897               MOVE ER-2222        TO EMI-ERROR
 14898               MOVE AL-UNBOF       TO CCANDT2A
 14899               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14900
 14901     IF CREFND2L = ZEROS
 14902        AND (CMAINTI = 'C' OR 'K')
 14903         NEXT SENTENCE
 14904     ELSE
 14905         IF CREFND2L NOT = ZEROS
 14906            MOVE AL-UNNON        TO CREFND2A
 14907
 14908* EXEC CICS BIF DEEDIT
 14909*               FIELD  (CREFND2I)
 14910*               LENGTH (11)
 14911*           END-EXEC
 14912     MOVE 11
 14913       TO DFHEIV11
 14914*    MOVE '@"L                   #   #00013420' TO DFHEIV0
 14915     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14916     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14917     MOVE X'2020233030303133343230' TO DFHEIV0(25:11)
 14918     CALL 'kxdfhei1' USING DFHEIV0,
 14919           CREFND2I,
 14920           DFHEIV11
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14922            MOVE CREFND2I        TO WS-CREFND2
 14923*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14924*           PERFORM 8600-DEEDIT
 14925*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 271
* EL6311.cbl
 14926            IF WS-CREFND2  = ZEROS
 14927               AND CMAINTI = 'A'
 14928             MOVE ER-2437        TO EMI-ERROR
 14929             MOVE -1             TO CREFND2L
 14930             MOVE AL-UNBON       TO CREFND2A
 14931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14932
 14933     IF CMTHD2L EQUAL +0
 14934        NEXT SENTENCE
 14935     ELSE
 14936        IF CMTHD2L NOT = +0
 14937           MOVE AL-UNNON        TO CMTHD2A
 14938           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14939                         OR '5' OR '6' OR '8' OR '9'
 14940                         OR ' ' OR 'R'
 14941              NEXT SENTENCE
 14942           ELSE
 14943              MOVE ER-0582        TO EMI-ERROR
 14944              MOVE -1             TO CMTHD2L
 14945              MOVE AL-UNBON       TO CMTHD2A
 14946              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14947
 14948     IF CLIVESL GREATER THAN ZEROS
 14949         MOVE CLIVESI            TO DEEDIT-FIELD
 14950         PERFORM 8600-DEEDIT
 14951         IF DEEDIT-FIELD-V0 NUMERIC
 14952             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14953             MOVE AL-UNNON       TO CLIVESA
 14954         ELSE
 14955             MOVE -1             TO CLIVESL
 14956             MOVE AL-UNBON       TO CLIVESA
 14957             MOVE ER-2223        TO EMI-ERROR
 14958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14959
 14960     IF CFORCEL  NOT = ZEROS
 14961         IF FORCE-CAP
 14962            MOVE AL-UANON            TO CFORCEA
 14963         ELSE
 14964            MOVE ER-2945             TO EMI-ERROR
 14965            MOVE AL-UABON            TO CFORCEA
 14966            MOVE -1                  TO CFORCEL
 14967            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14968
 14969     IF CPAYEEL GREATER THAN ZEROS
 14970        MOVE AL-UANON            TO CPAYEEA.
 14971
 14972     IF CBILCDL NOT = ZEROS
 14973        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14974                             AND 'A' AND 'B' AND 'E'
 14975           MOVE ER-2225              TO EMI-ERROR
 14976           MOVE AL-UABON             TO CBILCDA
 14977           MOVE -1                   TO CBILCDL
 14978           MOVE  1                   TO SET-CURSOR-SW
 14979           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14980        ELSE
 14981           MOVE AL-UANON             TO CBILCDA.
 14982
 14983 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 272
* EL6311.cbl
 14984     IF EMI-ERROR = ZEROS
 14985         NEXT SENTENCE
 14986     ELSE
 14987         GO TO 8200-SEND-DATAONLY.
 14988
 14989     IF CMAINTI = 'A'
 14990        GO TO 2200-ADD-CANCEL-ROUTINE.
 14991
 14992     IF CMAINTI = 'C'
 14993        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14994
 14995     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14996
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 273
* EL6311.cbl
 14998
 14999******************************************************************
 15000*                                                                *
 15001*                   S H O W   C A N C E L                        *
 15002*                                                                *
 15003******************************************************************
 15004
 15005 2100-SHOW-REQUEST.
 15006     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 15007
 15008     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 15009        MOVE -1                  TO CMAINTL
 15010        GO TO 8200-SEND-DATAONLY.
 15011
 15012     MOVE CCERTNOI            TO WS-NEW-PRIME.
 15013
 15014     IF CSUFIXL NOT = ZEROS
 15015        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 15016       ELSE
 15017        MOVE SPACE            TO WS-NEW-SUFFIX.
 15018
 15019     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15020     PERFORM 8600-DEEDIT.
 15021     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15022     MOVE '4'                    TO DC-OPTION-CODE.
 15023     PERFORM 9700-DATE-LINK.
 15024     IF DATE-CONVERSION-ERROR
 15025        MOVE ER-0348             TO EMI-ERROR
 15026        MOVE -1                  TO CEFFDTL
 15027        MOVE AL-UABON            TO CEFFDTA
 15028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15029        GO TO 8200-SEND-DATAONLY
 15030     ELSE
 15031        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15032        MOVE AL-UANON            TO CEFFDTA
 15033        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15034
 15035     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 15036
 15037     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 15038        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 15039        MOVE 'Y'                    TO WS-SHOW-SW
 15040        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 15041           GO TO 4100-BROWSE-PRIMARY-FORWARD
 15042        ELSE
 15043           IF PI-FILE-BROWSE
 15044              GO TO 4300-BROWSE-FILE-FORWARD
 15045           ELSE
 15046              IF PI-CSR-BROWSE
 15047                 GO TO 4200-BROWSE-CSR-FORWARD
 15048              ELSE
 15049                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15050     ELSE
 15051        GO TO 3900-RE-DISPLAY-RECORD.
 15052
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 274
* EL6311.cbl
 15054
 15055
 15056******************************************************************
 15057*                                                                *
 15058*            A D D   C A N C E L   R O U T I N E                 *
 15059*                                                                *
 15060******************************************************************
 15061
 15062 2200-ADD-CANCEL-ROUTINE.
 15063     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15064
 15065
 15066* EXEC CICS GETMAIN
 15067*        SET     (ADDRESS OF PENDING-BUSINESS)
 15068*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15069*    END-EXEC.
 15070*    MOVE '," L                  $   #00013567' TO DFHEIV0
 15071     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15072     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15073     MOVE X'2020233030303133353637' TO DFHEIV0(25:11)
 15074     CALL 'kxdfhei1' USING DFHEIV0,
 15075           DFHEIV20,
 15076           ERPNDB-RECORD-LENGTH,
 15077           DFHEIV99
 15078     SET ADDRESS OF PENDING-BUSINESS TO
 15079         DFHEIV20
 15080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15081
 15082
 15083
 15084* EXEC CICS HANDLE CONDITION
 15085*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15086*    END-EXEC.
 15087*    MOVE '"$I                   ! 3 #00013572' TO DFHEIV0
 15088     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15090     MOVE X'3320233030303133353732' TO DFHEIV0(25:11)
 15091     CALL 'kxdfhei1' USING DFHEIV0
 15092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15093
 15094
 15095     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15096     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15097     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15098
 15099
 15100* EXEC CICS READ
 15101*        INTO    (PENDING-BUSINESS)
 15102*        DATASET (FILE-ID-ERPNDB)
 15103*        RIDFLD  (ERPNDB-KEY)
 15104*    END-EXEC.
 15105     MOVE LENGTH OF
 15106      PENDING-BUSINESS
 15107       TO DFHEIV11
 15108*    MOVE '&"IL       E          (   #00013580' TO DFHEIV0
 15109     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15111     MOVE X'2020233030303133353830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 275
* EL6311.cbl
 15112     CALL 'kxdfhei1' USING DFHEIV0,
 15113           FILE-ID-ERPNDB,
 15114           PENDING-BUSINESS,
 15115           DFHEIV11,
 15116           ERPNDB-KEY,
 15117           DFHEIV99,
 15118           DFHEIV99,
 15119           DFHEIV99
 15120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15121
 15122
 15123     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15124
 15125     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15126     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15127     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15128     MOVE SPACES                 TO PENDING-BUSINESS.
 15129     MOVE 'PB'                   TO PB-RECORD-ID.
 15130     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15131     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15132     MOVE SPACES                 TO PB-CERT-SFX.
 15133     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15134     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15135                                    PB-ALT-CHG-SEQ-NO.
 15136
 15137     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15138     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15139     MOVE '2'                    TO PB-RECORD-TYPE.
 15140
 15141     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15142     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15143
 15144
 15145     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15146                                    PB-ALT-CHG-SEQ-NO
 15147                                    PB-C-LF-REF-CALC
 15148                                    PB-C-AH-REF-CALC
 15149                                    PB-C-LF-RFND-CLP
 15150                                    PB-C-AH-RFND-CLP
 15151                                    PB-CI-INSURED-AGE
 15152                                    PB-CI-LF-TERM
 15153                                    PB-CI-AH-TERM
 15154                                    PB-CI-LF-BENEFIT-CD
 15155                                    PB-CI-LF-BENEFIT-AMT
 15156                                    PB-CI-LF-ALT-BENEFIT-AMT
 15157                                    PB-CI-LF-PREMIUM-AMT
 15158                                    PB-CI-LF-ALT-PREMIUM-AMT
 15159                                    PB-CI-AH-BENEFIT-CD
 15160                                    PB-CI-AH-BENEFIT-AMT
 15161                                    PB-CI-AH-PREMIUM-AMT
 15162                                    PB-CI-PAY-FREQUENCY
 15163                                    PB-CI-LOAN-APR
 15164                                    PB-CI-LOAN-TERM
 15165                                    PB-CI-LIFE-COMMISSION
 15166                                    PB-CI-AH-COMMISSION
 15167                                    PB-CI-CURR-SEQ
 15168                                    PB-CI-AH-CANCEL-AMT
 15169                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 276
* EL6311.cbl
 15170                                    PB-CI-RATE-DEV-PCT-LF
 15171                                    PB-CI-RATE-DEV-PCT-AH
 15172                                    PB-CI-EXTENTION-DAYS
 15173                                    PB-CI-TERM-IN-DAYS
 15174                                    PB-CI-LIVES
 15175                                    PB-CI-LF-CRIT-PER
 15176                                    PB-CI-AH-CRIT-PER
 15177                                    PB-C-LF-REM-TERM
 15178                                    PB-C-AH-REM-TERM
 15179                                    PB-CHG-COUNT
 15180                                    PB-LF-BILLED-AMTS
 15181                                    PB-AH-BILLED-AMTS
 15182                                    PB-C-INT-ON-REFS
 15183*                                   PB-C-MICROFILM-NO
 15184                                    PB-CALC-TOLERANCE.
 15185
 15186     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15187                                    PB-CI-AH-SETTLEMENT-DT
 15188                                    PB-CI-DEATH-DT
 15189                                    PB-CI-LF-PRIOR-CANCEL-DT
 15190                                    PB-CI-AH-PRIOR-CANCEL-DT
 15191                                    PB-CI-ENTRY-DT
 15192                                    PB-CI-LF-EXPIRE-DT
 15193                                    PB-CI-AH-EXPIRE-DT
 15194                                    PB-CI-LOAN-1ST-PMT-DT
 15195                                    PB-C-LF-CANCEL-DT
 15196                                    PB-C-AH-CANCEL-DT
 15197                                    PB-CREDIT-ACCEPT-DT
 15198                                    PB-BILLED-DT
 15199                                    PB-ACCT-EFF-DT
 15200                                    PB-ACCT-EXP-DT.
 15201
 15202     MOVE 'X'                    TO PB-FATAL-FLAG.
 15203
 15204     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15205
 15206     IF CSUFIXL     GREATER THAN ZEROS
 15207        MOVE CSUFIXI             TO PB-CERT-SFX.
 15208
 15209*    IF CMICRNOL  GREATER  ZEROS
 15210*        IF CMICRNOI  NUMERIC
 15211*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15212*            MOVE AL-UNNON       TO  CMICRNOA
 15213*        ELSE
 15214*            MOVE -1             TO  CMICRNOL
 15215*            MOVE AL-UNBON       TO  CMICRNOA
 15216*            MOVE ER-2701        TO  EMI-ERROR
 15217*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15218
 15219     IF CLSTNML     GREATER THAN ZEROS
 15220        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15221
 15222     IF CCANREAL > ZEROS
 15223        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15224     END-IF
 15225     IF CCANDT1L    GREATER THAN ZEROS
 15226        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15227
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 277
* EL6311.cbl
 15228     IF CCANDT2L    GREATER THAN ZEROS
 15229        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15230
 15231     IF CMTHD1L    GREATER THAN +0
 15232        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15233
 15234     IF CMTHD2L    GREATER THAN +0
 15235        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15236
 15237     IF CREFND1L    GREATER THAN ZEROS
 15238        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15239        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15240     ELSE
 15241        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15242
 15243     IF CREFND2L    GREATER THAN ZEROS
 15244        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15245        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15246     ELSE
 15247        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15248
 15249     IF CLIVESL     GREATER THAN ZEROS
 15250        MOVE WS-CLIVES           TO PB-C-LIVES
 15251     ELSE
 15252        MOVE ZEROS               TO PB-C-LIVES.
 15253
 15254     IF CPAYEEL     GREATER THAN ZEROS
 15255        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15256
 15257     IF CFORCEL     GREATER THAN ZEROS
 15258        MOVE CFORCEI             TO PB-FORCE-CODE.
 15259
 15260     IF CBILCDL     GREATER THAN ZEROS
 15261        MOVE CBILCDI             TO PB-RECORD-BILL.
 15262
 15263*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15264
 15265 2260-WRITE-PB-RECORD.
 15266     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15267                                    PB-INPUT-BY.
 15268     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15269     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15270                                    PB-INPUT-DT.
 15271
 15272     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15273     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15274                                    PB-CONTROL-BY-ORIG-BATCH.
 15275
 15276     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15277     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15278     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15279     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15280     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15281
 15282     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15283
 15284     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15285
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 278
* EL6311.cbl
 15286     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15287     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15288     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15289
 15290     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15291     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15292
 15293 2275-WRITE-PENDING-BUSINESS.
 15294     MOVE 'A'                    TO JP-RECORD-TYPE.
 15295     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15296     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15297     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15298
 15299
 15300* EXEC CICS HANDLE CONDITION
 15301*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15302*    END-EXEC.
 15303*    MOVE '"$%                   ! 4 #00013762' TO DFHEIV0
 15304     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15306     MOVE X'3420233030303133373632' TO DFHEIV0(25:11)
 15307     CALL 'kxdfhei1' USING DFHEIV0
 15308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15309
 15310
 15311
 15312* EXEC CICS WRITE
 15313*        DATASET (FILE-ID-ERPNDB)
 15314*        FROM    (PENDING-BUSINESS)
 15315*        RIDFLD  (PB-CONTROL-PRIMARY)
 15316*    END-EXEC.
 15317     MOVE LENGTH OF
 15318      PENDING-BUSINESS
 15319       TO DFHEIV11
 15320*    MOVE '&$ L                  ''   #00013766' TO DFHEIV0
 15321     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15323     MOVE X'2020233030303133373636' TO DFHEIV0(25:11)
 15324     CALL 'kxdfhei1' USING DFHEIV0,
 15325           FILE-ID-ERPNDB,
 15326           PENDING-BUSINESS,
 15327           DFHEIV11,
 15328           PB-CONTROL-PRIMARY,
 15329           DFHEIV99,
 15330           DFHEIV99
 15331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15332
 15333
 15334     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15335
 15336     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15337
 15338******************************************************************
 15339*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15340******************************************************************
 15341
 15342     display ' made it to add orig CANCEL cert '
 15343     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 279
* EL6311.cbl
 15344     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15345     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15346     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15347
 15348
 15349* EXEC CICS READ
 15350*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15351*        DATASET (FILE-ID-ELCERT)
 15352*        RIDFLD  (ELCERT-KEY)
 15353*        RESP    (WS-RESPONSE)
 15354*    END-EXEC.
 15355*    MOVE '&"S        E          (  N#00013786' TO DFHEIV0
 15356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15358     MOVE X'204E233030303133373836' TO DFHEIV0(25:11)
 15359     CALL 'kxdfhei1' USING DFHEIV0,
 15360           FILE-ID-ELCERT,
 15361           DFHEIV20,
 15362           DFHEIV99,
 15363           ELCERT-KEY,
 15364           DFHEIV99,
 15365           DFHEIV99,
 15366           DFHEIV99
 15367     SET ADDRESS OF CERTIFICATE-MASTER TO
 15368         DFHEIV20
 15369     MOVE EIBRESP  TO WS-RESPONSE
 15370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15371
 15372
 15373     IF NOT RESP-NORMAL
 15374        GO TO 2276-BYPASS-CRTO
 15375     END-IF
 15376
 15377     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15378     MOVE ' '                    TO WS-ERMAIL-SW
 15379
 15380
 15381* EXEC CICS READ
 15382*       DATASET   (FILE-ID-ERMAIL)
 15383*       SET       (ADDRESS OF MAILING-DATA)
 15384*       RIDFLD    (ERMAIL-KEY)
 15385*       RESP      (WS-RESPONSE)
 15386*    END-EXEC
 15387*    MOVE '&"S        E          (  N#00013800' TO DFHEIV0
 15388     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15390     MOVE X'204E233030303133383030' TO DFHEIV0(25:11)
 15391     CALL 'kxdfhei1' USING DFHEIV0,
 15392           FILE-ID-ERMAIL,
 15393           DFHEIV20,
 15394           DFHEIV99,
 15395           ERMAIL-KEY,
 15396           DFHEIV99,
 15397           DFHEIV99,
 15398           DFHEIV99
 15399     SET ADDRESS OF MAILING-DATA TO
 15400         DFHEIV20
 15401     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 280
* EL6311.cbl
 15402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15403
 15404     IF RESP-NORMAL
 15405        SET ERMAIL-FOUND TO TRUE
 15406     END-IF
 15407
 15408     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15409
 15410     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15411     MOVE 'OC'                   TO OC-RECORD-ID
 15412     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15413                                 TO OC-CONTROL-PRIMARY (1:33)
 15414     MOVE 'I'                    TO OC-RECORD-TYPE
 15415     MOVE +4096                  TO OC-KEY-SEQ-NO
 15416     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15417     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15418     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15419
 15420     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15421     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15422     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15423     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15424     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15425     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15426     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15427     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15428     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15429     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15430     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15431     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15432     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15433     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15434     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15435     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15436     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15437     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15438     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15439     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15440     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15441     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15442     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15443     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15444     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15445     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15446     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15447     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15448     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15449     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15450     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15451     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15452
 15453     IF ERMAIL-FOUND
 15454        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15455     END-IF
 15456     IF NOT CERT-TRL-REC-NOT-FOUND
 15457        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15458                           OC-INS-AGE-DEFAULT-FLAG
 15459        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 281
* EL6311.cbl
 15460                           OC-JNT-AGE-DEFAULT-FLAG
 15461     END-IF
 15462     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15463     .
 15464 2275-WRITE-ELCRTO.
 15465
 15466
 15467* EXEC CICS WRITE
 15468*       DATASET   ('ELCRTO')
 15469*       FROM      (ORIGINAL-CERTIFICATE)
 15470*       RIDFLD    (OC-CONTROL-PRIMARY)
 15471*       RESP      (WS-RESPONSE)
 15472*    END-EXEC
 15473     MOVE LENGTH OF
 15474      ORIGINAL-CERTIFICATE
 15475       TO DFHEIV11
 15476     MOVE 'ELCRTO' TO DFHEIV1
 15477*    MOVE '&$ L                  ''  N#00013869' TO DFHEIV0
 15478     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15480     MOVE X'204E233030303133383639' TO DFHEIV0(25:11)
 15481     CALL 'kxdfhei1' USING DFHEIV0,
 15482           DFHEIV1,
 15483           ORIGINAL-CERTIFICATE,
 15484           DFHEIV11,
 15485           OC-CONTROL-PRIMARY,
 15486           DFHEIV99,
 15487           DFHEIV99
 15488     MOVE EIBRESP  TO WS-RESPONSE
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15490
 15491     display ' just wrote 2275 ' ws-response
 15492     IF RESP-DUPKEY
 15493        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15494        GO TO 2275-WRITE-ELCRTO
 15495     ELSE
 15496        IF NOT RESP-NORMAL
 15497           MOVE -1               TO BMAINTL
 15498           MOVE ER-7450          TO EMI-ERROR
 15499           PERFORM 9900-ERROR-FORMAT
 15500                                 THRU 9900-EXIT
 15501           GO TO 8200-SEND-DATAONLY
 15502        END-IF
 15503     END-IF.
 15504
 15505 2276-BYPASS-CRTO.
 15506******************************************************************
 15507*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15508******************************************************************
 15509
 15510
 15511* EXEC CICS READ
 15512*        INTO    (PENDING-BUSINESS)
 15513*        DATASET (FILE-ID-ERPNDB)
 15514*        RIDFLD  (ERPNDB-KEY)
 15515*        UPDATE
 15516*    END-EXEC.
 15517     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 282
* EL6311.cbl
 15518      PENDING-BUSINESS
 15519       TO DFHEIV11
 15520*    MOVE '&"IL       EU         (   #00013895' TO DFHEIV0
 15521     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15522     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15523     MOVE X'2020233030303133383935' TO DFHEIV0(25:11)
 15524     CALL 'kxdfhei1' USING DFHEIV0,
 15525           FILE-ID-ERPNDB,
 15526           PENDING-BUSINESS,
 15527           DFHEIV11,
 15528           ERPNDB-KEY,
 15529           DFHEIV99,
 15530           DFHEIV99,
 15531           DFHEIV99
 15532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15533
 15534
 15535     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15536     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15537     MOVE 'B'                    TO JP-RECORD-TYPE.
 15538     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15539
 15540     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15541
 15542     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15543
 15544
 15545* EXEC CICS REWRITE
 15546*        DATASET (FILE-ID-ERPNDB)
 15547*        FROM    (PENDING-BUSINESS)
 15548*    END-EXEC.
 15549     MOVE LENGTH OF
 15550      PENDING-BUSINESS
 15551       TO DFHEIV11
 15552*    MOVE '&& L                  %   #00013911' TO DFHEIV0
 15553     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15554     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15555     MOVE X'2020233030303133393131' TO DFHEIV0(25:11)
 15556     CALL 'kxdfhei1' USING DFHEIV0,
 15557           FILE-ID-ERPNDB,
 15558           PENDING-BUSINESS,
 15559           DFHEIV11,
 15560           DFHEIV99
 15561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15562
 15563
 15564     MOVE 'C'                    TO JP-RECORD-TYPE.
 15565     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15566
 15567     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15568
 15569     IF WS-ERRORS-PRESENT
 15570        GO TO 3900-RE-DISPLAY-RECORD.
 15571
 15572     MOVE ZEROS                  TO EMI-ERROR.
 15573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15574     MOVE LOW-VALUES             TO EL631CI.
 15575     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 283
* EL6311.cbl
 15576     GO TO 8100-SEND-INITIAL-MAP.
 15577
 15578 2280-BATCH-HDR-NOT-FOUND.
 15579     MOVE -1                     TO BMAINTL.
 15580     MOVE ER-7450                TO EMI-ERROR.
 15581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15582     GO TO 8200-SEND-DATAONLY.
 15583
 15584 2290-DUPLICATE-ALT-INDEX.
 15585
 15586******************************************************************
 15587*                                                                *
 15588*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15589*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15590*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15591*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15592*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15593*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15594*                                                                *
 15595******************************************************************
 15596
 15597     IF LCP-ONCTR-02 =  0
 15598         ADD 1 TO LCP-ONCTR-02
 15599        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15600
 15601     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15602
 15603     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15604         NEXT SENTENCE
 15605     ELSE
 15606         ADD +1 TO PB-BATCH-SEQ-NO
 15607                   PB-CSR-BATCH-SEQ-NO
 15608         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15609         GO TO 2275-WRITE-PENDING-BUSINESS.
 15610
 15611     MOVE -1                     TO CCERTNOL.
 15612     MOVE AL-UABON               TO CCERTNOA.
 15613     MOVE AL-UNBON               TO CEFFDTA.
 15614
 15615     MOVE 1                      TO EMI-SUB
 15616                                    EMI-SWITCH1
 15617                                    EMI-SWITCH-AREA-1
 15618                                    EMI-SWITCH-AREA-2.
 15619
 15620     MOVE SPACES                 TO EMI-ERROR-LINES.
 15621
 15622
 15623* EXEC CICS SYNCPOINT ROLLBACK
 15624*    END-EXEC.
 15625*    MOVE '6"R                   !   #00013974' TO DFHEIV0
 15626     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15628     MOVE X'2020233030303133393734' TO DFHEIV0(25:11)
 15629     CALL 'kxdfhei1' USING DFHEIV0
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15631
 15632
 15633     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 284
* EL6311.cbl
 15634     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15635     GO TO 8200-SEND-DATAONLY.
 15636
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 285
* EL6311.cbl
 15638
 15639******************************************************************
 15640*                                                                *
 15641*          C H A N G E   C A N C E L   R O U T I N E             *
 15642*                                                                *
 15643******************************************************************
 15644
 15645***************************************************************
 15646*                                                             *
 15647*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15648*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15649*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15650*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15651*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15652*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15653*     5. LINK TO THE EDIT ROUTINE.                            *
 15654*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15655*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15656*              THE EDIT ROUTINE.                              *
 15657*     7. REWRITE THE NEW ISSUE                                *
 15658*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15659*                                                             *
 15660***************************************************************
 15661 2300-CHANGE-CANCEL-ROUTINE.
 15662     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15663
 15664     IF CCHGL NOT = ZEROS
 15665        MOVE ER-2196             TO EMI-ERROR
 15666        MOVE AL-UABON            TO CMAINTA
 15667        MOVE -1                  TO CMAINTL
 15668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15669        GO TO 8200-SEND-DATAONLY.
 15670
 15671     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15672
 15673     IF CSUFIXL NOT = ZEROS
 15674        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15675     ELSE
 15676        MOVE SPACE               TO WS-NEW-SUFFIX.
 15677
 15678     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15679     PERFORM 8600-DEEDIT.
 15680     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15681     MOVE '4'                    TO DC-OPTION-CODE.
 15682
 15683     PERFORM 9700-DATE-LINK.
 15684
 15685     IF DATE-CONVERSION-ERROR
 15686        MOVE ER-0348             TO EMI-ERROR
 15687        MOVE -1                  TO CEFFDTL
 15688        MOVE AL-UABON            TO CEFFDTA
 15689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15690        GO TO 8200-SEND-DATAONLY
 15691     ELSE
 15692        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15693        MOVE AL-UANON            TO CEFFDTA
 15694        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15695
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 286
* EL6311.cbl
 15696 2325-PROCESS-CANCEL-CHANGES.
 15697
 15698* EXEC CICS HANDLE CONDITION
 15699*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15700*    END-EXEC.
 15701*    MOVE '"$I                   ! 5 #00014041' TO DFHEIV0
 15702     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15704     MOVE X'3520233030303134303431' TO DFHEIV0(25:11)
 15705     CALL 'kxdfhei1' USING DFHEIV0
 15706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15707
 15708
 15709     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15710     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15711     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15712
 15713
 15714* EXEC CICS GETMAIN
 15715*        SET      (ADDRESS OF PENDING-BUSINESS)
 15716*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15717*        INITIMG  (GETMAIN-SPACE)
 15718*     END-EXEC.
 15719*    MOVE ',"IL                  $   #00014049' TO DFHEIV0
 15720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134303439' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           DFHEIV20,
 15725           ERPNDB-RECORD-LENGTH,
 15726           GETMAIN-SPACE
 15727     SET ADDRESS OF PENDING-BUSINESS TO
 15728         DFHEIV20
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732
 15733* EXEC CICS READ
 15734*        INTO    (PENDING-BUSINESS)
 15735*        DATASET (FILE-ID-ERPNDB)
 15736*        RIDFLD  (ERPNDB-KEY)
 15737*    END-EXEC.
 15738     MOVE LENGTH OF
 15739      PENDING-BUSINESS
 15740       TO DFHEIV11
 15741*    MOVE '&"IL       E          (   #00014055' TO DFHEIV0
 15742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15744     MOVE X'2020233030303134303535' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0,
 15746           FILE-ID-ERPNDB,
 15747           PENDING-BUSINESS,
 15748           DFHEIV11,
 15749           ERPNDB-KEY,
 15750           DFHEIV99,
 15751           DFHEIV99,
 15752           DFHEIV99
 15753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 287
* EL6311.cbl
 15754
 15755
 15756     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15757
 15758
 15759* EXEC CICS HANDLE CONDITION
 15760*         NOTFND     (2385-REC-NOT-FOUND)
 15761*    END-EXEC.
 15762*    MOVE '"$I                   ! 6 #00014063' TO DFHEIV0
 15763     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15765     MOVE X'3620233030303134303633' TO DFHEIV0(25:11)
 15766     CALL 'kxdfhei1' USING DFHEIV0
 15767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15768
 15769
 15770**********************************************************
 15771*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15772*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15773**********************************************************
 15774
 15775
 15776* EXEC CICS READ
 15777*        DATASET (FILE-ID-ERPNDB)
 15778*        INTO    (PENDING-BUSINESS)
 15779*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15780*    END-EXEC.
 15781     MOVE LENGTH OF
 15782      PENDING-BUSINESS
 15783       TO DFHEIV11
 15784*    MOVE '&"IL       E          (   #00014072' TO DFHEIV0
 15785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15787     MOVE X'2020233030303134303732' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0,
 15789           FILE-ID-ERPNDB,
 15790           PENDING-BUSINESS,
 15791           DFHEIV11,
 15792           PI-PREV-CONTROL-PRIMARY,
 15793           DFHEIV99,
 15794           DFHEIV99,
 15795           DFHEIV99
 15796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15797
 15798
 15799********** DO NOT ALLOW CHANGES IF THRU A/R
 15800     IF BMAINTI = 'C'
 15801         IF PB-EL860-INTERNAL-PROCESS
 15802             MOVE ER-4005          TO EMI-ERROR
 15803             MOVE -1               TO BMAINTL
 15804             MOVE AL-UABON         TO BMAINTA
 15805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15806             GO TO 8200-SEND-DATAONLY.
 15807**********
 15808
 15809     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15810        MOVE -1                 TO CMAINTL
 15811        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 288
* EL6311.cbl
 15812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15813        GO TO 8200-SEND-DATAONLY.
 15814
 15815     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15816        MOVE ER-2196             TO EMI-ERROR
 15817        MOVE AL-UABON            TO CMAINTA
 15818        MOVE -1                  TO CMAINTL
 15819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15820        GO TO 8200-SEND-DATAONLY.
 15821     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15822
 15823     IF PB-BILLED-DT = LOW-VALUES AND
 15824        PB-CHG-COUNT = ZEROS
 15825        NEXT SENTENCE
 15826     ELSE
 15827        IF (CREFND1L GREATER THAN ZEROS AND
 15828            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15829           OR
 15830           (CREFND2L GREATER THAN ZEROS AND
 15831            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15832           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15833     if ((crefnd1l <> zeros)
 15834        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15835                      or
 15836        ((crefnd2l <> zeros)
 15837        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15838        continue
 15839     else
 15840        go to 2330-continue-change
 15841     end-if
 15842
 15843     move zeros                  to ws-check-amts
 15844     move ' '                    to ws-stop-sw
 15845                                    ws-check-sw
 15846                                    ws-any-check-sw
 15847                                    ws-proc-check-sw
 15848                                    ws-chek-browse-sw
 15849
 15850     perform 2500-browse-checks  thru 2500-exit
 15851
 15852     if i-have-processed-checks
 15853        or i-have-checks
 15854        continue
 15855     else
 15856        go to 2330-continue-change
 15857     end-if
 15858
 15859     if crefnd1l <> zeros
 15860        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15861        move ws-crefnd1 to ws-new-ref-total
 15862     else
 15863        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15864     end-if
 15865     if crefnd2l <> zeros
 15866        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15867        compute ws-new-ref-total = ws-new-ref-total +
 15868           ws-crefnd2
 15869     else
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 289
* EL6311.cbl
 15870        compute ws-new-ref-total = ws-new-ref-total +
 15871           pb-c-ah-cancel-amt
 15872     end-if
 15873
 15874     if zeros = (ws-lf-diff + ws-ah-diff)
 15875        move er-3449             to emi-error
 15876        perform 9900-error-format thru 9900-exit
 15877        go to 2330-continue-change
 15878     end-if
 15879
 15880     if (ws-new-ref-total < ws-check-amts)
 15881        and (pb-c-refund-sw = 'Y')
 15882        move er-3447             to emi-error
 15883        perform 9900-error-format thru 9900-exit
 15884        move al-uabon            to cmainta
 15885        move -1                  to cmaintl
 15886        go to 8200-send-dataonly
 15887     end-if
 15888
 15889     if (ws-new-ref-total > ws-check-amts)
 15890        and (ws-check-amts not = zeros)
 15891        move er-3448             to emi-error
 15892        move al-uabon            to crefnd1a
 15893                                    crefnd2a
 15894        perform 9900-error-format thru 9900-exit
 15895     end-if
 15896
 15897*     if (ws-lf-diff + ws-ah-diff) < zeros
 15898*        move er-3447             to emi-error
 15899*        perform 9900-error-format thru 9900-exit
 15900*        move al-uabon            to cmainta
 15901*        move -1                  to cmaintl
 15902*        go to 8200-send-dataonly
 15903*     end-if
 15904     .
 15905 2330-continue-change.
 15906
 15907
 15908* EXEC CICS READ
 15909*        DATASET (FILE-ID-ERPNDB)
 15910*        INTO    (PENDING-BUSINESS)
 15911*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15912*        UPDATE
 15913*    END-EXEC.
 15914     MOVE LENGTH OF
 15915      PENDING-BUSINESS
 15916       TO DFHEIV11
 15917*    MOVE '&"IL       EU         (   #00014186' TO DFHEIV0
 15918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15920     MOVE X'2020233030303134313836' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0,
 15922           FILE-ID-ERPNDB,
 15923           PENDING-BUSINESS,
 15924           DFHEIV11,
 15925           PI-PREV-CONTROL-PRIMARY,
 15926           DFHEIV99,
 15927           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 290
* EL6311.cbl
 15928           DFHEIV99
 15929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15930
 15931
 15932     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15933     MOVE 'B'                    TO JP-RECORD-TYPE
 15934     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15935     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15936
 15937*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15938
 15939     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15940          PB-CHG-COUNT NOT = ZEROS
 15941        IF (CREFND1L GREATER THAN ZEROS AND
 15942            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15943           OR
 15944           (CREFND2L GREATER THAN ZEROS AND
 15945            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15946            ADD +1                      TO PB-CHG-COUNT
 15947            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15948
 15949*    IF CMICRNOL  GREATER  ZEROS
 15950*        IF CMICRNOI  NUMERIC
 15951*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15952*            MOVE AL-UNNON       TO  CMICRNOA
 15953*        ELSE
 15954*            MOVE -1             TO  CMICRNOL
 15955*            MOVE AL-UNBON       TO  CMICRNOA
 15956*            MOVE ER-2701        TO  EMI-ERROR
 15957*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15958
 15959     IF CSUFIXL GREATER THAN ZEROS
 15960        MOVE CSUFIXI             TO PB-CERT-SFX.
 15961
 15962     IF CLSTNML GREATER THAN ZEROS
 15963         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15964
 15965     IF CCANREAL > ZEROS
 15966        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15967     END-IF
 15968     IF CCANDT1L    GREATER THAN ZEROS
 15969        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15970
 15971     IF CCANDT2L    GREATER THAN ZEROS
 15972        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15973
 15974     IF CMTHD1L    GREATER THAN +0
 15975        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15976
 15977     IF CMTHD2L    GREATER THAN +0
 15978        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15979
 15980     IF CREFND1L    GREATER THAN ZEROS
 15981        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15982        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15983        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15984        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15985
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 291
* EL6311.cbl
 15986     IF CREFND2L    GREATER THAN ZEROS
 15987        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15988        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15989        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15990        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15991
 15992     IF CLIVESL     GREATER THAN ZEROS
 15993        MOVE WS-CLIVES           TO PB-C-LIVES.
 15994
 15995     IF CPAYEEL     GREATER THAN ZEROS
 15996        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15997
 15998     IF CFORCEL     GREATER THAN ZEROS
 15999        MOVE CFORCEI             TO PB-FORCE-CODE.
 16000
 16001     IF CBILCDL     GREATER THAN ZEROS
 16002        MOVE CBILCDI             TO PB-RECORD-BILL.
 16003
 16004 2360-REWRITE-PB-RECORD.
 16005     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16006     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16007     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 16008*    MOVE 'C'                    TO JP-RECORD-TYPE.
 16009*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16010     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16011*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16012
 16013     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16014
 16015     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 16016     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 16017
 16018     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 16019
 16020     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 16021
 16022     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 16023     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 16024     MOVE PB-SV-STATE            TO PI-SV-STATE.
 16025
 16026     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 16027     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 16028
 16029 2375-REWRITE-PENDING-BUSINESS.
 16030     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 16031     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16032     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16033     MOVE 'C'                    TO JP-RECORD-TYPE.
 16034     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16035
 16036
 16037* EXEC CICS REWRITE
 16038*        DATASET (FILE-ID-ERPNDB)
 16039*        FROM    (PENDING-BUSINESS)
 16040*    END-EXEC.
 16041     MOVE LENGTH OF
 16042      PENDING-BUSINESS
 16043       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 292
* EL6311.cbl
 16044*    MOVE '&& L                  %   #00014297' TO DFHEIV0
 16045     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16046     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16047     MOVE X'2020233030303134323937' TO DFHEIV0(25:11)
 16048     CALL 'kxdfhei1' USING DFHEIV0,
 16049           FILE-ID-ERPNDB,
 16050           PENDING-BUSINESS,
 16051           DFHEIV11,
 16052           DFHEIV99
 16053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16054
 16055
 16056     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16057
 16058******************************************************************
 16059*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16060******************************************************************
 16061
 16062     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16063     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16064     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16065     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16066
 16067
 16068* EXEC CICS READ
 16069*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16070*        DATASET (FILE-ID-ELCERT)
 16071*        RIDFLD  (ELCERT-KEY)
 16072*        RESP    (WS-RESPONSE)
 16073*    END-EXEC.
 16074*    MOVE '&"S        E          (  N#00014313' TO DFHEIV0
 16075     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16077     MOVE X'204E233030303134333133' TO DFHEIV0(25:11)
 16078     CALL 'kxdfhei1' USING DFHEIV0,
 16079           FILE-ID-ELCERT,
 16080           DFHEIV20,
 16081           DFHEIV99,
 16082           ELCERT-KEY,
 16083           DFHEIV99,
 16084           DFHEIV99,
 16085           DFHEIV99
 16086     SET ADDRESS OF CERTIFICATE-MASTER TO
 16087         DFHEIV20
 16088     MOVE EIBRESP  TO WS-RESPONSE
 16089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16090
 16091
 16092     IF NOT RESP-NORMAL
 16093        GO TO 2376-BYPASS-CRTO
 16094     END-IF
 16095
 16096
 16097     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16098     MOVE ' '                    TO WS-ERMAIL-SW
 16099
 16100
 16101* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 293
* EL6311.cbl
 16102*       DATASET   (FILE-ID-ERMAIL)
 16103*       SET       (ADDRESS OF MAILING-DATA)
 16104*       RIDFLD    (ERMAIL-KEY)
 16105*       RESP      (WS-RESPONSE)
 16106*    END-EXEC
 16107*    MOVE '&"S        E          (  N#00014328' TO DFHEIV0
 16108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16110     MOVE X'204E233030303134333238' TO DFHEIV0(25:11)
 16111     CALL 'kxdfhei1' USING DFHEIV0,
 16112           FILE-ID-ERMAIL,
 16113           DFHEIV20,
 16114           DFHEIV99,
 16115           ERMAIL-KEY,
 16116           DFHEIV99,
 16117           DFHEIV99,
 16118           DFHEIV99
 16119     SET ADDRESS OF MAILING-DATA TO
 16120         DFHEIV20
 16121     MOVE EIBRESP  TO WS-RESPONSE
 16122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16123
 16124     IF RESP-NORMAL
 16125        SET ERMAIL-FOUND TO TRUE
 16126     END-IF
 16127
 16128     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16129
 16130     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16131                                 TO ELCRTO-KEY
 16132     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16133     MOVE +0                     TO ELCRTO-SEQ-NO
 16134
 16135
 16136* EXEC CICS READ
 16137*       DATASET   ('ELCRTO')
 16138*       INTO      (ORIGINAL-CERTIFICATE)
 16139*       RIDFLD    (ELCRTO-KEY)
 16140*       GTEQ
 16141*       RESP      (WS-RESPONSE)
 16142*    END-EXEC
 16143     MOVE LENGTH OF
 16144      ORIGINAL-CERTIFICATE
 16145       TO DFHEIV11
 16146     MOVE 'ELCRTO' TO DFHEIV1
 16147*    MOVE '&"IL       G          (  N#00014346' TO DFHEIV0
 16148     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16150     MOVE X'204E233030303134333436' TO DFHEIV0(25:11)
 16151     CALL 'kxdfhei1' USING DFHEIV0,
 16152           DFHEIV1,
 16153           ORIGINAL-CERTIFICATE,
 16154           DFHEIV11,
 16155           ELCRTO-KEY,
 16156           DFHEIV99,
 16157           DFHEIV99,
 16158           DFHEIV99
 16159     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 294
* EL6311.cbl
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16161
 16162     IF RESP-NORMAL
 16163        AND (OC-CONTROL-PRIMARY (1:33) =
 16164                 PB-CONTROL-BY-ACCOUNT (1:33))
 16165        AND (OC-RECORD-TYPE = 'I')
 16166        display ' resp norm, key =, type i '
 16167        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16168           display ' end proc blank '
 16169           display ' csr edit session ' PI-CSR-SESSION-SW
 16170           IF NOT CSR-EDIT-SESSION
 16171
 16172* EXEC CICS READ
 16173*                DATASET   ('ELCRTO')
 16174*                INTO      (ORIGINAL-CERTIFICATE)
 16175*                RIDFLD    (OC-CONTROL-PRIMARY)
 16176*                UPDATE
 16177*                RESP      (WS-RESPONSE)
 16178*             END-EXEC
 16179     MOVE LENGTH OF
 16180      ORIGINAL-CERTIFICATE
 16181       TO DFHEIV11
 16182     MOVE 'ELCRTO' TO DFHEIV1
 16183*    MOVE '&"IL       EU         (  N#00014363' TO DFHEIV0
 16184     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16185     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16186     MOVE X'204E233030303134333633' TO DFHEIV0(25:11)
 16187     CALL 'kxdfhei1' USING DFHEIV0,
 16188           DFHEIV1,
 16189           ORIGINAL-CERTIFICATE,
 16190           DFHEIV11,
 16191           OC-CONTROL-PRIMARY,
 16192           DFHEIV99,
 16193           DFHEIV99,
 16194           DFHEIV99
 16195     MOVE EIBRESP  TO WS-RESPONSE
 16196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16197              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16198              IF RESP-NORMAL
 16199                 display ' good read upd '
 16200                 IF OC-ISSUE-TRAN-IND = 'N'
 16201                    MOVE CM-INSURED-LAST-NAME   TO
 16202                         OC-INS-LAST-NAME
 16203                    MOVE CM-INSURED-FIRST-NAME  TO
 16204                         OC-INS-FIRST-NAME
 16205                    MOVE CM-INSURED-INITIAL2    TO
 16206                         OC-INS-MIDDLE-INIT
 16207                    MOVE CM-INSURED-ISSUE-AGE   TO
 16208                         OC-INS-AGE
 16209                    MOVE CM-JT-LAST-NAME        TO
 16210                         OC-JNT-LAST-NAME
 16211                    MOVE CM-JT-FIRST-NAME       TO
 16212                         OC-JNT-FIRST-NAME
 16213                    MOVE CM-JT-INITIAL          TO
 16214                         OC-JNT-MIDDLE-INIT
 16215                    MOVE CM-INSURED-JOINT-AGE   TO
 16216                         OC-JNT-AGE
 16217                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 295
* EL6311.cbl
 16218                         OC-LF-BENCD
 16219                    MOVE CM-LF-ORIG-TERM        TO
 16220                         OC-LF-TERM
 16221                    MOVE CM-LF-BENEFIT-AMT      TO
 16222                         OC-LF-BEN-AMT
 16223                    MOVE CM-LF-PREMIUM-AMT      TO
 16224                         OC-LF-PRM-AMT
 16225                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16226                         OC-LF-ALT-BEN-AMT
 16227                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16228                         OC-LF-ALT-PRM-AMT
 16229                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16230                         OC-LF-EXP-DT
 16231                    MOVE CM-LIFE-COMM-PCT       TO
 16232                         OC-LF-COMM-PCT
 16233                    MOVE CM-AH-BENEFIT-CD       TO
 16234                         OC-AH-BENCD
 16235                    MOVE CM-AH-ORIG-TERM        TO
 16236                         OC-AH-TERM
 16237                    MOVE CM-AH-BENEFIT-AMT      TO
 16238                         OC-AH-BEN-AMT
 16239                    MOVE CM-AH-PREMIUM-AMT      TO
 16240                         OC-AH-PRM-AMT
 16241                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16242                         OC-AH-EXP-DT
 16243                    MOVE CM-AH-COMM-PCT         TO
 16244                         OC-AH-COMM-PCT
 16245                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16246                         OC-AH-CP
 16247                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16248                         OC-1ST-PMT-DT
 16249                 END-IF
 16250                 MOVE PB-C-LF-CANCEL-DT      TO
 16251                         OC-LF-CANCEL-DT
 16252                 MOVE PB-C-LF-CANCEL-AMT     TO
 16253                         OC-LF-CANCEL-AMT
 16254                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16255                         OC-LF-ITD-CANCEL-AMT
 16256                 MOVE PB-C-AH-CANCEL-DT      TO
 16257                         OC-AH-CANCEL-DT
 16258                 MOVE PB-C-AH-CANCEL-AMT     TO
 16259                         OC-AH-CANCEL-AMT
 16260                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16261                         OC-AH-ITD-CANCEL-AMT
 16262                 MOVE 'Y'                    TO
 16263                         OC-CANCEL-TRAN-IND
 16264                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16265                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16266                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16267                 IF ERMAIL-FOUND
 16268                    MOVE MA-CRED-BENE-NAME
 16269                                 TO OC-CRED-BENE-NAME
 16270                 END-IF
 16271                 IF NOT CERT-TRL-REC-NOT-FOUND
 16272                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16273                           OC-INS-AGE-DEFAULT-FLAG
 16274                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16275                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 296
* EL6311.cbl
 16276                 END-IF
 16277
 16278* EXEC CICS REWRITE
 16279*                   DATASET   ('ELCRTO')
 16280*                   FROM      (ORIGINAL-CERTIFICATE)
 16281*                   RESP      (WS-RESPONSE)
 16282*                END-EXEC
 16283     MOVE LENGTH OF
 16284      ORIGINAL-CERTIFICATE
 16285       TO DFHEIV11
 16286     MOVE 'ELCRTO' TO DFHEIV1
 16287*    MOVE '&& L                  %  N#00014450' TO DFHEIV0
 16288     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16289     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16290     MOVE X'204E233030303134343530' TO DFHEIV0(25:11)
 16291     CALL 'kxdfhei1' USING DFHEIV0,
 16292           DFHEIV1,
 16293           ORIGINAL-CERTIFICATE,
 16294           DFHEIV11,
 16295           DFHEIV99
 16296     MOVE EIBRESP  TO WS-RESPONSE
 16297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16298                 display ' just rewrote ' ws-response
 16299              END-IF
 16300           END-IF
 16301        ELSE
 16302           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16303           MOVE 'OC'             TO OC-RECORD-ID
 16304           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16305           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16306           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16307           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16308           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16309           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16310           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16311           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16312           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16313           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16314           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16315           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16316           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16317           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16318           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16319           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16320           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16321           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16322           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16323           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16324           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16325           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16326           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16327           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16328           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16329           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16330           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16331           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16332           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16333           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 297
* EL6311.cbl
 16334           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16335           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16336           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16337           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16338           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16339           IF ERMAIL-FOUND
 16340              MOVE MA-CRED-BENE-NAME
 16341                                 TO OC-CRED-BENE-NAME
 16342           END-IF
 16343           IF NOT CERT-TRL-REC-NOT-FOUND
 16344              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16345                           OC-INS-AGE-DEFAULT-FLAG
 16346              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16347                           OC-JNT-AGE-DEFAULT-FLAG
 16348           END-IF
 16349           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16350
 16351* EXEC CICS WRITE
 16352*             DATASET   ('ELCRTO')
 16353*             FROM      (ORIGINAL-CERTIFICATE)
 16354*             RIDFLD    (OC-CONTROL-PRIMARY)
 16355*             RESP      (WS-RESPONSE)
 16356*          END-EXEC
 16357     MOVE LENGTH OF
 16358      ORIGINAL-CERTIFICATE
 16359       TO DFHEIV11
 16360     MOVE 'ELCRTO' TO DFHEIV1
 16361*    MOVE '&$ L                  ''  N#00014507' TO DFHEIV0
 16362     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16363     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16364     MOVE X'204E233030303134353037' TO DFHEIV0(25:11)
 16365     CALL 'kxdfhei1' USING DFHEIV0,
 16366           DFHEIV1,
 16367           ORIGINAL-CERTIFICATE,
 16368           DFHEIV11,
 16369           OC-CONTROL-PRIMARY,
 16370           DFHEIV99,
 16371           DFHEIV99
 16372     MOVE EIBRESP  TO WS-RESPONSE
 16373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16374        END-IF
 16375     ELSE
 16376        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16377        MOVE 'OC'                TO OC-RECORD-ID
 16378        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16379                                 TO OC-CONTROL-PRIMARY (1:33)
 16380        MOVE 'I'                 TO OC-RECORD-TYPE
 16381        MOVE +4096               TO OC-KEY-SEQ-NO
 16382        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16383        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16384        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16385        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16386        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16387        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16388        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16389        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16390        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16391        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 298
* EL6311.cbl
 16392        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16393        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16394        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16395        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16396        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16397        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16398        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16399        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16400        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16401        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16402        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16403        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16404        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16405        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16406        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16407        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16408        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16409        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16410        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16411        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16412        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16413        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16414        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16415        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16416        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16417        IF ERMAIL-FOUND
 16418           MOVE MA-CRED-BENE-NAME
 16419                                 TO OC-CRED-BENE-NAME
 16420        END-IF
 16421        IF NOT CERT-TRL-REC-NOT-FOUND
 16422           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16423                           OC-INS-AGE-DEFAULT-FLAG
 16424           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16425                           OC-JNT-AGE-DEFAULT-FLAG
 16426        END-IF
 16427        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16428
 16429
 16430* EXEC CICS WRITE
 16431*          DATASET   ('ELCRTO')
 16432*          FROM      (ORIGINAL-CERTIFICATE)
 16433*          RIDFLD    (OC-CONTROL-PRIMARY)
 16434*          RESP      (WS-RESPONSE)
 16435*       END-EXEC
 16436     MOVE LENGTH OF
 16437      ORIGINAL-CERTIFICATE
 16438       TO DFHEIV11
 16439     MOVE 'ELCRTO' TO DFHEIV1
 16440*    MOVE '&$ L                  ''  N#00014568' TO DFHEIV0
 16441     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16443     MOVE X'204E233030303134353638' TO DFHEIV0(25:11)
 16444     CALL 'kxdfhei1' USING DFHEIV0,
 16445           DFHEIV1,
 16446           ORIGINAL-CERTIFICATE,
 16447           DFHEIV11,
 16448           OC-CONTROL-PRIMARY,
 16449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 299
* EL6311.cbl
 16450           DFHEIV99
 16451     MOVE EIBRESP  TO WS-RESPONSE
 16452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16453     END-IF.
 16454
 16455 2376-BYPASS-CRTO.
 16456******************************************************************
 16457*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16458******************************************************************
 16459
 16460
 16461* EXEC CICS HANDLE CONDITION
 16462*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16463*    END-EXEC.
 16464*    MOVE '"$I                   ! 7 #00014581' TO DFHEIV0
 16465     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16467     MOVE X'3720233030303134353831' TO DFHEIV0(25:11)
 16468     CALL 'kxdfhei1' USING DFHEIV0
 16469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16470
 16471
 16472
 16473* EXEC CICS READ
 16474*        INTO    (PENDING-BUSINESS)
 16475*        DATASET (FILE-ID-ERPNDB)
 16476*        RIDFLD  (ERPNDB-KEY)
 16477*        UPDATE
 16478*    END-EXEC.
 16479     MOVE LENGTH OF
 16480      PENDING-BUSINESS
 16481       TO DFHEIV11
 16482*    MOVE '&"IL       EU         (   #00014585' TO DFHEIV0
 16483     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16484     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16485     MOVE X'2020233030303134353835' TO DFHEIV0(25:11)
 16486     CALL 'kxdfhei1' USING DFHEIV0,
 16487           FILE-ID-ERPNDB,
 16488           PENDING-BUSINESS,
 16489           DFHEIV11,
 16490           ERPNDB-KEY,
 16491           DFHEIV99,
 16492           DFHEIV99,
 16493           DFHEIV99
 16494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16495
 16496
 16497     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16498     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16499     MOVE 'B'                    TO JP-RECORD-TYPE.
 16500     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16501
 16502     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16503
 16504     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16505
 16506
 16507* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 300
* EL6311.cbl
 16508*        DATASET (FILE-ID-ERPNDB)
 16509*        FROM    (PENDING-BUSINESS)
 16510*    END-EXEC.
 16511     MOVE LENGTH OF
 16512      PENDING-BUSINESS
 16513       TO DFHEIV11
 16514*    MOVE '&& L                  %   #00014601' TO DFHEIV0
 16515     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16516     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16517     MOVE X'2020233030303134363031' TO DFHEIV0(25:11)
 16518     CALL 'kxdfhei1' USING DFHEIV0,
 16519           FILE-ID-ERPNDB,
 16520           PENDING-BUSINESS,
 16521           DFHEIV11,
 16522           DFHEIV99
 16523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16524
 16525
 16526     MOVE 'C'                    TO JP-RECORD-TYPE.
 16527     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16528
 16529     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16530
 16531     IF WS-ERRORS-PRESENT
 16532         GO TO 3900-RE-DISPLAY-RECORD.
 16533
 16534     MOVE ZEROS                  TO EMI-ERROR
 16535     MOVE -1                     TO CMAINTL
 16536     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16537     GO TO 3900-RE-DISPLAY-RECORD.
 16538
 16539 2380-BATCH-HDR-NOT-FOUND.
 16540     MOVE -1                     TO BMAINTL.
 16541     MOVE ER-7450                TO EMI-ERROR.
 16542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16543     GO TO 8200-SEND-DATAONLY.
 16544
 16545 2385-REC-NOT-FOUND.
 16546     MOVE -1                     TO BMAINTL.
 16547     MOVE ER-7451                TO EMI-ERROR.
 16548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16549     GO TO 8200-SEND-DATAONLY.
 16550
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 301
* EL6311.cbl
 16552
 16553******************************************************************
 16554*                                                                *
 16555*          D E L E T E   C A N C E L   R O U T I N E             *
 16556*                                                                *
 16557******************************************************************
 16558
 16559 2400-DELETE-CANCEL-ROUTINE.
 16560     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16561
 16562     IF CCHGL NOT = ZEROS
 16563        MOVE ER-2196             TO EMI-ERROR
 16564        MOVE AL-UABON            TO CMAINTA
 16565        MOVE -1                  TO CMAINTL
 16566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16567        GO TO 8200-SEND-DATAONLY.
 16568
 16569
 16570* EXEC CICS HANDLE CONDITION
 16571*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16572*    END-EXEC.
 16573*    MOVE '"$I                   ! 8 #00014649' TO DFHEIV0
 16574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16576     MOVE X'3820233030303134363439' TO DFHEIV0(25:11)
 16577     CALL 'kxdfhei1' USING DFHEIV0
 16578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16579
 16580
 16581     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16582     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16583     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16584
 16585
 16586* EXEC CICS READ
 16587*        SET     (ADDRESS OF PENDING-BUSINESS)
 16588*        DATASET (FILE-ID-ERPNDB)
 16589*        RIDFLD  (ERPNDB-KEY)
 16590*    END-EXEC.
 16591*    MOVE '&"S        E          (   #00014657' TO DFHEIV0
 16592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16594     MOVE X'2020233030303134363537' TO DFHEIV0(25:11)
 16595     CALL 'kxdfhei1' USING DFHEIV0,
 16596           FILE-ID-ERPNDB,
 16597           DFHEIV20,
 16598           DFHEIV99,
 16599           ERPNDB-KEY,
 16600           DFHEIV99,
 16601           DFHEIV99,
 16602           DFHEIV99
 16603     SET ADDRESS OF PENDING-BUSINESS TO
 16604         DFHEIV20
 16605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16606
 16607
 16608     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16609
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 302
* EL6311.cbl
 16610     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16611
 16612     IF CSUFIXL NOT = ZEROS
 16613        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16614     ELSE
 16615        MOVE SPACE               TO WS-NEW-SUFFIX.
 16616
 16617     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16618
 16619     PERFORM 8600-DEEDIT.
 16620     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16621     MOVE '4'                    TO DC-OPTION-CODE.
 16622     PERFORM 9700-DATE-LINK.
 16623
 16624     IF DATE-CONVERSION-ERROR
 16625        MOVE ER-0348             TO EMI-ERROR
 16626        MOVE -1                  TO CEFFDTL
 16627        MOVE AL-UABON            TO CEFFDTA
 16628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16629        GO TO 8200-SEND-DATAONLY
 16630     ELSE
 16631        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16632        MOVE AL-UANON            TO CEFFDTA
 16633        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16634
 16635
 16636* EXEC CICS HANDLE CONDITION
 16637*         NOTFND    (2490-RECORD-NOT-FOUND)
 16638*    END-EXEC.
 16639*    MOVE '"$I                   ! 9 #00014690' TO DFHEIV0
 16640     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16642     MOVE X'3920233030303134363930' TO DFHEIV0(25:11)
 16643     CALL 'kxdfhei1' USING DFHEIV0
 16644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16645
 16646
 16647
 16648* EXEC CICS READ
 16649*        SET     (ADDRESS OF PENDING-BUSINESS)
 16650*        DATASET (FILE-ID-ERPNDB)
 16651*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16652*        UPDATE
 16653*    END-EXEC.
 16654*    MOVE '&"S        EU         (   #00014694' TO DFHEIV0
 16655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16656     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16657     MOVE X'2020233030303134363934' TO DFHEIV0(25:11)
 16658     CALL 'kxdfhei1' USING DFHEIV0,
 16659           FILE-ID-ERPNDB,
 16660           DFHEIV20,
 16661           DFHEIV99,
 16662           PI-PREV-CONTROL-PRIMARY,
 16663           DFHEIV99,
 16664           DFHEIV99,
 16665           DFHEIV99
 16666     SET ADDRESS OF PENDING-BUSINESS TO
 16667         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 303
* EL6311.cbl
 16668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16669
 16670
 16671     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16672        MOVE -1                 TO CMAINTL
 16673        MOVE ER-2197            TO EMI-ERROR
 16674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16675        GO TO 8200-SEND-DATAONLY.
 16676
 16677     IF PB-BILLED-DT NOT = LOW-VALUES
 16678        MOVE -1                 TO CMAINTL
 16679        MOVE ER-2129            TO EMI-ERROR
 16680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16681        GO TO 8200-SEND-DATAONLY.
 16682
 16683     IF PB-CHG-COUNT NOT = ZEROS
 16684        MOVE ER-2336            TO EMI-ERROR
 16685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16686        MOVE AL-UABON            TO CMAINTA
 16687        MOVE -1                  TO CMAINTL
 16688        GO TO 8200-SEND-DATAONLY.
 16689
 16690     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16691        PB-CHG-COUNT NOT = ZEROS
 16692        MOVE ER-2196             TO EMI-ERROR
 16693        MOVE AL-UABON            TO CMAINTA
 16694        MOVE -1                  TO CMAINTL
 16695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16696        GO TO 8200-SEND-DATAONLY.
 16697
 16698     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16699        MOVE ER-2900 TO EMI-ERROR
 16700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16701        MOVE AL-UABON         TO CMAINTA
 16702        MOVE -1               TO CMAINTL
 16703        GO TO 8200-SEND-DATAONLY.
 16704     move ' '                    to ws-stop-sw
 16705                                    ws-check-sw
 16706                                    ws-any-check-sw
 16707                                    ws-proc-check-sw
 16708                                    ws-chek-browse-sw
 16709
 16710     perform 2500-browse-checks  thru 2500-exit
 16711     if (i-have-processed-checks)
 16712        and (pb-c-refund-sw = 'Y')
 16713        move er-3446             to emi-error
 16714        perform 9900-error-format thru 9900-exit
 16715        move al-uabon            to cmainta
 16716        move -1                  to cmaintl
 16717        go to 8200-send-dataonly
 16718     end-if
 16719
 16720* EXEC CICS HANDLE CONDITION
 16721*         NOTFND  (2475-CONTINUE-DELETE)
 16722*    END-EXEC
 16723*    MOVE '"$I                   ! : #00014749' TO DFHEIV0
 16724     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 304
* EL6311.cbl
 16726     MOVE X'3A20233030303134373439' TO DFHEIV0(25:11)
 16727     CALL 'kxdfhei1' USING DFHEIV0
 16728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16729
 16730     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16731     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16732     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16733     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16734
 16735
 16736* EXEC CICS READ
 16737*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16738*        DATASET (FILE-ID-ELCERT)
 16739*        RIDFLD  (ELCERT-KEY)
 16740*        UPDATE
 16741*    END-EXEC.
 16742*    MOVE '&"S        EU         (   #00014758' TO DFHEIV0
 16743     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16744     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16745     MOVE X'2020233030303134373538' TO DFHEIV0(25:11)
 16746     CALL 'kxdfhei1' USING DFHEIV0,
 16747           FILE-ID-ELCERT,
 16748           DFHEIV20,
 16749           DFHEIV99,
 16750           ELCERT-KEY,
 16751           DFHEIV99,
 16752           DFHEIV99,
 16753           DFHEIV99
 16754     SET ADDRESS OF CERTIFICATE-MASTER TO
 16755         DFHEIV20
 16756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16757
 16758
 16759     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16760
 16761     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16762     MOVE 'B'                    TO JP-RECORD-TYPE.
 16763     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16764     PERFORM 8400-LOG-JOURNAL-RECORD.
 16765
 16766     IF PB-CI-LIVES NOT NUMERIC
 16767         MOVE ZERO                    TO PB-CI-LIVES.
 16768
 16769     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16770        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16771           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16772           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16773           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16774                                            CM-LF-CANCEL-DT
 16775           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16776        ELSE
 16777           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16778           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16779           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16780           MOVE PB-CI-LIVES              TO CM-LIVES.
 16781
 16782     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16783        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 305
* EL6311.cbl
 16784           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16785               MOVE CM-LF-STATUS-AT-CANCEL
 16786                                        TO CM-LF-CURRENT-STATUS
 16787               MOVE SPACE
 16788                                        TO CM-LF-STATUS-AT-CANCEL
 16789           ELSE
 16790               MOVE PB-CI-LF-POLICY-STATUS
 16791                                        TO CM-LF-CURRENT-STATUS
 16792        ELSE
 16793           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16794
 16795
 16796     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16797        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16798           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16799           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16800           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16801                                            CM-AH-CANCEL-DT
 16802           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16803        ELSE
 16804           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16805           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16806           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16807           MOVE PB-CI-LIVES              TO CM-LIVES.
 16808
 16809     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16810        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16811           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16812               MOVE CM-AH-STATUS-AT-CANCEL
 16813                                        TO CM-AH-CURRENT-STATUS
 16814               MOVE SPACE
 16815                                        TO CM-AH-STATUS-AT-CANCEL
 16816           ELSE
 16817               MOVE PB-CI-AH-POLICY-STATUS
 16818                                        TO CM-AH-CURRENT-STATUS
 16819        ELSE
 16820           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16821
 16822 2450-REWRITE-CERT.
 16823     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16824     MOVE 'C'                      TO JP-RECORD-TYPE.
 16825     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16826
 16827
 16828* EXEC CICS REWRITE
 16829*        DATASET  (FILE-ID-ELCERT)
 16830*        FROM     (CERTIFICATE-MASTER)
 16831*    END-EXEC.
 16832     MOVE LENGTH OF
 16833      CERTIFICATE-MASTER
 16834       TO DFHEIV11
 16835*    MOVE '&& L                  %   #00014833' TO DFHEIV0
 16836     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16837     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16838     MOVE X'2020233030303134383333' TO DFHEIV0(25:11)
 16839     CALL 'kxdfhei1' USING DFHEIV0,
 16840           FILE-ID-ELCERT,
 16841           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 306
* EL6311.cbl
 16842           DFHEIV11,
 16843           DFHEIV99
 16844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16845
 16846
 16847     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16848
 16849     PERFORM 8400-LOG-JOURNAL-RECORD.
 16850
 16851     move ' '                    to ws-stop-sw
 16852                                    ws-any-check-sw
 16853                                    ws-proc-check-sw
 16854                                    ws-chek-browse-sw
 16855
 16856     if i-have-checks
 16857        perform until i-say-stop
 16858           perform 2510-startbr-erchek
 16859                                 thru 2510-exit
 16860           if resp-normal
 16861              perform 2520-readnext-erchek
 16862                                 thru 2520-exit
 16863           end-if
 16864           if (not resp-normal)
 16865              or (pb-control-by-account (1:33) not =
 16866                 ch-control-primary (1:33))
 16867                 set i-say-stop to true
 16868           else
 16869              perform 2530-readupd-erchek
 16870                                 thru 2530-exit
 16871              if resp-normal
 16872                 perform 2540-delete-erchek
 16873                                 thru 2540-exit
 16874              end-if
 16875              if ws-chek-browse-sw = 'Y'
 16876                 perform 2525-endbr-erchek
 16877                                 thru 2525-exit
 16878                 move ' '        to ws-chek-browse-sw
 16879              end-if
 16880           end-if
 16881        end-perform
 16882     end-if
 16883
 16884     if ws-chek-browse-sw = 'Y'
 16885        perform 2525-endbr-erchek thru 2525-exit
 16886     end-if
 16887     .
 16888 2475-CONTINUE-DELETE.
 16889     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16890     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16891
 16892     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16893     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16894
 16895     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16896
 16897     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16898     MOVE 'D'                    TO JP-RECORD-TYPE
 16899     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 307
* EL6311.cbl
 16900
 16901
 16902* EXEC CICS DELETE
 16903*        DATASET    (FILE-ID-ERPNDB)
 16904*    END-EXEC.
 16905*    MOVE '&(                    &   #00014892' TO DFHEIV0
 16906     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134383932' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           FILE-ID-ERPNDB,
 16911           DFHEIV99,
 16912           DFHEIV99,
 16913           DFHEIV99,
 16914           DFHEIV99
 16915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16916
 16917
 16918     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16919
 16920     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16921
 16922     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16923     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16924
 16925
 16926* EXEC CICS HANDLE CONDITION
 16927*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16928*    END-EXEC.
 16929*    MOVE '"$I                   ! ; #00014903' TO DFHEIV0
 16930     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16932     MOVE X'3B20233030303134393033' TO DFHEIV0(25:11)
 16933     CALL 'kxdfhei1' USING DFHEIV0
 16934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16935
 16936
 16937
 16938* EXEC CICS READ
 16939*        SET     (ADDRESS OF PENDING-BUSINESS)
 16940*        DATASET (FILE-ID-ERPNDB)
 16941*        RIDFLD  (ERPNDB-KEY)
 16942*        UPDATE
 16943*    END-EXEC.
 16944*    MOVE '&"S        EU         (   #00014907' TO DFHEIV0
 16945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16946     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16947     MOVE X'2020233030303134393037' TO DFHEIV0(25:11)
 16948     CALL 'kxdfhei1' USING DFHEIV0,
 16949           FILE-ID-ERPNDB,
 16950           DFHEIV20,
 16951           DFHEIV99,
 16952           ERPNDB-KEY,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99
 16956     SET ADDRESS OF PENDING-BUSINESS TO
 16957         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 308
* EL6311.cbl
 16958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16959
 16960
 16961     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16962     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16963
 16964     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16965        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16966        MOVE 'D'                 TO JP-RECORD-TYPE
 16967        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16968
 16969* EXEC CICS DELETE
 16970*            DATASET    (FILE-ID-ERPNDB)
 16971*       END-EXEC
 16972*    MOVE '&(                    &   #00014921' TO DFHEIV0
 16973     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16974     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16975     MOVE X'2020233030303134393231' TO DFHEIV0(25:11)
 16976     CALL 'kxdfhei1' USING DFHEIV0,
 16977           FILE-ID-ERPNDB,
 16978           DFHEIV99,
 16979           DFHEIV99,
 16980           DFHEIV99,
 16981           DFHEIV99
 16982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16983        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16984     ELSE
 16985        MOVE 'B'                 TO JP-RECORD-TYPE
 16986        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16987        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16988        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16989        MOVE 'C'                 TO JP-RECORD-TYPE
 16990        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16991
 16992* EXEC CICS REWRITE
 16993*            DATASET    (FILE-ID-ERPNDB)
 16994*            FROM       (PENDING-BUSINESS)
 16995*       END-EXEC
 16996     MOVE LENGTH OF
 16997      PENDING-BUSINESS
 16998       TO DFHEIV11
 16999*    MOVE '&& L                  %   #00014932' TO DFHEIV0
 17000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17002     MOVE X'2020233030303134393332' TO DFHEIV0(25:11)
 17003     CALL 'kxdfhei1' USING DFHEIV0,
 17004           FILE-ID-ERPNDB,
 17005           PENDING-BUSINESS,
 17006           DFHEIV11,
 17007           DFHEIV99
 17008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17009        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 17010     end-if
 17011
 17012******************************************************************
 17013*                                                                *
 17014*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 17015*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 309
* EL6311.cbl
 17016*                                                                *
 17017******************************************************************
 17018
 17019     IF NOT PI-AR-PROCESSING
 17020        GO TO 2480-DELETE-FINISHED.
 17021
 17022     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 17023        WS-B-CANCEL-CNT-ENTERED = ZEROS
 17024        NEXT SENTENCE
 17025     ELSE
 17026        GO TO 2480-DELETE-FINISHED.
 17027
 17028
 17029* EXEC CICS HANDLE CONDITION
 17030*         NOTFND    (2480-DELETE-FINISHED)
 17031*    END-EXEC.
 17032*    MOVE '"$I                   ! < #00014955' TO DFHEIV0
 17033     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17035     MOVE X'3C20233030303134393535' TO DFHEIV0(25:11)
 17036     CALL 'kxdfhei1' USING DFHEIV0
 17037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17038
 17039
 17040     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17041     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17042
 17043
 17044* EXEC CICS READ
 17045*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17046*        DATASET (FILE-ID-ERRQST)
 17047*        RIDFLD  (ERRQST-KEY)
 17048*        UPDATE
 17049*    END-EXEC.
 17050*    MOVE '&"S        EU         (   #00014962' TO DFHEIV0
 17051     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17052     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17053     MOVE X'2020233030303134393632' TO DFHEIV0(25:11)
 17054     CALL 'kxdfhei1' USING DFHEIV0,
 17055           FILE-ID-ERRQST,
 17056           DFHEIV20,
 17057           DFHEIV99,
 17058           ERRQST-KEY,
 17059           DFHEIV99,
 17060           DFHEIV99,
 17061           DFHEIV99
 17062     SET ADDRESS OF AR-REQUEST-RECORD TO
 17063         DFHEIV20
 17064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17065
 17066
 17067     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17068
 17069     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17070
 17071     MOVE 'D'                      TO JP-RECORD-TYPE.
 17072     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17073
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 310
* EL6311.cbl
 17074
 17075* EXEC CICS DELETE
 17076*         DATASET    (FILE-ID-ERRQST)
 17077*    END-EXEC.
 17078*    MOVE '&(                    &   #00014976' TO DFHEIV0
 17079     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17081     MOVE X'2020233030303134393736' TO DFHEIV0(25:11)
 17082     CALL 'kxdfhei1' USING DFHEIV0,
 17083           FILE-ID-ERRQST,
 17084           DFHEIV99,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99
 17088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17089
 17090
 17091     PERFORM 8400-LOG-JOURNAL-RECORD.
 17092
 17093 2480-DELETE-FINISHED.
 17094     MOVE ZEROS                  TO EMI-ERROR.
 17095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17096     MOVE LOW-VALUES             TO EL631CI.
 17097     MOVE -1                     TO CMAINTL.
 17098     GO TO 8100-SEND-INITIAL-MAP.
 17099
 17100 2485-BATCH-HDR-NOT-FOUND.
 17101     MOVE -1                     TO CMAINTL
 17102     MOVE AL-UABON               TO CMAINTA.
 17103     MOVE ER-7450                TO EMI-ERROR.
 17104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17105     GO TO 8200-SEND-DATAONLY.
 17106
 17107 2490-RECORD-NOT-FOUND.
 17108     MOVE -1                     TO CMAINTL
 17109     MOVE AL-UABON               TO CMAINTA.
 17110     MOVE ER-7451                TO EMI-ERROR.
 17111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17112     GO TO 8200-SEND-DATAONLY.
 17113***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17114***                                                            ***
 17115***     2500  B R O W S E   C H E C K S                        ***
 17116***  We perform this routine from 2 different places.          ***
 17117***  1. If the user changes the refund amount on a cancel, we  ***
 17118***    want to.........                                        ***
 17119***    a. determine if prior checks have been processed        ***
 17120***    b. If the amt is larger, display message instructing    ***
 17121***     them to create another check to make up the difference.***
 17122***    c. If the amt is less, do not allow the change and      ***
 17123***     display a FATAL error suggesting they deal with check  ***
 17124***     records befor continuing.                              ***
 17125***  2. If the user wants to delete a cancel record we......   ***
 17126***    a. browse through all the checks and if there is a      ***
 17127***     processed check, send FATAL message.                   ***
 17128***    b. If there is a non-released check, then delete that   ***
 17129***     check after you delete the pending cancel record.      ***
 17130***                                                            ***
 17131***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 311
* EL6311.cbl
 17132
 17133 2500-browse-checks.
 17134
 17135     perform 2510-startbr-erchek thru 2510-exit
 17136
 17137     if not resp-normal
 17138        go to 2500-exit
 17139     end-if
 17140
 17141     perform until i-say-stop
 17142        perform 2520-readnext-erchek
 17143                                 thru 2520-exit
 17144        if (not resp-normal)
 17145           or (pb-control-by-account (1:33) not =
 17146              ch-control-primary (1:33))
 17147              set i-say-stop to true
 17148        else
 17149           set i-have-a-check-period to true
 17150           if (ch-approval-status) = ' '
 17151              and (ch-void-dt = low-values)
 17152              and (ch-released-dt = low-values)
 17153              set i-have-checks to true
 17154           else
 17155              if ch-void-dt = low-values
 17156                 set i-have-processed-checks to true
 17157              end-if
 17158           end-if
 17159           if (ch-credit-accept-dt = low-values)
 17160              and (ch-void-dt = low-values)
 17161              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17162              if (ch-check-origin-sw not = 'R')
 17163                 and (pb-record-type = '2')
 17164                 continue
 17165              else
 17166                 compute ws-check-amts =
 17167                    ws-check-amts + ch-amount-paid
 17168              end-if
 17169           end-if
 17170        end-if
 17171     end-perform
 17172
 17173     if ws-chek-browse-sw = 'Y'
 17174        perform 2525-endbr-erchek thru 2525-exit
 17175     end-if
 17176
 17177    .
 17178 2500-exit.
 17179     exit.
 17180
 17181 2510-startbr-erchek.
 17182
 17183     move pb-control-by-account  to erchek-key
 17184     move +0                     to chek-record-seq
 17185
 17186
 17187* exec cics startbr
 17188*       dataset   ('ERCHEK')
 17189*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 312
* EL6311.cbl
 17190*       gteq
 17191*       resp      (ws-response)
 17192*    end-exec
 17193     MOVE 'ERCHEK' TO DFHEIV1
 17194     MOVE 0
 17195       TO DFHEIV11
 17196*    MOVE '&,         G          &  N#00015075' TO DFHEIV0
 17197     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17199     MOVE X'204E233030303135303735' TO DFHEIV0(25:11)
 17200     CALL 'kxdfhei1' USING DFHEIV0,
 17201           DFHEIV1,
 17202           erchek-key,
 17203           DFHEIV99,
 17204           DFHEIV11,
 17205           DFHEIV99
 17206     MOVE EIBRESP  TO ws-response
 17207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17208
 17209     IF RESP-NORMAL
 17210        move 'Y'                 to ws-chek-browse-sw
 17211     end-if
 17212
 17213     .
 17214 2510-exit.
 17215     exit.
 17216
 17217 2520-readnext-erchek.
 17218
 17219
 17220* EXEC CICS READNEXT
 17221*       SET     (ADDRESS OF CHECK-RECORDS)
 17222*       DATASET ('ERCHEK')
 17223*       RIDFLD  (ERCHEK-KEY)
 17224*       RESP    (WS-RESPONSE)
 17225*    END-EXEC
 17226     MOVE 'ERCHEK' TO DFHEIV1
 17227     MOVE 0
 17228       TO DFHEIV11
 17229*    MOVE '&.S                   )  N#00015092' TO DFHEIV0
 17230     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17231     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17232     MOVE X'204E233030303135303932' TO DFHEIV0(25:11)
 17233     CALL 'kxdfhei1' USING DFHEIV0,
 17234           DFHEIV1,
 17235           DFHEIV20,
 17236           DFHEIV99,
 17237           ERCHEK-KEY,
 17238           DFHEIV99,
 17239           DFHEIV11,
 17240           DFHEIV99,
 17241           DFHEIV99
 17242     SET ADDRESS OF CHECK-RECORDS TO
 17243         DFHEIV20
 17244     MOVE EIBRESP  TO WS-RESPONSE
 17245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17246
 17247     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 313
* EL6311.cbl
 17248 2520-exit.
 17249     exit.
 17250
 17251 2525-endbr-erchek.
 17252
 17253
 17254* exec cics endbr
 17255*       dataset  ('ERCHEK')
 17256*    end-exec
 17257     MOVE 'ERCHEK' TO DFHEIV1
 17258     MOVE 0
 17259       TO DFHEIV11
 17260*    MOVE '&2                    $   #00015105' TO DFHEIV0
 17261     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17263     MOVE X'2020233030303135313035' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0,
 17265           DFHEIV1,
 17266           DFHEIV11,
 17267           DFHEIV99
 17268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17269
 17270     .
 17271 2525-exit.
 17272     exit.
 17273
 17274 2530-readupd-erchek.
 17275
 17276
 17277* EXEC CICS READ
 17278*       UPDATE
 17279*       SET     (ADDRESS OF CHECK-RECORDS)
 17280*       DATASET ('ERCHEK')
 17281*       RIDFLD  (ERCHEK-KEY)
 17282*       RESP    (WS-RESPONSE)
 17283*    END-EXEC
 17284     MOVE 'ERCHEK' TO DFHEIV1
 17285*    MOVE '&"S        EU         (  N#00015115' TO DFHEIV0
 17286     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17287     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17288     MOVE X'204E233030303135313135' TO DFHEIV0(25:11)
 17289     CALL 'kxdfhei1' USING DFHEIV0,
 17290           DFHEIV1,
 17291           DFHEIV20,
 17292           DFHEIV99,
 17293           ERCHEK-KEY,
 17294           DFHEIV99,
 17295           DFHEIV99,
 17296           DFHEIV99
 17297     SET ADDRESS OF CHECK-RECORDS TO
 17298         DFHEIV20
 17299     MOVE EIBRESP  TO WS-RESPONSE
 17300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17301
 17302     .
 17303 2530-exit.
 17304     exit.
 17305
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 314
* EL6311.cbl
 17306 2540-delete-erchek.
 17307
 17308
 17309* EXEC CICS DELETE
 17310*       DATASET ('ERCHEK')
 17311*       RESP    (WS-RESPONSE)
 17312*    END-EXEC
 17313     MOVE 'ERCHEK' TO DFHEIV1
 17314*    MOVE '&(                    &  N#00015129' TO DFHEIV0
 17315     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17317     MOVE X'204E233030303135313239' TO DFHEIV0(25:11)
 17318     CALL 'kxdfhei1' USING DFHEIV0,
 17319           DFHEIV1,
 17320           DFHEIV99,
 17321           DFHEIV99,
 17322           DFHEIV99,
 17323           DFHEIV99
 17324     MOVE EIBRESP  TO WS-RESPONSE
 17325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17326
 17327     .
 17328 2540-exit.
 17329     exit.
 17330***************************************************************
 17331*                                                             *
 17332*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17333*                                                             *
 17334***************************************************************
 17335
 17336***************************************************************
 17337*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17338*     AN ALREADY BILLED RECORD.                               *
 17339***************************************************************
 17340
 17341 2700-BUILD-CORRECTION-RECORD.
 17342     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17343     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17344     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17345     MOVE '5'                    TO DC-OPTION-CODE.
 17346     PERFORM 9700-DATE-LINK.
 17347     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17348
 17349     IF PB-CHG-COUNT = ZEROS
 17350        MOVE +1                  TO WS-SEQ-SAVE
 17351     ELSE
 17352        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17353
 17354     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17355     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17356
 17357     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17358
 17359     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17360     MOVE 'A'                    TO JP-RECORD-TYPE.
 17361     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17362
 17363
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 315
* EL6311.cbl
 17364* EXEC CICS WRITE
 17365*        DATASET    (FILE-ID-ERPNDB)
 17366*        FROM       (PENDING-BUSINESS)
 17367*        RIDFLD     (PB-CONTROL-PRIMARY)
 17368*    END-EXEC.
 17369     MOVE LENGTH OF
 17370      PENDING-BUSINESS
 17371       TO DFHEIV11
 17372*    MOVE '&$ L                  ''   #00015170' TO DFHEIV0
 17373     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17375     MOVE X'2020233030303135313730' TO DFHEIV0(25:11)
 17376     CALL 'kxdfhei1' USING DFHEIV0,
 17377           FILE-ID-ERPNDB,
 17378           PENDING-BUSINESS,
 17379           DFHEIV11,
 17380           PB-CONTROL-PRIMARY,
 17381           DFHEIV99,
 17382           DFHEIV99
 17383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17384
 17385
 17386     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17387
 17388     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17389     .
 17390 2799-EXIT.
 17391      EXIT.
 17392
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 316
* EL6311.cbl
 17394
 17395******************************************************************
 17396*                                                                *
 17397*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17398*                 'K' transaction                                *
 17399******************************************************************
 17400
 17401 2800-REWRITE-ISSUE-CERT-KEY.
 17402     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17403
 17404     IF  BCERTNOL GREATER THAN ZEROS
 17405         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17406
 17407     IF  BSUFIXL  GREATER THAN ZEROS
 17408         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17409
 17410     IF  BEFFDTL  GREATER THAN ZEROS
 17411         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17412     move pi-prev-control-primary to pa-current-key
 17413     move erpndb-alt-key          to pa-new-alt-key
 17414     move spaces                  to pa-return-area
 17415
 17416
 17417* EXEC CICS LINK
 17418*       PROGRAM   ('EL055')
 17419*       COMMAREA  (EL055-PASS-AREA)
 17420*       LENGTH    (256)
 17421*    END-EXEC
 17422     MOVE 'EL055' TO DFHEIV1
 17423     MOVE 256
 17424       TO DFHEIV11
 17425*    MOVE '."C                   (   #00015206' TO DFHEIV0
 17426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17428     MOVE X'2020233030303135323036' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0,
 17430           DFHEIV1,
 17431           EL055-PASS-AREA,
 17432           DFHEIV11,
 17433           DFHEIV99,
 17434           DFHEIV99,
 17435           DFHEIV99,
 17436           DFHEIV99
 17437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17438     if ra-status-code = +99  *> found a claim
 17439        move -1                  to bmaintl
 17440        move al-uabon            to bmainta
 17441        move er-2878             to emi-error
 17442        perform 9900-error-format thru 9900-exit
 17443        go to 8200-send-dataonly
 17444     end-if
 17445
 17446     if ra-status-code = +88  *> found dup cert
 17447        move -1                  to bmaintl
 17448        move al-uabon            to bmainta
 17449        move er-0229             to emi-error
 17450        perform 9900-error-format thru 9900-exit
 17451        go to 8200-send-dataonly
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 317
* EL6311.cbl
 17452     end-if
 17453     GO TO 1325-PROCESS-ISSUE-CHANGES
 17454     .
 17455******************************************************************
 17456*                                                                *
 17457*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17458*                                                                *
 17459******************************************************************
 17460
 17461 2900-REWRITE-CAN-CERT-KEY.
 17462     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17463
 17464     IF  CCERTNOL GREATER THAN ZEROS
 17465         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17466
 17467     IF  CSUFIXL  GREATER THAN ZEROS
 17468         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17469
 17470     IF  CEFFDTL  GREATER THAN ZEROS
 17471         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17472
 17473 2910-READ-BY-ACCOUNT.
 17474
 17475* EXEC CICS HANDLE CONDITION
 17476*         NOTFND    (2920-PROCESS-REWRITE)
 17477*    END-EXEC.
 17478*    MOVE '"$I                   ! = #00015247' TO DFHEIV0
 17479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17481     MOVE X'3D20233030303135323437' TO DFHEIV0(25:11)
 17482     CALL 'kxdfhei1' USING DFHEIV0
 17483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17484
 17485
 17486
 17487* EXEC CICS READ
 17488*        SET     (ADDRESS OF PENDING-BUSINESS)
 17489*        DATASET (FILE-ID-ERPNDB2)
 17490*        RIDFLD  (ERPNDB-ALT-KEY)
 17491*    END-EXEC.
 17492*    MOVE '&"S        E          (   #00015251' TO DFHEIV0
 17493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17495     MOVE X'2020233030303135323531' TO DFHEIV0(25:11)
 17496     CALL 'kxdfhei1' USING DFHEIV0,
 17497           FILE-ID-ERPNDB2,
 17498           DFHEIV20,
 17499           DFHEIV99,
 17500           ERPNDB-ALT-KEY,
 17501           DFHEIV99,
 17502           DFHEIV99,
 17503           DFHEIV99
 17504     SET ADDRESS OF PENDING-BUSINESS TO
 17505         DFHEIV20
 17506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17507
 17508
 17509     GO TO 2990-DUPLICATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 318
* EL6311.cbl
 17510
 17511  2920-PROCESS-REWRITE.
 17512
 17513* EXEC CICS HANDLE CONDITION
 17514*         NOTFND    (2985-RECORD-MISSING)
 17515*    END-EXEC.
 17516*    MOVE '"$I                   ! > #00015260' TO DFHEIV0
 17517     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17519     MOVE X'3E20233030303135323630' TO DFHEIV0(25:11)
 17520     CALL 'kxdfhei1' USING DFHEIV0
 17521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17522
 17523
 17524     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17525
 17526
 17527* EXEC CICS READ
 17528*        SET     (ADDRESS OF PENDING-BUSINESS)
 17529*        DATASET (FILE-ID-ERPNDB)
 17530*        RIDFLD  (ERPNDB-KEY)
 17531*        UPDATE
 17532*    END-EXEC.
 17533*    MOVE '&"S        EU         (   #00015266' TO DFHEIV0
 17534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17536     MOVE X'2020233030303135323636' TO DFHEIV0(25:11)
 17537     CALL 'kxdfhei1' USING DFHEIV0,
 17538           FILE-ID-ERPNDB,
 17539           DFHEIV20,
 17540           DFHEIV99,
 17541           ERPNDB-KEY,
 17542           DFHEIV99,
 17543           DFHEIV99,
 17544           DFHEIV99
 17545     SET ADDRESS OF PENDING-BUSINESS TO
 17546         DFHEIV20
 17547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17548
 17549
 17550     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17551     MOVE 'D'                    TO JP-RECORD-TYPE.
 17552     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17553     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17554
 17555     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17556
 17557     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17558     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17559     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17560
 17561
 17562* EXEC CICS DELETE
 17563*        DATASET    (FILE-ID-ERPNDB)
 17564*    END-EXEC.
 17565*    MOVE '&(                    &   #00015284' TO DFHEIV0
 17566     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17567     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 319
* EL6311.cbl
 17568     MOVE X'2020233030303135323834' TO DFHEIV0(25:11)
 17569     CALL 'kxdfhei1' USING DFHEIV0,
 17570           FILE-ID-ERPNDB,
 17571           DFHEIV99,
 17572           DFHEIV99,
 17573           DFHEIV99,
 17574           DFHEIV99
 17575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17576
 17577
 17578     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17579
 17580
 17581* EXEC CICS GETMAIN
 17582*        SET      (ADDRESS OF PENDING-BUSINESS)
 17583*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17584*        INITIMG  (GETMAIN-SPACE)
 17585*    END-EXEC.
 17586*    MOVE ',"IL                  $   #00015290' TO DFHEIV0
 17587     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17588     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17589     MOVE X'2020233030303135323930' TO DFHEIV0(25:11)
 17590     CALL 'kxdfhei1' USING DFHEIV0,
 17591           DFHEIV20,
 17592           ERPNDB-RECORD-LENGTH,
 17593           GETMAIN-SPACE
 17594     SET ADDRESS OF PENDING-BUSINESS TO
 17595         DFHEIV20
 17596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17597
 17598
 17599     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17600
 17601 2950-PROCESS-CANCELS.
 17602
 17603
 17604* EXEC CICS HANDLE CONDITION
 17605*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17606*    END-EXEC.
 17607*    MOVE '"$I                   ! ? #00015300' TO DFHEIV0
 17608     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17610     MOVE X'3F20233030303135333030' TO DFHEIV0(25:11)
 17611     CALL 'kxdfhei1' USING DFHEIV0
 17612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17613
 17614
 17615
 17616* EXEC CICS READ
 17617*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17618*        DATASET (FILE-ID-ELCERT)
 17619*        RIDFLD  (ELCERT-KEY)
 17620*        UPDATE
 17621*    END-EXEC.
 17622*    MOVE '&"S        EU         (   #00015304' TO DFHEIV0
 17623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17624     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17625     MOVE X'2020233030303135333034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 320
* EL6311.cbl
 17626     CALL 'kxdfhei1' USING DFHEIV0,
 17627           FILE-ID-ELCERT,
 17628           DFHEIV20,
 17629           DFHEIV99,
 17630           ELCERT-KEY,
 17631           DFHEIV99,
 17632           DFHEIV99,
 17633           DFHEIV99
 17634     SET ADDRESS OF CERTIFICATE-MASTER TO
 17635         DFHEIV20
 17636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17637
 17638
 17639     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17640
 17641     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17642     MOVE 'B'                      TO JP-RECORD-TYPE.
 17643     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17644     PERFORM 8400-LOG-JOURNAL-RECORD.
 17645
 17646     IF PB-CI-LIVES NOT NUMERIC
 17647         MOVE ZERO                    TO PB-CI-LIVES.
 17648
 17649     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17650        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17651        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17652        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17653                                         CM-LF-CANCEL-DT
 17654     ELSE
 17655        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17656        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17657        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17658        MOVE PB-CI-LIVES              TO CM-LIVES.
 17659
 17660     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17661        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17662            MOVE CM-LF-STATUS-AT-CANCEL
 17663                                     TO CM-LF-CURRENT-STATUS
 17664            MOVE SPACE
 17665                                     TO CM-LF-STATUS-AT-CANCEL
 17666        ELSE
 17667            MOVE PB-CI-LF-POLICY-STATUS
 17668                                     TO CM-LF-CURRENT-STATUS
 17669     ELSE
 17670        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17671
 17672     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17673        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17674        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17675        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17676                                         CM-AH-CANCEL-DT
 17677     ELSE
 17678        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17679        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17680        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17681        MOVE PB-CI-LIVES              TO CM-LIVES.
 17682
 17683     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 321
* EL6311.cbl
 17684        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17685            MOVE CM-AH-STATUS-AT-CANCEL
 17686                                     TO CM-AH-CURRENT-STATUS
 17687            MOVE SPACE
 17688                                     TO CM-AH-STATUS-AT-CANCEL
 17689        ELSE
 17690            MOVE PB-CI-AH-POLICY-STATUS
 17691                                     TO CM-AH-CURRENT-STATUS
 17692     ELSE
 17693        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17694
 17695 2975-REWRITE-CERT.
 17696     MOVE 'C'                      TO JP-RECORD-TYPE.
 17697     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17698
 17699
 17700* EXEC CICS REWRITE
 17701*        DATASET    (FILE-ID-ELCERT)
 17702*        FROM       (CERTIFICATE-MASTER)
 17703*    END-EXEC.
 17704     MOVE LENGTH OF
 17705      CERTIFICATE-MASTER
 17706       TO DFHEIV11
 17707*    MOVE '&& L                  %   #00015371' TO DFHEIV0
 17708     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17709     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17710     MOVE X'2020233030303135333731' TO DFHEIV0(25:11)
 17711     CALL 'kxdfhei1' USING DFHEIV0,
 17712           FILE-ID-ELCERT,
 17713           CERTIFICATE-MASTER,
 17714           DFHEIV11,
 17715           DFHEIV99
 17716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17717
 17718
 17719     PERFORM 8400-LOG-JOURNAL-RECORD.
 17720
 17721 2960-BUILD-NEW-CANCEL-RECORD.
 17722     IF  CCERTNOL GREATER THAN ZEROS
 17723         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17724
 17725     IF  CSUFIXL  GREATER THAN ZEROS
 17726         MOVE CSUFIXI             TO PB-CERT-SFX.
 17727
 17728     IF  CEFFDTL  GREATER  THAN ZEROS
 17729         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17730
 17731 2970-WRITE-PENDING-BUSINESS.
 17732     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17733     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17734     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17735     MOVE '5'                    TO DC-OPTION-CODE.
 17736     PERFORM 9700-DATE-LINK.
 17737     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17738
 17739     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17740
 17741     MOVE SPACES                 TO PB-CI-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 322
* EL6311.cbl
 17742                                    PB-CI-INSURED-SEX
 17743                                    PB-CI-LF-BENEFIT-CD
 17744                                    PB-CI-AH-BENEFIT-CD
 17745                                    PB-CI-RATE-CLASS
 17746                                    PB-CI-RATE-DEV-LF
 17747                                    PB-CI-RATE-DEV-AH
 17748                                    PB-CI-LF-ABBR
 17749                                    PB-CI-AH-ABBR
 17750                                    PB-CI-OB-FLAG
 17751                                    PB-CI-LF-POLICY-STATUS
 17752                                    PB-CI-AH-POLICY-STATUS
 17753                                    PB-CI-INDV-GRP-CD
 17754                                    PB-CI-BENEFICIARY-NAME
 17755                                    PB-CI-NOTE-SW
 17756                                    PB-CI-SOC-SEC-NO
 17757                                    PB-CI-MEMBER-NO
 17758                                    PB-CI-INT-CODE
 17759                                    PB-CI-COMP-EXCP-SW
 17760                                    PB-CI-ENTRY-STATUS
 17761                                    PB-CI-CREDIT-INTERFACE-SW-1
 17762                                    PB-CI-CREDIT-INTERFACE-SW-2
 17763                                    PB-CI-ENTRY-BATCH.
 17764
 17765     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17766                                    PB-CI-AH-SETTLEMENT-DT
 17767                                    PB-CI-DEATH-DT
 17768                                    PB-CI-LF-PRIOR-CANCEL-DT
 17769                                    PB-CI-AH-PRIOR-CANCEL-DT
 17770                                    PB-CI-LOAN-1ST-PMT-DT
 17771                                    PB-CI-ENTRY-DT
 17772                                    PB-CI-LF-EXPIRE-DT
 17773                                    PB-CI-AH-EXPIRE-DT.
 17774
 17775     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17776                                    PB-CI-LF-TERM
 17777                                    PB-CI-LF-BENEFIT-AMT
 17778                                    PB-CI-LF-ALT-BENEFIT-AMT
 17779                                    PB-CI-LF-PREMIUM-AMT
 17780                                    PB-CI-LF-ALT-PREMIUM-AMT
 17781                                    PB-CI-AH-TERM
 17782                                    PB-CI-AH-BENEFIT-AMT
 17783                                    PB-CI-AH-PREMIUM-AMT
 17784                                    PB-CI-RATE-DEV-PCT-LF
 17785                                    PB-CI-RATE-DEV-PCT-AH
 17786                                    PB-CI-LIFE-COMMISSION
 17787                                    PB-CI-AH-COMMISSION
 17788                                    PB-CI-PAY-FREQUENCY
 17789                                    PB-CI-LOAN-APR
 17790                                    PB-CI-LOAN-TERM
 17791                                    PB-CI-CURR-SEQ
 17792                                    PB-CI-AH-CANCEL-AMT
 17793                                    PB-CI-LF-CANCEL-AMT
 17794                                    PB-CI-EXTENTION-DAYS
 17795                                    PB-CI-TERM-IN-DAYS
 17796                                    PB-CI-LOAN-OFFICER
 17797                                    PB-CI-LIVES
 17798                                    PB-CI-LF-CRIT-PER
 17799                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 323
* EL6311.cbl
 17800                                    PB-C-LF-REM-TERM
 17801                                    PB-C-AH-REM-TERM.
 17802
 17803     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17804     MOVE 'A'                    TO JP-RECORD-TYPE.
 17805     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17806
 17807
 17808* EXEC CICS HANDLE CONDITION
 17809*        DUPREC   (2990-DUPLICATE-RECORD)
 17810*    END-EXEC.
 17811*    MOVE '"$%                   ! @ #00015464' TO DFHEIV0
 17812     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17814     MOVE X'4020233030303135343634' TO DFHEIV0(25:11)
 17815     CALL 'kxdfhei1' USING DFHEIV0
 17816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17817
 17818
 17819
 17820* EXEC CICS WRITE
 17821*        DATASET  (FILE-ID-ERPNDB)
 17822*        FROM     (PENDING-BUSINESS)
 17823*        RIDFLD   (PB-CONTROL-PRIMARY)
 17824*    END-EXEC.
 17825     MOVE LENGTH OF
 17826      PENDING-BUSINESS
 17827       TO DFHEIV11
 17828*    MOVE '&$ L                  ''   #00015468' TO DFHEIV0
 17829     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17831     MOVE X'2020233030303135343638' TO DFHEIV0(25:11)
 17832     CALL 'kxdfhei1' USING DFHEIV0,
 17833           FILE-ID-ERPNDB,
 17834           PENDING-BUSINESS,
 17835           DFHEIV11,
 17836           PB-CONTROL-PRIMARY,
 17837           DFHEIV99,
 17838           DFHEIV99
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17843
 17844     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 17845
 17846     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17847
 17848 2985-RECORD-MISSING.
 17849     MOVE -1                     TO CMAINTL
 17850     MOVE AL-UABON               TO CMAINTA.
 17851
 17852     MOVE ER-2902                TO EMI-ERROR.
 17853     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17854     GO TO 8200-SEND-DATAONLY.
 17855
 17856 2990-DUPLICATE-RECORD.
 17857     MOVE SPACE                  TO CMAINTI.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 324
* EL6311.cbl
 17858     MOVE -1                     TO CMAINTL.
 17859     MOVE AL-UABON               TO CCERTNOA.
 17860     MOVE AL-UNBON               TO CEFFDTA.
 17861
 17862     MOVE 1                      TO EMI-SUB
 17863                                    EMI-SWITCH1
 17864                                    EMI-SWITCH-AREA-1
 17865                                    EMI-SWITCH-AREA-2.
 17866     MOVE SPACES                 TO EMI-ERROR-LINES.
 17867
 17868
 17869* EXEC CICS SYNCPOINT ROLLBACK
 17870*    END-EXEC.
 17871*    MOVE '6"R                   !   #00015500' TO DFHEIV0
 17872     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17874     MOVE X'2020233030303135353030' TO DFHEIV0(25:11)
 17875     CALL 'kxdfhei1' USING DFHEIV0
 17876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17877
 17878
 17879     MOVE ER-2247                TO EMI-ERROR.
 17880     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17881     GO TO 8200-SEND-DATAONLY.
 17882
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 325
* EL6311.cbl
 17884
 17885***************************************************************
 17886*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17887*     PREMIUM FOR A SINGLE BATCH.                             *
 17888*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17889***************************************************************
 17890
 17891 3000-BATCH-MAINLINE.
 17892     IF PI-PREV-KEY NOT = SPACES
 17893         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17894     ELSE
 17895         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17896
 17897     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17898
 17899 3010-READNEXT.
 17900
 17901* EXEC CICS READ
 17902*         DATASET    (FILE-ID-ERPNDB)
 17903*         SET        (ADDRESS OF PENDING-BUSINESS)
 17904*         RIDFLD     (ERPNDB-KEY)
 17905*         GTEQ
 17906*    END-EXEC.
 17907*    MOVE '&"S        G          (   #00015524' TO DFHEIV0
 17908     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17910     MOVE X'2020233030303135353234' TO DFHEIV0(25:11)
 17911     CALL 'kxdfhei1' USING DFHEIV0,
 17912           FILE-ID-ERPNDB,
 17913           DFHEIV20,
 17914           DFHEIV99,
 17915           ERPNDB-KEY,
 17916           DFHEIV99,
 17917           DFHEIV99,
 17918           DFHEIV99
 17919     SET ADDRESS OF PENDING-BUSINESS TO
 17920         DFHEIV20
 17921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17922
 17923
 17924     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17925        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17926          GO TO 3030-END-BATCH.
 17927
 17928     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17929
 17930     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17931        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17932          GO TO 3020-BUMP-SEQ.
 17933
 17934     IF PB-ISSUE
 17935        ADD +1                   TO WS-ISS-TOTAL-CNT
 17936        IF PB-FATAL-ERRORS
 17937           ADD +1                      TO WS-ISS-FATAL-CNT
 17938           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17939           GO TO 3020-BUMP-SEQ
 17940        ELSE
 17941           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 326
* EL6311.cbl
 17942              ADD +1                      TO WS-ISS-FORCE-CNT
 17943              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17944              GO TO 3020-BUMP-SEQ
 17945           ELSE
 17946              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17947                 ADD +1                      TO WS-ISS-HOLD-CNT
 17948                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17949                 GO TO 3020-BUMP-SEQ
 17950              ELSE
 17951                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17952                     THRU  3299-EXIT
 17953                 GO TO 3020-BUMP-SEQ.
 17954
 17955     IF PB-CANCELLATION
 17956        ADD +1                   TO WS-CAN-TOTAL-CNT
 17957        IF PB-FATAL-ERRORS
 17958           ADD +1                 TO WS-CAN-FATAL-CNT
 17959           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17960           GO TO 3020-BUMP-SEQ
 17961        ELSE
 17962           IF PB-UNFORCED-ERRORS
 17963              ADD +1                 TO WS-CAN-FORCE-CNT
 17964              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17965              GO TO 3020-BUMP-SEQ
 17966           ELSE
 17967              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17968                 ADD +1                 TO WS-CAN-HOLD-CNT
 17969                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17970                 GO TO 3020-BUMP-SEQ
 17971              ELSE
 17972                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17973                     THRU  3499-EXIT
 17974                 GO TO 3020-BUMP-SEQ.
 17975
 17976     IF PB-BATCH-TRAILER
 17977         GO TO 3030-END-BATCH.
 17978
 17979 3020-BUMP-SEQ.
 17980     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17981     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17982     GO TO 3010-READNEXT.
 17983
 17984 3030-END-BATCH.
 17985     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17986     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17987     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17988     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17989
 17990     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17991                                          - WS-ISS-FORCE-CNT
 17992                                          - WS-ISS-HOLD-CNT).
 17993
 17994     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17995     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17996
 17997     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17998     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17999     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 327
* EL6311.cbl
 18000     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18001     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18002                                          - WS-CAN-FORCE-CNT
 18003                                          - WS-CAN-HOLD-CNT).
 18004     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18005     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18006
 18007     COMPUTE WS-NET-TOTAL-CNT
 18008         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18009     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18010     COMPUTE WS-NET-FATAL-CNT
 18011         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18012     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18013     COMPUTE WS-NET-FORCE-CNT
 18014         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18015     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18016     COMPUTE WS-NET-HOLD-CNT
 18017         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18018     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18019
 18020     COMPUTE WS-NET-AVAIL-CNT
 18021          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18022                              - WS-ISS-FORCE-CNT
 18023                              - WS-ISS-HOLD-CNT)
 18024          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18025                              - WS-CAN-FORCE-CNT
 18026                              - WS-CAN-HOLD-CNT).
 18027     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18028
 18029     COMPUTE WS-NET-GOOD-PREM
 18030         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18031     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18032     COMPUTE WS-NET-BAD-PREM
 18033         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18034     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18035
 18036     MOVE 0000                   TO EMI-ERROR.
 18037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18038     MOVE -1                     TO DPFENTRL.
 18039     GO TO 8200-SEND-DATAONLY.
 18040
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 328
* EL6311.cbl
 18042
 18043******************************************************************
 18044*                                                                *
 18045*           A D D    B A D   I S S U E   P R E M I U M           *
 18046*                                                                *
 18047******************************************************************
 18048
 18049 3100-ADD-BAD-ISSUE-PREM.
 18050     IF PB-OVERRIDE-LIFE
 18051       OR PB-OVERRIDE-BOTH
 18052           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18053           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18054       ELSE
 18055           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18056           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18057
 18058     IF PB-OVERRIDE-AH
 18059       OR PB-OVERRIDE-BOTH
 18060           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18061       ELSE
 18062           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18063
 18064 3199-EXIT.
 18065     EXIT.
 18066
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 329
* EL6311.cbl
 18068
 18069******************************************************************
 18070*                                                                *
 18071*       A D D   G O O D   I S S U E   P R E M I U M              *
 18072*                                                                *
 18073******************************************************************
 18074
 18075 3200-ADD-GOOD-ISSUE-PREM.
 18076     IF PB-OVERRIDE-LIFE
 18077       OR PB-OVERRIDE-BOTH
 18078           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18079           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18080       ELSE
 18081           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18082           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18083
 18084     IF PB-OVERRIDE-AH
 18085       OR PB-OVERRIDE-BOTH
 18086           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18087       ELSE
 18088           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18089
 18090 3299-EXIT.
 18091     EXIT.
 18092
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 330
* EL6311.cbl
 18094
 18095
 18096******************************************************************
 18097*                                                                *
 18098*        A D D   B A D   C A N C E L   P R E M I U M             *
 18099*                                                                *
 18100******************************************************************
 18101
 18102 3300-ADD-BAD-CANCEL-PREM.
 18103     IF PB-OVERRIDE-LIFE
 18104       OR PB-OVERRIDE-BOTH
 18105           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18106       ELSE
 18107           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18108
 18109     IF PB-OVERRIDE-AH
 18110       OR PB-OVERRIDE-BOTH
 18111           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18112       ELSE
 18113           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18114
 18115 3399-EXIT.
 18116     EXIT.
 18117
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 331
* EL6311.cbl
 18119
 18120******************************************************************
 18121*                                                                *
 18122*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18123*                                                                *
 18124******************************************************************
 18125
 18126 3400-ADD-GOOD-CANCEL-PREM.
 18127     IF PB-OVERRIDE-LIFE
 18128       OR PB-OVERRIDE-BOTH
 18129           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18130       ELSE
 18131           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18132
 18133     IF PB-OVERRIDE-AH
 18134       OR PB-OVERRIDE-BOTH
 18135           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18136       ELSE
 18137           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18138
 18139 3499-EXIT.
 18140     EXIT.
 18141
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 332
* EL6311.cbl
 18143
 18144******************************************************************
 18145*                                                                *
 18146*           E D I T   B A T C H   D A T A                        *
 18147*                                                                *
 18148******************************************************************
 18149
 18150 3500-EDIT-BATCH-DATA.
 18151     IF PI-PREV-KEY NOT = SPACES
 18152        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18153     ELSE
 18154        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18155
 18156     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18157     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18158
 18159
 18160* EXEC CICS HANDLE CONDITION
 18161*         NOTFND      (3590-NOT-FOUND)
 18162*    END-EXEC.
 18163*    MOVE '"$I                   ! A #00015766' TO DFHEIV0
 18164     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18166     MOVE X'4120233030303135373636' TO DFHEIV0(25:11)
 18167     CALL 'kxdfhei1' USING DFHEIV0
 18168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18169
 18170
 18171     IF DRISSL   GREATER THAN ZEROS OR
 18172        DRISSL   GREATER THAN ZEROS OR
 18173        DRLFPRML GREATER THAN ZEROS OR
 18174        DRAHPRML GREATER THAN ZEROS OR
 18175        DRCANCL  GREATER THAN ZEROS OR
 18176        DRLFRFDL GREATER THAN ZEROS OR
 18177        DRAHRFDL GREATER THAN ZEROS
 18178              NEXT SENTENCE
 18179          ELSE
 18180              MOVE ER-3224    TO EMI-ERROR
 18181              MOVE -1         TO DPFENTRL
 18182              MOVE AL-UNBON   TO DPFENTRA
 18183              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18184              GO TO 8200-SEND-DATAONLY.
 18185
 18186     IF NOT MODIFY-CAP
 18187         MOVE 'UPDATE'       TO SM-READ
 18188         PERFORM 9995-SECURITY-VIOLATION
 18189         MOVE ER-0070        TO EMI-ERROR
 18190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18191         GO TO 8100-SEND-INITIAL-MAP.
 18192
 18193        IF DRISSL GREATER THAN ZEROS
 18194           MOVE AL-UNNON         TO DRISSA
 18195           MOVE DRISSI           TO DEEDIT-FIELD
 18196           PERFORM 8600-DEEDIT
 18197           IF DEEDIT-FIELD-V0  NUMERIC
 18198              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18199           ELSE
 18200              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 333
* EL6311.cbl
 18201              MOVE -1         TO DRISSL
 18202              MOVE AL-UNBON   TO DRISSA
 18203              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18204
 18205        IF DRLFPRML GREATER THAN ZEROS
 18206           MOVE AL-UNNON         TO DRLFPRMA
 18207
 18208* EXEC CICS BIF DEEDIT
 18209*              FIELD  (DRLFPRMI)
 18210*              LENGTH (11)
 18211*          END-EXEC
 18212     MOVE 11
 18213       TO DFHEIV11
 18214*    MOVE '@"L                   #   #00015806' TO DFHEIV0
 18215     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18217     MOVE X'2020233030303135383036' TO DFHEIV0(25:11)
 18218     CALL 'kxdfhei1' USING DFHEIV0,
 18219           DRLFPRMI,
 18220           DFHEIV11
 18221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18222           IF DRLFPRMI NUMERIC
 18223              MOVE DRLFPRMI   TO WS-DRLFPRM
 18224*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18225*          PERFORM 8600-DEEDIT
 18226*          IF DEEDIT-FIELD-V2  NUMERIC
 18227*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18228           ELSE
 18229              MOVE ER-2223    TO EMI-ERROR
 18230              MOVE -1         TO DRLFPRML
 18231              MOVE AL-UNBON   TO DRLFPRMA
 18232              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18233
 18234        IF DRAHPRML GREATER THAN ZEROS
 18235           MOVE AL-UNNON         TO DRAHPRMA
 18236
 18237* EXEC CICS BIF DEEDIT
 18238*              FIELD  (DRAHPRMI)
 18239*              LENGTH (11)
 18240*          END-EXEC
 18241     MOVE 11
 18242       TO DFHEIV11
 18243*    MOVE '@"L                   #   #00015824' TO DFHEIV0
 18244     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18245     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18246     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 18247     CALL 'kxdfhei1' USING DFHEIV0,
 18248           DRAHPRMI,
 18249           DFHEIV11
 18250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18251           IF DRAHPRMI NUMERIC
 18252              MOVE DRAHPRMI   TO WS-DRAHPRM
 18253*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18254*          PERFORM 8600-DEEDIT
 18255*          IF DEEDIT-FIELD-V2  NUMERIC
 18256*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18257           ELSE
 18258              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 334
* EL6311.cbl
 18259              MOVE -1         TO DRAHPRML
 18260              MOVE AL-UNBON   TO DRAHPRMA
 18261              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18262
 18263        IF DRCANCL GREATER THAN ZEROS
 18264           MOVE AL-UNNON         TO DRCANCA
 18265           MOVE DRCANCI          TO DEEDIT-FIELD
 18266           PERFORM 8600-DEEDIT
 18267           IF DEEDIT-FIELD-V0  NUMERIC
 18268              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18269           ELSE
 18270              MOVE ER-2223    TO EMI-ERROR
 18271              MOVE -1         TO DRCANCL
 18272              MOVE AL-UNBON   TO DRCANCL
 18273              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18274
 18275        IF DRLFRFDL GREATER THAN ZEROS
 18276           MOVE AL-UNNON         TO DRLFRFDA
 18277
 18278* EXEC CICS BIF DEEDIT
 18279*              FIELD  (DRLFRFDI)
 18280*              LENGTH (11)
 18281*          END-EXEC
 18282     MOVE 11
 18283       TO DFHEIV11
 18284*    MOVE '@"L                   #   #00015854' TO DFHEIV0
 18285     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18286     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18287     MOVE X'2020233030303135383534' TO DFHEIV0(25:11)
 18288     CALL 'kxdfhei1' USING DFHEIV0,
 18289           DRLFRFDI,
 18290           DFHEIV11
 18291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18292           IF DRLFRFDI NUMERIC
 18293              MOVE DRLFRFDI   TO WS-DRLFRFD
 18294*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18295*          PERFORM 8600-DEEDIT
 18296*          IF DEEDIT-FIELD-V2  NUMERIC
 18297*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18298           ELSE
 18299              MOVE ER-2223    TO EMI-ERROR
 18300              MOVE -1         TO DRLFRFDL
 18301              MOVE AL-UNBON   TO DRLFRFDA
 18302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18303
 18304        IF DRAHRFDL GREATER THAN ZEROS
 18305           MOVE AL-UNNON         TO DRAHRFDA
 18306
 18307* EXEC CICS BIF DEEDIT
 18308*              FIELD  (DRAHRFDI)
 18309*              LENGTH (11)
 18310*          END-EXEC
 18311     MOVE 11
 18312       TO DFHEIV11
 18313*    MOVE '@"L                   #   #00015872' TO DFHEIV0
 18314     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18315     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18316     MOVE X'2020233030303135383732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 335
* EL6311.cbl
 18317     CALL 'kxdfhei1' USING DFHEIV0,
 18318           DRAHRFDI,
 18319           DFHEIV11
 18320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18321           IF DRAHRFDI NUMERIC
 18322              MOVE DRAHRFDI   TO WS-DRAHRFD
 18323*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18324*          PERFORM 8600-DEEDIT
 18325*          IF DEEDIT-FIELD-V2  NUMERIC
 18326*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18327           ELSE
 18328              MOVE ER-2223    TO EMI-ERROR
 18329              MOVE -1         TO DRAHRFDL
 18330              MOVE AL-UNBON   TO DRAHRFDA
 18331              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18332
 18333     IF EMI-ERROR = ZEROS
 18334        GO 3600-UPDATE-BATCH-HEADER.
 18335
 18336     GO TO 8200-SEND-DATAONLY.
 18337
 18338 3590-NOT-FOUND.
 18339     MOVE ER-2192                TO EMI-ERROR.
 18340     MOVE -1                     TO DPFENTRL.
 18341     MOVE AL-UNBON               TO DPFENTRA.
 18342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18343     GO TO 8200-SEND-DATAONLY.
 18344
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 336
* EL6311.cbl
 18346
 18347******************************************************************
 18348*                                                                *
 18349*           U P D A T E   B A T C H   H E A D E R                *
 18350*                                                                *
 18351******************************************************************
 18352
 18353 3600-UPDATE-BATCH-HEADER.
 18354
 18355* EXEC CICS HANDLE CONDITION
 18356*         NOTFND      (3690-NOT-FOUND)
 18357*    END-EXEC.
 18358*    MOVE '"$I                   ! B #00015909' TO DFHEIV0
 18359     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18361     MOVE X'4220233030303135393039' TO DFHEIV0(25:11)
 18362     CALL 'kxdfhei1' USING DFHEIV0
 18363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18364
 18365
 18366
 18367* EXEC CICS READ
 18368*        DATASET (FILE-ID-ERPNDB)
 18369*        RIDFLD  (ERPNDB-KEY)
 18370*        SET     (ADDRESS OF PENDING-BUSINESS)
 18371*        UPDATE
 18372*    END-EXEC.
 18373*    MOVE '&"S        EU         (   #00015913' TO DFHEIV0
 18374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18376     MOVE X'2020233030303135393133' TO DFHEIV0(25:11)
 18377     CALL 'kxdfhei1' USING DFHEIV0,
 18378           FILE-ID-ERPNDB,
 18379           DFHEIV20,
 18380           DFHEIV99,
 18381           ERPNDB-KEY,
 18382           DFHEIV99,
 18383           DFHEIV99,
 18384           DFHEIV99
 18385     SET ADDRESS OF PENDING-BUSINESS TO
 18386         DFHEIV20
 18387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18388
 18389
 18390     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18391     MOVE 'B'                    TO JP-RECORD-TYPE.
 18392     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18393
 18394     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18395
 18396     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18397
 18398     IF DRISSL GREATER THAN ZEROS
 18399        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18400
 18401     IF DRCANCL GREATER THAN ZEROS
 18402        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18403
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 337
* EL6311.cbl
 18404
 18405     IF DRLFPRML GREATER THAN ZEROS
 18406        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18407
 18408     IF DRAHPRML GREATER THAN ZEROS
 18409        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18410
 18411     IF DRLFRFDL GREATER THAN ZEROS
 18412        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18413
 18414     IF DRAHRFDL GREATER THAN ZEROS
 18415        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18416
 18417 3670-REWRITE-BATCH-HEADER.
 18418     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18419        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18420        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18421        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18422        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18423        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18424        MOVE SPACE               TO PB-OUT-BAL-CD
 18425     ELSE
 18426        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18427
 18428     MOVE 'C'                    TO JP-RECORD-TYPE.
 18429     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18430
 18431
 18432* EXEC CICS REWRITE
 18433*         DATASET      (FILE-ID-ERPNDB)
 18434*         FROM         (PENDING-BUSINESS)
 18435*    END-EXEC.
 18436     MOVE LENGTH OF
 18437      PENDING-BUSINESS
 18438       TO DFHEIV11
 18439*    MOVE '&& L                  %   #00015961' TO DFHEIV0
 18440     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18441     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18442     MOVE X'2020233030303135393631' TO DFHEIV0(25:11)
 18443     CALL 'kxdfhei1' USING DFHEIV0,
 18444           FILE-ID-ERPNDB,
 18445           PENDING-BUSINESS,
 18446           DFHEIV11,
 18447           DFHEIV99
 18448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18449
 18450
 18451     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18452
 18453     GO TO 7200-DISPLAY-BATCHES.
 18454
 18455 3690-NOT-FOUND.
 18456     MOVE ER-2192                TO EMI-ERROR.
 18457     MOVE -1                     TO DPFENTRL.
 18458     MOVE AL-UNBON               TO DPFENTRA.
 18459     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18460     GO TO 8200-SEND-DATAONLY.
 18461
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 338
* EL6311.cbl
 18463
 18464******************************************************************
 18465*                                                                *
 18466*           R E - D I S P L A Y   R E C O R D                    *
 18467*                                                                *
 18468******************************************************************
 18469
 18470 3900-RE-DISPLAY-RECORD.
 18471
 18472* EXEC CICS HANDLE CONDITION
 18473*         NOTFND   (3990-NOT-FOUND)
 18474*    END-EXEC.
 18475*    MOVE '"$I                   ! C #00015986' TO DFHEIV0
 18476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18478     MOVE X'4320233030303135393836' TO DFHEIV0(25:11)
 18479     CALL 'kxdfhei1' USING DFHEIV0
 18480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18481
 18482
 18483     IF PI-DISPLAY-ORIGINAL-BATCH
 18484         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18485     ELSE
 18486         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18487
 18488
 18489* EXEC CICS READ
 18490*         DATASET   (FILE-ID)
 18491*         RIDFLD    (PI-PREV-KEY)
 18492*         SET       (ADDRESS OF PENDING-BUSINESS)
 18493*    END-EXEC.
 18494*    MOVE '&"S        E          (   #00015995' TO DFHEIV0
 18495     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18497     MOVE X'2020233030303135393935' TO DFHEIV0(25:11)
 18498     CALL 'kxdfhei1' USING DFHEIV0,
 18499           FILE-ID,
 18500           DFHEIV20,
 18501           DFHEIV99,
 18502           PI-PREV-KEY,
 18503           DFHEIV99,
 18504           DFHEIV99,
 18505           DFHEIV99
 18506     SET ADDRESS OF PENDING-BUSINESS TO
 18507         DFHEIV20
 18508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18509
 18510
 18511     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18512
 18513     IF PB-ISSUE
 18514         GO TO 7000-DISPLAY-ISSUES.
 18515
 18516     IF PB-CANCELLATION
 18517         GO TO 7100-DISPLAY-CANCELS.
 18518
 18519     IF PB-BATCH-TRAILER
 18520         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 339
* EL6311.cbl
 18521
 18522 3990-NOT-FOUND.
 18523     MOVE LOW-VALUES             TO EL631BI.
 18524
 18525     IF PI-MAP-NAME = EL631B
 18526         MOVE -1                  TO BMAINTL
 18527     ELSE
 18528         MOVE -1                  TO CMAINTL.
 18529
 18530     GO TO 8100-SEND-INITIAL-MAP.
 18531
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 340
* EL6311.cbl
 18533
 18534***************************************************************
 18535*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18536*                                                             *
 18537*      1. START BROWSE WITH                                   *
 18538*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18539*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18540*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18541*                                                             *
 18542*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18543*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18544*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18545*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18546*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18547*               AND IS IT TO BE DISPLAYED.                    *
 18548*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18549*               DISPLAYED.                                    *
 18550*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18551*               DISPLAYED.                                    *
 18552*                                                             *
 18553*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18554*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18555***************************************************************
 18556
 18557 4000-BROWSE-DETAIL-FORWARD.
 18558     IF FIRST-TIME
 18559        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18560     ELSE
 18561        IF SHOW-RECORD
 18562           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18563           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18564           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18565           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18566           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18567        ELSE
 18568           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18569
 18570
 18571* EXEC CICS HANDLE CONDITION
 18572*         NOTFND   (4050-END-RECORDS)
 18573*         ENDFILE  (4050-END-RECORDS)
 18574*    END-EXEC.
 18575*    MOVE '"$I''                  ! D #00016060' TO DFHEIV0
 18576     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18578     MOVE X'4420233030303136303630' TO DFHEIV0(25:11)
 18579     CALL 'kxdfhei1' USING DFHEIV0
 18580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18581
 18582
 18583
 18584* EXEC CICS STARTBR
 18585*         DATASET   (FILE-ID-ERPNDB2)
 18586*         RIDFLD    (ERPNDB-ALT-KEY)
 18587*    END-EXEC.
 18588     MOVE 0
 18589       TO DFHEIV11
 18590*    MOVE '&,         G          &   #00016065' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 341
* EL6311.cbl
 18591     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18592     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18593     MOVE X'2020233030303136303635' TO DFHEIV0(25:11)
 18594     CALL 'kxdfhei1' USING DFHEIV0,
 18595           FILE-ID-ERPNDB2,
 18596           ERPNDB-ALT-KEY,
 18597           DFHEIV99,
 18598           DFHEIV11,
 18599           DFHEIV99
 18600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18601
 18602
 18603     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18604
 18605     IF FIRST-TIME OR SHOW-RECORD
 18606        MOVE SPACE               TO WS-FIRST-TIME-SW
 18607        GO TO 4005-READ-NEXT-RECORD.
 18608
 18609
 18610* EXEC CICS READNEXT
 18611*         DATASET    (FILE-ID-ERPNDB2)
 18612*         SET        (ADDRESS OF PENDING-BUSINESS)
 18613*         RIDFLD     (ERPNDB-ALT-KEY)
 18614*    END-EXEC.
 18615     MOVE 0
 18616       TO DFHEIV11
 18617*    MOVE '&.S                   )   #00016076' TO DFHEIV0
 18618     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18619     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18620     MOVE X'2020233030303136303736' TO DFHEIV0(25:11)
 18621     CALL 'kxdfhei1' USING DFHEIV0,
 18622           FILE-ID-ERPNDB2,
 18623           DFHEIV20,
 18624           DFHEIV99,
 18625           ERPNDB-ALT-KEY,
 18626           DFHEIV99,
 18627           DFHEIV11,
 18628           DFHEIV99,
 18629           DFHEIV99
 18630     SET ADDRESS OF PENDING-BUSINESS TO
 18631         DFHEIV20
 18632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18633
 18634
 18635 4005-READ-NEXT-RECORD.
 18636
 18637* EXEC CICS READNEXT
 18638*         DATASET    (FILE-ID-ERPNDB2)
 18639*         SET        (ADDRESS OF PENDING-BUSINESS)
 18640*         RIDFLD     (ERPNDB-ALT-KEY)
 18641*    END-EXEC.
 18642     MOVE 0
 18643       TO DFHEIV11
 18644*    MOVE '&.S                   )   #00016083' TO DFHEIV0
 18645     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18647     MOVE X'2020233030303136303833' TO DFHEIV0(25:11)
 18648     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 342
* EL6311.cbl
 18649           FILE-ID-ERPNDB2,
 18650           DFHEIV20,
 18651           DFHEIV99,
 18652           ERPNDB-ALT-KEY,
 18653           DFHEIV99,
 18654           DFHEIV11,
 18655           DFHEIV99,
 18656           DFHEIV99
 18657     SET ADDRESS OF PENDING-BUSINESS TO
 18658         DFHEIV20
 18659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18660
 18661
 18662     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18663
 18664     IF WS-BATCH-PREFIX = '#CL'
 18665        GO TO 4005-READ-NEXT-RECORD.
 18666
 18667     IF SHOW-RECORD
 18668        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18669           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18670           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18671           PB-STATE         NOT = PI-PB-STATE          OR
 18672           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18673           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18674           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18675           GO TO 4050-END-RECORDS
 18676        ELSE
 18677           GO TO 4010-CHECK-REC-TYPE.
 18678
 18679     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18680        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18681        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18682        PB-STATE            NOT = PI-PB-STATE          OR
 18683        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18684        GO TO 4050-END-RECORDS.
 18685
 18686     IF PB-BATCH-TRAILER
 18687        GO TO 4005-READ-NEXT-RECORD.
 18688
 18689     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18690        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18691           GO TO 4005-READ-NEXT-RECORD
 18692        ELSE
 18693           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18694              GO TO 4010-CHECK-REC-TYPE
 18695           ELSE
 18696              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18697                 GO TO 4010-CHECK-REC-TYPE
 18698              ELSE
 18699                 GO TO 4005-READ-NEXT-RECORD.
 18700
 18701     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18702        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18703           GO TO 4005-READ-NEXT-RECORD.
 18704
 18705 4010-CHECK-REC-TYPE.
 18706     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 343
* EL6311.cbl
 18707         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18708             NEXT SENTENCE
 18709         ELSE
 18710             GO TO 4005-READ-NEXT-RECORD.
 18711
 18712     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18713         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18714             NEXT SENTENCE
 18715        ELSE
 18716             GO TO 4005-READ-NEXT-RECORD.
 18717
 18718     IF NOT DISPLAY-CHANGE-RECORDS AND
 18719            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18720        GO TO 4005-READ-NEXT-RECORD.
 18721
 18722     IF DISPLAY-HOLD-RECORDS AND
 18723        NOT PB-RECORD-ON-HOLD
 18724          GO TO 4005-READ-NEXT-RECORD.
 18725
 18726     IF PB-ISSUE
 18727        IF DISPLAY-CHK-REQ-RECORDS
 18728            GO TO 4005-READ-NEXT-RECORD.
 18729
 18730     IF PB-ISSUE
 18731        IF ISSUE-WITH-WARNING
 18732           IF PB-WARNING-ERRORS
 18733              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18734                  GO TO 4005-READ-NEXT-RECORD
 18735              ELSE
 18736                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18737                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18738                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18739                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18740                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18741                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18742                 GO TO 7000-DISPLAY-ISSUES
 18743           ELSE
 18744              GO TO 4005-READ-NEXT-RECORD.
 18745
 18746     IF PB-ISSUE
 18747        IF (ISSUES-IN-ERROR AND
 18748            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18749            ALL-ISSUES
 18750            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18751            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18752            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18753            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18754            MOVE PB-SV-STATE            TO PI-SV-STATE
 18755            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18756            GO TO 7000-DISPLAY-ISSUES
 18757        ELSE
 18758            GO TO 4005-READ-NEXT-RECORD.
 18759
 18760     IF PB-CANCELLATION
 18761        IF DISPLAY-CHK-REQ-RECORDS
 18762           IF PB-C-REFUND-REQUESTED
 18763              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18764              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 344
* EL6311.cbl
 18765              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18766              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18767              MOVE PB-SV-STATE            TO PI-SV-STATE
 18768              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18769              GO TO 7100-DISPLAY-CANCELS
 18770           ELSE
 18771               GO TO 4005-READ-NEXT-RECORD.
 18772
 18773     IF PB-CANCELLATION
 18774        IF CANCEL-WITH-WARNING
 18775           IF PB-WARNING-ERRORS
 18776              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18777                  GO TO 4005-READ-NEXT-RECORD
 18778              ELSE
 18779                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18780                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18781                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18782                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18783                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18784                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18785                 GO TO 7100-DISPLAY-CANCELS
 18786           ELSE
 18787              GO TO 4005-READ-NEXT-RECORD.
 18788
 18789     IF PB-CANCELLATION
 18790        IF (CANCEL-IN-ERROR  AND
 18791            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18792            ALL-CANCELS
 18793            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18794            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18795            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18796            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18797            MOVE PB-SV-STATE            TO PI-SV-STATE
 18798            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18799            GO TO 7100-DISPLAY-CANCELS.
 18800
 18801     GO TO 4005-READ-NEXT-RECORD.
 18802
 18803 4050-END-RECORDS.
 18804******************************************************************
 18805*                                                                *
 18806*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18807*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18808*         PROGRAM.                                               *
 18809*                                                                *
 18810******************************************************************
 18811
 18812     IF BROWSE-STARTED
 18813        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18814
 18815* EXEC CICS ENDBR
 18816*            DATASET  (FILE-ID-ERPNDB2)
 18817*       END-EXEC.
 18818     MOVE 0
 18819       TO DFHEIV11
 18820*    MOVE '&2                    $   #00016241' TO DFHEIV0
 18821     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 345
* EL6311.cbl
 18823     MOVE X'2020233030303136323431' TO DFHEIV0(25:11)
 18824     CALL 'kxdfhei1' USING DFHEIV0,
 18825           FILE-ID-ERPNDB2,
 18826           DFHEIV11,
 18827           DFHEIV99
 18828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18829
 18830
 18831     IF  EIBTRNID NOT = TRANS-EXB1
 18832         IF PENDING-BUS-RECS-FOUND
 18833             NEXT SENTENCE
 18834           ELSE
 18835             MOVE '9'            TO PI-BROWSE-SW
 18836             GO TO 9400-CLEAR.
 18837
 18838     IF SHOW-RECORD
 18839        MOVE ER-2253            TO EMI-ERROR
 18840       ELSE
 18841        MOVE ER-2254            TO EMI-ERROR.
 18842
 18843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18844
 18845     IF PI-MAP-NAME = SPACES
 18846        MOVE -1                  TO DPFENTRL
 18847        MOVE EL631D               TO PI-MAP-NAME
 18848        GO TO 8100-SEND-INITIAL-MAP.
 18849
 18850     IF PI-MAP-NAME = EL631B
 18851        MOVE -1                  TO BMAINTL
 18852     ELSE
 18853        IF PI-MAP-NAME = EL631C
 18854           MOVE -1               TO CMAINTL
 18855        ELSE
 18856           MOVE -1               TO DPFENTRL.
 18857
 18858     GO TO 8200-SEND-DATAONLY.
 18859
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 346
* EL6311.cbl
 18861
 18862***************************************************************
 18863*                                                             *
 18864*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18865*                                                             *
 18866*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18867*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18868*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18869*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18870*                                                             *
 18871*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18872*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18873*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18874*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18875*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18876*                AND IS IT TO BE DISPLAYED.                   *
 18877*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18878*                DISPLAYED.                                   *
 18879*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18880*                DISPLAYED.                                   *
 18881*                                                             *
 18882*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18883*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18884*                                                             *
 18885*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18886*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18887*                THEY ARE NOT TO BE DISPLAYED.                *
 18888*                                                             *
 18889***************************************************************
 18890
 18891 4100-BROWSE-PRIMARY-FORWARD.
 18892     IF FIRST-TIME  OR SHOW-RECORD
 18893        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18894        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18895        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18896     ELSE
 18897        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18898        IF ERPNDB-BATCH-SEQ-NO = +9999
 18899           GO TO 4150-END-BATCH
 18900        ELSE
 18901           IF DISPLAY-CHANGE-RECORDS
 18902              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18903           ELSE
 18904              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18905              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18906
 18907     IF FIRST-TIME
 18908         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18909            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18910              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18911
 18912
 18913* EXEC CICS HANDLE CONDITION
 18914*         ENDFILE  (4150-END-BATCH)
 18915*    END-EXEC.
 18916*    MOVE '"$''                   ! E #00016326' TO DFHEIV0
 18917     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 347
* EL6311.cbl
 18919     MOVE X'4520233030303136333236' TO DFHEIV0(25:11)
 18920     CALL 'kxdfhei1' USING DFHEIV0
 18921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18922
 18923
 18924 4105-READ-NEXT.
 18925
 18926* EXEC CICS HANDLE CONDITION
 18927*         NOTFND    (4150-END-BATCH)
 18928*    END-EXEC.
 18929*    MOVE '"$I                   ! F #00016331' TO DFHEIV0
 18930     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18932     MOVE X'4620233030303136333331' TO DFHEIV0(25:11)
 18933     CALL 'kxdfhei1' USING DFHEIV0
 18934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18935
 18936
 18937     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18938
 18939     IF PI-DISPLAY-ORIGINAL-BATCH
 18940        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18941     ELSE
 18942        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18943
 18944
 18945* EXEC CICS READ
 18946*         DATASET   (FILE-ID)
 18947*         SET       (ADDRESS OF PENDING-BUSINESS)
 18948*         RIDFLD    (ERPNDB-KEY)
 18949*         GTEQ
 18950*    END-EXEC.
 18951*    MOVE '&"S        G          (   #00016342' TO DFHEIV0
 18952     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18954     MOVE X'2020233030303136333432' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0,
 18956           FILE-ID,
 18957           DFHEIV20,
 18958           DFHEIV99,
 18959           ERPNDB-KEY,
 18960           DFHEIV99,
 18961           DFHEIV99,
 18962           DFHEIV99
 18963     SET ADDRESS OF PENDING-BUSINESS TO
 18964         DFHEIV20
 18965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18966
 18967
 18968     IF PI-DISPLAY-ORIGINAL-BATCH
 18969        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18970           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18971           GO TO 4150-END-BATCH
 18972        ELSE
 18973           IF PB-BATCH-TRAILER
 18974              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18975              GO TO 4105-READ-NEXT
 18976           ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 348
* EL6311.cbl
 18977              NEXT SENTENCE
 18978     ELSE
 18979        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18980           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18981           GO TO 4150-END-BATCH.
 18982
 18983     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18984
 18985     IF WS-BATCH-PREFIX = '#CL'
 18986         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18987         GO TO 4105-READ-NEXT.
 18988
 18989     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18990     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18991     MOVE PB-STATE               TO PI-PB-STATE.
 18992     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18993
 18994     IF PB-BATCH-TRAILER
 18995        IF SHOW-RECORD
 18996           GO TO 4150-END-BATCH
 18997        ELSE
 18998           MOVE ER-2251         TO EMI-ERROR
 18999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19000           MOVE 1               TO PI-BROWSE-TYPE
 19001           GO TO 7200-DISPLAY-BATCHES.
 19002
 19003     IF SHOW-RECORD
 19004           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19005              GO TO 4110-BUMP-SEQ
 19006           ELSE
 19007              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19008                 GO TO 4110-BUMP-SEQ
 19009              ELSE
 19010                 GO TO 4107-CHECK-REC-TYPE.
 19011
 19012     IF NOT  PI-PRIMARY-WITH-SELECT
 19013        GO TO 4107-CHECK-REC-TYPE.
 19014
 19015     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19016        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19017           GO TO 4110-BUMP-SEQ
 19018        ELSE
 19019           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19020              GO TO 4107-CHECK-REC-TYPE
 19021           ELSE
 19022              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19023                 GO TO 4107-CHECK-REC-TYPE
 19024              ELSE
 19025                 GO TO 4110-BUMP-SEQ.
 19026
 19027     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19028        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19029           GO TO 4110-BUMP-SEQ.
 19030
 19031 4107-CHECK-REC-TYPE.
 19032     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19033         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19034             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 349
* EL6311.cbl
 19035           ELSE
 19036             GO TO 4110-BUMP-SEQ.
 19037
 19038     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19039         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19040             NEXT SENTENCE
 19041           ELSE
 19042             GO TO 4110-BUMP-SEQ.
 19043
 19044     IF NOT DISPLAY-CHANGE-RECORDS AND
 19045        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19046           GO TO 4110-BUMP-SEQ.
 19047
 19048     IF DISPLAY-HOLD-RECORDS AND
 19049        NOT PB-RECORD-ON-HOLD
 19050          GO TO 4110-BUMP-SEQ.
 19051
 19052     IF PB-ISSUE
 19053        IF DISPLAY-CHK-REQ-RECORDS
 19054            GO TO 4110-BUMP-SEQ.
 19055
 19056     IF PB-ISSUE
 19057        IF ISSUE-WITH-WARNING
 19058           IF PB-WARNING-ERRORS
 19059              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19060                  GO TO 4110-BUMP-SEQ
 19061              ELSE
 19062                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19063                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19064                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19065                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19066                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19067                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19068                 GO TO 7000-DISPLAY-ISSUES
 19069        ELSE
 19070            GO TO 4110-BUMP-SEQ.
 19071
 19072     IF PB-ISSUE
 19073        IF (ISSUES-IN-ERROR AND
 19074            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19075            ALL-ISSUES
 19076            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19077            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19078            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19079            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19080            MOVE PB-SV-STATE            TO PI-SV-STATE
 19081            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19082            GO TO 7000-DISPLAY-ISSUES
 19083        ELSE
 19084            GO TO 4110-BUMP-SEQ.
 19085
 19086     IF PB-CANCELLATION
 19087        IF DISPLAY-CHK-REQ-RECORDS
 19088           IF PB-C-REFUND-REQUESTED
 19089              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19090              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19091              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19092              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 350
* EL6311.cbl
 19093              MOVE PB-SV-STATE            TO PI-SV-STATE
 19094              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19095              GO TO 7100-DISPLAY-CANCELS
 19096           ELSE
 19097              GO TO 4110-BUMP-SEQ.
 19098
 19099     IF PB-CANCELLATION
 19100        IF CANCEL-WITH-WARNING
 19101           IF PB-WARNING-ERRORS
 19102              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19103                  GO TO 4110-BUMP-SEQ
 19104              ELSE
 19105                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19106                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19107                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19108                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19109                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19110                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19111                 GO TO 7100-DISPLAY-CANCELS
 19112           ELSE
 19113              GO TO 4110-BUMP-SEQ.
 19114
 19115     IF PB-CANCELLATION
 19116        IF (CANCEL-IN-ERROR  AND
 19117            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19118            ALL-CANCELS
 19119            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19120            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19121            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19122            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19123            MOVE PB-SV-STATE            TO PI-SV-STATE
 19124            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19125            GO TO 7100-DISPLAY-CANCELS.
 19126
 19127 4110-BUMP-SEQ.
 19128     IF NOT DISPLAY-CHANGE-RECORDS
 19129        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19130        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19131     ELSE
 19132        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19133           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19134           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19135        ELSE
 19136           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19137           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19138
 19139     GO TO 4105-READ-NEXT.
 19140
 19141 4150-END-BATCH.
 19142******************************************************************
 19143*                                                                *
 19144*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19145*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19146*         PROGRAM.                                               *
 19147*                                                                *
 19148******************************************************************
 19149
 19150     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 351
* EL6311.cbl
 19151         IF PENDING-BUS-RECS-FOUND
 19152             NEXT SENTENCE
 19153           ELSE
 19154             MOVE '9'            TO PI-BROWSE-SW
 19155             GO TO 9400-CLEAR.
 19156
 19157     IF SHOW-RECORD
 19158        MOVE ER-2253             TO EMI-ERROR
 19159     ELSE
 19160        MOVE ER-2251             TO EMI-ERROR.
 19161
 19162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19163
 19164     IF PI-MAP-NAME = SPACES
 19165        MOVE -1                  TO BMAINTL
 19166        MOVE EL631B              TO PI-MAP-NAME
 19167        GO TO 8100-SEND-INITIAL-MAP.
 19168
 19169     IF PI-MAP-NAME = EL631B
 19170        MOVE -1                  TO BMAINTL
 19171     ELSE
 19172        IF PI-MAP-NAME = EL631C
 19173           MOVE -1               TO CMAINTL
 19174        ELSE
 19175           MOVE -1               TO DPFENTRL.
 19176
 19177     GO TO 8200-SEND-DATAONLY.
 19178
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 352
* EL6311.cbl
 19180
 19181***************************************************************
 19182*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19183*                                                             *
 19184*      1. START BROWSE WITH                                   *
 19185*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19186*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19187*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19188*                                                             *
 19189*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19190*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19191*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19192*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19193*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19194*               AND IS IT TO BE DISPLAYED.                    *
 19195*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19196*               DISPLAYED.                                    *
 19197*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19198*               DISPLAYED.                                    *
 19199*                                                             *
 19200*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19201*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19202***************************************************************
 19203
 19204 4200-BROWSE-CSR-FORWARD.
 19205
 19206     IF FIRST-TIME
 19207        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19208     ELSE
 19209        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19210
 19211
 19212* EXEC CICS HANDLE CONDITION
 19213*         NOTFND   (4250-END-RECORDS)
 19214*         ENDFILE  (4250-END-RECORDS)
 19215*    END-EXEC.
 19216*    MOVE '"$I''                  ! G #00016592' TO DFHEIV0
 19217     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19218     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19219     MOVE X'4720233030303136353932' TO DFHEIV0(25:11)
 19220     CALL 'kxdfhei1' USING DFHEIV0
 19221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19222
 19223
 19224
 19225* EXEC CICS STARTBR
 19226*         DATASET   (FILE-ID-ERPNDB4)
 19227*         RIDFLD    (ERPNDB-CSR-KEY)
 19228*    END-EXEC.
 19229     MOVE 0
 19230       TO DFHEIV11
 19231*    MOVE '&,         G          &   #00016597' TO DFHEIV0
 19232     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19233     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19234     MOVE X'2020233030303136353937' TO DFHEIV0(25:11)
 19235     CALL 'kxdfhei1' USING DFHEIV0,
 19236           FILE-ID-ERPNDB4,
 19237           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 353
* EL6311.cbl
 19238           DFHEIV99,
 19239           DFHEIV11,
 19240           DFHEIV99
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19245
 19246     IF FIRST-TIME
 19247        MOVE SPACE               TO WS-FIRST-TIME-SW
 19248        GO TO 4205-READ-NEXT-RECORD.
 19249
 19250
 19251* EXEC CICS READNEXT
 19252*         DATASET    (FILE-ID-ERPNDB4)
 19253*         SET        (ADDRESS OF PENDING-BUSINESS)
 19254*         RIDFLD     (ERPNDB-CSR-KEY)
 19255*    END-EXEC.
 19256     MOVE 0
 19257       TO DFHEIV11
 19258*    MOVE '&.S                   )   #00016608' TO DFHEIV0
 19259     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19260     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19261     MOVE X'2020233030303136363038' TO DFHEIV0(25:11)
 19262     CALL 'kxdfhei1' USING DFHEIV0,
 19263           FILE-ID-ERPNDB4,
 19264           DFHEIV20,
 19265           DFHEIV99,
 19266           ERPNDB-CSR-KEY,
 19267           DFHEIV99,
 19268           DFHEIV11,
 19269           DFHEIV99,
 19270           DFHEIV99
 19271     SET ADDRESS OF PENDING-BUSINESS TO
 19272         DFHEIV20
 19273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19274
 19275
 19276 4205-READ-NEXT-RECORD.
 19277
 19278
 19279* EXEC CICS READNEXT
 19280*         DATASET    (FILE-ID-ERPNDB4)
 19281*         SET        (ADDRESS OF PENDING-BUSINESS)
 19282*         RIDFLD     (ERPNDB-CSR-KEY)
 19283*    END-EXEC.
 19284     MOVE 0
 19285       TO DFHEIV11
 19286*    MOVE '&.S                   )   #00016616' TO DFHEIV0
 19287     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19288     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19289     MOVE X'2020233030303136363136' TO DFHEIV0(25:11)
 19290     CALL 'kxdfhei1' USING DFHEIV0,
 19291           FILE-ID-ERPNDB4,
 19292           DFHEIV20,
 19293           DFHEIV99,
 19294           ERPNDB-CSR-KEY,
 19295           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 354
* EL6311.cbl
 19296           DFHEIV11,
 19297           DFHEIV99,
 19298           DFHEIV99
 19299     SET ADDRESS OF PENDING-BUSINESS TO
 19300         DFHEIV20
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19305
 19306     IF WS-BATCH-PREFIX = '#CL'
 19307        GO TO 4205-READ-NEXT-RECORD.
 19308
 19309     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19310        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19311        GO TO 4250-END-RECORDS.
 19312
 19313     IF PB-BATCH-TRAILER
 19314        GO TO 4205-READ-NEXT-RECORD.
 19315
 19316     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19317        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19318           GO TO 4205-READ-NEXT-RECORD
 19319        ELSE
 19320           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19321              GO TO 4210-CHECK-REC-TYPE
 19322           ELSE
 19323              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19324                 GO TO 4210-CHECK-REC-TYPE
 19325              ELSE
 19326                 GO TO 4205-READ-NEXT-RECORD.
 19327
 19328     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19329        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19330           GO TO 4205-READ-NEXT-RECORD.
 19331
 19332 4210-CHECK-REC-TYPE.
 19333     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19334         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19335             NEXT SENTENCE
 19336         ELSE
 19337             GO TO 4205-READ-NEXT-RECORD.
 19338
 19339     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19340         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19341             NEXT SENTENCE
 19342        ELSE
 19343             GO TO 4205-READ-NEXT-RECORD.
 19344
 19345     IF NOT DISPLAY-CHANGE-RECORDS AND
 19346            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19347        GO TO 4205-READ-NEXT-RECORD.
 19348
 19349     IF DISPLAY-HOLD-RECORDS AND
 19350        NOT PB-RECORD-ON-HOLD
 19351          GO TO 4205-READ-NEXT-RECORD.
 19352
 19353     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 355
* EL6311.cbl
 19354        IF DISPLAY-CHK-REQ-RECORDS
 19355            GO TO 4205-READ-NEXT-RECORD.
 19356
 19357     IF PB-ISSUE
 19358        IF ISSUE-WITH-WARNING
 19359           IF PB-WARNING-ERRORS
 19360              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19361                  GO TO 4205-READ-NEXT-RECORD
 19362              ELSE
 19363                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19364                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19365                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19366                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19367                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19368                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19369                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19370                 GO TO 7000-DISPLAY-ISSUES
 19371           ELSE
 19372              GO TO 4205-READ-NEXT-RECORD.
 19373
 19374     IF PB-ISSUE
 19375        IF (ISSUES-IN-ERROR AND
 19376            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19377            ALL-ISSUES
 19378            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19379            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19380            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19381            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19382            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19383            MOVE PB-SV-STATE            TO PI-SV-STATE
 19384            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19385            GO TO 7000-DISPLAY-ISSUES
 19386        ELSE
 19387            GO TO 4205-READ-NEXT-RECORD.
 19388
 19389     IF PB-CANCELLATION
 19390        IF DISPLAY-CHK-REQ-RECORDS
 19391           IF PB-C-REFUND-REQUESTED
 19392              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19393              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19394              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19395              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19396              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19397              MOVE PB-SV-STATE            TO PI-SV-STATE
 19398              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19399              GO TO 7100-DISPLAY-CANCELS
 19400           ELSE
 19401               GO TO 4205-READ-NEXT-RECORD.
 19402
 19403     IF PB-CANCELLATION
 19404        IF CANCEL-WITH-WARNING
 19405           IF PB-WARNING-ERRORS
 19406              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19407                  GO TO 4205-READ-NEXT-RECORD
 19408              ELSE
 19409                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19410                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19411                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 356
* EL6311.cbl
 19412                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19413                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19414                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19415                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19416                 GO TO 7100-DISPLAY-CANCELS
 19417           ELSE
 19418              GO TO 4205-READ-NEXT-RECORD.
 19419
 19420     IF PB-CANCELLATION
 19421        IF (CANCEL-IN-ERROR  AND
 19422            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19423            ALL-CANCELS
 19424            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19425            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19426            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19427            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19428            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19429            MOVE PB-SV-STATE            TO PI-SV-STATE
 19430            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19431            GO TO 7100-DISPLAY-CANCELS.
 19432
 19433     GO TO 4205-READ-NEXT-RECORD.
 19434
 19435 4250-END-RECORDS.
 19436******************************************************************
 19437*                                                                *
 19438*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19439*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19440*         PROGRAM.                                               *
 19441*                                                                *
 19442******************************************************************
 19443
 19444     IF BROWSE-STARTED
 19445        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19446
 19447* EXEC CICS ENDBR
 19448*            DATASET  (FILE-ID-ERPNDB4)
 19449*       END-EXEC.
 19450     MOVE 0
 19451       TO DFHEIV11
 19452*    MOVE '&2                    $   #00016764' TO DFHEIV0
 19453     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19454     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19455     MOVE X'2020233030303136373634' TO DFHEIV0(25:11)
 19456     CALL 'kxdfhei1' USING DFHEIV0,
 19457           FILE-ID-ERPNDB4,
 19458           DFHEIV11,
 19459           DFHEIV99
 19460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19461
 19462
 19463     IF  EIBTRNID NOT = TRANS-EXB1
 19464         IF PENDING-BUS-RECS-FOUND
 19465             NEXT SENTENCE
 19466           ELSE
 19467             MOVE '9'            TO PI-BROWSE-SW
 19468             GO TO 9400-CLEAR.
 19469
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 357
* EL6311.cbl
 19470     IF SHOW-RECORD
 19471        MOVE ER-2253            TO EMI-ERROR
 19472       ELSE
 19473        MOVE ER-2254            TO EMI-ERROR.
 19474
 19475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19476
 19477     IF PI-MAP-NAME = SPACES
 19478        MOVE -1                  TO DPFENTRL
 19479        MOVE EL631D               TO PI-MAP-NAME
 19480        GO TO 8100-SEND-INITIAL-MAP.
 19481
 19482     IF PI-MAP-NAME = EL631B
 19483        MOVE -1                  TO BMAINTL
 19484     ELSE
 19485        IF PI-MAP-NAME = EL631C
 19486           MOVE -1               TO CMAINTL
 19487        ELSE
 19488           MOVE -1               TO DPFENTRL.
 19489
 19490     GO TO 8200-SEND-DATAONLY.
 19491
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 358
* EL6311.cbl
 19493
 19494***************************************************************
 19495*                                                             *
 19496*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19497*                                                             *
 19498*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19499*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19500*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19501*                                                             *
 19502*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19503*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19504*          A. IS IT WITHIN THE SAME COMPANY                   *
 19505*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19506*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19507*                AND IS IT TO BE DISPLAYED.                   *
 19508*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19509*                DISPLAYED.                                   *
 19510*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19511*                DISPLAYED.                                   *
 19512*                                                             *
 19513*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19514*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19515*                                                             *
 19516*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19517*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19518*                THEY ARE NOT TO BE DISPLAYED.                *
 19519*                                                             *
 19520***************************************************************
 19521
 19522 4300-BROWSE-FILE-FORWARD.
 19523     IF FIRST-TIME OR SHOW-RECORD
 19524        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19525        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19526        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19527     ELSE
 19528        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19529        IF ERPNDB-BATCH-SEQ-NO = +9999
 19530           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19531        ELSE
 19532           IF DISPLAY-CHANGE-RECORDS
 19533              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19534           ELSE
 19535              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19536              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19537
 19538
 19539* EXEC CICS HANDLE CONDITION
 19540*         ENDFILE  (4350-END-BATCH)
 19541*         NOTFND   (4350-END-BATCH)
 19542*    END-EXEC.
 19543*    MOVE '"$''I                  ! H #00016843' TO DFHEIV0
 19544     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19546     MOVE X'4820233030303136383433' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0
 19548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19549
 19550
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 359
* EL6311.cbl
 19551 4305-READ-NEXT.
 19552     IF PI-DISPLAY-ORIGINAL-BATCH
 19553        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19554     ELSE
 19555        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19556
 19557
 19558* EXEC CICS READ
 19559*         DATASET   (FILE-ID)
 19560*         SET       (ADDRESS OF PENDING-BUSINESS)
 19561*         RIDFLD    (ERPNDB-KEY)
 19562*         GTEQ
 19563*    END-EXEC.
 19564*    MOVE '&"S        G          (   #00016854' TO DFHEIV0
 19565     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19567     MOVE X'2020233030303136383534' TO DFHEIV0(25:11)
 19568     CALL 'kxdfhei1' USING DFHEIV0,
 19569           FILE-ID,
 19570           DFHEIV20,
 19571           DFHEIV99,
 19572           ERPNDB-KEY,
 19573           DFHEIV99,
 19574           DFHEIV99,
 19575           DFHEIV99
 19576     SET ADDRESS OF PENDING-BUSINESS TO
 19577         DFHEIV20
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19582        GO TO 4350-END-BATCH.
 19583
 19584     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19585                                    WS-BATCH-NO.
 19586
 19587     IF  WS-BATCH-PREFIX = '#CL'
 19588         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19589         GO TO 4305-READ-NEXT.
 19590
 19591     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19592     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19593     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19594     MOVE PB-STATE               TO PI-PB-STATE.
 19595     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19596
 19597     IF PB-BATCH-TRAILER
 19598        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19599        GO TO 4305-READ-NEXT.
 19600
 19601     IF SHOW-RECORD
 19602           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19603              GO TO 4310-BUMP-SEQ
 19604           ELSE
 19605              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19606                 GO TO 4310-BUMP-SEQ
 19607              ELSE
 19608                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 360
* EL6311.cbl
 19609
 19610     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19611        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19612           GO TO 4310-BUMP-SEQ
 19613        ELSE
 19614           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19615              GO TO 4307-CHECK-REC-TYPE
 19616           ELSE
 19617              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19618                 GO TO 4307-CHECK-REC-TYPE
 19619              ELSE
 19620                 GO TO 4310-BUMP-SEQ.
 19621
 19622     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19623        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19624           GO TO 4310-BUMP-SEQ.
 19625
 19626 4307-CHECK-REC-TYPE.
 19627     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19628         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19629             NEXT SENTENCE
 19630         ELSE
 19631             GO TO 4310-BUMP-SEQ.
 19632
 19633     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19634         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19635             NEXT SENTENCE
 19636        ELSE
 19637             GO TO 4310-BUMP-SEQ.
 19638
 19639     IF NOT DISPLAY-CHANGE-RECORDS AND
 19640            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19641        GO TO 4310-BUMP-SEQ.
 19642
 19643     IF DISPLAY-HOLD-RECORDS AND
 19644        NOT PB-RECORD-ON-HOLD
 19645          GO TO 4310-BUMP-SEQ.
 19646
 19647     IF PB-ISSUE
 19648        IF DISPLAY-CHK-REQ-RECORDS
 19649           GO TO 4310-BUMP-SEQ.
 19650
 19651     IF PB-ISSUE
 19652        IF ISSUE-WITH-WARNING
 19653           IF PB-WARNING-ERRORS
 19654              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19655                  GO TO 4310-BUMP-SEQ
 19656              ELSE
 19657                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19658                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19659                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19660                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19661                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19662                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19663                 GO TO 7000-DISPLAY-ISSUES
 19664           ELSE
 19665              GO TO 4310-BUMP-SEQ.
 19666
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 361
* EL6311.cbl
 19667     IF PB-ISSUE
 19668        IF (ISSUES-IN-ERROR AND
 19669            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19670            ALL-ISSUES
 19671            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19672            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19673            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19674            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19675            MOVE PB-SV-STATE            TO PI-SV-STATE
 19676            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19677            GO TO 7000-DISPLAY-ISSUES
 19678        ELSE
 19679            GO TO 4310-BUMP-SEQ.
 19680
 19681     IF PB-CANCELLATION
 19682        IF DISPLAY-CHK-REQ-RECORDS
 19683           IF PB-C-REFUND-REQUESTED
 19684              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19685              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19686              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19687              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19688              MOVE PB-SV-STATE            TO PI-SV-STATE
 19689              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19690              GO TO 7100-DISPLAY-CANCELS
 19691           ELSE
 19692              GO TO 4310-BUMP-SEQ.
 19693
 19694     IF PB-CANCELLATION
 19695        IF CANCEL-WITH-WARNING
 19696           IF PB-WARNING-ERRORS
 19697              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19698                  GO TO 4310-BUMP-SEQ
 19699              ELSE
 19700                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19701                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19702                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19703                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19704                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19705                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19706                 GO TO 7100-DISPLAY-CANCELS
 19707           ELSE
 19708              GO TO 4310-BUMP-SEQ.
 19709
 19710     IF PB-CANCELLATION
 19711        IF (CANCEL-IN-ERROR  AND
 19712            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19713            ALL-CANCELS
 19714            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19715            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19716            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19717            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19718            MOVE PB-SV-STATE            TO PI-SV-STATE
 19719            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19720            GO TO 7100-DISPLAY-CANCELS.
 19721
 19722 4310-BUMP-SEQ.
 19723     IF NOT DISPLAY-CHANGE-RECORDS
 19724        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 362
* EL6311.cbl
 19725        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19726     ELSE
 19727        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19728           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19729           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19730        ELSE
 19731           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19732           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19733
 19734     GO TO 4305-READ-NEXT.
 19735
 19736 4350-END-BATCH.
 19737
 19738******************************************************************
 19739*                                                                *
 19740*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19741*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19742*         PROGRAM.                                               *
 19743*                                                                *
 19744******************************************************************
 19745
 19746     IF  EIBTRNID NOT = TRANS-EXB1
 19747         IF PENDING-BUS-RECS-FOUND
 19748             NEXT SENTENCE
 19749           ELSE
 19750             MOVE '9'            TO PI-BROWSE-SW
 19751             GO TO 9400-CLEAR.
 19752
 19753     IF SHOW-RECORD
 19754        MOVE ER-2253            TO EMI-ERROR
 19755     ELSE
 19756        MOVE ER-2251            TO EMI-ERROR.
 19757
 19758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19759
 19760     IF PI-MAP-NAME = SPACES
 19761        MOVE -1                  TO BMAINTL
 19762        MOVE EL631B               TO PI-MAP-NAME
 19763        GO TO 8100-SEND-INITIAL-MAP.
 19764
 19765     IF PI-MAP-NAME = EL631B
 19766        MOVE -1                  TO BMAINTL
 19767     ELSE
 19768        IF PI-MAP-NAME = EL631C
 19769           MOVE -1               TO CMAINTL
 19770        ELSE
 19771           MOVE -1               TO DPFENTRL.
 19772
 19773     GO TO 8200-SEND-DATAONLY.
 19774
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 363
* EL6311.cbl
 19776
 19777******************************************************************
 19778*                                                                *
 19779*        B R O W S E   D E T A I L   B A C K W A R D             *
 19780*                                                                *
 19781******************************************************************
 19782
 19783 4500-BROWSE-DETAIL-BACKWARD.
 19784
 19785     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19786
 19787
 19788* EXEC CICS HANDLE CONDITION
 19789*         NOTFND   (4570-NOT-FOUND)
 19790*         ENDFILE  (4550-END-RECORDS)
 19791*    END-EXEC
 19792*    MOVE '"$I''                  ! I #00017067' TO DFHEIV0
 19793     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19795     MOVE X'4920233030303137303637' TO DFHEIV0(25:11)
 19796     CALL 'kxdfhei1' USING DFHEIV0
 19797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19798
 19799
 19800* EXEC CICS STARTBR
 19801*         DATASET   (FILE-ID-ERPNDB2)
 19802*         RIDFLD    (ERPNDB-ALT-KEY)
 19803*    END-EXEC.
 19804     MOVE 0
 19805       TO DFHEIV11
 19806*    MOVE '&,         G          &   #00017072' TO DFHEIV0
 19807     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19809     MOVE X'2020233030303137303732' TO DFHEIV0(25:11)
 19810     CALL 'kxdfhei1' USING DFHEIV0,
 19811           FILE-ID-ERPNDB2,
 19812           ERPNDB-ALT-KEY,
 19813           DFHEIV99,
 19814           DFHEIV11,
 19815           DFHEIV99
 19816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19817
 19818
 19819     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19820                                    WS-FIRST-TIME-SW.
 19821
 19822 4505-READ-PREV-RECORD.
 19823
 19824* EXEC CICS READPREV
 19825*         DATASET    (FILE-ID-ERPNDB2)
 19826*         SET        (ADDRESS OF PENDING-BUSINESS)
 19827*         RIDFLD     (ERPNDB-ALT-KEY)
 19828*    END-EXEC.
 19829     MOVE 0
 19830       TO DFHEIV11
 19831*    MOVE '&0S                   )   #00017081' TO DFHEIV0
 19832     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 364
* EL6311.cbl
 19834     MOVE X'2020233030303137303831' TO DFHEIV0(25:11)
 19835     CALL 'kxdfhei1' USING DFHEIV0,
 19836           FILE-ID-ERPNDB2,
 19837           DFHEIV20,
 19838           DFHEIV99,
 19839           ERPNDB-ALT-KEY,
 19840           DFHEIV99,
 19841           DFHEIV11,
 19842           DFHEIV99,
 19843           DFHEIV99
 19844     SET ADDRESS OF PENDING-BUSINESS TO
 19845         DFHEIV20
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19847
 19848
 19849     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19850
 19851     IF WS-BATCH-PREFIX = '#CL'
 19852         GO TO 4505-READ-PREV-RECORD.
 19853
 19854     IF FIRST-TIME
 19855         MOVE SPACE               TO WS-FIRST-TIME-SW
 19856         GO TO 4505-READ-PREV-RECORD.
 19857
 19858     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19859        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19860        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19861        PB-STATE         NOT = PI-PB-STATE    OR
 19862        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19863          GO TO 4550-END-RECORDS.
 19864
 19865
 19866     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19867
 19868     IF PB-BATCH-TRAILER
 19869        GO TO 4505-READ-PREV-RECORD.
 19870
 19871     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19872
 19873     IF  WS-BATCH-PREFIX = '#CL'
 19874         GO TO 4505-READ-PREV-RECORD.
 19875
 19876     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19877        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19878           GO TO 4505-READ-PREV-RECORD
 19879        ELSE
 19880           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19881              GO TO 4510-CHECK-REC-TYPE
 19882           ELSE
 19883              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19884                 GO TO 4510-CHECK-REC-TYPE
 19885              ELSE
 19886                 GO TO 4505-READ-PREV-RECORD.
 19887
 19888     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19889        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19890           GO TO 4505-READ-PREV-RECORD.
 19891
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 365
* EL6311.cbl
 19892 4510-CHECK-REC-TYPE.
 19893     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19894         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19895             NEXT SENTENCE
 19896         ELSE
 19897             GO TO 4505-READ-PREV-RECORD.
 19898
 19899     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19900         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19901             NEXT SENTENCE
 19902        ELSE
 19903             GO TO 4505-READ-PREV-RECORD.
 19904
 19905     IF NOT DISPLAY-CHANGE-RECORDS AND
 19906            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19907        GO TO 4505-READ-PREV-RECORD.
 19908
 19909     IF DISPLAY-HOLD-RECORDS AND
 19910        NOT PB-RECORD-ON-HOLD
 19911          GO TO 4505-READ-PREV-RECORD.
 19912
 19913     IF PB-ISSUE
 19914        IF DISPLAY-CHK-REQ-RECORDS
 19915           GO TO 4505-READ-PREV-RECORD.
 19916
 19917     IF PB-ISSUE
 19918        IF ISSUE-WITH-WARNING
 19919           IF PB-WARNING-ERRORS
 19920              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19921                  GO TO 4505-READ-PREV-RECORD
 19922              ELSE
 19923                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19924                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19925                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19926                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19927                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19928                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19929                 GO TO 7000-DISPLAY-ISSUES
 19930           ELSE
 19931              GO TO 4505-READ-PREV-RECORD.
 19932
 19933     IF PB-ISSUE
 19934        IF (ISSUES-IN-ERROR AND
 19935            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19936            ALL-ISSUES
 19937            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19938            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19939            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19940            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19941            MOVE PB-SV-STATE            TO PI-SV-STATE
 19942            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19943            GO TO 7000-DISPLAY-ISSUES
 19944        ELSE
 19945            GO TO 4505-READ-PREV-RECORD.
 19946
 19947     IF PB-CANCELLATION
 19948        IF DISPLAY-CHK-REQ-RECORDS
 19949           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 366
* EL6311.cbl
 19950              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19951              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19952              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19953              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19954              MOVE PB-SV-STATE            TO PI-SV-STATE
 19955              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19956              GO TO 7100-DISPLAY-CANCELS
 19957           ELSE
 19958              GO TO 4505-READ-PREV-RECORD.
 19959
 19960     IF PB-CANCELLATION
 19961        IF CANCEL-WITH-WARNING
 19962           IF PB-WARNING-ERRORS
 19963              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19964                  GO TO 4505-READ-PREV-RECORD
 19965              ELSE
 19966                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19967                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19968                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19969                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19970                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19971                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19972                 GO TO 7100-DISPLAY-CANCELS
 19973           ELSE
 19974              GO TO 4505-READ-PREV-RECORD.
 19975
 19976     IF PB-CANCELLATION
 19977        IF (CANCEL-IN-ERROR  AND
 19978            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19979            ALL-CANCELS
 19980            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19981            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19982            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19983            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19984            MOVE PB-SV-STATE            TO PI-SV-STATE
 19985            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19986            GO TO 7100-DISPLAY-CANCELS.
 19987
 19988     GO TO 4505-READ-PREV-RECORD.
 19989
 19990 4550-END-RECORDS.
 19991     IF PI-MAP-NAME = EL631B
 19992        MOVE -1                  TO BMAINTL
 19993     ELSE
 19994        IF PI-MAP-NAME = EL631C
 19995           MOVE -1               TO CMAINTL
 19996        ELSE
 19997           MOVE -1               TO DPFENTRL.
 19998
 19999     MOVE ER-2255               TO EMI-ERROR.
 20000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20001     GO TO 8200-SEND-DATAONLY.
 20002
 20003 4570-NOT-FOUND.
 20004
 20005******************************************************************
 20006*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20007******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 367
* EL6311.cbl
 20008
 20009
 20010* EXEC CICS RESETBR
 20011*         DATASET    (FILE-ID-ERPNDB2)
 20012*         RIDFLD     (ERPNDB-ALT-KEY)
 20013*    END-EXEC.
 20014     MOVE 0
 20015       TO DFHEIV11
 20016*    MOVE '&4         G          &   #00017247' TO DFHEIV0
 20017     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20018     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20019     MOVE X'2020233030303137323437' TO DFHEIV0(25:11)
 20020     CALL 'kxdfhei1' USING DFHEIV0,
 20021           FILE-ID-ERPNDB2,
 20022           ERPNDB-ALT-KEY,
 20023           DFHEIV99,
 20024           DFHEIV11,
 20025           DFHEIV99
 20026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20027
 20028
 20029
 20030* EXEC CICS READNEXT
 20031*         DATASET    (FILE-ID-ERPNDB2)
 20032*         SET        (ADDRESS OF PENDING-BUSINESS)
 20033*         RIDFLD     (ERPNDB-ALT-KEY)
 20034*    END-EXEC.
 20035     MOVE 0
 20036       TO DFHEIV11
 20037*    MOVE '&.S                   )   #00017252' TO DFHEIV0
 20038     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20039     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20040     MOVE X'2020233030303137323532' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0,
 20042           FILE-ID-ERPNDB2,
 20043           DFHEIV20,
 20044           DFHEIV99,
 20045           ERPNDB-ALT-KEY,
 20046           DFHEIV99,
 20047           DFHEIV11,
 20048           DFHEIV99,
 20049           DFHEIV99
 20050     SET ADDRESS OF PENDING-BUSINESS TO
 20051         DFHEIV20
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055
 20056* EXEC CICS READPREV
 20057*         DATASET    (FILE-ID-ERPNDB2)
 20058*         SET        (ADDRESS OF PENDING-BUSINESS)
 20059*         RIDFLD     (ERPNDB-ALT-KEY)
 20060*    END-EXEC.
 20061     MOVE 0
 20062       TO DFHEIV11
 20063*    MOVE '&0S                   )   #00017258' TO DFHEIV0
 20064     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20065     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 368
* EL6311.cbl
 20066     MOVE X'2020233030303137323538' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0,
 20068           FILE-ID-ERPNDB2,
 20069           DFHEIV20,
 20070           DFHEIV99,
 20071           ERPNDB-ALT-KEY,
 20072           DFHEIV99,
 20073           DFHEIV11,
 20074           DFHEIV99,
 20075           DFHEIV99
 20076     SET ADDRESS OF PENDING-BUSINESS TO
 20077         DFHEIV20
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081 4580-READ-PREV-RECORD.
 20082
 20083* EXEC CICS READPREV
 20084*         DATASET    (FILE-ID-ERPNDB2)
 20085*         SET        (ADDRESS OF PENDING-BUSINESS)
 20086*         RIDFLD     (ERPNDB-ALT-KEY)
 20087*    END-EXEC.
 20088     MOVE 0
 20089       TO DFHEIV11
 20090*    MOVE '&0S                   )   #00017265' TO DFHEIV0
 20091     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20092     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20093     MOVE X'2020233030303137323635' TO DFHEIV0(25:11)
 20094     CALL 'kxdfhei1' USING DFHEIV0,
 20095           FILE-ID-ERPNDB2,
 20096           DFHEIV20,
 20097           DFHEIV99,
 20098           ERPNDB-ALT-KEY,
 20099           DFHEIV99,
 20100           DFHEIV11,
 20101           DFHEIV99,
 20102           DFHEIV99
 20103     SET ADDRESS OF PENDING-BUSINESS TO
 20104         DFHEIV20
 20105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20106
 20107
 20108     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20109
 20110     IF WS-BATCH-PREFIX = '#CL'
 20111        GO TO 4580-READ-PREV-RECORD.
 20112
 20113     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20114     GO TO 4505-READ-PREV-RECORD.
 20115
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 369
* EL6311.cbl
 20117
 20118******************************************************************
 20119*                                                                *
 20120*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20121*                                                                *
 20122******************************************************************
 20123
 20124 4600-BROWSE-PRIMARY-BACKWARD.
 20125        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20126
 20127     IF ERPNDB-BATCH-SEQ-NO = +9999
 20128        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20129
 20130        IF ERPNDB-BATCH-SEQ-NO = +0000
 20131           GO TO 4650-END-BATCH
 20132        ELSE
 20133           IF PI-MAP-NAME NOT = EL631D
 20134              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20135                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20136              ELSE
 20137                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20138                 IF DISPLAY-CHANGE-RECORDS
 20139                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20140                 ELSE
 20141                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20142
 20143
 20144* EXEC CICS HANDLE CONDITION
 20145*         NOTFND    (4680-NOT-FOUND)
 20146*         ENDFILE   (4680-NOT-FOUND)
 20147*    END-EXEC.
 20148*    MOVE '"$I''                  ! J #00017306' TO DFHEIV0
 20149     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20151     MOVE X'4A20233030303137333036' TO DFHEIV0(25:11)
 20152     CALL 'kxdfhei1' USING DFHEIV0
 20153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20154
 20155
 20156 4605-READ-NEXT.
 20157     IF ERPNDB-BATCH-SEQ-NO = +0000
 20158        GO TO 4650-END-BATCH.
 20159
 20160     IF PI-DISPLAY-ORIGINAL-BATCH
 20161        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20162     ELSE
 20163        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20164
 20165
 20166* EXEC CICS READ
 20167*         DATASET   (FILE-ID)
 20168*         SET       (ADDRESS OF PENDING-BUSINESS)
 20169*         RIDFLD    (ERPNDB-KEY)
 20170*    END-EXEC.
 20171*    MOVE '&"S        E          (   #00017320' TO DFHEIV0
 20172     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303137333230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 370
* EL6311.cbl
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           FILE-ID,
 20177           DFHEIV20,
 20178           DFHEIV99,
 20179           ERPNDB-KEY,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV99
 20183     SET ADDRESS OF PENDING-BUSINESS TO
 20184         DFHEIV20
 20185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20186
 20187
 20188     IF NOT  PI-PRIMARY-WITH-SELECT
 20189        GO TO 4607-CHECK-REC-TYPE.
 20190
 20191     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20192
 20193     IF  WS-BATCH-PREFIX = '#CL'
 20194         GO TO 4610-BUMP-SEQ.
 20195
 20196     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20197        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20198           GO TO 4610-BUMP-SEQ
 20199        ELSE
 20200           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20201              GO TO 4607-CHECK-REC-TYPE
 20202           ELSE
 20203              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20204                 GO TO 4607-CHECK-REC-TYPE
 20205              ELSE
 20206                 GO TO 4610-BUMP-SEQ.
 20207
 20208     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20209        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20210           GO TO 4610-BUMP-SEQ.
 20211
 20212 4607-CHECK-REC-TYPE.
 20213     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20214         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20215             NEXT SENTENCE
 20216         ELSE
 20217             GO TO 4610-BUMP-SEQ.
 20218
 20219     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20220         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20221             NEXT SENTENCE
 20222        ELSE
 20223             GO TO 4610-BUMP-SEQ.
 20224
 20225     IF NOT DISPLAY-CHANGE-RECORDS AND
 20226            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20227        GO TO 4610-BUMP-SEQ.
 20228
 20229     IF DISPLAY-HOLD-RECORDS AND
 20230        NOT PB-RECORD-ON-HOLD
 20231          GO TO 4610-BUMP-SEQ.
 20232
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 371
* EL6311.cbl
 20233     IF PB-ISSUE
 20234        IF DISPLAY-CHK-REQ-RECORDS
 20235           GO TO 4610-BUMP-SEQ.
 20236
 20237     IF PB-ISSUE
 20238        IF ISSUE-WITH-WARNING
 20239           IF PB-WARNING-ERRORS
 20240              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20241                  GO TO 4610-BUMP-SEQ
 20242              ELSE
 20243                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20244                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20245                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20246                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20247                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20248                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20249                 GO TO 7000-DISPLAY-ISSUES
 20250           ELSE
 20251              GO TO 4610-BUMP-SEQ.
 20252
 20253     IF PB-ISSUE
 20254        IF (ISSUES-IN-ERROR AND
 20255            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20256            ALL-ISSUES
 20257            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20258            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20259            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20260            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20261            MOVE PB-SV-STATE            TO PI-SV-STATE
 20262            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20263            GO TO 7000-DISPLAY-ISSUES
 20264        ELSE
 20265            GO TO 4610-BUMP-SEQ.
 20266
 20267     IF PB-CANCELLATION
 20268        IF DISPLAY-CHK-REQ-RECORDS
 20269           IF PB-C-REFUND-REQUESTED
 20270              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20271              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20272              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20273              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20274              MOVE PB-SV-STATE            TO PI-SV-STATE
 20275              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20276              GO TO 7100-DISPLAY-CANCELS
 20277           ELSE
 20278              GO TO 4610-BUMP-SEQ.
 20279
 20280     IF PB-CANCELLATION
 20281        IF CANCEL-WITH-WARNING
 20282           IF PB-WARNING-ERRORS
 20283              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20284                  GO TO 4610-BUMP-SEQ
 20285              ELSE
 20286                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20287                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20288                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20289                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20290                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 372
* EL6311.cbl
 20291                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20292                 GO TO 7100-DISPLAY-CANCELS
 20293           ELSE
 20294              GO TO 4610-BUMP-SEQ.
 20295
 20296     IF PB-CANCELLATION
 20297        IF (CANCEL-IN-ERROR  AND
 20298            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20299            ALL-CANCELS
 20300            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20301            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20302            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20303            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20304            MOVE PB-SV-STATE            TO PI-SV-STATE
 20305            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20306            GO TO 7100-DISPLAY-CANCELS.
 20307
 20308 4610-BUMP-SEQ.
 20309     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20310        GO TO 4650-END-BATCH.
 20311
 20312     IF DISPLAY-CHANGE-RECORDS
 20313        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20314           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20315        ELSE
 20316           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20317           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20318        ELSE
 20319           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20320           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20321
 20322        GO TO 4605-READ-NEXT.
 20323
 20324 4650-END-BATCH.
 20325     IF PI-MAP-NAME = EL631B
 20326        MOVE -1                  TO BMAINTL
 20327     ELSE
 20328        IF PI-MAP-NAME = EL631C
 20329           MOVE -1               TO CMAINTL
 20330        ELSE
 20331           MOVE -1               TO DPFENTRL.
 20332
 20333     MOVE ER-2252               TO EMI-ERROR.
 20334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20335     GO TO 8200-SEND-DATAONLY.
 20336
 20337 4680-NOT-FOUND.
 20338     IF DISPLAY-CHANGE-RECORDS
 20339        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20340           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20341        ELSE
 20342           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20343           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20344     ELSE
 20345        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20346
 20347     GO TO 4605-READ-NEXT.
 20348
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 373
* EL6311.cbl
 20350
 20351******************************************************************
 20352*                                                                *
 20353*        B R O W S E   F I L E   B A C K W A R D S               *
 20354*                                                                *
 20355******************************************************************
 20356
 20357 4800-BROWSE-FILE-BACKWARD.
 20358
 20359* EXEC CICS HANDLE CONDITION
 20360*         NOTFND   (4860-NOT-FOUND)
 20361*         ENDFILE  (4850-END-RECORDS)
 20362*    END-EXEC.
 20363*    MOVE '"$I''                  ! K #00017496' TO DFHEIV0
 20364     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20366     MOVE X'4B20233030303137343936' TO DFHEIV0(25:11)
 20367     CALL 'kxdfhei1' USING DFHEIV0
 20368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20369
 20370
 20371     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20372
 20373     IF PI-DISPLAY-ORIGINAL-BATCH
 20374        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20375     ELSE
 20376        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20377
 20378
 20379* EXEC CICS STARTBR
 20380*         DATASET   (FILE-ID)
 20381*         RIDFLD    (ERPNDB-KEY)
 20382*    END-EXEC.
 20383     MOVE 0
 20384       TO DFHEIV11
 20385*    MOVE '&,         G          &   #00017508' TO DFHEIV0
 20386     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20387     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20388     MOVE X'2020233030303137353038' TO DFHEIV0(25:11)
 20389     CALL 'kxdfhei1' USING DFHEIV0,
 20390           FILE-ID,
 20391           ERPNDB-KEY,
 20392           DFHEIV99,
 20393           DFHEIV11,
 20394           DFHEIV99
 20395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20396
 20397
 20398     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20399
 20400
 20401* EXEC CICS READPREV
 20402*         DATASET    (FILE-ID-ERPNDB)
 20403*         SET        (ADDRESS OF PENDING-BUSINESS)
 20404*         RIDFLD     (ERPNDB-KEY)
 20405*    END-EXEC.
 20406     MOVE 0
 20407       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 374
* EL6311.cbl
 20408*    MOVE '&0S                   )   #00017515' TO DFHEIV0
 20409     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20410     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20411     MOVE X'2020233030303137353135' TO DFHEIV0(25:11)
 20412     CALL 'kxdfhei1' USING DFHEIV0,
 20413           FILE-ID-ERPNDB,
 20414           DFHEIV20,
 20415           DFHEIV99,
 20416           ERPNDB-KEY,
 20417           DFHEIV99,
 20418           DFHEIV11,
 20419           DFHEIV99,
 20420           DFHEIV99
 20421     SET ADDRESS OF PENDING-BUSINESS TO
 20422         DFHEIV20
 20423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20424
 20425
 20426 4810-READ-PREV-RECORD.
 20427
 20428* EXEC CICS READPREV
 20429*         DATASET    (FILE-ID-ERPNDB)
 20430*         SET        (ADDRESS OF PENDING-BUSINESS)
 20431*         RIDFLD     (ERPNDB-KEY)
 20432*    END-EXEC.
 20433     MOVE 0
 20434       TO DFHEIV11
 20435*    MOVE '&0S                   )   #00017522' TO DFHEIV0
 20436     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20437     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20438     MOVE X'2020233030303137353232' TO DFHEIV0(25:11)
 20439     CALL 'kxdfhei1' USING DFHEIV0,
 20440           FILE-ID-ERPNDB,
 20441           DFHEIV20,
 20442           DFHEIV99,
 20443           ERPNDB-KEY,
 20444           DFHEIV99,
 20445           DFHEIV11,
 20446           DFHEIV99,
 20447           DFHEIV99
 20448     SET ADDRESS OF PENDING-BUSINESS TO
 20449         DFHEIV20
 20450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20451
 20452
 20453     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20454        GO TO 4850-END-RECORDS.
 20455
 20456     IF PB-BATCH-TRAILER
 20457        GO TO 4810-READ-PREV-RECORD.
 20458
 20459     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20460
 20461     IF  WS-BATCH-PREFIX = '#CL'
 20462         GO TO 4810-READ-PREV-RECORD.
 20463
 20464     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20465        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 375
* EL6311.cbl
 20466           GO TO 4810-READ-PREV-RECORD
 20467        ELSE
 20468           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20469              GO TO 4820-CHECK-REC-TYPE
 20470           ELSE
 20471              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20472                 GO TO 4820-CHECK-REC-TYPE
 20473              ELSE
 20474                 GO TO 4810-READ-PREV-RECORD.
 20475
 20476     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20477        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20478           GO TO 4810-READ-PREV-RECORD.
 20479
 20480 4820-CHECK-REC-TYPE.
 20481     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20482         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20483             NEXT SENTENCE
 20484         ELSE
 20485             GO TO 4810-READ-PREV-RECORD.
 20486
 20487     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20488         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20489             NEXT SENTENCE
 20490        ELSE
 20491             GO TO 4810-READ-PREV-RECORD.
 20492
 20493     IF NOT DISPLAY-CHANGE-RECORDS AND
 20494            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20495        GO TO 4810-READ-PREV-RECORD.
 20496
 20497     IF DISPLAY-HOLD-RECORDS AND
 20498        NOT PB-RECORD-ON-HOLD
 20499          GO TO 4810-READ-PREV-RECORD.
 20500
 20501     IF PB-ISSUE
 20502        IF DISPLAY-CHK-REQ-RECORDS
 20503           GO TO 4810-READ-PREV-RECORD.
 20504
 20505     IF PB-ISSUE
 20506        IF ISSUE-WITH-WARNING
 20507           IF PB-WARNING-ERRORS
 20508              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20509                  GO TO 4810-READ-PREV-RECORD
 20510              ELSE
 20511                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20512                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20513                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20514                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20515                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20516                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20517                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20518                 GO TO 7000-DISPLAY-ISSUES
 20519           ELSE
 20520              GO TO 4810-READ-PREV-RECORD.
 20521
 20522     IF PB-ISSUE
 20523        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 376
* EL6311.cbl
 20524            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20525            ALL-ISSUES
 20526            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20527            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20528            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20529            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20530            MOVE PB-SV-STATE            TO PI-SV-STATE
 20531            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20532            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20533            GO TO 7000-DISPLAY-ISSUES
 20534        ELSE
 20535            GO TO 4810-READ-PREV-RECORD.
 20536
 20537     IF PB-CANCELLATION
 20538        IF DISPLAY-CHK-REQ-RECORDS
 20539           IF PB-C-REFUND-REQUESTED
 20540              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20541              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20542              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20543              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20544              MOVE PB-SV-STATE            TO PI-SV-STATE
 20545              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20546              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20547              GO TO 7100-DISPLAY-CANCELS
 20548           ELSE
 20549              GO TO 4810-READ-PREV-RECORD.
 20550
 20551     IF PB-CANCELLATION
 20552        IF CANCEL-WITH-WARNING
 20553           IF PB-WARNING-ERRORS
 20554              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20555                  GO TO 4810-READ-PREV-RECORD
 20556              ELSE
 20557                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20558                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20559                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20560                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20561                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20562                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20563                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20564                 GO TO 7100-DISPLAY-CANCELS
 20565           ELSE
 20566              GO TO 4810-READ-PREV-RECORD.
 20567
 20568     IF PB-CANCELLATION
 20569        IF (CANCEL-IN-ERROR  AND
 20570            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20571            ALL-CANCELS
 20572            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20573            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20574            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20575            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20576            MOVE PB-SV-STATE            TO PI-SV-STATE
 20577            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20578            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20579            GO TO 7100-DISPLAY-CANCELS.
 20580
 20581     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 377
* EL6311.cbl
 20582
 20583 4850-END-RECORDS.
 20584     MOVE ER-2252                TO EMI-ERROR.
 20585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20586
 20587     IF PI-MAP-NAME = EL631B
 20588        MOVE -1                  TO BPFENTRL
 20589     ELSE
 20590        MOVE -1                  TO CPFENTRL.
 20591
 20592     GO TO 8200-SEND-DATAONLY.
 20593
 20594 4860-NOT-FOUND.
 20595
 20596******************************************************************
 20597*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20598******************************************************************
 20599
 20600
 20601* EXEC CICS RESETBR
 20602*         DATASET    (FILE-ID-ERPNDB)
 20603*         RIDFLD     (ERPNDB-KEY)
 20604*     END-EXEC.
 20605     MOVE 0
 20606       TO DFHEIV11
 20607*    MOVE '&4         G          &   #00017675' TO DFHEIV0
 20608     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20609     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20610     MOVE X'2020233030303137363735' TO DFHEIV0(25:11)
 20611     CALL 'kxdfhei1' USING DFHEIV0,
 20612           FILE-ID-ERPNDB,
 20613           ERPNDB-KEY,
 20614           DFHEIV99,
 20615           DFHEIV11,
 20616           DFHEIV99
 20617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20618
 20619
 20620
 20621* EXEC CICS READNEXT
 20622*         DATASET    (FILE-ID-ERPNDB)
 20623*         SET        (ADDRESS OF PENDING-BUSINESS)
 20624*         RIDFLD     (ERPNDB-KEY)
 20625*    END-EXEC.
 20626     MOVE 0
 20627       TO DFHEIV11
 20628*    MOVE '&.S                   )   #00017680' TO DFHEIV0
 20629     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20630     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20631     MOVE X'2020233030303137363830' TO DFHEIV0(25:11)
 20632     CALL 'kxdfhei1' USING DFHEIV0,
 20633           FILE-ID-ERPNDB,
 20634           DFHEIV20,
 20635           DFHEIV99,
 20636           ERPNDB-KEY,
 20637           DFHEIV99,
 20638           DFHEIV11,
 20639           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 378
* EL6311.cbl
 20640           DFHEIV99
 20641     SET ADDRESS OF PENDING-BUSINESS TO
 20642         DFHEIV20
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646
 20647* EXEC CICS READPREV
 20648*         DATASET    (FILE-ID-ERPNDB)
 20649*         SET        (ADDRESS OF PENDING-BUSINESS)
 20650*         RIDFLD     (ERPNDB-KEY)
 20651*    END-EXEC.
 20652     MOVE 0
 20653       TO DFHEIV11
 20654*    MOVE '&0S                   )   #00017686' TO DFHEIV0
 20655     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20656     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20657     MOVE X'2020233030303137363836' TO DFHEIV0(25:11)
 20658     CALL 'kxdfhei1' USING DFHEIV0,
 20659           FILE-ID-ERPNDB,
 20660           DFHEIV20,
 20661           DFHEIV99,
 20662           ERPNDB-KEY,
 20663           DFHEIV99,
 20664           DFHEIV11,
 20665           DFHEIV99,
 20666           DFHEIV99
 20667     SET ADDRESS OF PENDING-BUSINESS TO
 20668         DFHEIV20
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20670
 20671
 20672     GO TO 4810-READ-PREV-RECORD.
 20673
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 379
* EL6311.cbl
 20675
 20676******************************************************************
 20677*                                                                *
 20678*           B R O W S E   C S R   B A C K W A R D                *
 20679*                                                                *
 20680******************************************************************
 20681
 20682 4900-BROWSE-CSR-BACKWARD.
 20683
 20684     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20685
 20686
 20687* EXEC CICS HANDLE CONDITION
 20688*         NOTFND   (4970-NOT-FOUND)
 20689*         ENDFILE  (4950-END-RECORDS)
 20690*    END-EXEC
 20691*    MOVE '"$I''                  ! L #00017706' TO DFHEIV0
 20692     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20694     MOVE X'4C20233030303137373036' TO DFHEIV0(25:11)
 20695     CALL 'kxdfhei1' USING DFHEIV0
 20696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20697
 20698
 20699* EXEC CICS STARTBR
 20700*         DATASET   (FILE-ID-ERPNDB4)
 20701*         RIDFLD    (ERPNDB-CSR-KEY)
 20702*    END-EXEC.
 20703     MOVE 0
 20704       TO DFHEIV11
 20705*    MOVE '&,         G          &   #00017711' TO DFHEIV0
 20706     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20708     MOVE X'2020233030303137373131' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           FILE-ID-ERPNDB4,
 20711           ERPNDB-CSR-KEY,
 20712           DFHEIV99,
 20713           DFHEIV11,
 20714           DFHEIV99
 20715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20716
 20717
 20718     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20719                                    WS-FIRST-TIME-SW.
 20720
 20721 4905-READ-PREV-RECORD.
 20722
 20723* EXEC CICS READPREV
 20724*         DATASET    (FILE-ID-ERPNDB4)
 20725*         SET        (ADDRESS OF PENDING-BUSINESS)
 20726*         RIDFLD     (ERPNDB-CSR-KEY)
 20727*    END-EXEC.
 20728     MOVE 0
 20729       TO DFHEIV11
 20730*    MOVE '&0S                   )   #00017720' TO DFHEIV0
 20731     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20732     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 380
* EL6311.cbl
 20733     MOVE X'2020233030303137373230' TO DFHEIV0(25:11)
 20734     CALL 'kxdfhei1' USING DFHEIV0,
 20735           FILE-ID-ERPNDB4,
 20736           DFHEIV20,
 20737           DFHEIV99,
 20738           ERPNDB-CSR-KEY,
 20739           DFHEIV99,
 20740           DFHEIV11,
 20741           DFHEIV99,
 20742           DFHEIV99
 20743     SET ADDRESS OF PENDING-BUSINESS TO
 20744         DFHEIV20
 20745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20746
 20747
 20748     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20749
 20750     IF WS-BATCH-PREFIX = '#CL'
 20751         GO TO 4905-READ-PREV-RECORD.
 20752
 20753     IF FIRST-TIME
 20754         MOVE SPACE               TO WS-FIRST-TIME-SW
 20755         GO TO 4905-READ-PREV-RECORD.
 20756
 20757     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20758        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20759        GO TO 4950-END-RECORDS.
 20760
 20761     IF PB-BATCH-TRAILER
 20762        GO TO 4905-READ-PREV-RECORD.
 20763
 20764     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20765
 20766     IF  WS-BATCH-PREFIX = '#CL'
 20767         GO TO 4905-READ-PREV-RECORD.
 20768
 20769     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20770        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20771           GO TO 4905-READ-PREV-RECORD
 20772        ELSE
 20773           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20774              GO TO 4910-CHECK-REC-TYPE
 20775           ELSE
 20776              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20777                 GO TO 4910-CHECK-REC-TYPE
 20778              ELSE
 20779                 GO TO 4905-READ-PREV-RECORD.
 20780
 20781     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20782        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20783           GO TO 4905-READ-PREV-RECORD.
 20784
 20785 4910-CHECK-REC-TYPE.
 20786     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20787         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20788             NEXT SENTENCE
 20789         ELSE
 20790             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 381
* EL6311.cbl
 20791
 20792     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20793         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20794             NEXT SENTENCE
 20795        ELSE
 20796             GO TO 4905-READ-PREV-RECORD.
 20797
 20798     IF NOT DISPLAY-CHANGE-RECORDS AND
 20799            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20800        GO TO 4905-READ-PREV-RECORD.
 20801
 20802     IF DISPLAY-HOLD-RECORDS AND
 20803        NOT PB-RECORD-ON-HOLD
 20804          GO TO 4905-READ-PREV-RECORD.
 20805
 20806     IF PB-ISSUE
 20807        IF DISPLAY-CHK-REQ-RECORDS
 20808           GO TO 4905-READ-PREV-RECORD.
 20809
 20810     IF PB-ISSUE
 20811        IF ISSUE-WITH-WARNING
 20812           IF PB-WARNING-ERRORS
 20813              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20814                  GO TO 4505-READ-PREV-RECORD
 20815              ELSE
 20816                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20817                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20818                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20819                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20820                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20821                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20822                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20823                 GO TO 7000-DISPLAY-ISSUES
 20824           ELSE
 20825              GO TO 4905-READ-PREV-RECORD.
 20826
 20827     IF PB-ISSUE
 20828        IF (ISSUES-IN-ERROR AND
 20829            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20830            ALL-ISSUES
 20831            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20832            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20833            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20834            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20835            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20836            MOVE PB-SV-STATE            TO PI-SV-STATE
 20837            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20838            GO TO 7000-DISPLAY-ISSUES
 20839        ELSE
 20840            GO TO 4905-READ-PREV-RECORD.
 20841
 20842     IF PB-CANCELLATION
 20843        IF DISPLAY-CHK-REQ-RECORDS
 20844           IF PB-C-REFUND-REQUESTED
 20845              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20846              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20847              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20848              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 382
* EL6311.cbl
 20849              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20850              MOVE PB-SV-STATE            TO PI-SV-STATE
 20851              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20852              GO TO 7100-DISPLAY-CANCELS
 20853           ELSE
 20854              GO TO 4905-READ-PREV-RECORD.
 20855
 20856     IF PB-CANCELLATION
 20857        IF CANCEL-WITH-WARNING
 20858           IF PB-WARNING-ERRORS
 20859              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20860                  GO TO 4505-READ-PREV-RECORD
 20861              ELSE
 20862                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20863                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20864                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20865                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20866                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20867                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20868                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20869                 GO TO 7100-DISPLAY-CANCELS
 20870           ELSE
 20871              GO TO 4905-READ-PREV-RECORD.
 20872
 20873     IF PB-CANCELLATION
 20874        IF (CANCEL-IN-ERROR  AND
 20875            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20876            ALL-CANCELS
 20877            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20878            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20879            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20880            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20881            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20882            MOVE PB-SV-STATE            TO PI-SV-STATE
 20883            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20884            GO TO 7100-DISPLAY-CANCELS.
 20885
 20886     GO TO 4905-READ-PREV-RECORD.
 20887
 20888 4950-END-RECORDS.
 20889     IF PI-MAP-NAME = EL631B
 20890        MOVE -1                  TO BMAINTL
 20891     ELSE
 20892        IF PI-MAP-NAME = EL631C
 20893           MOVE -1               TO CMAINTL
 20894        ELSE
 20895           MOVE -1               TO DPFENTRL.
 20896
 20897     MOVE ER-2255               TO EMI-ERROR.
 20898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20899     GO TO 8200-SEND-DATAONLY.
 20900
 20901 4970-NOT-FOUND.
 20902
 20903******************************************************************
 20904*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20905******************************************************************
 20906
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 383
* EL6311.cbl
 20907
 20908* EXEC CICS RESETBR
 20909*         DATASET    (FILE-ID-ERPNDB4)
 20910*         RIDFLD     (ERPNDB-CSR-KEY)
 20911*    END-EXEC.
 20912     MOVE 0
 20913       TO DFHEIV11
 20914*    MOVE '&4         G          &   #00017885' TO DFHEIV0
 20915     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20917     MOVE X'2020233030303137383835' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0,
 20919           FILE-ID-ERPNDB4,
 20920           ERPNDB-CSR-KEY,
 20921           DFHEIV99,
 20922           DFHEIV11,
 20923           DFHEIV99
 20924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20925
 20926
 20927
 20928* EXEC CICS READNEXT
 20929*         DATASET    (FILE-ID-ERPNDB4)
 20930*         SET        (ADDRESS OF PENDING-BUSINESS)
 20931*         RIDFLD     (ERPNDB-CSR-KEY)
 20932*    END-EXEC.
 20933     MOVE 0
 20934       TO DFHEIV11
 20935*    MOVE '&.S                   )   #00017890' TO DFHEIV0
 20936     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20938     MOVE X'2020233030303137383930' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0,
 20940           FILE-ID-ERPNDB4,
 20941           DFHEIV20,
 20942           DFHEIV99,
 20943           ERPNDB-CSR-KEY,
 20944           DFHEIV99,
 20945           DFHEIV11,
 20946           DFHEIV99,
 20947           DFHEIV99
 20948     SET ADDRESS OF PENDING-BUSINESS TO
 20949         DFHEIV20
 20950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20951
 20952
 20953
 20954* EXEC CICS READPREV
 20955*         DATASET    (FILE-ID-ERPNDB4)
 20956*         SET        (ADDRESS OF PENDING-BUSINESS)
 20957*         RIDFLD     (ERPNDB-CSR-KEY)
 20958*    END-EXEC.
 20959     MOVE 0
 20960       TO DFHEIV11
 20961*    MOVE '&0S                   )   #00017896' TO DFHEIV0
 20962     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20964     MOVE X'2020233030303137383936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 384
* EL6311.cbl
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           FILE-ID-ERPNDB4,
 20967           DFHEIV20,
 20968           DFHEIV99,
 20969           ERPNDB-CSR-KEY,
 20970           DFHEIV99,
 20971           DFHEIV11,
 20972           DFHEIV99,
 20973           DFHEIV99
 20974     SET ADDRESS OF PENDING-BUSINESS TO
 20975         DFHEIV20
 20976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20977
 20978
 20979 4980-READ-PREV-RECORD.
 20980
 20981* EXEC CICS READPREV
 20982*         DATASET    (FILE-ID-ERPNDB4)
 20983*         SET        (ADDRESS OF PENDING-BUSINESS)
 20984*         RIDFLD     (ERPNDB-CSR-KEY)
 20985*    END-EXEC.
 20986     MOVE 0
 20987       TO DFHEIV11
 20988*    MOVE '&0S                   )   #00017903' TO DFHEIV0
 20989     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20990     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20991     MOVE X'2020233030303137393033' TO DFHEIV0(25:11)
 20992     CALL 'kxdfhei1' USING DFHEIV0,
 20993           FILE-ID-ERPNDB4,
 20994           DFHEIV20,
 20995           DFHEIV99,
 20996           ERPNDB-CSR-KEY,
 20997           DFHEIV99,
 20998           DFHEIV11,
 20999           DFHEIV99,
 21000           DFHEIV99
 21001     SET ADDRESS OF PENDING-BUSINESS TO
 21002         DFHEIV20
 21003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21004
 21005
 21006     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21007
 21008     IF WS-BATCH-PREFIX = '#CL'
 21009        GO TO 4980-READ-PREV-RECORD.
 21010
 21011     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21012     GO TO 4905-READ-PREV-RECORD.
 21013
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 385
* EL6311.cbl
 21015
 21016
 21017******************************************************************
 21018*                                                                *
 21019*        B R O W S E   B A T C H   H E A D E R S                 *
 21020*                                                                *
 21021******************************************************************
 21022
 21023 5000-BROWSE-BATCH-HEADERS.
 21024
 21025     IF EIBTRNID NOT = TRANS-EXB1
 21026        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21027        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21028        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21029        GO TO 5010-READ-NEXT-RECORD.
 21030
 21031     IF EIBAID = DFHPF4
 21032        MOVE '0'                TO PI-EDIT-SW
 21033        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21034        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21035        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21036        GO TO 5010-READ-NEXT-RECORD.
 21037
 21038     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21039     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21040     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21041
 21042
 21043* EXEC CICS HANDLE CONDITION
 21044*         ENDFILE  (5050-NOT-FOUND)
 21045*    END-EXEC.
 21046*    MOVE '"$''                   ! M #00017945' TO DFHEIV0
 21047     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21049     MOVE X'4D20233030303137393435' TO DFHEIV0(25:11)
 21050     CALL 'kxdfhei1' USING DFHEIV0
 21051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21052
 21053
 21054 5010-READ-NEXT-RECORD.
 21055
 21056* EXEC CICS HANDLE CONDITION
 21057*         NOTFND    (5050-NOT-FOUND)
 21058*    END-EXEC.
 21059*    MOVE '"$I                   ! N #00017950' TO DFHEIV0
 21060     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21062     MOVE X'4E20233030303137393530' TO DFHEIV0(25:11)
 21063     CALL 'kxdfhei1' USING DFHEIV0
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067
 21068* EXEC CICS READ
 21069*         DATASET   (FILE-ID-ERPNDB)
 21070*         SET       (ADDRESS OF PENDING-BUSINESS)
 21071*         RIDFLD    (ERPNDB-KEY)
 21072*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 386
* EL6311.cbl
 21073*    END-EXEC.
 21074*    MOVE '&"S        G          (   #00017954' TO DFHEIV0
 21075     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21077     MOVE X'2020233030303137393534' TO DFHEIV0(25:11)
 21078     CALL 'kxdfhei1' USING DFHEIV0,
 21079           FILE-ID-ERPNDB,
 21080           DFHEIV20,
 21081           DFHEIV99,
 21082           ERPNDB-KEY,
 21083           DFHEIV99,
 21084           DFHEIV99,
 21085           DFHEIV99
 21086     SET ADDRESS OF PENDING-BUSINESS TO
 21087         DFHEIV20
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21089
 21090
 21091     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21092         GO TO 5050-NOT-FOUND.
 21093
 21094     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21095
 21096     IF WS-BATCH-PREFIX = '#CL'
 21097         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21098         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21099         GO TO 5010-READ-NEXT-RECORD.
 21100
 21101     IF NOT PB-BATCH-TRAILER
 21102         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21103         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21104         GO TO 5010-READ-NEXT-RECORD.
 21105
 21106     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21107         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21108             NEXT SENTENCE
 21109         ELSE
 21110             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21111             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21112             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21113             GO TO 5010-READ-NEXT-RECORD.
 21114
 21115     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21116         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21117             NEXT SENTENCE
 21118        ELSE
 21119             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21120             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21121             GO TO 5010-READ-NEXT-RECORD.
 21122
 21123     IF EIBAID = DFHPF4
 21124        MOVE '0'                TO PI-EDIT-SW
 21125        GO TO 7200-DISPLAY-BATCHES.
 21126
 21127     IF PI-CSR-BROWSE
 21128        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21129           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21130           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 387
* EL6311.cbl
 21131           GO TO 5010-READ-NEXT-RECORD.
 21132
 21133     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21134       IF PI-PB-CARRIER    = SPACES AND
 21135          PI-PB-GROUPING   = SPACES AND
 21136          PI-PB-STATE      = SPACES AND
 21137          PI-PB-ACCOUNT    = SPACES
 21138            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21139            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21140            GO TO 7200-DISPLAY-BATCHES
 21141         ELSE
 21142           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21143              PI-PB-GROUPING   = PB-GROUPING AND
 21144              PI-PB-STATE      = PB-STATE    AND
 21145              PI-PB-ACCOUNT    = PB-ACCOUNT
 21146              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21147              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21148              GO TO 7200-DISPLAY-BATCHES.
 21149
 21150     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21151     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21152
 21153
 21154* EXEC CICS HANDLE CONDITION
 21155*         NOTFND    (5050-NOT-FOUND)
 21156*    END-EXEC.
 21157*    MOVE '"$I                   ! O #00018023' TO DFHEIV0
 21158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21160     MOVE X'4F20233030303138303233' TO DFHEIV0(25:11)
 21161     CALL 'kxdfhei1' USING DFHEIV0
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165
 21166* EXEC CICS READ
 21167*         DATASET   (FILE-ID-ERPNDB)
 21168*         SET       (ADDRESS OF PENDING-BUSINESS)
 21169*         RIDFLD    (ERPNDB-KEY)
 21170*         GTEQ
 21171*    END-EXEC.
 21172*    MOVE '&"S        G          (   #00018027' TO DFHEIV0
 21173     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21175     MOVE X'2020233030303138303237' TO DFHEIV0(25:11)
 21176     CALL 'kxdfhei1' USING DFHEIV0,
 21177           FILE-ID-ERPNDB,
 21178           DFHEIV20,
 21179           DFHEIV99,
 21180           ERPNDB-KEY,
 21181           DFHEIV99,
 21182           DFHEIV99,
 21183           DFHEIV99
 21184     SET ADDRESS OF PENDING-BUSINESS TO
 21185         DFHEIV20
 21186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21187
 21188
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 388
* EL6311.cbl
 21189     GO TO 5010-READ-NEXT-RECORD.
 21190
 21191 5050-NOT-FOUND.
 21192
 21193******************************************************************
 21194*                                                                *
 21195*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21196*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21197*         PROGRAM.                                               *
 21198*                                                                *
 21199******************************************************************
 21200
 21201     IF EIBTRNID NOT = TRANS-EXB1
 21202        IF PENDING-BUS-RECS-FOUND
 21203            NEXT SENTENCE
 21204          ELSE
 21205            MOVE '9'            TO PI-BROWSE-SW
 21206            GO TO 9400-CLEAR.
 21207
 21208     MOVE ER-2256                TO EMI-ERROR.
 21209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21210
 21211     IF PI-MAP-NAME = SPACES
 21212        MOVE EL631D              TO PI-MAP-NAME
 21213        MOVE -1                  TO DPFENTRL
 21214        GO TO 8100-SEND-INITIAL-MAP.
 21215
 21216     IF PI-MAP-NAME = EL631B
 21217        MOVE -1                  TO BMAINTL
 21218     ELSE
 21219        IF PI-MAP-NAME = EL631C
 21220           MOVE -1               TO CMAINTL
 21221        ELSE
 21222           MOVE -1               TO DPFENTRL
 21223           GO TO 8200-SEND-DATAONLY.
 21224
 21225     GO TO 8100-SEND-INITIAL-MAP.
 21226
 21227     .
 21228 5100-PROCESS-POL-RESC.
 21229     MOVE ZEROS                  TO CG-LF-BENCD
 21230                                    CG-AH-BENCD
 21231                                    CG-LF-CAN-AMT
 21232                                    CG-AH-CAN-AMT
 21233     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21234                                    CG-AH-CAN-DT
 21235     MOVE SPACES                 TO CG-BATCH-NO
 21236     MOVE '4'                    TO CG-OPTION-CODE
 21237     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21238     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21239     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21240     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21241     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21242     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21243     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21244     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21245     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21246     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 389
* EL6311.cbl
 21247     MOVE PI-PREV-ALT-KEY (1:33)
 21248                                 TO CG-CERT-KEY
 21249     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21250     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21251                                    CG-AH-CAN-AMT
 21252     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21253                                    CG-AH-CAN-DT
 21254     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21255     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21256      display 'about to cancel ' cg-cert-key
 21257
 21258* EXEC CICS LINK
 21259*        PROGRAM  ('ELCANC')
 21260*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21261*    END-EXEC
 21262     MOVE LENGTH OF
 21263      CANCEL-GEN-PASS-AREA
 21264       TO DFHEIV11
 21265     MOVE 'ELCANC' TO DFHEIV1
 21266*    MOVE '."C                   (   #00018102' TO DFHEIV0
 21267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21269     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0,
 21271           DFHEIV1,
 21272           CANCEL-GEN-PASS-AREA,
 21273           DFHEIV11,
 21274           DFHEIV99,
 21275           DFHEIV99,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21279     IF CG-SUCCESS
 21280        CONTINUE
 21281     ELSE
 21282        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21283        MOVE '3'                 TO EMI-SWITCH1
 21284        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21285        EVALUATE TRUE
 21286           WHEN CG-DATE-ERROR
 21287             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21288           WHEN CG-CERT-NOT-FOUND
 21289             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21290           WHEN CG-AMOUNT-ERROR
 21291             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21292           WHEN CG-OPTION-ERROR
 21293             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21294           WHEN CG-PREV-CAN
 21295             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21296           WHEN CG-INVALID-DATA
 21297             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21298           WHEN CG-NO-ACCT-MSTR
 21299             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21300           WHEN CG-SFX-A-EXIST
 21301             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21302           WHEN CG-MISC-ERROR
 21303             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21304           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 390
* EL6311.cbl
 21305             MOVE ' ERROR - ELCANC - RETURN '
 21306                                 TO EMI-ERROR-TEXT (1) (12:25)
 21307        END-EVALUATE
 21308        GO TO 8200-SEND-DATAONLY
 21309     END-IF
 21310
 21311* EXEC CICS GETMAIN
 21312*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21313*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21314*        INITIMG (GETMAIN-SPACE)
 21315*    END-EXEC
 21316*    MOVE ',"IL                  $   #00018137' TO DFHEIV0
 21317     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21318     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21319     MOVE X'2020233030303138313337' TO DFHEIV0(25:11)
 21320     CALL 'kxdfhei1' USING DFHEIV0,
 21321           DFHEIV20,
 21322           ELCRTT-RECORD-LENGTH,
 21323           GETMAIN-SPACE
 21324     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21325         DFHEIV20
 21326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21327
 21328     move ' '                    to ws-elcrtt-update-sw
 21329     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21330     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21331
 21332
 21333* EXEC CICS READ
 21334*        UPDATE
 21335*        DATASET  (CRTT-ID)
 21336*        RIDFLD   (ELCRTT-KEY)
 21337*        INTO     (CERTIFICATE-TRAILERS)
 21338*        resp     (ws-response)
 21339*    END-EXEC
 21340     MOVE LENGTH OF
 21341      CERTIFICATE-TRAILERS
 21342       TO DFHEIV11
 21343*    MOVE '&"IL       EU         (  N#00018147' TO DFHEIV0
 21344     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21346     MOVE X'204E233030303138313437' TO DFHEIV0(25:11)
 21347     CALL 'kxdfhei1' USING DFHEIV0,
 21348           CRTT-ID,
 21349           CERTIFICATE-TRAILERS,
 21350           DFHEIV11,
 21351           ELCRTT-KEY,
 21352           DFHEIV99,
 21353           DFHEIV99,
 21354           DFHEIV99
 21355     MOVE EIBRESP  TO ws-response
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21357
 21358     if resp-normal
 21359        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21360                  'E' or 'F' or 'G'
 21361           move 'J'              to cs-claim-verification-status
 21362           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 391
* EL6311.cbl
 21363        end-if
 21364        if update-elcrtt
 21365
 21366* EXEC CICS REWRITE
 21367*             DATASET    (crtt-ID)
 21368*             FROM       (CERTIFICATE-TRAILERS)
 21369*          END-EXEC
 21370     MOVE LENGTH OF
 21371      CERTIFICATE-TRAILERS
 21372       TO DFHEIV11
 21373*    MOVE '&& L                  %   #00018162' TO DFHEIV0
 21374     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21375     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21376     MOVE X'2020233030303138313632' TO DFHEIV0(25:11)
 21377     CALL 'kxdfhei1' USING DFHEIV0,
 21378           crtt-ID,
 21379           CERTIFICATE-TRAILERS,
 21380           DFHEIV11,
 21381           DFHEIV99
 21382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21383        else
 21384
 21385* exec cics unlock
 21386*             dataset    (crtt-ID)
 21387*          end-exec
 21388*    MOVE '&*                    #   #00018167' TO DFHEIV0
 21389     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21390     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21391     MOVE X'2020233030303138313637' TO DFHEIV0(25:11)
 21392     CALL 'kxdfhei1' USING DFHEIV0,
 21393           crtt-ID,
 21394           DFHEIV99
 21395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21396        end-if
 21397     end-if
 21398     .
 21399 5100-EXIT.
 21400     EXIT.
 21401
 21402******************************************************************
 21403*                                                                *
 21404*        B R O W S E   B A T C H   B A C K W A R D S             *
 21405*                                                                *
 21406******************************************************************
 21407
 21408 5500-BROWSE-BATCH-BACKWARD.
 21409
 21410* EXEC CICS HANDLE CONDITION
 21411*         NOTFND   (5550-END-RECORDS)
 21412*         ENDFILE  (5550-END-RECORDS)
 21413*    END-EXEC.
 21414*    MOVE '"$I''                  ! P #00018183' TO DFHEIV0
 21415     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21417     MOVE X'5020233030303138313833' TO DFHEIV0(25:11)
 21418     CALL 'kxdfhei1' USING DFHEIV0
 21419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21420
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 392
* EL6311.cbl
 21421
 21422 5505-START-BROWSE.
 21423     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21424     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21425     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21426
 21427
 21428* EXEC CICS STARTBR
 21429*         DATASET   (FILE-ID-ERPNDB)
 21430*         RIDFLD    (ERPNDB-ALT-KEY)
 21431*    END-EXEC.
 21432     MOVE 0
 21433       TO DFHEIV11
 21434*    MOVE '&,         G          &   #00018193' TO DFHEIV0
 21435     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21437     MOVE X'2020233030303138313933' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0,
 21439           FILE-ID-ERPNDB,
 21440           ERPNDB-ALT-KEY,
 21441           DFHEIV99,
 21442           DFHEIV11,
 21443           DFHEIV99
 21444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21445
 21446
 21447     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21448
 21449
 21450* EXEC CICS READNEXT
 21451*         DATASET    (FILE-ID-ERPNDB)
 21452*         SET        (ADDRESS OF PENDING-BUSINESS)
 21453*         RIDFLD     (ERPNDB-KEY)
 21454*    END-EXEC.
 21455     MOVE 0
 21456       TO DFHEIV11
 21457*    MOVE '&.S                   )   #00018200' TO DFHEIV0
 21458     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21459     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21460     MOVE X'2020233030303138323030' TO DFHEIV0(25:11)
 21461     CALL 'kxdfhei1' USING DFHEIV0,
 21462           FILE-ID-ERPNDB,
 21463           DFHEIV20,
 21464           DFHEIV99,
 21465           ERPNDB-KEY,
 21466           DFHEIV99,
 21467           DFHEIV11,
 21468           DFHEIV99,
 21469           DFHEIV99
 21470     SET ADDRESS OF PENDING-BUSINESS TO
 21471         DFHEIV20
 21472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21473
 21474
 21475
 21476* EXEC CICS READPREV
 21477*         DATASET    (FILE-ID-ERPNDB)
 21478*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 393
* EL6311.cbl
 21479*         RIDFLD     (ERPNDB-KEY)
 21480*    END-EXEC.
 21481     MOVE 0
 21482       TO DFHEIV11
 21483*    MOVE '&0S                   )   #00018206' TO DFHEIV0
 21484     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21486     MOVE X'2020233030303138323036' TO DFHEIV0(25:11)
 21487     CALL 'kxdfhei1' USING DFHEIV0,
 21488           FILE-ID-ERPNDB,
 21489           DFHEIV20,
 21490           DFHEIV99,
 21491           ERPNDB-KEY,
 21492           DFHEIV99,
 21493           DFHEIV11,
 21494           DFHEIV99,
 21495           DFHEIV99
 21496     SET ADDRESS OF PENDING-BUSINESS TO
 21497         DFHEIV20
 21498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21499
 21500
 21501
 21502* EXEC CICS READPREV
 21503*         DATASET    (FILE-ID-ERPNDB)
 21504*         SET        (ADDRESS OF PENDING-BUSINESS)
 21505*         RIDFLD     (ERPNDB-KEY)
 21506*    END-EXEC.
 21507     MOVE 0
 21508       TO DFHEIV11
 21509*    MOVE '&0S                   )   #00018212' TO DFHEIV0
 21510     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21511     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21512     MOVE X'2020233030303138323132' TO DFHEIV0(25:11)
 21513     CALL 'kxdfhei1' USING DFHEIV0,
 21514           FILE-ID-ERPNDB,
 21515           DFHEIV20,
 21516           DFHEIV99,
 21517           ERPNDB-KEY,
 21518           DFHEIV99,
 21519           DFHEIV11,
 21520           DFHEIV99,
 21521           DFHEIV99
 21522     SET ADDRESS OF PENDING-BUSINESS TO
 21523         DFHEIV20
 21524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21525
 21526
 21527     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21528        GO TO 5550-END-RECORDS.
 21529
 21530     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21531
 21532     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21533
 21534     IF  WS-BATCH-PREFIX = '#CL'
 21535             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21536
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 394
* EL6311.cbl
 21537* EXEC CICS ENDBR
 21538*                 DATASET  (FILE-ID-ERPNDB)
 21539*            END-EXEC
 21540     MOVE 0
 21541       TO DFHEIV11
 21542*    MOVE '&2                    $   #00018227' TO DFHEIV0
 21543     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21544     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21545     MOVE X'2020233030303138323237' TO DFHEIV0(25:11)
 21546     CALL 'kxdfhei1' USING DFHEIV0,
 21547           FILE-ID-ERPNDB,
 21548           DFHEIV11,
 21549           DFHEIV99
 21550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21551         GO TO 5505-START-BROWSE.
 21552
 21553     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21554         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21555             NEXT SENTENCE
 21556         ELSE
 21557             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21558
 21559* EXEC CICS ENDBR
 21560*                 DATASET  (FILE-ID-ERPNDB)
 21561*            END-EXEC
 21562     MOVE 0
 21563       TO DFHEIV11
 21564*    MOVE '&2                    $   #00018237' TO DFHEIV0
 21565     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21566     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21567     MOVE X'2020233030303138323337' TO DFHEIV0(25:11)
 21568     CALL 'kxdfhei1' USING DFHEIV0,
 21569           FILE-ID-ERPNDB,
 21570           DFHEIV11,
 21571           DFHEIV99
 21572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21573             GO TO 5505-START-BROWSE.
 21574
 21575
 21576     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21577         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21578             NEXT SENTENCE
 21579        ELSE
 21580             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21581
 21582* EXEC CICS ENDBR
 21583*                 DATASET  (FILE-ID-ERPNDB)
 21584*            END-EXEC
 21585     MOVE 0
 21586       TO DFHEIV11
 21587*    MOVE '&2                    $   #00018248' TO DFHEIV0
 21588     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21589     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21590     MOVE X'2020233030303138323438' TO DFHEIV0(25:11)
 21591     CALL 'kxdfhei1' USING DFHEIV0,
 21592           FILE-ID-ERPNDB,
 21593           DFHEIV11,
 21594           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 395
* EL6311.cbl
 21595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21596             GO TO 5505-START-BROWSE.
 21597
 21598     IF NOT PB-BATCH-TRAILER
 21599        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21600
 21601* EXEC CICS ENDBR
 21602*            DATASET  (FILE-ID-ERPNDB)
 21603*       END-EXEC
 21604     MOVE 0
 21605       TO DFHEIV11
 21606*    MOVE '&2                    $   #00018255' TO DFHEIV0
 21607     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21609     MOVE X'2020233030303138323535' TO DFHEIV0(25:11)
 21610     CALL 'kxdfhei1' USING DFHEIV0,
 21611           FILE-ID-ERPNDB,
 21612           DFHEIV11,
 21613           DFHEIV99
 21614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21615        GO TO 5505-START-BROWSE.
 21616
 21617     IF PI-CSR-BROWSE
 21618        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21619           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21620
 21621* EXEC CICS ENDBR
 21622*               DATASET  (FILE-ID-ERPNDB)
 21623*          END-EXEC
 21624     MOVE 0
 21625       TO DFHEIV11
 21626*    MOVE '&2                    $   #00018263' TO DFHEIV0
 21627     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21629     MOVE X'2020233030303138323633' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0,
 21631           FILE-ID-ERPNDB,
 21632           DFHEIV11,
 21633           DFHEIV99
 21634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21635           GO TO 5505-START-BROWSE.
 21636
 21637     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21638        IF PI-PB-CARRIER    = SPACES AND
 21639           PI-PB-GROUPING   = SPACES AND
 21640           PI-PB-STATE      = SPACES AND
 21641           PI-PB-ACCOUNT    = SPACES
 21642             GO TO 7200-DISPLAY-BATCHES
 21643          ELSE
 21644            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21645               PI-PB-GROUPING   = PB-GROUPING AND
 21646               PI-PB-STATE      = PB-STATE    AND
 21647               PI-PB-ACCOUNT    = PB-ACCOUNT
 21648                 GO TO 7200-DISPLAY-BATCHES.
 21649
 21650     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21651
 21652
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 396
* EL6311.cbl
 21653* EXEC CICS ENDBR
 21654*         DATASET  (FILE-ID-ERPNDB)
 21655*    END-EXEC.
 21656     MOVE 0
 21657       TO DFHEIV11
 21658*    MOVE '&2                    $   #00018283' TO DFHEIV0
 21659     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21661     MOVE X'2020233030303138323833' TO DFHEIV0(25:11)
 21662     CALL 'kxdfhei1' USING DFHEIV0,
 21663           FILE-ID-ERPNDB,
 21664           DFHEIV11,
 21665           DFHEIV99
 21666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21667
 21668
 21669     GO TO 5505-START-BROWSE.
 21670
 21671 5550-END-RECORDS.
 21672     MOVE ER-2257                TO EMI-ERROR.
 21673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21674     MOVE -1                     TO DPFENTRL.
 21675
 21676     GO TO 8200-SEND-DATAONLY.
 21677
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 397
* EL6311.cbl
 21679
 21680******************************************************************
 21681*                                                                *
 21682*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21683*                                                                *
 21684******************************************************************
 21685
 21686 6000-CREATE-TEMP-STORAGE.
 21687
 21688
 21689* EXEC CICS HANDLE CONDITION
 21690*        QIDERR  (6050-QID-ERROR)
 21691*    END-EXEC.
 21692*    MOVE '"$N                   ! Q #00018306' TO DFHEIV0
 21693     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21695     MOVE X'5120233030303138333036' TO DFHEIV0(25:11)
 21696     CALL 'kxdfhei1' USING DFHEIV0
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699
 21700
 21701* EXEC CICS WRITEQ TS
 21702*        QUEUE    (QID)
 21703*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21704*        LENGTH   (WS-COMM-LENGTH)
 21705*        ITEM     (W-ONE)
 21706*    END-EXEC.
 21707*    MOVE '*" I   L              ''   #00018310' TO DFHEIV0
 21708     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21710     MOVE X'2020233030303138333130' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0,
 21712           QID,
 21713           PROGRAM-INTERFACE-BLOCK,
 21714           WS-COMM-LENGTH,
 21715           W-ONE,
 21716           DFHEIV99,
 21717           DFHEIV99
 21718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21719
 21720
 21721 6000-EXIT.
 21722      EXIT.
 21723
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 398
* EL6311.cbl
 21725
 21726******************************************************************
 21727*                                                                *
 21728*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21729*                                                                *
 21730******************************************************************
 21731
 21732 6050-RECOVER-TEMP-STORAGE.
 21733     IF PGM-NAME = XCTL-EL6312
 21734        GO TO 6050-EXIT.
 21735
 21736     IF PGM-NAME = XCTL-EL6313
 21737        GO TO 6050-EXIT.
 21738
 21739     IF PGM-NAME = XCTL-EL6315
 21740         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21741     END-IF
 21742
 21743     IF PGM-NAME = XCTL-EL6316
 21744         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21745     END-IF
 21746
 21747
 21748* EXEC CICS HANDLE CONDITION
 21749*        QIDERR  (6050-QID-ERROR)
 21750*    END-EXEC.
 21751*    MOVE '"$N                   ! R #00018343' TO DFHEIV0
 21752     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21754     MOVE X'5220233030303138333433' TO DFHEIV0(25:11)
 21755     CALL 'kxdfhei1' USING DFHEIV0
 21756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21757
 21758
 21759
 21760* EXEC CICS READQ TS
 21761*         QUEUE   (QID)
 21762*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21763*         LENGTH  (WS-COMM-LENGTH)
 21764*         ITEM    (W-ONE)
 21765*     END-EXEC.
 21766*    MOVE '*$II   L              ''   #00018347' TO DFHEIV0
 21767     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21769     MOVE X'2020233030303138333437' TO DFHEIV0(25:11)
 21770     CALL 'kxdfhei1' USING DFHEIV0,
 21771           QID,
 21772           PROGRAM-INTERFACE-BLOCK,
 21773           WS-COMM-LENGTH,
 21774           W-ONE,
 21775           DFHEIV99,
 21776           DFHEIV99
 21777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21778
 21779
 21780 6050-DELETE-TEMP-STORAGE.
 21781
 21782
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 399
* EL6311.cbl
 21783* EXEC CICS DELETEQ TS
 21784*        QUEUE   (QID)
 21785*    END-EXEC.
 21786*    MOVE '*&                    #   #00018356' TO DFHEIV0
 21787     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21788     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21789     MOVE X'2020233030303138333536' TO DFHEIV0(25:11)
 21790     CALL 'kxdfhei1' USING DFHEIV0,
 21791           QID,
 21792           DFHEIV99
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21794
 21795
 21796     GO TO 6050-EXIT.
 21797
 21798 6050-QID-ERROR.
 21799     MOVE ER-0033                TO EMI-ERROR
 21800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21801
 21802 6050-EXIT.
 21803      EXIT.
 21804
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 400
* EL6311.cbl
 21806
 21807******************************************************************
 21808*                                                                *
 21809*            T E R M   C O N V E R S I O N                       *
 21810*                                                                *
 21811******************************************************************
 21812
 21813 6100-TERM-CONVERSION.
 21814
 21815     IF PI-BPMTS = ZERO
 21816         GO TO 6199-EXIT.
 21817
 21818     IF PI-BMODE = ' ' OR 'M'
 21819         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21820         GO TO 6105-ROUND-TERM.
 21821
 21822     IF PI-BMODE = 'S'
 21823         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21824         GO TO 6105-ROUND-TERM.
 21825
 21826     IF PI-BMODE = 'W'
 21827         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21828         GO TO 6105-ROUND-TERM.
 21829
 21830     IF PI-BMODE = 'B'
 21831         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21832         GO TO 6105-ROUND-TERM.
 21833
 21834     IF PI-BMODE = 'T'
 21835         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21836
 21837 6105-ROUND-TERM.
 21838
 21839     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21840         ADD +1                  TO WS-CALC-TERM-WHOLE
 21841         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21842
 21843     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21844         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21845
 21846     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21847         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21848                                      WS-BTERM    (WS-SUB1)
 21849         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21850
 21851     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21852         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21853             MOVE -1               TO BMODEL
 21854             MOVE ER-2593          TO EMI-ERROR
 21855             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21856             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21857
 21858 6124-CHECK-BENEFIT.
 21859
 21860     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21861        GO TO 6126-COMPUTE-BENEFIT.
 21862
 21863     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 401
* EL6311.cbl
 21864
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 402
* EL6311.cbl
 21866******************************************************************
 21867**         COMPUTE TERM AND BENEFIT
 21868******************************************************************
 21869 6125-COMPUTE-TERM-BENEFIT.
 21870
 21871     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21872        PI-BPMTAMT = ZERO
 21873         GO TO 6199-EXIT.
 21874
 21875     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21876                                     WS-BTERM  (WS-SUB1).
 21877     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21878
 21879 6126-COMPUTE-BENEFIT.
 21880
 21881     IF PI-BMODE = 'M' OR  ' '
 21882         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21883
 21884     IF PI-BMODE = 'W'
 21885         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21886
 21887     IF PI-BMODE = 'S'
 21888         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21889
 21890     IF PI-BMODE = 'B'
 21891         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21892
 21893     IF PI-BMODE = 'T'
 21894         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21895
 21896     IF WS-SUB1 = +1
 21897        COMPUTE WS-BBEN (WS-SUB1) =
 21898                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21899
 21900     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21901     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21902     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21903
 21904 6199-EXIT.
 21905     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 403
* EL6311.cbl
 21907
 21908******************************************************************
 21909*                                                                *
 21910*             D I S P L A Y   I S S U E S                        *
 21911*                                                                *
 21912******************************************************************
 21913
 21914 6200-CREATE-VADS.
 21915     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21916     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21917     MOVE SPACES                 TO WS-PASS-VADS-REC
 21918
 21919* EXEC CICS GETMAIN
 21920*       SET      (ADDRESS OF PENDING-BUSINESS)
 21921*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21922*       INITIMG  (GETMAIN-SPACE)
 21923*       RESP     (WS-RESPONSE)
 21924*    END-EXEC
 21925*    MOVE ',"IL                  $  N#00018482' TO DFHEIV0
 21926     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21927     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21928     MOVE X'204E233030303138343832' TO DFHEIV0(25:11)
 21929     CALL 'kxdfhei1' USING DFHEIV0,
 21930           DFHEIV20,
 21931           ERPNDB-RECORD-LENGTH,
 21932           GETMAIN-SPACE
 21933     SET ADDRESS OF PENDING-BUSINESS TO
 21934         DFHEIV20
 21935     MOVE EIBRESP  TO WS-RESPONSE
 21936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21937
 21938* EXEC CICS READ
 21939*       INTO    (PENDING-BUSINESS)
 21940*       DATASET (FILE-ID-ERPNDB)
 21941*       RIDFLD  (ERPNDB-KEY)
 21942*       RESP    (WS-RESPONSE)
 21943*    END-EXEC
 21944     MOVE LENGTH OF
 21945      PENDING-BUSINESS
 21946       TO DFHEIV11
 21947*    MOVE '&"IL       E          (  N#00018488' TO DFHEIV0
 21948     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21950     MOVE X'204E233030303138343838' TO DFHEIV0(25:11)
 21951     CALL 'kxdfhei1' USING DFHEIV0,
 21952           FILE-ID-ERPNDB,
 21953           PENDING-BUSINESS,
 21954           DFHEIV11,
 21955           ERPNDB-KEY,
 21956           DFHEIV99,
 21957           DFHEIV99,
 21958           DFHEIV99
 21959     MOVE EIBRESP  TO WS-RESPONSE
 21960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21961     IF RESP-NORMAL
 21962        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21963        IF (RESP-NORMAL)
 21964           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 404
* EL6311.cbl
 21965              AM-CONTROL-PRIMARY (1:20))
 21966           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21967        ELSE
 21968           MOVE 'ACCOUNT NOT FOUND'
 21969                                 TO VD-ACCOUNT-NAME
 21970        END-IF
 21971        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21972                                    TO M1
 21973        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21974        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21975           (A2 > M1)
 21976           OR (WS-WORK-FIELD (A2:1) = '*')
 21977           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21978           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21979        END-PERFORM
 21980        IF A2 > M1
 21981           CONTINUE
 21982        ELSE
 21983           MOVE WS-WORK-FIELD (1:A2 - 1)
 21984                                    TO VD-ACCOUNT-NAME
 21985        END-IF
 21986        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21987        MOVE PB-CARRIER          TO VD-CARRIER
 21988        MOVE PB-GROUPING         TO VD-GROUPING
 21989        MOVE PB-STATE            TO VD-STATE
 21990        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21991        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21992        MOVE PB-CERT-NO          TO VD-CERT-NO
 21993        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21994        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21995        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21996        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21997        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21998        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21999        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22000        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22001        MOVE PB-CSR-ID           TO VD-CSR-ID
 22002        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22003        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22004        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22005        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22006        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22007        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22008        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22009        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22010        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22011        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22012        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22013        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22014        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22015     END-IF
 22016     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22017
 22018
 22019* EXEC CICS GETMAIN
 22020*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22021*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22022*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 405
* EL6311.cbl
 22023*       RESP     (WS-RESPONSE)
 22024*    END-EXEC
 22025*    MOVE ',"IL                  $  N#00018551' TO DFHEIV0
 22026     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22028     MOVE X'204E233030303138353531' TO DFHEIV0(25:11)
 22029     CALL 'kxdfhei1' USING DFHEIV0,
 22030           DFHEIV20,
 22031           ERPNDM-RECORD-LENGTH,
 22032           GETMAIN-SPACE
 22033     SET ADDRESS OF PENDING-MAILING-DATA TO
 22034         DFHEIV20
 22035     MOVE EIBRESP  TO WS-RESPONSE
 22036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22037
 22038
 22039* EXEC CICS READ
 22040*       INTO    (PENDING-MAILING-DATA)
 22041*       DATASET (FILE-ID-ERPNDM)
 22042*       RIDFLD  (ERPNDM-KEY)
 22043*       RESP    (WS-RESPONSE)
 22044*    END-EXEC
 22045     MOVE LENGTH OF
 22046      PENDING-MAILING-DATA
 22047       TO DFHEIV11
 22048*    MOVE '&"IL       E          (  N#00018558' TO DFHEIV0
 22049     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22051     MOVE X'204E233030303138353538' TO DFHEIV0(25:11)
 22052     CALL 'kxdfhei1' USING DFHEIV0,
 22053           FILE-ID-ERPNDM,
 22054           PENDING-MAILING-DATA,
 22055           DFHEIV11,
 22056           ERPNDM-KEY,
 22057           DFHEIV99,
 22058           DFHEIV99,
 22059           DFHEIV99
 22060     MOVE EIBRESP  TO WS-RESPONSE
 22061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22062
 22063     IF RESP-NORMAL
 22064        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22065        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22066        MOVE PM-CITY              TO VD-INSURED-CITY
 22067        MOVE PM-STATE             TO VD-INSURED-STATE
 22068        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22069     END-IF
 22070
 22071     MOVE 'VAC1'                  TO VD-LETTER-ID
 22072     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22073     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22074     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22075     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22076     MOVE +0                      TO VD-ARCHIVE-NO
 22077     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22078     .
 22079 6200-EXIT.
 22080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 406
* EL6311.cbl
 22081 6210-READ-ERACCT.
 22082     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22083     MOVE LOW-VALUES             TO ERACCT-FILL
 22084
 22085* EXEC CICS READ
 22086*         DATASET   ('ERACCT')
 22087*         INTO      (ACCOUNT-MASTER)
 22088*         RIDFLD    (ERACCT-KEY)
 22089*         GTEQ
 22090*         RESP      (WS-RESPONSE)
 22091*    END-EXEC
 22092     MOVE LENGTH OF
 22093      ACCOUNT-MASTER
 22094       TO DFHEIV11
 22095     MOVE 'ERACCT' TO DFHEIV1
 22096*    MOVE '&"IL       G          (  N#00018586' TO DFHEIV0
 22097     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22099     MOVE X'204E233030303138353836' TO DFHEIV0(25:11)
 22100     CALL 'kxdfhei1' USING DFHEIV0,
 22101           DFHEIV1,
 22102           ACCOUNT-MASTER,
 22103           DFHEIV11,
 22104           ERACCT-KEY,
 22105           DFHEIV99,
 22106           DFHEIV99,
 22107           DFHEIV99
 22108     MOVE EIBRESP  TO WS-RESPONSE
 22109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22110     .
 22111 6210-EXIT.
 22112     EXIT.
 22113
 22114 6220-READ-ERMAIL.
 22115
 22116     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22117     MOVE ' '                    TO WS-ERMAIL-SW
 22118
 22119
 22120* EXEC CICS READ
 22121*       DATASET   (FILE-ID-ERMAIL)
 22122*       SET       (ADDRESS OF MAILING-DATA)
 22123*       RIDFLD    (ERMAIL-KEY)
 22124*       RESP      (WS-RESPONSE)
 22125*    END-EXEC
 22126*    MOVE '&"S        E          (  N#00018602' TO DFHEIV0
 22127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22129     MOVE X'204E233030303138363032' TO DFHEIV0(25:11)
 22130     CALL 'kxdfhei1' USING DFHEIV0,
 22131           FILE-ID-ERMAIL,
 22132           DFHEIV20,
 22133           DFHEIV99,
 22134           ERMAIL-KEY,
 22135           DFHEIV99,
 22136           DFHEIV99,
 22137           DFHEIV99
 22138     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 407
* EL6311.cbl
 22139         DFHEIV20
 22140     MOVE EIBRESP  TO WS-RESPONSE
 22141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22142
 22143     IF RESP-NORMAL
 22144        SET ERMAIL-FOUND TO TRUE
 22145     END-IF
 22146     .
 22147 6220-EXIT.
 22148     EXIT.
 22149
 22150 6400-CHECK-FOR-RES-REF-CLAIM.
 22151     display 'made it to 6400- for ' pi-cert-no
 22152     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22153
 22154     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22155                                    W-CL-COMP-CD.
 22156     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22157                                    W-CL-CERT-NO.
 22158     MOVE SPACES                 TO MSTR-CERT-SFX.
 22159
 22160
 22161* EXEC CICS HANDLE CONDITION
 22162*        NOTFND  (6400-CONTINUE)
 22163*        ENDFILE (6400-CONTINUE)
 22164*    END-EXEC.
 22165*    MOVE '"$I''                  ! S #00018626' TO DFHEIV0
 22166     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22168     MOVE X'5320233030303138363236' TO DFHEIV0(25:11)
 22169     CALL 'kxdfhei1' USING DFHEIV0
 22170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22171
 22172
 22173
 22174* EXEC CICS IGNORE CONDITION
 22175*        DUPKEY
 22176*    END-EXEC.
 22177*    MOVE '"*$                   !   #00018631' TO DFHEIV0
 22178     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303138363331' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0
 22182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22183
 22184
 22185
 22186* EXEC CICS STARTBR
 22187*        DATASET   (CLMS-ID)
 22188*        RIDFLD    (ELMSTR-KEY)
 22189*        GENERIC   EQUAL
 22190*        KEYLENGTH (ELMSTR-LENGTH)
 22191*    END-EXEC.
 22192     MOVE 0
 22193       TO DFHEIV11
 22194*    MOVE '&,   KG    E          &   #00018635' TO DFHEIV0
 22195     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22196     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 408
* EL6311.cbl
 22197     MOVE X'2020233030303138363335' TO DFHEIV0(25:11)
 22198     CALL 'kxdfhei1' USING DFHEIV0,
 22199           CLMS-ID,
 22200           ELMSTR-KEY,
 22201           ELMSTR-LENGTH,
 22202           DFHEIV11,
 22203           DFHEIV99
 22204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22205
 22206
 22207     display 'browse started'
 22208     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22209
 22210 6400-NEXT-CLAIM.
 22211
 22212
 22213* EXEC CICS READNEXT
 22214*        DATASET   (CLMS-ID)
 22215*        RIDFLD    (ELMSTR-KEY)
 22216*        SET       (ADDRESS OF CLAIM-MASTER)
 22217*    END-EXEC.
 22218     MOVE 0
 22219       TO DFHEIV11
 22220*    MOVE '&.S                   )   #00018647' TO DFHEIV0
 22221     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22222     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22223     MOVE X'2020233030303138363437' TO DFHEIV0(25:11)
 22224     CALL 'kxdfhei1' USING DFHEIV0,
 22225           CLMS-ID,
 22226           DFHEIV20,
 22227           DFHEIV99,
 22228           ELMSTR-KEY,
 22229           DFHEIV99,
 22230           DFHEIV11,
 22231           DFHEIV99,
 22232           DFHEIV99
 22233     SET ADDRESS OF CLAIM-MASTER TO
 22234         DFHEIV20
 22235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22236
 22237
 22238     display 'read claim for ' mstr-cert-no
 22239     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22240        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22241         GO TO 6400-CONTINUE
 22242     END-IF.
 22243
 22244     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22245        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22246        PI-STATE       NOT = CL-CERT-STATE     OR
 22247        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22248        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22249         GO TO 6400-NEXT-CLAIM
 22250     END-IF.
 22251
 22252     display 'found claim ' cl-claim-no
 22253        ' with denial type ' cl-denial-type
 22254     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 409
* EL6311.cbl
 22255         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22256         GO TO 6400-CONTINUE
 22257     END-IF.
 22258
 22259     GO TO 6400-NEXT-CLAIM.
 22260
 22261 6400-CONTINUE.
 22262
 22263     IF WS-BROWSE-STARTED-SW = 'Y'
 22264
 22265* EXEC CICS ENDBR
 22266*            DATASET   (CLMS-ID)
 22267*        END-EXEC
 22268     MOVE 0
 22269       TO DFHEIV11
 22270*    MOVE '&2                    $   #00018679' TO DFHEIV0
 22271     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22273     MOVE X'2020233030303138363739' TO DFHEIV0(25:11)
 22274     CALL 'kxdfhei1' USING DFHEIV0,
 22275           CLMS-ID,
 22276           DFHEIV11,
 22277           DFHEIV99
 22278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22279         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22280     END-IF.
 22281
 22282 6400-EXIT.
 22283     EXIT.
 22284
 22285 7000-DISPLAY-ISSUES.
 22286
 22287     IF PI-DISPLAY-ORIGINAL-BATCH
 22288        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22289        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22290     ELSE
 22291        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22292
 22293     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22294
 22295     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22296     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22297
 22298     MOVE LOW-VALUES                 TO EL631BI.
 22299     MOVE ZEROS                      TO PI-BPMTAMT
 22300                                        PI-BPMTS.
 22301     MOVE SPACE                      TO PI-BMODE
 22302                                        PI-BTYPE (1)
 22303                                        PI-BTYPE (2).
 22304     MOVE EL631B                     TO PI-MAP-NAME.
 22305     MOVE 'Y'                        TO PI-BROWSE-SW.
 22306     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22307                                        PI-HIGH-SEQ-NO.
 22308
 22309     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22310        MOVE AL-SABOF                TO BCHGTA
 22311        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22312        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 410
* EL6311.cbl
 22313     ELSE
 22314        MOVE AL-SADOF                TO BCHGTA
 22315                                        BCHGA
 22316        MOVE PB-CHG-COUNT            TO BCHGO.
 22317
 22318     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22319     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22320     MOVE WS-HR-MINS                 TO BMANTATO.
 22321
 22322     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22323        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22324        MOVE SPACE                   TO DC-OPTION-CODE
 22325        PERFORM 9700-DATE-LINK
 22326        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22327        MOVE 'INACTIVE'              TO BMOENDTO
 22328     ELSE
 22329        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22330        MOVE SPACE                   TO DC-OPTION-CODE
 22331        PERFORM 9700-DATE-LINK
 22332        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22333        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22334        MOVE SPACE                   TO DC-OPTION-CODE
 22335        PERFORM 9700-DATE-LINK
 22336        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22337
 22338*    MOVE PB-I-REFERENCE             TO BREFO.
 22339
 22340*    IF PI-COMPANY-ID EQUAL 'HER'
 22341*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22342*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22343*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22344*                MOVE WS-MEMBER-NO-1-8
 22345*                                TO  BMICRNOO.
 22346
 22347*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22348*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22349*            MOVE PB-I-MICROFILM-NO
 22350*                                TO  BMICRNOO.
 22351     IF PB-I-VIN NOT = SPACES
 22352        MOVE PB-I-VIN            TO BVINO
 22353     END-IF
 22354     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22355
 22356
 22357     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22358     MOVE PB-CERT-SFX                TO BSUFIXO.
 22359     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22360     MOVE SPACE                      TO DC-OPTION-CODE.
 22361     PERFORM 9700-DATE-LINK.
 22362     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22363
 22364     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22365     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22366     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22367     MOVE PB-I-INSURED-SEX           TO BSEXO
 22368
 22369     IF PB-I-AGE NOT = ZEROS
 22370         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 411
* EL6311.cbl
 22371
 22372     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22373                                 TO ELCERT-KEY
 22374     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22375     IF NOT CERT-TRL-REC-NOT-FOUND
 22376         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22377             MOVE 'AGE*'             TO BAGEDEFO
 22378         ELSE
 22379             MOVE 'AGE '             TO BAGEDEFO
 22380         END-IF
 22381     ELSE
 22382         MOVE 'AGE '             TO BAGEDEFO
 22383     END-IF
 22384
 22385     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22386         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22387         MOVE SPACE                  TO DC-OPTION-CODE
 22388         PERFORM 9700-DATE-LINK
 22389         IF NO-CONVERSION-ERROR
 22390            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22391
 22392     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22393         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22394         MOVE SPACE                  TO DC-OPTION-CODE
 22395         PERFORM 9700-DATE-LINK
 22396         IF NO-CONVERSION-ERROR
 22397            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22398
 22399     IF PB-I-EXTENTION-DAYS NUMERIC
 22400        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22401           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22402        ELSE
 22403           IF PB-I-TERM-IN-DAYS NUMERIC
 22404              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22405                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22406
 22407     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22408        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22409
 22410     MOVE PB-FORCE-CODE              TO BFORCEO.
 22411     MOVE PB-I-TERM-TYPE             TO BMODEO
 22412                                        PI-BMODE.
 22413
 22414     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22415        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22416
 22417     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22418         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22419                                        PI-BPMTS.
 22420
 22421     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22422         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22423           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22424                                        PI-BPMTAMT.
 22425
 22426     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22427     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22428     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 412
* EL6311.cbl
 22429     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22430     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22431     MOVE PB-I-SIG-SW                TO BSIGO.
 22432     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22433     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22434     MOVE PB-RECORD-BILL             TO BBILCDO.
 22435     MOVE PB-FORCE-CODE              TO BFORCEO.
 22436
 22437     IF (PB-I-LIVES NUMERIC)
 22438        AND (PB-I-LIVES > ZEROS)
 22439        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22440        IF (RESP-NORMAL)
 22441           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22442           CONTINUE
 22443        ELSE
 22444           MOVE PB-I-LIVES       TO BLIVESO
 22445        END-IF
 22446     END-IF
 22447
 22448     IF PB-I-NUM-BILLED NUMERIC AND
 22449        PB-I-NUM-BILLED GREATER THAN ZEROS
 22450        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22451*    ELSE
 22452*       MOVE ZEROS                   TO BBILLEDO.
 22453
 22454     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22455
 22456     IF PB-I-LOAN-APR NOT = +99.9999
 22457        MOVE PB-I-LOAN-APR           TO BAPRO.
 22458
 22459     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22460        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22461
 22462     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22463        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22464           MOVE AL-SANOF                TO BORIGHDA
 22465           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22466           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22467
 22468     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22469
 22470     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22471        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22472
 22473     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22474        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22475                                        PI-BTYPE (1).
 22476
 22477     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22478        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22479
 22480     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22481        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22482
 22483     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22484        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22485
 22486     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 413
* EL6311.cbl
 22487        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22488
 22489     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22490        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22491
 22492     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22493         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22494         MOVE SPACE                  TO DC-OPTION-CODE
 22495         PERFORM 9700-DATE-LINK
 22496         IF NO-CONVERSION-ERROR
 22497            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22498
 22499     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22500        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22501        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22502        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22503        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22504                 GIVING BDIFFO (1)
 22505     ELSE
 22506        MOVE SPACES                  TO BBEN-CD     (1)
 22507                                        BBEN-ABBR   (1).
 22508
 22509     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22510        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22511        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22512                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22513
 22514     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22515       IF PB-RECORD-ON-HOLD
 22516          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22517
 22518     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22519       IF PB-RECORD-RETURNED
 22520          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22521
 22522     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22523        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22524             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22525
 22526     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22527
 22528     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22529        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22530
 22531     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22532        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22533                                        PI-BTYPE (2).
 22534
 22535     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22536        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22537
 22538     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22539        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22540
 22541     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22542        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22543
 22544     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 414
* EL6311.cbl
 22545        MOVE ZEROS               TO PB-I-TOT-FEES
 22546     END-IF
 22547     IF PB-I-TOT-FEES > ZEROS
 22548        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22549
 22550     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22551         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22552         MOVE SPACE                  TO DC-OPTION-CODE
 22553         PERFORM 9700-DATE-LINK
 22554         IF NO-CONVERSION-ERROR
 22555            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22556
 22557     IF PB-I-TOT-FEES > ZEROS
 22558        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22559        SUBTRACT PB-I-TOT-FEES FROM
 22560                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22561
 22562     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22563        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22564        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22565        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22566        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22567                 GIVING BDIFFO (2)
 22568     ELSE
 22569        MOVE SPACES                  TO BBEN-CD     (2)
 22570                                        BBEN-ABBR   (2).
 22571
 22572     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22573       IF PB-RECORD-ON-HOLD
 22574          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22575
 22576     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22577       IF PB-RECORD-RETURNED
 22578          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22579
 22580     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22581        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22582             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22583
 22584     MOVE PB-CSR-ID                  TO BCSRO.
 22585
 22586     IF PI-COMPANY-ID  =  'DMD'
 22587        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22588            NEXT SENTENCE
 22589        ELSE
 22590            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22591               MOVE 'NEW CERT'       TO BNCERTLI
 22592               MOVE EC-NEW-CERT      TO BNCERTO.
 22593
 22594     IF PI-COMPANY-ID  =  'DMD'
 22595        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22596            NEXT SENTENCE
 22597        ELSE
 22598           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22599               MOVE 'NEW STATE'      TO BNSTATLI
 22600               MOVE EC-NEW-STATE     TO BNSTATO.
 22601
 22602 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 415
* EL6311.cbl
 22603     MOVE 'C'                        TO BMAINTI.
 22604     MOVE AL-UANON                   TO BMAINTA.
 22605
 22606     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22607        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22608
 22609     IF ARCHIVE-LETTER-RELEASED
 22610        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 22611     END-IF
 22612     IF PI-6315-FINALIZED = 'Y'   AND
 22613        PB-UNFORCED-ERRORS
 22614          MOVE -1                TO BFORCEL
 22615          MOVE  1                TO SET-CURSOR-SW
 22616     END-IF
 22617
 22618     IF NO-CURSOR-SET
 22619        MOVE -1                      TO BMAINTL.
 22620
 22621     GO TO 8100-SEND-INITIAL-MAP.
 22622
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 416
* EL6311.cbl
 22624
 22625 7050-UPDATE-PENDING.
 22626
 22627* EXEC CICS READ
 22628*        DATASET (FILE-ID-ERPNDB)
 22629*        INTO    (PENDING-BUSINESS)
 22630*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 22631*        UPDATE
 22632*    END-EXEC.
 22633     MOVE LENGTH OF
 22634      PENDING-BUSINESS
 22635       TO DFHEIV11
 22636*    MOVE '&"IL       EU         (   #00019029' TO DFHEIV0
 22637     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22639     MOVE X'2020233030303139303239' TO DFHEIV0(25:11)
 22640     CALL 'kxdfhei1' USING DFHEIV0,
 22641           FILE-ID-ERPNDB,
 22642           PENDING-BUSINESS,
 22643           DFHEIV11,
 22644           PI-PREV-CONTROL-PRIMARY,
 22645           DFHEIV99,
 22646           DFHEIV99,
 22647           DFHEIV99
 22648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22649
 22650
 22651     MOVE 'C' TO PB-I-LETTER-REQD
 22652     MOVE PB-I-LETTER-REQD       TO LETRREQO
 22653     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 22654     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 22655     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 22656     MOVE '5'                    TO DC-OPTION-CODE.
 22657     PERFORM 9700-DATE-LINK
 22658     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 22659
 22660
 22661* EXEC CICS REWRITE
 22662*        DATASET (FILE-ID-ERPNDB)
 22663*        FROM    (PENDING-BUSINESS)
 22664*    END-EXEC.
 22665     MOVE LENGTH OF
 22666      PENDING-BUSINESS
 22667       TO DFHEIV11
 22668*    MOVE '&& L                  %   #00019045' TO DFHEIV0
 22669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22671     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 22672     CALL 'kxdfhei1' USING DFHEIV0,
 22673           FILE-ID-ERPNDB,
 22674           PENDING-BUSINESS,
 22675           DFHEIV11,
 22676           DFHEIV99
 22677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22678
 22679
 22680 7050-EXIT.
 22681      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 417
* EL6311.cbl
 22682
 22683******************************************************************
 22684*                                                                *
 22685*             D I S P L A Y   C A N C E L S                      *
 22686*                                                                *
 22687******************************************************************
 22688
 22689 7100-DISPLAY-CANCELS.
 22690     IF PI-DISPLAY-ORIGINAL-BATCH
 22691        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22692        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22693     ELSE
 22694        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22695
 22696     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22697
 22698     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22699     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22700
 22701     MOVE LOW-VALUES                 TO EL631CI.
 22702     MOVE EL631C                     TO PI-MAP-NAME.
 22703     MOVE 'Y'                        TO PI-BROWSE-SW.
 22704     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22705                                        PI-HIGH-SEQ-NO.
 22706
 22707     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22708        MOVE AL-SABOF                TO CCHGTA
 22709        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22710        MOVE AL-SANON                TO CCHGA
 22711      ELSE
 22712        MOVE AL-SADOF                TO CCHGTA
 22713                                        CCHGA
 22714        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22715
 22716*    MOVE PB-C-REFERENCE             TO CREFO.
 22717
 22718*    IF PB-C-MICROFILM-NO IS NUMERIC
 22719*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22720*          MOVE PB-C-MICROFILM-NO
 22721*                                TO CMICRNOO
 22722*          MOVE AL-UNNON         TO CMICRNOA
 22723*       END-IF
 22724*    END-IF
 22725     IF PB-C-INT-ON-REFS NUMERIC
 22726        IF PB-C-INT-ON-REFS NOT = ZEROS
 22727           MOVE PB-C-INT-ON-REFS
 22728                                 TO CNHINTO
 22729           MOVE AL-SANOF         TO CNHINTA
 22730        END-IF
 22731     END-IF
 22732     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22733     MOVE PB-CERT-SFX                TO CSUFIXO.
 22734     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22735     MOVE SPACE                      TO DC-OPTION-CODE.
 22736     PERFORM 9700-DATE-LINK.
 22737     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22738
 22739     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 418
* EL6311.cbl
 22740        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22741        MOVE SPACE                   TO DC-OPTION-CODE
 22742        PERFORM 9700-DATE-LINK
 22743        IF NO-CONVERSION-ERROR
 22744           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22745
 22746     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22747        NEXT SENTENCE
 22748     ELSE
 22749        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22750
 22751     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22752        NEXT SENTENCE
 22753     ELSE
 22754        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22755
 22756     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22757        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22758        MOVE SPACE                   TO DC-OPTION-CODE
 22759        PERFORM 9700-DATE-LINK
 22760        IF NO-CONVERSION-ERROR
 22761           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22762
 22763     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22764         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22765
 22766     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22767         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22768
 22769     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22770        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22771        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22772                 GIVING CDRFND1O.
 22773
 22774     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22775        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22776        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22777                 GIVING CDRFND2O.
 22778
 22779     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22780       IF PB-RECORD-ON-HOLD
 22781          MOVE 'ON HOLD'             TO CBILIT1O.
 22782
 22783     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22784       IF PB-RECORD-RETURNED
 22785          MOVE 'RETURNED'            TO CBILIT1O.
 22786
 22787     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22788        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22789             MOVE 'OVERRIDE'         TO CBILIT1O.
 22790
 22791     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22792       IF PB-RECORD-ON-HOLD
 22793          MOVE 'ON HOLD'             TO CBILIT2O.
 22794
 22795     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22796       IF PB-RECORD-RETURNED
 22797          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 419
* EL6311.cbl
 22798
 22799     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22800        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22801             MOVE 'OVERRIDE'         TO CBILIT2O.
 22802
 22803     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22804     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22805     MOVE PB-FORCE-CODE              TO CFORCEO.
 22806     MOVE PB-RECORD-BILL             TO CBILCDO.
 22807     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22808     MOVE SPACES                     TO CINITSO.
 22809     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22810         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22811     ELSE
 22812         MOVE PB-CI-INITIALS         TO CINITSO
 22813     END-IF.
 22814
 22815     IF PB-CI-CANCEL-FEE NUMERIC
 22816        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22817        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22818     ELSE
 22819        MOVE ZEROES                  TO W-CANCEL-FEE.
 22820
 22821     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22822
 22823     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22824        ADD PB-CI-LF-PREMIUM-AMT
 22825             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22826
 22827     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22828        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22829
 22830     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22831     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22832     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22833     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22834
 22835     IF PB-C-LIVES NUMERIC
 22836        MOVE PB-C-LIVES              TO CLIVESO.
 22837
 22838     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22839        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22840
 22841     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22842        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22843        MOVE SPACE                   TO DC-OPTION-CODE
 22844        PERFORM 9700-DATE-LINK
 22845        IF NO-CONVERSION-ERROR
 22846           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22847
 22848     IF  PB-C-REFUND-CREATED
 22849         MOVE 'YES'                  TO CRFNDSWO
 22850     ELSE
 22851         IF PB-C-REFUND-REQUESTED
 22852            MOVE 'REQ'               TO CRFNDSWO
 22853         ELSE
 22854            MOVE 'NO'                TO CRFNDSWO.
 22855
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 420
* EL6311.cbl
 22856     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22857     MOVE SPACE                      TO DC-OPTION-CODE.
 22858     PERFORM 9700-DATE-LINK.
 22859     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22860     MOVE PB-INPUT-BY                TO CENTBYO.
 22861
 22862     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22863        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22864        MOVE SPACE                   TO DC-OPTION-CODE
 22865        PERFORM 9700-DATE-LINK
 22866        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22867        MOVE 'INACTIVE'              TO CMOENDTO
 22868     ELSE
 22869        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22870        MOVE SPACE                   TO DC-OPTION-CODE
 22871        PERFORM 9700-DATE-LINK
 22872        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22873        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22874        MOVE SPACE                   TO DC-OPTION-CODE
 22875        PERFORM 9700-DATE-LINK
 22876        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22877
 22878     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22879
 22880     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22881     MOVE WS-HR-MINS                 TO CMANTATO.
 22882
 22883     EVALUATE PB-LF-REFUND-TYPE
 22884        WHEN '1'
 22885           MOVE 'RULE78'            TO CLFREFNO
 22886        WHEN '2'
 22887           MOVE 'PRORAT'            TO CLFREFNO
 22888        WHEN '3'
 22889           MOVE 'CALIF'             TO CLFREFNO
 22890        WHEN '4'
 22891           MOVE 'IRREG'             TO CLFREFNO
 22892        WHEN '5'
 22893           MOVE 'NETPAY'            TO CLFREFNO
 22894        WHEN '6'
 22895           MOVE 'ATCP'              TO CLFREFNO
 22896        WHEN '7'
 22897           MOVE 'UTAH'              TO CLFREFNO
 22898        WHEN '8'
 22899           MOVE 'MEAN'              TO CLFREFNO
 22900        WHEN '9'
 22901           MOVE 'SUM '              TO CLFREFNO
 22902        WHEN 'B'
 22903           MOVE 'BALN'              TO CLFREFNO
 22904     END-EVALUATE.
 22905
 22906     EVALUATE TRUE
 22907        WHEN PB-AH-REFUND-TYPE =  '1'
 22908           MOVE 'RULE78'            TO CAHREFNO
 22909        WHEN PB-AH-REFUND-TYPE =  '2'
 22910           MOVE 'PRORAT'            TO CAHREFNO
 22911        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22912           MOVE 'CALIF'             TO CAHREFNO
 22913        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 421
* EL6311.cbl
 22914           MOVE 'IRREG'             TO CAHREFNO
 22915        WHEN PB-AH-REFUND-TYPE =  '5'
 22916           MOVE 'NETPAY'            TO CAHREFNO
 22917        WHEN PB-AH-REFUND-TYPE =  '6'
 22918           MOVE 'ATCP'              TO CAHREFNO
 22919        WHEN PB-AH-REFUND-TYPE =  '7'
 22920           MOVE 'UTAH'              TO CAHREFNO
 22921        WHEN PB-AH-REFUND-TYPE =  '8'
 22922           MOVE 'MEAN'              TO CAHREFNO
 22923        WHEN PB-AH-REFUND-TYPE =  '9'
 22924           MOVE 'SUM '              TO CAHREFNO
 22925        WHEN PB-AH-REFUND-TYPE =  'B'
 22926           MOVE 'BALN'              TO CAHREFNO
 22927     END-EVALUATE.
 22928
 22929     MOVE PB-REIN-CD                 TO CREINCDO.
 22930
 22931     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22932        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22933        MOVE SPACE                   TO DC-OPTION-CODE
 22934        PERFORM 9700-DATE-LINK
 22935        IF NO-CONVERSION-ERROR
 22936           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22937
 22938     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22939        MOVE 999999                  TO WS-EXP-DT-EDIT
 22940        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22941        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22942     ELSE
 22943        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22944           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22945           MOVE SPACE                   TO DC-OPTION-CODE
 22946           PERFORM 9700-DATE-LINK
 22947           IF NO-CONVERSION-ERROR
 22948              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22949
 22950     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22951        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22952           MOVE AL-SANOF                TO CORIGHDA
 22953           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22954           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22955
 22956     MOVE PB-CSR-ID              TO CCSRO.
 22957
 22958     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22959     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22960     MOVE 'N'                    TO ACTSPCO
 22961     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 22962     MOVE '2'                    TO ERACNT-REC-TYPE
 22963     MOVE +3                     TO ERACNT-SEQ-NO
 22964
 22965
 22966* EXEC CICS READ
 22967*         DATASET   ('ERACNT')
 22968*         INTO      (NOTE-FILE)
 22969*         RIDFLD    (ERACNT-KEY)
 22970*         RESP      (WS-RESPONSE)
 22971*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 422
* EL6311.cbl
 22972     MOVE LENGTH OF
 22973      NOTE-FILE
 22974       TO DFHEIV11
 22975     MOVE 'ERACNT' TO DFHEIV1
 22976*    MOVE '&"IL       E          (  N#00019335' TO DFHEIV0
 22977     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22979     MOVE X'204E233030303139333335' TO DFHEIV0(25:11)
 22980     CALL 'kxdfhei1' USING DFHEIV0,
 22981           DFHEIV1,
 22982           NOTE-FILE,
 22983           DFHEIV11,
 22984           ERACNT-KEY,
 22985           DFHEIV99,
 22986           DFHEIV99,
 22987           DFHEIV99
 22988     MOVE EIBRESP  TO WS-RESPONSE
 22989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22990
 22991     IF RESP-NORMAL
 22992        IF NT-account-special = 'Y'
 22993           MOVE 'Y'              TO actspcO
 22994           MOVE ER-1762          TO EMI-ERROR
 22995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22996        END-IF
 22997     END-IF
 22998     MOVE 'C'                    TO CMAINTI.
 22999     MOVE AL-UANON               TO CMAINTA.
 23000
 23001     IF PI-6316-FINALIZED = 'Y'  AND
 23002        PB-UNFORCED-ERRORS
 23003          MOVE -1                TO CFORCEL
 23004          MOVE  1                TO SET-CURSOR-SW
 23005     END-IF
 23006
 23007     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23008        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23009
 23010     IF NO-CURSOR-SET
 23011        MOVE -1                  TO CMAINTL.
 23012
 23013     GO TO 8100-SEND-INITIAL-MAP.
 23014
 23015
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 423
* EL6311.cbl
 23017***************************************************************
 23018*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23019*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23020***************************************************************
 23021
 23022 7200-DISPLAY-BATCHES.
 23023     MOVE EL631D                 TO PI-MAP-NAME.
 23024     MOVE LOW-VALUES             TO EL631DI.
 23025
 23026     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23027
 23028
 23029* EXEC CICS HANDLE CONDITION
 23030*         NOTFND   (3690-NOT-FOUND)
 23031*    END-EXEC.
 23032*    MOVE '"$I                   ! T #00019379' TO DFHEIV0
 23033     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23035     MOVE X'5420233030303139333739' TO DFHEIV0(25:11)
 23036     CALL 'kxdfhei1' USING DFHEIV0
 23037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23038
 23039
 23040     IF PI-DISPLAY-SCREEN
 23041        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23042     ELSE
 23043        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23044
 23045     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23046     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23047
 23048
 23049* EXEC CICS READ
 23050*         DATASET   (FILE-ID-ERPNDB)
 23051*         RIDFLD    (ERPNDB-KEY)
 23052*         SET       (ADDRESS OF PENDING-BUSINESS)
 23053*    END-EXEC.
 23054*    MOVE '&"S        E          (   #00019391' TO DFHEIV0
 23055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23057     MOVE X'2020233030303139333931' TO DFHEIV0(25:11)
 23058     CALL 'kxdfhei1' USING DFHEIV0,
 23059           FILE-ID-ERPNDB,
 23060           DFHEIV20,
 23061           DFHEIV99,
 23062           ERPNDB-KEY,
 23063           DFHEIV99,
 23064           DFHEIV99,
 23065           DFHEIV99
 23066     SET ADDRESS OF PENDING-BUSINESS TO
 23067         DFHEIV20
 23068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23069
 23070
 23071     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23072     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23073     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23074     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 424
* EL6311.cbl
 23075     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23076
 23077     MOVE EL631D                 TO PI-MAP-NAME.
 23078     MOVE LOW-VALUES             TO EL631DI.
 23079     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23080
 23081*    IF PI-AR-PROCESSING
 23082*       MOVE PB-REFERENCE        TO DREFO.
 23083
 23084     MOVE PB-CSR-ID              TO DCSRO.
 23085
 23086     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23087        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23088        MOVE SPACE               TO DC-OPTION-CODE
 23089        PERFORM 9700-DATE-LINK
 23090        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23091        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23092        MOVE 'INACTIVE'          TO DLDATEO
 23093     ELSE
 23094        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23095        MOVE SPACE               TO DC-OPTION-CODE
 23096        PERFORM 9700-DATE-LINK
 23097        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23098
 23099     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23100     MOVE SPACE                  TO DC-OPTION-CODE.
 23101     PERFORM 9700-DATE-LINK.
 23102     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23103
 23104     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23105        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23106     ELSE
 23107        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23108        MOVE SPACE               TO DC-OPTION-CODE
 23109        PERFORM 9700-DATE-LINK
 23110        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23111
 23112     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23113     MOVE SPACE                  TO DC-OPTION-CODE.
 23114     PERFORM 9700-DATE-LINK.
 23115     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23116
 23117     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23118     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23119
 23120     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23121        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23122                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23123
 23124     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23125     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23126     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23127
 23128     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23129        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23130                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23131
 23132     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 425
* EL6311.cbl
 23133     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23134     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23135
 23136     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23137        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23138                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23139
 23140     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23141     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23142
 23143     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23144        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23145                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23146
 23147     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23148     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23149     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23150
 23151     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23152        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23153                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23154
 23155     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23156     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23157     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23158
 23159     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23160        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23161                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23162
 23163     MOVE -1                     TO DPFENTRL.
 23164     GO TO 8100-SEND-INITIAL-MAP.
 23165
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 426
* EL6311.cbl
 23167
 23168***************************************************************
 23169*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23170*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23171*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23172*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23173*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23174*     ARE THEN SET ACCORDINGLY.                               *
 23175*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23176*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23177*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23178***************************************************************
 23179
 23180******************************************************************
 23181*                                                                *
 23182*            E R R O R   A N A L Y S I S                         *
 23183*                                                                *
 23184******************************************************************
 23185
 23186******************************************************************
 23187*                                                                *
 23188*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23189*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23190*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23191*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23192*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23193*                                                                *
 23194*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23195*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23196*                                                                *
 23197******************************************************************
 23198
 23199 7300-FORMAT-ERRORS.
 23200     MOVE ' '                    TO PI-ERRORS-SW
 23201     IF PB-COMMON-ERRORS = LOW-VALUES
 23202        IF PB-FATAL-ERRORS
 23203           MOVE ER-2695          TO EMI-ERROR
 23204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23205           GO TO 7399-EXIT.
 23206
 23207     MOVE +0                     TO WS-SUB4
 23208     move +0                     to pi-6311-fatal-ctr
 23209     .
 23210 7310-ERROR-LOOP.
 23211
 23212     ADD +1                      TO WS-SUB4.
 23213
 23214     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23215        GO TO 7350-SET-ERROR-FLAGS.
 23216
 23217     IF PI-COMPANY-ID = 'UCL'
 23218         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23219             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23220             MOVE ' '                   TO DC-OPTION-CODE
 23221             PERFORM 9700-DATE-LINK
 23222             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23223
 23224     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 427
* EL6311.cbl
 23225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23226     if (emi-fatal)
 23227        and (emi-error not = 1753 and 1754 and 1757 and
 23228                             1758 and 1759 and 1760)
 23229        add +1                   to pi-6311-fatal-ctr
 23230     end-if
 23231     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23232
 23233     GO TO 7310-ERROR-LOOP.
 23234
 23235
 23236 7350-SET-ERROR-FLAGS.
 23237
 23238     IF EMI-FATAL-CTR NOT = ZEROS
 23239        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23240        MOVE 'X'                 TO PB-FATAL-FLAG
 23241                                    PI-ERRORS-SW
 23242        GO TO 7355-SET-ERROR-FLAGS.
 23243
 23244     move ' ' to pi-unforced-sw
 23245     IF EMI-FORCABLE-CTR NOT = ZEROS
 23246        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23247        IF PB-ISSUE
 23248           IF PB-ISSUE-FORCE
 23249              MOVE 'F'           TO PB-FORCE-ER-CD
 23250              MOVE ER-2600       TO EMI-ERROR
 23251              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23252             ELSE
 23253              MOVE 'X'           TO PB-FORCE-ER-CD
 23254*                                   PI-ERRORS-SW
 23255          ELSE
 23256           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23257              MOVE 'F'           TO PB-FORCE-ER-CD
 23258                                    pi-unforced-sw
 23259              MOVE ER-2600       TO EMI-ERROR
 23260              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23261             ELSE
 23262              MOVE 'X'           TO PB-FORCE-ER-CD
 23263                                    pi-unforced-sw.
 23264*                                   PI-ERRORS-SW.
 23265
 23266     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23267     IF PB-ISSUE
 23268         MOVE 'I'                TO ENDT-RECORD-TYPE
 23269     ELSE
 23270         MOVE 'C'                TO ENDT-RECORD-TYPE
 23271     END-IF
 23272     MOVE +0                     TO ENDT-SEQ-NO
 23273
 23274
 23275* EXEC CICS READ
 23276*        DATASET   (FILE-ID-ERENDT)
 23277*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23278*        RIDFLD    (ERENDT-KEY)
 23279*        RESP      (WS-RESPONSE)
 23280*        GTEQ
 23281*    END-EXEC
 23282*    MOVE '&"S        G          (  N#00019600' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 428
* EL6311.cbl
 23283     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23285     MOVE X'204E233030303139363030' TO DFHEIV0(25:11)
 23286     CALL 'kxdfhei1' USING DFHEIV0,
 23287           FILE-ID-ERENDT,
 23288           DFHEIV20,
 23289           DFHEIV99,
 23290           ERENDT-KEY,
 23291           DFHEIV99,
 23292           DFHEIV99,
 23293           DFHEIV99
 23294     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23295         DFHEIV20
 23296     MOVE EIBRESP  TO WS-RESPONSE
 23297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23298
 23299     IF RESP-NORMAL
 23300        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23301        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23302            MOVE ER-0280          TO EMI-ERROR
 23303            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23304            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23305            IF CALLED-FROM-6315
 23306               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23307            END-IF
 23308            EVALUATE TRUE
 23309              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23310                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23311              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23312                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23313              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23314                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23315            END-EVALUATE
 23316        END-IF
 23317     END-IF
 23318
 23319
 23320
 23321     IF FIRST-ENTRY OR
 23322        EIBAID = DFHPF1 OR DFHPF2
 23323        MOVE '0'                TO PI-EDIT-SW
 23324        GO TO 7399-EXIT.
 23325
 23326 7355-SET-ERROR-FLAGS.
 23327
 23328     IF EMI-WARNING-CTR NOT = ZEROS
 23329        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23330        MOVE 'W'                 TO PB-WARN-ER-CD.
 23331
 23332     IF PB-UNFORCED-ERRORS OR
 23333        PB-FATAL-ERRORS    OR
 23334        PB-RECORD-ON-HOLD  OR
 23335        PB-RECORD-RETURNED OR
 23336        PB-CANCELLATION
 23337          NEXT SENTENCE
 23338        ELSE
 23339          GO TO 7399-EXIT.
 23340
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 429
* EL6311.cbl
 23341
 23342* EXEC CICS  HANDLE CONDITION
 23343*           NOTFND   (7399-EXIT)
 23344*    END-EXEC.
 23345*    MOVE '"$I                   ! U #00019650' TO DFHEIV0
 23346     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23348     MOVE X'5520233030303139363530' TO DFHEIV0(25:11)
 23349     CALL 'kxdfhei1' USING DFHEIV0
 23350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23351
 23352
 23353     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23354     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23355     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23356     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23357
 23358
 23359* EXEC CICS READ
 23360*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23361*        DATASET (FILE-ID-ELCERT)
 23362*        RIDFLD  (ELCERT-KEY)
 23363*        UPDATE
 23364*    END-EXEC.
 23365*    MOVE '&"S        EU         (   #00019659' TO DFHEIV0
 23366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23367     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23368     MOVE X'2020233030303139363539' TO DFHEIV0(25:11)
 23369     CALL 'kxdfhei1' USING DFHEIV0,
 23370           FILE-ID-ELCERT,
 23371           DFHEIV20,
 23372           DFHEIV99,
 23373           ELCERT-KEY,
 23374           DFHEIV99,
 23375           DFHEIV99,
 23376           DFHEIV99
 23377     SET ADDRESS OF CERTIFICATE-MASTER TO
 23378         DFHEIV20
 23379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23380
 23381
 23382
 23383     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23384     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23385
 23386     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23387        GO TO 7360-REWRITE-CERT-MASTER.
 23388
 23389     IF PB-ISSUE
 23390        IF PB-RECORD-RETURNED
 23391            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23392            GO TO 7360-REWRITE-CERT-MASTER
 23393        ELSE
 23394            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23395            GO TO 7360-REWRITE-CERT-MASTER.
 23396
 23397     IF PB-RECORD-RETURNED
 23398         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 430
* EL6311.cbl
 23399         GO TO 7360-REWRITE-CERT-MASTER.
 23400
 23401     IF (PB-C-LF-CANCEL-VOIDED)
 23402        or (pb-c-ah-cancel-voided)
 23403        IF (PB-UNFORCED-ERRORS OR
 23404            PB-FATAL-ERRORS    OR
 23405            PB-RECORD-ON-HOLD)
 23406            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23407            GO TO 7360-REWRITE-CERT-MASTER
 23408        ELSE
 23409            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23410            GO TO 7360-REWRITE-CERT-MASTER.
 23411
 23412     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23413                            OR PB-RECORD-ON-HOLD)
 23414        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23415     ELSE
 23416        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23417
 23418 7360-REWRITE-CERT-MASTER.
 23419
 23420     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23421        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23422
 23423* EXEC CICS UNLOCK
 23424*            DATASET    (FILE-ID-ELCERT)
 23425*       END-EXEC
 23426*    MOVE '&*                    #   #00019706' TO DFHEIV0
 23427     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23428     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23429     MOVE X'2020233030303139373036' TO DFHEIV0(25:11)
 23430     CALL 'kxdfhei1' USING DFHEIV0,
 23431           FILE-ID-ELCERT,
 23432           DFHEIV99
 23433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23434        GO TO 7399-EXIT.
 23435
 23436
 23437* EXEC CICS REWRITE
 23438*         DATASET    (FILE-ID-ELCERT)
 23439*         FROM       (CERTIFICATE-MASTER)
 23440*    END-EXEC.
 23441     MOVE LENGTH OF
 23442      CERTIFICATE-MASTER
 23443       TO DFHEIV11
 23444*    MOVE '&& L                  %   #00019711' TO DFHEIV0
 23445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23447     MOVE X'2020233030303139373131' TO DFHEIV0(25:11)
 23448     CALL 'kxdfhei1' USING DFHEIV0,
 23449           FILE-ID-ELCERT,
 23450           CERTIFICATE-MASTER,
 23451           DFHEIV11,
 23452           DFHEIV99
 23453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23454
 23455
 23456 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 431
* EL6311.cbl
 23457      EXIT.
 23458
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 432
* EL6311.cbl
 23460
 23461*************************************************************
 23462*                                                           *
 23463*              S E T   A T T R I B U T E S                  *
 23464*                                                           *
 23465*************************************************************
 23466
 23467 7400-SET-ATTRIBUTES.
 23468
 23469     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23470        GO TO 7499-EXIT.
 23471
 23472**2601**
 23473
 23474     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23475        IF PB-ISSUE
 23476           MOVE AL-UABON         TO BEFFDTA
 23477           GO TO 7499-EXIT
 23478         ELSE
 23479           MOVE AL-UABON         TO CEFFDTA
 23480           GO TO 7499-EXIT.
 23481
 23482**2604**
 23483
 23484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23485        IF PB-ISSUE
 23486           MOVE AL-UABON         TO BTYPE1A
 23487           MOVE -1               TO BTYPE1L
 23488           MOVE  1               TO SET-CURSOR-SW
 23489           GO TO 7499-EXIT.
 23490
 23491**2605**
 23492
 23493     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23494        IF PB-ISSUE
 23495           MOVE AL-UABON         TO BTYPE2A
 23496           MOVE -1               TO BTYPE2L
 23497           MOVE  1               TO SET-CURSOR-SW
 23498           GO TO 7499-EXIT.
 23499
 23500**2606**
 23501
 23502     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23503        IF PB-ISSUE
 23504           MOVE AL-UABON         TO BSIGA
 23505           MOVE -1               TO BSIGL
 23506           MOVE  1               TO SET-CURSOR-SW
 23507           GO TO 7499-EXIT.
 23508
 23509**2607**
 23510
 23511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23512        IF PB-ISSUE
 23513           MOVE AL-UABON         TO BSIGA
 23514           MOVE -1               TO BSIGL
 23515           MOVE  1               TO SET-CURSOR-SW
 23516           GO TO 7499-EXIT.
 23517
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 433
* EL6311.cbl
 23518**2615**
 23519
 23520     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23521        IF PB-ISSUE
 23522           MOVE AL-UABOF         TO BREINA
 23523           MOVE -1               TO BREINL
 23524           GO TO 7499-EXIT.
 23525
 23526**2622**
 23527
 23528     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23529        IF PB-ISSUE
 23530           MOVE AL-UABON         TO BEFFDTA
 23531           GO TO 7499-EXIT
 23532        ELSE
 23533           MOVE AL-UABON         TO CEFFDTA
 23534           GO TO 7499-EXIT.
 23535
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 434
* EL6311.cbl
 23537
 23538*************************************************************
 23539*                                                           *
 23540*              I S S U E   E R R O R S                      *
 23541*                                                           *
 23542*************************************************************
 23543
 23544 7420-ISSUE-ERRORS.
 23545
 23546     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23547        MOVE -1                  TO LETRREQL
 23548        MOVE AL-UABOF            TO LETRREQA
 23549        MOVE  1                  TO SET-CURSOR-SW
 23550        GO TO 7499-EXIT.
 23551
 23552     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23553        MOVE AL-UABOF            TO LETRREQA
 23554        GO TO 7499-EXIT.
 23555
 23556**2626**
 23557
 23558     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23559        MOVE AL-UABON            TO BCERTNOA
 23560        GO TO 7499-EXIT.
 23561
 23562**2627**
 23563
 23564     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23565        MOVE AL-UNBON            TO BAGEA
 23566        MOVE -1                  TO BAGEL
 23567        MOVE  1                  TO SET-CURSOR-SW
 23568        GO TO 7499-EXIT.
 23569
 23570**2628**
 23571
 23572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23573        MOVE AL-UNBON            TO BAGEA
 23574        MOVE -1                  TO BAGEL
 23575        MOVE  1                  TO SET-CURSOR-SW
 23576        GO TO 7499-EXIT.
 23577
 23578**2629**
 23579
 23580     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23581        MOVE AL-UABON            TO BSEXA
 23582        MOVE -1                  TO BSEXL
 23583        MOVE  1                  TO SET-CURSOR-SW
 23584        GO TO 7499-EXIT.
 23585
 23586**2630**
 23587
 23588     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23589        MOVE -1                  TO BTYPE1L
 23590        MOVE  1                  TO SET-CURSOR-SW
 23591        GO TO 7499-EXIT.
 23592
 23593**2631**
 23594
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 435
* EL6311.cbl
 23595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23596        MOVE -1                  TO BTYPE1L
 23597        MOVE  1                  TO SET-CURSOR-SW
 23598        GO TO 7499-EXIT.
 23599
 23600**2632**
 23601
 23602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23603        MOVE AL-UNBON            TO BBEN1A
 23604        MOVE -1                  TO BBEN1L
 23605        MOVE  1                  TO SET-CURSOR-SW
 23606        GO TO 7499-EXIT.
 23607
 23608**2633**
 23609
 23610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23611        MOVE AL-UNBON            TO BPREM1A
 23612        MOVE -1                  TO BPREM1L
 23613        MOVE  1                  TO SET-CURSOR-SW
 23614        GO TO 7499-EXIT.
 23615
 23616**2634**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23619        MOVE -1                  TO BTYPE2L
 23620        MOVE  1                  TO SET-CURSOR-SW
 23621        GO TO 7499-EXIT.
 23622
 23623**2635**
 23624
 23625     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23626        MOVE AL-UNBON            TO BBEN2A
 23627        MOVE -1                  TO BBEN2L
 23628        MOVE  1                  TO SET-CURSOR-SW
 23629        GO TO 7499-EXIT.
 23630
 23631**2636**
 23632
 23633     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23634        MOVE AL-UNBON            TO BPREM2A
 23635        MOVE -1                  TO BPREM2L
 23636        MOVE  1                  TO SET-CURSOR-SW
 23637        GO TO 7499-EXIT.
 23638
 23639**2639**
 23640
 23641     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23642        MOVE AL-UNBON            TO BBEN1A
 23643        MOVE -1                  TO BBEN1L
 23644        MOVE  1                  TO SET-CURSOR-SW
 23645        GO TO 7499-EXIT.
 23646
 23647**2640**
 23648
 23649     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23650        MOVE AL-UNBON            TO BBEN2A
 23651        MOVE -1                  TO BBEN2L
 23652        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 436
* EL6311.cbl
 23653        GO TO 7499-EXIT.
 23654
 23655**2647**
 23656
 23657     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23658        MOVE AL-UNBON            TO BTERM1A
 23659        MOVE -1                  TO BTERM1L
 23660        MOVE  1                  TO SET-CURSOR-SW
 23661        GO TO 7499-EXIT.
 23662
 23663**2648**
 23664
 23665     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23666              or er-3070
 23667        MOVE AL-UNBON            TO BLNTRMA
 23668        MOVE -1                  TO BLNTRML
 23669        MOVE  1                  TO SET-CURSOR-SW
 23670        GO TO 7499-EXIT.
 23671
 23672**2649**
 23673
 23674     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23675        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23676            MOVE AL-UNBON            TO BPREM1A
 23677            MOVE -1                  TO BPREM1L
 23678            MOVE  1                  TO SET-CURSOR-SW
 23679            GO TO 7499-EXIT
 23680     ELSE
 23681        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23682           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23683            MOVE AL-UNBON            TO BPREM2A
 23684            MOVE -1                  TO BPREM2L
 23685            MOVE  1                  TO SET-CURSOR-SW
 23686            GO TO 7499-EXIT.
 23687
 23688**2650**
 23689
 23690     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23691        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23692            MOVE AL-UNBON        TO BPREM1A
 23693            MOVE -1              TO BPREM1L
 23694            MOVE  1              TO SET-CURSOR-SW
 23695            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23696                MOVE AL-UNBON        TO BPREM2A
 23697                MOVE -1              TO BPREM2L
 23698                MOVE  1              TO SET-CURSOR-SW
 23699                GO TO 7499-EXIT
 23700            ELSE
 23701                GO TO 7499-EXIT
 23702        ELSE
 23703            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23704                MOVE AL-UNBON        TO BPREM2A
 23705                MOVE -1              TO BPREM2L
 23706                MOVE  1              TO SET-CURSOR-SW
 23707                GO TO 7499-EXIT
 23708            ELSE
 23709                GO TO 7499-EXIT.
 23710
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 437
* EL6311.cbl
 23711**2651**
 23712
 23713     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 23714        MOVE AL-UABON            TO BSIGA
 23715        MOVE -1                  TO BSIGL
 23716        MOVE  1                  TO SET-CURSOR-SW
 23717        GO TO 7499-EXIT.
 23718
 23719**2653**
 23720
 23721     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 23722        MOVE AL-UABON            TO BFREQA
 23723        MOVE -1                  TO BFREQL
 23724        MOVE  1                  TO SET-CURSOR-SW
 23725        GO TO 7499-EXIT.
 23726
 23727**2654**
 23728
 23729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23730        MOVE AL-UABON            TO BFREQA
 23731        MOVE -1                  TO BFREQL
 23732        MOVE  1                  TO SET-CURSOR-SW
 23733        GO TO 7499-EXIT.
 23734
 23735**2655**
 23736
 23737     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23738        MOVE AL-UABON            TO BFREQA
 23739        MOVE -1                  TO BFREQL
 23740        MOVE  1                  TO SET-CURSOR-SW
 23741        GO TO 7499-EXIT.
 23742
 23743**2656**
 23744
 23745     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23746        MOVE AL-UNBON            TO BAPRA
 23747        MOVE -1                  TO BAPRL
 23748        MOVE  1                  TO SET-CURSOR-SW
 23749        GO TO 7499-EXIT.
 23750
 23751**2657**
 23752
 23753     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23754        MOVE AL-UNBON            TO BAPRA
 23755        MOVE -1                  TO BAPRL
 23756        MOVE  1                  TO SET-CURSOR-SW
 23757        GO TO 7499-EXIT.
 23758
 23759**2658**
 23760
 23761     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23762        MOVE AL-UNBON            TO BTERM2A
 23763        MOVE -1                  TO BTERM2L
 23764        MOVE  1                  TO SET-CURSOR-SW
 23765        GO TO 7499-EXIT.
 23766
 23767**2660**
 23768
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 438
* EL6311.cbl
 23769     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23770        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23771        MOVE -1                  TO BLSTNML
 23772        MOVE  1                  TO SET-CURSOR-SW
 23773        GO TO 7499-EXIT.
 23774
 23775
 23776**2662**
 23777
 23778     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23779        MOVE AL-UNBON            TO BAGEA
 23780        MOVE -1                  TO BAGEL
 23781        MOVE  1                  TO SET-CURSOR-SW
 23782        GO TO 7499-EXIT.
 23783
 23784**2663**
 23785
 23786     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23787        MOVE AL-UNBON            TO BAGEA
 23788        MOVE -1                  TO BAGEL
 23789        MOVE  1                  TO SET-CURSOR-SW
 23790        GO TO 7499-EXIT.
 23791
 23792**2664**
 23793
 23794     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23795        MOVE AL-UABON            TO BREINA
 23796        MOVE -1                  TO BREINL
 23797        MOVE  1                  TO SET-CURSOR-SW
 23798        GO TO 7499-EXIT.
 23799
 23800**2667**
 23801
 23802     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23803        MOVE AL-UNBON            TO BBEN2A
 23804        MOVE -1                  TO BBEN2L
 23805        MOVE  1                  TO SET-CURSOR-SW
 23806        GO TO 7499-EXIT.
 23807
 23808**2668**
 23809
 23810     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23811        MOVE AL-UABON            TO BEFFDTA
 23812        GO TO 7499-EXIT.
 23813
 23814**2669**
 23815
 23816     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23817       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23818       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23819        MOVE AL-UNBON            TO BAGEA
 23820        MOVE -1                  TO BAGEL
 23821        MOVE  1                  TO SET-CURSOR-SW
 23822        GO TO 7499-EXIT.
 23823
 23824**2670**
 23825
 23826     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 439
* EL6311.cbl
 23827        MOVE AL-UABON            TO BFORCEA
 23828        MOVE -1                  TO BFORCEL
 23829        MOVE  1                  TO SET-CURSOR-SW
 23830        GO TO 7499-EXIT.
 23831
 23832**2671**
 23833
 23834     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23835        MOVE AL-UABON            TO BEFFDTA
 23836        GO TO 7499-EXIT.
 23837
 23838**2672**
 23839
 23840     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23841        MOVE AL-UABON            TO BEFFDTA
 23842        GO TO 7499-EXIT.
 23843
 23844**2673**
 23845
 23846     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23847        MOVE AL-UABON            TO BEFFDTA
 23848        GO TO 7499-EXIT.
 23849
 23850**2674**
 23851
 23852     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23853        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23854        MOVE -1                  TO BTYPE1L
 23855        MOVE  1                  TO SET-CURSOR-SW
 23856        GO TO 7499-EXIT.
 23857
 23858**2677**
 23859
 23860     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23861        MOVE AL-UNBON            TO BTERM1A
 23862        MOVE -1                  TO BTERM1L
 23863        MOVE  1                  TO SET-CURSOR-SW
 23864        GO TO 7499-EXIT.
 23865
 23866**2678**
 23867
 23868     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23869        MOVE AL-UNBON            TO BTERM2A
 23870        MOVE -1                  TO BTERM2L
 23871        MOVE  1                  TO SET-CURSOR-SW
 23872        GO TO 7499-EXIT.
 23873
 23874**2679**
 23875
 23876     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23877        MOVE AL-UABON            TO BTYPE1A
 23878        MOVE -1                  TO BTYPE1L
 23879        MOVE  1                  TO SET-CURSOR-SW
 23880        GO TO 7499-EXIT.
 23881
 23882**2680**
 23883
 23884     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 440
* EL6311.cbl
 23885        MOVE AL-UABOF            TO B1STPMTA
 23886        MOVE -1                  TO B1STPMTL
 23887        MOVE  1                  TO SET-CURSOR-SW
 23888        GO TO 7499-EXIT.
 23889
 23890**2681**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23893        MOVE AL-UABON            TO BDAYSA
 23894        MOVE -1                  TO BDAYSL
 23895        MOVE  1                  TO SET-CURSOR-SW
 23896        GO TO 7499-EXIT.
 23897
 23898**2682**
 23899
 23900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23901        MOVE AL-UABON            TO BTERM1A
 23902        MOVE -1                  TO BTERM1L
 23903        MOVE  1                  TO SET-CURSOR-SW
 23904        GO TO 7499-EXIT.
 23905
 23906**2683**
 23907
 23908     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23909        MOVE AL-UABON            TO BSKPCDA
 23910        MOVE -1                  TO BSKPCDL
 23911        MOVE  1                  TO SET-CURSOR-SW
 23912        GO TO 7499-EXIT.
 23913
 23914**2684**
 23915
 23916     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23917        MOVE AL-UABON            TO BTYPE2A
 23918        MOVE -1                  TO BTYPE2L
 23919        MOVE  1                  TO SET-CURSOR-SW
 23920        GO TO 7499-EXIT.
 23921
 23922**2686**
 23923
 23924     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23925        MOVE AL-UABON            TO BTYPE2A
 23926        MOVE -1                  TO BTYPE2L
 23927        MOVE  1                  TO SET-CURSOR-SW
 23928        GO TO 7499-EXIT.
 23929
 23930**2689**
 23931
 23932     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23933        MOVE AL-UABON            TO BSIGA
 23934        MOVE -1                  TO BSIGL
 23935        MOVE  1                  TO SET-CURSOR-SW
 23936        GO TO 7499-EXIT.
 23937
 23938**2690**
 23939
 23940     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23941        MOVE AL-UABOF            TO BLNOFCRA
 23942        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 441
* EL6311.cbl
 23943        MOVE  1                  TO SET-CURSOR-SW
 23944        GO TO 7499-EXIT.
 23945
 23946**2693**
 23947
 23948     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23949        MOVE AL-UABOF            TO BLNOFCRA
 23950        MOVE AL-UNBON            TO BBEN1A
 23951        MOVE -1                  TO BBEN1L
 23952        MOVE  1                  TO SET-CURSOR-SW
 23953        GO TO 7499-EXIT.
 23954
 23955**2720**
 23956
 23957     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23958        MOVE AL-UNBON            TO BBEN1A
 23959        MOVE -1                  TO BBEN1L
 23960        MOVE  1                  TO SET-CURSOR-SW
 23961        GO TO 7499-EXIT.
 23962
 23963**2709**
 23964
 23965*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23966*       MOVE AL-UNBON            TO BBEN1A
 23967*       MOVE -1                  TO BBEN1L
 23968*       MOVE  1                  TO SET-CURSOR-SW
 23969*       GO TO 7499-EXIT.
 23970
 23971*************************************************************
 23972*                                                           *
 23973*            C A N C E L   E R R O R S                      *
 23974*                                                           *
 23975*************************************************************
 23976
 23977**2726**
 23978
 23979     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23980        MOVE AL-UABON            TO CCERTNOA
 23981        GO TO 7499-EXIT.
 23982
 23983**2728**
 23984
 23985     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23986        MOVE AL-UABON            TO CCERTNOA
 23987        GO TO 7499-EXIT.
 23988
 23989**2729**
 23990
 23991     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23992        MOVE AL-UABON            TO CCERTNOA
 23993        GO TO 7499-EXIT.
 23994
 23995**2730**
 23996
 23997     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23998        MOVE AL-UABON            TO CCERTNOA
 23999        GO TO 7499-EXIT.
 24000
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 442
* EL6311.cbl
 24001**2731**
 24002
 24003     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24004        MOVE AL-UABON            TO CCANDT1A
 24005        MOVE -1                  TO CCANDT1L
 24006        MOVE  1                  TO SET-CURSOR-SW
 24007        GO TO 7499-EXIT.
 24008
 24009**2732**
 24010
 24011     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24012        MOVE AL-UABON            TO CCANDT1A
 24013        MOVE -1                  TO CCANDT1L
 24014        MOVE  1                  TO SET-CURSOR-SW
 24015        GO TO 7499-EXIT.
 24016
 24017**2733**
 24018
 24019     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24020        MOVE AL-UABON            TO CCANDT1A
 24021        MOVE -1                  TO CCANDT1L
 24022        MOVE  1                  TO SET-CURSOR-SW
 24023        GO TO 7499-EXIT.
 24024
 24025**2734**
 24026
 24027     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24028        MOVE AL-UNBON            TO CREFND1A
 24029        MOVE -1                  TO CREFND1L
 24030        MOVE  1                  TO SET-CURSOR-SW
 24031        GO TO 7499-EXIT.
 24032
 24033**2735**
 24034
 24035     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24036        MOVE AL-UABON            TO CCANDT2A
 24037        MOVE -1                  TO CCANDT2L
 24038        MOVE  1                  TO SET-CURSOR-SW
 24039        GO TO 7499-EXIT.
 24040
 24041**2736**
 24042
 24043     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24044        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24045            MOVE AL-UNBON        TO CREFND1A
 24046            MOVE -1              TO CREFND1L
 24047            MOVE  1              TO SET-CURSOR-SW
 24048            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24049                MOVE AL-UNBON        TO CREFND2A
 24050                MOVE -1              TO CREFND2L
 24051                MOVE  1              TO SET-CURSOR-SW
 24052                GO TO 7499-EXIT
 24053            ELSE
 24054                GO TO 7499-EXIT
 24055        ELSE
 24056            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24057                MOVE AL-UNBON        TO CREFND2A
 24058                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 443
* EL6311.cbl
 24059                MOVE  1              TO SET-CURSOR-SW
 24060                GO TO 7499-EXIT
 24061            ELSE
 24062                GO TO 7499-EXIT.
 24063
 24064**2738**
 24065
 24066     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24067        MOVE -1                  TO CREFND2L
 24068        MOVE  1                  TO SET-CURSOR-SW
 24069        GO TO 7499-EXIT.
 24070
 24071**2739**
 24072
 24073     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24074        MOVE -1                  TO CREFND1L
 24075        MOVE  1                  TO SET-CURSOR-SW
 24076        GO TO 7499-EXIT.
 24077
 24078**2741**
 24079
 24080     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24081        MOVE -1                  TO CREFND1L
 24082        MOVE  1                  TO SET-CURSOR-SW
 24083        GO TO 7499-EXIT.
 24084
 24085**2743**
 24086
 24087     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24088        MOVE AL-UNBON            TO CCANDT1A
 24089        MOVE -1                  TO CCANDT1L
 24090        MOVE  1                  TO SET-CURSOR-SW
 24091        GO TO 7499-EXIT.
 24092
 24093**2744**
 24094
 24095     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24096        MOVE AL-UNBON            TO CCANDT2A
 24097        MOVE -1                  TO CCANDT2L
 24098        MOVE  1                  TO SET-CURSOR-SW
 24099        GO TO 7499-EXIT.
 24100
 24101**2747**
 24102
 24103     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24104        MOVE AL-UABON            TO CLSTNMA
 24105        MOVE -1                  TO CLSTNML
 24106        MOVE  1                  TO SET-CURSOR-SW
 24107        GO TO 7499-EXIT.
 24108
 24109**2749**
 24110
 24111     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24112        MOVE AL-UABON            TO CFORCEA
 24113        MOVE -1                  TO CFORCEL
 24114        MOVE  1                  TO SET-CURSOR-SW
 24115        GO TO 7499-EXIT.
 24116
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 444
* EL6311.cbl
 24117**2753**
 24118
 24119     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24120        MOVE AL-UNBON            TO CCANDT1A
 24121        MOVE -1                  TO CCANDT1L
 24122        MOVE  1                  TO SET-CURSOR-SW
 24123        GO TO 7499-EXIT.
 24124
 24125**2755**
 24126
 24127     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24128        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24129            MOVE AL-UNBON        TO CREFND1A
 24130            MOVE -1              TO CREFND1L
 24131            MOVE  1              TO SET-CURSOR-SW
 24132            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24133                MOVE AL-UNBON        TO CREFND2A
 24134                MOVE -1              TO CREFND2L
 24135                MOVE  1              TO SET-CURSOR-SW
 24136                GO TO 7499-EXIT
 24137            ELSE
 24138                GO TO 7499-EXIT
 24139        ELSE
 24140            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24141                MOVE AL-UNBON        TO CREFND2A
 24142                MOVE -1              TO CREFND2L
 24143                MOVE  1              TO SET-CURSOR-SW
 24144            ELSE
 24145                GO TO 7499-EXIT.
 24146
 24147**2757**
 24148
 24149     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24150        MOVE AL-UNBON            TO CLIVESA
 24151        MOVE -1                  TO CLIVESL
 24152        MOVE  1                  TO SET-CURSOR-SW
 24153        GO TO 7499-EXIT.
 24154
 24155**2771**
 24156
 24157     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24158        MOVE AL-UABON            TO CCANDT2A
 24159        MOVE -1                  TO CCANDT2L
 24160        MOVE  1                  TO SET-CURSOR-SW
 24161        GO TO 7499-EXIT.
 24162
 24163**2774**
 24164
 24165     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24166        MOVE AL-UABON            TO CCANDT1A
 24167        MOVE -1                  TO CCANDT1L
 24168        MOVE  1                  TO SET-CURSOR-SW
 24169        GO TO 7499-EXIT.
 24170
 24171**2775**
 24172
 24173     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24174        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 445
* EL6311.cbl
 24175        MOVE -1                  TO CCANDT2L
 24176        MOVE  1                  TO SET-CURSOR-SW
 24177        GO TO 7499-EXIT.
 24178
 24179**2776**
 24180
 24181     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24182        MOVE AL-UABON            TO CCANDT1A
 24183        MOVE -1                  TO CCANDT1L
 24184        MOVE  1                  TO SET-CURSOR-SW
 24185        GO TO 7499-EXIT.
 24186
 24187
 24188**2777**
 24189
 24190     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24191        MOVE AL-UABON            TO CCANDT2A
 24192        MOVE -1                  TO CCANDT2L
 24193        MOVE  1                  TO SET-CURSOR-SW
 24194        GO TO 7499-EXIT.
 24195
 24196**2794**
 24197
 24198     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24199        MOVE AL-UABON            TO CFORCEA
 24200        MOVE -1                  TO CFORCEL
 24201        MOVE  1                  TO SET-CURSOR-SW
 24202        GO TO 7499-EXIT.
 24203
 24204**2799**
 24205
 24206     IF PI-COMPANY-ID = 'UCL'
 24207         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24208             MOVE AL-UNBON            TO BEFFDTA
 24209             MOVE -1                  TO BEFFDTL
 24210             MOVE  1                  TO SET-CURSOR-SW
 24211             GO TO 7499-EXIT.
 24212
 24213 7499-EXIT.
 24214      EXIT.
 24215
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 446
* EL6311.cbl
 24217
 24218 7500-READ-ERLOFC.
 24219     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24220                                     ERLOFC-KEY.
 24221
 24222     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24223
 24224     IF ST-ACCNT-CNTL
 24225         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24226
 24227     IF CARR-GROUP-ST-ACCNT-CNTL
 24228         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24229         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24230         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24231
 24232     IF CARR-ST-ACCNT-CNTL
 24233         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24234         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24235
 24236     IF CARR-ACCNT-CNTL
 24237         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24238
 24239     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24240
 24241     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24242
 24243
 24244* EXEC CICS HANDLE CONDITION
 24245*        NOTFND   (7550-OFFICER-NOTFND)
 24246*    END-EXEC.
 24247*    MOVE '"$I                   ! V #00020503' TO DFHEIV0
 24248     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24250     MOVE X'5620233030303230353033' TO DFHEIV0(25:11)
 24251     CALL 'kxdfhei1' USING DFHEIV0
 24252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24253
 24254
 24255
 24256* EXEC CICS READ
 24257*        DATASET   (FILE-ID-ERLOFC)
 24258*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24259*        RIDFLD    (ERLOFC-KEY)
 24260*        EQUAL
 24261*    END-EXEC.
 24262*    MOVE '&"S        E          (   #00020507' TO DFHEIV0
 24263     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24265     MOVE X'2020233030303230353037' TO DFHEIV0(25:11)
 24266     CALL 'kxdfhei1' USING DFHEIV0,
 24267           FILE-ID-ERLOFC,
 24268           DFHEIV20,
 24269           DFHEIV99,
 24270           ERLOFC-KEY,
 24271           DFHEIV99,
 24272           DFHEIV99,
 24273           DFHEIV99
 24274     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 447
* EL6311.cbl
 24275         DFHEIV20
 24276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24277
 24278
 24279     GO TO 7599-EXIT.
 24280
 24281 7550-OFFICER-NOTFND.
 24282     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24283
 24284 7599-EXIT.
 24285      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 448
* EL6311.cbl
 24287******************************************************************
 24288*                                                                *
 24289*            S  E N D    I N I T I A L   M A P                   *
 24290*                                                                *
 24291******************************************************************
 24292
 24293 8100-SEND-INITIAL-MAP.
 24294     MOVE EIBTIME                TO TIME-IN.
 24295
 24296     IF EIBAID = DFHPF11
 24297        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24299
 24300
 24301     IF PI-COMPANY-ID = CLIENT-GIC
 24302        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24303                                       BCPREM-ATTRB (2).
 24304
 24305     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24306                         CLIENT-PEM OR
 24307                         CLIENT-CSO)
 24308        AND PI-DISPLAY-ORIGINAL-BATCH
 24309          IF PI-MAP-NAME = EL631B
 24310             MOVE AL-SADOF               TO BPF5HDRA
 24311                                            BPF4HDRA
 24312          ELSE
 24313             IF PI-MAP-NAME = EL631C
 24314                MOVE AL-SADOF            TO CPF5HDRA
 24315                                            CPF4HDRA.
 24316
 24317     IF PI-MAP-NAME = EL631B
 24318        MOVE AL-SADOF               TO BPF5HDRA
 24319     ELSE
 24320        MOVE AL-SADOF               TO CPF5HDRA
 24321     END-IF
 24322
 24323*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24324     IF PI-MAP-NAME = EL631B
 24325          IF PI-COMPANY-ID NOT = 'DMD'
 24326             MOVE AL-SANOF            TO BBILLEDA
 24327             MOVE AL-SADOF            TO DMDBILA.
 24328*DMD CUSTOM CODING*************END
 24329
 24330     IF PI-PROCESSOR-ID = 'LGXX'
 24331        IF PI-MAP-NAME = EL631B
 24332           MOVE AL-SABOF                    TO BREFHDGA
 24333           MOVE AL-SANOF                    TO BREFA
 24334        ELSE
 24335           IF PI-MAP-NAME = EL631C
 24336              MOVE AL-SABOF                 TO CREFHDGA
 24337              MOVE AL-SANOF                 TO CREFA.
 24338
 24339     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24340        continue
 24341     ELSE
 24342        IF PI-MAP-NAME = EL631C
 24343           MOVE AL-SADOF         TO CCANTXTA
 24344                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 449
* EL6311.cbl
 24345        end-if
 24346     end-if
 24347     IF PI-MAP-NAME = EL631D
 24348        IF PI-AR-PROCESSING
 24349           MOVE AL-SANOF            TO DREFHDGA
 24350        ELSE
 24351           MOVE AL-SADOF            TO DREFHDGA.
 24352
 24353     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24354        AND (PI-MAP-NAME = EL631B)
 24355        MOVE AL-SADOF            TO BVINHA
 24356                                    BVINA
 24357     END-IF
 24358     IF PI-MAP-NAME = EL631B
 24359        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24360        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24361                                 TO BREGIONO
 24362        MOVE PI-PROCESSOR-ID     TO BUSERO
 24363        IF CSR-EDIT-SESSION
 24364           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24365                                 TO BHEADO
 24366           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24367        ELSE
 24368           MOVE AL-SADOF         TO BF15HDRA
 24369           MOVE '4=B-HDR      '  TO BPF4HDRO
 24370        END-IF
 24371        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24372        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24373        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24374        MOVE WS-CURRENT-DT          TO BDATEO
 24375        MOVE TIME-OUT               TO BTIMEO
 24376        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24377        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24378        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24379        IF   WS-DISPLAY-SCREEN
 24380             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24381             MOVE PB-SV-CARRIER     TO BCARRO
 24382             MOVE PB-SV-GROUPING    TO BGROUPO
 24383             MOVE PB-SV-STATE       TO BSTATEO
 24384             MOVE PB-ACCOUNT        TO BACCTO
 24385        ELSE
 24386             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24387     ELSE
 24388        IF PI-MAP-NAME = EL631C
 24389           MOVE '4=B-HDR      '     TO CPF4HDRO
 24390           IF CSR-EDIT-SESSION
 24391              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24392                                 TO CHEADO
 24393           ELSE
 24394              MOVE AL-SADOF      TO CF15HDRA
 24395           END-IF
 24396           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24397           MOVE WS-CURRENT-DT          TO CDATEO
 24398           MOVE TIME-OUT               TO CTIMEO
 24399           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24400           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24401           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24402           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 450
* EL6311.cbl
 24403           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24404           MOVE WS-C-HDG               TO CAHHDGO
 24405           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24406           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24407           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24408           IF   WS-DISPLAY-SCREEN
 24409                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24410                MOVE PB-SV-CARRIER     TO CCARRO
 24411                MOVE PB-SV-GROUPING    TO CGROUPO
 24412                MOVE PB-SV-STATE       TO CSTATEO
 24413                MOVE PB-ACCOUNT        TO CACCTO
 24414           ELSE
 24415                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24416        ELSE
 24417           MOVE WS-CURRENT-DT          TO DDATEO
 24418           MOVE TIME-OUT               TO DTIMEO
 24419           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24420                                          WS-REFUND-HDG-OVERRIDE
 24421           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24422           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24423           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24424                                          WS-REFUND-HDG-OVERRIDE
 24425           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24426           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24427           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24428           IF CSR-EDIT-SESSION
 24429              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24430                                 TO DHEADO
 24431           END-IF
 24432           IF  WS-DISPLAY-SCREEN
 24433               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24434               MOVE PB-CARRIER         TO DCARRO
 24435               MOVE PB-GROUPING        TO DGROUPO
 24436               MOVE PB-STATE           TO DSTATEO
 24437               MOVE PB-ACCOUNT         TO DACCTO
 24438               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24439           ELSE
 24440               MOVE EL631D             TO PI-MAP-NAME
 24441               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24442               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24443
 24444     MOVE SPACE                        TO WS-DISPLAY-SW.
 24445
 24446
 24447* EXEC CICS SEND
 24448*        MAP      (PI-MAP-NAME)
 24449*        MAPSET   (MAPSET-EL6311S)
 24450*        FROM     (EL631BI)
 24451*        ERASE
 24452*        CURSOR
 24453*    END-EXEC.
 24454     MOVE LENGTH OF
 24455      EL631BI
 24456       TO DFHEIV12
 24457     MOVE -1
 24458       TO DFHEIV11
 24459*    MOVE '8$     CT  E    H L F ,   #00020681' TO DFHEIV0
 24460     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 451
* EL6311.cbl
 24461     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24462     MOVE X'2020233030303230363831' TO DFHEIV0(25:11)
 24463     CALL 'kxdfhei1' USING DFHEIV0,
 24464           PI-MAP-NAME,
 24465           EL631BI,
 24466           DFHEIV12,
 24467           MAPSET-EL6311S,
 24468           DFHEIV99,
 24469           DFHEIV99,
 24470           DFHEIV99,
 24471           DFHEIV11,
 24472           DFHEIV99,
 24473           DFHEIV99,
 24474           DFHEIV99
 24475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24476
 24477
 24478     GO TO 9100-RETURN-TRAN.
 24479
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 452
* EL6311.cbl
 24481
 24482******************************************************************
 24483*                                                                *
 24484*              S E N D    D A T A O N L Y                        *
 24485*                                                                *
 24486******************************************************************
 24487
 24488 8200-SEND-DATAONLY.
 24489     MOVE EIBTIME                TO TIME-IN.
 24490
 24491     IF PI-COMPANY-ID = CLIENT-GIC
 24492        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24493                                       BCPREM-ATTRB (2).
 24494
 24495     IF PI-MAP-NAME = EL631B
 24496        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24497        MOVE WS-CURRENT-DT          TO BDATEO
 24498        MOVE TIME-OUT               TO BTIMEO
 24499        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24500        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24501        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24502        MOVE SPACES                 TO BPFENTRO
 24503        MOVE AL-UANOF               TO BPFENTRA
 24504
 24505*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24506        IF PI-COMPANY-ID NOT = 'DMD'
 24507             MOVE AL-SANOF            TO BBILLEDA
 24508             MOVE AL-SADOF            TO DMDBILA
 24509         ELSE
 24510            NEXT SENTENCE
 24511*DMD CUSTOM CODING*************END
 24512     ELSE
 24513        IF PI-MAP-NAME = EL631C
 24514           MOVE WS-CURRENT-DT          TO CDATEO
 24515           MOVE TIME-OUT               TO CTIMEO
 24516           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24517           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24518           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24519           MOVE SPACES                 TO CPFENTRO
 24520           MOVE AL-UANOF               TO CPFENTRA
 24521        ELSE
 24522           MOVE WS-CURRENT-DT          TO DDATEO
 24523           MOVE TIME-OUT               TO DTIMEO
 24524           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24525
 24526
 24527* EXEC CICS SEND
 24528*        MAP      (PI-MAP-NAME)
 24529*        MAPSET   (MAPSET-EL6311S)
 24530*        FROM     (EL631BI)
 24531*        DATAONLY
 24532*        CURSOR
 24533*    END-EXEC.
 24534     MOVE LENGTH OF
 24535      EL631BI
 24536       TO DFHEIV12
 24537     MOVE -1
 24538       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 453
* EL6311.cbl
 24539*    MOVE '8$D    CT       H L F ,   #00020737' TO DFHEIV0
 24540     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24541     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24542     MOVE X'2020233030303230373337' TO DFHEIV0(25:11)
 24543     CALL 'kxdfhei1' USING DFHEIV0,
 24544           PI-MAP-NAME,
 24545           EL631BI,
 24546           DFHEIV12,
 24547           MAPSET-EL6311S,
 24548           DFHEIV99,
 24549           DFHEIV99,
 24550           DFHEIV99,
 24551           DFHEIV11,
 24552           DFHEIV99,
 24553           DFHEIV99,
 24554           DFHEIV99
 24555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24556
 24557
 24558     GO TO 9100-RETURN-TRAN.
 24559
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 454
* EL6311.cbl
 24561
 24562******************************************************************
 24563*                                                                *
 24564*           U T I L I T Y   R O U T I N E S                      *
 24565*                                                                *
 24566******************************************************************
 24567
 24568 8300-SEND-TEXT.
 24569
 24570* EXEC CICS SEND TEXT
 24571*        FROM     (LOGOFF-TEXT)
 24572*        LENGTH   (LOGOFF-LENGTH)
 24573*        ERASE
 24574*        FREEKB
 24575*    END-EXEC.
 24576*    MOVE '8&      T  E F  H   F -   #00020756' TO DFHEIV0
 24577     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24578     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24579     MOVE X'2020233030303230373536' TO DFHEIV0(25:11)
 24580     CALL 'kxdfhei1' USING DFHEIV0,
 24581           LOGOFF-TEXT,
 24582           LOGOFF-LENGTH,
 24583           DFHEIV99,
 24584           DFHEIV99,
 24585           DFHEIV99,
 24586           DFHEIV99,
 24587           DFHEIV99,
 24588           DFHEIV99,
 24589           DFHEIV99,
 24590           DFHEIV99,
 24591           DFHEIV99,
 24592           DFHEIV99
 24593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24594
 24595
 24596
 24597* EXEC CICS RETURN
 24598*    END-EXEC.
 24599*    MOVE '.(                    ''   #00020763' TO DFHEIV0
 24600     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24602     MOVE X'2020233030303230373633' TO DFHEIV0(25:11)
 24603     CALL 'kxdfhei1' USING DFHEIV0,
 24604           DFHEIV99,
 24605           DFHEIV99,
 24606           DFHEIV99,
 24607           DFHEIV99,
 24608           DFHEIV99,
 24609           DFHEIV99
 24610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24611
 24612
 24613 8400-LOG-JOURNAL-RECORD.
 24614
 24615     if (pi-journal-file-id > 0)
 24616        and (jp-file-id = file-id-erpndb)
 24617        move eibdate             to jp-date
 24618        move eibtime             to jp-time
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 455
* EL6311.cbl
 24619*       move FILE-ID-ERPNDB      TO JP-FILE-ID
 24620        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
 24621        MOVE 03                  TO PI-JOURNAL-FILE-ID
 24622        if csr-edit-session
 24623           move 'EL6311C'        to jp-program-id
 24624        else
 24625           MOVE THIS-PGM         TO JP-PROGRAM-ID
 24626        end-if
 24627
 24628**      length is 585 plus 30 extra for jrnl stuff
 24629**      system already accounts for the 34
 24630
 24631
 24632* EXEC CICS JOURNAL
 24633*          JFILEID   (PI-JOURNAL-FILE-ID)
 24634*          JTYPEID   ('EL')
 24635*          FROM      (JOURNAL-RECORD)
 24636*          LENGTH    (615)
 24637*          resp      (ws-response)
 24638*       END-EXEC
 24639     MOVE 'EL' TO DFHEIV7
 24640     MOVE 615
 24641       TO DFHEIV11
 24642*    MOVE '4"LF                  (  N#00020784' TO DFHEIV0
 24643     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 24644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24645     MOVE X'204E233030303230373834' TO DFHEIV0(25:11)
 24646     CALL 'kxdfhei1' USING DFHEIV0,
 24647           PI-JOURNAL-FILE-ID,
 24648           DFHEIV7,
 24649           JOURNAL-RECORD,
 24650           DFHEIV11,
 24651           DFHEIV99,
 24652           DFHEIV99,
 24653           DFHEIV99
 24654     MOVE EIBRESP  TO ws-response
 24655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 24656
 24657        if resp-normal
 24658           continue
 24659        else
 24660           display ' error-el6311-journal ' ws-response
 24661        end-if
 24662     end-if
 24663
 24664*    EXEC CICS JOURNAL
 24665*        JFILEID     (PI-JOURNAL-FILE-ID)
 24666*        JTYPEID     ('EL')
 24667*        FROM        (JOURNAL-RECORD)
 24668*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24669*    END-EXEC.
 24670     .
 24671 8400-exit.
 24672     exit.
 24673 8600-DEEDIT.
 24674
 24675* EXEC CICS BIF DEEDIT
 24676*         FIELD   (DEEDIT-FIELD)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 456
* EL6311.cbl
 24677*         LENGTH  (15)
 24678*    END-EXEC.
 24679     MOVE 15
 24680       TO DFHEIV11
 24681*    MOVE '@"L                   #   #00020809' TO DFHEIV0
 24682     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24683     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24684     MOVE X'2020233030303230383039' TO DFHEIV0(25:11)
 24685     CALL 'kxdfhei1' USING DFHEIV0,
 24686           DEEDIT-FIELD,
 24687           DFHEIV11
 24688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24689
 24690
 24691 8800-UNAUTHORIZED-ACCESS.
 24692     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24693     GO TO 8300-SEND-TEXT.
 24694
 24695 8810-PF23.
 24696     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24697     MOVE XCTL-EL005             TO PGM-NAME.
 24698     GO TO 9300-XCTL.
 24699
 24700 9100-RETURN-TRAN.
 24701     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24702
 24703     IF  PI-MAP-NAME =  EL631B
 24704         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24705
 24706     IF  PI-MAP-NAME =  EL631C
 24707         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24708
 24709     IF  PI-MAP-NAME =  EL631D
 24710         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24711
 24712
 24713* EXEC CICS RETURN
 24714*        TRANSID    (TRANS-EXB1)
 24715*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24716*        LENGTH     (1300)
 24717*    END-EXEC.
 24718     MOVE 1300
 24719       TO DFHEIV11
 24720*    MOVE '.(CT                  ''   #00020835' TO DFHEIV0
 24721     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24722     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24723     MOVE X'2020233030303230383335' TO DFHEIV0(25:11)
 24724     CALL 'kxdfhei1' USING DFHEIV0,
 24725           TRANS-EXB1,
 24726           PROGRAM-INTERFACE-BLOCK,
 24727           DFHEIV11,
 24728           DFHEIV99,
 24729           DFHEIV99,
 24730           DFHEIV99
 24731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24732
 24733
 24734 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 457
* EL6311.cbl
 24735     MOVE XCTL-EL626             TO PGM-NAME.
 24736     GO TO 9300-XCTL.
 24737
 24738 9300-XCTL.
 24739
 24740* EXEC CICS XCTL
 24741*        PROGRAM    (PGM-NAME)
 24742*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24743*        LENGTH     (PI-COMM-LENGTH)
 24744*    END-EXEC.
 24745*    MOVE '.$C                   %   #00020846' TO DFHEIV0
 24746     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24747     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24748     MOVE X'2020233030303230383436' TO DFHEIV0(25:11)
 24749     CALL 'kxdfhei1' USING DFHEIV0,
 24750           PGM-NAME,
 24751           PROGRAM-INTERFACE-BLOCK,
 24752           PI-COMM-LENGTH,
 24753           DFHEIV99
 24754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24755
 24756
 24757 9400-CLEAR.
 24758     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24759     GO TO 9300-XCTL.
 24760
 24761 9500-PF12.
 24762     MOVE XCTL-EL010             TO PGM-NAME.
 24763     GO TO 9300-XCTL.
 24764
 24765 9600-PGMID-ERROR.
 24766
 24767* EXEC CICS HANDLE CONDITION
 24768*        PGMIDERR    (8300-SEND-TEXT)
 24769*    END-EXEC.
 24770*    MOVE '"$L                   ! W #00020861' TO DFHEIV0
 24771     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24773     MOVE X'5720233030303230383631' TO DFHEIV0(25:11)
 24774     CALL 'kxdfhei1' USING DFHEIV0
 24775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24776
 24777
 24778     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24779     MOVE ' '                    TO PI-ENTRY-CD-1.
 24780     MOVE XCTL-EL005             TO PGM-NAME.
 24781     MOVE PGM-NAME               TO LOGOFF-PGM.
 24782     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24783     GO TO 9300-XCTL.
 24784
 24785 9700-DATE-LINK.
 24786     MOVE LINK-ELDATCV           TO PGM-NAME.
 24787
 24788* EXEC CICS LINK
 24789*        PROGRAM    (PGM-NAME)
 24790*        COMMAREA   (DATE-CONVERSION-DATA)
 24791*        LENGTH     (DC-COMM-LENGTH)
 24792*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 458
* EL6311.cbl
 24793*    MOVE '."C                   (   #00020874' TO DFHEIV0
 24794     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24796     MOVE X'2020233030303230383734' TO DFHEIV0(25:11)
 24797     CALL 'kxdfhei1' USING DFHEIV0,
 24798           PGM-NAME,
 24799           DATE-CONVERSION-DATA,
 24800           DC-COMM-LENGTH,
 24801           DFHEIV99,
 24802           DFHEIV99,
 24803           DFHEIV99,
 24804           DFHEIV99
 24805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24806
 24807
 24808 9800-LINK-PENDING-EDIT.
 24809     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24810     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24811
 24812     MOVE LINK-EL050             TO PGM-NAME
 24813     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24814     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24815                                    WK-CO-TOL-CLAIM
 24816                                    WK-CO-TOL-PREM
 24817                                    WK-CO-TOL-REFUND
 24818                                    WK-CO-TOL-PREM-PCT
 24819                                    WK-CO-TOL-REFUND-PCT
 24820                                    WK-REFUND-OVS-AMT
 24821                                    WK-REFUND-OVS-PCT
 24822                                    WK-ACCT-ADDR
 24823                                    WK-LIFE-EDIT-ADDR
 24824                                    WK-AH-EDIT-ADDR
 24825                                    WK-LIFE-BEN-ADDR
 24826                                    WK-AH-BEN-ADDR
 24827                                    WK-STATE-ADDR
 24828                                    WK-PLAN-ADDR
 24829                                    WK-FORM-ADDR
 24830     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24831
 24832     MOVE '6'                    TO WK-ENTRY-SW.
 24833
 24834     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24835
 24836     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24837                                    EC-AM-EXPIRATION-DT
 24838                                    EC-AM-EFFECTIVE-DT
 24839                                    EC-CM-LF-CANCEL-DT
 24840                                    EC-CM-AH-CANCEL-DT
 24841                                    EC-CM-DEATH-DT.
 24842
 24843     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24844                                    EC-CO-TOL-REFUND
 24845                                    EC-CO-MIN-AGE
 24846                                    EC-CO-MIN-PREMIUM
 24847                                    EC-CO-MIN-TERM
 24848                                    EC-CO-MAX-TERM
 24849                                    EC-ST-TOL-PREM
 24850                                    EC-ST-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 459
* EL6311.cbl
 24851                                    EC-AM-LF-TOL-PREM
 24852                                    EC-AM-AH-TOL-PREM
 24853                                    EC-AM-LF-MAX-ATT-AGE
 24854                                    EC-AM-LF-MAX-AGE
 24855                                    EC-AM-LF-MAX-TERM
 24856                                    EC-AM-LF-MAX-TOT-BEN
 24857                                    EC-AM-AH-MAX-ATT-AGE
 24858                                    EC-AM-AH-MAX-AGE
 24859                                    EC-AM-AH-MAX-TERM
 24860                                    EC-AM-AH-MAX-TOT-BEN
 24861                                    EC-AM-AH-MAX-MON-BEN
 24862                                    EC-RT-LF-MAX-ATT-AGE
 24863                                    EC-RT-LF-MAX-AGE
 24864                                    EC-RT-LF-MAX-TERM
 24865                                    EC-RT-LF-MAX-TOT-BEN
 24866                                    EC-RT-AH-MAX-ATT-AGE
 24867                                    EC-RT-AH-MAX-AGE
 24868                                    EC-RT-AH-MAX-TERM
 24869                                    EC-RT-AH-MAX-TOT-BEN
 24870                                    EC-RT-AH-MAX-MON-BEN
 24871                                    EC-RT-AH-RATE
 24872                                    EC-RT-LF-RATE
 24873                                    EC-RT-LF-NSP-RATE
 24874                                    EC-RT-AH-NSP-RATE
 24875                                    EC-CM-LF-PRIOR-REFUND
 24876                                    EC-CM-AH-PRIOR-REFUND.
 24877
 24878     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24879                                    EC-ST-TOL-PREM-PCT
 24880                                    EC-AM-LF-TOL-REFUND
 24881                                    EC-AM-LF-DEV-PERCENT
 24882                                    EC-CO-TOL-REFUND-PCT
 24883                                    EC-ST-TOL-REFUND-PCT
 24884                                    EC-AM-AH-TOL-REFUND
 24885                                    EC-AM-AH-DEV-PERCENT.
 24886
 24887
 24888* EXEC CICS LINK
 24889*         PROGRAM   (PGM-NAME)
 24890*         COMMAREA  (PASSED-RECORD)
 24891*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24892*    END-EXEC.
 24893*    MOVE '."C                   (   #00020959' TO DFHEIV0
 24894     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24896     MOVE X'2020233030303230393539' TO DFHEIV0(25:11)
 24897     CALL 'kxdfhei1' USING DFHEIV0,
 24898           PGM-NAME,
 24899           PASSED-RECORD,
 24900           WS-EDIT-PASS-LENGTH,
 24901           DFHEIV99,
 24902           DFHEIV99,
 24903           DFHEIV99,
 24904           DFHEIV99
 24905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24906
 24907
 24908     MOVE '1'                    TO PI-EDIT-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 460
* EL6311.cbl
 24909     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24910
 24911     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24912
 24913     IF PI-COMPANY-ID = 'UCL'
 24914         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24915
 24916     IF VALID-PB-ID
 24917        GO TO 9800-EXIT.
 24918
 24919     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24920
 24921     IF PI-MAP-NAME = EL631B
 24922        MOVE -1                  TO BMAINTL
 24923       ELSE
 24924        MOVE -1                  TO CMAINTL.
 24925
 24926     GO TO 8200-SEND-DATAONLY.
 24927
 24928 9800-EXIT.
 24929      EXIT.
 24930
 24931 9900-ERROR-FORMAT.
 24932
 24933     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24934
 24935     IF NOT EMI-ERRORS-COMPLETE
 24936         MOVE LINK-EL001         TO PGM-NAME
 24937
 24938* EXEC CICS LINK
 24939*            PROGRAM    (PGM-NAME)
 24940*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24941*            LENGTH     (EMI-COMM-LENGTH)
 24942*        END-EXEC.
 24943*    MOVE '."C                   (   #00020994' TO DFHEIV0
 24944     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24946     MOVE X'2020233030303230393934' TO DFHEIV0(25:11)
 24947     CALL 'kxdfhei1' USING DFHEIV0,
 24948           PGM-NAME,
 24949           ERROR-MESSAGE-INTERFACE-BLOCK,
 24950           EMI-COMM-LENGTH,
 24951           DFHEIV99,
 24952           DFHEIV99,
 24953           DFHEIV99,
 24954           DFHEIV99
 24955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24956
 24957
 24958 9900-EXIT.
 24959     EXIT.
 24960
 24961 9990-ABEND.
 24962     MOVE LINK-EL004             TO PGM-NAME.
 24963     MOVE DFHEIBLK               TO EMI-LINE1.
 24964
 24965* EXEC CICS LINK
 24966*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 461
* EL6311.cbl
 24967*        COMMAREA  (EMI-LINE1)
 24968*        LENGTH    (72)
 24969*    END-EXEC.
 24970     MOVE 72
 24971       TO DFHEIV11
 24972*    MOVE '."C                   (   #00021006' TO DFHEIV0
 24973     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24975     MOVE X'2020233030303231303036' TO DFHEIV0(25:11)
 24976     CALL 'kxdfhei1' USING DFHEIV0,
 24977           PGM-NAME,
 24978           EMI-LINE1,
 24979           DFHEIV11,
 24980           DFHEIV99,
 24981           DFHEIV99,
 24982           DFHEIV99,
 24983           DFHEIV99
 24984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24985
 24986
 24987     IF PI-MAP-NAME = EL631B
 24988        MOVE -1                  TO BMAINTL
 24989       ELSE
 24990        MOVE -1                  TO CMAINTL.
 24991
 24992     IF EIBTRNID NOT = TRANS-EXB1
 24993        GO TO 8100-SEND-INITIAL-MAP
 24994       ELSE
 24995        GO TO 8200-SEND-DATAONLY.
 24996
 24997 9995-SECURITY-VIOLATION.
 24998*                            COPY ELCSCTP.
 24999******************************************************************
 25000*                                                                *
 25001*                            ELCSCTP                             *
 25002*                            VMOD=2.001                          *
 25003*                                                                *
 25004*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25005******************************************************************
 25006
 25007
 25008     MOVE EIBDATE          TO SM-JUL-DATE.
 25009     MOVE EIBTRMID         TO SM-TERMID.
 25010     MOVE THIS-PGM         TO SM-PGM.
 25011     MOVE EIBTIME          TO TIME-IN.
 25012     MOVE TIME-OUT         TO SM-TIME.
 25013     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25014
 25015
 25016* EXEC CICS LINK
 25017*         PROGRAM  ('EL003')
 25018*         COMMAREA (SECURITY-MESSAGE)
 25019*         LENGTH   (80)
 25020*    END-EXEC.
 25021     MOVE 'EL003' TO DFHEIV1
 25022     MOVE 80
 25023       TO DFHEIV11
 25024*    MOVE '."C                   (   #00021040' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 462
* EL6311.cbl
 25025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25027     MOVE X'2020233030303231303430' TO DFHEIV0(25:11)
 25028     CALL 'kxdfhei1' USING DFHEIV0,
 25029           DFHEIV1,
 25030           SECURITY-MESSAGE,
 25031           DFHEIV11,
 25032           DFHEIV99,
 25033           DFHEIV99,
 25034           DFHEIV99,
 25035           DFHEIV99
 25036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25037
 25038
 25039******************************************************************
 25040
 25041
 25042 9999-DFHBACK SECTION.
 25043     MOVE '9%                    "   ' TO DFHEIV0
 25044     MOVE 'EL6311' TO DFHEIV1
 25045     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25046     GOBACK.
 25047 9999-DFHEXIT.
 25048     IF DFHEIGDJ EQUAL 0001
 25049         NEXT SENTENCE
 25050     ELSE IF DFHEIGDJ EQUAL 2
 25051         GO TO 9600-PGMID-ERROR,
 25052               9990-ABEND,
 25053               9990-ABEND,
 25054               0010-MAIN-LOGIC
 25055         DEPENDING ON DFHEIGDI
 25056     ELSE IF DFHEIGDJ EQUAL 3
 25057         GO TO 1280-BATCH-HDR-NOT-FOUND
 25058         DEPENDING ON DFHEIGDI
 25059     ELSE IF DFHEIGDJ EQUAL 4
 25060         GO TO 1290-DUPLICATE-ALT-INDEX
 25061         DEPENDING ON DFHEIGDI
 25062     ELSE IF DFHEIGDJ EQUAL 5
 25063         GO TO 1295-CERT-TRL-REC-NOTFND
 25064         DEPENDING ON DFHEIGDI
 25065     ELSE IF DFHEIGDJ EQUAL 6
 25066         GO TO 1380-BATCH-HDR-NOT-FOUND
 25067         DEPENDING ON DFHEIGDI
 25068     ELSE IF DFHEIGDJ EQUAL 7
 25069         GO TO 1385-REC-NOT-FOUND
 25070         DEPENDING ON DFHEIGDI
 25071     ELSE IF DFHEIGDJ EQUAL 8
 25072         GO TO 1386-NOTFND
 25073         DEPENDING ON DFHEIGDI
 25074     ELSE IF DFHEIGDJ EQUAL 9
 25075         GO TO 1399-EXIT
 25076         DEPENDING ON DFHEIGDI
 25077     ELSE IF DFHEIGDJ EQUAL 10
 25078         GO TO 1480-BATCH-HDR-NOT-FOUND
 25079         DEPENDING ON DFHEIGDI
 25080     ELSE IF DFHEIGDJ EQUAL 11
 25081         GO TO 1490-RECORD-NOT-FOUND
 25082         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 463
* EL6311.cbl
 25083     ELSE IF DFHEIGDJ EQUAL 12
 25084         GO TO 1405-DELETE-CERTIFICATE
 25085         DEPENDING ON DFHEIGDI
 25086     ELSE IF DFHEIGDJ EQUAL 13
 25087         GO TO 1420-CONTINUE-DELETE
 25088         DEPENDING ON DFHEIGDI
 25089     ELSE IF DFHEIGDJ EQUAL 14
 25090         GO TO 1406-DELETE-ERNOTE
 25091         DEPENDING ON DFHEIGDI
 25092     ELSE IF DFHEIGDJ EQUAL 15
 25093         GO TO 1407-DELETE-MAILING
 25094         DEPENDING ON DFHEIGDI
 25095     ELSE IF DFHEIGDJ EQUAL 16
 25096         GO TO 1420-CONTINUE-DELETE
 25097         DEPENDING ON DFHEIGDI
 25098     ELSE IF DFHEIGDJ EQUAL 17
 25099         GO TO 1480-BATCH-HDR-NOT-FOUND
 25100         DEPENDING ON DFHEIGDI
 25101     ELSE IF DFHEIGDJ EQUAL 18
 25102         GO TO 1475-DELETE-FINISHED
 25103         DEPENDING ON DFHEIGDI
 25104     ELSE IF DFHEIGDJ EQUAL 19
 25105         GO TO 2280-BATCH-HDR-NOT-FOUND
 25106         DEPENDING ON DFHEIGDI
 25107     ELSE IF DFHEIGDJ EQUAL 20
 25108         GO TO 2290-DUPLICATE-ALT-INDEX
 25109         DEPENDING ON DFHEIGDI
 25110     ELSE IF DFHEIGDJ EQUAL 21
 25111         GO TO 2380-BATCH-HDR-NOT-FOUND
 25112         DEPENDING ON DFHEIGDI
 25113     ELSE IF DFHEIGDJ EQUAL 22
 25114         GO TO 2385-REC-NOT-FOUND
 25115         DEPENDING ON DFHEIGDI
 25116     ELSE IF DFHEIGDJ EQUAL 23
 25117         GO TO 2380-BATCH-HDR-NOT-FOUND
 25118         DEPENDING ON DFHEIGDI
 25119     ELSE IF DFHEIGDJ EQUAL 24
 25120         GO TO 2485-BATCH-HDR-NOT-FOUND
 25121         DEPENDING ON DFHEIGDI
 25122     ELSE IF DFHEIGDJ EQUAL 25
 25123         GO TO 2490-RECORD-NOT-FOUND
 25124         DEPENDING ON DFHEIGDI
 25125     ELSE IF DFHEIGDJ EQUAL 26
 25126         GO TO 2475-CONTINUE-DELETE
 25127         DEPENDING ON DFHEIGDI
 25128     ELSE IF DFHEIGDJ EQUAL 27
 25129         GO TO 2485-BATCH-HDR-NOT-FOUND
 25130         DEPENDING ON DFHEIGDI
 25131     ELSE IF DFHEIGDJ EQUAL 28
 25132         GO TO 2480-DELETE-FINISHED
 25133         DEPENDING ON DFHEIGDI
 25134     ELSE IF DFHEIGDJ EQUAL 29
 25135         GO TO 2920-PROCESS-REWRITE
 25136         DEPENDING ON DFHEIGDI
 25137     ELSE IF DFHEIGDJ EQUAL 30
 25138         GO TO 2985-RECORD-MISSING
 25139         DEPENDING ON DFHEIGDI
 25140     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 464
* EL6311.cbl
 25141         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25142         DEPENDING ON DFHEIGDI
 25143     ELSE IF DFHEIGDJ EQUAL 32
 25144         GO TO 2990-DUPLICATE-RECORD
 25145         DEPENDING ON DFHEIGDI
 25146     ELSE IF DFHEIGDJ EQUAL 33
 25147         GO TO 3590-NOT-FOUND
 25148         DEPENDING ON DFHEIGDI
 25149     ELSE IF DFHEIGDJ EQUAL 34
 25150         GO TO 3690-NOT-FOUND
 25151         DEPENDING ON DFHEIGDI
 25152     ELSE IF DFHEIGDJ EQUAL 35
 25153         GO TO 3990-NOT-FOUND
 25154         DEPENDING ON DFHEIGDI
 25155     ELSE IF DFHEIGDJ EQUAL 36
 25156         GO TO 4050-END-RECORDS,
 25157               4050-END-RECORDS
 25158         DEPENDING ON DFHEIGDI
 25159     ELSE IF DFHEIGDJ EQUAL 37
 25160         GO TO 4150-END-BATCH
 25161         DEPENDING ON DFHEIGDI
 25162     ELSE IF DFHEIGDJ EQUAL 38
 25163         GO TO 4150-END-BATCH
 25164         DEPENDING ON DFHEIGDI
 25165     ELSE IF DFHEIGDJ EQUAL 39
 25166         GO TO 4250-END-RECORDS,
 25167               4250-END-RECORDS
 25168         DEPENDING ON DFHEIGDI
 25169     ELSE IF DFHEIGDJ EQUAL 40
 25170         GO TO 4350-END-BATCH,
 25171               4350-END-BATCH
 25172         DEPENDING ON DFHEIGDI
 25173     ELSE IF DFHEIGDJ EQUAL 41
 25174         GO TO 4570-NOT-FOUND,
 25175               4550-END-RECORDS
 25176         DEPENDING ON DFHEIGDI
 25177     ELSE IF DFHEIGDJ EQUAL 42
 25178         GO TO 4680-NOT-FOUND,
 25179               4680-NOT-FOUND
 25180         DEPENDING ON DFHEIGDI
 25181     ELSE IF DFHEIGDJ EQUAL 43
 25182         GO TO 4860-NOT-FOUND,
 25183               4850-END-RECORDS
 25184         DEPENDING ON DFHEIGDI
 25185     ELSE IF DFHEIGDJ EQUAL 44
 25186         GO TO 4970-NOT-FOUND,
 25187               4950-END-RECORDS
 25188         DEPENDING ON DFHEIGDI
 25189     ELSE IF DFHEIGDJ EQUAL 45
 25190         GO TO 5050-NOT-FOUND
 25191         DEPENDING ON DFHEIGDI
 25192     ELSE IF DFHEIGDJ EQUAL 46
 25193         GO TO 5050-NOT-FOUND
 25194         DEPENDING ON DFHEIGDI
 25195     ELSE IF DFHEIGDJ EQUAL 47
 25196         GO TO 5050-NOT-FOUND
 25197         DEPENDING ON DFHEIGDI
 25198     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 465
* EL6311.cbl
 25199         GO TO 5550-END-RECORDS,
 25200               5550-END-RECORDS
 25201         DEPENDING ON DFHEIGDI
 25202     ELSE IF DFHEIGDJ EQUAL 49
 25203         GO TO 6050-QID-ERROR
 25204         DEPENDING ON DFHEIGDI
 25205     ELSE IF DFHEIGDJ EQUAL 50
 25206         GO TO 6050-QID-ERROR
 25207         DEPENDING ON DFHEIGDI
 25208     ELSE IF DFHEIGDJ EQUAL 51
 25209         GO TO 6400-CONTINUE,
 25210               6400-CONTINUE
 25211         DEPENDING ON DFHEIGDI
 25212     ELSE IF DFHEIGDJ EQUAL 52
 25213         GO TO 3690-NOT-FOUND
 25214         DEPENDING ON DFHEIGDI
 25215     ELSE IF DFHEIGDJ EQUAL 53
 25216         GO TO 7399-EXIT
 25217         DEPENDING ON DFHEIGDI
 25218     ELSE IF DFHEIGDJ EQUAL 54
 25219         GO TO 7550-OFFICER-NOTFND
 25220         DEPENDING ON DFHEIGDI
 25221     ELSE IF DFHEIGDJ EQUAL 55
 25222         GO TO 8300-SEND-TEXT
 25223         DEPENDING ON DFHEIGDI.
 25224     MOVE '9%                    "   ' TO DFHEIV0
 25225     MOVE 'EL6311' TO DFHEIV1
 25226     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25227     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16636     Code:       99389
