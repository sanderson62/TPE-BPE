* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44******************************************************************
    45
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   3
* EL131.cbl
    47 ENVIRONMENT DIVISION.
    48
    49 DATA DIVISION.
    50
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53
    54 77  FILLER  PIC X(32)  VALUE '********************************'.
    55 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    56 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    57 77  s1                          pic s999 comp-3 value+0.
    58 77  s2                          pic s999 comp-3 value+0.
    59 77  a1                          pic s999 comp-3 value+0.
    60 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    61 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    62 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    63 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    64 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    65 77  ws-max-extension            pic s999 comp-3 value +0.
    66 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    67 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    68 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    69     88  ERPDEF-FOUND                 VALUE 'Y'.
    70 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    71     88  TRLR-FILE-EOF                VALUE 'Y'.
    72 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    73     88  PAYMENT-PENDING              VALUE 'Y'.
    74 77  ws-eracct-sw                pic x  value ' '.
    75     88  acct-found                value 'Y'.
    76 77  ws-benper-sw                pic x   value ' '.
    77     88  good-benper               value 'Y'.
    78 77  ws-claim-type               pic x value ' '.
    79 77  ws-ben-per                  pic 99 value 00.
    80 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    81 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    82 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    83 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    84
    85 01  LCP-TIME-OF-DAY-XX.
    86     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    87     05  FILLER                    PIC 99.
    88 01  LCP-CICS-TIME                 PIC 9(15).
    89*                            COPY ELCSCTM.
    90******************************************************************
    91*                                                                *
    92*                                                                *
    93*                            ELCSCTM                             *
    94*                            VMOD=2.001                          *
    95*                                                                *
    96*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    97*                                                                *
    98******************************************************************
    99 01  SECURITY-MESSAGE.
   100     12  FILLER                          PIC X(30)
   101            VALUE '** LOGIC SECURITY VIOLATION -'.
   102     12  SM-READ                         PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   4
* EL131.cbl
   105     12  SM-PGM                          PIC X(6).
   106     12  FILLER                          PIC X(5)
   107            VALUE ' OPR='.
   108     12  SM-PROCESSOR-ID                 PIC X(4).
   109     12  FILLER                          PIC X(6)
   110            VALUE ' TERM='.
   111     12  SM-TERMID                       PIC X(4).
   112     12  FILLER                          PIC XX   VALUE SPACE.
   113     12  SM-JUL-DATE                     PIC 9(5).
   114     12  FILLER                          PIC X    VALUE SPACE.
   115     12  SM-TIME                         PIC 99.99.
   116
   117
   118*                            COPY ELCSCRTY.
   119******************************************************************
   120*                                                                *
   121*                                                                *
   122*                            ELCSCRTY                            *
   123*                            VMOD=2.001                          *
   124*                                                                *
   125*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   126*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   127*        SAVED IN PI-SECURITY-ADDRESS.                           *
   128*                                                                *
   129******************************************************************
   130 01  SECURITY-CONTROL.
   131     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   132     12  FILLER                       PIC XX    VALUE 'SC'.
   133     12  SC-CREDIT-CODES.
   134         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   135             20  SC-CREDIT-DISPLAY    PIC X.
   136             20  SC-CREDIT-UPDATE     PIC X.
   137     12  SC-CLAIMS-CODES.
   138         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   139             20  SC-CLAIMS-DISPLAY    PIC X.
   140             20  SC-CLAIMS-UPDATE     PIC X.
   141
   142*                            COPY ELCNWA.
   143*****************************************************************
   144*                                                               *
   145*                                                               *
   146*                            ELCNWA.                            *
   147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   148*                            VMOD=2.003                         *
   149*                                                               *
   150*            M O V E   N A M E   W O R K   A R E A.             *
   151*                                                               *
   152*****************************************************************.
   153
   154 01  WS-NAME-WORK-AREA.
   155     05  WS-INSURED-LAST-NAME        PIC X(15).
   156     05  WS-INSURED-1ST-NAME         PIC X(12).
   157     05  WS-INSURED-MID-INIT         PIC X.
   158
   159     05  WS-NAME-WORK.
   160         10  WS-NW                   PIC X
   161             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   162
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   5
* EL131.cbl
   163     05  WS-NAME-WORK2.
   164         10  WS-NW2                  PIC X
   165             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   166                                        NWA-INDEX0.
   167
   168     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   169                                     COMP-3.
   170
   171
   172 01  ws-dcc-error-line.
   173     05  filler occurs 15.
   174         10  ws-error-no        pic x(4).
   175 01  WS-DATE-AREA.
   176     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   177     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   178     12  SAVE-DATE-CCYYMMDD.
   179         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   180         16  SAVE-DATE-YMD.
   181             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   182             20  FILLER         PIC X(4)    VALUE SPACES.
   183
   184 01  WS-BLANK                   PIC X       VALUE ' '.
   185
   186 01  CSO-WORK-FIELDS.
   187     05  WS-HOLD-CLAIM-STATUS    PIC X.
   188     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   189     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   190         10  WS-RECURRENT-YN     PIC X.
   191         10  FILLER              PIC X.
   192
   193 01  LITERALS-NUMBERS.
   194     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   195     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   196     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   197     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   198     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   199     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   200     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   201     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   202
   203     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   204     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   205     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   206     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   207     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   208     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   209     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   210     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   211     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   212     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   213
   214     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   215
   216     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   217
   218     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   219     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   220     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   6
* EL131.cbl
   221     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   222     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   223     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   224     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   225     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   226     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   227     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   228     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   229
   230     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   231     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   232     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   233     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   234         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   235     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   236     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   237     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   238     12  WS-ICD-CODE-1           PIC X(8).
   239     12  WS-ICD-CODE-2           PIC X(8).
   240     12  WS-CLAIM-SEQU.
   241         16  FILLER              PIC X VALUE '('.
   242         16  WS-CURRENT-SEQU     PIC Z9.
   243         16  FILLER              PIC X(04) VALUE ' OF '.
   244         16  WS-OF-SEQU          PIC Z9.
   245         16  FILLER              PIC X VALUE ')'.
   246     12  WS-EDIT-BEN-CODE        PIC XX.
   247         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   248                                          '90' THRU '99'.
   249
   250     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   251     12  WS-EDIT-NUMBER          PIC ZZZ9.
   252
   253     12  WS-RESPONSE             PIC S9(8)   COMP.
   254         88  WS-RESP-NORMAL              VALUE +00.
   255         88  WS-RESP-ERROR               VALUE +01.
   256         88  WS-RESP-NOTFND              VALUE +13.
   257         88  WS-RESP-DUPKEY              VALUE +15.
   258         88  WS-RESP-NOTOPEN             VALUE +19.
   259         88  WS-RESP-ENDFILE             VALUE +20.
   260
   261     12  WS-MOS-PAID             PIC 999.
   262     12  WS-ODD-DAYS             PIC 99.
   263     12  WS-REM-MOS              PIC 999.
   264     12  WS-REM-DAYS             PIC 99.
   265     12  WS-TERM-IN-DAYS         PIC 9(4).
   266     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   267
   268     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   269     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   270     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   271     12  WS-RESET-SW             PIC X       VALUE 'N'.
   272     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   273     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   274     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   275
   276 01  DMD-DATE-YYYYMMDD.
   277     12  DMD-DECADE          PIC XX      VALUE SPACES.
   278     12  DMD-YYMMDD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   7
* EL131.cbl
   279         16  DMD-YY          PIC XX      VALUE SPACES.
   280         16  DMD-MM          PIC XX      VALUE SPACES.
   281         16  DMD-DD          PIC XX      VALUE SPACES.
   282
   283 01  DMD-DATE-MMDDYYYY.
   284     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   285     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   286     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   287     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   288     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   289     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   290
   291 01  WS-MAIL-CODE.
   292     12  FILLER              PIC X.
   293     12  DMD-MAIL-CODE.
   294         16  WS-MAIL-4       PIC X(4).
   295         16  WS-MAIL-5       PIC X.
   296     12  FILLER              PIC X(4).
   297
   298     12  W-NAME-LAST             PIC  X(15).
   299     12  W-NAME-FIRST            PIC  X(15).
   300     12  W-NAME-MIDDLE.
   301         16  FILLER              PIC  X.
   302         16  W-NAME-MIDDLE-2     PIC  X.
   303         16  FILLER              PIC  X(13).
   304
   305*    COPY ELCDCTB.
   306******************************************************************
   307*                                                                *
   308*                                                                *
   309*                            ELCDCTB.                            *
   310*                            VMOD=2.002                          *
   311*                                                                *
   312*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   313*       COMMUNICATIONS AREA                                      *
   314*                                                                *
   315******************************************************************
   316 01  DCT-COMMUNICATION-AREA.
   317     12  DCT-BILLING-BANK-ID      PIC  X(05).
   318     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   319     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   320     12  DCT-PRODUCT-CODE         PIC  X(02).
   321     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   322     12  DCT-RETURN-CODE          PIC  X(02).
   323     12  DCT-MAIL-CODE            PIC  X(05).
   324     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   325     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   8
* EL131.cbl
   327 01  ERROR-SWITCHES.
   328     12  ERROR-SWITCH            PIC X.
   329         88  SCREEN-ERROR                    VALUE 'X'.
   330     12  MSTR-KEY-SWITCH         PIC X.
   331         88  MSTR-KEY-CHANGED                VALUE 'X'.
   332     12  CERT-KEY-SWITCH         PIC X.
   333*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   334         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   335*********SET TO Y IF PRIMARY KEY WILL CHANGE
   336         88  CERT-KEY-CHANGED                VALUE 'Y'.
   337     12  MSTR-SWITCH             PIC X.
   338         88  MSTR-UPDATES                    VALUE 'X'.
   339     12  crtt-switch             pic x value spaces.
   340         88  crtt-update             value 'X'.
   341     12  CERT-SWITCH             PIC X.
   342         88  CERT-UPDATES                    VALUE 'X'.
   343     12  UPDATE-SWITCH           PIC X.
   344         88  UPDATES-PRESENT                 VALUE 'X'.
   345     12  TRLR-SWITCH             PIC X.
   346         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   347         88  UPDATE-MADE                     VALUE 'Y'.
   348     12  NINETY-TRLR-SWITCH      PIC X.
   349         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   350     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   351         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   352     12  EARNINGS-CALC-SWITCH    PIC X.
   353         88  TEX-REG                         VALUE '4'.
   354         88  NET-PAY                         VALUE '5'.
   355     12  DLYACTV-SW              PIC X       VALUE 'N'.
   356         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page   9
* EL131.cbl
   358 01  EDIT-WORK-AREA.
   359     12  COUNT-2                 PIC 9.
   360     12  CALL-PGM                PIC X(8).
   361     12  TRANS-ID                PIC X(4).
   362     12  CHECK-PFKEYS            PIC 99.
   363     12  CHECK-MAINT             PIC X.
   364         88  ADD-ALPHA-RECORD                VALUE 'A'.
   365         88  CHANGE-CLAIM                    VALUE 'C'.
   366         88  DELETE-CLAIM                    VALUE 'D'.
   367         88  CHANGE-NAME                     VALUE 'N'.
   368         88  VALID-OPTIONS                   VALUE 'A' 'C'
   369                                                   'D' 'N'.
   370
   371     12  HOLD-BENEFIT            PIC XX.
   372     12  HOLD-FREQ               PIC XX.
   373     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   374     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   375     12  HOLD-PDTHRU             PIC XX.
   376     12  HOLD-ADDON              PIC XX.
   377     12  HOLD-NODAYS             PIC 9(4).
   378     12  HOLD-NOPMTS             PIC 9(3).
   379     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   380     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   381     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   382     12  HOLD-BIRTH              PIC XX.
   383     12  HOLD-END                PIC XX.
   384     12  HOLD-EFF                PIC XX.
   385     12  HOLD-ENTRY              PIC XX.
   386     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   387     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   388     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   389     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   390     12  HOLD-LF-CV-CAN          PIC XX.
   391     12  HOLD-AH-CV-CAN          PIC XX.
   392     12  DIVIDE-QUOT             PIC 9(3).
   393     12  DIVIDE-REM              PIC 9(3).
   394
   395     12  WS-ALPHA-DATE.
   396         16  WS-ALPHA-YEAR.
   397             20  WS-ALPHA-YY-1   PIC 99.
   398             20  WS-ALPHA-YY-2   PIC 99.
   399         16  WS-ALPHA-MM         PIC 99.
   400         16  WS-ALPHA-DD         PIC 99.
   401
   402     12  BUILD-VALID-DATE.
   403         16  BUILD-MONTH         PIC 99.
   404         16  BUILD-DAY           PIC 99.
   405         16  BUILD-YEAR          PIC 99.
   406     12  DEEDIT-MMYY-INPUT.
   407         16  FILLER              PIC X.
   408         16  DEEDIT-MONTH        PIC XX.
   409         16  DEEDIT-YEAR         PIC XX.
   410     12  DEEDIT-BEN              PIC 9(9)V99.
   411     12  DEEDIT-DATE-INPUT.
   412         16  FILLER              PIC XX.
   413         16  DEEDIT-DATE         PIC X(6).
   414     12  WORK-DATE-MDY.
   415         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  10
* EL131.cbl
   416         16  FILLER              PIC X(4).
   417         16  YEAR-WORK           PIC XX.
   418     12  WORK-DATE-MY.
   419         16  WORK-MONTH          PIC XX.
   420         16  WORK-SLASH          PIC X       VALUE '/'.
   421         16  WORK-YEAR           PIC XX.
   422     12  HOLD-DATE.
   423         16  HOLD-MONTH          PIC 99.
   424         16  FILLER              PIC X(4).
   425         16  HOLD-YEAR           PIC 99.
   426     12  SPLIT-INFO-LINE-1.
   427         16  SPLIT-INFO-DESC     PIC X(15).
   428         16  FILLER              PIC X(5)    VALUE ' OLD='.
   429         16  SPLIT-INFO-OLD      PIC X(40).
   430     12  EFF-TERM-MO             PIC 9(4).
   431     12  CURR-MO                 PIC 9(4).
   432     12  WS-BIN-CURRENT-DT       PIC XX.
   433     12  WS-CALC-METHOD          PIC X.
   434     12  WS-INITIALS.
   435         16  WS-INIT-1           PIC X.
   436         16  WS-INIT-2           PIC X.
   437     12  WS-REIN-TABLE.
   438         16  WS-REIN-1           PIC X.
   439         16  WS-REIN-2           PIC X.
   440         16  WS-REIN-3           PIC X.
   441     12  PI-KEY.
   442         16  PI-TERM             PIC X(4).
   443         16  PI-QUAL             PIC X(4).
   444     12  CHECK-KEY               PIC X(20).
   445     12  SAVE-ACCT-KEY           PIC X(20).
   446     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   447     12  WS-SOC-SEC-NUMBER.
   448         16  WS-SOC-SEC-NO       PIC 9(9).
   449         16  WS-SOC-SEC-BLANK    PIC X(2).
   450     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   451         16  WS-SSN-1-3          PIC 9(3).
   452         16  WS-SSN-DASH1        PIC X(1).
   453         16  WS-SSN-4-5          PIC 9(2).
   454         16  WS-SSN-DASH2        PIC X(1).
   455         16  WS-SSN-6-9          PIC 9(4).
   456     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   457     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   458
   459 01  WS-SAVE-FIELDS.
   460     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   461     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   462     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   463     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   464     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   465     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   466     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   467     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   468     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   469     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   470     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   471     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   472     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  11
* EL131.cbl
   474     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   476     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   478     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   479     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   480     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   481     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   482     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   484     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   486     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   488     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   490     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   492     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   494     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   496     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   498     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   500     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   502     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   504     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   506     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   507     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   508     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   509     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   510     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   511     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   512     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   513     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   514     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   515
   516 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   517     12  M                   PIC S9(7)V99           VALUE ZEROS.
   518     12  L                   PIC S9(7)V99           VALUE ZEROS.
   519     12  N                   PIC S9(3)              VALUE ZEROS.
   520     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   521     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   522     12  I                   PIC S99V9(5)           VALUE ZEROS.
   523     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   524     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   525     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   526     12  R                   PIC S9(3)              VALUE ZEROS.
   527     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   528     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   529     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   530     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   531     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  12
* EL131.cbl
   532     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   533     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   534     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   535     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   536
   537 01  TERM-CALC-WORK-AREA.
   538     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   539     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   540     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   541     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   542     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   543     12  V-EXPONENTS.
   544        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   545     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   546
   547 01  TIME-IN.
   548     12  UN-HOURS                PIC XX.
   549     12  UN-MINUTES              PIC XX.
   550     12  FILLER                  PIC XX.
   551
   552 01  TIME-OUT.
   553     12  FOR-HOURS               PIC XX.
   554     12  FILLER                  PIC X       VALUE '.'.
   555     12  FOR-MINUTES             PIC XX.
   556
   557 01  ERROR-NUMBERS.
   558     12  ER-0000                 PIC X(4)    VALUE '0000'.
   559     12  ER-0004                 PIC X(4)    VALUE '0004'.
   560     12  ER-0008                 PIC X(4)    VALUE '0008'.
   561     12  ER-0023                 PIC X(4)    VALUE '0023'.
   562     12  ER-0029                 PIC X(4)    VALUE '0029'.
   563     12  ER-0068                 PIC X(4)    VALUE '0068'.
   564     12  ER-0070                 PIC X(4)    VALUE '0070'.
   565     12  ER-0149                 PIC X(4)    VALUE '0149'.
   566     12  ER-0154                 PIC X(4)    VALUE '0154'.
   567     12  ER-0169                 PIC X(4)    VALUE '0169'.
   568     12  ER-0192                 PIC X(4)    VALUE '0192'.
   569     12  ER-0199                 PIC X(4)    VALUE '0199'.
   570     12  ER-0203                 PIC X(4)    VALUE '0203'.
   571     12  ER-0204                 PIC X(4)    VALUE '0204'.
   572     12  ER-0205                 PIC X(4)    VALUE '0205'.
   573     12  ER-0206                 PIC X(4)    VALUE '0206'.
   574     12  ER-0208                 PIC X(4)    VALUE '0208'.
   575     12  ER-0210                 PIC X(4)    VALUE '0210'.
   576     12  ER-0215                 PIC X(4)    VALUE '0215'.
   577     12  ER-0219                 PIC X(4)    VALUE '0219'.
   578     12  ER-0220                 PIC X(4)    VALUE '0220'.
   579     12  ER-0222                 PIC X(4)    VALUE '0222'.
   580     12  ER-0223                 PIC X(4)    VALUE '0223'.
   581     12  ER-0224                 PIC X(4)    VALUE '0224'.
   582     12  ER-0227                 PIC X(4)    VALUE '0227'.
   583     12  ER-0230                 PIC X(4)    VALUE '0230'.
   584     12  ER-0232                 PIC X(4)    VALUE '0232'.
   585     12  ER-0233                 PIC X(4)    VALUE '0233'.
   586     12  ER-0236                 PIC X(4)    VALUE '0236'.
   587     12  ER-0237                 PIC X(4)    VALUE '0237'.
   588     12  ER-0238                 PIC X(4)    VALUE '0238'.
   589     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  13
* EL131.cbl
   590     12  ER-0241                 PIC X(4)    VALUE '0241'.
   591     12  ER-0243                 PIC X(4)    VALUE '0243'.
   592     12  ER-0244                 PIC X(4)    VALUE '0244'.
   593     12  ER-0246                 PIC X(4)    VALUE '0246'.
   594     12  ER-0247                 PIC X(4)    VALUE '0247'.
   595     12  ER-0248                 PIC X(4)    VALUE '0248'.
   596     12  ER-0250                 PIC X(4)    VALUE '0250'.
   597     12  ER-0251                 PIC X(4)    VALUE '0251'.
   598     12  ER-0253                 PIC X(4)    VALUE '0253'.
   599     12  ER-0256                 PIC X(4)    VALUE '0256'.
   600     12  ER-0257                 PIC X(4)    VALUE '0257'.
   601     12  ER-0258                 PIC X(4)    VALUE '0258'.
   602     12  ER-0259                 PIC X(4)    VALUE '0259'.
   603     12  ER-0260                 PIC X(4)    VALUE '0260'.
   604     12  ER-0261                 PIC X(4)    VALUE '0261'.
   605     12  ER-0262                 PIC X(4)    VALUE '0262'.
   606     12  ER-0263                 PIC X(4)    VALUE '0263'.
   607     12  ER-0273                 PIC X(4)    VALUE '0273'.
   608     12  ER-0274                 PIC X(4)    VALUE '0274'.
   609     12  ER-0276                 PIC X(4)    VALUE '0276'.
   610     12  ER-0282                 PIC X(4)    VALUE '0282'.
   611     12  ER-0283                 PIC X(4)    VALUE '0283'.
   612     12  ER-0309                 PIC X(4)    VALUE '0309'.
   613     12  ER-0310                 PIC X(4)    VALUE '0310'.
   614     12  ER-0311                 PIC X(4)    VALUE '0311'.
   615     12  ER-0333                 PIC X(4)    VALUE '0333'.
   616     12  ER-0360                 PIC X(4)    VALUE '0360'.
   617     12  ER-0377                 PIC X(4)    VALUE '0377'.
   618     12  ER-0402                 PIC X(4)    VALUE '0402'.
   619     12  ER-0416                 PIC X(4)    VALUE '0416'.
   620     12  ER-0426                 PIC X(4)    VALUE '0426'.
   621     12  ER-0427                 PIC X(4)    VALUE '0427'.
   622     12  ER-0428                 PIC X(4)    VALUE '0428'.
   623     12  ER-0429                 PIC X(4)    VALUE '0429'.
   624     12  ER-0430                 PIC X(4)    VALUE '0430'.
   625     12  ER-0458                 PIC X(4)    VALUE '0458'.
   626     12  ER-0475                 PIC X(4)    VALUE '0475'.
   627     12  ER-0491                 PIC X(4)    VALUE '0491'.
   628     12  ER-0509                 PIC X(4)    VALUE '0509'.
   629     12  ER-0510                 PIC X(4)    VALUE '0510'.
   630     12  ER-0511                 PIC X(4)    VALUE '0511'.
   631     12  ER-0512                 PIC X(4)    VALUE '0512'.
   632     12  ER-0519                 PIC X(4)    VALUE '0519'.
   633     12  ER-0520                 PIC X(4)    VALUE '0520'.
   634     12  ER-0521                 PIC X(4)    VALUE '0521'.
   635     12  ER-0547                 PIC X(4)    VALUE '0547'.
   636     12  ER-0548                 PIC X(4)    VALUE '0548'.
   637     12  ER-0549                 PIC X(4)    VALUE '0549'.
   638     12  ER-0565                 PIC X(4)    VALUE '0565'.
   639     12  ER-0598                 PIC X(4)    VALUE '0598'.
   640     12  ER-0639                 PIC X(4)    VALUE '0639'.
   641     12  ER-0797                 PIC X(4)    VALUE '0797'.
   642     12  ER-0802                 PIC X(4)    VALUE '0802'.
   643     12  ER-0803                 PIC X(4)    VALUE '0803'.
   644     12  ER-0849                 PIC X(4)    VALUE '0849'.
   645     12  ER-0885                 PIC X(4)    VALUE '0885'.
   646     12  ER-0887                 PIC X(4)    VALUE '0887'.
   647     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  14
* EL131.cbl
   648     12  ER-0921                 PIC X(4)    VALUE '0921'.
   649     12  ER-0938                 PIC X(4)    VALUE '0938'.
   650     12  ER-0946                 PIC X(4)    VALUE '0946'.
   651     12  ER-0947                 PIC X(4)    VALUE '0947'.
   652     12  ER-0948                 PIC X(4)    VALUE '0948'.
   653     12  ER-0949                 PIC X(4)    VALUE '0949'.
   654     12  ER-0950                 PIC X(4)    VALUE '0950'.
   655     12  ER-0951                 PIC X(4)    VALUE '0951'.
   656     12  ER-0954                 PIC X(4)    VALUE '0954'.
   657     12  ER-0974                 PIC X(4)    VALUE '0974'.
   658     12  ER-0975                 PIC X(4)    VALUE '0975'.
   659     12  ER-0992                 PIC X(4)    VALUE '0992'.
   660     12  er-1581                 pic x(4)    value '1581'.
   661     12  ER-1651                 PIC X(4)    VALUE '1651'.
   662     12  ER-1652                 PIC X(4)    VALUE '1652'.
   663     12  ER-1653                 PIC X(4)    VALUE '1653'.
   664     12  ER-1654                 PIC X(4)    VALUE '1654'.
   665     12  ER-1655                 PIC X(4)    VALUE '1655'.
   666     12  er-1656                 pic x(4)    value '1656'.
   667     12  ER-1661                 PIC X(4)    VALUE '1661'.
   668     12  ER-1662                 PIC X(4)    VALUE '1662'.
   669     12  ER-1663                 PIC X(4)    VALUE '1663'.
   670     12  er-1664                 pic x(4)    value '1664'.
   671     12  er-1665                 pic x(4)    value '1665'.
   672     12  er-1666                 pic x(4)    value '1666'.
   673     12  er-1668                 pic x(4)    value '1668'.
   674     12  er-1669                 pic x(4)    value '1669'.
   675     12  er-1676                 pic x(4)    value '1676'.
   676     12  ER-1772                 PIC X(4)    VALUE '1772'.
   677     12  ER-1773                 PIC X(4)    VALUE '1773'.
   678     12  ER-2280                 PIC X(4)    VALUE '2280'.
   679     12  ER-2878                 PIC X(4)    VALUE '2878'.
   680     12  ER-7641                 PIC X(4)    VALUE '7641'.
   681     12  ER-7642                 PIC X(4)    VALUE '7642'.
   682     12  ER-7650                 PIC X(4)    VALUE '7650'.
   683     12  ER-7651                 PIC X(4)    VALUE '7651'.
   684     12  ER-7687                 PIC X(4)    VALUE '7687'.
   685     12  ER-7689                 PIC X(4)    VALUE '7689'.
   686     12  ER-7690                 PIC X(4)    VALUE '7690'.
   687     12  ER-7691                 PIC X(4)    VALUE '7691'.
   688     12  ER-8003                 PIC X(4)    VALUE '8003'.
   689     12  ER-8051                 PIC X(4)    VALUE '8051'.
   690     12  ER-8052                 PIC X(4)    VALUE '8052'.
   691     12  ER-8053                 PIC X(4)    VALUE '8053'.
   692     12  ER-8054                 PIC X(4)    VALUE '8054'.
   693     12  ER-8055                 PIC X(4)    VALUE '8055'.
   694     12  ER-8056                 PIC X(4)    VALUE '8056'.
   695     12  ER-8057                 PIC X(4)    VALUE '8057'.
   696     12  ER-8058                 PIC X(4)    VALUE '8058'.
   697     12  ER-8059                 PIC X(4)    VALUE '8059'.
   698     12  ER-8060                 PIC X(4)    VALUE '8060'.
   699     12  ER-8061                 PIC X(4)    VALUE '8061'.
   700     12  ER-8062                 PIC X(4)    VALUE '8062'.
   701     12  ER-8063                 PIC X(4)    VALUE '8063'.
   702     12  ER-8064                 PIC X(4)    VALUE '8064'.
   703     12  ER-8065                 PIC X(4)    VALUE '8065'.
   704     12  ER-8066                 PIC X(4)    VALUE '8066'.
   705     12  ER-8152                 PIC X(4)    VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  15
* EL131.cbl
   706     12  ER-8153                 PIC X(4)    VALUE '8153'.
   707     12  ER-8154                 PIC X(4)    VALUE '8154'.
   708     12  ER-8155                 PIC X(4)    VALUE '8155'.
   709 01  ERPDEF-KEY-SAVE             PIC X(18).
   710 01  ERPDEF-KEY.
   711     12  ERPDEF-COMPANY-CD       PIC X.
   712     12  ERPDEF-STATE            PIC XX.
   713     12  ERPDEF-PROD-CD          PIC XXX.
   714     12  F                       PIC X(7).
   715     12  ERPDEF-BEN-TYPE         PIC X.
   716     12  ERPDEF-BEN-CODE         PIC XX.
   717     12  ERPDEF-EXP-DT           PIC XX.
   718 01  MSTR-KEY.
   719     12  COMPANY-CODE            PIC X.
   720     12  CARRIER-CODE            PIC X.
   721     12  CLAIM-NO                PIC X(7).
   722     12  CERT-NO.
   723         16  CERT-NO-PRIME       PIC X(10).
   724         16  CERT-NO-SUFX        PIC X.
   725
   726 01  WS-SAVE-CLAIM-KEY.
   727     12  WS-SAVE-COMPANY-CD      PIC X.
   728     12  WS-SAVE-CARRIER         PIC X.
   729     12  WS-SAVE-CLAIM-NO        PIC X(7).
   730     12  WS-SAVE-CERT-NO.
   731         16  WS-CERT-NO-PRIME    PIC X(10).
   732         16  WS-CERT-NO-SUFX     PIC X.
   733
   734 01  CERT-KEY.
   735     12  CERT-COMPANY-CODE       PIC X.
   736     12  CERT-CARRIER            PIC X.
   737     12  CERT-GROUP              PIC X(6).
   738     12  CERT-STATE              PIC XX.
   739     12  CERT-ACCOUNT            PIC X(10).
   740     12  CERT-DATE               PIC XX.
   741     12  CERT-CERT.
   742         16  CERT-CERT-PRIME     PIC X(10).
   743         16  CERT-CERT-SUFX      PIC X.
   744
   745 01  ELCRTT-KEY.
   746     05  CTRLR-COMP-CD       PIC X.
   747     05  CTRLR-CARRIER       PIC X.
   748     05  CTRLR-GROUPING      PIC X(6).
   749     05  CTRLR-STATE         PIC X(2).
   750     05  CTRLR-ACCOUNT       PIC X(10).
   751     05  CTRLR-EFF-DT        PIC XX.
   752     05  CTRLR-CERT-NO       PIC X(11).
   753     05  CTRLR-REC-TYPE      PIC X.
   754 01  NOTE-KEY.
   755     12  NOTE-COMP-CD            PIC X.
   756     12  NOTE-CERT-KEY.
   757         16  NOTE-CARRIER        PIC X.
   758         16  NOTE-GROUP          PIC X(6).
   759         16  NOTE-STATE          PIC XX.
   760         16  NOTE-ACCOUNT        PIC X(10).
   761         16  NOTE-DATE           PIC XX.
   762         16  NOTE-CERT-NO        PIC X(11).
   763
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  16
* EL131.cbl
   764 01  TRLR-KEY.
   765     12  TRLR-MAIN-KEY.
   766         16  TRLR-COMPANY-CD     PIC X.
   767         16  TRLR-CARRIER        PIC X.
   768         16  TRLR-CLAIM-NO       PIC X(07).
   769         16  TRLR-CERT-NO        PIC X(11).
   770     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   771
   772 01  BENEFIT-KEY.
   773     12  BEN-CO-ID               PIC X(3).
   774     12  BEN-REC-TYPE            PIC X.
   775     12  FILLER                  PIC XX.
   776     12  BEN-ACC-CD              PIC XX.
   777     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   778
   779 01  CNTL-KEY.
   780     12  CNTL-CO-ID              PIC X(3).
   781     12  CNTL-REC-TYPE           PIC X.
   782     12  CNTL-PROC-ID            PIC X(4).
   783     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   784         16  CNTL-STATE-NUMBER   PIC XX.
   785         16  FILLER              PIC XX.
   786     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   787         16  FILLER              PIC X(3).
   788         16  CNTL-CARRIER        PIC X.
   789     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   790
   791 01  ACTQ-KEY                    PIC X(20).
   792
   793 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   794
   795 01  CHKQ-KEY.
   796     12  CHKQ-COMPANY-CODE       PIC X.
   797     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   798     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   799
   800 01  ARCH-KEY.
   801     12  ARCH-COMPANY-CODE       PIC X.
   802     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   803     12  ARCH-RECORD-TYPE        PIC X.
   804     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   805
   806 01  ACCT-KEY.
   807     05  ACCT-PARTIAL-KEY.
   808         12  ACCT-COMPANY-CODE   PIC X.
   809         12  ACCT-CARRIER        PIC X.
   810         12  ACCT-GROUP          PIC X(6).
   811         12  ACCT-STATE          PIC XX.
   812         12  ACCT-ACCOUNT        PIC X(10).
   813     05  ACCT-DATE               PIC XX.
   814
   815 01  WS-ELBENE-KEY.
   816     12  WS-ELBENE-COMPANY-CD    PIC X.
   817     12  WS-ELBENE-RECORD-TYPE   PIC X.
   818     12  WS-ELBENE-ID            PIC X(10).
   819
   820 01  ELALPH-KEY.
   821     12  ELALPH-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  17
* EL131.cbl
   822     12  ELALPH-SOURCE           PIC X.
   823     12  ELALPH-NAME.
   824         16  ELALPH-LAST-NAME    PIC X(15).
   825         16  ELALPH-FIRST-NAME.
   826             20  ELALPH-FIRST-INIT   PIC X.
   827             20  FILLER              PIC X(11).
   828         16  ELALPH-MIDDLE-INIT  PIC X.
   829     12  ELALPH-DATE             PIC X(08).
   830     12  ELALPH-TIME             PIC S9(04)    COMP.
   831
   832 01  COMP-LENGTHS.
   833     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   834     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   835     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   836     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   837     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   838     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   839     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   840     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   841     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   842     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   843     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   844     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   845     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   846     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  18
* EL131.cbl
   848*                                COPY ELCLNKLT.
   849******************************************************************
   850*                                                                *
   851*                                                                *
   852*                           ELCLNKLT                             *
   853*                            VMOD=2.003                          *
   854*                                                                *
   855*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   856*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   857*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   858*                                                                *
   859*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   860*   COMPLETING THE REQUIRED FIELDS.                              *
   861*                                                                *
   862*   THE CALLING PROGRAM SHOULD CHECK:                            *
   863*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   864*                              9999 INDICATES AN UNKNOWN ABEND   *
   865*                                   WAS DETECTED.                *
   866*                              ALL OTHER VALUES ARE NORMAL ERROR *
   867*                              CODES FOUND IN THE ERROR FILE.    *
   868******************************************************************
   869 01  W-1523-LINKDATA.
   870     12  W-1523-COMMON-PI-DATA.
   871         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   872         16  FILLER              PIC  X(67).
   873         16  W-1523-COMPANY-CD   PIC  X(01).
   874         16  FILLER              PIC  X(10).
   875         16  W-1523-CONTROL-IN-PROGRESS.
   876             20  W-1523-CARRIER  PIC  X(01).
   877             20  W-1523-GROUPING PIC  X(06).
   878             20  W-1523-STATE    PIC  X(02).
   879             20  W-1523-ACCOUNT  PIC  X(10).
   880             20  W-1523-CLAIM-CERT-GRP.
   881                 24  W-1523-CLAIM-NO
   882                                 PIC  X(07).
   883                 24  W-1523-CERT-NO.
   884                     28  W-1523-CERT-PRIME
   885                                 PIC  X(10).
   886                     28  W-1523-CERT-SFX
   887                                 PIC  X(01).
   888                 24  W-1523-CERT-EFF-DT
   889                                 PIC  X(02).
   890         16  FILLER              PIC X(265).
   891
   892     12  W-1523-WORK-AREA.
   893         16  W-1523-FORM-NUMBER  PIC  X(04).
   894         16  W-1523-NUMBER-COPIES
   895                                 PIC  9(01).
   896         16  W-1523-ADDR-TYPE    PIC  X(02).
   897         16  W-1523-FOLLOW-UP-DATE
   898                                 PIC  X(02).
   899         16  W-1523-RESEND-DATE  PIC  X(02).
   900         16  W-1523-ERROR-CODE   PIC  9(04).
   901             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   902             88  W-1523-FATAL-ERROR
   903                                    VALUES  0006 0013 0042
   904                                            0154 0168 0169
   905                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  19
* EL131.cbl
   906                                            0179 0186 0281
   907                                            0332 2055 3697
   908                                            3698 3699 3770
   909                                            3771 3772 7675
   910                                            9106 9808 9883
   911                                            9887.
   912             88  W-1523-STOP-ERRORS
   913                                    VALUES  0013 0042 0154
   914                                            0168 0169 0172
   915                                            0281 0332 2055
   916                                            3698 3699 7675
   917                                            9106 9808 9883
   918                                            9999.
   919         16  W-1523-REASON       PIC  X(70).
   920         16  W-1523-ARCHIVE-NUMBER
   921                                 PIC  9(08).
   922     12  W-1523-POINTER-AREA.
   923         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   924         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   925         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   926         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   927         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  20
* EL131.cbl
   929*                                COPY ELCINTF.
   930******************************************************************
   931*                                                                *
   932*                                                                *
   933*                            ELCINTF.                            *
   934*                            VMOD=2.017                          *
   935*                                                                *
   936*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   937*                                                                *
   938*       LENGTH = 1024                                            *
   939*                                                                *
   940******************************************************************
   941*                   C H A N G E   L O G
   942*
   943* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   944*-----------------------------------------------------------------
   945*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   946* EFFECTIVE    NUMBER
   947*-----------------------------------------------------------------
   948* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   949******************************************************************
   950 01  PROGRAM-INTERFACE-BLOCK.
   951     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   952     12  PI-CALLING-PROGRAM              PIC X(8).
   953     12  PI-SAVED-PROGRAM-1              PIC X(8).
   954     12  PI-SAVED-PROGRAM-2              PIC X(8).
   955     12  PI-SAVED-PROGRAM-3              PIC X(8).
   956     12  PI-SAVED-PROGRAM-4              PIC X(8).
   957     12  PI-SAVED-PROGRAM-5              PIC X(8).
   958     12  PI-SAVED-PROGRAM-6              PIC X(8).
   959     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   960     12  PI-COMPANY-ID                   PIC XXX.
   961     12  PI-COMPANY-CD                   PIC X.
   962
   963     12  PI-COMPANY-PASSWORD             PIC X(8).
   964
   965     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   966
   967     12  PI-CONTROL-IN-PROGRESS.
   968         16  PI-CARRIER                  PIC X.
   969         16  PI-GROUPING                 PIC X(6).
   970         16  PI-STATE                    PIC XX.
   971         16  PI-ACCOUNT                  PIC X(10).
   972         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   973                                         PIC X(10).
   974         16  PI-CLAIM-CERT-GRP.
   975             20  PI-CLAIM-NO             PIC X(7).
   976             20  PI-CERT-NO.
   977                 25  PI-CERT-PRIME       PIC X(10).
   978                 25  PI-CERT-SFX         PIC X.
   979             20  PI-CERT-EFF-DT          PIC XX.
   980         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   981             20  PI-PLAN-CODE            PIC X(2).
   982             20  PI-REVISION-NUMBER      PIC X(3).
   983             20  PI-PLAN-EFF-DT          PIC X(2).
   984             20  PI-PLAN-EXP-DT          PIC X(2).
   985             20  FILLER                  PIC X(11).
   986         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  21
* EL131.cbl
   987             20  PI-OE-REFERENCE-1.
   988                 25  PI-OE-REF-1-PRIME   PIC X(18).
   989                 25  PI-OE-REF-1-SUFF    PIC XX.
   990
   991     12  PI-SESSION-IN-PROGRESS          PIC X.
   992         88  CLAIM-SESSION                   VALUE '1'.
   993         88  CREDIT-SESSION                  VALUE '2'.
   994         88  WARRANTY-SESSION                VALUE '3'.
   995         88  MORTGAGE-SESSION                VALUE '4'.
   996         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   997
   998
   999*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1000
  1001     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1002     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1003
  1004     12  PI-CREDIT-USER                  PIC X.
  1005         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1006         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1007
  1008     12  PI-CLAIM-USER                   PIC X.
  1009         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1010         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1011
  1012     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1013         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1014         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1015         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1016         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1017         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1018
  1019     12  PI-PROCESSOR-ID                 PIC X(4).
  1020
  1021     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1022
  1023     12  PI-MEMBER-CAPTION               PIC X(10).
  1024
  1025     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1026         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1027
  1028     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1029     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1030     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1031     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1032
  1033     12  PI-AH-OVERRIDE-L1               PIC X.
  1034     12  PI-AH-OVERRIDE-L2               PIC XX.
  1035     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1036     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1037
  1038     12  PI-NEW-SYSTEM                   PIC X(2).
  1039
  1040     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1041     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1042         88  PI-USES-PAID-TO                 VALUE '1'.
  1043     12  PI-CRDTCRD-SYSTEM.
  1044         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  22
* EL131.cbl
  1045             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1046             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1047         16  PI-CC-MONTH-END-DT          PIC XX.
  1048     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1049
  1050     12  PI-OE-REFERENCE-2.
  1051         16  PI-OE-REF-2-PRIME           PIC X(10).
  1052         16  PI-OE-REF-2-SUFF            PIC X.
  1053
  1054     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1055
  1056     12  PI-LANGUAGE-TYPE                PIC X.
  1057             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1058             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1059             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1060
  1061     12  PI-POLICY-LINKAGE-IND           PIC X.
  1062         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1063         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1064                                                   LOW-VALUES.
  1065
  1066     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1067     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1068         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1069         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1070
  1071     12  PI-PROCESSOR-CSR-IND            PIC X.
  1072         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1073         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1074
  1075     12  FILLER                          PIC X(3).
  1076
  1077     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1078
  1079     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1080         PI-SYSTEM-LEVEL.
  1081
  1082         16  PI-ENTRY-CODES.
  1083             20  PI-ENTRY-CD-1           PIC X.
  1084             20  PI-ENTRY-CD-2           PIC X.
  1085
  1086         16  PI-RETURN-CODES.
  1087             20  PI-RETURN-CD-1          PIC X.
  1088             20  PI-RETURN-CD-2          PIC X.
  1089
  1090         16  PI-UPDATE-STATUS-SAVE.
  1091             20  PI-UPDATE-BY            PIC X(4).
  1092             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1093
  1094         16  PI-LOWER-CASE-LETTERS       PIC X.
  1095             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1096
  1097*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1098*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1099*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1100
  1101         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1102             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  23
* EL131.cbl
  1103             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1104             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1105             88  ACCNT-CNTL                  VALUE '3'.
  1106             88  CARR-ACCNT-CNTL             VALUE '4'.
  1107
  1108         16  PI-PROCESSOR-CAP-LIST.
  1109             20  PI-SYSTEM-CONTROLS.
  1110                24 PI-SYSTEM-DISPLAY     PIC X.
  1111                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1112                24 PI-SYSTEM-MODIFY      PIC X.
  1113                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1114             20  FILLER                  PIC XX.
  1115             20  PI-DISPLAY-CAP          PIC X.
  1116                 88  DISPLAY-CAP             VALUE 'Y'.
  1117             20  PI-MODIFY-CAP           PIC X.
  1118                 88  MODIFY-CAP              VALUE 'Y'.
  1119             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1120                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1121             20  PI-FORCE-CAP            PIC X.
  1122                 88  FORCE-CAP               VALUE 'Y'.
  1123
  1124         16  PI-PROGRAM-CONTROLS.
  1125             20  PI-PGM-PRINT-OPT        PIC X.
  1126             20  PI-PGM-FORMAT-OPT       PIC X.
  1127             20  PI-PGM-PROCESS-OPT      PIC X.
  1128             20  PI-PGM-TOTALS-OPT       PIC X.
  1129
  1130         16  PI-HELP-INTERFACE.
  1131             20  PI-LAST-ERROR-NO        PIC X(4).
  1132             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1133
  1134         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1135             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1136
  1137         16  PI-CR-CONTROL-IN-PROGRESS.
  1138             20  PI-CR-CARRIER           PIC X.
  1139             20  PI-CR-GROUPING          PIC X(6).
  1140             20  PI-CR-STATE             PIC XX.
  1141             20  PI-CR-ACCOUNT           PIC X(10).
  1142             20  PI-CR-FIN-RESP          PIC X(10).
  1143             20  PI-CR-TYPE              PIC X.
  1144
  1145         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1146
  1147         16  PI-CR-MONTH-END-DT          PIC XX.
  1148
  1149         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1150             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1151             88  PI-ZERO-CARRIER             VALUE '1'.
  1152             88  PI-ZERO-GROUPING            VALUE '2'.
  1153             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1154
  1155         16  PI-CARRIER-SECURITY         PIC X.
  1156             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1157
  1158         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1159             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1160             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  24
* EL131.cbl
  1161
  1162         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1163             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1164                                         INDEXED BY PI-ACCESS-NDX
  1165                                         PIC X.
  1166
  1167         16  PI-GA-BILLING-CONTROL       PIC X.
  1168             88  PI-GA-BILLING               VALUE '1'.
  1169
  1170         16  PI-MAIL-PROCESSING          PIC X.
  1171             88  PI-MAIL-YES                 VALUE 'Y'.
  1172
  1173         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1174
  1175         16  PI-AR-SYSTEM.
  1176             20  PI-AR-PROCESSING-CNTL   PIC X.
  1177                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1178             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1179             20  PI-AR-MONTH-END-DT      PIC XX.
  1180
  1181         16  PI-MP-SYSTEM.
  1182             20  PI-MORTGAGE-USER            PIC X.
  1183                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1184                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1185             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1186                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1187                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1188                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1189                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1190                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1191             20  PI-MP-MONTH-END-DT          PIC XX.
  1192             20  PI-MP-REFERENCE-NO.
  1193                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1194                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1195
  1196         16  PI-LABEL-CONTROL            PIC X(01).
  1197             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1198             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1199
  1200         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1201             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1202
  1203         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1204             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1205             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1206
  1207         16  FILLER                      PIC X(14).
  1208
  1209     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1210******************************************************************
  1211     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1212         16  PI-NO-PMTS                    PIC 9(4).
  1213         16  PI-CERT-SWITCH                PIC X.
  1214             88  CREATED-CERT              VALUE '2'.
  1215         16  PI-PREM-TYPE                  PIC X.
  1216         16  PI-SAVE-CERT-NO.
  1217             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1218             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  25
* EL131.cbl
  1219         16  FILLER                        PIC X(46).
  1220         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1221         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1222         16  PI-REC-FOUND-SW               PIC X.
  1223         16  PI-LETTER-SW                  PIC X.
  1224         16  PI-PREV-TRLR-KEY              PIC X(22).
  1225         16  pi-claim-type                 pic x.
  1226         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1227         16  pi-approval-level             pic x.
  1228         16  FILLER                        PIC X(543).
  1229
  1230 01  SAVE-RECORD                 PIC X(450).
  1231
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  26
* EL131.cbl
  1233*                                COPY ELCLOGOF SUPPRESS.
  1234******************************************************************
  1235*                                                                *
  1236*                                                                *
  1237*                            ELCLOGOF.                           *
  1238*                            VMOD=2.001                          *
  1239*                                                                *
  1240*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1241*                                                                *
  1242******************************************************************
  1243 01  CLASIC-LOGOFF.
  1244     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1245     12  LOGOFF-TEXT.
  1246         16  FILLER          PIC X(5)    VALUE SPACES.
  1247         16  LOGOFF-MSG.
  1248             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1249             20  FILLER      PIC X       VALUE SPACES.
  1250             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1251         16  FILLER          PIC X(80)
  1252           VALUE '* YOU ARE NOW LOGGED OFF'.
  1253         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1254         16  FILLER          PIC X       VALUE QUOTE.
  1255         16  LOGOFF-SYS-MSG  PIC X(17)
  1256           VALUE 'S CLAS-IC SYSTEM '.
  1257     12  TEXT-MESSAGES.
  1258         16  UNACCESS-MSG    PIC X(29)
  1259             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1260         16  PGMIDERR-MSG    PIC X(17)
  1261             VALUE 'PROGRAM NOT FOUND'.
  1262
  1263*                                COPY ELCATTR SUPPRESS.
  1264******************************************************************
  1265*                                                                *
  1266*                            ELCATTR.                            *
  1267*                            VMOD=2.001                          *
  1268*                                                                *
  1269*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1270*                                                                *
  1271*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1272*                                                                *
  1273*                   POS 1   P=PROTECTED                          *
  1274*                           U=UNPROTECTED                        *
  1275*                           S=ASKIP                              *
  1276*                   POS 2   A=ALPHA/NUMERIC                      *
  1277*                           N=NUMERIC                            *
  1278*                   POS 3   N=NORMAL                             *
  1279*                           B=BRIGHT                             *
  1280*                           D=DARK                               *
  1281*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1282*                           OF=MODIFIED DATA TAG OFF             *
  1283*                                                                *
  1284*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1285******************************************************************
  1286 01  ATTRIBUTE-LIST.
  1287     12  AL-PABOF            PIC X       VALUE 'Y'.
  1288     12  AL-PABON            PIC X       VALUE 'Z'.
  1289     12  AL-PADOF            PIC X       VALUE '%'.
  1290     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  27
* EL131.cbl
  1291     12  AL-PANOF            PIC X       VALUE '-'.
  1292     12  AL-PANON            PIC X       VALUE '/'.
  1293     12  AL-SABOF            PIC X       VALUE '8'.
  1294     12  AL-SABON            PIC X       VALUE '9'.
  1295     12  AL-SADOF            PIC X       VALUE '@'.
  1296     12  AL-SADON            PIC X       VALUE QUOTE.
  1297     12  AL-SANOF            PIC X       VALUE '0'.
  1298     12  AL-SANON            PIC X       VALUE '1'.
  1299     12  AL-UABOF            PIC X       VALUE 'H'.
  1300     12  AL-UABON            PIC X       VALUE 'I'.
  1301     12  AL-UADOF            PIC X       VALUE '<'.
  1302     12  AL-UADON            PIC X       VALUE '('.
  1303     12  AL-UANOF            PIC X       VALUE ' '.
  1304     12  AL-UANON            PIC X       VALUE 'A'.
  1305     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1306     12  AL-UNBON            PIC X       VALUE 'R'.
  1307     12  AL-UNDOF            PIC X       VALUE '*'.
  1308     12  AL-UNDON            PIC X       VALUE ')'.
  1309     12  AL-UNNOF            PIC X       VALUE '&'.
  1310     12  AL-UNNON            PIC X       VALUE 'J'.
  1311
  1312*                                COPY ELCAID SUPPRESS.
  1313******************************************************************
  1314*                                                                *
  1315*                            ELCAID.                             *
  1316*                            VMOD=2.001                          *
  1317*                                                                *
  1318*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1319*                                                                *
  1320*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1321*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1322******************************************************************
  1323
  1324 01  DFHAID.
  1325   02  DFHNULL   PIC  X  VALUE  ' '.
  1326   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1327   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1328   02  DFHPEN    PIC  X  VALUE  '='.
  1329   02  DFHOPID   PIC  X  VALUE  'W'.
  1330   02  DFHPA1    PIC  X  VALUE  '%'.
  1331   02  DFHPA2    PIC  X  VALUE  '>'.
  1332   02  DFHPA3    PIC  X  VALUE  ','.
  1333   02  DFHPF1    PIC  X  VALUE  '1'.
  1334   02  DFHPF2    PIC  X  VALUE  '2'.
  1335   02  DFHPF3    PIC  X  VALUE  '3'.
  1336   02  DFHPF4    PIC  X  VALUE  '4'.
  1337   02  DFHPF5    PIC  X  VALUE  '5'.
  1338   02  DFHPF6    PIC  X  VALUE  '6'.
  1339   02  DFHPF7    PIC  X  VALUE  '7'.
  1340   02  DFHPF8    PIC  X  VALUE  '8'.
  1341   02  DFHPF9    PIC  X  VALUE  '9'.
  1342   02  DFHPF10   PIC  X  VALUE  ':'.
  1343   02  DFHPF11   PIC  X  VALUE  '#'.
  1344   02  DFHPF12   PIC  X  VALUE  '@'.
  1345   02  DFHPF13   PIC  X  VALUE  'A'.
  1346   02  DFHPF14   PIC  X  VALUE  'B'.
  1347   02  DFHPF15   PIC  X  VALUE  'C'.
  1348   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  28
* EL131.cbl
  1349   02  DFHPF17   PIC  X  VALUE  'E'.
  1350   02  DFHPF18   PIC  X  VALUE  'F'.
  1351   02  DFHPF19   PIC  X  VALUE  'G'.
  1352   02  DFHPF20   PIC  X  VALUE  'H'.
  1353   02  DFHPF21   PIC  X  VALUE  'I'.
  1354*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1355   02  DFHPF22   PIC  X  VALUE  '['.
  1356   02  DFHPF23   PIC  X  VALUE  '.'.
  1357   02  DFHPF24   PIC  X  VALUE  '<'.
  1358   02  DFHMSRE   PIC  X  VALUE  'X'.
  1359   02  DFHSTRF   PIC  X  VALUE  'h'.
  1360   02  DFHTRIG   PIC  X  VALUE  '"'.
  1361 01  FILLER REDEFINES DFHAID.
  1362     12  FILLER                  PIC X(8).
  1363     12  AID-KEYS OCCURS 24 TIMES.
  1364         16  FILLER              PIC X.
  1365
  1366*                                COPY EL131S.
  1367 01  EL131AI.
  1368     05  FILLER            PIC  X(0012).
  1369*    -------------------------------
  1370     05  DATEL PIC S9(0004) COMP.
  1371     05  DATEF PIC  X(0001).
  1372     05  FILLER REDEFINES DATEF.
  1373         10  DATEA PIC  X(0001).
  1374     05  DATEI PIC  X(0008).
  1375*    -------------------------------
  1376     05  TIMEL PIC S9(0004) COMP.
  1377     05  TIMEF PIC  X(0001).
  1378     05  FILLER REDEFINES TIMEF.
  1379         10  TIMEA PIC  X(0001).
  1380     05  TIMEI PIC  X(0005).
  1381*    -------------------------------
  1382     05  SEQUL PIC S9(0004) COMP.
  1383     05  SEQUF PIC  X(0001).
  1384     05  FILLER REDEFINES SEQUF.
  1385         10  SEQUA PIC  X(0001).
  1386     05  SEQUI PIC  X(0010).
  1387*    -------------------------------
  1388     05  COMPL PIC S9(0004) COMP.
  1389     05  COMPF PIC  X(0001).
  1390     05  FILLER REDEFINES COMPF.
  1391         10  COMPA PIC  X(0001).
  1392     05  COMPI PIC  X(0003).
  1393*    -------------------------------
  1394     05  USERIDL PIC S9(0004) COMP.
  1395     05  USERIDF PIC  X(0001).
  1396     05  FILLER REDEFINES USERIDF.
  1397         10  USERIDA PIC  X(0001).
  1398     05  USERIDI PIC  X(0004).
  1399*    -------------------------------
  1400     05  LABEL1L PIC S9(0004) COMP.
  1401     05  LABEL1F PIC  X(0001).
  1402     05  FILLER REDEFINES LABEL1F.
  1403         10  LABEL1A PIC  X(0001).
  1404     05  LABEL1I PIC  X(0011).
  1405*    -------------------------------
  1406     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  29
* EL131.cbl
  1407     05  PCERTNOF PIC  X(0001).
  1408     05  FILLER REDEFINES PCERTNOF.
  1409         10  PCERTNOA PIC  X(0001).
  1410     05  PCERTNOI PIC  X(0010).
  1411*    -------------------------------
  1412     05  PSUFXL PIC S9(0004) COMP.
  1413     05  PSUFXF PIC  X(0001).
  1414     05  FILLER REDEFINES PSUFXF.
  1415         10  PSUFXA PIC  X(0001).
  1416     05  PSUFXI PIC  X(0001).
  1417*    -------------------------------
  1418     05  CCNOL PIC S9(0004) COMP.
  1419     05  CCNOF PIC  X(0001).
  1420     05  FILLER REDEFINES CCNOF.
  1421         10  CCNOA PIC  X(0001).
  1422     05  CCNOI PIC  X(0016).
  1423*    -------------------------------
  1424     05  MAINTL PIC S9(0004) COMP.
  1425     05  MAINTF PIC  X(0001).
  1426     05  FILLER REDEFINES MAINTF.
  1427         10  MAINTA PIC  X(0001).
  1428     05  MAINTI PIC  X(0001).
  1429*    -------------------------------
  1430     05  CLAIML PIC S9(0004) COMP.
  1431     05  CLAIMF PIC  X(0001).
  1432     05  FILLER REDEFINES CLAIMF.
  1433         10  CLAIMA PIC  X(0001).
  1434     05  CLAIMI PIC  X(0007).
  1435*    -------------------------------
  1436     05  CARRL PIC S9(0004) COMP.
  1437     05  CARRF PIC  X(0001).
  1438     05  FILLER REDEFINES CARRF.
  1439         10  CARRA PIC  X(0001).
  1440     05  CARRI PIC  X(0001).
  1441*    -------------------------------
  1442     05  CERTL PIC S9(0004) COMP.
  1443     05  CERTF PIC  X(0001).
  1444     05  FILLER REDEFINES CERTF.
  1445         10  CERTA PIC  X(0001).
  1446     05  CERTI PIC  X(0010).
  1447*    -------------------------------
  1448     05  SUFXL PIC S9(0004) COMP.
  1449     05  SUFXF PIC  X(0001).
  1450     05  FILLER REDEFINES SUFXF.
  1451         10  SUFXA PIC  X(0001).
  1452     05  SUFXI PIC  X(0001).
  1453*    -------------------------------
  1454     05  TYPEL PIC S9(0004) COMP.
  1455     05  TYPEF PIC  X(0001).
  1456     05  FILLER REDEFINES TYPEF.
  1457         10  TYPEA PIC  X(0001).
  1458     05  TYPEI PIC  X(0001).
  1459*    -------------------------------
  1460     05  BENPERL PIC S9(0004) COMP.
  1461     05  BENPERF PIC  X(0001).
  1462     05  FILLER REDEFINES BENPERF.
  1463         10  BENPERA PIC  X(0001).
  1464     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  30
* EL131.cbl
  1465*    -------------------------------
  1466     05  INSTYPEL PIC S9(0004) COMP.
  1467     05  INSTYPEF PIC  X(0001).
  1468     05  FILLER REDEFINES INSTYPEF.
  1469         10  INSTYPEA PIC  X(0001).
  1470     05  INSTYPEI PIC  X(0001).
  1471*    -------------------------------
  1472     05  STATUSL PIC S9(0004) COMP.
  1473     05  STATUSF PIC  X(0001).
  1474     05  FILLER REDEFINES STATUSF.
  1475         10  STATUSA PIC  X(0001).
  1476     05  STATUSI PIC  X(0006).
  1477*    -------------------------------
  1478     05  INCL PIC S9(0004) COMP.
  1479     05  INCF PIC  X(0001).
  1480     05  FILLER REDEFINES INCF.
  1481         10  INCA PIC  X(0001).
  1482     05  INCI PIC  X(0008).
  1483*    -------------------------------
  1484     05  REPL PIC S9(0004) COMP.
  1485     05  REPF PIC  X(0001).
  1486     05  FILLER REDEFINES REPF.
  1487         10  REPA PIC  X(0001).
  1488     05  REPI PIC  X(0008).
  1489*    -------------------------------
  1490     05  ICD1L PIC S9(0004) COMP.
  1491     05  ICD1F PIC  X(0001).
  1492     05  FILLER REDEFINES ICD1F.
  1493         10  ICD1A PIC  X(0001).
  1494     05  ICD1I PIC  X(0008).
  1495*    -------------------------------
  1496     05  ICD2L PIC S9(0004) COMP.
  1497     05  ICD2F PIC  X(0001).
  1498     05  FILLER REDEFINES ICD2F.
  1499         10  ICD2A PIC  X(0001).
  1500     05  ICD2I PIC  X(0008).
  1501*    -------------------------------
  1502     05  DIAGL PIC S9(0004) COMP.
  1503     05  DIAGF PIC  X(0001).
  1504     05  FILLER REDEFINES DIAGF.
  1505         10  DIAGA PIC  X(0001).
  1506     05  DIAGI PIC  X(0060).
  1507*    -------------------------------
  1508     05  ACCSWL PIC S9(0004) COMP.
  1509     05  ACCSWF PIC  X(0001).
  1510     05  FILLER REDEFINES ACCSWF.
  1511         10  ACCSWA PIC  X(0001).
  1512     05  ACCSWI PIC  X(0001).
  1513*    -------------------------------
  1514     05  BENEL PIC S9(0004) COMP.
  1515     05  BENEF PIC  X(0001).
  1516     05  FILLER REDEFINES BENEF.
  1517         10  BENEA PIC  X(0001).
  1518     05  BENEI PIC  X(0010).
  1519*    -------------------------------
  1520     05  BIRTHL PIC S9(0004) COMP.
  1521     05  BIRTHF PIC  X(0001).
  1522     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  31
* EL131.cbl
  1523         10  BIRTHA PIC  X(0001).
  1524     05  BIRTHI PIC  X(0008).
  1525*    -------------------------------
  1526     05  SOCIALL PIC S9(0004) COMP.
  1527     05  SOCIALF PIC  X(0001).
  1528     05  FILLER REDEFINES SOCIALF.
  1529         10  SOCIALA PIC  X(0001).
  1530     05  SOCIALI PIC  X(0011).
  1531*    -------------------------------
  1532     05  SEXL PIC S9(0004) COMP.
  1533     05  SEXF PIC  X(0001).
  1534     05  FILLER REDEFINES SEXF.
  1535         10  SEXA PIC  X(0001).
  1536     05  SEXI PIC  X(0001).
  1537*    -------------------------------
  1538     05  MLNAMEL PIC S9(0004) COMP.
  1539     05  MLNAMEF PIC  X(0001).
  1540     05  FILLER REDEFINES MLNAMEF.
  1541         10  MLNAMEA PIC  X(0001).
  1542     05  MLNAMEI PIC  X(0015).
  1543*    -------------------------------
  1544     05  MFNAMEL PIC S9(0004) COMP.
  1545     05  MFNAMEF PIC  X(0001).
  1546     05  FILLER REDEFINES MFNAMEF.
  1547         10  MFNAMEA PIC  X(0001).
  1548     05  MFNAMEI PIC  X(0012).
  1549*    -------------------------------
  1550     05  MMINITL PIC S9(0004) COMP.
  1551     05  MMINITF PIC  X(0001).
  1552     05  FILLER REDEFINES MMINITF.
  1553         10  MMINITA PIC  X(0001).
  1554     05  MMINITI PIC  X(0001).
  1555*    -------------------------------
  1556     05  LOANNOL PIC S9(0004) COMP.
  1557     05  LOANNOF PIC  X(0001).
  1558     05  FILLER REDEFINES LOANNOF.
  1559         10  LOANNOA PIC  X(0001).
  1560     05  LOANNOI PIC  X(0008).
  1561*    -------------------------------
  1562     05  CRTLNMEL PIC S9(0004) COMP.
  1563     05  CRTLNMEF PIC  X(0001).
  1564     05  FILLER REDEFINES CRTLNMEF.
  1565         10  CRTLNMEA PIC  X(0001).
  1566     05  CRTLNMEI PIC  X(0015).
  1567*    -------------------------------
  1568     05  CRTFNMEL PIC S9(0004) COMP.
  1569     05  CRTFNMEF PIC  X(0001).
  1570     05  FILLER REDEFINES CRTFNMEF.
  1571         10  CRTFNMEA PIC  X(0001).
  1572     05  CRTFNMEI PIC  X(0012).
  1573*    -------------------------------
  1574     05  CRTINITL PIC S9(0004) COMP.
  1575     05  CRTINITF PIC  X(0001).
  1576     05  FILLER REDEFINES CRTINITF.
  1577         10  CRTINITA PIC  X(0001).
  1578     05  CRTINITI PIC  X(0001).
  1579*    -------------------------------
  1580     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  32
* EL131.cbl
  1581     05  LOANBALF PIC  X(0001).
  1582     05  FILLER REDEFINES LOANBALF.
  1583         10  LOANBALA PIC  X(0001).
  1584     05  LOANBALI PIC  9(7)V99.
  1585*    -------------------------------
  1586     05  PROCL PIC S9(0004) COMP.
  1587     05  PROCF PIC  X(0001).
  1588     05  FILLER REDEFINES PROCF.
  1589         10  PROCA PIC  X(0001).
  1590     05  PROCI PIC  X(0004).
  1591*    -------------------------------
  1592     05  SUPVL PIC S9(0004) COMP.
  1593     05  SUPVF PIC  X(0001).
  1594     05  FILLER REDEFINES SUPVF.
  1595         10  SUPVA PIC  X(0001).
  1596     05  SUPVI PIC  X(0001).
  1597*    -------------------------------
  1598     05  PRICDL PIC S9(0004) COMP.
  1599     05  PRICDF PIC  X(0001).
  1600     05  FILLER REDEFINES PRICDF.
  1601         10  PRICDA PIC  X(0001).
  1602     05  PRICDI PIC  X(0001).
  1603*    -------------------------------
  1604     05  CRITPL PIC S9(0004) COMP.
  1605     05  CRITPF PIC  X(0001).
  1606     05  FILLER REDEFINES CRITPF.
  1607         10  CRITPA PIC  X(0001).
  1608     05  CRITPI PIC  X(0002).
  1609*    -------------------------------
  1610     05  CRITPTL PIC S9(0004) COMP.
  1611     05  CRITPTF PIC  X(0001).
  1612     05  FILLER REDEFINES CRITPTF.
  1613         10  CRITPTA PIC  X(0001).
  1614     05  CRITPTI PIC  X(0002).
  1615*    -------------------------------
  1616     05  RTWMOSL PIC S9(0004) COMP.
  1617     05  RTWMOSF PIC  X(0001).
  1618     05  FILLER REDEFINES RTWMOSF.
  1619         10  RTWMOSA PIC  X(0001).
  1620     05  RTWMOSI PIC  X(0002).
  1621*    -------------------------------
  1622     05  FILETOL PIC S9(0004) COMP.
  1623     05  FILETOF PIC  X(0001).
  1624     05  FILLER REDEFINES FILETOF.
  1625         10  FILETOA PIC  X(0001).
  1626     05  FILETOI PIC  X(0004).
  1627*    -------------------------------
  1628     05  PTHRHDGL PIC S9(0004) COMP.
  1629     05  PTHRHDGF PIC  X(0001).
  1630     05  FILLER REDEFINES PTHRHDGF.
  1631         10  PTHRHDGA PIC  X(0001).
  1632     05  PTHRHDGI PIC  X(0010).
  1633*    -------------------------------
  1634     05  PDTHRUL PIC S9(0004) COMP.
  1635     05  PDTHRUF PIC  X(0001).
  1636     05  FILLER REDEFINES PDTHRUF.
  1637         10  PDTHRUA PIC  X(0001).
  1638     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  33
* EL131.cbl
  1639*    -------------------------------
  1640     05  PDAMTL PIC S9(0004) COMP.
  1641     05  PDAMTF PIC  X(0001).
  1642     05  FILLER REDEFINES PDAMTF.
  1643         10  PDAMTA PIC  X(0001).
  1644     05  PDAMTI PIC  9(7)V99.
  1645*    -------------------------------
  1646     05  NODAYSL PIC S9(0004) COMP.
  1647     05  NODAYSF PIC  X(0001).
  1648     05  FILLER REDEFINES NODAYSF.
  1649         10  NODAYSA PIC  X(0001).
  1650     05  NODAYSI PIC  9(5).
  1651*    -------------------------------
  1652     05  NOPMTSL PIC S9(0004) COMP.
  1653     05  NOPMTSF PIC  X(0001).
  1654     05  FILLER REDEFINES NOPMTSF.
  1655         10  NOPMTSA PIC  X(0001).
  1656     05  NOPMTSI PIC  9(4).
  1657*    -------------------------------
  1658     05  FORMTYPL PIC S9(0004) COMP.
  1659     05  FORMTYPF PIC  X(0001).
  1660     05  FILLER REDEFINES FORMTYPF.
  1661         10  FORMTYPA PIC  X(0001).
  1662     05  FORMTYPI PIC  X(0001).
  1663*    -------------------------------
  1664     05  ESTL PIC S9(0004) COMP.
  1665     05  ESTF PIC  X(0001).
  1666     05  FILLER REDEFINES ESTF.
  1667         10  ESTA PIC  X(0001).
  1668     05  ESTI PIC  X(0008).
  1669*    -------------------------------
  1670     05  AUIDL PIC S9(0004) COMP.
  1671     05  AUIDF PIC  X(0001).
  1672     05  FILLER REDEFINES AUIDF.
  1673         10  AUIDA PIC  X(0001).
  1674     05  AUIDI PIC  X(0004).
  1675*    -------------------------------
  1676     05  OCCL PIC S9(0004) COMP.
  1677     05  OCCF PIC  X(0001).
  1678     05  FILLER REDEFINES OCCF.
  1679         10  OCCA PIC  X(0001).
  1680     05  OCCI PIC  X(0006).
  1681*    -------------------------------
  1682     05  MNTDTL PIC S9(0004) COMP.
  1683     05  MNTDTF PIC  X(0001).
  1684     05  FILLER REDEFINES MNTDTF.
  1685         10  MNTDTA PIC  X(0001).
  1686     05  MNTDTI PIC  X(0008).
  1687*    -------------------------------
  1688     05  MNTTYPEL PIC S9(0004) COMP.
  1689     05  MNTTYPEF PIC  X(0001).
  1690     05  FILLER REDEFINES MNTTYPEF.
  1691         10  MNTTYPEA PIC  X(0001).
  1692     05  MNTTYPEI PIC  X(0006).
  1693*    -------------------------------
  1694     05  CERTCARL PIC S9(0004) COMP.
  1695     05  CERTCARF PIC  X(0001).
  1696     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  34
* EL131.cbl
  1697         10  CERTCARA PIC  X(0001).
  1698     05  CERTCARI PIC  X(0001).
  1699*    -------------------------------
  1700     05  CERTGRPL PIC S9(0004) COMP.
  1701     05  CERTGRPF PIC  X(0001).
  1702     05  FILLER REDEFINES CERTGRPF.
  1703         10  CERTGRPA PIC  X(0001).
  1704     05  CERTGRPI PIC  X(0006).
  1705*    -------------------------------
  1706     05  CERTSTL PIC S9(0004) COMP.
  1707     05  CERTSTF PIC  X(0001).
  1708     05  FILLER REDEFINES CERTSTF.
  1709         10  CERTSTA PIC  X(0001).
  1710     05  CERTSTI PIC  X(0002).
  1711*    -------------------------------
  1712     05  CERTACTL PIC S9(0004) COMP.
  1713     05  CERTACTF PIC  X(0001).
  1714     05  FILLER REDEFINES CERTACTF.
  1715         10  CERTACTA PIC  X(0001).
  1716     05  CERTACTI PIC  X(0010).
  1717*    -------------------------------
  1718     05  CERTEFFL PIC S9(0004) COMP.
  1719     05  CERTEFFF PIC  X(0001).
  1720     05  FILLER REDEFINES CERTEFFF.
  1721         10  CERTEFFA PIC  X(0001).
  1722     05  CERTEFFI PIC  X(0008).
  1723*    -------------------------------
  1724     05  ISSAGEL PIC S9(0004) COMP.
  1725     05  ISSAGEF PIC  X(0001).
  1726     05  FILLER REDEFINES ISSAGEF.
  1727         10  ISSAGEA PIC  X(0001).
  1728     05  ISSAGEI PIC  X(0002).
  1729*    -------------------------------
  1730     05  APRL PIC S9(0004) COMP.
  1731     05  APRF PIC  X(0001).
  1732     05  FILLER REDEFINES APRF.
  1733         10  APRA PIC  X(0001).
  1734     05  APRI PIC  9(4)V9(4).
  1735*    -------------------------------
  1736     05  PMTFREQL PIC S9(0004) COMP.
  1737     05  PMTFREQF PIC  X(0001).
  1738     05  FILLER REDEFINES PMTFREQF.
  1739         10  PMTFREQA PIC  X(0001).
  1740     05  PMTFREQI PIC  99.
  1741*    -------------------------------
  1742     05  INDGRPL PIC S9(0004) COMP.
  1743     05  INDGRPF PIC  X(0001).
  1744     05  FILLER REDEFINES INDGRPF.
  1745         10  INDGRPA PIC  X(0001).
  1746     05  INDGRPI PIC  X(0001).
  1747*    -------------------------------
  1748     05  PREMTYPL PIC S9(0004) COMP.
  1749     05  PREMTYPF PIC  X(0001).
  1750     05  FILLER REDEFINES PREMTYPF.
  1751         10  PREMTYPA PIC  X(0001).
  1752     05  PREMTYPI PIC  X(0001).
  1753*    -------------------------------
  1754     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  35
* EL131.cbl
  1755     05  REINCDF PIC  X(0001).
  1756     05  FILLER REDEFINES REINCDF.
  1757         10  REINCDA PIC  X(0001).
  1758     05  REINCDI PIC  X(0001).
  1759*    -------------------------------
  1760     05  JNTLNMEL PIC S9(0004) COMP.
  1761     05  JNTLNMEF PIC  X(0001).
  1762     05  FILLER REDEFINES JNTLNMEF.
  1763         10  JNTLNMEA PIC  X(0001).
  1764     05  JNTLNMEI PIC  X(0015).
  1765*    -------------------------------
  1766     05  JNTFNMEL PIC S9(0004) COMP.
  1767     05  JNTFNMEF PIC  X(0001).
  1768     05  FILLER REDEFINES JNTFNMEF.
  1769         10  JNTFNMEA PIC  X(0001).
  1770     05  JNTFNMEI PIC  X(0012).
  1771*    -------------------------------
  1772     05  JNTINITL PIC S9(0004) COMP.
  1773     05  JNTINITF PIC  X(0001).
  1774     05  FILLER REDEFINES JNTINITF.
  1775         10  JNTINITA PIC  X(0001).
  1776     05  JNTINITI PIC  X(0001).
  1777*    -------------------------------
  1778     05  JNTAGEL PIC S9(0004) COMP.
  1779     05  JNTAGEF PIC  X(0001).
  1780     05  FILLER REDEFINES JNTAGEF.
  1781         10  JNTAGEA PIC  X(0001).
  1782     05  JNTAGEI PIC  X(0002).
  1783*    -------------------------------
  1784     05  ADDONDTL PIC S9(0004) COMP.
  1785     05  ADDONDTF PIC  X(0001).
  1786     05  FILLER REDEFINES ADDONDTF.
  1787         10  ADDONDTA PIC  X(0001).
  1788     05  ADDONDTI PIC  X(0008).
  1789*    -------------------------------
  1790     05  LCVDSCRL PIC S9(0004) COMP.
  1791     05  LCVDSCRF PIC  X(0001).
  1792     05  FILLER REDEFINES LCVDSCRF.
  1793         10  LCVDSCRA PIC  X(0001).
  1794     05  LCVDSCRI PIC  X(0006).
  1795*    -------------------------------
  1796     05  LCVKINDL PIC S9(0004) COMP.
  1797     05  LCVKINDF PIC  X(0001).
  1798     05  FILLER REDEFINES LCVKINDF.
  1799         10  LCVKINDA PIC  X(0001).
  1800     05  LCVKINDI PIC  X(0003).
  1801*    -------------------------------
  1802     05  LCVCDL PIC S9(0004) COMP.
  1803     05  LCVCDF PIC  X(0001).
  1804     05  FILLER REDEFINES LCVCDF.
  1805         10  LCVCDA PIC  X(0001).
  1806     05  LCVCDI PIC  X(0002).
  1807*    -------------------------------
  1808     05  LCVOTRML PIC S9(0004) COMP.
  1809     05  LCVOTRMF PIC  X(0001).
  1810     05  FILLER REDEFINES LCVOTRMF.
  1811         10  LCVOTRMA PIC  X(0001).
  1812     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  36
* EL131.cbl
  1813*    -------------------------------
  1814     05  LCVRTRML PIC S9(0004) COMP.
  1815     05  LCVRTRMF PIC  X(0001).
  1816     05  FILLER REDEFINES LCVRTRMF.
  1817         10  LCVRTRMA PIC  X(0001).
  1818     05  LCVRTRMI PIC  X(0003).
  1819*    -------------------------------
  1820     05  LCVRATEL PIC S9(0004) COMP.
  1821     05  LCVRATEF PIC  X(0001).
  1822     05  FILLER REDEFINES LCVRATEF.
  1823         10  LCVRATEA PIC  X(0001).
  1824     05  LCVRATEI PIC  9999V99.
  1825*    -------------------------------
  1826     05  LCVBENEL PIC S9(0004) COMP.
  1827     05  LCVBENEF PIC  X(0001).
  1828     05  FILLER REDEFINES LCVBENEF.
  1829         10  LCVBENEA PIC  X(0001).
  1830     05  LCVBENEI PIC  9(9)V99.
  1831*    -------------------------------
  1832     05  LCVFORML PIC S9(0004) COMP.
  1833     05  LCVFORMF PIC  X(0001).
  1834     05  FILLER REDEFINES LCVFORMF.
  1835         10  LCVFORMA PIC  X(0001).
  1836     05  LCVFORMI PIC  X(0012).
  1837*    -------------------------------
  1838     05  LCVCNDTL PIC S9(0004) COMP.
  1839     05  LCVCNDTF PIC  X(0001).
  1840     05  FILLER REDEFINES LCVCNDTF.
  1841         10  LCVCNDTA PIC  X(0001).
  1842     05  LCVCNDTI PIC  X(0008).
  1843*    -------------------------------
  1844     05  LCVEXITL PIC S9(0004) COMP.
  1845     05  LCVEXITF PIC  X(0001).
  1846     05  FILLER REDEFINES LCVEXITF.
  1847         10  LCVEXITA PIC  X(0001).
  1848     05  LCVEXITI PIC  X(0008).
  1849*    -------------------------------
  1850     05  LCVSTATL PIC S9(0004) COMP.
  1851     05  LCVSTATF PIC  X(0001).
  1852     05  FILLER REDEFINES LCVSTATF.
  1853         10  LCVSTATA PIC  X(0001).
  1854     05  LCVSTATI PIC  X(0006).
  1855*    -------------------------------
  1856     05  ACVDSCRL PIC S9(0004) COMP.
  1857     05  ACVDSCRF PIC  X(0001).
  1858     05  FILLER REDEFINES ACVDSCRF.
  1859         10  ACVDSCRA PIC  X(0001).
  1860     05  ACVDSCRI PIC  X(0006).
  1861*    -------------------------------
  1862     05  ACVKINDL PIC S9(0004) COMP.
  1863     05  ACVKINDF PIC  X(0001).
  1864     05  FILLER REDEFINES ACVKINDF.
  1865         10  ACVKINDA PIC  X(0001).
  1866     05  ACVKINDI PIC  X(0003).
  1867*    -------------------------------
  1868     05  ACVCDL PIC S9(0004) COMP.
  1869     05  ACVCDF PIC  X(0001).
  1870     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  37
* EL131.cbl
  1871         10  ACVCDA PIC  X(0001).
  1872     05  ACVCDI PIC  X(0002).
  1873*    -------------------------------
  1874     05  ACVOTRML PIC S9(0004) COMP.
  1875     05  ACVOTRMF PIC  X(0001).
  1876     05  FILLER REDEFINES ACVOTRMF.
  1877         10  ACVOTRMA PIC  X(0001).
  1878     05  ACVOTRMI PIC  999.
  1879*    -------------------------------
  1880     05  ACVRTRML PIC S9(0004) COMP.
  1881     05  ACVRTRMF PIC  X(0001).
  1882     05  FILLER REDEFINES ACVRTRMF.
  1883         10  ACVRTRMA PIC  X(0001).
  1884     05  ACVRTRMI PIC  X(0003).
  1885*    -------------------------------
  1886     05  ACVRATEL PIC S9(0004) COMP.
  1887     05  ACVRATEF PIC  X(0001).
  1888     05  FILLER REDEFINES ACVRATEF.
  1889         10  ACVRATEA PIC  X(0001).
  1890     05  ACVRATEI PIC  9999V99.
  1891*    -------------------------------
  1892     05  ACVBENEL PIC S9(0004) COMP.
  1893     05  ACVBENEF PIC  X(0001).
  1894     05  FILLER REDEFINES ACVBENEF.
  1895         10  ACVBENEA PIC  X(0001).
  1896     05  ACVBENEI PIC  9(9)V99.
  1897*    -------------------------------
  1898     05  ACVFORML PIC S9(0004) COMP.
  1899     05  ACVFORMF PIC  X(0001).
  1900     05  FILLER REDEFINES ACVFORMF.
  1901         10  ACVFORMA PIC  X(0001).
  1902     05  ACVFORMI PIC  X(0012).
  1903*    -------------------------------
  1904     05  ACVCNDTL PIC S9(0004) COMP.
  1905     05  ACVCNDTF PIC  X(0001).
  1906     05  FILLER REDEFINES ACVCNDTF.
  1907         10  ACVCNDTA PIC  X(0001).
  1908     05  ACVCNDTI PIC  X(0008).
  1909*    -------------------------------
  1910     05  ACVEXITL PIC S9(0004) COMP.
  1911     05  ACVEXITF PIC  X(0001).
  1912     05  FILLER REDEFINES ACVEXITF.
  1913         10  ACVEXITA PIC  X(0001).
  1914     05  ACVEXITI PIC  X(0008).
  1915*    -------------------------------
  1916     05  ACVSTATL PIC S9(0004) COMP.
  1917     05  ACVSTATF PIC  X(0001).
  1918     05  FILLER REDEFINES ACVSTATF.
  1919         10  ACVSTATA PIC  X(0001).
  1920     05  ACVSTATI PIC  X(0006).
  1921*    -------------------------------
  1922     05  LABEL2L PIC S9(0004) COMP.
  1923     05  LABEL2F PIC  X(0001).
  1924     05  FILLER REDEFINES LABEL2F.
  1925         10  LABEL2A PIC  X(0001).
  1926     05  LABEL2I PIC  X(0014).
  1927*    -------------------------------
  1928     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  38
* EL131.cbl
  1929     05  BCERT1F PIC  X(0001).
  1930     05  FILLER REDEFINES BCERT1F.
  1931         10  BCERT1A PIC  X(0001).
  1932     05  BCERT1I PIC  X(0010).
  1933*    -------------------------------
  1934     05  BSUFX1L PIC S9(0004) COMP.
  1935     05  BSUFX1F PIC  X(0001).
  1936     05  FILLER REDEFINES BSUFX1F.
  1937         10  BSUFX1A PIC  X(0001).
  1938     05  BSUFX1I PIC  X(0001).
  1939*    -------------------------------
  1940     05  BCERT2L PIC S9(0004) COMP.
  1941     05  BCERT2F PIC  X(0001).
  1942     05  FILLER REDEFINES BCERT2F.
  1943         10  BCERT2A PIC  X(0001).
  1944     05  BCERT2I PIC  X(0010).
  1945*    -------------------------------
  1946     05  BSUFX2L PIC S9(0004) COMP.
  1947     05  BSUFX2F PIC  X(0001).
  1948     05  FILLER REDEFINES BSUFX2F.
  1949         10  BSUFX2A PIC  X(0001).
  1950     05  BSUFX2I PIC  X(0001).
  1951*    -------------------------------
  1952     05  BCERT3L PIC S9(0004) COMP.
  1953     05  BCERT3F PIC  X(0001).
  1954     05  FILLER REDEFINES BCERT3F.
  1955         10  BCERT3A PIC  X(0001).
  1956     05  BCERT3I PIC  X(0010).
  1957*    -------------------------------
  1958     05  BSUFX3L PIC S9(0004) COMP.
  1959     05  BSUFX3F PIC  X(0001).
  1960     05  FILLER REDEFINES BSUFX3F.
  1961         10  BSUFX3A PIC  X(0001).
  1962     05  BSUFX3I PIC  X(0001).
  1963*    -------------------------------
  1964     05  BCERT4L PIC S9(0004) COMP.
  1965     05  BCERT4F PIC  X(0001).
  1966     05  FILLER REDEFINES BCERT4F.
  1967         10  BCERT4A PIC  X(0001).
  1968     05  BCERT4I PIC  X(0010).
  1969*    -------------------------------
  1970     05  BSUFX4L PIC S9(0004) COMP.
  1971     05  BSUFX4F PIC  X(0001).
  1972     05  FILLER REDEFINES BSUFX4F.
  1973         10  BSUFX4A PIC  X(0001).
  1974     05  BSUFX4I PIC  X(0001).
  1975*    -------------------------------
  1976     05  BCERT5L PIC S9(0004) COMP.
  1977     05  BCERT5F PIC  X(0001).
  1978     05  FILLER REDEFINES BCERT5F.
  1979         10  BCERT5A PIC  X(0001).
  1980     05  BCERT5I PIC  X(0010).
  1981*    -------------------------------
  1982     05  BSUFX5L PIC S9(0004) COMP.
  1983     05  BSUFX5F PIC  X(0001).
  1984     05  FILLER REDEFINES BSUFX5F.
  1985         10  BSUFX5A PIC  X(0001).
  1986     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  39
* EL131.cbl
  1987*    -------------------------------
  1988     05  MSG1L PIC S9(0004) COMP.
  1989     05  MSG1F PIC  X(0001).
  1990     05  FILLER REDEFINES MSG1F.
  1991         10  MSG1A PIC  X(0001).
  1992     05  MSG1I PIC  X(0072).
  1993*    -------------------------------
  1994     05  MSG2L PIC S9(0004) COMP.
  1995     05  MSG2F PIC  X(0001).
  1996     05  FILLER REDEFINES MSG2F.
  1997         10  MSG2A PIC  X(0001).
  1998     05  MSG2I PIC  X(0072).
  1999*    -------------------------------
  2000     05  PFKEYL PIC S9(0004) COMP.
  2001     05  PFKEYF PIC  X(0001).
  2002     05  FILLER REDEFINES PFKEYF.
  2003         10  PFKEYA PIC  X(0001).
  2004     05  PFKEYI PIC  99.
  2005*    -------------------------------
  2006     05  PFKEY6L PIC S9(0004) COMP.
  2007     05  PFKEY6F PIC  X(0001).
  2008     05  FILLER REDEFINES PFKEY6F.
  2009         10  PFKEY6A PIC  X(0001).
  2010     05  PFKEY6I PIC  X(0016).
  2011 01  EL131AO REDEFINES EL131AI.
  2012     05  FILLER            PIC  X(0012).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  DATEO PIC  X(0008).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  TIMEO PIC  99.99.
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  SEQUO PIC  X(0010).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  COMPO PIC  X(0003).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  USERIDO PIC  X(0004).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  LABEL1O PIC  X(0011).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  PCERTNOO PIC  X(0010).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  PSUFXO PIC  X(0001).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  CCNOO PIC  X(0016).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  MAINTO PIC  X(0001).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  40
* EL131.cbl
  2045     05  CLAIMO PIC  X(0007).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  CARRO PIC  X(0001).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  CERTO PIC  X(0010).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  SUFXO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  TYPEO PIC  X(0001).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  BENPERO PIC  X(0002).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  INSTYPEO PIC  X(0001).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  STATUSO PIC  X(0006).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  INCO PIC  X(0008).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  REPO PIC  X(0008).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  ICD1O PIC  X(0008).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  ICD2O PIC  X(0008).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  DIAGO PIC  X(0060).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  ACCSWO PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  BENEO PIC  X(0010).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  BIRTHO PIC  X(0008).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  SOCIALO PIC  X(0011).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  SEXO PIC  X(0001).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  MLNAMEO PIC  X(0015).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  41
* EL131.cbl
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  MMINITO PIC  X(0001).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  LOANNOO PIC  X(0008).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  CRTLNMEO PIC  X(0015).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  CRTFNMEO PIC  X(0012).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  CRTINITO PIC  X(0001).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  LOANBALO PIC  ZZZZZ9.99.
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  PROCO PIC  X(0004).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  SUPVO PIC  X(0001).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  PRICDO PIC  X(0001).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  CRITPO PIC  X(0002).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  CRITPTO PIC  X(0002).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  RTWMOSO PIC  X(0002).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  FILETOO PIC  X(0004).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  PTHRHDGO PIC  X(0010).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  PDTHRUO PIC  X(0008).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  PDAMTO PIC  Z(06).99.
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  NODAYSO PIC  ZZZ99.
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  NOPMTSO PIC  ZZ99.
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  FORMTYPO PIC  X(0001).
  2160*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  42
* EL131.cbl
  2161     05  FILLER            PIC  X(0003).
  2162     05  ESTO PIC  X(0008).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  AUIDO PIC  X(0004).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  OCCO PIC  X(0006).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  MNTDTO PIC  X(0008).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  MNTTYPEO PIC  X(0006).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  CERTCARO PIC  X(0001).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  CERTGRPO PIC  X(0006).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  CERTSTO PIC  X(0002).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  CERTACTO PIC  X(0010).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  CERTEFFO PIC  X(0008).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  ISSAGEO PIC  X(0002).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  APRO PIC  9(3).9(4).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  PMTFREQO PIC  99.
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  INDGRPO PIC  X(0001).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  PREMTYPO PIC  X(0001).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  REINCDO PIC  X(0001).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  JNTLNMEO PIC  X(0015).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  JNTFNMEO PIC  X(0012).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  JNTINITO PIC  X(0001).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  43
* EL131.cbl
  2219     05  JNTAGEO PIC  X(0002).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  ADDONDTO PIC  X(0008).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  LCVDSCRO PIC  X(0006).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  LCVKINDO PIC  X(0003).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  LCVCDO PIC  X(0002).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  LCVOTRMO PIC  999.
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  LCVRTRMO PIC  999.
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  LCVRATEO PIC  ZZZ.ZZ.
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  LCVFORMO PIC  X(0012).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  LCVCNDTO PIC  X(0008).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  LCVEXITO PIC  X(0008).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  LCVSTATO PIC  X(0006).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  ACVDSCRO PIC  X(0006).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  ACVKINDO PIC  X(0003).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  ACVCDO PIC  X(0002).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  ACVOTRMO PIC  999.
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  ACVRTRMO PIC  999.
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  ACVRATEO PIC  ZZZ.ZZ.
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  44
* EL131.cbl
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  ACVFORMO PIC  X(0012).
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  ACVCNDTO PIC  X(0008).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  ACVEXITO PIC  X(0008).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  ACVSTATO PIC  X(0006).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  LABEL2O PIC  X(0014).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  BCERT1O PIC  X(0010).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  BSUFX1O PIC  X(0001).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  BCERT2O PIC  X(0010).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  BSUFX2O PIC  X(0001).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  BCERT3O PIC  X(0010).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  BSUFX3O PIC  X(0001).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  BCERT4O PIC  X(0010).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  BSUFX4O PIC  X(0001).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  BCERT5O PIC  X(0010).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  BSUFX5O PIC  X(0001).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  MSG1O PIC  X(0072).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  MSG2O PIC  X(0072).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  PFKEYO PIC  X(0002).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  PFKEY6O PIC  X(0016).
  2334*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  45
* EL131.cbl
  2335
  2336*                                COPY ELCEMIB SUPPRESS.
  2337******************************************************************
  2338*                                                                *
  2339*                                                                *
  2340*                            ELCEMIB.                            *
  2341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2342*                            VMOD=2.005                          *
  2343*                                                                *
  2344*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2345*                                                                *
  2346******************************************************************
  2347 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2348     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2349     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2350     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2351     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2352     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2353     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2354     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2355     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2356     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2357         88  EMI-NO-ERRORS                    VALUE '1'.
  2358         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2359         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2360     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2361         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2362     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2363         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2364         88  EMI-AREA1-FULL                   VALUE '2'.
  2365     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2366         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2367         88  EMI-AREA2-FULL                   VALUE '2'.
  2368     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2369         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2370         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2371         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2372         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2373         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2374     12  EMI-ERROR-LINES.
  2375         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2376         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2377         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2378         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2379             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2380                 24  EMI-ERR-NUM         PIC X(4).
  2381                 24  EMI-FILLER          PIC X.
  2382                 24  EMI-SEV             PIC X.
  2383                 24  FILLER              PIC X.
  2384             20  FILLER                  PIC X(02).
  2385     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2386         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2387             20  EMI-ERROR-NUMBER    PIC X(4).
  2388             20  EMI-FILL            PIC X.
  2389             20  EMI-SEVERITY        PIC X.
  2390             20  FILLER              PIC X.
  2391             20  EMI-ERROR-TEXT.
  2392                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  46
* EL131.cbl
  2393                 24  FILLER          PIC X(55).
  2394     12  EMI-SEVERITY-SAVE           PIC X.
  2395         88  EMI-NOTE                    VALUE 'N'.
  2396         88  EMI-WARNING                 VALUE 'W'.
  2397         88  EMI-FORCABLE                VALUE 'F'.
  2398         88  EMI-FATAL                   VALUE 'X'.
  2399     12  EMI-MESSAGE-FLAG            PIC X.
  2400         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2401         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2402     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2403     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2404         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2405         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2406         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2407     12  emi-claim-no                pic x(7).
  2408     12  emi-claim-type              pic x(6).
  2409     12  FILLER                      PIC X(124)  VALUE SPACES.
  2410     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2411     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2412     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2413     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2414
  2415*                                COPY ELCJPFX SUPPRESS.
  2416******************************************************************
  2417*                                                                *
  2418*                                                                *
  2419*                            ELCJPFX.                            *
  2420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2421*                            VMOD=2.002                          *
  2422*                                                                *
  2423*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2424*                                                                *
  2425*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2426*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2427*        ELCNTL - CONTROL FILE                                   *
  2428*        ELMSTR - CLAIM MASTERS                                  *
  2429*        ELTRLR - ACTIVITY TRAILERS                              *
  2430*        ELCHKQ - CHECK QUE                                      *
  2431******************************************************************
  2432 01  JOURNAL-RECORD.
  2433     12  jp-date                     pic s9(5) comp-3.
  2434     12  jp-time                     pic s9(7) comp-3.
  2435     12  JP-USER-ID                  PIC X(4).
  2436     12  JP-FILE-ID                  PIC X(8).
  2437     12  JP-PROGRAM-ID               PIC X(8).
  2438     12  JP-RECORD-TYPE              PIC X.
  2439         88 JP-ADD              VALUE 'A'.
  2440         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2441         88 JP-AFTER-CHANGE     VALUE 'C'.
  2442         88 JP-DELETE           VALUE 'D'.
  2443         88 JP-GENERIC-DELETE   VALUE 'G'.
  2444         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2445         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2446     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2447     12  JP-RECORD-AREA
  2448
  2449
  2450                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  47
* EL131.cbl
  2451
  2452*                                COPY ELCCALC.
  2453******************************************************************
  2454*                                                                *
  2455*                           ELCCALC.                            *
  2456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2457*                            VMOD=2.025                          *
  2458*                                                                *
  2459*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2460*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2461*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2462*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2463*                                                                *
  2464*  PASSED TO ELRTRM                                              *
  2465*  -----------------                                             *
  2466*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2467*  ORIGINAL TERM                                                 *
  2468*  BEGINNING DATE                                                *
  2469*  ENDING DATE                                                   *
  2470*  COMPANY I.D.                                                  *
  2471*  ACCOUNT MASTER USER FIELD                                     *
  2472*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2473*  FREE LOOK DAYS                                                *
  2474*                                                                *
  2475*  RETURNED FROM ELRTRM                                          *
  2476*  ---------------------                                         *
  2477*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2478*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2479*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2480*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2481*----------------------------------------------------------------*
  2482*  PASSED TO ELRAMT                                              *
  2483*  ----------------                                              *
  2484*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2485*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2486*  ORIGINAL AMOUNT                                               *
  2487*  ALTERNATE BENEFIT (BALLON)                                    *
  2488*  A.P.R. - NET PAY ONLY                                         *
  2489*  METHOD
  2490*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2491*  COMPANY I.D.                                                  *
  2492*  BENEFIT TYPE                                                  *
  2493*                                                                *
  2494*  RETURNED FROM ELRAMT                                          *
  2495*  --------------------                                          *
  2496*  REMAINING AMOUNT 1 - CURRENT                                  *
  2497*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2498*  REMAINING AMOUNT FACTOR
  2499*----------------------------------------------------------------*
  2500*  PASSED TO ELRESV                                              *
  2501*  -----------------                                             *
  2502*  CERTIFICATE EFFECTIVE DATE                                    *
  2503*  VALUATION DATE                                                *
  2504*  PAID THRU DATE                                                *
  2505*  BENEFIT                                                       *
  2506*  INCURRED DATE                                                 *
  2507*  REPORTED DATE                                                 *
  2508*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  48
* EL131.cbl
  2509*  TERM                                                          *
  2510*  CDT PERCENT                                                   *
  2511*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2512* *CLAIM TYPE (LIFE, A/H)                                        *
  2513* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2514* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2515*                                                                *
  2516*  RETURNED FROM ELRESV                                          *
  2517*  --------------------                                          *
  2518*  CDT TABLE USED                                                *
  2519*  CDT FACTOR USED                                               *
  2520*  PAY TO CURRENT RESERVE                                        *
  2521*  I.B.N.R. - A/H ONLY                                           *
  2522*  FUTURE (ACCRUED) AH ONLY                                      *
  2523*----------------------------------------------------------------*
  2524*  PASSED TO ELRATE                                              *
  2525*  ----------------                                              *
  2526*  CERT ISSUE DATE                                               *
  2527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2528*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2529*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2530*  STATE CODE (CLIENT DEFINED)                                   *
  2531*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2532*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2533*  DEVIATION CODE                                                *
  2534*  ISSUE AGE                                                     *
  2535*  ORIGINAL BENEFIT AMOUNT                                       *
  2536*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2537*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2538*  BENEFIT KIND (LIFE OR A/H)                                    *
  2539*  A.P.R.                                                        *
  2540*  METHOD
  2541*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2542*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2543*  COMPANY I.D. (3 CHARACTER)                                    *
  2544*  BENEFIT CODE                                                  *
  2545*  BENEFIT OVERRIDE CODE                                         *
  2546*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2547*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2548*  JOINT INDICATOR (CSL ONLY)                                    *
  2549*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2550*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2551*                                                                *
  2552*  RETURNED FROM ELRATE                                          *
  2553*  --------------------                                          *
  2554*  CALCULATED PREMIUM                                            *
  2555*  PREMIUM RATE                                                  *
  2556*  MORTALITY CODE                                                *
  2557*  MAX ATTAINED AGE                                              *
  2558*  MAX AGE                                                       *
  2559*  MAX TERM                                                      *
  2560*  MAX MONTHLY BENEFIT                                           *
  2561*  MAX TOTAL BENIFIT                                             *
  2562*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2563*----------------------------------------------------------------*
  2564*  PASSED TO ELRFND                                              *
  2565*  ----------------                                              *
  2566*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  49
* EL131.cbl
  2567*  REFUND DATE                                                   *
  2568*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2569*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2570*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2571*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2572*  STATE CODE (CLIENT DEFINED)                                   *
  2573*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2574*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2575*  DEVIATION CODE                                                *
  2576*  ISSUE AGE                                                     *
  2577*  ORIGINAL BENEFIT AMOUNT                                       *
  2578*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2579*  PROCESS TYPE (CANCEL)                                         *
  2580*  BENEFIT KIND (LIFE OR A/H)                                    *
  2581*  A.P.R.                                                        *
  2582*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2583*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2584*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2585*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2586*  COMPANY I.D. (3 CHARACTER)                                    *
  2587*  BENEFIT CODE                                                  *
  2588*  BENEFIT OVERRIDE CODE                                         *
  2589*                                                                *
  2590*  RETURNED FROM ELRFND                                          *
  2591*  --------------------                                          *
  2592*  CALCULATED REFUND                                             *
  2593*----------------------------------------------------------------*
  2594*  PASSED TO ELEARN                                              *
  2595*  ----------------                                              *
  2596*  CERT ISSUE DATE                                               *
  2597*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2598*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2599*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2600*  STATE CODE (CLIENT DEFINED)                                   *
  2601*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2602*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2603*  DEVIATION CODE                                                *
  2604*  ISSUE AGE                                                     *
  2605*  ORIGINAL BENEFIT AMOUNT                                       *
  2606*  BENEFIT KIND (LIFE OR A/H)                                    *
  2607*  A.P.R.                                                        *
  2608*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2609*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2610*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2611*  COMPANY I.D. (3 CHARACTER)                                    *
  2612*  BENEFIT CODE                                                  *
  2613*  BENEFIT OVERRIDE CODE                                         *
  2614*                                                                *
  2615*  RETURNED FROM ELEARN                                          *
  2616*  --------------------                                          *
  2617*  INDICATED  EARNINGS                                           *
  2618*----------------------------------------------------------------*
  2619*                 LENGTH = 450                                   *
  2620*                                                                *
  2621******************************************************************
  2622******************************************************************
  2623*                   C H A N G E   L O G
  2624*
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  50
* EL131.cbl
  2625* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2626*-----------------------------------------------------------------
  2627*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2628* EFFECTIVE    NUMBER
  2629*-----------------------------------------------------------------
  2630* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2631* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2632* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2633* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2634* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2635* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2636* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2637* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2638* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2639* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2640* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2641******************************************************************
  2642
  2643 01  CALCULATION-PASS-AREA.
  2644     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2645                                     COMP.
  2646
  2647     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2648       88  NO-CP-ERROR                             VALUE ZERO.
  2649       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2650                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2651       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2652       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2653       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2654       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2655       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2656       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2657       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2658       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2659       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2660       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2661       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2662       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2663       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2664       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2665       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2666       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2667       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2668
  2669     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2670       88  NO-CP-ERROR-2                           VALUE ZERO.
  2671***********************  INPUT AREAS ****************************
  2672
  2673     12  CP-CALCULATION-AREA.
  2674         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2675         16  CP-CERT-EFF-DT        PIC XX.
  2676         16  CP-VALUATION-DT       PIC XX.
  2677         16  CP-PAID-THRU-DT       PIC XX.
  2678         16  CP-BENEFIT-TYPE       PIC X.
  2679           88  CP-AH                               VALUE 'A' 'D'
  2680                                                   'I' 'U'.
  2681           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2682           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  51
* EL131.cbl
  2683         16  CP-INCURRED-DT        PIC XX.
  2684         16  CP-REPORTED-DT        PIC XX.
  2685         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2686         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2687         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-CDT-METHOD         PIC X.
  2692           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2693           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2694           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2695         16  CP-CLAIM-TYPE         PIC X.
  2696           88  CP-AH-CLAIM                         VALUE 'A'.
  2697           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2698         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2701                                     COMP-3.
  2702         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2703                                     COMP-3.
  2704         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2705                                     COMP-3.
  2706         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2709                                     COMP-3.
  2710         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-REM-TERM-METHOD    PIC X.
  2713           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2714           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2715           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2716           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2717           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2718           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2719           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2720         16  CP-EARNING-METHOD     PIC X.
  2721           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2722           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2723           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2724           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2725           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2726           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2727           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2728           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2729           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2730           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2731           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2732           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2733           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2734           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2735         16  CP-PROCESS-TYPE       PIC X.
  2736           88  CP-CLAIM                            VALUE '1'.
  2737           88  CP-CANCEL                           VALUE '2'.
  2738           88  CP-ISSUE                            VALUE '3'.
  2739         16  CP-SPECIAL-CALC-CD    PIC X.
  2740           88  CP-OUTSTANDING-BAL              VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  52
* EL131.cbl
  2741           88  CP-1-MTH-INTEREST               VALUE ' '.
  2742           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2743           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2744           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2745           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2746           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2747           88  CP-FARM-PLAN                    VALUE 'F'.
  2748           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2749           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2750           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2751           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2752           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2753           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2754           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2755           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2756           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2757           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2758                                                     'W' 'X'.
  2759           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2760           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2761           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2762           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2763           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2764           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2765           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2766           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2767           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2768           88  CP-CSL-METH-1                   VALUE '5'.
  2769           88  CP-CSL-METH-2                   VALUE '6'.
  2770           88  CP-CSL-METH-3                   VALUE '7'.
  2771           88  CP-CSL-METH-4                   VALUE '8'.
  2772
  2773         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2774                                     COMP-3.
  2775         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2776         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2777         16  CP-STATE              PIC XX          VALUE SPACE.
  2778         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2779         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2780           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2781               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2782         16  CP-R78-OPTION         PIC X.
  2783           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2784           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2785
  2786         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2787         16  CP-IBNR-RESERVE-SW    PIC X.
  2788         16  CP-CLAIM-STATUS       PIC X.
  2789         16  CP-RATE-FILE          PIC X.
  2790         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2791                                     COMP-3.
  2792
  2793         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2794         16  CP-AH-OVERRIDE-CODE   PIC X.
  2795
  2796         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  53
* EL131.cbl
  2799                                   PIC S9(5)V99 COMP-3.
  2800         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2801                                     COMP-3.
  2802         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2803                                     COMP-3.
  2804         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2805                                     COMP-3.
  2806         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2807                                  PIC S9(7)V99 COMP-3.
  2808
  2809         16  CP-PAID-FROM-DATE     PIC X(02).
  2810         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2811         16  CP-EXT-DAYS-CALC      PIC X.
  2812           88  CP-EXT-NO-CHG                   VALUE ' '.
  2813           88  CP-EXT-CHG-LF                   VALUE '1'.
  2814           88  CP-EXT-CHG-AH                   VALUE '2'.
  2815           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2816         16  CP-DOMICILE-STATE     PIC XX.
  2817         16  CP-CARRIER            PIC X.
  2818         16  CP-REIN-FLAG          PIC X.
  2819         16  CP-REM-TRM-CALC-OPTION PIC X.
  2820           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2821                      '2' '3' '4' '5'.
  2822           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2823           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2824           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2825           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2826           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2827           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2828           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2829           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2830         16  CP-SIG-SWITCH         PIC X.
  2831         16  CP-RATING-METHOD      PIC X.
  2832           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2833           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2834           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2835           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2836           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2837           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2838           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2839           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2840           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2841         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2842                                     COMP-3.
  2843         16  CP-BEN-CATEGORY       PIC X.
  2844         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2845         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2846                                   PIC S99V9(5) COMP-3.
  2847         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2848         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2849                                   PIC S99V9(5) COMP-3.
  2850         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2851         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2852         16  CP-EXPIRE-DT          PIC XX.
  2853         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2854         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2855         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2856         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  54
* EL131.cbl
  2857         16  CP-DDF-SPEC-CALC      PIC X.
  2858             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2859             88  CP-CALC-CLP              VALUE 'C'.
  2860         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2861         16  CP-CANCEL-REASON      PIC X.
  2862         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2863         16  CP-PMT-MODE           PIC X.
  2864         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2865         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2866         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2867         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2868         16  FILLER                PIC X.
  2869
  2870***************    OUTPUT FROM ELRESV   ************************
  2871
  2872         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2873
  2874         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2875                                     COMP-3.
  2876         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2879                                     COMP-3.
  2880         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2881                                     COMP-3.
  2882         16  FILLER                PIC X(09).
  2883***************    OUTPUT FROM ELRTRM   *************************
  2884
  2885         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2888                                     COMP-3.
  2889         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2890                                     COMP-3.
  2891         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2892                                     COMP-3.
  2893         16  FILLER                PIC X(12).
  2894
  2895***************    OUTPUT FROM ELRAMT   *************************
  2896
  2897         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2898                                     COMP-3.
  2899         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2900                                     COMP-3.
  2901         16  FILLER                PIC X(12).
  2902
  2903***************    OUTPUT FROM ELRATE   *************************
  2904
  2905         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2906                                     COMP-3.
  2907         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2908                                     COMP-3.
  2909         16  CP-MORTALITY-CODE     PIC X(4).
  2910         16  CP-RATE-EDIT-FLAG     PIC X.
  2911             88  CP-RATES-NEED-APR                  VALUE '1'.
  2912         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2913                                     COMP-3.
  2914         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  55
* EL131.cbl
  2915         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2916         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2917                                   PIC S9(7)V99 COMP-3.
  2918         16  FILLER                PIC X(07).
  2919
  2920***************    OUTPUT FROM ELRFND   *************************
  2921
  2922         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2923                                     COMP-3.
  2924         16  CP-REFUND-TYPE-USED   PIC X.
  2925           88  CP-R-AS-R78                         VALUE '1'.
  2926           88  CP-R-AS-PRORATA                     VALUE '2'.
  2927           88  CP-R-AS-CALIF                       VALUE '3'.
  2928           88  CP-R-AS-TEXAS                       VALUE '4'.
  2929           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2930           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2931           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2932           88  CP-R-AS-MEAN                        VALUE '8'.
  2933           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2934           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2935           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2936           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2937           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2938           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2939         16  FILLER                PIC X(12).
  2940
  2941***************    OUTPUT FROM ELEARN   *************************
  2942
  2943         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2944                                     COMP-3.
  2945         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2946                                     COMP-3.
  2947         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2948                                     COMP-3.
  2949         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2950                                     COMP-3.
  2951         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2952                                     COMP-3.
  2953         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2954                                     COMP-3.
  2955         16  CP-EARNING-TYPE-USED  PIC X.
  2956           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2957           88  CP-E-AS-R78                         VALUE '1'.
  2958           88  CP-E-AS-PRORATA                     VALUE '2'.
  2959           88  CP-E-AS-TEXAS                       VALUE '4'.
  2960           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2961           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2962           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2963           88  CP-E-AS-MEAN                        VALUE '8'.
  2964           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2965         16  FILLER                PIC X(12).
  2966
  2967***************    OUTPUT FROM ELPMNT   *************************
  2968
  2969         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2970                                     COMP-3.
  2971         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2972                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  56
* EL131.cbl
  2973         16  FILLER                PIC X(12).
  2974
  2975***************   MISC WORK AREAS    *****************************
  2976         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2977                                     COMP-3.
  2978         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2979                                     COMP-3.
  2980         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2981                                     COMP-3.
  2982         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2983                                     COMP-3.
  2984         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2985                                     COMP-3.
  2986         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2987                                     COMP-3.
  2988         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2989             88  OPEN-RATE-FILE                   VALUE 'O'.
  2990             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2991             88  IO-ERROR                         VALUE 'E'.
  2992
  2993         16  CP-FIRST-PAY-DATE     PIC XX.
  2994
  2995         16  CP-JOINT-INDICATOR    PIC X.
  2996
  2997         16  CP-RESERVE-REMAINING-TERM
  2998                                   PIC S9(4)V9    VALUE ZERO
  2999                                     COMP-3.
  3000
  3001         16  CP-INSURED-BIRTH-DT   PIC XX.
  3002
  3003         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3004                                     COMP-3.
  3005
  3006         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3007                                     COMP-3.
  3008
  3009         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3010                                     COMP-3.
  3011
  3012         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3013                                     COMP-3.
  3014
  3015         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3016                                     COMP-3.
  3017
  3018         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3019                                     COMP-3.
  3020
  3021         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3022                                     COMP-3.
  3023
  3024         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3025             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3026
  3027         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3028                                     COMP-3.
  3029         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3030                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  57
* EL131.cbl
  3031         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3032         16  cp-extra-periods      pic 9 value zeros.
  3033         16  cp-net-only-state     pic x value spaces.
  3034         16  FILLER                PIC X(13).
  3035******************************************************************
  3036
  3037*                                COPY ELCDATE.
  3038******************************************************************
  3039*                                                                *
  3040*                                                                *
  3041*                            ELCDATE.                            *
  3042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3043*                            VMOD=2.003
  3044*                                                                *
  3045*                                                                *
  3046*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3047*                 LENGTH = 200                                   *
  3048******************************************************************
  3049
  3050 01  DATE-CONVERSION-DATA.
  3051     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3052     12  DC-OPTION-CODE                PIC X.
  3053         88  BIN-TO-GREG                VALUE ' '.
  3054         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3055         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3056         88  YMD-GREG-TO-BIN            VALUE '3'.
  3057         88  MDY-GREG-TO-BIN            VALUE '4'.
  3058         88  JULIAN-TO-BIN              VALUE '5'.
  3059         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3060         88  FIND-CENTURY               VALUE '7'.
  3061         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3062         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3063         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3064         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3065         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3066         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3067         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3068         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3069         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3070         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3071         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3072         88  BIN-3-TO-GREG              VALUE 'I'.
  3073         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3074         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3075         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3076         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3077         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3078         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3079         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3080         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3081         88  THREE-CHARACTER-BIN
  3082                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3083         88  GREGORIAN-TO-BIN
  3084                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3085         88  BIN-TO-GREGORIAN
  3086                  VALUES ' ' '1' 'I' '8' 'G'.
  3087         88  JULIAN-TO-BINARY
  3088                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  58
* EL131.cbl
  3089     12  DC-ERROR-CODE                 PIC X.
  3090         88  NO-CONVERSION-ERROR        VALUE ' '.
  3091         88  DATE-CONVERSION-ERROR
  3092                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3093         88  DATE-IS-ZERO               VALUE '1'.
  3094         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3095         88  DATE-IS-INVALID            VALUE '3'.
  3096         88  DATE1-GREATER-DATE2        VALUE '4'.
  3097         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3098         88  DATE-INVALID-OPTION        VALUE '9'.
  3099         88  INVALID-CENTURY            VALUE 'A'.
  3100         88  ONLY-CENTURY               VALUE 'B'.
  3101         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3102         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3103     12  DC-END-OF-MONTH               PIC X.
  3104         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3105     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3106         88  USE-NORMAL-PROCESS         VALUE ' '.
  3107         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3108         88  ADJUST-UP-100-YRS          VALUE '2'.
  3109     12  FILLER                        PIC X.
  3110     12  DC-CONVERSION-DATES.
  3111         16  DC-BIN-DATE-1             PIC XX.
  3112         16  DC-BIN-DATE-2             PIC XX.
  3113         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3114         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3115                       DC-GREG-DATE-1-EDIT.
  3116             20  DC-EDIT1-MONTH        PIC 99.
  3117             20  SLASH1-1              PIC X.
  3118             20  DC-EDIT1-DAY          PIC 99.
  3119             20  SLASH1-2              PIC X.
  3120             20  DC-EDIT1-YEAR         PIC 99.
  3121         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3122         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3123                     DC-GREG-DATE-2-EDIT.
  3124             20  DC-EDIT2-MONTH        PIC 99.
  3125             20  SLASH2-1              PIC X.
  3126             20  DC-EDIT2-DAY          PIC 99.
  3127             20  SLASH2-2              PIC X.
  3128             20  DC-EDIT2-YEAR         PIC 99.
  3129         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3130         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3131                     DC-GREG-DATE-1-YMD.
  3132             20  DC-YMD-YEAR           PIC 99.
  3133             20  DC-YMD-MONTH          PIC 99.
  3134             20  DC-YMD-DAY            PIC 99.
  3135         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3136         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3137                      DC-GREG-DATE-1-MDY.
  3138             20  DC-MDY-MONTH          PIC 99.
  3139             20  DC-MDY-DAY            PIC 99.
  3140             20  DC-MDY-YEAR           PIC 99.
  3141         16  DC-GREG-DATE-1-ALPHA.
  3142             20  DC-ALPHA-MONTH        PIC X(10).
  3143             20  DC-ALPHA-DAY          PIC 99.
  3144             20  FILLER                PIC XX.
  3145             20  DC-ALPHA-CENTURY.
  3146                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  59
* EL131.cbl
  3147             20  DC-ALPHA-YEAR         PIC 99.
  3148         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3149         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3150         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3151         16  DC-JULIAN-DATE            PIC 9(05).
  3152         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3153                                       PIC 9(05).
  3154         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3155             20  DC-JULIAN-YEAR        PIC 99.
  3156             20  DC-JULIAN-DAYS        PIC 999.
  3157         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3158         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3159         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3160     12  DATE-CONVERSION-VARIBLES.
  3161         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3162         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3163             20  FILLER                PIC 9(3).
  3164             20  HOLD-CEN-1-CCYY.
  3165                 24  HOLD-CEN-1-CC     PIC 99.
  3166                 24  HOLD-CEN-1-YY     PIC 99.
  3167             20  HOLD-CEN-1-MO         PIC 99.
  3168             20  HOLD-CEN-1-DA         PIC 99.
  3169         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3170             20  HOLD-CEN-1-R-MO       PIC 99.
  3171             20  HOLD-CEN-1-R-DA       PIC 99.
  3172             20  HOLD-CEN-1-R-CCYY.
  3173                 24  HOLD-CEN-1-R-CC   PIC 99.
  3174                 24  HOLD-CEN-1-R-YY   PIC 99.
  3175             20  FILLER                PIC 9(3).
  3176         16  HOLD-CENTURY-1-X.
  3177             20  FILLER                PIC X(3)  VALUE SPACES.
  3178             20  HOLD-CEN-1-X-CCYY.
  3179                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3180                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3181             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3182             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3183         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3184             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3185             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3186             20  HOLD-CEN-1-R-X-CCYY.
  3187                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3188                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3189             20  FILLER                PIC XXX.
  3190         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3191         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3192         16  DC-JULIAN-DATE-1          PIC 9(07).
  3193         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3194             20  DC-JULIAN-1-CCYY.
  3195                 24  DC-JULIAN-1-CC    PIC 99.
  3196                 24  DC-JULIAN-1-YR    PIC 99.
  3197             20  DC-JULIAN-DA-1        PIC 999.
  3198         16  DC-JULIAN-DATE-2          PIC 9(07).
  3199         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3200             20  DC-JULIAN-2-CCYY.
  3201                 24  DC-JULIAN-2-CC    PIC 99.
  3202                 24  DC-JULIAN-2-YR    PIC 99.
  3203             20  DC-JULIAN-DA-2        PIC 999.
  3204         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  60
* EL131.cbl
  3205             20  DC-EDITA-MONTH        PIC 99.
  3206             20  SLASHA-1              PIC X VALUE '/'.
  3207             20  DC-EDITA-DAY          PIC 99.
  3208             20  SLASHA-2              PIC X VALUE '/'.
  3209             20  DC-EDITA-CCYY.
  3210                 24  DC-EDITA-CENT     PIC 99.
  3211                 24  DC-EDITA-YEAR     PIC 99.
  3212         16  DC-GREG-DATE-B-EDIT.
  3213             20  DC-EDITB-MONTH        PIC 99.
  3214             20  SLASHB-1              PIC X VALUE '/'.
  3215             20  DC-EDITB-DAY          PIC 99.
  3216             20  SLASHB-2              PIC X VALUE '/'.
  3217             20  DC-EDITB-CCYY.
  3218                 24  DC-EDITB-CENT     PIC 99.
  3219                 24  DC-EDITB-YEAR     PIC 99.
  3220         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3221         16  DC-GREG-DATE-CYMD-R REDEFINES
  3222                              DC-GREG-DATE-CYMD.
  3223             20  DC-CYMD-CEN           PIC 99.
  3224             20  DC-CYMD-YEAR          PIC 99.
  3225             20  DC-CYMD-MONTH         PIC 99.
  3226             20  DC-CYMD-DAY           PIC 99.
  3227         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3228         16  DC-GREG-DATE-MDCY-R REDEFINES
  3229                              DC-GREG-DATE-MDCY.
  3230             20  DC-MDCY-MONTH         PIC 99.
  3231             20  DC-MDCY-DAY           PIC 99.
  3232             20  DC-MDCY-CEN           PIC 99.
  3233             20  DC-MDCY-YEAR          PIC 99.
  3234    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3235        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3236    12  DC-EL310-DATE                  PIC X(21).
  3237    12  FILLER                         PIC X(28).
  3238
  3239*                                COPY ELCDMO.
  3240******************************************************************
  3241*                                                                *
  3242*                                                                *
  3243*                            ELCDMO.                             *
  3244*                            VMOD=2.004                          *
  3245*                                                                *
  3246*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3247*        COMMUNICATION AREA                                      *
  3248*   FILE TYPE = NA                                               *
  3249*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3250*                                                                *
  3251******************************************************************
  3252 01  DMO-COMMUNICATION-AREA.
  3253     12  DM-RECORD-TYPE                  PIC  X(02).
  3254             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3255             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3256             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3257     12  DM-DIST-CODE                    PIC  X(04).
  3258     12  DM-MAIL-CODE                    PIC  X(05).
  3259     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3260     12  DM-INSURED-NAME                 PIC  X(30).
  3261     12  DM-CLAIM-NO                     PIC  X(07).
  3262     12  DM-CLAIM-TYPE                   PIC  X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  61
* EL131.cbl
  3263
  3264     12  DM-STATUS-DATA-AREA.
  3265         16  DM-CLAIM-STATUS             PIC  X.
  3266             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3267             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3268             88  DM-CLOSED                        VALUE '3'.
  3269             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3270             88  DM-DEFAULT                       VALUE '9'.
  3271         16  DM-STATUS-DATE              PIC  X(08).
  3272******YYYYMMDD
  3273         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3274             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3275             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3276             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3277             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3278             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3279             88  DM-RE-OPENED                     VALUE 'R'.
  3280             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3281             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3282             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3283         16  DM-STAT-CARRIER             PIC X.
  3284
  3285     12  DM-DRAFT-DATA-AREA.
  3286         16  DM-PAYMENT-TYPE             PIC  X.
  3287             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3288         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3289         16  DM-PAYMENT-DATE             PIC  X(08).
  3290******YYYYMMDD
  3291         16  DM-CERT-NO                  PIC  X(11).
  3292         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3293         16  DM-CARRIER                  PIC  X.
  3294
  3295     12  DM-RETURN-CODE                  PIC  XX.
  3296*                                COPY ERCPDEF.
  3297******************************************************************
  3298*                                                                *
  3299*                                                                *
  3300*                            ERCPDEF.                            *
  3301*                                                                *
  3302*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3303*                                                                *
  3304*    FILE TYPE = VSAM,KSDS                                       *
  3305*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3306*                                                                *
  3307*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3308*                                                                *
  3309*    LOG = YES                                                   *
  3310*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3311******************************************************************
  3312*                   C H A N G E   L O G
  3313*
  3314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3315*-----------------------------------------------------------------
  3316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3317* EFFECTIVE    NUMBER
  3318*-----------------------------------------------------------------
  3319* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3320* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  62
* EL131.cbl
  3321* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3322******************************************************************
  3323 01  PRODUCT-MASTER.
  3324    12  PD-RECORD-ID                 PIC X(02).
  3325        88  VALID-PD-ID                  VALUE 'PD'.
  3326    12  PD-CONTROL-PRIMARY.
  3327        16  PD-COMPANY-CD            PIC X.
  3328        16  PD-STATE                 PIC XX.
  3329        16  PD-PRODUCT-CD            PIC XXX.
  3330        16  PD-FILLER                PIC X(7).
  3331        16  PD-BEN-TYPE              PIC X.
  3332        16  PD-BEN-CODE              PIC XX.
  3333        16  PD-PROD-EXP-DT           PIC XX.
  3334    12  FILLER                       PIC X(50).
  3335    12  PD-PRODUCT-DATA OCCURS 8.
  3336        16  PD-PROD-CODE             PIC X.
  3337            88  PD-PROD-LIFE           VALUE 'L'.
  3338            88  PD-PROD-PROP           VALUE 'P'.
  3339            88  PD-PROD-AH             VALUE 'A'.
  3340            88  PD-PROD-IU             VALUE 'I'.
  3341            88  PD-PROD-GAP            VALUE 'G'.
  3342            88  PD-PROD-FAML           VALUE 'F'.
  3343        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3344        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3345        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3346        16  PD-MAX-TERM              PIC S999        COMP-3.
  3347        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3348        16  FILLER                   PIC X.
  3349        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3350        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3351        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3352        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3353        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3354        16  PD-REC-CRIT-PERIOD       PIC 99.
  3355        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3356            20  PD-RECURRING-YN      PIC X.
  3357            20  FILLER               PIC X.
  3358        16  PD-RTW-MOS               PIC 99.
  3359        16  PD-MAX-EXTENSION         PIC 99.
  3360        16  pd-ben-pct               pic sv999 comp-3.
  3361*       16  FILLER                   PIC XX.
  3362    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3363    12  PD-TERM-LIMITS OCCURS 15.
  3364        16  PD-LOW-TERM              PIC S999        COMP-3.
  3365        16  PD-HI-TERM               PIC S999        COMP-3.
  3366*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3367    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3368        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3369        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3370    12  PD-EARN-FACTORS.
  3371        16  FILLER OCCURS 15.
  3372            20  FILLER OCCURS 15.
  3373                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3374    12  PD-PRODUCT-DESC              PIC X(80).
  3375    12  PD-TRUNCATED                 PIC X.
  3376    12  FILLER                       PIC X(59).
  3377    12  PD-MAINT-INFORMATION.
  3378        16  PD-LAST-MAINT-DT         PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  63
* EL131.cbl
  3379        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3380        16  PD-LAST-MAINT-BY         PIC X(04).
  3381*                                COPY ELCCRTT.
  3382******************************************************************
  3383*                                                                *
  3384*                            ELCCRTT.                            *
  3385*                                                                *
  3386*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3387*                                                                *
  3388*   FILE TYPE = VSAM,KSDS                                        *
  3389*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3390*                                                                *
  3391*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3392*                                                                *
  3393*   LOG = YES                                                    *
  3394*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3395******************************************************************
  3396*                   C H A N G E   L O G
  3397*
  3398* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3399*-----------------------------------------------------------------
  3400*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3401* EFFECTIVE    NUMBER
  3402*-----------------------------------------------------------------
  3403* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3404* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3405* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3406* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3407* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3408* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3409* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3410* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3411* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3412******************************************************************
  3413
  3414 01  CERTIFICATE-TRAILERS.
  3415     12  CS-RECORD-ID                      PIC XX.
  3416         88  VALID-CS-ID                      VALUE 'CS'.
  3417
  3418     12  CS-CONTROL-PRIMARY.
  3419         16  CS-COMPANY-CD                 PIC X.
  3420         16  CS-CARRIER                    PIC X.
  3421         16  CS-GROUPING                   PIC X(6).
  3422         16  CS-STATE                      PIC XX.
  3423         16  CS-ACCOUNT                    PIC X(10).
  3424         16  CS-CERT-EFF-DT                PIC XX.
  3425         16  CS-CERT-NO.
  3426             20  CS-CERT-PRIME             PIC X(10).
  3427             20  CS-CERT-SFX               PIC X.
  3428         16  CS-TRAILER-TYPE               PIC X.
  3429             88  COMM-TRLR           VALUE 'A'.
  3430             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3431             88  CERT-DATA-TRLR      VALUE 'C'.
  3432
  3433     12  CS-DATA-AREA                      PIC X(516).
  3434
  3435     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3436         16  CS-BANK-COMMISSION-AREA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  64
* EL131.cbl
  3437             20  CS-BANK-COMMS       OCCURS 10.
  3438                 24  CS-AGT                PIC X(10).
  3439                 24  CS-COM-TYP            PIC X.
  3440                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3441                 24  CS-RECALC-LV-INDIC    PIC X.
  3442                 24  FILLER                PIC X(10).
  3443         16  FILLER                        PIC X(256).
  3444
  3445     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3446****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3447         16  CS-MB-CLAIM-DATA OCCURS 24.
  3448             20  CS-CLAIM-NO               PIC X(7).
  3449             20  CS-CLAIM-TYPE             PIC X.
  3450                 88  CS-AH-CLM               VALUE 'A'.
  3451                 88  CS-IU-CLM               VALUE 'I'.
  3452                 88  CS-GP-CLM               VALUE 'G'.
  3453                 88  CS-LF-CLM               VALUE 'L'.
  3454                 88  CS-PR-CLM               VALUE 'P'.
  3455                 88  CS-FL-CLM               VALUE 'F'.
  3456             20  CS-INSURED-TYPE           PIC X.
  3457                 88  CS-PRIM-INSURED          VALUE 'P'.
  3458                 88  CS-CO-BORROWER           VALUE 'C'.
  3459             20  CS-BENEFIT-PERIOD         PIC 99.
  3460             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3461             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3462             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3463         16  FILLER                        PIC X(12).
  3464     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3465         16  CS-VIN-NUMBER                 PIC X(17).
  3466         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3467         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3468         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3469         16  cs-agent-name.
  3470             20  cs-agent-fname            pic x(20).
  3471             20  cs-agent-mi               pic x.
  3472             20  cs-agent-lname            pic x(25).
  3473         16  cs-license-no                 pic x(15).
  3474         16  cs-npn-number                 pic x(10).
  3475         16  cs-agent-edit-status          pic x.
  3476             88  cs-ae-refer-to-manager      value 'M'.
  3477             88  cs-ae-cover-sheet           value 'C'.
  3478             88  cs-ae-sig-form              value 'S'.
  3479             88  cs-ae-verified              value 'V'.
  3480             88  cs-unidentified-signature   value 'U'.
  3481             88  cs-cert-returned            value 'R'.
  3482             88  cs-accept-no-commission     value 'N'.
  3483         16  cs-year                       pic 9999.
  3484         16  cs-make                       pic x(20).
  3485         16  cs-model                      pic x(20).
  3486         16  cs-future                     pic x(20).
  3487         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3488         16  FILLER                        PIC X(356). *> was 420
  3489*        16  FILLER                        PIC X(496).
  3490
  3491****************************************************************
  3492*
  3493* Copyright (c) 2007 by Clerity Solutions, Inc.
  3494* All rights reserved.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  65
* EL131.cbl
  3495*
  3496****************************************************************
  3497 01  DFHEIV.
  3498   02  DFHEIV0               PIC X(35).
  3499   02  DFHEIV1               PIC X(08).
  3500   02  DFHEIV2               PIC X(08).
  3501   02  DFHEIV3               PIC X(08).
  3502   02  DFHEIV4               PIC X(06).
  3503   02  DFHEIV5               PIC X(04).
  3504   02  DFHEIV6               PIC X(04).
  3505   02  DFHEIV7               PIC X(02).
  3506   02  DFHEIV8               PIC X(02).
  3507   02  DFHEIV9               PIC X(01).
  3508   02  DFHEIV10              PIC S9(7) COMP-3.
  3509   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3510   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3511   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3512   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3513   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3514   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3515   02  DFHEIV17              PIC X(04).
  3516   02  DFHEIV18              PIC X(04).
  3517   02  DFHEIV19              PIC X(04).
  3518   02  DFHEIV20              USAGE IS POINTER.
  3519   02  DFHEIV21              USAGE IS POINTER.
  3520   02  DFHEIV22              USAGE IS POINTER.
  3521   02  DFHEIV23              USAGE IS POINTER.
  3522   02  DFHEIV24              USAGE IS POINTER.
  3523   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3524   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3525   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3526   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3527   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3528   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3529   02  FILLER                PIC X(02).
  3530   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3531   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3532   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3533   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3534   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3535 LINKAGE  SECTION.
  3536*****************************************************************
  3537*                                                               *
  3538* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3539* All rights reserved.                                          *
  3540*                                                               *
  3541*****************************************************************
  3542 01  dfheiblk.
  3543     02  eibtime          pic s9(7) comp-3.
  3544     02  eibdate          pic s9(7) comp-3.
  3545     02  eibtrnid         pic x(4).
  3546     02  eibtaskn         pic s9(7) comp-3.
  3547     02  eibtrmid         pic x(4).
  3548     02  dfheigdi         pic s9(4) comp.
  3549     02  eibcposn         pic s9(4) comp.
  3550     02  eibcalen         pic s9(4) comp.
  3551     02  eibaid           pic x(1).
  3552     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  66
* EL131.cbl
  3553     02  eibfn            pic x(2).
  3554     02  eibfiller2       pic x(2).
  3555     02  eibrcode         pic x(6).
  3556     02  eibfiller3       pic x(2).
  3557     02  eibds            pic x(8).
  3558     02  eibreqid         pic x(8).
  3559     02  eibrsrce         pic x(8).
  3560     02  eibsync          pic x(1).
  3561     02  eibfree          pic x(1).
  3562     02  eibrecv          pic x(1).
  3563     02  eibsend          pic x(1).
  3564     02  eibatt           pic x(1).
  3565     02  eibeoc           pic x(1).
  3566     02  eibfmh           pic x(1).
  3567     02  eibcompl         pic x(1).
  3568     02  eibsig           pic x(1).
  3569     02  eibconf          pic x(1).
  3570     02  eiberr           pic x(1).
  3571     02  eibrldbk         pic x(1).
  3572     02  eiberrcd         pic x(4).
  3573     02  eibsynrb         pic x(1).
  3574     02  eibnodat         pic x(1).
  3575     02  eibfiller5       pic x(2).
  3576     02  eibresp          pic 9(09) comp.
  3577     02  eibresp2         pic 9(09) comp.
  3578     02  dfheigdj         pic s9(4) comp.
  3579     02  dfheigdk         pic s9(4) comp.
  3580 01  DFHCOMMAREA                 PIC X(1024).
  3581
  3582*                                COPY ELCMSTR.
  3583******************************************************************
  3584*                                                                *
  3585*                            ELCMSTR.                            *
  3586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3587*                            VMOD=2.012                          *
  3588*                                                                *
  3589*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3590*                                                                *
  3591*   FILE TYPE = VSAM,KSDS                                        *
  3592*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3593*                                                                *
  3594*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3595*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3596*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3597*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3598*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3599*                                                 RKP=75,LEN=21  *
  3600*                                                                *
  3601*   **** NOTE ****                                               *
  3602*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3603*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3604*                                                                *
  3605*   LOG = YES                                                    *
  3606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3607******************************************************************
  3608*                   C H A N G E   L O G
  3609*
  3610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  67
* EL131.cbl
  3611*-----------------------------------------------------------------
  3612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3613* EFFECTIVE    NUMBER
  3614*-----------------------------------------------------------------
  3615* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3616* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3617* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3618* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3619* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3620******************************************************************
  3621 01  CLAIM-MASTER.
  3622     12  CL-RECORD-ID                PIC XX.
  3623         88  VALID-CL-ID         VALUE 'CL'.
  3624
  3625     12  CL-CONTROL-PRIMARY.
  3626         16  CL-COMPANY-CD           PIC X.
  3627         16  CL-CARRIER              PIC X.
  3628         16  CL-CLAIM-NO             PIC X(7).
  3629         16  CL-CERT-NO.
  3630             20  CL-CERT-PRIME       PIC X(10).
  3631             20  CL-CERT-SFX         PIC X.
  3632
  3633     12  CL-CONTROL-BY-NAME.
  3634         16  CL-COMPANY-CD-A1        PIC X.
  3635         16  CL-INSURED-LAST-NAME    PIC X(15).
  3636         16  CL-INSURED-NAME.
  3637             20  CL-INSURED-1ST-NAME PIC X(12).
  3638             20  CL-INSURED-MID-INIT PIC X.
  3639
  3640     12  CL-CONTROL-BY-SSN.
  3641         16  CL-COMPANY-CD-A2        PIC X.
  3642         16  CL-SOC-SEC-NO.
  3643             20  CL-SSN-STATE        PIC XX.
  3644             20  CL-SSN-ACCOUNT      PIC X(6).
  3645             20  CL-SSN-LN3          PIC X(3).
  3646
  3647     12  CL-CONTROL-BY-CERT-NO.
  3648         16  CL-COMPANY-CD-A4        PIC X.
  3649         16  CL-CERT-NO-A4.
  3650             20  CL-CERT-A4-PRIME    PIC X(10).
  3651             20  CL-CERT-A4-SFX      PIC X.
  3652
  3653     12  CL-CONTROL-BY-CCN.
  3654         16  CL-COMPANY-CD-A5        PIC X.
  3655         16  CL-CCN-A5.
  3656             20  CL-CCN.
  3657                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3658                 24  CL-CCN-PRIME-A5 PIC X(12).
  3659             20  CL-CCN-FILLER-A5    PIC X(4).
  3660
  3661     12  CL-INSURED-PROFILE-DATA.
  3662         16  CL-INSURED-BIRTH-DT     PIC XX.
  3663         16  CL-INSURED-SEX-CD       PIC X.
  3664             88  INSURED-IS-MALE        VALUE 'M'.
  3665             88  INSURED-IS-FEMALE      VALUE 'F'.
  3666             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3667         16  CL-INSURED-OCC-CD       PIC X(6).
  3668         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  68
* EL131.cbl
  3669
  3670     12  CL-PROCESSING-INFO.
  3671         16  CL-PROCESSOR-ID         PIC X(4).
  3672         16  CL-CLAIM-STATUS         PIC X.
  3673             88  CLAIM-IS-OPEN          VALUE 'O'.
  3674             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3675         16  CL-CLAIM-TYPE           PIC X.
  3676*            88  AH-CLAIM               VALUE 'A'.
  3677*            88  LIFE-CLAIM             VALUE 'L'.
  3678*            88  PROPERTY-CLAIM         VALUE 'P'.
  3679*            88  IUI-CLAIM              VALUE 'I'.
  3680*            88  GAP-CLAIM              VALUE 'G'.
  3681*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3682         16  CL-CLAIM-PREM-TYPE      PIC X.
  3683             88  SINGLE-PREMIUM         VALUE '1'.
  3684             88  O-B-COVERAGE           VALUE '2'.
  3685             88  OPEN-END-COVERAGE      VALUE '3'.
  3686         16  CL-INCURRED-DT          PIC XX.
  3687         16  CL-REPORTED-DT          PIC XX.
  3688         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3689         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3690         16  CL-LAST-PMT-DT          PIC XX.
  3691         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3692         16  CL-PAID-THRU-DT         PIC XX.
  3693         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3694         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3695         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3696         16  CL-PMT-CALC-METHOD      PIC X.
  3697             88  CL-360-DAY-YR          VALUE '1'.
  3698             88  CL-365-DAY-YR          VALUE '2'.
  3699             88  CL-FULL-MONTHS         VALUE '3'.
  3700         16  CL-CAUSE-CD             PIC X(6).
  3701
  3702         16  CL-PRIME-CERT-NO.
  3703             20  CL-PRIME-CERT-PRIME PIC X(10).
  3704             20  CL-PRIME-CERT-SFX   PIC X.
  3705
  3706         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3707             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3708             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3709
  3710         16  CL-MICROFILM-NO         PIC X(10).
  3711         16  FILLER REDEFINES CL-MICROFILM-NO.
  3712             20  CL-BENEFIT-PERIOD   PIC 99.
  3713             20  FILLER              PIC X(8).
  3714         16  CL-PROG-FORM-TYPE       PIC X.
  3715         16  CL-LAST-ADD-ON-DT       PIC XX.
  3716
  3717         16  CL-LAST-REOPEN-DT       PIC XX.
  3718         16  CL-LAST-CLOSE-DT        PIC XX.
  3719         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3720             88  FINAL-PAID             VALUE '1'.
  3721             88  CLAIM-DENIED           VALUE '2'.
  3722             88  AUTO-CLOSE             VALUE '3'.
  3723             88  MANUAL-CLOSE           VALUE '4'.
  3724             88  BENEFITS-CHANGED       VALUE 'C'.
  3725             88  SETUP-ERRORS           VALUE 'E'.
  3726         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  69
* EL131.cbl
  3727         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3728         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3729             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3730         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3731         16  FILLER                  PIC X.
  3732
  3733     12  CL-CERTIFICATE-DATA.
  3734         16  CL-CERT-ORIGIN          PIC X.
  3735             88  CERT-WAS-ONLINE        VALUE '1'.
  3736             88  CERT-WAS-CREATED       VALUE '2'.
  3737             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3738         16  CL-CERT-KEY-DATA.
  3739             20  CL-CERT-CARRIER     PIC X.
  3740             20  CL-CERT-GROUPING    PIC X(6).
  3741             20  CL-CERT-STATE       PIC XX.
  3742             20  CL-CERT-ACCOUNT.
  3743                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3744                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3745             20  CL-CERT-EFF-DT      PIC XX.
  3746
  3747     12  CL-STATUS-CONTROLS.
  3748         16  CL-PRIORITY-CD          PIC X.
  3749             88  CONFIDENTIAL-DATA      VALUE '8'.
  3750             88  HIGHEST-PRIORITY       VALUE '9'.
  3751         16  CL-SUPV-ATTN-CD         PIC X.
  3752             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3753             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3754         16  CL-PURGED-DT            PIC XX.
  3755         16  CL-RESTORED-DT          PIC XX.
  3756         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3757         16  CL-NEXT-RESEND-DT       PIC XX.
  3758         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3759         16  CL-CRITICAL-PERIOD      PIC 99.
  3760*        16  FILLER                  PIC XX.
  3761         16  CL-LAST-MAINT-DT        PIC XX.
  3762         16  CL-LAST-MAINT-USER      PIC X(4).
  3763         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3764         16  CL-LAST-MAINT-TYPE      PIC X.
  3765             88  CLAIM-SET-UP           VALUE ' '.
  3766             88  PAYMENT-MADE           VALUE '1'.
  3767             88  LETTER-SENT            VALUE '2'.
  3768             88  MASTER-WAS-ALTERED     VALUE '3'.
  3769             88  MASTER-WAS-RESTORED    VALUE '4'.
  3770             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3771             88  FILE-CONVERTED         VALUE '6'.
  3772             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3773             88  ERROR-CORRECTION       VALUE 'E'.
  3774         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3775         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3776         16  CL-BENEFICIARY          PIC X(10).
  3777         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3778         16  CL-DENIAL-TYPE          PIC X.
  3779             88  CL-TYPE-DENIAL          VALUE '1'.
  3780             88  CL-TYPE-RESCISSION      VALUE '2'.
  3781             88  CL-TYPE-REFORMATION     VALUE '3'.
  3782             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3783             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3784         16  filler                  pic x(5).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  70
* EL131.cbl
  3785*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3786*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3787*        16  CL-RTW-DT               PIC XX.
  3788
  3789     12  CL-TRAILER-CONTROLS.
  3790         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3791             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3792             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3793             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3794         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3795         16  FILLER                  PIC XX.
  3796         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3797         16  CL-ADDRESS-TRAILER-CNT.
  3798             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3799                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3800             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3801                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3802             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3803                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3804             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3805                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3806             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3807                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3808             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3809                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3810             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3811                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3812
  3813     12  CL-CV-REFERENCE-NO.
  3814         16  CL-CV-REFNO-PRIME       PIC X(18).
  3815         16  CL-CV-REFNO-SFX         PIC XX.
  3816
  3817     12  CL-FILE-LOCATION            PIC X(4).
  3818
  3819     12  CL-PROCESS-ERRORS.
  3820         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3821             88  NO-FATAL-ERRORS        VALUE ZERO.
  3822         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3823             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3824
  3825     12  CL-PRODUCT-CD               PIC X.
  3826
  3827     12  CL-CURRENT-KEY-DATA.
  3828         16  CL-CURRENT-CARRIER      PIC X.
  3829         16  CL-CURRENT-GROUPING     PIC X(6).
  3830         16  CL-CURRENT-STATE        PIC XX.
  3831         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3832
  3833     12  CL-ASSOCIATES               PIC X.
  3834         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3835         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3836         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3837         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3838
  3839     12  CL-ACTIVITY-CODE            PIC 99.
  3840     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3841     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3842
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  71
* EL131.cbl
  3843     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3844     12  CL-LAG-REPORT-CODE          PIC 9.
  3845     12  CL-LOAN-TYPE                PIC XX.
  3846     12  CL-LEGAL-STATE              PIC XX.
  3847
  3848     12  CL-YESNOSW                  PIC X.
  3849     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3850         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3851         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3852         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3853     12  cl-insured-type             pic x.
  3854         88  cl-claim-on-primary         value 'P'.
  3855         88  cl-claim-on-co-borrower     value 'C'.
  3856     12  cl-benefit-expiration-dt    PIC XX.
  3857
  3858*                                COPY ELCCERT.
  3859******************************************************************
  3860*                                                                *
  3861*                            ELCCERT.                            *
  3862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3863*                            VMOD=2.013                          *
  3864*                                                                *
  3865*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3866*                                                                *
  3867*   FILE TYPE = VSAM,KSDS                                        *
  3868*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3869*                                                                *
  3870*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3871*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3872*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3873*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3874*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3875*                                                                *
  3876*   LOG = YES                                                    *
  3877*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3878******************************************************************
  3879*                   C H A N G E   L O G
  3880*
  3881* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3882*-----------------------------------------------------------------
  3883*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3884* EFFECTIVE    NUMBER
  3885*-----------------------------------------------------------------
  3886* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3887* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3888* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3889* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3890* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3891* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3892* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3893* 032612  CR2011110200001  PEMA  AHL CHANGES
  3894* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3895* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3896******************************************************************
  3897
  3898 01  CERTIFICATE-MASTER.
  3899     12  CM-RECORD-ID                      PIC XX.
  3900         88  VALID-CM-ID                      VALUE 'CM'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  72
* EL131.cbl
  3901
  3902     12  CM-CONTROL-PRIMARY.
  3903         16  CM-COMPANY-CD                 PIC X.
  3904         16  CM-CARRIER                    PIC X.
  3905         16  CM-GROUPING.
  3906             20  CM-GROUPING-PREFIX        PIC X(3).
  3907             20  CM-GROUPING-PRIME         PIC X(3).
  3908         16  CM-STATE                      PIC XX.
  3909         16  CM-ACCOUNT.
  3910             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3911             20  CM-ACCOUNT-PRIME          PIC X(6).
  3912         16  CM-CERT-EFF-DT                PIC XX.
  3913         16  CM-CERT-NO.
  3914             20  CM-CERT-PRIME             PIC X(10).
  3915             20  CM-CERT-SFX               PIC X.
  3916
  3917     12  CM-CONTROL-BY-NAME.
  3918         16  CM-COMPANY-CD-A1              PIC X.
  3919         16  CM-INSURED-LAST-NAME          PIC X(15).
  3920         16  CM-INSURED-INITIALS.
  3921             20  CM-INSURED-INITIAL1       PIC X.
  3922             20  CM-INSURED-INITIAL2       PIC X.
  3923
  3924     12  CM-CONTROL-BY-SSN.
  3925         16  CM-COMPANY-CD-A2              PIC X.
  3926         16  CM-SOC-SEC-NO.
  3927             20  CM-SSN-STATE              PIC XX.
  3928             20  CM-SSN-ACCOUNT            PIC X(6).
  3929             20  CM-SSN-LN3.
  3930                 25  CM-INSURED-INITIALS-A2.
  3931                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3932                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3933                 25 CM-PART-LAST-NAME-A2         PIC X.
  3934
  3935     12  CM-CONTROL-BY-CERT-NO.
  3936         16  CM-COMPANY-CD-A4              PIC X.
  3937         16  CM-CERT-NO-A4                 PIC X(11).
  3938
  3939     12  CM-CONTROL-BY-MEMB.
  3940         16  CM-COMPANY-CD-A5              PIC X.
  3941         16  CM-MEMBER-NO.
  3942             20  CM-MEMB-STATE             PIC XX.
  3943             20  CM-MEMB-ACCOUNT           PIC X(6).
  3944             20  CM-MEMB-LN4.
  3945                 25  CM-INSURED-INITIALS-A5.
  3946                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3947                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3948                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3949
  3950     12  CM-INSURED-PROFILE-DATA.
  3951         16  CM-INSURED-FIRST-NAME.
  3952             20  CM-INSURED-1ST-INIT       PIC X.
  3953             20  FILLER                    PIC X(9).
  3954         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3955         16  CM-INSURED-SEX                PIC X.
  3956             88  CM-SEX-MALE                  VALUE 'M'.
  3957             88  CM-SEX-FEMAL                 VALUE 'F'.
  3958         16  CM-INSURED-JOINT-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  73
* EL131.cbl
  3959         16  CM-JOINT-INSURED-NAME.
  3960             20  CM-JT-LAST-NAME           PIC X(15).
  3961             20  CM-JT-FIRST-NAME.
  3962                 24  CM-JT-1ST-INIT        PIC X.
  3963                 24  FILLER                PIC X(9).
  3964             20  CM-JT-INITIAL             PIC X.
  3965
  3966     12  CM-LIFE-DATA.
  3967         16  CM-LF-BENEFIT-CD              PIC XX.
  3968         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3969         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3970         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3971         16  CM-LF-DEV-CODE                PIC XXX.
  3972         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3973         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3974         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3975         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3976         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3977         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3978         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3979         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3980         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3981         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3982         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3983         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3984         16  cm-temp-epiq                  pic xx.
  3985             88  EPIQ-CLASS                  value 'EQ'.
  3986*        16  FILLER                        PIC XX.
  3987
  3988     12  CM-AH-DATA.
  3989         16  CM-AH-BENEFIT-CD              PIC XX.
  3990         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3991         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3992         16  CM-AH-DEV-CODE                PIC XXX.
  3993         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3994         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3995         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3996         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3997         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3998         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3999         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4000         16  CM-AH-PAID-THRU-DT            PIC XX.
  4001             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4002         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4003         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4004         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4005         16  FILLER                        PIC X.
  4006
  4007     12  CM-LOAN-INFORMATION.
  4008         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4009         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4010                                           PIC S9(5)V99  COMP-3.
  4011         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4012         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4013         16  CM-PAY-FREQUENCY              PIC S99.
  4014         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4015         16  CM-RATE-CLASS                 PIC XX.
  4016         16  CM-BENEFICIARY                PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  74
* EL131.cbl
  4017         16  CM-POLICY-FORM-NO             PIC X(12).
  4018         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4019         16  CM-LAST-ADD-ON-DT             PIC XX.
  4020         16  CM-DEDUCTIBLE-AMOUNTS.
  4021             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4022             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4023         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4024             20  CM-RESIDENT-STATE         PIC XX.
  4025             20  CM-RATE-CODE              PIC X(4).
  4026             20  FILLER                    PIC XX.
  4027         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4028             20  CM-LOAN-OFFICER           PIC X(5).
  4029             20  FILLER                    PIC XXX.
  4030         16  CM-CSR-CODE                   PIC XXX.
  4031         16  CM-UNDERWRITING-CODE          PIC X.
  4032             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4033         16  CM-POST-CARD-IND              PIC X.
  4034         16  CM-NH-INTERFACE-SW            PIC X.
  4035         16  CM-PREMIUM-TYPE               PIC X.
  4036             88  CM-SING-PRM                  VALUE '1'.
  4037             88  CM-O-B-COVERAGE              VALUE '2'.
  4038             88  CM-OPEN-END                  VALUE '3'.
  4039         16  CM-IND-GRP-TYPE               PIC X.
  4040             88  CM-INDIVIDUAL                VALUE 'I'.
  4041             88  CM-GROUP                     VALUE 'G'.
  4042         16  CM-SKIP-CODE                  PIC X.
  4043             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4044             88  SKIP-JULY                    VALUE '1'.
  4045             88  SKIP-AUGUST                  VALUE '2'.
  4046             88  SKIP-SEPTEMBER               VALUE '3'.
  4047             88  SKIP-JULY-AUG                VALUE '4'.
  4048             88  SKIP-AUG-SEPT                VALUE '5'.
  4049             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4050             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4051             88  SKIP-JUNE                    VALUE '8'.
  4052             88  SKIP-JUNE-JULY               VALUE '9'.
  4053             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4054             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4055         16  CM-PAYMENT-MODE               PIC X.
  4056             88  PAY-MONTHLY                  VALUE SPACE.
  4057             88  PAY-WEEKLY                   VALUE '1'.
  4058             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4059             88  PAY-BI-WEEKLY                VALUE '3'.
  4060             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4061         16  CM-LOAN-NUMBER                PIC X(8).
  4062         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4063         16  CM-OLD-LOF                    PIC XXX.
  4064*        16  CM-LOAN-OFFICER               PIC XXX.
  4065         16  CM-REIN-TABLE                 PIC XXX.
  4066         16  CM-SPECIAL-REIN-CODE          PIC X.
  4067         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4068         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4069         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4070
  4071     12  CM-STATUS-DATA.
  4072         16  CM-ENTRY-STATUS               PIC X.
  4073         16  CM-ENTRY-DT                   PIC XX.
  4074
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  75
* EL131.cbl
  4075         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4076         16  CM-LF-CANCEL-DT               PIC XX.
  4077         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4078
  4079         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4080         16  CM-LF-DEATH-DT                PIC XX.
  4081         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4082
  4083         16  CM-LF-CURRENT-STATUS          PIC X.
  4084             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4085                                                'M' '4' '5' '9'.
  4086             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4087             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4088             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4089             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4090             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4091             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4092             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4093             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4094             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4095             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4096             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4097             88  CM-LF-DECLINED               VALUE 'D'.
  4098             88  CM-LF-VOIDED                 VALUE 'V'.
  4099
  4100         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4101         16  CM-AH-CANCEL-DT               PIC XX.
  4102         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4103
  4104         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4105         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4106         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4107
  4108         16  CM-AH-CURRENT-STATUS          PIC X.
  4109             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4110                                                'M' '4' '5' '9'.
  4111             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4112             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4113             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4114             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4115             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4116             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4117             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4118             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4119             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4120             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4121             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4122             88  CM-AH-DECLINED               VALUE 'D'.
  4123             88  CM-AH-VOIDED                 VALUE 'V'.
  4124
  4125         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4126             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4127             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4128             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4129         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4130
  4131         16  CM-ENTRY-BATCH                PIC X(6).
  4132         16  CM-LF-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  76
* EL131.cbl
  4133         16  CM-AH-EXIT-BATCH              PIC X(6).
  4134         16  CM-LAST-MONTH-END             PIC XX.
  4135
  4136     12  CM-NOTE-SW                        PIC X.
  4137         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4138         88  CERT-NOTES-PRESENT               VALUE '1'.
  4139         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4140         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4141         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4142         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4143         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4144         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4145     12  CM-COMP-EXCP-SW                   PIC X.
  4146         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4147         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4148     12  CM-INSURED-ADDRESS-SW             PIC X.
  4149         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4150         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4151
  4152*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4153     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4154     12  FILLER                            PIC X.
  4155
  4156*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4157     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4158     12  FILLER                            PIC X.
  4159*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4160     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4161
  4162     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4163         88  CERT-ADDED-BATCH                 VALUE ' '.
  4164         88  CERT-ADDED-ONLINE                VALUE '1'.
  4165         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4166         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4167         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4168     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4169         88  CERT-AS-LOADED                   VALUE ' '.
  4170         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4171         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4172         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4173         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4174         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4175         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4176         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4177
  4178     12  CM-ACCOUNT-COMM-PCTS.
  4179         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4180         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4181
  4182     12  CM-USER-FIELD                     PIC X.
  4183     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4184     12  CM-CLP-STATE                      PIC XX.
  4185     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4186     12  CM-USER-RESERVED                  PIC XXX.
  4187     12  FILLER REDEFINES CM-USER-RESERVED.
  4188         16  CM-AH-CLASS-CD                PIC XX.
  4189         16  F                             PIC X.
  4190******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  77
* EL131.cbl
  4191
  4192*                                COPY ELCTRLR.
  4193******************************************************************
  4194*                                                                *
  4195*                            ELCTRLR.                            *
  4196*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4197*                            VMOD=2.014                          *
  4198*                                                                *
  4199*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4200*                                                                *
  4201*   FILE TYPE = VSAM,KSDS                                        *
  4202*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4203*                                                                *
  4204*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4205*       ALTERNATE INDEX = NONE                                   *
  4206*                                                                *
  4207*   LOG = YES                                                    *
  4208*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4209******************************************************************
  4210*                   C H A N G E   L O G
  4211*
  4212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4213*-----------------------------------------------------------------
  4214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4215* EFFECTIVE    NUMBER
  4216*-----------------------------------------------------------------
  4217* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4218* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4219* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4220* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4221* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4222* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4223* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4224* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4225* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4226* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4227* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4228* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4229* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4230* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4231* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4232* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4233* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4234* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4235* 040814    2014030500002  AJRA  ADD ICD CODES
  4236* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4237******************************************************************
  4238 01  ACTIVITY-TRAILERS.
  4239     12  AT-RECORD-ID                    PIC XX.
  4240         88  VALID-AT-ID                       VALUE 'AT'.
  4241
  4242     12  AT-CONTROL-PRIMARY.
  4243         16  AT-COMPANY-CD               PIC X.
  4244         16  AT-CARRIER                  PIC X.
  4245         16  AT-CLAIM-NO                 PIC X(7).
  4246         16  AT-CERT-NO.
  4247             20  AT-CERT-PRIME           PIC X(10).
  4248             20  AT-CERT-SFX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  78
* EL131.cbl
  4249         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4250             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4251             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4252             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4253             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4254             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4255             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4256             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4257             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4258             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4259             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4260             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4261             88  AT-BENEFICIARY-TRL           VALUE +91.
  4262             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4263             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4264             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4265             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4266
  4267     12  AT-TRAILER-TYPE                 PIC X.
  4268         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4269         88  PAYMENT-TR                       VALUE '2'.
  4270         88  AUTO-PAY-TR                      VALUE '3'.
  4271         88  CORRESPONDENCE-TR                VALUE '4'.
  4272         88  ADDRESS-TR                       VALUE '5'.
  4273         88  GENERAL-INFO-TR                  VALUE '6'.
  4274         88  AUTO-PROMPT-TR                   VALUE '7'.
  4275         88  DENIAL-TR                        VALUE '8'.
  4276         88  INCURRED-CHG-TR                  VALUE '9'.
  4277         88  FORM-CONTROL-TR                  VALUE 'A'.
  4278
  4279     12  AT-RECORDED-DT                  PIC XX.
  4280     12  AT-RECORDED-BY                  PIC X(4).
  4281     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4282
  4283     12  AT-TRAILER-BODY                 PIC X(165).
  4284
  4285     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4286         16  AT-RESERVE-CONTROLS.
  4287             20  AT-MANUAL-SW            PIC X.
  4288                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4289             20  AT-FUTURE-SW            PIC X.
  4290                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4291             20  AT-PTC-SW               PIC X.
  4292                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4293             20  AT-IBNR-SW              PIC X.
  4294                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4295             20  AT-PTC-LF-SW            PIC X.
  4296                 88  AT-LF-PTC-USED          VALUE '1'.
  4297             20  AT-CDT-ACCESS-METHOD    PIC X.
  4298                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4299                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4300                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4301             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4302         16  AT-LAST-COMPUTED-DT         PIC XX.
  4303         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4304         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4305         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4306         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  79
* EL131.cbl
  4307         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4308         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4309         16  AT-EXPENSE-CONTROLS.
  4310             20  AT-EXPENSE-METHOD       PIC X.
  4311                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4312                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4313                 88  PERCENT-OF-PMT           VALUE '3'.
  4314                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4315             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4316             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4317         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4318         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4319
  4320         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4321         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4322
  4323*        16  FILLER                      PIC X(53).
  4324         16  FILLER                      PIC X(47).
  4325
  4326         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4327         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4328
  4329         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4330             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4331             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4332*                    C = CLOSED
  4333*                    O = OPEN
  4334             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4335*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4336
  4337     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4338         16  AT-PAYMENT-TYPE             PIC X.
  4339             88  PARTIAL-PAYMENT                VALUE '1'.
  4340             88  FINAL-PAYMENT                  VALUE '2'.
  4341             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4342             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4343             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4344             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4345             88  VOIDED-PAYMENT                 VALUE '9'.
  4346             88  TRANSFER                       VALUE 'T'.
  4347             88  LIFE-INTEREST                  VALUE 'I'.
  4348
  4349         16  AT-CLAIM-TYPE               PIC X.
  4350             88  PAID-FOR-AH                    VALUE 'A'.
  4351             88  PAID-FOR-LIFE                  VALUE 'L'.
  4352             88  PAID-FOR-IUI                   VALUE 'I'.
  4353             88  PAID-FOR-GAP                   VALUE 'G'.
  4354             88  PAID-FOR-FAM                   VALUE 'F'.
  4355         16  AT-CLAIM-PREM-TYPE          PIC X.
  4356             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4357             88  AT-O-B-COVERAGE                VALUE '2'.
  4358             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4359         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4360         16  AT-CHECK-NO                 PIC X(7).
  4361         16  AT-PAID-FROM-DT             PIC XX.
  4362         16  AT-PAID-THRU-DT             PIC XX.
  4363         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4364         16  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  80
* EL131.cbl
  4365         16  AT-PAYEES-NAME              PIC X(30).
  4366         16  AT-PAYMENT-ORIGIN           PIC X.
  4367             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4368             88  ONLINE-AUTO-PMT                VALUE '2'.
  4369             88  OFFLINE-PMT                    VALUE '3'.
  4370         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4371         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4372         16  AT-VOID-DATA.
  4373             20  AT-VOID-DT              PIC XX.
  4374*00144       20  AT-VOID-REASON          PIC X(30).
  4375             20  AT-VOID-REASON          PIC X(26).
  4376         16  AT-PMT-APPROVED-BY          PIC X(04).
  4377         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4378         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4379         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4380                                         PIC S99V9(5)  COMP-3.
  4381         16  AT-CREDIT-INTERFACE.
  4382             20  AT-PMT-SELECT-DT        PIC XX.
  4383                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4384             20  AT-PMT-ACCEPT-DT        PIC XX.
  4385                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4386             20  AT-VOID-SELECT-DT       PIC XX.
  4387                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4388             20  AT-VOID-ACCEPT-DT       PIC XX.
  4389                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4390
  4391         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4392                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4393                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4394         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4395
  4396         16  AT-FORCE-CONTROL            PIC X.
  4397             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4398         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4399         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4400         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4401         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4402         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4403         16  AT-BENEFIT-TYPE             PIC X.
  4404
  4405         16  AT-EXPENSE-TYPE             PIC X.
  4406         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4407
  4408         16  AT-PAYEE-TYPE-CD.
  4409             20  AT-PAYEE-TYPE           PIC X.
  4410                 88  INSURED-PAID           VALUE 'I'.
  4411                 88  BENEFICIARY-PAID       VALUE 'B'.
  4412                 88  ACCOUNT-PAID           VALUE 'A'.
  4413                 88  OTHER-1-PAID           VALUE 'O'.
  4414                 88  OTHER-2-PAID           VALUE 'Q'.
  4415                 88  DOCTOR-PAID            VALUE 'P'.
  4416                 88  EMPLOYER-PAID          VALUE 'E'.
  4417             20  AT-PAYEE-SEQ            PIC X.
  4418
  4419         16  AT-CASH-PAYMENT             PIC X.
  4420         16  AT-GROUPED-PAYMENT          PIC X.
  4421         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4422         16  AT-APPROVAL-LEVEL-REQD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  81
* EL131.cbl
  4423         16  AT-APPROVED-LEVEL           PIC X.
  4424         16  AT-VOID-TYPE                PIC X.
  4425             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4426             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4427         16  AT-AIG-UNEMP-IND            PIC X.
  4428             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4429         16  AT-ASSOCIATES               PIC X.
  4430             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4431             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4432
  4433         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4434         16  AT-CV-PMT-CODE              PIC X.
  4435             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4436             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4437             88  FULL-ADD-PAYMENT           VALUE '3'.
  4438             88  HALF-ADD-PAYMENT           VALUE '4'.
  4439             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4440             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4441             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4442             88  ADDL-PAYMENT               VALUE '8'.
  4443
  4444         16  AT-EOB-CODE1                PIC XXX.
  4445         16  AT-EOB-CODE2                PIC XXX.
  4446         16  AT-EOB-CODE3                PIC XXX.
  4447         16  FILLER REDEFINES AT-EOB-CODE3.
  4448             20  AT-PRINT-CLM-FORM       PIC X.
  4449             20  AT-PRINT-SURVEY         PIC X.
  4450             20  AT-SPECIAL-RELEASE      PIC X.
  4451         16  AT-EOB-CODE4                PIC XXX.
  4452         16  FILLER REDEFINES AT-EOB-CODE4.
  4453             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4454             20  FILLER                  PIC X.
  4455         16  AT-EOB-CODE5                PIC XXX.
  4456         16  FILLER REDEFINES AT-EOB-CODE5.
  4457             20  AT-PMT-PROOF-DT         PIC XX.
  4458             20  FILLER                  PIC X.
  4459
  4460         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4461             88  AT-PRINT-EOB            VALUE 'Y'.
  4462
  4463         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4464         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4465
  4466     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4467         16  AT-SCHEDULE-START-DT        PIC XX.
  4468         16  AT-SCHEDULE-END-DT          PIC XX.
  4469         16  AT-TERMINATED-DT            PIC XX.
  4470         16  AT-LAST-PMT-TYPE            PIC X.
  4471             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4472             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4473         16  AT-FIRST-PMT-DATA.
  4474             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4475             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4476             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4477         16  AT-REGULAR-PMT-DATA.
  4478             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4479             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4480             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  82
* EL131.cbl
  4481         16  AT-AUTO-PAYEE-CD.
  4482             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4483                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4484                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4485                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4486                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4487                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4488             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4489         16  AT-AUTO-PAY-DAY             PIC 99.
  4490         16  AT-AUTO-CASH                PIC X.
  4491             88  AT-CASH                      VALUE 'Y'.
  4492             88  AT-NON-CASH                  VALUE 'N'.
  4493*        16  FILLER                      PIC X(129).
  4494         16  AT-AUTO-END-LETTER          PIC X(4).
  4495         16  FILLER                      PIC X(125).
  4496
  4497         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4498         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4499
  4500     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4501         16  AT-LETTER-SENT-DT           PIC XX.
  4502         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4503         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4504         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4505         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4506         16  AT-LETTER-ORIGIN            PIC X.
  4507             88  ONLINE-CREATION              VALUE '1' '3'.
  4508             88  OFFLINE-CREATION             VALUE '2' '4'.
  4509             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4510             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4511         16  AT-STD-LETTER-FORM          PIC X(4).
  4512         16  AT-REASON-TEXT              PIC X(70).
  4513         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4514         16  AT-ADDRESEE-TYPE            PIC X.
  4515              88  INSURED-ADDRESEE            VALUE 'I'.
  4516              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4517              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4518              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4519              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4520              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4521              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4522         16  AT-ADDRESSEE-NAME           PIC X(30).
  4523         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4524         16  AT-RESEND-PRINT-DATE        PIC XX.
  4525         16  AT-CORR-SOL-UNSOL           PIC X.
  4526         16  AT-LETTER-PURGED-DT         PIC XX.
  4527*
  4528*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4529*
  4530         16  AT-CSO-REDEFINITION.
  4531             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4532             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4533             20  AT-LETTER-TO-BENE       PIC X(1).
  4534             20  AT-STOP-LETTER-DT       PIC X(2).
  4535             20  FILLER                  PIC X(19).
  4536*             20  FILLER                  PIC X(27).
  4537             20  AT-CSO-LETTER-STATUS    PIC X.
  4538                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  83
* EL131.cbl
  4539                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4540                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4541             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4542             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4543*
  4544*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4545*
  4546*        16  FILLER                      PIC X(26).
  4547*
  4548*        16  AT-DMD-BSR-CODE             PIC X.
  4549*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4550*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4551*
  4552*        16  AT-DMD-LETTER-STATUS        PIC X.
  4553*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4554*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4555*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4556*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4557*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4558
  4559         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4560         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4561
  4562     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4563         16  AT-ADDRESS-TYPE             PIC X.
  4564             88  INSURED-ADDRESS               VALUE 'I'.
  4565             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4566             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4567             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4568             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4569             88  OTHER-ADDRESS-1               VALUE 'O'.
  4570             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4571         16  AT-MAIL-TO-NAME             PIC X(30).
  4572         16  AT-ADDRESS-LINE-1           PIC X(30).
  4573         16  AT-ADDRESS-LINE-2           PIC X(30).
  4574         16  AT-CITY-STATE.
  4575             20  AT-CITY                 PIC X(28).
  4576             20  AT-STATE                PIC XX.
  4577         16  AT-ZIP.
  4578             20  AT-ZIP-CODE.
  4579                 24  AT-ZIP-1ST          PIC X.
  4580                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4581                 24  FILLER              PIC X(4).
  4582             20  AT-ZIP-PLUS4            PIC X(4).
  4583         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4584             20  AT-CAN-POSTAL-1         PIC XXX.
  4585             20  AT-CAN-POSTAL-2         PIC XXX.
  4586             20  FILLER                  PIC XXX.
  4587         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4588*         16  FILLER                      PIC X(23).
  4589         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4590         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4591         16  FILLER                      PIC X(13).
  4592         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4593         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4594
  4595     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4596         16  AT-INFO-LINE-1              PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  84
* EL131.cbl
  4597         16  FILLER REDEFINES AT-INFO-LINE-1.
  4598             20  AT-NOTE-ERROR-NO OCCURS 15
  4599                                         PIC X(4).
  4600         16  AT-INFO-LINE-2              PIC X(60).
  4601         16  FILLER REDEFINES AT-INFO-LINE-2.
  4602             20  AT-ICD-CODE-1           PIC X(8).
  4603             20  AT-ICD-CODE-2           PIC X(8).
  4604             20  FILLER                  PIC X(44).
  4605         16  AT-INFO-TRAILER-TYPE        PIC X.
  4606             88  AT-ERRORS-NOTE          VALUE 'E'.
  4607             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4608             88  AT-CALL-NOTE            VALUE 'C'.
  4609             88  AT-MAINT-NOTE           VALUE 'M'.
  4610             88  AT-CERT-CHANGE          VALUE 'X'.
  4611             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4612             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4613             88  AT-CERT-CANCELLED       VALUE 'T'.
  4614         16  AT-CALL-TYPE                PIC X.
  4615             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4616             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4617         16  AT-NOTE-CONTINUATION        PIC X.
  4618             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4619         16  AT-EOB-CODES-EXIST          PIC X.
  4620             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4621         16  FILLER                      PIC X(35).
  4622         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4623         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4624
  4625     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4626         16  AT-PROMPT-LINE-1            PIC X(60).
  4627         16  AT-PROMPT-LINE-2            PIC X(60).
  4628         16  AT-PROMPT-START-DT          PIC XX.
  4629         16  AT-PROMPT-END-DT            PIC XX.
  4630         16  FILLER                      PIC X(35).
  4631         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4632         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4633
  4634     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4635         16  AT-DENIAL-INFO-1            PIC X(60).
  4636         16  AT-DENIAL-INFO-2            PIC X(60).
  4637         16  AT-DENIAL-DT                PIC XX.
  4638         16  AT-RETRACTION-DT            PIC XX.
  4639         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4640*         16  FILLER                      PIC X(31).
  4641         16  AT-DENIAL-PROOF-DT          PIC XX.
  4642         16  FILLER                      PIC X(29).
  4643         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4644         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4645
  4646     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4647         16  AT-OLD-INCURRED-DT          PIC XX.
  4648         16  AT-OLD-REPORTED-DT          PIC XX.
  4649         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4650         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4651         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4652         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4653         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4654         16  AT-LAST-PMT-MADE-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  85
* EL131.cbl
  4655         16  FILLER                      PIC X(26).
  4656         16  AT-OLD-DIAG-CODE            PIC X(6).
  4657         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4658         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4659         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4660         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4661         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4662         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4663         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4664         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4665         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4666         16  FILLER                      PIC X(9).
  4667         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4668
  4669     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4670         16  AT-FORM-SEND-ON-DT          PIC XX.
  4671         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4672         16  AT-FORM-RE-SEND-DT          PIC XX.
  4673         16  AT-FORM-ANSWERED-DT         PIC XX.
  4674         16  AT-FORM-PRINTED-DT          PIC XX.
  4675         16  AT-FORM-REPRINT-DT          PIC XX.
  4676         16  AT-FORM-TYPE                PIC X.
  4677             88  INITIAL-FORM                  VALUE '1'.
  4678             88  PROGRESS-FORM                 VALUE '2'.
  4679         16  AT-INSTRUCT-LN-1            PIC X(28).
  4680         16  AT-INSTRUCT-LN-2            PIC X(28).
  4681         16  AT-INSTRUCT-LN-3            PIC X(28).
  4682         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4683         16  AT-FORM-ADDRESS             PIC X.
  4684             88  FORM-TO-INSURED              VALUE 'I'.
  4685             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4686             88  FORM-TO-OTHER-1              VALUE 'O'.
  4687             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4688         16  AT-RELATED-1.
  4689             20 AT-REL-CARR-1            PIC X.
  4690             20 AT-REL-CLAIM-1           PIC X(7).
  4691             20 AT-REL-CERT-1            PIC X(11).
  4692         16  AT-RELATED-2.
  4693             20 AT-REL-CARR-2            PIC X.
  4694             20 AT-REL-CLAIM-2           PIC X(7).
  4695             20 AT-REL-CERT-2            PIC X(11).
  4696         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4697         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4698         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4699         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4700         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4701         16  AT-STOP-FORM-DT             PIC X(2).
  4702
  4703         16  FILLER                      PIC X(09).
  4704         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4705         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4706******************************************************************
  4707
  4708*                                COPY ELCCNTL.
  4709******************************************************************
  4710*                                                                *
  4711*                                                                *
  4712*                            ELCCNTL.                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  86
* EL131.cbl
  4713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4714*                            VMOD=2.059                          *
  4715*                                                                *
  4716*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4717*                                                                *
  4718*   FILE TYPE = VSAM,KSDS                                        *
  4719*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4720*                                                                *
  4721*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4722*       ALTERNATE INDEX = NONE                                   *
  4723*                                                                *
  4724*   LOG = YES                                                    *
  4725*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4726******************************************************************
  4727*                   C H A N G E   L O G
  4728*
  4729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4730*-----------------------------------------------------------------
  4731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4732* EFFECTIVE    NUMBER
  4733*-----------------------------------------------------------------
  4734* 082503                   PEMA  ADD BENEFIT GROUP
  4735* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4736* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4737* 092705    2005050300006  PEMA  ADD SPP LEASES
  4738* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4739* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4740* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4741* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4742* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4743* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4744* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4745* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4746* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4747* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4748******************************************************************
  4749*
  4750 01  CONTROL-FILE.
  4751     12  CF-RECORD-ID                       PIC XX.
  4752         88  VALID-CF-ID                        VALUE 'CF'.
  4753
  4754     12  CF-CONTROL-PRIMARY.
  4755         16  CF-COMPANY-ID                  PIC XXX.
  4756         16  CF-RECORD-TYPE                 PIC X.
  4757             88  CF-COMPANY-MASTER              VALUE '1'.
  4758             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4759             88  CF-STATE-MASTER                VALUE '3'.
  4760             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4761             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4762             88  CF-CARRIER-MASTER              VALUE '6'.
  4763             88  CF-MORTALITY-MASTER            VALUE '7'.
  4764             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4765             88  CF-TERMINAL-MASTER             VALUE '9'.
  4766             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4767             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4768             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4769             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4770             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  87
* EL131.cbl
  4771             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4772             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4773             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4774             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4775         16  CF-ACCESS-CD-GENL              PIC X(4).
  4776         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4777             20  CF-PROCESSOR               PIC X(4).
  4778         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4779             20  CF-STATE-CODE              PIC XX.
  4780             20  FILLER                     PIC XX.
  4781         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4782             20  FILLER                     PIC XX.
  4783             20  CF-HI-BEN-IN-REC           PIC XX.
  4784         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4785             20  FILLER                     PIC XXX.
  4786             20  CF-CARRIER-CNTL            PIC X.
  4787         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4788             20  FILLER                     PIC XX.
  4789             20  CF-HI-TYPE-IN-REC          PIC 99.
  4790         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4791             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4792                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4793             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4794             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4795         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4796             20  FILLER                     PIC X.
  4797             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4798         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4799             20  FILLER                     PIC XX.
  4800             20  CF-MORTGAGE-PLAN           PIC XX.
  4801         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4802
  4803     12  CF-LAST-MAINT-DT                   PIC XX.
  4804     12  CF-LAST-MAINT-BY                   PIC X(4).
  4805     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4806
  4807     12  CF-RECORD-BODY                     PIC X(728).
  4808
  4809
  4810****************************************************************
  4811*             COMPANY MASTER RECORD                            *
  4812****************************************************************
  4813
  4814     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4815         16  CF-COMPANY-ADDRESS.
  4816             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4817             20  CF-CL-IN-CARE-OF           PIC X(30).
  4818             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4819             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4820             20  CF-CL-CITY-STATE           PIC X(30).
  4821             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4822             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4823         16  CF-COMPANY-CD                  PIC X.
  4824         16  CF-COMPANY-PASSWORD            PIC X(8).
  4825         16  CF-SECURITY-OPTION             PIC X.
  4826             88  ALL-SECURITY                   VALUE '1'.
  4827             88  COMPANY-VERIFY                 VALUE '2'.
  4828             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  88
* EL131.cbl
  4829             88  NO-SECURITY                    VALUE '4'.
  4830             88  ALL-BUT-TERM                   VALUE '5'.
  4831         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4832             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4833         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4834             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4835         16  CF-INFORCE-LOCATION            PIC X.
  4836             88  CERTS-ARE-ONLINE               VALUE '1'.
  4837             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4838             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4839         16  CF-LOWER-CASE-LETTERS          PIC X.
  4840         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4841             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4842             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4843             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4844             88  CF-ACCNT-CNTL                  VALUE '3'.
  4845             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4846
  4847         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4848         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4849
  4850         16  CF-LGX-CREDIT-USER             PIC X.
  4851             88  CO-IS-NOT-USER                 VALUE 'N'.
  4852             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4853
  4854         16 CF-CREDIT-CALC-CODES.
  4855             20  CF-CR-REM-TERM-CALC PIC X.
  4856               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4857               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4858               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4859               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4860               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4861               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4862               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4863             20  CF-CR-R78-METHOD           PIC X.
  4864               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4865               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4866
  4867         16  CF-CLAIM-CONTROL-COUNTS.
  4868             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4869                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4870
  4871             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4872                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4873
  4874             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4875                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4876
  4877             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4878                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4879
  4880         16  CF-CURRENT-MONTH-END           PIC XX.
  4881
  4882         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4883             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4884             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4885             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4886             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  89
* EL131.cbl
  4887                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4888                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4889             20  CF-CO-PREM-REJECT-SW       PIC X.
  4890                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4891                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4892             20  CF-CO-REF-REJECT-SW        PIC X.
  4893                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4894                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4895
  4896         16  CF-CO-REPORTING-DT             PIC XX.
  4897         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4898         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4899           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4900           88  CF-CO-MONTH-END                  VALUE '1'.
  4901
  4902         16  CF-LGX-CLAIM-USER              PIC X.
  4903             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4904             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4905
  4906         16  CF-CREDIT-EDIT-CONTROLS.
  4907             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4908             20  CF-MIN-AGE                 PIC 99.
  4909             20  CF-DEFAULT-AGE             PIC 99.
  4910             20  CF-MIN-TERM                PIC S999      COMP-3.
  4911             20  CF-MAX-TERM                PIC S999      COMP-3.
  4912             20  CF-DEFAULT-SEX             PIC X.
  4913             20  CF-JOINT-AGE-INPUT         PIC X.
  4914                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4915             20  CF-BIRTH-DATE-INPUT        PIC X.
  4916                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4917             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4918                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4919                 88  CF-ZERO-CARRIER            VALUE '1'.
  4920                 88  CF-ZERO-GROUPING           VALUE '2'.
  4921                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4922             20  CF-EDIT-SW                 PIC X.
  4923                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4924             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4925             20  CF-CR-PR-METHOD            PIC X.
  4926               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4927               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4928             20  FILLER                     PIC X.
  4929
  4930         16  CF-CREDIT-MISC-CONTROLS.
  4931             20  CF-REIN-TABLE-SW           PIC X.
  4932                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4933             20  CF-COMP-TABLE-SW           PIC X.
  4934                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4935             20  CF-EXPERIENCE-RETENTION-AGE
  4936                                            PIC S9        COMP-3.
  4937             20  CF-CONVERSION-DT           PIC XX.
  4938             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4939             20  CF-RUN-FREQUENCY-SW        PIC X.
  4940                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4941                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4942
  4943             20  CF-CR-CHECK-NO-CONTROL.
  4944                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  90
* EL131.cbl
  4945                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4946                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4947                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4948                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4949                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4950
  4951                 24  CF-CR-CHECK-COUNT       REDEFINES
  4952                     CF-CR-CHECK-COUNTER      PIC X(4).
  4953
  4954                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4955                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4956
  4957                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4958                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4959                 24  CF-MAIL-PROCESSING       PIC X.
  4960                     88  MAIL-PROCESSING          VALUE 'Y'.
  4961
  4962         16  CF-MISC-SYSTEM-CONTROL.
  4963             20  CF-SYSTEM-C                 PIC X.
  4964                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4965             20  CF-SYSTEM-D                 PIC X.
  4966                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4967             20  CF-SOC-SEC-NO-SW            PIC X.
  4968                 88  SOC-SEC-NO-USED             VALUE '1'.
  4969             20  CF-MEMBER-NO-SW             PIC X.
  4970                 88  MEMBER-NO-USED              VALUE '1'.
  4971             20  CF-TAX-ID-NUMBER            PIC X(11).
  4972             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4973             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4974                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4975                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4976                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4977                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4978             20  CF-SYSTEM-E                 PIC X.
  4979                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4980
  4981         16  CF-LGX-LIFE-USER               PIC X.
  4982             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4983             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4984
  4985         16  CF-CR-MONTH-END-DT             PIC XX.
  4986
  4987         16  CF-FILE-MAINT-DATES.
  4988             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4989                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4990             20  CF-LAST-BATCH       REDEFINES
  4991                 CF-LAST-BATCH-NO               PIC X(4).
  4992             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4993             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4994             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4995             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4996             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4997             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4998             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4999             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5000             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5001             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5002
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  91
* EL131.cbl
  5003         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5004         16  FILLER                         PIC X.
  5005
  5006         16  CF-ALT-MORT-CODE               PIC X(4).
  5007         16  CF-MEMBER-CAPTION              PIC X(10).
  5008
  5009         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5010             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5011             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5012             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5013             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5014             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5015
  5016         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5017
  5018         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5019         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5020         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5021         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5022
  5023         16  CF-AH-OVERRIDE-L1              PIC X.
  5024         16  CF-AH-OVERRIDE-L2              PIC XX.
  5025         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5026         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5027
  5028         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5029         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5030
  5031         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5032         16  CF-AR-LAST-EL860-DT            PIC XX.
  5033         16  CF-MP-MONTH-END-DT             PIC XX.
  5034
  5035         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5036         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5037             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5038
  5039         16  CF-AR-MONTH-END-DT             PIC XX.
  5040
  5041         16  CF-CRDTCRD-USER                PIC X.
  5042             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5043             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5044
  5045         16  CF-CC-MONTH-END-DT             PIC XX.
  5046
  5047         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5048
  5049         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5050             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5051             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5052             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5053         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5054         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5055         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5056         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5057             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5058             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5059         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5060         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  92
* EL131.cbl
  5061         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5062             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5063         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5064
  5065         16  CF-CL-ZIP-CODE.
  5066             20  CF-CL-ZIP-PRIME.
  5067                 24  CF-CL-ZIP-1ST          PIC X.
  5068                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5069                 24  FILLER                 PIC X(4).
  5070             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5071         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5072             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5073             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5074             20  FILLER                     PIC XXX.
  5075
  5076         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5077         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5078         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5079         16  CF-CO-OPTION-START-DATE        PIC XX.
  5080         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5081           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5082                                                      '3' '4'.
  5083           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5084           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5085           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5086           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5087           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5088           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5089
  5090         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5091
  5092         16  CF-PAYMENT-APPROVAL-LEVELS.
  5093             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5094             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5095             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5096             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5097             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5098             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5099
  5100         16  CF-END-USER-REPORTING-USER     PIC X.
  5101             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5102             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5103
  5104         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5105             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5106             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5107
  5108         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5109
  5110         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5111         16  FILLER                         PIC X.
  5112
  5113         16  CF-CREDIT-ARCHIVE-CNTL.
  5114             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5115             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5116             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5117
  5118         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  93
* EL131.cbl
  5119
  5120         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5121             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5122             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5123
  5124         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5125             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5126             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5127
  5128         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5129
  5130         16  CF-CO-ACH-ID-CODE              PIC  X.
  5131             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5132             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5133             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5134         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5135         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5136         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5137         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5138         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5139         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5140         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5141         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5142         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5143                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5144         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5145                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5146
  5147         16  CF-CO-OVER-SHORT.
  5148             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5149             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5150
  5151*         16  FILLER                         PIC X(102).
  5152         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5153             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5154             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5155
  5156         16  CF-AH-APPROVAL-DAYS.
  5157             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5158             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5159             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5160             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5161
  5162         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5163
  5164         16  CF-APPROV-LEV-5.
  5165             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5166             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5167             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5168
  5169         16  FILLER                         PIC X(68).
  5170****************************************************************
  5171*             PROCESSOR/USER RECORD                            *
  5172****************************************************************
  5173
  5174     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5175         16  CF-PROCESSOR-NAME              PIC X(30).
  5176         16  CF-PROCESSOR-PASSWORD          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  94
* EL131.cbl
  5177         16  CF-PROCESSOR-TITLE             PIC X(26).
  5178         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5179                 88  MESSAGE-YES                VALUE 'Y'.
  5180                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5181
  5182*****************************************************
  5183****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5184****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5185****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5186****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5187*****************************************************
  5188
  5189         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5190             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5191             20  CF-APPLICATION-FORCE       PIC X.
  5192             20  CF-INDIVIDUAL-APP.
  5193                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5194                     28  CF-BROWSE-APP      PIC X.
  5195                     28  CF-UPDATE-APP      PIC X.
  5196
  5197         16  CF-CURRENT-TERM-ON             PIC X(4).
  5198         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5199             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5200             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5201             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5202             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5203             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5204             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5205             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5206         16  CF-PROCESSOR-CARRIER           PIC X.
  5207             88  NO-CARRIER-SECURITY            VALUE ' '.
  5208         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5209             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5210         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5211             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5212         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5213             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5214
  5215         16  CF-PROC-SYS-ACCESS-SW.
  5216             20  CF-PROC-CREDIT-CLAIMS-SW.
  5217                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5218                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5219                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5220                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5221             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5222                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5223                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5224             20  CF-PROC-LIFE-GNRLDGR-SW.
  5225                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5226                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5227                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5228                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5229             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5230                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5231                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5232         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5233             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5234             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  95
* EL131.cbl
  5235         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5236
  5237         16  CF-APPROVAL-LEVEL                  PIC X.
  5238             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5239             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5240             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5241             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5242             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5243
  5244         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5245
  5246         16  CF-LANGUAGE-TYPE                   PIC X.
  5247             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5248             88  CF-LANG-IS-FR                      VALUE 'F'.
  5249
  5250         16  CF-CSR-IND                         PIC X.
  5251         16  FILLER                             PIC X(239).
  5252
  5253****************************************************************
  5254*             PROCESSOR/REMINDERS RECORD                       *
  5255****************************************************************
  5256
  5257     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5258         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5259             20  CF-START-REMIND-DT         PIC XX.
  5260             20  CF-END-REMIND-DT           PIC XX.
  5261             20  CF-REMINDER-TEXT           PIC X(50).
  5262         16  FILLER                         PIC X(296).
  5263
  5264
  5265****************************************************************
  5266*             STATE MASTER RECORD                              *
  5267****************************************************************
  5268
  5269     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5270         16  CF-STATE-ABBREVIATION          PIC XX.
  5271         16  CF-STATE-NAME                  PIC X(25).
  5272         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5273         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5274             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5275             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5276             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5277             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5278                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5279                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5280             20  CF-ST-PREM-REJECT-SW       PIC X.
  5281                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5282                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5283             20  CF-ST-REF-REJECT-SW        PIC X.
  5284                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5285                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5286         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5287         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5288         16  CF-ST-REFUND-RULES.
  5289             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5290             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5291             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5292         16  CF-ST-FST-PMT-EXTENSION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  96
* EL131.cbl
  5293             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5294             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5295                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5296                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5297                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5298                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5299         16  CF-ST-STATE-CALL.
  5300             20  CF-ST-CALL-UNEARNED        PIC X.
  5301             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5302             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5303         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5304             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5305             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5306         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5307         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5308         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5309         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5310         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5311         16  FILLER                         PIC X.
  5312         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5313             20  CF-ST-BENEFIT-CD           PIC XX.
  5314             20  CF-ST-BENEFIT-KIND         PIC X.
  5315                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5316                 88  CF-ST-AH-KIND              VALUE 'A'.
  5317             20  CF-ST-REM-TERM-CALC        PIC X.
  5318                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5319                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5320                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5321                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5322                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5323                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5324                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5325                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5326
  5327             20  CF-ST-REFUND-CALC          PIC X.
  5328                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5329                 88  ST-REFD-BY-R78             VALUE '1'.
  5330                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5331                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5332                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5333                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5334                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5335                 88  ST-REFD-UTAH               VALUE '7'.
  5336                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5337                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5338                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5339
  5340             20  CF-ST-EARNING-CALC         PIC X.
  5341                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5342                 88  ST-EARN-BY-R78             VALUE '1'.
  5343                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5344                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5345                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5346                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5347                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5348                 88  ST-EARN-MEAN               VALUE '8'.
  5349                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5350
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  97
* EL131.cbl
  5351             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5352                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5353                 88  ST-OVRD-BY-R78             VALUE '1'.
  5354                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5355                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5356                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5357                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5358                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5359                 88  ST-OVRD-MEAN               VALUE '8'.
  5360                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5361             20  cf-st-extra-periods        pic 9.
  5362*            20  FILLER                     PIC X.
  5363
  5364         16  CF-ST-COMMISSION-CAPS.
  5365             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5366             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5367             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5368             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5369         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5370                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5371
  5372         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5373
  5374         16  CF-ST-STATUTORY-INTEREST.
  5375             20  CF-ST-STAT-DATE-FROM       PIC X.
  5376                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5377                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5378             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5379             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5380             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5381             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5382             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5383
  5384         16  CF-ST-OVER-SHORT.
  5385             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5386             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5387
  5388         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5389
  5390         16  CF-ST-RT-CALC                  PIC X.
  5391
  5392         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5393         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5394         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5395         16  CF-ST-RF-LR-CALC               PIC X.
  5396         16  CF-ST-RF-LL-CALC               PIC X.
  5397         16  CF-ST-RF-LN-CALC               PIC X.
  5398         16  CF-ST-RF-AH-CALC               PIC X.
  5399         16  CF-ST-RF-CP-CALC               PIC X.
  5400*        16  FILLER                         PIC X(206).
  5401*CIDMOD         16  FILLER                         PIC X(192).
  5402         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5403             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5404         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5405         16  CF-ST-VFY-2ND-BENE             PIC X.
  5406         16  CF-ST-CAUSAL-STATE             PIC X.
  5407         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5408         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  98
* EL131.cbl
  5409         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5410             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5411         16  CF-ST-NET-ONLY-STATE           PIC X.
  5412             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5413         16  FILLER                         PIC X(181).
  5414
  5415****************************************************************
  5416*             BENEFIT MASTER RECORD                            *
  5417****************************************************************
  5418
  5419     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5420         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5421             20  CF-BENEFIT-CODE            PIC XX.
  5422             20  CF-BENEFIT-NUMERIC  REDEFINES
  5423                 CF-BENEFIT-CODE            PIC XX.
  5424             20  CF-BENEFIT-ALPHA           PIC XXX.
  5425             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5426             20  CF-BENEFIT-COMMENT         PIC X(10).
  5427
  5428             20  CF-LF-COVERAGE-TYPE        PIC X.
  5429                 88  CF-REDUCING                VALUE 'R'.
  5430                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5431
  5432             20  CF-SPECIAL-CALC-CD         PIC X.
  5433                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5434                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5435                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5436                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5437                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5438                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5439                 88  CF-FARM-PLAN               VALUE 'F'.
  5440                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5441                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5442                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5443                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5444                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5445                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5446                 88  CF-PRUDENTIAL              VALUE 'P'.
  5447                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5448                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5449                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5450                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5451                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5452                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5453
  5454             20  CF-JOINT-INDICATOR         PIC X.
  5455                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5456
  5457*            20  FILLER                     PIC X(12).
  5458             20  cf-maximum-benefits        pic s999 comp-3.
  5459             20  FILLER                     PIC X(09).
  5460             20  CF-BENEFIT-CATEGORY        PIC X.
  5461             20  CF-LOAN-TYPE               PIC X(8).
  5462
  5463             20  CF-CO-REM-TERM-CALC        PIC X.
  5464                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5465                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5466                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page  99
* EL131.cbl
  5467                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5468                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5469
  5470             20  CF-CO-EARNINGS-CALC        PIC X.
  5471                 88  CO-EARN-BY-R78             VALUE '1'.
  5472                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5473                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5474                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5475                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5476                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5477                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5478                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5479
  5480             20  CF-CO-REFUND-CALC          PIC X.
  5481                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5482                 88  CO-REFD-BY-R78             VALUE '1'.
  5483                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5484                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5485                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5486                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5487                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5488                 88  CO-REFD-MEAN               VALUE '8'.
  5489                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5490                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5491                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5492
  5493             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5494                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5495                 88  CO-OVRD-BY-R78             VALUE '1'.
  5496                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5497                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5498                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5499                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5500                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5501                 88  CO-OVRD-MEAN               VALUE '8'.
  5502                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5503
  5504             20  CF-CO-BEN-I-G-CD           PIC X.
  5505                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5506                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5507                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5508
  5509         16  FILLER                         PIC X(304).
  5510
  5511
  5512****************************************************************
  5513*             CARRIER MASTER RECORD                            *
  5514****************************************************************
  5515
  5516     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5517         16  CF-ADDRESS-DATA.
  5518             20  CF-MAIL-TO-NAME            PIC X(30).
  5519             20  CF-IN-CARE-OF              PIC X(30).
  5520             20  CF-ADDRESS-LINE-1          PIC X(30).
  5521             20  CF-ADDRESS-LINE-2          PIC X(30).
  5522             20  CF-CITY-STATE              PIC X(30).
  5523             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5524             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 100
* EL131.cbl
  5525
  5526         16  CF-CLAIM-NO-CONTROL.
  5527             20  CF-CLAIM-NO-METHOD         PIC X.
  5528                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5529                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5530                 88  CLAIM-NO-SEQ               VALUE '3'.
  5531                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5532             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5533                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5534                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5535                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5536
  5537         16  CF-CHECK-NO-CONTROL.
  5538             20  CF-CHECK-NO-METHOD         PIC X.
  5539                 88  CHECK-NO-MANUAL            VALUE '1'.
  5540                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5541                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5542                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5543             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5544                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5545
  5546         16  CF-DOMICILE-STATE              PIC XX.
  5547
  5548         16  CF-EXPENSE-CONTROLS.
  5549             20  CF-EXPENSE-METHOD          PIC X.
  5550                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5551                 88  DOLLARS-PER-PMT            VALUE '2'.
  5552                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5553                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5554             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5555             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5556
  5557         16  CF-CORRESPONDENCE-CONTROL.
  5558             20  CF-LETTER-RESEND-OPT       PIC X.
  5559                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5560                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5561             20  FILLER                     PIC X(4).
  5562
  5563         16  CF-RESERVE-CONTROLS.
  5564             20  CF-MANUAL-SW               PIC X.
  5565                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5566             20  CF-FUTURE-SW               PIC X.
  5567                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5568             20  CF-PTC-SW                  PIC X.
  5569                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5570             20  CF-IBNR-SW                 PIC X.
  5571                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5572             20  CF-PTC-LF-SW               PIC X.
  5573                 88  CF-LF-PTC-USED             VALUE '1'.
  5574             20  CF-CDT-ACCESS-METHOD       PIC X.
  5575                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5576                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5577                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5578             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5579
  5580         16  CF-CLAIM-CALC-METHOD           PIC X.
  5581             88  360-PLUS-MONTHS                VALUE '1'.
  5582             88  365-PLUS-MONTHS                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 101
* EL131.cbl
  5583             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5584             88  360-DAILY                      VALUE '4'.
  5585             88  365-DAILY                      VALUE '5'.
  5586
  5587         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5588         16  FILLER                         PIC X(11).
  5589
  5590         16  CF-LIMIT-AMOUNTS.
  5591             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5592             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5593             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5594             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5595             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5596             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5597             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5600             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5601
  5602         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5603         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5604         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5605
  5606         16  CF-ZIP-CODE.
  5607             20  CF-ZIP-PRIME.
  5608                 24  CF-ZIP-1ST             PIC X.
  5609                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5610                 24  FILLER                 PIC X(4).
  5611             20  CF-ZIP-PLUS4               PIC X(4).
  5612         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5613             20  CF-CAN-POSTAL-1            PIC XXX.
  5614             20  CF-CAN-POSTAL-2            PIC XXX.
  5615             20  FILLER                     PIC XXX.
  5616
  5617         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5618         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5619         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5620
  5621         16  CF-RATING-SWITCH               PIC X.
  5622             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5623             88  CF-NO-RATING                   VALUE 'N'.
  5624
  5625         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5626
  5627         16  CF-CARRIER-OVER-SHORT.
  5628             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5629             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5630
  5631         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5632         16  CF-SECPAY-SWITCH               PIC X.
  5633             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5634             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5635         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5636         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5637         16  FILLER                         PIC X(444).
  5638*        16  FILLER                         PIC X(452).
  5639
  5640
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 102
* EL131.cbl
  5641****************************************************************
  5642*             MORTALITY MASTER RECORD                          *
  5643****************************************************************
  5644
  5645     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5646         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5647                                INDEXED BY CF-MORT-NDX.
  5648             20  CF-MORT-TABLE              PIC X(5).
  5649             20  CF-MORT-TABLE-TYPE         PIC X.
  5650                 88  CF-MORT-JOINT              VALUE 'J'.
  5651                 88  CF-MORT-SINGLE             VALUE 'S'.
  5652                 88  CF-MORT-COMBINED           VALUE 'C'.
  5653                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5654                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5655             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5656             20  CF-MORT-AGE-METHOD         PIC XX.
  5657                 88  CF-AGE-LAST                VALUE 'AL'.
  5658                 88  CF-AGE-NEAR                VALUE 'AN'.
  5659             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5660             20  CF-MORT-ADJUSTMENT-DIRECTION
  5661                                            PIC X.
  5662                 88  CF-MINUS                   VALUE '-'.
  5663                 88  CF-PLUS                    VALUE '+'.
  5664             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5665             20  CF-MORT-JOINT-CODE         PIC X.
  5666                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5667             20  CF-MORT-PC-Q               PIC X.
  5668                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5669             20  CF-MORT-TABLE-CODE         PIC X(4).
  5670             20  CF-MORT-COMMENTS           PIC X(15).
  5671             20  FILLER                     PIC X(14).
  5672
  5673         16  FILLER                         PIC X(251).
  5674
  5675
  5676****************************************************************
  5677*             BUSSINESS TYPE MASTER RECORD                     *
  5678****************************************************************
  5679
  5680     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5681* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5682* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5683* AND RECORD 05 IS TYPES 81-99
  5684         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5685             20  CF-BUSINESS-TITLE          PIC  X(19).
  5686             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5687                                            PIC S9V9(4) COMP-3.
  5688             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5689             20  FILLER                     PIC  X.
  5690         16  FILLER                         PIC  X(248).
  5691
  5692
  5693****************************************************************
  5694*             TERMINAL MASTER RECORD                           *
  5695****************************************************************
  5696
  5697     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5698
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 103
* EL131.cbl
  5699         16  CF-COMPANY-TERMINALS.
  5700             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5701                                  PIC X(4).
  5702         16  FILLER               PIC X(248).
  5703
  5704
  5705****************************************************************
  5706*             LIFE EDIT MASTER RECORD                          *
  5707****************************************************************
  5708
  5709     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5710         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5711             20  CF-LIFE-CODE-IN            PIC XX.
  5712             20  CF-LIFE-CODE-OUT           PIC XX.
  5713         16  FILLER                         PIC X(248).
  5714
  5715
  5716****************************************************************
  5717*             AH EDIT MASTER RECORD                            *
  5718****************************************************************
  5719
  5720     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5721         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5722             20  CF-AH-CODE-IN              PIC XXX.
  5723             20  CF-AH-CODE-OUT             PIC XX.
  5724         16  FILLER                         PIC X(248).
  5725
  5726
  5727****************************************************************
  5728*             CREDIBILITY TABLES                               *
  5729****************************************************************
  5730
  5731     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5732         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5733                             INDEXED BY CF-CRDB-NDX.
  5734             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5735             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5736             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5737         16  FILLER                         PIC  X(332).
  5738
  5739
  5740****************************************************************
  5741*             REPORT CUSTOMIZATION RECORD                      *
  5742****************************************************************
  5743
  5744     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5745         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5746             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5747             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5748             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5749**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5750****       A T-TRANSFER.                                   ****
  5751             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5752
  5753         16  FILLER                         PIC XX.
  5754
  5755         16  CF-CARRIER-CNTL-OPT.
  5756             20  CF-CARRIER-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 104
* EL131.cbl
  5757                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5758                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5759             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5760                                            PIC X.
  5761         16  CF-GROUP-CNTL-OPT.
  5762             20  CF-GROUP-OPT-SEQ           PIC 9.
  5763                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5764                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5765             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5766                                            PIC X(6).
  5767         16  CF-STATE-CNTL-OPT.
  5768             20  CF-STATE-OPT-SEQ           PIC 9.
  5769                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5770                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5771             20  CF-STATE-SELECT OCCURS 3 TIMES
  5772                                            PIC XX.
  5773         16  CF-ACCOUNT-CNTL-OPT.
  5774             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5775                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5776                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5777             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5778                                            PIC X(10).
  5779         16  CF-BUS-TYP-CNTL-OPT.
  5780             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5781                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5782                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5783             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5784                                            PIC XX.
  5785         16  CF-LF-TYP-CNTL-OPT.
  5786             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5787                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5788                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5789             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5790                                            PIC XX.
  5791         16  CF-AH-TYP-CNTL-OPT.
  5792             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5793                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5794                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5795             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5796                                            PIC XX.
  5797         16  CF-REPTCD1-CNTL-OPT.
  5798             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5799                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5800                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5801             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5802                                            PIC X(10).
  5803         16  CF-REPTCD2-CNTL-OPT.
  5804             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5805                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5806                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5807             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5808                                            PIC X(10).
  5809         16  CF-USER1-CNTL-OPT.
  5810             20  CF-USER1-OPT-SEQ           PIC 9.
  5811                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5812                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5813             20  CF-USER1-SELECT OCCURS 3 TIMES
  5814                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 105
* EL131.cbl
  5815         16  CF-USER2-CNTL-OPT.
  5816             20  CF-USER2-OPT-SEQ           PIC 9.
  5817                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5818                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5819             20  CF-USER2-SELECT OCCURS 3 TIMES
  5820                                            PIC X(10).
  5821         16  CF-USER3-CNTL-OPT.
  5822             20  CF-USER3-OPT-SEQ           PIC 9.
  5823                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5824                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5825             20  CF-USER3-SELECT OCCURS 3 TIMES
  5826                                            PIC X(10).
  5827         16  CF-USER4-CNTL-OPT.
  5828             20  CF-USER4-OPT-SEQ           PIC 9.
  5829                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5830                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5831             20  CF-USER4-SELECT OCCURS 3 TIMES
  5832                                            PIC X(10).
  5833         16  CF-USER5-CNTL-OPT.
  5834             20  CF-USER5-OPT-SEQ           PIC 9.
  5835                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5836                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5837             20  CF-USER5-SELECT OCCURS 3 TIMES
  5838                                            PIC X(10).
  5839         16  CF-REINS-CNTL-OPT.
  5840             20  CF-REINS-OPT-SEQ           PIC 9.
  5841                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5842                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5843             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5844                 24  CF-REINS-PRIME         PIC XXX.
  5845                 24  CF-REINS-SUB           PIC XXX.
  5846
  5847         16  CF-AGENT-CNTL-OPT.
  5848             20  CF-AGENT-OPT-SEQ           PIC 9.
  5849                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5850                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5851             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5852                                            PIC X(10).
  5853
  5854         16  FILLER                         PIC X(43).
  5855
  5856         16  CF-LOSS-RATIO-SELECT.
  5857             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5858             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5859         16  CF-ENTRY-DATE-SELECT.
  5860             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5861             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5862         16  CF-EFFECTIVE-DATE-SELECT.
  5863             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5864             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5865
  5866         16  CF-EXCEPTION-LIST-IND          PIC X.
  5867             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5868
  5869         16  FILLER                         PIC X(318).
  5870
  5871****************************************************************
  5872*                  EXCEPTION REPORTING RECORD                  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 106
* EL131.cbl
  5873****************************************************************
  5874
  5875     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5876         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5877             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5878
  5879         16  CF-COMBINED-LIFE-AH-OPT.
  5880             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5881             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5882             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5883             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5884
  5885         16  CF-LIFE-OPT.
  5886             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5887             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5888             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5889             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5890             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5891             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5892             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5893             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5894             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5895             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5896
  5897         16  CF-AH-OPT.
  5898             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5899             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5900             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5901             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5902             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5903             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5904             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5905             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5906             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5907             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5908
  5909         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5910             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5911             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5912             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5913
  5914         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5915
  5916         16  FILLER                         PIC X(673).
  5917
  5918
  5919****************************************************************
  5920*             MORTGAGE SYSTEM PLAN RECORD                      *
  5921****************************************************************
  5922
  5923     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5924         16  CF-PLAN-TYPE                   PIC X.
  5925             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5926             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5927             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5928         16  CF-PLAN-ABBREV                 PIC XXX.
  5929         16  CF-PLAN-DESCRIPT               PIC X(10).
  5930         16  CF-PLAN-NOTES                  PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 107
* EL131.cbl
  5931         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5932         16  CF-PLAN-UNDERWRITING.
  5933             20  CF-PLAN-TERM-DATA.
  5934                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5935                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5936             20  CF-PLAN-AGE-DATA.
  5937                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5938                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5939                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5940             20  CF-PLAN-BENEFIT-DATA.
  5941                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5942                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5943                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5944                                            PIC S9(7)V99  COMP-3.
  5945         16  CF-PLAN-POLICY-FORMS.
  5946             20  CF-POLICY-FORM             PIC X(12).
  5947             20  CF-MASTER-APPLICATION      PIC X(12).
  5948             20  CF-MASTER-POLICY           PIC X(12).
  5949         16  CF-PLAN-RATING.
  5950             20  CF-RATE-CODE               PIC X(5).
  5951             20  CF-SEX-RATING              PIC X.
  5952                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5953                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5954             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5955             20  CF-SUB-STD-TYPE            PIC X.
  5956                 88  CF-PCT-OF-PREM            VALUE '1'.
  5957                 88  CF-PCT-OF-BENE            VALUE '2'.
  5958         16  CF-PLAN-PREM-TOLERANCES.
  5959             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5960             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5961         16  CF-PLAN-PYMT-TOLERANCES.
  5962             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5963             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5964         16  CF-PLAN-MISC-DATA.
  5965             20  FILLER                     PIC X.
  5966             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5967             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5968         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5969         16  CF-PLAN-IND-GRP                PIC X.
  5970             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5971                                                     '1'.
  5972             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5973                                                     '2'.
  5974         16  CF-MIB-SEARCH-SW               PIC X.
  5975             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5976             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5977             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5978             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5979         16  CF-ALPHA-SEARCH-SW             PIC X.
  5980             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5981             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5982             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5983             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5984             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5985             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5986             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5987             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5988             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 108
* EL131.cbl
  5989             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5990                                                     'A' 'B' 'C'
  5991                                                     'X' 'Y' 'Z'.
  5992         16  CF-EFF-DT-RULE-SW              PIC X.
  5993             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5994             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5995             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5996             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5997             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5998         16  FILLER                         PIC X(4).
  5999         16  CF-HEALTH-QUESTIONS            PIC X.
  6000             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6001         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6002         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6003         16  CF-PLAN-SNGL-JNT               PIC X.
  6004             88  CF-COMBINED-PLAN              VALUE 'C'.
  6005             88  CF-JNT-PLAN                   VALUE 'J'.
  6006             88  CF-SNGL-PLAN                  VALUE 'S'.
  6007         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6008         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6009         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6010         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6011         16  CF-RERATE-CNTL                 PIC  X.
  6012             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6013             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6014             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6015             88  CF-AUTO-RECALC                 VALUE '4'.
  6016         16  CF-BENEFIT-TYPE                PIC  X.
  6017             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6018             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6019         16  CF-POLICY-FEE                  PIC S999V99
  6020                                                    COMP-3.
  6021         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6022         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6023         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6024         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6025         16  FILLER                         PIC  X(32).
  6026         16  CF-TERMINATION-FORM            PIC  X(04).
  6027         16  FILLER                         PIC  X(08).
  6028         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6029                                                       COMP-3.
  6030         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6031         16  CF-ISSUE-LETTER                PIC  X(4).
  6032         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6033         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6034             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6035             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6036         16  CF-MP-REFUND-CALC              PIC X.
  6037             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6038             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6039             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6040             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6041             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6042             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6043             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6044             88  CF-MP-REFD-MEAN                VALUE '8'.
  6045         16  CF-ALT-RATE-CODE               PIC  X(5).
  6046
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 109
* EL131.cbl
  6047
  6048         16  FILLER                         PIC X(498).
  6049****************************************************************
  6050*             MORTGAGE COMPANY MASTER RECORD                   *
  6051****************************************************************
  6052
  6053     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6054         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6055         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6056             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6057             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6058             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6059             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6060             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6061
  6062         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6063         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6064         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6065         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6066         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6067
  6068         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6069             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6070         16  CF-MP-RECON-USE-IND            PIC X(1).
  6071             88  CF-MP-USE-RECON             VALUE 'Y'.
  6072         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6073             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6074         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6075             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6076             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6077         16  FILLER                         PIC X(1).
  6078         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6079             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6080         16  CF-MORTG-MIB-VERSION           PIC X.
  6081             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6082             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6083             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6084         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6085             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6086                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6087             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6088                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6089             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6090                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6091             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6092                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6093             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6094                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6095             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6096                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6097         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6098         16  FILLER                         PIC X(7).
  6099         16  CF-MORTG-DESTINATION-SYMBOL.
  6100             20  CF-MORTG-MIB-COMM          PIC X(5).
  6101             20  CF-MORTG-MIB-TERM          PIC X(5).
  6102         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6103             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6104         16  FILLER                         PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 110
* EL131.cbl
  6105         16  CF-MP-CHECK-NO-CONTROL.
  6106             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6107                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6108                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6109                                                ' ' LOW-VALUES.
  6110                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6111                                               VALUE '3'.
  6112         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6113         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6114         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6115             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6116                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6117             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6118                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6119             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6120                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6121             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6122                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6123             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6124                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6125             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6126                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6127         16  CF-MORTG-BILLING-AREA.
  6128             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6129                                            PIC X.
  6130         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6131         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6132         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6133         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6134             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6135             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6136         16  FILLER                         PIC X.
  6137         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6138             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6139             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6140         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6141         16  FILLER                         PIC X(8).
  6142         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6143         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6144         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6145         16  CF-ACH-COMPANY-ID.
  6146             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6147                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6148                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6149                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6150             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6151         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6152             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6153         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6154             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6155             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6156         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6157         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6158         16  FILLER                         PIC X(536).
  6159
  6160****************************************************************
  6161*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6162****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 111
* EL131.cbl
  6163
  6164     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6165         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6166             20  CF-FEMALE-HEIGHT.
  6167                 24  CF-FEMALE-FT           PIC 99.
  6168                 24  CF-FEMALE-IN           PIC 99.
  6169             20  CF-FEMALE-MIN-WT           PIC 999.
  6170             20  CF-FEMALE-MAX-WT           PIC 999.
  6171         16  FILLER                         PIC X(428).
  6172
  6173     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6174         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6175             20  CF-MALE-HEIGHT.
  6176                 24  CF-MALE-FT             PIC 99.
  6177                 24  CF-MALE-IN             PIC 99.
  6178             20  CF-MALE-MIN-WT             PIC 999.
  6179             20  CF-MALE-MAX-WT             PIC 999.
  6180         16  FILLER                         PIC X(428).
  6181******************************************************************
  6182*             AUTOMATIC ACTIVITY RECORD                          *
  6183******************************************************************
  6184     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6185         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6186             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6187             20  CF-SYS-LETTER-ID           PIC X(04).
  6188             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6189             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6190             20  CF-SYS-RESET-SW            PIC X(01).
  6191             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6192             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6193
  6194         16  FILLER                         PIC X(50).
  6195
  6196         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6197             20  CF-USER-ACTIVE-SW          PIC X(01).
  6198             20  CF-USER-LETTER-ID          PIC X(04).
  6199             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6200             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6201             20  CF-USER-RESET-SW           PIC X(01).
  6202             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6203             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6204             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6205
  6206         16  FILLER                         PIC X(246).
  6207
  6208*                                COPY ELCACTQ.
  6209******************************************************************
  6210*                                                                *
  6211*                            ELCACTQ.                            *
  6212*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6213*                            VMOD=2.004                          *
  6214*                                                                *
  6215*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6216*                                                                *
  6217*   FILE TYPE = VSAM,KSDS                                        *
  6218*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6219*                                                                *
  6220*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 112
* EL131.cbl
  6221*       ALTERNATE INDEX = NONE                                   *
  6222*                                                                *
  6223*   LOG = YES                                                    *
  6224*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6225*                                                                *
  6226*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6227******************************************************************
  6228
  6229 01  ACTIVITY-QUE.
  6230     12  AQ-RECORD-ID                PIC XX.
  6231         88  VALID-AQ-ID                VALUE 'AQ'.
  6232
  6233     12  AQ-CONTROL-PRIMARY.
  6234         16  AQ-COMPANY-CD           PIC X.
  6235         16  AQ-CARRIER              PIC X.
  6236         16  AQ-CLAIM-NO             PIC X(7).
  6237         16  AQ-CERT-NO.
  6238             20  AQ-CERT-PRIME       PIC X(10).
  6239             20  AQ-CERT-SFX         PIC X.
  6240
  6241     12  AQ-PENDING-ACTIVITY-FLAGS.
  6242         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6243         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6244             88  PENDING-PAYMENTS       VALUE '1'.
  6245         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6246             88  PENDING-FULL-PRINT     VALUE '1'.
  6247             88  PENDING-PART-PRINT     VALUE '2'.
  6248         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6249             88  PENDING-LETTERS        VALUE '1'.
  6250         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6251             88  PENDING-RESTORE        VALUE 'C'.
  6252             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6253
  6254     12  FILLER                      PIC X(20).
  6255
  6256     12  AQ-RESEND-DATE              PIC XX.
  6257     12  AQ-FOLLOWUP-DATE            PIC XX.
  6258     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6259     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6260     12  AQ-AUTO-LETTER              PIC X(4).
  6261     12  FILLER                      PIC XX.
  6262     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6263*****************************************************************
  6264
  6265*                                COPY ERCACCT.
  6266******************************************************************
  6267*                                                                *
  6268*                                                                *
  6269*                            ERCACCT                             *
  6270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6271*                            VMOD=2.031                          *
  6272*                                                                *
  6273*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6274*                                                                *
  6275*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6276*   VSAM ACCOUNT MASTER FILES.                                   *
  6277*                                                                *
  6278*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 113
* EL131.cbl
  6279*                                                                *
  6280*   FILE TYPE = VSAM,KSDS                                        *
  6281*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6282*                                                                *
  6283*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6284*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6285*                                                                *
  6286*   LOG = NO                                                     *
  6287*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6288*                                                                *
  6289*                                                                *
  6290******************************************************************
  6291*                   C H A N G E   L O G
  6292*
  6293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6294*-----------------------------------------------------------------
  6295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6296* EFFECTIVE    NUMBER
  6297*-----------------------------------------------------------------
  6298* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6299* 092705    2005050300006  PEMA  ADD SPP LEASES
  6300* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6301* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6302* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6303* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6304* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6305******************************************************************
  6306
  6307 01  ACCOUNT-MASTER.
  6308     12  AM-RECORD-ID                      PIC XX.
  6309         88  VALID-AM-ID                      VALUE 'AM'.
  6310
  6311     12  AM-CONTROL-PRIMARY.
  6312         16  AM-COMPANY-CD                 PIC X.
  6313         16  AM-MSTR-CNTRL.
  6314             20  AM-CONTROL-A.
  6315                 24  AM-CARRIER            PIC X.
  6316                 24  AM-GROUPING.
  6317                     28 AM-GROUPING-PREFIX PIC XXX.
  6318                     28 AM-GROUPING-PRIME  PIC XXX.
  6319                 24  AM-STATE              PIC XX.
  6320                 24  AM-ACCOUNT.
  6321                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6322                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6323             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6324                                           PIC X(19).
  6325             20  AM-CNTRL-B.
  6326                 24  AM-EXPIRATION-DT      PIC XX.
  6327                 24  FILLER                PIC X(4).
  6328             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6329                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6330
  6331     12  AM-CONTROL-BY-VAR-GRP.
  6332         16  AM-COMPANY-CD-A1              PIC X.
  6333         16  AM-VG-CARRIER                 PIC X.
  6334         16  AM-VG-GROUPING                PIC X(6).
  6335         16  AM-VG-STATE                   PIC XX.
  6336         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 114
* EL131.cbl
  6337         16  AM-VG-DATE.
  6338             20  AM-VG-EXPIRATION-DT       PIC XX.
  6339             20  FILLER                    PIC X(4).
  6340         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6341                                           PIC 9(11)      COMP-3.
  6342     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6343         16  FILLER                        PIC X(10).
  6344         16  AM-VG-KEY3.
  6345             20  AM-VG3-ACCOUNT            PIC X(10).
  6346             20  AM-VG3-EXP-DT             PIC XX.
  6347         16  FILLER                        PIC X(4).
  6348     12  AM-MAINT-INFORMATION.
  6349         16  AM-LAST-MAINT-DT              PIC XX.
  6350         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6351         16  AM-LAST-MAINT-USER            PIC X(4).
  6352         16  FILLER                        PIC XX.
  6353
  6354     12  AM-EFFECTIVE-DT                   PIC XX.
  6355     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6356
  6357     12  AM-PREV-DATES  COMP-3.
  6358         16  AM-PREV-EXP-DT                PIC 9(11).
  6359         16  AM-PREV-EFF-DT                PIC 9(11).
  6360
  6361     12  AM-REPORT-CODE-1                  PIC X(10).
  6362     12  AM-REPORT-CODE-2                  PIC X(10).
  6363
  6364     12  AM-CITY-CODE                      PIC X(4).
  6365     12  AM-COUNTY-PARISH                  PIC X(6).
  6366
  6367     12  AM-NAME                           PIC X(30).
  6368     12  AM-PERSON                         PIC X(30).
  6369     12  AM-ADDRS                          PIC X(30).
  6370     12  AM-CITY.
  6371         16  AM-ADDR-CITY                  PIC X(28).
  6372         16  AM-ADDR-STATE                 PIC XX.
  6373     12  AM-ZIP.
  6374         16  AM-ZIP-PRIME.
  6375             20  AM-ZIP-PRI-1ST            PIC X.
  6376                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6377             20  FILLER                    PIC X(4).
  6378         16  AM-ZIP-PLUS4                  PIC X(4).
  6379     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6380         16  AM-CAN-POSTAL-1               PIC XXX.
  6381         16  AM-CAN-POSTAL-2               PIC XXX.
  6382         16  FILLER                        PIC XXX.
  6383     12  AM-TEL-NO.
  6384         16  AM-AREA-CODE                  PIC 999.
  6385         16  AM-TEL-PRE                    PIC 999.
  6386         16  AM-TEL-NBR                    PIC 9(4).
  6387     12  AM-TEL-LOC                        PIC X.
  6388         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6389         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6390
  6391     12  AM-COMM-STRUCTURE.
  6392         16  AM-DEFN-1.
  6393             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6394                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 115
* EL131.cbl
  6395                     28  AM-AGT-PREFIX     PIC X(4).
  6396                     28  AM-AGT-PRIME      PIC X(6).
  6397                 24  AM-COM-TYP            PIC X.
  6398                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6399                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6400                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6401                 24  AM-RECALC-LV-INDIC    PIC X.
  6402                 24  AM-RETRO-LV-INDIC     PIC X.
  6403                 24  AM-GL-CODES           PIC X.
  6404                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6405                 24  FILLER                PIC X(01).
  6406         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6407             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6408                 24  FILLER                PIC X(11).
  6409                 24  AM-L-COMA             PIC XXX.
  6410                 24  AM-J-COMA             PIC XXX.
  6411                 24  AM-A-COMA             PIC XXX.
  6412                 24  FILLER                PIC X(6).
  6413
  6414     12  AM-COMM-CHANGE-STATUS             PIC X.
  6415         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6416
  6417     12  AM-CSR-CODE                       PIC X(4).
  6418
  6419     12  AM-BILLING-STATUS                 PIC X.
  6420         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6421         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6422     12  AM-AUTO-REFUND-SW                 PIC X.
  6423         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6424         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6425     12  AM-GPCD                           PIC 99.
  6426     12  AM-IG                             PIC X.
  6427         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6428         88  AM-HAS-GROUP                     VALUE '2'.
  6429     12  AM-STATUS                         PIC X.
  6430         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6431         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6432         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6433         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6434         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6435         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6436     12  AM-REMIT-TO                       PIC 99.
  6437     12  AM-ID-NO                          PIC X(11).
  6438
  6439     12  AM-CAL-TABLE                      PIC XX.
  6440     12  AM-LF-DEVIATION                   PIC XXX.
  6441     12  AM-AH-DEVIATION                   PIC XXX.
  6442     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6443     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6444     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6445     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6446     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6447     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6448
  6449     12  AM-USER-FIELDS.
  6450         16  AM-FLD-1                      PIC XX.
  6451         16  AM-FLD-2                      PIC XX.
  6452         16  AM-FLD-3                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 116
* EL131.cbl
  6453         16  AM-FLD-4                      PIC XX.
  6454         16  AM-FLD-5                      PIC XX.
  6455
  6456     12  AM-1ST-PROD-DATE.
  6457         16  AM-1ST-PROD-YR                PIC XX.
  6458         16  AM-1ST-PROD-MO                PIC XX.
  6459         16  AM-1ST-PROD-DA                PIC XX.
  6460     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6461     12  AM-CERTS-PURGED-DATE.
  6462         16  AM-PUR-YR                     PIC XX.
  6463         16  AM-PUR-MO                     PIC XX.
  6464         16  AM-PUR-DA                     PIC XX.
  6465     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6466     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6467     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6468     12  AM-INACTIVE-DATE.
  6469         16  AM-INA-MO                     PIC 99.
  6470         16  AM-INA-DA                     PIC 99.
  6471         16  AM-INA-YR                     PIC 99.
  6472     12  AM-AR-HI-CERT-DATE                PIC XX.
  6473
  6474     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6475     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6476
  6477     12  AM-OB-PAYMENT-MODE                PIC X.
  6478         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6479         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6480         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6481         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6482
  6483     12  AM-AH-ONLY-INDICATOR              PIC X.
  6484         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6485         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6486
  6487     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6488
  6489     12  AM-OVER-SHORT.
  6490         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6491         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6492
  6493     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6494     12  AM-DCC-CLP-STATE                  PIC XX.
  6495
  6496     12  AM-RECALC-COMM                    PIC X.
  6497     12  AM-RECALC-REIN                    PIC X.
  6498
  6499     12  AM-REI-TABLE                      PIC XXX.
  6500     12  AM-REI-ET-LF                      PIC X.
  6501     12  AM-REI-ET-AH                      PIC X.
  6502     12  AM-REI-PE-LF                      PIC X.
  6503     12  AM-REI-PE-AH                      PIC X.
  6504     12  AM-REI-PRT-ST                     PIC X.
  6505     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6506     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6507     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6508     12  AM-REI-GROUP-A                    PIC X(6).
  6509     12  AM-REI-MORT                       PIC X(4).
  6510     12  AM-REI-PRT-OW                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 117
* EL131.cbl
  6511     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6512     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6513     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6514     12  AM-REI-GROUP-B                    PIC X(6).
  6515
  6516     12  AM-TRUST-TYPE                     PIC X(2).
  6517
  6518     12  AM-EMPLOYER-STMT-USED             PIC X.
  6519     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6520
  6521     12  AM-STD-AH-TYPE                    PIC XX.
  6522     12  AM-EARN-METHODS.
  6523         16  AM-EARN-METHOD-R              PIC X.
  6524             88 AM-REF-RL-R78                 VALUE 'R'.
  6525             88 AM-REF-RL-PR                  VALUE 'P'.
  6526             88 AM-REF-RL-MEAN                VALUE 'M'.
  6527             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6528         16  AM-EARN-METHOD-L              PIC X.
  6529             88 AM-REF-LL-R78                 VALUE 'R'.
  6530             88 AM-REF-LL-PR                  VALUE 'P'.
  6531             88 AM-REF-LL-MEAN                VALUE 'M'.
  6532             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6533         16  AM-EARN-METHOD-A              PIC X.
  6534             88 AM-REF-AH-R78                 VALUE 'R'.
  6535             88 AM-REF-AH-PR                  VALUE 'P'.
  6536             88 AM-REF-AH-MEAN                VALUE 'M'.
  6537             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6538             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6539             88 AM-REF-AH-NET                 VALUE 'N'.
  6540
  6541     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6542     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6543     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6544
  6545     12  AM-RET-Y-N                        PIC X.
  6546     12  AM-RET-P-E                        PIC X.
  6547     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6548     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6549     12  AM-RET-GRP                        PIC X(6).
  6550     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6551         16  AM-POOL-PRIME                 PIC XXX.
  6552         16  AM-POOL-SUB                   PIC XXX.
  6553     12  AM-RETRO-EARNINGS.
  6554         16  AM-RET-EARN-R                 PIC X.
  6555         16  AM-RET-EARN-L                 PIC X.
  6556         16  AM-RET-EARN-A                 PIC X.
  6557     12  AM-RET-ST-TAX-USE                 PIC X.
  6558         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6559         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6560     12  AM-RETRO-BEG-EARNINGS.
  6561         16  AM-RET-BEG-EARN-R             PIC X.
  6562         16  AM-RET-BEG-EARN-L             PIC X.
  6563         16  AM-RET-BEG-EARN-A             PIC X.
  6564     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6565     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6566
  6567     12  AM-USER-SELECT-OPTIONS.
  6568         16  AM-USER-SELECT-1              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 118
* EL131.cbl
  6569         16  AM-USER-SELECT-2              PIC X(10).
  6570         16  AM-USER-SELECT-3              PIC X(10).
  6571         16  AM-USER-SELECT-4              PIC X(10).
  6572         16  AM-USER-SELECT-5              PIC X(10).
  6573
  6574     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6575
  6576     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6577
  6578     12  AM-RPT045A-SWITCH                 PIC X.
  6579         88  RPT045A-OFF                   VALUE 'N'.
  6580
  6581     12  AM-INSURANCE-LIMITS.
  6582         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6583         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6584
  6585     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6586         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6587
  6588     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6589         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6590         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6591
  6592     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6593
  6594     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6595     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6596     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6597     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6598     12  AM-DCC-UEF-STATE                  PIC XX.
  6599     12  FILLER                            PIC XXX.
  6600     12  AM-REPORT-CODE-3                  PIC X(10).
  6601*    12  FILLER                            PIC X(22).
  6602
  6603     12  AM-RESERVE-DATE.
  6604         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6605         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6606         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6607
  6608     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6609     12  AM-NOTIFICATION-TYPES.
  6610         16  AM-NOTIF-OF-LETTERS           PIC X.
  6611         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6612         16  AM-NOTIF-OF-REPORTS           PIC X.
  6613         16  AM-NOTIF-OF-STATUS            PIC X.
  6614
  6615     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6616         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6617         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6618         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6619         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6620
  6621     12  AM-BENEFIT-CONTROLS.
  6622         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6623             20  AM-BENEFIT-CODE           PIC XX.
  6624             20  AM-BENEFIT-TYPE           PIC X.
  6625             20  AM-BENEFIT-REVISION       PIC XXX.
  6626             20  AM-BENEFIT-REM-TERM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 119
* EL131.cbl
  6627             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6628             20  FILLER                    PIC XX.
  6629         16  FILLER                        PIC X(80).
  6630
  6631     12  AM-TRANSFER-DATA.
  6632         16  AM-TRANSFERRED-FROM.
  6633             20  AM-TRNFROM-CARRIER        PIC X.
  6634             20  AM-TRNFROM-GROUPING.
  6635                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6636                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6637             20  AM-TRNFROM-STATE          PIC XX.
  6638             20  AM-TRNFROM-ACCOUNT.
  6639                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6640                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6641             20  AM-TRNFROM-DTE            PIC XX.
  6642         16  AM-TRANSFERRED-TO.
  6643             20  AM-TRNTO-CARRIER          PIC X.
  6644             20  AM-TRNTO-GROUPING.
  6645                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6646                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6647             20  AM-TRNTO-STATE            PIC XX.
  6648             20  AM-TRNTO-ACCOUNT.
  6649                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6650                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6651             20  AM-TRNTO-DTE              PIC XX.
  6652         16  FILLER                        PIC X(10).
  6653
  6654     12  AM-SAVED-REMIT-TO                 PIC 99.
  6655
  6656     12  AM-COMM-STRUCTURE-SAVED.
  6657         16  AM-DEFN-1-SAVED.
  6658             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6659                 24  AM-AGT-SV             PIC X(10).
  6660                 24  AM-COM-TYP-SV         PIC X.
  6661                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6662                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6663                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6664                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6665                 24  FILLER                PIC X.
  6666                 24  AM-GL-CODES-SV        PIC X.
  6667                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6668                 24  FILLER                PIC X.
  6669         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6670             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6671                 24  FILLER                PIC X(11).
  6672                 24  AM-L-COMA-SV          PIC XXX.
  6673                 24  AM-J-COMA-SV          PIC XXX.
  6674                 24  AM-A-COMA-SV          PIC XXX.
  6675                 24  FILLER                PIC X(6).
  6676
  6677     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6678         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6679            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6680            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6681            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6682
  6683     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6684     12  FILLER                            PIC X(120).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 120
* EL131.cbl
  6685
  6686     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6687         16  AM-CONTROL-NAME               PIC X(30).
  6688         16  AM-EXECUTIVE-ONE.
  6689             20  AM-EXEC1-NAME             PIC X(15).
  6690             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6691                                                          COMP-3.
  6692             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6693                                                          COMP-3.
  6694         16  AM-EXECUTIVE-TWO.
  6695             20  AM-EXEC2-NAME             PIC X(15).
  6696             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6697                                                          COMP-3.
  6698             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6699                                                          COMP-3.
  6700
  6701     12  AM-RETRO-ADDITIONAL-DATA.
  6702         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6703         16  AM-RETRO-PREM-P-E             PIC X.
  6704         16  AM-RETRO-CLMS-P-I             PIC X.
  6705         16  AM-RETRO-RET-BRACKET-LF.
  6706             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6707                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6708                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6709             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6710                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6711                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6712             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6713                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6714                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6715         16  AM-RETRO-RET-BRACKET-AH.
  6716             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6717                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6718                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6719                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6720             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6721                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6722                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6723             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6724                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6725                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6726
  6727     12  AM-COMMENTS.
  6728         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6729
  6730     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6731         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6732         16  AM-FLI-BILLING-CODE           PIC X.
  6733         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6734         16  AM-FLI-UNITED-IDENT           PIC X.
  6735         16  AM-FLI-INTEREST-LOST-DATA.
  6736             20  AM-FLI-BANK-NO            PIC X(5).
  6737             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6738             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6739             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6740         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6741             20  AM-FLI-AGT                PIC X(9).
  6742             20  AM-FLI-AGT-COMM-ACC       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 121
* EL131.cbl
  6743             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6744         16  FILLER                        PIC X(102).
  6745
  6746     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6747         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6748             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6749             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6750             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6751             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6752             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6753         16  FILLER                          PIC X(10).
  6754******************************************************************
  6755
  6756*                                COPY ELCCHKQ.
  6757******************************************************************
  6758*                                                                *
  6759*                                                                *
  6760*                            ELCCHKQ.                            *
  6761*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6762*                            VMOD=2.007                          *
  6763*                                                                *
  6764*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6765*                                                                *
  6766*   FILE TYPE = VSAM,KSDS                                        *
  6767*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6768*                                                                *
  6769*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6770*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6771*                                                                *
  6772*   LOG = YES                                                    *
  6773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6774******************************************************************
  6775 01  CHECK-QUE.
  6776     12  CQ-RECORD-ID                PIC XX.
  6777         88  VALID-CQ-ID         VALUE 'CQ'.
  6778
  6779     12  CQ-CONTROL-PRIMARY.
  6780         16  CQ-COMPANY-CD           PIC X.
  6781         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6782         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6783
  6784     12  CQ-CONTROL-BY-PAYEE.
  6785         16  CQ-CONTROL-BY-NUMBER.
  6786             20  CQ-COMPANY-CD-A1     PIC X.
  6787             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6788         16  CQ-PAYEE-CARRIER        PIC X.
  6789         16  CQ-PAYEE-GROUPING       PIC X(6).
  6790         16  CQ-PAYEE-STATE          PIC XX.
  6791         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6792         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6793
  6794     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6795         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6796         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6797         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6798         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6799         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6800         16  FILLER                  PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 122
* EL131.cbl
  6801
  6802     12  CQ-ENTRY-TYPE               PIC X.
  6803             88  CHECK-ON-QUE           VALUE 'Q'.
  6804             88  ALIGNMENT-CHECK        VALUE 'A'.
  6805             88  SPOILED-CHECK          VALUE 'S'.
  6806             88  PAYMENT-ABORTED        VALUE 'X'.
  6807
  6808     12  CQ-CLAIM-MAST-CNTL.
  6809         16  CQ-CARRIER              PIC X.
  6810         16  CQ-CLAIM-NO             PIC X(7).
  6811         16  CQ-CERT-NO.
  6812             20  CQ-CERT-PRIME       PIC X(10).
  6813             20  CQ-CERT-SFX         PIC X.
  6814         16  CQ-CLAIM-TYPE           PIC X.
  6815             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6816             88  CQ-AH-CLAIM            VALUE 'A'.
  6817         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6818             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6819             88  CQ-O-B-COVERAGE        VALUE '2'.
  6820             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6821
  6822     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6823     12  CQ-CHECK-NUMBER             PIC X(7).
  6824     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6825     12  CQ-PAYMENT-TYPE             PIC X.
  6826             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6827             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6828             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6829             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6830             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6831             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6832             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6833             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6834     12  CQ-VOID-INDICATOR           PIC X.
  6835             88  CHECK-IS-STOPPED          VALUE 'S'.
  6836             88  CHECK-IS-VOID             VALUE 'V'.
  6837     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6838     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6839     12  CQ-CHECK-BY-USER            PIC X(4).
  6840     12  CQ-PRE-NUMBERING-SW         PIC X.
  6841       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6842       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6843
  6844     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6845     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6846     12  CQ-LEDGER-FLAG              PIC X(01).
  6847     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6848     12  CQ-LAST-UPDATED-DT          PIC XX.
  6849     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6850     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6851
  6852     12  FILLER                      PIC X(04).
  6853
  6854******************************************************************
  6855
  6856*                                COPY ELCARCH.
  6857******************************************************************
  6858*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 123
* EL131.cbl
  6859*                            ELCARCH.                            *
  6860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6861*                            VMOD=2.007                          *
  6862*                                                                *
  6863*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6864*                                                                *
  6865*   FILE TYPE = VSAM,KSDS                                        *
  6866*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6867*                                                                *
  6868*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6869*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6870*                                                                *
  6871*   LOG = NO                                                     *
  6872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6873*                                                                *
  6874*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6875******************************************************************
  6876 01  LETTER-ARCHIVE.
  6877     12  LA-RECORD-ID                PIC XX.
  6878         88  VALID-LA-ID                VALUE 'LA'.
  6879
  6880     12  LA-CONTROL-PRIMARY.
  6881         16  LA-COMPANY-CD           PIC X.
  6882         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6883         16  LA-RECORD-TYPE          PIC X.
  6884             88  LA-HEADER-DATA         VALUE '1'.
  6885             88  LA-ADDRESS-DATA        VALUE '2'.
  6886             88  LA-TEXT-DATA           VALUE '3'.
  6887             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6888         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6889
  6890     12  LA-CONTROL-BY-TYPE.
  6891         16  LA-COMPANY-CD-A1        PIC X.
  6892         16  LA-RECORD-TYPE-A1       PIC X.
  6893         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6894         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6895
  6896     12  LA-TEXT-RECORD.
  6897         16  LA-SKIP-CONTROL         PIC XX.
  6898             88  NO-LINES-SKIPPED       VALUE SPACES.
  6899             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6900         16  LA-TEXT-LINE            PIC X(70).
  6901
  6902     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6903         16  FILLER                  PIC XX.
  6904         16  LA-ADDRESS-LINE         PIC X(30).
  6905         16  FILLER                  PIC X(40).
  6906
  6907     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6908         16  FILLER                  PIC XX.
  6909         16  LA-CARRIER              PIC X.
  6910         16  LA-CLAIM-NO             PIC X(7).
  6911         16  LA-CERT-NO.
  6912             20  LA-CERT-PRIME       PIC X(10).
  6913             20  LA-CERT-SFX         PIC X.
  6914         16  LA-NO-OF-COPIES         PIC S9.
  6915         16  LA-RESEND-DATE          PIC XX.
  6916         16  LA-PROCESSOR-CD         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 124
* EL131.cbl
  6917         16  LA-CREATION-DT          PIC XX.
  6918         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6919         16  LA-RESEND-PRINT-DATE    PIC XX.
  6920         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6921         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6922*
  6923* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6924*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6925*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6926*   I        20  LA-DMD-RES-ST           PIC XX.
  6927*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6928*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6929*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6930*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6931*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6932*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6933*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6934*   I        20  LA-DMD-UND-CODE         PIC XX.
  6935*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6936*   V    16  FILLER                  PIC X(15).
  6937* -----
  6938*
  6939* REINSERTED  CSO  MODS
  6940*
  6941         16  FILLER.
  6942             20  FILLER                  PIC X(29).
  6943             20  LA-CSO-LETTER-STATUS    PIC X.
  6944                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6945                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6946                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6947             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6948             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6949*
  6950
  6951     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6952         16  FILLER                  PIC XX.
  6953         16  LA4-CARRIER             PIC X.
  6954         16  LA4-CLAIM-NO            PIC X(7).
  6955         16  LA4-CERT-NO.
  6956             20  LA4-CERT-PRIME      PIC X(10).
  6957             20  LA4-CERT-SFX        PIC X.
  6958         16  LA4-NO-OF-COPIES        PIC S9.
  6959         16  LA4-RESEND-DATE         PIC XX.
  6960         16  LA4-PROCESSOR-CD        PIC X(4).
  6961         16  LA4-CREATION-DT         PIC XX.
  6962         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6963         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6964         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6965         16  LA4-FORM-TYPE           PIC X.
  6966             88  LA4-INITIAL-FORM    VALUE '1'.
  6967             88  LA4-PROGRESS-FORM   VALUE '2'.
  6968         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6969         16  LA4-STATE               PIC X(02).
  6970         16  FILLER                  PIC X(31).
  6971******************************************************************
  6972
  6973*                                COPY ELCBENE.
  6974******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 125
* EL131.cbl
  6975*                                                                *
  6976*                            ELCBENE.                            *
  6977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6978*                            VMOD=2.006                          *
  6979*                                                                *
  6980*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6981*                                                                *
  6982*   FILE TYPE = VSAM,KSDS                                        *
  6983*   RECORD SIZE = 500   RECFORM = FIX                            *
  6984*                                                                *
  6985*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6986*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6987*                                                                *
  6988*   LOG = YES                                                    *
  6989*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6990*                                                                *
  6991*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6992******************************************************************
  6993
  6994 01  BENEFICIARY-MASTER.
  6995     12  BE-RECORD-ID                PIC XX.
  6996         88  VALID-BE-ID                VALUE 'BE'.
  6997
  6998     12  BE-CONTROL-PRIMARY.
  6999         16  BE-COMPANY-CD           PIC X.
  7000         16  BE-RECORD-TYPE          PIC X.
  7001             88  BENEFICIARY-RECORD  VALUE 'B'.
  7002             88  ADJUSTOR-RECORD     VALUE 'A'.
  7003         16  BE-BENEFICIARY          PIC X(10).
  7004     12  BE-CONTROL-BY-NAME.
  7005         16  BE-COMPANY-CD-A1        PIC X.
  7006         16  BE-RECORD-TYPE-A1       PIC X.
  7007         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7008         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7009
  7010     12  BE-LAST-MAINT-DT            PIC XX.
  7011     12  BE-LAST-MAINT-BY            PIC X(4).
  7012     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7013
  7014     12  BE-ADDRESS-DATA.
  7015         16  BE-MAIL-TO-NAME         PIC X(30).
  7016         16  BE-ADDRESS-LINE-1       PIC X(30).
  7017         16  BE-ADDRESS-LINE-2       PIC X(30).
  7018         16  BE-ADDRESS-LINE-3       PIC X(30).
  7019         16  BE-CITY-STATE.
  7020             20  BE-CITY             PIC X(28).
  7021             20  BE-STATE            PIC XX.
  7022         16  BE-ZIP-CODE.
  7023             20  BE-ZIP-PRIME.
  7024                 24  BE-ZIP-1ST      PIC X.
  7025                     88  BE-CANADIAN-POST-CODE
  7026                                         VALUE 'A' THRU 'Z'.
  7027                 24  FILLER          PIC X(4).
  7028             20  BE-ZIP-PLUS4        PIC X(4).
  7029         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7030             20  BE-CAN-POSTAL-1     PIC XXX.
  7031             20  BE-CAN-POSTAL-2     PIC XXX.
  7032             20  FILLER              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 126
* EL131.cbl
  7033         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7034         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7035
  7036******************************************************************
  7037*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7038*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7039******************************************************************
  7040     12  BE-CARRIER                  PIC X.
  7041
  7042     12  BE-ADDRESS-DATA2.
  7043         16  BE-MAIL-TO-NAME2        PIC X(30).
  7044         16  BE-ADDRESS-LINE-12      PIC X(30).
  7045         16  BE-ADDRESS-LINE-22      PIC X(30).
  7046         16  BE-ADDRESS-LINE-32      PIC X(30).
  7047         16  BE-CITY-STATE2.
  7048             20  BE-CITY2            PIC X(28).
  7049             20  BE-STATE2           PIC XX.
  7050         16  BE-ZIP-CODE2.
  7051             20  BE-ZIP-PRIME2.
  7052                 24  BE-ZIP-1ST2     PIC X.
  7053                     88  BE-CANADIAN-POST-CODE2
  7054                                         VALUE 'A' THRU 'Z'.
  7055                 24  FILLER          PIC X(4).
  7056             20  BE-ZIP-PLUS42       PIC X(4).
  7057         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7058             20  BE-CAN-POSTAL-12    PIC XXX.
  7059             20  BE-CAN-POSTAL-22    PIC XXX.
  7060             20  FILLER              PIC XXX.
  7061         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7062         16  BE-BILLING-STMT-DATA.
  7063             20  BE-BSR              PIC X.
  7064                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7065                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7066             20  BE-BSR-FROM         PIC X(30).
  7067             20  BE-BSR-DEPT         PIC X(30).
  7068             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7069             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7070             20  BE-OUTPUT-TYPE      PIC X.
  7071                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7072                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7073
  7074     12  FILLER                      PIC X(28).
  7075******************************************************************
  7076
  7077*                                COPY ELCDAR.
  7078******************************************************************
  7079*                                                                *
  7080*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7083*   BASE CLUSTER = DLYACTV                                       *
  7084*   LOG = YES                                                    *
  7085*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7086*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7087*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7088*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7089*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7090*               BY PROGRAM "LGINFCE".                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 127
* EL131.cbl
  7091*                                                                *
  7092******************************************************************
  7093 01  DAILY-ACTIVITY-RECORD.
  7094     05  DA-KEY.
  7095         10  DA-COMP-CD          PIC X.
  7096         10  DA-CARRIER          PIC X.
  7097         10  DA-CLAIM-NO         PIC X(7).
  7098         10  DA-CERT-NO.
  7099             15  DA-CERT-PRIME   PIC X(10).
  7100             15  DA-CERT-SFX     PIC X.
  7101     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7102     05  DA-RECORD-TYPE          PIC X.
  7103     05  FILLER                  PIC X(2).
  7104******************************************************************
  7105
  7106*                                COPY ELCALPH.
  7107******************************************************************
  7108*                                                                *
  7109*                            ELCALPH.                            *
  7110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7111*                            VMOD=2.003                          *
  7112*                                                                *
  7113*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7114*                                                                *
  7115*   FILE TYPE = VSAM,KSDS                                        *
  7116*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7117*                                                                *
  7118*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7119*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7120*                                                                *
  7121*   LOG = YES                                                    *
  7122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7123*                                                                *
  7124*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7125******************************************************************
  7126
  7127 01  ALPHA-INDEX.
  7128     12  AI-RECORD-ID                         PIC XX.
  7129         88  VALID-AI-ID                  VALUE 'AI'.
  7130     12  AI-CONTROL-PRIMARY.
  7131         16  AI-COMPANY-CD                     PIC X.
  7132         16  AI-SOURCE                         PIC X.
  7133             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7134             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7135         16  AI-NAME.
  7136             20  AI-LAST-NAME                  PIC X(15).
  7137             20  AI-FIRST-NAME.
  7138                 24  AI-FIRST-INITIAL          PIC X.
  7139                 24  FILLER                    PIC X(11).
  7140             20  AI-MIDDLE-INIT                PIC X.
  7141         16  AI-DATE                           PIC X(8).
  7142         16  AI-TIME                           PIC S9(07) COMP-3.
  7143
  7144     12  AI-CONTROL-BY-ADMIN-KEY.
  7145         16  AI-CM-COMPANY-CD                  PIC X.
  7146         16  AI-CM-SOURCE                      PIC X.
  7147         16  AI-CM-CARRIER                     PIC X.
  7148         16  AI-CM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 128
* EL131.cbl
  7149             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7150             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7151         16  AI-CM-STATE                       PIC XX.
  7152         16  AI-CM-PRODUCER.
  7153             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7154             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7155         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7156         16  AI-CM-CERTIFICATE-NUMBER.
  7157             20  AI-CM-CERT-PRIME              PIC X(10).
  7158             20  AI-CM-CERT-SFX                PIC X.
  7159         16  AI-CM-DATE                        PIC X(8).
  7160         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7161         16  FILLER                            PIC X(11).
  7162
  7163     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7164         AI-CONTROL-BY-ADMIN-KEY.
  7165         16  AI-CL-COMPANY-CD                  PIC X.
  7166         16  AI-CL-SOURCE                      PIC X.
  7167         16  AI-CL-CARRIER                     PIC X.
  7168         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7169         16  AI-CL-CERTIFICATE-NUMBER.
  7170             20  AI-CL-CERT-PRIME              PIC X(10).
  7171             20  AI-CL-CERT-SFX                PIC X.
  7172         16  AI-CL-DATE                        PIC X(8).
  7173         16  AI-CL-INCURRED-DATE               PIC XX.
  7174         16  AI-CL-CLOSE-DATE                  PIC XX.
  7175         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7176         16  AI-CREDIT-CARD-NUMBER.
  7177             20  AI-CCN.
  7178                 24  AI-CCN-PREFIX             PIC X(4).
  7179                 24  AI-CCN-PRIME              PIC X(12).
  7180             20  AI-CCN-FILLER                 PIC X(4).
  7181
  7182     12  AI-MAINT-INFO.
  7183         16  AI-LAST-MAINT-BY                  PIC X(4).
  7184         16  AI-LAST-MAINT-DT                  PIC XX.
  7185         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7186
  7187     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7188
  7189     12  FILLER                                PIC X(15).
  7190
  7191
  7192*                                COPY ERCDMDNT.
  7193******************************************************************
  7194*                                                                *
  7195*                            ERCDMDNT                            *
  7196*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7197*                            VMOD=2.005                          *
  7198*                                                                *
  7199*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7200*                                                                *
  7201*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7202*                                                                *
  7203*        FILE TYPE= VSAM,KSDS                                    *
  7204*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7205*                                                                *
  7206*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 129
* EL131.cbl
  7207*                                                                *
  7208*        LOG = YES                                               *
  7209*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7210*                                                                *
  7211******************************************************************
  7212
  7213 01  CERTIFICATE-NOTE.
  7214     12  CN-RECORD-ID                     PIC  XX.
  7215         88  VALID-CN-ID                      VALUE 'CN'.
  7216
  7217     12  CN-CONTROL-PRIMARY.
  7218         16  CN-COMPANY-CD                PIC X.
  7219         16  CN-CERT-KEY.
  7220             20  CN-CARRIER               PIC X.
  7221             20  CN-GROUPING.
  7222                 24  CN-GROUPING-PREFIX   PIC XXX.
  7223                 24  CN-GROUPING-PRIME    PIC XXX.
  7224             20  CN-STATE                 PIC XX.
  7225             20  CN-ACCOUNT.
  7226                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7227                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7228             20  CN-CERT-EFF-DT           PIC XX.
  7229             20  CN-CERT-NO.
  7230                 24  CN-CERT-PRIME        PIC X(10).
  7231                 24  CN-CERT-SFX          PIC X.
  7232
  7233     12  CN-BILLING-START-LINE-NO         PIC 99.
  7234     12  CN-BILLING-END-LINE-NO           PIC 99.
  7235
  7236     12  CN-LINES.
  7237         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7238
  7239     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7240         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7241         16  CN-CSI-GENERAL-DATA-AREA.
  7242             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7243
  7244         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7245             CN-CSI-GENERAL-DATA-AREA.
  7246             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7247             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7248             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7249             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7250             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7251             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7252             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7253             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7254             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7255             20  FILLER                       PIC XX.
  7256             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7257             20  FILLER                       PIC X(38).
  7258
  7259         16  CN-CSI-PRODUCT-DATA-AREA.
  7260             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7261
  7262         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7263             CN-CSI-PRODUCT-DATA-AREA.
  7264             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 130
* EL131.cbl
  7265             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7266             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7267             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7268             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7269             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7270             20  FILLER                   PIC XX.
  7271             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7272             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7273             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7274             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7275             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7276             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7277             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7278             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7279             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7280             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7281             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7282             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7283             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7284             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7285             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7286             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7287             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7288             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7289             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7290             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7291             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7292             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7293             20  FILLER                   PIC X(25).
  7294
  7295         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7296             CN-CSI-CREDIT-CARD-DATA.
  7297             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7298             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7299             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7300             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7301             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7302             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7303             20  FILLER                   PIC XX.
  7304             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7305             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7306             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7307             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7308             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7309             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7310             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7311             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7312             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7313             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7314             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7315             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7316             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7317             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7318             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7319             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7320             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7321             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7322             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 131
* EL131.cbl
  7323             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7324             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7325             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7326             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7327             20  FILLER                   PIC X(17).
  7328
  7329         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7330             CN-CSI-FAMILY-LEAVE-DATA.
  7331             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7332             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7333             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7334             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7335             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7336             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7337             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7338             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7339             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7340             20  CN-CSI-SL-INT-ON-PROCEEDS
  7341                                          PIC S9(5)V99  COMP-3.
  7342             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7343             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7344             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7345             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7346             20  CN-CSI-SL-POLICY-BENEFITS
  7347                                          PIC S9(5)V99  COMP-3.
  7348             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7349             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7350             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7351             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7352             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7353             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7354             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7355             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7356             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7357             20  CN-CSI-SL-STATE-NOT      PIC X.
  7358             20  FILLER                   PIC XX.
  7359
  7360         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7361             CN-CSI-SENIOR-LIFE-DATA.
  7362             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7363             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7364             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7365                                          PIC S9(5)V99  COMP-3.
  7366             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7367             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7368             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7369             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7370             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7371             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7372             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7373             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7374             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7375             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7376             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7377             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7378             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7379             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7380             20  CN-CSI-PP-REPAIR         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 132
* EL131.cbl
  7381             20  CN-CSI-PP-REPLACE        PIC X.
  7382             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7383             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7384             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7385             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7386             20  FILLER                   PIC X(5).
  7387
  7388         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7389             CN-CSI-PURCH-PROP-DATA.
  7390             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7391             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7392             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7393             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7394             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7395             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7396             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7397             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7398             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7399             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7400             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7401             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7402             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7403             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7404             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7405             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7406             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7407             20  CN-CSI-EW-REPLACE        PIC X.
  7408             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7409             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7410             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7411             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7412             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7413             20  FILLER                   PIC X(4).
  7414
  7415     12  CN-LAST-MAINT-DT                 PIC XX.
  7416     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7417     12  CN-LAST-MAINT-USER               PIC X(4).
  7418     12  FILLER                           PIC X(6).
  7419
  7420******************************************************************
  7421
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 133
* EL131.cbl
  7423 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7424                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7425                          CONTROL-FILE ACTIVITY-QUE
  7426                          ACCOUNT-MASTER CHECK-QUE
  7427                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7428                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7429                          CERTIFICATE-NOTE.
  7430 0000-DFHEXIT SECTION.
  7431     MOVE '9#                    $   ' TO DFHEIV0.
  7432     MOVE 'EL131' TO DFHEIV1.
  7433     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7434
  7435     IF EIBCALEN = ZERO
  7436         GO TO 8800-UNAUTHORIZED-ACCESS.
  7437
  7438     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7439     MOVE '5'                    TO DC-OPTION-CODE.
  7440     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7441     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7442     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7443     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7444
  7445     IF SAVE-DATE-YY GREATER 70
  7446         MOVE 19                 TO SAVE-DATE-CC
  7447      ELSE
  7448         MOVE 20                 TO SAVE-DATE-CC.
  7449
  7450
  7451* EXEC CICS HANDLE CONDITION
  7452*        PGMIDERR (8820-XCTL-ERROR)
  7453*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7454*        ERROR    (9990-ABEND)
  7455*    END-EXEC.
  7456*    MOVE '"$LI.                 ! " #00007446' TO DFHEIV0
  7457     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7459     MOVE X'2220233030303037343436' TO DFHEIV0(25:11)
  7460     CALL 'kxdfhei1' USING DFHEIV0
  7461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7462
  7463
  7464     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7465     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7466     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7467
  7468     INITIALIZE    EDIT-WORK-AREA.
  7469     MOVE '/'                    TO WORK-SLASH.
  7470     MOVE SPACES                 TO ERROR-SWITCHES.
  7471
  7472     MOVE TRAN-ID                TO TRANS-ID.
  7473     MOVE EIBTRMID               TO PI-TERM.
  7474     MOVE MAP-ID                 TO PI-QUAL.
  7475
  7476     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7477
  7478     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7479         MOVE LOW-VALUES         TO EL131AO
  7480         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 134
* EL131.cbl
  7481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7482         MOVE -1                 TO MAINTL
  7483         GO TO 8110-SEND-DATA.
  7484
  7485     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7486         MOVE LOW-VALUES         TO EL131AO
  7487         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7488         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7489         MOVE 'X'                TO PI-RETURN-CD-1
  7490         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7491         MOVE -1                 TO MAINTL
  7492         IF WS-RETURNED-FROM = XCTL-EL114
  7493             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7494         END-IF
  7495         GO TO 8100-SEND-MAP.
  7496
  7497     IF EIBAID = DFHCLEAR
  7498         GO TO 8200-RETURN-PRIOR.
  7499
  7500     IF PI-PROCESSOR-ID = 'LGXX'
  7501         NEXT SENTENCE
  7502     ELSE
  7503
  7504* EXEC CICS READQ TS
  7505*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7506*            INTO    (SECURITY-CONTROL)
  7507*            LENGTH  (SC-COMM-LENGTH)
  7508*            ITEM    (SC-ITEM)
  7509*        END-EXEC
  7510*    MOVE '*$II   L              ''   #00007491' TO DFHEIV0
  7511     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7512     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7513     MOVE X'2020233030303037343931' TO DFHEIV0(25:11)
  7514     CALL 'kxdfhei1' USING DFHEIV0,
  7515           PI-SECURITY-TEMP-STORE-ID,
  7516           SECURITY-CONTROL,
  7517           SC-COMM-LENGTH,
  7518           SC-ITEM,
  7519           DFHEIV99,
  7520           DFHEIV99
  7521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7522         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7523         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7524         IF NOT DISPLAY-CAP
  7525             MOVE 'READ'               TO  SM-READ
  7526             PERFORM 9995-SECURITY-VIOLATION
  7527             MOVE ER-0070              TO  EMI-ERROR
  7528             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7529             GO TO 8100-SEND-MAP.
  7530
  7531
  7532* EXEC CICS RECEIVE
  7533*        MAP    ('EL131A')
  7534*        MAPSET ('EL131S')
  7535*    END-EXEC.
  7536     MOVE 'EL131A' TO DFHEIV1
  7537     MOVE 'EL131S' TO DFHEIV2
  7538*    MOVE '8"T                   ''   #00007506' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 135
* EL131.cbl
  7539     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7541     MOVE X'2020233030303037353036' TO DFHEIV0(25:11)
  7542     CALL 'kxdfhei1' USING DFHEIV0,
  7543           DFHEIV1,
  7544           EL131AI,
  7545           DFHEIV99,
  7546           DFHEIV2,
  7547           DFHEIV99,
  7548           DFHEIV99
  7549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7550
  7551
  7552     IF PFKEYL GREATER THAN ZERO
  7553         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7554
  7555     IF SCREEN-ERROR
  7556         MOVE ER-0004 TO EMI-ERROR
  7557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7558         MOVE -1 TO MAINTL
  7559         GO TO 8110-SEND-DATA.
  7560
  7561     IF EIBAID = DFHPF3
  7562         GO TO 8500-TRLR-MNT.
  7563
  7564     IF EIBAID = DFHPF4
  7565         GO TO 8600-ADDR-MNT.
  7566
  7567     IF EIBAID = DFHPF5
  7568         GO TO 8700-CERT-MNT.
  7569
  7570     IF PI-COMPANY-ID = 'DMD'
  7571       IF EIBAID = DFHPF6
  7572         GO TO 8750-DMD-CLM-FIX.
  7573
  7574     IF EIBAID = DFHPF7
  7575         GO TO 4000-FORCE-ERRORS.
  7576
  7577     IF EIBAID = DFHPF12
  7578         GO TO 8300-GET-HELP.
  7579
  7580     IF EIBAID = DFHPF15
  7581         GO TO 8725-BENEFICIARY-MNT
  7582     END-IF.
  7583
  7584     IF EIBAID = DFHPF23
  7585         GO TO 8810-PF23-ENTERED.
  7586
  7587     IF EIBAID = DFHPF24
  7588         GO TO 8400-RETURN-MASTER.
  7589
  7590     IF EIBAID NOT = DFHENTER
  7591         MOVE ER-0029            TO EMI-ERROR
  7592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7593         MOVE -1                 TO MAINTL
  7594         GO TO 8110-SEND-DATA.
  7595
  7596     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 136
* EL131.cbl
  7597         MOVE ER-0311            TO EMI-ERROR
  7598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7599         MOVE -1                 TO MAINTL
  7600         GO TO 8110-SEND-DATA.
  7601
  7602     IF MAINTI = 'A'
  7603         GO TO 0500-ADD-ALPHA-ONLY.
  7604
  7605     IF MAINTI = 'N'
  7606         GO TO 0600-CHANGE-NAME.
  7607
  7608     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7609
  7610     IF SCREEN-ERROR
  7611         GO TO 8110-SEND-DATA.
  7612
  7613     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7614         MOVE ER-0276            TO EMI-ERROR
  7615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7616         MOVE -1                 TO MAINTL
  7617         GO TO 8110-SEND-DATA.
  7618
  7619     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7620
  7621     IF SCREEN-ERROR
  7622         GO TO 8110-SEND-DATA.
  7623
  7624     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7625
  7626     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7627
  7628     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7629         GO TO 8110-SEND-DATA.
  7630
  7631     IF EMI-FATAL-CTR GREATER THAN ZERO
  7632         GO TO 8110-SEND-DATA.
  7633
  7634     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7635
  7636     IF WS-OPEN-CLOSE-SW = 'Y'
  7637         IF PI-LETTER-SW = 'Y'
  7638             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7639             MOVE 'T'            TO  CNTL-REC-TYPE
  7640             MOVE SPACES         TO  CNTL-PROC-ID
  7641             MOVE +0             TO  CNTL-SEQ-NO
  7642
  7643* EXEC CICS READ
  7644*                DATASET   (CNTL-FILE-ID)
  7645*                RIDFLD    (CNTL-KEY)
  7646*                SET       (ADDRESS OF CONTROL-FILE)
  7647*            END-EXEC
  7648*    MOVE '&"S        E          (   #00007601' TO DFHEIV0
  7649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7651     MOVE X'2020233030303037363031' TO DFHEIV0(25:11)
  7652     CALL 'kxdfhei1' USING DFHEIV0,
  7653           CNTL-FILE-ID,
  7654           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 137
* EL131.cbl
  7655           DFHEIV99,
  7656           CNTL-KEY,
  7657           DFHEIV99,
  7658           DFHEIV99,
  7659           DFHEIV99
  7660     SET ADDRESS OF CONTROL-FILE TO
  7661         DFHEIV20
  7662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7663             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7664
  7665     MOVE ER-0000                TO EMI-ERROR.
  7666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7667
  7668     MOVE SPACE                  TO MAINTO.
  7669     MOVE -1                     TO MAINTL.
  7670     GO TO 8100-SEND-MAP.
  7671
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 138
* EL131.cbl
  7673 0100-UPDATE-PI.
  7674
  7675     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7676     IF WS-RETURNED-FROM = XCTL-EL114
  7677***sometimes there is crap in positions 7-10 when no code was sele
  7678        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7679          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7680        END-IF
  7681     END-IF.
  7682
  7683     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7684         GO TO 0110-UPDATE-UP.
  7685
  7686     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7687     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7688     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7689     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7690     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7691     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7692     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7693     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7694     GO TO 0120-UPDATE-PI-EXIT.
  7695
  7696 0110-UPDATE-UP.
  7697     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7698     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7699     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7700     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7701     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7702     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7703     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7704     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7705
  7706
  7707* EXEC CICS HANDLE CONDITION
  7708*         QIDERR    (0130-TS-ERROR)
  7709*         ITEMERR   (0130-TS-ERROR)
  7710*    END-EXEC.
  7711*    MOVE '"$N<                  ! # #00007649' TO DFHEIV0
  7712     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7714     MOVE X'2320233030303037363439' TO DFHEIV0(25:11)
  7715     CALL 'kxdfhei1' USING DFHEIV0
  7716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7717
  7718
  7719     IF WS-RETURNED-FROM = XCTL-EL114
  7720
  7721* EXEC CICS READQ TS
  7722*            QUEUE    (PI-KEY)
  7723*            INTO     (EL131AI)
  7724*            LENGTH   (MAP-LENGTH)
  7725*       END-EXEC
  7726*    MOVE '*$I    L              ''   #00007655' TO DFHEIV0
  7727     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7729     MOVE X'2020233030303037363535' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 139
* EL131.cbl
  7731           PI-KEY,
  7732           EL131AI,
  7733           MAP-LENGTH,
  7734           DFHEIV99,
  7735           DFHEIV99,
  7736           DFHEIV99
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7738
  7739        IF WS-SAVE-BENEFICIARY > SPACES
  7740            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7741            MOVE +10            TO BENEL
  7742            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7743        END-IF
  7744        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7745     END-IF.
  7746
  7747
  7748* EXEC CICS READQ TS
  7749*         QUEUE    (PI-KEY)
  7750*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7751*         LENGTH   (PI-COMM-LENGTH)
  7752*    END-EXEC.
  7753*    MOVE '*$I    L              ''   #00007669' TO DFHEIV0
  7754     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7756     MOVE X'2020233030303037363639' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0,
  7758           PI-KEY,
  7759           PROGRAM-INTERFACE-BLOCK,
  7760           PI-COMM-LENGTH,
  7761           DFHEIV99,
  7762           DFHEIV99,
  7763           DFHEIV99
  7764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7765
  7766
  7767
  7768* EXEC CICS DELETEQ TS
  7769*         QUEUE    (PI-KEY)
  7770*    END-EXEC.
  7771*    MOVE '*&                    #   #00007675' TO DFHEIV0
  7772     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7773     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7774     MOVE X'2020233030303037363735' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0,
  7776           PI-KEY,
  7777           DFHEIV99
  7778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7779
  7780
  7781 0120-UPDATE-PI-EXIT.
  7782     EXIT.
  7783
  7784 0130-TS-ERROR.
  7785     MOVE LOW-VALUES             TO EL131AO.
  7786     MOVE ER-0192                TO EMI-ERROR.
  7787
  7788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 140
* EL131.cbl
  7789
  7790     GO TO 8100-SEND-MAP.
  7791
  7792 0200-TRANS-PF.
  7793     IF EIBAID NOT = DFHENTER
  7794         MOVE 'X'                TO ERROR-SWITCH
  7795         GO TO 0210-EXIT.
  7796
  7797     IF PFKEYI NOT NUMERIC
  7798         MOVE 'X'                TO ERROR-SWITCH
  7799         GO TO 0210-EXIT.
  7800
  7801     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7802
  7803     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7804         MOVE 'X' TO ERROR-SWITCH
  7805         GO TO 0210-EXIT.
  7806
  7807     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7808
  7809 0210-EXIT.
  7810     EXIT.
  7811
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 141
* EL131.cbl
  7813 0500-ADD-ALPHA-ONLY.
  7814******************************************************************
  7815*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7816*    RECORD.                                                     *
  7817******************************************************************
  7818
  7819     IF MLNAMEL = +0 AND
  7820        MFNAMEL = +0 AND
  7821        MMINITL = +0
  7822         MOVE ER-0797                TO  EMI-ERROR
  7823         MOVE -1                     TO  MAINTL
  7824         MOVE AL-UABON               TO  MAINTA
  7825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7826         GO TO 8110-SEND-DATA.
  7827
  7828     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7829     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7830     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7831     MOVE PI-CERT-NO                 TO  CERT-NO.
  7832
  7833
  7834* EXEC CICS READ
  7835*        DATASET   (CLMS-FILE-ID)
  7836*        RIDFLD    (MSTR-KEY)
  7837*        SET       (ADDRESS OF CLAIM-MASTER)
  7838*    END-EXEC.
  7839*    MOVE '&"S        E          (   #00007731' TO DFHEIV0
  7840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7842     MOVE X'2020233030303037373331' TO DFHEIV0(25:11)
  7843     CALL 'kxdfhei1' USING DFHEIV0,
  7844           CLMS-FILE-ID,
  7845           DFHEIV20,
  7846           DFHEIV99,
  7847           MSTR-KEY,
  7848           DFHEIV99,
  7849           DFHEIV99,
  7850           DFHEIV99
  7851     SET ADDRESS OF CLAIM-MASTER TO
  7852         DFHEIV20
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7854
  7855
  7856
  7857* EXEC CICS GETMAIN
  7858*        SET       (ADDRESS OF ALPHA-INDEX)
  7859*        LENGTH    (ALPH-LENGTH)
  7860*        INITIMG   (GETMAIN-SPACE)
  7861*    END-EXEC.
  7862*    MOVE ',"IL                  $   #00007737' TO DFHEIV0
  7863     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037373337' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           DFHEIV20,
  7868           ALPH-LENGTH,
  7869           GETMAIN-SPACE
  7870     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 142
* EL131.cbl
  7871         DFHEIV20
  7872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7873
  7874
  7875     MOVE 'AI'                       TO  AI-RECORD-ID.
  7876     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7877                                         AI-CL-COMPANY-CD.
  7878     MOVE 'C'                        TO  AI-SOURCE
  7879                                         AI-CL-SOURCE.
  7880
  7881     IF MLNAMEL IS GREATER THAN +0
  7882         MOVE MLNAMEI                TO  AI-LAST-NAME
  7883     ELSE
  7884         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7885
  7886     IF MFNAMEL IS GREATER THAN +0
  7887         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7888     ELSE
  7889         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7890
  7891     IF MMINITL IS GREATER THAN +0
  7892         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7893     ELSE
  7894         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7895
  7896     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7897     MOVE '5'                        TO  DC-OPTION-CODE.
  7898     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7899     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7900     IF BUILD-YEAR IS GREATER THAN 50
  7901         MOVE '19'                   TO  WS-ALPHA-YY-1
  7902         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7903         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7904         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7905     ELSE
  7906         MOVE '20'                   TO  WS-ALPHA-YY-1
  7907         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7908         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7909         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7910
  7911     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7912                                         AI-CL-DATE.
  7913
  7914     MOVE EIBTIME                    TO  AI-TIME
  7915                                         AI-CL-TIME.
  7916
  7917     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7918     MOVE 'C'                        TO  AI-CL-SOURCE.
  7919     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7920     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7921     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7922     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7923     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7924
  7925     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7926     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7927     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7928
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 143
* EL131.cbl
  7929
  7930* EXEC CICS WRITE
  7931*        DATASET   (ALPH-FILE-ID)
  7932*        RIDFLD    (AI-CONTROL-PRIMARY)
  7933*        FROM      (ALPHA-INDEX)
  7934*    END-EXEC.
  7935     MOVE LENGTH OF
  7936      ALPHA-INDEX
  7937       TO DFHEIV11
  7938*    MOVE '&$ L                  ''   #00007797' TO DFHEIV0
  7939     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037373937' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           ALPH-FILE-ID,
  7944           ALPHA-INDEX,
  7945           DFHEIV11,
  7946           AI-CONTROL-PRIMARY,
  7947           DFHEIV99,
  7948           DFHEIV99
  7949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7950
  7951
  7952     MOVE LOW-VALUES                 TO  EL131AO.
  7953     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7954     MOVE ER-0000                    TO  EMI-ERROR.
  7955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7956     MOVE -1                         TO  MAINTL.
  7957     GO TO 8100-SEND-MAP.
  7958
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 144
* EL131.cbl
  7960 0600-CHANGE-NAME.
  7961******************************************************************
  7962*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7963*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7964******************************************************************
  7965
  7966     IF MLNAMEL = +0 AND
  7967        MFNAMEL = +0 AND
  7968        MMINITL = +0
  7969         MOVE ER-0276                TO  EMI-ERROR
  7970         MOVE -1                     TO  MAINTL
  7971         MOVE AL-UABON               TO  MAINTA
  7972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7973         GO TO 8110-SEND-DATA.
  7974
  7975     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7976     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7977     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7978     MOVE PI-CERT-NO                 TO  CERT-NO.
  7979
  7980
  7981* EXEC CICS READ
  7982*        DATASET   (CLMS-FILE-ID)
  7983*        RIDFLD    (MSTR-KEY)
  7984*        SET       (ADDRESS OF CLAIM-MASTER)
  7985*    END-EXEC.
  7986*    MOVE '&"S        E          (   #00007831' TO DFHEIV0
  7987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7989     MOVE X'2020233030303037383331' TO DFHEIV0(25:11)
  7990     CALL 'kxdfhei1' USING DFHEIV0,
  7991           CLMS-FILE-ID,
  7992           DFHEIV20,
  7993           DFHEIV99,
  7994           MSTR-KEY,
  7995           DFHEIV99,
  7996           DFHEIV99,
  7997           DFHEIV99
  7998     SET ADDRESS OF CLAIM-MASTER TO
  7999         DFHEIV20
  8000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8001
  8002
  8003
  8004* EXEC CICS GETMAIN
  8005*        SET       (ADDRESS OF ALPHA-INDEX)
  8006*        LENGTH    (ALPH-LENGTH)
  8007*        INITIMG   (GETMAIN-SPACE)
  8008*    END-EXEC.
  8009*    MOVE ',"IL                  $   #00007837' TO DFHEIV0
  8010     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8012     MOVE X'2020233030303037383337' TO DFHEIV0(25:11)
  8013     CALL 'kxdfhei1' USING DFHEIV0,
  8014           DFHEIV20,
  8015           ALPH-LENGTH,
  8016           GETMAIN-SPACE
  8017     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 145
* EL131.cbl
  8018         DFHEIV20
  8019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8020
  8021
  8022     MOVE 'AI'                       TO  AI-RECORD-ID.
  8023     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8024                                         AI-CL-COMPANY-CD.
  8025     MOVE 'C'                        TO  AI-SOURCE
  8026                                         AI-CL-SOURCE.
  8027
  8028     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8029     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8030     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8031
  8032     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8033     MOVE '5'                        TO  DC-OPTION-CODE.
  8034     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8035     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8036     IF BUILD-YEAR IS GREATER THAN 50
  8037         MOVE '19'                   TO  WS-ALPHA-YY-1
  8038         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8039         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8040         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8041     ELSE
  8042         MOVE '20'                   TO  WS-ALPHA-YY-1
  8043         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8044         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8045         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8046
  8047     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8048                                         AI-CL-DATE.
  8049
  8050     MOVE EIBTIME                    TO  AI-TIME
  8051                                         AI-CL-TIME.
  8052
  8053     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8054     MOVE 'C'                        TO  AI-CL-SOURCE.
  8055     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8056     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8057     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8058     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8059     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8060
  8061     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8062     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8063     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8064
  8065     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8066         MOVE 'Y'                TO CL-YESNOSW
  8067     END-IF.
  8068
  8069
  8070* EXEC CICS WRITE
  8071*        DATASET   (ALPH-FILE-ID)
  8072*        RIDFLD    (AI-CONTROL-PRIMARY)
  8073*        FROM      (ALPHA-INDEX)
  8074*    END-EXEC.
  8075     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 146
* EL131.cbl
  8076      ALPHA-INDEX
  8077       TO DFHEIV11
  8078*    MOVE '&$ L                  ''   #00007890' TO DFHEIV0
  8079     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8081     MOVE X'2020233030303037383930' TO DFHEIV0(25:11)
  8082     CALL 'kxdfhei1' USING DFHEIV0,
  8083           ALPH-FILE-ID,
  8084           ALPHA-INDEX,
  8085           DFHEIV11,
  8086           AI-CONTROL-PRIMARY,
  8087           DFHEIV99,
  8088           DFHEIV99
  8089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8090
  8091
  8092
  8093* EXEC CICS READ
  8094*        DATASET   (CLMS-FILE-ID)
  8095*        RIDFLD    (MSTR-KEY)
  8096*        SET       (ADDRESS OF CLAIM-MASTER)
  8097*        UPDATE
  8098*    END-EXEC.
  8099*    MOVE '&"S        EU         (   #00007896' TO DFHEIV0
  8100     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8101     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8102     MOVE X'2020233030303037383936' TO DFHEIV0(25:11)
  8103     CALL 'kxdfhei1' USING DFHEIV0,
  8104           CLMS-FILE-ID,
  8105           DFHEIV20,
  8106           DFHEIV99,
  8107           MSTR-KEY,
  8108           DFHEIV99,
  8109           DFHEIV99,
  8110           DFHEIV99
  8111     SET ADDRESS OF CLAIM-MASTER TO
  8112         DFHEIV20
  8113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8114
  8115
  8116     if (cl-priority-cd = '8')
  8117        and (pi-processor-id not = 'PEMA'and 'JMS '
  8118             AND 'AMWA' AND 'KMSB')
  8119        MOVE ER-8003             TO EMI-ERROR
  8120        PERFORM 9900-ERROR-FORMAT
  8121                                 THRU 9900-EXIT
  8122        MOVE -1                  TO MAINTL
  8123        GO TO 8110-SEND-DATA
  8124     end-if
  8125
  8126     IF MLNAMEL IS GREATER THAN +0
  8127         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8128
  8129     IF MFNAMEL IS GREATER THAN +0
  8130         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8131
  8132     IF MMINITL IS GREATER THAN +0
  8133         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 147
* EL131.cbl
  8134
  8135     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8136     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8137     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8138     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8139
  8140     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8141         MOVE 'Y'                TO CL-YESNOSW
  8142     END-IF.
  8143
  8144
  8145* EXEC CICS HANDLE CONDITION
  8146*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8147*    END-EXEC.
  8148*    MOVE '"$$                   ! $ #00007931' TO DFHEIV0
  8149     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8151     MOVE X'2420233030303037393331' TO DFHEIV0(25:11)
  8152     CALL 'kxdfhei1' USING DFHEIV0
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156
  8157* EXEC CICS REWRITE
  8158*        DATASET   (CLMS-FILE-ID)
  8159*        FROM      (CLAIM-MASTER)
  8160*    END-EXEC.
  8161     MOVE LENGTH OF
  8162      CLAIM-MASTER
  8163       TO DFHEIV11
  8164*    MOVE '&& L                  %   #00007935' TO DFHEIV0
  8165     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8167     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0,
  8169           CLMS-FILE-ID,
  8170           CLAIM-MASTER,
  8171           DFHEIV11,
  8172           DFHEIV99
  8173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8174
  8175
  8176 0600-CONTINUE-NAME-UPDATE.
  8177
  8178     MOVE LOW-VALUES                 TO  EL131AO.
  8179     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8180     MOVE ER-0000                    TO  EMI-ERROR.
  8181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8182     MOVE -1                         TO  MAINTL.
  8183     GO TO 8100-SEND-MAP.
  8184
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 148
* EL131.cbl
  8186 1000-EDIT-SCREEN.
  8187
  8188     MOVE MAINTI                 TO CHECK-MAINT.
  8189
  8190     IF NOT VALID-OPTIONS
  8191         MOVE 'X'                TO ERROR-SWITCH
  8192         MOVE -1                 TO MAINTL
  8193         MOVE AL-UABON           TO MAINTA
  8194         MOVE ER-0023            TO EMI-ERROR
  8195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8196         GO TO 1010-EXIT.
  8197
  8198     IF NOT MODIFY-CAP
  8199         MOVE 'UPDATE'           TO  SM-READ
  8200         PERFORM 9995-SECURITY-VIOLATION
  8201         MOVE ER-0070               TO  EMI-ERROR
  8202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8203         GO TO 8100-SEND-MAP.
  8204
  8205     IF DELETE-CLAIM
  8206         MOVE AL-UANON TO MAINTA
  8207         GO TO 1010-EXIT.
  8208
  8209     MOVE AL-UANON               TO MAINTA.
  8210
  8211     IF CCNOI GREATER THAN LOW-VALUES
  8212         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8213
  8214     IF PI-COMPANY-ID = 'CSL'
  8215        CONTINUE
  8216     ELSE
  8217        IF TYPEL > ZERO
  8218           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8219              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8220                    PI-LIFE-OVERRIDE-L1))
  8221                       OR
  8222              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8223              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8224                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8225              MOVE AL-UANON      TO TYPEA
  8226              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8227           ELSE
  8228              MOVE ER-0199       TO EMI-ERROR
  8229              PERFORM 9900-ERROR-FORMAT
  8230                                 THRU 9900-EXIT
  8231              MOVE AL-UABON      TO TYPEA
  8232              MOVE -1            TO TYPEL
  8233              MOVE 'X'           TO ERROR-SWITCH
  8234           END-IF
  8235        ELSE
  8236           MOVE AL-UANOF         TO TYPEA
  8237        END-IF
  8238     END-IF
  8239     IF STATUSI GREATER THAN LOW-VALUES
  8240         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8241             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8242             MOVE AL-UANON       TO STATUSA
  8243             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 149
* EL131.cbl
  8244             MOVE 'Y'            TO DLYACTV-SW
  8245         ELSE
  8246             MOVE ER-0333        TO EMI-ERROR
  8247             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8248             MOVE AL-UABON       TO STATUSA
  8249             MOVE -1             TO STATUSL
  8250             MOVE 'X'            TO ERROR-SWITCH
  8251         END-IF
  8252     ELSE
  8253         MOVE SPACE              TO TRLR-SWITCH
  8254         MOVE 'N'                TO DLYACTV-SW
  8255         MOVE AL-UANOF           TO STATUSA.
  8256
  8257     IF PROCI GREATER THAN LOW-VALUES
  8258         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8259     ELSE
  8260         MOVE AL-UANOF TO PROCA.
  8261
  8262     IF SEXI GREATER THAN LOW-VALUES
  8263         IF SEXI = 'F' OR 'M'
  8264             MOVE AL-UANON       TO SEXA
  8265             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8266           ELSE
  8267             MOVE ER-0219        TO EMI-ERROR
  8268             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8269             MOVE AL-UABON       TO SEXA
  8270             MOVE -1             TO SEXL
  8271             MOVE 'X'            TO ERROR-SWITCH
  8272       ELSE
  8273         MOVE AL-UANOF           TO SEXA.
  8274
  8275     IF BIRTHL = +0
  8276         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8277         MOVE AL-UANOF           TO  BIRTHA
  8278         GO TO 1000-CONTINUE-EDITS.
  8279
  8280     IF BIRTHI = SPACES
  8281         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8282         MOVE 'X'                TO  UPDATE-SWITCH
  8283                                     MSTR-SWITCH
  8284         GO TO 1000-CONTINUE-EDITS.
  8285
  8286     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8287     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8288     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8289     MOVE '4'                    TO  DC-OPTION-CODE.
  8290     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8291     IF DATE-CONVERSION-ERROR
  8292         MOVE ER-0220            TO  EMI-ERROR
  8293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8294         MOVE AL-UABON           TO  BIRTHA
  8295         MOVE -1                 TO  BIRTHL
  8296         MOVE 'X'                TO  ERROR-SWITCH
  8297         GO TO 1000-CONTINUE-EDITS.
  8298
  8299******************************************************************
  8300**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8301**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 150
* EL131.cbl
  8302**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8303******************************************************************
  8304     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8305         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8306         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8307         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8308         MOVE '4'                TO  DC-OPTION-CODE
  8309         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8310         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8311                                     DC-ELAPSED-DAYS
  8312         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8313         IF DATE-CONVERSION-ERROR
  8314             MOVE ER-0220        TO  EMI-ERROR
  8315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8316             MOVE AL-UABON       TO  BIRTHA
  8317             MOVE -1             TO  BIRTHL
  8318             MOVE 'X'            TO  ERROR-SWITCH
  8319             GO TO 1000-CONTINUE-EDITS.
  8320
  8321     MOVE AL-UANON               TO  BIRTHA.
  8322     MOVE 'X'                    TO  UPDATE-SWITCH
  8323                                     MSTR-SWITCH.
  8324     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8325     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8326     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8327
  8328 1000-CONTINUE-EDITS.
  8329
  8330     IF SOCIALI GREATER THAN LOW-VALUES
  8331         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8332         IF WS-SOC-SEC-NO NUMERIC AND
  8333           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8334             NEXT SENTENCE
  8335         ELSE
  8336            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8337               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8338               WS-SSN-DASH2 = '-'
  8339                 NEXT SENTENCE
  8340            ELSE
  8341                 MOVE ER-0887        TO  EMI-ERROR
  8342                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343                 MOVE AL-UABON       TO  SOCIALA
  8344                 MOVE -1             TO  SOCIALL
  8345                 MOVE 'X'            TO  ERROR-SWITCH
  8346            END-IF
  8347        END-IF
  8348     END-IF.
  8349     if critpl > zeros
  8350        and critpi numeric
  8351        move al-uanon            to critpa
  8352        move 'X'                 to update-switch
  8353     end-if
  8354     IF SOCIALI GREATER THAN LOW-VALUES
  8355         MOVE AL-UANON           TO SOCIALA
  8356         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8357     ELSE
  8358         MOVE AL-UANOF           TO SOCIALA.
  8359
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 151
* EL131.cbl
  8360     IF OCCI GREATER THAN LOW-VALUES
  8361         MOVE AL-UANON           TO OCCA
  8362         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8363     ELSE
  8364         MOVE AL-UANOF           TO OCCA.
  8365
  8366     IF BENEL NOT GREATER THAN ZERO
  8367            GO TO 1005-CONTINUE-EDITS.
  8368
  8369     IF BENEI = SPACES
  8370        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8371           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8372           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8373           IF AUTO-PAY-TO-BENE = 'Y'
  8374               MOVE ER-1773      TO  EMI-ERROR
  8375               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8376               MOVE 'X'          TO ERROR-SWITCH
  8377               MOVE AL-UABON     TO BENEA
  8378               MOVE -1           TO BENEL
  8379           ELSE
  8380               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8381           END-IF
  8382        ELSE
  8383           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8384           IF PAYMENT-PENDING
  8385               MOVE ER-1772      TO  EMI-ERROR
  8386               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8387               MOVE 'X'          TO ERROR-SWITCH
  8388               MOVE AL-UABON     TO BENEA
  8389               MOVE -1           TO BENEL
  8390           END-IF
  8391           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8392        END-IF
  8393        GO TO 1005-CONTINUE-EDITS.
  8394
  8395
  8396* EXEC CICS HANDLE CONDITION
  8397*        NOTFND (1004-BENE-NOT-FOUND)
  8398*    END-EXEC.
  8399*    MOVE '"$I                   ! % #00008159' TO DFHEIV0
  8400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8402     MOVE X'2520233030303038313539' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8405
  8406
  8407     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8408     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8409     MOVE BENEI                  TO  WS-ELBENE-ID.
  8410
  8411
  8412* EXEC CICS READ
  8413*        DATASET ('ELBENE')
  8414*        RIDFLD  (WS-ELBENE-KEY)
  8415*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8416*    END-EXEC.
  8417     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 152
* EL131.cbl
  8418*    MOVE '&"S        E          (   #00008167' TO DFHEIV0
  8419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303038313637' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           DFHEIV1,
  8424           DFHEIV20,
  8425           DFHEIV99,
  8426           WS-ELBENE-KEY,
  8427           DFHEIV99,
  8428           DFHEIV99,
  8429           DFHEIV99
  8430     SET ADDRESS OF BENEFICIARY-MASTER TO
  8431         DFHEIV20
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
  8434
  8435     MOVE AL-UANON               TO  BENEA.
  8436     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8437
  8438     GO TO 1005-CONTINUE-EDITS.
  8439
  8440 1004-BENE-NOT-FOUND.
  8441     MOVE ER-0565                TO  EMI-ERROR.
  8442
  8443     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8444     MOVE 'X'                    TO ERROR-SWITCH.
  8445     MOVE AL-UABON               TO BENEA.
  8446     MOVE -1                     TO BENEL.
  8447
  8448 1005-CONTINUE-EDITS.
  8449
  8450     IF DIAGI GREATER THAN LOW-VALUES
  8451         MOVE AL-UANON           TO DIAGA
  8452         MOVE 'X'                TO UPDATE-SWITCH
  8453                                    NINETY-TRLR-SWITCH
  8454     ELSE
  8455         MOVE AL-UANOF           TO DIAGA.
  8456
  8457     IF ICD1I GREATER THAN LOW-VALUES
  8458         IF (ICD1I GREATER THAN SPACES) AND
  8459            (ICD1I(4:1) NOT = '.')
  8460             IF ICD1I(4:1) = ' '
  8461                 MOVE '.' TO ICD1I(4:1)
  8462             ELSE
  8463                 IF ICD1I(8:1) = ' '
  8464                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8465                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8466                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8467                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8468                     MOVE '.'        TO ICD1I(4:1)
  8469                 END-IF
  8470             END-IF
  8471         END-IF
  8472         IF (ICD1I GREATER THAN SPACES) AND
  8473            (ICD1I(1:1) NOT > ' ' OR
  8474             ICD1I(2:1) NOT > ' ' OR
  8475             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 153
* EL131.cbl
  8476             ICD1I(4:1) NOT = '.')
  8477              MOVE ER-0992        TO  EMI-ERROR
  8478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8479              MOVE 'X'            TO ERROR-SWITCH
  8480              MOVE AL-UABON       TO ICD1A
  8481              MOVE -1             TO ICD1L
  8482         ELSE
  8483             MOVE AL-UANON       TO ICD1A
  8484             MOVE 'X'            TO UPDATE-SWITCH
  8485                                    NINETY-TRLR-SWITCH
  8486         END-IF
  8487     ELSE
  8488         MOVE AL-UANOF           TO ICD1A
  8489     END-IF.
  8490
  8491     IF ICD2I GREATER THAN LOW-VALUES
  8492         IF (ICD2I GREATER THAN SPACES) AND
  8493            (ICD2I(4:1) NOT = '.')
  8494             IF ICD2I(4:1) = ' '
  8495                 MOVE '.' TO ICD2I(4:1)
  8496             ELSE
  8497                 IF ICD2I(8:1) = ' '
  8498                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8499                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8500                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8501                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8502                     MOVE '.'        TO ICD2I(4:1)
  8503                 END-IF
  8504             END-IF
  8505         END-IF
  8506         IF (ICD2I GREATER THAN SPACES) AND
  8507            (ICD2I(1:1) NOT > ' ' OR
  8508             ICD2I(2:1) NOT > ' ' OR
  8509             ICD2I(3:1) NOT > ' ' OR
  8510             ICD2I(4:1) NOT = '.')
  8511              MOVE ER-0992        TO EMI-ERROR
  8512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8513              MOVE 'X'            TO ERROR-SWITCH
  8514              MOVE AL-UABON       TO ICD2A
  8515              MOVE -1             TO ICD2L
  8516         ELSE
  8517             MOVE AL-UANON       TO ICD2A
  8518             MOVE 'X'            TO UPDATE-SWITCH
  8519                                    NINETY-TRLR-SWITCH
  8520         END-IF
  8521     ELSE
  8522         MOVE AL-UANOF           TO ICD2A
  8523     END-IF.
  8524
  8525*    IF CAUSEI GREATER THAN LOW-VALUES
  8526*        MOVE AL-UANON           TO CAUSEA
  8527*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8528*    ELSE
  8529*        MOVE AL-UANOF           TO CAUSEA.
  8530
  8531*    IF ENDL GREATER THAN ZERO
  8532*        MOVE LOW-VALUES         TO HOLD-END
  8533*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 154
* EL131.cbl
  8534*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8535*        ELSE
  8536*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8537*            EXEC CICS BIF DEEDIT
  8538*                FIELD    (DEEDIT-DATE-INPUT)
  8539*                LENGTH   (DATE-LENGTH)
  8540*            END-EXEC
  8541*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8542*            MOVE '4'            TO DC-OPTION-CODE
  8543*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8544*            IF NOT DATE-CONVERSION-ERROR
  8545*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8546*                MOVE AL-UANON   TO ENDA
  8547*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8548*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8549*            ELSE
  8550*                MOVE ER-0224    TO EMI-ERROR
  8551*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8552*                MOVE AL-UABON   TO ENDA
  8553*                MOVE -1         TO ENDL
  8554*                MOVE 'X'        TO ERROR-SWITCH
  8555*      ELSE
  8556*          MOVE AL-UANOF         TO ENDA.
  8557
  8558     IF INCL GREATER THAN ZERO
  8559         MOVE LOW-VALUES         TO HOLD-INCUR
  8560         IF INCI = SPACES
  8561             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8562         ELSE
  8563             MOVE INCI           TO DEEDIT-DATE-INPUT
  8564
  8565* EXEC CICS BIF DEEDIT
  8566*                FIELD    (DEEDIT-DATE-INPUT)
  8567*                LENGTH   (DATE-LENGTH)
  8568*            END-EXEC
  8569*    MOVE '@"L                   #   #00008302' TO DFHEIV0
  8570     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8571     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8572     MOVE X'2020233030303038333032' TO DFHEIV0(25:11)
  8573     CALL 'kxdfhei1' USING DFHEIV0,
  8574           DEEDIT-DATE-INPUT,
  8575           DATE-LENGTH
  8576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8577             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8578             MOVE '4'            TO DC-OPTION-CODE
  8579             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8580             IF NOT DATE-CONVERSION-ERROR
  8581                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8582                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8583                 MOVE AL-UANON           TO INCA
  8584                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8585             ELSE
  8586                 MOVE ER-0222    TO EMI-ERROR
  8587                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8588                 MOVE AL-UABON   TO INCA
  8589                 MOVE -1         TO INCL
  8590                 MOVE 'X'        TO ERROR-SWITCH
  8591       ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 155
* EL131.cbl
  8592           IF PI-NO-PMTS = ZEROS
  8593               MOVE AL-UANOF     TO INCA.
  8594
  8595     IF REPL GREATER THAN ZERO
  8596         MOVE LOW-VALUES         TO HOLD-REPORTED
  8597         IF REPI = SPACES
  8598             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8599         ELSE
  8600             MOVE REPI           TO DEEDIT-DATE-INPUT
  8601
  8602* EXEC CICS BIF DEEDIT
  8603*                FIELD    (DEEDIT-DATE-INPUT)
  8604*                LENGTH   (DATE-LENGTH)
  8605*            END-EXEC
  8606*    MOVE '@"L                   #   #00008330' TO DFHEIV0
  8607     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8609     MOVE X'2020233030303038333330' TO DFHEIV0(25:11)
  8610     CALL 'kxdfhei1' USING DFHEIV0,
  8611           DEEDIT-DATE-INPUT,
  8612           DATE-LENGTH
  8613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8614             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8615             MOVE '4'            TO DC-OPTION-CODE
  8616             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8617             IF NOT DATE-CONVERSION-ERROR
  8618                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8619                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8620                 MOVE AL-UANON   TO REPA
  8621                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8622             ELSE
  8623                 MOVE ER-0223    TO EMI-ERROR
  8624                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8625                 MOVE AL-UABON   TO REPA
  8626                 MOVE -1         TO REPL
  8627                 MOVE 'X'        TO ERROR-SWITCH
  8628       ELSE
  8629         MOVE AL-UANOF TO REPA.
  8630
  8631     IF PDTHRUI GREATER THAN LOW-VALUES
  8632        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8633        IF PDTHRUI = SPACES
  8634           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8635        ELSE
  8636           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8637
  8638* EXEC CICS BIF DEEDIT
  8639*               FIELD    (DEEDIT-DATE-INPUT)
  8640*               LENGTH   (DATE-LENGTH)
  8641*          END-EXEC
  8642*    MOVE '@"L                   #   #00008357' TO DFHEIV0
  8643     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8644     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8645     MOVE X'2020233030303038333537' TO DFHEIV0(25:11)
  8646     CALL 'kxdfhei1' USING DFHEIV0,
  8647           DEEDIT-DATE-INPUT,
  8648           DATE-LENGTH
  8649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 156
* EL131.cbl
  8650           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8651           MOVE '4'            TO DC-OPTION-CODE
  8652           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8653           IF NOT DATE-CONVERSION-ERROR
  8654              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8655              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8656              MOVE AL-UANON   TO PDTHRUA
  8657              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8658              IF PI-USES-PAID-TO
  8659                 MOVE '6'            TO DC-OPTION-CODE
  8660                 MOVE -1             TO DC-ELAPSED-DAYS
  8661                 MOVE +0             TO DC-ELAPSED-MONTHS
  8662                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8663                 IF NO-CONVERSION-ERROR
  8664                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8665                 ELSE
  8666                    NEXT SENTENCE
  8667              ELSE
  8668                 NEXT SENTENCE
  8669           ELSE
  8670              MOVE ER-0475    TO EMI-ERROR
  8671              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8672              MOVE AL-UABON   TO PDTHRUA
  8673              MOVE -1         TO PDTHRUL
  8674              MOVE 'X'        TO ERROR-SWITCH
  8675     ELSE
  8676        IF MODIFY-CAP
  8677           MOVE AL-UANOF        TO PDTHRUA.
  8678
  8679     IF PDAMTL GREATER THAN +0
  8680         MOVE ZEROS              TO HOLD-PDAMT
  8681
  8682* EXEC CICS BIF DEEDIT
  8683*            FIELD    (PDAMTI)
  8684*            LENGTH   (9)
  8685*        END-EXEC
  8686     MOVE 9
  8687       TO DFHEIV11
  8688*    MOVE '@"L                   #   #00008392' TO DFHEIV0
  8689     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8690     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           PDAMTI,
  8694           DFHEIV11
  8695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8696         IF PDAMTI NUMERIC
  8697             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8698             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8699             MOVE AL-UNNON       TO PDAMTA
  8700         ELSE
  8701             MOVE ER-0547        TO EMI-ERROR
  8702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8703             MOVE AL-UNBON       TO PDAMTA
  8704             MOVE -1             TO PDAMTL
  8705             MOVE 'X'            TO ERROR-SWITCH
  8706     ELSE
  8707         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 157
* EL131.cbl
  8708            MOVE AL-UNNOF        TO PDAMTA.
  8709
  8710     IF NODAYSI GREATER THAN LOW-VALUES
  8711         MOVE ZEROS              TO HOLD-NODAYS
  8712
  8713* EXEC CICS BIF DEEDIT
  8714*            FIELD (NODAYSI)
  8715*            LENGTH (5)
  8716*        END-EXEC
  8717     MOVE 5
  8718       TO DFHEIV11
  8719*    MOVE '@"L                   #   #00008412' TO DFHEIV0
  8720     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8721     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8722     MOVE X'2020233030303038343132' TO DFHEIV0(25:11)
  8723     CALL 'kxdfhei1' USING DFHEIV0,
  8724           NODAYSI,
  8725           DFHEIV11
  8726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8727         IF NODAYSI NUMERIC
  8728             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8729             MOVE AL-UNNON       TO NODAYSA
  8730             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8731         ELSE
  8732             MOVE ER-0491        TO EMI-ERROR
  8733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8734             MOVE AL-UNBON       TO NODAYSA
  8735             MOVE -1             TO NODAYSL
  8736             MOVE 'X'            TO ERROR-SWITCH
  8737     ELSE
  8738         IF MODIFY-CAP
  8739            MOVE AL-UNNOF        TO NODAYSA.
  8740
  8741     IF NOPMTSI GREATER THAN LOW-VALUES
  8742         MOVE ZEROS              TO HOLD-NOPMTS
  8743
  8744* EXEC CICS BIF DEEDIT
  8745*            FIELD (NOPMTSI)
  8746*            LENGTH (4)
  8747*        END-EXEC
  8748     MOVE 4
  8749       TO DFHEIV11
  8750*    MOVE '@"L                   #   #00008432' TO DFHEIV0
  8751     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8752     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8753     MOVE X'2020233030303038343332' TO DFHEIV0(25:11)
  8754     CALL 'kxdfhei1' USING DFHEIV0,
  8755           NOPMTSI,
  8756           DFHEIV11
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8758         IF NOPMTSI NUMERIC
  8759             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8760             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8761             MOVE AL-UNNON       TO NOPMTSA
  8762           ELSE
  8763             MOVE ER-0548        TO EMI-ERROR
  8764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8765             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 158
* EL131.cbl
  8766             MOVE -1             TO NOPMTSL
  8767             MOVE 'X'            TO ERROR-SWITCH
  8768       ELSE
  8769         IF MODIFY-CAP
  8770            MOVE AL-UNNOF        TO NOPMTSA.
  8771
  8772     IF FORMTYPI GREATER THAN LOW-VALUES
  8773         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8774             MOVE AL-UANON       TO FORMTYPA
  8775             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8776           ELSE
  8777             MOVE ER-7650        TO EMI-ERROR
  8778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8779             MOVE AL-UABON       TO FORMTYPA
  8780             MOVE -1             TO FORMTYPL
  8781             MOVE 'X'            TO ERROR-SWITCH
  8782       ELSE
  8783         MOVE AL-UANOF           TO FORMTYPA.
  8784
  8785     IF PRICDL GREATER THAN ZERO
  8786         IF (PRICDI = ' ') OR
  8787            (PRICDI GREATER THAN ZERO   AND
  8788             PRICDI NOT GREATER THAN '9')
  8789             MOVE AL-UANON       TO PRICDA
  8790             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8791         ELSE
  8792             MOVE ER-0274        TO EMI-ERROR
  8793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794             MOVE AL-UABON       TO PRICDA
  8795             MOVE -1             TO PRICDL
  8796             MOVE 'X'            TO ERROR-SWITCH
  8797     ELSE
  8798         MOVE AL-UANOF TO PRICDA.
  8799
  8800     IF PI-COMPANY-ID = 'DMD'
  8801     IF PRICDL GREATER THAN ZERO
  8802       IF SYSTEM-MODIFY-CAP  OR
  8803          PI-PROCESSOR-ID = 'LGXX'
  8804             NEXT SENTENCE
  8805           ELSE
  8806            IF CL-PRIORITY-CD = '9'  OR
  8807               PRICDI         = '9'
  8808                  MOVE ER-0938        TO EMI-ERROR
  8809                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8810                  MOVE AL-UABON       TO PRICDA
  8811                  MOVE -1             TO PRICDL
  8812                  MOVE 'X'            TO ERROR-SWITCH.
  8813
  8814     IF FILETOL GREATER THAN ZERO
  8815         MOVE AL-UANON           TO FILETOA
  8816         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8817     ELSE
  8818         MOVE AL-UANOF TO FILETOA.
  8819
  8820     IF SUPVL GREATER THAN ZERO
  8821         IF SUPVI = 'Y' OR 'N' OR SPACE
  8822             MOVE AL-UANON       TO SUPVA
  8823             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 159
* EL131.cbl
  8824         ELSE
  8825             MOVE ER-0230        TO EMI-ERROR
  8826             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8827             MOVE AL-UABON       TO SUPVA
  8828             MOVE -1             TO SUPVL
  8829             MOVE 'X'            TO ERROR-SWITCH
  8830     ELSE
  8831         MOVE AL-UANOF           TO SUPVA.
  8832
  8833     IF MLNAMEL GREATER THAN ZERO
  8834         IF MLNAMEI GREATER THAN SPACES
  8835            MOVE AL-UANON        TO MLNAMEA
  8836            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8837                                     MSTR-KEY-SWITCH
  8838         ELSE
  8839            MOVE ER-0236         TO EMI-ERROR
  8840            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8841            MOVE AL-UABON        TO MLNAMEA
  8842            MOVE -1              TO MLNAMEL
  8843            MOVE 'X'             TO ERROR-SWITCH
  8844     ELSE
  8845         MOVE AL-UANOF           TO MLNAMEA.
  8846
  8847     IF MFNAMEI GREATER THAN LOW-VALUES
  8848         MOVE AL-UANON           TO MFNAMEA
  8849         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8850     ELSE
  8851         MOVE AL-UANOF           TO MFNAMEA.
  8852
  8853     IF MMINITI GREATER THAN LOW-VALUES
  8854         MOVE AL-UANON           TO MMINITA
  8855         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8856     ELSE
  8857         MOVE AL-UANOF           TO MMINITA.
  8858
  8859     IF CRTLNMEI GREATER THAN LOW-VALUES
  8860         IF CRTLNMEI NOT = SPACES
  8861            MOVE AL-UANON        TO CRTLNMEA
  8862            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8863                                     CERT-KEY-SWITCH
  8864        ELSE
  8865            MOVE ER-0236         TO EMI-ERROR
  8866            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8867            MOVE AL-UABON        TO CRTLNMEA
  8868            MOVE -1              TO CRTLNMEL
  8869            MOVE 'X'             TO ERROR-SWITCH
  8870     ELSE
  8871         MOVE AL-UANOF           TO CRTLNMEA.
  8872
  8873     IF CRTFNMEI GREATER THAN LOW-VALUES
  8874         MOVE AL-UANON           TO CRTFNMEA
  8875         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8876     ELSE
  8877         MOVE AL-UANOF           TO CRTFNMEA.
  8878
  8879     IF CRTINITI GREATER THAN LOW-VALUES
  8880         MOVE AL-UANON           TO CRTINITA
  8881         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 160
* EL131.cbl
  8882     ELSE
  8883         MOVE AL-UANOF           TO CRTINITA.
  8884
  8885     IF ISSAGEL GREATER THAN ZERO
  8886         IF ISSAGEI NUMERIC
  8887            MOVE AL-UANON        TO ISSAGEA
  8888            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8889         ELSE
  8890            MOVE ER-0237         TO EMI-ERROR
  8891            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8892            MOVE AL-UABON        TO ISSAGEA
  8893            MOVE -1              TO ISSAGEL
  8894            MOVE 'X'             TO ERROR-SWITCH
  8895     ELSE
  8896         MOVE AL-UANOF           TO ISSAGEA.
  8897
  8898     IF JNTFNMEI GREATER THAN LOW-VALUES
  8899         MOVE AL-UANON           TO JNTFNMEA
  8900         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8901     ELSE
  8902         MOVE AL-UANOF           TO JNTFNMEA.
  8903
  8904     IF JNTLNMEI GREATER THAN LOW-VALUES
  8905         MOVE AL-UANON           TO JNTLNMEA
  8906         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8907     ELSE
  8908         MOVE AL-UANOF           TO JNTLNMEA.
  8909
  8910     IF JNTINITI GREATER THAN LOW-VALUES
  8911         MOVE AL-UANON           TO JNTINITA
  8912         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8913     ELSE
  8914         MOVE AL-UANOF           TO JNTINITA.
  8915
  8916     IF JNTAGEL GREATER THAN ZERO
  8917         IF JNTAGEI NUMERIC
  8918            MOVE AL-UANON        TO JNTAGEA
  8919            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8920         ELSE
  8921            MOVE ER-0238         TO EMI-ERROR
  8922            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8923            MOVE AL-UABON        TO JNTAGEA
  8924            MOVE -1              TO JNTAGEL
  8925            MOVE 'X'             TO ERROR-SWITCH
  8926     ELSE
  8927         MOVE AL-UANOF           TO JNTAGEA.
  8928
  8929     IF ADDONDTI GREATER THAN LOW-VALUES
  8930         MOVE LOW-VALUES         TO HOLD-ADDON
  8931         IF ADDONDTI = SPACES
  8932             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8933         ELSE
  8934             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8935
  8936* EXEC CICS BIF DEEDIT
  8937*                FIELD    (DEEDIT-DATE-INPUT)
  8938*                LENGTH   (DATE-LENGTH)
  8939*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 161
* EL131.cbl
  8940*    MOVE '@"L                   #   #00008613' TO DFHEIV0
  8941     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           DEEDIT-DATE-INPUT,
  8946           DATE-LENGTH
  8947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8948             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8949             MOVE '4'            TO DC-OPTION-CODE
  8950             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8951             IF NOT DATE-CONVERSION-ERROR
  8952                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8953                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8954                                                  CERT-SWITCH
  8955                 MOVE AL-UANON   TO ADDONDTA
  8956                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8957             ELSE
  8958                 MOVE ER-7651    TO EMI-ERROR
  8959                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8960                 MOVE AL-UABON   TO ADDONDTA
  8961                 MOVE -1         TO ADDONDTL
  8962                 MOVE 'X'        TO ERROR-SWITCH
  8963       ELSE
  8964         MOVE AL-UANOF TO ADDONDTA.
  8965
  8966     IF LCVCDI GREATER THAN LOW-VALUES
  8967         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8968         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8969     ELSE
  8970         MOVE AL-UANOF           TO LCVCDA.
  8971
  8972     IF ACVCDI GREATER THAN LOW-VALUES
  8973         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8974         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8975     ELSE
  8976         MOVE AL-UANOF           TO ACVCDA.
  8977
  8978     IF LCVOTRMI GREATER THAN LOW-VALUES
  8979
  8980* EXEC CICS BIF DEEDIT
  8981*            FIELD (LCVOTRMI)
  8982*            LENGTH(3)
  8983*        END-EXEC
  8984     MOVE 3
  8985       TO DFHEIV11
  8986*    MOVE '@"L                   #   #00008648' TO DFHEIV0
  8987     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8989     MOVE X'2020233030303038363438' TO DFHEIV0(25:11)
  8990     CALL 'kxdfhei1' USING DFHEIV0,
  8991           LCVOTRMI,
  8992           DFHEIV11
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8994         IF LCVOTRMI IS NUMERIC
  8995             MOVE LCVOTRMI       TO LCVOTRMO
  8996             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8997             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 162
* EL131.cbl
  8998         ELSE
  8999             MOVE ER-0241        TO EMI-ERROR
  9000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9001             MOVE AL-UNBON       TO LCVOTRMA
  9002             MOVE 'X'            TO ERROR-SWITCH
  9003             MOVE -1             TO LCVOTRML
  9004     ELSE
  9005         MOVE AL-UANOF           TO LCVOTRMA.
  9006
  9007     IF ACVOTRMI GREATER THAN LOW-VALUES
  9008
  9009* EXEC CICS BIF DEEDIT
  9010*            FIELD (ACVOTRMI)
  9011*            LENGTH(3)
  9012*        END-EXEC
  9013     MOVE 3
  9014       TO DFHEIV11
  9015*    MOVE '@"L                   #   #00008666' TO DFHEIV0
  9016     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038363636' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           ACVOTRMI,
  9021           DFHEIV11
  9022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9023         IF ACVOTRMI IS NUMERIC
  9024             MOVE ACVOTRMI       TO ACVOTRMO
  9025             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9026             MOVE AL-UANON       TO ACVOTRMA
  9027         ELSE
  9028             MOVE ER-0241        TO EMI-ERROR
  9029             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9030             MOVE AL-UNBON       TO ACVOTRMA
  9031             MOVE 'X'            TO ERROR-SWITCH
  9032             MOVE -1             TO ACVOTRML
  9033     ELSE
  9034         MOVE AL-UANOF           TO ACVOTRMA.
  9035
  9036     IF LCVRATEL GREATER THAN +0
  9037
  9038* EXEC CICS BIF DEEDIT
  9039*            FIELD (LCVRATEI)
  9040*            LENGTH(6)
  9041*        END-EXEC
  9042     MOVE 6
  9043       TO DFHEIV11
  9044*    MOVE '@"L                   #   #00008684' TO DFHEIV0
  9045     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9046     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9047     MOVE X'2020233030303038363834' TO DFHEIV0(25:11)
  9048     CALL 'kxdfhei1' USING DFHEIV0,
  9049           LCVRATEI,
  9050           DFHEIV11
  9051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9052         IF LCVRATEI IS NUMERIC
  9053             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9054             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9055             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 163
* EL131.cbl
  9056         ELSE
  9057             MOVE ER-2280        TO EMI-ERROR
  9058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9059             MOVE AL-UNBON       TO LCVRATEA
  9060             MOVE 'X'            TO ERROR-SWITCH
  9061             MOVE -1             TO LCVRATEL
  9062     ELSE
  9063         MOVE AL-UNNOF           TO LCVRATEA.
  9064
  9065     IF ACVRATEL GREATER THAN +0
  9066
  9067* EXEC CICS BIF DEEDIT
  9068*            FIELD (ACVRATEI)
  9069*            LENGTH(6)
  9070*        END-EXEC
  9071     MOVE 6
  9072       TO DFHEIV11
  9073*    MOVE '@"L                   #   #00008702' TO DFHEIV0
  9074     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9076     MOVE X'2020233030303038373032' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0,
  9078           ACVRATEI,
  9079           DFHEIV11
  9080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9081         IF ACVRATEI IS NUMERIC
  9082             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9083             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9084             MOVE AL-UNNON       TO ACVRATEA
  9085         ELSE
  9086             MOVE ER-2280        TO EMI-ERROR
  9087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9088             MOVE AL-UNBON       TO ACVRATEA
  9089             MOVE 'X'            TO ERROR-SWITCH
  9090             MOVE -1             TO ACVRATEL
  9091     ELSE
  9092         MOVE AL-UNNOF           TO ACVRATEA.
  9093
  9094     IF LCVBENEL GREATER THAN ZERO
  9095
  9096* EXEC CICS BIF DEEDIT
  9097*            FIELD (LCVBENEI)
  9098*            LENGTH (11)
  9099*        END-EXEC
  9100     MOVE 11
  9101       TO DFHEIV11
  9102*    MOVE '@"L                   #   #00008720' TO DFHEIV0
  9103     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9105     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0,
  9107           LCVBENEI,
  9108           DFHEIV11
  9109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9110         IF LCVBENEI IS NUMERIC
  9111            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9112            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9113            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 164
* EL131.cbl
  9114         ELSE
  9115            MOVE ER-0243         TO EMI-ERROR
  9116            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9117            MOVE AL-UNBON        TO LCVBENEA
  9118            MOVE -1              TO LCVBENEL
  9119            MOVE 'X'             TO ERROR-SWITCH
  9120     ELSE
  9121         MOVE AL-UANOF           TO LCVBENEA.
  9122
  9123     IF ACVBENEL GREATER THAN ZERO
  9124
  9125* EXEC CICS BIF DEEDIT
  9126*            FIELD (ACVBENEI)
  9127*            LENGTH (11)
  9128*        END-EXEC
  9129     MOVE 11
  9130       TO DFHEIV11
  9131*    MOVE '@"L                   #   #00008738' TO DFHEIV0
  9132     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9133     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9134     MOVE X'2020233030303038373338' TO DFHEIV0(25:11)
  9135     CALL 'kxdfhei1' USING DFHEIV0,
  9136           ACVBENEI,
  9137           DFHEIV11
  9138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9139         IF ACVBENEI IS NUMERIC
  9140            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9141            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9142            MOVE AL-UNNON        TO ACVBENEA
  9143         ELSE
  9144            MOVE ER-0243         TO EMI-ERROR
  9145            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9146            MOVE AL-UNBON        TO ACVBENEA
  9147            MOVE -1              TO ACVBENEL
  9148            MOVE 'X'             TO ERROR-SWITCH
  9149     ELSE
  9150         MOVE AL-UANOF           TO ACVBENEA.
  9151
  9152     IF LCVFORMI GREATER THAN LOW-VALUES
  9153        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9154        MOVE AL-UANON            TO LCVFORMA
  9155     ELSE
  9156        MOVE AL-UANOF            TO LCVFORMA.
  9157
  9158     IF ACVFORMI GREATER THAN LOW-VALUES
  9159        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9160        MOVE AL-UANON            TO ACVFORMA
  9161     ELSE
  9162        MOVE AL-UANOF            TO ACVFORMA.
  9163
  9164     IF LCVCNDTL GREATER THAN ZERO
  9165         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9166         IF LCVCNDTI = SPACES
  9167             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9168         ELSE
  9169             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9170             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9171             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 165
* EL131.cbl
  9172             MOVE '4'            TO DC-OPTION-CODE
  9173             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9174             IF NOT DATE-CONVERSION-ERROR
  9175                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9176                 MOVE AL-UANON   TO LCVCNDTA
  9177                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9178                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9179             ELSE
  9180                 MOVE ER-0246    TO EMI-ERROR
  9181                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9182                 MOVE AL-UABON   TO LCVCNDTA
  9183                 MOVE -1         TO LCVCNDTL
  9184                 MOVE 'X'        TO ERROR-SWITCH
  9185     ELSE
  9186         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9187         MOVE AL-UANOF           TO LCVCNDTA.
  9188
  9189     IF ACVCNDTL GREATER THAN ZERO
  9190         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9191         IF ACVCNDTI = SPACES
  9192             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9193         ELSE
  9194             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9195             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9196             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9197             MOVE '4'            TO DC-OPTION-CODE
  9198             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9199             IF NOT DATE-CONVERSION-ERROR
  9200                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9201                 MOVE AL-UANON   TO ACVCNDTA
  9202                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9203                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9204             ELSE
  9205                 MOVE ER-0246    TO EMI-ERROR
  9206                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9207                 MOVE AL-UABON   TO ACVCNDTA
  9208                 MOVE -1         TO ACVCNDTL
  9209                 MOVE 'X'        TO ERROR-SWITCH
  9210     ELSE
  9211         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9212         MOVE AL-UANOF           TO ACVCNDTA.
  9213
  9214     IF APRL GREATER THAN +0
  9215
  9216* EXEC CICS BIF DEEDIT
  9217*            FIELD    (APRI)
  9218*            LENGTH   (8)
  9219*        END-EXEC
  9220     MOVE 8
  9221       TO DFHEIV11
  9222*    MOVE '@"L                   #   #00008818' TO DFHEIV0
  9223     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9224     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9225     MOVE X'2020233030303038383138' TO DFHEIV0(25:11)
  9226     CALL 'kxdfhei1' USING DFHEIV0,
  9227           APRI,
  9228           DFHEIV11
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 166
* EL131.cbl
  9230         IF APRI NUMERIC
  9231            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9232            MOVE APRI            TO HOLD-APR APRO
  9233            MOVE AL-UANON        TO APRA
  9234          ELSE
  9235            MOVE ER-0259         TO EMI-ERROR
  9236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237            MOVE AL-UABON        TO APRA
  9238            MOVE -1              TO APRL
  9239            MOVE 'X'             TO ERROR-SWITCH
  9240     ELSE
  9241         MOVE AL-UANOF           TO APRA.
  9242
  9243     IF PMTFREQL GREATER THAN ZERO
  9244
  9245* EXEC CICS BIF DEEDIT
  9246*            FIELD    (PMTFREQI)
  9247*            LENGTH   (2)
  9248*        END-EXEC
  9249     MOVE 2
  9250       TO DFHEIV11
  9251*    MOVE '@"L                   #   #00008836' TO DFHEIV0
  9252     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9253     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9254     MOVE X'2020233030303038383336' TO DFHEIV0(25:11)
  9255     CALL 'kxdfhei1' USING DFHEIV0,
  9256           PMTFREQI,
  9257           DFHEIV11
  9258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9259         IF PMTFREQI NUMERIC
  9260            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9261            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9262            MOVE AL-UANON        TO PMTFREQA
  9263          ELSE
  9264            MOVE ER-0427         TO EMI-ERROR
  9265            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266            MOVE AL-UABON        TO PMTFREQA
  9267            MOVE -1              TO PMTFREQL
  9268            MOVE 'X'             TO ERROR-SWITCH
  9269     ELSE
  9270         MOVE AL-UANOF           TO PMTFREQA.
  9271
  9272     IF INDGRPL GREATER THAN ZERO
  9273         IF INDGRPI = 'I' OR 'G' OR SPACE
  9274             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9275             MOVE AL-UANON       TO INDGRPA
  9276          ELSE
  9277             MOVE ER-0260        TO EMI-ERROR
  9278             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9279             MOVE AL-UABON       TO INDGRPA
  9280             MOVE -1             TO INDGRPL
  9281             MOVE 'X'            TO ERROR-SWITCH
  9282     ELSE
  9283         MOVE AL-UANOF           TO INDGRPA.
  9284
  9285     IF PREMTYPL GREATER THAN ZERO
  9286         IF PREMTYPI = '1' OR '2' OR '3'
  9287            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 167
* EL131.cbl
  9288            MOVE AL-UNNON        TO PREMTYPA
  9289            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9290          ELSE
  9291            MOVE ER-0227         TO EMI-ERROR
  9292            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9293            MOVE AL-UNBON        TO PREMTYPA
  9294            MOVE -1              TO PREMTYPL
  9295            MOVE 'X'             TO ERROR-SWITCH
  9296     ELSE
  9297         MOVE AL-UANOF           TO PREMTYPA.
  9298
  9299     IF LOANBALL GREATER THAN ZERO
  9300
  9301* EXEC CICS BIF DEEDIT
  9302*             FIELD    (LOANBALI)
  9303*             LENGTH   (9)
  9304*        END-EXEC
  9305     MOVE 9
  9306       TO DFHEIV11
  9307*    MOVE '@"L                   #   #00008881' TO DFHEIV0
  9308     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9310     MOVE X'2020233030303038383831' TO DFHEIV0(25:11)
  9311     CALL 'kxdfhei1' USING DFHEIV0,
  9312           LOANBALI,
  9313           DFHEIV11
  9314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9315         IF LOANBALI NUMERIC
  9316             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9317             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9318             MOVE AL-UNNON TO LOANBALA
  9319         ELSE
  9320             MOVE ER-0639        TO EMI-ERROR
  9321             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322             MOVE AL-UNBON       TO LOANBALA
  9323             MOVE -1             TO LOANBALL
  9324             MOVE 'X'            TO ERROR-SWITCH
  9325     ELSE
  9326         MOVE AL-UNNOF           TO LOANBALA.
  9327
  9328     IF LOANNOL GREATER THAN ZERO
  9329        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9330        MOVE AL-UANON            TO LOANNOA
  9331     ELSE
  9332        MOVE AL-UANOF            TO LOANNOA.
  9333
  9334     IF REINCDI GREATER THAN LOW-VALUES
  9335        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9336        MOVE AL-UANON            TO REINCDA
  9337     ELSE
  9338        MOVE AL-UANOF            TO REINCDA.
  9339
  9340     IF CERTI GREATER THAN LOW-VALUES
  9341         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9342     ELSE
  9343         MOVE AL-UANOF           TO CERTA.
  9344
  9345     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 168
* EL131.cbl
  9346         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9347     ELSE
  9348         MOVE AL-UANOF           TO CERTEFFA.
  9349
  9350     IF CERTACTI GREATER THAN LOW-VALUES
  9351         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9352     ELSE
  9353         MOVE AL-UANOF           TO CERTACTA.
  9354
  9355     IF CERTSTI GREATER THAN LOW-VALUES
  9356         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9357     ELSE
  9358         MOVE AL-UANOF           TO CERTSTA.
  9359
  9360     IF CERTCARI GREATER THAN LOW-VALUES
  9361         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9362     ELSE
  9363         MOVE AL-UANOF           TO CERTCARA.
  9364
  9365     IF DLYACTV-RECORD-NEEDED
  9366         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9367                 1150-EXIT
  9368     END-IF.
  9369
  9370     IF CERTEFFI GREATER LOW-VALUES OR
  9371        CERTACTI GREATER LOW-VALUES OR
  9372        CERTSTI  GREATER LOW-VALUES OR
  9373        CERTCARI GREATER LOW-VALUES OR
  9374        CERTGRPI GREATER LOW-VALUES
  9375        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9376
  9377*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9378*      IF PI-PREM-TYPE NOT = '1'  AND
  9379*         PI-NO-PMTS = ZEROS
  9380*          IF LOANBALL GREATER +0 OR
  9381*             ACVBENEL GREATER +0
  9382*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9383     if not acct-found
  9384        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9385     end-if
  9386     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9387     MOVE PI-CARRIER             TO CARRIER-CODE
  9388     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9389     MOVE PI-CERT-NO             TO CERT-NO
  9390
  9391* EXEC CICS READ
  9392*        DATASET   (CLMS-FILE-ID)
  9393*        RIDFLD    (MSTR-KEY)
  9394*        SET       (ADDRESS OF CLAIM-MASTER)
  9395*        RESP      (WS-RESPONSE)
  9396*    END-EXEC
  9397*    MOVE '&"S        E          (  N#00008960' TO DFHEIV0
  9398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9400     MOVE X'204E233030303038393630' TO DFHEIV0(25:11)
  9401     CALL 'kxdfhei1' USING DFHEIV0,
  9402           CLMS-FILE-ID,
  9403           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 169
* EL131.cbl
  9404           DFHEIV99,
  9405           MSTR-KEY,
  9406           DFHEIV99,
  9407           DFHEIV99,
  9408           DFHEIV99
  9409     SET ADDRESS OF CLAIM-MASTER TO
  9410         DFHEIV20
  9411     MOVE EIBRESP  TO WS-RESPONSE
  9412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9413     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9414     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9415     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9416     MOVE CL-CERT-STATE          TO CERT-STATE
  9417     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9418     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9419     MOVE CL-CERT-NO             TO CERT-CERT
  9420
  9421* EXEC CICS READ
  9422*       DATASET   (CERT-FILE-ID)
  9423*       RIDFLD    (CERT-KEY)
  9424*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9425*       RESP      (WS-RESPONSE)
  9426*    END-EXEC
  9427*    MOVE '&"S        E          (  N#00008973' TO DFHEIV0
  9428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9430     MOVE X'204E233030303038393733' TO DFHEIV0(25:11)
  9431     CALL 'kxdfhei1' USING DFHEIV0,
  9432           CERT-FILE-ID,
  9433           DFHEIV20,
  9434           DFHEIV99,
  9435           CERT-KEY,
  9436           DFHEIV99,
  9437           DFHEIV99,
  9438           DFHEIV99
  9439     SET ADDRESS OF CERTIFICATE-MASTER TO
  9440         DFHEIV20
  9441     MOVE EIBRESP  TO WS-RESPONSE
  9442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9443     if mfnamei > low-values
  9444        move mfnamei to w-name-first
  9445     else
  9446        move cl-insured-1st-name to w-name-first
  9447     end-if
  9448     if mlnamei > low-values
  9449        move mlnamei to w-name-last
  9450     else
  9451        move cl-insured-last-name to w-name-last
  9452     end-if
  9453     if instypel > zeros
  9454        evaluate true
  9455           when cl-no-of-days-paid > zeros
  9456              move er-1668       to emi-error
  9457              perform 9900-error-format
  9458                                 thru 9900-exit
  9459              move al-uabon      to instypea
  9460              move -1            to instypel
  9461              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 170
* EL131.cbl
  9462           when instypei = 'C'
  9463              if w-name-first (1:10) = cm-insured-first-name
  9464                 move er-1666    to emi-error
  9465                 PERFORM 9900-ERROR-FORMAT
  9466                                 THRU 9900-EXIT
  9467                 move al-uabon   to instypea
  9468                 move -1         to instypel
  9469                 move 'X'        to error-switch
  9470              end-if
  9471           when instypei = 'P'
  9472              if (w-name-first (1:10) <> cm-insured-first-name)
  9473                 or (w-name-last <> cm-insured-last-name)
  9474                 move er-1676    to emi-error
  9475                 PERFORM 9900-ERROR-FORMAT
  9476                                 THRU 9900-EXIT
  9477                 move al-uabon   to instypea
  9478                 move -1         to instypel
  9479                 move 'X'        to error-switch
  9480              end-if
  9481        end-evaluate
  9482     end-if
  9483*    if (instypel > zeros)
  9484*       and (cl-no-of-days-paid > zero)
  9485*       move er-1668             to emi-error
  9486*       perform 9900-error-format thru 9900-exit
  9487*       move al-uabon            to instypea
  9488*       move -1                  to instypel
  9489*       move 'X'                 to error-switch
  9490*    end-if
  9491*
  9492*    if instypel > zero
  9493*       if instypei = 'C'
  9494*          if w-name-first (1:10) = cm-insured-first-name
  9495*             move er-1666          to emi-error
  9496*             PERFORM 9900-ERROR-FORMAT
  9497*                                   THRU 9900-EXIT
  9498*             move al-uabon         to instypea
  9499*             move -1               to instypel
  9500*             move 'X'              to error-switch
  9501*          end-if
  9502*       end-if
  9503*    end-if
  9504     if (pi-company-id = 'DCC' OR 'VPP')
  9505        and (acct-found)
  9506        perform 2120-check-pdef  thru 2120-exit
  9507     end-if
  9508     if benperl > zeros
  9509        move al-uanon            to benpera
  9510     end-if
  9511     if benperl > zeros
  9512        if benperi numeric
  9513           perform 1015-edit-benefit-period
  9514                                 thru 1015-exit
  9515        else
  9516           move er-1669          to emi-error
  9517           PERFORM 9900-ERROR-FORMAT
  9518                                 THRU 9900-EXIT
  9519           move al-uabon         to benpera
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 171
* EL131.cbl
  9520           move -1               to benperl
  9521           move 'X'              to error-switch
  9522        end-if
  9523    end-if
  9524     if instypel > zeros
  9525        if instypei = 'P' OR 'C'
  9526           move 'X'              to update-switch
  9527                                    mstr-switch
  9528           move al-uanon         to instypea
  9529        else
  9530            move er-1654          to emi-error
  9531           PERFORM 9900-ERROR-FORMAT
  9532                                 THRU 9900-EXIT
  9533           move al-uabon         to instypea
  9534           move -1               to instypel
  9535           move 'X'              to error-switch
  9536        end-if
  9537    end-if
  9538     if accswl > zeros
  9539        if accswi = 'Y' OR 'N'
  9540           MOVE 'X'              TO UPDATE-SWITCH
  9541                                    MSTR-SWITCH
  9542           MOVE AL-UANON         TO accswa
  9543*       else
  9544*          move er-1656          to emi-error
  9545*          PERFORM 9900-ERROR-FORMAT
  9546*                                THRU 9900-EXIT
  9547*          move al-uabon         to accswa
  9548*          move -1               to accswl
  9549*          move 'X'              to error-switch
  9550*          move al-uanof         to accswa
  9551        end-if
  9552     end-if
  9553     IF CERTL = ZEROS AND
  9554        SUFXL = ZEROS
  9555          GO TO 1010-EXIT.
  9556
  9557     IF CERTL GREATER THAN ZEROS
  9558         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9559             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9560             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9561             MOVE 'X'            TO ERROR-SWITCH
  9562             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9563
  9564     IF SUFXL GREATER THAN ZEROS
  9565         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9566             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9567             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9568             MOVE 'X'            TO ERROR-SWITCH
  9569             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9570
  9571 1010-EXIT.
  9572     EXIT.
  9573
  9574 1015-edit-benefit-period.
  9575     move ' '                    to ws-benper-sw
  9576     evaluate true
  9577        when not erpdef-found
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 172
* EL131.cbl
  9578           set good-benper       to true
  9579        when pd-recurring-yn (a1) = 'Y'
  9580           set good-benper       to true
  9581        when pd-recurring-yn (a1) = 'N'
  9582           if benperi < 02
  9583              set good-benper    to true
  9584           end-if
  9585        when pd-rec-crit-period (a1) numeric
  9586           if benperi <= pd-rec-crit-period (a1)
  9587              set good-benper    to true
  9588           end-if
  9589     end-evaluate
  9590     MOVE CERT-KEY               TO ELCRTT-KEY
  9591     MOVE 'B'                    TO CTRLR-REC-TYPE
  9592
  9593* EXEC CICS READ
  9594*       DATASET   ('ELCRTT')
  9595*       RIDFLD    (ELCRTT-KEY)
  9596*       INTO      (CERTIFICATE-TRAILERS)
  9597*       RESP      (WS-RESPONSE)
  9598*    END-EXEC
  9599     MOVE LENGTH OF
  9600      CERTIFICATE-TRAILERS
  9601       TO DFHEIV11
  9602     MOVE 'ELCRTT' TO DFHEIV1
  9603*    MOVE '&"IL       E          (  N#00009128' TO DFHEIV0
  9604     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9606     MOVE X'204E233030303039313238' TO DFHEIV0(25:11)
  9607     CALL 'kxdfhei1' USING DFHEIV0,
  9608           DFHEIV1,
  9609           CERTIFICATE-TRAILERS,
  9610           DFHEIV11,
  9611           ELCRTT-KEY,
  9612           DFHEIV99,
  9613           DFHEIV99,
  9614           DFHEIV99
  9615     MOVE EIBRESP  TO WS-RESPONSE
  9616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9617     IF WS-RESP-NORMAL
  9618        perform varying s1 from +1 by +1 until
  9619           (s1 > +24)
  9620           or ((cs-claim-type (s1) = cl-claim-type)
  9621           and (cs-insured-type (s1) = cl-insured-type)
  9622           and (cs-benefit-period (s1) > benperi))
  9623        end-perform
  9624        if s1 < +25
  9625           move er-1665          to emi-error
  9626           PERFORM 9900-ERROR-FORMAT
  9627                                 THRU 9900-EXIT
  9628           move al-uabon         to benpera
  9629           move -1               to benperl
  9630           move 'X'              to error-switch
  9631           go to 1015-exit
  9632*       else
  9633*          set good-benper       to true
  9634        end-if
  9635     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 173
* EL131.cbl
  9636     if good-benper
  9637        move 'X'                 to update-switch
  9638                                    mstr-switch
  9639        move al-uanon            to benpera
  9640     else
  9641        move er-1669             to emi-error
  9642        PERFORM 9900-ERROR-FORMAT
  9643                                 THRU 9900-EXIT
  9644        move al-uabon            to benpera
  9645        move -1                  to benperl
  9646        move 'X'                 to error-switch
  9647     end-if
  9648     .
  9649 1015-exit.
  9650     exit.
  9651 1050-EDIT-BENE.
  9652     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9653     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9654     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9655     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9656     MOVE 1000               TO TRLR-SEQ-NO.
  9657
  9658
  9659* EXEC CICS HANDLE CONDITION
  9660*         NOTFND    (1052-DONE)
  9661*         ENDFILE   (1052-DONE)
  9662*    END-EXEC.
  9663*    MOVE '"$I''                  ! & #00009175' TO DFHEIV0
  9664     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9666     MOVE X'2620233030303039313735' TO DFHEIV0(25:11)
  9667     CALL 'kxdfhei1' USING DFHEIV0
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671
  9672* EXEC CICS STARTBR
  9673*        DATASET (TRLR-FILE-ID)
  9674*        RIDFLD  (TRLR-KEY)
  9675*    END-EXEC
  9676     MOVE 0
  9677       TO DFHEIV11
  9678*    MOVE '&,         G          &   #00009180' TO DFHEIV0
  9679     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9680     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9681     MOVE X'2020233030303039313830' TO DFHEIV0(25:11)
  9682     CALL 'kxdfhei1' USING DFHEIV0,
  9683           TRLR-FILE-ID,
  9684           TRLR-KEY,
  9685           DFHEIV99,
  9686           DFHEIV11,
  9687           DFHEIV99
  9688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9689
  9690
  9691     MOVE SPACES TO WS-TRLR-FILE-EOF
  9692                    WS-PAYMENT-PENDING
  9693     PERFORM 1052-READ-TRLR THRU 1052-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 174
* EL131.cbl
  9694       UNTIL  TRLR-FILE-EOF
  9695         OR PAYMENT-PENDING
  9696
  9697
  9698* EXEC CICS ENDBR
  9699*        DATASET (TRLR-FILE-ID)
  9700*    END-EXEC.
  9701     MOVE 0
  9702       TO DFHEIV11
  9703*    MOVE '&2                    $   #00009192' TO DFHEIV0
  9704     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9705     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9706     MOVE X'2020233030303039313932' TO DFHEIV0(25:11)
  9707     CALL 'kxdfhei1' USING DFHEIV0,
  9708           TRLR-FILE-ID,
  9709           DFHEIV11,
  9710           DFHEIV99
  9711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9712
  9713 1050-EXIT.
  9714     EXIT.
  9715
  9716 1052-READ-TRLR.
  9717
  9718* EXEC CICS READNEXT
  9719*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9720*         DATASET  (TRLR-FILE-ID)
  9721*         RIDFLD   (TRLR-KEY)
  9722*    END-EXEC.
  9723     MOVE 0
  9724       TO DFHEIV11
  9725*    MOVE '&.S                   )   #00009199' TO DFHEIV0
  9726     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9727     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303039313939' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           TRLR-FILE-ID,
  9731           DFHEIV20,
  9732           DFHEIV99,
  9733           TRLR-KEY,
  9734           DFHEIV99,
  9735           DFHEIV11,
  9736           DFHEIV99,
  9737           DFHEIV99
  9738     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9739         DFHEIV20
  9740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9741
  9742
  9743     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9744       AND PI-CARRIER  = TRLR-CARRIER
  9745       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9746       AND PI-CERT-NO  = TRLR-CERT-NO
  9747        CONTINUE
  9748     ELSE
  9749        GO TO 1052-DONE
  9750     END-IF.
  9751
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 175
* EL131.cbl
  9752     IF PAYMENT-TR
  9753       AND BENEFICIARY-PAID
  9754       AND AT-VOID-DT = LOW-VALUES
  9755       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9756         SET PAYMENT-PENDING TO TRUE
  9757     END-IF.
  9758
  9759     GO TO 1052-EXIT.
  9760
  9761 1052-DONE.
  9762     SET TRLR-FILE-EOF TO TRUE.
  9763 1052-EXIT.
  9764     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 176
* EL131.cbl
  9766 1120-EDIT-PROC.
  9767     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9768     MOVE '2'                    TO CNTL-REC-TYPE.
  9769     MOVE PROCI                  TO CNTL-PROC-ID.
  9770     MOVE ZERO                   TO CNTL-SEQ-NO.
  9771
  9772
  9773* EXEC CICS HANDLE CONDITION
  9774*         NOTFND    (1120-CNTL-NOTFND)
  9775*    END-EXEC.
  9776*    MOVE '"$I                   ! '' #00009234' TO DFHEIV0
  9777     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9779     MOVE X'2720233030303039323334' TO DFHEIV0(25:11)
  9780     CALL 'kxdfhei1' USING DFHEIV0
  9781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9782
  9783
  9784
  9785* EXEC CICS READ
  9786*         SET      (ADDRESS OF CONTROL-FILE)
  9787*         DATASET  (CNTL-FILE-ID)
  9788*         RIDFLD   (CNTL-KEY)
  9789*    END-EXEC.
  9790*    MOVE '&"S        E          (   #00009238' TO DFHEIV0
  9791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9793     MOVE X'2020233030303039323338' TO DFHEIV0(25:11)
  9794     CALL 'kxdfhei1' USING DFHEIV0,
  9795           CNTL-FILE-ID,
  9796           DFHEIV20,
  9797           DFHEIV99,
  9798           CNTL-KEY,
  9799           DFHEIV99,
  9800           DFHEIV99,
  9801           DFHEIV99
  9802     SET ADDRESS OF CONTROL-FILE TO
  9803         DFHEIV20
  9804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9805
  9806
  9807     MOVE AL-UANON               TO PROCA.
  9808     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9809     GO TO 1120-EXIT.
  9810
  9811 1120-CNTL-NOTFND.
  9812     MOVE ER-0273                TO EMI-ERROR.
  9813     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9814     MOVE AL-UABON               TO PROCA.
  9815     MOVE -1                     TO PROCL.
  9816     MOVE 'X'                    TO ERROR-SWITCH.
  9817
  9818 1120-EXIT.
  9819     EXIT.
  9820
  9821*************************************************************
  9822*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9823*************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 177
* EL131.cbl
  9824
  9825 1150-OUTPUT-ACTIVITY-RECORD.
  9826
  9827
  9828* EXEC CICS GETMAIN
  9829*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9830*        LENGTH (25)
  9831*        INITIMG (WS-BLANK)
  9832*    END-EXEC.
  9833     MOVE 25
  9834       TO DFHEIV11
  9835*    MOVE ',"IL                  $   #00009264' TO DFHEIV0
  9836     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9837     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9838     MOVE X'2020233030303039323634' TO DFHEIV0(25:11)
  9839     CALL 'kxdfhei1' USING DFHEIV0,
  9840           DFHEIV20,
  9841           DFHEIV11,
  9842           WS-BLANK
  9843     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9844         DFHEIV20
  9845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9846
  9847
  9848     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9849     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9850     MOVE PI-CARRIER             TO DA-CARRIER.
  9851     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9852     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9853     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9854     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9855
  9856
  9857* EXEC CICS HANDLE CONDITION
  9858*        NOTOPEN (1150-NOTOPEN-ERROR)
  9859*        DUPREC (1150-EXIT)
  9860*    END-EXEC.
  9861*    MOVE '"$J%                  ! ( #00009278' TO DFHEIV0
  9862     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9864     MOVE X'2820233030303039323738' TO DFHEIV0(25:11)
  9865     CALL 'kxdfhei1' USING DFHEIV0
  9866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9867
  9868     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9869     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9870     MOVE 'A'                    TO JP-RECORD-TYPE.
  9871     MOVE +48                    TO JOURNAL-LENGTH.
  9872
  9873
  9874* EXEC CICS WRITE
  9875*        DATASET ('DLYACTV')
  9876*        RIDFLD (DA-KEY)
  9877*        FROM (DAILY-ACTIVITY-RECORD)
  9878*        LENGTH (25)
  9879*    END-EXEC.
  9880     MOVE 'DLYACTV' TO DFHEIV1
  9881     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 178
* EL131.cbl
  9882       TO DFHEIV11
  9883*    MOVE '&$ L                  ''   #00009287' TO DFHEIV0
  9884     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039323837' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           DFHEIV1,
  9889           DAILY-ACTIVITY-RECORD,
  9890           DFHEIV11,
  9891           DA-KEY,
  9892           DFHEIV99,
  9893           DFHEIV99
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9895
  9896
  9897     GO TO 1150-EXIT.
  9898
  9899 1150-NOTOPEN-ERROR.
  9900
  9901     MOVE '2955'                 TO EMI-ERROR.
  9902     MOVE -1                     TO MAINTL.
  9903     MOVE AL-UANON               TO MAINTA.
  9904     MOVE 'X'                    TO ERROR-SWITCH.
  9905     PERFORM 9900-ERROR-FORMAT THRU
  9906             9900-EXIT.
  9907
  9908 1150-EXIT.
  9909     EXIT.
  9910
  9911*************************************************************
  9912*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9913*************************************************************
  9914
  9915 1240-EDIT-LIFE-CODE.
  9916
  9917     IF INVALID-BENEFIT-CODE
  9918         GO TO 1240-SET-ERROR.
  9919
  9920     MOVE SPACES                 TO BENEFIT-KEY.
  9921     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9922     MOVE '4'                    TO BEN-REC-TYPE.
  9923     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9924     MOVE ZERO                   TO BEN-SEQ-NO.
  9925
  9926
  9927* EXEC CICS READ GTEQ
  9928*         DATASET  (CNTL-FILE-ID)
  9929*         RIDFLD   (BENEFIT-KEY)
  9930*         SET      (ADDRESS OF CONTROL-FILE)
  9931*    END-EXEC.
  9932*    MOVE '&"S        G          (   #00009323' TO DFHEIV0
  9933     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9935     MOVE X'2020233030303039333233' TO DFHEIV0(25:11)
  9936     CALL 'kxdfhei1' USING DFHEIV0,
  9937           CNTL-FILE-ID,
  9938           DFHEIV20,
  9939           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 179
* EL131.cbl
  9940           BENEFIT-KEY,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99
  9944     SET ADDRESS OF CONTROL-FILE TO
  9945         DFHEIV20
  9946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9947
  9948
  9949     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9950        CF-RECORD-TYPE NOT = '4'
  9951         GO TO 1240-SET-ERROR.
  9952
  9953     MOVE ZERO                   TO COUNT-2.
  9954     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9955
  9956     IF SCREEN-ERROR
  9957         GO TO 1240-SET-ERROR.
  9958
  9959 1240-SET-CODE-SWITCHES.
  9960     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9961     MOVE AL-UANON               TO LCVCDA.
  9962     GO TO 1240-EXIT.
  9963
  9964 1240-SET-ERROR.
  9965     MOVE ER-0240                TO EMI-ERROR.
  9966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9967     MOVE 'X'                    TO ERROR-SWITCH.
  9968     MOVE AL-UABON               TO LCVCDA.
  9969     MOVE -1                     TO LCVCDL.
  9970
  9971 1240-EXIT.
  9972     EXIT.
  9973
  9974 1310-EDIT-AH-CODE.
  9975     IF INVALID-BENEFIT-CODE
  9976         GO TO 1310-SET-ERROR.
  9977
  9978     MOVE SPACES                 TO BENEFIT-KEY.
  9979     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9980     MOVE '5'                    TO BEN-REC-TYPE.
  9981     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9982     MOVE ZERO                   TO BEN-SEQ-NO.
  9983
  9984
  9985* EXEC CICS READ GTEQ
  9986*         DATASET  (CNTL-FILE-ID)
  9987*         RIDFLD   (BENEFIT-KEY)
  9988*         SET      (ADDRESS OF CONTROL-FILE)
  9989*    END-EXEC.
  9990*    MOVE '&"S        G          (   #00009364' TO DFHEIV0
  9991     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9993     MOVE X'2020233030303039333634' TO DFHEIV0(25:11)
  9994     CALL 'kxdfhei1' USING DFHEIV0,
  9995           CNTL-FILE-ID,
  9996           DFHEIV20,
  9997           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 180
* EL131.cbl
  9998           BENEFIT-KEY,
  9999           DFHEIV99,
 10000           DFHEIV99,
 10001           DFHEIV99
 10002     SET ADDRESS OF CONTROL-FILE TO
 10003         DFHEIV20
 10004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10005
 10006
 10007     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10008        CF-RECORD-TYPE NOT = '5'
 10009         GO TO 1310-SET-ERROR.
 10010
 10011     MOVE ZERO                   TO COUNT-2.
 10012     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10013     IF SCREEN-ERROR
 10014         GO TO 1310-SET-ERROR.
 10015
 10016 1310-SET-CODE-SWITCHES.
 10017     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10018     MOVE AL-UANON               TO ACVCDA.
 10019     GO TO 1310-EXIT.
 10020
 10021 1310-SET-ERROR.
 10022     MOVE ER-0250                TO EMI-ERROR.
 10023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10024     MOVE AL-UABON               TO ACVCDA.
 10025     MOVE 'X'                    TO ERROR-SWITCH.
 10026     MOVE -1                     TO ACVCDL.
 10027
 10028 1310-EXIT.
 10029     EXIT.
 10030
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 181
* EL131.cbl
 10032 1460-EDIT-CERT-NO.
 10033     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10034     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10035
 10036     IF WS-SAVE-CERT-NO = SPACES
 10037         MOVE ER-0203            TO EMI-ERROR
 10038         GO TO 1460-CERT-NO-ERROR.
 10039
 10040     IF WS-CERT-NO-PRIME = SPACES AND
 10041        WS-CERT-NO-SUFX GREATER THAN SPACE
 10042            MOVE ER-0210         TO EMI-ERROR
 10043            GO TO 1460-CERT-NO-ERROR.
 10044
 10045     MOVE 'X'                    TO UPDATE-SWITCH.
 10046     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10047     MOVE AL-UANON               TO CERTA.
 10048
 10049     IF SUFXL IS GREATER THAN 0
 10050         MOVE AL-UANON           TO SUFXA.
 10051
 10052     GO TO 1460-EXIT.
 10053
 10054 1460-CERT-NO-ERROR.
 10055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10056     MOVE AL-UABON               TO SUFXA.
 10057     MOVE AL-UABON               TO CERTA.
 10058     MOVE -1                     TO CERTL.
 10059     MOVE 'X'                    TO ERROR-SWITCH.
 10060
 10061 1460-EXIT.
 10062     EXIT.
 10063
 10064 1470-EDIT-EFF.
 10065     IF CERTEFFI = SPACES
 10066         GO TO 1470-DATE-ERROR.
 10067
 10068     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10069     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10070     IF DEEDIT-DATE = ZERO
 10071         GO TO 1470-DATE-ERROR.
 10072
 10073     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10074     MOVE '4'                    TO DC-OPTION-CODE.
 10075     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10076     IF NOT DATE-CONVERSION-ERROR
 10077         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10078         MOVE AL-UANON           TO CERTEFFA
 10079         MOVE 'X'                TO UPDATE-SWITCH
 10080         MOVE 'Y'                TO CERT-KEY-SWITCH
 10081         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10082         GO TO 1470-EXIT.
 10083
 10084 1470-DATE-ERROR.
 10085     MOVE ER-0215                TO EMI-ERROR.
 10086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10087     MOVE AL-UABON               TO CERTEFFA.
 10088     MOVE -1                     TO CERTEFFL.
 10089     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 182
* EL131.cbl
 10090
 10091 1470-EXIT.
 10092     EXIT.
 10093
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 183
* EL131.cbl
 10095 1480-EDIT-ACCT.
 10096     IF CERTACTI = SPACES
 10097         MOVE ER-0232            TO EMI-ERROR
 10098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10099         MOVE AL-UABON           TO CERTACTA
 10100         MOVE -1                 TO CERTACTL
 10101         MOVE 'X'                TO ERROR-SWITCH
 10102     ELSE
 10103         MOVE 'X'                TO UPDATE-SWITCH
 10104         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10105
 10106 1480-EXIT.
 10107     EXIT.
 10108
 10109 1490-EDIT-STATE.
 10110     IF CERTSTI = SPACES
 10111         MOVE ER-0233            TO EMI-ERROR
 10112         GO TO 1490-STATE-ERROR.
 10113
 10114     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10115     MOVE '3'                    TO CNTL-REC-TYPE.
 10116     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10117     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10118     MOVE ZERO                   TO CNTL-SEQ-NO.
 10119
 10120
 10121* EXEC CICS HANDLE CONDITION
 10122*         NOTFND (1490-STATE-NOTFND)
 10123*    END-EXEC.
 10124*    MOVE '"$I                   ! ) #00009483' TO DFHEIV0
 10125     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10127     MOVE X'2920233030303039343833' TO DFHEIV0(25:11)
 10128     CALL 'kxdfhei1' USING DFHEIV0
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
 10131
 10132
 10133* EXEC CICS READ
 10134*         SET        (ADDRESS OF CONTROL-FILE)
 10135*         DATASET    ('ELCNTL')
 10136*         RIDFLD     (CNTL-KEY)
 10137*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10138*         GENERIC
 10139*    END-EXEC.
 10140     MOVE 'ELCNTL' TO DFHEIV1
 10141*    MOVE '&"S  KG    E          (   #00009487' TO DFHEIV0
 10142     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10144     MOVE X'2020233030303039343837' TO DFHEIV0(25:11)
 10145     CALL 'kxdfhei1' USING DFHEIV0,
 10146           DFHEIV1,
 10147           DFHEIV20,
 10148           DFHEIV99,
 10149           CNTL-KEY,
 10150           CNTL-GENERIC-LENGTH,
 10151           DFHEIV99,
 10152           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 184
* EL131.cbl
 10153     SET ADDRESS OF CONTROL-FILE TO
 10154         DFHEIV20
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158     MOVE AL-UANON               TO CERTSTA.
 10159     MOVE 'X'                    TO UPDATE-SWITCH.
 10160     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10161     GO TO 1490-EXIT.
 10162
 10163 1490-STATE-NOTFND.
 10164     MOVE ER-0149                TO EMI-ERROR.
 10165
 10166 1490-STATE-ERROR.
 10167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10168     MOVE AL-UABON               TO CERTSTA.
 10169     MOVE -1                     TO CERTSTL.
 10170     MOVE 'X'                    TO ERROR-SWITCH.
 10171
 10172 1490-EXIT.
 10173     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 185
* EL131.cbl
 10175 1500-EDIT-CARR.
 10176     IF CERTCARI = SPACES
 10177         GO TO 1500-CARR-NOTFND.
 10178
 10179     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10180     MOVE '6'                    TO CNTL-REC-TYPE.
 10181     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10182     MOVE CERTCARI               TO CNTL-CARRIER.
 10183     MOVE ZERO                   TO CNTL-SEQ-NO.
 10184
 10185
 10186* EXEC CICS HANDLE CONDITION
 10187*         NOTFND   (1500-CARR-NOTFND)
 10188*    END-EXEC.
 10189*    MOVE '"$I                   ! * #00009522' TO DFHEIV0
 10190     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10192     MOVE X'2A20233030303039353232' TO DFHEIV0(25:11)
 10193     CALL 'kxdfhei1' USING DFHEIV0
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
 10197
 10198* EXEC CICS READ
 10199*         SET        (ADDRESS OF CONTROL-FILE)
 10200*         DATASET    ('ELCNTL')
 10201*         RIDFLD     (CNTL-KEY)
 10202*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10203*         GENERIC
 10204*    END-EXEC.
 10205     MOVE 'ELCNTL' TO DFHEIV1
 10206*    MOVE '&"S  KG    E          (   #00009526' TO DFHEIV0
 10207     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10209     MOVE X'2020233030303039353236' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0,
 10211           DFHEIV1,
 10212           DFHEIV20,
 10213           DFHEIV99,
 10214           CNTL-KEY,
 10215           CNTL-GENERIC-LENGTH,
 10216           DFHEIV99,
 10217           DFHEIV99
 10218     SET ADDRESS OF CONTROL-FILE TO
 10219         DFHEIV20
 10220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10221
 10222
 10223     MOVE AL-UANON               TO CERTCARA.
 10224     MOVE 'X'                    TO UPDATE-SWITCH.
 10225     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10226     GO TO 1500-EXIT.
 10227
 10228 1500-CARR-NOTFND.
 10229     MOVE ER-0360                TO EMI-ERROR.
 10230     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10231     MOVE AL-UABON               TO CERTCARA.
 10232     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 186
* EL131.cbl
 10233     MOVE 'X'                    TO ERROR-SWITCH.
 10234
 10235 1500-EXIT.
 10236     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 187
* EL131.cbl
 10238 1510-DEEDIT-DATE.
 10239
 10240* EXEC CICS BIF DEEDIT
 10241*         FIELD    (DEEDIT-DATE-INPUT)
 10242*         LENGTH   (DATE-LENGTH)
 10243*    END-EXEC.
 10244*    MOVE '@"L                   #   #00009550' TO DFHEIV0
 10245     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10247     MOVE X'2020233030303039353530' TO DFHEIV0(25:11)
 10248     CALL 'kxdfhei1' USING DFHEIV0,
 10249           DEEDIT-DATE-INPUT,
 10250           DATE-LENGTH
 10251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10252
 10253
 10254 1510-EXIT.
 10255     EXIT.
 10256
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 188
* EL131.cbl
 10258 1620-VERIFY-ACCT.
 10259
 10260     move ' '                    to ws-eracct-sw
 10261     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10262     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10263     MOVE PI-GROUPING            TO ACCT-GROUP.
 10264     MOVE PI-STATE               TO ACCT-STATE.
 10265     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10266
 10267     IF CERTEFFI GREATER THAN LOW-VALUES
 10268         MOVE HOLD-EFF           TO ACCT-DATE
 10269     ELSE
 10270         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10271
 10272     IF CERTACTI GREATER THAN LOW-VALUES
 10273         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10274     IF CERTSTI GREATER THAN LOW-VALUES
 10275         MOVE CERTSTI            TO  ACCT-STATE.
 10276     IF CERTCARI GREATER THAN LOW-VALUES
 10277         MOVE CERTCARI           TO  ACCT-CARRIER.
 10278     IF CERTGRPI GREATER THAN LOW-VALUES
 10279         MOVE CERTGRPI           TO ACCT-GROUP.
 10280
 10281     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10282
 10283
 10284* EXEC CICS HANDLE CONDITION
 10285*         NOTFND  (1620-ACCT-NOTFND)
 10286*    END-EXEC.
 10287*    MOVE '"$I                   ! + #00009584' TO DFHEIV0
 10288     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10290     MOVE X'2B20233030303039353834' TO DFHEIV0(25:11)
 10291     CALL 'kxdfhei1' USING DFHEIV0
 10292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10293
 10294
 10295
 10296* EXEC CICS STARTBR
 10297*         DATASET   (ACCT-FILE-ID)
 10298*         RIDFLD    (ACCT-KEY)
 10299*    END-EXEC.
 10300     MOVE 0
 10301       TO DFHEIV11
 10302*    MOVE '&,         G          &   #00009588' TO DFHEIV0
 10303     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10304     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10305     MOVE X'2020233030303039353838' TO DFHEIV0(25:11)
 10306     CALL 'kxdfhei1' USING DFHEIV0,
 10307           ACCT-FILE-ID,
 10308           ACCT-KEY,
 10309           DFHEIV99,
 10310           DFHEIV11,
 10311           DFHEIV99
 10312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10313
 10314
 10315 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 189
* EL131.cbl
 10316
 10317
 10318* EXEC CICS READNEXT
 10319*         DATASET  (ACCT-FILE-ID)
 10320*         RIDFLD   (ACCT-KEY)
 10321*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10322*    END-EXEC.
 10323     MOVE 0
 10324       TO DFHEIV11
 10325*    MOVE '&.S                   )   #00009595' TO DFHEIV0
 10326     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10327     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10328     MOVE X'2020233030303039353935' TO DFHEIV0(25:11)
 10329     CALL 'kxdfhei1' USING DFHEIV0,
 10330           ACCT-FILE-ID,
 10331           DFHEIV20,
 10332           DFHEIV99,
 10333           ACCT-KEY,
 10334           DFHEIV99,
 10335           DFHEIV11,
 10336           DFHEIV99,
 10337           DFHEIV99
 10338     SET ADDRESS OF ACCOUNT-MASTER TO
 10339         DFHEIV20
 10340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10341
 10342
 10343     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10344         GO TO 1620-ACCT-NOTFND.
 10345
 10346     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10347        HOLD-EFF     LESS AM-EXPIRATION-DT
 10348         NEXT SENTENCE
 10349     ELSE
 10350         GO TO 1620-ACCT-LOOP.
 10351
 10352     set acct-found to true
 10353     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10354         GO TO 1620-ACCT-END-BROWSE.
 10355
 10356     IF LOANBALL GREATER THAN +0
 10357         IF AM-MAX-TOT-BEN NUMERIC  AND
 10358            AM-MAX-TOT-BEN GREATER THAN ZERO
 10359             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10360                 MOVE AL-UNBON     TO LOANBALA
 10361                 MOVE -1           TO LOANBALL
 10362                 MOVE 'X'          TO ERROR-SWITCH
 10363                 MOVE ER-7641      TO EMI-ERROR
 10364                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10365
 10366     IF ACVBENEL GREATER THAN +0
 10367         IF AM-MAX-MON-BEN NUMERIC  AND
 10368            AM-MAX-MON-BEN GREATER THAN ZERO
 10369             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10370                 MOVE AL-UNBON     TO ACVBENEA
 10371                 MOVE -1           TO ACVBENEL
 10372                 MOVE 'X'          TO ERROR-SWITCH
 10373                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 190
* EL131.cbl
 10374                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10375
 10376 1620-ACCT-END-BROWSE.
 10377
 10378
 10379* EXEC CICS ENDBR
 10380*         DATASET (ACCT-FILE-ID)
 10381*    END-EXEC.
 10382     MOVE 0
 10383       TO DFHEIV11
 10384*    MOVE '&2                    $   #00009636' TO DFHEIV0
 10385     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10387     MOVE X'2020233030303039363336' TO DFHEIV0(25:11)
 10388     CALL 'kxdfhei1' USING DFHEIV0,
 10389           ACCT-FILE-ID,
 10390           DFHEIV11,
 10391           DFHEIV99
 10392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10393
 10394
 10395     GO TO 1620-EXIT.
 10396
 10397 1620-ACCT-NOTFND.
 10398
 10399     MOVE -1                     TO MAINTL.
 10400     MOVE 'X'                    TO ERROR-SWITCH.
 10401     MOVE ER-0426                TO EMI-ERROR.
 10402     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10403
 10404 1620-EXIT.
 10405     EXIT.
 10406
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 191
* EL131.cbl
 10408 2000-UPDATE-CLAIM.
 10409
 10410     MOVE SPACES                 TO ERROR-SWITCH.
 10411     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10412     MOVE PI-CARRIER             TO CARRIER-CODE.
 10413     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10414     MOVE PI-CERT-NO             TO CERT-NO.
 10415
 10416     IF DELETE-CLAIM
 10417         GO TO 3000-DELETE-CLAIM.
 10418
 10419     IF  NOT MODIFY-CAP
 10420         MOVE ER-0070            TO EMI-ERROR
 10421         MOVE 'X'                TO ERROR-SWITCH
 10422         MOVE -1                 TO MAINTL
 10423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10424         GO TO 2000-EXIT.
 10425
 10426     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10427     MOVE ZERO                   TO TRLR-SEQ-NO.
 10428
 10429
 10430* EXEC CICS READ UPDATE
 10431*         SET       (ADDRESS OF CLAIM-MASTER)
 10432*         DATASET   (CLMS-FILE-ID)
 10433*         RIDFLD    (MSTR-KEY)
 10434*    END-EXEC.
 10435*    MOVE '&"S        EU         (   #00009674' TO DFHEIV0
 10436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10437     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10438     MOVE X'2020233030303039363734' TO DFHEIV0(25:11)
 10439     CALL 'kxdfhei1' USING DFHEIV0,
 10440           CLMS-FILE-ID,
 10441           DFHEIV20,
 10442           DFHEIV99,
 10443           MSTR-KEY,
 10444           DFHEIV99,
 10445           DFHEIV99,
 10446           DFHEIV99
 10447     SET ADDRESS OF CLAIM-MASTER TO
 10448         DFHEIV20
 10449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10450
 10451
 10452     if (incl > zeros)
 10453        and (cl-no-of-pmts-made > 0)
 10454        and (hold-incur > low-values)
 10455        and (hold-incur not = cl-incurred-dt)
 10456        if hold-incur > cl-incurred-dt
 10457           move cl-incurred-dt   to dc-bin-date-1
 10458           move hold-incur       to dc-bin-date-2
 10459        else
 10460           move hold-incur       to dc-bin-date-1
 10461           move cl-incurred-dt   to dc-bin-date-2
 10462        end-if
 10463        move '1'                 to dc-option-code
 10464        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10465        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 192
* EL131.cbl
 10466           MOVE ER-1663             TO EMI-ERROR
 10467           PERFORM 9900-ERROR-FORMAT
 10468                                 THRU 9900-EXIT
 10469           MOVE -1                  TO MAINTL
 10470           GO TO 8110-SEND-DATA
 10471        end-if
 10472     end-if
 10473     IF (CL-PRIORITY-CD = '8')
 10474        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10475             AND 'AMWA' AND 'KMSB')
 10476        MOVE ER-8003             TO EMI-ERROR
 10477        PERFORM 9900-ERROR-FORMAT
 10478                                 THRU 9900-EXIT
 10479        MOVE -1                  TO MAINTL
 10480        GO TO 8110-SEND-DATA
 10481     END-IF
 10482
 10483     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10484         MOVE ER-0068            TO EMI-ERROR
 10485         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10486         GO TO 2000-EXIT.
 10487
 10488     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10489         MOVE ER-0068            TO EMI-ERROR
 10490         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10491         GO TO 2000-EXIT.
 10492
 10493     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10494         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10495
 10496     IF CL-PURGED-DT NOT = LOW-VALUES
 10497         MOVE ER-7691            TO EMI-ERROR
 10498         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10499         GO TO 2000-EXIT.
 10500
 10501     IF CERT-KEY-CHANGED
 10502         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10503
 10504     IF SCREEN-ERROR
 10505         MOVE ER-0068            TO EMI-ERROR
 10506         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10507         GO TO 2000-EXIT.
 10508
 10509     IF NINETY-TRLR-UPDATED
 10510         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10511
 10512     IF MSTR-KEY-CHANGED
 10513         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10514        ELSE
 10515         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10516
 10517     IF TRLR-UPDATE-REQUIRED
 10518         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10519
 10520 2000-CHECK-CERT.
 10521     IF NOT CERT-UPDATES
 10522         GO TO 2000-EXIT.
 10523
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 193
* EL131.cbl
 10524     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10525     MOVE PI-CARRIER             TO CERT-CARRIER.
 10526     MOVE PI-GROUPING            TO CERT-GROUP.
 10527     MOVE PI-STATE               TO CERT-STATE.
 10528     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10529     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10530     MOVE PI-CERT-NO             TO CERT-CERT.
 10531
 10532     IF CERT-ALT-KEY-CHANGED
 10533         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10534     ELSE
 10535         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10536
 10537 2000-EXIT.
 10538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 194
* EL131.cbl
 10540 2010-RELEASE-REC.
 10541
 10542* EXEC CICS UNLOCK
 10543*         DATASET  (CLMS-FILE-ID)
 10544*    END-EXEC
 10545*    MOVE '&*                    #   #00009769' TO DFHEIV0
 10546     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10547     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10548     MOVE X'2020233030303039373639' TO DFHEIV0(25:11)
 10549     CALL 'kxdfhei1' USING DFHEIV0,
 10550           CLMS-FILE-ID,
 10551           DFHEIV99
 10552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10553
 10554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10555     MOVE 'X'                    TO ERROR-SWITCH.
 10556
 10557 2010-EXIT.
 10558     EXIT.
 10559
 10560 2020-NORMAL-UPDATE.
 10561     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10562
 10563     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10564
 10565     IF WS-OPEN-CLOSE-SW = 'Y'
 10566       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10567       IF PI-REC-FOUND-SW = 'Y'
 10568         IF CL-ACTIVITY-CODE = 09
 10569           NEXT SENTENCE
 10570         ELSE
 10571           IF WS-RESET-SW = 'Y'
 10572             IF CL-CLAIM-STATUS = 'C'
 10573               MOVE 07               TO  CL-ACTIVITY-CODE
 10574               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10575               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10576             ELSE
 10577               MOVE 08               TO  CL-ACTIVITY-CODE
 10578               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10579               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10580
 10581     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10582         MOVE 'Y'                TO CL-YESNOSW
 10583     END-IF.
 10584
 10585     if pi-company-id = 'DCC' OR 'VPP'
 10586        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10587        perform 2120-check-pdef  thru 2120-exit
 10588     end-if
 10589     if ((benperl <> zeros)
 10590        and (benperi numeric))
 10591                  or
 10592            (instypel <> zeros)
 10593        perform 2140-update-elcrtt thru 2140-exit
 10594     end-if
 10595
 10596* EXEC CICS HANDLE CONDITION
 10597*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 195
* EL131.cbl
 10598*    END-EXEC.
 10599*    MOVE '"$$                   ! , #00009814' TO DFHEIV0
 10600     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10602     MOVE X'2C20233030303039383134' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0
 10604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10605
 10606
 10607
 10608* EXEC CICS REWRITE
 10609*         DATASET   (CLMS-FILE-ID)
 10610*         FROM      (CLAIM-MASTER)
 10611*    END-EXEC.
 10612     MOVE LENGTH OF
 10613      CLAIM-MASTER
 10614       TO DFHEIV11
 10615*    MOVE '&& L                  %   #00009818' TO DFHEIV0
 10616     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10617     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10618     MOVE X'2020233030303039383138' TO DFHEIV0(25:11)
 10619     CALL 'kxdfhei1' USING DFHEIV0,
 10620           CLMS-FILE-ID,
 10621           CLAIM-MASTER,
 10622           DFHEIV11,
 10623           DFHEIV99
 10624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10625
 10626
 10627 2020-EXIT.
 10628     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 196
* EL131.cbl
 10630 2030-KEY-UPDATE.
 10631     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10632
 10633
 10634* EXEC CICS DELETE
 10635*        DATASET  (CLMS-FILE-ID)
 10636*    END-EXEC.
 10637*    MOVE '&(                    &   #00009829' TO DFHEIV0
 10638     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10639     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10640     MOVE X'2020233030303039383239' TO DFHEIV0(25:11)
 10641     CALL 'kxdfhei1' USING DFHEIV0,
 10642           CLMS-FILE-ID,
 10643           DFHEIV99,
 10644           DFHEIV99,
 10645           DFHEIV99,
 10646           DFHEIV99
 10647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10648
 10649
 10650
 10651* EXEC CICS GETMAIN
 10652*         SET      (ADDRESS OF CLAIM-MASTER)
 10653*         LENGTH   (MSTR-LENGTH)
 10654*         INITIMG  (GETMAIN-SPACE)
 10655*    END-EXEC.
 10656*    MOVE ',"IL                  $   #00009833' TO DFHEIV0
 10657     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10659     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
 10660     CALL 'kxdfhei1' USING DFHEIV0,
 10661           DFHEIV20,
 10662           MSTR-LENGTH,
 10663           GETMAIN-SPACE
 10664     SET ADDRESS OF CLAIM-MASTER TO
 10665         DFHEIV20
 10666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10667
 10668
 10669     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10670
 10671     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10672
 10673     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10674
 10675     IF WS-OPEN-CLOSE-SW = 'Y'
 10676       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10677         IF PI-REC-FOUND-SW = 'Y'
 10678           IF CL-ACTIVITY-CODE = 09
 10679             NEXT SENTENCE
 10680           ELSE
 10681             IF WS-RESET-SW = 'Y'
 10682               IF CL-CLAIM-STATUS = 'C'
 10683                 MOVE 07             TO  CL-ACTIVITY-CODE
 10684                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10685                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10686               ELSE
 10687                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 197
* EL131.cbl
 10688                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10689                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10690
 10691
 10692* EXEC CICS HANDLE CONDITION
 10693*         DUPKEY    (2030-EXIT)
 10694*    END-EXEC.
 10695*    MOVE '"$$                   ! - #00009861' TO DFHEIV0
 10696     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10698     MOVE X'2D20233030303039383631' TO DFHEIV0(25:11)
 10699     CALL 'kxdfhei1' USING DFHEIV0
 10700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10701
 10702
 10703** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10704*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10705
 10706     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10707         MOVE 'Y'                TO CL-YESNOSW
 10708     END-IF.
 10709
 10710
 10711* EXEC CICS WRITE
 10712*         DATASET   (CLMS-FILE-ID)
 10713*         RIDFLD    (MSTR-KEY)
 10714*         FROM      (CLAIM-MASTER)
 10715*    END-EXEC.
 10716     MOVE LENGTH OF
 10717      CLAIM-MASTER
 10718       TO DFHEIV11
 10719*    MOVE '&$ L                  ''   #00009872' TO DFHEIV0
 10720     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10721     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10722     MOVE X'2020233030303039383732' TO DFHEIV0(25:11)
 10723     CALL 'kxdfhei1' USING DFHEIV0,
 10724           CLMS-FILE-ID,
 10725           CLAIM-MASTER,
 10726           DFHEIV11,
 10727           MSTR-KEY,
 10728           DFHEIV99,
 10729           DFHEIV99
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10731
 10732
 10733 2030-EXIT.
 10734     EXIT.
 10735
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 198
* EL131.cbl
 10737 2040-NORMAL-UPDATE.
 10738
 10739* EXEC CICS READ UPDATE
 10740*         DATASET  (CERT-FILE-ID)
 10741*         RIDFLD   (CERT-KEY)
 10742*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10743*    END-EXEC.
 10744*    MOVE '&"S        EU         (   #00009883' TO DFHEIV0
 10745     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10746     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10747     MOVE X'2020233030303039383833' TO DFHEIV0(25:11)
 10748     CALL 'kxdfhei1' USING DFHEIV0,
 10749           CERT-FILE-ID,
 10750           DFHEIV20,
 10751           DFHEIV99,
 10752           CERT-KEY,
 10753           DFHEIV99,
 10754           DFHEIV99,
 10755           DFHEIV99
 10756     SET ADDRESS OF CERTIFICATE-MASTER TO
 10757         DFHEIV20
 10758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10759
 10760
 10761     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10762
 10763
 10764* EXEC CICS HANDLE CONDITION
 10765*         DUPKEY   (2040-EXIT)
 10766*    END-EXEC.
 10767*    MOVE '"$$                   ! . #00009891' TO DFHEIV0
 10768     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10770     MOVE X'2E20233030303039383931' TO DFHEIV0(25:11)
 10771     CALL 'kxdfhei1' USING DFHEIV0
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
 10775
 10776* EXEC CICS REWRITE
 10777*         DATASET  (CERT-FILE-ID)
 10778*         FROM     (CERTIFICATE-MASTER)
 10779*    END-EXEC.
 10780     MOVE LENGTH OF
 10781      CERTIFICATE-MASTER
 10782       TO DFHEIV11
 10783*    MOVE '&& L                  %   #00009895' TO DFHEIV0
 10784     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10785     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10786     MOVE X'2020233030303039383935' TO DFHEIV0(25:11)
 10787     CALL 'kxdfhei1' USING DFHEIV0,
 10788           CERT-FILE-ID,
 10789           CERTIFICATE-MASTER,
 10790           DFHEIV11,
 10791           DFHEIV99
 10792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10793
 10794
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 199
* EL131.cbl
 10795 2040-EXIT.
 10796     EXIT.
 10797
 10798 2050-KEY-UPDATE.
 10799
 10800* EXEC CICS READ UPDATE
 10801*         DATASET  (CERT-FILE-ID)
 10802*         RIDFLD   (CERT-KEY)
 10803*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10804*    END-EXEC.
 10805*    MOVE '&"S        EU         (   #00009904' TO DFHEIV0
 10806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10807     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10808     MOVE X'2020233030303039393034' TO DFHEIV0(25:11)
 10809     CALL 'kxdfhei1' USING DFHEIV0,
 10810           CERT-FILE-ID,
 10811           DFHEIV20,
 10812           DFHEIV99,
 10813           CERT-KEY,
 10814           DFHEIV99,
 10815           DFHEIV99,
 10816           DFHEIV99
 10817     SET ADDRESS OF CERTIFICATE-MASTER TO
 10818         DFHEIV20
 10819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10820
 10821
 10822     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10823
 10824
 10825* EXEC CICS DELETE
 10826*         DATASET   (CERT-FILE-ID)
 10827*    END-EXEC.
 10828*    MOVE '&(                    &   #00009912' TO DFHEIV0
 10829     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10831     MOVE X'2020233030303039393132' TO DFHEIV0(25:11)
 10832     CALL 'kxdfhei1' USING DFHEIV0,
 10833           CERT-FILE-ID,
 10834           DFHEIV99,
 10835           DFHEIV99,
 10836           DFHEIV99,
 10837           DFHEIV99
 10838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10839
 10840
 10841
 10842* EXEC CICS GETMAIN
 10843*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10844*         LENGTH    (CERT-LENGTH)
 10845*         INITIMG   (GETMAIN-SPACE)
 10846*    END-EXEC.
 10847*    MOVE ',"IL                  $   #00009916' TO DFHEIV0
 10848     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10849     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10850     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 10851     CALL 'kxdfhei1' USING DFHEIV0,
 10852           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 200
* EL131.cbl
 10853           CERT-LENGTH,
 10854           GETMAIN-SPACE
 10855     SET ADDRESS OF CERTIFICATE-MASTER TO
 10856         DFHEIV20
 10857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10858
 10859
 10860     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10861
 10862     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10863
 10864
 10865* EXEC CICS HANDLE CONDITION
 10866*         DUPKEY (2050-EXIT)
 10867*    END-EXEC.
 10868*    MOVE '"$$                   ! / #00009926' TO DFHEIV0
 10869     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10871     MOVE X'2F20233030303039393236' TO DFHEIV0(25:11)
 10872     CALL 'kxdfhei1' USING DFHEIV0
 10873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10874
 10875
 10876
 10877* EXEC CICS WRITE
 10878*         DATASET  (CERT-FILE-ID)
 10879*         RIDFLD   (CERT-KEY)
 10880*         FROM     (CERTIFICATE-MASTER)
 10881*    END-EXEC.
 10882     MOVE LENGTH OF
 10883      CERTIFICATE-MASTER
 10884       TO DFHEIV11
 10885*    MOVE '&$ L                  ''   #00009930' TO DFHEIV0
 10886     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10888     MOVE X'2020233030303039393330' TO DFHEIV0(25:11)
 10889     CALL 'kxdfhei1' USING DFHEIV0,
 10890           CERT-FILE-ID,
 10891           CERTIFICATE-MASTER,
 10892           DFHEIV11,
 10893           CERT-KEY,
 10894           DFHEIV99,
 10895           DFHEIV99
 10896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10897
 10898
 10899 2050-EXIT.
 10900     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 201
* EL131.cbl
 10902 2060-CHANGE-CERT.
 10903     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10904     MOVE PI-CARRIER             TO CERT-CARRIER.
 10905     MOVE PI-GROUPING            TO CERT-GROUP.
 10906     MOVE PI-STATE               TO CERT-STATE.
 10907     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10908     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10909     MOVE PI-CERT-NO             TO CERT-CERT.
 10910     IF CERTEFFI GREATER THAN LOW-VALUES
 10911         MOVE HOLD-EFF           TO CERT-DATE.
 10912     IF CERTACTI GREATER THAN LOW-VALUES
 10913         MOVE CERTACTI           TO CERT-ACCOUNT.
 10914     IF CERTSTI GREATER THAN LOW-VALUES
 10915         MOVE CERTSTI            TO CERT-STATE.
 10916     IF CERTCARI GREATER THAN LOW-VALUES
 10917         MOVE CERTCARI           TO CERT-CARRIER.
 10918     IF CERTGRPI GREATER THAN LOW-VALUES
 10919         MOVE CERTGRPI           TO CERT-GROUP.
 10920     IF CERTI GREATER THAN LOW-VALUES
 10921         MOVE CERTI              TO CERT-CERT-PRIME.
 10922     IF SUFXI GREATER THAN LOW-VALUES
 10923         MOVE SUFXI              TO CERT-CERT-SUFX.
 10924
 10925
 10926* EXEC CICS HANDLE CONDITION
 10927*         NOTFND   (2060-CERT-NOTFND)
 10928*    END-EXEC.
 10929*    MOVE '"$I                   ! 0 #00009962' TO DFHEIV0
 10930     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10932     MOVE X'3020233030303039393632' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0
 10934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10935
 10936
 10937
 10938* EXEC CICS READ UPDATE
 10939*         DATASET  (CERT-FILE-ID)
 10940*         RIDFLD   (CERT-KEY)
 10941*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10942*    END-EXEC.
 10943*    MOVE '&"S        EU         (   #00009966' TO DFHEIV0
 10944     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10945     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10946     MOVE X'2020233030303039393636' TO DFHEIV0(25:11)
 10947     CALL 'kxdfhei1' USING DFHEIV0,
 10948           CERT-FILE-ID,
 10949           DFHEIV20,
 10950           DFHEIV99,
 10951           CERT-KEY,
 10952           DFHEIV99,
 10953           DFHEIV99,
 10954           DFHEIV99
 10955     SET ADDRESS OF CERTIFICATE-MASTER TO
 10956         DFHEIV20
 10957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10958
 10959
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 202
* EL131.cbl
 10960     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10961
 10962     IF CM-CLAIM-INTERFACE-SW = SPACES
 10963        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10964
 10965
 10966* EXEC CICS HANDLE CONDITION
 10967*         DUPKEY   (2060-DUPKEY)
 10968*    END-EXEC.
 10969*    MOVE '"$$                   ! 1 #00009977' TO DFHEIV0
 10970     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10972     MOVE X'3120233030303039393737' TO DFHEIV0(25:11)
 10973     CALL 'kxdfhei1' USING DFHEIV0
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977
 10978* EXEC CICS REWRITE
 10979*         DATASET  (CERT-FILE-ID)
 10980*         FROM     (CERTIFICATE-MASTER)
 10981*    END-EXEC.
 10982     MOVE LENGTH OF
 10983      CERTIFICATE-MASTER
 10984       TO DFHEIV11
 10985*    MOVE '&& L                  %   #00009981' TO DFHEIV0
 10986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10988     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10989     CALL 'kxdfhei1' USING DFHEIV0,
 10990           CERT-FILE-ID,
 10991           CERTIFICATE-MASTER,
 10992           DFHEIV11,
 10993           DFHEIV99
 10994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10995
 10996
 10997 2060-DUPKEY.
 10998
 10999     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11000
 11001 2060-CHANGE-TRLR-ACTQ.
 11002     IF SCREEN-ERROR
 11003         GO TO 2060-EXIT.
 11004
 11005     IF CERTI    GREATER LOW-VALUES OR
 11006        SUFXI    GREATER LOW-VALUES OR
 11007        CERTCARI GREATER LOW-VALUES
 11008         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11009         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11010
 11011     MOVE SPACES                 TO CERT-KEY-SWITCH
 11012                                    CERT-SWITCH
 11013                                    TRLR-SWITCH
 11014                                    NINETY-TRLR-SWITCH.
 11015     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11016     GO TO 2060-EXIT.
 11017
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 203
* EL131.cbl
 11018 2060-CERT-NOTFND.
 11019     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11020
 11021     IF WS-REC-FOUND-SW = 'N'
 11022         MOVE ER-0206            TO  EMI-ERROR
 11023         MOVE -1                 TO  MAINTL
 11024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11025
 11026* EXEC CICS UNLOCK
 11027*            DATASET   (CLMS-FILE-ID)
 11028*        END-EXEC
 11029*    MOVE '&*                    #   #00010014' TO DFHEIV0
 11030     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11032     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 11033     CALL 'kxdfhei1' USING DFHEIV0,
 11034           CLMS-FILE-ID,
 11035           DFHEIV99
 11036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11037         GO TO 8110-SEND-DATA.
 11038
 11039     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11040
 11041     GO TO 2060-CHANGE-TRLR-ACTQ.
 11042
 11043 2060-EXIT.
 11044     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 204
* EL131.cbl
 11046 2070-CHECK-OLD.
 11047
 11048
 11049* EXEC CICS HANDLE CONDITION
 11050*        NOTFND   (2070-NOT-FOUND)
 11051*    END-EXEC.
 11052*    MOVE '"$I                   ! 2 #00010028' TO DFHEIV0
 11053     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11055     MOVE X'3220233030303130303238' TO DFHEIV0(25:11)
 11056     CALL 'kxdfhei1' USING DFHEIV0
 11057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11058
 11059
 11060     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11061     MOVE PI-CARRIER             TO CERT-CARRIER.
 11062     MOVE PI-GROUPING            TO CERT-GROUP.
 11063     MOVE PI-STATE               TO CERT-STATE.
 11064     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11065     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11066     MOVE PI-CERT-NO             TO CERT-CERT.
 11067
 11068
 11069* EXEC CICS READ UPDATE
 11070*         DATASET  (CERT-FILE-ID)
 11071*         RIDFLD   (CERT-KEY)
 11072*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11073*    END-EXEC.
 11074*    MOVE '&"S        EU         (   #00010040' TO DFHEIV0
 11075     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11076     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11077     MOVE X'2020233030303130303430' TO DFHEIV0(25:11)
 11078     CALL 'kxdfhei1' USING DFHEIV0,
 11079           CERT-FILE-ID,
 11080           DFHEIV20,
 11081           DFHEIV99,
 11082           CERT-KEY,
 11083           DFHEIV99,
 11084           DFHEIV99,
 11085           DFHEIV99
 11086     SET ADDRESS OF CERTIFICATE-MASTER TO
 11087         DFHEIV20
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
 11091     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11092     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11093     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11094
 11095     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11096         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11097
 11098     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11099       AND
 11100        CERT-WAS-CREATED-FOR-CLAIM
 11101         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11102
 11103* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 205
* EL131.cbl
 11104*             DATASET   (CERT-FILE-ID)
 11105*        END-EXEC
 11106*    MOVE '&(                    &   #00010057' TO DFHEIV0
 11107     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11108     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11109     MOVE X'2020233030303130303537' TO DFHEIV0(25:11)
 11110     CALL 'kxdfhei1' USING DFHEIV0,
 11111           CERT-FILE-ID,
 11112           DFHEIV99,
 11113           DFHEIV99,
 11114           DFHEIV99,
 11115           DFHEIV99
 11116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11117         GO TO 2070-EXIT.
 11118
 11119     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11120         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11121
 11122
 11123* EXEC CICS HANDLE CONDITION
 11124*         DUPKEY   (2070-EXIT)
 11125*    END-EXEC.
 11126*    MOVE '"$$                   ! 3 #00010065' TO DFHEIV0
 11127     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11129     MOVE X'3320233030303130303635' TO DFHEIV0(25:11)
 11130     CALL 'kxdfhei1' USING DFHEIV0
 11131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11132
 11133
 11134
 11135* EXEC CICS REWRITE
 11136*         DATASET  (CERT-FILE-ID)
 11137*         FROM     (CERTIFICATE-MASTER)
 11138*    END-EXEC.
 11139     MOVE LENGTH OF
 11140      CERTIFICATE-MASTER
 11141       TO DFHEIV11
 11142*    MOVE '&& L                  %   #00010069' TO DFHEIV0
 11143     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11144     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11145     MOVE X'2020233030303130303639' TO DFHEIV0(25:11)
 11146     CALL 'kxdfhei1' USING DFHEIV0,
 11147           CERT-FILE-ID,
 11148           CERTIFICATE-MASTER,
 11149           DFHEIV11,
 11150           DFHEIV99
 11151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11152
 11153
 11154     GO TO 2070-EXIT.
 11155
 11156 2070-NOT-FOUND.
 11157     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11158
 11159 2070-EXIT.
 11160     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 206
* EL131.cbl
 11162 2080-CREATE-CERT.
 11163
 11164* EXEC CICS GETMAIN
 11165*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11166*         LENGTH    (CERT-LENGTH)
 11167*         INITIMG   (GETMAIN-SPACE)
 11168*    END-EXEC.
 11169*    MOVE ',"IL                  $   #00010083' TO DFHEIV0
 11170     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11172     MOVE X'2020233030303130303833' TO DFHEIV0(25:11)
 11173     CALL 'kxdfhei1' USING DFHEIV0,
 11174           DFHEIV20,
 11175           CERT-LENGTH,
 11176           GETMAIN-SPACE
 11177     SET ADDRESS OF CERTIFICATE-MASTER TO
 11178         DFHEIV20
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
 11182     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11183
 11184     IF CERTEFFI GREATER THAN LOW-VALUES
 11185         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11186                                    DC-BIN-DATE-1
 11187         MOVE '6'                TO DC-OPTION-CODE
 11188         MOVE +1                 TO DC-ELAPSED-MONTHS
 11189         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11190         IF NO-CONVERSION-ERROR
 11191             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11192
 11193     IF CERTACTI GREATER THAN LOW-VALUES
 11194         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11195     IF CERTSTI GREATER THAN LOW-VALUES
 11196         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11197     IF CERTCARI GREATER THAN LOW-VALUES
 11198         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11199     IF CERTGRPI GREATER THAN LOW-VALUES
 11200         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11201     IF CERTI GREATER THAN LOW-VALUES
 11202         MOVE CERTI              TO CERT-CERT-PRIME
 11203                                    CM-CERT-PRIME
 11204         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11205
 11206     IF SUFXI GREATER THAN LOW-VALUES
 11207         MOVE SUFXI              TO CERT-CERT-SUFX
 11208                                    CM-CERT-SFX
 11209         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11210
 11211     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11212
 11213     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11214
 11215     MOVE SPACES                 TO CM-ENTRY-BATCH
 11216                                    CM-LF-EXIT-BATCH
 11217                                    CM-AH-EXIT-BATCH
 11218                                    CM-CREDIT-INTERFACE-SW-1
 11219                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 207
* EL131.cbl
 11220
 11221     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11222                               '9' OR 'D' OR 'V'
 11223         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11224
 11225     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11226                               '9' OR 'D' OR 'V'
 11227         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11228
 11229     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11230                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11231     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11232
 11233
 11234* EXEC CICS HANDLE CONDITION
 11235*         DUPKEY (2080-EXIT)
 11236*    END-EXEC.
 11237*    MOVE '"$$                   ! 4 #00010140' TO DFHEIV0
 11238     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11240     MOVE X'3420233030303130313430' TO DFHEIV0(25:11)
 11241     CALL 'kxdfhei1' USING DFHEIV0
 11242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11243
 11244
 11245
 11246* EXEC CICS WRITE
 11247*         DATASET  (CERT-FILE-ID)
 11248*         RIDFLD   (CERT-KEY)
 11249*         FROM     (CERTIFICATE-MASTER)
 11250*    END-EXEC.
 11251     MOVE LENGTH OF
 11252      CERTIFICATE-MASTER
 11253       TO DFHEIV11
 11254*    MOVE '&$ L                  ''   #00010144' TO DFHEIV0
 11255     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11257     MOVE X'2020233030303130313434' TO DFHEIV0(25:11)
 11258     CALL 'kxdfhei1' USING DFHEIV0,
 11259           CERT-FILE-ID,
 11260           CERTIFICATE-MASTER,
 11261           DFHEIV11,
 11262           CERT-KEY,
 11263           DFHEIV99,
 11264           DFHEIV99
 11265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11266
 11267
 11268 2080-EXIT.
 11269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 208
* EL131.cbl
 11271 2100-MOVE-MSTR.
 11272     IF TYPEI GREATER THAN LOW-VALUES
 11273         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11274
 11275     IF STATUSI = LOW-VALUES
 11276         GO TO 2100-NO-STATUS-CHANGE.
 11277
 11278     IF STATUSI = 'OPEN' OR 'O'
 11279         IF CL-CLAIM-STATUS = 'O'
 11280             MOVE SPACES         TO TRLR-SWITCH
 11281                 GO TO 2100-NO-STATUS-CHANGE.
 11282
 11283     IF STATUSI = 'CLOSED' OR 'C'
 11284         IF CL-CLAIM-STATUS = 'C'
 11285             MOVE SPACES         TO TRLR-SWITCH
 11286                 GO TO 2100-NO-STATUS-CHANGE.
 11287
 11288     IF PI-COMPANY-ID = 'DMD'
 11289        IF STATUSI = 'OPEN' OR 'O'
 11290           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11291              MOVE ZERO       TO STATUSL
 11292              MOVE LOW-VALUES TO STATUSI
 11293              GO TO 2100-NO-STATUS-CHANGE.
 11294
 11295     IF PI-COMPANY-ID = 'DMD'
 11296         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11297
 11298     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11299
 11300 2100-NO-STATUS-CHANGE.
 11301
 11302     IF CCNOI GREATER THAN LOW-VALUES
 11303         MOVE CCNOI              TO CL-CCN.
 11304
 11305     IF PROCI GREATER THAN LOW-VALUES
 11306         MOVE PROCI              TO CL-PROCESSOR-ID.
 11307
 11308     if (accswi > low-values)
 11309        and (accswi = 'Y' OR 'N')
 11310        move accswi              to cl-accident-claim-sw
 11311     end-if
 11312     if benperi > low-values
 11313        and benperi numeric
 11314        move benperi             to cl-benefit-period
 11315     end-if
 11316     if instypei > low-values
 11317        move instypei            to cl-insured-type
 11318     end-if
 11319     IF SEXI GREATER THAN LOW-VALUES
 11320         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11321
 11322     IF BIRTHI GREATER THAN LOW-VALUES
 11323         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11324
 11325     IF SOCIALI GREATER THAN LOW-VALUES
 11326       AND
 11327        SOCIALI = SPACES
 11328         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 209
* EL131.cbl
 11329         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11330         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11331     ELSE
 11332         IF SOCIALI GREATER THAN LOW-VALUES
 11333             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11334
 11335     IF OCCI GREATER THAN LOW-VALUES
 11336         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11337
 11338     IF BENEL GREATER THAN ZERO
 11339         MOVE BENEI              TO CL-BENEFICIARY.
 11340
 11341     IF DIAGI GREATER THAN LOW-VALUES
 11342         MOVE DIAGI              TO WS-DIAGNOSIS.
 11343
 11344     IF ICD1I GREATER THAN LOW-VALUES
 11345         MOVE ICD1I              TO WS-ICD-CODE-1
 11346     END-IF.
 11347
 11348     IF ICD2I GREATER THAN LOW-VALUES
 11349         MOVE ICD2I              TO WS-ICD-CODE-2
 11350     END-IF.
 11351
 11352     IF PREMTYPI GREATER THAN LOW-VALUES
 11353         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11354
 11355*    IF CAUSEI GREATER THAN LOW-VALUES
 11356*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11357
 11358*    IF ENDI GREATER THAN LOW-VALUES
 11359*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11360
 11361     IF PDTHRUI GREATER THAN LOW-VALUES
 11362        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11363
 11364     IF PDAMTL GREATER THAN +0
 11365        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11366
 11367     IF NODAYSI GREATER THAN LOW-VALUES
 11368        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11369
 11370     IF NOPMTSI GREATER THAN LOW-VALUES
 11371        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11372
 11373     IF FORMTYPI GREATER THAN LOW-VALUES
 11374        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11375
 11376     IF INCI GREATER THAN LOW-VALUES
 11377        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11378
 11379     IF REPI GREATER THAN LOW-VALUES
 11380        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11381
 11382     IF ADDONDTI GREATER THAN LOW-VALUES
 11383        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11384
 11385     IF PRICDI GREATER THAN LOW-VALUES
 11386         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 210
* EL131.cbl
 11387
 11388     IF CRITPL  > ZEROS
 11389        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11390     END-IF
 11391
 11392*    IF CRITPTL > ZEROS
 11393*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11394*    END-IF
 11395
 11396*    IF RTWMOSL > ZEROS
 11397*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11398*    END-IF
 11399     IF FILETOI GREATER THAN LOW-VALUES
 11400         MOVE FILETOI            TO CL-FILE-LOCATION.
 11401
 11402     IF SUPVI GREATER THAN LOW-VALUES
 11403         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11404
 11405     IF MLNAMEI GREATER THAN LOW-VALUES
 11406         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11407
 11408     IF MFNAMEI GREATER THAN LOW-VALUES
 11409         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11410
 11411     IF MMINITI GREATER THAN LOW-VALUES
 11412         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11413
 11414     IF CERTEFFI GREATER THAN LOW-VALUES
 11415         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11416
 11417     IF CERTACTI GREATER THAN LOW-VALUES
 11418         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11419
 11420     IF CERTSTI GREATER THAN LOW-VALUES
 11421         MOVE CERTSTI            TO CL-CERT-STATE.
 11422
 11423     IF CERTCARI GREATER THAN LOW-VALUES
 11424         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11425                                    CL-CARRIER.
 11426
 11427     IF CERTGRPI GREATER THAN LOW-VALUES
 11428         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11429
 11430     IF CERTI GREATER THAN LOW-VALUES
 11431         MOVE CERTI              TO CERT-NO-PRIME.
 11432
 11433     IF SUFXI GREATER THAN LOW-VALUES
 11434         MOVE SUFXI              TO CERT-NO-SUFX.
 11435
 11436     MOVE CERT-NO                TO CL-CERT-NO
 11437                                    CL-CERT-NO-A4.
 11438
 11439     IF PI-COMPANY-ID = 'FLA'
 11440          NEXT SENTENCE
 11441     ELSE
 11442         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11443         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11444         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 211
* EL131.cbl
 11445         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11446
 11447     IF TRLR-UPDATE-REQUIRED
 11448        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11449        MOVE ZEROS              TO TRLR-SEQ-NO
 11450
 11451* EXEC CICS READ
 11452*            DATASET   (TRLR-FILE-ID)
 11453*            RIDFLD    (TRLR-KEY)
 11454*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11455*       END-EXEC
 11456*    MOVE '&"S        E          (   #00010332' TO DFHEIV0
 11457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11459     MOVE X'2020233030303130333332' TO DFHEIV0(25:11)
 11460     CALL 'kxdfhei1' USING DFHEIV0,
 11461           TRLR-FILE-ID,
 11462           DFHEIV20,
 11463           DFHEIV99,
 11464           TRLR-KEY,
 11465           DFHEIV99,
 11466           DFHEIV99,
 11467           DFHEIV99
 11468     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11469         DFHEIV20
 11470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11471        IF AT-TRAILER-TYPE = '1'
 11472           MOVE +1 TO MISC-SUB
 11473           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11474           MISC-SUB GREATER THAN +6 OR
 11475           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11476           IF MISC-SUB GREATER THAN +1
 11477              SUBTRACT +1 FROM MISC-SUB
 11478              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11479                 GO TO 2100-BYPASS-LAST-UPDATE.
 11480
 11481     IF TRLR-UPDATE-REQUIRED AND
 11482        CLAIM-IS-OPEN
 11483         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11484     ELSE
 11485         IF TRLR-UPDATE-REQUIRED AND
 11486            CLAIM-IS-CLOSED
 11487             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11488             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11489
 11490 2100-BYPASS-LAST-UPDATE.
 11491     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11492     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11493
 11494     GO TO 2100-EXIT.
 11495
 11496 2100-BUMP-OPEN-CLOSE-HIST.
 11497     ADD +1                      TO MISC-SUB.
 11498
 11499 2100-EXIT.
 11500     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 212
* EL131.cbl
 11502 2120-check-pdef.
 11503     move +0                     to s1
 11504     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11505     move spaces                 to ws-dcc-error-line
 11506     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11507     IF ERPDEF-FOUND
 11508        perform 2130-check-trlr  thru 2130-exit
 11509        move +1                  to s1
 11510*       if cl-accident-claim-sw = ' '
 11511*          move er-1655             to ws-error-no (s1)
 11512*          add +1 to s1
 11513*       end-if
 11514        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11515        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11516        if (hold-incur > low-values)
 11517           and (incl > zeros)
 11518           and (hold-incur not = cl-incurred-dt)
 11519           move hold-incur       to dc-bin-date-2
 11520        end-if
 11521        MOVE '1'                 TO DC-OPTION-CODE
 11522        MOVE +0                  TO DC-ELAPSED-MONTHS
 11523                                    DC-ELAPSED-DAYS
 11524        PERFORM 9800-CONVERT-DATE
 11525                                 THRU 9800-EXIT
 11526        IF NO-CONVERSION-ERROR
 11527           MOVE DC-ELAPSED-MONTHS
 11528                                 TO WS-MONTHS-BETWEEN
 11529           IF DC-ELAPSED-DAYS > 1
 11530              ADD 1 TO WS-MONTHS-BETWEEN
 11531           END-IF
 11532        ELSE
 11533           display ' dte conv error ' dc-error-code
 11534           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11535        END-IF
 11536        IF (WS-EXCL-PERIOD = ZEROS)
 11537           OR (WS-MONTHS-BETWEEN = ZEROS)
 11538           CONTINUE
 11539        ELSE
 11540           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11541              MOVE ER-1651       TO ws-error-no (s1)
 11542              add +1             to s1
 11543           END-IF
 11544        END-IF
 11545        IF (WS-COV-ENDS = ZEROS)
 11546           OR (WS-MONTHS-BETWEEN = ZEROS)
 11547           CONTINUE
 11548        ELSE
 11549           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11550              MOVE -1            TO MAINTL
 11551              MOVE ER-1653       TO ws-error-no (s1)
 11552              add +1 to s1
 11553           END-IF
 11554        END-IF
 11555        IF (WS-ACC-PERIOD = ZEROS)
 11556           OR (WS-MONTHS-BETWEEN = ZEROS)
 11557           CONTINUE
 11558        ELSE
 11559           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 213
* EL131.cbl
 11560              and (accswi = spaces or low-values)
 11561*             and (cl-accident-claim-sw = ' ')
 11562              move er-1655       to ws-error-no (s1)
 11563              add +1             to s1
 11564           end-if
 11565           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11566*             if (cl-accident-claim-sw not = 'Y')
 11567              if (accswi not = 'Y')
 11568                 MOVE ER-1652    TO ws-error-no (s1)
 11569              else
 11570                 move er-1662    to ws-error-no (s1)
 11571              end-if
 11572              MOVE -1            TO MAINTL
 11573              add +1             to s1
 11574           END-IF
 11575        END-IF
 11576        if cl-claim-type  = 'I'
 11577           move er-1661          to ws-error-no (s1)
 11578           add +1                to s1
 11579        end-if
 11580        perform 2130-check-trlr  thru 2130-exit
 11581     END-IF
 11582
 11583     .
 11584 2120-exit.
 11585     exit.
 11586
 11587 2130-check-trlr.
 11588
 11589     evaluate true
 11590        when s1 = +0
 11591           move cl-control-primary
 11592                                 to trlr-key
 11593           MOVE +95              TO TRLR-SEQ-NO
 11594
 11595* EXEC CICS READ
 11596*             update
 11597*             DATASET  ('ELTRLR')
 11598*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11599*             RIDFLD   (TRLR-KEY)
 11600*             RESP     (WS-RESPONSE)
 11601*          END-EXEC
 11602     MOVE 'ELTRLR' TO DFHEIV1
 11603*    MOVE '&"S        EU         (  N#00010460' TO DFHEIV0
 11604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11606     MOVE X'204E233030303130343630' TO DFHEIV0(25:11)
 11607     CALL 'kxdfhei1' USING DFHEIV0,
 11608           DFHEIV1,
 11609           DFHEIV20,
 11610           DFHEIV99,
 11611           TRLR-KEY,
 11612           DFHEIV99,
 11613           DFHEIV99,
 11614           DFHEIV99
 11615     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11616         DFHEIV20
 11617     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 214
* EL131.cbl
 11618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11619           if ws-resp-normal
 11620              move spaces        to at-info-line-1
 11621           end-if
 11622        when s1 = +1
 11623           if ws-resp-normal
 11624
 11625* exec cics rewrite
 11626*                dataset   ('ELTRLR')
 11627*                from      (activity-trailers)
 11628*             end-exec
 11629     MOVE LENGTH OF
 11630      activity-trailers
 11631       TO DFHEIV11
 11632     MOVE 'ELTRLR' TO DFHEIV1
 11633*    MOVE '&& L                  %   #00010472' TO DFHEIV0
 11634     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11635     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11636     MOVE X'2020233030303130343732' TO DFHEIV0(25:11)
 11637     CALL 'kxdfhei1' USING DFHEIV0,
 11638           DFHEIV1,
 11639           activity-trailers,
 11640           DFHEIV11,
 11641           DFHEIV99
 11642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11643           end-if
 11644        when s1 > +1
 11645           if ws-resp-normal
 11646              move ws-dcc-error-line
 11647                                 to at-info-line-1
 11648
 11649* exec cics rewrite
 11650*                dataset   ('ELTRLR')
 11651*                from      (activity-trailers)
 11652*             end-exec
 11653     MOVE LENGTH OF
 11654      activity-trailers
 11655       TO DFHEIV11
 11656     MOVE 'ELTRLR' TO DFHEIV1
 11657*    MOVE '&& L                  %   #00010481' TO DFHEIV0
 11658     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11659     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11660     MOVE X'2020233030303130343831' TO DFHEIV0(25:11)
 11661     CALL 'kxdfhei1' USING DFHEIV0,
 11662           DFHEIV1,
 11663           activity-trailers,
 11664           DFHEIV11,
 11665           DFHEIV99
 11666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11667           else
 11668
 11669* EXEC CICS GETMAIN
 11670*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11671*                LENGTH   (TRLR-LENGTH)
 11672*                INITIMG  (GETMAIN-SPACE)
 11673*             END-EXEC
 11674*    MOVE ',"IL                  $   #00010486' TO DFHEIV0
 11675     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 215
* EL131.cbl
 11676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11677     MOVE X'2020233030303130343836' TO DFHEIV0(25:11)
 11678     CALL 'kxdfhei1' USING DFHEIV0,
 11679           DFHEIV20,
 11680           TRLR-LENGTH,
 11681           GETMAIN-SPACE
 11682     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11683         DFHEIV20
 11684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11685              move 'AT'          to at-record-id
 11686              move cl-control-primary
 11687                                 to at-control-primary
 11688              move +95           to at-sequence-no
 11689              move '6'           to at-trailer-type
 11690              move ws-dcc-error-line
 11691                                 to at-info-line-1
 11692              move 'E'           to at-info-trailer-type
 11693              move save-bin-date to at-recorded-dt
 11694                                    at-gen-info-last-maint-dt
 11695              move pi-processor-id
 11696                                 to at-recorded-by
 11697                                    at-gen-info-last-updated-by
 11698              move eibtime       to at-last-maint-hhmmss
 11699
 11700* exec cics write
 11701*                dataset   ('ELTRLR')
 11702*                from      (activity-trailers)
 11703*                ridfld    (trlr-key)
 11704*             end-exec
 11705     MOVE LENGTH OF
 11706      activity-trailers
 11707       TO DFHEIV11
 11708     MOVE 'ELTRLR' TO DFHEIV1
 11709*    MOVE '&$ L                  ''   #00010505' TO DFHEIV0
 11710     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11712     MOVE X'2020233030303130353035' TO DFHEIV0(25:11)
 11713     CALL 'kxdfhei1' USING DFHEIV0,
 11714           DFHEIV1,
 11715           activity-trailers,
 11716           DFHEIV11,
 11717           trlr-key,
 11718           DFHEIV99,
 11719           DFHEIV99
 11720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11721              perform varying s1 from +1 by +1 until
 11722                 ws-error-no (s1) = spaces
 11723                 move ws-error-no (s1)
 11724                                 to emi-error
 11725                 PERFORM 9900-ERROR-FORMAT
 11726                                 THRU 9900-EXIT
 11727              end-perform
 11728           end-if
 11729     end-evaluate
 11730
 11731     .
 11732 2130-exit.
 11733     exit.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 216
* EL131.cbl
 11734 2140-update-elcrtt.
 11735     move ' '                    to crtt-switch
 11736     MOVE CERT-KEY               TO ELCRTT-KEY
 11737     MOVE 'B'                    TO CTRLR-REC-TYPE
 11738
 11739* EXEC CICS READ
 11740*       UPDATE
 11741*       DATASET   ('ELCRTT')
 11742*       RIDFLD    (ELCRTT-KEY)
 11743*       INTO      (CERTIFICATE-TRAILERS)
 11744*       RESP      (WS-RESPONSE)
 11745*    END-EXEC
 11746     MOVE LENGTH OF
 11747      CERTIFICATE-TRAILERS
 11748       TO DFHEIV11
 11749     MOVE 'ELCRTT' TO DFHEIV1
 11750*    MOVE '&"IL       EU         (  N#00010527' TO DFHEIV0
 11751     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11752     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11753     MOVE X'204E233030303130353237' TO DFHEIV0(25:11)
 11754     CALL 'kxdfhei1' USING DFHEIV0,
 11755           DFHEIV1,
 11756           CERTIFICATE-TRAILERS,
 11757           DFHEIV11,
 11758           ELCRTT-KEY,
 11759           DFHEIV99,
 11760           DFHEIV99,
 11761           DFHEIV99
 11762     MOVE EIBRESP  TO WS-RESPONSE
 11763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11764     IF WS-RESP-NORMAL
 11765        perform varying s1 from +1 by +1 until
 11766           (s1 > +24)
 11767           or (cs-claim-no (s1) = cl-claim-no)
 11768        end-perform
 11769        if (s1 < +25)
 11770           if (benperl <> zeros)
 11771              and (cs-benefit-period (s1) not = benperi)
 11772              move benperi       to cs-benefit-period (s1)
 11773              set crtt-update    to true
 11774          end-if
 11775          if (instypel <> zeros)
 11776             and (instypei not = cs-insured-type (s1))
 11777             move instypei      to cs-insured-type (s1)
 11778             set crtt-update    to true
 11779          end-if
 11780          move cs-claim-type (s1) to ws-claim-type
 11781          move cs-benefit-period (s1) to ws-ben-per
 11782        end-if
 11783        if crtt-update
 11784           perform 2150-accum    thru 2150-exit
 11785
 11786* EXEC CICS REWRITE
 11787*             DATASET   ('ELCRTT')
 11788*             FROM      (CERTIFICATE-TRAILERS)
 11789*          END-EXEC
 11790     MOVE LENGTH OF
 11791      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 217
* EL131.cbl
 11792       TO DFHEIV11
 11793     MOVE 'ELCRTT' TO DFHEIV1
 11794*    MOVE '&& L                  %   #00010555' TO DFHEIV0
 11795     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11797     MOVE X'2020233030303130353535' TO DFHEIV0(25:11)
 11798     CALL 'kxdfhei1' USING DFHEIV0,
 11799           DFHEIV1,
 11800           CERTIFICATE-TRAILERS,
 11801           DFHEIV11,
 11802           DFHEIV99
 11803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11804        else
 11805
 11806* exec cics unlock
 11807*             dataset   ('ELCRTT')
 11808*          end-exec
 11809     MOVE 'ELCRTT' TO DFHEIV1
 11810*    MOVE '&*                    #   #00010560' TO DFHEIV0
 11811     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11812     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11813     MOVE X'2020233030303130353630' TO DFHEIV0(25:11)
 11814     CALL 'kxdfhei1' USING DFHEIV0,
 11815           DFHEIV1,
 11816           DFHEIV99
 11817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11818        end-if
 11819     end-if
 11820     .
 11821 2140-exit.
 11822     exit.
 11823 2150-accum.
 11824     if not erpdef-found
 11825        perform 3997-get-erpdef  thru 3997-exit
 11826     end-if
 11827     if (erpdef-found)
 11828        and (ws-max-moben not = zeros)
 11829        and (ws-max-moben < cm-ah-benefit-amt)
 11830        continue
 11831     else
 11832        move cm-ah-benefit-amt   to ws-max-moben
 11833     end-if
 11834     move cm-ah-orig-term        to ws-max-bens
 11835     if cl-critical-period not = zeros and spaces
 11836        move cl-critical-period  to ws-max-bens
 11837     end-if
 11838     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11839     perform varying s2 from +1 by +1 until
 11840        (s2 > +24)
 11841        or (cs-claim-no (s2) = spaces)
 11842        if (cs-benefit-period (s2) = ws-ben-per)
 11843           and (cs-claim-type (s2) = ws-claim-type)
 11844           and (cs-insured-type (s2) = cl-insured-type)
 11845*          compute ws-tot-days-paid =
 11846*             ws-tot-days-paid + cs-days-paid (s2)
 11847           compute ws-tot-amt-paid =
 11848              ws-tot-amt-paid + cs-total-paid (s2)
 11849        end-if
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 218
* EL131.cbl
 11850     end-perform
 11851     if s2 < +25
 11852        compute ws-pd-bens rounded =
 11853           ws-tot-amt-paid / ws-max-moben
 11854        compute cs-remaining-bens (s1) =
 11855           ws-max-bens - ws-pd-bens
 11856        if cs-remaining-bens (s1) < zeros
 11857           move zeros            to cs-remaining-bens (s1)
 11858        end-if
 11859     end-if
 11860     .
 11861 2150-exit.
 11862     exit.
 11863 2200-MOVE-CERT.
 11864     IF CRTLNMEI GREATER THAN LOW-VALUES
 11865         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11866
 11867     IF CRTFNMEI GREATER THAN LOW-VALUES
 11868         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11869         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11870
 11871     IF CRTINITI GREATER THAN LOW-VALUES
 11872         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11873
 11874     IF CM-INSURED-INITIALS = SPACES
 11875         MOVE '**'               TO CM-INSURED-INITIALS.
 11876
 11877     IF ISSAGEI GREATER THAN LOW-VALUES
 11878         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11879
 11880     IF JNTFNMEI GREATER THAN LOW-VALUES
 11881         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11882
 11883     IF JNTLNMEI GREATER THAN LOW-VALUES
 11884         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11885
 11886     IF JNTINITI GREATER THAN LOW-VALUES
 11887         MOVE JNTINITI           TO CM-JT-INITIAL.
 11888
 11889     IF JNTAGEI GREATER THAN LOW-VALUES
 11890         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11891
 11892     IF ADDONDTI GREATER THAN LOW-VALUES
 11893        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11894
 11895     IF LCVCDI GREATER THAN LOW-VALUES
 11896        IF LCVCDI = SPACES OR ZEROS
 11897           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11898        ELSE
 11899           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11900
 11901     IF LCVOTRMI GREATER THAN LOW-VALUES
 11902         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11903
 11904     IF LCVRATEL GREATER THAN +0
 11905         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11906
 11907     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 219
* EL131.cbl
 11908         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11909
 11910     IF LCVFORMI GREATER THAN LOW-VALUES
 11911         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11912
 11913     IF LCVCNDTI = LOW-VALUES
 11914        GO TO 2210-SET-STATUS.
 11915
 11916     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11917        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11918        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11919        GO TO 2210-SET-STATUS.
 11920
 11921     IF CM-LF-CURRENT-STATUS = '7'
 11922        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11923        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11924        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11925                                    CM-LF-DEATH-DT
 11926        GO TO 2210-SET-STATUS.
 11927
 11928     IF CM-LF-CURRENT-STATUS = '8'
 11929        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11930        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11931                                    CM-LF-CANCEL-DT.
 11932
 11933 2210-SET-STATUS.
 11934
 11935     IF CM-LF-CURRENT-STATUS = SPACES
 11936         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11937
 11938     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11939         MOVE '6'                TO DC-OPTION-CODE
 11940         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11941         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11942         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11943         IF NO-CONVERSION-ERROR
 11944             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11945         ELSE
 11946             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11947     ELSE
 11948         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11949
 11950 2215-PROCESS-AH-SIDE.
 11951
 11952     IF ACVCDI GREATER THAN LOW-VALUES
 11953        IF ACVCDI = SPACES OR ZEROS
 11954           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11955        ELSE
 11956           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11957
 11958     IF ACVOTRMI GREATER THAN LOW-VALUES
 11959         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11960
 11961     IF ACVRATEL GREATER THAN +0
 11962         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11963
 11964     IF ACVBENEL GREATER THAN +0
 11965         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 220
* EL131.cbl
 11966                                    PI-PAYMENT-AMT.
 11967
 11968     IF ACVFORMI GREATER THAN LOW-VALUES
 11969         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11970
 11971     IF ACVCNDTI = LOW-VALUES
 11972        GO TO 2220-SET-STATUS.
 11973
 11974     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11975        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11976        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11977        GO TO 2220-SET-STATUS.
 11978
 11979     IF CM-AH-CURRENT-STATUS = '6'
 11980        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11981                                 TO CM-AH-CURRENT-STATUS
 11982        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11983        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11984                                    CM-AH-SETTLEMENT-DT
 11985        GO TO 2220-SET-STATUS.
 11986
 11987     IF CM-AH-CURRENT-STATUS = '8'
 11988        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11989        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11990                                    CM-AH-CANCEL-DT.
 11991
 11992 2220-SET-STATUS.
 11993     IF CM-AH-CURRENT-STATUS = SPACES
 11994         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11995
 11996     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11997         MOVE '6'                TO DC-OPTION-CODE
 11998         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11999         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12000         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12001         IF NO-CONVERSION-ERROR
 12002             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12003         ELSE
 12004             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12005     ELSE
 12006         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12007
 12008 2225-FINISH-CERT.
 12009     IF APRL GREATER THAN +0
 12010         MOVE HOLD-APR           TO CM-LOAN-APR.
 12011
 12012     IF PMTFREQI GREATER THAN LOW-VALUES
 12013         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12014
 12015     IF INDGRPI GREATER THAN LOW-VALUES
 12016         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12017
 12018     IF LOANNOI GREATER THAN LOW-VALUES
 12019        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12020
 12021     IF LOANBALL GREATER THAN +0
 12022        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12023
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 221
* EL131.cbl
 12024     IF PREMTYPI GREATER THAN LOW-VALUES
 12025         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12026
 12027     IF REINCDI GREATER THAN LOW-VALUES
 12028         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12029                                    WS-REIN-1
 12030                                    WS-REIN-2
 12031                                    WS-REIN-3
 12032         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12033
 12034     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12035
 12036     MOVE ZEROS                  TO CM-LOAN-TERM
 12037                                    CM-LIFE-COMM-PCT
 12038                                    CM-AH-COMM-PCT.
 12039
 12040*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12041*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12042*         PI-NO-PMTS = ZEROS
 12043*          IF LOANBALL GREATER THAN +0          OR
 12044*             ACVBENEL GREATER THAN +0          OR
 12045*             APRL     GREATER THAN +0          OR
 12046*             LCVRATEL GREATER THAN +0          OR
 12047*             ACVRATEL GREATER THAN +0
 12048*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12049
 12050 2200-EXIT.
 12051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 222
* EL131.cbl
 12053 2300-UPDATE-TRLR.
 12054     MOVE ZERO                   TO TRLR-SEQ-NO.
 12055
 12056* EXEC CICS READ UPDATE
 12057*         DATASET  (TRLR-FILE-ID)
 12058*         RIDFLD   (TRLR-KEY)
 12059*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12060*    END-EXEC.
 12061*    MOVE '&"S        EU         (   #00010800' TO DFHEIV0
 12062     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12064     MOVE X'2020233030303130383030' TO DFHEIV0(25:11)
 12065     CALL 'kxdfhei1' USING DFHEIV0,
 12066           TRLR-FILE-ID,
 12067           DFHEIV20,
 12068           DFHEIV99,
 12069           TRLR-KEY,
 12070           DFHEIV99,
 12071           DFHEIV99,
 12072           DFHEIV99
 12073     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12074         DFHEIV20
 12075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12076
 12077
 12078     MOVE ZERO                   TO COUNT-2.
 12079
 12080     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12081         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12082
 12083     IF NOT UPDATE-MADE
 12084         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12085
 12086
 12087* EXEC CICS REWRITE
 12088*         DATASET  (TRLR-FILE-ID)
 12089*         FROM     (ACTIVITY-TRAILERS)
 12090*    END-EXEC.
 12091     MOVE LENGTH OF
 12092      ACTIVITY-TRAILERS
 12093       TO DFHEIV11
 12094*    MOVE '&& L                  %   #00010814' TO DFHEIV0
 12095     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12096     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12097     MOVE X'2020233030303130383134' TO DFHEIV0(25:11)
 12098     CALL 'kxdfhei1' USING DFHEIV0,
 12099           TRLR-FILE-ID,
 12100           ACTIVITY-TRAILERS,
 12101           DFHEIV11,
 12102           DFHEIV99
 12103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12104
 12105
 12106 2300-EXIT.
 12107     EXIT.
 12108
 12109 2310-INS-STATUS.
 12110     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 223
* EL131.cbl
 12111     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12112         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12113         MOVE 'Y'                TO TRLR-SWITCH.
 12114
 12115 2310-EXIT.
 12116     EXIT.
 12117
 12118 2320-SHIFT-STATUS.
 12119     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12120        MOVE 6                   TO COUNT-2
 12121        GO TO 2320-EXIT.
 12122
 12123     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12124     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12125     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12126     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12127     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12128     MOVE 6       TO COUNT-2.
 12129     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12130
 12131 2320-EXIT.
 12132     EXIT.
 12133
 12134 2330-ADD-UPDATE.
 12135
 12136     IF COUNT-2 GREATER THAN 1
 12137        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12138        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12139           GO TO 2330-EXIT.
 12140
 12141     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12142                                   AT-RESERVES-LAST-MAINT-DT
 12143
 12144     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12145     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12146     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12147     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12148
 12149 2330-EXIT.
 12150     EXIT.
 12151
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 224
* EL131.cbl
 12153 2400-UPDATE-TRLR.
 12154
 12155* EXEC CICS HANDLE CONDITION
 12156*         NOTFND    (2400-TRLR-NOTFND)
 12157*         ENDFILE   (2410-EXIT)
 12158*    END-EXEC.
 12159*    MOVE '"$I''                  ! 5 #00010867' TO DFHEIV0
 12160     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12162     MOVE X'3520233030303130383637' TO DFHEIV0(25:11)
 12163     CALL 'kxdfhei1' USING DFHEIV0
 12164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12165
 12166
 12167
 12168* EXEC CICS STARTBR
 12169*        DATASET (TRLR-FILE-ID)
 12170*        RIDFLD  (TRLR-KEY)
 12171*    END-EXEC.
 12172     MOVE 0
 12173       TO DFHEIV11
 12174*    MOVE '&,         G          &   #00010872' TO DFHEIV0
 12175     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12176     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12177     MOVE X'2020233030303130383732' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0,
 12179           TRLR-FILE-ID,
 12180           TRLR-KEY,
 12181           DFHEIV99,
 12182           DFHEIV11,
 12183           DFHEIV99
 12184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12185
 12186
 12187
 12188* EXEC CICS GETMAIN
 12189*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12190*         LENGTH    (TRLR-LENGTH)
 12191*         INITIMG   (GETMAIN-SPACE)
 12192*    END-EXEC.
 12193*    MOVE ',"IL                  $   #00010877' TO DFHEIV0
 12194     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12195     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12196     MOVE X'2020233030303130383737' TO DFHEIV0(25:11)
 12197     CALL 'kxdfhei1' USING DFHEIV0,
 12198           DFHEIV20,
 12199           TRLR-LENGTH,
 12200           GETMAIN-SPACE
 12201     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12202         DFHEIV20
 12203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12204
 12205
 12206     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12207
 12208
 12209* EXEC CICS ENDBR
 12210*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 225
* EL131.cbl
 12211*    END-EXEC.
 12212     MOVE 0
 12213       TO DFHEIV11
 12214*    MOVE '&2                    $   #00010885' TO DFHEIV0
 12215     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12216     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12217     MOVE X'2020233030303130383835' TO DFHEIV0(25:11)
 12218     CALL 'kxdfhei1' USING DFHEIV0,
 12219           TRLR-FILE-ID,
 12220           DFHEIV11,
 12221           DFHEIV99
 12222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12223
 12224
 12225     GO TO 2400-EXIT.
 12226
 12227 2400-TRLR-NOTFND.
 12228     MOVE ER-0205                TO EMI-ERROR.
 12229     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12230     MOVE 'X'                    TO ERROR-SWITCH.
 12231
 12232 2400-EXIT.
 12233     EXIT.
 12234
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 226
* EL131.cbl
 12236 2410-CHANGE-TRLR.
 12237
 12238* EXEC CICS READNEXT
 12239*        DATASET (TRLR-FILE-ID)
 12240*        RIDFLD  (TRLR-KEY)
 12241*        INTO    (ACTIVITY-TRAILERS)
 12242*    END-EXEC.
 12243     MOVE LENGTH OF
 12244      ACTIVITY-TRAILERS
 12245       TO DFHEIV12
 12246     MOVE 0
 12247       TO DFHEIV11
 12248*    MOVE '&.IL                  )   #00010901' TO DFHEIV0
 12249     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12250     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12251     MOVE X'2020233030303130393031' TO DFHEIV0(25:11)
 12252     CALL 'kxdfhei1' USING DFHEIV0,
 12253           TRLR-FILE-ID,
 12254           ACTIVITY-TRAILERS,
 12255           DFHEIV12,
 12256           TRLR-KEY,
 12257           DFHEIV99,
 12258           DFHEIV11,
 12259           DFHEIV99,
 12260           DFHEIV99
 12261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12262
 12263
 12264     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12265        GO TO 2410-CHANGE-TRLR.
 12266
 12267     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12268                                    CHECK-KEY.
 12269
 12270     IF CHECK-KEY NOT = MSTR-KEY
 12271         GO TO 2410-EXIT.
 12272
 12273
 12274* EXEC CICS ENDBR
 12275*        DATASET (TRLR-FILE-ID)
 12276*    END-EXEC.
 12277     MOVE 0
 12278       TO DFHEIV11
 12279*    MOVE '&2                    $   #00010916' TO DFHEIV0
 12280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12282     MOVE X'2020233030303130393136' TO DFHEIV0(25:11)
 12283     CALL 'kxdfhei1' USING DFHEIV0,
 12284           TRLR-FILE-ID,
 12285           DFHEIV11,
 12286           DFHEIV99
 12287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12288
 12289
 12290
 12291* EXEC CICS READ UPDATE
 12292*        DATASET (TRLR-FILE-ID)
 12293*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 227
* EL131.cbl
 12294*        INTO    (ACTIVITY-TRAILERS)
 12295*    END-EXEC.
 12296     MOVE LENGTH OF
 12297      ACTIVITY-TRAILERS
 12298       TO DFHEIV11
 12299*    MOVE '&"IL       EU         (   #00010920' TO DFHEIV0
 12300     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12301     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12302     MOVE X'2020233030303130393230' TO DFHEIV0(25:11)
 12303     CALL 'kxdfhei1' USING DFHEIV0,
 12304           TRLR-FILE-ID,
 12305           ACTIVITY-TRAILERS,
 12306           DFHEIV11,
 12307           TRLR-KEY,
 12308           DFHEIV99,
 12309           DFHEIV99,
 12310           DFHEIV99
 12311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12312
 12313
 12314
 12315* EXEC CICS DELETE
 12316*        DATASET (TRLR-FILE-ID)
 12317*    END-EXEC.
 12318*    MOVE '&(                    &   #00010926' TO DFHEIV0
 12319     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12321     MOVE X'2020233030303130393236' TO DFHEIV0(25:11)
 12322     CALL 'kxdfhei1' USING DFHEIV0,
 12323           TRLR-FILE-ID,
 12324           DFHEIV99,
 12325           DFHEIV99,
 12326           DFHEIV99,
 12327           DFHEIV99
 12328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12329
 12330
 12331     IF AT-SEQUENCE-NO = ZERO AND
 12332        TRLR-UPDATE-REQUIRED
 12333         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12334
 12335     IF CERTI GREATER THAN LOW-VALUES
 12336        MOVE CERTI               TO AT-CERT-PRIME.
 12337
 12338     IF SUFXI GREATER THAN LOW-VALUES
 12339        MOVE SUFXI               TO AT-CERT-SFX.
 12340
 12341     IF CERTCARI GREATER THAN LOW-VALUES
 12342        MOVE CERTCARI            TO AT-CARRIER.
 12343
 12344     IF PAYMENT-TR
 12345        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12346           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12347              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12348
 12349     IF CORRESPONDENCE-TR
 12350        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12351           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 228
* EL131.cbl
 12352
 12353
 12354* EXEC CICS WRITE
 12355*         DATASET  (TRLR-FILE-ID)
 12356*         RIDFLD   (AT-CONTROL-PRIMARY)
 12357*         FROM     (ACTIVITY-TRAILERS)
 12358*    END-EXEC.
 12359     MOVE LENGTH OF
 12360      ACTIVITY-TRAILERS
 12361       TO DFHEIV11
 12362*    MOVE '&$ L                  ''   #00010952' TO DFHEIV0
 12363     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12365     MOVE X'2020233030303130393532' TO DFHEIV0(25:11)
 12366     CALL 'kxdfhei1' USING DFHEIV0,
 12367           TRLR-FILE-ID,
 12368           ACTIVITY-TRAILERS,
 12369           DFHEIV11,
 12370           AT-CONTROL-PRIMARY,
 12371           DFHEIV99,
 12372           DFHEIV99
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376
 12377* EXEC CICS STARTBR
 12378*         DATASET  (TRLR-FILE-ID)
 12379*         RIDFLD   (TRLR-KEY)
 12380*    END-EXEC.
 12381     MOVE 0
 12382       TO DFHEIV11
 12383*    MOVE '&,         G          &   #00010958' TO DFHEIV0
 12384     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12386     MOVE X'2020233030303130393538' TO DFHEIV0(25:11)
 12387     CALL 'kxdfhei1' USING DFHEIV0,
 12388           TRLR-FILE-ID,
 12389           TRLR-KEY,
 12390           DFHEIV99,
 12391           DFHEIV11,
 12392           DFHEIV99
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396     GO TO 2410-CHANGE-TRLR.
 12397
 12398 2410-EXIT.
 12399     EXIT.
 12400
 12401 2420-UPDATE-TRLR.
 12402     MOVE ZERO TO COUNT-2.
 12403     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12404         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12405
 12406     IF NOT UPDATE-MADE
 12407         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12408
 12409 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 229
* EL131.cbl
 12410     EXIT.
 12411
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 230
* EL131.cbl
 12413 2425-UPDATE-NINETY-TRLR.
 12414
 12415     MOVE +90                    TO TRLR-SEQ-NO.
 12416
 12417
 12418* EXEC CICS HANDLE CONDITION
 12419*         NOTFND    (2425-NINETY-NOTFND)
 12420*         ENDFILE   (2425-NINETY-NOTFND)
 12421*    END-EXEC.
 12422*    MOVE '"$I''                  ! 6 #00010984' TO DFHEIV0
 12423     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12425     MOVE X'3620233030303130393834' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0
 12427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12428
 12429
 12430
 12431* EXEC CICS READ UPDATE
 12432*        DATASET (TRLR-FILE-ID)
 12433*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12434*        RIDFLD  (TRLR-KEY)
 12435*    END-EXEC.
 12436*    MOVE '&"S        EU         (   #00010989' TO DFHEIV0
 12437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12439     MOVE X'2020233030303130393839' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           TRLR-FILE-ID,
 12442           DFHEIV20,
 12443           DFHEIV99,
 12444           TRLR-KEY,
 12445           DFHEIV99,
 12446           DFHEIV99,
 12447           DFHEIV99
 12448     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12449         DFHEIV20
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12451
 12452     if (diagi > low-values)
 12453        and (diagi not = at-info-line-1)
 12454        and (cl-total-paid-amt > zeros)
 12455        move cl-cert-eff-dt      to dc-bin-date-1
 12456        move cl-paid-thru-dt     to dc-bin-date-2
 12457        move '1'                 to dc-option-code
 12458        perform 9800-convert-date
 12459                                 thru 9800-exit
 12460        if no-conversion-error
 12461           and dc-elapsed-months < +24
 12462           and (not emi-bypass-forcables)
 12463           move er-1581          to emi-error
 12464           perform 9900-error-format
 12465                                thru 9900-exit
 12466           move -1              to diagl
 12467           go to 8110-send-data
 12468        end-if
 12469     end-if
 12470     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 231
* EL131.cbl
 12471     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12472     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12473
 12474     IF DIAGI GREATER THAN LOW-VALUES
 12475         MOVE DIAGI             TO AT-INFO-LINE-1
 12476     END-IF.
 12477
 12478     IF ICD1I GREATER THAN LOW-VALUES
 12479         MOVE ICD1I             TO AT-ICD-CODE-1
 12480     END-IF.
 12481
 12482     IF ICD2I GREATER THAN LOW-VALUES
 12483         MOVE ICD2I             TO AT-ICD-CODE-2
 12484     END-IF.
 12485
 12486
 12487* EXEC CICS REWRITE
 12488*        DATASET (TRLR-FILE-ID)
 12489*        FROM    (ACTIVITY-TRAILERS)
 12490*    END-EXEC.
 12491     MOVE LENGTH OF
 12492      ACTIVITY-TRAILERS
 12493       TO DFHEIV11
 12494*    MOVE '&& L                  %   #00011028' TO DFHEIV0
 12495     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12496     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12497     MOVE X'2020233030303131303238' TO DFHEIV0(25:11)
 12498     CALL 'kxdfhei1' USING DFHEIV0,
 12499           TRLR-FILE-ID,
 12500           ACTIVITY-TRAILERS,
 12501           DFHEIV11,
 12502           DFHEIV99
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506     IF DIAGI GREATER THAN LOW-VALUES
 12507       AND DIAGI NOT = WS-DIAGNOSIS
 12508         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12509         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12510         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12511
 12512     IF ICD1I GREATER THAN LOW-VALUES
 12513       AND ICD1I NOT = WS-ICD-CODE-1
 12514         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12515         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12516         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12517     END-IF.
 12518
 12519     IF ICD2I GREATER THAN LOW-VALUES
 12520       AND ICD2I NOT = WS-ICD-CODE-2
 12521         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12522         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12523         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12524     END-IF.
 12525
 12526     GO TO 2425-EXIT.
 12527
 12528 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 232
* EL131.cbl
 12529
 12530
 12531* EXEC CICS GETMAIN
 12532*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12533*         LENGTH    (TRLR-LENGTH)
 12534*         INITIMG   (GETMAIN-SPACE)
 12535*    END-EXEC.
 12536*    MOVE ',"IL                  $   #00011057' TO DFHEIV0
 12537     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12539     MOVE X'2020233030303131303537' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0,
 12541           DFHEIV20,
 12542           TRLR-LENGTH,
 12543           GETMAIN-SPACE
 12544     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12545         DFHEIV20
 12546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12547
 12548
 12549     MOVE +90                  TO TRLR-SEQ-NO.
 12550     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12551
 12552     MOVE 'AT'                 TO AT-RECORD-ID
 12553     MOVE '6'                  TO AT-TRAILER-TYPE
 12554     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12555                                  AT-GEN-INFO-LAST-MAINT-DT
 12556     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12557                                  AT-GEN-INFO-LAST-UPDATED-BY
 12558     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12559     MOVE DIAGI                TO AT-INFO-LINE-1.
 12560     MOVE ICD1I                TO AT-ICD-CODE-1.
 12561     MOVE ICD2I                TO AT-ICD-CODE-2.
 12562
 12563
 12564* EXEC CICS WRITE
 12565*        DATASET (TRLR-FILE-ID)
 12566*        FROM    (ACTIVITY-TRAILERS)
 12567*        RIDFLD  (TRLR-KEY)
 12568*    END-EXEC.
 12569     MOVE LENGTH OF
 12570      ACTIVITY-TRAILERS
 12571       TO DFHEIV11
 12572*    MOVE '&$ L                  ''   #00011077' TO DFHEIV0
 12573     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12575     MOVE X'2020233030303131303737' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0,
 12577           TRLR-FILE-ID,
 12578           ACTIVITY-TRAILERS,
 12579           DFHEIV11,
 12580           TRLR-KEY,
 12581           DFHEIV99,
 12582           DFHEIV99
 12583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12584
 12585
 12586 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 233
* EL131.cbl
 12587     EXIT.
 12588
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 234
* EL131.cbl
 12590 2430-UPDATE-ACTQ.
 12591
 12592* EXEC CICS HANDLE CONDITION
 12593*         NOTFND    (2430-EXIT)
 12594*         ENDFILE   (2440-EXIT)
 12595*    END-EXEC.
 12596*    MOVE '"$I''                  ! 7 #00011088' TO DFHEIV0
 12597     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12599     MOVE X'3720233030303131303838' TO DFHEIV0(25:11)
 12600     CALL 'kxdfhei1' USING DFHEIV0
 12601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12602
 12603
 12604
 12605* EXEC CICS STARTBR
 12606*         DATASET  (ACTQ-FILE-ID)
 12607*         RIDFLD   (ACTQ-KEY)
 12608*    END-EXEC.
 12609     MOVE 0
 12610       TO DFHEIV11
 12611*    MOVE '&,         G          &   #00011093' TO DFHEIV0
 12612     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12614     MOVE X'2020233030303131303933' TO DFHEIV0(25:11)
 12615     CALL 'kxdfhei1' USING DFHEIV0,
 12616           ACTQ-FILE-ID,
 12617           ACTQ-KEY,
 12618           DFHEIV99,
 12619           DFHEIV11,
 12620           DFHEIV99
 12621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12622
 12623
 12624
 12625* EXEC CICS GETMAIN
 12626*         SET      (ADDRESS OF ACTIVITY-QUE)
 12627*         LENGTH   (ACTQ-LENGTH)
 12628*         INITIMG  (GETMAIN-SPACE)
 12629*    END-EXEC.
 12630*    MOVE ',"IL                  $   #00011098' TO DFHEIV0
 12631     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12633     MOVE X'2020233030303131303938' TO DFHEIV0(25:11)
 12634     CALL 'kxdfhei1' USING DFHEIV0,
 12635           DFHEIV20,
 12636           ACTQ-LENGTH,
 12637           GETMAIN-SPACE
 12638     SET ADDRESS OF ACTIVITY-QUE TO
 12639         DFHEIV20
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12644
 12645 2430-EXIT.
 12646     EXIT.
 12647
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 235
* EL131.cbl
 12648 2440-CHANGE-ACTQ.
 12649
 12650
 12651* EXEC CICS READNEXT
 12652*         DATASET  (ACTQ-FILE-ID)
 12653*         RIDFLD   (ACTQ-KEY)
 12654*         INTO     (ACTIVITY-QUE)
 12655*    END-EXEC.
 12656     MOVE LENGTH OF
 12657      ACTIVITY-QUE
 12658       TO DFHEIV12
 12659     MOVE 0
 12660       TO DFHEIV11
 12661*    MOVE '&.IL                  )   #00011111' TO DFHEIV0
 12662     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12664     MOVE X'2020233030303131313131' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0,
 12666           ACTQ-FILE-ID,
 12667           ACTIVITY-QUE,
 12668           DFHEIV12,
 12669           ACTQ-KEY,
 12670           DFHEIV99,
 12671           DFHEIV11,
 12672           DFHEIV99,
 12673           DFHEIV99
 12674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12675
 12676
 12677
 12678* EXEC CICS ENDBR
 12679*         DATASET (ACTQ-FILE-ID)
 12680*    END-EXEC.
 12681     MOVE 0
 12682       TO DFHEIV11
 12683*    MOVE '&2                    $   #00011117' TO DFHEIV0
 12684     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12686     MOVE X'2020233030303131313137' TO DFHEIV0(25:11)
 12687     CALL 'kxdfhei1' USING DFHEIV0,
 12688           ACTQ-FILE-ID,
 12689           DFHEIV11,
 12690           DFHEIV99
 12691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12692
 12693
 12694     IF ACTQ-KEY NOT = MSTR-KEY
 12695         GO TO 2440-EXIT.
 12696
 12697
 12698* EXEC CICS READ UPDATE
 12699*         DATASET  (ACTQ-FILE-ID)
 12700*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12701*         SET      (ADDRESS OF ACTIVITY-QUE)
 12702*    END-EXEC.
 12703*    MOVE '&"S        EU         (   #00011124' TO DFHEIV0
 12704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12705     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 236
* EL131.cbl
 12706     MOVE X'2020233030303131313234' TO DFHEIV0(25:11)
 12707     CALL 'kxdfhei1' USING DFHEIV0,
 12708           ACTQ-FILE-ID,
 12709           DFHEIV20,
 12710           DFHEIV99,
 12711           AQ-CONTROL-PRIMARY,
 12712           DFHEIV99,
 12713           DFHEIV99,
 12714           DFHEIV99
 12715     SET ADDRESS OF ACTIVITY-QUE TO
 12716         DFHEIV20
 12717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12718
 12719
 12720     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12721
 12722
 12723* EXEC CICS DELETE
 12724*         DATASET (ACTQ-FILE-ID)
 12725*    END-EXEC.
 12726*    MOVE '&(                    &   #00011132' TO DFHEIV0
 12727     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12728     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12729     MOVE X'2020233030303131313332' TO DFHEIV0(25:11)
 12730     CALL 'kxdfhei1' USING DFHEIV0,
 12731           ACTQ-FILE-ID,
 12732           DFHEIV99,
 12733           DFHEIV99,
 12734           DFHEIV99,
 12735           DFHEIV99
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12740     IF CERTI GREATER THAN LOW-VALUES
 12741        MOVE CERTI               TO AQ-CERT-PRIME.
 12742     IF SUFXI GREATER THAN LOW-VALUES
 12743        MOVE SUFXI               TO AQ-CERT-SFX.
 12744     IF CERTCARI GREATER THAN LOW-VALUES
 12745        MOVE CERTCARI            TO AQ-CARRIER.
 12746
 12747
 12748* EXEC CICS HANDLE CONDITION
 12749*         DUPREC   (2440-EXIT)
 12750*    END-EXEC.
 12751*    MOVE '"$%                   ! 8 #00011144' TO DFHEIV0
 12752     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12754     MOVE X'3820233030303131313434' TO DFHEIV0(25:11)
 12755     CALL 'kxdfhei1' USING DFHEIV0
 12756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12757
 12758
 12759
 12760* EXEC CICS WRITE
 12761*         DATASET  (ACTQ-FILE-ID)
 12762*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12763*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 237
* EL131.cbl
 12764*    END-EXEC.
 12765     MOVE LENGTH OF
 12766      ACTIVITY-QUE
 12767       TO DFHEIV11
 12768*    MOVE '&$ L                  ''   #00011148' TO DFHEIV0
 12769     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12771     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 12772     CALL 'kxdfhei1' USING DFHEIV0,
 12773           ACTQ-FILE-ID,
 12774           ACTIVITY-QUE,
 12775           DFHEIV11,
 12776           AQ-CONTROL-PRIMARY,
 12777           DFHEIV99,
 12778           DFHEIV99
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782 2440-EXIT.
 12783     EXIT.
 12784
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 238
* EL131.cbl
 12786 2460-UPDATE-CHECKQ.
 12787
 12788* EXEC CICS HANDLE CONDITION
 12789*         NOTFND   (2460-EXIT)
 12790*    END-EXEC.
 12791*    MOVE '"$I                   ! 9 #00011159' TO DFHEIV0
 12792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12794     MOVE X'3920233030303131313539' TO DFHEIV0(25:11)
 12795     CALL 'kxdfhei1' USING DFHEIV0
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12800     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12801     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12802
 12803
 12804* EXEC CICS READ UPDATE
 12805*         DATASET   (CHKQ-FILE-ID)
 12806*         RIDFLD    (CHKQ-KEY)
 12807*         SET       (ADDRESS OF CHECK-QUE)
 12808*    END-EXEC.
 12809*    MOVE '&"S        EU         (   #00011167' TO DFHEIV0
 12810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12812     MOVE X'2020233030303131313637' TO DFHEIV0(25:11)
 12813     CALL 'kxdfhei1' USING DFHEIV0,
 12814           CHKQ-FILE-ID,
 12815           DFHEIV20,
 12816           DFHEIV99,
 12817           CHKQ-KEY,
 12818           DFHEIV99,
 12819           DFHEIV99,
 12820           DFHEIV99
 12821     SET ADDRESS OF CHECK-QUE TO
 12822         DFHEIV20
 12823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12824
 12825
 12826     IF CERTI GREATER THAN LOW-VALUES
 12827        MOVE CERTI               TO CQ-CERT-PRIME.
 12828     IF SUFXI GREATER THAN LOW-VALUES
 12829        MOVE SUFXI               TO CQ-CERT-SFX.
 12830     IF CERTCARI GREATER THAN LOW-VALUES
 12831        MOVE CERTCARI            TO CQ-CARRIER.
 12832
 12833
 12834* EXEC CICS REWRITE
 12835*         DATASET  (CHKQ-FILE-ID)
 12836*         FROM     (CHECK-QUE)
 12837*    END-EXEC.
 12838     MOVE LENGTH OF
 12839      CHECK-QUE
 12840       TO DFHEIV11
 12841*    MOVE '&& L                  %   #00011180' TO DFHEIV0
 12842     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 239
* EL131.cbl
 12844     MOVE X'2020233030303131313830' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0,
 12846           CHKQ-FILE-ID,
 12847           CHECK-QUE,
 12848           DFHEIV11,
 12849           DFHEIV99
 12850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12851
 12852
 12853 2460-EXIT.
 12854     EXIT.
 12855
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 240
* EL131.cbl
 12857 2475-UPDATE-LETTER.
 12858
 12859* EXEC CICS HANDLE CONDITION
 12860*         NOTFND   (2475-EXIT)
 12861*    END-EXEC.
 12862*    MOVE '"$I                   ! : #00011190' TO DFHEIV0
 12863     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12865     MOVE X'3A20233030303131313930' TO DFHEIV0(25:11)
 12866     CALL 'kxdfhei1' USING DFHEIV0
 12867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12868
 12869
 12870     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12871     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12872     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12873     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12874
 12875
 12876* EXEC CICS READ UPDATE
 12877*         DATASET   (ARCH-FILE-ID)
 12878*         RIDFLD    (ARCH-KEY)
 12879*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12880*    END-EXEC.
 12881*    MOVE '&"S        EU         (   #00011199' TO DFHEIV0
 12882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12884     MOVE X'2020233030303131313939' TO DFHEIV0(25:11)
 12885     CALL 'kxdfhei1' USING DFHEIV0,
 12886           ARCH-FILE-ID,
 12887           DFHEIV20,
 12888           DFHEIV99,
 12889           ARCH-KEY,
 12890           DFHEIV99,
 12891           DFHEIV99,
 12892           DFHEIV99
 12893     SET ADDRESS OF LETTER-ARCHIVE TO
 12894         DFHEIV20
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12899* TO THIS MASTER-KEY INFORMATION.
 12900
 12901     IF LA-CARRIER  = CARRIER-CODE AND
 12902        LA-CLAIM-NO = CLAIM-NO     AND
 12903        LA-CERT-NO  = CERT-NO
 12904        NEXT SENTENCE
 12905     ELSE
 12906        GO TO 2475-UNLOCK.
 12907
 12908     IF CERTI GREATER THAN LOW-VALUES
 12909        MOVE CERTI               TO LA-CERT-PRIME.
 12910     IF SUFXI GREATER THAN LOW-VALUES
 12911        MOVE SUFXI               TO LA-CERT-SFX.
 12912     IF CERTCARI GREATER THAN LOW-VALUES
 12913        MOVE CERTCARI            TO LA-CARRIER.
 12914
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 241
* EL131.cbl
 12915
 12916* EXEC CICS REWRITE
 12917*         DATASET  (ARCH-FILE-ID)
 12918*         FROM     (LETTER-ARCHIVE)
 12919*    END-EXEC.
 12920     MOVE LENGTH OF
 12921      LETTER-ARCHIVE
 12922       TO DFHEIV11
 12923*    MOVE '&& L                  %   #00011222' TO DFHEIV0
 12924     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12925     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12926     MOVE X'2020233030303131323232' TO DFHEIV0(25:11)
 12927     CALL 'kxdfhei1' USING DFHEIV0,
 12928           ARCH-FILE-ID,
 12929           LETTER-ARCHIVE,
 12930           DFHEIV11,
 12931           DFHEIV99
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935     GO TO 2475-EXIT.
 12936
 12937 2475-UNLOCK.
 12938
 12939* EXEC CICS UNLOCK
 12940*         DATASET  (ARCH-FILE-ID)
 12941*    END-EXEC.
 12942*    MOVE '&*                    #   #00011230' TO DFHEIV0
 12943     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12944     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12945     MOVE X'2020233030303131323330' TO DFHEIV0(25:11)
 12946     CALL 'kxdfhei1' USING DFHEIV0,
 12947           ARCH-FILE-ID,
 12948           DFHEIV99
 12949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12950
 12951
 12952 2475-EXIT.
 12953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 242
* EL131.cbl
 12955 2600-CREATE-MAINT-NOTE.
 12956     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12957     MOVE '1'                    TO CNTL-REC-TYPE.
 12958     MOVE SPACES                 TO CNTL-PROC-ID.
 12959     MOVE ZERO                   TO CNTL-SEQ-NO.
 12960
 12961
 12962* EXEC CICS READ
 12963*         SET        (ADDRESS OF CONTROL-FILE)
 12964*         DATASET    ('ELCNTL')
 12965*         RIDFLD     (CNTL-KEY)
 12966*    END-EXEC.
 12967     MOVE 'ELCNTL' TO DFHEIV1
 12968*    MOVE '&"S        E          (   #00011243' TO DFHEIV0
 12969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12971     MOVE X'2020233030303131323433' TO DFHEIV0(25:11)
 12972     CALL 'kxdfhei1' USING DFHEIV0,
 12973           DFHEIV1,
 12974           DFHEIV20,
 12975           DFHEIV99,
 12976           CNTL-KEY,
 12977           DFHEIV99,
 12978           DFHEIV99,
 12979           DFHEIV99
 12980     SET ADDRESS OF CONTROL-FILE TO
 12981         DFHEIV20
 12982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12983
 12984
 12985     IF CO-NO-USE-AUDIT-CHANGES
 12986         GO TO 2600-EXIT.
 12987
 12988     IF PROCL GREATER ZERO
 12989     IF PROCI NOT = LOW-VALUES
 12990     IF PROCI NOT = CL-PROCESSOR-ID
 12991         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12992         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12993         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12994
 12995     IF SEXL GREATER ZERO
 12996     IF SEXI NOT = LOW-VALUES
 12997     IF SEXI NOT = CL-INSURED-SEX-CD
 12998         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12999         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13000         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13001
 13002     IF BIRTHL GREATER ZERO
 13003     IF HOLD-BIRTH NOT = LOW-VALUES
 13004     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13005         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13006         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13007         MOVE SPACES               TO DC-OPTION-CODE
 13008         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13009         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13010         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13011
 13012     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 243
* EL131.cbl
 13013     IF SOCIALI NOT = LOW-VALUES
 13014     IF SOCIALI NOT = CL-SOC-SEC-NO
 13015         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13016         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13017         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13018
 13019     IF OCCL GREATER ZERO
 13020     IF OCCI NOT = LOW-VALUES
 13021     IF OCCI NOT = CL-INSURED-OCC-CD
 13022         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13023         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13024         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13025
 13026     IF BENEL GREATER ZERO
 13027     IF BENEI NOT = LOW-VALUES
 13028     IF BENEI NOT = CL-BENEFICIARY
 13029         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13030         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13031         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13032
 13033     IF PREMTYPL GREATER ZERO
 13034     IF PREMTYPI NOT = LOW-VALUES
 13035     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13036         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13037         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13038         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13039
 13040*    IF CAUSEL GREATER ZERO
 13041*    IF CAUSEI NOT = LOW-VALUES
 13042*    IF CAUSEI NOT = CL-CAUSE-CD
 13043*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13044*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13045*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13046
 13047*    IF ENDL GREATER ZERO
 13048*    IF HOLD-END NOT = LOW-VALUES
 13049*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13050*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13051*        MOVE CL-EST-END-OF-DISAB-DT
 13052*                                  TO DC-BIN-DATE-1
 13053*        MOVE SPACES               TO DC-OPTION-CODE
 13054*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13055*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13056*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13057
 13058     IF PDTHRUL GREATER ZERO
 13059     IF HOLD-PDTHRU NOT = LOW-VALUES
 13060     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13061         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13062         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13063         MOVE SPACES               TO DC-OPTION-CODE
 13064         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13065         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13066         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13067
 13068     IF PDAMTL GREATER ZERO
 13069     IF HOLD-PDAMT NOT = ZEROS
 13070     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 244
* EL131.cbl
 13071         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13072         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13073         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13074         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13075
 13076     IF NODAYSL GREATER ZERO
 13077     IF HOLD-NODAYS NOT = ZEROS
 13078     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13079         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13080         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13081         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13082         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13083
 13084     IF NOPMTSL GREATER ZERO
 13085     IF HOLD-NOPMTS NOT = ZEROS
 13086     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13087         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13088         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13089         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13090         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13091
 13092     IF FORMTYPL GREATER ZERO
 13093     IF FORMTYPI NOT = LOW-VALUES
 13094     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13095         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13096         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13097         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13098
 13099     IF REPL GREATER ZERO
 13100     IF HOLD-REPORTED NOT = LOW-VALUES
 13101     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13102         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13103         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13104         MOVE SPACES               TO DC-OPTION-CODE
 13105         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13106         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13107         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13108
 13109     IF ADDONDTL GREATER ZERO
 13110     IF HOLD-ADDON NOT = LOW-VALUES
 13111     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13112         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13113         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13114         MOVE SPACES               TO DC-OPTION-CODE
 13115         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13116         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13117         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13118
 13119     IF PRICDL GREATER ZERO
 13120     IF PRICDI NOT = LOW-VALUES
 13121     IF PRICDI NOT = CL-PRIORITY-CD
 13122         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13123         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13124         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13125
 13126     IF FILETOL GREATER ZERO
 13127     IF FILETOI NOT = LOW-VALUES
 13128     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 245
* EL131.cbl
 13129         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13130         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13131         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13132
 13133     IF SUPVL GREATER ZERO
 13134     IF SUPVI NOT = LOW-VALUES
 13135     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13136         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13137         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13138         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13139*    IF (CRITPTL > ZERO)
 13140*       AND (CRITPTI NOT = LOW-VALUES)
 13141*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13142*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13143*       MOVE CL-CRIT-PER-RECURRENT
 13144*                                TO SPLIT-INFO-OLD
 13145*       PERFORM 2650-WRITE-MAINT-NOTE
 13146*                                THRU 2650-EXIT
 13147*    END-IF
 13148
 13149*    IF (RTWMOSL > ZERO)
 13150*       AND (RTWMOSI NOT = LOW-VALUES)
 13151*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13152*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13153*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13154*       PERFORM 2650-WRITE-MAINT-NOTE
 13155*                                THRU 2650-EXIT
 13156*    END-IF
 13157     IF MLNAMEL GREATER ZERO
 13158     IF MLNAMEI NOT = LOW-VALUES
 13159     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13160         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13161         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13162         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13163
 13164     IF MFNAMEL GREATER ZERO
 13165     IF MFNAMEI NOT = LOW-VALUES
 13166     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13167         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13168         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13169         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13170
 13171     IF MMINITL GREATER ZERO
 13172     IF MMINITI NOT = LOW-VALUES
 13173     IF MMINITI NOT = CL-INSURED-MID-INIT
 13174         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13175         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13176         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13177
 13178     IF CERTEFFL GREATER ZERO
 13179     IF HOLD-EFF NOT = LOW-VALUES
 13180     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13181         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13182         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13183         MOVE SPACES               TO DC-OPTION-CODE
 13184         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13185         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13186         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 246
* EL131.cbl
 13187
 13188     IF CERTACTL GREATER ZERO
 13189     IF CERTACTI NOT = LOW-VALUES
 13190     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13191         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13192         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13193         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13194
 13195     IF CERTSTL GREATER ZERO
 13196     IF CERTSTI NOT = LOW-VALUES
 13197     IF CERTSTI NOT = CL-CERT-STATE
 13198         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13199         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13200         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13201
 13202     IF CERTCARL GREATER ZERO
 13203     IF CERTCARI NOT = LOW-VALUES
 13204     IF CERTCARI NOT = CL-CERT-CARRIER
 13205         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13206         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13207         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13208
 13209     IF CERTGRPL GREATER ZERO
 13210     IF CERTGRPI NOT = LOW-VALUES
 13211     IF CERTGRPI NOT = CL-CERT-GROUPING
 13212         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13213         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13214         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13215
 13216     IF CERTL GREATER ZERO OR
 13217        SUFXL GREATER ZERO
 13218     IF (CERTI NOT = LOW-VALUES AND
 13219                     CL-CERT-PRIME)
 13220                OR
 13221        (SUFXI NOT = LOW-VALUES AND
 13222                     CL-CERT-SFX)
 13223         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13224         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13225         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13226     IF incl > zeros
 13227        IF (HOLD-INCUR NOT = LOW-VALUES)
 13228           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13229           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13230           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13231           MOVE SPACES           TO DC-OPTION-CODE
 13232           PERFORM 9800-CONVERT-DATE
 13233                                 THRU 9800-EXIT
 13234           MOVE DC-GREG-DATE-1-EDIT
 13235                                 TO SPLIT-INFO-OLD
 13236           PERFORM 2650-WRITE-MAINT-NOTE
 13237                                 THRU 2650-EXIT
 13238        END-IF
 13239     END-IF
 13240     .
 13241 2600-EXIT.
 13242      EXIT.
 13243
 13244 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 247
* EL131.cbl
 13245
 13246* EXEC CICS GETMAIN
 13247*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13248*         LENGTH   (TRLR-LENGTH)
 13249*         INITIMG  (GETMAIN-SPACE)
 13250*    END-EXEC.
 13251*    MOVE ',"IL                  $   #00011509' TO DFHEIV0
 13252     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13253     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13254     MOVE X'2020233030303131353039' TO DFHEIV0(25:11)
 13255     CALL 'kxdfhei1' USING DFHEIV0,
 13256           DFHEIV20,
 13257           TRLR-LENGTH,
 13258           GETMAIN-SPACE
 13259     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13260         DFHEIV20
 13261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13262
 13263
 13264
 13265* EXEC CICS HANDLE CONDITION
 13266*         DUPREC   (2650-EXIT)
 13267*    END-EXEC.
 13268*    MOVE '"$%                   ! ; #00011515' TO DFHEIV0
 13269     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13271     MOVE X'3B20233030303131353135' TO DFHEIV0(25:11)
 13272     CALL 'kxdfhei1' USING DFHEIV0
 13273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13274
 13275
 13276     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13277
 13278     IF CERTL GREATER ZERO
 13279         MOVE CERTI          TO CL-CERT-PRIME.
 13280
 13281     IF SUFXL GREATER ZERO
 13282         MOVE SUFXI          TO CL-CERT-SFX.
 13283
 13284     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13285
 13286     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13287     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13288
 13289     MOVE 'AT'               TO AT-RECORD-ID.
 13290
 13291     MOVE '6'                TO AT-TRAILER-TYPE.
 13292     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13293                                AT-GEN-INFO-LAST-MAINT-DT.
 13294     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13295                                AT-GEN-INFO-LAST-UPDATED-BY.
 13296     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13297     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13298     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13299
 13300
 13301* EXEC CICS WRITE
 13302*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 248
* EL131.cbl
 13303*         RIDFLD   (AT-CONTROL-PRIMARY)
 13304*         FROM     (ACTIVITY-TRAILERS)
 13305*    END-EXEC.
 13306     MOVE LENGTH OF
 13307      ACTIVITY-TRAILERS
 13308       TO DFHEIV11
 13309*    MOVE '&$ L                  ''   #00011543' TO DFHEIV0
 13310     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13311     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13312     MOVE X'2020233030303131353433' TO DFHEIV0(25:11)
 13313     CALL 'kxdfhei1' USING DFHEIV0,
 13314           TRLR-FILE-ID,
 13315           ACTIVITY-TRAILERS,
 13316           DFHEIV11,
 13317           AT-CONTROL-PRIMARY,
 13318           DFHEIV99,
 13319           DFHEIV99
 13320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13321
 13322
 13323 2650-EXIT.
 13324      EXIT.
 13325
 13326 2800-CHECK-AUTO-PAY.
 13327
 13328     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13329     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13330     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13331     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13332     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13333
 13334
 13335* EXEC CICS HANDLE CONDITION
 13336*         NOTFND    (2800-EXIT)
 13337*         ENDFILE   (2800-EXIT)
 13338*    END-EXEC.
 13339*    MOVE '"$I''                  ! < #00011560' TO DFHEIV0
 13340     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13342     MOVE X'3C20233030303131353630' TO DFHEIV0(25:11)
 13343     CALL 'kxdfhei1' USING DFHEIV0
 13344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13345
 13346
 13347
 13348* EXEC CICS READ
 13349*        DATASET (TRLR-FILE-ID)
 13350*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13351*        RIDFLD  (TRLR-KEY)
 13352*    END-EXEC.
 13353*    MOVE '&"S        E          (   #00011565' TO DFHEIV0
 13354     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13356     MOVE X'2020233030303131353635' TO DFHEIV0(25:11)
 13357     CALL 'kxdfhei1' USING DFHEIV0,
 13358           TRLR-FILE-ID,
 13359           DFHEIV20,
 13360           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 249
* EL131.cbl
 13361           TRLR-KEY,
 13362           DFHEIV99,
 13363           DFHEIV99,
 13364           DFHEIV99
 13365     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13366         DFHEIV20
 13367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13368
 13369
 13370     IF BENEFICIARY-PAID-AUTO
 13371         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13372     END-IF.
 13373
 13374 2800-EXIT.
 13375      EXIT.
 13376
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 250
* EL131.cbl
 13378 3000-DELETE-CLAIM.
 13379     IF  NOT MODIFY-CAP
 13380         MOVE ER-0070            TO EMI-ERROR
 13381         MOVE -1                 TO MAINTL
 13382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13383         GO TO 8110-SEND-DATA.
 13384
 13385
 13386* EXEC CICS READ
 13387*         SET      (ADDRESS OF CLAIM-MASTER)
 13388*         DATASET  (CLMS-FILE-ID)
 13389*         RIDFLD   (MSTR-KEY)
 13390*    END-EXEC.
 13391*    MOVE '&"S        E          (   #00011586' TO DFHEIV0
 13392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13394     MOVE X'2020233030303131353836' TO DFHEIV0(25:11)
 13395     CALL 'kxdfhei1' USING DFHEIV0,
 13396           CLMS-FILE-ID,
 13397           DFHEIV20,
 13398           DFHEIV99,
 13399           MSTR-KEY,
 13400           DFHEIV99,
 13401           DFHEIV99,
 13402           DFHEIV99
 13403     SET ADDRESS OF CLAIM-MASTER TO
 13404         DFHEIV20
 13405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13406
 13407
 13408     IF CL-1ST-TRL-AVAIL
 13409         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13410     ELSE
 13411        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13412        MOVE 0                   TO TRLR-SEQ-NO
 13413
 13414* EXEC CICS STARTBR
 13415*            DATASET (TRLR-FILE-ID)
 13416*            RIDFLD  (TRLR-KEY)
 13417*        END-EXEC
 13418     MOVE 0
 13419       TO DFHEIV11
 13420*    MOVE '&,         G          &   #00011597' TO DFHEIV0
 13421     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13422     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13423     MOVE X'2020233030303131353937' TO DFHEIV0(25:11)
 13424     CALL 'kxdfhei1' USING DFHEIV0,
 13425           TRLR-FILE-ID,
 13426           TRLR-KEY,
 13427           DFHEIV99,
 13428           DFHEIV11,
 13429           DFHEIV99
 13430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13431         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13432
 13433* EXEC CICS ENDBR
 13434*            DATASET (TRLR-FILE-ID)
 13435*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 251
* EL131.cbl
 13436     MOVE 0
 13437       TO DFHEIV11
 13438*    MOVE '&2                    $   #00011602' TO DFHEIV0
 13439     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13441     MOVE X'2020233030303131363032' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           TRLR-FILE-ID,
 13444           DFHEIV11,
 13445           DFHEIV99
 13446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13447        IF SCREEN-ERROR
 13448            MOVE ER-0208         TO EMI-ERROR
 13449            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13450            MOVE -1              TO MAINTL
 13451            GO TO 8110-SEND-DATA
 13452        ELSE
 13453            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13454
 13455     IF SCREEN-ERROR
 13456         MOVE -1                 TO MAINTL
 13457         GO TO 8110-SEND-DATA.
 13458
 13459     MOVE -1                     TO ONE-OR-MIN1.
 13460     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13461
 13462     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13463         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13464                                    WS-SAVE-CLAIM-KEY
 13465         MOVE +1                 TO ONE-OR-MIN1
 13466         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13467
 13468     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13469
 13470     MOVE LOW-VALUES             TO EL131AO.
 13471     MOVE ER-0000                TO EMI-ERROR.
 13472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13473     MOVE 'X'                    TO PI-RETURN-CD-1.
 13474     MOVE -1                     TO MAINTL.
 13475     GO TO 8100-SEND-MAP.
 13476
 13477 3010-DEL-MSTR-TRLR.
 13478
 13479* EXEC CICS READ UPDATE
 13480*         SET       (ADDRESS OF CLAIM-MASTER)
 13481*         DATASET   (CLMS-FILE-ID)
 13482*         RIDFLD    (MSTR-KEY)
 13483*    END-EXEC.
 13484*    MOVE '&"S        EU         (   #00011636' TO DFHEIV0
 13485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13486     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13487     MOVE X'2020233030303131363336' TO DFHEIV0(25:11)
 13488     CALL 'kxdfhei1' USING DFHEIV0,
 13489           CLMS-FILE-ID,
 13490           DFHEIV20,
 13491           DFHEIV99,
 13492           MSTR-KEY,
 13493           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 252
* EL131.cbl
 13494           DFHEIV99,
 13495           DFHEIV99
 13496     SET ADDRESS OF CLAIM-MASTER TO
 13497         DFHEIV20
 13498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13499
 13500
 13501     if (cl-priority-cd = '8')
 13502        and (pi-processor-id not = 'PEMA' and 'JMS '
 13503             AND 'AMWA')
 13504        MOVE ER-8003             TO EMI-ERROR
 13505        PERFORM 9900-ERROR-FORMAT
 13506                                 THRU 9900-EXIT
 13507        MOVE -1                  TO MAINTL
 13508        GO TO 8110-SEND-DATA
 13509     end-if
 13510
 13511     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13512     MOVE ZERO                   TO TRLR-SEQ-NO.
 13513
 13514
 13515* EXEC CICS HANDLE CONDITION
 13516*         NOTFND    (3010-DEL-ACTQ)
 13517*         ENDFILE   (3040-EXIT)
 13518*    END-EXEC.
 13519*    MOVE '"$I''                  ! = #00011655' TO DFHEIV0
 13520     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13522     MOVE X'3D20233030303131363535' TO DFHEIV0(25:11)
 13523     CALL 'kxdfhei1' USING DFHEIV0
 13524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13525
 13526
 13527     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13528
 13529 3010-DEL-ACTQ.
 13530
 13531
 13532* EXEC CICS HANDLE CONDITION
 13533*         NOTFND    (3010-NO-ACTIVITY)
 13534*         ENDFILE   (3050-EXIT)
 13535*    END-EXEC.
 13536*    MOVE '"$I''                  ! > #00011664' TO DFHEIV0
 13537     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13539     MOVE X'3E20233030303131363634' TO DFHEIV0(25:11)
 13540     CALL 'kxdfhei1' USING DFHEIV0
 13541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13542
 13543
 13544
 13545* EXEC CICS STARTBR
 13546*         DATASET  (ACTQ-FILE-ID)
 13547*         RIDFLD   (ACTQ-KEY)
 13548*    END-EXEC.
 13549     MOVE 0
 13550       TO DFHEIV11
 13551*    MOVE '&,         G          &   #00011669' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 253
* EL131.cbl
 13552     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13554     MOVE X'2020233030303131363639' TO DFHEIV0(25:11)
 13555     CALL 'kxdfhei1' USING DFHEIV0,
 13556           ACTQ-FILE-ID,
 13557           ACTQ-KEY,
 13558           DFHEIV99,
 13559           DFHEIV11,
 13560           DFHEIV99
 13561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13562
 13563
 13564
 13565* EXEC CICS GETMAIN
 13566*         SET      (ADDRESS OF ACTIVITY-QUE)
 13567*         LENGTH   (ACTQ-LENGTH)
 13568*         INITIMG  (GETMAIN-SPACE)
 13569*    END-EXEC.
 13570*    MOVE ',"IL                  $   #00011674' TO DFHEIV0
 13571     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13573     MOVE X'2020233030303131363734' TO DFHEIV0(25:11)
 13574     CALL 'kxdfhei1' USING DFHEIV0,
 13575           DFHEIV20,
 13576           ACTQ-LENGTH,
 13577           GETMAIN-SPACE
 13578     SET ADDRESS OF ACTIVITY-QUE TO
 13579         DFHEIV20
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13581
 13582
 13583     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13584
 13585
 13586* EXEC CICS ENDBR
 13587*         DATASET (ACTQ-FILE-ID)
 13588*    END-EXEC.
 13589     MOVE 0
 13590       TO DFHEIV11
 13591*    MOVE '&2                    $   #00011682' TO DFHEIV0
 13592     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303131363832' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           ACTQ-FILE-ID,
 13597           DFHEIV11,
 13598           DFHEIV99
 13599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13600
 13601
 13602 3010-NO-ACTIVITY.
 13603
 13604
 13605* EXEC CICS HANDLE CONDITION
 13606*        NOTFND   (3010-CERT-NOT-FOUND)
 13607*    END-EXEC.
 13608*    MOVE '"$I                   ! ? #00011688' TO DFHEIV0
 13609     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 254
* EL131.cbl
 13610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13611     MOVE X'3F20233030303131363838' TO DFHEIV0(25:11)
 13612     CALL 'kxdfhei1' USING DFHEIV0
 13613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13614
 13615
 13616     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13617     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13618     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13619     MOVE CL-CERT-STATE          TO CERT-STATE.
 13620     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13621     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13622     MOVE CL-CERT-NO             TO CERT-CERT.
 13623
 13624
 13625* EXEC CICS READ
 13626*        DATASET   (CERT-FILE-ID)
 13627*        RIDFLD    (CERT-KEY)
 13628*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13629*    END-EXEC.
 13630*    MOVE '&"S        E          (   #00011700' TO DFHEIV0
 13631     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13632     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13633     MOVE X'2020233030303131373030' TO DFHEIV0(25:11)
 13634     CALL 'kxdfhei1' USING DFHEIV0,
 13635           CERT-FILE-ID,
 13636           DFHEIV20,
 13637           DFHEIV99,
 13638           CERT-KEY,
 13639           DFHEIV99,
 13640           DFHEIV99,
 13641           DFHEIV99
 13642     SET ADDRESS OF CERTIFICATE-MASTER TO
 13643         DFHEIV20
 13644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13645
 13646
 13647     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13648       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13649         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13650     ELSE
 13651         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13652
 13653 3010-UPDATE-CERT-TRLR.
 13654
 13655     MOVE CERT-KEY               TO ELCRTT-KEY
 13656     MOVE 'B'                    TO CTRLR-REC-TYPE
 13657
 13658* EXEC CICS READ
 13659*       UPDATE
 13660*       DATASET   ('ELCRTT')
 13661*       RIDFLD    (ELCRTT-KEY)
 13662*       INTO      (CERTIFICATE-TRAILERS)
 13663*       RESP      (WS-RESPONSE)
 13664*    END-EXEC
 13665     MOVE LENGTH OF
 13666      CERTIFICATE-TRAILERS
 13667       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 255
* EL131.cbl
 13668     MOVE 'ELCRTT' TO DFHEIV1
 13669*    MOVE '&"IL       EU         (  N#00011716' TO DFHEIV0
 13670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13672     MOVE X'204E233030303131373136' TO DFHEIV0(25:11)
 13673     CALL 'kxdfhei1' USING DFHEIV0,
 13674           DFHEIV1,
 13675           CERTIFICATE-TRAILERS,
 13676           DFHEIV11,
 13677           ELCRTT-KEY,
 13678           DFHEIV99,
 13679           DFHEIV99,
 13680           DFHEIV99
 13681     MOVE EIBRESP  TO WS-RESPONSE
 13682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13683     IF WS-RESP-NORMAL
 13684        perform varying s1 from +1 by +1 until
 13685           (s1 > +24)
 13686           or (cs-claim-no (s1) = cl-claim-no)
 13687        end-perform
 13688        if s1 < +25
 13689           move spaces           to cs-claim-no (s1)
 13690                                    cs-claim-type (s1)
 13691                                    cs-insured-type (s1)
 13692           move zeros            to cs-days-paid (s1)
 13693                                    cs-total-paid (s1)
 13694                                    cs-benefit-period (s1)
 13695           if s1 not = +24
 13696              compute s2 = s1 + +1
 13697              perform 3015-bump  thru 3015-exit
 13698           end-if
 13699
 13700* EXEC CICS REWRITE
 13701*             DATASET   ('ELCRTT')
 13702*             FROM      (CERTIFICATE-TRAILERS)
 13703*          END-EXEC
 13704     MOVE LENGTH OF
 13705      CERTIFICATE-TRAILERS
 13706       TO DFHEIV11
 13707     MOVE 'ELCRTT' TO DFHEIV1
 13708*    MOVE '&& L                  %   #00011739' TO DFHEIV0
 13709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13711     MOVE X'2020233030303131373339' TO DFHEIV0(25:11)
 13712     CALL 'kxdfhei1' USING DFHEIV0,
 13713           DFHEIV1,
 13714           CERTIFICATE-TRAILERS,
 13715           DFHEIV11,
 13716           DFHEIV99
 13717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13718        end-if
 13719     end-if
 13720     .
 13721 3010-CERT-NOT-FOUND.
 13722
 13723
 13724* EXEC CICS DELETE
 13725*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 256
* EL131.cbl
 13726*    END-EXEC.
 13727*    MOVE '&(                    &   #00011748' TO DFHEIV0
 13728     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13729     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13730     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
 13731     CALL 'kxdfhei1' USING DFHEIV0,
 13732           CLMS-FILE-ID,
 13733           DFHEIV99,
 13734           DFHEIV99,
 13735           DFHEIV99,
 13736           DFHEIV99
 13737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13738
 13739
 13740 3010-EXIT.
 13741      EXIT.
 13742
 13743 3015-bump.
 13744     perform varying s2 from s2 by +1 until s2 > +24
 13745        move cs-mb-claim-data (s2)
 13746                                 to cs-mb-claim-data (s1)
 13747        move spaces              to cs-mb-claim-data (s2)
 13748        add +1 to s1
 13749     end-perform
 13750     .
 13751 3015-exit.
 13752     exit.
 13753 3020-UPDATE-CERT.
 13754
 13755* EXEC CICS READ UPDATE
 13756*         DATASET  (CERT-FILE-ID)
 13757*         RIDFLD   (CERT-KEY)
 13758*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13759*    END-EXEC.
 13760*    MOVE '&"S        EU         (   #00011766' TO DFHEIV0
 13761     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13762     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13763     MOVE X'2020233030303131373636' TO DFHEIV0(25:11)
 13764     CALL 'kxdfhei1' USING DFHEIV0,
 13765           CERT-FILE-ID,
 13766           DFHEIV20,
 13767           DFHEIV99,
 13768           CERT-KEY,
 13769           DFHEIV99,
 13770           DFHEIV99,
 13771           DFHEIV99
 13772     SET ADDRESS OF CERTIFICATE-MASTER TO
 13773         DFHEIV20
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13775
 13776
 13777     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13778
 13779
 13780* EXEC CICS HANDLE CONDITION
 13781*         DUPKEY   (3020-EXIT)
 13782*    END-EXEC.
 13783*    MOVE '"$$                   ! @ #00011774' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 257
* EL131.cbl
 13784     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13786     MOVE X'4020233030303131373734' TO DFHEIV0(25:11)
 13787     CALL 'kxdfhei1' USING DFHEIV0
 13788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13789
 13790
 13791
 13792* EXEC CICS REWRITE
 13793*         DATASET  (CERT-FILE-ID)
 13794*         FROM     (CERTIFICATE-MASTER)
 13795*    END-EXEC.
 13796     MOVE LENGTH OF
 13797      CERTIFICATE-MASTER
 13798       TO DFHEIV11
 13799*    MOVE '&& L                  %   #00011778' TO DFHEIV0
 13800     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13801     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13802     MOVE X'2020233030303131373738' TO DFHEIV0(25:11)
 13803     CALL 'kxdfhei1' USING DFHEIV0,
 13804           CERT-FILE-ID,
 13805           CERTIFICATE-MASTER,
 13806           DFHEIV11,
 13807           DFHEIV99
 13808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13809
 13810
 13811 3020-EXIT.
 13812     EXIT.
 13813
 13814 3030-DELETE-CERT.
 13815
 13816* EXEC CICS READ UPDATE
 13817*         DATASET  (CERT-FILE-ID)
 13818*         RIDFLD   (CERT-KEY)
 13819*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13820*    END-EXEC.
 13821*    MOVE '&"S        EU         (   #00011787' TO DFHEIV0
 13822     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13823     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13824     MOVE X'2020233030303131373837' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0,
 13826           CERT-FILE-ID,
 13827           DFHEIV20,
 13828           DFHEIV99,
 13829           CERT-KEY,
 13830           DFHEIV99,
 13831           DFHEIV99,
 13832           DFHEIV99
 13833     SET ADDRESS OF CERTIFICATE-MASTER TO
 13834         DFHEIV20
 13835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13836
 13837
 13838
 13839* EXEC CICS DELETE
 13840*         DATASET   (CERT-FILE-ID)
 13841*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 258
* EL131.cbl
 13842*    MOVE '&(                    &   #00011793' TO DFHEIV0
 13843     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13845     MOVE X'2020233030303131373933' TO DFHEIV0(25:11)
 13846     CALL 'kxdfhei1' USING DFHEIV0,
 13847           CERT-FILE-ID,
 13848           DFHEIV99,
 13849           DFHEIV99,
 13850           DFHEIV99,
 13851           DFHEIV99
 13852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13853
 13854
 13855 3030-EXIT.
 13856     EXIT.
 13857
 13858 3040-DELETE-TRLR.
 13859
 13860* EXEC CICS READ
 13861*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13862*         DATASET  (TRLR-FILE-ID)
 13863*         RIDFLD   (TRLR-KEY)
 13864*         GTEQ
 13865*    END-EXEC.
 13866*    MOVE '&"S        G          (   #00011801' TO DFHEIV0
 13867     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13869     MOVE X'2020233030303131383031' TO DFHEIV0(25:11)
 13870     CALL 'kxdfhei1' USING DFHEIV0,
 13871           TRLR-FILE-ID,
 13872           DFHEIV20,
 13873           DFHEIV99,
 13874           TRLR-KEY,
 13875           DFHEIV99,
 13876           DFHEIV99,
 13877           DFHEIV99
 13878     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13879         DFHEIV20
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13881
 13882
 13883     IF PI-COMPANY-CD = AT-COMPANY-CD
 13884        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13885        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13886           GO TO 3040-EXIT
 13887        ELSE
 13888           NEXT SENTENCE
 13889     ELSE
 13890        GO TO 3040-EXIT.
 13891
 13892
 13893* EXEC CICS DELETE
 13894*         DATASET  (TRLR-FILE-ID)
 13895*         RIDFLD   (TRLR-KEY)
 13896*    END-EXEC.
 13897*    MOVE '&(  R                 &   #00011817' TO DFHEIV0
 13898     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13899     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 259
* EL131.cbl
 13900     MOVE X'2020233030303131383137' TO DFHEIV0(25:11)
 13901     CALL 'kxdfhei1' USING DFHEIV0,
 13902           TRLR-FILE-ID,
 13903           TRLR-KEY,
 13904           DFHEIV99,
 13905           DFHEIV99,
 13906           DFHEIV99
 13907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13908
 13909
 13910     GO TO 3040-DELETE-TRLR.
 13911
 13912 3040-EXIT.
 13913     EXIT.
 13914
 13915 3050-DELETE-ACTQ.
 13916
 13917* EXEC CICS READNEXT
 13918*         DATASET  (ACTQ-FILE-ID)
 13919*         RIDFLD   (ACTQ-KEY)
 13920*         INTO     (ACTIVITY-QUE)
 13921*    END-EXEC.
 13922     MOVE LENGTH OF
 13923      ACTIVITY-QUE
 13924       TO DFHEIV12
 13925     MOVE 0
 13926       TO DFHEIV11
 13927*    MOVE '&.IL                  )   #00011828' TO DFHEIV0
 13928     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13929     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13930     MOVE X'2020233030303131383238' TO DFHEIV0(25:11)
 13931     CALL 'kxdfhei1' USING DFHEIV0,
 13932           ACTQ-FILE-ID,
 13933           ACTIVITY-QUE,
 13934           DFHEIV12,
 13935           ACTQ-KEY,
 13936           DFHEIV99,
 13937           DFHEIV11,
 13938           DFHEIV99,
 13939           DFHEIV99
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13941
 13942
 13943     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13944         GO TO 3050-EXIT.
 13945
 13946
 13947* EXEC CICS ENDBR
 13948*         DATASET  (ACTQ-FILE-ID)
 13949*    END-EXEC.
 13950     MOVE 0
 13951       TO DFHEIV11
 13952*    MOVE '&2                    $   #00011837' TO DFHEIV0
 13953     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13954     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13955     MOVE X'2020233030303131383337' TO DFHEIV0(25:11)
 13956     CALL 'kxdfhei1' USING DFHEIV0,
 13957           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 260
* EL131.cbl
 13958           DFHEIV11,
 13959           DFHEIV99
 13960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13961
 13962
 13963
 13964* EXEC CICS DELETE
 13965*         DATASET   (ACTQ-FILE-ID)
 13966*         RIDFLD    (ACTQ-KEY)
 13967*    END-EXEC.
 13968*    MOVE '&(  R                 &   #00011841' TO DFHEIV0
 13969     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13971     MOVE X'2020233030303131383431' TO DFHEIV0(25:11)
 13972     CALL 'kxdfhei1' USING DFHEIV0,
 13973           ACTQ-FILE-ID,
 13974           ACTQ-KEY,
 13975           DFHEIV99,
 13976           DFHEIV99,
 13977           DFHEIV99
 13978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13979
 13980
 13981
 13982* EXEC CICS STARTBR
 13983*         DATASET   (ACTQ-FILE-ID)
 13984*         RIDFLD    (ACTQ-KEY)
 13985*    END-EXEC.
 13986     MOVE 0
 13987       TO DFHEIV11
 13988*    MOVE '&,         G          &   #00011846' TO DFHEIV0
 13989     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13990     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13991     MOVE X'2020233030303131383436' TO DFHEIV0(25:11)
 13992     CALL 'kxdfhei1' USING DFHEIV0,
 13993           ACTQ-FILE-ID,
 13994           ACTQ-KEY,
 13995           DFHEIV99,
 13996           DFHEIV11,
 13997           DFHEIV99
 13998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13999
 14000
 14001     GO TO 3050-DELETE-ACTQ.
 14002
 14003 3050-EXIT.
 14004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 261
* EL131.cbl
 14006 3060-READ-TRLR.
 14007
 14008* EXEC CICS HANDLE CONDITION
 14009*         NOTFND    (3060-EXIT)
 14010*         ENDFILE   (3060-EXIT)
 14011*    END-EXEC.
 14012*    MOVE '"$I''                  ! A #00011857' TO DFHEIV0
 14013     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14015     MOVE X'4120233030303131383537' TO DFHEIV0(25:11)
 14016     CALL 'kxdfhei1' USING DFHEIV0
 14017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14018
 14019
 14020 3060-LOOP.
 14021
 14022* EXEC CICS READNEXT
 14023*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14024*         DATASET  (TRLR-FILE-ID)
 14025*         RIDFLD   (TRLR-KEY)
 14026*    END-EXEC.
 14027     MOVE 0
 14028       TO DFHEIV11
 14029*    MOVE '&.S                   )   #00011863' TO DFHEIV0
 14030     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14031     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14032     MOVE X'2020233030303131383633' TO DFHEIV0(25:11)
 14033     CALL 'kxdfhei1' USING DFHEIV0,
 14034           TRLR-FILE-ID,
 14035           DFHEIV20,
 14036           DFHEIV99,
 14037           TRLR-KEY,
 14038           DFHEIV99,
 14039           DFHEIV11,
 14040           DFHEIV99,
 14041           DFHEIV99
 14042     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14043         DFHEIV20
 14044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14045
 14046
 14047     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14048         GO TO 3060-EXIT.
 14049
 14050     IF FORM-CONTROL-TR
 14051         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14052             NEXT SENTENCE
 14053         ELSE
 14054             MOVE 'X'            TO ERROR-SWITCH
 14055             GO TO 3060-EXIT
 14056     ELSE
 14057         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14058            MOVE 'X'                 TO ERROR-SWITCH
 14059            GO TO 3060-EXIT.
 14060
 14061     GO TO 3060-LOOP.
 14062
 14063 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 262
* EL131.cbl
 14064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 263
* EL131.cbl
 14066 3997-GET-ERPDEF.
 14067
 14068     move cl-company-cd          to cert-company-code
 14069     move cl-cert-key-data       to cert-key (2:21)
 14070     move cl-cert-no             to cert-cert
 14071
 14072
 14073* EXEC CICS READ
 14074*        DATASET   (CERT-FILE-ID)
 14075*        RIDFLD    (CERT-KEY)
 14076*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14077*        resp      (ws-response)
 14078*    END-EXEC
 14079*    MOVE '&"S        E          (  N#00011894' TO DFHEIV0
 14080     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14082     MOVE X'204E233030303131383934' TO DFHEIV0(25:11)
 14083     CALL 'kxdfhei1' USING DFHEIV0,
 14084           CERT-FILE-ID,
 14085           DFHEIV20,
 14086           DFHEIV99,
 14087           CERT-KEY,
 14088           DFHEIV99,
 14089           DFHEIV99,
 14090           DFHEIV99
 14091     SET ADDRESS OF CERTIFICATE-MASTER TO
 14092         DFHEIV20
 14093     MOVE EIBRESP  TO ws-response
 14094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14095
 14096     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14097                                    WS-ERPDEF-SW
 14098     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14099                                    WS-CRIT-PER-RTW-MOS
 14100
 14101     if cm-clp-state = spaces or low-values or zeros
 14102        move cm-state            to cm-clp-state
 14103     end-if
 14104     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14105     MOVE CM-clp-state           TO ERPDEF-STATE
 14106     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14107     evaluate true
 14108        when (cl-claim-type = 'L' or 'P')
 14109           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14110             and 'CU')
 14111           move 'L'              to erpdef-ben-type
 14112           move cm-lf-benefit-cd to erpdef-ben-code
 14113        when (cl-claim-type not = 'L' and 'P')
 14114           and (cm-ah-benefit-cd not = '00' and '  ')
 14115           move 'A'              to erpdef-ben-type
 14116           move cm-ah-benefit-cd to erpdef-ben-code
 14117        when (cl-claim-type not = 'L' and 'P')
 14118           and (cm-ah-benefit-cd = '00' or '  ')
 14119           move 'L'              to erpdef-ben-type
 14120           move cm-lf-benefit-cd to erpdef-ben-code
 14121        when (cl-claim-type = 'L' or 'P')
 14122           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14123           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 264
* EL131.cbl
 14124           move cm-ah-benefit-cd to erpdef-ben-code
 14125        when other
 14126           move 'A'              to erpdef-ben-type
 14127           move cm-ah-benefit-cd to erpdef-ben-code
 14128     end-evaluate
 14129
 14130*    if (cl-claim-type = 'L' or 'P')
 14131*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14132*          and 'CU')
 14133*       move 'L'                 to erpdef-ben-type
 14134*       move cm-lf-benefit-cd    to erpdef-ben-code
 14135*    else
 14136*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14137*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14138*    end-if
 14139     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14140     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14141
 14142
 14143* EXEC CICS STARTBR
 14144*        DATASET  ('ERPDEF')
 14145*        RIDFLD   (ERPDEF-KEY)
 14146*        GTEQ
 14147*        RESP     (WS-RESPONSE)
 14148*    END-EXEC
 14149     MOVE 'ERPDEF' TO DFHEIV1
 14150     MOVE 0
 14151       TO DFHEIV11
 14152*    MOVE '&,         G          &  N#00011947' TO DFHEIV0
 14153     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14154     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14155     MOVE X'204E233030303131393437' TO DFHEIV0(25:11)
 14156     CALL 'kxdfhei1' USING DFHEIV0,
 14157           DFHEIV1,
 14158           ERPDEF-KEY,
 14159           DFHEIV99,
 14160           DFHEIV11,
 14161           DFHEIV99
 14162     MOVE EIBRESP  TO WS-RESPONSE
 14163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14164
 14165     IF WS-RESP-NORMAL
 14166
 14167* EXEC CICS READNEXT
 14168*          DATASET  ('ERPDEF')
 14169*          INTO     (PRODUCT-MASTER)
 14170*          RIDFLD   (ERPDEF-KEY)
 14171*          RESP     (WS-RESPONSE)
 14172*       END-EXEC
 14173     MOVE LENGTH OF
 14174      PRODUCT-MASTER
 14175       TO DFHEIV12
 14176     MOVE 'ERPDEF' TO DFHEIV1
 14177     MOVE 0
 14178       TO DFHEIV11
 14179*    MOVE '&.IL                  )  N#00011955' TO DFHEIV0
 14180     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 265
* EL131.cbl
 14182     MOVE X'204E233030303131393535' TO DFHEIV0(25:11)
 14183     CALL 'kxdfhei1' USING DFHEIV0,
 14184           DFHEIV1,
 14185           PRODUCT-MASTER,
 14186           DFHEIV12,
 14187           ERPDEF-KEY,
 14188           DFHEIV99,
 14189           DFHEIV11,
 14190           DFHEIV99,
 14191           DFHEIV99
 14192     MOVE EIBRESP  TO WS-RESPONSE
 14193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14194        IF WS-RESP-NORMAL
 14195           IF (ERPDEF-KEY-SAVE (1:16) =
 14196              PD-CONTROL-PRIMARY (1:16))
 14197              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14198              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14199                 (A1 > +8)
 14200                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14201              END-PERFORM
 14202              IF A1 < +9
 14203                 SET ERPDEF-FOUND TO TRUE
 14204                 MOVE PD-CRIT-PERIOD (A1)
 14205                              TO WS-CRITICAL-PERIOD
 14206                 MOVE PD-REC-CRIT-PERIOD (A1)
 14207                              TO WS-CRIT-PER-RECURRENT
 14208                 IF PD-RTW-MOS (A1) NUMERIC
 14209                    MOVE PD-RTW-MOS (A1)
 14210                              TO WS-CRIT-PER-RTW-MOS
 14211                 ELSE
 14212                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14213                 END-IF
 14214                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14215                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14216                                 TO WS-EXCL-PERIOD
 14217                 END-IF
 14218                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14219                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14220                                 TO WS-COV-ENDS
 14221                 END-IF
 14222                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14223                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14224                                 TO WS-ACC-PERIOD
 14225                 END-IF
 14226                 if pd-max-extension (a1) numeric
 14227                    move pd-max-extension (a1)
 14228                                 to ws-max-extension
 14229                 end-if
 14230                 if pd-max-amt (a1) numeric
 14231                    move pd-max-amt (a1)
 14232                                 to ws-max-moben
 14233                 end-if
 14234              END-IF
 14235           END-IF
 14236        END-IF
 14237     END-IF
 14238
 14239     .
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 266
* EL131.cbl
 14240 3997-EXIT.
 14241     EXIT.
 14242 4000-FORCE-ERRORS.
 14243     IF PI-RETURN-CD-1 = 'X'
 14244         MOVE ER-0311            TO EMI-ERROR
 14245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246         MOVE -1                 TO MAINTL
 14247         GO TO 8110-SEND-DATA.
 14248
 14249     IF NOT FORCE-CAP
 14250         MOVE ER-0416            TO EMI-ERROR
 14251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14252         MOVE -1                 TO MAINTL
 14253         GO TO 8110-SEND-DATA.
 14254
 14255     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14256     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14257     IF EMI-FATAL-CTR GREATER THAN ZERO
 14258         GO TO 4000-FATAL-ERRORS.
 14259
 14260     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14261
 14262     IF EMI-FATAL-CTR GREATER THAN ZERO
 14263         GO TO 4000-FATAL-ERRORS.
 14264
 14265     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14266
 14267     IF EMI-FATAL-CTR GREATER THAN ZERO
 14268         GO TO 4000-FATAL-ERRORS.
 14269
 14270     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14271     MOVE AL-UANOF               TO CERTA.
 14272     MOVE ER-0000 TO EMI-ERROR.
 14273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14274
 14275 4000-FATAL-ERRORS.
 14276     MOVE -1                     TO MAINTL.
 14277     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 267
* EL131.cbl
 14279
 14280 4100-SAVE-CHANGES.
 14281     IF MAINTL > 0
 14282         MOVE MAINTI  TO WS-SAVE-MAINTI
 14283         MOVE MAINTL  TO WS-SAVE-MAINTL
 14284     END-IF
 14285     IF STATUSL > 0
 14286         MOVE STATUSI  TO WS-SAVE-STATUSI
 14287         MOVE STATUSL  TO WS-SAVE-STATUSL
 14288     END-IF
 14289     IF REPL > 0
 14290         MOVE REPI  TO WS-SAVE-REPI
 14291         MOVE REPL  TO WS-SAVE-REPL
 14292     END-IF
 14293*    IF CAUSEL > 0
 14294*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14295*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14296*    END-IF
 14297*    IF ENDL > 0
 14298*        MOVE ENDI  TO WS-SAVE-ENDI
 14299*        MOVE ENDL  TO WS-SAVE-ENDL
 14300*    END-IF
 14301     IF DIAGL > 0
 14302         MOVE DIAGI  TO WS-SAVE-DIAGI
 14303         MOVE DIAGL  TO WS-SAVE-DIAGL
 14304     END-IF
 14305     IF ICD1L > 0
 14306         MOVE ICD1I  TO WS-SAVE-ICD1I
 14307         MOVE ICD1L  TO WS-SAVE-ICD1L
 14308     END-IF
 14309     IF ICD2L > 0
 14310         MOVE ICD2I  TO WS-SAVE-ICD2I
 14311         MOVE ICD2L  TO WS-SAVE-ICD2L
 14312     END-IF
 14313     IF BENEL > 0
 14314         MOVE BENEI  TO WS-SAVE-BENEI
 14315         MOVE BENEL  TO WS-SAVE-BENEL
 14316     END-IF
 14317     IF BIRTHL > 0
 14318         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14319         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14320     END-IF
 14321     IF SOCIALL > 0
 14322         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14323         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14324     END-IF
 14325     IF SEXL > 0
 14326         MOVE SEXI  TO WS-SAVE-SEXI
 14327         MOVE SEXL  TO WS-SAVE-SEXL
 14328     END-IF
 14329     IF MLNAMEL > 0
 14330         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14331         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14332     END-IF
 14333     IF MFNAMEL > 0
 14334         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14335         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14336     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 268
* EL131.cbl
 14337     IF MMINITL > 0
 14338         MOVE MMINITI  TO WS-SAVE-MMINITI
 14339         MOVE MMINITL  TO WS-SAVE-MMINITL
 14340     END-IF
 14341     IF LOANNOL > 0
 14342         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14343         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14344     END-IF
 14345     IF LOANBALL > 0
 14346         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14347         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14348     END-IF
 14349     IF PROCL > 0
 14350         MOVE PROCI  TO WS-SAVE-PROCI
 14351         MOVE PROCL  TO WS-SAVE-PROCL
 14352     END-IF
 14353     IF SUPVL > 0
 14354         MOVE SUPVI  TO WS-SAVE-SUPVI
 14355         MOVE SUPVL  TO WS-SAVE-SUPVL
 14356     END-IF
 14357     IF PRICDL > 0
 14358         MOVE PRICDI  TO WS-SAVE-PRICDI
 14359         MOVE PRICDL  TO WS-SAVE-PRICDL
 14360     END-IF
 14361     IF FILETOL > 0
 14362         MOVE FILETOI  TO WS-SAVE-FILETOI
 14363         MOVE FILETOL  TO WS-SAVE-FILETOL
 14364     END-IF
 14365     IF PDTHRUL > 0
 14366         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14367         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14368     END-IF
 14369     IF PDAMTL > 0
 14370         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14371         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14372     END-IF
 14373     IF NODAYSL > 0
 14374         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14375         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14376     END-IF
 14377     IF NOPMTSL > 0
 14378         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14379         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14380     END-IF
 14381     IF FORMTYPL > 0
 14382         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14383         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14384     END-IF
 14385     IF OCCL > 0
 14386         MOVE OCCI  TO WS-SAVE-OCCI
 14387         MOVE OCCL  TO WS-SAVE-OCCL
 14388     END-IF.
 14389 4100-EXIT.
 14390      EXIT.
 14391
 14392 4200-LOAD-CHANGES.
 14393     IF WS-SAVE-MAINTL > 0
 14394         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 269
* EL131.cbl
 14395         MOVE WS-SAVE-MAINTL  TO MAINTL
 14396         MOVE AL-UANON        TO MAINTA
 14397     END-IF
 14398     IF WS-SAVE-STATUSL > 0
 14399         MOVE WS-SAVE-STATUSI  TO STATUSI
 14400         MOVE WS-SAVE-STATUSL  TO STATUSL
 14401         MOVE AL-UANON         TO STATUSA
 14402     END-IF
 14403     IF WS-SAVE-REPL > 0
 14404         MOVE WS-SAVE-REPI  TO REPI
 14405         MOVE WS-SAVE-REPL  TO REPL
 14406         MOVE AL-UANON      TO REPA
 14407     END-IF
 14408*    IF WS-SAVE-CAUSEL > 0
 14409*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14410*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14411*        MOVE AL-UANON        TO CAUSEA
 14412*    END-IF
 14413*    IF WS-SAVE-ENDL > 0
 14414*        MOVE WS-SAVE-ENDI  TO ENDI
 14415*        MOVE WS-SAVE-ENDL  TO ENDL
 14416*        MOVE AL-UANON      TO ENDA
 14417*    END-IF
 14418     IF WS-SAVE-DIAGL > 0
 14419         MOVE WS-SAVE-DIAGI  TO DIAGI
 14420         MOVE WS-SAVE-DIAGL  TO DIAGL
 14421         MOVE AL-UANON       TO DIAGA
 14422     END-IF
 14423     IF WS-SAVE-ICD1L > 0
 14424         MOVE WS-SAVE-ICD1I  TO ICD1I
 14425         MOVE WS-SAVE-ICD1L  TO ICD1L
 14426         MOVE AL-UANON       TO ICD1A
 14427     END-IF
 14428     IF WS-SAVE-ICD2L > 0
 14429         MOVE WS-SAVE-ICD2I  TO ICD2I
 14430         MOVE WS-SAVE-ICD2L  TO ICD2L
 14431         MOVE AL-UANON       TO ICD2A
 14432     END-IF
 14433     IF WS-SAVE-BENEL > 0
 14434         MOVE WS-SAVE-BENEI  TO BENEI
 14435         MOVE WS-SAVE-BENEL  TO BENEL
 14436         MOVE AL-UANON       TO BENEA
 14437     END-IF
 14438     IF WS-SAVE-BIRTHL > 0
 14439         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14440         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14441         MOVE AL-UANON        TO BIRTHA
 14442     END-IF
 14443     IF WS-SAVE-SOCIALL > 0
 14444         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14445         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14446         MOVE AL-UANON         TO SOCIALA
 14447     END-IF
 14448     IF WS-SAVE-SEXL > 0
 14449         MOVE WS-SAVE-SEXI  TO SEXI
 14450         MOVE WS-SAVE-SEXL  TO SEXL
 14451         MOVE AL-UANON      TO SEXA
 14452     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 270
* EL131.cbl
 14453     IF WS-SAVE-MLNAMEL > 0
 14454         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14455         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14456         MOVE AL-UANON         TO MLNAMEA
 14457     END-IF
 14458     IF WS-SAVE-MFNAMEL > 0
 14459         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14460         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14461         MOVE AL-UANON         TO MFNAMEA
 14462     END-IF
 14463     IF WS-SAVE-MMINITL > 0
 14464         MOVE WS-SAVE-MMINITI  TO MMINITI
 14465         MOVE WS-SAVE-MMINITL  TO MMINITL
 14466         MOVE AL-UANON         TO MMINITA
 14467     END-IF
 14468     IF WS-SAVE-LOANNOL > 0
 14469         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14470         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14471         MOVE AL-UANON         TO LOANNOA
 14472     END-IF
 14473     IF WS-SAVE-LOANBALL > 0
 14474         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14475         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14476         MOVE AL-UANON          TO LOANBALA
 14477     END-IF
 14478     IF WS-SAVE-PROCL > 0
 14479         MOVE WS-SAVE-PROCI  TO PROCI
 14480         MOVE WS-SAVE-PROCL  TO PROCL
 14481         MOVE AL-UANON       TO PROCA
 14482     END-IF
 14483     IF WS-SAVE-SUPVL > 0
 14484         MOVE WS-SAVE-SUPVI  TO SUPVI
 14485         MOVE WS-SAVE-SUPVL  TO SUPVL
 14486         MOVE AL-UANON       TO SUPVA
 14487     END-IF
 14488     IF WS-SAVE-PRICDL > 0
 14489         MOVE WS-SAVE-PRICDI  TO PRICDI
 14490         MOVE WS-SAVE-PRICDL  TO PRICDL
 14491         MOVE AL-UANON        TO PRICDA
 14492     END-IF
 14493     IF WS-SAVE-FILETOL > 0
 14494         MOVE WS-SAVE-FILETOI  TO FILETOI
 14495         MOVE WS-SAVE-FILETOL  TO FILETOL
 14496         MOVE AL-UANON         TO FILETOA
 14497     END-IF
 14498     IF WS-SAVE-PDTHRUL > 0
 14499         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14500         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14501         MOVE AL-UANON         TO PDTHRUA
 14502     END-IF
 14503     IF WS-SAVE-PDAMTL > 0
 14504         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14505         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14506         MOVE AL-UANON        TO PDAMTA
 14507     END-IF
 14508     IF WS-SAVE-NODAYSL > 0
 14509         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14510         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 271
* EL131.cbl
 14511         MOVE AL-UANON         TO NODAYSA
 14512     END-IF
 14513     IF WS-SAVE-NOPMTSL > 0
 14514         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14515         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14516         MOVE AL-UANON         TO NOPMTSA
 14517     END-IF
 14518     IF WS-SAVE-FORMTYPL > 0
 14519         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14520         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14521         MOVE AL-UANON          TO FORMTYPA
 14522     END-IF
 14523     IF WS-SAVE-OCCL > 0
 14524         MOVE WS-SAVE-OCCI  TO OCCI
 14525         MOVE WS-SAVE-OCCL  TO OCCL
 14526         MOVE AL-UANON      TO OCCA
 14527     END-IF.
 14528 4200-EXIT.
 14529      EXIT.
 14530
 14531 5000-BUILD-MAP.
 14532     IF PI-RETURN-CD-1 = SPACE
 14533         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14534
 14535     MOVE SPACE                  TO PI-RETURN-CD-1.
 14536
 14537     MOVE LOW-VALUES             TO EL131AI.
 14538
 14539     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14540     MOVE PI-CARRIER             TO CARRIER-CODE.
 14541     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14542     MOVE PI-CERT-NO             TO CERT-NO.
 14543
 14544 5000-READ-CLAIM-MASTER.
 14545
 14546
 14547* EXEC CICS READ
 14548*         SET      (ADDRESS OF CLAIM-MASTER)
 14549*         DATASET  (CLMS-FILE-ID)
 14550*         RIDFLD   (MSTR-KEY)
 14551*    END-EXEC.
 14552*    MOVE '&"S        E          (   #00012313' TO DFHEIV0
 14553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14555     MOVE X'2020233030303132333133' TO DFHEIV0(25:11)
 14556     CALL 'kxdfhei1' USING DFHEIV0,
 14557           CLMS-FILE-ID,
 14558           DFHEIV20,
 14559           DFHEIV99,
 14560           MSTR-KEY,
 14561           DFHEIV99,
 14562           DFHEIV99,
 14563           DFHEIV99
 14564     SET ADDRESS OF CLAIM-MASTER TO
 14565         DFHEIV20
 14566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14567
 14568
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 272
* EL131.cbl
 14569     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14570
 14571 5000-READ-DIAGNOSIS-TRAILER.
 14572
 14573
 14574* EXEC CICS HANDLE CONDITION
 14575*         NOTFND (5000-TRLR-NOT-FOUND)
 14576*    END-EXEC.
 14577*    MOVE '"$I                   ! B #00012323' TO DFHEIV0
 14578     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14580     MOVE X'4220233030303132333233' TO DFHEIV0(25:11)
 14581     CALL 'kxdfhei1' USING DFHEIV0
 14582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14583
 14584
 14585     MOVE MSTR-KEY               TO TRLR-KEY.
 14586     MOVE NINETY                 TO TRLR-SEQ-NO.
 14587
 14588
 14589* EXEC CICS READ
 14590*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14591*         DATASET  (TRLR-FILE-ID)
 14592*         RIDFLD   (TRLR-KEY)
 14593*    END-EXEC.
 14594*    MOVE '&"S        E          (   #00012330' TO DFHEIV0
 14595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14597     MOVE X'2020233030303132333330' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           TRLR-FILE-ID,
 14600           DFHEIV20,
 14601           DFHEIV99,
 14602           TRLR-KEY,
 14603           DFHEIV99,
 14604           DFHEIV99,
 14605           DFHEIV99
 14606     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14607         DFHEIV20
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611     MOVE AT-INFO-LINE-1         TO DIAGO.
 14612     MOVE AT-ICD-CODE-1          TO ICD1O.
 14613     MOVE AT-ICD-CODE-2          TO ICD2O.
 14614
 14615 5000-READ-CERTIFICATE-MASTER.
 14616
 14617     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14618     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14619     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14620     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14621     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14622     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14623     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14624
 14625
 14626* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 273
* EL131.cbl
 14627*         NOTFND (5000-CERT-NOT-FOUND)
 14628*    END-EXEC.
 14629*    MOVE '"$I                   ! C #00012350' TO DFHEIV0
 14630     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14632     MOVE X'4320233030303132333530' TO DFHEIV0(25:11)
 14633     CALL 'kxdfhei1' USING DFHEIV0
 14634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14635
 14636
 14637
 14638* EXEC CICS READ
 14639*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14640*         DATASET  (CERT-FILE-ID)
 14641*         RIDFLD   (CERT-KEY)
 14642*    END-EXEC.
 14643*    MOVE '&"S        E          (   #00012354' TO DFHEIV0
 14644     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14646     MOVE X'2020233030303132333534' TO DFHEIV0(25:11)
 14647     CALL 'kxdfhei1' USING DFHEIV0,
 14648           CERT-FILE-ID,
 14649           DFHEIV20,
 14650           DFHEIV99,
 14651           CERT-KEY,
 14652           DFHEIV99,
 14653           DFHEIV99,
 14654           DFHEIV99
 14655     SET ADDRESS OF CERTIFICATE-MASTER TO
 14656         DFHEIV20
 14657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14658
 14659
 14660     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14661     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14662
 14663     GO TO 5000-EXIT.
 14664
 14665 5000-TRLR-NOT-FOUND.
 14666     MOVE ER-7687                TO EMI-ERROR.
 14667     MOVE -1                     TO DIAGL.
 14668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14669     GO TO 5000-EXIT.
 14670
 14671 5000-CERT-NOT-FOUND.
 14672     MOVE ER-0206                TO EMI-ERROR.
 14673     MOVE -1                     TO CERTL.
 14674     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14675
 14676 5000-EXIT.
 14677     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 274
* EL131.cbl
 14679 5010-RESET-PI-AREA.
 14680     IF CERTI GREATER THAN LOW-VALUES
 14681         MOVE CERTI              TO PI-CERT-PRIME.
 14682
 14683     IF SUFXI GREATER THAN LOW-VALUES
 14684         MOVE SUFXI              TO PI-CERT-SFX.
 14685
 14686     IF CERTEFFI GREATER THAN LOW-VALUES
 14687         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14688
 14689     IF CERTACTI GREATER THAN LOW-VALUES
 14690         MOVE CERTACTI           TO PI-ACCOUNT.
 14691
 14692     IF CERTSTI GREATER THAN LOW-VALUES
 14693         MOVE CERTSTI            TO PI-STATE.
 14694
 14695     IF CERTCARI GREATER THAN LOW-VALUES
 14696         MOVE CERTCARI           TO PI-CARRIER.
 14697
 14698     IF CERTGRPI GREATER THAN LOW-VALUES
 14699         MOVE CERTGRPI           TO PI-GROUPING.
 14700
 14701 5010-EXIT.
 14702     EXIT.
 14703
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 275
* EL131.cbl
 14705 5020-MOVE-MSTR.
 14706
 14707     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14708     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14709     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14710     MOVE AL-SABON               TO SEQUA.
 14711     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14712     MOVE CL-CLAIM-TYPE          TO TYPEO
 14713                                    pi-claim-type
 14714
 14715     IF CL-TOTAL-PAID-AMT  = +0 AND
 14716        CL-LAST-PMT-AMT    = +0 AND
 14717        CL-NO-OF-PMTS-MADE = +0
 14718          MOVE AL-UANON          TO TYPEA.
 14719
 14720     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14721     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14722     MOVE CL-CERT-PRIME          TO CERTO.
 14723     MOVE CL-CERT-SFX            TO SUFXO.
 14724     MOVE CL-CERT-CARRIER        TO CARRO.
 14725
 14726     IF CL-CLAIM-STATUS = 'C'
 14727         MOVE 'CLOSED'           TO STATUSO
 14728     ELSE
 14729         MOVE 'OPEN  '           TO STATUSO.
 14730
 14731     move cl-accident-claim-sw   to accswo
 14732     if cl-benefit-period not numeric
 14733        move zeros               to cl-benefit-period
 14734     end-if
 14735     move cl-benefit-period      to benpero
 14736     move cl-insured-type        to instypeo
 14737     MOVE CL-PROCESSOR-ID        TO PROCO.
 14738
 14739     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14740     MOVE CL-CCN                 TO CCNOO.
 14741
 14742     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14743     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14744     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14745     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14746
 14747     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14748         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14749         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14750         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14751         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14752     ELSE
 14753         MOVE SPACES             TO BIRTHO.
 14754
 14755     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14756        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14757         NEXT SENTENCE
 14758       ELSE
 14759         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14760
 14761     IF PI-COMPANY-ID = 'DMD'
 14762       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 276
* EL131.cbl
 14763          IF SOCIALO = SPACES OR LOW-VALUES
 14764            MOVE ER-0885         TO EMI-ERROR
 14765            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14766
 14767     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14768*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14769
 14770*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14771*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14772*        MOVE SPACES                 TO DC-OPTION-CODE
 14773*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14774*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14775*    ELSE
 14776*        MOVE SPACES             TO ENDO.
 14777
 14778     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14779        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14780        MOVE SPACES             TO DC-OPTION-CODE
 14781        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14782        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14783        IF PI-USES-PAID-TO
 14784           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14785           MOVE '6'                TO DC-OPTION-CODE
 14786           MOVE +1                 TO DC-ELAPSED-DAYS
 14787           MOVE +0                 TO DC-ELAPSED-MONTHS
 14788           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14789           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14790        ELSE
 14791           NEXT SENTENCE
 14792     ELSE
 14793        MOVE SPACES             TO PDTHRUO.
 14794
 14795     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14796     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14797     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14798     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14799
 14800     IF MODIFY-CAP
 14801        MOVE AL-UNNOF            TO PDAMTA
 14802                                    NODAYSA
 14803                                    NOPMTSA
 14804        MOVE AL-UANOF            TO PDTHRUA.
 14805     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14806     MOVE '2'                    TO CNTL-REC-TYPE
 14807     MOVE +0                     TO CNTL-SEQ-NO
 14808     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14809
 14810
 14811* EXEC CICS READ
 14812*         DATASET  (CNTL-FILE-ID)
 14813*         SET      (ADDRESS OF CONTROL-FILE)
 14814*         RIDFLD   (CNTL-KEY)
 14815*         RESP     (WS-RESPONSE)
 14816*    END-EXEC
 14817*    MOVE '&"S        E          (  N#00012510' TO DFHEIV0
 14818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14820     MOVE X'204E233030303132353130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 277
* EL131.cbl
 14821     CALL 'kxdfhei1' USING DFHEIV0,
 14822           CNTL-FILE-ID,
 14823           DFHEIV20,
 14824           DFHEIV99,
 14825           CNTL-KEY,
 14826           DFHEIV99,
 14827           DFHEIV99,
 14828           DFHEIV99
 14829     SET ADDRESS OF CONTROL-FILE TO
 14830         DFHEIV20
 14831     MOVE EIBRESP  TO WS-RESPONSE
 14832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14833
 14834     IF WS-RESP-NORMAL
 14835        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14836     end-if
 14837     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14838         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14839         MOVE SPACES             TO DC-OPTION-CODE
 14840         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14841         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14842     ELSE
 14843         MOVE SPACES             TO INCO.
 14844
 14845     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14846        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14847        MOVE AL-UANOF            TO INCA
 14848     end-if
 14849     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14850
 14851     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14852         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14853         MOVE SPACES             TO DC-OPTION-CODE
 14854         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14855         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14856     ELSE
 14857         MOVE SPACES             TO REPO.
 14858
 14859     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14860         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14861         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14862         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14863         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14864     ELSE
 14865         MOVE SPACES             TO ESTO.
 14866
 14867     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14868         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14869         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14870         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14871         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14872     ELSE
 14873         MOVE SPACES             TO MNTDTO.
 14874
 14875
 14876     IF CL-LAST-MAINT-TYPE = SPACE
 14877         MOVE 'SET-UP'           TO MNTTYPEO
 14878     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 278
* EL131.cbl
 14879     IF CL-LAST-MAINT-TYPE = '1'
 14880         MOVE 'PAYMNT'           TO MNTTYPEO
 14881     ELSE
 14882     IF CL-LAST-MAINT-TYPE = '2'
 14883         MOVE 'LETTER'           TO MNTTYPEO
 14884     ELSE
 14885     IF CL-LAST-MAINT-TYPE = '3'
 14886         MOVE 'UPDATE'           TO MNTTYPEO
 14887     ELSE
 14888     IF CL-LAST-MAINT-TYPE = '4'
 14889         MOVE 'RESTOR'           TO MNTTYPEO
 14890     ELSE
 14891     IF CL-LAST-MAINT-TYPE = '5'
 14892         MOVE 'INC DT'           TO MNTTYPEO
 14893     ELSE
 14894     IF CL-LAST-MAINT-TYPE = '6'
 14895         MOVE ' CONV'            TO MNTTYPEO
 14896     ELSE
 14897     IF CL-LAST-MAINT-TYPE = 'C'
 14898         MOVE 'CHGBEN'           TO MNTTYPEO
 14899     ELSE
 14900     IF CL-LAST-MAINT-TYPE = 'E'
 14901         MOVE 'ERRCOR'           TO MNTTYPEO
 14902     ELSE
 14903         MOVE SPACES             TO MNTTYPEO.
 14904
 14905     MOVE CL-BENEFICIARY         TO BENEO.
 14906     MOVE CL-FILE-LOCATION       TO FILETOO.
 14907     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14908        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14909     END-IF
 14910     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14911*    MOVE CL-CRIT-PER-RECURRENT
 14912*                                TO CRITPTO
 14913*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14914*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14915*    END-IF
 14916*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14917     MOVE CL-PRIORITY-CD         TO PRICDO.
 14918     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14919     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14920     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14921     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14922
 14923 5020-EXIT.
 14924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 279
* EL131.cbl
 14926 5030-MOVE-CERT.
 14927
 14928     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14929         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14930         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14931         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14932         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14933       ELSE
 14934         MOVE SPACES             TO CERTEFFO
 14935         MOVE ZERO               TO HOLD-DATE.
 14936
 14937     MOVE CM-ACCOUNT             TO CERTACTO.
 14938     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14939     MOVE CM-GROUPING            TO CERTGRPO.
 14940     MOVE CM-CARRIER             TO CERTCARO.
 14941     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14942     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14943     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14944     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14945     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14946     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14947     MOVE CM-JT-INITIAL          TO JNTINITO.
 14948     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14949
 14950*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14951     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14952     MOVE '3'                    TO CNTL-REC-TYPE.
 14953     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14954     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14955     MOVE ZERO                   TO CNTL-SEQ-NO.
 14956
 14957
 14958* EXEC CICS READ
 14959*         SET        (ADDRESS OF CONTROL-FILE)
 14960*         DATASET    ('ELCNTL')
 14961*         RIDFLD     (CNTL-KEY)
 14962*         RESP       (WS-RESPONSE)
 14963*    END-EXEC.
 14964     MOVE 'ELCNTL' TO DFHEIV1
 14965*    MOVE '&"S        E          (  N#00012640' TO DFHEIV0
 14966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14968     MOVE X'204E233030303132363430' TO DFHEIV0(25:11)
 14969     CALL 'kxdfhei1' USING DFHEIV0,
 14970           DFHEIV1,
 14971           DFHEIV20,
 14972           DFHEIV99,
 14973           CNTL-KEY,
 14974           DFHEIV99,
 14975           DFHEIV99,
 14976           DFHEIV99
 14977     SET ADDRESS OF CONTROL-FILE TO
 14978         DFHEIV20
 14979     MOVE EIBRESP  TO WS-RESPONSE
 14980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14981
 14982
 14983     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 280
* EL131.cbl
 14984        MOVE ZERO                TO CP-FREE-LOOK
 14985     ELSE
 14986        MOVE CF-ST-FREE-LOOK-PERIOD
 14987                                 TO CP-FREE-LOOK.
 14988
 14989     IF CM-LF-BENEFIT-CD = '00'
 14990        GO TO 5030-MOVE-CERT-AH.
 14991
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 281
* EL131.cbl
 14993     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14994     MOVE '5'                    TO DC-OPTION-CODE
 14995     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14996     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14997     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14998     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14999     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15000     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15001     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15002     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15003     MOVE '4'                    TO CP-REM-TERM-METHOD
 15004     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15005     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15006     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15007
 15008     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15009     IF CM-LF-PREMIUM-RATE NUMERIC
 15010         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15011     ELSE
 15012         MOVE ZEROS              TO LCVRATEO.
 15013
 15014     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15015         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15016
 15017     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15018
 15019     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15020
 15021     IF CM-LF-CURRENT-STATUS = '8'
 15022        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15023            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15024            MOVE ' '             TO DC-OPTION-CODE
 15025            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15026            IF NOT DATE-CONVERSION-ERROR
 15027                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15028
 15029     IF CM-LF-CURRENT-STATUS = '7'
 15030        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15031            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15032            MOVE ' '             TO DC-OPTION-CODE
 15033            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15034            IF NOT DATE-CONVERSION-ERROR
 15035                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15036
 15037     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15038         MOVE ' '                TO DC-OPTION-CODE
 15039         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15040         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15041         IF NOT DATE-CONVERSION-ERROR
 15042             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15043             MOVE HOLD-MONTH     TO WORK-MONTH
 15044             MOVE HOLD-YEAR      TO WORK-YEAR
 15045             MOVE WORK-DATE-MY   TO LCVEXITO.
 15046
 15047     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15048        IF CP-REMAINING-TERM-3 = ZEROS
 15049           MOVE 'EXPIRED'        TO LCVSTATO
 15050        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 282
* EL131.cbl
 15051           MOVE 'ACTIVE'         TO LCVSTATO.
 15052
 15053     IF CM-LF-CURRENT-STATUS = '2'
 15054        MOVE 'PEND   '           TO LCVSTATO.
 15055     IF CM-LF-CURRENT-STATUS = '3'
 15056        MOVE 'RESTORE'           TO LCVSTATO.
 15057     IF CM-LF-CURRENT-STATUS = '5'
 15058        MOVE 'REISSUE'           TO LCVSTATO.
 15059     IF CM-LF-CURRENT-STATUS = '6'
 15060        MOVE 'LMP DIS'           TO LCVSTATO.
 15061     IF CM-LF-CURRENT-STATUS = '7'
 15062        MOVE 'DEATH  '           TO LCVSTATO.
 15063     IF CM-LF-CURRENT-STATUS = '8'
 15064        MOVE 'CANCEL '           TO LCVSTATO.
 15065     IF CM-LF-CURRENT-STATUS = '9'
 15066        MOVE 'RE-ONLY'           TO LCVSTATO.
 15067     IF CM-LF-CURRENT-STATUS = 'V'
 15068        MOVE 'VOID   '           TO LCVSTATO.
 15069     IF CM-LF-CURRENT-STATUS = 'D'
 15070        MOVE 'DECLINE'           TO LCVSTATO.
 15071
 15072     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15073     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15074     MOVE '4'                    TO BEN-REC-TYPE.
 15075     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15076     MOVE ZERO                   TO BEN-SEQ-NO.
 15077
 15078
 15079* EXEC CICS READ GTEQ
 15080*         DATASET  (CNTL-FILE-ID)
 15081*         RIDFLD   (BENEFIT-KEY)
 15082*         SET      (ADDRESS OF CONTROL-FILE)
 15083*    END-EXEC.
 15084*    MOVE '&"S        G          (   #00012742' TO DFHEIV0
 15085     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15087     MOVE X'2020233030303132373432' TO DFHEIV0(25:11)
 15088     CALL 'kxdfhei1' USING DFHEIV0,
 15089           CNTL-FILE-ID,
 15090           DFHEIV20,
 15091           DFHEIV99,
 15092           BENEFIT-KEY,
 15093           DFHEIV99,
 15094           DFHEIV99,
 15095           DFHEIV99
 15096     SET ADDRESS OF CONTROL-FILE TO
 15097         DFHEIV20
 15098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15099
 15100
 15101     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15102        CF-RECORD-TYPE NOT = '4'
 15103         MOVE ER-0240            TO EMI-ERROR
 15104         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15105         GO TO 5030-MOVE-CERT-FINISH.
 15106
 15107     MOVE ZERO                   TO COUNT-2.
 15108     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 283
* EL131.cbl
 15109
 15110     IF SCREEN-ERROR
 15111         MOVE ER-0282            TO EMI-ERROR
 15112         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15113        ELSE
 15114         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15115
 15116 5030-MOVE-CERT-AH.
 15117
 15118     IF CM-LF-BENEFIT-CD = '00'
 15119         IF CM-AH-BENEFIT-CD = '00'
 15120             GO TO 5030-MOVE-CERT-FINISH.
 15121
 15122     IF CM-AH-BENEFIT-CD = '00'
 15123        MOVE SPACES             TO ACVKINDO
 15124        COMPUTE PI-PAYMENT-AMT =
 15125                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15126        GO TO 5030-MOVE-CERT-FINISH.
 15127
 15128     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15129     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15130     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15131     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15132     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15133     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15134     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15135     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15136
 15137**DMD **********************************************
 15138     IF PI-COMPANY-ID = 'DMD'
 15139         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15140                                   CM-PMT-EXTENSION-DAYS
 15141         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15142                                      CL-NO-OF-DAYS-PAID
 15143         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15144             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15145         MOVE WS-REM-MOS         TO ACVRTRMO
 15146                                    CP-REMAINING-TERM-3
 15147*        MOVE WS-REM-DAYS        TO DAYSPO
 15148         GO TO 5030-SKIP-RTRM.
 15149**DMD **********************************************
 15150
 15151     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15152     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15153     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15154     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15155
 15156 5030-SKIP-RTRM.
 15157     IF CM-AH-PREMIUM-RATE NUMERIC
 15158         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15159     ELSE
 15160         MOVE ZEROS              TO ACVRATEO.
 15161
 15162     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15163     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15164
 15165     IF CM-AH-CURRENT-STATUS = '8'
 15166        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 284
* EL131.cbl
 15167            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15168            MOVE ' '             TO DC-OPTION-CODE
 15169            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15170            IF NOT DATE-CONVERSION-ERROR
 15171                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15172
 15173     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15174        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15175            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15176            MOVE ' '             TO DC-OPTION-CODE
 15177            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15178            IF NOT DATE-CONVERSION-ERROR
 15179                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15180
 15181     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15182        IF CP-REMAINING-TERM-3 = ZEROS
 15183           MOVE 'EXPIRED'        TO ACVSTATO
 15184        ELSE
 15185           MOVE 'ACTIVE'         TO ACVSTATO.
 15186
 15187     IF CM-AH-CURRENT-STATUS = '2'
 15188        MOVE 'PEND   '           TO ACVSTATO.
 15189     IF CM-AH-CURRENT-STATUS = '3'
 15190        MOVE 'RESTORE'           TO ACVSTATO.
 15191     IF CM-AH-CURRENT-STATUS = '5'
 15192        MOVE 'REISSUE'           TO ACVSTATO.
 15193     IF CM-AH-CURRENT-STATUS = '6'
 15194        MOVE 'LMP DIS'           TO ACVSTATO.
 15195     IF CM-AH-CURRENT-STATUS = '7'
 15196        MOVE 'DEATH  '           TO ACVSTATO.
 15197     IF CM-AH-CURRENT-STATUS = '8'
 15198        MOVE 'CANCEL '           TO ACVSTATO.
 15199     IF CM-AH-CURRENT-STATUS = '9'
 15200        MOVE 'RE-ONLY'           TO ACVSTATO.
 15201     IF CM-AH-CURRENT-STATUS = 'V'
 15202        MOVE 'VOID   '           TO ACVSTATO.
 15203     IF CM-AH-CURRENT-STATUS = '9'
 15204        MOVE 'DECLINE'           TO ACVSTATO.
 15205
 15206     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15207         MOVE ' '                TO DC-OPTION-CODE
 15208         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15209         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15210         IF NOT DATE-CONVERSION-ERROR
 15211             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15212             MOVE HOLD-MONTH     TO WORK-MONTH
 15213             MOVE HOLD-YEAR      TO WORK-YEAR
 15214             MOVE WORK-DATE-MY   TO ACVEXITO.
 15215
 15216     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15217
 15218     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15219     MOVE '5'                    TO BEN-REC-TYPE.
 15220     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15221     MOVE ZERO                   TO BEN-SEQ-NO.
 15222
 15223
 15224* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 285
* EL131.cbl
 15225*         DATASET  (CNTL-FILE-ID)
 15226*         RIDFLD   (BENEFIT-KEY)
 15227*         SET      (ADDRESS OF CONTROL-FILE)
 15228*    END-EXEC.
 15229*    MOVE '&"S        G          (   #00012870' TO DFHEIV0
 15230     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15232     MOVE X'2020233030303132383730' TO DFHEIV0(25:11)
 15233     CALL 'kxdfhei1' USING DFHEIV0,
 15234           CNTL-FILE-ID,
 15235           DFHEIV20,
 15236           DFHEIV99,
 15237           BENEFIT-KEY,
 15238           DFHEIV99,
 15239           DFHEIV99,
 15240           DFHEIV99
 15241     SET ADDRESS OF CONTROL-FILE TO
 15242         DFHEIV20
 15243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15244
 15245
 15246     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15247        CF-RECORD-TYPE NOT = '5'
 15248         MOVE ER-0250            TO EMI-ERROR
 15249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15250         GO TO 5030-MOVE-CERT-FINISH.
 15251
 15252     MOVE ZERO                   TO COUNT-2.
 15253     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15254
 15255     IF SCREEN-ERROR
 15256         MOVE ER-0283            TO EMI-ERROR
 15257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15258       ELSE
 15259         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15260
 15261 5030-MOVE-CERT-FINISH.
 15262
 15263     MOVE CM-LOAN-APR            TO APRO.
 15264     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15265     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15266     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15267     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15268     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15269     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15270
 15271     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15272         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15273         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15274         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15275         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15276     ELSE
 15277         MOVE SPACES               TO ADDONDTO.
 15278
 15279     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15280
 15281 5030-EXIT.
 15282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 286
* EL131.cbl
 15284 5040-FIND-BENEFIT.
 15285     ADD 1                       TO COUNT-2.
 15286     IF COUNT-2 GREATER THAN 8
 15287         GO TO 5050-BENEFIT-NOTFND.
 15288
 15289     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15290         GO TO 5060-EXIT.
 15291
 15292     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15293         GO TO 5050-BENEFIT-NOTFND.
 15294
 15295     GO TO 5040-FIND-BENEFIT.
 15296
 15297 5050-BENEFIT-NOTFND.
 15298     MOVE 'X'                    TO ERROR-SWITCH.
 15299
 15300 5060-EXIT.
 15301     EXIT.
 15302
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 287
* EL131.cbl
 15304 6000-CALCULATE-CERT-TERM.
 15305
 15306     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15307         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15308     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15309         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15310     IF CM-LOAN-APR NOT NUMERIC
 15311         MOVE ZEROS              TO CM-LOAN-APR.
 15312
 15313*    IF WS-CALC-METHOD  = 'G'
 15314         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15315*     ELSE
 15316*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15317
 15318     IF N GREATER 120
 15319         MOVE 120                TO N.
 15320
 15321     MOVE '6'                    TO DC-OPTION-CODE.
 15322     MOVE N                      TO DC-ELAPSED-MONTHS.
 15323     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15324     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15325
 15326     IF CM-LF-BENEFIT-CD NOT = ZERO
 15327         MOVE N                  TO CM-LF-ORIG-TERM
 15328         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15329         IF NO-CONVERSION-ERROR
 15330             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15331
 15332     IF CM-AH-BENEFIT-CD NOT = ZERO
 15333         MOVE N                  TO CM-AH-ORIG-TERM
 15334         IF NO-CONVERSION-ERROR
 15335             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15336
 15337 6000-EXIT.
 15338      EXIT.
 15339
 15340 6100-CALC-GROSS-TERM.
 15341     MOVE CM-LOAN-BALANCE         TO L.
 15342     MOVE PI-PAYMENT-AMT          TO M.
 15343
 15344     COMPUTE N = L / M.
 15345     IF N LESS 1
 15346         MOVE 1  TO N.
 15347
 15348     IF CM-LF-BENEFIT-CD NOT = ZERO
 15349         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15350     ELSE
 15351         MOVE ZEROS               TO WS-LF-RATE.
 15352
 15353     IF CM-AH-BENEFIT-CD NOT = ZERO
 15354         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15355     ELSE
 15356         MOVE ZEROS               TO WS-AH-RATE.
 15357
 15358     COMPUTE I = CM-LOAN-APR / +1200.
 15359
 15360 6105-LOOP.
 15361     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 288
* EL131.cbl
 15362         GO TO 6200-EXIT.
 15363     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15364     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15365         ADD 1 TO N
 15366         GO TO 6105-LOOP.
 15367
 15368 6200-EXIT.
 15369      EXIT.
 15370
 15371 6210-CALC-LEFT-RIGHTONE.
 15372      MOVE L         TO LEFT-TOT-1.
 15373      SUBTRACT 1 FROM N.
 15374      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15375      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15376      ADD 1 TO N.
 15377 6211-CALC-TERM1.
 15378      MOVE N         TO TERM1.
 15379      MULTIPLY M BY TERM1.
 15380 6212-LOOP.
 15381      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15382      ADD 1 TO A-N.
 15383      MULTIPLY A-N BY TERM1.
 15384      SUBTRACT 1 FROM A-N.
 15385      ADD TERM1 TO LEFT-TOT-1.
 15386 6213-CALC-TERM2.
 15387      MOVE M         TO TERM2.
 15388      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15389      MULTIPLY IA-N BY TERM2.
 15390      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15391 6215-CALC-RIGHTONE.
 15392      MOVE M         TO RIGHT-TOT-1.
 15393      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15394      MULTIPLY A-N BY RIGHT-TOT-1.
 15395 6220-EXIT.
 15396      EXIT.
 15397
 15398 6300-CALC-A-N.
 15399     IF N LESS 1
 15400         MOVE 0     TO A-N
 15401         GO TO 6300-EXIT.
 15402     IF I = 0
 15403         MOVE .00001 TO I.
 15404     ADD 1 TO I.
 15405     DIVIDE I INTO 1 GIVING V.
 15406     SUBTRACT 1 FROM I.
 15407     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15408     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15409     DIVIDE I INTO TERM3 GIVING A-N.
 15410 6300-EXIT.
 15411      EXIT.
 15412
 15413 6350-CALC-IA-N.
 15414     IF N LESS 1
 15415         MOVE 0      TO IA-N
 15416         GO TO 6400-EXIT.
 15417     ADD 1 TO N.
 15418     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15419     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 289
* EL131.cbl
 15420     MULTIPLY N BY V-EX-N GIVING TERM3.
 15421     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15422     SUBTRACT V FROM 1 GIVING TERM4.
 15423     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15424 6400-EXIT.
 15425      EXIT.
 15426
 15427 6450-CALC-V-EX-N.
 15428     IF N LESS 1
 15429         MOVE 1    TO V-EX-N
 15430         GO TO 6490-EXIT.
 15431     MOVE N        TO NV-STORE.
 15432     IF V-EX-ONETIME = 1  OR
 15433        V NOT = V-EXPONENT (1)
 15434          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15435 6460-LOOP.
 15436     IF N GREATER 248
 15437         MOVE 248 TO N.
 15438     IF N = 1
 15439         MOVE V               TO V-EX-N
 15440      ELSE
 15441         MOVE V-EXPONENT (N)  TO V-EX-N.
 15442     GO TO 6490-EXIT.
 15443
 15444 6470-BUILD-V-EX-TABLE.
 15445     MOVE 2      TO N.
 15446     MOVE V      TO V-EXPONENT (1)
 15447                    V-EX-N.
 15448 6471-LOOP.
 15449     MULTIPLY V BY V-EX-N.
 15450     MOVE V-EX-N   TO V-EXPONENT (N).
 15451     ADD 1 TO N.
 15452     IF N LESS 248
 15453         GO TO 6471-LOOP.
 15454     MOVE NV-STORE     TO N.
 15455     MOVE 0            TO V-EX-ONETIME.
 15456 6480-EXIT.
 15457      EXIT.
 15458
 15459 6490-EXIT.
 15460      EXIT.
 15461
 15462 6500-CALC-NET-TERM.
 15463     MOVE CM-LOAN-BALANCE         TO L.
 15464     MOVE PI-PAYMENT-AMT          TO M.
 15465
 15466     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15467     IF WS-REMAIN GREATER ZERO
 15468         ADD 1 TO N.
 15469     IF N = 0
 15470         MOVE 1 TO N.
 15471
 15472 6700-EXIT.
 15473      EXIT.
 15474
 15475 6999-CALC-TERM-EXIT.
 15476     EXIT.
 15477
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 290
* EL131.cbl
 15479 7000-RESET-ATTRIBUTE.
 15480
 15481     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15482                                    CERTSTA   CERTCARA
 15483                                    CERTGRPA.
 15484     MOVE -1                     TO CERTCARL.
 15485
 15486 7000-EXIT.
 15487     EXIT.
 15488
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 291
* EL131.cbl
 15490 7600-BROWSE-CLAIM.
 15491
 15492
 15493* EXEC CICS READ
 15494*        DATASET(CLMS-FILE-ID)
 15495*        SET    (ADDRESS OF CLAIM-MASTER)
 15496*        RIDFLD (MSTR-KEY)
 15497*        GENERIC
 15498*        EQUAL
 15499*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15500*    END-EXEC.
 15501*    MOVE '&"S  KG    E          (   #00013122' TO DFHEIV0
 15502     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15504     MOVE X'2020233030303133313232' TO DFHEIV0(25:11)
 15505     CALL 'kxdfhei1' USING DFHEIV0,
 15506           CLMS-FILE-ID,
 15507           DFHEIV20,
 15508           DFHEIV99,
 15509           MSTR-KEY,
 15510           ELMSTR-GENERIC-LENGTH,
 15511           DFHEIV99,
 15512           DFHEIV99
 15513     SET ADDRESS OF CLAIM-MASTER TO
 15514         DFHEIV20
 15515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15516
 15517
 15518     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15519
 15520     if cl-assoc-cert-total = 0
 15521        move 1 to cl-assoc-cert-total
 15522     end-if
 15523     IF CL-ASSOC-CERT-SEQU = 0
 15524        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15525     END-IF
 15526
 15527     IF CL-ASSOC-CERT-TOTAL = 1
 15528         MOVE AL-SADOF           TO BCERT1A
 15529                                    BSUFX1A
 15530                                    BCERT2A
 15531                                    BSUFX2A
 15532                                    BCERT3A
 15533                                    BSUFX3A
 15534                                    BCERT4A
 15535                                    BSUFX4A
 15536                                    BCERT5A
 15537                                    BSUFX5A
 15538                                    PCERTNOA
 15539                                    PSUFXA
 15540                                    LABEL1A
 15541                                    LABEL2A
 15542         GO TO 7699-EXIT.
 15543
 15544 7610-BROWSE-CLAIM-LOOP.
 15545
 15546     MOVE LOW-VALUES             TO BCERT1O
 15547                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 292
* EL131.cbl
 15548                                    BCERT2O
 15549                                    BSUFX2O
 15550                                    BCERT3O
 15551                                    BSUFX3O
 15552                                    BCERT4O
 15553                                    BSUFX4O
 15554                                    BCERT5O
 15555                                    BSUFX5O.
 15556
 15557
 15558* EXEC CICS HANDLE CONDITION
 15559*        ENDFILE  (7630-END-BROWSE)
 15560*    END-EXEC.
 15561*    MOVE '"$''                   ! D #00013170' TO DFHEIV0
 15562     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15564     MOVE X'4420233030303133313730' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0
 15566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15567
 15568
 15569
 15570* EXEC CICS STARTBR
 15571*        DATASET    (CLMS-FILE-ID)
 15572*        RIDFLD     (MSTR-KEY)
 15573*    END-EXEC.
 15574     MOVE 0
 15575       TO DFHEIV11
 15576*    MOVE '&,         G          &   #00013174' TO DFHEIV0
 15577     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15579     MOVE X'2020233030303133313734' TO DFHEIV0(25:11)
 15580     CALL 'kxdfhei1' USING DFHEIV0,
 15581           CLMS-FILE-ID,
 15582           MSTR-KEY,
 15583           DFHEIV99,
 15584           DFHEIV11,
 15585           DFHEIV99
 15586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15587
 15588
 15589     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15590
 15591 7620-READ-CLAIM-LOOP.
 15592
 15593
 15594* EXEC CICS READNEXT
 15595*        DATASET   (CLMS-FILE-ID)
 15596*        SET       (ADDRESS OF CLAIM-MASTER)
 15597*        RIDFLD    (MSTR-KEY)
 15598*    END-EXEC.
 15599     MOVE 0
 15600       TO DFHEIV11
 15601*    MOVE '&.S                   )   #00013183' TO DFHEIV0
 15602     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15603     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15604     MOVE X'2020233030303133313833' TO DFHEIV0(25:11)
 15605     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 293
* EL131.cbl
 15606           CLMS-FILE-ID,
 15607           DFHEIV20,
 15608           DFHEIV99,
 15609           MSTR-KEY,
 15610           DFHEIV99,
 15611           DFHEIV11,
 15612           DFHEIV99,
 15613           DFHEIV99
 15614     SET ADDRESS OF CLAIM-MASTER TO
 15615         DFHEIV20
 15616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15617
 15618
 15619     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15620        CL-CARRIER     NOT = CARRI           OR
 15621        CL-CLAIM-NO    NOT = CLAIMI
 15622        GO TO 7630-END-BROWSE.
 15623
 15624     IF WS-ASSOCIATED-CERTS = 1
 15625         MOVE CL-CERT-PRIME      TO BCERT1O
 15626         MOVE CL-CERT-SFX        TO BSUFX1O.
 15627
 15628     IF WS-ASSOCIATED-CERTS = 2
 15629         MOVE CL-CERT-PRIME      TO BCERT2O
 15630         MOVE CL-CERT-SFX        TO BSUFX2O.
 15631
 15632     IF WS-ASSOCIATED-CERTS = 3
 15633         MOVE CL-CERT-PRIME      TO BCERT3O
 15634         MOVE CL-CERT-SFX        TO BSUFX3O.
 15635
 15636     IF WS-ASSOCIATED-CERTS = 4
 15637         MOVE CL-CERT-PRIME      TO BCERT4O
 15638         MOVE CL-CERT-SFX        TO BSUFX4O.
 15639
 15640     IF WS-ASSOCIATED-CERTS = 5
 15641         MOVE CL-CERT-PRIME      TO BCERT5O
 15642         MOVE CL-CERT-SFX        TO BSUFX5O
 15643     ELSE
 15644         ADD +1                  TO WS-ASSOCIATED-CERTS
 15645         GO TO 7620-READ-CLAIM-LOOP.
 15646
 15647 7630-END-BROWSE.
 15648
 15649
 15650* EXEC CICS ENDBR
 15651*        DATASET   (CLMS-FILE-ID)
 15652*    END-EXEC.
 15653     MOVE 0
 15654       TO DFHEIV11
 15655*    MOVE '&2                    $   #00013219' TO DFHEIV0
 15656     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15657     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15658     MOVE X'2020233030303133323139' TO DFHEIV0(25:11)
 15659     CALL 'kxdfhei1' USING DFHEIV0,
 15660           CLMS-FILE-ID,
 15661           DFHEIV11,
 15662           DFHEIV99
 15663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 294
* EL131.cbl
 15664
 15665
 15666 7640-HIGHLIGHT-CERT-DISPLAYED.
 15667
 15668     MOVE AL-SANON               TO BCERT1A
 15669                                    BSUFX1A
 15670                                    BCERT2A
 15671                                    BSUFX2A
 15672                                    BCERT3A
 15673                                    BSUFX3A
 15674                                    BCERT4A
 15675                                    BSUFX4A
 15676                                    BCERT5A
 15677                                    BSUFX5A.
 15678
 15679     IF BCERT1O = CERTI AND
 15680        BSUFX1O = SUFXI
 15681            MOVE AL-SABON        TO BCERT1A
 15682                                    BSUFX1A.
 15683
 15684     IF BCERT2O = CERTI AND
 15685        BSUFX2O = SUFXI
 15686            MOVE AL-SABON        TO BCERT2A
 15687                                    BSUFX2A.
 15688
 15689     IF BCERT3O = CERTI AND
 15690        BSUFX3O = SUFXI
 15691            MOVE AL-SABON        TO BCERT3A
 15692                                    BSUFX3A.
 15693
 15694     IF BCERT4O = CERTI AND
 15695        BSUFX4O = SUFXI
 15696            MOVE AL-SABON        TO BCERT4A
 15697                                    BSUFX4A.
 15698
 15699     IF BCERT5O = CERTI AND
 15700        BSUFX5O = SUFXI
 15701            MOVE AL-SABON        TO BCERT5A
 15702                                    BSUFX5A.
 15703
 15704 7699-EXIT.
 15705     EXIT.
 15706
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 295
* EL131.cbl
 15708 7700-CHECK-SEQUENCE.
 15709
 15710
 15711* EXEC CICS HANDLE CONDITION
 15712*        ENDFILE  (7799-EXIT)
 15713*        NOTFND   (7799-EXIT)
 15714*    END-EXEC.
 15715*    MOVE '"$''I                  ! E #00013267' TO DFHEIV0
 15716     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15717     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15718     MOVE X'4520233030303133323637' TO DFHEIV0(25:11)
 15719     CALL 'kxdfhei1' USING DFHEIV0
 15720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15721
 15722
 15723
 15724* EXEC CICS READ
 15725*        DATASET(CLMS-FILE-ID)
 15726*        SET    (ADDRESS OF CLAIM-MASTER)
 15727*        RIDFLD (MSTR-KEY)
 15728*        GENERIC
 15729*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15730*    END-EXEC.
 15731*    MOVE '&"S  KG    E          (   #00013272' TO DFHEIV0
 15732     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15734     MOVE X'2020233030303133323732' TO DFHEIV0(25:11)
 15735     CALL 'kxdfhei1' USING DFHEIV0,
 15736           CLMS-FILE-ID,
 15737           DFHEIV20,
 15738           DFHEIV99,
 15739           MSTR-KEY,
 15740           ELMSTR-GENERIC-LENGTH,
 15741           DFHEIV99,
 15742           DFHEIV99
 15743     SET ADDRESS OF CLAIM-MASTER TO
 15744         DFHEIV20
 15745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15746
 15747
 15748     COMPUTE WS-ASSOC-CERT-TOTAL =
 15749             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15750
 15751     GO TO 7799-EXIT.
 15752
 15753 7710-RESEQUENCE-CLAIMS.
 15754
 15755
 15756* EXEC CICS HANDLE CONDITION
 15757*        ENDFILE  (7799-EXIT)
 15758*    END-EXEC.
 15759*    MOVE '"$''                   ! F #00013287' TO DFHEIV0
 15760     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15762     MOVE X'4620233030303133323837' TO DFHEIV0(25:11)
 15763     CALL 'kxdfhei1' USING DFHEIV0
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 296
* EL131.cbl
 15766
 15767
 15768* EXEC CICS STARTBR
 15769*        DATASET(CLMS-FILE-ID)
 15770*        RIDFLD (MSTR-KEY)
 15771*    END-EXEC.
 15772     MOVE 0
 15773       TO DFHEIV11
 15774*    MOVE '&,         G          &   #00013291' TO DFHEIV0
 15775     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15777     MOVE X'2020233030303133323931' TO DFHEIV0(25:11)
 15778     CALL 'kxdfhei1' USING DFHEIV0,
 15779           CLMS-FILE-ID,
 15780           MSTR-KEY,
 15781           DFHEIV99,
 15782           DFHEIV11,
 15783           DFHEIV99
 15784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15785
 15786
 15787     COMPUTE WS-ASSOC-CERT-SEQU =
 15788             WS-ASSOC-CERT-SEQU + 1.
 15789
 15790     COMPUTE WS-READNEXT-SWITCH =
 15791             WS-READNEXT-SWITCH + 1.
 15792
 15793 7720-READ-CLAIM-LOOP.
 15794
 15795
 15796* EXEC CICS READNEXT
 15797*        DATASET(CLMS-FILE-ID)
 15798*        SET    (ADDRESS OF CLAIM-MASTER)
 15799*        RIDFLD (MSTR-KEY)
 15800*    END-EXEC.
 15801     MOVE 0
 15802       TO DFHEIV11
 15803*    MOVE '&.S                   )   #00013304' TO DFHEIV0
 15804     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15805     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15806     MOVE X'2020233030303133333034' TO DFHEIV0(25:11)
 15807     CALL 'kxdfhei1' USING DFHEIV0,
 15808           CLMS-FILE-ID,
 15809           DFHEIV20,
 15810           DFHEIV99,
 15811           MSTR-KEY,
 15812           DFHEIV99,
 15813           DFHEIV11,
 15814           DFHEIV99,
 15815           DFHEIV99
 15816     SET ADDRESS OF CLAIM-MASTER TO
 15817         DFHEIV20
 15818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15819
 15820
 15821     IF WS-READNEXT-SWITCH = 1
 15822         ADD 1                   TO WS-READNEXT-SWITCH
 15823         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 297
* EL131.cbl
 15824
 15825 7730-END-BROWSE.
 15826
 15827
 15828* EXEC CICS ENDBR
 15829*        DATASET(CLMS-FILE-ID)
 15830*    END-EXEC.
 15831     MOVE 0
 15832       TO DFHEIV11
 15833*    MOVE '&2                    $   #00013316' TO DFHEIV0
 15834     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15836     MOVE X'2020233030303133333136' TO DFHEIV0(25:11)
 15837     CALL 'kxdfhei1' USING DFHEIV0,
 15838           CLMS-FILE-ID,
 15839           DFHEIV11,
 15840           DFHEIV99
 15841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15842
 15843
 15844 7740-READ-CLAIM-UPDATE.
 15845
 15846     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15847        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15848        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15849        GO TO 7799-EXIT
 15850     ELSE
 15851        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15852
 15853
 15854* EXEC CICS READ
 15855*        DATASET(CLMS-FILE-ID)
 15856*        SET    (ADDRESS OF CLAIM-MASTER)
 15857*        RIDFLD (MSTR-KEY)
 15858*        UPDATE
 15859*    END-EXEC.
 15860*    MOVE '&"S        EU         (   #00013329' TO DFHEIV0
 15861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15863     MOVE X'2020233030303133333239' TO DFHEIV0(25:11)
 15864     CALL 'kxdfhei1' USING DFHEIV0,
 15865           CLMS-FILE-ID,
 15866           DFHEIV20,
 15867           DFHEIV99,
 15868           MSTR-KEY,
 15869           DFHEIV99,
 15870           DFHEIV99,
 15871           DFHEIV99
 15872     SET ADDRESS OF CLAIM-MASTER TO
 15873         DFHEIV20
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877     if (cl-priority-cd = '8')
 15878        and (pi-processor-id not = 'PEMA' and 'JMS '
 15879             AND 'AMWA')
 15880        MOVE ER-8003             TO EMI-ERROR
 15881        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 298
* EL131.cbl
 15882                                 THRU 9900-EXIT
 15883        MOVE -1                  TO MAINTL
 15884        GO TO 8110-SEND-DATA
 15885     end-if
 15886
 15887     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15888         MOVE 'Y'                TO CL-YESNOSW
 15889     END-IF.
 15890
 15891     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15892     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15893
 15894
 15895* EXEC CICS REWRITE
 15896*         DATASET(CLMS-FILE-ID)
 15897*         FROM   (CLAIM-MASTER)
 15898*    END-EXEC.
 15899     MOVE LENGTH OF
 15900      CLAIM-MASTER
 15901       TO DFHEIV11
 15902*    MOVE '&& L                  %   #00013353' TO DFHEIV0
 15903     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15904     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15905     MOVE X'2020233030303133333533' TO DFHEIV0(25:11)
 15906     CALL 'kxdfhei1' USING DFHEIV0,
 15907           CLMS-FILE-ID,
 15908           CLAIM-MASTER,
 15909           DFHEIV11,
 15910           DFHEIV99
 15911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15912
 15913
 15914     GO TO 7710-RESEQUENCE-CLAIMS.
 15915
 15916 7799-EXIT.
 15917     EXIT.
 15918
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 299
* EL131.cbl
 15920 7800-CHECK-AUTO-ACTIVITY.
 15921
 15922
 15923* EXEC CICS HANDLE CONDITION
 15924*        NOTFND   (7800-NOT-FOUND)
 15925*    END-EXEC.
 15926*    MOVE '"$I                   ! G #00013366' TO DFHEIV0
 15927     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15929     MOVE X'4720233030303133333636' TO DFHEIV0(25:11)
 15930     CALL 'kxdfhei1' USING DFHEIV0
 15931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15932
 15933
 15934     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15935     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15936     MOVE SPACES                     TO  CNTL-PROC-ID.
 15937     MOVE +0                         TO  CNTL-SEQ-NO.
 15938
 15939
 15940* EXEC CICS READ
 15941*        DATASET   (CNTL-FILE-ID)
 15942*        RIDFLD    (CNTL-KEY)
 15943*        SET       (ADDRESS OF CONTROL-FILE)
 15944*    END-EXEC.
 15945*    MOVE '&"S        E          (   #00013375' TO DFHEIV0
 15946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15948     MOVE X'2020233030303133333735' TO DFHEIV0(25:11)
 15949     CALL 'kxdfhei1' USING DFHEIV0,
 15950           CNTL-FILE-ID,
 15951           DFHEIV20,
 15952           DFHEIV99,
 15953           CNTL-KEY,
 15954           DFHEIV99,
 15955           DFHEIV99,
 15956           DFHEIV99
 15957     SET ADDRESS OF CONTROL-FILE TO
 15958         DFHEIV20
 15959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15960
 15961
 15962     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15963         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15964
 15965     IF CL-ACTIVITY-CODE NOT = ZEROS
 15966         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15967         IF MISC-SUB IS GREATER THAN +9
 15968             SUBTRACT +9 FROM MISC-SUB
 15969             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15970         ELSE
 15971             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15972     ELSE
 15973         MOVE 'Y'                              TO  WS-RESET-SW.
 15974
 15975     IF STATUSI = 'C' OR 'CLOSED'
 15976         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15977             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 300
* EL131.cbl
 15978                                         PI-LETTER-SW
 15979             GO TO 7800-EXIT.
 15980
 15981     IF STATUSI = 'C' OR 'CLOSED'
 15982         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15983             MOVE 'N'                TO  PI-LETTER-SW
 15984         ELSE
 15985             MOVE 'Y'                TO  PI-LETTER-SW.
 15986
 15987     IF STATUSI = 'O' OR 'OPEN'
 15988         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15989             MOVE 'N'                TO  PI-REC-FOUND-SW
 15990                                         PI-LETTER-SW
 15991             GO TO 7800-EXIT.
 15992
 15993     IF STATUSI = 'O' OR 'OPEN'
 15994         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15995             MOVE 'N'                TO  PI-LETTER-SW
 15996         ELSE
 15997             MOVE 'Y'                TO  PI-LETTER-SW.
 15998
 15999     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16000     GO TO 7800-EXIT.
 16001
 16002 7800-NOT-FOUND.
 16003
 16004     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16005                                         PI-LETTER-SW.
 16006
 16007 7800-EXIT.
 16008     EXIT.
 16009
 16010 7850-AUTO-LETTER-WRITER.
 16011
 16012     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16013     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16014
 16015     IF STATUSI = 'C' OR 'CLOSED'
 16016         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16017     ELSE
 16018         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16019
 16020     IF STATUSI = 'C' OR 'CLOSED'
 16021         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16022             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16023             MOVE '6'                TO  DC-OPTION-CODE
 16024             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16025             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16026             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16027             IF NO-CONVERSION-ERROR
 16028                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16029             ELSE
 16030                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16031
 16032     IF STATUSI = 'C' OR 'CLOSED'
 16033         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16034             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16035             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 301
* EL131.cbl
 16036             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16037             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16038             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16039             IF NO-CONVERSION-ERROR
 16040                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16041             ELSE
 16042                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16043
 16044     IF STATUSI = 'O' OR 'OPEN'
 16045         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16046             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16047             MOVE '6'                TO  DC-OPTION-CODE
 16048             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16049             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16050             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16051             IF NO-CONVERSION-ERROR
 16052                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16053             ELSE
 16054                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16055
 16056     IF STATUSI = 'O' OR 'OPEN'
 16057         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16058             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16059             MOVE '6'                TO  DC-OPTION-CODE
 16060             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16061             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16062             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16063             IF NO-CONVERSION-ERROR
 16064                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16065             ELSE
 16066                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16067
 16068
 16069* EXEC CICS LINK
 16070*        PROGRAM    (LINK-1523)
 16071*        COMMAREA   (W-1523-LINKDATA)
 16072*        LENGTH     (W-1523-COMM-LENGTH)
 16073*    END-EXEC.
 16074*    MOVE '."C                   (   #00013487' TO DFHEIV0
 16075     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16077     MOVE X'2020233030303133343837' TO DFHEIV0(25:11)
 16078     CALL 'kxdfhei1' USING DFHEIV0,
 16079           LINK-1523,
 16080           W-1523-LINKDATA,
 16081           W-1523-COMM-LENGTH,
 16082           DFHEIV99,
 16083           DFHEIV99,
 16084           DFHEIV99,
 16085           DFHEIV99
 16086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16087
 16088
 16089     IF W-1523-ERROR-CODE = ZEROS
 16090         GO TO 7850-EXIT.
 16091
 16092     IF W-1523-FATAL-ERROR
 16093         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 302
* EL131.cbl
 16094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16095
 16096     IF W-1523-ERROR-CODE = 0191
 16097         MOVE ER-0803                TO  EMI-ERROR
 16098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16099
 16100 7850-EXIT.
 16101     EXIT.
 16102
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 303
* EL131.cbl
 16104 8000-CREATE-DMO-REC.
 16105     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16106     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16107     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16108
 16109
 16110* EXEC CICS HANDLE CONDITION
 16111*         NOTFND   (8000-NOTE-NOT-FOUND)
 16112*    END-EXEC.
 16113*    MOVE '"$I                   ! H #00013513' TO DFHEIV0
 16114     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16116     MOVE X'4820233030303133353133' TO DFHEIV0(25:11)
 16117     CALL 'kxdfhei1' USING DFHEIV0
 16118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16119
 16120
 16121
 16122* EXEC CICS READ
 16123*         DATASET(NOTE-FILE-ID)
 16124*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16125*         RIDFLD (NOTE-KEY)
 16126*    END-EXEC.
 16127*    MOVE '&"S        E          (   #00013517' TO DFHEIV0
 16128     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16130     MOVE X'2020233030303133353137' TO DFHEIV0(25:11)
 16131     CALL 'kxdfhei1' USING DFHEIV0,
 16132           NOTE-FILE-ID,
 16133           DFHEIV20,
 16134           DFHEIV99,
 16135           NOTE-KEY,
 16136           DFHEIV99,
 16137           DFHEIV99,
 16138           DFHEIV99
 16139     SET ADDRESS OF CERTIFICATE-NOTE TO
 16140         DFHEIV20
 16141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16142
 16143
 16144     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16145     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16146     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16147
 16148     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16149         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16150     ELSE
 16151         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16152
 16153     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16154     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16155
 16156
 16157* EXEC CICS LINK
 16158*        PROGRAM    ('DLO006')
 16159*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16160*        LENGTH     (WS-DCT-LENGTH)
 16161*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 304
* EL131.cbl
 16162     MOVE 'DLO006' TO DFHEIV1
 16163*    MOVE '."C                   (   #00013535' TO DFHEIV0
 16164     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16166     MOVE X'2020233030303133353335' TO DFHEIV0(25:11)
 16167     CALL 'kxdfhei1' USING DFHEIV0,
 16168           DFHEIV1,
 16169           DCT-COMMUNICATION-AREA,
 16170           WS-DCT-LENGTH,
 16171           DFHEIV99,
 16172           DFHEIV99,
 16173           DFHEIV99,
 16174           DFHEIV99
 16175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16176
 16177
 16178     IF  DCT-RETURN-CODE = 'OK'
 16179         GO TO 8000-CONT.
 16180
 16181     IF DCT-RETURN-CODE = '01' OR '02'
 16182         GO TO 8000-EXIT.
 16183
 16184     IF DCT-RETURN-CODE = '03'
 16185         MOVE ER-0951            TO EMI-ERROR
 16186         MOVE -1                 TO MAINTL
 16187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16188         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16189         GO TO 8110-SEND-DATA.
 16190
 16191     IF DCT-RETURN-CODE = '04'
 16192         MOVE ER-0946            TO EMI-ERROR
 16193         MOVE -1                 TO MAINTL
 16194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16195         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16196         GO TO 8110-SEND-DATA.
 16197
 16198     IF DCT-RETURN-CODE = '05'
 16199         MOVE ER-0947            TO EMI-ERROR
 16200         MOVE -1                 TO MAINTL
 16201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16202         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16203         GO TO 8110-SEND-DATA.
 16204
 16205     IF DCT-RETURN-CODE = '06'
 16206         MOVE ER-0921            TO EMI-ERROR
 16207         MOVE -1                 TO MAINTL
 16208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16209         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16210         GO TO 8110-SEND-DATA.
 16211
 16212     IF DCT-RETURN-CODE = '07'
 16213         MOVE ER-0919            TO EMI-ERROR
 16214         MOVE -1                 TO MAINTL
 16215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16216         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16217         GO TO 8110-SEND-DATA.
 16218
 16219     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 305
* EL131.cbl
 16220         MOVE ER-0948            TO EMI-ERROR
 16221         MOVE -1                 TO MAINTL
 16222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16223         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16224         GO TO 8110-SEND-DATA.
 16225
 16226     IF DCT-RETURN-CODE = 'N1'
 16227         MOVE ER-0950            TO EMI-ERROR
 16228         MOVE -1                 TO MAINTL
 16229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16230         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16231         GO TO 8110-SEND-DATA.
 16232
 16233     IF DCT-RETURN-CODE = 'E1'
 16234         MOVE ER-0974            TO EMI-ERROR
 16235         MOVE -1                 TO MAINTL
 16236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16237         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16238         GO TO 8110-SEND-DATA.
 16239
 16240     IF DCT-RETURN-CODE = 'E2'
 16241         MOVE ER-0975            TO EMI-ERROR
 16242         MOVE -1                 TO MAINTL
 16243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16244         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16245         GO TO 8110-SEND-DATA.
 16246
 16247     IF DCT-RETURN-CODE NOT = 'OK'
 16248         MOVE ER-0949            TO EMI-ERROR
 16249         MOVE -1                 TO MAINTL
 16250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16251         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16252         GO TO 8110-SEND-DATA.
 16253
 16254 8000-CONT.
 16255
 16256     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16257     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16258     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16259     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16260     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16261     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16262     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16263     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16264
 16265     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16266     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16267     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16268     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16269     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16270
 16271     IF STATUSI = 'OPEN' OR 'O'
 16272         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16273      ELSE
 16274         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16275
 16276     IF STATUSI = 'OPEN' OR 'O'
 16277        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 306
* EL131.cbl
 16278         MOVE '1'                TO DM-CLAIM-STATUS
 16279      ELSE
 16280         MOVE '2'                TO DM-CLAIM-STATUS.
 16281
 16282     IF STATUSI = 'CLOSED' OR 'C'
 16283        IF NOT FINAL-PAID
 16284         MOVE '3'                TO DM-CLAIM-STATUS
 16285      ELSE
 16286         MOVE '4'                TO DM-CLAIM-STATUS.
 16287
 16288     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16289
 16290
 16291* EXEC CICS LINK
 16292*        PROGRAM    ('DLO025')
 16293*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16294*        LENGTH     (WS-DMO-LENGTH)
 16295*    END-EXEC.
 16296     MOVE 'DLO025' TO DFHEIV1
 16297*    MOVE '."C                   (   #00013653' TO DFHEIV0
 16298     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16300     MOVE X'2020233030303133363533' TO DFHEIV0(25:11)
 16301     CALL 'kxdfhei1' USING DFHEIV0,
 16302           DFHEIV1,
 16303           DMO-COMMUNICATION-AREA,
 16304           WS-DMO-LENGTH,
 16305           DFHEIV99,
 16306           DFHEIV99,
 16307           DFHEIV99,
 16308           DFHEIV99
 16309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16310
 16311
 16312     IF  DM-RETURN-CODE = 'OK'
 16313         GO TO 8000-EXIT.
 16314
 16315     IF DM-RETURN-CODE = '01'
 16316         MOVE ER-8051            TO EMI-ERROR
 16317         MOVE -1                 TO MAINTL
 16318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16320         GO TO 8110-SEND-DATA.
 16321
 16322     IF DM-RETURN-CODE = '02'
 16323         MOVE ER-8052            TO EMI-ERROR
 16324         MOVE -1                 TO MAINTL
 16325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16326         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16327         GO TO 8110-SEND-DATA.
 16328
 16329     IF DM-RETURN-CODE = '03'
 16330         MOVE ER-8053            TO EMI-ERROR
 16331         MOVE -1                 TO MAINTL
 16332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16333         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16334         GO TO 8110-SEND-DATA.
 16335
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 307
* EL131.cbl
 16336     IF DM-RETURN-CODE = '04'
 16337         MOVE ER-8054            TO EMI-ERROR
 16338         MOVE -1                 TO MAINTL
 16339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16340         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16341         GO TO 8110-SEND-DATA.
 16342
 16343     IF DM-RETURN-CODE = '05'
 16344         MOVE ER-8055            TO EMI-ERROR
 16345         MOVE -1                 TO MAINTL
 16346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16347         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16348         GO TO 8110-SEND-DATA.
 16349
 16350     IF DM-RETURN-CODE = '06'
 16351         MOVE ER-8056            TO EMI-ERROR
 16352         MOVE -1                 TO MAINTL
 16353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16354         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16355         GO TO 8110-SEND-DATA.
 16356
 16357     IF DM-RETURN-CODE = '07'
 16358         MOVE ER-8057            TO EMI-ERROR
 16359         MOVE -1                 TO MAINTL
 16360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16361         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16362         GO TO 8110-SEND-DATA.
 16363
 16364     IF DM-RETURN-CODE = '08'
 16365         MOVE ER-8058            TO EMI-ERROR
 16366         MOVE -1                 TO MAINTL
 16367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16368         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16369         GO TO 8110-SEND-DATA.
 16370
 16371     IF DM-RETURN-CODE = '09'
 16372         MOVE ER-8059            TO EMI-ERROR
 16373         MOVE -1                 TO MAINTL
 16374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16375         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16376         GO TO 8110-SEND-DATA.
 16377
 16378     IF DM-RETURN-CODE = '10'
 16379         MOVE ER-8060            TO EMI-ERROR
 16380         MOVE -1                 TO MAINTL
 16381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16382         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16383         GO TO 8110-SEND-DATA.
 16384
 16385     IF DM-RETURN-CODE = '11'
 16386         MOVE ER-8061            TO EMI-ERROR
 16387         MOVE -1                 TO MAINTL
 16388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16389         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16390         GO TO 8110-SEND-DATA.
 16391
 16392     IF DM-RETURN-CODE = '12'
 16393         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 308
* EL131.cbl
 16394         MOVE -1                 TO MAINTL
 16395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16396         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16397         GO TO 8110-SEND-DATA.
 16398
 16399     IF DM-RETURN-CODE = '13'
 16400         MOVE ER-8063            TO EMI-ERROR
 16401         MOVE -1                 TO MAINTL
 16402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16403         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16404         GO TO 8110-SEND-DATA.
 16405
 16406     IF DM-RETURN-CODE = '14'
 16407         MOVE ER-8064            TO EMI-ERROR
 16408         MOVE -1                 TO MAINTL
 16409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16410         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16411         GO TO 8110-SEND-DATA.
 16412
 16413     IF DM-RETURN-CODE = '15'
 16414         MOVE ER-8065            TO EMI-ERROR
 16415         MOVE -1                 TO MAINTL
 16416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16417         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16418         GO TO 8110-SEND-DATA.
 16419
 16420     IF DM-RETURN-CODE = '16'
 16421         MOVE ER-8154            TO EMI-ERROR
 16422         MOVE -1                 TO MAINTL
 16423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16424         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16425         GO TO 8110-SEND-DATA.
 16426
 16427     IF DM-RETURN-CODE = '17'
 16428         MOVE ER-8155            TO EMI-ERROR
 16429         MOVE -1                 TO MAINTL
 16430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16431         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16432         GO TO 8110-SEND-DATA.
 16433
 16434     IF DM-RETURN-CODE = 'N1'
 16435         MOVE ER-8152            TO EMI-ERROR
 16436         MOVE -1                 TO MAINTL
 16437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16438         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16439         GO TO 8110-SEND-DATA.
 16440
 16441     IF DM-RETURN-CODE = 'E1'
 16442         MOVE ER-8153            TO EMI-ERROR
 16443         MOVE -1                 TO MAINTL
 16444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16445         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16446         GO TO 8110-SEND-DATA.
 16447
 16448     MOVE ER-8066                TO EMI-ERROR.
 16449     MOVE -1                     TO MAINTL.
 16450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16451     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 309
* EL131.cbl
 16452     GO TO 8110-SEND-DATA.
 16453
 16454 8000-NOTE-NOT-FOUND.
 16455
 16456* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16457*    MOVE '6"R                   !   #00013802' TO DFHEIV0
 16458     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16460     MOVE X'2020233030303133383032' TO DFHEIV0(25:11)
 16461     CALL 'kxdfhei1' USING DFHEIV0
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464     MOVE ER-0954                TO EMI-ERROR.
 16465     MOVE -1                     TO MAINTL.
 16466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467     GO TO 8110-SEND-DATA.
 16468
 16469 8000-EXIT.
 16470     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 310
* EL131.cbl
 16472 8050-FORMAT-LAST-NAME-1ST.
 16473*****************************************************************
 16474*             M O V E   N A M E   R O U T I N E                 *
 16475*                                                               *
 16476*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16477*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16478*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16479*                                                               *
 16480*                  FIELD               VALUE                    *
 16481*                  -----               -----                    *
 16482*           W-NAME-LAST    (CL15)      SMITH                    *
 16483*           W-NAME-FIRST   (CL15)      JOHN                     *
 16484*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16485*                                                               *
 16486*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16487*                SMITH, JOHN ALLEN                              *
 16488*                     OR                                        *
 16489*                SMITH, JOHN A.                                 *
 16490*                                                               *
 16491*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16492*     COPYBOOK, ELCNWA.                                         *
 16493*****************************************************************.
 16494
 16495     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16496     MOVE ZERO                   TO WS-NAME-SW.
 16497     SET NWA-INDEX               TO +1.
 16498
 16499     IF W-NAME-LAST   = SPACES  AND
 16500        W-NAME-MIDDLE = SPACES
 16501          MOVE +1                TO WS-NAME-SW.
 16502
 16503     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16504     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16505
 16506     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16507     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16508
 16509     SET NWA-INDEX UP BY +1.
 16510
 16511     IF W-NAME-MIDDLE NOT = SPACES
 16512         IF W-NAME-MIDDLE-2 = SPACES
 16513             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16514             SET NWA-INDEX UP BY +1
 16515             MOVE '.'            TO WS-NW (NWA-INDEX)
 16516             SET NWA-INDEX UP BY +2
 16517         ELSE
 16518             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16519             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16520
 16521 8050-EXIT.
 16522     EXIT.
 16523
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 311
* EL131.cbl
 16525 8060-MOVE-NAME.
 16526     IF WS-NAME-SW GREATER THAN +1
 16527         GO TO 8060-EXIT.
 16528
 16529     IF WS-NAME-WORK2 = SPACES
 16530         GO TO 8060-EXIT.
 16531
 16532     SET NWA-INDEX2            TO +1.
 16533     SET NWA-INDEX3            TO +2.
 16534
 16535 8060-MOVE-NAME-CYCLE.
 16536     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16537
 16538     IF NWA-INDEX LESS THAN +30
 16539         SET NWA-INDEX UP BY +1
 16540     ELSE
 16541         ADD +2 TO  WS-NAME-SW
 16542         GO TO 8060-EXIT.
 16543
 16544     IF NWA-INDEX2 LESS THAN +20
 16545         SET NWA-INDEX3 UP BY +1
 16546         SET NWA-INDEX2 UP BY +1.
 16547
 16548     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16549        WS-NW2 (NWA-INDEX3) = SPACES
 16550         IF WS-NAME-SW = ZERO
 16551             MOVE ','            TO WS-NW (NWA-INDEX)
 16552             SET NWA-INDEX UP BY +2
 16553             MOVE +1             TO WS-NAME-SW
 16554             GO TO 8060-EXIT
 16555         ELSE
 16556             GO TO 8060-EXIT.
 16557
 16558     GO TO 8060-MOVE-NAME-CYCLE.
 16559
 16560 8060-EXIT.
 16561     EXIT.
 16562
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 312
* EL131.cbl
 16564
 16565 8070-UNLOCK-CLAIM-MSTR.
 16566
 16567* EXEC CICS UNLOCK
 16568*        DATASET   (CLMS-FILE-ID)
 16569*    END-EXEC.
 16570*    MOVE '&*                    #   #00013905' TO DFHEIV0
 16571     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16573     MOVE X'2020233030303133393035' TO DFHEIV0(25:11)
 16574     CALL 'kxdfhei1' USING DFHEIV0,
 16575           CLMS-FILE-ID,
 16576           DFHEIV99
 16577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16578
 16579
 16580 8070-EXIT.
 16581      EXIT.
 16582
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 313
* EL131.cbl
 16584 8100-SEND-MAP.
 16585     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16586
 16587     move al-uanon               to accswa
 16588     IF NOT PI-NO-CARRIER-SECURITY
 16589        MOVE AL-SANOF            TO CERTCARA.
 16590     IF NOT PI-NO-ACCOUNT-SECURITY
 16591        MOVE AL-SANOF            TO CERTACTA.
 16592
 16593     IF PI-PROCESSOR-ID = 'LGXX'
 16594        MOVE AL-UANON            TO CCNOA.
 16595
 16596     IF PI-COMPANY-ID = 'DMD'
 16597        NEXT SENTENCE
 16598     ELSE
 16599        MOVE AL-SADOF            TO PFKEY6A.
 16600
 16601     IF PI-USES-PAID-TO
 16602        MOVE 'PAID TO  :' TO PTHRHDGO.
 16603
 16604
 16605* EXEC CICS SEND
 16606*         MAP     ('EL131A')
 16607*         MAPSET  ('EL131S')
 16608*         ERASE
 16609*         FREEKB
 16610*         CURSOR
 16611*    END-EXEC.
 16612     MOVE 'EL131A' TO DFHEIV1
 16613     MOVE -1
 16614       TO DFHEIV11
 16615     MOVE 'EL131S' TO DFHEIV2
 16616*    MOVE '8$     CT  E F  H     ,   #00013933' TO DFHEIV0
 16617     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16618     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16619     MOVE X'2020233030303133393333' TO DFHEIV0(25:11)
 16620     CALL 'kxdfhei1' USING DFHEIV0,
 16621           DFHEIV1,
 16622           EL131AO,
 16623           DFHEIV99,
 16624           DFHEIV2,
 16625           DFHEIV99,
 16626           DFHEIV99,
 16627           DFHEIV99,
 16628           DFHEIV11,
 16629           DFHEIV99,
 16630           DFHEIV99,
 16631           DFHEIV99
 16632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16633
 16634
 16635     GO TO 9000-RETURN-TRANS.
 16636
 16637 8110-SEND-DATA.
 16638     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16639
 16640     IF PI-USES-PAID-TO
 16641        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 314
* EL131.cbl
 16642
 16643     IF PI-PROCESSOR-ID = 'LGXX'
 16644        MOVE AL-UANON            TO CCNOA.
 16645
 16646     IF PI-COMPANY-ID = 'DMD'
 16647        NEXT SENTENCE
 16648     ELSE
 16649        MOVE AL-SADOF            TO PFKEY6A.
 16650
 16651
 16652* EXEC CICS SEND
 16653*         MAP      ('EL131A')
 16654*         MAPSET   ('EL131S')
 16655*         DATAONLY
 16656*         FREEKB
 16657*         CURSOR
 16658*    END-EXEC.
 16659     MOVE 'EL131A' TO DFHEIV1
 16660     MOVE -1
 16661       TO DFHEIV11
 16662     MOVE 'EL131S' TO DFHEIV2
 16663*    MOVE '8$D    CT    F  H     ,   #00013957' TO DFHEIV0
 16664     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16665     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16666     MOVE X'2020233030303133393537' TO DFHEIV0(25:11)
 16667     CALL 'kxdfhei1' USING DFHEIV0,
 16668           DFHEIV1,
 16669           EL131AO,
 16670           DFHEIV99,
 16671           DFHEIV2,
 16672           DFHEIV99,
 16673           DFHEIV99,
 16674           DFHEIV99,
 16675           DFHEIV11,
 16676           DFHEIV99,
 16677           DFHEIV99,
 16678           DFHEIV99
 16679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16680
 16681
 16682     GO TO 9000-RETURN-TRANS.
 16683
 16684 8120-FORMAT-TIME-DATE.
 16685     perform 8140-check-for-prev-errors
 16686                                 thru 8140-exit
 16687     IF SKIP-ATTRIBUTE = 'Y'
 16688        MOVE SPACES              TO SKIP-ATTRIBUTE
 16689        MOVE ER-0598             TO EMI-ERROR
 16690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16691        GO TO 8125-SKIP-ATTRIBUTE.
 16692
 16693*     IF PI-COMPANY-ID = 'DMD'
 16694      IF PI-PROCESSOR-ID <> 'EMER'
 16695         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16696                                    CERTCARA  CERTGRPA CERTA SUFXA
 16697
 16698     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16699                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 315
* EL131.cbl
 16700                                    JNTINITA  JNTAGEA   APRA
 16701                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16702                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16703                                    LCVEXITA  LCVSTATA  LCVKINDA
 16704                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16705                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16706                                    ACVEXITA  ACVSTATA  ACVKINDA
 16707                                    PMTFREQA  INDGRPA   PREMTYPA
 16708                                    REINCDA   LCVRATEA  ACVRATEA
 16709                                    ADDONDTA.
 16710
 16711*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16712*       IF PI-COMPANY-ID = 'DMD'
 16713*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16714*                                   SUFXA
 16715*                                   PDAMTA    NODAYSA   NOPMTSA
 16716*                                   INCA      OCCA
 16717*          IF NOT SYSTEM-MODIFY-CAP
 16718*              MOVE AL-SANOF         TO PDTHRUA.
 16719
 16720     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16721         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16722
 16723 8125-SKIP-ATTRIBUTE.
 16724
 16725     MOVE SAVE-DATE              TO DATEO.
 16726
 16727* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16728*    END-EXEC
 16729*    MOVE '0"A                   "   #00014009' TO DFHEIV0
 16730     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16731     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16732     MOVE X'2020233030303134303039' TO DFHEIV0(25:11)
 16733     CALL 'kxdfhei1' USING DFHEIV0,
 16734           LCP-CICS-TIME
 16735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16736
 16737* EXEC CICS FORMATTIME
 16738*              ABSTIME(LCP-CICS-TIME)
 16739*              TIME(LCP-TIME-OF-DAY-XX)
 16740*    END-EXEC
 16741*    MOVE 'j$(     (             #   #00014011' TO DFHEIV0
 16742     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16743     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16744     MOVE X'2020233030303134303131' TO DFHEIV0(25:11)
 16745     CALL 'kxdfhei1' USING DFHEIV0,
 16746           LCP-CICS-TIME,
 16747           LCP-TIME-OF-DAY-XX
 16748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16749     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16750     MOVE UN-HOURS               TO FOR-HOURS.
 16751     MOVE UN-MINUTES             TO FOR-MINUTES.
 16752     MOVE TIME-OUT               TO TIMEO.
 16753     MOVE PI-COMPANY-ID          TO COMPO.
 16754     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16755     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16756     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16757     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 316
* EL131.cbl
 16758     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16759
 16760 8130-EXIT.
 16761     EXIT.
 16762
 16763 8140-check-for-prev-errors.
 16764
 16765     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16766     MOVE PI-CARRIER             TO trlr-carrier
 16767     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16768     MOVE PI-CERT-NO             TO trlr-cert-no
 16769     MOVE +95                    TO TRLR-SEQ-NO
 16770
 16771
 16772* EXEC CICS READ
 16773*       DATASET  ('ELTRLR')
 16774*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16775*       RIDFLD   (TRLR-KEY)
 16776*       RESP     (WS-RESPONSE)
 16777*    END-EXEC
 16778     MOVE 'ELTRLR' TO DFHEIV1
 16779*    MOVE '&"S        E          (  N#00014037' TO DFHEIV0
 16780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16782     MOVE X'204E233030303134303337' TO DFHEIV0(25:11)
 16783     CALL 'kxdfhei1' USING DFHEIV0,
 16784           DFHEIV1,
 16785           DFHEIV20,
 16786           DFHEIV99,
 16787           TRLR-KEY,
 16788           DFHEIV99,
 16789           DFHEIV99,
 16790           DFHEIV99
 16791     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16792         DFHEIV20
 16793     MOVE EIBRESP  TO WS-RESPONSE
 16794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16795
 16796     if ws-resp-normal
 16797        perform varying s1 from +1 by +1 until
 16798           at-note-error-no (s1) = spaces
 16799           if at-note-error-no (s1) = '1652'
 16800              continue
 16801           else
 16802              move at-note-error-no (s1)
 16803                                 to emi-error
 16804              move -1 to maintl
 16805              if at-note-error-no (s1) = '1653'
 16806                 evaluate true
 16807                    when pi-claim-type = 'L'
 16808                       move '  LF  '
 16809                        to emi-claim-type
 16810                    when pi-claim-type = 'I'
 16811                       move '  IU  '
 16812                        to emi-claim-type
 16813                    WHEN PI-CLAIM-TYPE = 'F'
 16814                       MOVE '  FL  '
 16815                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 317
* EL131.cbl
 16816                    when other
 16817                       move '  AH  '
 16818                        to emi-claim-type
 16819                 end-evaluate
 16820              end-if
 16821              PERFORM 9900-ERROR-FORMAT
 16822                                 THRU 9900-EXIT
 16823           end-if
 16824*          if at-note-error-no (s1) = '1653'
 16825*             perform varying emi-sub from 1 by 1 until
 16826*                emi-sub > 3
 16827*                if emi-error-number (emi-sub) = '1653'
 16828*                   evaluate true
 16829*                      when pi-claim-type = 'L'
 16830*                         move '  LF  '
 16831*                          to emi-claim-type
 16832*                      when pi-claim-type = 'I'
 16833*                         move '  IU  '
 16834*                          to emi-claim-type
 16835*                      when other
 16836*                         move '  AH  '
 16837*                          to emi-claim-type
 16838*                   end-evaluate
 16839*                end-if
 16840*             end-perform
 16841*          end-if
 16842        end-perform
 16843     else
 16844        display ' resp not normal ' ws-response ' '
 16845        trlr-key (2:19)
 16846     end-if
 16847
 16848     .
 16849 8140-exit.
 16850     exit.
 16851 8150-ENTERED-CLAIM-NOTFOUND.
 16852
 16853     MOVE ER-0204                TO EMI-ERROR.
 16854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16855     MOVE -1                     TO MAINTL.
 16856     GO TO 8100-SEND-MAP.
 16857
 16858 8200-RETURN-PRIOR.
 16859     MOVE SPACE                  TO PI-RETURN-CD-1.
 16860     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16861     GO TO 9200-XCTL.
 16862
 16863 8300-GET-HELP.
 16864     MOVE XCTL-EL010             TO CALL-PGM.
 16865     GO TO 9200-XCTL.
 16866
 16867 8400-RETURN-MASTER.
 16868     MOVE SPACE                  TO PI-RETURN-CD-1.
 16869     MOVE XCTL-EL126             TO CALL-PGM.
 16870     GO TO 9200-XCTL.
 16871
 16872 8500-TRLR-MNT.
 16873     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 318
* EL131.cbl
 16874         MOVE ER-0311            TO EMI-ERROR
 16875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16876         MOVE -1                 TO MAINTL
 16877         GO TO 8110-SEND-DATA.
 16878
 16879
 16880* EXEC CICS WRITEQ TS
 16881*         QUEUE     (PI-KEY)
 16882*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16883*         LENGTH    (PI-COMM-LENGTH)
 16884*    END-EXEC.
 16885*    MOVE '*"                    ''   #00014127' TO DFHEIV0
 16886     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16888     MOVE X'2020233030303134313237' TO DFHEIV0(25:11)
 16889     CALL 'kxdfhei1' USING DFHEIV0,
 16890           PI-KEY,
 16891           PROGRAM-INTERFACE-BLOCK,
 16892           PI-COMM-LENGTH,
 16893           DFHEIV99,
 16894           DFHEIV99,
 16895           DFHEIV99
 16896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16897
 16898
 16899     MOVE XCTL-EL142             TO CALL-PGM.
 16900     GO TO 9200-XCTL.
 16901
 16902 8600-ADDR-MNT.
 16903     IF PI-RETURN-CD-1 = 'X'
 16904         MOVE ER-0311            TO EMI-ERROR
 16905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16906         MOVE -1                 TO MAINTL
 16907         GO TO 8110-SEND-DATA.
 16908
 16909
 16910* EXEC CICS WRITEQ TS
 16911*         QUEUE     (PI-KEY)
 16912*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16913*         LENGTH    (PI-COMM-LENGTH)
 16914*    END-EXEC.
 16915*    MOVE '*"                    ''   #00014143' TO DFHEIV0
 16916     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16918     MOVE X'2020233030303134313433' TO DFHEIV0(25:11)
 16919     CALL 'kxdfhei1' USING DFHEIV0,
 16920           PI-KEY,
 16921           PROGRAM-INTERFACE-BLOCK,
 16922           PI-COMM-LENGTH,
 16923           DFHEIV99,
 16924           DFHEIV99,
 16925           DFHEIV99
 16926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16927
 16928
 16929     MOVE XCTL-EL141             TO CALL-PGM.
 16930     GO TO 9200-XCTL.
 16931
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 319
* EL131.cbl
 16932 8700-CERT-MNT.
 16933     IF PI-RETURN-CD-1 = 'X'
 16934         MOVE ER-7690            TO EMI-ERROR
 16935         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16936         MOVE -1                 TO MAINTL
 16937         GO TO 8110-SEND-DATA.
 16938
 16939
 16940* EXEC CICS WRITEQ TS
 16941*         QUEUE     (PI-KEY)
 16942*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16943*         LENGTH    (PI-COMM-LENGTH)
 16944*    END-EXEC.
 16945*    MOVE '*"                    ''   #00014159' TO DFHEIV0
 16946     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16948     MOVE X'2020233030303134313539' TO DFHEIV0(25:11)
 16949     CALL 'kxdfhei1' USING DFHEIV0,
 16950           PI-KEY,
 16951           PROGRAM-INTERFACE-BLOCK,
 16952           PI-COMM-LENGTH,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959     MOVE XCTL-EL1273            TO CALL-PGM.
 16960     GO TO 9200-XCTL.
 16961
 16962 8725-BENEFICIARY-MNT.
 16963     IF PI-RETURN-CD-1 = 'X'
 16964         MOVE ER-0311            TO EMI-ERROR
 16965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16966         MOVE -1                 TO MAINTL
 16967         GO TO 8110-SEND-DATA.
 16968
 16969
 16970* EXEC CICS WRITEQ TS
 16971*         QUEUE     (PI-KEY)
 16972*         FROM      (EL131AI)
 16973*         LENGTH    (MAP-LENGTH)
 16974*    END-EXEC.
 16975*    MOVE '*"                    ''   #00014175' TO DFHEIV0
 16976     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16978     MOVE X'2020233030303134313735' TO DFHEIV0(25:11)
 16979     CALL 'kxdfhei1' USING DFHEIV0,
 16980           PI-KEY,
 16981           EL131AI,
 16982           MAP-LENGTH,
 16983           DFHEIV99,
 16984           DFHEIV99,
 16985           DFHEIV99
 16986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16987
 16988
 16989
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 320
* EL131.cbl
 16990* EXEC CICS WRITEQ TS
 16991*         QUEUE     (PI-KEY)
 16992*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16993*         LENGTH    (PI-COMM-LENGTH)
 16994*    END-EXEC.
 16995*    MOVE '*"                    ''   #00014181' TO DFHEIV0
 16996     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16998     MOVE X'2020233030303134313831' TO DFHEIV0(25:11)
 16999     CALL 'kxdfhei1' USING DFHEIV0,
 17000           PI-KEY,
 17001           PROGRAM-INTERFACE-BLOCK,
 17002           PI-COMM-LENGTH,
 17003           DFHEIV99,
 17004           DFHEIV99,
 17005           DFHEIV99
 17006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17007
 17008
 17009     MOVE XCTL-EL114             TO CALL-PGM.
 17010     GO TO 9200-XCTL.
 17011
 17012 8750-DMD-CLM-FIX.
 17013
 17014* EXEC CICS WRITEQ TS
 17015*         QUEUE     (PI-KEY)
 17016*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17017*         LENGTH    (PI-COMM-LENGTH)
 17018*    END-EXEC.
 17019*    MOVE '*"                    ''   #00014191' TO DFHEIV0
 17020     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 17021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17022     MOVE X'2020233030303134313931' TO DFHEIV0(25:11)
 17023     CALL 'kxdfhei1' USING DFHEIV0,
 17024           PI-KEY,
 17025           PROGRAM-INTERFACE-BLOCK,
 17026           PI-COMM-LENGTH,
 17027           DFHEIV99,
 17028           DFHEIV99,
 17029           DFHEIV99
 17030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17031
 17032
 17033     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17034     GO TO 9200-XCTL.
 17035
 17036 8800-UNAUTHORIZED-ACCESS.
 17037     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17038     GO TO 8990-SEND-TEXT.
 17039
 17040 8810-PF23-ENTERED.
 17041     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17042     MOVE XCTL-EL005             TO CALL-PGM.
 17043     GO TO 9200-XCTL.
 17044
 17045 8820-XCTL-ERROR.
 17046
 17047* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 321
* EL131.cbl
 17048*        PGMIDERR (8990-SEND-TEXT)
 17049*    END-EXEC.
 17050*    MOVE '"$L                   ! I #00014210' TO DFHEIV0
 17051     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17053     MOVE X'4920233030303134323130' TO DFHEIV0(25:11)
 17054     CALL 'kxdfhei1' USING DFHEIV0
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17059     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17060     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17061     MOVE XCTL-EL005            TO CALL-PGM.
 17062     GO TO 9200-XCTL.
 17063
 17064 8990-SEND-TEXT.
 17065
 17066* EXEC CICS SEND TEXT
 17067*         FROM      (LOGOFF-TEXT)
 17068*         LENGTH    (LOGOFF-LENGTH)
 17069*         ERASE
 17070*         FREEKB
 17071*    END-EXEC.
 17072*    MOVE '8&      T  E F  H   F -   #00014221' TO DFHEIV0
 17073     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17074     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17075     MOVE X'2020233030303134323231' TO DFHEIV0(25:11)
 17076     CALL 'kxdfhei1' USING DFHEIV0,
 17077           LOGOFF-TEXT,
 17078           LOGOFF-LENGTH,
 17079           DFHEIV99,
 17080           DFHEIV99,
 17081           DFHEIV99,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99,
 17088           DFHEIV99
 17089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17090
 17091
 17092     GO TO 9100-RETURN-CICS.
 17093
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 322
* EL131.cbl
 17095 9000-RETURN-TRANS.
 17096
 17097* EXEC CICS RETURN
 17098*         TRANSID   (TRANS-ID)
 17099*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17100*         LENGTH    (PI-COMM-LENGTH)
 17101*    END-EXEC.
 17102*    MOVE '.(CT                  ''   #00014232' TO DFHEIV0
 17103     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17104     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17105     MOVE X'2020233030303134323332' TO DFHEIV0(25:11)
 17106     CALL 'kxdfhei1' USING DFHEIV0,
 17107           TRANS-ID,
 17108           PROGRAM-INTERFACE-BLOCK,
 17109           PI-COMM-LENGTH,
 17110           DFHEIV99,
 17111           DFHEIV99,
 17112           DFHEIV99
 17113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17114
 17115
 17116
 17117* GOBACK.
 17118     MOVE '9%                    "   ' TO DFHEIV0
 17119     MOVE 'EL131' TO DFHEIV1
 17120     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17121     GOBACK.
 17122
 17123 9100-RETURN-CICS.
 17124
 17125* EXEC CICS RETURN
 17126*    END-EXEC.
 17127*    MOVE '.(                    ''   #00014241' TO DFHEIV0
 17128     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17130     MOVE X'2020233030303134323431' TO DFHEIV0(25:11)
 17131     CALL 'kxdfhei1' USING DFHEIV0,
 17132           DFHEIV99,
 17133           DFHEIV99,
 17134           DFHEIV99,
 17135           DFHEIV99,
 17136           DFHEIV99,
 17137           DFHEIV99
 17138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17139
 17140
 17141
 17142* GOBACK.
 17143     MOVE '9%                    "   ' TO DFHEIV0
 17144     MOVE 'EL131' TO DFHEIV1
 17145     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17146     GOBACK.
 17147
 17148 9200-XCTL.
 17149
 17150* EXEC CICS XCTL
 17151*         PROGRAM    (CALL-PGM)
 17152*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 323
* EL131.cbl
 17153*         LENGTH     (PI-COMM-LENGTH)
 17154*    END-EXEC.
 17155*    MOVE '.$C                   %   #00014247' TO DFHEIV0
 17156     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17157     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17158     MOVE X'2020233030303134323437' TO DFHEIV0(25:11)
 17159     CALL 'kxdfhei1' USING DFHEIV0,
 17160           CALL-PGM,
 17161           PROGRAM-INTERFACE-BLOCK,
 17162           PI-COMM-LENGTH,
 17163           DFHEIV99
 17164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17165
 17166
 17167 9700-LINK-RTRM-FILE-ID.
 17168
 17169* EXEC CICS LINK
 17170*        PROGRAM  (RTRM-FILE-ID)
 17171*        COMMAREA (CALCULATION-PASS-AREA)
 17172*        LENGTH   (CP-COMM-LENGTH)
 17173*    END-EXEC.
 17174*    MOVE '."C                   (   #00014254' TO DFHEIV0
 17175     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17177     MOVE X'2020233030303134323534' TO DFHEIV0(25:11)
 17178     CALL 'kxdfhei1' USING DFHEIV0,
 17179           RTRM-FILE-ID,
 17180           CALCULATION-PASS-AREA,
 17181           CP-COMM-LENGTH,
 17182           DFHEIV99,
 17183           DFHEIV99,
 17184           DFHEIV99,
 17185           DFHEIV99
 17186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17187
 17188
 17189 9700-EXIT.
 17190      EXIT.
 17191
 17192 9800-CONVERT-DATE.
 17193     MOVE SPACES TO DC-ERROR-CODE.
 17194
 17195* EXEC CICS LINK
 17196*         PROGRAM    (DATE-CONV)
 17197*         COMMAREA   (DATE-CONVERSION-DATA)
 17198*         LENGTH     (DC-COMM-LENGTH)
 17199*    END-EXEC.
 17200*    MOVE '."C                   (   #00014265' TO DFHEIV0
 17201     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17203     MOVE X'2020233030303134323635' TO DFHEIV0(25:11)
 17204     CALL 'kxdfhei1' USING DFHEIV0,
 17205           DATE-CONV,
 17206           DATE-CONVERSION-DATA,
 17207           DC-COMM-LENGTH,
 17208           DFHEIV99,
 17209           DFHEIV99,
 17210           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 324
* EL131.cbl
 17211           DFHEIV99
 17212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17213
 17214
 17215 9800-EXIT.
 17216     EXIT.
 17217
 17218 9900-ERROR-FORMAT.
 17219
 17220* EXEC CICS LINK
 17221*         PROGRAM    (XCTL-EL001)
 17222*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17223*         LENGTH     (EMI-COMM-LENGTH)
 17224*    END-EXEC.
 17225*    MOVE '."C                   (   #00014275' TO DFHEIV0
 17226     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17228     MOVE X'2020233030303134323735' TO DFHEIV0(25:11)
 17229     CALL 'kxdfhei1' USING DFHEIV0,
 17230           XCTL-EL001,
 17231           ERROR-MESSAGE-INTERFACE-BLOCK,
 17232           EMI-COMM-LENGTH,
 17233           DFHEIV99,
 17234           DFHEIV99,
 17235           DFHEIV99,
 17236           DFHEIV99
 17237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17238
 17239
 17240 9900-EXIT.
 17241     EXIT.
 17242
 17243 9990-ABEND.
 17244     MOVE DFHEIBLK               TO EMI-LINE1.
 17245
 17246* EXEC CICS LINK
 17247*         PROGRAM   (XCTL-EL004)
 17248*         COMMAREA  (EMI-LINE1)
 17249*         LENGTH    (72)
 17250*     END-EXEC.
 17251     MOVE 72
 17252       TO DFHEIV11
 17253*    MOVE '."C                   (   #00014286' TO DFHEIV0
 17254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17256     MOVE X'2020233030303134323836' TO DFHEIV0(25:11)
 17257     CALL 'kxdfhei1' USING DFHEIV0,
 17258           XCTL-EL004,
 17259           EMI-LINE1,
 17260           DFHEIV11,
 17261           DFHEIV99,
 17262           DFHEIV99,
 17263           DFHEIV99,
 17264           DFHEIV99
 17265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17266
 17267
 17268     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 325
* EL131.cbl
 17269
 17270     GO TO 8110-SEND-DATA.
 17271
 17272 9995-SECURITY-VIOLATION.
 17273*           COPY ELCSCTP.
 17274******************************************************************
 17275*                                                                *
 17276*                            ELCSCTP                             *
 17277*                            VMOD=2.001                          *
 17278*                                                                *
 17279*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17280******************************************************************
 17281
 17282
 17283     MOVE EIBDATE          TO SM-JUL-DATE.
 17284     MOVE EIBTRMID         TO SM-TERMID.
 17285     MOVE THIS-PGM         TO SM-PGM.
 17286     MOVE EIBTIME          TO TIME-IN.
 17287     MOVE TIME-OUT         TO SM-TIME.
 17288     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17289
 17290
 17291* EXEC CICS LINK
 17292*         PROGRAM  ('EL003')
 17293*         COMMAREA (SECURITY-MESSAGE)
 17294*         LENGTH   (80)
 17295*    END-EXEC.
 17296     MOVE 'EL003' TO DFHEIV1
 17297     MOVE 80
 17298       TO DFHEIV11
 17299*    MOVE '."C                   (   #00014314' TO DFHEIV0
 17300     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17301     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17302     MOVE X'2020233030303134333134' TO DFHEIV0(25:11)
 17303     CALL 'kxdfhei1' USING DFHEIV0,
 17304           DFHEIV1,
 17305           SECURITY-MESSAGE,
 17306           DFHEIV11,
 17307           DFHEIV99,
 17308           DFHEIV99,
 17309           DFHEIV99,
 17310           DFHEIV99
 17311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17312
 17313
 17314******************************************************************
 17315
 17316
 17317
 17318 9999-DFHBACK SECTION.
 17319     MOVE '9%                    "   ' TO DFHEIV0
 17320     MOVE 'EL131' TO DFHEIV1
 17321     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17322     GOBACK.
 17323 9999-DFHEXIT.
 17324     IF DFHEIGDJ EQUAL 0001
 17325         NEXT SENTENCE
 17326     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 326
* EL131.cbl
 17327         GO TO 8820-XCTL-ERROR,
 17328               8150-ENTERED-CLAIM-NOTFOUND,
 17329               9990-ABEND
 17330         DEPENDING ON DFHEIGDI
 17331     ELSE IF DFHEIGDJ EQUAL 3
 17332         GO TO 0130-TS-ERROR,
 17333               0130-TS-ERROR
 17334         DEPENDING ON DFHEIGDI
 17335     ELSE IF DFHEIGDJ EQUAL 4
 17336         GO TO 0600-CONTINUE-NAME-UPDATE
 17337         DEPENDING ON DFHEIGDI
 17338     ELSE IF DFHEIGDJ EQUAL 5
 17339         GO TO 1004-BENE-NOT-FOUND
 17340         DEPENDING ON DFHEIGDI
 17341     ELSE IF DFHEIGDJ EQUAL 6
 17342         GO TO 1052-DONE,
 17343               1052-DONE
 17344         DEPENDING ON DFHEIGDI
 17345     ELSE IF DFHEIGDJ EQUAL 7
 17346         GO TO 1120-CNTL-NOTFND
 17347         DEPENDING ON DFHEIGDI
 17348     ELSE IF DFHEIGDJ EQUAL 8
 17349         GO TO 1150-NOTOPEN-ERROR,
 17350               1150-EXIT
 17351         DEPENDING ON DFHEIGDI
 17352     ELSE IF DFHEIGDJ EQUAL 9
 17353         GO TO 1490-STATE-NOTFND
 17354         DEPENDING ON DFHEIGDI
 17355     ELSE IF DFHEIGDJ EQUAL 10
 17356         GO TO 1500-CARR-NOTFND
 17357         DEPENDING ON DFHEIGDI
 17358     ELSE IF DFHEIGDJ EQUAL 11
 17359         GO TO 1620-ACCT-NOTFND
 17360         DEPENDING ON DFHEIGDI
 17361     ELSE IF DFHEIGDJ EQUAL 12
 17362         GO TO 2020-EXIT
 17363         DEPENDING ON DFHEIGDI
 17364     ELSE IF DFHEIGDJ EQUAL 13
 17365         GO TO 2030-EXIT
 17366         DEPENDING ON DFHEIGDI
 17367     ELSE IF DFHEIGDJ EQUAL 14
 17368         GO TO 2040-EXIT
 17369         DEPENDING ON DFHEIGDI
 17370     ELSE IF DFHEIGDJ EQUAL 15
 17371         GO TO 2050-EXIT
 17372         DEPENDING ON DFHEIGDI
 17373     ELSE IF DFHEIGDJ EQUAL 16
 17374         GO TO 2060-CERT-NOTFND
 17375         DEPENDING ON DFHEIGDI
 17376     ELSE IF DFHEIGDJ EQUAL 17
 17377         GO TO 2060-DUPKEY
 17378         DEPENDING ON DFHEIGDI
 17379     ELSE IF DFHEIGDJ EQUAL 18
 17380         GO TO 2070-NOT-FOUND
 17381         DEPENDING ON DFHEIGDI
 17382     ELSE IF DFHEIGDJ EQUAL 19
 17383         GO TO 2070-EXIT
 17384         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 327
* EL131.cbl
 17385     ELSE IF DFHEIGDJ EQUAL 20
 17386         GO TO 2080-EXIT
 17387         DEPENDING ON DFHEIGDI
 17388     ELSE IF DFHEIGDJ EQUAL 21
 17389         GO TO 2400-TRLR-NOTFND,
 17390               2410-EXIT
 17391         DEPENDING ON DFHEIGDI
 17392     ELSE IF DFHEIGDJ EQUAL 22
 17393         GO TO 2425-NINETY-NOTFND,
 17394               2425-NINETY-NOTFND
 17395         DEPENDING ON DFHEIGDI
 17396     ELSE IF DFHEIGDJ EQUAL 23
 17397         GO TO 2430-EXIT,
 17398               2440-EXIT
 17399         DEPENDING ON DFHEIGDI
 17400     ELSE IF DFHEIGDJ EQUAL 24
 17401         GO TO 2440-EXIT
 17402         DEPENDING ON DFHEIGDI
 17403     ELSE IF DFHEIGDJ EQUAL 25
 17404         GO TO 2460-EXIT
 17405         DEPENDING ON DFHEIGDI
 17406     ELSE IF DFHEIGDJ EQUAL 26
 17407         GO TO 2475-EXIT
 17408         DEPENDING ON DFHEIGDI
 17409     ELSE IF DFHEIGDJ EQUAL 27
 17410         GO TO 2650-EXIT
 17411         DEPENDING ON DFHEIGDI
 17412     ELSE IF DFHEIGDJ EQUAL 28
 17413         GO TO 2800-EXIT,
 17414               2800-EXIT
 17415         DEPENDING ON DFHEIGDI
 17416     ELSE IF DFHEIGDJ EQUAL 29
 17417         GO TO 3010-DEL-ACTQ,
 17418               3040-EXIT
 17419         DEPENDING ON DFHEIGDI
 17420     ELSE IF DFHEIGDJ EQUAL 30
 17421         GO TO 3010-NO-ACTIVITY,
 17422               3050-EXIT
 17423         DEPENDING ON DFHEIGDI
 17424     ELSE IF DFHEIGDJ EQUAL 31
 17425         GO TO 3010-CERT-NOT-FOUND
 17426         DEPENDING ON DFHEIGDI
 17427     ELSE IF DFHEIGDJ EQUAL 32
 17428         GO TO 3020-EXIT
 17429         DEPENDING ON DFHEIGDI
 17430     ELSE IF DFHEIGDJ EQUAL 33
 17431         GO TO 3060-EXIT,
 17432               3060-EXIT
 17433         DEPENDING ON DFHEIGDI
 17434     ELSE IF DFHEIGDJ EQUAL 34
 17435         GO TO 5000-TRLR-NOT-FOUND
 17436         DEPENDING ON DFHEIGDI
 17437     ELSE IF DFHEIGDJ EQUAL 35
 17438         GO TO 5000-CERT-NOT-FOUND
 17439         DEPENDING ON DFHEIGDI
 17440     ELSE IF DFHEIGDJ EQUAL 36
 17441         GO TO 7630-END-BROWSE
 17442         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:10 Page 328
* EL131.cbl
 17443     ELSE IF DFHEIGDJ EQUAL 37
 17444         GO TO 7799-EXIT,
 17445               7799-EXIT
 17446         DEPENDING ON DFHEIGDI
 17447     ELSE IF DFHEIGDJ EQUAL 38
 17448         GO TO 7799-EXIT
 17449         DEPENDING ON DFHEIGDI
 17450     ELSE IF DFHEIGDJ EQUAL 39
 17451         GO TO 7800-NOT-FOUND
 17452         DEPENDING ON DFHEIGDI
 17453     ELSE IF DFHEIGDJ EQUAL 40
 17454         GO TO 8000-NOTE-NOT-FOUND
 17455         DEPENDING ON DFHEIGDI
 17456     ELSE IF DFHEIGDJ EQUAL 41
 17457         GO TO 8990-SEND-TEXT
 17458         DEPENDING ON DFHEIGDI.
 17459     MOVE '9%                    "   ' TO DFHEIV0
 17460     MOVE 'EL131' TO DFHEIV1
 17461     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17462     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13596     Code:       60593
