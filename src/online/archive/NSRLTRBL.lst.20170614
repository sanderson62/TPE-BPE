* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20******************************************************************
    21 ENVIRONMENT DIVISION.
    22 DATA DIVISION.
    23 working-storage section.
    24 01  DFH-START PIC X(04).
    25 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    26 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    27 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    28 77  S1                          PIC S999 COMP-3 VALUE +0.
    29 77  S2                          PIC S999 COMP-3 VALUE +0.
    30 77  S3                          PIC S999 COMP-3 VALUE +0.
    31 77  E1                          PIC S999 COMP-3 VALUE +0.
    32 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    33 77  M1                          PIC S999 COMP-3 VALUE +0.
    34 77  P1                          PIC S999 COMP-3 VALUE +0.
    35 77  WS-HOLD-KEY                 PIC X(20).
    36 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    37 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    38 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    39 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    40 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    41 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    42 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    43 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    44 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    45 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    46 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    47     88  FOUND-BENE                  VALUE 'Y'.
    48 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    49 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    50 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-CNTR                     pic s999 comp-3 value +0.
    52 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    53 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    55 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    56 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    57 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    58 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    59 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    60     88  PDEF-FOUND                   VALUE 'Y'.
    61 77  wk1                         pic 999 value zeros.
    62 77  wk2                         pic 999 value zeros.
    63 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    64 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    65 01  output-screen-work-area.
    66     05  os-prev-key.
    67         10  os-prev-clm-type        pic x.
    68         10  os-prev-ins-type        pic x.
    69     05  ws-pd-bens                  pic 999 value zeros.
    70     05  ws-cov-rem-bens             pic s999 value zeros.
    71 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   3
* NSRLTRBL.cbl
    72 01 response-code         pic s9(8) comp.
    73 01 display-response      pic 9(8).
    74 01 bl-index              pic 9(8) comp.
    75 01 max-last-name         pic x(18).
    76 01 first-initial         pic x.
    77 01 name-in-range-flag    pic 9.
    78 01 max-entries           pic s9(8) comp value 100.
    79 01 lower-case    pic x(26) value
    80            "abcdefghijklmnopqrstuvwxyz".
    81 01 upper-case    pic x(26) value
    82            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    83 01  W-Z-CONTROL-DATA.
    84     05  W-NUMBER-OF-COPIES  PIC  9(01).
    85     05  FILLER              PIC  X(01).
    86     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    87     05  FILLER              PIC  X(01).
    88     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    89     05  FILLER              PIC  X(01).
    90     05  W-FORM-TO-RESEND    PIC  X(04).
    91     05  FILLER              PIC  X(01).
    92     05  W-PROMPT-LETTER     PIC  X(01).
    93     05  FILLER              PIC  X(01).
    94     05  W-ENCLOSURE-CD      PIC  X(03).
    95     05  FILLER              PIC  X(1).
    96     05  W-AUTO-CLOSE-IND    PIC  X(1).
    97     05  FILLER              PIC  X(1).
    98     05  W-LETTER-TO-BENE    PIC  X(1).
    99 01  MISC.
   100     12  WS-RESPONSE             PIC S9(8)   COMP.
   101         88  RESP-NORMAL                  VALUE +00.
   102         88  RESP-NOTFND                  VALUE +13.
   103         88  RESP-DUPREC                  VALUE +14.
   104         88  RESP-DUPKEY                  VALUE +15.
   105         88  RESP-NOTOPEN                 VALUE +19.
   106         88  RESP-ENDFILE                 VALUE +20.
   107 01  WS-ELENCC-KEY.
   108     05  WS-ELENCC-COMPANY-CD    PIC X.
   109     05  WS-ELENCC-REC-TYPE      PIC X.
   110     05  WS-ELENCC-ENC-CODE      PIC X(5).
   111     05  F                       PIC X(09).
   112 01  WS-ELMSTR-KEY.
   113     05  WS-ELMSTR-COMPANY-CD    PIC X.
   114     05  WS-ELMSTR-CARRIER       PIC X.
   115     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   116     05  WS-ELMSTR-CERT-NO       PIC X(11).
   117 01  WS-ELTRLR-KEY.
   118     05  WS-ELTRLR-COMPANY-CD    PIC X.
   119     05  WS-ELTRLR-CARRIER       PIC X.
   120     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   121     05  WS-ELTRLR-CERT-NO       PIC X(11).
   122     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   123 01  WS-ELCERT-KEY.
   124     05  WS-ELCERT-COMPANY-CD    PIC X.
   125     05  WS-ELCERT-CARRIER       PIC X.
   126     05  WS-ELCERT-GROUP         PIC X(6).
   127     05  WS-ELCERT-STATE         PIC XX.
   128     05  WS-ELCERT-ACCOUNT       PIC X(10).
   129     05  WS-ELCERT-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-CERT-NO       PIC X(11).
   131 01  WS-ERACCT-KEY.
   132     05  WS-ERACCT-COMPANY-CD    PIC X.
   133     05  WS-ERACCT-CARRIER       PIC X.
   134     05  WS-ERACCT-GROUP         PIC X(6).
   135     05  WS-ERACCT-STATE         PIC XX.
   136     05  WS-ERACCT-ACCOUNT       PIC X(10).
   137     05  WS-ERACCT-EXP-DT        PIC XX.
   138     05  FILLER                  PIC XXXX.
   139 01  WS-ELBENE-KEY.
   140     05  WS-ELBENE-COMPANY-CD    PIC X.
   141     05  WS-ELBENE-REC-TYPE      PIC X.
   142     05  WS-ELBENE-BENE          PIC X(10).
   143 01  WS-ELLETR-KEY.
   144     05  WS-ELLETR-COMPANY-CD    PIC X.
   145     05  WS-ELLETR-LETTER-ID     PIC X(12).
   146     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   147 01  WS-ELCNTL-KEY.
   148     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   149     05  WS-ELCNTL-REC-TYPE      PIC X.
   150     05  WS-ELCNTL-GENL.
   151         10  FILLER              PIC XX  VALUE SPACES.
   152         10  WS-ELCNTL-BEN-CD    PIC XX.
   153     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   154 01  ACCESS-KEYS.
   155     12  ELCRTT-KEY.
   156         16  CRTT-COMP-CD            PIC X.
   157         16  CRTT-CARRIER            PIC X.
   158         16  CRTT-GROUPING           PIC X(6).
   159         16  CRTT-STATE              PIC XX.
   160         16  CRTT-ACCOUNT            PIC X(10).
   161         16  CRTT-EFF-DT             PIC XX.
   162         16  CRTT-CERT-NO            PIC X(11).
   163         16  CRTT-REC-TYPE           PIC X.
   164
   165 01  ERPDEF-KEY-SAVE             PIC X(18).
   166 01  ERPDEF-KEY.
   167     12  ERPDEF-COMPANY-CD       PIC X.
   168     12  ERPDEF-STATE            PIC XX.
   169     12  ERPDEF-PROD-CD          PIC XXX.
   170     12  F                       PIC X(7).
   171     12  ERPDEF-BEN-TYPE         PIC X.
   172     12  ERPDEF-BEN-CODE         PIC XX.
   173     12  ERPDEF-EXP-DT           PIC XX.
   174 01  TEXT-WORK-AREAS.
   175     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   176 01  WS-UNSORTED-TABLE.
   177     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   178         16  WS-KEY.
   179             20  WS-CLM-TYPE     PIC X.
   180             20  WS-INS-TYPE     PIC X.
   181             20  WS-BEN-PER      PIC 99.
   182             20  WS-INC-DT       PIC XX.
   183         16  WS-EXCL-PER         PIC 999.
   184         16  WS-COV-ENDS         PIC 999.
   185         16  WS-ACC-PER          PIC 999.
   186         16  WS-MAX-BENS         PIC 999.
   187         16  WS-REC-MOS          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   5
* NSRLTRBL.cbl
   188         16  WS-MAX-EXTEN        PIC 99.
   189         16  WS-STATUS           PIC X.
   190         16  WS-PD-THRU-DT       PIC XX.
   191         16  WS-CLAIM-NO         PIC X(7).
   192         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   193         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   194         16  WS-REM-BENS         PIC 999.
   195         16  WS-SORTED-SW        PIC X.
   196 01  WS-SORTED-TABLE.
   197     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   198         16  WS-SRTD-KEY.
   199             20  WS-SRTD-CLM-TYPE PIC X.
   200             20  WS-SRTD-INS-TYPE PIC X.
   201             20  WS-SRTD-BEN-PER PIC 99.
   202             20  WS-SRTD-INC-DT  PIC XX.
   203         16  WS-SRTD-EXCL-PER    PIC 999.
   204         16  WS-SRTD-COV-ENDS    PIC 999.
   205         16  WS-SRTD-ACC-PER     PIC 999.
   206         16  WS-SRTD-MAX-BENS    PIC 999.
   207         16  WS-SRTD-REC-MOS     PIC 99.
   208         16  WS-SRTD-MAX-EXTEN   PIC 99.
   209         16  WS-SRTD-STATUS      PIC X.
   210         16  WS-SRTD-PD-THRU-DT  PIC XX.
   211         16  WS-SRTD-CLAIM-NO    PIC X(7).
   212         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   213         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   214         16  WS-SRTD-REM-BENS    PIC 999.
   215         16  WS-SRTD-SW          PIC X.
   216 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   217*                                COPY ELCDATE.
   218******************************************************************
   219*                                                                *
   220*                                                                *
   221*                            ELCDATE.                            *
   222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   223*                            VMOD=2.003
   224*                                                                *
   225*                                                                *
   226*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   227*                 LENGTH = 200                                   *
   228******************************************************************
   229
   230 01  DATE-CONVERSION-DATA.
   231     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   232     12  DC-OPTION-CODE                PIC X.
   233         88  BIN-TO-GREG                VALUE ' '.
   234         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   235         88  EDIT-GREG-TO-BIN           VALUE '2'.
   236         88  YMD-GREG-TO-BIN            VALUE '3'.
   237         88  MDY-GREG-TO-BIN            VALUE '4'.
   238         88  JULIAN-TO-BIN              VALUE '5'.
   239         88  BIN-PLUS-ELAPSED           VALUE '6'.
   240         88  FIND-CENTURY               VALUE '7'.
   241         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   242         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   243         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   244         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   245         88  JULIAN-TO-BIN-3            VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   6
* NSRLTRBL.cbl
   246         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   247         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   248         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   249         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   250         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   251         88  CHECK-LEAP-YEAR            VALUE 'H'.
   252         88  BIN-3-TO-GREG              VALUE 'I'.
   253         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   254         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   255         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   256         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   257         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   258         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   259         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   260         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   261         88  THREE-CHARACTER-BIN
   262                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   263         88  GREGORIAN-TO-BIN
   264                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   265         88  BIN-TO-GREGORIAN
   266                  VALUES ' ' '1' 'I' '8' 'G'.
   267         88  JULIAN-TO-BINARY
   268                  VALUES '5' 'C' 'E' 'F'.
   269     12  DC-ERROR-CODE                 PIC X.
   270         88  NO-CONVERSION-ERROR        VALUE ' '.
   271         88  DATE-CONVERSION-ERROR
   272                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   273         88  DATE-IS-ZERO               VALUE '1'.
   274         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   275         88  DATE-IS-INVALID            VALUE '3'.
   276         88  DATE1-GREATER-DATE2        VALUE '4'.
   277         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   278         88  DATE-INVALID-OPTION        VALUE '9'.
   279         88  INVALID-CENTURY            VALUE 'A'.
   280         88  ONLY-CENTURY               VALUE 'B'.
   281         88  ONLY-LEAP-YEAR             VALUE 'C'.
   282         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   283     12  DC-END-OF-MONTH               PIC X.
   284         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   285     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   286         88  USE-NORMAL-PROCESS         VALUE ' '.
   287         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   288         88  ADJUST-UP-100-YRS          VALUE '2'.
   289     12  FILLER                        PIC X.
   290     12  DC-CONVERSION-DATES.
   291         16  DC-BIN-DATE-1             PIC XX.
   292         16  DC-BIN-DATE-2             PIC XX.
   293         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   294         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   295                       DC-GREG-DATE-1-EDIT.
   296             20  DC-EDIT1-MONTH        PIC 99.
   297             20  SLASH1-1              PIC X.
   298             20  DC-EDIT1-DAY          PIC 99.
   299             20  SLASH1-2              PIC X.
   300             20  DC-EDIT1-YEAR         PIC 99.
   301         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   302         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   303                     DC-GREG-DATE-2-EDIT.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   7
* NSRLTRBL.cbl
   304             20  DC-EDIT2-MONTH        PIC 99.
   305             20  SLASH2-1              PIC X.
   306             20  DC-EDIT2-DAY          PIC 99.
   307             20  SLASH2-2              PIC X.
   308             20  DC-EDIT2-YEAR         PIC 99.
   309         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   310         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   311                     DC-GREG-DATE-1-YMD.
   312             20  DC-YMD-YEAR           PIC 99.
   313             20  DC-YMD-MONTH          PIC 99.
   314             20  DC-YMD-DAY            PIC 99.
   315         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   316         16  DC-GREG-DATE-1-MDY-R REDEFINES
   317                      DC-GREG-DATE-1-MDY.
   318             20  DC-MDY-MONTH          PIC 99.
   319             20  DC-MDY-DAY            PIC 99.
   320             20  DC-MDY-YEAR           PIC 99.
   321         16  DC-GREG-DATE-1-ALPHA.
   322             20  DC-ALPHA-MONTH        PIC X(10).
   323             20  DC-ALPHA-DAY          PIC 99.
   324             20  FILLER                PIC XX.
   325             20  DC-ALPHA-CENTURY.
   326                 24 DC-ALPHA-CEN-N     PIC 99.
   327             20  DC-ALPHA-YEAR         PIC 99.
   328         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   329         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   330         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   331         16  DC-JULIAN-DATE            PIC 9(05).
   332         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   333                                       PIC 9(05).
   334         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   335             20  DC-JULIAN-YEAR        PIC 99.
   336             20  DC-JULIAN-DAYS        PIC 999.
   337         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   338         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   339         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   340     12  DATE-CONVERSION-VARIBLES.
   341         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   342         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   343             20  FILLER                PIC 9(3).
   344             20  HOLD-CEN-1-CCYY.
   345                 24  HOLD-CEN-1-CC     PIC 99.
   346                 24  HOLD-CEN-1-YY     PIC 99.
   347             20  HOLD-CEN-1-MO         PIC 99.
   348             20  HOLD-CEN-1-DA         PIC 99.
   349         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   350             20  HOLD-CEN-1-R-MO       PIC 99.
   351             20  HOLD-CEN-1-R-DA       PIC 99.
   352             20  HOLD-CEN-1-R-CCYY.
   353                 24  HOLD-CEN-1-R-CC   PIC 99.
   354                 24  HOLD-CEN-1-R-YY   PIC 99.
   355             20  FILLER                PIC 9(3).
   356         16  HOLD-CENTURY-1-X.
   357             20  FILLER                PIC X(3)  VALUE SPACES.
   358             20  HOLD-CEN-1-X-CCYY.
   359                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   360                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   361             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   8
* NSRLTRBL.cbl
   362             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   363         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   364             20  HOLD-CEN-1-R-X-MO     PIC XX.
   365             20  HOLD-CEN-1-R-X-DA     PIC XX.
   366             20  HOLD-CEN-1-R-X-CCYY.
   367                 24  HOLD-CEN-1-R-X-CC PIC XX.
   368                 24  HOLD-CEN-1-R-X-YY PIC XX.
   369             20  FILLER                PIC XXX.
   370         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   371         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   372         16  DC-JULIAN-DATE-1          PIC 9(07).
   373         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   374             20  DC-JULIAN-1-CCYY.
   375                 24  DC-JULIAN-1-CC    PIC 99.
   376                 24  DC-JULIAN-1-YR    PIC 99.
   377             20  DC-JULIAN-DA-1        PIC 999.
   378         16  DC-JULIAN-DATE-2          PIC 9(07).
   379         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   380             20  DC-JULIAN-2-CCYY.
   381                 24  DC-JULIAN-2-CC    PIC 99.
   382                 24  DC-JULIAN-2-YR    PIC 99.
   383             20  DC-JULIAN-DA-2        PIC 999.
   384         16  DC-GREG-DATE-A-EDIT.
   385             20  DC-EDITA-MONTH        PIC 99.
   386             20  SLASHA-1              PIC X VALUE '/'.
   387             20  DC-EDITA-DAY          PIC 99.
   388             20  SLASHA-2              PIC X VALUE '/'.
   389             20  DC-EDITA-CCYY.
   390                 24  DC-EDITA-CENT     PIC 99.
   391                 24  DC-EDITA-YEAR     PIC 99.
   392         16  DC-GREG-DATE-B-EDIT.
   393             20  DC-EDITB-MONTH        PIC 99.
   394             20  SLASHB-1              PIC X VALUE '/'.
   395             20  DC-EDITB-DAY          PIC 99.
   396             20  SLASHB-2              PIC X VALUE '/'.
   397             20  DC-EDITB-CCYY.
   398                 24  DC-EDITB-CENT     PIC 99.
   399                 24  DC-EDITB-YEAR     PIC 99.
   400         16  DC-GREG-DATE-CYMD         PIC 9(08).
   401         16  DC-GREG-DATE-CYMD-R REDEFINES
   402                              DC-GREG-DATE-CYMD.
   403             20  DC-CYMD-CEN           PIC 99.
   404             20  DC-CYMD-YEAR          PIC 99.
   405             20  DC-CYMD-MONTH         PIC 99.
   406             20  DC-CYMD-DAY           PIC 99.
   407         16  DC-GREG-DATE-MDCY         PIC 9(08).
   408         16  DC-GREG-DATE-MDCY-R REDEFINES
   409                              DC-GREG-DATE-MDCY.
   410             20  DC-MDCY-MONTH         PIC 99.
   411             20  DC-MDCY-DAY           PIC 99.
   412             20  DC-MDCY-CEN           PIC 99.
   413             20  DC-MDCY-YEAR          PIC 99.
   414    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   415        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   416    12  DC-EL310-DATE                  PIC X(21).
   417    12  FILLER                         PIC X(28).
   418*                                COPY ELCMSTR.
   419******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page   9
* NSRLTRBL.cbl
   420*                                                                *
   421*                            ELCMSTR.                            *
   422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   423*                            VMOD=2.012                          *
   424*                                                                *
   425*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   426*                                                                *
   427*   FILE TYPE = VSAM,KSDS                                        *
   428*   RECORD SIZE = 350  RECFORM = FIXED                           *
   429*                                                                *
   430*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   431*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   432*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   433*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   434*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   435*                                                 RKP=75,LEN=21  *
   436*                                                                *
   437*   **** NOTE ****                                               *
   438*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   439*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   440*                                                                *
   441*   LOG = YES                                                    *
   442*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   443******************************************************************
   444*                   C H A N G E   L O G
   445*
   446* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   447*-----------------------------------------------------------------
   448*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   449* EFFECTIVE    NUMBER
   450*-----------------------------------------------------------------
   451* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   452* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   453* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   454* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   455* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   456******************************************************************
   457 01  CLAIM-MASTER.
   458     12  CL-RECORD-ID                PIC XX.
   459         88  VALID-CL-ID         VALUE 'CL'.
   460
   461     12  CL-CONTROL-PRIMARY.
   462         16  CL-COMPANY-CD           PIC X.
   463         16  CL-CARRIER              PIC X.
   464         16  CL-CLAIM-NO             PIC X(7).
   465         16  CL-CERT-NO.
   466             20  CL-CERT-PRIME       PIC X(10).
   467             20  CL-CERT-SFX         PIC X.
   468
   469     12  CL-CONTROL-BY-NAME.
   470         16  CL-COMPANY-CD-A1        PIC X.
   471         16  CL-INSURED-LAST-NAME    PIC X(15).
   472         16  CL-INSURED-NAME.
   473             20  CL-INSURED-1ST-NAME PIC X(12).
   474             20  CL-INSURED-MID-INIT PIC X.
   475
   476     12  CL-CONTROL-BY-SSN.
   477         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  10
* NSRLTRBL.cbl
   478         16  CL-SOC-SEC-NO.
   479             20  CL-SSN-STATE        PIC XX.
   480             20  CL-SSN-ACCOUNT      PIC X(6).
   481             20  CL-SSN-LN3          PIC X(3).
   482
   483     12  CL-CONTROL-BY-CERT-NO.
   484         16  CL-COMPANY-CD-A4        PIC X.
   485         16  CL-CERT-NO-A4.
   486             20  CL-CERT-A4-PRIME    PIC X(10).
   487             20  CL-CERT-A4-SFX      PIC X.
   488
   489     12  CL-CONTROL-BY-CCN.
   490         16  CL-COMPANY-CD-A5        PIC X.
   491         16  CL-CCN-A5.
   492             20  CL-CCN.
   493                 24  CL-CCN-PREFIX-A5 PIC X(4).
   494                 24  CL-CCN-PRIME-A5 PIC X(12).
   495             20  CL-CCN-FILLER-A5    PIC X(4).
   496
   497     12  CL-INSURED-PROFILE-DATA.
   498         16  CL-INSURED-BIRTH-DT     PIC XX.
   499         16  CL-INSURED-SEX-CD       PIC X.
   500             88  INSURED-IS-MALE        VALUE 'M'.
   501             88  INSURED-IS-FEMALE      VALUE 'F'.
   502             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   503         16  CL-INSURED-OCC-CD       PIC X(6).
   504         16  FILLER                  PIC X(5).
   505
   506     12  CL-PROCESSING-INFO.
   507         16  CL-PROCESSOR-ID         PIC X(4).
   508         16  CL-CLAIM-STATUS         PIC X.
   509             88  CLAIM-IS-OPEN          VALUE 'O'.
   510             88  CLAIM-IS-CLOSED        VALUE 'C'.
   511         16  CL-CLAIM-TYPE           PIC X.
   512*            88  AH-CLAIM               VALUE 'A'.
   513*            88  LIFE-CLAIM             VALUE 'L'.
   514*            88  PROPERTY-CLAIM         VALUE 'P'.
   515*            88  IUI-CLAIM              VALUE 'I'.
   516*            88  GAP-CLAIM              VALUE 'G'.
   517*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   518         16  CL-CLAIM-PREM-TYPE      PIC X.
   519             88  SINGLE-PREMIUM         VALUE '1'.
   520             88  O-B-COVERAGE           VALUE '2'.
   521             88  OPEN-END-COVERAGE      VALUE '3'.
   522         16  CL-INCURRED-DT          PIC XX.
   523         16  CL-REPORTED-DT          PIC XX.
   524         16  CL-FILE-ESTABLISH-DT    PIC XX.
   525         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   526         16  CL-LAST-PMT-DT          PIC XX.
   527         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   528         16  CL-PAID-THRU-DT         PIC XX.
   529         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   530         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   531         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   532         16  CL-PMT-CALC-METHOD      PIC X.
   533             88  CL-360-DAY-YR          VALUE '1'.
   534             88  CL-365-DAY-YR          VALUE '2'.
   535             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  11
* NSRLTRBL.cbl
   536         16  CL-CAUSE-CD             PIC X(6).
   537
   538         16  CL-PRIME-CERT-NO.
   539             20  CL-PRIME-CERT-PRIME PIC X(10).
   540             20  CL-PRIME-CERT-SFX   PIC X.
   541
   542         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   543             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   544             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   545
   546         16  CL-MICROFILM-NO         PIC X(10).
   547         16  FILLER REDEFINES CL-MICROFILM-NO.
   548             20  CL-BENEFIT-PERIOD   PIC 99.
   549             20  FILLER              PIC X(8).
   550         16  CL-PROG-FORM-TYPE       PIC X.
   551         16  CL-LAST-ADD-ON-DT       PIC XX.
   552
   553         16  CL-LAST-REOPEN-DT       PIC XX.
   554         16  CL-LAST-CLOSE-DT        PIC XX.
   555         16  CL-LAST-CLOSE-REASON    PIC X(01).
   556             88  FINAL-PAID             VALUE '1'.
   557             88  CLAIM-DENIED           VALUE '2'.
   558             88  AUTO-CLOSE             VALUE '3'.
   559             88  MANUAL-CLOSE           VALUE '4'.
   560             88  BENEFITS-CHANGED       VALUE 'C'.
   561             88  SETUP-ERRORS           VALUE 'E'.
   562         16  CL-ASSOC-CERT-SEQU      PIC S99.
   563         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   564         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   565             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   566         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   567         16  FILLER                  PIC X.
   568
   569     12  CL-CERTIFICATE-DATA.
   570         16  CL-CERT-ORIGIN          PIC X.
   571             88  CERT-WAS-ONLINE        VALUE '1'.
   572             88  CERT-WAS-CREATED       VALUE '2'.
   573             88  COVERAGE-WAS-ADDED     VALUE '3'.
   574         16  CL-CERT-KEY-DATA.
   575             20  CL-CERT-CARRIER     PIC X.
   576             20  CL-CERT-GROUPING    PIC X(6).
   577             20  CL-CERT-STATE       PIC XX.
   578             20  CL-CERT-ACCOUNT.
   579                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   580                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   581             20  CL-CERT-EFF-DT      PIC XX.
   582
   583     12  CL-STATUS-CONTROLS.
   584         16  CL-PRIORITY-CD          PIC X.
   585             88  CONFIDENTIAL-DATA      VALUE '8'.
   586             88  HIGHEST-PRIORITY       VALUE '9'.
   587         16  CL-SUPV-ATTN-CD         PIC X.
   588             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   589             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   590         16  CL-PURGED-DT            PIC XX.
   591         16  CL-RESTORED-DT          PIC XX.
   592         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   593         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  12
* NSRLTRBL.cbl
   594         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   595         16  CL-CRITICAL-PERIOD      PIC 99.
   596*        16  FILLER                  PIC XX.
   597         16  CL-LAST-MAINT-DT        PIC XX.
   598         16  CL-LAST-MAINT-USER      PIC X(4).
   599         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   600         16  CL-LAST-MAINT-TYPE      PIC X.
   601             88  CLAIM-SET-UP           VALUE ' '.
   602             88  PAYMENT-MADE           VALUE '1'.
   603             88  LETTER-SENT            VALUE '2'.
   604             88  MASTER-WAS-ALTERED     VALUE '3'.
   605             88  MASTER-WAS-RESTORED    VALUE '4'.
   606             88  INCURRED-DATE-CHANGED  VALUE '5'.
   607             88  FILE-CONVERTED         VALUE '6'.
   608             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   609             88  ERROR-CORRECTION       VALUE 'E'.
   610         16  CL-RELATED-CLAIM-NO     PIC X(7).
   611         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   612         16  CL-BENEFICIARY          PIC X(10).
   613         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   614         16  CL-DENIAL-TYPE          PIC X.
   615             88  CL-TYPE-DENIAL          VALUE '1'.
   616             88  CL-TYPE-RESCISSION      VALUE '2'.
   617             88  CL-TYPE-REFORMATION     VALUE '3'.
   618             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   619             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   620         16  filler                  pic x(5).
   621*        16  CL-CRIT-PER-RECURRENT   PIC X.
   622*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   623*        16  CL-RTW-DT               PIC XX.
   624
   625     12  CL-TRAILER-CONTROLS.
   626         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   627             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   628             88  CL-LAST-TRL-AVAIL      VALUE +100.
   629             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   630         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   631         16  FILLER                  PIC XX.
   632         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   633         16  CL-ADDRESS-TRAILER-CNT.
   634             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   635                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   636             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   637                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   638             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   639                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   640             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   641                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   642             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   643                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   644             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   645                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   646             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   647                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   648
   649     12  CL-CV-REFERENCE-NO.
   650         16  CL-CV-REFNO-PRIME       PIC X(18).
   651         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  13
* NSRLTRBL.cbl
   652
   653     12  CL-FILE-LOCATION            PIC X(4).
   654
   655     12  CL-PROCESS-ERRORS.
   656         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   657             88  NO-FATAL-ERRORS        VALUE ZERO.
   658         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   659             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   660
   661     12  CL-PRODUCT-CD               PIC X.
   662
   663     12  CL-CURRENT-KEY-DATA.
   664         16  CL-CURRENT-CARRIER      PIC X.
   665         16  CL-CURRENT-GROUPING     PIC X(6).
   666         16  CL-CURRENT-STATE        PIC XX.
   667         16  CL-CURRENT-ACCOUNT      PIC X(10).
   668
   669     12  CL-ASSOCIATES               PIC X.
   670         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   671         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   672         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   673         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   674
   675     12  CL-ACTIVITY-CODE            PIC 99.
   676     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   677     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   678
   679     12  CL-LAPSE-REPORT-CODE        PIC 9.
   680     12  CL-LAG-REPORT-CODE          PIC 9.
   681     12  CL-LOAN-TYPE                PIC XX.
   682     12  CL-LEGAL-STATE              PIC XX.
   683
   684     12  CL-YESNOSW                  PIC X.
   685     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   686         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   687         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   688         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   689     12  cl-insured-type             pic x.
   690         88  cl-claim-on-primary         value 'P'.
   691         88  cl-claim-on-co-borrower     value 'C'.
   692     12  cl-benefit-expiration-dt    PIC XX.
   693*                                COPY ELCTRLR.
   694******************************************************************
   695*                                                                *
   696*                            ELCTRLR.                            *
   697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   698*                            VMOD=2.014                          *
   699*                                                                *
   700*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   701*                                                                *
   702*   FILE TYPE = VSAM,KSDS                                        *
   703*   RECORD SIZE = 200    RECFORM = FIXED                         *
   704*                                                                *
   705*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   706*       ALTERNATE INDEX = NONE                                   *
   707*                                                                *
   708*   LOG = YES                                                    *
   709*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  14
* NSRLTRBL.cbl
   710******************************************************************
   711*                   C H A N G E   L O G
   712*
   713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   714*-----------------------------------------------------------------
   715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   716* EFFECTIVE    NUMBER
   717*-----------------------------------------------------------------
   718* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   719* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   720* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   721* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   722* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   723* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   724* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   725* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   726* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   727* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   728* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   729* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   730* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   731* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   732* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   733* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   734* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   735* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   736* 040814    2014030500002  AJRA  ADD ICD CODES
   737* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   738******************************************************************
   739 01  ACTIVITY-TRAILERS.
   740     12  AT-RECORD-ID                    PIC XX.
   741         88  VALID-AT-ID                       VALUE 'AT'.
   742
   743     12  AT-CONTROL-PRIMARY.
   744         16  AT-COMPANY-CD               PIC X.
   745         16  AT-CARRIER                  PIC X.
   746         16  AT-CLAIM-NO                 PIC X(7).
   747         16  AT-CERT-NO.
   748             20  AT-CERT-PRIME           PIC X(10).
   749             20  AT-CERT-SFX             PIC X.
   750         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   751             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   752             88  AT-LAST-TRL-AVAIL            VALUE +100.
   753             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   754             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   755             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
   756             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
   757             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
   758             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   759             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
   760             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   761             88  AT-DIAGNOSIS-TRL             VALUE +90.
   762             88  AT-BENEFICIARY-TRL           VALUE +91.
   763             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   764             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   765             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   766             88  AT-ERROR-MSGS-TRL            VALUE +95.
   767
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  15
* NSRLTRBL.cbl
   768     12  AT-TRAILER-TYPE                 PIC X.
   769         88  RESERVE-EXPENSE-TR               VALUE '1'.
   770         88  PAYMENT-TR                       VALUE '2'.
   771         88  AUTO-PAY-TR                      VALUE '3'.
   772         88  CORRESPONDENCE-TR                VALUE '4'.
   773         88  ADDRESS-TR                       VALUE '5'.
   774         88  GENERAL-INFO-TR                  VALUE '6'.
   775         88  AUTO-PROMPT-TR                   VALUE '7'.
   776         88  DENIAL-TR                        VALUE '8'.
   777         88  INCURRED-CHG-TR                  VALUE '9'.
   778         88  FORM-CONTROL-TR                  VALUE 'A'.
   779
   780     12  AT-RECORDED-DT                  PIC XX.
   781     12  AT-RECORDED-BY                  PIC X(4).
   782     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   783
   784     12  AT-TRAILER-BODY                 PIC X(165).
   785
   786     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   787         16  AT-RESERVE-CONTROLS.
   788             20  AT-MANUAL-SW            PIC X.
   789                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   790             20  AT-FUTURE-SW            PIC X.
   791                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   792             20  AT-PTC-SW               PIC X.
   793                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   794             20  AT-IBNR-SW              PIC X.
   795                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   796             20  AT-PTC-LF-SW            PIC X.
   797                 88  AT-LF-PTC-USED          VALUE '1'.
   798             20  AT-CDT-ACCESS-METHOD    PIC X.
   799                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   800                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   801                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   802             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   803         16  AT-LAST-COMPUTED-DT         PIC XX.
   804         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   805         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   806         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   807         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   808         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   809         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   810         16  AT-EXPENSE-CONTROLS.
   811             20  AT-EXPENSE-METHOD       PIC X.
   812                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   813                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
   814                 88  PERCENT-OF-PMT           VALUE '3'.
   815                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
   816             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   817             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
   818         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   819         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   820
   821         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   822         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   823
   824*        16  FILLER                      PIC X(53).
   825         16  FILLER                      PIC X(47).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  16
* NSRLTRBL.cbl
   826
   827         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   828         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   829
   830         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   831             20  AT-OPEN-CLOSE-DATE      PIC XX.
   832             20  AT-OPEN-CLOSE-TYPE      PIC X.
   833*                    C = CLOSED
   834*                    O = OPEN
   835             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   836*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   837
   838     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   839         16  AT-PAYMENT-TYPE             PIC X.
   840             88  PARTIAL-PAYMENT                VALUE '1'.
   841             88  FINAL-PAYMENT                  VALUE '2'.
   842             88  LUMP-SUM-PAYMENT               VALUE '3'.
   843             88  ADDITIONAL-PAYMENT             VALUE '4'.
   844             88  CHARGEABLE-EXPENSE             VALUE '5'.
   845             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   846             88  VOIDED-PAYMENT                 VALUE '9'.
   847             88  TRANSFER                       VALUE 'T'.
   848             88  LIFE-INTEREST                  VALUE 'I'.
   849
   850         16  AT-CLAIM-TYPE               PIC X.
   851             88  PAID-FOR-AH                    VALUE 'A'.
   852             88  PAID-FOR-LIFE                  VALUE 'L'.
   853             88  PAID-FOR-IUI                   VALUE 'I'.
   854             88  PAID-FOR-GAP                   VALUE 'G'.
   855             88  PAID-FOR-FAM                   VALUE 'F'.
   856         16  AT-CLAIM-PREM-TYPE          PIC X.
   857             88  AT-SINGLE-PREMIUM              VALUE '1'.
   858             88  AT-O-B-COVERAGE                VALUE '2'.
   859             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   860         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   861         16  AT-CHECK-NO                 PIC X(7).
   862         16  AT-PAID-FROM-DT             PIC XX.
   863         16  AT-PAID-THRU-DT             PIC XX.
   864         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   865         16  FILLER                      PIC X.
   866         16  AT-PAYEES-NAME              PIC X(30).
   867         16  AT-PAYMENT-ORIGIN           PIC X.
   868             88  ONLINE-MANUAL-PMT              VALUE '1'.
   869             88  ONLINE-AUTO-PMT                VALUE '2'.
   870             88  OFFLINE-PMT                    VALUE '3'.
   871         16  AT-CHECK-WRITTEN-DT         PIC XX.
   872         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   873         16  AT-VOID-DATA.
   874             20  AT-VOID-DT              PIC XX.
   875*00144       20  AT-VOID-REASON          PIC X(30).
   876             20  AT-VOID-REASON          PIC X(26).
   877         16  AT-PMT-APPROVED-BY          PIC X(04).
   878         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   879         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   880         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   881                                         PIC S99V9(5)  COMP-3.
   882         16  AT-CREDIT-INTERFACE.
   883             20  AT-PMT-SELECT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  17
* NSRLTRBL.cbl
   884                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   885             20  AT-PMT-ACCEPT-DT        PIC XX.
   886                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   887             20  AT-VOID-SELECT-DT       PIC XX.
   888                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   889             20  AT-VOID-ACCEPT-DT       PIC XX.
   890                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   891
   892         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   893                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   894                 88  CONVERSION-PAYMENT           VALUE +99999999.
   895         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   896
   897         16  AT-FORCE-CONTROL            PIC X.
   898             88  PAYMENT-WAS-FORCED           VALUE '1'.
   899         16  AT-PREV-LAST-PMT-DT         PIC XX.
   900         16  AT-PREV-PAID-THRU-DT        PIC XX.
   901         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   902         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   903         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   904         16  AT-BENEFIT-TYPE             PIC X.
   905
   906         16  AT-EXPENSE-TYPE             PIC X.
   907         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   908
   909         16  AT-PAYEE-TYPE-CD.
   910             20  AT-PAYEE-TYPE           PIC X.
   911                 88  INSURED-PAID           VALUE 'I'.
   912                 88  BENEFICIARY-PAID       VALUE 'B'.
   913                 88  ACCOUNT-PAID           VALUE 'A'.
   914                 88  OTHER-1-PAID           VALUE 'O'.
   915                 88  OTHER-2-PAID           VALUE 'Q'.
   916                 88  DOCTOR-PAID            VALUE 'P'.
   917                 88  EMPLOYER-PAID          VALUE 'E'.
   918             20  AT-PAYEE-SEQ            PIC X.
   919
   920         16  AT-CASH-PAYMENT             PIC X.
   921         16  AT-GROUPED-PAYMENT          PIC X.
   922         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   923         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   924         16  AT-APPROVED-LEVEL           PIC X.
   925         16  AT-VOID-TYPE                PIC X.
   926             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   927             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
   928         16  AT-AIG-UNEMP-IND            PIC X.
   929             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
   930         16  AT-ASSOCIATES               PIC X.
   931             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
   932             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   933
   934         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   935         16  AT-CV-PMT-CODE              PIC X.
   936             88  FULL-DEATH-PAYMENT         VALUE '1'.
   937             88  HALF-DEATH-PAYMENT         VALUE '2'.
   938             88  FULL-ADD-PAYMENT           VALUE '3'.
   939             88  HALF-ADD-PAYMENT           VALUE '4'.
   940             88  FULL-RIDER-PAYMENT         VALUE '5'.
   941             88  HALF-RIDER-PAYMENT         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  18
* NSRLTRBL.cbl
   942             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   943             88  ADDL-PAYMENT               VALUE '8'.
   944
   945         16  AT-EOB-CODE1                PIC XXX.
   946         16  AT-EOB-CODE2                PIC XXX.
   947         16  AT-EOB-CODE3                PIC XXX.
   948         16  FILLER REDEFINES AT-EOB-CODE3.
   949             20  AT-PRINT-CLM-FORM       PIC X.
   950             20  AT-PRINT-SURVEY         PIC X.
   951             20  AT-SPECIAL-RELEASE      PIC X.
   952         16  AT-EOB-CODE4                PIC XXX.
   953         16  FILLER REDEFINES AT-EOB-CODE4.
   954             20  AT-INT-PMT-SELECT-DT    PIC XX.
   955             20  FILLER                  PIC X.
   956         16  AT-EOB-CODE5                PIC XXX.
   957         16  FILLER REDEFINES AT-EOB-CODE5.
   958             20  AT-PMT-PROOF-DT         PIC XX.
   959             20  FILLER                  PIC X.
   960
   961         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   962             88  AT-PRINT-EOB            VALUE 'Y'.
   963
   964         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   965         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   966
   967     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   968         16  AT-SCHEDULE-START-DT        PIC XX.
   969         16  AT-SCHEDULE-END-DT          PIC XX.
   970         16  AT-TERMINATED-DT            PIC XX.
   971         16  AT-LAST-PMT-TYPE            PIC X.
   972             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   973             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   974         16  AT-FIRST-PMT-DATA.
   975             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   976             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   977             20  AT-1ST-PAY-THRU-DT      PIC XX.
   978         16  AT-REGULAR-PMT-DATA.
   979             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   980             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   981             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   982         16  AT-AUTO-PAYEE-CD.
   983             20  AT-AUTO-PAYEE-TYPE      PIC X.
   984                 88  INSURED-PAID-AUTO      VALUE 'I'.
   985                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
   986                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
   987                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
   988                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
   989             20  AT-AUTO-PAYEE-SEQ       PIC X.
   990         16  AT-AUTO-PAY-DAY             PIC 99.
   991         16  AT-AUTO-CASH                PIC X.
   992             88  AT-CASH                      VALUE 'Y'.
   993             88  AT-NON-CASH                  VALUE 'N'.
   994*        16  FILLER                      PIC X(129).
   995         16  AT-AUTO-END-LETTER          PIC X(4).
   996         16  FILLER                      PIC X(125).
   997
   998         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
   999         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  19
* NSRLTRBL.cbl
  1000
  1001     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1002         16  AT-LETTER-SENT-DT           PIC XX.
  1003         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1004         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1005         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1006         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1007         16  AT-LETTER-ORIGIN            PIC X.
  1008             88  ONLINE-CREATION              VALUE '1' '3'.
  1009             88  OFFLINE-CREATION             VALUE '2' '4'.
  1010             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1011             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1012         16  AT-STD-LETTER-FORM          PIC X(4).
  1013         16  AT-REASON-TEXT              PIC X(70).
  1014         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1015         16  AT-ADDRESEE-TYPE            PIC X.
  1016              88  INSURED-ADDRESEE            VALUE 'I'.
  1017              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1018              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1019              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1020              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1021              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1022              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1023         16  AT-ADDRESSEE-NAME           PIC X(30).
  1024         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1025         16  AT-RESEND-PRINT-DATE        PIC XX.
  1026         16  AT-CORR-SOL-UNSOL           PIC X.
  1027         16  AT-LETTER-PURGED-DT         PIC XX.
  1028*
  1029*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1030*
  1031         16  AT-CSO-REDEFINITION.
  1032             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1033             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1034             20  AT-LETTER-TO-BENE       PIC X(1).
  1035             20  AT-STOP-LETTER-DT       PIC X(2).
  1036             20  FILLER                  PIC X(19).
  1037*             20  FILLER                  PIC X(27).
  1038             20  AT-CSO-LETTER-STATUS    PIC X.
  1039                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1040                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1041                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1042             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1043             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1044*
  1045*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1046*
  1047*        16  FILLER                      PIC X(26).
  1048*
  1049*        16  AT-DMD-BSR-CODE             PIC X.
  1050*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1051*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1052*
  1053*        16  AT-DMD-LETTER-STATUS        PIC X.
  1054*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1055*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1056*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1057*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  20
* NSRLTRBL.cbl
  1058*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1059
  1060         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1061         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1062
  1063     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1064         16  AT-ADDRESS-TYPE             PIC X.
  1065             88  INSURED-ADDRESS               VALUE 'I'.
  1066             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1067             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1068             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1069             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1070             88  OTHER-ADDRESS-1               VALUE 'O'.
  1071             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1072         16  AT-MAIL-TO-NAME             PIC X(30).
  1073         16  AT-ADDRESS-LINE-1           PIC X(30).
  1074         16  AT-ADDRESS-LINE-2           PIC X(30).
  1075         16  AT-CITY-STATE.
  1076             20  AT-CITY                 PIC X(28).
  1077             20  AT-STATE                PIC XX.
  1078         16  AT-ZIP.
  1079             20  AT-ZIP-CODE.
  1080                 24  AT-ZIP-1ST          PIC X.
  1081                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1082                 24  FILLER              PIC X(4).
  1083             20  AT-ZIP-PLUS4            PIC X(4).
  1084         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1085             20  AT-CAN-POSTAL-1         PIC XXX.
  1086             20  AT-CAN-POSTAL-2         PIC XXX.
  1087             20  FILLER                  PIC XXX.
  1088         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1089*         16  FILLER                      PIC X(23).
  1090         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1091         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1092         16  FILLER                      PIC X(13).
  1093         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1094         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1095
  1096     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1097         16  AT-INFO-LINE-1              PIC X(60).
  1098         16  FILLER REDEFINES AT-INFO-LINE-1.
  1099             20  AT-NOTE-ERROR-NO OCCURS 15
  1100                                         PIC X(4).
  1101         16  AT-INFO-LINE-2              PIC X(60).
  1102         16  FILLER REDEFINES AT-INFO-LINE-2.
  1103             20  AT-ICD-CODE-1           PIC X(8).
  1104             20  AT-ICD-CODE-2           PIC X(8).
  1105             20  FILLER                  PIC X(44).
  1106         16  AT-INFO-TRAILER-TYPE        PIC X.
  1107             88  AT-ERRORS-NOTE          VALUE 'E'.
  1108             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1109             88  AT-CALL-NOTE            VALUE 'C'.
  1110             88  AT-MAINT-NOTE           VALUE 'M'.
  1111             88  AT-CERT-CHANGE          VALUE 'X'.
  1112             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1113             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1114             88  AT-CERT-CANCELLED       VALUE 'T'.
  1115         16  AT-CALL-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  21
* NSRLTRBL.cbl
  1116             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1117             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1118         16  AT-NOTE-CONTINUATION        PIC X.
  1119             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1120         16  AT-EOB-CODES-EXIST          PIC X.
  1121             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1122         16  FILLER                      PIC X(35).
  1123         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1124         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1125
  1126     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1127         16  AT-PROMPT-LINE-1            PIC X(60).
  1128         16  AT-PROMPT-LINE-2            PIC X(60).
  1129         16  AT-PROMPT-START-DT          PIC XX.
  1130         16  AT-PROMPT-END-DT            PIC XX.
  1131         16  FILLER                      PIC X(35).
  1132         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1133         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1134
  1135     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1136         16  AT-DENIAL-INFO-1            PIC X(60).
  1137         16  AT-DENIAL-INFO-2            PIC X(60).
  1138         16  AT-DENIAL-DT                PIC XX.
  1139         16  AT-RETRACTION-DT            PIC XX.
  1140         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1141*         16  FILLER                      PIC X(31).
  1142         16  AT-DENIAL-PROOF-DT          PIC XX.
  1143         16  FILLER                      PIC X(29).
  1144         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1145         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1146
  1147     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1148         16  AT-OLD-INCURRED-DT          PIC XX.
  1149         16  AT-OLD-REPORTED-DT          PIC XX.
  1150         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1151         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1152         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1153         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1154         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1155         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1156         16  FILLER                      PIC X(26).
  1157         16  AT-OLD-DIAG-CODE            PIC X(6).
  1158         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1159         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1160         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1161         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1162         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1163         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1164         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1165         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1166         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1167         16  FILLER                      PIC X(9).
  1168         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1169
  1170     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1171         16  AT-FORM-SEND-ON-DT          PIC XX.
  1172         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1173         16  AT-FORM-RE-SEND-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  22
* NSRLTRBL.cbl
  1174         16  AT-FORM-ANSWERED-DT         PIC XX.
  1175         16  AT-FORM-PRINTED-DT          PIC XX.
  1176         16  AT-FORM-REPRINT-DT          PIC XX.
  1177         16  AT-FORM-TYPE                PIC X.
  1178             88  INITIAL-FORM                  VALUE '1'.
  1179             88  PROGRESS-FORM                 VALUE '2'.
  1180         16  AT-INSTRUCT-LN-1            PIC X(28).
  1181         16  AT-INSTRUCT-LN-2            PIC X(28).
  1182         16  AT-INSTRUCT-LN-3            PIC X(28).
  1183         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1184         16  AT-FORM-ADDRESS             PIC X.
  1185             88  FORM-TO-INSURED              VALUE 'I'.
  1186             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1187             88  FORM-TO-OTHER-1              VALUE 'O'.
  1188             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1189         16  AT-RELATED-1.
  1190             20 AT-REL-CARR-1            PIC X.
  1191             20 AT-REL-CLAIM-1           PIC X(7).
  1192             20 AT-REL-CERT-1            PIC X(11).
  1193         16  AT-RELATED-2.
  1194             20 AT-REL-CARR-2            PIC X.
  1195             20 AT-REL-CLAIM-2           PIC X(7).
  1196             20 AT-REL-CERT-2            PIC X(11).
  1197         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1198         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1199         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1200         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1201         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1202         16  AT-STOP-FORM-DT             PIC X(2).
  1203
  1204         16  FILLER                      PIC X(09).
  1205         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1206         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1207******************************************************************
  1208*                                COPY ELCCERT.
  1209******************************************************************
  1210*                                                                *
  1211*                            ELCCERT.                            *
  1212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1213*                            VMOD=2.013                          *
  1214*                                                                *
  1215*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1216*                                                                *
  1217*   FILE TYPE = VSAM,KSDS                                        *
  1218*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1219*                                                                *
  1220*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1221*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1222*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1223*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1224*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1225*                                                                *
  1226*   LOG = YES                                                    *
  1227*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1228******************************************************************
  1229*                   C H A N G E   L O G
  1230*
  1231* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  23
* NSRLTRBL.cbl
  1232*-----------------------------------------------------------------
  1233*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1234* EFFECTIVE    NUMBER
  1235*-----------------------------------------------------------------
  1236* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1237* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1238* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1239* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1240* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1241* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1242* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1243* 032612  CR2011110200001  PEMA  AHL CHANGES
  1244* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1245* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1246******************************************************************
  1247
  1248 01  CERTIFICATE-MASTER.
  1249     12  CM-RECORD-ID                      PIC XX.
  1250         88  VALID-CM-ID                      VALUE 'CM'.
  1251
  1252     12  CM-CONTROL-PRIMARY.
  1253         16  CM-COMPANY-CD                 PIC X.
  1254         16  CM-CARRIER                    PIC X.
  1255         16  CM-GROUPING.
  1256             20  CM-GROUPING-PREFIX        PIC X(3).
  1257             20  CM-GROUPING-PRIME         PIC X(3).
  1258         16  CM-STATE                      PIC XX.
  1259         16  CM-ACCOUNT.
  1260             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1261             20  CM-ACCOUNT-PRIME          PIC X(6).
  1262         16  CM-CERT-EFF-DT                PIC XX.
  1263         16  CM-CERT-NO.
  1264             20  CM-CERT-PRIME             PIC X(10).
  1265             20  CM-CERT-SFX               PIC X.
  1266
  1267     12  CM-CONTROL-BY-NAME.
  1268         16  CM-COMPANY-CD-A1              PIC X.
  1269         16  CM-INSURED-LAST-NAME          PIC X(15).
  1270         16  CM-INSURED-INITIALS.
  1271             20  CM-INSURED-INITIAL1       PIC X.
  1272             20  CM-INSURED-INITIAL2       PIC X.
  1273
  1274     12  CM-CONTROL-BY-SSN.
  1275         16  CM-COMPANY-CD-A2              PIC X.
  1276         16  CM-SOC-SEC-NO.
  1277             20  CM-SSN-STATE              PIC XX.
  1278             20  CM-SSN-ACCOUNT            PIC X(6).
  1279             20  CM-SSN-LN3.
  1280                 25  CM-INSURED-INITIALS-A2.
  1281                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1282                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1283                 25 CM-PART-LAST-NAME-A2         PIC X.
  1284
  1285     12  CM-CONTROL-BY-CERT-NO.
  1286         16  CM-COMPANY-CD-A4              PIC X.
  1287         16  CM-CERT-NO-A4                 PIC X(11).
  1288
  1289     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  24
* NSRLTRBL.cbl
  1290         16  CM-COMPANY-CD-A5              PIC X.
  1291         16  CM-MEMBER-NO.
  1292             20  CM-MEMB-STATE             PIC XX.
  1293             20  CM-MEMB-ACCOUNT           PIC X(6).
  1294             20  CM-MEMB-LN4.
  1295                 25  CM-INSURED-INITIALS-A5.
  1296                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1297                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1298                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1299
  1300     12  CM-INSURED-PROFILE-DATA.
  1301         16  CM-INSURED-FIRST-NAME.
  1302             20  CM-INSURED-1ST-INIT       PIC X.
  1303             20  FILLER                    PIC X(9).
  1304         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1305         16  CM-INSURED-SEX                PIC X.
  1306             88  CM-SEX-MALE                  VALUE 'M'.
  1307             88  CM-SEX-FEMAL                 VALUE 'F'.
  1308         16  CM-INSURED-JOINT-AGE          PIC 99.
  1309         16  CM-JOINT-INSURED-NAME.
  1310             20  CM-JT-LAST-NAME           PIC X(15).
  1311             20  CM-JT-FIRST-NAME.
  1312                 24  CM-JT-1ST-INIT        PIC X.
  1313                 24  FILLER                PIC X(9).
  1314             20  CM-JT-INITIAL             PIC X.
  1315
  1316     12  CM-LIFE-DATA.
  1317         16  CM-LF-BENEFIT-CD              PIC XX.
  1318         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1319         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1320         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1321         16  CM-LF-DEV-CODE                PIC XXX.
  1322         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1323         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1324         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1325         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1326         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1327         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1328         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1329         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1330         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1331         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1332         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1333         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1334         16  cm-temp-epiq                  pic xx.
  1335             88  EPIQ-CLASS                  value 'EQ'.
  1336*        16  FILLER                        PIC XX.
  1337
  1338     12  CM-AH-DATA.
  1339         16  CM-AH-BENEFIT-CD              PIC XX.
  1340         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1341         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1342         16  CM-AH-DEV-CODE                PIC XXX.
  1343         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1344         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1345         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1346         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1347         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  25
* NSRLTRBL.cbl
  1348         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1349         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1350         16  CM-AH-PAID-THRU-DT            PIC XX.
  1351             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1352         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1353         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1354         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1355         16  FILLER                        PIC X.
  1356
  1357     12  CM-LOAN-INFORMATION.
  1358         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1359         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1360                                           PIC S9(5)V99  COMP-3.
  1361         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1362         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1363         16  CM-PAY-FREQUENCY              PIC S99.
  1364         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1365         16  CM-RATE-CLASS                 PIC XX.
  1366         16  CM-BENEFICIARY                PIC X(25).
  1367         16  CM-POLICY-FORM-NO             PIC X(12).
  1368         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1369         16  CM-LAST-ADD-ON-DT             PIC XX.
  1370         16  CM-DEDUCTIBLE-AMOUNTS.
  1371             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1372             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1373         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1374             20  CM-RESIDENT-STATE         PIC XX.
  1375             20  CM-RATE-CODE              PIC X(4).
  1376             20  FILLER                    PIC XX.
  1377         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1378             20  CM-LOAN-OFFICER           PIC X(5).
  1379             20  FILLER                    PIC XXX.
  1380         16  CM-CSR-CODE                   PIC XXX.
  1381         16  CM-UNDERWRITING-CODE          PIC X.
  1382             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1383         16  CM-POST-CARD-IND              PIC X.
  1384         16  CM-NH-INTERFACE-SW            PIC X.
  1385         16  CM-PREMIUM-TYPE               PIC X.
  1386             88  CM-SING-PRM                  VALUE '1'.
  1387             88  CM-O-B-COVERAGE              VALUE '2'.
  1388             88  CM-OPEN-END                  VALUE '3'.
  1389         16  CM-IND-GRP-TYPE               PIC X.
  1390             88  CM-INDIVIDUAL                VALUE 'I'.
  1391             88  CM-GROUP                     VALUE 'G'.
  1392         16  CM-SKIP-CODE                  PIC X.
  1393             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1394             88  SKIP-JULY                    VALUE '1'.
  1395             88  SKIP-AUGUST                  VALUE '2'.
  1396             88  SKIP-SEPTEMBER               VALUE '3'.
  1397             88  SKIP-JULY-AUG                VALUE '4'.
  1398             88  SKIP-AUG-SEPT                VALUE '5'.
  1399             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1400             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1401             88  SKIP-JUNE                    VALUE '8'.
  1402             88  SKIP-JUNE-JULY               VALUE '9'.
  1403             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1404             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1405         16  CM-PAYMENT-MODE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  26
* NSRLTRBL.cbl
  1406             88  PAY-MONTHLY                  VALUE SPACE.
  1407             88  PAY-WEEKLY                   VALUE '1'.
  1408             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1409             88  PAY-BI-WEEKLY                VALUE '3'.
  1410             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1411         16  CM-LOAN-NUMBER                PIC X(8).
  1412         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1413         16  CM-OLD-LOF                    PIC XXX.
  1414*        16  CM-LOAN-OFFICER               PIC XXX.
  1415         16  CM-REIN-TABLE                 PIC XXX.
  1416         16  CM-SPECIAL-REIN-CODE          PIC X.
  1417         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1418         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1419         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1420
  1421     12  CM-STATUS-DATA.
  1422         16  CM-ENTRY-STATUS               PIC X.
  1423         16  CM-ENTRY-DT                   PIC XX.
  1424
  1425         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1426         16  CM-LF-CANCEL-DT               PIC XX.
  1427         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1428
  1429         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1430         16  CM-LF-DEATH-DT                PIC XX.
  1431         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1432
  1433         16  CM-LF-CURRENT-STATUS          PIC X.
  1434             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1435                                                'M' '4' '5' '9'.
  1436             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1437             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1438             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1439             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1440             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1441             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1442             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1443             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1444             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1445             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1446             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1447             88  CM-LF-DECLINED               VALUE 'D'.
  1448             88  CM-LF-VOIDED                 VALUE 'V'.
  1449
  1450         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1451         16  CM-AH-CANCEL-DT               PIC XX.
  1452         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1453
  1454         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1455         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1456         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1457
  1458         16  CM-AH-CURRENT-STATUS          PIC X.
  1459             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1460                                                'M' '4' '5' '9'.
  1461             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1462             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1463             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  27
* NSRLTRBL.cbl
  1464             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1465             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1466             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1467             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1468             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1469             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1470             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1471             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1472             88  CM-AH-DECLINED               VALUE 'D'.
  1473             88  CM-AH-VOIDED                 VALUE 'V'.
  1474
  1475         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1476             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1477             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1478             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1479         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1480
  1481         16  CM-ENTRY-BATCH                PIC X(6).
  1482         16  CM-LF-EXIT-BATCH              PIC X(6).
  1483         16  CM-AH-EXIT-BATCH              PIC X(6).
  1484         16  CM-LAST-MONTH-END             PIC XX.
  1485
  1486     12  CM-NOTE-SW                        PIC X.
  1487         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1488         88  CERT-NOTES-PRESENT               VALUE '1'.
  1489         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1490         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1491         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1492         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1493         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1494         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1495     12  CM-COMP-EXCP-SW                   PIC X.
  1496         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1497         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1498     12  CM-INSURED-ADDRESS-SW             PIC X.
  1499         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1500         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1501
  1502*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1503     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1504     12  FILLER                            PIC X.
  1505
  1506*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1507     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1508     12  FILLER                            PIC X.
  1509*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1510     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1511
  1512     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1513         88  CERT-ADDED-BATCH                 VALUE ' '.
  1514         88  CERT-ADDED-ONLINE                VALUE '1'.
  1515         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1516         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1517         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1518     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1519         88  CERT-AS-LOADED                   VALUE ' '.
  1520         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1521         88  CERT-CLAIM-ONLINE                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  28
* NSRLTRBL.cbl
  1522         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1523         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1524         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1525         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1526         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1527
  1528     12  CM-ACCOUNT-COMM-PCTS.
  1529         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1530         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1531
  1532     12  CM-USER-FIELD                     PIC X.
  1533     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1534     12  CM-CLP-STATE                      PIC XX.
  1535     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1536     12  CM-USER-RESERVED                  PIC XXX.
  1537     12  FILLER REDEFINES CM-USER-RESERVED.
  1538         16  CM-AH-CLASS-CD                PIC XX.
  1539         16  F                             PIC X.
  1540******************************************************************
  1541*                                COPY ERCACCT.
  1542******************************************************************
  1543*                                                                *
  1544*                                                                *
  1545*                            ERCACCT                             *
  1546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1547*                            VMOD=2.031                          *
  1548*                                                                *
  1549*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1550*                                                                *
  1551*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1552*   VSAM ACCOUNT MASTER FILES.                                   *
  1553*                                                                *
  1554*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1555*                                                                *
  1556*   FILE TYPE = VSAM,KSDS                                        *
  1557*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1558*                                                                *
  1559*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1560*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1561*                                                                *
  1562*   LOG = NO                                                     *
  1563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1564*                                                                *
  1565*                                                                *
  1566******************************************************************
  1567*                   C H A N G E   L O G
  1568*
  1569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1570*-----------------------------------------------------------------
  1571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1572* EFFECTIVE    NUMBER
  1573*-----------------------------------------------------------------
  1574* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1575* 092705    2005050300006  PEMA  ADD SPP LEASES
  1576* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1577* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1578* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1579* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  29
* NSRLTRBL.cbl
  1580* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1581* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1582******************************************************************
  1583
  1584 01  ACCOUNT-MASTER.
  1585     12  AM-RECORD-ID                      PIC XX.
  1586         88  VALID-AM-ID                      VALUE 'AM'.
  1587
  1588     12  AM-CONTROL-PRIMARY.
  1589         16  AM-COMPANY-CD                 PIC X.
  1590         16  AM-MSTR-CNTRL.
  1591             20  AM-CONTROL-A.
  1592                 24  AM-CARRIER            PIC X.
  1593                 24  AM-GROUPING.
  1594                     28 AM-GROUPING-PREFIX PIC XXX.
  1595                     28 AM-GROUPING-PRIME  PIC XXX.
  1596                 24  AM-STATE              PIC XX.
  1597                 24  AM-ACCOUNT.
  1598                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1599                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1600             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1601                                           PIC X(19).
  1602             20  AM-CNTRL-B.
  1603                 24  AM-EXPIRATION-DT      PIC XX.
  1604                 24  FILLER                PIC X(4).
  1605             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1606                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1607
  1608     12  AM-CONTROL-BY-VAR-GRP.
  1609         16  AM-COMPANY-CD-A1              PIC X.
  1610         16  AM-VG-CARRIER                 PIC X.
  1611         16  AM-VG-GROUPING                PIC X(6).
  1612         16  AM-VG-STATE                   PIC XX.
  1613         16  AM-VG-ACCOUNT                 PIC X(10).
  1614         16  AM-VG-DATE.
  1615             20  AM-VG-EXPIRATION-DT       PIC XX.
  1616             20  FILLER                    PIC X(4).
  1617         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1618                                           PIC 9(11)      COMP-3.
  1619     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1620         16  FILLER                        PIC X(10).
  1621         16  AM-VG-KEY3.
  1622             20  AM-VG3-ACCOUNT            PIC X(10).
  1623             20  AM-VG3-EXP-DT             PIC XX.
  1624         16  FILLER                        PIC X(4).
  1625     12  AM-MAINT-INFORMATION.
  1626         16  AM-LAST-MAINT-DT              PIC XX.
  1627         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1628         16  AM-LAST-MAINT-USER            PIC X(4).
  1629         16  FILLER                        PIC XX.
  1630
  1631     12  AM-EFFECTIVE-DT                   PIC XX.
  1632     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1633
  1634     12  AM-PREV-DATES  COMP-3.
  1635         16  AM-PREV-EXP-DT                PIC 9(11).
  1636         16  AM-PREV-EFF-DT                PIC 9(11).
  1637
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  30
* NSRLTRBL.cbl
  1638     12  AM-REPORT-CODE-1                  PIC X(10).
  1639     12  AM-REPORT-CODE-2                  PIC X(10).
  1640
  1641     12  AM-CITY-CODE                      PIC X(4).
  1642     12  AM-COUNTY-PARISH                  PIC X(6).
  1643
  1644     12  AM-NAME                           PIC X(30).
  1645     12  AM-PERSON                         PIC X(30).
  1646     12  AM-ADDRS                          PIC X(30).
  1647     12  AM-CITY.
  1648         16  AM-ADDR-CITY                  PIC X(28).
  1649         16  AM-ADDR-STATE                 PIC XX.
  1650     12  AM-ZIP.
  1651         16  AM-ZIP-PRIME.
  1652             20  AM-ZIP-PRI-1ST            PIC X.
  1653                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1654             20  FILLER                    PIC X(4).
  1655         16  AM-ZIP-PLUS4                  PIC X(4).
  1656     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1657         16  AM-CAN-POSTAL-1               PIC XXX.
  1658         16  AM-CAN-POSTAL-2               PIC XXX.
  1659         16  FILLER                        PIC XXX.
  1660     12  AM-TEL-NO.
  1661         16  AM-AREA-CODE                  PIC 999.
  1662         16  AM-TEL-PRE                    PIC 999.
  1663         16  AM-TEL-NBR                    PIC 9(4).
  1664     12  AM-TEL-LOC                        PIC X.
  1665         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1666         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1667
  1668     12  AM-COMM-STRUCTURE.
  1669         16  AM-DEFN-1.
  1670             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1671                 24  AM-AGT.
  1672                     28  AM-AGT-PREFIX     PIC X(4).
  1673                     28  AM-AGT-PRIME      PIC X(6).
  1674                 24  AM-COM-TYP            PIC X.
  1675                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1676                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1677                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1678                 24  AM-RECALC-LV-INDIC    PIC X.
  1679                 24  AM-RETRO-LV-INDIC     PIC X.
  1680                 24  AM-GL-CODES           PIC X.
  1681                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1682                 24  FILLER                PIC X(01).
  1683         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1684             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1685                 24  FILLER                PIC X(11).
  1686                 24  AM-L-COMA             PIC XXX.
  1687                 24  AM-J-COMA             PIC XXX.
  1688                 24  AM-A-COMA             PIC XXX.
  1689                 24  FILLER                PIC X(6).
  1690
  1691     12  AM-COMM-CHANGE-STATUS             PIC X.
  1692         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1693
  1694     12  AM-CSR-CODE                       PIC X(4).
  1695
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  31
* NSRLTRBL.cbl
  1696     12  AM-BILLING-STATUS                 PIC X.
  1697         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1698         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1699     12  AM-AUTO-REFUND-SW                 PIC X.
  1700         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1701         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1702     12  AM-GPCD                           PIC 99.
  1703     12  AM-IG                             PIC X.
  1704         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1705         88  AM-HAS-GROUP                     VALUE '2'.
  1706     12  AM-STATUS                         PIC X.
  1707         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1708         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1709         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1710         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1711         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1712         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1713         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1714         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1715         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1716         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1717     12  AM-REMIT-TO                       PIC 99.
  1718     12  AM-ID-NO                          PIC X(11).
  1719
  1720     12  AM-CAL-TABLE                      PIC XX.
  1721     12  AM-LF-DEVIATION                   PIC XXX.
  1722     12  AM-AH-DEVIATION                   PIC XXX.
  1723     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1724     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1725     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1726     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1727     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1728     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1729
  1730     12  AM-USER-FIELDS.
  1731         16  AM-FLD-1                      PIC XX.
  1732         16  AM-FLD-2                      PIC XX.
  1733         16  AM-FLD-3                      PIC XX.
  1734         16  AM-FLD-4                      PIC XX.
  1735         16  AM-FLD-5                      PIC XX.
  1736
  1737     12  AM-1ST-PROD-DATE.
  1738         16  AM-1ST-PROD-YR                PIC XX.
  1739         16  AM-1ST-PROD-MO                PIC XX.
  1740         16  AM-1ST-PROD-DA                PIC XX.
  1741     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1742     12  AM-CERTS-PURGED-DATE.
  1743         16  AM-PUR-YR                     PIC XX.
  1744         16  AM-PUR-MO                     PIC XX.
  1745         16  AM-PUR-DA                     PIC XX.
  1746     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1747     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1748     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1749     12  AM-INACTIVE-DATE.
  1750         16  AM-INA-MO                     PIC 99.
  1751         16  AM-INA-DA                     PIC 99.
  1752         16  AM-INA-YR                     PIC 99.
  1753     12  AM-AR-HI-CERT-DATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  32
* NSRLTRBL.cbl
  1754
  1755     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1756     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1757
  1758     12  AM-OB-PAYMENT-MODE                PIC X.
  1759         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1760         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1761         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1762         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1763
  1764     12  AM-AH-ONLY-INDICATOR              PIC X.
  1765         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1766         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1767
  1768     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1769
  1770     12  AM-OVER-SHORT.
  1771         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1772         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1773
  1774     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1775     12  AM-DCC-CLP-STATE                  PIC XX.
  1776
  1777     12  AM-RECALC-COMM                    PIC X.
  1778     12  AM-RECALC-REIN                    PIC X.
  1779
  1780     12  AM-REI-TABLE                      PIC XXX.
  1781     12  AM-REI-ET-LF                      PIC X.
  1782     12  AM-REI-ET-AH                      PIC X.
  1783     12  AM-REI-PE-LF                      PIC X.
  1784     12  AM-REI-PE-AH                      PIC X.
  1785     12  AM-REI-PRT-ST                     PIC X.
  1786     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1787     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1788     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1789     12  AM-REI-GROUP-A                    PIC X(6).
  1790     12  AM-REI-MORT                       PIC X(4).
  1791     12  AM-REI-PRT-OW                     PIC X.
  1792     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1793     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1794     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1795     12  AM-REI-GROUP-B                    PIC X(6).
  1796
  1797     12  AM-TRUST-TYPE                     PIC X(2).
  1798
  1799     12  AM-EMPLOYER-STMT-USED             PIC X.
  1800     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1801
  1802     12  AM-STD-AH-TYPE                    PIC XX.
  1803     12  AM-EARN-METHODS.
  1804         16  AM-EARN-METHOD-R              PIC X.
  1805             88 AM-REF-RL-R78                 VALUE 'R'.
  1806             88 AM-REF-RL-PR                  VALUE 'P'.
  1807             88 AM-REF-RL-MEAN                VALUE 'M'.
  1808             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1809         16  AM-EARN-METHOD-L              PIC X.
  1810             88 AM-REF-LL-R78                 VALUE 'R'.
  1811             88 AM-REF-LL-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  33
* NSRLTRBL.cbl
  1812             88 AM-REF-LL-MEAN                VALUE 'M'.
  1813             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1814         16  AM-EARN-METHOD-A              PIC X.
  1815             88 AM-REF-AH-R78                 VALUE 'R'.
  1816             88 AM-REF-AH-PR                  VALUE 'P'.
  1817             88 AM-REF-AH-MEAN                VALUE 'M'.
  1818             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1819             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1820             88 AM-REF-AH-NET                 VALUE 'N'.
  1821
  1822     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1823     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1824     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1825
  1826     12  AM-RET-Y-N                        PIC X.
  1827     12  AM-RET-P-E                        PIC X.
  1828     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1829     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1830     12  AM-RET-GRP                        PIC X(6).
  1831     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1832         16  AM-POOL-PRIME                 PIC XXX.
  1833         16  AM-POOL-SUB                   PIC XXX.
  1834     12  AM-RETRO-EARNINGS.
  1835         16  AM-RET-EARN-R                 PIC X.
  1836         16  AM-RET-EARN-L                 PIC X.
  1837         16  AM-RET-EARN-A                 PIC X.
  1838     12  AM-RET-ST-TAX-USE                 PIC X.
  1839         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1840         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1841     12  AM-RETRO-BEG-EARNINGS.
  1842         16  AM-RET-BEG-EARN-R             PIC X.
  1843         16  AM-RET-BEG-EARN-L             PIC X.
  1844         16  AM-RET-BEG-EARN-A             PIC X.
  1845     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1846     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1847
  1848     12  AM-USER-SELECT-OPTIONS.
  1849         16  AM-USER-SELECT-1              PIC X(10).
  1850         16  AM-USER-SELECT-2              PIC X(10).
  1851         16  AM-USER-SELECT-3              PIC X(10).
  1852         16  AM-USER-SELECT-4              PIC X(10).
  1853         16  AM-USER-SELECT-5              PIC X(10).
  1854
  1855     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1856
  1857     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1858
  1859     12  AM-RPT045A-SWITCH                 PIC X.
  1860         88  RPT045A-OFF                   VALUE 'N'.
  1861
  1862     12  AM-INSURANCE-LIMITS.
  1863         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1864         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1865
  1866     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1867         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1868
  1869     12  AM-DISMBR-COVERAGE-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  34
* NSRLTRBL.cbl
  1870         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1871         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1872
  1873     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1874
  1875     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1876     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1877     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1878     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1879     12  AM-DCC-UEF-STATE                  PIC XX.
  1880     12  FILLER                            PIC XXX.
  1881     12  AM-REPORT-CODE-3                  PIC X(10).
  1882*    12  FILLER                            PIC X(22).
  1883
  1884     12  AM-RESERVE-DATE.
  1885         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1886         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1887         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1888
  1889     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1890     12  AM-NOTIFICATION-TYPES.
  1891         16  AM-NOTIF-OF-LETTERS           PIC X.
  1892         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1893         16  AM-NOTIF-OF-REPORTS           PIC X.
  1894         16  AM-NOTIF-OF-STATUS            PIC X.
  1895
  1896     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1897         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1898         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1899         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1900         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1901
  1902     12  AM-BENEFIT-CONTROLS.
  1903         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1904             20  AM-BENEFIT-CODE           PIC XX.
  1905             20  AM-BENEFIT-TYPE           PIC X.
  1906             20  AM-BENEFIT-REVISION       PIC XXX.
  1907             20  AM-BENEFIT-REM-TERM       PIC X.
  1908             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1909             20  FILLER                    PIC XX.
  1910         16  FILLER                        PIC X(80).
  1911
  1912     12  AM-TRANSFER-DATA.
  1913         16  AM-TRANSFERRED-FROM.
  1914             20  AM-TRNFROM-CARRIER        PIC X.
  1915             20  AM-TRNFROM-GROUPING.
  1916                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1917                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1918             20  AM-TRNFROM-STATE          PIC XX.
  1919             20  AM-TRNFROM-ACCOUNT.
  1920                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1921                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1922             20  AM-TRNFROM-DTE            PIC XX.
  1923         16  AM-TRANSFERRED-TO.
  1924             20  AM-TRNTO-CARRIER          PIC X.
  1925             20  AM-TRNTO-GROUPING.
  1926                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1927                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  35
* NSRLTRBL.cbl
  1928             20  AM-TRNTO-STATE            PIC XX.
  1929             20  AM-TRNTO-ACCOUNT.
  1930                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1931                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1932             20  AM-TRNTO-DTE              PIC XX.
  1933         16  FILLER                        PIC X(10).
  1934
  1935     12  AM-SAVED-REMIT-TO                 PIC 99.
  1936
  1937     12  AM-COMM-STRUCTURE-SAVED.
  1938         16  AM-DEFN-1-SAVED.
  1939             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1940                 24  AM-AGT-SV             PIC X(10).
  1941                 24  AM-COM-TYP-SV         PIC X.
  1942                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1943                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1944                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1945                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1946                 24  FILLER                PIC X.
  1947                 24  AM-GL-CODES-SV        PIC X.
  1948                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1949                 24  FILLER                PIC X.
  1950         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1951             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1952                 24  FILLER                PIC X(11).
  1953                 24  AM-L-COMA-SV          PIC XXX.
  1954                 24  AM-J-COMA-SV          PIC XXX.
  1955                 24  AM-A-COMA-SV          PIC XXX.
  1956                 24  FILLER                PIC X(6).
  1957
  1958     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1959         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1960            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1961            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1962            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1963
  1964     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1965     12  FILLER                            PIC X(120).
  1966
  1967     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1968         16  AM-CONTROL-NAME               PIC X(30).
  1969         16  AM-EXECUTIVE-ONE.
  1970             20  AM-EXEC1-NAME             PIC X(15).
  1971             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1972                                                          COMP-3.
  1973             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1974                                                          COMP-3.
  1975         16  AM-EXECUTIVE-TWO.
  1976             20  AM-EXEC2-NAME             PIC X(15).
  1977             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1978                                                          COMP-3.
  1979             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1980                                                          COMP-3.
  1981
  1982     12  AM-RETRO-ADDITIONAL-DATA.
  1983         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1984         16  AM-RETRO-PREM-P-E             PIC X.
  1985         16  AM-RETRO-CLMS-P-I             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  36
* NSRLTRBL.cbl
  1986         16  AM-RETRO-RET-BRACKET-LF.
  1987             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1988                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1989                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1990             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1991                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1992                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1993             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1994                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1995                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1996         16  AM-RETRO-RET-BRACKET-AH.
  1997             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1998                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1999                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2000                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2001             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2002                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2003                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2004             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2005                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2006                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2007
  2008     12  AM-COMMENTS.
  2009         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2010
  2011     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2012         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2013         16  AM-FLI-BILLING-CODE           PIC X.
  2014         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2015         16  AM-FLI-UNITED-IDENT           PIC X.
  2016         16  AM-FLI-INTEREST-LOST-DATA.
  2017             20  AM-FLI-BANK-NO            PIC X(5).
  2018             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2019             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2020             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2021         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2022             20  AM-FLI-AGT                PIC X(9).
  2023             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2024             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2025         16  FILLER                        PIC X(102).
  2026
  2027     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2028         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2029             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2030             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2031             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2032             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2033             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2034         16  FILLER                          PIC X(10).
  2035******************************************************************
  2036*                                COPY ELCBENE.
  2037******************************************************************
  2038*                                                                *
  2039*                            ELCBENE.                            *
  2040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2041*                            VMOD=2.006                          *
  2042*                                                                *
  2043*   FILE DESCRIPTION = BENEFICIARY FILE                          *
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  37
* NSRLTRBL.cbl
  2044*                                                                *
  2045*   FILE TYPE = VSAM,KSDS                                        *
  2046*   RECORD SIZE = 500   RECFORM = FIX                            *
  2047*                                                                *
  2048*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2049*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2050*                                                                *
  2051*   LOG = YES                                                    *
  2052*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2053*                                                                *
  2054*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2055******************************************************************
  2056
  2057 01  BENEFICIARY-MASTER.
  2058     12  BE-RECORD-ID                PIC XX.
  2059         88  VALID-BE-ID                VALUE 'BE'.
  2060
  2061     12  BE-CONTROL-PRIMARY.
  2062         16  BE-COMPANY-CD           PIC X.
  2063         16  BE-RECORD-TYPE          PIC X.
  2064             88  BENEFICIARY-RECORD  VALUE 'B'.
  2065             88  ADJUSTOR-RECORD     VALUE 'A'.
  2066         16  BE-BENEFICIARY          PIC X(10).
  2067     12  BE-CONTROL-BY-NAME.
  2068         16  BE-COMPANY-CD-A1        PIC X.
  2069         16  BE-RECORD-TYPE-A1       PIC X.
  2070         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2071         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2072
  2073     12  BE-LAST-MAINT-DT            PIC XX.
  2074     12  BE-LAST-MAINT-BY            PIC X(4).
  2075     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2076
  2077     12  BE-ADDRESS-DATA.
  2078         16  BE-MAIL-TO-NAME         PIC X(30).
  2079         16  BE-ADDRESS-LINE-1       PIC X(30).
  2080         16  BE-ADDRESS-LINE-2       PIC X(30).
  2081         16  BE-ADDRESS-LINE-3       PIC X(30).
  2082         16  BE-CITY-STATE.
  2083             20  BE-CITY             PIC X(28).
  2084             20  BE-STATE            PIC XX.
  2085         16  BE-ZIP-CODE.
  2086             20  BE-ZIP-PRIME.
  2087                 24  BE-ZIP-1ST      PIC X.
  2088                     88  BE-CANADIAN-POST-CODE
  2089                                         VALUE 'A' THRU 'Z'.
  2090                 24  FILLER          PIC X(4).
  2091             20  BE-ZIP-PLUS4        PIC X(4).
  2092         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2093             20  BE-CAN-POSTAL-1     PIC XXX.
  2094             20  BE-CAN-POSTAL-2     PIC XXX.
  2095             20  FILLER              PIC XXX.
  2096         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2097         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2098
  2099******************************************************************
  2100*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2101*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  38
* NSRLTRBL.cbl
  2102******************************************************************
  2103     12  BE-CARRIER                  PIC X.
  2104
  2105     12  BE-ADDRESS-DATA2.
  2106         16  BE-MAIL-TO-NAME2        PIC X(30).
  2107         16  BE-ADDRESS-LINE-12      PIC X(30).
  2108         16  BE-ADDRESS-LINE-22      PIC X(30).
  2109         16  BE-ADDRESS-LINE-32      PIC X(30).
  2110         16  BE-CITY-STATE2.
  2111             20  BE-CITY2            PIC X(28).
  2112             20  BE-STATE2           PIC XX.
  2113         16  BE-ZIP-CODE2.
  2114             20  BE-ZIP-PRIME2.
  2115                 24  BE-ZIP-1ST2     PIC X.
  2116                     88  BE-CANADIAN-POST-CODE2
  2117                                         VALUE 'A' THRU 'Z'.
  2118                 24  FILLER          PIC X(4).
  2119             20  BE-ZIP-PLUS42       PIC X(4).
  2120         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2121             20  BE-CAN-POSTAL-12    PIC XXX.
  2122             20  BE-CAN-POSTAL-22    PIC XXX.
  2123             20  FILLER              PIC XXX.
  2124         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2125         16  BE-BILLING-STMT-DATA.
  2126             20  BE-BSR              PIC X.
  2127                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  2128                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  2129             20  BE-BSR-FROM         PIC X(30).
  2130             20  BE-BSR-DEPT         PIC X(30).
  2131             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2132             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2133             20  BE-OUTPUT-TYPE      PIC X.
  2134                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2135                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2136
  2137     12  FILLER                      PIC X(28).
  2138******************************************************************
  2139*                                COPY ELCTEXT.
  2140******************************************************************
  2141*                                                                *
  2142*                                                                *
  2143*                            ELCTEXT.                            *
  2144*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2145*                            VMOD=2.008                          *
  2146*                                                                *
  2147*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2148*                                     FORM LETTERS,              *
  2149*                                     CERT FORM DISPLAY.
  2150*                                                                *
  2151*   FILE TYPE = VSAM,KSDS                                        *
  2152*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2153*                                                                *
  2154*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2155*       ALTERNATE INDEX = NONE                                   *
  2156*                                                                *
  2157*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2158*       ALTERNATE INDEX = NONE                                   *
  2159*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  39
* NSRLTRBL.cbl
  2160*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2161*       ALTERNATE INDEX = NONE                                   *
  2162*                                                                *
  2163*   LOG = NO                                                     *
  2164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2165******************************************************************
  2166 01  TEXT-FILES.
  2167     12  TEXT-FILE-ID                PIC XX.
  2168         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2169         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2170         88  HELP-FILE-TEXT             VALUE 'TH'.
  2171
  2172     12  TX-CONTROL-PRIMARY.
  2173         16  TX-COMPANY-CD           PIC X.
  2174             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2175         16  TX-ACCESS-CD-GENL       PIC X(12).
  2176
  2177         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2178             20  TX-LETTER-NO        PIC X(4).
  2179             20  FILLER              PIC X(8).
  2180
  2181         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2182             20  TX-FORM-NO          PIC X(12).
  2183
  2184         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2185             20  TX-HELP-TYPE        PIC X.
  2186                 88  HELP-FOR-GENERAL   VALUE ' '.
  2187                 88  HELP-BY-SCREEN     VALUE 'S'.
  2188                 88  HELP-BY-ERROR      VALUE 'E'.
  2189             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2190                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2191             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2192                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2193             20  FILLER              PIC X(4).
  2194
  2195         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2196
  2197     12  TX-PROCESS-CONTROL          PIC XX.
  2198         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2199
  2200     12  TX-TEXT-LINE                PIC X(70).
  2201
  2202     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2203         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2204         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2205         88  TX-VALID-FORM-SQUEEZE-VALUE
  2206                                        VALUE 'Y' ' '.
  2207
  2208     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2209         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2210         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2211         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2212         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2213         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2214         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2215         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2216                                              'K' 'N' ' '
  2217                                              'Z'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  40
* NSRLTRBL.cbl
  2218
  2219     12  TX-ARCHIVE-SW               PIC X.
  2220         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2221         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2222         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2223
  2224     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2225     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2226
  2227     12  TX-BSR-CODE                 PIC X.
  2228         88  TX-BSR-LETTER              VALUE 'B'.
  2229         88  TX-NON-BSR-LETTER          VALUE ' '.
  2230
  2231     12  FILLER                      PIC X.
  2232*****************************************************************
  2233*                                COPY ELCCNTL.
  2234******************************************************************
  2235*                                                                *
  2236*                                                                *
  2237*                            ELCCNTL.                            *
  2238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2239*                            VMOD=2.059                          *
  2240*                                                                *
  2241*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2242*                                                                *
  2243*   FILE TYPE = VSAM,KSDS                                        *
  2244*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2245*                                                                *
  2246*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2247*       ALTERNATE INDEX = NONE                                   *
  2248*                                                                *
  2249*   LOG = YES                                                    *
  2250*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2251******************************************************************
  2252*                   C H A N G E   L O G
  2253*
  2254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2255*-----------------------------------------------------------------
  2256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2257* EFFECTIVE    NUMBER
  2258*-----------------------------------------------------------------
  2259* 082503                   PEMA  ADD BENEFIT GROUP
  2260* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2261* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2262* 092705    2005050300006  PEMA  ADD SPP LEASES
  2263* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2264* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2265* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2266* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2267* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2268* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2269* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2270* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2271* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2272* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2273******************************************************************
  2274*
  2275 01  CONTROL-FILE.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  41
* NSRLTRBL.cbl
  2276     12  CF-RECORD-ID                       PIC XX.
  2277         88  VALID-CF-ID                        VALUE 'CF'.
  2278
  2279     12  CF-CONTROL-PRIMARY.
  2280         16  CF-COMPANY-ID                  PIC XXX.
  2281         16  CF-RECORD-TYPE                 PIC X.
  2282             88  CF-COMPANY-MASTER              VALUE '1'.
  2283             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2284             88  CF-STATE-MASTER                VALUE '3'.
  2285             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2286             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2287             88  CF-CARRIER-MASTER              VALUE '6'.
  2288             88  CF-MORTALITY-MASTER            VALUE '7'.
  2289             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2290             88  CF-TERMINAL-MASTER             VALUE '9'.
  2291             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2292             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2293             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2294             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2295             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2296             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2297             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2298             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2299             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2300         16  CF-ACCESS-CD-GENL              PIC X(4).
  2301         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2302             20  CF-PROCESSOR               PIC X(4).
  2303         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2304             20  CF-STATE-CODE              PIC XX.
  2305             20  FILLER                     PIC XX.
  2306         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2307             20  FILLER                     PIC XX.
  2308             20  CF-HI-BEN-IN-REC           PIC XX.
  2309         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2310             20  FILLER                     PIC XXX.
  2311             20  CF-CARRIER-CNTL            PIC X.
  2312         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2313             20  FILLER                     PIC XX.
  2314             20  CF-HI-TYPE-IN-REC          PIC 99.
  2315         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2316             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2317                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2318             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2319             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2320         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2321             20  FILLER                     PIC X.
  2322             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2323         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2324             20  FILLER                     PIC XX.
  2325             20  CF-MORTGAGE-PLAN           PIC XX.
  2326         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2327
  2328     12  CF-LAST-MAINT-DT                   PIC XX.
  2329     12  CF-LAST-MAINT-BY                   PIC X(4).
  2330     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2331
  2332     12  CF-RECORD-BODY                     PIC X(728).
  2333
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  42
* NSRLTRBL.cbl
  2334
  2335****************************************************************
  2336*             COMPANY MASTER RECORD                            *
  2337****************************************************************
  2338
  2339     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2340         16  CF-COMPANY-ADDRESS.
  2341             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2342             20  CF-CL-IN-CARE-OF           PIC X(30).
  2343             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2344             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2345             20  CF-CL-CITY-STATE           PIC X(30).
  2346             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2347             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2348         16  CF-COMPANY-CD                  PIC X.
  2349         16  CF-COMPANY-PASSWORD            PIC X(8).
  2350         16  CF-SECURITY-OPTION             PIC X.
  2351             88  ALL-SECURITY                   VALUE '1'.
  2352             88  COMPANY-VERIFY                 VALUE '2'.
  2353             88  PROCESSOR-VERIFY               VALUE '3'.
  2354             88  NO-SECURITY                    VALUE '4'.
  2355             88  ALL-BUT-TERM                   VALUE '5'.
  2356         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2357             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2358         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2359             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2360         16  CF-INFORCE-LOCATION            PIC X.
  2361             88  CERTS-ARE-ONLINE               VALUE '1'.
  2362             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2363             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2364         16  CF-LOWER-CASE-LETTERS          PIC X.
  2365         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2366             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2367             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2368             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2369             88  CF-ACCNT-CNTL                  VALUE '3'.
  2370             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2371
  2372         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2373         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2374
  2375         16  CF-LGX-CREDIT-USER             PIC X.
  2376             88  CO-IS-NOT-USER                 VALUE 'N'.
  2377             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2378
  2379         16 CF-CREDIT-CALC-CODES.
  2380             20  CF-CR-REM-TERM-CALC PIC X.
  2381               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2382               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2383               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2384               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2385               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2386               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2387               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2388             20  CF-CR-R78-METHOD           PIC X.
  2389               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2390               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2391
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  43
* NSRLTRBL.cbl
  2392         16  CF-CLAIM-CONTROL-COUNTS.
  2393             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2394                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2395
  2396             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2397                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2398
  2399             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2400                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2401
  2402             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2403                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2404
  2405         16  CF-CURRENT-MONTH-END           PIC XX.
  2406
  2407         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2408             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2409             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2410             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2411             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2412                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2413                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2414             20  CF-CO-PREM-REJECT-SW       PIC X.
  2415                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2416                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2417             20  CF-CO-REF-REJECT-SW        PIC X.
  2418                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2419                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2420
  2421         16  CF-CO-REPORTING-DT             PIC XX.
  2422         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2423         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2424           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2425           88  CF-CO-MONTH-END                  VALUE '1'.
  2426
  2427         16  CF-LGX-CLAIM-USER              PIC X.
  2428             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2429             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2430
  2431         16  CF-CREDIT-EDIT-CONTROLS.
  2432             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2433             20  CF-MIN-AGE                 PIC 99.
  2434             20  CF-DEFAULT-AGE             PIC 99.
  2435             20  CF-MIN-TERM                PIC S999      COMP-3.
  2436             20  CF-MAX-TERM                PIC S999      COMP-3.
  2437             20  CF-DEFAULT-SEX             PIC X.
  2438             20  CF-JOINT-AGE-INPUT         PIC X.
  2439                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2440             20  CF-BIRTH-DATE-INPUT        PIC X.
  2441                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2442             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2443                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2444                 88  CF-ZERO-CARRIER            VALUE '1'.
  2445                 88  CF-ZERO-GROUPING           VALUE '2'.
  2446                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2447             20  CF-EDIT-SW                 PIC X.
  2448                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2449             20  CF-EDIT-RESTART-BATCH      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  44
* NSRLTRBL.cbl
  2450             20  CF-CR-PR-METHOD            PIC X.
  2451               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2452               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2453             20  FILLER                     PIC X.
  2454
  2455         16  CF-CREDIT-MISC-CONTROLS.
  2456             20  CF-REIN-TABLE-SW           PIC X.
  2457                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2458             20  CF-COMP-TABLE-SW           PIC X.
  2459                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2460             20  CF-EXPERIENCE-RETENTION-AGE
  2461                                            PIC S9        COMP-3.
  2462             20  CF-CONVERSION-DT           PIC XX.
  2463             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2464             20  CF-RUN-FREQUENCY-SW        PIC X.
  2465                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2466                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2467
  2468             20  CF-CR-CHECK-NO-CONTROL.
  2469                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2470                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2471                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2472                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2473                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2474                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2475
  2476                 24  CF-CR-CHECK-COUNT       REDEFINES
  2477                     CF-CR-CHECK-COUNTER      PIC X(4).
  2478
  2479                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2480                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2481
  2482                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2483                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2484                 24  CF-MAIL-PROCESSING       PIC X.
  2485                     88  MAIL-PROCESSING          VALUE 'Y'.
  2486
  2487         16  CF-MISC-SYSTEM-CONTROL.
  2488             20  CF-SYSTEM-C                 PIC X.
  2489                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2490             20  CF-SYSTEM-D                 PIC X.
  2491                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2492             20  CF-SOC-SEC-NO-SW            PIC X.
  2493                 88  SOC-SEC-NO-USED             VALUE '1'.
  2494             20  CF-MEMBER-NO-SW             PIC X.
  2495                 88  MEMBER-NO-USED              VALUE '1'.
  2496             20  CF-TAX-ID-NUMBER            PIC X(11).
  2497             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2498             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2499                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2500                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2501                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2502                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2503             20  CF-SYSTEM-E                 PIC X.
  2504                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2505
  2506         16  CF-LGX-LIFE-USER               PIC X.
  2507             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  45
* NSRLTRBL.cbl
  2508             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2509
  2510         16  CF-CR-MONTH-END-DT             PIC XX.
  2511
  2512         16  CF-FILE-MAINT-DATES.
  2513             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2514                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2515             20  CF-LAST-BATCH       REDEFINES
  2516                 CF-LAST-BATCH-NO               PIC X(4).
  2517             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2518             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2519             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2520             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2521             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2522             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2523             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2524             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2525             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2526             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2527
  2528         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2529         16  FILLER                         PIC X.
  2530
  2531         16  CF-ALT-MORT-CODE               PIC X(4).
  2532         16  CF-MEMBER-CAPTION              PIC X(10).
  2533
  2534         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2535             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2536             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2537             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2538             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2539             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2540
  2541         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2542
  2543         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2544         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2545         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2546         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2547
  2548         16  CF-AH-OVERRIDE-L1              PIC X.
  2549         16  CF-AH-OVERRIDE-L2              PIC XX.
  2550         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2551         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2552
  2553         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2554         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2555
  2556         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2557         16  CF-AR-LAST-EL860-DT            PIC XX.
  2558         16  CF-MP-MONTH-END-DT             PIC XX.
  2559
  2560         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2561         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2562             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2563
  2564         16  CF-AR-MONTH-END-DT             PIC XX.
  2565
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  46
* NSRLTRBL.cbl
  2566         16  CF-CRDTCRD-USER                PIC X.
  2567             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2568             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2569
  2570         16  CF-CC-MONTH-END-DT             PIC XX.
  2571
  2572         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2573
  2574         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2575             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2576             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2577             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2578         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2579         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2580         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2581         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2582             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2583             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2584         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2585         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2586         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2587             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2588         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2589
  2590         16  CF-CL-ZIP-CODE.
  2591             20  CF-CL-ZIP-PRIME.
  2592                 24  CF-CL-ZIP-1ST          PIC X.
  2593                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2594                 24  FILLER                 PIC X(4).
  2595             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2596         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2597             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2598             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2599             20  FILLER                     PIC XXX.
  2600
  2601         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2602         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2603         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2604         16  CF-CO-OPTION-START-DATE        PIC XX.
  2605         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2606           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2607                                                      '3' '4'.
  2608           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2609           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2610           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2611           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2612           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2613           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2614
  2615         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2616
  2617         16  CF-PAYMENT-APPROVAL-LEVELS.
  2618             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2619             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2620             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2621             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2622             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2623             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  47
* NSRLTRBL.cbl
  2624
  2625         16  CF-END-USER-REPORTING-USER     PIC X.
  2626             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2627             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2628
  2629         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2630             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2631             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2632
  2633         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2634
  2635         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2636         16  FILLER                         PIC X.
  2637
  2638         16  CF-CREDIT-ARCHIVE-CNTL.
  2639             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2640             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2641             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2642
  2643         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2644
  2645         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2646             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2647             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2648
  2649         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2650             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2651             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2652
  2653         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2654
  2655         16  CF-CO-ACH-ID-CODE              PIC  X.
  2656             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2657             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2658             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2659         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2660         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2661         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2662         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2663         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2664         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2665         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2666         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2667         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2668                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2669         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2670                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2671
  2672         16  CF-CO-OVER-SHORT.
  2673             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2674             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2675
  2676*         16  FILLER                         PIC X(102).
  2677         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2678             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2679             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2680
  2681         16  CF-AH-APPROVAL-DAYS.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  48
* NSRLTRBL.cbl
  2682             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2683             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2684             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2685             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2686
  2687         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2688
  2689         16  CF-APPROV-LEV-5.
  2690             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2691             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2692             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2693
  2694         16  FILLER                         PIC X(68).
  2695****************************************************************
  2696*             PROCESSOR/USER RECORD                            *
  2697****************************************************************
  2698
  2699     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2700         16  CF-PROCESSOR-NAME              PIC X(30).
  2701         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2702         16  CF-PROCESSOR-TITLE             PIC X(26).
  2703         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2704                 88  MESSAGE-YES                VALUE 'Y'.
  2705                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2706
  2707*****************************************************
  2708****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2709****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2710****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2711****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2712*****************************************************
  2713
  2714         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2715             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2716             20  CF-APPLICATION-FORCE       PIC X.
  2717             20  CF-INDIVIDUAL-APP.
  2718                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2719                     28  CF-BROWSE-APP      PIC X.
  2720                     28  CF-UPDATE-APP      PIC X.
  2721
  2722         16  CF-CURRENT-TERM-ON             PIC X(4).
  2723         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2724             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2725             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2726             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2727             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2728             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2729             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2730             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2731         16  CF-PROCESSOR-CARRIER           PIC X.
  2732             88  NO-CARRIER-SECURITY            VALUE ' '.
  2733         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2734             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2735         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2736             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2737         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2738             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2739
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  49
* NSRLTRBL.cbl
  2740         16  CF-PROC-SYS-ACCESS-SW.
  2741             20  CF-PROC-CREDIT-CLAIMS-SW.
  2742                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2743                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2744                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2745                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2746             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2747                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2748                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2749             20  CF-PROC-LIFE-GNRLDGR-SW.
  2750                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2751                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2752                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2753                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2754             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2755                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2756                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2757         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2758             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2759             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2760         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2761
  2762         16  CF-APPROVAL-LEVEL                  PIC X.
  2763             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2764             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2765             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2766             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2767             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2768
  2769         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2770
  2771         16  CF-LANGUAGE-TYPE                   PIC X.
  2772             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2773             88  CF-LANG-IS-FR                      VALUE 'F'.
  2774
  2775         16  CF-CSR-IND                         PIC X.
  2776         16  FILLER                             PIC X(239).
  2777
  2778****************************************************************
  2779*             PROCESSOR/REMINDERS RECORD                       *
  2780****************************************************************
  2781
  2782     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2783         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2784             20  CF-START-REMIND-DT         PIC XX.
  2785             20  CF-END-REMIND-DT           PIC XX.
  2786             20  CF-REMINDER-TEXT           PIC X(50).
  2787         16  FILLER                         PIC X(296).
  2788
  2789
  2790****************************************************************
  2791*             STATE MASTER RECORD                              *
  2792****************************************************************
  2793
  2794     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2795         16  CF-STATE-ABBREVIATION          PIC XX.
  2796         16  CF-STATE-NAME                  PIC X(25).
  2797         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  50
* NSRLTRBL.cbl
  2798         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2799             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2800             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2801             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2802             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2803                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2804                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2805             20  CF-ST-PREM-REJECT-SW       PIC X.
  2806                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2807                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2808             20  CF-ST-REF-REJECT-SW        PIC X.
  2809                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2810                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2811         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2812         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2813         16  CF-ST-REFUND-RULES.
  2814             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2815             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2816             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2817         16  CF-ST-FST-PMT-EXTENSION.
  2818             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2819             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2820                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2821                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2822                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2823                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2824         16  CF-ST-STATE-CALL.
  2825             20  CF-ST-CALL-UNEARNED        PIC X.
  2826             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2827             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2828         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2829             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2830             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2831         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2832         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2833         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2834         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2835         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2836         16  FILLER                         PIC X.
  2837         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2838             20  CF-ST-BENEFIT-CD           PIC XX.
  2839             20  CF-ST-BENEFIT-KIND         PIC X.
  2840                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2841                 88  CF-ST-AH-KIND              VALUE 'A'.
  2842             20  CF-ST-REM-TERM-CALC        PIC X.
  2843                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2844                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2845                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2846                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2847                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2848                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2849                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2850                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2851
  2852             20  CF-ST-REFUND-CALC          PIC X.
  2853                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2854                 88  ST-REFD-BY-R78             VALUE '1'.
  2855                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  51
* NSRLTRBL.cbl
  2856                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2857                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2858                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2859                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2860                 88  ST-REFD-UTAH               VALUE '7'.
  2861                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2862                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2863                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2864
  2865             20  CF-ST-EARNING-CALC         PIC X.
  2866                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2867                 88  ST-EARN-BY-R78             VALUE '1'.
  2868                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2869                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2870                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2871                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2872                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2873                 88  ST-EARN-MEAN               VALUE '8'.
  2874                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2875
  2876             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2877                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2878                 88  ST-OVRD-BY-R78             VALUE '1'.
  2879                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2880                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2881                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2882                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2883                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2884                 88  ST-OVRD-MEAN               VALUE '8'.
  2885                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2886             20  cf-st-extra-periods        pic 9.
  2887*            20  FILLER                     PIC X.
  2888
  2889         16  CF-ST-COMMISSION-CAPS.
  2890             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2891             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2892             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2893             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2894         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2895                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2896
  2897         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2898
  2899         16  CF-ST-STATUTORY-INTEREST.
  2900             20  CF-ST-STAT-DATE-FROM       PIC X.
  2901                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2902                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2903             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2904             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2905             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2906             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2907             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2908
  2909         16  CF-ST-OVER-SHORT.
  2910             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2911             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2912
  2913         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  52
* NSRLTRBL.cbl
  2914
  2915         16  CF-ST-RT-CALC                  PIC X.
  2916
  2917         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2918         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2919         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2920         16  CF-ST-RF-LR-CALC               PIC X.
  2921         16  CF-ST-RF-LL-CALC               PIC X.
  2922         16  CF-ST-RF-LN-CALC               PIC X.
  2923         16  CF-ST-RF-AH-CALC               PIC X.
  2924         16  CF-ST-RF-CP-CALC               PIC X.
  2925*        16  FILLER                         PIC X(206).
  2926*CIDMOD         16  FILLER                         PIC X(192).
  2927         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2928             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2929         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2930         16  CF-ST-VFY-2ND-BENE             PIC X.
  2931         16  CF-ST-CAUSAL-STATE             PIC X.
  2932         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2933         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2934         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2935             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2936         16  CF-ST-NET-ONLY-STATE           PIC X.
  2937             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2938         16  FILLER                         PIC X(181).
  2939
  2940****************************************************************
  2941*             BENEFIT MASTER RECORD                            *
  2942****************************************************************
  2943
  2944     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2945         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2946             20  CF-BENEFIT-CODE            PIC XX.
  2947             20  CF-BENEFIT-NUMERIC  REDEFINES
  2948                 CF-BENEFIT-CODE            PIC XX.
  2949             20  CF-BENEFIT-ALPHA           PIC XXX.
  2950             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2951             20  CF-BENEFIT-COMMENT         PIC X(10).
  2952
  2953             20  CF-LF-COVERAGE-TYPE        PIC X.
  2954                 88  CF-REDUCING                VALUE 'R'.
  2955                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2956
  2957             20  CF-SPECIAL-CALC-CD         PIC X.
  2958                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2959                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2960                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2961                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2962                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2963                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2964                 88  CF-FARM-PLAN               VALUE 'F'.
  2965                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2966                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2967                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2968                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2969                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2970                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2971                 88  CF-PRUDENTIAL              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  53
* NSRLTRBL.cbl
  2972                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2973                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2974                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2975                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2976                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2977                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2978
  2979             20  CF-JOINT-INDICATOR         PIC X.
  2980                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2981
  2982*            20  FILLER                     PIC X(12).
  2983             20  cf-maximum-benefits        pic s999 comp-3.
  2984             20  FILLER                     PIC X(09).
  2985             20  CF-BENEFIT-CATEGORY        PIC X.
  2986             20  CF-LOAN-TYPE               PIC X(8).
  2987
  2988             20  CF-CO-REM-TERM-CALC        PIC X.
  2989                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2990                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2991                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2992                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2993                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2994
  2995             20  CF-CO-EARNINGS-CALC        PIC X.
  2996                 88  CO-EARN-BY-R78             VALUE '1'.
  2997                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2998                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2999                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3000                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3001                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3002                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3003                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3004
  3005             20  CF-CO-REFUND-CALC          PIC X.
  3006                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3007                 88  CO-REFD-BY-R78             VALUE '1'.
  3008                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3009                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3010                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3011                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3012                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3013                 88  CO-REFD-MEAN               VALUE '8'.
  3014                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3015                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3016                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3017
  3018             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3019                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3020                 88  CO-OVRD-BY-R78             VALUE '1'.
  3021                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3022                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3023                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3024                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3025                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3026                 88  CO-OVRD-MEAN               VALUE '8'.
  3027                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3028
  3029             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  54
* NSRLTRBL.cbl
  3030                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3031                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3032                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3033
  3034         16  FILLER                         PIC X(304).
  3035
  3036
  3037****************************************************************
  3038*             CARRIER MASTER RECORD                            *
  3039****************************************************************
  3040
  3041     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3042         16  CF-ADDRESS-DATA.
  3043             20  CF-MAIL-TO-NAME            PIC X(30).
  3044             20  CF-IN-CARE-OF              PIC X(30).
  3045             20  CF-ADDRESS-LINE-1          PIC X(30).
  3046             20  CF-ADDRESS-LINE-2          PIC X(30).
  3047             20  CF-CITY-STATE              PIC X(30).
  3048             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3049             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3050
  3051         16  CF-CLAIM-NO-CONTROL.
  3052             20  CF-CLAIM-NO-METHOD         PIC X.
  3053                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3054                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3055                 88  CLAIM-NO-SEQ               VALUE '3'.
  3056                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3057             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3058                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3059                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3060                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3061
  3062         16  CF-CHECK-NO-CONTROL.
  3063             20  CF-CHECK-NO-METHOD         PIC X.
  3064                 88  CHECK-NO-MANUAL            VALUE '1'.
  3065                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3066                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3067                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3068             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3069                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3070
  3071         16  CF-DOMICILE-STATE              PIC XX.
  3072
  3073         16  CF-EXPENSE-CONTROLS.
  3074             20  CF-EXPENSE-METHOD          PIC X.
  3075                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3076                 88  DOLLARS-PER-PMT            VALUE '2'.
  3077                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3078                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3079             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3080             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3081
  3082         16  CF-CORRESPONDENCE-CONTROL.
  3083             20  CF-LETTER-RESEND-OPT       PIC X.
  3084                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3085                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3086             20  FILLER                     PIC X(4).
  3087
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  55
* NSRLTRBL.cbl
  3088         16  CF-RESERVE-CONTROLS.
  3089             20  CF-MANUAL-SW               PIC X.
  3090                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3091             20  CF-FUTURE-SW               PIC X.
  3092                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3093             20  CF-PTC-SW                  PIC X.
  3094                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3095             20  CF-IBNR-SW                 PIC X.
  3096                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3097             20  CF-PTC-LF-SW               PIC X.
  3098                 88  CF-LF-PTC-USED             VALUE '1'.
  3099             20  CF-CDT-ACCESS-METHOD       PIC X.
  3100                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3101                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3102                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3103             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3104
  3105         16  CF-CLAIM-CALC-METHOD           PIC X.
  3106             88  360-PLUS-MONTHS                VALUE '1'.
  3107             88  365-PLUS-MONTHS                VALUE '2'.
  3108             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3109             88  360-DAILY                      VALUE '4'.
  3110             88  365-DAILY                      VALUE '5'.
  3111
  3112         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3113         16  FILLER                         PIC X(11).
  3114
  3115         16  CF-LIMIT-AMOUNTS.
  3116             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3117             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3118             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3119             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3120             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3121             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3122             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3123             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3124             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3125             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3126
  3127         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3128         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3129         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3130
  3131         16  CF-ZIP-CODE.
  3132             20  CF-ZIP-PRIME.
  3133                 24  CF-ZIP-1ST             PIC X.
  3134                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3135                 24  FILLER                 PIC X(4).
  3136             20  CF-ZIP-PLUS4               PIC X(4).
  3137         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3138             20  CF-CAN-POSTAL-1            PIC XXX.
  3139             20  CF-CAN-POSTAL-2            PIC XXX.
  3140             20  FILLER                     PIC XXX.
  3141
  3142         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3143         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3144         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3145
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  56
* NSRLTRBL.cbl
  3146         16  CF-RATING-SWITCH               PIC X.
  3147             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3148             88  CF-NO-RATING                   VALUE 'N'.
  3149
  3150         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3151
  3152         16  CF-CARRIER-OVER-SHORT.
  3153             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3154             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3155
  3156         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3157         16  CF-SECPAY-SWITCH               PIC X.
  3158             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3159             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3160         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3161         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3162         16  FILLER                         PIC X(444).
  3163*        16  FILLER                         PIC X(452).
  3164
  3165
  3166****************************************************************
  3167*             MORTALITY MASTER RECORD                          *
  3168****************************************************************
  3169
  3170     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3171         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3172                                INDEXED BY CF-MORT-NDX.
  3173             20  CF-MORT-TABLE              PIC X(5).
  3174             20  CF-MORT-TABLE-TYPE         PIC X.
  3175                 88  CF-MORT-JOINT              VALUE 'J'.
  3176                 88  CF-MORT-SINGLE             VALUE 'S'.
  3177                 88  CF-MORT-COMBINED           VALUE 'C'.
  3178                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3179                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3180             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3181             20  CF-MORT-AGE-METHOD         PIC XX.
  3182                 88  CF-AGE-LAST                VALUE 'AL'.
  3183                 88  CF-AGE-NEAR                VALUE 'AN'.
  3184             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3185             20  CF-MORT-ADJUSTMENT-DIRECTION
  3186                                            PIC X.
  3187                 88  CF-MINUS                   VALUE '-'.
  3188                 88  CF-PLUS                    VALUE '+'.
  3189             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3190             20  CF-MORT-JOINT-CODE         PIC X.
  3191                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3192             20  CF-MORT-PC-Q               PIC X.
  3193                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3194             20  CF-MORT-TABLE-CODE         PIC X(4).
  3195             20  CF-MORT-COMMENTS           PIC X(15).
  3196             20  FILLER                     PIC X(14).
  3197
  3198         16  FILLER                         PIC X(251).
  3199
  3200
  3201****************************************************************
  3202*             BUSSINESS TYPE MASTER RECORD                     *
  3203****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  57
* NSRLTRBL.cbl
  3204
  3205     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3206* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3207* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3208* AND RECORD 05 IS TYPES 81-99
  3209         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3210             20  CF-BUSINESS-TITLE          PIC  X(19).
  3211             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3212                                            PIC S9V9(4) COMP-3.
  3213             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3214             20  FILLER                     PIC  X.
  3215         16  FILLER                         PIC  X(248).
  3216
  3217
  3218****************************************************************
  3219*             TERMINAL MASTER RECORD                           *
  3220****************************************************************
  3221
  3222     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3223
  3224         16  CF-COMPANY-TERMINALS.
  3225             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3226                                  PIC X(4).
  3227         16  FILLER               PIC X(248).
  3228
  3229
  3230****************************************************************
  3231*             LIFE EDIT MASTER RECORD                          *
  3232****************************************************************
  3233
  3234     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3235         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3236             20  CF-LIFE-CODE-IN            PIC XX.
  3237             20  CF-LIFE-CODE-OUT           PIC XX.
  3238         16  FILLER                         PIC X(248).
  3239
  3240
  3241****************************************************************
  3242*             AH EDIT MASTER RECORD                            *
  3243****************************************************************
  3244
  3245     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3246         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3247             20  CF-AH-CODE-IN              PIC XXX.
  3248             20  CF-AH-CODE-OUT             PIC XX.
  3249         16  FILLER                         PIC X(248).
  3250
  3251
  3252****************************************************************
  3253*             CREDIBILITY TABLES                               *
  3254****************************************************************
  3255
  3256     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3257         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3258                             INDEXED BY CF-CRDB-NDX.
  3259             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3260             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3261             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  58
* NSRLTRBL.cbl
  3262         16  FILLER                         PIC  X(332).
  3263
  3264
  3265****************************************************************
  3266*             REPORT CUSTOMIZATION RECORD                      *
  3267****************************************************************
  3268
  3269     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3270         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3271             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3272             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3273             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3274**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3275****       A T-TRANSFER.                                   ****
  3276             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3277
  3278         16  FILLER                         PIC XX.
  3279
  3280         16  CF-CARRIER-CNTL-OPT.
  3281             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3282                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3283                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3284             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3285                                            PIC X.
  3286         16  CF-GROUP-CNTL-OPT.
  3287             20  CF-GROUP-OPT-SEQ           PIC 9.
  3288                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3289                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3290             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3291                                            PIC X(6).
  3292         16  CF-STATE-CNTL-OPT.
  3293             20  CF-STATE-OPT-SEQ           PIC 9.
  3294                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3295                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3296             20  CF-STATE-SELECT OCCURS 3 TIMES
  3297                                            PIC XX.
  3298         16  CF-ACCOUNT-CNTL-OPT.
  3299             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3300                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3301                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3302             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3303                                            PIC X(10).
  3304         16  CF-BUS-TYP-CNTL-OPT.
  3305             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3306                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3307                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3308             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3309                                            PIC XX.
  3310         16  CF-LF-TYP-CNTL-OPT.
  3311             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3312                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3313                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3314             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3315                                            PIC XX.
  3316         16  CF-AH-TYP-CNTL-OPT.
  3317             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3318                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3319                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  59
* NSRLTRBL.cbl
  3320             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3321                                            PIC XX.
  3322         16  CF-REPTCD1-CNTL-OPT.
  3323             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3324                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3325                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3326             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3327                                            PIC X(10).
  3328         16  CF-REPTCD2-CNTL-OPT.
  3329             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3330                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3331                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3332             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3333                                            PIC X(10).
  3334         16  CF-USER1-CNTL-OPT.
  3335             20  CF-USER1-OPT-SEQ           PIC 9.
  3336                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3337                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3338             20  CF-USER1-SELECT OCCURS 3 TIMES
  3339                                            PIC X(10).
  3340         16  CF-USER2-CNTL-OPT.
  3341             20  CF-USER2-OPT-SEQ           PIC 9.
  3342                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3343                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3344             20  CF-USER2-SELECT OCCURS 3 TIMES
  3345                                            PIC X(10).
  3346         16  CF-USER3-CNTL-OPT.
  3347             20  CF-USER3-OPT-SEQ           PIC 9.
  3348                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3349                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3350             20  CF-USER3-SELECT OCCURS 3 TIMES
  3351                                            PIC X(10).
  3352         16  CF-USER4-CNTL-OPT.
  3353             20  CF-USER4-OPT-SEQ           PIC 9.
  3354                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3355                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3356             20  CF-USER4-SELECT OCCURS 3 TIMES
  3357                                            PIC X(10).
  3358         16  CF-USER5-CNTL-OPT.
  3359             20  CF-USER5-OPT-SEQ           PIC 9.
  3360                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3361                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3362             20  CF-USER5-SELECT OCCURS 3 TIMES
  3363                                            PIC X(10).
  3364         16  CF-REINS-CNTL-OPT.
  3365             20  CF-REINS-OPT-SEQ           PIC 9.
  3366                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3367                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3368             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3369                 24  CF-REINS-PRIME         PIC XXX.
  3370                 24  CF-REINS-SUB           PIC XXX.
  3371
  3372         16  CF-AGENT-CNTL-OPT.
  3373             20  CF-AGENT-OPT-SEQ           PIC 9.
  3374                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3375                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3376             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3377                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  60
* NSRLTRBL.cbl
  3378
  3379         16  FILLER                         PIC X(43).
  3380
  3381         16  CF-LOSS-RATIO-SELECT.
  3382             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3383             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3384         16  CF-ENTRY-DATE-SELECT.
  3385             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3386             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3387         16  CF-EFFECTIVE-DATE-SELECT.
  3388             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3389             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3390
  3391         16  CF-EXCEPTION-LIST-IND          PIC X.
  3392             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3393
  3394         16  FILLER                         PIC X(318).
  3395
  3396****************************************************************
  3397*                  EXCEPTION REPORTING RECORD                  *
  3398****************************************************************
  3399
  3400     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3401         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3402             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3403
  3404         16  CF-COMBINED-LIFE-AH-OPT.
  3405             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3406             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3407             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3408             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3409
  3410         16  CF-LIFE-OPT.
  3411             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3412             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3413             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3414             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3415             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3416             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3417             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3418             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3419             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3420             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3421
  3422         16  CF-AH-OPT.
  3423             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3424             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3425             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3426             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3427             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3428             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3429             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3430             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3431             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3432             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3433
  3434         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3435             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  61
* NSRLTRBL.cbl
  3436             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3437             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3438
  3439         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3440
  3441         16  FILLER                         PIC X(673).
  3442
  3443
  3444****************************************************************
  3445*             MORTGAGE SYSTEM PLAN RECORD                      *
  3446****************************************************************
  3447
  3448     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3449         16  CF-PLAN-TYPE                   PIC X.
  3450             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3451             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3452             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3453         16  CF-PLAN-ABBREV                 PIC XXX.
  3454         16  CF-PLAN-DESCRIPT               PIC X(10).
  3455         16  CF-PLAN-NOTES                  PIC X(20).
  3456         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3457         16  CF-PLAN-UNDERWRITING.
  3458             20  CF-PLAN-TERM-DATA.
  3459                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3460                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3461             20  CF-PLAN-AGE-DATA.
  3462                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3463                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3464                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3465             20  CF-PLAN-BENEFIT-DATA.
  3466                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3467                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3468                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3469                                            PIC S9(7)V99  COMP-3.
  3470         16  CF-PLAN-POLICY-FORMS.
  3471             20  CF-POLICY-FORM             PIC X(12).
  3472             20  CF-MASTER-APPLICATION      PIC X(12).
  3473             20  CF-MASTER-POLICY           PIC X(12).
  3474         16  CF-PLAN-RATING.
  3475             20  CF-RATE-CODE               PIC X(5).
  3476             20  CF-SEX-RATING              PIC X.
  3477                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3478                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3479             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3480             20  CF-SUB-STD-TYPE            PIC X.
  3481                 88  CF-PCT-OF-PREM            VALUE '1'.
  3482                 88  CF-PCT-OF-BENE            VALUE '2'.
  3483         16  CF-PLAN-PREM-TOLERANCES.
  3484             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3485             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3486         16  CF-PLAN-PYMT-TOLERANCES.
  3487             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3488             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3489         16  CF-PLAN-MISC-DATA.
  3490             20  FILLER                     PIC X.
  3491             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3492             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3493         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  62
* NSRLTRBL.cbl
  3494         16  CF-PLAN-IND-GRP                PIC X.
  3495             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3496                                                     '1'.
  3497             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3498                                                     '2'.
  3499         16  CF-MIB-SEARCH-SW               PIC X.
  3500             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3501             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3502             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3503             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3504         16  CF-ALPHA-SEARCH-SW             PIC X.
  3505             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3506             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3507             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3508             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3509             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3510             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3511             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3512             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3513             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3514             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3515                                                     'A' 'B' 'C'
  3516                                                     'X' 'Y' 'Z'.
  3517         16  CF-EFF-DT-RULE-SW              PIC X.
  3518             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3519             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3520             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3521             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3522             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3523         16  FILLER                         PIC X(4).
  3524         16  CF-HEALTH-QUESTIONS            PIC X.
  3525             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3526         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3527         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3528         16  CF-PLAN-SNGL-JNT               PIC X.
  3529             88  CF-COMBINED-PLAN              VALUE 'C'.
  3530             88  CF-JNT-PLAN                   VALUE 'J'.
  3531             88  CF-SNGL-PLAN                  VALUE 'S'.
  3532         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3533         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3534         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3535         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3536         16  CF-RERATE-CNTL                 PIC  X.
  3537             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3538             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3539             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3540             88  CF-AUTO-RECALC                 VALUE '4'.
  3541         16  CF-BENEFIT-TYPE                PIC  X.
  3542             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3543             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3544         16  CF-POLICY-FEE                  PIC S999V99
  3545                                                    COMP-3.
  3546         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3547         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3548         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3549         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3550         16  FILLER                         PIC  X(32).
  3551         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  63
* NSRLTRBL.cbl
  3552         16  FILLER                         PIC  X(08).
  3553         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3554                                                       COMP-3.
  3555         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3556         16  CF-ISSUE-LETTER                PIC  X(4).
  3557         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3558         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3559             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3560             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3561         16  CF-MP-REFUND-CALC              PIC X.
  3562             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3563             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3564             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3565             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3566             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3567             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3568             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3569             88  CF-MP-REFD-MEAN                VALUE '8'.
  3570         16  CF-ALT-RATE-CODE               PIC  X(5).
  3571
  3572
  3573         16  FILLER                         PIC X(498).
  3574****************************************************************
  3575*             MORTGAGE COMPANY MASTER RECORD                   *
  3576****************************************************************
  3577
  3578     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3579         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3580         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3581             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3582             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3583             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3584             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3585             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3586
  3587         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3588         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3589         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3590         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3591         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3592
  3593         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3594             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3595         16  CF-MP-RECON-USE-IND            PIC X(1).
  3596             88  CF-MP-USE-RECON             VALUE 'Y'.
  3597         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3598             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3599         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3600             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3601             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3602         16  FILLER                         PIC X(1).
  3603         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3604             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3605         16  CF-MORTG-MIB-VERSION           PIC X.
  3606             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3607             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3608             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3609         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  64
* NSRLTRBL.cbl
  3610             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3611                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3612             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3613                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3614             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3615                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3616             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3617                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3618             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3619                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3620             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3621                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3622         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3623         16  FILLER                         PIC X(7).
  3624         16  CF-MORTG-DESTINATION-SYMBOL.
  3625             20  CF-MORTG-MIB-COMM          PIC X(5).
  3626             20  CF-MORTG-MIB-TERM          PIC X(5).
  3627         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3628             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3629         16  FILLER                         PIC X(03).
  3630         16  CF-MP-CHECK-NO-CONTROL.
  3631             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3632                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3633                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3634                                                ' ' LOW-VALUES.
  3635                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3636                                               VALUE '3'.
  3637         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3638         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3639         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3640             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3641                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3642             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3643                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3644             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3645                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3646             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3647                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3648             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3649                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3650             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3651                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3652         16  CF-MORTG-BILLING-AREA.
  3653             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3654                                            PIC X.
  3655         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3656         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3657         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3658         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3659             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3660             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3661         16  FILLER                         PIC X.
  3662         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3663             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3664             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3665         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3666         16  FILLER                         PIC X(8).
  3667         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  65
* NSRLTRBL.cbl
  3668         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3669         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3670         16  CF-ACH-COMPANY-ID.
  3671             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3672                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3673                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3674                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3675             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3676         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3677             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3678         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3679             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3680             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3681         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3682         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3683         16  FILLER                         PIC X(536).
  3684
  3685****************************************************************
  3686*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3687****************************************************************
  3688
  3689     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3690         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3691             20  CF-FEMALE-HEIGHT.
  3692                 24  CF-FEMALE-FT           PIC 99.
  3693                 24  CF-FEMALE-IN           PIC 99.
  3694             20  CF-FEMALE-MIN-WT           PIC 999.
  3695             20  CF-FEMALE-MAX-WT           PIC 999.
  3696         16  FILLER                         PIC X(428).
  3697
  3698     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3699         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3700             20  CF-MALE-HEIGHT.
  3701                 24  CF-MALE-FT             PIC 99.
  3702                 24  CF-MALE-IN             PIC 99.
  3703             20  CF-MALE-MIN-WT             PIC 999.
  3704             20  CF-MALE-MAX-WT             PIC 999.
  3705         16  FILLER                         PIC X(428).
  3706******************************************************************
  3707*             AUTOMATIC ACTIVITY RECORD                          *
  3708******************************************************************
  3709     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3710         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3711             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3712             20  CF-SYS-LETTER-ID           PIC X(04).
  3713             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3714             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3715             20  CF-SYS-RESET-SW            PIC X(01).
  3716             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3717             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3718
  3719         16  FILLER                         PIC X(50).
  3720
  3721         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3722             20  CF-USER-ACTIVE-SW          PIC X(01).
  3723             20  CF-USER-LETTER-ID          PIC X(04).
  3724             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3725             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  66
* NSRLTRBL.cbl
  3726             20  CF-USER-RESET-SW           PIC X(01).
  3727             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3728             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3729             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3730
  3731         16  FILLER                         PIC X(246).
  3732*                                COPY NSCVARS.
  3733******************************************************************
  3734*                   C H A N G E   L O G
  3735*
  3736* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3737*-----------------------------------------------------------------
  3738*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3739* EFFECTIVE    NUMBER
  3740*-----------------------------------------------------------------
  3741* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3742* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3743* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3744******************************************************************
  3745 01 NAPER-OUTPUT-DATA.
  3746    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3747    05 OUT-TEMP            PIC X(4).
  3748    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3749    05 OUT-LETTER          PIC X(4).
  3750    05 FILLER              PIC X(6) VALUE "&CARR=".
  3751    05 OUT-CARR            PIC X.
  3752    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3753    05 OUT-CLMNO           PIC X(7).
  3754    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3755    05 OUT-CRTNO           PIC X(11).
  3756    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3757    05 OUT-ACTNO           PIC X(10).
  3758    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3759    05 OUT-ILNAME          PIC X(15).
  3760    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3761    05 OUT-IFNAME          PIC X(10).
  3762    05 FILLER              PIC X(7) VALUE "&SEXCD=".
  3763    05 OUT-SEX-CD          PIC X.
  3764    05 FILLER              PIC X(5) VALUE "&SSN=".
  3765    05 OUT-SSN             PIC X(11).
  3766    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3767    05 OUT-CLMSTAT         PIC X.
  3768    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3769    05 OUT-CLMTYPE         PIC X.
  3770    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3771    05 OUT-EST-DT          PIC X(21).
  3772    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3773    05 OUT-INC-DT          PIC X(21).
  3774    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3775    05 OUT-RPT-DT          PIC X(21).
  3776    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3777    05 OUT-PD-THRU-DT      PIC X(21).
  3778    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3779    05 OUT-FORM-DUE-DT     PIC X(21).
  3780    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3781    05 OUT-LST-PMT-DT      PIC X(21).
  3782    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3783    05 OUT-NO-OF-PMTS      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  67
* NSRLTRBL.cbl
  3784    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3785    05 OUT-TOT-PAID        PIC 9999999.99.
  3786    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3787    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3788    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3789    05 OUT-ADDR-CNT        PIC 9.
  3790    05 FILLER              PIC X(7) VALUE "&CRTST=".
  3791    05 OUT-CRT-ST          PIC XX.
  3792    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3793    05 OUT-CERTACCT        PIC X(10).
  3794    05 FILLER              PIC X(7) VALUE "&EFFDT=".
  3795    05 OUT-EFF-DT          PIC X(21).
  3796    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3797    05 OUT-LST-MAINT-DT    PIC X(21).
  3798    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3799    05 OUT-LST-MAINT-USER  PIC X(10).
  3800    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3801    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3802    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3803    05 OUT-DIAG            PIC X(66).
  3804    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3805    05 OUT-EXP-DT          PIC X(21).
  3806    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3807    05 OUT-LST-CLS-REA     PIC X(10).
  3808    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3809    05 OUT-BIRTH-DT        PIC X(21).
  3810    05 FILLER              PIC X(6) VALUE "&TERM=".
  3811    05 OUT-TERM            PIC 999.
  3812    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3813    05 OUT-BEN-CD          PIC XX.
  3814    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3815    05 OUT-BENAMT          PIC 9999999.99.
  3816    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3817    05 OUT-CRIT-PER        PIC 999.
  3818    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3819    05 OUT-WAIT-PER        PIC XX.
  3820    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
  3821    05 OUT-LF-INT-RATE     PIC 99.99999.
  3822    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3823    05 OUT-AUTO-PY-DT      PIC X(21).
  3824    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3825    05 OUT-AUTO-SCHD-END   PIC X(21).
  3826    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3827    05 OUT-LOAN-NO         PIC X(25).
  3828    05 FILLER              PIC X(5) VALUE "&APR=".
  3829    05 OUT-APR             PIC 99.99999.
  3830    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3831    05 OUT-LST-ACT-DT      PIC X(21).
  3832    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3833    05 OUT-ACT-DT          PIC X(21).
  3834    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3835    05 OUT-LST-ACT-TYPE    PIC X(15).
  3836    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3837    05 OUT-ACT-TYPE        PIC X(15).
  3838    05 FILLER              PIC X(6) VALUE "&FORM=".
  3839    05 OUT-FORM            PIC X(4).
  3840    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3841    05 OUT-INS-NAME        PIC X(36).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  68
* NSRLTRBL.cbl
  3842    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3843    05 OUT-INS-ADDR1       PIC X(36).
  3844    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3845    05 OUT-INS-ADDR2       PIC X(36).
  3846    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3847    05 OUT-INS-CITY        PIC X(28).
  3848    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
  3849    05 OUT-INS-STATE       PIC XX.
  3850    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3851    05 OUT-INS-ZIP         PIC X(10).
  3852    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
  3853    05 OUT-INS-PHONE       PIC X(13).
  3854    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3855    05 OUT-BEN-NAME        PIC X(32).
  3856    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3857    05 OUT-BEN-ADDR1       PIC X(36).
  3858    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3859    05 OUT-BEN-ADDR2       PIC X(32).
  3860    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3861    05 OUT-BEN-CITY        PIC X(28).
  3862    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3863    05 OUT-BEN-STATE       PIC XX.
  3864    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3865    05 OUT-BEN-ZIP         PIC X(10).
  3866    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3867    05 OUT-BEN-PHONE       PIC X(13).
  3868    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3869    05 OUT-ORIG-NAME       PIC X(32).
  3870    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3871    05 OUT-ACCT-NAME       PIC X(32).
  3872    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3873    05 OUT-ACCT-ADDR1      PIC X(36).
  3874    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3875    05 OUT-ACCT-ADDR2      PIC X(32).
  3876    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3877    05 OUT-ACCT-CITY       PIC X(30).
  3878    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
  3879    05 OUT-ACCT-STATE      PIC XX.
  3880    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3881    05 OUT-ACCT-ZIP        PIC X(10).
  3882    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3883    05 OUT-ACCT-PHONE      PIC X(13).
  3884    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3885    05 OUT-ENC-CODE        PIC XXX.
  3886    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3887    05 OUT-ENC-ST          PIC XX.
  3888    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3889    05 OUT-ARCHNO          PIC 999999999.
  3890    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3891    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3892    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3893    05 OUT-NEXT-DUE-DT     PIC X(21).
  3894    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3895    05 OUT-JLNAME          PIC X(15).
  3896    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3897    05 OUT-JFNAME          PIC X(10).
  3898    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3899    05 OUT-ENCLINE         PIC X(100).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  69
* NSRLTRBL.cbl
  3900    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3901    05 OUT-ENCATTS         PIC X(100).
  3902    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3903    05 OUT-OUTSTACK        PIC X.
  3904    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3905    05 OUT-PROCID          PIC XXXX.
  3906    05 FILLER              PIC X(8) VALUE "&COMPID=".
  3907    05 OUT-COMPID          PIC XXX.
  3908    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3909    05 OUT-PRINT-NOW-SW    PIC X.
  3910    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
  3911    05 OUT-CYCLE-DATE      PIC X(8).
  3912    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3913    05 OUT-ENC-ST-NAME     PIC XX.
  3914    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3915    05 OUT-CARR-LU         PIC X.
  3916    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3917    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3918    05 FILLER              PIC X(4) VALUE "&GP=".
  3919    05 OUT-ACCT-GPCD       PIC 99.
  3920    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3921    05 OUT-MAX-BENS        PIC 9(3).
  3922    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3923    05 OUT-PAID-BENS       PIC 9(3).
  3924    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3925    05 OUT-REM-BENS        PIC 9(3).
  3926    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3927    05 OUT-EXCL-PER        PIC 9(3).
  3928    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3929    05 OUT-REC-MOS         PIC 9(2).
  3930    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3931    05 OUT-INS-TYP         PIC X(4).
  3932    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3933    05 OUT-BEN-PER         PIC 9(2).
  3934    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3935    05 OUT-ACC-SW          PIC X.
  3936 01  FILLER                      PIC X(500)  VALUE SPACES.
  3937*                                COPY ELCNAPS.
  3938******************************************************************
  3939*                                                                *
  3940*                            ELCNAPS                             *
  3941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3942*                            VMOD=2.003                          *
  3943*                                                                *
  3944*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3945*                                                                *
  3946*        FILE TYPE= VSAM,KSDS                                    *
  3947*        RECORD SIZE = 150    RECFORM = FIXED                    *
  3948*                                                                *
  3949*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  3950*                                                                *
  3951*        LOG = YES                                               *
  3952*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3953*                                                                *
  3954******************************************************************
  3955*                   C H A N G E   L O G
  3956*
  3957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  70
* NSRLTRBL.cbl
  3958*-----------------------------------------------------------------
  3959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3960* EFFECTIVE    NUMBER
  3961*-----------------------------------------------------------------
  3962* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  3963******************************************************************
  3964
  3965 01  NAPERSOFT-FILE.
  3966     12  NA-RECORD-ID                PIC  XX.
  3967         88  VALID-NA-ID                  VALUE 'NA'.
  3968
  3969     12  NA-CONTROL-PRIMARY.
  3970         16  NA-COMPANY-CD           PIC X.
  3971         16  NA-CARRIER              PIC X.
  3972         16  NA-CLAIM-NO             PIC X(7).
  3973         16  NA-CERT-NO.
  3974             20  NA-CERT-PRIME       PIC X(10).
  3975             20  NA-CERT-SFX         PIC X.
  3976         16  NA-ARCHIVE-NO           PIC 9(8).
  3977
  3978     12  NA-LETTER-INFORMATION.
  3979         16  NA-LETTER-ID            PIC X(4).
  3980         16  NA-PROCESSOR-ID         PIC X(4).
  3981         16  NA-CREATION-DT          PIC X(2).
  3982         16  NA-INITIAL-PRINT-DT     PIC X(2).
  3983         16  NA-FOLLOW-UP-DT         PIC X(2).
  3984         16  NA-RESEND-DT            PIC X(2).
  3985         16  NA-RESEND-LETTER-ID     PIC X(4).
  3986         16  NA-NO-OF-COPIES         PIC 9(2).
  3987         16  NA-ADDRESS-TYPE         PIC X(2).
  3988         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  3989         16  NA-RESEND-PRINT-DT      PIC X(2).
  3990         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  3991         16  NA-NEXT-DUE-DT          PIC X(2).
  3992         16  NA-AUTOPYDT             PIC X(2).
  3993         16  NA-ENCLOSURE-CD         PIC X(3).
  3994         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
  3995         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  3996         16  NA-RESEND-PROMPT-IND    PIC X(1).
  3997         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  3998         16  FILLER                  PIC X(67).
  3999******************************************************************
  4000*                                COPY ELCENCC.
  4001******************************************************************
  4002*                                                                *
  4003*                                                                *
  4004*                            ELCENCC                             *
  4005*                            VMOD=2.001                          *
  4006*                                                                *
  4007*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4008*                                                                *
  4009*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4010*   A NAPERSOFT DOCUMENT                                         *
  4011*                                                                *
  4012*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4013*                                                                *
  4014*   FILE TYPE = VSAM,KSDS                                        *
  4015*   RECORD SIZE = 400   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  71
* NSRLTRBL.cbl
  4016*                                                                *
  4017*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4018*                                                                *
  4019*   LOG = NO                                                     *
  4020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4021*                                                                *
  4022*                                                                *
  4023******************************************************************
  4024*                   C H A N G E   L O G
  4025*
  4026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4027*-----------------------------------------------------------------
  4028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4029* EFFECTIVE    NUMBER
  4030*-----------------------------------------------------------------
  4031* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4032******************************************************************
  4033 01  ENCLOSURE-CODES.
  4034     12  NC-RECORD-ID                      PIC XX.
  4035         88  VALID-NC-ID                      VALUE 'NC'.
  4036     12  NC-CONTROL-PRIMARY.
  4037         16  NC-COMPANY-CD                 PIC X.
  4038         16  NC-REC-TYPE                   PIC X.
  4039             88  NC-CLAIMS                   VALUE '1'.
  4040             88  NC-ADMIN                    VALUE '2'.
  4041         16  NC-ENC-CODE                   PIC X(5).
  4042         16  FILLER                        PIC X(09).
  4043     12  NC-MAINT-INFORMATION.
  4044         16  NC-LAST-MAINT-DT              PIC XX.
  4045         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4046         16  NC-LAST-MAINT-USER            PIC X(4).
  4047         16  FILLER                        PIC XX.
  4048     12  NC-OUTPUT-STACK                   PIC XXX.
  4049     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4050     12  NC-ATTACHMENTS                    PIC X(100).
  4051     12  NC-FUTURE                         PIC X(50).
  4052     12  FILLER                            PIC X(117).
  4053******************************************************************
  4054*                                COPY ELCCRTT.
  4055******************************************************************
  4056*                                                                *
  4057*                            ELCCRTT.                            *
  4058*                                                                *
  4059*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4060*                                                                *
  4061*   FILE TYPE = VSAM,KSDS                                        *
  4062*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4063*                                                                *
  4064*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4065*                                                                *
  4066*   LOG = YES                                                    *
  4067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4068******************************************************************
  4069*                   C H A N G E   L O G
  4070*
  4071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4072*-----------------------------------------------------------------
  4073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  72
* NSRLTRBL.cbl
  4074* EFFECTIVE    NUMBER
  4075*-----------------------------------------------------------------
  4076* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4077* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4078* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4079* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4080* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4081* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4082* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4083* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4084* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  4085******************************************************************
  4086
  4087 01  CERTIFICATE-TRAILERS.
  4088     12  CS-RECORD-ID                      PIC XX.
  4089         88  VALID-CS-ID                      VALUE 'CS'.
  4090
  4091     12  CS-CONTROL-PRIMARY.
  4092         16  CS-COMPANY-CD                 PIC X.
  4093         16  CS-CARRIER                    PIC X.
  4094         16  CS-GROUPING                   PIC X(6).
  4095         16  CS-STATE                      PIC XX.
  4096         16  CS-ACCOUNT                    PIC X(10).
  4097         16  CS-CERT-EFF-DT                PIC XX.
  4098         16  CS-CERT-NO.
  4099             20  CS-CERT-PRIME             PIC X(10).
  4100             20  CS-CERT-SFX               PIC X.
  4101         16  CS-TRAILER-TYPE               PIC X.
  4102             88  COMM-TRLR           VALUE 'A'.
  4103             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4104             88  CERT-DATA-TRLR      VALUE 'C'.
  4105
  4106     12  CS-DATA-AREA                      PIC X(516).
  4107
  4108     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4109         16  CS-BANK-COMMISSION-AREA.
  4110             20  CS-BANK-COMMS       OCCURS 10.
  4111                 24  CS-AGT                PIC X(10).
  4112                 24  CS-COM-TYP            PIC X.
  4113                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4114                 24  CS-RECALC-LV-INDIC    PIC X.
  4115                 24  FILLER                PIC X(10).
  4116         16  FILLER                        PIC X(256).
  4117
  4118     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4119****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4120         16  CS-MB-CLAIM-DATA OCCURS 24.
  4121             20  CS-CLAIM-NO               PIC X(7).
  4122             20  CS-CLAIM-TYPE             PIC X.
  4123                 88  CS-AH-CLM               VALUE 'A'.
  4124                 88  CS-IU-CLM               VALUE 'I'.
  4125                 88  CS-GP-CLM               VALUE 'G'.
  4126                 88  CS-LF-CLM               VALUE 'L'.
  4127                 88  CS-PR-CLM               VALUE 'P'.
  4128                 88  CS-FL-CLM               VALUE 'F'.
  4129             20  CS-INSURED-TYPE           PIC X.
  4130                 88  CS-PRIM-INSURED          VALUE 'P'.
  4131                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  73
* NSRLTRBL.cbl
  4132             20  CS-BENEFIT-PERIOD         PIC 99.
  4133             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  4134             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4135             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  4136         16  FILLER                        PIC X(12).
  4137     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4138         16  CS-VIN-NUMBER                 PIC X(17).
  4139         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4140         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4141         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4142         16  cs-agent-name.
  4143             20  cs-agent-fname            pic x(20).
  4144             20  cs-agent-mi               pic x.
  4145             20  cs-agent-lname            pic x(25).
  4146         16  cs-license-no                 pic x(15).
  4147         16  cs-npn-number                 pic x(10).
  4148         16  cs-agent-edit-status          pic x.
  4149             88  cs-ae-refer-to-manager      value 'M'.
  4150             88  cs-ae-cover-sheet           value 'C'.
  4151             88  cs-ae-sig-form              value 'S'.
  4152             88  cs-ae-verified              value 'V'.
  4153             88  cs-unidentified-signature   value 'U'.
  4154             88  cs-cert-returned            value 'R'.
  4155             88  cs-accept-no-commission     value 'N'.
  4156         16  cs-year                       pic 9999.
  4157         16  cs-make                       pic x(20).
  4158         16  cs-model                      pic x(20).
  4159         16  cs-future                     pic x(20).
  4160         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4161         16  FILLER                        PIC X(356). *> was 420
  4162*        16  FILLER                        PIC X(496).
  4163*                                COPY ERCPDEF.
  4164******************************************************************
  4165*                                                                *
  4166*                                                                *
  4167*                            ERCPDEF.                            *
  4168*                                                                *
  4169*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4170*                                                                *
  4171*    FILE TYPE = VSAM,KSDS                                       *
  4172*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4173*                                                                *
  4174*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  4175*                                                                *
  4176*    LOG = YES                                                   *
  4177*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4178******************************************************************
  4179*                   C H A N G E   L O G
  4180*
  4181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4182*-----------------------------------------------------------------
  4183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4184* EFFECTIVE    NUMBER
  4185*-----------------------------------------------------------------
  4186* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4187* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4188* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  74
* NSRLTRBL.cbl
  4190 01  PRODUCT-MASTER.
  4191    12  PD-RECORD-ID                 PIC X(02).
  4192        88  VALID-PD-ID                  VALUE 'PD'.
  4193    12  PD-CONTROL-PRIMARY.
  4194        16  PD-COMPANY-CD            PIC X.
  4195        16  PD-STATE                 PIC XX.
  4196        16  PD-PRODUCT-CD            PIC XXX.
  4197        16  PD-FILLER                PIC X(7).
  4198        16  PD-BEN-TYPE              PIC X.
  4199        16  PD-BEN-CODE              PIC XX.
  4200        16  PD-PROD-EXP-DT           PIC XX.
  4201    12  FILLER                       PIC X(50).
  4202    12  PD-PRODUCT-DATA OCCURS 8.
  4203        16  PD-PROD-CODE             PIC X.
  4204            88  PD-PROD-LIFE           VALUE 'L'.
  4205            88  PD-PROD-PROP           VALUE 'P'.
  4206            88  PD-PROD-AH             VALUE 'A'.
  4207            88  PD-PROD-IU             VALUE 'I'.
  4208            88  PD-PROD-GAP            VALUE 'G'.
  4209            88  PD-PROD-FAML           VALUE 'F'.
  4210        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4211        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4212        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4213        16  PD-MAX-TERM              PIC S999        COMP-3.
  4214        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4215        16  FILLER                   PIC X.
  4216        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4217        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4218        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4219        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4220        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4221        16  PD-REC-CRIT-PERIOD       PIC 99.
  4222        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4223            20  PD-RECURRING-YN      PIC X.
  4224            20  FILLER               PIC X.
  4225        16  PD-RTW-MOS               PIC 99.
  4226        16  PD-MAX-EXTENSION         PIC 99.
  4227        16  pd-ben-pct               pic sv999 comp-3.
  4228*       16  FILLER                   PIC XX.
  4229    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  4230    12  PD-TERM-LIMITS OCCURS 15.
  4231        16  PD-LOW-TERM              PIC S999        COMP-3.
  4232        16  PD-HI-TERM               PIC S999        COMP-3.
  4233*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4234    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4235        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  4236        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4237    12  PD-EARN-FACTORS.
  4238        16  FILLER OCCURS 15.
  4239            20  FILLER OCCURS 15.
  4240                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4241    12  PD-PRODUCT-DESC              PIC X(80).
  4242    12  PD-TRUNCATED                 PIC X.
  4243    12  FILLER                       PIC X(59).
  4244    12  PD-MAINT-INFORMATION.
  4245        16  PD-LAST-MAINT-DT         PIC X(02).
  4246        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4247        16  PD-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  75
* NSRLTRBL.cbl
  4248****************************************************************
  4249*
  4250* Copyright (c) 2007 by Clerity Solutions, Inc.
  4251* All rights reserved.
  4252*
  4253****************************************************************
  4254 01  DFHEIV.
  4255   02  DFHEIV0               PIC X(35).
  4256   02  DFHEIV1               PIC X(08).
  4257   02  DFHEIV2               PIC X(08).
  4258   02  DFHEIV3               PIC X(08).
  4259   02  DFHEIV4               PIC X(06).
  4260   02  DFHEIV5               PIC X(04).
  4261   02  DFHEIV6               PIC X(04).
  4262   02  DFHEIV7               PIC X(02).
  4263   02  DFHEIV8               PIC X(02).
  4264   02  DFHEIV9               PIC X(01).
  4265   02  DFHEIV10              PIC S9(7) COMP-3.
  4266   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4267   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4268   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4269   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4270   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4271   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4272   02  DFHEIV17              PIC X(04).
  4273   02  DFHEIV18              PIC X(04).
  4274   02  DFHEIV19              PIC X(04).
  4275   02  DFHEIV20              USAGE IS POINTER.
  4276   02  DFHEIV21              USAGE IS POINTER.
  4277   02  DFHEIV22              USAGE IS POINTER.
  4278   02  DFHEIV23              USAGE IS POINTER.
  4279   02  DFHEIV24              USAGE IS POINTER.
  4280   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4281   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4282   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4283   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4284   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4285   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4286   02  FILLER                PIC X(02).
  4287   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4288   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4289   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4290   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4291   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4292 LINKAGE  SECTION.
  4293*****************************************************************
  4294*                                                               *
  4295* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4296* All rights reserved.                                          *
  4297*                                                               *
  4298*****************************************************************
  4299 01  dfheiblk.
  4300     02  eibtime          pic s9(7) comp-3.
  4301     02  eibdate          pic s9(7) comp-3.
  4302     02  eibtrnid         pic x(4).
  4303     02  eibtaskn         pic s9(7) comp-3.
  4304     02  eibtrmid         pic x(4).
  4305     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  76
* NSRLTRBL.cbl
  4306     02  eibcposn         pic s9(4) comp.
  4307     02  eibcalen         pic s9(4) comp.
  4308     02  eibaid           pic x(1).
  4309     02  eibfiller1       pic x(1).
  4310     02  eibfn            pic x(2).
  4311     02  eibfiller2       pic x(2).
  4312     02  eibrcode         pic x(6).
  4313     02  eibfiller3       pic x(2).
  4314     02  eibds            pic x(8).
  4315     02  eibreqid         pic x(8).
  4316     02  eibrsrce         pic x(8).
  4317     02  eibsync          pic x(1).
  4318     02  eibfree          pic x(1).
  4319     02  eibrecv          pic x(1).
  4320     02  eibsend          pic x(1).
  4321     02  eibatt           pic x(1).
  4322     02  eibeoc           pic x(1).
  4323     02  eibfmh           pic x(1).
  4324     02  eibcompl         pic x(1).
  4325     02  eibsig           pic x(1).
  4326     02  eibconf          pic x(1).
  4327     02  eiberr           pic x(1).
  4328     02  eibrldbk         pic x(1).
  4329     02  eiberrcd         pic x(4).
  4330     02  eibsynrb         pic x(1).
  4331     02  eibnodat         pic x(1).
  4332     02  eibfiller5       pic x(2).
  4333     02  eibresp          pic 9(09) comp.
  4334     02  eibresp2         pic 9(09) comp.
  4335     02  dfheigdj         pic s9(4) comp.
  4336     02  dfheigdk         pic s9(4) comp.
  4337 01 dfhcommarea.
  4338*                                copy ELCLTRSPI.
  4339******************************************************************
  4340*                   C H A N G E   L O G
  4341*
  4342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4343*-----------------------------------------------------------------
  4344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4345* EFFECTIVE    NUMBER
  4346*-----------------------------------------------------------------
  4347* 121802    2009122800001  PEMA  NEW COPYBOOK
  4348******************************************************************
  4349****************************************
  4350*  commarea for NaperSoft On Demand Claim letters
  4351*  (business logic input & output)
  4352****************************************
  4353     03  BL-INPUT.
  4354         05  BL-CARRIER          PIC X.
  4355         05  BL-CLAIM-NO         PIC X(7).
  4356         05  BL-CERT-NO          PIC X(11).
  4357         05  BL-LETTER-ID        PIC XXXX.
  4358         05  BL-FOLLOW-UP-DT     PIC X(10).
  4359         05  BL-RESEND-DT        PIC X(10).
  4360         05  BL-NO-OF-COPIES     PIC 99.
  4361         05  BL-PROC-ID          PIC XXXX.
  4362         05  BL-COMP-ID          PIC XXX.
  4363         05  BL-PRINT-NOW-SW     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  77
* NSRLTRBL.cbl
  4364         05  BL-ENC-CD           PIC XXX.
  4365         05  BL-ARCHIVE-NO       PIC 9(8).
  4366         05  BL-REGARDING        PIC X(70).
  4367     03  BL-OUTPUT.
  4368         05  BL-STATUS                   PIC X.
  4369             88  BL-OK                      VALUE "P".
  4370             88  BL-FAIL                  VALUE "F".
  4371         05  BL-MESSAGE          PIC X(50).
  4372     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4373 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4374 0000-DFHEXIT SECTION.
  4375     MOVE '9#                    $   ' TO DFHEIV0.
  4376     MOVE 'NSRLTRBL' TO DFHEIV1.
  4377     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4378     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4379     MOVE '5'                    TO DC-OPTION-CODE
  4380     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4381     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4382     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4383     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4384*****************************************************
  4385* The full claim key has been established and passed
  4386* to this program via NSREQLTR
  4387*****************************************************
  4388     IF BL-COMP-ID = 'DCC'
  4389        MOVE X'05'               TO WS-ELMSTR-COMPANY-CD
  4390     ELSE
  4391       IF BL-COMP-ID = 'AHL'
  4392        MOVE X'06'               TO WS-ELMSTR-COMPANY-CD
  4393       ELSE
  4394        MOVE X'04'               TO WS-ELMSTR-COMPANY-CD
  4395       END-IF
  4396     END-IF
  4397     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4398     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4399     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4400     SET BL-FAIL TO TRUE
  4401
  4402* EXEC CICS READ
  4403*         DATASET    ('ELMSTR')
  4404*         INTO       (CLAIM-MASTER)
  4405*         RIDFLD     (WS-ELMSTR-KEY)
  4406*         RESP       (WS-RESPONSE)
  4407*    END-EXEC.
  4408     MOVE LENGTH OF
  4409      CLAIM-MASTER
  4410       TO DFHEIV11
  4411     MOVE 'ELMSTR' TO DFHEIV1
  4412*    MOVE '&"IL       E          (  N#00004397' TO DFHEIV0
  4413     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4415     MOVE X'204E233030303034333937' TO DFHEIV0(25:11)
  4416     CALL 'kxdfhei1' USING DFHEIV0,
  4417           DFHEIV1,
  4418           CLAIM-MASTER,
  4419           DFHEIV11,
  4420           WS-ELMSTR-KEY,
  4421           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  78
* NSRLTRBL.cbl
  4422           DFHEIV99,
  4423           DFHEIV99
  4424     MOVE EIBRESP  TO WS-RESPONSE
  4425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4426
  4427     IF RESP-NORMAL
  4428        MOVE BL-LETTER-ID        TO OUT-TEMP
  4429                                    OUT-LETTER
  4430        MOVE BL-PROC-ID          TO OUT-PROCID
  4431        MOVE BL-COMP-ID          TO OUT-COMPID
  4432        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4433        MOVE CL-CARRIER          TO OUT-CARR
  4434                                    OUT-CARR-LU
  4435        MOVE CL-INSURED-LAST-NAME
  4436                                 TO OUT-ILNAME
  4437        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4438        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4439        MOVE CL-CERT-NO          TO OUT-CRTNO
  4440        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4441        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4442        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4443        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4444        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4445        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4446          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4447        END-STRING
  4448*       IF CLAIM-IS-CLOSED
  4449*          MOVE 'CLOSED'         TO OUT-CLMSTAT
  4450*       ELSE
  4451*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4452*       END-IF
  4453        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4454        MOVE CL-FILE-ESTABLISH-DT
  4455                                 TO DC-BIN-DATE-1
  4456        MOVE ' '                 TO DC-OPTION-CODE
  4457        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4458        IF NO-CONVERSION-ERROR
  4459           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4460              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4461              INTO OUT-EST-DT
  4462           END-STRING
  4463        ELSE
  4464           MOVE SPACES           TO OUT-EST-DT
  4465        END-IF
  4466        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4467        MOVE ' '                 TO DC-OPTION-CODE
  4468        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4469        IF NO-CONVERSION-ERROR
  4470           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4471              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4472              INTO OUT-PD-THRU-DT
  4473           END-STRING
  4474        ELSE
  4475           MOVE SPACES           TO OUT-PD-THRU-DT
  4476        END-IF
  4477        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4478        MOVE +0                  TO DC-ELAPSED-MONTHS
  4479        MOVE +30                 TO DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  79
* NSRLTRBL.cbl
  4480        MOVE '6'                 TO DC-OPTION-CODE
  4481        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4482        IF NO-CONVERSION-ERROR
  4483           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4484              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4485              INTO OUT-FORM-DUE-DT
  4486           END-STRING
  4487        ELSE
  4488           MOVE SPACES           TO OUT-FORM-DUE-DT
  4489        END-IF
  4490        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4491        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4492        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4493                                    OUT-ENC-ST
  4494                                    OUT-ENC-ST-NAME
  4495        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4496        MOVE ' '                 TO DC-OPTION-CODE
  4497        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4498        IF NO-CONVERSION-ERROR
  4499           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4500              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4501              INTO OUT-EFF-DT
  4502           END-STRING
  4503        ELSE
  4504           MOVE SPACES           TO OUT-EFF-DT
  4505        END-IF
  4506        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  4507        MOVE ' '                 TO DC-OPTION-CODE
  4508        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4509        IF NO-CONVERSION-ERROR
  4510           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4511              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4512              INTO OUT-INC-DT
  4513           END-STRING
  4514        ELSE
  4515           MOVE SPACES           TO OUT-INC-DT
  4516        END-IF
  4517        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4518        MOVE ' '                 TO DC-OPTION-CODE
  4519        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4520        IF NO-CONVERSION-ERROR
  4521           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4522              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4523              INTO OUT-RPT-DT
  4524           END-STRING
  4525        ELSE
  4526           MOVE SPACES           TO OUT-RPT-DT
  4527        END-IF
  4528        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4529        MOVE ' '                 TO DC-OPTION-CODE
  4530        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4531        IF NO-CONVERSION-ERROR
  4532           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4533              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4534              INTO OUT-LST-PMT-DT
  4535           END-STRING
  4536        ELSE
  4537           MOVE SPACES           TO OUT-LST-PMT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  80
* NSRLTRBL.cbl
  4538        END-IF
  4539        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4540        MOVE ' '                 TO DC-OPTION-CODE
  4541        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4542        IF NO-CONVERSION-ERROR
  4543           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4544              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4545              INTO OUT-BIRTH-DT
  4546           END-STRING
  4547        ELSE
  4548           MOVE SPACES           TO OUT-BIRTH-DT
  4549        END-IF
  4550        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4551        MOVE ' '                 TO DC-OPTION-CODE
  4552        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4553        IF NO-CONVERSION-ERROR
  4554           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4555              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4556              INTO OUT-LST-MAINT-DT
  4557           END-STRING
  4558        ELSE
  4559           MOVE SPACES           TO OUT-LST-MAINT-DT
  4560        END-IF
  4561        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4562        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4563        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4564        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
  4565        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
  4566        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4567        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4568        PERFORM 1000-GET-FILES   THRU 1000-EXIT
  4569        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4570        SET BL-OK TO TRUE
  4571     END-IF
  4572     IF BL-OK
  4573        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4574        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
  4575        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4576        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4577*       PERFORM 1600-ADD-CORR-TRLR
  4578*                                THRU 1600-EXIT
  4579     END-IF
  4580
  4581* exec cics return end-exec.
  4582*    MOVE '.(                    ''   #00004556' TO DFHEIV0
  4583     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4584     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4585     MOVE X'2020233030303034353536' TO DFHEIV0(25:11)
  4586     CALL 'kxdfhei1' USING DFHEIV0,
  4587           DFHEIV99,
  4588           DFHEIV99,
  4589           DFHEIV99,
  4590           DFHEIV99,
  4591           DFHEIV99,
  4592           DFHEIV99
  4593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4594
  4595 0500-SCRUB-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  81
* NSRLTRBL.cbl
  4596*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4597*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4598*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4599*   TO A HEX 26 TO GET BY THE DECODER
  4600     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4601                                 TO M1
  4602     MOVE SPACES                 TO WS-WORK-FIELD
  4603     perform varying a1 from +1 by +1 until a1 > m1
  4604        if out-ilname (a1:1) = '&'
  4605           MOVE OUT-ILNAME (1:A1 - 1)
  4606                                 TO WS-WORK-FIELD (1:A1 - 1)
  4607           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4608           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4609                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4610           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4611           add +2 to a1
  4612        end-if
  4613     end-perform
  4614     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4615                                 TO M1
  4616     MOVE SPACES                 TO WS-WORK-FIELD
  4617     perform varying a1 from +1 by +1 until a1 > m1
  4618        if out-acct-addr1 (a1:1) = '&'
  4619           MOVE out-acct-addr1 (1:A1 - 1)
  4620                                 TO WS-WORK-FIELD (1:A1 - 1)
  4621           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4622           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4623                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4624           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4625           add +2 to a1
  4626        end-if
  4627     end-perform
  4628     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
  4629                                 TO M1
  4630     MOVE SPACES                 TO WS-WORK-FIELD
  4631     perform varying a1 from +1 by +1 until a1 > m1
  4632        if out-acct-addr2 (a1:1) = '&'
  4633           MOVE out-acct-addr2 (1:A1 - 1)
  4634                                 TO WS-WORK-FIELD (1:A1 - 1)
  4635           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4636           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4637                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4638           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4639           add +2 to a1
  4640        end-if
  4641     end-perform
  4642     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4643                                 TO M1
  4644     MOVE SPACES                 TO WS-WORK-FIELD
  4645     perform varying a1 from +1 by +1 until a1 > m1
  4646        if out-acct-city (a1:1) = '&'
  4647           MOVE out-acct-city (1:A1 - 1)
  4648                                 TO WS-WORK-FIELD (1:A1 - 1)
  4649           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4650           MOVE out-acct-city (A1 + 1:M1 - A1)
  4651                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4652           MOVE WS-WORK-FIELD    TO out-acct-city
  4653           add +2 to a1
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  82
* NSRLTRBL.cbl
  4654        end-if
  4655     end-perform
  4656     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4657                                 TO M1
  4658     MOVE SPACES                 TO WS-WORK-FIELD
  4659     perform varying a1 from +1 by +1 until a1 > m1
  4660        if out-acct-name (a1:1) = '&'
  4661           MOVE out-acct-name (1:A1 - 1)
  4662                                 TO WS-WORK-FIELD (1:A1 - 1)
  4663           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4664           MOVE out-acct-name (A1 + 1:M1 - A1)
  4665                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4666           MOVE WS-WORK-FIELD    TO out-acct-name
  4667           add +2 to a1
  4668        end-if
  4669     end-perform
  4670     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4671                                 TO M1
  4672     MOVE SPACES                 TO WS-WORK-FIELD
  4673     perform varying a1 from +1 by +1 until a1 > m1
  4674        if out-orig-name (a1:1) = '&'
  4675           MOVE out-orig-name (1:A1 - 1)
  4676                                 TO WS-WORK-FIELD (1:A1 - 1)
  4677           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4678           MOVE out-orig-name (A1 + 1:M1 - A1)
  4679                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4680           MOVE WS-WORK-FIELD    TO out-orig-name
  4681           add +2 to a1
  4682        end-if
  4683     end-perform
  4684     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4685                                 TO M1
  4686     MOVE SPACES                 TO WS-WORK-FIELD
  4687     perform varying a1 from +1 by +1 until a1 > m1
  4688        if out-ins-name (a1:1) = '&'
  4689           MOVE out-ins-name (1:A1 - 1)
  4690                                 TO WS-WORK-FIELD (1:A1 - 1)
  4691           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4692           MOVE out-ins-name (A1 + 1:M1 - A1)
  4693                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4694           MOVE WS-WORK-FIELD    TO out-ins-name
  4695           add +2 to a1
  4696        end-if
  4697     end-perform
  4698     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4699                                 TO M1
  4700     MOVE SPACES                 TO WS-WORK-FIELD
  4701     perform varying a1 from +1 by +1 until a1 > m1
  4702        if out-ins-addr1 (a1:1) = '&'
  4703           MOVE out-ins-addr1 (1:A1 - 1)
  4704                                 TO WS-WORK-FIELD (1:A1 - 1)
  4705           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4706           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4707                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4708           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4709           add +2 to a1
  4710        end-if
  4711     end-perform
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  83
* NSRLTRBL.cbl
  4712     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4713                                 TO M1
  4714     MOVE SPACES                 TO WS-WORK-FIELD
  4715     perform varying a1 from +1 by +1 until a1 > m1
  4716        if out-ins-addr2 (a1:1) = '&'
  4717           MOVE out-ins-addr2 (1:A1 - 1)
  4718                                 TO WS-WORK-FIELD (1:A1 - 1)
  4719           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4720           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4721                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4722           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4723           add +2 to a1
  4724        end-if
  4725     end-perform
  4726     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4727     MOVE SPACES                 TO WS-WORK-FIELD
  4728     perform varying a1 from +1 by +1 until a1 > m1
  4729        if out-ben-name (a1:1) = '&'
  4730           MOVE out-ben-name (1:A1 - 1)
  4731                                 TO WS-WORK-FIELD (1:A1 - 1)
  4732           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4733           MOVE out-ben-name (A1 + 1:M1 - A1)
  4734                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4735           MOVE WS-WORK-FIELD    TO out-ben-name
  4736           add +2 to a1
  4737        end-if
  4738     end-perform
  4739     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
  4740                                 TO M1
  4741     MOVE SPACES                 TO WS-WORK-FIELD
  4742     perform varying a1 from +1 by +1 until a1 > m1
  4743        if out-ben-addr1 (a1:1) = '&'
  4744           MOVE out-ben-addr1 (1:A1 - 1)
  4745                                 TO WS-WORK-FIELD (1:A1 - 1)
  4746           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4747           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4748                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4749           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4750           add +2 to a1
  4751        end-if
  4752     end-perform
  4753     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4754                                 TO M1
  4755     MOVE SPACES                 TO WS-WORK-FIELD
  4756     perform varying a1 from +1 by +1 until a1 > m1
  4757        if out-ben-addr2 (a1:1) = '&'
  4758           MOVE out-ben-addr2 (1:A1 - 1)
  4759                                 TO WS-WORK-FIELD (1:A1 - 1)
  4760           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4761           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4762                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4763           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4764           add +2 to a1
  4765        end-if
  4766     end-perform
  4767     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4768     MOVE SPACES                 TO WS-WORK-FIELD
  4769     perform varying a1 from +1 by +1 until a1 > m1
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  84
* NSRLTRBL.cbl
  4770        if out-diag (a1:1) = '&'
  4771           MOVE out-diag (1:A1 - 1)
  4772                                 TO WS-WORK-FIELD (1:A1 - 1)
  4773           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4774           MOVE out-diag (A1 + 1:M1 - A1)
  4775                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4776           MOVE WS-WORK-FIELD    TO out-diag
  4777           add +2 to a1
  4778        end-if
  4779     end-perform
  4780     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4781     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4782        FOR ALL '%'
  4783     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4784        FOR ALL '%26'
  4785     IF (WS-TALLY > 0)
  4786        AND (WS-TALLY NOT = WS-TALLY1)
  4787        MOVE +1                  TO A1
  4788        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4789                                 TO NS-LEN
  4790        PERFORM WS-TALLY TIMES
  4791           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4792              (A1 > NS-LEN)
  4793              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4794           END-PERFORM
  4795           IF A1 > NS-LEN
  4796              CONTINUE
  4797           ELSE
  4798              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4799                 ADD +1 TO A1
  4800              ELSE
  4801                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4802                                 TO WS-XML-WORK
  4803                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4804                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4805                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4806                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
  4807                 ADD +3 TO A1
  4808              END-IF
  4809           END-IF
  4810        END-PERFORM
  4811     END-IF
  4812     .
  4813 0500-EXIT.
  4814     EXIT.
  4815 1000-GET-FILES.
  4816     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4817     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4818     MOVE ' '                    TO WS-FOUND-BENE-SW
  4819     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4820     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4821     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4822     IF CL-CLAIM-TYPE NOT = 'L' AND 'P'
  4823        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4824     END-IF
  4825     IF NOT FOUND-BENE
  4826        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4827        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  85
* NSRLTRBL.cbl
  4828        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4829
  4830* EXEC CICS READ
  4831*            DATASET    ('ELBENE')
  4832*            INTO       (BENEFICIARY-MASTER)
  4833*            RIDFLD     (WS-ELBENE-KEY)
  4834*            RESP       (WS-RESPONSE)
  4835*       END-EXEC
  4836     MOVE LENGTH OF
  4837      BENEFICIARY-MASTER
  4838       TO DFHEIV11
  4839     MOVE 'ELBENE' TO DFHEIV1
  4840*    MOVE '&"IL       E          (  N#00004791' TO DFHEIV0
  4841     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4843     MOVE X'204E233030303034373931' TO DFHEIV0(25:11)
  4844     CALL 'kxdfhei1' USING DFHEIV0,
  4845           DFHEIV1,
  4846           BENEFICIARY-MASTER,
  4847           DFHEIV11,
  4848           WS-ELBENE-KEY,
  4849           DFHEIV99,
  4850           DFHEIV99,
  4851           DFHEIV99
  4852     MOVE EIBRESP  TO WS-RESPONSE
  4853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4854        IF RESP-NORMAL
  4855           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
  4856           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4857           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  4858           MOVE BE-CITY           TO OUT-BEN-CITY
  4859           MOVE BE-STATE          TO OUT-BEN-STATE
  4860           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
  4861           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4862              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4863                 INTO OUT-BEN-ZIP (6:5)
  4864              END-STRING
  4865           END-IF
  4866           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4867        END-IF
  4868     END-IF
  4869     .
  4870 1000-EXIT.
  4871     EXIT.
  4872 1100-GET-ELCERT.
  4873     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4874     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4875     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4876
  4877* EXEC CICS READ
  4878*         DATASET    ('ELCERT')
  4879*         INTO       (CERTIFICATE-MASTER)
  4880*         RIDFLD     (WS-ELCERT-KEY)
  4881*         RESP       (WS-RESPONSE)
  4882*    END-EXEC.
  4883     MOVE LENGTH OF
  4884      CERTIFICATE-MASTER
  4885       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  86
* NSRLTRBL.cbl
  4886     MOVE 'ELCERT' TO DFHEIV1
  4887*    MOVE '&"IL       E          (  N#00004819' TO DFHEIV0
  4888     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4890     MOVE X'204E233030303034383139' TO DFHEIV0(25:11)
  4891     CALL 'kxdfhei1' USING DFHEIV0,
  4892           DFHEIV1,
  4893           CERTIFICATE-MASTER,
  4894           DFHEIV11,
  4895           WS-ELCERT-KEY,
  4896           DFHEIV99,
  4897           DFHEIV99,
  4898           DFHEIV99
  4899     MOVE EIBRESP  TO WS-RESPONSE
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4901
  4902     IF RESP-NORMAL
  4903        IF CL-CLAIM-TYPE = 'L' OR 'P'
  4904           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4905           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4906           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4907           MOVE CM-LF-CRITICAL-PERIOD
  4908                                 TO OUT-CRIT-PER
  4909           MOVE CM-LF-LOAN-EXPIRE-DT
  4910                                 TO DC-BIN-DATE-1
  4911           MOVE ' '              TO DC-OPTION-CODE
  4912           PERFORM 9700-DATE-LINK
  4913                                 THRU 9700-EXIT
  4914           IF NO-CONVERSION-ERROR
  4915              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4916                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4917                 INTO OUT-EXP-DT
  4918              END-STRING
  4919           ELSE
  4920              MOVE SPACES        TO OUT-EXP-DT
  4921           END-IF
  4922        ELSE
  4923           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  4924           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  4925           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  4926           MOVE CM-AH-CRITICAL-PERIOD
  4927                                 TO OUT-CRIT-PER
  4928           MOVE CM-AH-LOAN-EXPIRE-DT
  4929                                 TO DC-BIN-DATE-1
  4930           MOVE ' '              TO DC-OPTION-CODE
  4931           PERFORM 9700-DATE-LINK
  4932                                 THRU 9700-EXIT
  4933           IF NO-CONVERSION-ERROR
  4934              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4935                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4936                 INTO OUT-EXP-DT
  4937              END-STRING
  4938           ELSE
  4939              MOVE SPACES        TO OUT-EXP-DT
  4940           END-IF
  4941        END-IF
  4942        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  4943        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  87
* NSRLTRBL.cbl
  4944            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  4945            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  4946        ELSE
  4947            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  4948            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  4949        END-IF
  4950        MOVE CM-LOAN-APR         TO OUT-APR
  4951     END-IF
  4952     .
  4953 1100-EXIT.
  4954     EXIT.
  4955 1200-GET-ERACCT.
  4956    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  4957    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  4958
  4959* EXEC CICS STARTBR
  4960*        DATASET   ('ERACCT')
  4961*        RIDFLD    (WS-ERACCT-KEY)
  4962*        GTEQ
  4963*        RESP      (WS-RESPONSE)
  4964*    END-EXEC
  4965     MOVE 'ERACCT' TO DFHEIV1
  4966     MOVE 0
  4967       TO DFHEIV11
  4968*    MOVE '&,         G          &  N#00004881' TO DFHEIV0
  4969     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4971     MOVE X'204E233030303034383831' TO DFHEIV0(25:11)
  4972     CALL 'kxdfhei1' USING DFHEIV0,
  4973           DFHEIV1,
  4974           WS-ERACCT-KEY,
  4975           DFHEIV99,
  4976           DFHEIV11,
  4977           DFHEIV99
  4978     MOVE EIBRESP  TO WS-RESPONSE
  4979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4980     IF RESP-NORMAL
  4981
  4982* EXEC CICS READNEXT
  4983*          INTO    (ACCOUNT-MASTER)
  4984*          DATASET ('ERACCT')
  4985*          RIDFLD  (WS-ERACCT-KEY)
  4986*          RESP    (WS-RESPONSE)
  4987*       END-EXEC
  4988     MOVE LENGTH OF
  4989      ACCOUNT-MASTER
  4990       TO DFHEIV12
  4991     MOVE 'ERACCT' TO DFHEIV1
  4992     MOVE 0
  4993       TO DFHEIV11
  4994*    MOVE '&.IL                  )  N#00004888' TO DFHEIV0
  4995     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4996     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4997     MOVE X'204E233030303034383838' TO DFHEIV0(25:11)
  4998     CALL 'kxdfhei1' USING DFHEIV0,
  4999           DFHEIV1,
  5000           ACCOUNT-MASTER,
  5001           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  88
* NSRLTRBL.cbl
  5002           WS-ERACCT-KEY,
  5003           DFHEIV99,
  5004           DFHEIV11,
  5005           DFHEIV99,
  5006           DFHEIV99
  5007     MOVE EIBRESP  TO WS-RESPONSE
  5008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5009     END-IF
  5010     IF RESP-NORMAL
  5011        PERFORM WITH TEST AFTER UNTIL
  5012           NOT (RESP-NORMAL)
  5013           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5014                        AM-CONTROL-PRIMARY (1:20))
  5015           IF (CM-CONTROL-PRIMARY (1:20)
  5016              = AM-CONTROL-PRIMARY (1:20))
  5017              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5018                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5019                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5020                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5021              END-IF
  5022              MOVE AM-NAME       TO OUT-ACCT-NAME
  5023              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5024              MOVE SPACES        TO OUT-ACCT-ADDR2
  5025              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5026              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5027              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
  5028              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5029                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  5030                    INTO OUT-ACCT-ZIP (6:5)
  5031                 END-STRING
  5032              END-IF
  5033              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5034              MOVE AM-GPCD       TO OUT-ACCT-GPCD
  5035
  5036* EXEC CICS READNEXT
  5037*                INTO    (ACCOUNT-MASTER)
  5038*                DATASET ('ERACCT')
  5039*                RIDFLD  (WS-ERACCT-KEY)
  5040*                RESP    (WS-RESPONSE)
  5041*             END-EXEC
  5042     MOVE LENGTH OF
  5043      ACCOUNT-MASTER
  5044       TO DFHEIV12
  5045     MOVE 'ERACCT' TO DFHEIV1
  5046     MOVE 0
  5047       TO DFHEIV11
  5048*    MOVE '&.IL                  )  N#00004920' TO DFHEIV0
  5049     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5050     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5051     MOVE X'204E233030303034393230' TO DFHEIV0(25:11)
  5052     CALL 'kxdfhei1' USING DFHEIV0,
  5053           DFHEIV1,
  5054           ACCOUNT-MASTER,
  5055           DFHEIV12,
  5056           WS-ERACCT-KEY,
  5057           DFHEIV99,
  5058           DFHEIV11,
  5059           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  89
* NSRLTRBL.cbl
  5060           DFHEIV99
  5061     MOVE EIBRESP  TO WS-RESPONSE
  5062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5063           END-IF
  5064        END-PERFORM
  5065     END-IF
  5066     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5067    .
  5068 1200-EXIT.
  5069     EXIT.
  5070 1250-GET-ELLETR.
  5071     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5072     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5073     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5074
  5075* EXEC CICS READ
  5076*         DATASET    ('ELLETR')
  5077*         INTO       (TEXT-FILES)
  5078*         RIDFLD     (WS-ELLETR-KEY)
  5079*         RESP       (WS-RESPONSE)
  5080*         GTEQ
  5081*    END-EXEC
  5082     MOVE LENGTH OF
  5083      TEXT-FILES
  5084       TO DFHEIV11
  5085     MOVE 'ELLETR' TO DFHEIV1
  5086*    MOVE '&"IL       G          (  N#00004937' TO DFHEIV0
  5087     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5089     MOVE X'204E233030303034393337' TO DFHEIV0(25:11)
  5090     CALL 'kxdfhei1' USING DFHEIV0,
  5091           DFHEIV1,
  5092           TEXT-FILES,
  5093           DFHEIV11,
  5094           WS-ELLETR-KEY,
  5095           DFHEIV99,
  5096           DFHEIV99,
  5097           DFHEIV99
  5098     MOVE EIBRESP  TO WS-RESPONSE
  5099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5100     IF RESP-NORMAL
  5101        IF (LETTER-FILE-TEXT)
  5102           AND (BL-LETTER-ID = TX-LETTER-NO)
  5103           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5104           PERFORM 1280-PROCESS-Z-CONTROLS
  5105                                 THRU 1280-EXIT
  5106        END-IF
  5107     END-IF
  5108     .
  5109 1250-EXIT.
  5110     EXIT.
  5111 1280-PROCESS-Z-CONTROLS.
  5112     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5113     IF W-FORM-TO-RESEND > SPACES
  5114        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5115     ELSE
  5116        MOVE SPACES              TO OUT-FORM
  5117     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  90
* NSRLTRBL.cbl
  5118*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5119     .
  5120 1280-EXIT.
  5121     EXIT.
  5122 1300-GET-ELTRLRS.
  5123     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5124     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5125
  5126* EXEC CICS STARTBR
  5127*        DATASET   ('ELTRLR')
  5128*        RIDFLD    (WS-ELTRLR-KEY)
  5129*        GTEQ
  5130*        RESP      (WS-RESPONSE)
  5131*    END-EXEC
  5132     MOVE 'ELTRLR' TO DFHEIV1
  5133     MOVE 0
  5134       TO DFHEIV11
  5135*    MOVE '&,         G          &  N#00004969' TO DFHEIV0
  5136     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5137     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5138     MOVE X'204E233030303034393639' TO DFHEIV0(25:11)
  5139     CALL 'kxdfhei1' USING DFHEIV0,
  5140           DFHEIV1,
  5141           WS-ELTRLR-KEY,
  5142           DFHEIV99,
  5143           DFHEIV11,
  5144           DFHEIV99
  5145     MOVE EIBRESP  TO WS-RESPONSE
  5146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5147    IF RESP-NORMAL
  5148
  5149* EXEC CICS READNEXT
  5150*         INTO    (ACTIVITY-TRAILERS)
  5151*         DATASET ('ELTRLR')
  5152*         RIDFLD  (WS-ELTRLR-KEY)
  5153*         RESP    (WS-RESPONSE)
  5154*      END-EXEC
  5155     MOVE LENGTH OF
  5156      ACTIVITY-TRAILERS
  5157       TO DFHEIV12
  5158     MOVE 'ELTRLR' TO DFHEIV1
  5159     MOVE 0
  5160       TO DFHEIV11
  5161*    MOVE '&.IL                  )  N#00004976' TO DFHEIV0
  5162     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5163     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5164     MOVE X'204E233030303034393736' TO DFHEIV0(25:11)
  5165     CALL 'kxdfhei1' USING DFHEIV0,
  5166           DFHEIV1,
  5167           ACTIVITY-TRAILERS,
  5168           DFHEIV12,
  5169           WS-ELTRLR-KEY,
  5170           DFHEIV99,
  5171           DFHEIV11,
  5172           DFHEIV99,
  5173           DFHEIV99
  5174     MOVE EIBRESP  TO WS-RESPONSE
  5175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  91
* NSRLTRBL.cbl
  5176       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5177    END-IF
  5178     .
  5179 1300-EXIT.
  5180     EXIT.
  5181 1310-GET-ELTRLRS.
  5182     IF RESP-NORMAL
  5183     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5184        EVALUATE TRUE
  5185           WHEN AT-INSURED-ADDR-TRL
  5186              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5187              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5188              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5189              MOVE AT-CITY           TO OUT-INS-CITY
  5190              MOVE AT-STATE          TO OUT-INS-STATE
  5191              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5192              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5193                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5194                    INTO OUT-INS-ZIP (6:5)
  5195                 END-STRING
  5196              END-IF
  5197              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5198           WHEN AT-BENEFICIARY-ADDR-TRL
  5199              SET FOUND-BENE TO TRUE
  5200              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5201              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  5202              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5203              MOVE AT-CITY           TO OUT-BEN-CITY
  5204              MOVE AT-STATE          TO OUT-BEN-STATE
  5205              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
  5206              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5207                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5208                    INTO OUT-BEN-ZIP (6:5)
  5209                 END-STRING
  5210              END-IF
  5211              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5212           WHEN AT-ACCOUNT-ADDR-TRL
  5213              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5214              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5215              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5216              MOVE AT-CITY           TO OUT-ACCT-CITY
  5217              MOVE AT-STATE          TO OUT-ACCT-STATE
  5218              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5219              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5220                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5221                    INTO OUT-ACCT-ZIP (6:5)
  5222                 END-STRING
  5223              END-IF
  5224              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5225           WHEN AT-SEQUENCE-NO = +90
  5226              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5227           WHEN AT-SEQUENCE-NO = +91
  5228              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5229           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5230              IF AT-INT-RATE NUMERIC AND
  5231                 AT-INT-RATE NOT EQUAL ZEROS
  5232                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5233              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  92
* NSRLTRBL.cbl
  5234           WHEN AT-TRAILER-TYPE = '3'
  5235              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5236                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5237                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5238                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5239              END-IF
  5240           WHEN AT-TRAILER-TYPE = '8'
  5241              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5242                 MOVE AT-RECORDED-DT
  5243                              TO WS-LAST-ACT-DT
  5244                 MOVE 'DENIAL'
  5245                              TO WS-LAST-ACT-TYPE
  5246              END-IF
  5247           WHEN AT-TRAILER-TYPE = 'A'
  5248              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5249                 MOVE AT-RECORDED-DT
  5250                              TO WS-LAST-ACT-DT
  5251                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5252                 IF INITIAL-FORM
  5253                    MOVE 'INIT'
  5254                              TO WS-FORM
  5255                 END-IF
  5256                 IF PROGRESS-FORM
  5257                    MOVE 'PROG'
  5258                              TO WS-FORM
  5259                 END-IF
  5260              END-IF
  5261              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
  5262                 MOVE AT-FORM-SEND-ON-DT
  5263                              TO WS-ACTIVITY-DT
  5264              END-IF
  5265              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5266                 MOVE AT-FORM-REPRINT-DT
  5267                              TO WS-ACTIVITY-DT
  5268              END-IF
  5269              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5270                 MOVE AT-FORM-ANSWERED-DT
  5271                              TO WS-ACTIVITY-DT
  5272              END-IF
  5273        END-EVALUATE
  5274
  5275* EXEC CICS READNEXT
  5276*         INTO    (ACTIVITY-TRAILERS)
  5277*         DATASET ('ELTRLR')
  5278*         RIDFLD  (WS-ELTRLR-KEY)
  5279*         RESP    (WS-RESPONSE)
  5280*       END-EXEC
  5281     MOVE LENGTH OF
  5282      ACTIVITY-TRAILERS
  5283       TO DFHEIV12
  5284     MOVE 'ELTRLR' TO DFHEIV1
  5285     MOVE 0
  5286       TO DFHEIV11
  5287*    MOVE '&.IL                  )  N#00005080' TO DFHEIV0
  5288     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5289     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5290     MOVE X'204E233030303035303830' TO DFHEIV0(25:11)
  5291     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  93
* NSRLTRBL.cbl
  5292           DFHEIV1,
  5293           ACTIVITY-TRAILERS,
  5294           DFHEIV12,
  5295           WS-ELTRLR-KEY,
  5296           DFHEIV99,
  5297           DFHEIV11,
  5298           DFHEIV99,
  5299           DFHEIV99
  5300     MOVE EIBRESP  TO WS-RESPONSE
  5301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5302        GO TO 1310-GET-ELTRLRS
  5303     END-IF
  5304     END-IF
  5305     .
  5306 1310-EXIT.
  5307     EXIT.
  5308 1400-GET-WAIT-PER.
  5309     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5310     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5311     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5312     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5313
  5314* EXEC CICS READ
  5315*       INTO    (CONTROL-FILE)
  5316*       DATASET ('ELCNTL')
  5317*       RIDFLD  (WS-ELCNTL-KEY)
  5318*       GTEQ
  5319*       RESP    (WS-RESPONSE)
  5320*    END-EXEC
  5321     MOVE LENGTH OF
  5322      CONTROL-FILE
  5323       TO DFHEIV11
  5324     MOVE 'ELCNTL' TO DFHEIV1
  5325*    MOVE '&"IL       G          (  N#00005097' TO DFHEIV0
  5326     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5328     MOVE X'204E233030303035303937' TO DFHEIV0(25:11)
  5329     CALL 'kxdfhei1' USING DFHEIV0,
  5330           DFHEIV1,
  5331           CONTROL-FILE,
  5332           DFHEIV11,
  5333           WS-ELCNTL-KEY,
  5334           DFHEIV99,
  5335           DFHEIV99,
  5336           DFHEIV99
  5337     MOVE EIBRESP  TO WS-RESPONSE
  5338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5339     IF RESP-NORMAL
  5340        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5341        AND (CF-RECORD-TYPE = '5')
  5342        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5343           (S1 > +8)
  5344           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5345        END-PERFORM
  5346        IF S1 > +8
  5347           MOVE '**'             TO OUT-WAIT-PER
  5348        ELSE
  5349           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  94
* NSRLTRBL.cbl
  5350                                 TO OUT-WAIT-PER
  5351        END-IF
  5352     ELSE
  5353        MOVE '**'                TO OUT-WAIT-PER
  5354     END-IF
  5355    .
  5356 1400-EXIT.
  5357     EXIT.
  5358 1500-GET-ARCH-NO.
  5359*    DISPLAY ' MADE IT TO 1500 '
  5360     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5361     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5362     MOVE SPACES                 TO WS-ELCNTL-GENL
  5363     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5364
  5365* EXEC CICS READ
  5366*       INTO    (CONTROL-FILE)
  5367*       DATASET ('ELCNTL')
  5368*       RIDFLD  (WS-ELCNTL-KEY)
  5369*       UPDATE
  5370*       RESP    (WS-RESPONSE)
  5371*    END-EXEC
  5372     MOVE LENGTH OF
  5373      CONTROL-FILE
  5374       TO DFHEIV11
  5375     MOVE 'ELCNTL' TO DFHEIV1
  5376*    MOVE '&"IL       EU         (  N#00005129' TO DFHEIV0
  5377     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5379     MOVE X'204E233030303035313239' TO DFHEIV0(25:11)
  5380     CALL 'kxdfhei1' USING DFHEIV0,
  5381           DFHEIV1,
  5382           CONTROL-FILE,
  5383           DFHEIV11,
  5384           WS-ELCNTL-KEY,
  5385           DFHEIV99,
  5386           DFHEIV99,
  5387           DFHEIV99
  5388     MOVE EIBRESP  TO WS-RESPONSE
  5389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5390     IF RESP-NORMAL
  5391        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5392        AND (CF-RECORD-TYPE = '1')
  5393        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5394        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5395        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5396
  5397* EXEC CICS REWRITE
  5398*          FROM    (CONTROL-FILE)
  5399*          DATASET ('ELCNTL')
  5400*       END-EXEC
  5401     MOVE LENGTH OF
  5402      CONTROL-FILE
  5403       TO DFHEIV11
  5404     MOVE 'ELCNTL' TO DFHEIV1
  5405*    MOVE '&& L                  %   #00005142' TO DFHEIV0
  5406     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5407     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  95
* NSRLTRBL.cbl
  5408     MOVE X'2020233030303035313432' TO DFHEIV0(25:11)
  5409     CALL 'kxdfhei1' USING DFHEIV0,
  5410           DFHEIV1,
  5411           CONTROL-FILE,
  5412           DFHEIV11,
  5413           DFHEIV99
  5414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5415     ELSE
  5416        MOVE +0                  TO WS-ARCHIVE-NO
  5417     END-IF
  5418    .
  5419 1500-EXIT.
  5420     EXIT.
  5421 1600-ADD-CORR-TRLR.
  5422
  5423* EXEC CICS READ
  5424*         DATASET    ('ELMSTR')
  5425*         INTO       (CLAIM-MASTER)
  5426*         RIDFLD     (WS-ELMSTR-KEY)
  5427*         UPDATE
  5428*         RESP       (WS-RESPONSE)
  5429*    END-EXEC
  5430     MOVE LENGTH OF
  5431      CLAIM-MASTER
  5432       TO DFHEIV11
  5433     MOVE 'ELMSTR' TO DFHEIV1
  5434*    MOVE '&"IL       EU         (  N#00005153' TO DFHEIV0
  5435     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5436     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5437     MOVE X'204E233030303035313533' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           DFHEIV1,
  5440           CLAIM-MASTER,
  5441           DFHEIV11,
  5442           WS-ELMSTR-KEY,
  5443           DFHEIV99,
  5444           DFHEIV99,
  5445           DFHEIV99
  5446     MOVE EIBRESP  TO WS-RESPONSE
  5447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5448     IF NOT RESP-NORMAL
  5449        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5450        GO TO 1600-EXIT
  5451     END-IF
  5452     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5453     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5454     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5455        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5456     END-IF
  5457     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5458        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5459     END-IF
  5460     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5461     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5462     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5463     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5464     MOVE  4                     TO AT-TRAILER-TYPE
  5465     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  96
* NSRLTRBL.cbl
  5466                                    CL-LAST-MAINT-DT
  5467                                    AT-CORR-LAST-MAINT-DT
  5468     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5469                                    CL-LAST-MAINT-USER
  5470                                    AT-CORR-LAST-UPDATED-BY
  5471     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5472                                    CL-LAST-MAINT-HHMMSS.
  5473     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5474     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5475     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5476     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5477                                    AT-LETTER-PURGED-DT.
  5478     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5479     MOVE '3'                    TO AT-LETTER-ORIGIN
  5480     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5481     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5482     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5483
  5484* EXEC CICS WRITE
  5485*         DATASET    ('ELTRLR')
  5486*         FROM       (ACTIVITY-TRAILERS)
  5487*         RIDFLD     (AT-CONTROL-PRIMARY)
  5488*         RESP       (WS-RESPONSE)
  5489*    END-EXEC
  5490     MOVE LENGTH OF
  5491      ACTIVITY-TRAILERS
  5492       TO DFHEIV11
  5493     MOVE 'ELTRLR' TO DFHEIV1
  5494*    MOVE '&$ L                  ''  N#00005195' TO DFHEIV0
  5495     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5497     MOVE X'204E233030303035313935' TO DFHEIV0(25:11)
  5498     CALL 'kxdfhei1' USING DFHEIV0,
  5499           DFHEIV1,
  5500           ACTIVITY-TRAILERS,
  5501           DFHEIV11,
  5502           AT-CONTROL-PRIMARY,
  5503           DFHEIV99,
  5504           DFHEIV99
  5505     MOVE EIBRESP  TO WS-RESPONSE
  5506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5507     IF NOT RESP-NORMAL
  5508        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5509        GO TO 1600-EXIT
  5510     END-IF
  5511
  5512* EXEC CICS REWRITE
  5513*         DATASET    ('ELMSTR')
  5514*         FROM       (CLAIM-MASTER)
  5515*         RESP       (WS-RESPONSE)
  5516*    END-EXEC
  5517     MOVE LENGTH OF
  5518      CLAIM-MASTER
  5519       TO DFHEIV11
  5520     MOVE 'ELMSTR' TO DFHEIV1
  5521*    MOVE '&& L                  %  N#00005205' TO DFHEIV0
  5522     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5523     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  97
* NSRLTRBL.cbl
  5524     MOVE X'204E233030303035323035' TO DFHEIV0(25:11)
  5525     CALL 'kxdfhei1' USING DFHEIV0,
  5526           DFHEIV1,
  5527           CLAIM-MASTER,
  5528           DFHEIV11,
  5529           DFHEIV99
  5530     MOVE EIBRESP  TO WS-RESPONSE
  5531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5532     IF NOT RESP-NORMAL
  5533        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5534     END-IF
  5535     .
  5536 1600-EXIT.
  5537     EXIT.
  5538 1700-GET-ELENCC.
  5539     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5540     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5541     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5542     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5543        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5544        OR (E1 > +5)
  5545     END-PERFORM
  5546     IF E1 < +5
  5547        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5548     END-IF
  5549
  5550* EXEC CICS READ
  5551*        DATASET   ('ELENCC')
  5552*        INTO      (ENCLOSURE-CODES)
  5553*        RIDFLD    (WS-ELENCC-KEY)
  5554*        RESP      (WS-RESPONSE)
  5555*    END-EXEC
  5556     MOVE LENGTH OF
  5557      ENCLOSURE-CODES
  5558       TO DFHEIV11
  5559     MOVE 'ELENCC' TO DFHEIV1
  5560*    MOVE '&"IL       E          (  N#00005227' TO DFHEIV0
  5561     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5563     MOVE X'204E233030303035323237' TO DFHEIV0(25:11)
  5564     CALL 'kxdfhei1' USING DFHEIV0,
  5565           DFHEIV1,
  5566           ENCLOSURE-CODES,
  5567           DFHEIV11,
  5568           WS-ELENCC-KEY,
  5569           DFHEIV99,
  5570           DFHEIV99,
  5571           DFHEIV99
  5572     MOVE EIBRESP  TO WS-RESPONSE
  5573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5574     IF NOT RESP-NORMAL
  5575        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5576
  5577* EXEC CICS READ
  5578*           DATASET   ('ELENCC')
  5579*           INTO      (ENCLOSURE-CODES)
  5580*           RIDFLD    (WS-ELENCC-KEY)
  5581*           RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  98
* NSRLTRBL.cbl
  5582*       END-EXEC
  5583     MOVE LENGTH OF
  5584      ENCLOSURE-CODES
  5585       TO DFHEIV11
  5586     MOVE 'ELENCC' TO DFHEIV1
  5587*    MOVE '&"IL       E          (  N#00005235' TO DFHEIV0
  5588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5590     MOVE X'204E233030303035323335' TO DFHEIV0(25:11)
  5591     CALL 'kxdfhei1' USING DFHEIV0,
  5592           DFHEIV1,
  5593           ENCLOSURE-CODES,
  5594           DFHEIV11,
  5595           WS-ELENCC-KEY,
  5596           DFHEIV99,
  5597           DFHEIV99,
  5598           DFHEIV99
  5599     MOVE EIBRESP  TO WS-RESPONSE
  5600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5601     END-IF
  5602     IF RESP-NORMAL
  5603        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5604        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5605        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5606     END-IF
  5607     .
  5608 1700-EXIT.
  5609     EXIT.
  5610 1800-SET-EL150D-FIELDS.
  5611     MOVE SPACES TO WS-UNSORTED-TABLE
  5612                    WS-SORTED-TABLE
  5613
  5614*    move cm-ah-benefit-amt      to pi-mo-ben
  5615
  5616     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5617
  5618     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5619     MOVE 'B'                    TO CRTT-REC-TYPE
  5620
  5621
  5622* EXEC CICS READ
  5623*       DATASET   ('ELCRTT')
  5624*       INTO      (CERTIFICATE-TRAILERS)
  5625*       RIDFLD    (ELCRTT-KEY)
  5626*       RESP      (WS-RESPONSE)
  5627*    END-EXEC
  5628     MOVE LENGTH OF
  5629      CERTIFICATE-TRAILERS
  5630       TO DFHEIV11
  5631     MOVE 'ELCRTT' TO DFHEIV1
  5632*    MOVE '&"IL       E          (  N#00005261' TO DFHEIV0
  5633     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5635     MOVE X'204E233030303035323631' TO DFHEIV0(25:11)
  5636     CALL 'kxdfhei1' USING DFHEIV0,
  5637           DFHEIV1,
  5638           CERTIFICATE-TRAILERS,
  5639           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page  99
* NSRLTRBL.cbl
  5640           ELCRTT-KEY,
  5641           DFHEIV99,
  5642           DFHEIV99,
  5643           DFHEIV99
  5644     MOVE EIBRESP  TO WS-RESPONSE
  5645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5646
  5647     IF NOT RESP-NORMAL
  5648        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5649        GO TO 1800-EXIT
  5650     END-IF
  5651
  5652     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5653     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5654       (S1 > +24)
  5655       OR (CS-CLAIM-NO (S1) = SPACES)
  5656        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5657        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5658        IF CS-INSURED-TYPE (S1) = 'C'
  5659           MOVE '2'              TO WS-INS-TYPE (S1)
  5660        ELSE
  5661           MOVE '1'              TO WS-INS-TYPE (S1)
  5662        END-IF
  5663        MOVE CS-BENEFIT-PERIOD (S1)
  5664                                 TO WS-BEN-PER (S1)
  5665*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5666        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5667        MOVE ' '                 TO WS-SORTED-SW (S1)
  5668
  5669        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5670        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5671        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5672        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
  5673
  5674
  5675* EXEC CICS READ
  5676*          DATASET        ('ELMSTR')
  5677*          RIDFLD         (WS-ELMSTR-KEY)
  5678*          INTO           (CLAIM-MASTER)
  5679*          RESP           (WS-RESPONSE)
  5680*       END-EXEC
  5681     MOVE LENGTH OF
  5682      CLAIM-MASTER
  5683       TO DFHEIV11
  5684     MOVE 'ELMSTR' TO DFHEIV1
  5685*    MOVE '&"IL       E          (  N#00005295' TO DFHEIV0
  5686     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5688     MOVE X'204E233030303035323935' TO DFHEIV0(25:11)
  5689     CALL 'kxdfhei1' USING DFHEIV0,
  5690           DFHEIV1,
  5691           CLAIM-MASTER,
  5692           DFHEIV11,
  5693           WS-ELMSTR-KEY,
  5694           DFHEIV99,
  5695           DFHEIV99,
  5696           DFHEIV99
  5697     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 100
* NSRLTRBL.cbl
  5698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5699        IF RESP-NORMAL
  5700           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5701           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5702           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5703           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5704              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5705           END-IF
  5706           MOVE CL-CRITICAL-PERIOD
  5707                                 TO WS-MAX-BENS (S1)
  5708           IF CL-CRITICAL-PERIOD = ZEROS
  5709              IF CL-CLAIM-TYPE = 'L' OR 'P'
  5710                 MOVE 01         TO WS-MAX-BENS (S1)
  5711              ELSE
  5712                 MOVE CM-AH-ORIG-TERM
  5713                                 TO WS-MAX-BENS (S1)
  5714              END-IF
  5715           END-IF
  5716           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5717              MOVE 'D'           TO WS-STATUS (S1)
  5718           END-IF
  5719           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5720              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5721           END-IF
  5722
  5723           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5724           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5725              PERFORM 1850-GET-DDF-LIMITS
  5726                                 THRU 1850-EXIT
  5727           END-IF
  5728           IF PDEF-FOUND
  5729              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5730                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  5731                 OR (P1 > +8)
  5732              END-PERFORM
  5733              IF P1 < +9
  5734                 IF CL-CLAIM-TYPE = 'L' OR 'P'
  5735                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5736                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5737                       MOVE PD-MAX-AMT (P1)
  5738                                 TO WS-MAX-MOBEN (S1)
  5739                    ELSE
  5740                       MOVE CM-LF-BENEFIT-AMT
  5741                                 TO WS-MAX-MOBEN (S1)
  5742                    END-IF
  5743                 ELSE
  5744                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5745                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5746                    END-IF
  5747                    IF PD-BEN-PCT (P1) = ZEROS
  5748                       MOVE +1      TO WS-WORK-BEN-PCT
  5749                    ELSE
  5750                       MOVE PD-BEN-PCT (P1)
  5751                                    TO WS-WORK-BEN-PCT
  5752                    END-IF
  5753                    COMPUTE WS-MAX-MOBEN (S1) =
  5754                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5755                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 101
* NSRLTRBL.cbl
  5756                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5757                       MOVE PD-MAX-AMT (P1)
  5758                                 TO WS-MAX-MOBEN (S1)
  5759                    END-IF
  5760                 END-IF
  5761*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5762*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5763*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5764*                ELSE
  5765*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5766*                END-IF
  5767                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5768                                 TO WS-EXCL-PER (S1)
  5769                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5770                                 TO WS-COV-ENDS (S1)
  5771                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5772                                 TO WS-ACC-PER (S1)
  5773                 MOVE PD-MAX-EXTENSION (P1)
  5774                                 TO WS-MAX-EXTEN (S1)
  5775                 EVALUATE TRUE
  5776                    WHEN PD-RECURRING-YN (P1) = 'N'
  5777                       MOVE 00   TO WS-REC-MOS (S1)
  5778                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5779                       MOVE 99   TO WS-REC-MOS (S1)
  5780                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5781                       MOVE PD-REC-CRIT-PERIOD (P1)
  5782                                 TO WS-REC-MOS (S1)
  5783                    WHEN OTHER
  5784                       MOVE ZEROS TO WS-REC-MOS (S1)
  5785                 END-EVALUATE
  5786                 IF WS-REC-MOS (S1) = ZEROS
  5787                    MOVE 01      TO WS-REC-MOS (S1)
  5788                 END-IF
  5789                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5790              END-IF
  5791           ELSE
  5792              IF CL-CLAIM-TYPE NOT = 'L' AND 'P'
  5793                 MOVE CM-AH-BENEFIT-AMT
  5794                                 TO WS-MAX-MOBEN (S1)
  5795              ELSE
  5796                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5797              END-IF
  5798              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5799                                    WS-MAX-EXTEN (S1)
  5800                                    WS-ACC-PER  (S1)
  5801              MOVE 999           TO WS-COV-ENDS (S1)
  5802              MOVE 01            TO WS-REC-MOS  (S1)
  5803           END-IF
  5804        END-IF
  5805     END-PERFORM
  5806
  5807*      SORT THE TABLE
  5808     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5809     COMPUTE WS-MAX-SUB = S1 - +1
  5810     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5811
  5812     MOVE WS-MAX-SUB             TO WS-CNTR
  5813
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 102
* NSRLTRBL.cbl
  5814     MOVE +1                     TO S2
  5815     MOVE +0                     TO S3
  5816     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5817        MOVE +0 TO WS-HOLD-S1
  5818        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5819        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5820           (S1 > WS-MAX-SUB)
  5821           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5822              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5823              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5824              MOVE S1            TO WS-HOLD-S1
  5825           END-IF
  5826        END-PERFORM
  5827        IF WS-HOLD-S1 NOT = ZEROS
  5828           MOVE WS-HOLD-S1         TO S1
  5829           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5830           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5831           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5832           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5833           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5834           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5835           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5836           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5837           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5838           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5839           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5840           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5841*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5842           MOVE 'Y'                TO WS-SORTED-SW       (S1)
  5843           SUBTRACT 1 FROM WS-CNTR
  5844           ADD +1 TO S2
  5845        END-IF
  5846        ADD 1 TO S3
  5847     END-PERFORM
  5848
  5849     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
  5850
  5851***  -----------------------
  5852     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5853        PERFORM 1900-BUILD-NON-DCC
  5854        GO TO 1800-EXIT
  5855     END-IF
  5856
  5857     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5858                                    WS-PREV-INS-TYPE
  5859     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5860                                    WS-ACCUM-DAYS
  5861                                    WS-ACCUM-AMT
  5862                                    WS-ACCUM-PD-BENS
  5863
  5864     MOVE +1                     TO M1
  5865     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5866        S1 > WS-MAX-SUB
  5867        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5868           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5869           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5870           MOVE ZEROS            TO WS-ACCUM-DAYS
  5871                                    WS-ACCUM-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 103
* NSRLTRBL.cbl
  5872                                    WS-ACCUM-PD-BENS
  5873        END-IF
  5874        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5875        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5876           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5877           MOVE ZEROS            TO WS-ACCUM-DAYS
  5878                                    WS-ACCUM-AMT
  5879                                    WS-ACCUM-PD-BENS
  5880        END-IF
  5881        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5882        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5883           PERFORM 1810-SET-NEW-HEAD
  5884                                 THRU 1810-EXIT
  5885           MOVE WS-SRTD-CLM-TYPE (S1)
  5886                                 TO WS-PREV-CLM-TYPE
  5887           ADD +1                TO M1
  5888        END-IF
  5889
  5890        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5891        IF WS-SRTD-INS-TYPE (S1) = '1'
  5892           MOVE 'PRIM'             TO OUT-INS-TYP
  5893        ELSE
  5894           MOVE 'COBO'             TO OUT-INS-TYP
  5895        END-IF
  5896*       EVALUATE WS-SRTD-STATUS (S1)
  5897*          WHEN 'C'
  5898*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5899*          WHEN 'D'
  5900*             MOVE 'DENIED'        TO WSM-STATUS (M1)
  5901*          WHEN 'O'
  5902*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5903*          WHEN OTHER
  5904*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  5905*       END-EVALUATE
  5906*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5907*                                     PI-WSM-CLAIM-NOS (S1)
  5908*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5909
  5910        COMPUTE OUT-MAX-BENS =
  5911           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5912
  5913        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  5914           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5915
  5916        MOVE ZEROS TO WK1 WK2
  5917        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5918           COMPUTE WS-PD-BENS ROUNDED =
  5919              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  5920           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  5921              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  5922                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  5923                 REMAINDER WK2
  5924           END-IF
  5925        ELSE
  5926           MOVE ZEROS            TO WS-PD-BENS
  5927        END-IF
  5928        IF (WS-PD-BENS = ZEROS)
  5929           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 104
* NSRLTRBL.cbl
  5930           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  5931           MOVE 1                TO WS-PD-BENS
  5932        END-IF
  5933        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  5934*       if wk2 not = zeros
  5935*          move '*'              to wsm-part (m1)
  5936*       end-if
  5937*       compute ws-accum-days =
  5938*          ws-accum-days + ws-srtd-days-paid (s1)
  5939        COMPUTE WS-ACCUM-AMT =
  5940           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  5941        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  5942           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  5943        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5944           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  5945              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  5946        ELSE
  5947           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  5948        END-IF
  5949        IF (WS-ACCUM-PD-BENS = ZEROS)
  5950           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  5951           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  5952           MOVE 1                TO WS-ACCUM-PD-BENS
  5953        END-IF
  5954        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  5955           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5956        COMPUTE OUT-REM-BENS =
  5957           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5958        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
  5959
  5960*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  5961*       MOVE ' '                    TO DC-OPTION-CODE
  5962*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5963*       IF NO-CONVERSION-ERROR
  5964*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  5965*       ELSE
  5966*          MOVE SPACES              TO wsm-inc-date (m1)
  5967*       END-IF
  5968*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  5969*       MOVE ' '                     TO DC-OPTION-CODE
  5970*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5971*       IF NO-CONVERSION-ERROR
  5972*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  5973*       ELSE
  5974*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  5975*       END-IF
  5976        ADD +1                   TO M1
  5977        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  5978           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  5979           MOVE 26 TO S1
  5980        END-IF
  5981
  5982     END-PERFORM
  5983
  5984    DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  5985    display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  5986    display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  5987    display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 105
* NSRLTRBL.cbl
  5988    display  ' ACC SW ' OUT-ACC-SW
  5989
  5990     .
  5991 1800-EXIT.
  5992     EXIT.
  5993
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 106
* NSRLTRBL.cbl
  5995
  5996 1810-SET-NEW-HEAD.
  5997     MOVE ZEROS                  TO WS-ACCUM-DAYS
  5998                                    WS-ACCUM-AMT
  5999                                    WS-ACCUM-PD-BENS
  6000     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6001        WHEN 'A'
  6002           MOVE 'A&H'            TO WS-COV-TYPE
  6003        WHEN 'F'
  6004           MOVE 'FAM '           TO WS-COV-TYPE
  6005        WHEN 'I'
  6006           MOVE ' IU '           TO WS-COV-TYPE
  6007        WHEN 'L'
  6008           MOVE 'LIFE'           TO WS-COV-TYPE
  6009        WHEN OTHER
  6010           MOVE WS-SRTD-CLM-TYPE (S1)
  6011                                 TO WS-COV-TYPE
  6012     END-EVALUATE
  6013
  6014     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6015     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6016
  6017*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6018*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6019*       ' MaxBens ' ws-srtd-max-bens (s1)
  6020*       ' Recurring ' OUT-REC-MOS
  6021*       delimited by size into ws-map-output (m1)
  6022*    end-string
  6023
  6024     .
  6025 1810-EXIT.
  6026     EXIT.
  6027
  6028 1820-FIND-QUALIFY.
  6029     IF NOT PDEF-FOUND
  6030        GO TO 1820-EXIT
  6031     END-IF
  6032
  6033     DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6034        WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6035
  6036     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6037     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6038     MOVE '1'                    TO DC-OPTION-CODE
  6039     MOVE +0                     TO DC-ELAPSED-MONTHS
  6040                                    DC-ELAPSED-DAYS
  6041     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6042
  6043     IF NO-CONVERSION-ERROR
  6044        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6045        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6046        IF DC-ELAPSED-DAYS > 1
  6047           ADD 1 TO WS-MONTHS-BETWEEN
  6048        END-IF
  6049     ELSE
  6050        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6051     END-IF
  6052
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 107
* NSRLTRBL.cbl
  6053     DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6054        ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6055
  6056     EVALUATE TRUE
  6057        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6058           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6059           DISPLAY ' NSRLTRBL- ZERO 1 '
  6060           MOVE ZEROS TO OUT-MAX-BENS
  6061                         OUT-REM-BENS
  6062        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6063           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6064           DISPLAY ' NSRLTRBL- ZERO 2 '
  6065           MOVE ZEROS TO OUT-MAX-BENS
  6066     END-EVALUATE
  6067     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6068        MOVE ZEROS               TO OUT-REM-BENS
  6069     END-IF
  6070
  6071     .
  6072 1820-EXIT.
  6073     EXIT.
  6074
  6075 1850-GET-DDF-LIMITS.
  6076
  6077     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6078        MOVE CM-STATE            TO CM-CLP-STATE
  6079     END-IF
  6080
  6081     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6082     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6083     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6084
  6085     IF (CL-CLAIM-TYPE = 'L' OR 'P')
  6086        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6087        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6088        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6089     ELSE
  6090        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6091        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6092     END-IF
  6093
  6094     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6095
  6096     DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6097     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6098
  6099
  6100* EXEC CICS STARTBR
  6101*        DATASET  ('ERPDEF')
  6102*        RIDFLD   (ERPDEF-KEY)
  6103*        GTEQ
  6104*        RESP     (WS-RESPONSE)
  6105*    END-EXEC
  6106     MOVE 'ERPDEF' TO DFHEIV1
  6107     MOVE 0
  6108       TO DFHEIV11
  6109*    MOVE '&,         G          &  N#00005701' TO DFHEIV0
  6110     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 108
* NSRLTRBL.cbl
  6111     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6112     MOVE X'204E233030303035373031' TO DFHEIV0(25:11)
  6113     CALL 'kxdfhei1' USING DFHEIV0,
  6114           DFHEIV1,
  6115           ERPDEF-KEY,
  6116           DFHEIV99,
  6117           DFHEIV11,
  6118           DFHEIV99
  6119     MOVE EIBRESP  TO WS-RESPONSE
  6120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6121
  6122     IF NOT RESP-NORMAL
  6123        GO TO 1850-EXIT
  6124     END-IF
  6125
  6126     .
  6127 1850-READNEXT.
  6128
  6129
  6130* EXEC CICS READNEXT
  6131*       DATASET  ('ERPDEF')
  6132*       INTO     (PRODUCT-MASTER)
  6133*       RIDFLD   (ERPDEF-KEY)
  6134*       RESP     (WS-RESPONSE)
  6135*    END-EXEC
  6136     MOVE LENGTH OF
  6137      PRODUCT-MASTER
  6138       TO DFHEIV12
  6139     MOVE 'ERPDEF' TO DFHEIV1
  6140     MOVE 0
  6141       TO DFHEIV11
  6142*    MOVE '&.IL                  )  N#00005715' TO DFHEIV0
  6143     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6144     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6145     MOVE X'204E233030303035373135' TO DFHEIV0(25:11)
  6146     CALL 'kxdfhei1' USING DFHEIV0,
  6147           DFHEIV1,
  6148           PRODUCT-MASTER,
  6149           DFHEIV12,
  6150           ERPDEF-KEY,
  6151           DFHEIV99,
  6152           DFHEIV11,
  6153           DFHEIV99,
  6154           DFHEIV99
  6155     MOVE EIBRESP  TO WS-RESPONSE
  6156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6157
  6158     IF NOT RESP-NORMAL
  6159        GO TO 1850-ENDBR
  6160     END-IF
  6161
  6162     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6163        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6164           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6165           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6166        ELSE
  6167           GO TO 1850-READNEXT
  6168        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 109
* NSRLTRBL.cbl
  6169     ELSE
  6170        GO TO 1850-ENDBR
  6171     END-IF
  6172
  6173     .
  6174 1850-ENDBR.
  6175
  6176
  6177* EXEC CICS ENDBR
  6178*       DATASET  ('ERPDEF')
  6179*    END-EXEC
  6180     MOVE 'ERPDEF' TO DFHEIV1
  6181     MOVE 0
  6182       TO DFHEIV11
  6183*    MOVE '&2                    $   #00005740' TO DFHEIV0
  6184     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6185     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6186     MOVE X'2020233030303035373430' TO DFHEIV0(25:11)
  6187     CALL 'kxdfhei1' USING DFHEIV0,
  6188           DFHEIV1,
  6189           DFHEIV11,
  6190           DFHEIV99
  6191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6192
  6193     .
  6194 1850-EXIT.
  6195     EXIT.
  6196
  6197 1900-BUILD-NON-DCC.
  6198
  6199     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6200                                    WS-PREV-INS-TYPE
  6201     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6202                                    WS-ACCUM-DAYS
  6203                                    WS-ACCUM-AMT
  6204                                    WS-ACCUM-PD-BENS
  6205
  6206     MOVE +1                     TO M1
  6207     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6208        S1 > WS-MAX-SUB
  6209        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6210           PERFORM 1810-SET-NEW-HEAD
  6211                                 THRU 1810-EXIT
  6212           MOVE WS-SRTD-CLM-TYPE (S1)
  6213                                 TO WS-PREV-CLM-TYPE
  6214           ADD +1                TO M1
  6215        END-IF
  6216        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6217        IF WS-SRTD-INS-TYPE (S1) = '1'
  6218           MOVE 'PRIM'             TO OUT-INS-TYP
  6219        ELSE
  6220           MOVE 'COBO'             TO OUT-INS-TYP
  6221        END-IF
  6222*       evaluate ws-srtd-status (s1)
  6223*          when 'C'
  6224*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6225*          WHEN 'D'
  6226*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 110
* NSRLTRBL.cbl
  6227*          WHEN 'O'
  6228*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6229*          WHEN OTHER
  6230*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6231*       END-EVALUATE
  6232*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6233*                                     pi-wsm-claim-nos (s1)
  6234*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6235
  6236        COMPUTE OUT-MAX-BENS =
  6237           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6238
  6239        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6240           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6241
  6242        MOVE ZEROS TO WK1 WK2
  6243        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6244           COMPUTE WS-PD-BENS ROUNDED =
  6245              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6246           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6247              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6248                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6249                 REMAINDER WK2
  6250           END-IF
  6251        ELSE
  6252           MOVE ZEROS            TO WS-PD-BENS
  6253        END-IF
  6254        IF (WS-PD-BENS = ZEROS)
  6255           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6256           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6257           MOVE 1                TO WS-PD-BENS
  6258        END-IF
  6259        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6260*       IF WK2 NOT = ZEROS
  6261*          MOVE '*'              TO WSM-PART (M1)
  6262*       END-IF
  6263        COMPUTE WS-ACCUM-AMT =
  6264           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6265        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6266           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6267        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6268           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6269              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6270        ELSE
  6271           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6272        END-IF
  6273        IF (WS-ACCUM-PD-BENS = ZEROS)
  6274           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6275           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6276           MOVE 1                TO WS-ACCUM-PD-BENS
  6277        END-IF
  6278        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6279           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6280        COMPUTE OUT-REM-BENS =
  6281           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6282
  6283*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6284*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 111
* NSRLTRBL.cbl
  6285*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6286*       IF NO-CONVERSION-ERROR
  6287*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6288*       ELSE
  6289*          MOVE SPACES              TO wsm-inc-date (m1)
  6290*       END-IF
  6291*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6292*       MOVE ' '                     TO DC-OPTION-CODE
  6293*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6294*       IF NO-CONVERSION-ERROR
  6295*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6296*       ELSE
  6297*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6298*       END-IF
  6299*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6300        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6301           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6302           MOVE 26 TO S1
  6303        END-IF
  6304
  6305        ADD +1                   TO M1
  6306     END-PERFORM
  6307     DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6308     display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6309     display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6310     display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6311     display ' ACC SW ' OUT-ACC-SW
  6312     .
  6313 2000-BUILD-ELNAPS.
  6314     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6315     MOVE 'NA'                   TO NAPERSOFT-FILE
  6316     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6317     MOVE BL-CARRIER             TO NA-CARRIER
  6318     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6319     MOVE BL-CERT-NO             TO NA-CERT-NO
  6320     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6321                                    BL-ARCHIVE-NO
  6322     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6323     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6324     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6325                                    NA-INITIAL-PRINT-DT
  6326     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6327                                    NA-RESEND-DT
  6328                                    NA-RESEND-PRINT-DT
  6329                                    NA-1ST-LTR-PRINT-DT
  6330                                    NA-NEXT-DUE-DT
  6331                                    NA-AUTOPYDT
  6332     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6333     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6334        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6335           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6336             INTO DC-GREG-DATE-1-YMD-R
  6337        END-STRING
  6338        MOVE '3'                 TO DC-OPTION-CODE
  6339        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6340        IF NO-CONVERSION-ERROR
  6341           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6342                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 112
* NSRLTRBL.cbl
  6343        ELSE
  6344           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6345                                    WS-FOLLOW-UP-DT
  6346        END-IF
  6347     END-IF
  6348     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6349        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6350           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6351             INTO DC-GREG-DATE-1-YMD-R
  6352        END-STRING
  6353        MOVE '3'                 TO DC-OPTION-CODE
  6354        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6355        IF NO-CONVERSION-ERROR
  6356           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6357                                    WS-RESEND-DT
  6358        ELSE
  6359           MOVE LOW-VALUES       TO NA-RESEND-DT
  6360                                    WS-RESEND-DT
  6361        END-IF
  6362     END-IF
  6363     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6364
  6365* EXEC CICS WRITE
  6366*          DATASET   ('ELNAPS')
  6367*          FROM      (NAPERSOFT-FILE)
  6368*          RIDFLD    (NA-CONTROL-PRIMARY)
  6369*          RESP      (WS-RESPONSE)
  6370*       END-EXEC
  6371     MOVE LENGTH OF
  6372      NAPERSOFT-FILE
  6373       TO DFHEIV11
  6374     MOVE 'ELNAPS' TO DFHEIV1
  6375*    MOVE '&$ L                  ''  N#00005915' TO DFHEIV0
  6376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6378     MOVE X'204E233030303035393135' TO DFHEIV0(25:11)
  6379     CALL 'kxdfhei1' USING DFHEIV0,
  6380           DFHEIV1,
  6381           NAPERSOFT-FILE,
  6382           DFHEIV11,
  6383           NA-CONTROL-PRIMARY,
  6384           DFHEIV99,
  6385           DFHEIV99
  6386     MOVE EIBRESP  TO WS-RESPONSE
  6387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6388        IF RESP-NORMAL
  6389           CONTINUE
  6390        ELSE
  6391           IF RESP-DUPREC OR RESP-DUPKEY
  6392              ADD +1 TO NA-ARCHIVE-NO
  6393           ELSE
  6394              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6395                 ' ' NA-CONTROL-PRIMARY (2:19)
  6396              SET RESP-NORMAL TO TRUE
  6397           END-IF
  6398        END-IF
  6399     END-PERFORM
  6400    .
* Micro Focus Server Express         V5.1 revision 000 21-Apr-16 15:21 Page 113
* NSRLTRBL.cbl
  6401 2000-EXIT.
  6402     EXIT.
  6403 9700-DATE-LINK.
  6404
  6405* EXEC CICS LINK
  6406*        PROGRAM   ('ELDATCV')
  6407*        COMMAREA  (DATE-CONVERSION-DATA)
  6408*        LENGTH    (DC-COMM-LENGTH)
  6409*    END-EXEC.
  6410     MOVE 'ELDATCV' TO DFHEIV1
  6411*    MOVE '."C                   (   #00005937' TO DFHEIV0
  6412     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6414     MOVE X'2020233030303035393337' TO DFHEIV0(25:11)
  6415     CALL 'kxdfhei1' USING DFHEIV0,
  6416           DFHEIV1,
  6417           DATE-CONVERSION-DATA,
  6418           DC-COMM-LENGTH,
  6419           DFHEIV99,
  6420           DFHEIV99,
  6421           DFHEIV99,
  6422           DFHEIV99
  6423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6424
  6425 9700-EXIT.
  6426      EXIT.
  6427
  6428 9999-DFHBACK SECTION.
  6429     MOVE '9%                    "   ' TO DFHEIV0
  6430     MOVE 'NSRLTRBL' TO DFHEIV1
  6431     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6432     GOBACK.
  6433 9999-DFHEXIT.
  6434     IF DFHEIGDJ EQUAL 0001
  6435         NEXT SENTENCE.
  6436     MOVE '9%                    "   ' TO DFHEIV0
  6437     MOVE 'NSRLTRBL' TO DFHEIV1
  6438     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6439     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18392     Code:       16226
