* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128*-----------------------------------------------------------------
   129
   130 01  WORK-AREAS.
   131
   132*****************************************************************
   133*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   134*****************************************************************
   135
   136     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   137     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-NAME-EDIT-WORK-AREA.
   140         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   141         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   142             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   143         16  WS-WORK-NAME.
   144             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   145             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   146             20  FILLER           PIC X(10)     VALUE SPACES.
   147         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   148             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   149
   150*****************************************************************
   151*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   152*****************************************************************
   153
   154     12  WS-ERRESC-KEY.
   155         16 WS-ERRESC-SEARCH-KEY.
   156             20  WS-ERRESC-COMPANY-CD PIC  X.
   157             20  WS-ERRESC-CARRIER    PIC  X.
   158             20  WS-ERRESC-GROUP      PIC X(6).
   159             20  WS-ERRESC-STATE      PIC XX.
   160             20  WS-ERRESC-ACCOUNT    PIC X(10).
   161         16 WS-ERRESC-RESIDUAL-KEY.
   162             20  WS-ERRESC-AGENT      PIC X(10).
   163             20  WS-ERRESC-RES-STATE  PIC XX.
   164             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   165*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   5
* EL050.cbl
   166     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   167     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   168
   169*RESIDENT STATE TAX MASTER(ERRESS)
   170*
   171     12  WS-ERRESS-KEY.
   172         16  WS-ERRESS-COMPANY-CD      PIC  X.
   173         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   174         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   175         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   176*                                          YYYYMMDD
   177
   178     12  WS-CONTRACT-DATE              PIC 9(8).
   179*                                          YYYYMMDD
   180     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   181     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   182         16 WS-YEAR-YY                 PIC   9999.
   183         16 FILLER                     PIC 9(4).
   184*                                          YYYYMMDD
   185     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   186     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   187     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   188     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   189
   190     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   191         88  DPRB-1ST-TIME                      VALUE ' '.
   192
   193*****************************************************************
   194*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   195*****************************************************************
   196
   197     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   198     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   199     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   200     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   203     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   204     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   205     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   207         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   208         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   209     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   210         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   211         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   212     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   213
   214     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   215     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   216
   217     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   218     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   231     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   232     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   253     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   254     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   255     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   256     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   265     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   266     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   267     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   268     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   269     12  WS-2671-SW               PIC X         VALUE SPACE.
   270     12  WS-2672-SW               PIC X         VALUE SPACE.
   271     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   272         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   273     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   274         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   275     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   276
   277     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   278         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   279         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   280         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   281         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   7
* EL050.cbl
   282
   283     12  WS-CREDIT-EDIT-CONTROLS.
   284         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   285         16  WS-MIN-AGE           PIC 99                VALUE  0.
   286         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   287         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   288         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   290
   291     12  WS-AGE-FIELDS.
   292         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   293         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   295         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   296
   297     12  WS-SAVE-ALLOWABLE-BENEFIT.
   298         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   299         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   300         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   301         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   302         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   303         16  FILLER                      PIC XX.
   304
   305     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   306     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   307     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   308     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   309     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   310     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   311     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   313     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   314     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315
   316     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   317     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   318     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   319     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   320     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   321     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   322     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   323     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   324         88  WS-REDUCING              VALUE 'R'.
   325         88  WS-LEVEL                 VALUE 'L' 'P'.
   326     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   327
   328     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   329     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   330     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   331     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   332     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   333     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   334     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   335     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   336     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   337
   338     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   339     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   8
* EL050.cbl
   340     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   341     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   343     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   344     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   345     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   346     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   347     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   348     12  WS-ACCT-SIG-SW.
   349         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   350         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   351     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   352     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   354     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-INITIALS.
   360         16  WS-INIT-1            PIC X         VALUE SPACES.
   361         16  WS-INIT-2            PIC X         VALUE SPACES.
   362
   363     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   364     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   365     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   366     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   368*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   369     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   370     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   376     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   377     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   385     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391******** FLA
   392     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   396     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397********
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   9
* EL050.cbl
   398     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   399     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   402     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   403     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   404     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   405     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   406     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   407     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   408
   409     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   410         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   411                                         '0' THRU '9'.
   412
   413     12  NUMBER-OF-MONTHS.
   414         16  SK-MO OCCURS 12 TIMES PIC X.
   415
   416     12  WS-WORK-DATE.
   417         16  WS-YEAR            PIC 99    VALUE 00.
   418         16  WS-MONTH           PIC 99    VALUE 00.
   419         16  WS-DAY             PIC 99    VALUE 00.
   420
   421     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   422     12  WS-WORK-CRIT-DEV       REDEFINES
   423         WS-WORK-LF-CRIT-PER    PIC X(03).
   424
   425     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   426     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   427
   428     12  WS-WORK-DATE-FROM.
   429         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   430         16  FILLER             PIC X  VALUE SPACE.
   431         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   432         16  FILLER             PIC X         VALUE SPACE.
   433         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   434
   435     12  WS-WORK-DATE-THRU.
   436         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   437         16  FILLER             PIC X         VALUE SPACE.
   438         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   439         16  FILLER             PIC X         VALUE SPACE.
   440         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   441
   442     12  WS-LF-INPUT-CD.
   443         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   444         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   445
   446     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   447     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   448         16  WS-AH-INPUT-CD-1   PIC X.
   449         16  WS-AH-INPUT-CD-2-3 PIC XX.
   450
   451     12  WS-SWITCHES.
   452         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   453         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   454             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   455         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  10
* EL050.cbl
   456             88  BANK-ACCT-FOUND          VALUE 'Y'.
   457         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   458             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   459         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   460             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   461         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   462             88  COMP-MASTER-FOUND        VALUE 'Y'.
   463         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   464             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   465         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   466             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   467         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   468             88  STAT-MASTER-FOUND        VALUE 'Y'.
   469         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   470             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   471         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   472             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   473         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   474             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   475         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   476             88  FORM-MASTER-FOUND        VALUE 'Y'.
   477         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   478             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   479         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   480             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   481         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   482             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   483         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   484             88  NO-BENEFIT-FOUND         VALUE 'N'.
   485         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   486             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   487         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   488             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   489         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   490             88  AH-BENEFIT-FOUND         VALUE ' '.
   491             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   492         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   493             88  LF-BENEFIT-FOUND         VALUE ' '.
   494             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   495         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   496             88  NO-STATE-RECORD          VALUE '1'.
   497         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   498             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   499         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   500             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   501         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   502             88  CERT-WAS-FOUND           VALUE ' '.
   503             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   504         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   505             88  BROWSE-STARTED           VALUE 'Y'.
   506         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   507             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   508         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   509             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   510         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   511             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   512         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   513             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  11
* EL050.cbl
   514         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   515             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   516         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   517             88  APP-CERT-USED            VALUE 'Y' 'A'.
   518         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   519             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   520             88  FIRST-TIME-THROUGH       VALUE '1'.
   521             88  CTBL-NOT-FOUND           VALUE '2'.
   522
   523         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   524             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   525
   526         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   527             88  DLO-ERROR-FOUND          VALUE 'Y'.
   528
   529********FLA
   530     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   531     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   532********
   533     12  RC-SW-1                  PIC X           VALUE '0'.
   534     12  RC-SW-2                  PIC X           VALUE '0'.
   535     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   536     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   538     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   545     12  LIT-SPACES               PIC X           VALUE SPACES.
   546     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   547     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   548     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   549     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   550     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   551     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   553         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   554         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   555     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   556         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   557
   558 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   559     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   560     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   561 01  WS-CRI-SSN-WORK-AREA.
   562     05  WS-CRI-SOC-SEC-NO.
   563         10  WS-SS-REPT-CD       PIC X(5).
   564         10  WS-SS-LAST-NAME     PIC X(5).
   565         10  WS-SS-INITIAL       PIC X.
   566
   567     05  WS-CRI-REPORT-CODE.
   568         10  FILLER              PIC X(5).
   569         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   570
   571     05  WS-CRI-LAST-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  12
* EL050.cbl
   572         10  WS-CRI-NAME-MOVE    PIC X(5).
   573         10  FILLER              PIC X(10).
   574
   575 01  WS-NUM-TABLE                PIC X(26)  VALUE
   576     '12345678012345070923456789'.
   577 01  FILLER REDEFINES WS-NUM-TABLE.
   578     05  WS-NUM OCCURS 26        PIC 9.
   579 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   580 01  V1                          PIC S999 COMP-3.
   581 01  V2                          PIC S999 COMP-3.
   582 01  V3                          PIC S999 COMP-3.
   583 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   584 01  FILLER REDEFINES WS-WORK-VIN.
   585     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   586 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   587 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   588 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   589 01  WS-HEX-WORK.
   590     05  FILLER                  PIC X  VALUE LOW-VALUES.
   591     05  WS-HEX-BYTE             PIC X.
   592 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   593 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   594 01  WS-WORK-HIN-ROW-B.
   595     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   596
   597 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   598 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   599     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   600 01  WS-ROW-D-TABLE.
   601     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   602
   603 01  WS-HIN-TABLE-B.
   604     05  F                       PIC XX VALUE 'A2'.
   605     05  F                       PIC XX VALUE 'B3'.
   606     05  F                       PIC XX VALUE 'C4'.
   607     05  F                       PIC XX VALUE 'D5'.
   608     05  F                       PIC XX VALUE 'E6'.
   609     05  F                       PIC XX VALUE 'F7'.
   610     05  F                       PIC XX VALUE 'G8'.
   611     05  F                       PIC XX VALUE 'H9'.
   612     05  F                       PIC XX VALUE 'I1'.
   613     05  F                       PIC XX VALUE 'J2'.
   614     05  F                       PIC XX VALUE 'K3'.
   615     05  F                       PIC XX VALUE 'L4'.
   616     05  F                       PIC XX VALUE 'M5'.
   617     05  F                       PIC XX VALUE 'N6'.
   618     05  F                       PIC XX VALUE 'O0'.
   619     05  F                       PIC XX VALUE 'P7'.
   620     05  F                       PIC XX VALUE 'Q0'.
   621     05  F                       PIC XX VALUE 'R8'.
   622     05  F                       PIC XX VALUE 'S9'.
   623     05  F                       PIC XX VALUE 'T2'.
   624     05  F                       PIC XX VALUE 'U3'.
   625     05  F                       PIC XX VALUE 'V4'.
   626     05  F                       PIC XX VALUE 'W5'.
   627     05  F                       PIC XX VALUE 'X6'.
   628     05  F                       PIC XX VALUE 'Y7'.
   629     05  F                       PIC XX VALUE 'Z8'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  13
* EL050.cbl
   630 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   631     05  WS-VAL-IN               PIC X.
   632     05  WS-VAL-OUT              PIC 9.
   633 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   634 01  WS-COMPARE-BINARY-DATES.
   635     05  WS-971231                PIC XX VALUE X'92FF'.
   636     05  WS-931231                PIC XX VALUE X'8CFF'.
   637     05  WS-791231                PIC XX VALUE X'77FF'.
   638     05  WS-771001                PIC XX VALUE X'74A1'.
   639     05  WS-820301                PIC XX VALUE X'7B41'.
   640     05  WS-831031                PIC XX VALUE X'7DBF'.
   641     05  WS-831231                PIC XX VALUE X'7DFF'.
   642     05  WS-810831                PIC XX VALUE X'7A7F'.
   643     05  WS-830901                PIC XX VALUE X'7D81'.
   644
   645 01  FILE-ACCESS-IDS.
   646     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   647     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   648     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   649     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   650     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   651     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   652     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   653     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   654     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   655     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   656     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   657     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   658     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   659     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   660     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   661     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   662     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   663 01  DD-IU-SW                    PIC X   VALUE ' '.
   664     88  DD-IU-PRESENT                 VALUE 'Y'.
   665
   666 01  ACCESS-KEYS.
   667     12  ELMSTR-KEY.
   668         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   669         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   670     12  W-CLAIM-KEY.
   671         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCNTL-KEY.
   675         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   676         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   677         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   678         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   679
   680     12  ELCERT-KEY.
   681         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   682         16  CERT-CARRIER         PIC X       VALUE SPACE.
   683         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   684         16  CERT-STATE           PIC XX      VALUE SPACES.
   685         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   686         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   687         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  14
* EL050.cbl
   688
   689     12  ELCERT2-KEY.
   690         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   691         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   692
   693     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   694
   695     12  ELCERT-SAVE.
   696         16  FILLER                      PIC XX    VALUE SPACES.
   697
   698         16  WCS-CONTROL-PRIMARY.
   699             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   700             20  WCS-CARRIER             PIC X     VALUE SPACE.
   701             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   702             20  WCS-STATE               PIC XX    VALUE SPACES.
   703             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   704             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   705             20  WCS-CERT-NO.
   706                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   707                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   708
   709         16  CS-CONTROL-BY-NAME.
   710             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   711             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   712             20  CS-INSURED-INITIALS.
   713                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   714                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   715
   716         16  CS-CONTROL-BY-SSN.
   717             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   718             20  CS-SOC-SEC-NO.
   719                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   720                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   721                 24  CS-SSN-LN3.
   722                     28 CS-INSURED-INITIALS-A2   PIC XX
   723                                     VALUE SPACES.
   724                     28 CS-PART-LAST-NAME-A2     PIC X
   725                                     VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-CERT-NO.
   728             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   729             20  CS-CERT-NO-A4           PIC X(11)
   730                                     VALUE SPACES.
   731
   732         16  CS-CONTROL-BY-MEMB.
   733             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   734             20  CS-MEMBER-NO.
   735                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   736                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   737                 24  CS-MEMB-LN4.
   738                     28 CS-INSURED-INITIALS-A5   PIC XX
   739                                      VALUE SPACES.
   740                     28 CS-PART-LAST-NAME-A5     PIC XX
   741                                      VALUE SPACES.
   742
   743         16  FILLER              PIC X(360) VALUE SPACES.
   744
   745     12  ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  15
* EL050.cbl
   746         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   747         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   748         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   749         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   750         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   751         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   752
   753     12  ERCOMP-KEY.
   754         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   755         16  COMP-CARRIER         PIC X     VALUE SPACES.
   756         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   757         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   758         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   759         16  COMP-TYPE            PIC X     VALUE SPACES.
   760
   761     12  ERLOFC-KEY.
   762         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   763         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   764         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   765         16  LOFC-STATE           PIC XX    VALUE SPACES.
   766         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   767         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   768
   769     12  WS-ELCRTT-KEY.
   770         16  WS-ELCRTT-PRIMARY       PIC X(33).
   771         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   772
   773     12  ERBXRF-KEY.
   774         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   775         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   776         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   777         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   778
   779     12  ERAGTC-KEY.
   780         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   782         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   783         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   784         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   785         16  AGTC-TYPE            PIC X     VALUE SPACES.
   786
   787     12  ERPLAN-KEY.
   788         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   790         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   791         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   792         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   793         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   794         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   795         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   796
   797     12  ERFORM-KEY.
   798         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   800         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   801         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   802
   803     12  ERREIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  16
* EL050.cbl
   804         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   805         16  REIN-TYPE            PIC X     VALUE SPACES.
   806         16  REIN-TABLE-CO.
   807             20  REIN-CODE-1      PIC X     VALUE SPACE.
   808             20  REIN-CODE-2      PIC X     VALUE SPACE.
   809             20  REIN-CODE-3      PIC X     VALUE SPACE.
   810         16  FILLER               PIC X(3)  VALUE SPACES.
   811
   812     12  ERCTBL-KEY.
   813         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   814         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   815         16  CTBL-CNTRL-2.
   816             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   817             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   818
   819     12  ELCRTO-KEY.
   820         16  ELCRTO-COMPANY-CD       PIC X.
   821         16  ELCRTO-CARRIER          PIC X.
   822         16  ELCRTO-GROUPING         PIC X(6).
   823         16  ELCRTO-STATE            PIC XX.
   824         16  ELCRTO-ACCOUNT          PIC X(10).
   825         16  ELCRTO-CERT-EFF-DT      PIC XX.
   826         16  ELCRTO-CERT-NO.
   827             20  ELCRTO-CERT-PRIME   PIC X(10).
   828             20  ELCRTO-CERT-SFX     PIC X.
   829         16  ELCRTO-RECORD-TYPE      PIC X.
   830         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   831
   832
   833     12  WS-ACCESS.
   834         16  FILLER               PIC XX    VALUE SPACES.
   835         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   836
   837     12  WS-CARR-ACCESS.
   838         16  FILLER               PIC X(3)  VALUE SPACES.
   839         16  WS-CARR              PIC X     VALUE SPACE.
   840*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   841*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   842     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   843         88  WS-DMD-LF-RATING   VALUE 'Y'.
   844         88  WS-DMD-AH-RATING   VALUE 'Y'.
   845         88  WS-DMD-NO-RATING   VALUE 'N'.
   846
   847     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   848         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   849                                         'NJ' 'NL'
   850                                         'PJ' 'PL'
   851                                         'SJ' 'SL'.
   852     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   853         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   854                                         'NI' 'NJ' 'NL' 'NU'
   855                                         'PJ' 'PL' 'PI' 'PU'
   856                                         'SI' 'SJ' 'SL' 'SU'
   857                                         'MX' 'MY' 'MZ'.
   858 01  ERPDEF-KEY-SAVE             PIC X(18).
   859 01  ERPDEF-KEY.
   860     12  ERPDEF-COMPANY-CD       PIC X.
   861     12  ERPDEF-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  17
* EL050.cbl
   862     12  ERPDEF-PROD-CD          PIC XXX.
   863     12  F                       PIC X(7).
   864     12  ERPDEF-BEN-TYPE         PIC X.
   865     12  ERPDEF-BEN-CODE         PIC XX.
   866     12  ERPDEF-EXP-DT           PIC XX.
   867
   868 01  ELSTAT-KEY-SAVE             PIC X(20).
   869 01  ELSTAT-KEY.
   870     12  ELSTAT-COMPANY-ID       PIC XXX.
   871     12  ELSTAT-CARRIER          PIC X.
   872     12  ELSTAT-GROUP            PIC X(6).
   873     12  ELSTAT-STATE            PIC XX.
   874     12  ELSTAT-EXP-DT           PIC 9(8).
   875 01  WS-ERROR-VALUES.
   876     12  ER-1570                     PIC S9(4)   VALUE +1570.
   877     12  ER-1571                     PIC S9(4)   VALUE +1571.
   878     12  ER-1575                     PIC S9(4)   VALUE +1575.
   879     12  ER-1891                     PIC S9(4)   VALUE +1891.
   880     12  ER-1892                     PIC S9(4)   VALUE +1892.
   881     12  ER-1893                     PIC S9(4)   VALUE +1893.
   882     12  ER-1894                     PIC S9(4)   VALUE +1894.
   883     12  ER-1895                     PIC S9(4)   VALUE +1895.
   884     12  ER-1896                     PIC S9(4)   VALUE +1896.
   885     12  ER-1897                     PIC S9(4)   VALUE +1897.
   886     12  ER-1898                     PIC S9(4)   VALUE +1898.
   887     12  ER-1899                     PIC S9(4)   VALUE +1899.
   888     12  ER-1900                     PIC S9(4)   VALUE +1900.
   889     12  ER-1901                     PIC S9(4)   VALUE +1901.
   890     12  ER-1902                     PIC S9(4)   VALUE +1902.
   891     12  ER-1903                     PIC S9(4)   VALUE +1903.
   892     12  ER-1904                     PIC S9(4)   VALUE +1904.
   893     12  ER-1905                     PIC S9(4)   VALUE +1905.
   894     12  ER-1906                     PIC S9(4)   VALUE +1906.
   895     12  ER-1907                     PIC S9(4)   VALUE +1907.
   896     12  ER-1909                     PIC S9(4)   VALUE +1909.
   897     12  ER-1910                     PIC S9(4)   VALUE +1910.
   898     12  ER-1911                     PIC S9(4)   VALUE +1911.
   899     12  ER-1912                     PIC S9(4)   VALUE +1912.
   900     12  ER-1913                     PIC S9(4)   VALUE +1913.
   901     12  ER-1914                     PIC S9(4)   VALUE +1914.
   902     12  ER-1915                     PIC S9(4)   VALUE +1915.
   903     12  ER-1916                     PIC S9(4)   VALUE +1916.
   904     12  ER-1917                     PIC S9(4)   VALUE +1917.
   905     12  ER-1918                     PIC S9(4)   VALUE +1918.
   906     12  ER-1919                     PIC S9(4)   VALUE +1919.
   907     12  ER-1920                     PIC S9(4)   VALUE +1920.
   908     12  ER-1921                     PIC S9(4)   VALUE +1921.
   909     12  ER-1922                     PIC S9(4)   VALUE +1922.
   910     12  ER-1923                     PIC S9(4)   VALUE +1923.
   911     12  ER-1924                     PIC S9(4)   VALUE +1924.
   912     12  ER-1925                     PIC S9(4)   VALUE +1925.
   913     12  ER-1926                     PIC S9(4)   VALUE +1926.
   914     12  ER-1927                     PIC S9(4)   VALUE +1927.
   915     12  ER-2393                     PIC S9(4)   VALUE +2393.
   916     12  ER-2600                     PIC S9(4)   VALUE +2600.
   917     12  ER-2601                     PIC S9(4)   VALUE +2601.
   918     12  ER-2602                     PIC S9(4)   VALUE +2602.
   919     12  ER-2603                     PIC S9(4)   VALUE +2603.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  18
* EL050.cbl
   920     12  ER-2604                     PIC S9(4)   VALUE +2604.
   921     12  ER-2605                     PIC S9(4)   VALUE +2605.
   922     12  ER-2606                     PIC S9(4)   VALUE +2606.
   923     12  ER-2607                     PIC S9(4)   VALUE +2607.
   924     12  ER-2608                     PIC S9(4)   VALUE +2608.
   925     12  ER-2609                     PIC S9(4)   VALUE +2609.
   926     12  ER-2610                     PIC S9(4)   VALUE +2610.
   927     12  ER-2611                     PIC S9(4)   VALUE +2611.
   928     12  ER-2612                     PIC S9(4)   VALUE +2612.
   929     12  ER-2613                     PIC S9(4)   VALUE +2613.
   930     12  ER-2614                     PIC S9(4)   VALUE +2614.
   931     12  ER-2615                     PIC S9(4)   VALUE +2615.
   932     12  ER-2616                     PIC S9(4)   VALUE +2616.
   933     12  ER-2617                     PIC S9(4)   VALUE +2617.
   934     12  ER-2618                     PIC S9(4)   VALUE +2618.
   935     12  ER-2619                     PIC S9(4)   VALUE +2619.
   936     12  ER-2620                     PIC S9(4)   VALUE +2620.
   937     12  ER-2621                     PIC S9(4)   VALUE +2621.
   938     12  ER-2622                     PIC S9(4)   VALUE +2622.
   939     12  ER-2623                     PIC S9(4)   VALUE +2623.
   940     12  ER-2624                     PIC S9(4)   VALUE +2624.
   941     12  ER-2625                     PIC S9(4)   VALUE +2625.
   942     12  ER-2626                     PIC S9(4)   VALUE +2626.
   943     12  ER-2627                     PIC S9(4)   VALUE +2627.
   944     12  ER-2628                     PIC S9(4)   VALUE +2628.
   945     12  ER-2629                     PIC S9(4)   VALUE +2629.
   946     12  ER-2630                     PIC S9(4)   VALUE +2630.
   947     12  ER-2631                     PIC S9(4)   VALUE +2631.
   948     12  ER-2632                     PIC S9(4)   VALUE +2632.
   949     12  ER-2633                     PIC S9(4)   VALUE +2633.
   950     12  ER-2634                     PIC S9(4)   VALUE +2634.
   951     12  ER-2635                     PIC S9(4)   VALUE +2635.
   952     12  ER-2636                     PIC S9(4)   VALUE +2636.
   953     12  ER-2637                     PIC S9(4)   VALUE +2637.
   954     12  ER-2638                     PIC S9(4)   VALUE +2638.
   955     12  ER-2639                     PIC S9(4)   VALUE +2639.
   956     12  ER-2640                     PIC S9(4)   VALUE +2640.
   957     12  ER-2641                     PIC S9(4)   VALUE +2641.
   958     12  ER-2642                     PIC S9(4)   VALUE +2642.
   959     12  ER-2643                     PIC S9(4)   VALUE +2643.
   960     12  ER-2644                     PIC S9(4)   VALUE +2644.
   961     12  ER-2645                     PIC S9(4)   VALUE +2645.
   962     12  ER-2646                     PIC S9(4)   VALUE +2646.
   963     12  ER-2647                     PIC S9(4)   VALUE +2647.
   964     12  ER-2648                     PIC S9(4)   VALUE +2648.
   965     12  ER-2649                     PIC S9(4)   VALUE +2649.
   966     12  ER-2650                     PIC S9(4)   VALUE +2650.
   967     12  ER-2651                     PIC S9(4)   VALUE +2651.
   968     12  ER-2652                     PIC S9(4)   VALUE +2652.
   969     12  ER-2653                     PIC S9(4)   VALUE +2653.
   970     12  ER-2654                     PIC S9(4)   VALUE +2654.
   971     12  ER-2655                     PIC S9(4)   VALUE +2655.
   972     12  ER-2656                     PIC S9(4)   VALUE +2656.
   973     12  ER-2657                     PIC S9(4)   VALUE +2657.
   974     12  ER-2658                     PIC S9(4)   VALUE +2658.
   975     12  ER-2659                     PIC S9(4)   VALUE +2659.
   976     12  ER-2660                     PIC S9(4)   VALUE +2660.
   977     12  ER-2661                     PIC S9(4)   VALUE +2661.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  19
* EL050.cbl
   978     12  ER-2662                     PIC S9(4)   VALUE +2662.
   979     12  ER-2663                     PIC S9(4)   VALUE +2663.
   980     12  ER-2664                     PIC S9(4)   VALUE +2664.
   981     12  ER-2665                     PIC S9(4)   VALUE +2665.
   982     12  ER-2666                     PIC S9(4)   VALUE +2666.
   983     12  ER-2667                     PIC S9(4)   VALUE +2667.
   984     12  ER-2668                     PIC S9(4)   VALUE +2668.
   985     12  ER-2669                     PIC S9(4)   VALUE +2669.
   986     12  ER-2670                     PIC S9(4)   VALUE +2670.
   987     12  ER-2671                     PIC S9(4)   VALUE +2671.
   988     12  ER-2672                     PIC S9(4)   VALUE +2672.
   989     12  ER-2673                     PIC S9(4)   VALUE +2673.
   990     12  ER-2674                     PIC S9(4)   VALUE +2674.
   991     12  ER-2675                     PIC S9(4)   VALUE +2675.
   992     12  ER-2676                     PIC S9(4)   VALUE +2676.
   993     12  ER-2677                     PIC S9(4)   VALUE +2677.
   994     12  ER-2678                     PIC S9(4)   VALUE +2678.
   995     12  ER-2679                     PIC S9(4)   VALUE +2679.
   996     12  ER-2680                     PIC S9(4)   VALUE +2680.
   997     12  ER-2681                     PIC S9(4)   VALUE +2681.
   998     12  ER-2682                     PIC S9(4)   VALUE +2682.
   999     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1000     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1001     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1002     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1003     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1004     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1005     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1006     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1007     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1008     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1009     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1010     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1011     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1012     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1013     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1014     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1015     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1016     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1017     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1018     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1019     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1020     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1021     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1022     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1023     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1024     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1025     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1026     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1027     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1028     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1029     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1030     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1031     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1032     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1033     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1034     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1035     12  ER-2729                     PIC S9(4)   VALUE +2729.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  20
* EL050.cbl
  1036     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1037     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1038     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1039     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1040     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1041     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1042     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1043     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1044     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1045     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1046     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1047     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1048     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1049     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1050     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1051     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1052     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1053     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1054     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1055     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1056     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1057     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1058     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1059     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1060     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1061     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1062     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1063     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1064     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1065     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1066     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1067     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1068     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1069     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1070     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1071     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1072     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1073     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1074     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1075     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1076     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1077     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1078     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1079     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1080     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1081     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1082     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1083     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1084     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1085     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1086     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1087     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1088     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1089     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1090     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1091     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1092     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1093     12  ER-2789                     PIC S9(4)   VALUE +2789.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  21
* EL050.cbl
  1094     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1095     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1096     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1097     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1098     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1099     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1100     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1101     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1102     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1103     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1104     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1105     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1106     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1107     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1108     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1109     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1110     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1111     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1112     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1113     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1114     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1115     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1116     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1117     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1118     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1119     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1120     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1121     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1122     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1123     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1124     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1125     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1126     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1127     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1128     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1129     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1130     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1131     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1132     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1133     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1134     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1135     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1136     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1137     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1138     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1139     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1140     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1141     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1142     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1143     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1144     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1145     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1146     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1147     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1148     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1149     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1150     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1151     12  ER-8041                     PIC S9(4)   VALUE +8041.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  22
* EL050.cbl
  1152     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1153     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1154     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1155     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1156     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1157     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1158     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1159     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1160     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1161     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1162     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1163     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1164     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1165     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1166     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1167     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1168     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1169     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1170     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1171     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1172     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1173     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1174     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1175     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1176     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1177     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1178     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1179     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1180     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1181     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1182     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1183     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1184     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1185     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1186     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1187     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1188     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1189     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1190     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1191     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1192     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1193     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1194     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1195     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1196     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1197     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1198     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1199     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1200     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1201     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1202     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1203     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1204     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1205     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1206     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1207     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1208     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1209     12  ER-8315                     PIC S9(4)   VALUE +8315.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  23
* EL050.cbl
  1210     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1211     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1212     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1213     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1214     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1215     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1216     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1217******************************************************************
  1218***************   END OF ELC50WS     ****************************
  1219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  24
* EL050.cbl
  1222 01  WORKING-STORAGE-WORK-AREAS.
  1223     12  WS-RESPONSE             PIC S9(8)  COMP.
  1224         88  WS-RESP-NORMAL           VALUE +00.
  1225         88  WS-RESP-ERROR            VALUE +01.
  1226         88  WS-RESP-NOTFND           VALUE +13.
  1227         88  WS-RESP-DUPREC           VALUE +14.
  1228         88  WS-RESP-ENDFILE          VALUE +20.
  1229     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1230     12  WORK-AREAS.
  1231         16  WK-CONV-GREG.
  1232             24  WCG-CENT             PIC XX.
  1233             24  WCG-REST             PIC X(4).
  1234         16  WORK-GREGORIAN-DATE.
  1235             24  WK-GREG-CENT         PIC XX.
  1236             24  WK-GREG-DATE-YYMMDD.
  1237                 28  WK-GREG-YYMM     PIC X(4).
  1238                 28  WK-GREG-DD       PIC XX.
  1239
  1240         16  WORK-SELECT-DATE.
  1241             24  WK-SELECT-CENT            PIC XX.
  1242             24  WK-SELECT-DATE-YYMMDD.
  1243                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1244                 28  FILLER                PIC XX.
  1245
  1246         16  WK-FORM-NO.
  1247             24  WK-FORM-BANK-ID       PIC X(5).
  1248             24  WK-FORM-UNDRWRTR      PIC X(1).
  1249             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1250
  1251         16  WK-MEMBER-NO.
  1252             24  WK-MEMBER-1-6        PIC X(6).
  1253             24  WK-MEMBER-7-12       PIC X(6).
  1254
  1255         16  WK-FULL-CERT-NO.
  1256             24  WK-CERT-POS-1-2      PIC X(2).
  1257             24  WK-CERT-POS-3        PIC X(1).
  1258             24  WK-CERT-POS-4        PIC X(1).
  1259             24  WK-CERT-POS-5-6      PIC X(2).
  1260             24  WK-CERT-POS-7        PIC X(1).
  1261             24  WK-CERT-POS-8-11     PIC X(4).
  1262
  1263         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1264             88  VALID-RATE-CODE        VALUE 'Y'.
  1265             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1266
  1267         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1268         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1269         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1271         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1272         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1273         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1274         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1275         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1276         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1277
  1278* DLO001
  1279 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  25
* EL050.cbl
  1280     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DMPF-RETURN-CODE          PIC XX.
  1282         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1287         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO002
  1290 01  WS-DLO-INTERNAL-POLICY-FORM.
  1291     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1292     12  DIPF-RETURN-CODE          PIC XX.
  1293         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1294         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1295         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1296         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1297         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1298         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1299
  1300* DLO003
  1301 01  WS-DLO-VALID-BANK-ID.
  1302     12  DVBI-BANK-ID              PIC X(5).
  1303     12  DVBI-BANK-ID-TYPE         PIC X.
  1304         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1305         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1306         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1307         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1308         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1309     12  DVBI-RETURN-CODE          PIC XX.
  1310         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1311         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1312         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1313         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1314         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1315         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1316         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1317         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1318         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1319
  1320* DLO007
  1321 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1322     12  DCUA-RES-STATE            PIC XX.
  1323     12  DCUA-BEN-TYPE             PIC XX.
  1324     12  DCUA-SYS-IDENT            PIC X.
  1325         88  DCUA-CLAIM                        VALUE 'C'.
  1326         88  DCUA-PREMIUM                      VALUE 'P'.
  1327     12  DCUA-COVERAGE-RULE        PIC X.
  1328     12  DCUA-CLIENT-ID            PIC X(10).
  1329     12  DCUA-EFF-DATE             PIC X(8).
  1330     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1331     12  DCUA-RETURN-CODE          PIC XX.
  1332         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1333     12  DCUA-CERT-NUMBER          PIC X(11).
  1334     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1335     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1336
  1337* DLO011
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  26
* EL050.cbl
  1338 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1339     12  DPRB-RATE-CODE            PIC X(4).
  1340     12  DPRB-COVERAGE-CATEG       PIC X.
  1341     12  DPRB-RETURN-CODE          PIC XX.
  1342         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1343         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1344         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1345         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1346         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1347         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1348         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1349         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1350         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1351     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1352     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1353     12  DPRB-BEN-TYPE             PIC XX.
  1354
  1355* DLO017
  1356 01  WS-DLO-VALID-RATE-CODE.
  1357     12  DVRC-RATE-CODE            PIC X(4).
  1358     12  DVRC-RETURN-CODE          PIC XX.
  1359         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1360         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1361         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1362         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1363         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1364         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1365
  1366* DLO019
  1367 01  WS-DLO-ORIG-COV-CAT.
  1368     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1369     12  DOCC-RETURN-CODE          PIC XX.
  1370     12  DOCC-ORIG-COV-CAT         PIC X.
  1371     12  DOCC-UNDERWITER           PIC XX.
  1372     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1373     12  DOCC-FILLER               PIC X(6).
  1374
  1375* DLO021
  1376 01  WS-DLO-VALID-LOAN-OFFICER.
  1377     12  DVLO-LOAN-OFFICER.
  1378         16  DVLO-BILL-TYPE        PIC X.
  1379         16  DVLO-BILL-SOURCE      PIC X.
  1380         16  DVLO-BATCH-TYPE       PIC X.
  1381     12  DVLO-RETURN-CODE          PIC XX.
  1382         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1384         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1385         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1386         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1387         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1388
  1389* DLO022
  1390 01  WS-DLO-VALID-STATE-CODE.
  1391     12  DVSC-STATE-CODE           PIC XX.
  1392     12  DVSC-RETURN-CODE          PIC XX.
  1393         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1394
  1395* DLO023
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  27
* EL050.cbl
  1396 01  WS-DLO-VALID-CODE-VALUES.
  1397     12  DVCV-SYSTEM-ID            PIC XX.
  1398         88  DVCV-CLAIMS                       VALUE 'CL'.
  1399         88  DVCV-CREDIT                       VALUE 'CR'.
  1400     12  DVCV-RECORD-TYPE          PIC XX.
  1401         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1402         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1403         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1404         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1405         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1406         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1407         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1408         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1409     12  DVCV-RECORD-KEY           PIC X(6).
  1410     12  DVCV-RETURN-CODE          PIC XX.
  1411         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1413         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1414         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1415         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1416         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1418     12  DVCV-CODE-DESC            PIC X(60).
  1419     12  DVCV-GEN-DESC-1           PIC X(20).
  1420     12  DVCV-GEN-DESC-2           PIC X(20).
  1421     12  DVCV-GEN-DESC-3           PIC X(20).
  1422
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  28
* EL050.cbl
  1424*    COPY ERCBXRF.
  1425******************************************************************
  1426*                                                                *
  1427*                                                                *
  1428*                            ERCBXRF                             *
  1429*                                                                *
  1430*   ONLINE CREDIT SYSTEM                                         *
  1431*                                                                *
  1432*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1433*                                                                *
  1434*   FILE TYPE = VSAM,KSDS                                        *
  1435*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1436*                                                                *
  1437*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1438*       ALTERNATE PATH = NONE                                    *
  1439*                                                                *
  1440*   LOG = NO                                                     *
  1441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1442*                                                                *
  1443******************************************************************
  1444
  1445 01  BANK-CROSS-REFERENCE.
  1446     12  BK-RECORD-ID                PIC XX.
  1447         88  VALID-BK-ID             VALUE 'BK'.
  1448
  1449     12  BK-CONTROL-PRIMARY.
  1450         16  BK-COMPANY-CD           PIC X.
  1451         16  BK-CARRIER              PIC X.
  1452         16  BK-GROUPING             PIC X(6).
  1453         16  BK-BANK-NO              PIC X(10).
  1454
  1455     12  BK-MAINT-INFORMATION.
  1456         16  BK-LAST-MAINT-DT        PIC XX.
  1457         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1458         16  BK-LAST-MAINT-USER      PIC X(4).
  1459         16  FILLER                  PIC X(9).
  1460
  1461     12  FILLER                      PIC X(37).
  1462
  1463     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1464
  1465     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1466                            DEPENDING ON BK-BANK-POINTER-CNT.
  1467         16  BK-AM-ACCOUNT           PIC X(10).
  1468         16  BK-AM-EXP-DT            PIC XX.
  1469         16  BK-AM-EFF-DT            PIC XX.
  1470         16  BK-AM-STATE             PIC XX.
  1471         16  FILLER                  PIC X(20).
  1472
  1473******************************************************************
  1474
  1475*    COPY ERCCOMP.
  1476******************************************************************
  1477*                                                                *
  1478*                                                                *
  1479*                            ERCCOMP                             *
  1480*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1481*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  29
* EL050.cbl
  1482*                                                                *
  1483*   ONLINE CREDIT SYSTEM                                         *
  1484*                                                                *
  1485*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1486*                                                                *
  1487*   FILE TYPE = VSAM,KSDS                                        *
  1488*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1489*                                                                *
  1490*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1491*       ALTERNATE PATH = NONE                                    *
  1492*                                                                *
  1493*   LOG = NO                                                     *
  1494*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1495*                                                                *
  1496******************************************************************
  1497*                   C H A N G E   L O G
  1498*
  1499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1500*-----------------------------------------------------------------
  1501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1502* EFFECTIVE    NUMBER
  1503*-----------------------------------------------------------------
  1504* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1505* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1506* 092205    2005050300006  PEMA  ADD LEASE FEE
  1507* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1508* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1509* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1510* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1511* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1512* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1513******************************************************************
  1514
  1515 01  COMPENSATION-MASTER.
  1516     12  CO-RECORD-ID                          PIC XX.
  1517         88  VALID-CO-ID                          VALUE 'CO'.
  1518
  1519     12  CO-CONTROL-PRIMARY.
  1520         16  CO-COMPANY-CD                     PIC X.
  1521         16  CO-CONTROL.
  1522             20  CO-CTL-1.
  1523                 24  CO-CARR-GROUP.
  1524                     28  CO-CARRIER            PIC X.
  1525                     28  CO-GROUPING.
  1526                         32  CO-GROUP-PREFIX   PIC XXX.
  1527                         32  CO-GROUP-PRIME    PIC XXX.
  1528                 24  CO-RESP-NO.
  1529                     28  CO-RESP-PREFIX        PIC X(4).
  1530                     28  CO-RESP-PRIME         PIC X(6).
  1531             20  CO-CTL-2.
  1532                 24  CO-ACCOUNT.
  1533                     28  CO-ACCT-PREFIX        PIC X(4).
  1534                     28  CO-ACCT-PRIME         PIC X(6).
  1535         16  CO-TYPE                           PIC X.
  1536             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1537             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1538             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1539
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  30
* EL050.cbl
  1540     12  CO-MAINT-INFORMATION.
  1541         16  CO-LAST-MAINT-DT                  PIC XX.
  1542         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1543         16  CO-LAST-MAINT-USER                PIC X(4).
  1544     12  FILLER                                PIC XX.
  1545     12  CO-STMT-TYPE                          PIC XXX.
  1546     12  CO-COMP-TYPE                          PIC X.
  1547         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1548     12  CO-STMT-OWNER                         PIC X(4).
  1549     12  CO-BALANCE-CONTROL                    PIC X.
  1550         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1551         88  CO-NO-BALANCE                        VALUE 'N'.
  1552
  1553     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1554         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1555         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1556         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1557
  1558     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1559         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1560         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1561
  1562     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1563     12  CO-GA-DIRECT-DEP                      PIC X.
  1564     12  CO-FUTURE-SPACE                       PIC X.
  1565         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1566
  1567     12  CO-ACCT-NAME                          PIC X(30).
  1568     12  CO-MAIL-NAME                          PIC X(30).
  1569     12  CO-ADDR-1                             PIC X(30).
  1570     12  CO-ADDR-2                             PIC X(30).
  1571     12  CO-ADDR-3.
  1572         16  CO-ADDR-CITY                      PIC X(27).
  1573         16  CO-ADDR-STATE                     PIC XX.
  1574     12  CO-CSO-1099                           PIC X.
  1575     12  CO-ZIP.
  1576         16  CO-ZIP-PRIME.
  1577             20  CO-ZIP-PRI-1ST                PIC X.
  1578                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1579             20  FILLER                        PIC X(4).
  1580         16  CO-ZIP-PLUS4                      PIC X(4).
  1581     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1582         16  CO-CAN-POSTAL-1                   PIC XXX.
  1583         16  CO-CAN-POSTAL-2                   PIC XXX.
  1584         16  FILLER                            PIC XXX.
  1585     12  CO-SOC-SEC                            PIC X(13).
  1586     12  CO-TELEPHONE.
  1587         16  CO-AREA-CODE                      PIC XXX.
  1588         16  CO-PREFIX                         PIC XXX.
  1589         16  CO-PHONE                          PIC X(4).
  1590
  1591     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1592
  1593     12  CO-AR-BAL-LEVEL                       PIC X.
  1594         88  CO-AR-REF-LVL                        VALUE '1'.
  1595         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1596         88  CO-AR-BILL-LVL                       VALUE '2'.
  1597         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  31
* EL050.cbl
  1598         88  CO-AR-FR-LVL                         VALUE '4'.
  1599
  1600     12  CO-AR-NORMAL-PRINT                    PIC X.
  1601         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1602         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1603
  1604     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1605
  1606     12  CO-AR-REPORTING                       PIC X.
  1607         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1608         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1609
  1610     12  CO-AR-PULL-CHECK                      PIC X.
  1611         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1612         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1613
  1614     12  CO-AR-BALANCE-PRINT                   PIC X.
  1615         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1616
  1617     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1618         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1619         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1620         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1621
  1622     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1623
  1624     12  CO-USER-CODE                          PIC X.
  1625     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1626
  1627******************************************************************
  1628*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1629*    THE LAST MONTH END RUN.
  1630******************************************************************
  1631
  1632     12  CO-LAST-ACTIVITY-DATE.
  1633         16  CO-ACT-YEAR                       PIC 99.
  1634         16  CO-ACT-MONTH                      PIC 99.
  1635         16  CO-ACT-DAY                        PIC 99.
  1636
  1637     12  CO-LAST-STMT-DT.
  1638         16  CO-LAST-STMT-YEAR                 PIC 99.
  1639         16  CO-LAST-STMT-MONTH                PIC 99.
  1640         16  CO-LAST-STMT-DAY                  PIC 99.
  1641
  1642     12  CO-MO-END-TOTALS.
  1643         16  CO-MONTHLY-TOTALS.
  1644             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1645             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1646             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1648             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1649
  1650         16  CO-AGING-TOTALS.
  1651             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1652             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1653             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1654             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1655
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  32
* EL050.cbl
  1656         16  CO-YTD-TOTALS.
  1657             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1658             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-OVER-UNDER-TOTALS.
  1661             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1662             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1663
  1664     12  CO-MISCELLANEOUS-TOTALS.
  1665         16  CO-FICA-TOTALS.
  1666             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1667             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1668
  1669         16  CO-CLAIM-TOTALS.
  1670             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1671             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1672
  1673******************************************************************
  1674*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1675*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1676******************************************************************
  1677
  1678     12  CO-CURRENT-TOTALS.
  1679         16  CO-CURRENT-LAST-STMT-DT.
  1680             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1681             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1682             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1683
  1684         16  CO-CURRENT-MONTHLY-TOTALS.
  1685             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1686             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1687             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1690
  1691         16  CO-CURRENT-AGING-TOTALS.
  1692             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1693             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1694             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1696
  1697         16  CO-CURRENT-YTD-TOTALS.
  1698             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1699             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1700
  1701     12  CO-PAID-COMM-TOTALS.
  1702         16  CO-YTD-PAID-COMMS.
  1703             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1704             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1705
  1706     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1707         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1708         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1709
  1710     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1711         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1712         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1713         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  33
* EL050.cbl
  1714         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1715         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1716         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1717         88  CO-FINAL-LETTER                  VALUE 'F'.
  1718         88  CO-RECONCILING                   VALUE 'R'.
  1719         88  CO-PHONE-CALL                    VALUE 'P'.
  1720         88  CO-LEGAL                         VALUE 'L'.
  1721         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1722         88  CO-WRITE-OFF                     VALUE 'W'.
  1723         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1724
  1725     12  CO-CSR-CODE                       PIC X(4).
  1726
  1727     12  CO-GA-STATUS-INFO.
  1728         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1729         16  CO-GA-TERMINATION-DT          PIC XX.
  1730         16  CO-GA-STATUS-CODE             PIC X.
  1731             88  CO-GA-ACTIVE                 VALUE 'A'.
  1732             88  CO-GA-INACTIVE               VALUE 'I'.
  1733             88  CO-GA-PENDING                VALUE 'P'.
  1734         16  CO-GA-COMMENTS.
  1735             20  CO-GA-COMMENT-1           PIC X(40).
  1736             20  CO-GA-COMMENT-2           PIC X(40).
  1737             20  CO-GA-COMMENT-3           PIC X(40).
  1738             20  CO-GA-COMMENT-4           PIC X(40).
  1739
  1740     12  CO-RPTCD2                         PIC X(10).
  1741     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1742         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1743         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1744
  1745     12  CO-TYPE-AGENT                     PIC X(01).
  1746         88  CO-CORPORATION                   VALUE 'C'.
  1747         88  CO-PARTNERSHIP                   VALUE 'P'.
  1748         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1749         88  CO-TRUST                         VALUE 'T'.
  1750         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1751
  1752     12  CO-FAXNO.
  1753         16  CO-FAX-AREA-CODE                  PIC XXX.
  1754         16  CO-FAX-PREFIX                     PIC XXX.
  1755         16  CO-FAX-PHONE                      PIC X(4).
  1756
  1757     12  CO-BANK-INFORMATION.
  1758         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1759         16  CO-BANK-TRANSIT-NON REDEFINES
  1760             CO-BANK-TRANSIT-NO                PIC 9(8).
  1761
  1762         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1763     12  CO-MISC-DEDUCT-INFO REDEFINES
  1764                  CO-BANK-INFORMATION.
  1765         16  CO-MD-GL-ACCT                     PIC X(10).
  1766         16  CO-MD-DIV                         PIC XX.
  1767         16  CO-MD-CENTER                      PIC X(4).
  1768         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1769         16  CO-CREATE-AP-CHECK                PIC X.
  1770         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1771         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  34
* EL050.cbl
  1772     12  CO-ACH-STATUS                         PIC X.
  1773         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1774         88  CO-ACH-PENDING                        VALUE 'P'.
  1775
  1776     12  CO-BILL-SW                            PIC X.
  1777     12  CO-CONTROL-NAME                       PIC X(30).
  1778     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1779     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1780     12  CO-CLP-STATE                          PIC XX.
  1781     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1782     12  CO-SPP-REFUND-EDIT                    PIC X.
  1783
  1784******************************************************************
  1785
  1786*    COPY ERCAGTC.
  1787******************************************************************
  1788*                                                                *
  1789*                                                                *
  1790*                            ERCAGTC                             *
  1791*                            VMOD=2.001                          *
  1792*                                                                *
  1793*   ONLINE CREDIT SYSTEM                                         *
  1794*                                                                *
  1795*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1796*                                                                *
  1797*   FILE TYPE = VSAM,KSDS                                        *
  1798*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1799*                                                                *
  1800*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1801*       ALTERNATE PATH = NONE                                    *
  1802*                                                                *
  1803*   LOG = NO                                                     *
  1804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1805*                                                                *
  1806******************************************************************
  1807*                   C H A N G E   L O G
  1808*
  1809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1810*-----------------------------------------------------------------
  1811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1812* EFFECTIVE    NUMBER
  1813*-----------------------------------------------------------------
  1814* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1815* 111004                         NEW FILE AND COPYBOOK
  1816* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1817******************************************************************
  1818 01  AGENT-COMMISSIONS.
  1819     12  AG-RECORD-ID                          PIC XX.
  1820         88  VALID-CO-ID                          VALUE 'AG'.
  1821     12  AG-CONTROL-PRIMARY.
  1822         16  AG-COMPANY-CD                     PIC X.
  1823         16  AG-CONTROL.
  1824             20  AG-CTL-1.
  1825                 24  AG-CARR-GROUP.
  1826                     28  AG-CARRIER            PIC X.
  1827                     28  AG-GROUPING           PIC X(6).
  1828                 24  AG-BANK                   PIC X(10).
  1829             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  35
* EL050.cbl
  1830                 24  AG-EXP-DT                 PIC XX.
  1831         16  AG-TYPE                           PIC X.
  1832             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1833             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1834     12  AG-MAINT-INFORMATION.
  1835         16  AG-LAST-MAINT-DT                  PIC XX.
  1836         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1837         16  AG-LAST-MAINT-USER                PIC X(4).
  1838         16  FILLER                            PIC X(10).
  1839     12  AG-EFF-DT                             PIC XX.
  1840     12  AG-COMM-STRUCTURE.
  1841         16  AG-AGT-COMMS OCCURS 10.
  1842             20  AG-AGT                PIC X(10).
  1843             20  AG-COM-TYP            PIC X.
  1844             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1845             20  AG-RECALC-LV-INDIC    PIC X.
  1846             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1847             20  AG-LRCALC-LV-INDIC    PIC X.
  1848             20  FILLER                PIC X(05).
  1849     12  FILLER                  PIC X(145).
  1850******************************************************************
  1851*    COPY ERCRESS.
  1852******************************************************************
  1853*                                                                *
  1854*                            ERCRESS                             *
  1855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1856*                            VMOD=2.002                          *
  1857*                                                                *
  1858*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1859*                                                                *
  1860*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1861*   VSAM RESIDENT STATE TAX MASTER                              *
  1862*                                                                *
  1863*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1867*                                                                *
  1868*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1869*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1870*                                                                *
  1871*   LOG = NO                                                     *
  1872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1873*                                                                *
  1874*                                                                *
  1875******************************************************************
  1876
  1877 01  RESIDENT-STATE-TAX-MASTER.
  1878
  1879     10  ERRESS-PRIMARY-KEY.
  1880         15  RES-COMPANY-CD        PIC X.
  1881         15  RES-RESIDENT-STATE    PIC XX.
  1882         15  RES-COVERAGE-CATEGORY PIC X.
  1883         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1884*                                      YYYYMMDD
  1885*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1886
  1887     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  36
* EL050.cbl
  1888
  1889         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1890         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1891         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893
  1894     10 RES-RECALC-SW              PIC   X.
  1895         88 RECALC                VALUE 'Y'.
  1896         88 NO-RECALC             VALUE 'N'.
  1897     10  RES-MAINT-BY              PIC X(4).
  1898     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1899     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1900*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  37
* EL050.cbl
  1902*    COPY ERCRESC.
  1903******************************************************************
  1904*                                                                *
  1905*                            ERCRESC                             *
  1906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1907*                            VMOD=2.003                          *
  1908*                                                                *
  1909*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1910*                                                                *
  1911*   FILE TYPE = VSAM,KSDS                                        *
  1912*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1913*                                                                *
  1914*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1915*       ALTERNATE PATH1 = NONE                                   *
  1916*                                                                *
  1917*   LOG = NO                                                     *
  1918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1919*                                                                *
  1920******************************************************************
  1921
  1922 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1923
  1924     10  ERRESC-RECORD-KEY.
  1925         15  RESC-COMPANY-CD           PIC   X.
  1926         15  RESC-CARRIER              PIC   X.
  1927         15  RESC-GROUP                PIC   X(6).
  1928         15  RESC-STATE                PIC   XX.
  1929         15  RESC-ACCOUNT              PIC   X(10).
  1930         15  RESC-AGENT                PIC   X(10).
  1931         15  RESC-RESIDENT-STATE       PIC   XX.
  1932         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1933*                                           YYYYMMDD
  1934     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1935
  1936     10  RESC-COMM-RECORD-DATA.
  1937         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1938             20 RESC-COVERAGE-CAT      PIC    X.
  1939             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1940             20 RESC-COMMISSION-TAB REDEFINES
  1941                RESC-COMMISSION-PER    PIC  XXX.
  1942
  1943     10  RESC-MAINT-BY                 PIC X(4).
  1944     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1945     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1946*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  38
* EL050.cbl
  1948*    COPY ERCPLAN.
  1949******************************************************************
  1950*                                                                *
  1951*                                                                *
  1952*                            ERCPLAN                             *
  1953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1954*                            VMOD=2.003                          *
  1955*                                                                *
  1956*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1957*                                                                *
  1958*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1959*   PLAN MASTER                                                  *
  1960*                                                                *
  1961*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1962*                                                                *
  1963*   FILE TYPE = VSAM,KSDS                                        *
  1964*   RECORD SIZE = 420   RECFORM = FIX                            *
  1965*                                                                *
  1966*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1967*       ALTERNATE PATH1 = N/A                                    *
  1968*                                                                *
  1969*   LOG = NO                                                     *
  1970*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1971*                                                                *
  1972*                                                                *
  1973******************************************************************
  1974
  1975 01  PLAN-MASTER.
  1976     12  PL-RECORD-ID                      PIC XX.
  1977         88  VALID-PL-ID                      VALUE 'PL'.
  1978
  1979     12  PL-CONTROL-PRIMARY.
  1980         16  PL-COMPANY-CD                 PIC X.
  1981         16  PL-MSTR-CNTRL.
  1982             20  PL-CONTROL-A.
  1983                 24  PL-CARRIER            PIC X.
  1984                 24  PL-GROUPING           PIC X(6).
  1985                 24  PL-STATE              PIC XX.
  1986                 24  PL-ACCOUNT            PIC X(10).
  1987             20  PL-BENEFIT-TYPE           PIC X.
  1988             20  PL-BENEFIT-CODE           PIC XX.
  1989             20  PL-REVISION-NO            PIC X(3).
  1990
  1991     12  PL-CONTROL-BY-VAR-GRP.
  1992         16  PL-COMPANY-CD-A1              PIC X.
  1993         16  PL-VG-CARRIER                 PIC X.
  1994         16  PL-VG-GROUPING                PIC X(6).
  1995         16  PL-VG-STATE                   PIC XX.
  1996         16  PL-VG-ACCOUNT                 PIC X(10).
  1997         16  PL-BENEFIT-TYPE-A1            PIC X.
  1998         16  PL-BENEFIT-CODE-A1            PIC XX.
  1999         16  PL-REVISION-NO-A1             PIC 999.
  2000
  2001     12  PL-MAINT-INFORMATION.
  2002         16  PL-LAST-MAINT-DT              PIC XX.
  2003         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2004         16  PL-LAST-MAINT-USER            PIC X(4).
  2005         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  39
* EL050.cbl
  2006
  2007     12  PL-LIABILITY-LIMITS.
  2008         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2009         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2010             20  PL-LM-AGE                 PIC S99        COMP-3.
  2011             20  PL-LM-DUR                 PIC S999       COMP-3.
  2012             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2013             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2014
  2015     12  FILLER                            PIC X(30).
  2016
  2017     12  PL-GL-ACCOUNT-NOS.
  2018         16  PL-PREMIUM-GL                 PIC X(8).
  2019         16  PL-COMM-GL                    PIC X(8).
  2020         16  PL-CLAIM-GL                   PIC X(8).
  2021     12  FILLER                            PIC X(24).
  2022     12  PL-TOLERANCES.
  2023         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2024         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2025         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2026         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2027         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2028         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2029     12  PL-OVER-SHORT.
  2030         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2031         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2032     12  FILLER                            PIC X(24).
  2033     12  PLAN-MISC.
  2034         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2035         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2036         16  PL-IG                         PIC X.
  2037         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2038         16  PL-POLICY-FORM                PIC X(12).
  2039         16  PL-EDIT-FOR-FORM              PIC X(01).
  2040         16  PL-DEV-CODE                   PIC XXX.
  2041         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2042         16  PL-CALC-METHOD                PIC X.
  2043         16  PL-BENEFIT-GROUP              PIC X(05).
  2044         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2045
  2046         16  FILLER                        PIC X(99).
  2047******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  40
* EL050.cbl
  2049*    COPY ELCCERT.
  2050******************************************************************
  2051*                                                                *
  2052*                            ELCCERT.                            *
  2053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2054*                            VMOD=2.013                          *
  2055*                                                                *
  2056*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2057*                                                                *
  2058*   FILE TYPE = VSAM,KSDS                                        *
  2059*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2060*                                                                *
  2061*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2062*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2063*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2064*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2065*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2066*                                                                *
  2067*   LOG = YES                                                    *
  2068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2069******************************************************************
  2070*                   C H A N G E   L O G
  2071*
  2072* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2073*-----------------------------------------------------------------
  2074*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2075* EFFECTIVE    NUMBER
  2076*-----------------------------------------------------------------
  2077* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2078* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2079* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2080* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2081* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2082* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2083* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2084* 032612  CR2011110200001  PEMA  AHL CHANGES
  2085******************************************************************
  2086
  2087 01  CERTIFICATE-MASTER.
  2088     12  CM-RECORD-ID                      PIC XX.
  2089         88  VALID-CM-ID                      VALUE 'CM'.
  2090
  2091     12  CM-CONTROL-PRIMARY.
  2092         16  CM-COMPANY-CD                 PIC X.
  2093         16  CM-CARRIER                    PIC X.
  2094         16  CM-GROUPING.
  2095             20  CM-GROUPING-PREFIX        PIC X(3).
  2096             20  CM-GROUPING-PRIME         PIC X(3).
  2097         16  CM-STATE                      PIC XX.
  2098         16  CM-ACCOUNT.
  2099             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2100             20  CM-ACCOUNT-PRIME          PIC X(6).
  2101         16  CM-CERT-EFF-DT                PIC XX.
  2102         16  CM-CERT-NO.
  2103             20  CM-CERT-PRIME             PIC X(10).
  2104             20  CM-CERT-SFX               PIC X.
  2105
  2106     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  41
* EL050.cbl
  2107         16  CM-COMPANY-CD-A1              PIC X.
  2108         16  CM-INSURED-LAST-NAME          PIC X(15).
  2109         16  CM-INSURED-INITIALS.
  2110             20  CM-INSURED-INITIAL1       PIC X.
  2111             20  CM-INSURED-INITIAL2       PIC X.
  2112
  2113     12  CM-CONTROL-BY-SSN.
  2114         16  CM-COMPANY-CD-A2              PIC X.
  2115         16  CM-SOC-SEC-NO.
  2116             20  CM-SSN-STATE              PIC XX.
  2117             20  CM-SSN-ACCOUNT            PIC X(6).
  2118             20  CM-SSN-LN3.
  2119                 25  CM-INSURED-INITIALS-A2.
  2120                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2121                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2122                 25 CM-PART-LAST-NAME-A2         PIC X.
  2123
  2124     12  CM-CONTROL-BY-CERT-NO.
  2125         16  CM-COMPANY-CD-A4              PIC X.
  2126         16  CM-CERT-NO-A4                 PIC X(11).
  2127
  2128     12  CM-CONTROL-BY-MEMB.
  2129         16  CM-COMPANY-CD-A5              PIC X.
  2130         16  CM-MEMBER-NO.
  2131             20  CM-MEMB-STATE             PIC XX.
  2132             20  CM-MEMB-ACCOUNT           PIC X(6).
  2133             20  CM-MEMB-LN4.
  2134                 25  CM-INSURED-INITIALS-A5.
  2135                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2136                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2137                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2138
  2139     12  CM-INSURED-PROFILE-DATA.
  2140         16  CM-INSURED-FIRST-NAME.
  2141             20  CM-INSURED-1ST-INIT       PIC X.
  2142             20  FILLER                    PIC X(9).
  2143         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2144         16  CM-INSURED-SEX                PIC X.
  2145             88  CM-SEX-MALE                  VALUE 'M'.
  2146             88  CM-SEX-FEMAL                 VALUE 'F'.
  2147         16  CM-INSURED-JOINT-AGE          PIC 99.
  2148         16  CM-JOINT-INSURED-NAME.
  2149             20  CM-JT-LAST-NAME           PIC X(15).
  2150             20  CM-JT-FIRST-NAME.
  2151                 24  CM-JT-1ST-INIT        PIC X.
  2152                 24  FILLER                PIC X(9).
  2153             20  CM-JT-INITIAL             PIC X.
  2154
  2155     12  CM-LIFE-DATA.
  2156         16  CM-LF-BENEFIT-CD              PIC XX.
  2157         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2158         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2159         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2160         16  CM-LF-DEV-CODE                PIC XXX.
  2161         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2162         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2163         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2164         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  42
* EL050.cbl
  2165         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2167         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2168         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2171         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2172         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2173         16  FILLER                        PIC XX.
  2174
  2175     12  CM-AH-DATA.
  2176         16  CM-AH-BENEFIT-CD              PIC XX.
  2177         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2178         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2179         16  CM-AH-DEV-CODE                PIC XXX.
  2180         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2181         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2182         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2183         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2187         16  CM-AH-PAID-THRU-DT            PIC XX.
  2188             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2189         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2190         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2191         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2192         16  FILLER                        PIC X.
  2193
  2194     12  CM-LOAN-INFORMATION.
  2195         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2196         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2197                                           PIC S9(5)V99  COMP-3.
  2198         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2199         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2200         16  CM-PAY-FREQUENCY              PIC S99.
  2201         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2202         16  CM-RATE-CLASS                 PIC XX.
  2203         16  CM-BENEFICIARY                PIC X(25).
  2204         16  CM-POLICY-FORM-NO             PIC X(12).
  2205         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2206         16  CM-LAST-ADD-ON-DT             PIC XX.
  2207         16  CM-DEDUCTIBLE-AMOUNTS.
  2208             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2209             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2210         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2211             20  CM-RESIDENT-STATE         PIC XX.
  2212             20  CM-RATE-CODE              PIC X(4).
  2213             20  FILLER                    PIC XX.
  2214         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2215             20  CM-LOAN-OFFICER           PIC X(5).
  2216             20  FILLER                    PIC XXX.
  2217         16  CM-CSR-CODE                   PIC XXX.
  2218         16  CM-UNDERWRITING-CODE          PIC X.
  2219             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2220         16  CM-POST-CARD-IND              PIC X.
  2221         16  CM-NH-INTERFACE-SW            PIC X.
  2222         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  43
* EL050.cbl
  2223             88  CM-SING-PRM                  VALUE '1'.
  2224             88  CM-O-B-COVERAGE              VALUE '2'.
  2225             88  CM-OPEN-END                  VALUE '3'.
  2226         16  CM-IND-GRP-TYPE               PIC X.
  2227             88  CM-INDIVIDUAL                VALUE 'I'.
  2228             88  CM-GROUP                     VALUE 'G'.
  2229         16  CM-SKIP-CODE                  PIC X.
  2230             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2231             88  SKIP-JULY                    VALUE '1'.
  2232             88  SKIP-AUGUST                  VALUE '2'.
  2233             88  SKIP-SEPTEMBER               VALUE '3'.
  2234             88  SKIP-JULY-AUG                VALUE '4'.
  2235             88  SKIP-AUG-SEPT                VALUE '5'.
  2236             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2237             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2238             88  SKIP-JUNE                    VALUE '8'.
  2239             88  SKIP-JUNE-JULY               VALUE '9'.
  2240             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2241             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2242         16  CM-PAYMENT-MODE               PIC X.
  2243             88  PAY-MONTHLY                  VALUE SPACE.
  2244             88  PAY-WEEKLY                   VALUE '1'.
  2245             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2246             88  PAY-BI-WEEKLY                VALUE '3'.
  2247             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2248         16  CM-LOAN-NUMBER                PIC X(8).
  2249         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2250         16  CM-OLD-LOF                    PIC XXX.
  2251*        16  CM-LOAN-OFFICER               PIC XXX.
  2252         16  CM-REIN-TABLE                 PIC XXX.
  2253         16  CM-SPECIAL-REIN-CODE          PIC X.
  2254         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2255         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2256         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2257
  2258     12  CM-STATUS-DATA.
  2259         16  CM-ENTRY-STATUS               PIC X.
  2260         16  CM-ENTRY-DT                   PIC XX.
  2261
  2262         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2263         16  CM-LF-CANCEL-DT               PIC XX.
  2264         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2265
  2266         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2267         16  CM-LF-DEATH-DT                PIC XX.
  2268         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2269
  2270         16  CM-LF-CURRENT-STATUS          PIC X.
  2271             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2272                                                'M' '4' '5' '9'.
  2273             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2274             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2275             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2276             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2277             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2278             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2279             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2280             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  44
* EL050.cbl
  2281             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2282             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2283             88  CM-LF-DECLINED               VALUE 'D'.
  2284             88  CM-LF-VOIDED                 VALUE 'V'.
  2285
  2286         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2287         16  CM-AH-CANCEL-DT               PIC XX.
  2288         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2289
  2290         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2291         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2292         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2293
  2294         16  CM-AH-CURRENT-STATUS          PIC X.
  2295             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2296                                                'M' '4' '5' '9'.
  2297             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2298             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2299             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2300             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2301             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2302             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2303             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2304             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2305             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2306             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2307             88  CM-AH-DECLINED               VALUE 'D'.
  2308             88  CM-AH-VOIDED                 VALUE 'V'.
  2309
  2310         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2311             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2312             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2313             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2314         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2315
  2316         16  CM-ENTRY-BATCH                PIC X(6).
  2317         16  CM-LF-EXIT-BATCH              PIC X(6).
  2318         16  CM-AH-EXIT-BATCH              PIC X(6).
  2319         16  CM-LAST-MONTH-END             PIC XX.
  2320
  2321     12  CM-NOTE-SW                        PIC X.
  2322         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2323         88  CERT-NOTES-PRESENT               VALUE '1'.
  2324         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2325         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2326         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2327         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2328         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2329         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2330     12  CM-COMP-EXCP-SW                   PIC X.
  2331         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2332         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2333     12  CM-INSURED-ADDRESS-SW             PIC X.
  2334         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2335         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2336
  2337*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2338     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  45
* EL050.cbl
  2339     12  FILLER                            PIC X.
  2340
  2341*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2342     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2343     12  FILLER                            PIC X.
  2344*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2345     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2346
  2347     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2348         88  CERT-ADDED-BATCH                 VALUE ' '.
  2349         88  CERT-ADDED-ONLINE                VALUE '1'.
  2350         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2351         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2352         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2353     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2354         88  CERT-AS-LOADED                   VALUE ' '.
  2355         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2356         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2357         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2358         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2359         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2360         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2361         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2362
  2363     12  CM-ACCOUNT-COMM-PCTS.
  2364         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2365         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2366
  2367     12  CM-USER-FIELD                     PIC X.
  2368     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2369     12  CM-CLP-STATE                      PIC XX.
  2370     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2371     12  CM-USER-RESERVED                  PIC XXX.
  2372     12  FILLER REDEFINES CM-USER-RESERVED.
  2373         16  CM-AH-CLASS-CD                PIC XX.
  2374         16  F                             PIC X.
  2375******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  46
* EL050.cbl
  2377*    COPY ERCMAIL.
  2378******************************************************************
  2379*                                                                *
  2380*                                                                *
  2381*                            ERCMAIL                             *
  2382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2383*                            VMOD=2.003                          *
  2384*                                                                *
  2385*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2386*                                                                *
  2387*   FILE TYPE = VSAM,KSDS                                        *
  2388*   RECORD SIZE = 374   RECFORM = FIX                            *
  2389*                                                                *
  2390*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2391*   ALTERNATE PATH    = NOT USED                                 *
  2392*                                                                *
  2393*   LOG = YES                                                    *
  2394*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2395******************************************************************
  2396*                   C H A N G E   L O G
  2397*
  2398* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2399*-----------------------------------------------------------------
  2400*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2401* EFFECTIVE    NUMBER
  2402*-----------------------------------------------------------------
  2403* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2404* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2405* 111108                   PEMA  ADD CRED BENE ADDR2
  2406******************************************************************
  2407
  2408 01  MAILING-DATA.
  2409     12  MA-RECORD-ID                      PIC XX.
  2410         88  VALID-MA-ID                       VALUE 'MA'.
  2411
  2412     12  MA-CONTROL-PRIMARY.
  2413         16  MA-COMPANY-CD                 PIC X.
  2414         16  MA-CARRIER                    PIC X.
  2415         16  MA-GROUPING.
  2416             20  MA-GROUPING-PREFIX        PIC XXX.
  2417             20  MA-GROUPING-PRIME         PIC XXX.
  2418         16  MA-STATE                      PIC XX.
  2419         16  MA-ACCOUNT.
  2420             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2421             20  MA-ACCOUNT-PRIME          PIC X(6).
  2422         16  MA-CERT-EFF-DT                PIC XX.
  2423         16  MA-CERT-NO.
  2424             20  MA-CERT-PRIME             PIC X(10).
  2425             20  MA-CERT-SFX               PIC X.
  2426
  2427     12  FILLER                            PIC XX.
  2428
  2429     12  MA-ACCESS-CONTROL.
  2430         16  MA-SOURCE-SYSTEM              PIC XX.
  2431             88  MA-FROM-CREDIT                VALUE 'CR'.
  2432             88  MA-FROM-VSI                   VALUE 'VS'.
  2433             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2434             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  47
* EL050.cbl
  2435         16  MA-RECORD-ADD-DT              PIC XX.
  2436         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2437         16  MA-LAST-MAINT-DT              PIC XX.
  2438         16  MA-LAST-MAINT-BY              PIC XXXX.
  2439         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2440
  2441     12  MA-PROFILE-INFO.
  2442         16  MA-QUALIFY-CODE-1             PIC XX.
  2443         16  MA-QUALIFY-CODE-2             PIC XX.
  2444         16  MA-QUALIFY-CODE-3             PIC XX.
  2445         16  MA-QUALIFY-CODE-4             PIC XX.
  2446         16  MA-QUALIFY-CODE-5             PIC XX.
  2447
  2448         16  MA-INSURED-LAST-NAME          PIC X(15).
  2449         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2450         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2451         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2452         16  MA-INSURED-BIRTH-DT           PIC XX.
  2453         16  MA-INSURED-SEX                PIC X.
  2454             88  MA-SEX-MALE                   VALUE 'M'.
  2455             88  MA-SEX-FEMALE                 VALUE 'F'.
  2456         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2457
  2458         16  MA-ADDRESS-CORRECTED          PIC X.
  2459         16  MA-JOINT-BIRTH-DT             PIC XX.
  2460*        16  FILLER                        PIC X(12).
  2461
  2462         16  MA-ADDRESS-LINE-1             PIC X(30).
  2463         16  MA-ADDRESS-LINE-2             PIC X(30).
  2464         16  MA-CITY-STATE.
  2465             20  MA-CITY                   PIC X(28).
  2466             20  MA-ADDR-STATE             PIC XX.
  2467         16  MA-ZIP.
  2468             20  MA-ZIP-CODE.
  2469                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2470                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2471                 24  FILLER                PIC X(4).
  2472             20  MA-ZIP-PLUS4              PIC X(4).
  2473         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2474             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2475             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2476             20  FILLER                    PIC X(3).
  2477
  2478         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2479
  2480         16  FILLER                        PIC XXX.
  2481*        16  FILLER                        PIC X(10).
  2482
  2483     12  MA-CRED-BENE-INFO.
  2484         16  MA-CRED-BENE-NAME                 PIC X(25).
  2485         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2486         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2487         16  MA-CRED-BENE-CTYST.
  2488             20  MA-CRED-BENE-CITY             PIC X(28).
  2489             20  MA-CRED-BENE-STATE            PIC XX.
  2490         16  MA-CRED-BENE-ZIP.
  2491             20  MA-CB-ZIP-CODE.
  2492                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  48
* EL050.cbl
  2493                     88  MA-CB-CANADIAN-POST-CODE
  2494                                           VALUE 'A' THRU 'Z'.
  2495                 24  FILLER                    PIC X(4).
  2496             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2497         16  MA-CB-CANADIAN-POSTAL-CODE
  2498                            REDEFINES MA-CRED-BENE-ZIP.
  2499             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2500             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2501             20  FILLER                        PIC X(3).
  2502     12  MA-POST-CARD-MAIL-DATA.
  2503         16  MA-MAIL-DATA OCCURS 7.
  2504             20  MA-MAIL-TYPE              PIC X.
  2505                 88  MA-12MO-MAILING           VALUE '1'.
  2506                 88  MA-EXP-MAILING            VALUE '2'.
  2507             20  MA-MAIL-STATUS            PIC X.
  2508                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2509                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2510                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2511             20  MA-MAIL-DATE              PIC XX.
  2512     12  FILLER                            PIC XX.
  2513     12  FILLER                            PIC XX.
  2514*    12  FILLER                            PIC X(30).
  2515******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  49
* EL050.cbl
  2517*    COPY ERCPNDM.
  2518******************************************************************
  2519*                                                                *
  2520*                                                                *
  2521*                            ERCPNDM                             *
  2522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2523*                            VMOD=2.003                          *
  2524*                                                                *
  2525*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2526*                                                                *
  2527*   FILE TYPE = VSAM,KSDS                                        *
  2528*   RECORD SIZE = 374   RECFORM = FIX                            *
  2529*                                                                *
  2530*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2531*   ALTERNATE PATH    = NOT USED                                 *
  2532*                                                                *
  2533*   LOG = YES                                                    *
  2534*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2535******************************************************************
  2536*                   C H A N G E   L O G
  2537*
  2538* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2539*-----------------------------------------------------------------
  2540*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2541* EFFECTIVE    NUMBER
  2542*-----------------------------------------------------------------
  2543* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2544* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2545* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2546******************************************************************
  2547
  2548 01  PENDING-MAILING-DATA.
  2549     12  PM-RECORD-ID                      PIC XX.
  2550         88  VALID-MA-ID                       VALUE 'PM'.
  2551
  2552     12  PM-CONTROL-PRIMARY.
  2553         16  PM-COMPANY-CD                 PIC X.
  2554         16  PM-ENTRY-BATCH                PIC X(6).
  2555         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2556         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2557
  2558     12  FILLER                            PIC X(14).
  2559
  2560     12  PM-ACCESS-CONTROL.
  2561         16  PM-SOURCE-SYSTEM              PIC XX.
  2562             88  PM-FROM-CREDIT                VALUE 'CR'.
  2563             88  PM-FROM-VSI                   VALUE 'VS'.
  2564             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2565             88  PM-FROM-OTHER                 VALUE 'OT'.
  2566         16  PM-RECORD-ADD-DT              PIC XX.
  2567         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2568         16  PM-LAST-MAINT-DT              PIC XX.
  2569         16  PM-LAST-MAINT-BY              PIC XXXX.
  2570         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2571
  2572     12  PM-PROFILE-INFO.
  2573         16  PM-QUALIFY-CODE-1             PIC XX.
  2574         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  50
* EL050.cbl
  2575         16  PM-QUALIFY-CODE-3             PIC XX.
  2576         16  PM-QUALIFY-CODE-4             PIC XX.
  2577         16  PM-QUALIFY-CODE-5             PIC XX.
  2578
  2579         16  PM-INSURED-LAST-NAME          PIC X(15).
  2580         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2581         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2582         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2583         16  PM-INSURED-BIRTH-DT           PIC XX.
  2584         16  PM-INSURED-SEX                PIC X.
  2585             88  PM-SEX-MALE                   VALUE 'M'.
  2586             88  PM-SEX-FEMALE                 VALUE 'F'.
  2587         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2588
  2589         16  PM-ADDRESS-CORRECTED          PIC X.
  2590         16  PM-JOINT-BIRTH-DT             PIC XX.
  2591*        16  FILLER                        PIC X(12).
  2592
  2593         16  PM-ADDRESS-LINE-1             PIC X(30).
  2594         16  PM-ADDRESS-LINE-2             PIC X(30).
  2595         16  PM-CITY-STATE.
  2596             20  PM-CITY                   PIC X(28).
  2597             20  PM-STATE                  PIC XX.
  2598         16  PM-ZIP.
  2599             20  PM-ZIP-CODE.
  2600                 24  PM-ZIP-1              PIC X.
  2601                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2602                 24  FILLER                PIC X(4).
  2603             20  PM-ZIP-PLUS4              PIC X(4).
  2604         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2605             20  PM-CAN-POST1              PIC XXX.
  2606             20  PM-CAN-POST2              PIC XXX.
  2607             20  FILLER                    PIC XXX.
  2608
  2609         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2610
  2611         16  FILLER                        PIC X(03).
  2612
  2613     12  PM-CRED-BENE-INFO.
  2614         16  PM-CRED-BENE-NAME             PIC X(25).
  2615         16  PM-CRED-BENE-ADDR             PIC X(30).
  2616         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2617         16  PM-CRED-BENE-CTYST.
  2618             20  PM-CRED-BENE-CITY         PIC X(28).
  2619             20  PM-CRED-BENE-STATE        PIC XX.
  2620         16  PM-CRED-BENE-ZIP.
  2621             20  PM-CB-ZIP-CODE.
  2622                 24  PM-CB-ZIP-1           PIC X.
  2623                     88  PM-CB-CANADIAN-POST-CODE
  2624                                  VALUE 'A' THRU 'Z'.
  2625                 24  FILLER                PIC X(4).
  2626             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2627         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2628             20  PM-CB-CAN-POST1           PIC XXX.
  2629             20  PM-CB-CAN-POST2           PIC XXX.
  2630             20  FILLER                    PIC XXX.
  2631     12  PM-POST-CARD-MAIL-DATA.
  2632         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  51
* EL050.cbl
  2633             20  PM-MAIL-TYPE              PIC X.
  2634                 88  PM-12MO-MAILING           VALUE '1'.
  2635                 88  PM-EXP-MAILING            VALUE '2'.
  2636             20  PM-MAIL-STATUS            PIC X.
  2637                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2638                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2639                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2640             20  PM-MAIL-DATE              PIC XX.
  2641     12  FILLER                            PIC XX.
  2642     12  FILLER                            PIC X(12).
  2643*    12  FILLER                            PIC X(30).
  2644
  2645******************************************************************
  2646*                                COPY ERCLOFC.
  2647******************************************************************
  2648*                                                                *
  2649*                                                                *
  2650*                            ERCLOFC                             *
  2651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2652*                            VMOD=2.003                          *
  2653*                                                                *
  2654*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2655*                                                                *
  2656*   FILE TYPE = VSAM,KSDS                                        *
  2657*   RECORD SIZE = 670   RECFORM = FIX                            *
  2658*                                                                *
  2659*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2660*                                                                *
  2661*   LOG = YES                                                    *
  2662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2663*                                                                *
  2664******************************************************************
  2665
  2666 01  LOAN-OFFICER-MASTER.
  2667     12  LO-RECORD-ID                PIC XX.
  2668         88  VALID-LO-ID                VALUE 'LO'.
  2669
  2670     12  LO-CONTROL-PRIMARY.
  2671         16  LO-COMPANY-CD           PIC X.
  2672         16  LO-CARRIER              PIC X.
  2673         16  LO-GROUPING.
  2674             20  LO-GROUPING-PREFIX  PIC XXX.
  2675             20  LO-GROUPING-PRIME   PIC XXX.
  2676         16  LO-STATE                PIC XX.
  2677         16  LO-ACCOUNT.
  2678             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2679             20  LO-ACCOUNT-PRIME    PIC X(6).
  2680         16  LO-OFFICER-CODE         PIC X(5).
  2681
  2682     12  LO-OFFICER-NAME             PIC X(30).
  2683
  2684     12  LO-LAST-MAINT-DT            PIC XX.
  2685     12  LO-LAST-USER                PIC X(4).
  2686     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2687
  2688     12  LO-COMP-CONTROL             PIC X.
  2689             88  LO-SHOW-COMP           VALUE 'Y'.
  2690             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  52
* EL050.cbl
  2691     12  LO-DETAIL-CONTROL           PIC X.
  2692             88  LO-PRINT-DETAIL        VALUE 'D'.
  2693             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2694
  2695     12  LO-SV-CARRIER               PIC X.
  2696     12  LO-SV-GROUPING              PIC X(6).
  2697     12  LO-SV-STATE                 PIC XX.
  2698
  2699     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2700     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2701
  2702     12  LO-OFFICER-INFO.
  2703         16  FILLER OCCURS 12 TIMES.
  2704             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2705             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2706             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2707             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2708             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2709             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2710             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2711             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2712     12  FILLER                      PIC X(198).
  2713******************************************************************
  2714*                                COPY ERCPDEF.
  2715******************************************************************
  2716*                                                                *
  2717*                                                                *
  2718*                            ERCPDEF.                            *
  2719*                                                                *
  2720*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2721*                                                                *
  2722*    FILE TYPE = VSAM,KSDS                                       *
  2723*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2724*                                                                *
  2725*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2726*                                                                *
  2727*    LOG = YES                                                   *
  2728*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2729******************************************************************
  2730 01  PRODUCT-MASTER.
  2731    12  PD-RECORD-ID                 PIC X(02).
  2732        88  VALID-PD-ID                  VALUE 'PD'.
  2733    12  PD-CONTROL-PRIMARY.
  2734        16  PD-COMPANY-CD            PIC X.
  2735        16  PD-STATE                 PIC XX.
  2736        16  PD-PRODUCT-CD            PIC XXX.
  2737        16  PD-FILLER                PIC X(7).
  2738        16  PD-BEN-TYPE              PIC X.
  2739        16  PD-BEN-CODE              PIC XX.
  2740        16  PD-PROD-EXP-DT           PIC XX.
  2741    12  FILLER                       PIC X(50).
  2742    12  PD-PRODUCT-DATA OCCURS 8.
  2743        16  PD-PROD-CODE             PIC X.
  2744            88  PD-PROD-LIFE           VALUE 'L'.
  2745            88  PD-PROD-PROP           VALUE 'P'.
  2746            88  PD-PROD-AH             VALUE 'A'.
  2747            88  PD-PROD-IU             VALUE 'I'.
  2748            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  53
* EL050.cbl
  2749        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2750        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2751        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2752        16  PD-MAX-TERM              PIC S999        COMP-3.
  2753        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2754        16  FILLER                   PIC X.
  2755        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2756        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2757        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2758        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2759        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2760        16  PD-REC-CRIT-PERIOD       PIC X.
  2761        16  PD-RTW-MOS               PIC 99.
  2762        16  FILLER                   PIC X(5).
  2763    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2764    12  PD-TERM-LIMITS OCCURS 15.
  2765        16  PD-LOW-TERM              PIC S999        COMP-3.
  2766        16  PD-HI-TERM               PIC S999        COMP-3.
  2767*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2768    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2769        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2770        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2771    12  PD-EARN-FACTORS.
  2772        16  FILLER OCCURS 15.
  2773            20  FILLER OCCURS 15.
  2774                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2775    12  PD-PRODUCT-DESC              PIC X(80).
  2776    12  PD-TRUNCATED                 PIC X.
  2777    12  FILLER                       PIC X(59).
  2778    12  PD-MAINT-INFORMATION.
  2779        16  PD-LAST-MAINT-DT         PIC X(02).
  2780        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2781        16  PD-LAST-MAINT-BY         PIC X(04).
  2782*                                COPY ELCSTATE.
  2783******************************************************************
  2784*                                                                *
  2785*                                                                *
  2786*                            ELCSTATE.                           *
  2787*                                                                *
  2788*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2789*                                                                *
  2790*   FILE TYPE = VSAM,KSDS                                        *
  2791*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2792*                                                                *
  2793*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2794*       ALTERNATE INDEX = NONE                                   *
  2795*                                                                *
  2796*   LOG = YES                                                    *
  2797*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2798******************************************************************
  2799*                   C H A N G E   L O G
  2800*
  2801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2802*-----------------------------------------------------------------
  2803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2804* EFFECTIVE    NUMBER
  2805*-----------------------------------------------------------------
  2806* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  54
* EL050.cbl
  2807******************************************************************
  2808*
  2809 01  STATE-FILE.
  2810     12  SF-RECORD-ID                       PIC XX.
  2811         88  VALID-CF-ID                        VALUE 'SF'.
  2812     12  SF-CONTROL-PRIMARY.
  2813         16  SF-COMPANY-ID                  PIC XXX.
  2814         16  SF-CARRIER-CODE                PIC X.
  2815         16  SF-GROUPING                    PIC X(6).
  2816         16  SF-STATE-CODE                  PIC XX.
  2817         16  SF-EXPIRE-DATE                 PIC 9(8).
  2818****************************************************************
  2819*             STATE CONTROLS
  2820****************************************************************
  2821     12  SF-LAST-MAINT-DT                   PIC XX.
  2822     12  SF-LAST-MAINT-BY                   PIC X(4).
  2823     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2824     12  SF-STATE-RT-CONTROLS.
  2825         16  SF-ST-RT-CALC                  PIC X.
  2826     12  SF-ST-TAX-CONTROLS.
  2827         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2828         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2829         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2830     12  SF-ST-REFUND-OPTIONS.
  2831         16  SF-ST-RF-LR-CALC               PIC X.
  2832         16  SF-ST-RF-LL-CALC               PIC X.
  2833         16  SF-ST-RF-LN-CALC               PIC X.
  2834         16  SF-ST-RF-AH-CALC               PIC X.
  2835         16  SF-ST-RF-CP-CALC               PIC X.
  2836     12  SF-ST-UNEARN-PREM-OPTIONS.
  2837         16  SF-ST-LUEP-R78                 PIC X.
  2838         16  SF-ST-LUEP-PRO                 PIC X.
  2839         16  SF-ST-LUEP-ST                  PIC X.
  2840         16  SF-ST-LUEP-DOM                 PIC X.
  2841         16  SF-ST-AUEP-R78                 PIC X.
  2842         16  SF-ST-AUEP-PRO                 PIC X.
  2843         16  SF-ST-AUEP-ST                  PIC X.
  2844         16  SF-ST-AUEP-DOM                 PIC X.
  2845         16  SF-ST-CUEP-R78                 PIC X.
  2846         16  SF-ST-CUEP-PRO                 PIC X.
  2847         16  SF-ST-CUEP-ST                  PIC X.
  2848         16  SF-ST-CUEP-DOM                 PIC X.
  2849     12  SF-ST-EARN-PREM-OPTIONS.
  2850         16  SF-ST-LEP-R78                  PIC X.
  2851         16  SF-ST-LEP-PRO                  PIC X.
  2852         16  SF-ST-LEP-ST                   PIC X.
  2853         16  SF-ST-LEP-DOM                  PIC X.
  2854         16  SF-ST-AEP-R78                  PIC X.
  2855         16  SF-ST-AEP-PRO                  PIC X.
  2856         16  SF-ST-AEP-ST                   PIC X.
  2857         16  SF-ST-AEP-DOM                  PIC X.
  2858         16  SF-ST-CEP-R78                  PIC X.
  2859         16  SF-ST-CEP-PRO                  PIC X.
  2860         16  SF-ST-CEP-ST                   PIC X.
  2861         16  SF-ST-CEP-DOM                  PIC X.
  2862     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  55
* EL050.cbl
  2864*    COPY ELCCRTT.
  2865******************************************************************
  2866*                                                                *
  2867*                            ELCCRTT.                            *
  2868*                                                                *
  2869*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2870*                                                                *
  2871*   FILE TYPE = VSAM,KSDS                                        *
  2872*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2873*                                                                *
  2874*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2875*                                                                *
  2876*   LOG = YES                                                    *
  2877*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2878******************************************************************
  2879*                   C H A N G E   L O G
  2880*
  2881* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2882*-----------------------------------------------------------------
  2883*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2884* EFFECTIVE    NUMBER
  2885*-----------------------------------------------------------------
  2886* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2887* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2888* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2889* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2890******************************************************************
  2891
  2892 01  CERTIFICATE-TRAILERS.
  2893     12  CS-RECORD-ID                      PIC XX.
  2894         88  VALID-CS-ID                      VALUE 'CS'.
  2895
  2896     12  CS-CONTROL-PRIMARY.
  2897         16  CS-COMPANY-CD                 PIC X.
  2898         16  CS-CARRIER                    PIC X.
  2899         16  CS-GROUPING                   PIC X(6).
  2900         16  CS-STATE                      PIC XX.
  2901         16  CS-ACCOUNT                    PIC X(10).
  2902         16  CS-CERT-EFF-DT                PIC XX.
  2903         16  CS-CERT-NO.
  2904             20  CS-CERT-PRIME             PIC X(10).
  2905             20  CS-CERT-SFX               PIC X.
  2906         16  CS-TRAILER-TYPE               PIC X.
  2907             88  COMM-TRLR           VALUE 'A'.
  2908             88  FUTURE-TRLR         VALUE 'B'.
  2909             88  CERT-DATA-TRLR      VALUE 'C'.
  2910
  2911     12  CS-DATA-AREA                      PIC X(516).
  2912
  2913     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2914         16  CS-BANK-COMMISSION-AREA.
  2915             20  CS-BANK-COMMS       OCCURS 10.
  2916                 24  CS-AGT                PIC X(10).
  2917                 24  CS-COM-TYP            PIC X.
  2918                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2919                 24  CS-RECALC-LV-INDIC    PIC X.
  2920                 24  FILLER                PIC X(10).
  2921         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  56
* EL050.cbl
  2922
  2923     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2924         16  CS-VIN-NUMBER                 PIC X(17).
  2925         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2926         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2927         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2928         16  FILLER                        PIC X(496).
  2929******************************************************************
  2930*    COPY ELCCRTO.
  2931******************************************************************
  2932*                                                                *
  2933*                            ELCCRTO.                            *
  2934*                                                                *
  2935*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2936*                                                                *
  2937*   FILE TYPE = VSAM,KSDS                                        *
  2938*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2939*                                                                *
  2940*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2941*                                                                *
  2942*   LOG = YES                                                    *
  2943*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2944******************************************************************
  2945*                   C H A N G E   L O G
  2946*
  2947* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2948*-----------------------------------------------------------------
  2949*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2950* EFFECTIVE    NUMBER
  2951*-----------------------------------------------------------------
  2952* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2953* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2954* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2955* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2956* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2957******************************************************************
  2958 01  ORIGINAL-CERTIFICATE.
  2959     12  OC-RECORD-ID                      PIC XX.
  2960         88  VALID-OC-ID                      VALUE 'OC'.
  2961     12  OC-CONTROL-PRIMARY.
  2962         16  OC-COMPANY-CD                 PIC X.
  2963         16  OC-CARRIER                    PIC X.
  2964         16  OC-GROUPING                   PIC X(6).
  2965         16  OC-STATE                      PIC XX.
  2966         16  OC-ACCOUNT                    PIC X(10).
  2967         16  OC-CERT-EFF-DT                PIC XX.
  2968         16  OC-CERT-NO.
  2969             20  OC-CERT-PRIME             PIC X(10).
  2970             20  OC-CERT-SFX               PIC X.
  2971         16  OC-RECORD-TYPE                PIC X.
  2972         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2973     12  OC-LAST-MAINT-DT                  PIC XX.
  2974     12  OC-LAST-MAINT-BY                  PIC X(4).
  2975     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2976     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2977     12  FILLER                            PIC X(49).
  2978     12  OC-ORIG-REC.
  2979         16  OC-INS-LAST-NAME              PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  57
* EL050.cbl
  2980         16  OC-INS-FIRST-NAME             PIC X(10).
  2981         16  OC-INS-MIDDLE-INIT            PIC X.
  2982         16  OC-INS-AGE                    PIC S999     COMP-3.
  2983         16  OC-JNT-LAST-NAME              PIC X(15).
  2984         16  OC-JNT-FIRST-NAME             PIC X(10).
  2985         16  OC-JNT-MIDDLE-INIT            PIC X.
  2986         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2987         16  OC-LF-BENCD                   PIC XX.
  2988         16  OC-LF-TERM                    PIC S999      COMP-3.
  2989         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2990         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2991         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2992         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2993         16  OC-LF-EXP-DT                  PIC XX.
  2994         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2995         16  OC-LF-CANCEL-DT               PIC XX.
  2996         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2997         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2998         16  OC-AH-BENCD                   PIC XX.
  2999         16  OC-AH-TERM                    PIC S999      COMP-3.
  3000         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3001         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3002         16  OC-AH-EXP-DT                  PIC XX.
  3003         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3004         16  OC-AH-CP                      PIC 99.
  3005         16  OC-AH-CANCEL-DT               PIC XX.
  3006         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3007         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3008         16  OC-CRED-BENE-NAME             PIC X(25).
  3009         16  OC-1ST-PMT-DT                 PIC XX.
  3010         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3011         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3012         16  OC-ISSUE-TRAN-IND             PIC X.
  3013         16  OC-CANCEL-TRAN-IND            PIC X.
  3014         16  FILLER                        PIC X(211).
  3015
  3016     12  FILLER                            PIC X(50).
  3017******************************************************************
  3018
  3019*    COPY ELCDATE.
  3020******************************************************************
  3021*                                                                *
  3022*                                                                *
  3023*                            ELCDATE.                            *
  3024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3025*                            VMOD=2.003
  3026*                                                                *
  3027*                                                                *
  3028*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3029*                 LENGTH = 200                                   *
  3030******************************************************************
  3031
  3032 01  DATE-CONVERSION-DATA.
  3033     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3034     12  DC-OPTION-CODE                PIC X.
  3035         88  BIN-TO-GREG                VALUE ' '.
  3036         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3037         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  58
* EL050.cbl
  3038         88  YMD-GREG-TO-BIN            VALUE '3'.
  3039         88  MDY-GREG-TO-BIN            VALUE '4'.
  3040         88  JULIAN-TO-BIN              VALUE '5'.
  3041         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3042         88  FIND-CENTURY               VALUE '7'.
  3043         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3044         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3045         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3046         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3047         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3048         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3049         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3050         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3051         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3052         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3053         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3054         88  BIN-3-TO-GREG              VALUE 'I'.
  3055         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3056         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3057         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3058         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3059         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3060         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3061         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3062         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3063         88  THREE-CHARACTER-BIN
  3064                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3065         88  GREGORIAN-TO-BIN
  3066                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3067         88  BIN-TO-GREGORIAN
  3068                  VALUES ' ' '1' 'I' '8' 'G'.
  3069         88  JULIAN-TO-BINARY
  3070                  VALUES '5' 'C' 'E' 'F'.
  3071     12  DC-ERROR-CODE                 PIC X.
  3072         88  NO-CONVERSION-ERROR        VALUE ' '.
  3073         88  DATE-CONVERSION-ERROR
  3074                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3075         88  DATE-IS-ZERO               VALUE '1'.
  3076         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3077         88  DATE-IS-INVALID            VALUE '3'.
  3078         88  DATE1-GREATER-DATE2        VALUE '4'.
  3079         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3080         88  DATE-INVALID-OPTION        VALUE '9'.
  3081         88  INVALID-CENTURY            VALUE 'A'.
  3082         88  ONLY-CENTURY               VALUE 'B'.
  3083         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3084         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3085     12  DC-END-OF-MONTH               PIC X.
  3086         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3087     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3088         88  USE-NORMAL-PROCESS         VALUE ' '.
  3089         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3090         88  ADJUST-UP-100-YRS          VALUE '2'.
  3091     12  FILLER                        PIC X.
  3092     12  DC-CONVERSION-DATES.
  3093         16  DC-BIN-DATE-1             PIC XX.
  3094         16  DC-BIN-DATE-2             PIC XX.
  3095         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  59
* EL050.cbl
  3096         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3097                       DC-GREG-DATE-1-EDIT.
  3098             20  DC-EDIT1-MONTH        PIC 99.
  3099             20  SLASH1-1              PIC X.
  3100             20  DC-EDIT1-DAY          PIC 99.
  3101             20  SLASH1-2              PIC X.
  3102             20  DC-EDIT1-YEAR         PIC 99.
  3103         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3104         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3105                     DC-GREG-DATE-2-EDIT.
  3106             20  DC-EDIT2-MONTH        PIC 99.
  3107             20  SLASH2-1              PIC X.
  3108             20  DC-EDIT2-DAY          PIC 99.
  3109             20  SLASH2-2              PIC X.
  3110             20  DC-EDIT2-YEAR         PIC 99.
  3111         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3112         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3113                     DC-GREG-DATE-1-YMD.
  3114             20  DC-YMD-YEAR           PIC 99.
  3115             20  DC-YMD-MONTH          PIC 99.
  3116             20  DC-YMD-DAY            PIC 99.
  3117         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3118         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3119                      DC-GREG-DATE-1-MDY.
  3120             20  DC-MDY-MONTH          PIC 99.
  3121             20  DC-MDY-DAY            PIC 99.
  3122             20  DC-MDY-YEAR           PIC 99.
  3123         16  DC-GREG-DATE-1-ALPHA.
  3124             20  DC-ALPHA-MONTH        PIC X(10).
  3125             20  DC-ALPHA-DAY          PIC 99.
  3126             20  FILLER                PIC XX.
  3127             20  DC-ALPHA-CENTURY.
  3128                 24 DC-ALPHA-CEN-N     PIC 99.
  3129             20  DC-ALPHA-YEAR         PIC 99.
  3130         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3131         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3132         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3133         16  DC-JULIAN-DATE            PIC 9(05).
  3134         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3135                                       PIC 9(05).
  3136         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3137             20  DC-JULIAN-YEAR        PIC 99.
  3138             20  DC-JULIAN-DAYS        PIC 999.
  3139         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3140         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3141         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3142     12  DATE-CONVERSION-VARIBLES.
  3143         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3144         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3145             20  FILLER                PIC 9(3).
  3146             20  HOLD-CEN-1-CCYY.
  3147                 24  HOLD-CEN-1-CC     PIC 99.
  3148                 24  HOLD-CEN-1-YY     PIC 99.
  3149             20  HOLD-CEN-1-MO         PIC 99.
  3150             20  HOLD-CEN-1-DA         PIC 99.
  3151         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3152             20  HOLD-CEN-1-R-MO       PIC 99.
  3153             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  60
* EL050.cbl
  3154             20  HOLD-CEN-1-R-CCYY.
  3155                 24  HOLD-CEN-1-R-CC   PIC 99.
  3156                 24  HOLD-CEN-1-R-YY   PIC 99.
  3157             20  FILLER                PIC 9(3).
  3158         16  HOLD-CENTURY-1-X.
  3159             20  FILLER                PIC X(3)  VALUE SPACES.
  3160             20  HOLD-CEN-1-X-CCYY.
  3161                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3162                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3163             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3164             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3165         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3166             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3167             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3168             20  HOLD-CEN-1-R-X-CCYY.
  3169                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3170                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3171             20  FILLER                PIC XXX.
  3172         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3173         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3174         16  DC-JULIAN-DATE-1          PIC 9(07).
  3175         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3176             20  DC-JULIAN-1-CCYY.
  3177                 24  DC-JULIAN-1-CC    PIC 99.
  3178                 24  DC-JULIAN-1-YR    PIC 99.
  3179             20  DC-JULIAN-DA-1        PIC 999.
  3180         16  DC-JULIAN-DATE-2          PIC 9(07).
  3181         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3182             20  DC-JULIAN-2-CCYY.
  3183                 24  DC-JULIAN-2-CC    PIC 99.
  3184                 24  DC-JULIAN-2-YR    PIC 99.
  3185             20  DC-JULIAN-DA-2        PIC 999.
  3186         16  DC-GREG-DATE-A-EDIT.
  3187             20  DC-EDITA-MONTH        PIC 99.
  3188             20  SLASHA-1              PIC X VALUE '/'.
  3189             20  DC-EDITA-DAY          PIC 99.
  3190             20  SLASHA-2              PIC X VALUE '/'.
  3191             20  DC-EDITA-CCYY.
  3192                 24  DC-EDITA-CENT     PIC 99.
  3193                 24  DC-EDITA-YEAR     PIC 99.
  3194         16  DC-GREG-DATE-B-EDIT.
  3195             20  DC-EDITB-MONTH        PIC 99.
  3196             20  SLASHB-1              PIC X VALUE '/'.
  3197             20  DC-EDITB-DAY          PIC 99.
  3198             20  SLASHB-2              PIC X VALUE '/'.
  3199             20  DC-EDITB-CCYY.
  3200                 24  DC-EDITB-CENT     PIC 99.
  3201                 24  DC-EDITB-YEAR     PIC 99.
  3202         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3203         16  DC-GREG-DATE-CYMD-R REDEFINES
  3204                              DC-GREG-DATE-CYMD.
  3205             20  DC-CYMD-CEN           PIC 99.
  3206             20  DC-CYMD-YEAR          PIC 99.
  3207             20  DC-CYMD-MONTH         PIC 99.
  3208             20  DC-CYMD-DAY           PIC 99.
  3209         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3210         16  DC-GREG-DATE-MDCY-R REDEFINES
  3211                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  61
* EL050.cbl
  3212             20  DC-MDCY-MONTH         PIC 99.
  3213             20  DC-MDCY-DAY           PIC 99.
  3214             20  DC-MDCY-CEN           PIC 99.
  3215             20  DC-MDCY-YEAR          PIC 99.
  3216    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3217        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3218    12  DC-EL310-DATE                  PIC X(21).
  3219    12  FILLER                         PIC X(28).
  3220
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  62
* EL050.cbl
  3222*    COPY ELCCALC.
  3223******************************************************************
  3224*                                                                *
  3225*                           ELCCALC.                            *
  3226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3227*                            VMOD=2.025                          *
  3228*                                                                *
  3229*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3230*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3231*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3232*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3233*                                                                *
  3234*  PASSED TO ELRTRM                                              *
  3235*  -----------------                                             *
  3236*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3237*  ORIGINAL TERM                                                 *
  3238*  BEGINNING DATE                                                *
  3239*  ENDING DATE                                                   *
  3240*  COMPANY I.D.                                                  *
  3241*  ACCOUNT MASTER USER FIELD                                     *
  3242*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3243*  FREE LOOK DAYS                                                *
  3244*                                                                *
  3245*  RETURNED FROM ELRTRM                                          *
  3246*  ---------------------                                         *
  3247*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3248*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3249*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3250*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3251*----------------------------------------------------------------*
  3252*  PASSED TO ELRAMT                                              *
  3253*  ----------------                                              *
  3254*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3255*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3256*  ORIGINAL AMOUNT                                               *
  3257*  ALTERNATE BENEFIT (BALLON)                                    *
  3258*  A.P.R. - NET PAY ONLY                                         *
  3259*  METHOD
  3260*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3261*  COMPANY I.D.                                                  *
  3262*  BENEFIT TYPE                                                  *
  3263*                                                                *
  3264*  RETURNED FROM ELRAMT                                          *
  3265*  --------------------                                          *
  3266*  REMAINING AMOUNT 1 - CURRENT                                  *
  3267*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3268*  REMAINING AMOUNT FACTOR
  3269*----------------------------------------------------------------*
  3270*  PASSED TO ELRESV                                              *
  3271*  -----------------                                             *
  3272*  CERTIFICATE EFFECTIVE DATE                                    *
  3273*  VALUATION DATE                                                *
  3274*  PAID THRU DATE                                                *
  3275*  BENEFIT                                                       *
  3276*  INCURRED DATE                                                 *
  3277*  REPORTED DATE                                                 *
  3278*  ISSUE AGE                                                     *
  3279*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  63
* EL050.cbl
  3280*  CDT PERCENT                                                   *
  3281*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3282* *CLAIM TYPE (LIFE, A/H)                                        *
  3283* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3284* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3285*                                                                *
  3286*  RETURNED FROM ELRESV                                          *
  3287*  --------------------                                          *
  3288*  CDT TABLE USED                                                *
  3289*  CDT FACTOR USED                                               *
  3290*  PAY TO CURRENT RESERVE                                        *
  3291*  I.B.N.R. - A/H ONLY                                           *
  3292*  FUTURE (ACCRUED) AH ONLY                                      *
  3293*----------------------------------------------------------------*
  3294*  PASSED TO ELRATE                                              *
  3295*  ----------------                                              *
  3296*  CERT ISSUE DATE                                               *
  3297*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3298*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3299*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3300*  STATE CODE (CLIENT DEFINED)                                   *
  3301*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3302*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3303*  DEVIATION CODE                                                *
  3304*  ISSUE AGE                                                     *
  3305*  ORIGINAL BENEFIT AMOUNT                                       *
  3306*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3307*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3308*  BENEFIT KIND (LIFE OR A/H)                                    *
  3309*  A.P.R.                                                        *
  3310*  METHOD
  3311*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3312*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3313*  COMPANY I.D. (3 CHARACTER)                                    *
  3314*  BENEFIT CODE                                                  *
  3315*  BENEFIT OVERRIDE CODE                                         *
  3316*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3317*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3318*  JOINT INDICATOR (CSL ONLY)                                    *
  3319*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3320*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3321*                                                                *
  3322*  RETURNED FROM ELRATE                                          *
  3323*  --------------------                                          *
  3324*  CALCULATED PREMIUM                                            *
  3325*  PREMIUM RATE                                                  *
  3326*  MORTALITY CODE                                                *
  3327*  MAX ATTAINED AGE                                              *
  3328*  MAX AGE                                                       *
  3329*  MAX TERM                                                      *
  3330*  MAX MONTHLY BENEFIT                                           *
  3331*  MAX TOTAL BENIFIT                                             *
  3332*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3333*----------------------------------------------------------------*
  3334*  PASSED TO ELRFND                                              *
  3335*  ----------------                                              *
  3336*  CERT ISSUE DATE                                               *
  3337*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  64
* EL050.cbl
  3338*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3339*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3340*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3341*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3342*  STATE CODE (CLIENT DEFINED)                                   *
  3343*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3344*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3345*  DEVIATION CODE                                                *
  3346*  ISSUE AGE                                                     *
  3347*  ORIGINAL BENEFIT AMOUNT                                       *
  3348*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3349*  PROCESS TYPE (CANCEL)                                         *
  3350*  BENEFIT KIND (LIFE OR A/H)                                    *
  3351*  A.P.R.                                                        *
  3352*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3353*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3354*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3355*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3356*  COMPANY I.D. (3 CHARACTER)                                    *
  3357*  BENEFIT CODE                                                  *
  3358*  BENEFIT OVERRIDE CODE                                         *
  3359*                                                                *
  3360*  RETURNED FROM ELRFND                                          *
  3361*  --------------------                                          *
  3362*  CALCULATED REFUND                                             *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELEARN                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3368*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3369*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3370*  STATE CODE (CLIENT DEFINED)                                   *
  3371*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3373*  DEVIATION CODE                                                *
  3374*  ISSUE AGE                                                     *
  3375*  ORIGINAL BENEFIT AMOUNT                                       *
  3376*  BENEFIT KIND (LIFE OR A/H)                                    *
  3377*  A.P.R.                                                        *
  3378*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3379*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3380*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3381*  COMPANY I.D. (3 CHARACTER)                                    *
  3382*  BENEFIT CODE                                                  *
  3383*  BENEFIT OVERRIDE CODE                                         *
  3384*                                                                *
  3385*  RETURNED FROM ELEARN                                          *
  3386*  --------------------                                          *
  3387*  INDICATED  EARNINGS                                           *
  3388*----------------------------------------------------------------*
  3389*                 LENGTH = 450                                   *
  3390*                                                                *
  3391******************************************************************
  3392******************************************************************
  3393*                   C H A N G E   L O G
  3394*
  3395* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  65
* EL050.cbl
  3396*-----------------------------------------------------------------
  3397*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3398* EFFECTIVE    NUMBER
  3399*-----------------------------------------------------------------
  3400* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3401* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3402* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3403* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3404* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3405* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3406* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3407* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3408* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3409******************************************************************
  3410
  3411 01  CALCULATION-PASS-AREA.
  3412     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3413                                     COMP.
  3414
  3415     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3416       88  NO-CP-ERROR                             VALUE ZERO.
  3417       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3418                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3419       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3420       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3421       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3422       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3423       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3424       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3425       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3426       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3427       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3428       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3429       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3430       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3431       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3432       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3433       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3434       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3435       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3436
  3437     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3438       88  NO-CP-ERROR-2                           VALUE ZERO.
  3439***********************  INPUT AREAS ****************************
  3440
  3441     12  CP-CALCULATION-AREA.
  3442         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3443         16  CP-CERT-EFF-DT        PIC XX.
  3444         16  CP-VALUATION-DT       PIC XX.
  3445         16  CP-PAID-THRU-DT       PIC XX.
  3446         16  CP-BENEFIT-TYPE       PIC X.
  3447           88  CP-AH                               VALUE 'A' 'D'
  3448                                                   'I' 'U'.
  3449           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3450           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3451         16  CP-INCURRED-DT        PIC XX.
  3452         16  CP-REPORTED-DT        PIC XX.
  3453         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  66
* EL050.cbl
  3454         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3455         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3456                                     COMP-3.
  3457         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3458                                     COMP-3.
  3459         16  CP-CDT-METHOD         PIC X.
  3460           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3461           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3462           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3463         16  CP-CLAIM-TYPE         PIC X.
  3464           88  CP-AH-CLAIM                         VALUE 'A'.
  3465           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3466         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3467                                     COMP-3.
  3468         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3479                                     COMP-3.
  3480         16  CP-REM-TERM-METHOD    PIC X.
  3481           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3482           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3483           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3484           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3485           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3486           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3487           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3488         16  CP-EARNING-METHOD     PIC X.
  3489           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3490           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3491           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3492           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3493           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3494           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3495           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3496           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3497           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3498           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3499           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3500           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3501           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3502           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3503         16  CP-PROCESS-TYPE       PIC X.
  3504           88  CP-CLAIM                            VALUE '1'.
  3505           88  CP-CANCEL                           VALUE '2'.
  3506           88  CP-ISSUE                            VALUE '3'.
  3507         16  CP-SPECIAL-CALC-CD    PIC X.
  3508           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3509           88  CP-1-MTH-INTEREST               VALUE ' '.
  3510           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3511           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  67
* EL050.cbl
  3512           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3513           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3514           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3515           88  CP-FARM-PLAN                    VALUE 'F'.
  3516           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3517           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3518           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3519           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3520           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3521           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3522           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3523           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3524           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3525           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3526                                                     'W' 'X'.
  3527           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3528           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3529           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3530           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3531           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3532           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3533           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3534           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3535           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3536           88  CP-CSL-METH-1                   VALUE '5'.
  3537           88  CP-CSL-METH-2                   VALUE '6'.
  3538           88  CP-CSL-METH-3                   VALUE '7'.
  3539           88  CP-CSL-METH-4                   VALUE '8'.
  3540
  3541         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3542                                     COMP-3.
  3543         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3544         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3545         16  CP-STATE              PIC XX          VALUE SPACE.
  3546         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3547         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3548           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3549               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3550         16  CP-R78-OPTION         PIC X.
  3551           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3552           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3553
  3554         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3555         16  CP-IBNR-RESERVE-SW    PIC X.
  3556         16  CP-CLAIM-STATUS       PIC X.
  3557         16  CP-RATE-FILE          PIC X.
  3558         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3559                                     COMP-3.
  3560
  3561         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3562         16  CP-AH-OVERRIDE-CODE   PIC X.
  3563
  3564         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3567                                   PIC S9(5)V99 COMP-3.
  3568         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3569                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  68
* EL050.cbl
  3570         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3571                                     COMP-3.
  3572         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3575                                  PIC S9(7)V99 COMP-3.
  3576
  3577         16  CP-PAID-FROM-DATE     PIC X(02).
  3578         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3579         16  CP-EXT-DAYS-CALC      PIC X.
  3580           88  CP-EXT-NO-CHG                   VALUE ' '.
  3581           88  CP-EXT-CHG-LF                   VALUE '1'.
  3582           88  CP-EXT-CHG-AH                   VALUE '2'.
  3583           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3584         16  CP-DOMICILE-STATE     PIC XX.
  3585         16  CP-CARRIER            PIC X.
  3586         16  CP-REIN-FLAG          PIC X.
  3587         16  CP-REM-TRM-CALC-OPTION PIC X.
  3588           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3589                      '2' '3' '4' '5'.
  3590           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3591           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3592           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3593           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3594           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3595           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3596           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3597           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3598         16  CP-SIG-SWITCH         PIC X.
  3599         16  CP-RATING-METHOD      PIC X.
  3600           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3601           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3602           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3603           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3604           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3605           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3606           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3607           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3608           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3609         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3610                                     COMP-3.
  3611         16  CP-BEN-CATEGORY       PIC X.
  3612         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3613         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3614                                   PIC S99V9(5) COMP-3.
  3615         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3616         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3617                                   PIC S99V9(5) COMP-3.
  3618         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3619         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3620         16  CP-EXPIRE-DT          PIC XX.
  3621         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3622         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3623         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3624         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3625         16  CP-DDF-SPEC-CALC      PIC X.
  3626             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3627             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  69
* EL050.cbl
  3628         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3629         16  CP-CANCEL-REASON      PIC X.
  3630         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3631         16  CP-PMT-MODE           PIC X.
  3632         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3633         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3634         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3635         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3636         16  FILLER                PIC X.
  3637
  3638***************    OUTPUT FROM ELRESV   ************************
  3639
  3640         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3641
  3642         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3645                                     COMP-3.
  3646         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3647                                     COMP-3.
  3648         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3649                                     COMP-3.
  3650         16  FILLER                PIC X(09).
  3651***************    OUTPUT FROM ELRTRM   *************************
  3652
  3653         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3658                                     COMP-3.
  3659         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3660                                     COMP-3.
  3661         16  FILLER                PIC X(12).
  3662
  3663***************    OUTPUT FROM ELRAMT   *************************
  3664
  3665         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(12).
  3670
  3671***************    OUTPUT FROM ELRATE   *************************
  3672
  3673         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-MORTALITY-CODE     PIC X(4).
  3678         16  CP-RATE-EDIT-FLAG     PIC X.
  3679             88  CP-RATES-NEED-APR                  VALUE '1'.
  3680         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3681                                     COMP-3.
  3682         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3683         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3684         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3685                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  70
* EL050.cbl
  3686         16  FILLER                PIC X(07).
  3687
  3688***************    OUTPUT FROM ELRFND   *************************
  3689
  3690         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-REFUND-TYPE-USED   PIC X.
  3693           88  CP-R-AS-R78                         VALUE '1'.
  3694           88  CP-R-AS-PRORATA                     VALUE '2'.
  3695           88  CP-R-AS-CALIF                       VALUE '3'.
  3696           88  CP-R-AS-TEXAS                       VALUE '4'.
  3697           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3698           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3699           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3700           88  CP-R-AS-MEAN                        VALUE '8'.
  3701           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3702           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3703           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3704           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3705           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3706           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3707         16  FILLER                PIC X(12).
  3708
  3709***************    OUTPUT FROM ELEARN   *************************
  3710
  3711         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-EARNING-TYPE-USED  PIC X.
  3724           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3725           88  CP-E-AS-R78                         VALUE '1'.
  3726           88  CP-E-AS-PRORATA                     VALUE '2'.
  3727           88  CP-E-AS-TEXAS                       VALUE '4'.
  3728           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3729           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3730           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3731           88  CP-E-AS-MEAN                        VALUE '8'.
  3732           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3733         16  FILLER                PIC X(12).
  3734
  3735***************    OUTPUT FROM ELPMNT   *************************
  3736
  3737         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  FILLER                PIC X(12).
  3742
  3743***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  71
* EL050.cbl
  3744         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3757             88  OPEN-RATE-FILE                   VALUE 'O'.
  3758             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3759             88  IO-ERROR                         VALUE 'E'.
  3760
  3761         16  CP-FIRST-PAY-DATE     PIC XX.
  3762
  3763         16  CP-JOINT-INDICATOR    PIC X.
  3764
  3765         16  CP-RESERVE-REMAINING-TERM
  3766                                   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768
  3769         16  CP-INSURED-BIRTH-DT   PIC XX.
  3770
  3771         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3772                                     COMP-3.
  3773
  3774         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3775                                     COMP-3.
  3776
  3777         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779
  3780         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3781                                     COMP-3.
  3782
  3783         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3784                                     COMP-3.
  3785
  3786         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3787                                     COMP-3.
  3788
  3789         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3790                                     COMP-3.
  3791
  3792         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3793             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3794
  3795         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3796                                     COMP-3.
  3797         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3800         16  FILLER                PIC X(15).
  3801******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  72
* EL050.cbl
  3803******************************************************************
  3804*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3805*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3806*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3807*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3808*** MODIFICATION.                                              ***
  3809*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3810*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3811******************************************************************
  3812*    COPY ERCPNDB.
  3813******************************************************************
  3814*                                                                *
  3815*                                                                *
  3816*                            ERCPNDB.                            *
  3817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3818*                            VMOD=2.025                          *
  3819*                                                                *
  3820*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3821*                                                                *
  3822******************************************************************
  3823*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3824*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3825******************************************************************
  3826*                                                                *
  3827*                                                                *
  3828*   FILE TYPE = VSAM,KSDS                                        *
  3829*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3830*                                                                *
  3831*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3832*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3833*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3834*                                                 RKP=13,LEN=36  *
  3835*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3836*                                      AND CHG-SEQ.)             *
  3837*                                                RKP=49,LEN=11   *
  3838*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3839*                                      AND CHG-SEQ.)             *
  3840*                                                RKP=60,LEN=15   *
  3841*                                                                *
  3842*   LOG = NO                                                     *
  3843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3844******************************************************************
  3845******************************************************************
  3846*                   C H A N G E   L O G
  3847*
  3848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3849*-----------------------------------------------------------------
  3850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3851* EFFECTIVE    NUMBER
  3852*-----------------------------------------------------------------
  3853* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3854* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3855* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3856* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3857* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3858* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3859* 032306                   PEMA  ADD BOW LOAN NUMBER
  3860* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  73
* EL050.cbl
  3861* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3862* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3863* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3864* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3865* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3866* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3867* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3868******************************************************************
  3869
  3870 01  PENDING-BUSINESS.
  3871     12  PB-RECORD-ID                     PIC XX.
  3872         88  VALID-PB-ID                        VALUE 'PB'.
  3873
  3874     12  PB-CONTROL-PRIMARY.
  3875         16  PB-COMPANY-CD                PIC X.
  3876         16  PB-ENTRY-BATCH               PIC X(6).
  3877         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3878         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3879
  3880     12  PB-CONTROL-BY-ACCOUNT.
  3881         16  PB-COMPANY-CD-A1             PIC X.
  3882         16  PB-CARRIER                   PIC X.
  3883         16  PB-GROUPING.
  3884             20  PB-GROUPING-PREFIX       PIC XXX.
  3885             20  PB-GROUPING-PRIME        PIC XXX.
  3886         16  PB-STATE                     PIC XX.
  3887         16  PB-ACCOUNT.
  3888             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3889             20  PB-ACCOUNT-PRIME         PIC X(6).
  3890         16  PB-CERT-EFF-DT               PIC XX.
  3891         16  PB-CERT-NO.
  3892             20  PB-CERT-PRIME            PIC X(10).
  3893             20  PB-CERT-SFX              PIC X.
  3894         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3895
  3896         16  PB-RECORD-TYPE               PIC X.
  3897             88  PB-MAILING-DATA                VALUE '0'.
  3898             88  PB-ISSUE                       VALUE '1'.
  3899             88  PB-CANCELLATION                VALUE '2'.
  3900             88  PB-BATCH-TRAILER               VALUE '9'.
  3901
  3902     12  PB-CONTROL-BY-ORIG-BATCH.
  3903         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3904         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3905         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3906         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3907
  3908     12  PB-CONTROL-BY-CSR.
  3909         16  PB-CSR-COMPANY-CD            PIC X.
  3910         16  PB-CSR-ID                    PIC X(4).
  3911         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3912         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3913         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3914******************************************************************
  3915*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3916******************************************************************
  3917
  3918     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  74
* EL050.cbl
  3919     12  PB-LAST-MAINT-BY                 PIC X(4).
  3920     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3921
  3922     12  PB-RECORD-BODY                   PIC X(375).
  3923
  3924     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3925         16  PB-CERT-ORIGIN               PIC X.
  3926             88  CLASIC-CREATED-CERT         VALUE '1'.
  3927         16  PB-I-NAME.
  3928             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3929             20  PB-I-INSURED-FIRST-NAME.
  3930                 24  PB-I-INSURED-1ST-INIT PIC X.
  3931                 24  FILLER                PIC X(9).
  3932             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3933         16  PB-I-AGE                     PIC S99   COMP-3.
  3934         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3935         16  PB-I-BIRTHDAY                PIC XX.
  3936         16  PB-I-INSURED-SEX             PIC X.
  3937             88  PB-SEX-MALE     VALUE 'M'.
  3938             88  PB-SEX-FEMALE   VALUE 'F'.
  3939
  3940         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3941         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3942         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3943         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3944         16  PB-I-SKIP-CODE               PIC X.
  3945             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3946             88  PB-SKIP-JULY              VALUE '1'.
  3947             88  PB-SKIP-AUGUST            VALUE '2'.
  3948             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3949             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3950             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3951             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3952             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3953             88  PB-SKIP-JUNE              VALUE '8'.
  3954             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3955             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3956             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3957         16  PB-I-TERM-TYPE               PIC X.
  3958             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3959             88  PB-PAID-WEEKLY            VALUE 'W'.
  3960             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3961             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3962             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3963         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3964         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3965         16  PB-I-DATA-ENTRY-SW           PIC X.
  3966             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3967             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3968             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3969             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3970         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3971         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3972*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3973         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3974         16  FILLER                       PIC X.
  3975
  3976         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  75
* EL050.cbl
  3977             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3978             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3979                                                   '90' THRU '99'.
  3980         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3981                                          PIC XX.
  3982         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3983         16  PB-I-AMOUNT-FINANCED REDEFINES
  3984                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3985         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3986         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3987                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3988         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3990         16  PB-I-CLP-AMOUNT REDEFINES
  3991                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3992         16  PB-I-LF-CALC-FLAG            PIC X.
  3993             88 PB-COMP-LF-PREM               VALUE '?'.
  3994         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3995         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3996         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3997         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3998         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3999         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4000         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4001         16  PB-I-LF-ABBR                 PIC XXX.
  4002         16  PB-I-LF-INPUT-CD             PIC XX.
  4003
  4004         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4005             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4006             88  PB-INVALID-AH               VALUE '  ' '00'
  4007                                                   '90' THRU '99'.
  4008         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4009         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4010         16  PB-I-AH-CALC-FLAG            PIC X.
  4011             88 PB-COMP-AH-PREM                  VALUE '?'.
  4012         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4013         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4014         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4015         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4016         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4017         16  PB-I-AH-ABBR                 PIC XXX.
  4018         16  PB-I-AH-INPUT-CD             PIC XXX.
  4019
  4020         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4021         16  PB-I-REIN-TABLE              PIC XXX.
  4022         16  PB-I-BUSINESS-TYPE           PIC 99.
  4023         16  PB-I-INDV-GRP-CD             PIC X.
  4024         16  PB-I-MORT-CODE.
  4025             20  PB-I-TABLE               PIC X.
  4026             20  PB-I-INTEREST            PIC XX.
  4027             20  PB-I-MORT-TYP            PIC X.
  4028         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4029         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4030         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4031         16  PB-I-INDV-GRP-OVRD           PIC X.
  4032         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4033         16  PB-I-SIG-SW                  PIC X.
  4034             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  76
* EL050.cbl
  4035         16  PB-I-RATE-CLASS              PIC XX.
  4036         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4037         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4038         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4039         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4040         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4041         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4042         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4043         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4044         16  PB-I-OB-FLAG                 PIC X.
  4045             88  PB-I-OB                      VALUE 'B'.
  4046             88  PB-I-SUMMARY                 VALUE 'Z'.
  4047         16  PB-I-ENTRY-STATUS            PIC X.
  4048             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4049                                              'M' '5' '9' '2'.
  4050             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4051             88  PB-I-POLICY-PENDING          VALUE '2'.
  4052             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4053             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4054             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4055             88  PB-I-REIN-ONLY               VALUE '9'.
  4056             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4057             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4058             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4059             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4060         16  PB-I-INT-CODE                PIC X.
  4061             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4062             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4063         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4064         16  PB-I-SOC-SEC-NO              PIC X(11).
  4065         16  PB-I-MEMBER-NO               PIC X(12).
  4066         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4067*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4068         16  PB-I-OLD-LOF                 PIC XXX.
  4069         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4070         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4071         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4072         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4073         16  PB-I-LIFE-INDICATOR          PIC X.
  4074             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4075         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4076         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4077                                          PIC S9(5)V99    COMP-3.
  4078         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4079             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4080             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4081         16  PB-I-1ST-PMT-DT              PIC XX.
  4082         16  PB-I-JOINT-INSURED.
  4083             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4084             20 PB-I-JOINT-FIRST-NAME.
  4085                24  PB-I-JOINT-FIRST-INIT PIC X.
  4086                24  FILLER                PIC X(9).
  4087             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4088*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4089         16  PB-I-BENEFICIARY-NAME.
  4090             20  PB-I-BANK-NUMBER         PIC X(10).
  4091             20  FILLER                   PIC X(15).
  4092         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  77
* EL050.cbl
  4093         16  PB-I-REFERENCE               PIC X(12).
  4094         16  FILLER REDEFINES PB-I-REFERENCE.
  4095             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4096             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4097             20  PB-I-CLP-STATE           PIC XX.
  4098         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4099             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4100             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4101             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4102         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4103         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4104         16  PB-I-RESIDENT-STATE          PIC XX.
  4105         16  PB-I-RATE-CODE               PIC X(4).
  4106         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4107         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4108         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4109         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4110         16  PB-I-BANK-NOCHRGB            PIC 99.
  4111         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4112         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4113
  4114     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4115         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4116             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4117         16  PB-C-CANCEL-ORIGIN           PIC X.
  4118             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4119         16  PB-C-LF-CANCEL-DT            PIC XX.
  4120         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4121         16  PB-C-LF-CALC-REQ             PIC X.
  4122             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4123         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4124         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4125         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4126             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4127         16  PB-C-AH-CANCEL-DT            PIC XX.
  4128         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4129         16  PB-C-AH-CALC-REQ             PIC X.
  4130             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4131         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4132         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4133         16  PB-C-LAST-NAME               PIC X(15).
  4134         16  PB-C-REFUND-SW               PIC X.
  4135             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4136             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4137         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4138         16  PB-C-PAYEE-CODE              PIC X(6).
  4139         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4140         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4141         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4142         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4143         16  PB-C-REFERENCE               PIC X(12).
  4144         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4145         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4146         16  PB-C-POST-CARD-IND           PIC X.
  4147         16  PB-C-CANCEL-REASON           PIC X.
  4148         16  PB-C-REF-INTERFACE-SW        PIC X.
  4149         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4150         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  78
* EL050.cbl
  4151         16  FILLER                       PIC X(01).
  4152*        16  FILLER                       PIC X(18).
  4153         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4154*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4155         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4156         16  PB-CANCELED-CERT-DATA.
  4157             20  PB-CI-INSURED-NAME.
  4158                 24  PB-CI-LAST-NAME      PIC X(15).
  4159                 24  PB-CI-INITIALS       PIC XX.
  4160             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4161             20  PB-CI-INSURED-SEX        PIC X.
  4162             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4163             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4164             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4165             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4166             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4167             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4168             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4169             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4170             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4171             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4172             20  PB-CI-RATE-CLASS         PIC XX.
  4173             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4174             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4175             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4176             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4177             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4178             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4179             20  PB-CI-LF-ABBR            PIC X(3).
  4180             20  PB-CI-AH-ABBR            PIC X(3).
  4181             20  PB-CI-OB-FLAG            PIC X.
  4182                 88  PB-CI-OB                VALUE 'B'.
  4183             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4184                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4185                                           'M' '4' '5' '9' '2'.
  4186                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4187                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4188                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4189                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4190                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4191                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4192                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4193                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4194                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4195                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4196                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4197                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4198             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4199                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4200                                           'M' '4' '5' '9' '2'.
  4201                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4202                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4203                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4204                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4205                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4206                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4207                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4208                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  79
* EL050.cbl
  4209                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4210                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4211                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4212                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4213             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4214             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4215             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4216             20  PB-CI-MEMBER-NO          PIC X(12).
  4217             20  PB-CI-INT-CODE           PIC X.
  4218                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4219                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4220             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4221             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4222             20  PB-CI-COMP-EXCP-SW       PIC X.
  4223                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4224                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4225             20  PB-CI-ENTRY-STATUS       PIC X.
  4226             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4227             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4228             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4229             20  PB-CI-DEATH-DT           PIC XX.
  4230             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4231             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4232             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4233             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4234             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4235             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4236             20  PB-CI-ENTRY-DT              PIC XX.
  4237             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4238             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4239             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4240             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4241             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4242             20  PB-CI-OLD-LOF               PIC XXX.
  4243*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4244             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4245             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4246             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4247             20  PB-CI-INDV-GRP-CD           PIC X.
  4248             20  PB-CI-BENEFICIARY-NAME.
  4249                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4250                 24  FILLER                  PIC X(15).
  4251             20  PB-CI-NOTE-SW               PIC X.
  4252             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4253             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4254             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4255             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4256             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4257             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4258             20  PB-CI-FIRST-NAME            PIC X(10).
  4259             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4260
  4261         16  FILLER                       PIC X(13).
  4262*032306  16  FILLER                       PIC X(27).
  4263*        16  FILLER                       PIC X(46).
  4264
  4265     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4266         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  80
* EL050.cbl
  4267         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4268         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4269         16  PB-M-INSURED-MID-INIT        PIC X.
  4270         16  PB-M-INSURED-AGE             PIC 99.
  4271         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4272         16  PB-M-INSURED-SEX             PIC X.
  4273         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4274         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4275         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4276         16  PB-M-INSURED-CITY-STATE.
  4277             20  PB-M-INSURED-CITY        PIC X(28).
  4278             20  PB-M-INSURED-STATE       PIC XX.
  4279         16  PB-M-INSURED-ZIP-CODE.
  4280             20  PB-M-INSURED-ZIP-PRIME.
  4281                 24  PB-M-INSURED-ZIP-1   PIC X.
  4282                     88  PB-M-CANADIAN-POST-CODE
  4283                                             VALUE 'A' THRU 'Z'.
  4284                 24  FILLER               PIC X(4).
  4285             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4286         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4287                                        PB-M-INSURED-ZIP-CODE.
  4288             20  PM-M-INS-CAN-POST1       PIC XXX.
  4289             20  PM-M-INS-CAN-POST2       PIC XXX.
  4290             20  FILLER                   PIC XXX.
  4291         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4292         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4293         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4294         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4295         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4296         16  PB-M-CRED-BENE-CITYST.
  4297             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4298             20  PB-M-CRED-BENE-STATE     PIC XX.
  4299         16  FILLER                       PIC X(92).
  4300
  4301     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4302         16  FILLER                       PIC X(10).
  4303         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4304         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4305         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4307         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4308         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4310         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4311         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4312         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4313         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4314         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4315         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4316         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4317         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4318         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4319         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4320         16  PB-ACCOUNT-NAME              PIC X(30).
  4321         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4322         16  PB-REFERENCE                 PIC X(12).
  4323         16  PB-B-RECEIVED-DT             PIC XX.
  4324         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  81
* EL050.cbl
  4325
  4326     12  PB-RECORD-STATUS.
  4327         16  PB-CREDIT-SELECT-DT          PIC XX.
  4328         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4329         16  PB-BILLED-DT                 PIC XX.
  4330         16  PB-BILLING-STATUS            PIC X.
  4331             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4332             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4333             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4334         16  PB-RECORD-BILL               PIC X.
  4335             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4336             88  PB-RECORD-RETURNED           VALUE 'R'.
  4337             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4338             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4339             88  PB-OVERRIDE-AH               VALUE 'A'.
  4340             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4341         16  PB-BATCH-ENTRY               PIC X.
  4342             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4343             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4344             88  PB-REISSUED-CERT             VALUE 'E'.
  4345             88  PB-MONTHLY-CERT              VALUE 'M'.
  4346             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4347             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4348             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4349         16  PB-FORCE-CODE                PIC X.
  4350             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4351             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4352             88  PB-CANCEL-FORCE              VALUE '8'.
  4353             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4354             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4355             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4356             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4357             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4358             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4359             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4360         16  PB-FATAL-FLAG                PIC X.
  4361             88  PB-FATAL-ERRORS              VALUE 'X'.
  4362         16  PB-FORCE-ER-CD               PIC X.
  4363             88  PB-FORCE-ERRORS              VALUE 'F'.
  4364             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4365         16  PB-WARN-ER-CD                PIC X.
  4366             88  PB-WARNING-ERRORS            VALUE 'W'.
  4367         16  FILLER                       PIC X.
  4368         16  PB-OUT-BAL-CD                PIC X.
  4369             88  PB-OUT-OF-BAL                VALUE 'O'.
  4370         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4371         16  PB-AH-OVERRIDE-L1            PIC X.
  4372         16  PB-INPUT-DT                  PIC XX.
  4373         16  PB-INPUT-BY                  PIC X(4).
  4374         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4375         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4376         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4377         16  PB-LF-EARNING-METHOD         PIC X.
  4378         16  PB-AH-EARNING-METHOD         PIC X.
  4379         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4380         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4381         16  PB-REIN-CD                   PIC XXX.
  4382         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  82
* EL050.cbl
  4383         16  PB-AH-REFUND-TYPE            PIC X.
  4384         16  PB-ACCT-EFF-DT               PIC XX.
  4385         16  PB-ACCT-EXP-DT               PIC XX.
  4386         16  PB-COMPANY-ID                PIC X(3).
  4387         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4388         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4389         16  PB-SV-CARRIER                PIC X.
  4390         16  PB-SV-GROUPING               PIC X(6).
  4391         16  PB-SV-STATE                  PIC XX.
  4392         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4393         16  PB-GA-BILLING-INFO.
  4394             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4395                                          PIC XX.
  4396         16  PB-SV-REMIT-TO  REDEFINES
  4397             PB-GA-BILLING-INFO           PIC X(10).
  4398         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4399         16  PB-I-LOAN-OFFICER            PIC X(5).
  4400         16  PB-I-VIN                     PIC X(17).
  4401
  4402         16  FILLER                       PIC X(04).
  4403         16  IMNET-BYPASS-SW              PIC X.
  4404
  4405******************************************************************
  4406*                COMMON EDIT ERRORS                              *
  4407******************************************************************
  4408
  4409     12  PB-COMMON-ERRORS.
  4410         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4411                                           PIC S9(4)     COMP.
  4412
  4413******************************************************************
  4414
  4415* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4416*    COPY ELC50W1.
  4417******************************************************************
  4418*                                                                *
  4419*                                                                *
  4420*                             ELC50W1                            *
  4421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4422*                            VMOD=2.004                          *
  4423*                                                                *
  4424*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4425*                                                                *
  4426*                                                                *
  4427******************************************************************
  4428
  4429     12  WK-WORK-AREA.
  4430         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4431         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4432         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4433         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4434         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4435         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4436         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4437         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4438         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4439         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4440         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  83
* EL050.cbl
  4441         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4442         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4443         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4444         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4445         16  WK-CREDIT-EDIT-CONTROLS.
  4446             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4447             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4448             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4449             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4450             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4451             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4452         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4453         16  WK-SAVE-REIN-DATA.
  4454             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4455             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4456             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4457         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4458             88  ENTRY-FROM-EL6311       VALUE '6'.
  4459         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4460         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4461     12  WK-RECORD-ADDRESSES.
  4462         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4463         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4464         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4465         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4466         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4467         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4468         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4469         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4470     12  WK-OVER-SHORT-AREA.
  4471         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4472         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4473         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4474             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4475         16  FILLER                   PIC X(5) VALUE SPACES.
  4476
  4477*    COPY ELCEDITC.
  4478******************************************************************
  4479*                                                                *
  4480*                                                                *
  4481*                            ELCEDITC                            *
  4482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4483*                            VMOD=2.012                          *
  4484*                                                                *
  4485*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4486*                     EL6313, EL050 AND EL517.                   *
  4487*                                                                *
  4488******************************************************************
  4489******************************************************************
  4490*                   C H A N G E   L O G
  4491*
  4492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4493*-----------------------------------------------------------------
  4494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4495* EFFECTIVE    NUMBER
  4496*-----------------------------------------------------------------
  4497* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4498******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  84
* EL050.cbl
  4499
  4500     12  EDIT-CRITERIA-DATA.
  4501         16  EC-CO-MONTH-END-DT       PIC XX.
  4502         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4503         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4504         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4505         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4506         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4507         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4508         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4509         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4510         16  EC-CO-REM-TERM-CALC      PIC X.
  4511               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4512               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4513               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4514               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4515
  4516         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4517               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4518               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4519               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4520               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4521               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4522               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4523               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4524               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4525               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4526               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4527
  4528         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4529               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4530               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4531               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4532               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4533               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4534               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4535               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4536               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4537
  4538         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4539                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4540                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4541
  4542         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4543                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4544                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4545                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4546                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4547                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4548                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4549                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4550                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4551
  4552         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4553               88  EC-BR-REDUCING                   VALUE 'R'.
  4554               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4555
  4556         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  85
* EL050.cbl
  4557         16  EC-BR-LF-DESC             PIC X(10).
  4558         16  EC-BR-AH-DESC             PIC X(10).
  4559         16  EC-BR-LF-COMMENT          PIC X(10).
  4560         16  EC-BR-AH-COMMENT          PIC X(10).
  4561
  4562         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4563               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4564               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4565               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4566               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4567
  4568         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4569               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4570               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4571               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4572               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4573
  4574         16  EC-BR-LF-REFUND-CALC      PIC X.
  4575                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4576                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4577                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4578                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4579                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4580                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4581                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4582
  4583         16  EC-BR-AH-REFUND-CALC      PIC X.
  4584                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4585                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4586                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4587                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4588                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4589                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4590                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4591                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4592
  4593         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4594                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4595                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4596                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4597
  4598         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4599                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4600                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4601                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4602
  4603         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4604         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4605         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4606         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4607
  4608         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4609         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4610                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4611                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4612                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4613                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4614
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  86
* EL050.cbl
  4615         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4616               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4617               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4618               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4619               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4620               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4621
  4622         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4623               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4624               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4625               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4626               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4627               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4628
  4629         16  EC-ST-LF-REFUND-CALC      PIC X.
  4630                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4631                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4632                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4633                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4634                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4635                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4636                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4637                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4638
  4639         16  EC-ST-AH-REFUND-CALC      PIC X.
  4640                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4641                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4642                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4643                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4644                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4645                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4646                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4647                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4648
  4649         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4650         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4651         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4652         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4653         16  EC-AM-EXPIRATION-DT       PIC XX.
  4654         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4655         16  EC-AM-CLASS-CD            PIC XX.
  4656         16  EC-AM-LF-DEVIATION        PIC XXX.
  4657         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4658         16  EC-AM-AH-DEVIATION        PIC XXX.
  4659         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4660         16  EC-AM-PHONE-NO            PIC X(10).
  4661
  4662         16  EC-AM-LF-REFUND-CALC      PIC X.
  4663                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4664                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4665                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4666                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4667                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4668                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4669                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4670
  4671         16  EC-AM-AH-REFUND-CALC      PIC X.
  4672                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  87
* EL050.cbl
  4673                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4674                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4675                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4676                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4677                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4678                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4679
  4680         16  EC-AM-BEN-I-G-CD          PIC X.
  4681                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4682                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4683                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4684
  4685         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4686         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4687         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4688         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4689         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4690         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4691         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4692         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4693         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4694
  4695         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4696         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4697         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4698         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4699         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4700         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4701         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4702         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4703         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4704         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4705         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4706         16  EC-RT-LF-NSP-ST           PIC XX.
  4707         16  EC-RT-AH-NSP-ST           PIC XX.
  4708         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4709         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4710
  4711         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4712             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4713                                             'M' '5' '9' '2'.
  4714             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4715             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4716             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4717             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4718             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4719             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4720             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4721             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4722             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4723             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4724
  4725         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4726             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4727                                             'M' '5' '9' '2'.
  4728             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4729             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4730             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  88
* EL050.cbl
  4731             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4732             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4733             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4734             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4735             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4736             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4737             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4738
  4739         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4740         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4741         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4742         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4743         16  EC-CM-DEATH-DT            PIC XX.
  4744
  4745*DMD CUSTOM CODING FIELDS BELOW
  4746*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4747         16  EC-BR-DMD-RATING-SW       PIC X.
  4748                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4749                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4750                 88  NO-DMD-RATING               VALUE 'N'.
  4751
  4752         16  EC-NEW-CERT               PIC X(11).
  4753         16  EC-NEW-STATE              PIC XX.
  4754         16  FILLER                    PIC X.
  4755*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4756         16  OVER-SHORT-EDIT-FIELDS.
  4757             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4758             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4759             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4760             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4761             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4762             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4763             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4764             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4765             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4766         16  FILLER                    PIC X(71).
  4767******************************************************************
  4768
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  89
* EL050.cbl
  4770*    COPY ELCDIFRD.
  4771******************************************************************
  4772*                                                                *
  4773*                                                                *
  4774*                            ELCDIFRD.                           *
  4775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4776*                            VMOD=2.004                          *
  4777*                                                                *
  4778*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4779*                                                                *
  4780******************************************************************
  4781*
  4782  01  WS-DIFFERENCE-CALCULATION.
  4783        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4784        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4785        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4786        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4787        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4788        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4789        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4790        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4791        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4792        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4793        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4794
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  90
* EL050.cbl
  4796****************************************************************
  4797*
  4798* Copyright (c) 2007 by Clerity Solutions, Inc.
  4799* All rights reserved.
  4800*
  4801****************************************************************
  4802 01  DFHEIV.
  4803   02  DFHEIV0               PIC X(35).
  4804   02  DFHEIV1               PIC X(08).
  4805   02  DFHEIV2               PIC X(08).
  4806   02  DFHEIV3               PIC X(08).
  4807   02  DFHEIV4               PIC X(06).
  4808   02  DFHEIV5               PIC X(04).
  4809   02  DFHEIV6               PIC X(04).
  4810   02  DFHEIV7               PIC X(02).
  4811   02  DFHEIV8               PIC X(02).
  4812   02  DFHEIV9               PIC X(01).
  4813   02  DFHEIV10              PIC S9(7) COMP-3.
  4814   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4815   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4816   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4817   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4818   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4819   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4820   02  DFHEIV17              PIC X(04).
  4821   02  DFHEIV18              PIC X(04).
  4822   02  DFHEIV19              PIC X(04).
  4823   02  DFHEIV20              USAGE IS POINTER.
  4824   02  DFHEIV21              USAGE IS POINTER.
  4825   02  DFHEIV22              USAGE IS POINTER.
  4826   02  DFHEIV23              USAGE IS POINTER.
  4827   02  DFHEIV24              USAGE IS POINTER.
  4828   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4829   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4830   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4831   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4832   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4833   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4834   02  FILLER                PIC X(02).
  4835   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4836   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4837   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4838   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4839   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4840 LINKAGE  SECTION.
  4841*****************************************************************
  4842*                                                               *
  4843* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4844* All rights reserved.                                          *
  4845*                                                               *
  4846*****************************************************************
  4847 01  dfheiblk.
  4848     02  eibtime          pic s9(7) comp-3.
  4849     02  eibdate          pic s9(7) comp-3.
  4850     02  eibtrnid         pic x(4).
  4851     02  eibtaskn         pic s9(7) comp-3.
  4852     02  eibtrmid         pic x(4).
  4853     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  91
* EL050.cbl
  4854     02  eibcposn         pic s9(4) comp.
  4855     02  eibcalen         pic s9(4) comp.
  4856     02  eibaid           pic x(1).
  4857     02  eibfiller1       pic x(1).
  4858     02  eibfn            pic x(2).
  4859     02  eibfiller2       pic x(2).
  4860     02  eibrcode         pic x(6).
  4861     02  eibfiller3       pic x(2).
  4862     02  eibds            pic x(8).
  4863     02  eibreqid         pic x(8).
  4864     02  eibrsrce         pic x(8).
  4865     02  eibsync          pic x(1).
  4866     02  eibfree          pic x(1).
  4867     02  eibrecv          pic x(1).
  4868     02  eibsend          pic x(1).
  4869     02  eibatt           pic x(1).
  4870     02  eibeoc           pic x(1).
  4871     02  eibfmh           pic x(1).
  4872     02  eibcompl         pic x(1).
  4873     02  eibsig           pic x(1).
  4874     02  eibconf          pic x(1).
  4875     02  eiberr           pic x(1).
  4876     02  eibrldbk         pic x(1).
  4877     02  eiberrcd         pic x(4).
  4878     02  eibsynrb         pic x(1).
  4879     02  eibnodat         pic x(1).
  4880     02  eibfiller5       pic x(2).
  4881     02  eibresp          pic 9(09) comp.
  4882     02  eibresp2         pic 9(09) comp.
  4883     02  dfheigdj         pic s9(4) comp.
  4884     02  dfheigdk         pic s9(4) comp.
  4885
  4886 01  DFHCOMMAREA                   PIC X(1036).
  4887
  4888*01 PARMLIST .
  4889*    02  FILLER                    PIC S9(8)   COMP.
  4890*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4891*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4892*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4893*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4894*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4895*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4896*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4897
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  92
* EL050.cbl
  4899*    COPY ELCCNTL.
  4900******************************************************************
  4901*                                                                *
  4902*                                                                *
  4903*                            ELCCNTL.                            *
  4904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4905*                            VMOD=2.059                          *
  4906*                                                                *
  4907*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4908*                                                                *
  4909*   FILE TYPE = VSAM,KSDS                                        *
  4910*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4911*                                                                *
  4912*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4913*       ALTERNATE INDEX = NONE                                   *
  4914*                                                                *
  4915*   LOG = YES                                                    *
  4916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4917******************************************************************
  4918*                   C H A N G E   L O G
  4919*
  4920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4921*-----------------------------------------------------------------
  4922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4923* EFFECTIVE    NUMBER
  4924*-----------------------------------------------------------------
  4925* 082503                   PEMA  ADD BENEFIT GROUP
  4926* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4927* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4928* 092705    2005050300006  PEMA  ADD SPP LEASES
  4929* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4930* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4931* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4932* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4933* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4934* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4935******************************************************************
  4936*
  4937 01  CONTROL-FILE.
  4938     12  CF-RECORD-ID                       PIC XX.
  4939         88  VALID-CF-ID                        VALUE 'CF'.
  4940
  4941     12  CF-CONTROL-PRIMARY.
  4942         16  CF-COMPANY-ID                  PIC XXX.
  4943         16  CF-RECORD-TYPE                 PIC X.
  4944             88  CF-COMPANY-MASTER              VALUE '1'.
  4945             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4946             88  CF-STATE-MASTER                VALUE '3'.
  4947             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4948             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4949             88  CF-CARRIER-MASTER              VALUE '6'.
  4950             88  CF-MORTALITY-MASTER            VALUE '7'.
  4951             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4952             88  CF-TERMINAL-MASTER             VALUE '9'.
  4953             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4954             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4955             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4956             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  93
* EL050.cbl
  4957             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4958             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4959             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4960             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4961             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4962         16  CF-ACCESS-CD-GENL              PIC X(4).
  4963         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4964             20  CF-PROCESSOR               PIC X(4).
  4965         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  CF-STATE-CODE              PIC XX.
  4967             20  FILLER                     PIC XX.
  4968         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4969             20  FILLER                     PIC XX.
  4970             20  CF-HI-BEN-IN-REC           PIC XX.
  4971         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4972             20  FILLER                     PIC XXX.
  4973             20  CF-CARRIER-CNTL            PIC X.
  4974         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4975             20  FILLER                     PIC XX.
  4976             20  CF-HI-TYPE-IN-REC          PIC 99.
  4977         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4978             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4979                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4980             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4981             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4982         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4983             20  FILLER                     PIC X.
  4984             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4985         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4986             20  FILLER                     PIC XX.
  4987             20  CF-MORTGAGE-PLAN           PIC XX.
  4988         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4989
  4990     12  CF-LAST-MAINT-DT                   PIC XX.
  4991     12  CF-LAST-MAINT-BY                   PIC X(4).
  4992     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4993
  4994     12  CF-RECORD-BODY                     PIC X(728).
  4995
  4996
  4997****************************************************************
  4998*             COMPANY MASTER RECORD                            *
  4999****************************************************************
  5000
  5001     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5002         16  CF-COMPANY-ADDRESS.
  5003             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5004             20  CF-CL-IN-CARE-OF           PIC X(30).
  5005             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5006             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5007             20  CF-CL-CITY-STATE           PIC X(30).
  5008             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5009             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5010         16  CF-COMPANY-CD                  PIC X.
  5011         16  CF-COMPANY-PASSWORD            PIC X(8).
  5012         16  CF-SECURITY-OPTION             PIC X.
  5013             88  ALL-SECURITY                   VALUE '1'.
  5014             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  94
* EL050.cbl
  5015             88  PROCESSOR-VERIFY               VALUE '3'.
  5016             88  NO-SECURITY                    VALUE '4'.
  5017             88  ALL-BUT-TERM                   VALUE '5'.
  5018         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5019             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5020         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5021             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5022         16  CF-INFORCE-LOCATION            PIC X.
  5023             88  CERTS-ARE-ONLINE               VALUE '1'.
  5024             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5025             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5026         16  CF-LOWER-CASE-LETTERS          PIC X.
  5027         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5028             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5029             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5030             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5031             88  CF-ACCNT-CNTL                  VALUE '3'.
  5032             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5033
  5034         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5035         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5036
  5037         16  CF-LGX-CREDIT-USER             PIC X.
  5038             88  CO-IS-NOT-USER                 VALUE 'N'.
  5039             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5040
  5041         16 CF-CREDIT-CALC-CODES.
  5042             20  CF-CR-REM-TERM-CALC PIC X.
  5043               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5044               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5045               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5046               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5047               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5048               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5049               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5050             20  CF-CR-R78-METHOD           PIC X.
  5051               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5052               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5053
  5054         16  CF-CLAIM-CONTROL-COUNTS.
  5055             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5056                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5057
  5058             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5059                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5060
  5061             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5062                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5063
  5064             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5065                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5066
  5067         16  CF-CURRENT-MONTH-END           PIC XX.
  5068
  5069         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5070             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5071             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5072             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  95
* EL050.cbl
  5073             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5074                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5075                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5076             20  CF-CO-PREM-REJECT-SW       PIC X.
  5077                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5078                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5079             20  CF-CO-REF-REJECT-SW        PIC X.
  5080                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5081                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5082
  5083         16  CF-CO-REPORTING-DT             PIC XX.
  5084         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5085         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5086           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5087           88  CF-CO-MONTH-END                  VALUE '1'.
  5088
  5089         16  CF-LGX-CLAIM-USER              PIC X.
  5090             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5091             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5092
  5093         16  CF-CREDIT-EDIT-CONTROLS.
  5094             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5095             20  CF-MIN-AGE                 PIC 99.
  5096             20  CF-DEFAULT-AGE             PIC 99.
  5097             20  CF-MIN-TERM                PIC S999      COMP-3.
  5098             20  CF-MAX-TERM                PIC S999      COMP-3.
  5099             20  CF-DEFAULT-SEX             PIC X.
  5100             20  CF-JOINT-AGE-INPUT         PIC X.
  5101                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5102             20  CF-BIRTH-DATE-INPUT        PIC X.
  5103                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5104             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5105                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5106                 88  CF-ZERO-CARRIER            VALUE '1'.
  5107                 88  CF-ZERO-GROUPING           VALUE '2'.
  5108                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5109             20  CF-EDIT-SW                 PIC X.
  5110                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5111             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5112             20  CF-CR-PR-METHOD            PIC X.
  5113               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5114               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5115             20  FILLER                     PIC X.
  5116
  5117         16  CF-CREDIT-MISC-CONTROLS.
  5118             20  CF-REIN-TABLE-SW           PIC X.
  5119                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5120             20  CF-COMP-TABLE-SW           PIC X.
  5121                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5122             20  CF-EXPERIENCE-RETENTION-AGE
  5123                                            PIC S9        COMP-3.
  5124             20  CF-CONVERSION-DT           PIC XX.
  5125             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5126             20  CF-RUN-FREQUENCY-SW        PIC X.
  5127                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5128                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5129
  5130             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  96
* EL050.cbl
  5131                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5132                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5133                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5134                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5135                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5136                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5137
  5138                 24  CF-CR-CHECK-COUNT       REDEFINES
  5139                     CF-CR-CHECK-COUNTER      PIC X(4).
  5140
  5141                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5142                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5143
  5144                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5145                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5146                 24  CF-MAIL-PROCESSING       PIC X.
  5147                     88  MAIL-PROCESSING          VALUE 'Y'.
  5148
  5149         16  CF-MISC-SYSTEM-CONTROL.
  5150             20  CF-SYSTEM-C                 PIC X.
  5151                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5152             20  CF-SYSTEM-D                 PIC X.
  5153                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5154             20  CF-SOC-SEC-NO-SW            PIC X.
  5155                 88  SOC-SEC-NO-USED             VALUE '1'.
  5156             20  CF-MEMBER-NO-SW             PIC X.
  5157                 88  MEMBER-NO-USED              VALUE '1'.
  5158             20  CF-TAX-ID-NUMBER            PIC X(11).
  5159             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5160             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5161                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5162                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5163                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5164                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5165             20  CF-SYSTEM-E                 PIC X.
  5166                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5167
  5168         16  CF-LGX-LIFE-USER               PIC X.
  5169             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5170             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5171
  5172         16  CF-CR-MONTH-END-DT             PIC XX.
  5173
  5174         16  CF-FILE-MAINT-DATES.
  5175             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5176                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5177             20  CF-LAST-BATCH       REDEFINES
  5178                 CF-LAST-BATCH-NO               PIC X(4).
  5179             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5180             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5181             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5182             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5183             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5184             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5185             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5186             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5187             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5188             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  97
* EL050.cbl
  5189
  5190         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5191         16  FILLER                         PIC X.
  5192
  5193         16  CF-ALT-MORT-CODE               PIC X(4).
  5194         16  CF-MEMBER-CAPTION              PIC X(10).
  5195
  5196         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5197             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5198             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5199             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5200             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5201             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5202
  5203         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5204
  5205         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5206         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5207         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5208         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5209
  5210         16  CF-AH-OVERRIDE-L1              PIC X.
  5211         16  CF-AH-OVERRIDE-L2              PIC XX.
  5212         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5213         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5214
  5215         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5216         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5217
  5218         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5219         16  CF-AR-LAST-EL860-DT            PIC XX.
  5220         16  CF-MP-MONTH-END-DT             PIC XX.
  5221
  5222         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5223         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5224             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5225
  5226         16  CF-AR-MONTH-END-DT             PIC XX.
  5227
  5228         16  CF-CRDTCRD-USER                PIC X.
  5229             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5230             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5231
  5232         16  CF-CC-MONTH-END-DT             PIC XX.
  5233
  5234         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5235
  5236         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5237             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5238             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5239             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5240         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5241         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5242         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5243         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5244             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5245             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5246         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  98
* EL050.cbl
  5247         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5248         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5249             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5250         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5251
  5252         16  CF-CL-ZIP-CODE.
  5253             20  CF-CL-ZIP-PRIME.
  5254                 24  CF-CL-ZIP-1ST          PIC X.
  5255                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5256                 24  FILLER                 PIC X(4).
  5257             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5258         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5259             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5260             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5261             20  FILLER                     PIC XXX.
  5262
  5263         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5264         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5265         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5266         16  CF-CO-OPTION-START-DATE        PIC XX.
  5267         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5268           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5269                                                      '3' '4'.
  5270           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5271           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5272           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5273           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5274           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5275           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5276
  5277         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5278
  5279         16  CF-PAYMENT-APPROVAL-LEVELS.
  5280             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5281             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5282             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5283             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5284             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5285             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5286
  5287         16  CF-END-USER-REPORTING-USER     PIC X.
  5288             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5289             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5292             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5293             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5294
  5295         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5296
  5297         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5298         16  FILLER                         PIC X.
  5299
  5300         16  CF-CREDIT-ARCHIVE-CNTL.
  5301             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5302             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5303             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5304
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  99
* EL050.cbl
  5305         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5306
  5307         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5308             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5309             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5310
  5311         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5312             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5313             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5314
  5315         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5316
  5317         16  CF-CO-ACH-ID-CODE              PIC  X.
  5318             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5319             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5320             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5321         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5322         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5323         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5324         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5325         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5326         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5327         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5328         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5329         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5330                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5331         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5332                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5333
  5334         16  CF-CO-OVER-SHORT.
  5335             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5336             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5337
  5338*         16  FILLER                         PIC X(102).
  5339         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5340             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5341             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5342
  5343         16  CF-AH-APPROVAL-DAYS.
  5344             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5345             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5346             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5347             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5348
  5349         16  FILLER                         PIC X(82).
  5350****************************************************************
  5351*             PROCESSOR/USER RECORD                            *
  5352****************************************************************
  5353
  5354     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5355         16  CF-PROCESSOR-NAME              PIC X(30).
  5356         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5357         16  CF-PROCESSOR-TITLE             PIC X(26).
  5358         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5359                 88  MESSAGE-YES                VALUE 'Y'.
  5360                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5361
  5362*****************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 100
* EL050.cbl
  5363****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5364****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5365****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5366****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5367*****************************************************
  5368
  5369         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5370             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5371             20  CF-APPLICATION-FORCE       PIC X.
  5372             20  CF-INDIVIDUAL-APP.
  5373                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5374                     28  CF-BROWSE-APP      PIC X.
  5375                     28  CF-UPDATE-APP      PIC X.
  5376
  5377         16  CF-CURRENT-TERM-ON             PIC X(4).
  5378         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5379             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5380             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5381             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5382             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5383             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5384             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5385             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5386         16  CF-PROCESSOR-CARRIER           PIC X.
  5387             88  NO-CARRIER-SECURITY            VALUE ' '.
  5388         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5389             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5390         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5391             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5392         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5393             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5394
  5395         16  CF-PROC-SYS-ACCESS-SW.
  5396             20  CF-PROC-CREDIT-CLAIMS-SW.
  5397                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5398                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5399                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5400                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5401             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5402                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5403                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5404             20  CF-PROC-LIFE-GNRLDGR-SW.
  5405                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5406                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5407                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5408                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5409             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5410                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5411                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5412         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5413             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5414             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5415         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5416
  5417         16  CF-APPROVAL-LEVEL                  PIC X.
  5418             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5419             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5420             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 101
* EL050.cbl
  5421             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5422
  5423         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5424
  5425         16  CF-LANGUAGE-TYPE                   PIC X.
  5426             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5427             88  CF-LANG-IS-FR                      VALUE 'F'.
  5428
  5429         16  CF-CSR-IND                         PIC X.
  5430         16  FILLER                             PIC X(239).
  5431
  5432****************************************************************
  5433*             PROCESSOR/REMINDERS RECORD                       *
  5434****************************************************************
  5435
  5436     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5437         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5438             20  CF-START-REMIND-DT         PIC XX.
  5439             20  CF-END-REMIND-DT           PIC XX.
  5440             20  CF-REMINDER-TEXT           PIC X(50).
  5441         16  FILLER                         PIC X(296).
  5442
  5443
  5444****************************************************************
  5445*             STATE MASTER RECORD                              *
  5446****************************************************************
  5447
  5448     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5449         16  CF-STATE-ABBREVIATION          PIC XX.
  5450         16  CF-STATE-NAME                  PIC X(25).
  5451         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5452         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5453             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5454             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5455             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5456             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5457                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5458                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5459             20  CF-ST-PREM-REJECT-SW       PIC X.
  5460                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5461                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5462             20  CF-ST-REF-REJECT-SW        PIC X.
  5463                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5464                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5465         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5466         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5467         16  CF-ST-REFUND-RULES.
  5468             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5469             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5470             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5471         16  CF-ST-FST-PMT-EXTENSION.
  5472             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5473             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5474                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5475                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5476                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5477                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5478         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 102
* EL050.cbl
  5479             20  CF-ST-CALL-UNEARNED        PIC X.
  5480             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5481             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5482         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5483             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5484             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5485         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5486         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5487         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5488         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5489         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5490         16  FILLER                         PIC X.
  5491         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5492             20  CF-ST-BENEFIT-CD           PIC XX.
  5493             20  CF-ST-BENEFIT-KIND         PIC X.
  5494                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5495                 88  CF-ST-AH-KIND              VALUE 'A'.
  5496             20  CF-ST-REM-TERM-CALC        PIC X.
  5497                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5498                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5499                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5500                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5501                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5502                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5503                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5504                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5505
  5506             20  CF-ST-REFUND-CALC          PIC X.
  5507                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5508                 88  ST-REFD-BY-R78             VALUE '1'.
  5509                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5510                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5511                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5512                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5513                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5514                 88  ST-REFD-UTAH               VALUE '7'.
  5515                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5516                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5517                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5518
  5519             20  CF-ST-EARNING-CALC         PIC X.
  5520                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5521                 88  ST-EARN-BY-R78             VALUE '1'.
  5522                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5523                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5524                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5525                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5526                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5527                 88  ST-EARN-MEAN               VALUE '8'.
  5528                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5529
  5530             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5531                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5532                 88  ST-OVRD-BY-R78             VALUE '1'.
  5533                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5534                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5535                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5536                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 103
* EL050.cbl
  5537                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5538                 88  ST-OVRD-MEAN               VALUE '8'.
  5539                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5540             20  FILLER                     PIC X.
  5541
  5542         16  CF-ST-COMMISSION-CAPS.
  5543             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5544             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5545             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5546             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5547         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5548                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5549
  5550         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5551
  5552         16  CF-ST-STATUTORY-INTEREST.
  5553             20  CF-ST-STAT-DATE-FROM       PIC X.
  5554                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5555                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5556             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5557             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5558             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5559             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5560             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5561
  5562         16  CF-ST-OVER-SHORT.
  5563             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5564             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5565
  5566         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5567
  5568         16  CF-ST-RT-CALC                  PIC X.
  5569
  5570         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5571         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5572         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5573         16  CF-ST-RF-LR-CALC               PIC X.
  5574         16  CF-ST-RF-LL-CALC               PIC X.
  5575         16  CF-ST-RF-LN-CALC               PIC X.
  5576         16  CF-ST-RF-AH-CALC               PIC X.
  5577         16  CF-ST-RF-CP-CALC               PIC X.
  5578*        16  FILLER                         PIC X(206).
  5579*CIDMOD         16  FILLER                         PIC X(192).
  5580         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5581             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5582         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5583         16  CF-ST-VFY-2ND-BENE             PIC X.
  5584         16  FILLER                         PIC X(186).
  5585
  5586****************************************************************
  5587*             BENEFIT MASTER RECORD                            *
  5588****************************************************************
  5589
  5590     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5591         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5592             20  CF-BENEFIT-CODE            PIC XX.
  5593             20  CF-BENEFIT-NUMERIC  REDEFINES
  5594                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 104
* EL050.cbl
  5595             20  CF-BENEFIT-ALPHA           PIC XXX.
  5596             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5597             20  CF-BENEFIT-COMMENT         PIC X(10).
  5598
  5599             20  CF-LF-COVERAGE-TYPE        PIC X.
  5600                 88  CF-REDUCING                VALUE 'R'.
  5601                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5602
  5603             20  CF-SPECIAL-CALC-CD         PIC X.
  5604                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5605                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5606                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5607                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5608                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5609                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5610                 88  CF-FARM-PLAN               VALUE 'F'.
  5611                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5612                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5613                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5614                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5615                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5616                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5617                 88  CF-PRUDENTIAL              VALUE 'P'.
  5618                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5619                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5620                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5621                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5622                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5623                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5624
  5625             20  CF-JOINT-INDICATOR         PIC X.
  5626                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5627
  5628*            20  FILLER                     PIC X(12).
  5629             20  FILLER                     PIC X(11).
  5630             20  CF-BENEFIT-CATEGORY        PIC X.
  5631             20  CF-LOAN-TYPE               PIC X(8).
  5632
  5633             20  CF-CO-REM-TERM-CALC        PIC X.
  5634                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5635                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5636                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5637                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5638                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5639
  5640             20  CF-CO-EARNINGS-CALC        PIC X.
  5641                 88  CO-EARN-BY-R78             VALUE '1'.
  5642                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5643                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5644                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5645                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5646                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5647                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5648                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5649
  5650             20  CF-CO-REFUND-CALC          PIC X.
  5651                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5652                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 105
* EL050.cbl
  5653                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5654                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5655                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5656                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5657                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5658                 88  CO-REFD-MEAN               VALUE '8'.
  5659                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5660                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5661                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5662
  5663             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5664                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5665                 88  CO-OVRD-BY-R78             VALUE '1'.
  5666                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5667                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5668                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5669                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5670                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5671                 88  CO-OVRD-MEAN               VALUE '8'.
  5672                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5673
  5674             20  CF-CO-BEN-I-G-CD           PIC X.
  5675                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5676                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5677                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5678
  5679         16  FILLER                         PIC X(304).
  5680
  5681
  5682****************************************************************
  5683*             CARRIER MASTER RECORD                            *
  5684****************************************************************
  5685
  5686     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5687         16  CF-ADDRESS-DATA.
  5688             20  CF-MAIL-TO-NAME            PIC X(30).
  5689             20  CF-IN-CARE-OF              PIC X(30).
  5690             20  CF-ADDRESS-LINE-1          PIC X(30).
  5691             20  CF-ADDRESS-LINE-2          PIC X(30).
  5692             20  CF-CITY-STATE              PIC X(30).
  5693             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5694             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5695
  5696         16  CF-CLAIM-NO-CONTROL.
  5697             20  CF-CLAIM-NO-METHOD         PIC X.
  5698                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5699                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5700                 88  CLAIM-NO-SEQ               VALUE '3'.
  5701                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5702             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5703                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5704                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5705                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5706
  5707         16  CF-CHECK-NO-CONTROL.
  5708             20  CF-CHECK-NO-METHOD         PIC X.
  5709                 88  CHECK-NO-MANUAL            VALUE '1'.
  5710                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 106
* EL050.cbl
  5711                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5712                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5713             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5714                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5715
  5716         16  CF-DOMICILE-STATE              PIC XX.
  5717
  5718         16  CF-EXPENSE-CONTROLS.
  5719             20  CF-EXPENSE-METHOD          PIC X.
  5720                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5721                 88  DOLLARS-PER-PMT            VALUE '2'.
  5722                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5723                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5724             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5725             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5726
  5727         16  CF-CORRESPONDENCE-CONTROL.
  5728             20  CF-LETTER-RESEND-OPT       PIC X.
  5729                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5730                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5731             20  FILLER                     PIC X(4).
  5732
  5733         16  CF-RESERVE-CONTROLS.
  5734             20  CF-MANUAL-SW               PIC X.
  5735                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5736             20  CF-FUTURE-SW               PIC X.
  5737                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5738             20  CF-PTC-SW                  PIC X.
  5739                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5740             20  CF-IBNR-SW                 PIC X.
  5741                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5742             20  CF-PTC-LF-SW               PIC X.
  5743                 88  CF-LF-PTC-USED             VALUE '1'.
  5744             20  CF-CDT-ACCESS-METHOD       PIC X.
  5745                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5746                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5747                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5748             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5749
  5750         16  CF-CLAIM-CALC-METHOD           PIC X.
  5751             88  360-PLUS-MONTHS                VALUE '1'.
  5752             88  365-PLUS-MONTHS                VALUE '2'.
  5753             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5754             88  360-DAILY                      VALUE '4'.
  5755             88  365-DAILY                      VALUE '5'.
  5756
  5757         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5758         16  FILLER                         PIC X(11).
  5759
  5760         16  CF-LIMIT-AMOUNTS.
  5761             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5762             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5763             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5764             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5765             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5766             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5767             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5768             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 107
* EL050.cbl
  5769             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5770             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5771
  5772         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5773         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5774         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5775
  5776         16  CF-ZIP-CODE.
  5777             20  CF-ZIP-PRIME.
  5778                 24  CF-ZIP-1ST             PIC X.
  5779                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5780                 24  FILLER                 PIC X(4).
  5781             20  CF-ZIP-PLUS4               PIC X(4).
  5782         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5783             20  CF-CAN-POSTAL-1            PIC XXX.
  5784             20  CF-CAN-POSTAL-2            PIC XXX.
  5785             20  FILLER                     PIC XXX.
  5786
  5787         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5788         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5789         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5790
  5791         16  CF-RATING-SWITCH               PIC X.
  5792             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5793             88  CF-NO-RATING                   VALUE 'N'.
  5794
  5795         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5796
  5797         16  CF-CARRIER-OVER-SHORT.
  5798             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5799             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5800
  5801         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5802         16  CF-SECPAY-SWITCH               PIC X.
  5803             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5804             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5805         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5806         16  FILLER                         PIC X(448).
  5807*        16  FILLER                         PIC X(452).
  5808
  5809
  5810****************************************************************
  5811*             MORTALITY MASTER RECORD                          *
  5812****************************************************************
  5813
  5814     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5815         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5816                                INDEXED BY CF-MORT-NDX.
  5817             20  CF-MORT-TABLE              PIC X(5).
  5818             20  CF-MORT-TABLE-TYPE         PIC X.
  5819                 88  CF-MORT-JOINT              VALUE 'J'.
  5820                 88  CF-MORT-SINGLE             VALUE 'S'.
  5821                 88  CF-MORT-COMBINED           VALUE 'C'.
  5822                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5823                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5824             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5825             20  CF-MORT-AGE-METHOD         PIC XX.
  5826                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 108
* EL050.cbl
  5827                 88  CF-AGE-NEAR                VALUE 'AN'.
  5828             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5829             20  CF-MORT-ADJUSTMENT-DIRECTION
  5830                                            PIC X.
  5831                 88  CF-MINUS                   VALUE '-'.
  5832                 88  CF-PLUS                    VALUE '+'.
  5833             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5834             20  CF-MORT-JOINT-CODE         PIC X.
  5835                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5836             20  CF-MORT-PC-Q               PIC X.
  5837                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5838             20  CF-MORT-TABLE-CODE         PIC X(4).
  5839             20  CF-MORT-COMMENTS           PIC X(15).
  5840             20  FILLER                     PIC X(14).
  5841
  5842         16  FILLER                         PIC X(251).
  5843
  5844
  5845****************************************************************
  5846*             BUSSINESS TYPE MASTER RECORD                     *
  5847****************************************************************
  5848
  5849     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5850* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5851* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5852* AND RECORD 05 IS TYPES 81-99
  5853         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5854             20  CF-BUSINESS-TITLE          PIC  X(19).
  5855             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5856                                            PIC S9V9(4) COMP-3.
  5857             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5858             20  FILLER                     PIC  X.
  5859         16  FILLER                         PIC  X(248).
  5860
  5861
  5862****************************************************************
  5863*             TERMINAL MASTER RECORD                           *
  5864****************************************************************
  5865
  5866     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5867
  5868         16  CF-COMPANY-TERMINALS.
  5869             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5870                                  PIC X(4).
  5871         16  FILLER               PIC X(248).
  5872
  5873
  5874****************************************************************
  5875*             LIFE EDIT MASTER RECORD                          *
  5876****************************************************************
  5877
  5878     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5879         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5880             20  CF-LIFE-CODE-IN            PIC XX.
  5881             20  CF-LIFE-CODE-OUT           PIC XX.
  5882         16  FILLER                         PIC X(248).
  5883
  5884
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 109
* EL050.cbl
  5885****************************************************************
  5886*             AH EDIT MASTER RECORD                            *
  5887****************************************************************
  5888
  5889     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5890         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5891             20  CF-AH-CODE-IN              PIC XXX.
  5892             20  CF-AH-CODE-OUT             PIC XX.
  5893         16  FILLER                         PIC X(248).
  5894
  5895
  5896****************************************************************
  5897*             CREDIBILITY TABLES                               *
  5898****************************************************************
  5899
  5900     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5901         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5902                             INDEXED BY CF-CRDB-NDX.
  5903             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5904             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5905             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5906         16  FILLER                         PIC  X(332).
  5907
  5908
  5909****************************************************************
  5910*             REPORT CUSTOMIZATION RECORD                      *
  5911****************************************************************
  5912
  5913     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5914         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5915             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5916             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5917             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5918**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5919****       A T-TRANSFER.                                   ****
  5920             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5921
  5922         16  FILLER                         PIC XX.
  5923
  5924         16  CF-CARRIER-CNTL-OPT.
  5925             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5926                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5927                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5928             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5929                                            PIC X.
  5930         16  CF-GROUP-CNTL-OPT.
  5931             20  CF-GROUP-OPT-SEQ           PIC 9.
  5932                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5933                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5934             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5935                                            PIC X(6).
  5936         16  CF-STATE-CNTL-OPT.
  5937             20  CF-STATE-OPT-SEQ           PIC 9.
  5938                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5939                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5940             20  CF-STATE-SELECT OCCURS 3 TIMES
  5941                                            PIC XX.
  5942         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 110
* EL050.cbl
  5943             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5944                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5945                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5946             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5947                                            PIC X(10).
  5948         16  CF-BUS-TYP-CNTL-OPT.
  5949             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5950                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5951                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5952             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5953                                            PIC XX.
  5954         16  CF-LF-TYP-CNTL-OPT.
  5955             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5956                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5957                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5958             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5959                                            PIC XX.
  5960         16  CF-AH-TYP-CNTL-OPT.
  5961             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5962                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5963                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5964             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5965                                            PIC XX.
  5966         16  CF-REPTCD1-CNTL-OPT.
  5967             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5968                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5969                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5970             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5971                                            PIC X(10).
  5972         16  CF-REPTCD2-CNTL-OPT.
  5973             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5974                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5975                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5976             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5977                                            PIC X(10).
  5978         16  CF-USER1-CNTL-OPT.
  5979             20  CF-USER1-OPT-SEQ           PIC 9.
  5980                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5981                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5982             20  CF-USER1-SELECT OCCURS 3 TIMES
  5983                                            PIC X(10).
  5984         16  CF-USER2-CNTL-OPT.
  5985             20  CF-USER2-OPT-SEQ           PIC 9.
  5986                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5987                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5988             20  CF-USER2-SELECT OCCURS 3 TIMES
  5989                                            PIC X(10).
  5990         16  CF-USER3-CNTL-OPT.
  5991             20  CF-USER3-OPT-SEQ           PIC 9.
  5992                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5993                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5994             20  CF-USER3-SELECT OCCURS 3 TIMES
  5995                                            PIC X(10).
  5996         16  CF-USER4-CNTL-OPT.
  5997             20  CF-USER4-OPT-SEQ           PIC 9.
  5998                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6000             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 111
* EL050.cbl
  6001                                            PIC X(10).
  6002         16  CF-USER5-CNTL-OPT.
  6003             20  CF-USER5-OPT-SEQ           PIC 9.
  6004                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6005                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6006             20  CF-USER5-SELECT OCCURS 3 TIMES
  6007                                            PIC X(10).
  6008         16  CF-REINS-CNTL-OPT.
  6009             20  CF-REINS-OPT-SEQ           PIC 9.
  6010                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6011                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6012             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6013                 24  CF-REINS-PRIME         PIC XXX.
  6014                 24  CF-REINS-SUB           PIC XXX.
  6015
  6016         16  CF-AGENT-CNTL-OPT.
  6017             20  CF-AGENT-OPT-SEQ           PIC 9.
  6018                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6019                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6020             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6021                                            PIC X(10).
  6022
  6023         16  FILLER                         PIC X(43).
  6024
  6025         16  CF-LOSS-RATIO-SELECT.
  6026             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6027             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6028         16  CF-ENTRY-DATE-SELECT.
  6029             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6030             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6031         16  CF-EFFECTIVE-DATE-SELECT.
  6032             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6033             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6034
  6035         16  CF-EXCEPTION-LIST-IND          PIC X.
  6036             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6037
  6038         16  FILLER                         PIC X(318).
  6039
  6040****************************************************************
  6041*                  EXCEPTION REPORTING RECORD                  *
  6042****************************************************************
  6043
  6044     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6045         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6046             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6047
  6048         16  CF-COMBINED-LIFE-AH-OPT.
  6049             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6050             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6051             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6052             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6053
  6054         16  CF-LIFE-OPT.
  6055             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6056             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6057             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6058             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 112
* EL050.cbl
  6059             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6060             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6061             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6062             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6063             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6064             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6065
  6066         16  CF-AH-OPT.
  6067             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6068             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6069             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6070             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6071             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6072             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6073             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6074             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6075             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6076             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6077
  6078         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6079             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6080             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6081             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6082
  6083         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6084
  6085         16  FILLER                         PIC X(673).
  6086
  6087
  6088****************************************************************
  6089*             MORTGAGE SYSTEM PLAN RECORD                      *
  6090****************************************************************
  6091
  6092     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6093         16  CF-PLAN-TYPE                   PIC X.
  6094             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6095             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6096             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6097         16  CF-PLAN-ABBREV                 PIC XXX.
  6098         16  CF-PLAN-DESCRIPT               PIC X(10).
  6099         16  CF-PLAN-NOTES                  PIC X(20).
  6100         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6101         16  CF-PLAN-UNDERWRITING.
  6102             20  CF-PLAN-TERM-DATA.
  6103                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6104                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6105             20  CF-PLAN-AGE-DATA.
  6106                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6107                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6108                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6109             20  CF-PLAN-BENEFIT-DATA.
  6110                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6111                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6112                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6113                                            PIC S9(7)V99  COMP-3.
  6114         16  CF-PLAN-POLICY-FORMS.
  6115             20  CF-POLICY-FORM             PIC X(12).
  6116             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 113
* EL050.cbl
  6117             20  CF-MASTER-POLICY           PIC X(12).
  6118         16  CF-PLAN-RATING.
  6119             20  CF-RATE-CODE               PIC X(5).
  6120             20  CF-SEX-RATING              PIC X.
  6121                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6122                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6123             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6124             20  CF-SUB-STD-TYPE            PIC X.
  6125                 88  CF-PCT-OF-PREM            VALUE '1'.
  6126                 88  CF-PCT-OF-BENE            VALUE '2'.
  6127         16  CF-PLAN-PREM-TOLERANCES.
  6128             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6129             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6130         16  CF-PLAN-PYMT-TOLERANCES.
  6131             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6132             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6133         16  CF-PLAN-MISC-DATA.
  6134             20  FILLER                     PIC X.
  6135             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6136             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6137         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6138         16  CF-PLAN-IND-GRP                PIC X.
  6139             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6140                                                     '1'.
  6141             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6142                                                     '2'.
  6143         16  CF-MIB-SEARCH-SW               PIC X.
  6144             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6145             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6146             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6147             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6148         16  CF-ALPHA-SEARCH-SW             PIC X.
  6149             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6150             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6151             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6152             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6153             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6154             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6155             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6156             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6157             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6158             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6159                                                     'A' 'B' 'C'
  6160                                                     'X' 'Y' 'Z'.
  6161         16  CF-EFF-DT-RULE-SW              PIC X.
  6162             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6163             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6164             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6165             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6166             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6167         16  FILLER                         PIC X(4).
  6168         16  CF-HEALTH-QUESTIONS            PIC X.
  6169             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6170         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6171         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6172         16  CF-PLAN-SNGL-JNT               PIC X.
  6173             88  CF-COMBINED-PLAN              VALUE 'C'.
  6174             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 114
* EL050.cbl
  6175             88  CF-SNGL-PLAN                  VALUE 'S'.
  6176         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6177         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6178         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6179         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6180         16  CF-RERATE-CNTL                 PIC  X.
  6181             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6182             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6183             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6184             88  CF-AUTO-RECALC                 VALUE '4'.
  6185         16  CF-BENEFIT-TYPE                PIC  X.
  6186             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6187             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6188         16  CF-POLICY-FEE                  PIC S999V99
  6189                                                    COMP-3.
  6190         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6191         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6192         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6193         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6194         16  FILLER                         PIC  X(32).
  6195         16  CF-TERMINATION-FORM            PIC  X(04).
  6196         16  FILLER                         PIC  X(08).
  6197         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6198                                                       COMP-3.
  6199         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6200         16  CF-ISSUE-LETTER                PIC  X(4).
  6201         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6202         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6203             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6204             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6205         16  CF-MP-REFUND-CALC              PIC X.
  6206             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6207             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6208             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6209             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6210             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6211             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6212             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6213             88  CF-MP-REFD-MEAN                VALUE '8'.
  6214         16  CF-ALT-RATE-CODE               PIC  X(5).
  6215
  6216
  6217         16  FILLER                         PIC X(498).
  6218****************************************************************
  6219*             MORTGAGE COMPANY MASTER RECORD                   *
  6220****************************************************************
  6221
  6222     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6223         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6224         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6225             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6226             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6227             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6228             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6229             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6230
  6231         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6232         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 115
* EL050.cbl
  6233         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6234         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6235         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6236
  6237         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6238             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6239         16  CF-MP-RECON-USE-IND            PIC X(1).
  6240             88  CF-MP-USE-RECON             VALUE 'Y'.
  6241         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6242             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6243         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6244             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6245             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6246         16  FILLER                         PIC X(1).
  6247         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6248             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6249         16  CF-MORTG-MIB-VERSION           PIC X.
  6250             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6251             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6252             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6253         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6254             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6255                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6256             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6257                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6258             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6259                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6260             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6261                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6262             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6263                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6264             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6265                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6266         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6267         16  FILLER                         PIC X(7).
  6268         16  CF-MORTG-DESTINATION-SYMBOL.
  6269             20  CF-MORTG-MIB-COMM          PIC X(5).
  6270             20  CF-MORTG-MIB-TERM          PIC X(5).
  6271         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6272             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6273         16  FILLER                         PIC X(03).
  6274         16  CF-MP-CHECK-NO-CONTROL.
  6275             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6276                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6277                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6278                                                ' ' LOW-VALUES.
  6279                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6280                                               VALUE '3'.
  6281         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6282         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6283         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6284             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6285                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6286             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6287                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6288             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6289                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6290             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 116
* EL050.cbl
  6291                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6292             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6293                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6294             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6295                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6296         16  CF-MORTG-BILLING-AREA.
  6297             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6298                                            PIC X.
  6299         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6300         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6301         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6302         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6303             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6304             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6305         16  FILLER                         PIC X.
  6306         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6307             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6308             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6309         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6310         16  FILLER                         PIC X(8).
  6311         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6312         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6313         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6314         16  CF-ACH-COMPANY-ID.
  6315             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6316                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6317                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6318                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6319             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6320         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6321             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6322         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6323             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6324             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6325         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6326         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6327         16  FILLER                         PIC X(536).
  6328
  6329****************************************************************
  6330*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6331****************************************************************
  6332
  6333     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6334         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6335             20  CF-FEMALE-HEIGHT.
  6336                 24  CF-FEMALE-FT           PIC 99.
  6337                 24  CF-FEMALE-IN           PIC 99.
  6338             20  CF-FEMALE-MIN-WT           PIC 999.
  6339             20  CF-FEMALE-MAX-WT           PIC 999.
  6340         16  FILLER                         PIC X(428).
  6341
  6342     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6343         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6344             20  CF-MALE-HEIGHT.
  6345                 24  CF-MALE-FT             PIC 99.
  6346                 24  CF-MALE-IN             PIC 99.
  6347             20  CF-MALE-MIN-WT             PIC 999.
  6348             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 117
* EL050.cbl
  6349         16  FILLER                         PIC X(428).
  6350******************************************************************
  6351*             AUTOMATIC ACTIVITY RECORD                          *
  6352******************************************************************
  6353     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6354         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6355             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6356             20  CF-SYS-LETTER-ID           PIC X(04).
  6357             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6358             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6359             20  CF-SYS-RESET-SW            PIC X(01).
  6360             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6361             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6362
  6363         16  FILLER                         PIC X(50).
  6364
  6365         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6366             20  CF-USER-ACTIVE-SW          PIC X(01).
  6367             20  CF-USER-LETTER-ID          PIC X(04).
  6368             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6369             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6370             20  CF-USER-RESET-SW           PIC X(01).
  6371             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6372             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6373             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6374
  6375         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 118
* EL050.cbl
  6377*    COPY ERCACCT.
  6378******************************************************************
  6379*                                                                *
  6380*                                                                *
  6381*                            ERCACCT                             *
  6382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6383*                            VMOD=2.031                          *
  6384*                                                                *
  6385*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6386*                                                                *
  6387*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6388*   VSAM ACCOUNT MASTER FILES.                                   *
  6389*                                                                *
  6390*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6391*                                                                *
  6392*   FILE TYPE = VSAM,KSDS                                        *
  6393*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6394*                                                                *
  6395*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6396*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6397*                                                                *
  6398*   LOG = NO                                                     *
  6399*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6400*                                                                *
  6401*                                                                *
  6402******************************************************************
  6403*                   C H A N G E   L O G
  6404*
  6405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6406*-----------------------------------------------------------------
  6407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6408* EFFECTIVE    NUMBER
  6409*-----------------------------------------------------------------
  6410* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6411* 092705    2005050300006  PEMA  ADD SPP LEASES
  6412* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6413* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6414* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6415* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6416* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6417******************************************************************
  6418
  6419 01  ACCOUNT-MASTER.
  6420     12  AM-RECORD-ID                      PIC XX.
  6421         88  VALID-AM-ID                      VALUE 'AM'.
  6422
  6423     12  AM-CONTROL-PRIMARY.
  6424         16  AM-COMPANY-CD                 PIC X.
  6425         16  AM-MSTR-CNTRL.
  6426             20  AM-CONTROL-A.
  6427                 24  AM-CARRIER            PIC X.
  6428                 24  AM-GROUPING.
  6429                     28 AM-GROUPING-PREFIX PIC XXX.
  6430                     28 AM-GROUPING-PRIME  PIC XXX.
  6431                 24  AM-STATE              PIC XX.
  6432                 24  AM-ACCOUNT.
  6433                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6434                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 119
* EL050.cbl
  6435             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6436                                           PIC X(19).
  6437             20  AM-CNTRL-B.
  6438                 24  AM-EXPIRATION-DT      PIC XX.
  6439                 24  FILLER                PIC X(4).
  6440             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6441                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6442
  6443     12  AM-CONTROL-BY-VAR-GRP.
  6444         16  AM-COMPANY-CD-A1              PIC X.
  6445         16  AM-VG-CARRIER                 PIC X.
  6446         16  AM-VG-GROUPING                PIC X(6).
  6447         16  AM-VG-STATE                   PIC XX.
  6448         16  AM-VG-ACCOUNT                 PIC X(10).
  6449         16  AM-VG-DATE.
  6450             20  AM-VG-EXPIRATION-DT       PIC XX.
  6451             20  FILLER                    PIC X(4).
  6452         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6453                                           PIC 9(11)      COMP-3.
  6454     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6455         16  FILLER                        PIC X(10).
  6456         16  AM-VG-KEY3.
  6457             20  AM-VG3-ACCOUNT            PIC X(10).
  6458             20  AM-VG3-EXP-DT             PIC XX.
  6459         16  FILLER                        PIC X(4).
  6460     12  AM-MAINT-INFORMATION.
  6461         16  AM-LAST-MAINT-DT              PIC XX.
  6462         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6463         16  AM-LAST-MAINT-USER            PIC X(4).
  6464         16  FILLER                        PIC XX.
  6465
  6466     12  AM-EFFECTIVE-DT                   PIC XX.
  6467     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6468
  6469     12  AM-PREV-DATES  COMP-3.
  6470         16  AM-PREV-EXP-DT                PIC 9(11).
  6471         16  AM-PREV-EFF-DT                PIC 9(11).
  6472
  6473     12  AM-REPORT-CODE-1                  PIC X(10).
  6474     12  AM-REPORT-CODE-2                  PIC X(10).
  6475
  6476     12  AM-CITY-CODE                      PIC X(4).
  6477     12  AM-COUNTY-PARISH                  PIC X(6).
  6478
  6479     12  AM-NAME                           PIC X(30).
  6480     12  AM-PERSON                         PIC X(30).
  6481     12  AM-ADDRS                          PIC X(30).
  6482     12  AM-CITY.
  6483         16  AM-ADDR-CITY                  PIC X(28).
  6484         16  AM-ADDR-STATE                 PIC XX.
  6485     12  AM-ZIP.
  6486         16  AM-ZIP-PRIME.
  6487             20  AM-ZIP-PRI-1ST            PIC X.
  6488                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6489             20  FILLER                    PIC X(4).
  6490         16  AM-ZIP-PLUS4                  PIC X(4).
  6491     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6492         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 120
* EL050.cbl
  6493         16  AM-CAN-POSTAL-2               PIC XXX.
  6494         16  FILLER                        PIC XXX.
  6495     12  AM-TEL-NO.
  6496         16  AM-AREA-CODE                  PIC 999.
  6497         16  AM-TEL-PRE                    PIC 999.
  6498         16  AM-TEL-NBR                    PIC 9(4).
  6499     12  AM-TEL-LOC                        PIC X.
  6500         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6501         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6502
  6503     12  AM-COMM-STRUCTURE.
  6504         16  AM-DEFN-1.
  6505             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6506                 24  AM-AGT.
  6507                     28  AM-AGT-PREFIX     PIC X(4).
  6508                     28  AM-AGT-PRIME      PIC X(6).
  6509                 24  AM-COM-TYP            PIC X.
  6510                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6511                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6512                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6513                 24  AM-RECALC-LV-INDIC    PIC X.
  6514                 24  AM-RETRO-LV-INDIC     PIC X.
  6515                 24  AM-GL-CODES           PIC X.
  6516                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6517                 24  FILLER                PIC X(01).
  6518         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6519             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6520                 24  FILLER                PIC X(11).
  6521                 24  AM-L-COMA             PIC XXX.
  6522                 24  AM-J-COMA             PIC XXX.
  6523                 24  AM-A-COMA             PIC XXX.
  6524                 24  FILLER                PIC X(6).
  6525
  6526     12  AM-COMM-CHANGE-STATUS             PIC X.
  6527         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6528
  6529     12  AM-CSR-CODE                       PIC X(4).
  6530
  6531     12  AM-BILLING-STATUS                 PIC X.
  6532         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6533         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6534     12  AM-AUTO-REFUND-SW                 PIC X.
  6535         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6536         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6537     12  AM-GPCD                           PIC 99.
  6538     12  AM-IG                             PIC X.
  6539         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6540         88  AM-HAS-GROUP                     VALUE '2'.
  6541     12  AM-STATUS                         PIC X.
  6542         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6543         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6544         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6545         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6546         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6547         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6548     12  AM-REMIT-TO                       PIC 99.
  6549     12  AM-ID-NO                          PIC X(11).
  6550
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 121
* EL050.cbl
  6551     12  AM-CAL-TABLE                      PIC XX.
  6552     12  AM-LF-DEVIATION                   PIC XXX.
  6553     12  AM-AH-DEVIATION                   PIC XXX.
  6554     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6555     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6556     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6557     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6558     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6559     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6560
  6561     12  AM-USER-FIELDS.
  6562         16  AM-FLD-1                      PIC XX.
  6563         16  AM-FLD-2                      PIC XX.
  6564         16  AM-FLD-3                      PIC XX.
  6565         16  AM-FLD-4                      PIC XX.
  6566         16  AM-FLD-5                      PIC XX.
  6567
  6568     12  AM-1ST-PROD-DATE.
  6569         16  AM-1ST-PROD-YR                PIC XX.
  6570         16  AM-1ST-PROD-MO                PIC XX.
  6571         16  AM-1ST-PROD-DA                PIC XX.
  6572     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6573     12  AM-CERTS-PURGED-DATE.
  6574         16  AM-PUR-YR                     PIC XX.
  6575         16  AM-PUR-MO                     PIC XX.
  6576         16  AM-PUR-DA                     PIC XX.
  6577     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6578     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6579     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6580     12  AM-INACTIVE-DATE.
  6581         16  AM-INA-MO                     PIC 99.
  6582         16  AM-INA-DA                     PIC 99.
  6583         16  AM-INA-YR                     PIC 99.
  6584     12  AM-AR-HI-CERT-DATE                PIC XX.
  6585
  6586     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6587     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6588
  6589     12  AM-OB-PAYMENT-MODE                PIC X.
  6590         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6591         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6592         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6593         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6594
  6595     12  AM-AH-ONLY-INDICATOR              PIC X.
  6596         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6597         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6598
  6599     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6600
  6601     12  AM-OVER-SHORT.
  6602         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6603         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6604
  6605     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6606     12  AM-DCC-CLP-STATE                  PIC XX.
  6607
  6608     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 122
* EL050.cbl
  6609     12  AM-RECALC-REIN                    PIC X.
  6610
  6611     12  AM-REI-TABLE                      PIC XXX.
  6612     12  AM-REI-ET-LF                      PIC X.
  6613     12  AM-REI-ET-AH                      PIC X.
  6614     12  AM-REI-PE-LF                      PIC X.
  6615     12  AM-REI-PE-AH                      PIC X.
  6616     12  AM-REI-PRT-ST                     PIC X.
  6617     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6618     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6619     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6620     12  AM-REI-GROUP-A                    PIC X(6).
  6621     12  AM-REI-MORT                       PIC X(4).
  6622     12  AM-REI-PRT-OW                     PIC X.
  6623     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6624     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6625     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6626     12  AM-REI-GROUP-B                    PIC X(6).
  6627
  6628     12  AM-TRUST-TYPE                     PIC X(2).
  6629
  6630     12  AM-EMPLOYER-STMT-USED             PIC X.
  6631     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6632
  6633     12  AM-STD-AH-TYPE                    PIC XX.
  6634     12  AM-EARN-METHODS.
  6635         16  AM-EARN-METHOD-R              PIC X.
  6636             88 AM-REF-RL-R78                 VALUE 'R'.
  6637             88 AM-REF-RL-PR                  VALUE 'P'.
  6638             88 AM-REF-RL-MEAN                VALUE 'M'.
  6639             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6640         16  AM-EARN-METHOD-L              PIC X.
  6641             88 AM-REF-LL-R78                 VALUE 'R'.
  6642             88 AM-REF-LL-PR                  VALUE 'P'.
  6643             88 AM-REF-LL-MEAN                VALUE 'M'.
  6644             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6645         16  AM-EARN-METHOD-A              PIC X.
  6646             88 AM-REF-AH-R78                 VALUE 'R'.
  6647             88 AM-REF-AH-PR                  VALUE 'P'.
  6648             88 AM-REF-AH-MEAN                VALUE 'M'.
  6649             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6650             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6651             88 AM-REF-AH-NET                 VALUE 'N'.
  6652
  6653     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6654     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6655     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6656
  6657     12  AM-RET-Y-N                        PIC X.
  6658     12  AM-RET-P-E                        PIC X.
  6659     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6660     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6661     12  AM-RET-GRP                        PIC X(6).
  6662     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6663         16  AM-POOL-PRIME                 PIC XXX.
  6664         16  AM-POOL-SUB                   PIC XXX.
  6665     12  AM-RETRO-EARNINGS.
  6666         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 123
* EL050.cbl
  6667         16  AM-RET-EARN-L                 PIC X.
  6668         16  AM-RET-EARN-A                 PIC X.
  6669     12  AM-RET-ST-TAX-USE                 PIC X.
  6670         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6671         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6672     12  AM-RETRO-BEG-EARNINGS.
  6673         16  AM-RET-BEG-EARN-R             PIC X.
  6674         16  AM-RET-BEG-EARN-L             PIC X.
  6675         16  AM-RET-BEG-EARN-A             PIC X.
  6676     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6677     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6678
  6679     12  AM-USER-SELECT-OPTIONS.
  6680         16  AM-USER-SELECT-1              PIC X(10).
  6681         16  AM-USER-SELECT-2              PIC X(10).
  6682         16  AM-USER-SELECT-3              PIC X(10).
  6683         16  AM-USER-SELECT-4              PIC X(10).
  6684         16  AM-USER-SELECT-5              PIC X(10).
  6685
  6686     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6687
  6688     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6689
  6690     12  AM-RPT045A-SWITCH                 PIC X.
  6691         88  RPT045A-OFF                   VALUE 'N'.
  6692
  6693     12  AM-INSURANCE-LIMITS.
  6694         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6695         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6696
  6697     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6698         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6699
  6700     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6701         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6702         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6703
  6704     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6705
  6706     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6707     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6708     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6709     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6710     12  AM-DCC-UEF-STATE                  PIC XX.
  6711     12  FILLER                            PIC XXX.
  6712     12  AM-REPORT-CODE-3                  PIC X(10).
  6713*    12  FILLER                            PIC X(22).
  6714
  6715     12  AM-RESERVE-DATE.
  6716         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6717         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6718         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6719
  6720     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6721     12  AM-NOTIFICATION-TYPES.
  6722         16  AM-NOTIF-OF-LETTERS           PIC X.
  6723         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6724         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 124
* EL050.cbl
  6725         16  AM-NOTIF-OF-STATUS            PIC X.
  6726
  6727     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6728         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6729         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6730         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6731         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6732
  6733     12  AM-BENEFIT-CONTROLS.
  6734         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6735             20  AM-BENEFIT-CODE           PIC XX.
  6736             20  AM-BENEFIT-TYPE           PIC X.
  6737             20  AM-BENEFIT-REVISION       PIC XXX.
  6738             20  AM-BENEFIT-REM-TERM       PIC X.
  6739             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6740             20  FILLER                    PIC XX.
  6741         16  FILLER                        PIC X(80).
  6742
  6743     12  AM-TRANSFER-DATA.
  6744         16  AM-TRANSFERRED-FROM.
  6745             20  AM-TRNFROM-CARRIER        PIC X.
  6746             20  AM-TRNFROM-GROUPING.
  6747                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6748                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6749             20  AM-TRNFROM-STATE          PIC XX.
  6750             20  AM-TRNFROM-ACCOUNT.
  6751                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6752                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6753             20  AM-TRNFROM-DTE            PIC XX.
  6754         16  AM-TRANSFERRED-TO.
  6755             20  AM-TRNTO-CARRIER          PIC X.
  6756             20  AM-TRNTO-GROUPING.
  6757                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6758                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6759             20  AM-TRNTO-STATE            PIC XX.
  6760             20  AM-TRNTO-ACCOUNT.
  6761                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6762                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6763             20  AM-TRNTO-DTE              PIC XX.
  6764         16  FILLER                        PIC X(10).
  6765
  6766     12  AM-SAVED-REMIT-TO                 PIC 99.
  6767
  6768     12  AM-COMM-STRUCTURE-SAVED.
  6769         16  AM-DEFN-1-SAVED.
  6770             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6771                 24  AM-AGT-SV             PIC X(10).
  6772                 24  AM-COM-TYP-SV         PIC X.
  6773                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6774                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6775                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6776                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6777                 24  FILLER                PIC X.
  6778                 24  AM-GL-CODES-SV        PIC X.
  6779                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6780                 24  FILLER                PIC X.
  6781         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6782             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 125
* EL050.cbl
  6783                 24  FILLER                PIC X(11).
  6784                 24  AM-L-COMA-SV          PIC XXX.
  6785                 24  AM-J-COMA-SV          PIC XXX.
  6786                 24  AM-A-COMA-SV          PIC XXX.
  6787                 24  FILLER                PIC X(6).
  6788
  6789     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6790         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6791            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6792            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6793            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6794
  6795     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6796     12  FILLER                            PIC X(120).
  6797
  6798     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6799         16  AM-CONTROL-NAME               PIC X(30).
  6800         16  AM-EXECUTIVE-ONE.
  6801             20  AM-EXEC1-NAME             PIC X(15).
  6802             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6803                                                          COMP-3.
  6804             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6805                                                          COMP-3.
  6806         16  AM-EXECUTIVE-TWO.
  6807             20  AM-EXEC2-NAME             PIC X(15).
  6808             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6809                                                          COMP-3.
  6810             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6811                                                          COMP-3.
  6812
  6813     12  AM-RETRO-ADDITIONAL-DATA.
  6814         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6815         16  AM-RETRO-PREM-P-E             PIC X.
  6816         16  AM-RETRO-CLMS-P-I             PIC X.
  6817         16  AM-RETRO-RET-BRACKET-LF.
  6818             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6819                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6820                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6821             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6822                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6823                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6824             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6825                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6826                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6827         16  AM-RETRO-RET-BRACKET-AH.
  6828             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6829                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6830                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6831                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6832             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6833                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6834                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6835             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6836                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6837                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6838
  6839     12  AM-COMMENTS.
  6840         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 126
* EL050.cbl
  6841
  6842     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6843         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6844         16  AM-FLI-BILLING-CODE           PIC X.
  6845         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6846         16  AM-FLI-UNITED-IDENT           PIC X.
  6847         16  AM-FLI-INTEREST-LOST-DATA.
  6848             20  AM-FLI-BANK-NO            PIC X(5).
  6849             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6850             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6851             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6852         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6853             20  AM-FLI-AGT                PIC X(9).
  6854             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6855             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6856         16  FILLER                        PIC X(102).
  6857
  6858     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6859         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6860             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6861             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6862             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6863             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6864             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6865         16  FILLER                          PIC X(10).
  6866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 127
* EL050.cbl
  6868*    COPY ERCREIN.
  6869******************************************************************
  6870*                                                                *
  6871*                            ERCREIN                             *
  6872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6873*                            VMOD=2.010                          *
  6874*                                                                *
  6875*   ONLINE CREDIT SYSTEM                                         *
  6876*                                                                *
  6877*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6878*                                                                *
  6879*   FILE TYPE = VSAM,KSDS                                        *
  6880*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6881*                                                                *
  6882*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6883*       ALTERNATE PATH = NONE                                    *
  6884*                                                                *
  6885*   LOG = NO                                                     *
  6886*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6887*                                                                *
  6888******************************************************************
  6889*                   C H A N G E   L O G
  6890*
  6891* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6892*-----------------------------------------------------------------
  6893*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6894* EFFECTIVE    NUMBER
  6895*-----------------------------------------------------------------
  6896* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6897* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6898******************************************************************
  6899 01  REINSURANCE-RECORD.
  6900     12  RE-RECORD-ID                      PIC XX.
  6901         88  VALID-RE-ID                      VALUE 'RE'.
  6902
  6903     12  RE-CONTROL-PRIMARY.
  6904         16  RE-COMPANY-CD                 PIC X.
  6905         16  RE-KEY.
  6906             20  RE-CODE                   PIC X.
  6907                 88  RE-TABLE-RECORD          VALUE 'A'.
  6908                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6909             20  RE-TABLE                  PIC XXX.
  6910             20  FILLER                    PIC XXX.
  6911         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6912             20  FILLER                    PIC X.
  6913             20  RE-COMPANY.
  6914                 24  RE-COMP-PRIME         PIC XXX.
  6915                 24  RE-COMP-SUB           PIC XXX.
  6916
  6917     12  RE-MAINT-INFORMATION.
  6918         16  RE-LAST-MAINT-DT              PIC XX.
  6919         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6920         16  RE-LAST-MAINT-USER            PIC X(4).
  6921         16  FILLER                        PIC X(10).
  6922
  6923     12  RE-TABLE-DATA.
  6924         16  RE-100-COMP                   PIC 99.
  6925
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 128
* EL050.cbl
  6926         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6927             20  RE-REI-COMP-NO.
  6928                 24  RE-REI-COMP           PIC XXX.
  6929                 24  RE-REI-COMP-SUB       PIC XXX.
  6930             20  RE-LF-QC                  PIC X.
  6931             20  RE-AH-QC                  PIC X.
  6932             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6933             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6934             20  RE-LFAGE-LO               PIC 99.
  6935             20  RE-LFAGE-HI               PIC 99.
  6936             20  RE-AHAGE-LO               PIC 99.
  6937             20  RE-AHAGE-HI               PIC 99.
  6938             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6939             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6940             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6941             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6942             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6943             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6944             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6945             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6946             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6947             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6948             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6949             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6950             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6951             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6952             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6953             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6954             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6955             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6956             20  RE-LF-BEN-CODE            PIC X.
  6957             20  RE-AH-BEN-CODE            PIC X.
  6958             20  RE-INTERACTIVE            PIC X.
  6959             20  RE-REMAINING              PIC X.
  6960             20  RE-LF-RUNOFF-SW           PIC X.
  6961             20  RE-AH-RUNOFF-SW           PIC X.
  6962             20  FILLER                    PIC X(19).
  6963
  6964         16  RE-COMP-INFO-END              PIC X(6).
  6965         16  RE-NSP-ST-CD-LF               PIC XX.
  6966         16  RE-NSP-ST-CD-AH               PIC XX.
  6967         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6968             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6969
  6970         16  FILLER                        PIC X(27).
  6971
  6972     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6973         16  RE-NAME                       PIC X(30).
  6974         16  RE-LF-PE                      PIC X.
  6975         16  RE-AH-PE                      PIC X.
  6976         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6977         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6978         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6979         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6980         16  RE-PRT-ST                     PIC X.
  6981         16  RE-PRT-OW                     PIC X.
  6982         16  RE-MORT-CODE                  PIC X(4).
  6983         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 129
* EL050.cbl
  6984         16  RE-ZERO-LF-FEE                PIC X.
  6985         16  RE-ZERO-AH-FEE                PIC X.
  6986         16  RE-CEDE-NAME                  PIC X(30).
  6987         16  RE-LF-COMM                    PIC X.
  6988         16  RE-AH-COMM                    PIC X.
  6989         16  RE-LF-TAX                     PIC X.
  6990         16  RE-AH-TAX                     PIC X.
  6991         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6992         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6993         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6994
  6995         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6996             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6997
  6998         16  RE-LF-CEDING-FEE-BRACKETS.
  6999             20  RE-LF-FEE-METHOD          PIC X.
  7000                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7001                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7002                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7003                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7004             20  RE-LF-FEE-BASIS           PIC X.
  7005                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7006                 88  RE-LF-NET-CEDED               VALUE '2'.
  7007                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7008                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7009                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7010                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7011                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7012                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7013             20  FILLER                    PIC XXX.
  7014             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7015                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7016                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7017
  7018         16  RE-AH-CEDING-FEE-BRACKETS.
  7019             20  RE-AH-FEE-METHOD          PIC X.
  7020                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7021                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7022                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7023                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7024             20  RE-AH-FEE-BASIS           PIC X.
  7025                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7026                 88  RE-AH-NET-CEDED               VALUE '2'.
  7027                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7028                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7029                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7030                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7031                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7032                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7033             20  FILLER                    PIC XXX.
  7034             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7035                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7036                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7037
  7038         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7039
  7040         16  RE-OLD-CEDING-STMT            PIC X.
  7041
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 130
* EL050.cbl
  7042         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7043         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7044         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7045         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7046         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7047         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7048         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7049         16  RE-MORT-SW                    PIC X.
  7050         16  RE-CEDING-TYPE-FLAG           PIC X.
  7051             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7052             88  RE-CEDED                          VALUE 'C'.
  7053             88  RE-ASSUMED                        VALUE 'A'.
  7054             88  RE-PHANTOM                        VALUE 'P'.
  7055
  7056         16  RE-CEDING-STMT-OPT-A          PIC X.
  7057             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7058         16  RE-CEDING-STMT-OPT-B          PIC X.
  7059             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7060         16  RE-CEDING-STMT-OPT-C          PIC X.
  7061             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7062         16  RE-CEDING-STMT-OPT-D          PIC X.
  7063             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7064         16  RE-CEDING-STMT-OPT-E          PIC X.
  7065             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7066
  7067         16  RE-PRT-CRSV                   PIC X.
  7068
  7069         16  RE-GL-CENTER                  PIC X(4).
  7070
  7071         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7072
  7073         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7074
  7075         16  RE-EARN-STOP-CODE             PIC X.
  7076             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7077             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7078
  7079         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7080             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7081
  7082         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7083         16  FILLER                        PIC X(2281).
  7084
  7085         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7086
  7087******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 131
* EL050.cbl
  7089*    COPY ERCCTBL.
  7090******************************************************************
  7091*                                                                *
  7092*                                                                *
  7093*                            ERCCTBL                             *
  7094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7095*                            VMOD=2.003
  7096*                                                                *
  7097*   ONLINE CREDIT SYSTEM                                         *
  7098*                                                                *
  7099*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7100*                                                                *
  7101*   FILE TYPE = VSAM,KSDS                                        *
  7102*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7103*                                                                *
  7104*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7105*       ALTERNATE PATH = NONE                                    *
  7106*                                                                *
  7107*   LOG = NO                                                     *
  7108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7109*                                                                *
  7110*                                                                *
  7111******************************************************************
  7112
  7113 01  COMM-TABLE-RECORD.
  7114     12  CT-RECORD-ID                      PIC XX.
  7115         88  VALID-CT-ID                      VALUE 'CT'.
  7116
  7117     12  CT-CONTROL-PRIMARY.
  7118         16  CT-COMPANY-CD                 PIC X.
  7119         16  CT-TABLE                      PIC XXX.
  7120         16  CT-CNTRL-2.
  7121             20  CT-BEN-TYPE               PIC X.
  7122             20  CT-BEN-CODE               PIC XX.
  7123
  7124     12  CT-MAINT-INFORMATION.
  7125         16  CT-LAST-MAINT-DT              PIC XX.
  7126         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7127         16  CT-LAST-MAINT-USER            PIC X(4).
  7128         16  FILLER                        PIC X(31).
  7129
  7130     12  CT-LIMITS.
  7131         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7132
  7133         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7134
  7135         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7136
  7137     12  CT-RATES.
  7138         16  CT-RTX          OCCURS 27 TIMES.
  7139             20  CT-RT                     PIC SV9(5)     COMP-3.
  7140             20  CT-RT-R   REDEFINES
  7141                 CT-RT                     PIC XXX.
  7142
  7143     12  FILLER                            PIC  X(42).
  7144
  7145******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 132
* EL050.cbl
  7147*    COPY ERCFORM.
  7148******************************************************************
  7149*                                                                *
  7150*                                                                *
  7151*                            ERCFORM.                            *
  7152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7153*                            VMOD=2.003                          *
  7154*                                                                *
  7155*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7156*                                                                *
  7157*    FILE TYPE = VSAM,KSDS                                       *
  7158*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7159*                                                                *
  7160*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7161*                                                                *
  7162*    LOG = YES                                                   *
  7163*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7164******************************************************************
  7165 01  FORM-MASTER.
  7166    12  FO-RECORD-ID                 PIC X(02).
  7167        88  VALID-FO-ID                  VALUE 'FO'.
  7168
  7169    12  FO-CONTROL-PRIMARY.
  7170        16  FO-COMPANY-CD            PIC X(01).
  7171        16  FO-STATE                 PIC X(02).
  7172        16  FO-FORM-ID               PIC X(12).
  7173        16  FO-FORM-EXP-DT           PIC X(02).
  7174
  7175    12  FO-POLICY-FORM-DATA.
  7176        16  FO-IND-GRP-CD            PIC X(01).
  7177        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7178        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7179        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7180        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7181        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7182        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7183        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7184        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7185        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7186        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7187        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7188        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7189        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7190        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7191        16  FO-APP-CERT-USE-CD       PIC X(01).
  7192
  7193    12  FILLER                       PIC X(29).
  7194
  7195    12  FO-FORM-PLAN-TABLE.
  7196        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7197            20  FO-PLAN-TYPE         PIC X(01).
  7198            20  FO-PLAN-ID           PIC X(02).
  7199            20  FO-PLAN-TERM         PIC 9(03).
  7200            20  FO-PLAN-REFUND-METHOD
  7201                                     PIC X.
  7202
  7203    12  FILLER                       PIC X(30).
  7204
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 133
* EL050.cbl
  7205    12  FO-COMMENTS-AREA.
  7206        16  FO-COMMENT-LINE-1        PIC X(78).
  7207
  7208    12  FILLER                       PIC X(20).
  7209
  7210    12  FO-MAINT-INFORMATION.
  7211        16  FO-LAST-MAINT-DT         PIC X(02).
  7212        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7213        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 134
* EL050.cbl
  7215*    COPY ELCMSTR.
  7216******************************************************************
  7217*                                                                *
  7218*                            ELCMSTR.                            *
  7219*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7220*                            VMOD=2.012                          *
  7221*                                                                *
  7222*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7223*                                                                *
  7224*   FILE TYPE = VSAM,KSDS                                        *
  7225*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7226*                                                                *
  7227*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7228*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7229*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7230*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7231*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7232*                                                 RKP=75,LEN=21  *
  7233*                                                                *
  7234*   **** NOTE ****                                               *
  7235*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7236*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7237*                                                                *
  7238*   LOG = YES                                                    *
  7239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7240******************************************************************
  7241*                   C H A N G E   L O G
  7242*
  7243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7244*-----------------------------------------------------------------
  7245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7246* EFFECTIVE    NUMBER
  7247*-----------------------------------------------------------------
  7248* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7249* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7250******************************************************************
  7251 01  CLAIM-MASTER.
  7252     12  CL-RECORD-ID                PIC XX.
  7253         88  VALID-CL-ID         VALUE 'CL'.
  7254
  7255     12  CL-CONTROL-PRIMARY.
  7256         16  CL-COMPANY-CD           PIC X.
  7257         16  CL-CARRIER              PIC X.
  7258         16  CL-CLAIM-NO             PIC X(7).
  7259         16  CL-CERT-NO.
  7260             20  CL-CERT-PRIME       PIC X(10).
  7261             20  CL-CERT-SFX         PIC X.
  7262
  7263     12  CL-CONTROL-BY-NAME.
  7264         16  CL-COMPANY-CD-A1        PIC X.
  7265         16  CL-INSURED-LAST-NAME    PIC X(15).
  7266         16  CL-INSURED-NAME.
  7267             20  CL-INSURED-1ST-NAME PIC X(12).
  7268             20  CL-INSURED-MID-INIT PIC X.
  7269
  7270     12  CL-CONTROL-BY-SSN.
  7271         16  CL-COMPANY-CD-A2        PIC X.
  7272         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 135
* EL050.cbl
  7273             20  CL-SSN-STATE        PIC XX.
  7274             20  CL-SSN-ACCOUNT      PIC X(6).
  7275             20  CL-SSN-LN3          PIC X(3).
  7276
  7277     12  CL-CONTROL-BY-CERT-NO.
  7278         16  CL-COMPANY-CD-A4        PIC X.
  7279         16  CL-CERT-NO-A4.
  7280             20  CL-CERT-A4-PRIME    PIC X(10).
  7281             20  CL-CERT-A4-SFX      PIC X.
  7282
  7283     12  CL-CONTROL-BY-CCN.
  7284         16  CL-COMPANY-CD-A5        PIC X.
  7285         16  CL-CCN-A5.
  7286             20  CL-CCN.
  7287                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7288                 24  CL-CCN-PRIME-A5 PIC X(12).
  7289             20  CL-CCN-FILLER-A5    PIC X(4).
  7290
  7291     12  CL-INSURED-PROFILE-DATA.
  7292         16  CL-INSURED-BIRTH-DT     PIC XX.
  7293         16  CL-INSURED-SEX-CD       PIC X.
  7294             88  INSURED-IS-MALE        VALUE 'M'.
  7295             88  INSURED-IS-FEMALE      VALUE 'F'.
  7296             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7297         16  CL-INSURED-OCC-CD       PIC X(6).
  7298         16  FILLER                  PIC X(5).
  7299
  7300     12  CL-PROCESSING-INFO.
  7301         16  CL-PROCESSOR-ID         PIC X(4).
  7302         16  CL-CLAIM-STATUS         PIC X.
  7303             88  CLAIM-IS-OPEN          VALUE 'O'.
  7304             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7305         16  CL-CLAIM-TYPE           PIC X.
  7306*            88  AH-CLAIM               VALUE 'A'.
  7307*            88  LIFE-CLAIM             VALUE 'L'.
  7308*            88  PROPERTY-CLAIM         VALUE 'P'.
  7309*            88  IUI-CLAIM              VALUE 'I'.
  7310*            88  GAP-CLAIM              VALUE 'G'.
  7311         16  CL-CLAIM-PREM-TYPE      PIC X.
  7312             88  SINGLE-PREMIUM         VALUE '1'.
  7313             88  O-B-COVERAGE           VALUE '2'.
  7314             88  OPEN-END-COVERAGE      VALUE '3'.
  7315         16  CL-INCURRED-DT          PIC XX.
  7316         16  CL-REPORTED-DT          PIC XX.
  7317         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7318         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7319         16  CL-LAST-PMT-DT          PIC XX.
  7320         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7321         16  CL-PAID-THRU-DT         PIC XX.
  7322         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7323         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7324         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7325         16  CL-PMT-CALC-METHOD      PIC X.
  7326             88  CL-360-DAY-YR          VALUE '1'.
  7327             88  CL-365-DAY-YR          VALUE '2'.
  7328             88  CL-FULL-MONTHS         VALUE '3'.
  7329         16  CL-CAUSE-CD             PIC X(6).
  7330
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 136
* EL050.cbl
  7331         16  CL-PRIME-CERT-NO.
  7332             20  CL-PRIME-CERT-PRIME PIC X(10).
  7333             20  CL-PRIME-CERT-SFX   PIC X.
  7334
  7335         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7336             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7337             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7338
  7339         16  CL-MICROFILM-NO         PIC X(10).
  7340         16  CL-PROG-FORM-TYPE       PIC X.
  7341         16  CL-LAST-ADD-ON-DT       PIC XX.
  7342
  7343         16  CL-LAST-REOPEN-DT       PIC XX.
  7344         16  CL-LAST-CLOSE-DT        PIC XX.
  7345         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7346             88  FINAL-PAID             VALUE '1'.
  7347             88  CLAIM-DENIED           VALUE '2'.
  7348             88  AUTO-CLOSE             VALUE '3'.
  7349             88  MANUAL-CLOSE           VALUE '4'.
  7350             88  BENEFITS-CHANGED       VALUE 'C'.
  7351             88  SETUP-ERRORS           VALUE 'E'.
  7352         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7353         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7354         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7355             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7356         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7357         16  FILLER                  PIC X.
  7358
  7359     12  CL-CERTIFICATE-DATA.
  7360         16  CL-CERT-ORIGIN          PIC X.
  7361             88  CERT-WAS-ONLINE        VALUE '1'.
  7362             88  CERT-WAS-CREATED       VALUE '2'.
  7363             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7364         16  CL-CERT-KEY-DATA.
  7365             20  CL-CERT-CARRIER     PIC X.
  7366             20  CL-CERT-GROUPING    PIC X(6).
  7367             20  CL-CERT-STATE       PIC XX.
  7368             20  CL-CERT-ACCOUNT.
  7369                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7370                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7371             20  CL-CERT-EFF-DT      PIC XX.
  7372
  7373     12  CL-STATUS-CONTROLS.
  7374         16  CL-PRIORITY-CD          PIC X.
  7375             88  CONFIDENTIAL-DATA      VALUE '8'.
  7376             88  HIGHEST-PRIORITY       VALUE '9'.
  7377         16  CL-SUPV-ATTN-CD         PIC X.
  7378             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7379             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7380         16  CL-PURGED-DT            PIC XX.
  7381         16  CL-RESTORED-DT          PIC XX.
  7382         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7383         16  CL-NEXT-RESEND-DT       PIC XX.
  7384         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7385         16  FILLER                  PIC XX.
  7386         16  CL-LAST-MAINT-DT        PIC XX.
  7387         16  CL-LAST-MAINT-USER      PIC X(4).
  7388         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 137
* EL050.cbl
  7389         16  CL-LAST-MAINT-TYPE      PIC X.
  7390             88  CLAIM-SET-UP           VALUE ' '.
  7391             88  PAYMENT-MADE           VALUE '1'.
  7392             88  LETTER-SENT            VALUE '2'.
  7393             88  MASTER-WAS-ALTERED     VALUE '3'.
  7394             88  MASTER-WAS-RESTORED    VALUE '4'.
  7395             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7396             88  FILE-CONVERTED         VALUE '6'.
  7397             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7398             88  ERROR-CORRECTION       VALUE 'E'.
  7399         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7400         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7401         16  CL-BENEFICIARY          PIC X(10).
  7402         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7403         16  CL-DENIAL-TYPE          PIC X.
  7404             88  CL-TYPE-DENIAL          VALUE '1'.
  7405             88  CL-TYPE-RESCISSION      VALUE '2'.
  7406             88  CL-TYPE-REFORMATION     VALUE '3'.
  7407             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7408             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7409         16  FILLER                  PIC X(5).
  7410
  7411     12  CL-TRAILER-CONTROLS.
  7412         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7413             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7414             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7415             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7416         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7417         16  FILLER                  PIC XX.
  7418         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7419         16  CL-ADDRESS-TRAILER-CNT.
  7420             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7421                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7422             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7423                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7424             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7425                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7426             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7427                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7428             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7429                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7430             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7431                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7432             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7433                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7434
  7435     12  CL-CV-REFERENCE-NO.
  7436         16  CL-CV-REFNO-PRIME       PIC X(18).
  7437         16  CL-CV-REFNO-SFX         PIC XX.
  7438
  7439     12  CL-FILE-LOCATION            PIC X(4).
  7440
  7441     12  CL-PROCESS-ERRORS.
  7442         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7443             88  NO-FATAL-ERRORS        VALUE ZERO.
  7444         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7445             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7446
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 138
* EL050.cbl
  7447     12  CL-PRODUCT-CD               PIC X.
  7448
  7449     12  CL-CURRENT-KEY-DATA.
  7450         16  CL-CURRENT-CARRIER      PIC X.
  7451         16  CL-CURRENT-GROUPING     PIC X(6).
  7452         16  CL-CURRENT-STATE        PIC XX.
  7453         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7454
  7455     12  CL-ASSOCIATES               PIC X.
  7456         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7457         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7458         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7459         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7460
  7461     12  CL-ACTIVITY-CODE            PIC 99.
  7462     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7463     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7464
  7465     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7466     12  CL-LAG-REPORT-CODE          PIC 9.
  7467     12  CL-LOAN-TYPE                PIC XX.
  7468     12  CL-LEGAL-STATE              PIC XX.
  7469
  7470*    12  FILLER                      PIC X(5).
  7471     12  CL-YESNOSW                  PIC X.
  7472     12  FILLER                      PIC X(4).
  7473
  7474 01  PLAN-RECORDS.
  7475     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7476     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7477
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 139
* EL050.cbl
  7479 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7480                          ACCOUNT-MASTER REINSURANCE-RECORD
  7481                          COMM-TABLE-RECORD FORM-MASTER
  7482                          CLAIM-MASTER PLAN-RECORDS.
  7483 0000-DFHEXIT SECTION.
  7484     MOVE '9#                    $   ' TO DFHEIV0.
  7485     MOVE 'EL050' TO DFHEIV1.
  7486     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7487
  7488     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7489
  7490
  7491* EXEC CICS  HANDLE CONDITION
  7492*           ERROR    (9300-ABEND)
  7493*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7494*    END-EXEC.
  7495*    MOVE '"$.J                  ! " #00007486' TO DFHEIV0
  7496     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7498     MOVE X'2220233030303037343836' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0
  7500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7501
  7502
  7503 0000-COPY-PROCEDURE-DIV.
  7504*                          COPY ELC50PD.
  7505******************************************************************
  7506*                                                                *
  7507*                            ELC50PD                             *
  7508*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7509*                            VMOD=2.188                          *
  7510*                                                                *
  7511******************************************************************
  7512*                   C H A N G E   L O G
  7513*
  7514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7515*-----------------------------------------------------------------
  7516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7517* EFFECTIVE    NUMBER
  7518*-----------------------------------------------------------------
  7519* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7520* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7521* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7522*                             2709 AND 2718
  7523* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7524* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7525* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7526* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7527* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7528*                                IS OPEN OR CNC DT < PD THRU
  7529* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7530* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7531* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7532* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7533* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7534* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7535* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7536* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 140
* EL050.cbl
  7537* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7538* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7539* 020906                   PEMA  EXPAND LOAN OFFICER
  7540* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7541* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7542* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7543* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7544* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7545* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7546* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7547* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7548* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7549* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7550* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7551* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7552* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7553* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7554* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7555* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7556* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7557* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7558* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7559* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7560* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7561* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7562* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7563* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7564* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7565*                                UPDATE VIN ON CERT TRAILER
  7566* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7567* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7568* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7569* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7570* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7571* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7572* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7573* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7574* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7575* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7576* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7577* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7578* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7579* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7580* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7581* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7582* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7583* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7584* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7585* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7586* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7587* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7588* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7589* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7590* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7591* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7592* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7593* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7594* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 141
* EL050.cbl
  7595* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7596* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7597* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7598* 032912  CR2011110200001  PEMA  AHL CHANGES
  7599* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7600* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7601* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7602* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7603* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7604* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7605* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7606* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7607* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7608* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7609******************************************************************
  7610************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7611******************************************************************
  7612
  7613     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7614
  7615     MOVE SPACES                 TO PB-FATAL-FLAG
  7616                                    PB-FORCE-ER-CD
  7617                                    PB-WARN-ER-CD
  7618                                    PB-OUT-BAL-CD.
  7619
  7620     MOVE SPACE                  TO WS-IG-OVRD-AH
  7621                                    WS-IG-OVRD-LF
  7622                                    WS-IG-OVRD-AM
  7623                                    WS-IG-OVRD
  7624                                    WS-IG-OVRD-AH-PL
  7625                                    WS-IG-OVRD-LF-PL
  7626                                    WS-IG-OVRD-AH-BEN
  7627                                    WS-IG-OVRD-LF-BEN.
  7628
  7629******************************************************************
  7630*************       INITIALIZE COMMON ERRORS       ***************
  7631******************************************************************
  7632
  7633     MOVE +0                     TO PB-NO-OF-ERRORS.
  7634     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7635
  7636******************************************************************
  7637
  7638     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7639     SET JULIAN-TO-BIN           TO TRUE.
  7640*    MOVE 5                      TO DC-OPTION-CODE.
  7641     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7642     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7643
  7644     MOVE ZERO                   TO  SUB4.
  7645
  7646 0040-INITIALIZE-GA-BILL-DT.
  7647
  7648     ADD +1                      TO  SUB4.
  7649
  7650     IF  SUB4 GREATER THAN +5
  7651         GO TO 0050-CHECK-CNTL-FOUND.
  7652
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 142
* EL050.cbl
  7653     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7654         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7655
  7656     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7657
  7658 0050-CHECK-CNTL-FOUND.
  7659
  7660     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7661        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7662                                         WS-AH-REM-TERM-CALC
  7663                                         EC-CO-REM-TERM-CALC
  7664        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7665        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7666        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7667                                         WS-TOL-AH-CLAIM
  7668        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7669                                         WS-TOL-AH-PREM
  7670                                         EC-CO-TOL-PREM
  7671        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7672                                         WS-TOL-AH-REFUND
  7673                                         EC-CO-TOL-REFUND
  7674        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7675                                         WS-AH-REFUND-OVS-AMT
  7676                                         EC-CO-OVR-SHT-AMT
  7677        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7678                                         WS-TOL-AH-PREM-PCT
  7679                                         EC-CO-TOL-PREM-PCT
  7680        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7681                                         WS-TOL-AH-REFUND-PCT
  7682                                         EC-CO-TOL-REFUND-PCT
  7683        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7684                                         WS-AH-REFUND-OVS-PCT
  7685                                         EC-CO-OVR-SHT-PCT
  7686        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7687        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7688        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7689        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7690        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7691        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7692        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7693        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7694        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7695        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7696        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7697        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7698                                         EC-CO-MONTH-END-DT
  7699        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7700          GO TO 0100-READ-ACCT.
  7701
  7702     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7703     MOVE SPACES                 TO CNTL-ACCESS.
  7704     MOVE '1'                    TO CNTL-REC-TYPE.
  7705     MOVE +0                     TO CNTL-SEQ-NO.
  7706
  7707     MOVE '1' TO RC-SW-1.
  7708     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7709     IF NOT CF-COMPANY-MASTER
  7710         MOVE ZEROS             TO WK-CO-TOL-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 143
* EL050.cbl
  7711                                   WK-CO-TOL-CLAIM
  7712                                   WK-CO-TOL-REFUND
  7713                                   WK-REFUND-OVS-AMT
  7714                                   WK-REFUND-OVS-PCT
  7715                                   WK-CO-TOL-PREM-PCT
  7716                                   WK-CO-TOL-REFUND-PCT
  7717                                   WK-DEFAULT-APR
  7718                                   WK-CO-MAX-CAP
  7719        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7720                                   WK-CR-R78-METHOD
  7721                                   WK-CO-REF-REJECT-SW
  7722                                   WK-CO-PREM-REJECT-SW
  7723                                   WK-REM-TRM-CALC-OPTION
  7724                                   WK-BIRTH-DATE-INPUT
  7725                                   WK-JOINT-AGE-INPUT
  7726        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7727        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7728        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7729        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7730          GO TO 0099-COMPANY-NOT-FOUND.
  7731
  7732     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7733        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7734     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7735        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7736     IF CF-CO-TOL-CAP NOT NUMERIC
  7737        MOVE +0                    TO CF-CO-TOL-CAP.
  7738     IF CF-DEFAULT-APR NOT NUMERIC
  7739        MOVE +0                    TO CF-DEFAULT-APR.
  7740
  7741     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7742     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7743     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7744     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7745     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7746     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7747     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7748     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7749     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7750     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7751     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7752     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7753
  7754     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7755          CF-CO-OVR-SHT-AMT > +0
  7756        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7757
  7758     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7759          CF-CO-OVR-SHT-PCT > +0
  7760        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7761
  7762     IF CF-VALID-REM-TRM-OPTION
  7763         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7764     ELSE
  7765         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7766
  7767     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7768     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 144
* EL050.cbl
  7769     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7770     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7771
  7772     GO TO 0050-CHECK-CNTL-FOUND.
  7773
  7774 0099-COMPANY-NOT-FOUND.
  7775
  7776     MOVE ER-2616                TO WS-ERROR.
  7777     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7778
  7779 0100-READ-ACCT.
  7780
  7781     MOVE SPACES                 TO DATE-RANGE-SW.
  7782
  7783     IF WK-ACCT-ADDR = ZEROS
  7784        GO TO 0102-ACCT-GETMAIN.
  7785
  7786     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7787     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7788     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7789
  7790     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7791        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7792        GO TO 0105-READ-ACCT
  7793     END-IF
  7794
  7795     IF PB-CARRIER NOT = SPACES
  7796        IF PB-CARRIER NOT = AM-VG-CARRIER
  7797           GO TO 0105-READ-ACCT.
  7798
  7799     IF PB-STATE NOT = SPACES
  7800        IF PB-STATE NOT = AM-VG-STATE
  7801           GO TO 0105-READ-ACCT.
  7802
  7803     IF PB-GROUPING NOT = SPACES
  7804        IF PB-GROUPING NOT = AM-VG-GROUPING
  7805           GO TO 0105-READ-ACCT.
  7806
  7807     MOVE 'X'                 TO DATE-RANGE-SW.
  7808
  7809     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7810        MOVE 'X'                 TO DATE-RANGE-SW
  7811        GO TO 0105-READ-ACCT.
  7812
  7813     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7814        GO TO 0105-READ-ACCT.
  7815
  7816     GO TO 0180-ACCOUNT-FOUND.
  7817
  7818 0102-ACCT-GETMAIN.
  7819     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7820     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7821
  7822 0105-READ-ACCT.
  7823     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7824     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7825     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7826     MOVE PB-STATE               TO ACCT-STATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 145
* EL050.cbl
  7827     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7828     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7829
  7830     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7831
  7832     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7833
  7834 0110-FIND-ACCT-TOLERANCES-LOOP.
  7835     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7836
  7837     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7838        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7839        GO TO 0199-ACCT-NOT-FOUND
  7840     END-IF
  7841     IF PB-CARRIER NOT = SPACES
  7842        IF PB-CARRIER NOT = AM-VG-CARRIER
  7843           GO TO 0199-ACCT-NOT-FOUND.
  7844
  7845     IF PB-STATE NOT = SPACES
  7846        IF PB-STATE NOT = AM-VG-STATE
  7847           GO TO 0199-ACCT-NOT-FOUND.
  7848
  7849     IF PB-GROUPING NOT = SPACES
  7850        IF PB-GROUPING NOT = AM-VG-GROUPING
  7851           GO TO 0199-ACCT-NOT-FOUND.
  7852
  7853     MOVE 'X'                    TO DATE-RANGE-SW.
  7854
  7855     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7856        MOVE 'X'                 TO DATE-RANGE-SW
  7857        GO TO 0199-ACCT-NOT-FOUND.
  7858
  7859     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7860        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7861
  7862 0180-ACCOUNT-FOUND.
  7863     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7864     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7865     MOVE AM-STATE               TO PB-SV-STATE.
  7866     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7867
  7868     IF AM-CANCEL-FEE  NOT NUMERIC
  7869        MOVE ZEROS TO AM-CANCEL-FEE.
  7870
  7871     IF AM-MAX-MON-BEN NOT NUMERIC
  7872        MOVE ZEROS TO AM-MAX-MON-BEN.
  7873
  7874     IF AM-MAX-TOT-BEN NOT NUMERIC
  7875        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7876
  7877     IF AM-CLP-TOL-PCT NOT NUMERIC
  7878        MOVE +0                  TO AM-CLP-TOL-PCT
  7879     END-IF
  7880     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7881        MOVE +0                  TO AM-SPP-LEASE-COMM
  7882     END-IF
  7883     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7884        MOVE ER-2611             TO   WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 146
* EL050.cbl
  7885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7886
  7887     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7888        MOVE ER-2621             TO   WS-ERROR
  7889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7890
  7891     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7892        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7893        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7894        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7895         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7896
  7897     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7898     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7899     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7900     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7901     IF AM-CLP-TOL-PCT NOT = ZEROS
  7902        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7903     END-IF
  7904     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7905        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7906     END-IF
  7907*    IF PB-COMPANY-ID = 'DCC'
  7908*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7909*                                   WS-ADMIN-FEES
  7910*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7911*          (SUB5 > +10)
  7912*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7913*             AND (AM-A-COM (SUB5) NUMERIC)
  7914*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7915*                + (AM-A-COM (SUB5) * 1000)
  7916*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7917*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7918*                + (AM-A-COM (SUB5) * 1000)
  7919*             END-IF
  7920*             IF AM-COM-TYP (SUB5) = 'N'
  7921*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7922*                + (AM-A-COM (SUB5) * 1000)
  7923*             END-IF
  7924*          END-IF
  7925*       END-PERFORM
  7926*    END-IF
  7927     IF (PB-COMPANY-ID = 'DCC')
  7928        AND (PB-ISSUE)
  7929        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7930        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7931           (SUB5 > +10)
  7932           MOVE +0 TO WS-WK-RATE
  7933           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7934              IF (AM-A-COM (SUB5) NUMERIC)
  7935                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7936                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7937              ELSE
  7938                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7939                 IF PB-ISSUE
  7940                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7941                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7942                 ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 147
* EL050.cbl
  7943                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7944                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7945                 END-IF
  7946                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7947                 MOVE ZEROS             TO WS-SUB1
  7948                                           WS-COMMISSION
  7949                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7950                 MOVE '0530'               TO CTBL-SW
  7951                 MOVE ' '                  TO WS-CTBL-READ-SW
  7952                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7953                 IF FIRST-TIME-THROUGH
  7954                    MOVE 'AA'              TO CTBL-BEN-CODE
  7955                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7956                 END-IF
  7957                 IF CTBL-TABLE-FOUND
  7958                    IF PB-ISSUE
  7959                       COMPUTE WS-COMM-CK-AMT =
  7960                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7961                    ELSE
  7962                       COMPUTE WS-COMM-CK-AMT =
  7963                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7964                    END-IF
  7965                    PERFORM 8800-GET-COMP-RATE
  7966                              THRU 8800-EXIT
  7967                 END-IF
  7968              END-IF
  7969              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7970                + (WS-WK-RATE * 1000)
  7971           END-IF
  7972        END-PERFORM
  7973     END-IF
  7974     IF PB-COMPANY-ID EQUAL 'CRI'
  7975         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7976
  7977     IF PB-COMPANY-ID EQUAL 'NCL'
  7978         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7979     END-IF
  7980
  7981     GO TO 0200-READ-CERT.
  7982
  7983 0199-ACCT-NOT-FOUND.
  7984
  7985     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7986
  7987     IF DATE-RANGE-SW NOT = SPACES
  7988        MOVE ER-2601             TO WS-ERROR
  7989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7990     ELSE
  7991        MOVE ER-2619             TO WS-ERROR
  7992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7993
  7994     GO TO 9990-RETURN.
  7995
  7996 0200-READ-CERT.
  7997
  7998     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7999     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8000     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 148
* EL050.cbl
  8001     MOVE PB-SV-STATE            TO CERT-STATE.
  8002     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8003     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8004     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8005
  8006     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8007
  8008     IF CERT-WAS-NOT-FOUND
  8009        GO TO 0299-CERT-NOT-FOUND.
  8010
  8011     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8012        MOVE ER-2759             TO WS-ERROR
  8013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8014        GO TO 0298-UNLOCK-RETURN.
  8015
  8016     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8017         MOVE ER-2758            TO WS-ERROR
  8018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8019         GO TO 0298-UNLOCK-RETURN.
  8020
  8021     IF PB-ISSUE
  8022        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8023           IF CERT-WAS-CREATED-FOR-CLAIM
  8024              NEXT SENTENCE
  8025            ELSE
  8026              MOVE ER-2626       TO WS-ERROR
  8027              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8028              GO TO 0298-UNLOCK-RETURN.
  8029
  8030     IF NOT PB-CANCELLATION
  8031        GO TO 0300-CONTINUE-EDIT.
  8032
  8033     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8034     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8035     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8036     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8037     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8038     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8039
  8040     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8041     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8042     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8043     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8044     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8045     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8046     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8047     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8048     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8049
  8050     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8051     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8052     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8053     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8054     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8055     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8056     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8057
  8058     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 149
* EL050.cbl
  8059     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8060
  8061     MOVE CM-CREDIT-INTERFACE-SW-1
  8062                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8063     MOVE CM-CREDIT-INTERFACE-SW-2
  8064                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8065
  8066     IF CM-O-B-COVERAGE
  8067         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8068
  8069     IF CM-LIVES NOT NUMERIC
  8070         MOVE ZERO                TO CM-LIVES.
  8071
  8072     IF CM-BILLED NOT NUMERIC
  8073         MOVE ZERO                TO CM-BILLED.
  8074
  8075     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8076         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8077         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8078         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8079         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8080         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8081         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8082         MOVE CM-LIVES             TO PB-CI-LIVES
  8083*The next line causes a problem with my change  I dont think it is
  8084*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8085
  8086     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8087     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8088     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8089     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8090     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8091     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8092
  8093     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8094     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8095     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8096     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8097
  8098     IF CM-LIFE-COMM-PCT NUMERIC
  8099         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8100     ELSE
  8101         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8102
  8103     IF CM-AH-COMM-PCT NUMERIC
  8104         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8105     ELSE
  8106         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8107
  8108     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8109
  8110     IF CM-LOAN-APR       NOT NUMERIC
  8111           MOVE ZERO               TO CM-LOAN-APR.
  8112
  8113     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8114           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8115
  8116     IF CM-LOAN-TERM      NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 150
* EL050.cbl
  8117           MOVE ZERO               TO CM-LOAN-TERM.
  8118
  8119     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8120           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8121
  8122     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8123           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8124
  8125     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8126     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8127     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8128     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8129     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8130     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8131     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8132     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8133     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8134     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8135     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8136     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8137
  8138     IF CM-STATE = CM-SSN-STATE
  8139         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8140
  8141     IF CM-STATE NOT = CM-MEMB-STATE
  8142         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8143
  8144     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8145
  8146     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8147        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8148        IF CM-ADDL-CLP NOT NUMERIC
  8149           MOVE +0               TO CM-ADDL-CLP
  8150        END-IF
  8151        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8152        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8153           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8154        END-IF
  8155     END-IF
  8156     IF PB-COMPANY-ID = 'DCC'
  8157        MOVE +0                  TO WS-ADMIN-FEES
  8158                                    WS-CSO-ADMIN-FEE
  8159                                    WS-COMM-AND-MFEE
  8160                                    WS-1ST-YR-ALLOW
  8161        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8162           (SUB5 > +10)
  8163           MOVE +0 TO WS-WK-RATE
  8164           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8165              IF (AM-A-COM (SUB5) NUMERIC)
  8166                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8167                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8168              ELSE
  8169                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8170                 IF PB-ISSUE
  8171                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8172                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8173                 ELSE
  8174                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 151
* EL050.cbl
  8175                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8176                 END-IF
  8177                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8178                 MOVE ZEROS             TO WS-SUB1
  8179                                           WS-COMMISSION
  8180                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8181                 MOVE '0530'               TO CTBL-SW
  8182                 MOVE ' '                  TO WS-CTBL-READ-SW
  8183                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8184                 IF FIRST-TIME-THROUGH
  8185                    MOVE 'AA'              TO CTBL-BEN-CODE
  8186                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8187                 END-IF
  8188                 IF CTBL-TABLE-FOUND
  8189                    IF PB-ISSUE
  8190                       COMPUTE WS-COMM-CK-AMT =
  8191                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8192                    ELSE
  8193                       COMPUTE WS-COMM-CK-AMT =
  8194                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8195                    END-IF
  8196                    PERFORM 8800-GET-COMP-RATE
  8197                              THRU 8800-EXIT
  8198                 END-IF
  8199              END-IF
  8200              IF AM-COM-TYP (SUB5) = 'I'
  8201                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8202                   + (WS-WK-RATE * 1000)
  8203              END-IF
  8204              IF AM-COM-TYP (SUB5) = 'N'
  8205                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8206                   + (WS-WK-RATE * 1000)
  8207              END-IF
  8208              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8209                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8210                   + (WS-WK-RATE * 1000)
  8211              END-IF
  8212              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8213                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8214                   + (WS-WK-RATE * 1000)
  8215              END-IF
  8216           END-IF
  8217        END-PERFORM
  8218     END-IF
  8219     GO TO 0300-CONTINUE-EDIT.
  8220
  8221 0298-UNLOCK-RETURN.
  8222      PERFORM 9250-UNLOCK-RETURN
  8223      GO TO 9990-RETURN.
  8224
  8225 0299-CERT-NOT-FOUND.
  8226
  8227     MOVE '1'                     TO CERT-STATUS-SW.
  8228
  8229     IF PB-COMPANY-ID = 'UCL'
  8230         IF WS-ERROR = ER-2799
  8231             GO TO 3000-CONTINUE-EDIT.
  8232
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 152
* EL050.cbl
  8233     IF NOT PB-CANCELLATION
  8234         GO TO 0300-CONTINUE-EDIT.
  8235
  8236     MOVE ER-2726                  TO  WS-ERROR.
  8237     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8238     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8239     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8240                                    PB-CI-LF-TERM
  8241                                    PB-C-LF-REM-TERM
  8242                                    PB-CI-AH-TERM
  8243                                    PB-C-AH-REM-TERM
  8244                                    PB-CI-LF-BENEFIT-CD
  8245                                    PB-CI-LF-BENEFIT-AMT
  8246                                    PB-CI-LF-ALT-BENEFIT-AMT
  8247                                    PB-CI-LF-PREMIUM-AMT
  8248                                    PB-CI-LF-ALT-PREMIUM-AMT
  8249                                    PB-CI-AH-BENEFIT-CD
  8250                                    PB-CI-AH-BENEFIT-AMT
  8251                                    PB-CI-AH-PREMIUM-AMT
  8252                                    PB-CI-PAY-FREQUENCY
  8253                                    PB-CI-LOAN-APR
  8254                                    PB-CI-LOAN-TERM
  8255                                    PB-CI-LIFE-COMMISSION
  8256                                    PB-CI-AH-COMMISSION
  8257                                    PB-CI-CURR-SEQ
  8258                                    PB-CI-AH-CANCEL-AMT
  8259                                    PB-CI-LF-CANCEL-AMT
  8260                                    PB-CI-RATE-DEV-PCT-LF
  8261                                    PB-CI-RATE-DEV-PCT-AH
  8262                                    PB-CI-EXTENTION-DAYS
  8263                                    PB-CI-TERM-IN-DAYS
  8264                                    PB-CI-LIVES
  8265                                    PB-CI-LF-CRIT-PER
  8266                                    PB-CI-AH-CRIT-PER
  8267                                    PB-CI-ADDL-CLP
  8268                                    PB-CI-DDF-IU-RATE-UP.
  8269
  8270     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8271                                    PB-CI-AH-SETTLEMENT-DT
  8272                                    PB-CI-DEATH-DT
  8273                                    PB-CI-LF-PRIOR-CANCEL-DT
  8274                                    PB-CI-AH-PRIOR-CANCEL-DT
  8275                                    PB-CI-ENTRY-DT
  8276                                    PB-CI-LF-EXPIRE-DT
  8277                                    PB-CI-AH-EXPIRE-DT
  8278                                    PB-CI-LOAN-1ST-PMT-DT.
  8279
  8280     IF ACCOUNT-MAST-FOUND
  8281        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8282        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8283
  8284     GO TO 3000-CONTINUE-EDIT.
  8285
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 153
* EL050.cbl
  8287
  8288 0300-CONTINUE-EDIT.
  8289
  8290     IF PB-ISSUE
  8291        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8292            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8293
  8294     IF PB-ISSUE
  8295        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8296            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8297
  8298     IF PB-ISSUE
  8299       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8300          (AM-NO-AH-ONLY)
  8301           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8302               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8303                   MOVE ER-2679 TO WS-ERROR
  8304                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8305
  8306     IF PB-ISSUE
  8307        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8308        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8309        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8310     ELSE
  8311        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8312        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8313        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8314
  8315     MOVE 'N'                    TO PLAN-MASTER-SW
  8316                                    PLAN-MASTER-LIFE-SW
  8317                                    FORM-MASTER-SW
  8318                                    WS-APP-CERT-SW.
  8319
  8320     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8321                                    WS-PL-TOL-LF-REFUND
  8322                                    WS-PL-REF-OVS-AMT
  8323                                    WS-PL-TOL-LF-PREM-PCT
  8324                                    WS-PL-TOL-LF-REFUND-PCT
  8325                                    WS-PL-REF-OVS-PCT
  8326                                    WS-PL-TOL-LF-CLAIM.
  8327
  8328     IF PB-COMPANY-ID = 'NCL'
  8329       IF PB-ISSUE
  8330         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8331             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8332             IF FORM-MASTER-FOUND
  8333                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8334
  8335     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8336        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8337
  8338********************** MON CODE **********************
  8339     IF PB-COMPANY-ID = 'MON'
  8340     IF PB-ISSUE
  8341     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8342        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8343             PB-I-LOAN-APR = ZERO)
  8344               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 154
* EL050.cbl
  8345******************************************************
  8346
  8347     IF PB-COMPANY-ID = 'NCL'
  8348       IF PB-ISSUE
  8349           IF FORM-MASTER-FOUND
  8350             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8351                AM-DISMBR-COVERAGE
  8352                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8353                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8354                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8355                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8356                                           PB-I-LIFE-BENEFIT-CD.
  8357
  8358     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8359
  8360     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8361         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8362         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8363         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8364         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8365         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8366           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8367             GO TO 0301-LIFE-BENEFIT-SEARCH
  8368         ELSE
  8369             NEXT SENTENCE
  8370     ELSE
  8371         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8372
  8373     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8374     MOVE '4'                    TO CNTL-REC-TYPE.
  8375     MOVE +0                     TO CNTL-SEQ-NO.
  8376     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8377
  8378     MOVE '1' TO RC-SW-2.
  8379     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8380
  8381     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8382        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8383         GO TO 0305-BENEFIT-NOT-FOUND.
  8384
  8385     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8386
  8387 0301-LIFE-BENEFIT-SEARCH.
  8388
  8389     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8390
  8391     IF NO-BENEFIT-FOUND
  8392        GO TO 0305-BENEFIT-NOT-FOUND.
  8393
  8394     IF WS-BEN-CD = '99'
  8395        GO TO 0305-BENEFIT-NOT-FOUND.
  8396
  8397     IF PB-COMPANY-ID = 'NCL'
  8398         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8399             GO TO 0304-LIFE-BENEFIT-FOUND.
  8400
  8401     MOVE +1                     TO SUB5.
  8402     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 155
* EL050.cbl
  8403
  8404* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8405* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8406     IF PB-COMPANY-ID = 'DMD'
  8407         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8408
  8409 0302-EDIT-ACCT-LF-BENEFITS.
  8410
  8411     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8412        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8413           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8414                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8415           GO TO 03XX-GET-LIFE-ERPLAN.
  8416
  8417     IF SUB5 LESS THAN +20
  8418        ADD +1                   TO SUB5
  8419        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8420
  8421     MOVE +1                     TO SUB5.
  8422
  8423     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8424        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8425
  8426 0303-EDIT-DMD-EXTRA-BENEFITS.
  8427
  8428     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8429        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8430           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8431                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8432           GO TO 03XX-GET-LIFE-ERPLAN.
  8433
  8434     IF SUB5 LESS THAN +30
  8435        ADD +1                   TO SUB5
  8436        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8437
  8438     MOVE +1                     TO SUB5.
  8439
  8440 03XX-EDIT-FOR-NINETY-LF.
  8441
  8442***************************************************************
  8443*                                                             *
  8444*    NINETY BENEFIT PLAN TYPES:                               *
  8445*                                                             *
  8446*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8447*      92 = ALL GROUP REDUCING BENEFITS                       *
  8448*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8449*      94 = ALL GROUP LEVEL BENEFITS                          *
  8450*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8451*           BENEFIT CONTROLS.                                 *
  8452*      99 = ALL BENEFITS                                      *
  8453*                                                             *
  8454***************************************************************
  8455
  8456     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8457                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8458
  8459     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8460       AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 156
* EL050.cbl
  8461        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8462        GO TO 03XX-GET-LIFE-ERPLAN.
  8463
  8464     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8465       AND
  8466        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8467        IF CF-REDUCING (SUB3)
  8468           IF (PB-I-INDV-GRP-OVRD = 'I')
  8469              OR
  8470           ((AM-IG = '1') AND
  8471           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8472              OR
  8473           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8474           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8475           (AM-IG NOT = '2'))
  8476              GO TO 03XX-GET-LIFE-ERPLAN.
  8477
  8478     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8479       AND
  8480        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8481        IF CF-REDUCING (SUB3)
  8482           IF (PB-I-INDV-GRP-OVRD = 'G')
  8483              OR
  8484           ((AM-IG = '2') AND
  8485           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8486              OR
  8487           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8488           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8489           (AM-IG NOT = '1'))
  8490              GO TO 03XX-GET-LIFE-ERPLAN.
  8491
  8492     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8493       AND
  8494        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8495        IF CF-LEVEL    (SUB3)
  8496           IF (PB-I-INDV-GRP-OVRD = 'I')
  8497              OR
  8498           ((AM-IG = '1') AND
  8499           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8500              OR
  8501           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8502           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8503            (AM-IG NOT = '2'))
  8504              GO TO 03XX-GET-LIFE-ERPLAN.
  8505
  8506     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8507       AND
  8508        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8509        IF CF-LEVEL    (SUB3)
  8510           IF (PB-I-INDV-GRP-OVRD = 'G')
  8511              OR
  8512           ((AM-IG = '2') AND
  8513           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8514              OR
  8515           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8516           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8517           (AM-IG NOT = '1'))
  8518              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 157
* EL050.cbl
  8519
  8520     IF SUB5 LESS THAN +20
  8521        ADD +1                   TO SUB5
  8522        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8523
  8524     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8525
  8526     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8527        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8528
  8529     MOVE +1                     TO SUB5.
  8530
  8531 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8532
  8533     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8534                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8535
  8536     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8537       AND
  8538        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8539        GO TO 03XX-GET-LIFE-ERPLAN.
  8540
  8541     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8542       AND
  8543        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8544        IF CF-REDUCING (SUB3)
  8545           IF (PB-I-INDV-GRP-OVRD = 'I')
  8546              OR
  8547           ((AM-IG = '1') AND
  8548           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8549              OR
  8550           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8551           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8552           (AM-IG NOT = '2'))
  8553              GO TO 03XX-GET-LIFE-ERPLAN.
  8554
  8555     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8556       AND
  8557        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8558        IF CF-REDUCING (SUB3)
  8559           IF (PB-I-INDV-GRP-OVRD = 'G')
  8560              OR
  8561           ((AM-IG = '2') AND
  8562           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8563              OR
  8564           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8565           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8566           (AM-IG NOT = '1'))
  8567              GO TO 03XX-GET-LIFE-ERPLAN.
  8568
  8569     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8570       AND
  8571        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8572        IF CF-LEVEL    (SUB3)
  8573           IF (PB-I-INDV-GRP-OVRD = 'I')
  8574              OR
  8575           ((AM-IG = '1') AND
  8576           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 158
* EL050.cbl
  8577              OR
  8578           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8579           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8580            (AM-IG NOT = '2'))
  8581              GO TO 03XX-GET-LIFE-ERPLAN.
  8582
  8583     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8584       AND
  8585        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8586        IF CF-LEVEL    (SUB3)
  8587           IF (PB-I-INDV-GRP-OVRD = 'G')
  8588              OR
  8589           ((AM-IG = '2') AND
  8590           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8591              OR
  8592           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8593           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8594           (AM-IG NOT = '1'))
  8595              GO TO 03XX-GET-LIFE-ERPLAN.
  8596
  8597     IF SUB5 LESS THAN +30
  8598        ADD +1                   TO SUB5
  8599        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8600
  8601     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8602
  8603 03XX-EDIT-FOR-NINETY-LF-CONT.
  8604
  8605     MOVE +99                    TO SUB5.
  8606
  8607     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8608        IF PB-ISSUE
  8609           MOVE ER-1924          TO  WS-ERROR
  8610           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8611
  8612     GO TO 0304-LIFE-BENEFIT-FOUND.
  8613
  8614 03XX-GET-LIFE-ERPLAN.
  8615
  8616     IF WK-PLAN-ADDR EQUAL +0
  8617        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8618
  8619     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8620     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8621     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8622     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8623     MOVE 'Y'                    TO PLAN-MASTER-SW
  8624                                    PLAN-MASTER-LIFE-SW.
  8625     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8626
  8627 03XX-ERPLAN-LIFE-GETMAIN.
  8628
  8629     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8630     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8631
  8632 03XX-ERPLAN-LIFE-READ.
  8633
  8634     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 159
* EL050.cbl
  8635     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8636     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8637     MOVE PB-SV-STATE            TO PLAN-STATE.
  8638     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8639     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8640     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8641     MOVE WS-SAVE-BENEFIT-REVISION
  8642                                 TO PLAN-REVISION-NO.
  8643
  8644     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8645     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8646
  8647     IF PB-COMPANY-ID = 'NCL'
  8648       IF NOT LF-PLAN-MASTER-FOUND
  8649         IF NOT PB-POLICY-IS-DECLINED  AND
  8650            NOT PB-POLICY-IS-VOIDED
  8651             MOVE  ER-1921         TO  WS-ERROR
  8652             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8653             GO TO 0304-LIFE-BENEFIT-FOUND.
  8654
  8655     IF NOT LF-PLAN-MASTER-FOUND
  8656        GO TO 0304-LIFE-BENEFIT-FOUND.
  8657
  8658 XXXX-CHECK-LF-PLAN-KEY.
  8659
  8660     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8661        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8662        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8663        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8664        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8665        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8666        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8667        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8668        MOVE 'N'                 TO PLAN-MASTER-SW
  8669          GO TO 03XX-ERPLAN-LIFE-READ.
  8670
  8671     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8672
  8673     IF  PB-CANCELLATION
  8674         GO TO  0303-LF-ACCT-BEN-FOUND.
  8675
  8676     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8677        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8678           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8679           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8680              MOVE ER-2644             TO WS-ERROR
  8681              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8682           ELSE
  8683              NEXT SENTENCE
  8684        ELSE
  8685           IF PB-COMPANY-ID NOT = 'NCL'
  8686              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8687                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8688
  8689 0303-LF-ACCT-BEN-FOUND.
  8690
  8691     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8692
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 160
* EL050.cbl
  8693     IF PL-DEV-CODE NOT = SPACES
  8694        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8695
  8696     IF PL-DEV-PCT NUMERIC AND
  8697        PL-DEV-PCT NOT = ZEROS
  8698        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8699
  8700     IF PL-TOL-PREM-AMT GREATER THAN +0
  8701        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8702
  8703     IF PL-TOL-REF-AMT GREATER THAN +0
  8704        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8705
  8706     IF PL-TOL-PREM-PCT GREATER THAN +0
  8707        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8708
  8709     IF PL-TOL-REF-PCT GREATER THAN +0
  8710        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8711
  8712     IF PL-TOL-CLM-AMT GREATER THAN +0
  8713        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8714
  8715     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8716                          PL-OVER-SHORT-AMT > +0
  8717        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8718
  8719     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8720                          PL-OVER-SHORT-PCT > +0
  8721        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8722
  8723     IF PL-SALES-TAX NUMERIC AND
  8724                          PL-SALES-TAX > +0
  8725         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8726
  8727     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8728        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8729                                    WS-IG-OVRD-AM.
  8730
  8731 0304-LIFE-BENEFIT-FOUND.
  8732
  8733     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8734
  8735     IF PB-ISSUE
  8736        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8737     ELSE
  8738        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8739
  8740     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8741     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8742     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8743     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8744     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8745                                         WS-LF-REFUND-CALC.
  8746
  8747     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8748        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8749
  8750     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 161
* EL050.cbl
  8751        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8752     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8753
  8754     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8755     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8756     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8757     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8758     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8759     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8760
  8761     IF PB-COMPANY-ID = 'NCL'  AND
  8762        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8763         NEXT SENTENCE
  8764     ELSE
  8765         IF SUB5 NOT GREATER THAN +20
  8766            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8767               MOVE WS-SAVE-BENEFIT-REM-TERM
  8768                                      TO WS-AM-LF-BENE-REM-TERM
  8769                                         EC-BR-LF-REM-TERM-CALC.
  8770
  8771     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8772     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8773
  8774     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8775
  8776 0305-BENEFIT-NOT-FOUND.
  8777
  8778     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8779     MOVE ER-2604                TO WS-ERROR.
  8780     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8781
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 162
* EL050.cbl
  8783
  8784 0310-FIND-AH-BENEFIT-RECORD.
  8785
  8786     MOVE 'N'                    TO PLAN-MASTER-SW
  8787                                    PLAN-MASTER-AH-SW.
  8788
  8789     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8790                                    WS-PL-TOL-AH-REFUND
  8791                                    WS-AH-PL-REF-OVS-AMT
  8792                                    WS-PL-TOL-AH-PREM-PCT
  8793                                    WS-PL-TOL-AH-REFUND-PCT
  8794                                    WS-AH-PL-REF-OVS-PCT
  8795                                    WS-PL-TOL-AH-CLAIM.
  8796     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8797
  8798
  8799     if pb-issue
  8800        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8801           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8802        end-if
  8803        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8804           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8805           GO TO 0399-BENEFIT-NOT-FOUND
  8806        end-if
  8807     end-if
  8808
  8809     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8810        GO TO 0400-FIND-CARRIER.
  8811
  8812     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8813
  8814     IF WK-AH-BEN-ADDR NOT = ZEROS
  8815         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8816         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8817         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8818         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8819           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8820             GO TO 0311-AH-BENEFIT-SEARCH
  8821         ELSE
  8822             NEXT SENTENCE
  8823     ELSE
  8824         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8825
  8826     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8827     MOVE '5'                    TO CNTL-REC-TYPE.
  8828     MOVE +0                     TO CNTL-SEQ-NO.
  8829     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8830
  8831     MOVE '2' TO RC-SW-2.
  8832     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8833
  8834     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8835        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8836          GO TO 0399-BENEFIT-NOT-FOUND.
  8837
  8838     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8839
  8840 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 163
* EL050.cbl
  8841
  8842     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8843
  8844     IF NO-BENEFIT-FOUND
  8845         GO TO 0399-BENEFIT-NOT-FOUND.
  8846
  8847     IF WS-BEN-CD = '99'
  8848        GO TO 0399-BENEFIT-NOT-FOUND.
  8849
  8850     IF PB-COMPANY-ID  =  'NCL'
  8851         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8852             GO TO 0314-A-H-BENEFIT-FOUND.
  8853
  8854     MOVE +1                     TO SUB5.
  8855     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8856
  8857* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8858* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8859     IF PB-COMPANY-ID = 'DMD'
  8860         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8861
  8862 0312-EDIT-ACCT-AH-BENEFITS.
  8863
  8864     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8865        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8866           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8867                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8868           GO TO 03XX-GET-AH-ERPLAN.
  8869
  8870     IF SUB5 LESS THAN +20
  8871        ADD +1                   TO SUB5
  8872        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8873
  8874     MOVE +1                     TO SUB5.
  8875
  8876     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8877        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8878
  8879 0313-EDIT-DMD-EXTRA-BENEFITS.
  8880
  8881     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8882        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8883           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8884                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8885           GO TO 03XX-GET-AH-ERPLAN.
  8886
  8887     IF SUB5 LESS THAN +30
  8888        ADD +1                   TO SUB5
  8889        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8890
  8891     MOVE +1                     TO SUB5.
  8892
  8893 03XX-EDIT-FOR-NINETY-AH.
  8894
  8895***************************************************************
  8896*                                                             *
  8897*    NINETY BENEFIT PLAN TYPES:                               *
  8898*                                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 164
* EL050.cbl
  8899*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8900*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8901*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8902*           BENEFIT CONTROLS.                                 *
  8903*      99 = ALL BENEFITS.                                     *
  8904*                                                             *
  8905***************************************************************
  8906
  8907     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8908                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8909
  8910     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8911       AND
  8912        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8913        GO TO 03XX-GET-AH-ERPLAN.
  8914
  8915     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8916       AND
  8917        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8918           IF (PB-I-INDV-GRP-OVRD = 'I')
  8919              OR
  8920           ((AM-IG = '1') AND
  8921           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8922              OR
  8923           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8924           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8925           (AM-IG NOT = '2'))
  8926              GO TO 03XX-GET-AH-ERPLAN.
  8927
  8928     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8929       AND
  8930        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8931           IF (PB-I-INDV-GRP-OVRD = 'G')
  8932              OR
  8933           ((AM-IG = '2') AND
  8934           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8935              OR
  8936           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8937           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8938           (AM-IG NOT = '1'))
  8939              GO TO 03XX-GET-AH-ERPLAN.
  8940
  8941     IF SUB5 LESS THAN +20
  8942        ADD +1                   TO SUB5
  8943        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8944
  8945     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8946        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8947
  8948     MOVE +1                    TO SUB5.
  8949
  8950 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8951
  8952     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8953                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8954
  8955     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8956       AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 165
* EL050.cbl
  8957        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8958        GO TO 03XX-GET-AH-ERPLAN.
  8959
  8960     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8961       AND
  8962        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8963           IF (PB-I-INDV-GRP-OVRD = 'I')
  8964              OR
  8965           ((AM-IG = '1') AND
  8966           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8967              OR
  8968           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8969           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8970           (AM-IG NOT = '2'))
  8971              GO TO 03XX-GET-AH-ERPLAN.
  8972
  8973     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8974       AND
  8975        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8976           IF (PB-I-INDV-GRP-OVRD = 'G')
  8977              OR
  8978           ((AM-IG = '2') AND
  8979           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8980              OR
  8981           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8983           (AM-IG NOT = '1'))
  8984              GO TO 03XX-GET-AH-ERPLAN.
  8985
  8986     IF SUB5 LESS THAN +30
  8987        ADD +1                   TO SUB5
  8988        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8989
  8990 03XX-EDIT-FOR-NINETY-AH-CONT.
  8991
  8992     MOVE +99                    TO SUB5.
  8993
  8994     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8995
  8996     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8997        IF PB-ISSUE
  8998           MOVE ER-1925          TO  WS-ERROR
  8999           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9000
  9001     GO TO 0314-A-H-BENEFIT-FOUND.
  9002
  9003 03XX-GET-AH-ERPLAN.
  9004
  9005     IF WK-PLAN-ADDR EQUAL +0
  9006         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9007
  9008     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9009     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9010     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9011     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9012     MOVE 'Y'                    TO PLAN-MASTER-SW
  9013                                    PLAN-MASTER-AH-SW.
  9014*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 166
* EL050.cbl
  9015     GO TO 03XX-ERPLAN-AH-READ.
  9016
  9017 03XX-ERPLAN-AH-GETMAIN.
  9018
  9019     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9020     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9021
  9022 03XX-ERPLAN-AH-READ.
  9023
  9024     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9025     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9026     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9027     MOVE PB-SV-STATE            TO PLAN-STATE.
  9028     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9029     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9030     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9031     MOVE WS-SAVE-BENEFIT-REVISION
  9032                                 TO PLAN-REVISION-NO.
  9033
  9034     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9035     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9036
  9037     IF PB-COMPANY-ID = 'NCL'
  9038       IF NOT AH-PLAN-MASTER-FOUND
  9039         IF NOT PB-POLICY-IS-DECLINED  AND
  9040            NOT PB-POLICY-IS-VOIDED
  9041             MOVE  ER-1922         TO  WS-ERROR
  9042             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9043             GO TO 0314-A-H-BENEFIT-FOUND.
  9044
  9045     IF NOT AH-PLAN-MASTER-FOUND
  9046        GO TO 0314-A-H-BENEFIT-FOUND.
  9047
  9048 XXXX-CHECK-AH-PLAN-KEY.
  9049
  9050     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9051        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9052        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9053        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9054        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9055        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9056        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9057        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9058        MOVE 'N'                 TO PLAN-MASTER-SW
  9059          GO TO 03XX-ERPLAN-AH-READ.
  9060
  9061     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9062
  9063     IF  PB-CANCELLATION
  9064         GO TO  0313-AH-ACCT-BEN-FOUND.
  9065
  9066     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9067       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9068          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9069          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9070             MOVE ER-2644             TO WS-ERROR
  9071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9072          ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 167
* EL050.cbl
  9073             NEXT SENTENCE
  9074       ELSE
  9075          IF PB-COMPANY-ID NOT = 'NCL'
  9076             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9077                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9078
  9079 0313-AH-ACCT-BEN-FOUND.
  9080
  9081     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9082
  9083     IF PL-DEV-CODE NOT = SPACES
  9084        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9085
  9086     IF PL-DEV-PCT NUMERIC AND
  9087        PL-DEV-PCT NOT = ZEROS
  9088        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9089
  9090     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9091        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9092
  9093     IF PL-TOL-REF-AMT NOT EQUAL +0
  9094        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9095
  9096     IF PL-TOL-PREM-PCT GREATER THAN +0
  9097        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9098
  9099     IF PL-TOL-REF-PCT GREATER THAN +0
  9100        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9101
  9102     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9103        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9104
  9105     IF PL-OVER-SHORT-AMT NUMERIC AND
  9106                          PL-OVER-SHORT-AMT > +0
  9107        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9108
  9109     IF PL-OVER-SHORT-PCT NUMERIC AND
  9110                          PL-OVER-SHORT-PCT > +0
  9111        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9112
  9113     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9114        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9115        IF WS-IG-OVRD-AM EQUAL SPACES
  9116            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9117
  9118 0314-A-H-BENEFIT-FOUND.
  9119
  9120     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9121
  9122     IF PB-ISSUE
  9123        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9124       ELSE
  9125        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9126
  9127     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9128     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9129     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9130     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 168
* EL050.cbl
  9131                                         WS-AH-REFUND-CALC.
  9132
  9133     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9134        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9135
  9136     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9137        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9138     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9139
  9140     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9141     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9142     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9143     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9144     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9145     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9146
  9147     IF PB-COMPANY-ID = 'NCL'  AND
  9148        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9149         NEXT SENTENCE
  9150     ELSE
  9151         IF SUB5 NOT GREATER THAN +20
  9152            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9153                MOVE WS-SAVE-BENEFIT-REM-TERM
  9154                                      TO WS-AM-AH-BENE-REM-TERM
  9155                                         EC-BR-AH-REM-TERM-CALC.
  9156
  9157     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9158     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9159
  9160     GO TO 0400-FIND-CARRIER.
  9161
  9162 0399-BENEFIT-NOT-FOUND.
  9163
  9164     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9165     MOVE ER-2605                TO WS-ERROR.
  9166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9167
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 169
* EL050.cbl
  9169
  9170 0400-FIND-CARRIER.
  9171
  9172     MOVE PB-SV-CARRIER          TO WS-CARR.
  9173
  9174     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9175     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9176     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9177     MOVE '6'                    TO CNTL-REC-TYPE.
  9178
  9179*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9180     MOVE SPACE                  TO WS-DMD-RATING-SW
  9181                                    EC-BR-DMD-RATING-SW.
  9182
  9183     MOVE '2'                    TO RC-SW-1.
  9184     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9185
  9186     IF NOT CF-CARRIER-MASTER
  9187        GO TO 0400-CARRIER-NOT-FOUND.
  9188
  9189 0400-BUILD-CARR-TOL.
  9190
  9191     IF CF-CR-TOL-PREM NUMERIC AND
  9192        CF-CR-TOL-PREM GREATER THAN +0
  9193        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9194                                    WS-TOL-AH-PREM.
  9195
  9196     IF CF-CR-TOL-REFUND NUMERIC AND
  9197        CF-CR-TOL-REFUND GREATER THAN +0
  9198        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9199                                    WS-TOL-AH-REFUND.
  9200
  9201     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9202        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9203        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9204                                    WS-AH-REFUND-OVS-AMT.
  9205
  9206     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9207        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9208        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9209                                    WS-AH-REFUND-OVS-PCT.
  9210
  9211     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9212        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9213        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9214                                    WS-TOL-AH-PREM-PCT.
  9215
  9216     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9217        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9218        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9219                                     WS-TOL-AH-REFUND-PCT.
  9220
  9221     IF CF-COMPANY-ID EQUAL 'DMD'
  9222         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9223                                    EC-BR-DMD-RATING-SW.
  9224
  9225     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9226     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 170
* EL050.cbl
  9227        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9228     END-IF
  9229     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9230        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9231     END-IF
  9232     IF WS-TOL-CLP-PCT = ZEROS
  9233        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9234     END-IF
  9235
  9236     IF WS-SPP-LEASE-COMM = ZEROS
  9237        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9238     END-IF
  9239     GO TO 0400-FIND-ERPDEF.
  9240
  9241 0400-CARRIER-NOT-FOUND.
  9242
  9243     MOVE ER-2602                TO WS-ERROR.
  9244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9245
  9246 0400-FIND-ERPDEF.
  9247     IF PB-COMPANY-ID = 'DCC'
  9248        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9249        CONTINUE
  9250     ELSE
  9251        GO TO 0400-FIND-ERCOMP
  9252     END-IF
  9253     MOVE ' '                    TO PDEF-MASTER-SW
  9254     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9255     MOVE PB-STATE               TO ERPDEF-STATE
  9256     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9257     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9258     IF PB-ISSUE
  9259        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9260     ELSE
  9261        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9262     END-IF
  9263     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9264     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9265     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9266     IF PDEF-MASTER-FOUND
  9267        MOVE 'N'                 TO PDEF-MASTER-SW
  9268        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9269        IF PDEF-MASTER-FOUND
  9270           IF (ERPDEF-KEY-SAVE (1:16) =
  9271                        PD-CONTROL-PRIMARY (1:16))
  9272              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9273              CONTINUE
  9274           ELSE
  9275              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9276              IF (ERPDEF-KEY-SAVE (1:16) =
  9277                        PD-CONTROL-PRIMARY (1:16))
  9278                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9279                 CONTINUE
  9280              ELSE
  9281                 MOVE 'N'        TO PDEF-MASTER-SW
  9282              END-IF
  9283           END-IF
  9284        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 171
* EL050.cbl
  9285        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9286     END-IF
  9287     IF PDEF-MASTER-FOUND
  9288        IF PD-TRUNCATED = 'Y'
  9289           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9290        END-IF
  9291     END-IF
  9292     .
  9293 0400-FIND-ERCOMP.
  9294     IF PB-COMPANY-ID = 'DCC'
  9295        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9296           (WS-SUB1 > +10)
  9297           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9298                 OR 'A' OR 'N'
  9299              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9300              MOVE PB-CARRIER    TO COMP-CARRIER
  9301              MOVE PB-GROUPING   TO COMP-GROUPING
  9302              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9303              MOVE AM-AGT (WS-SUB1)
  9304                                 TO COMP-FIN-RESP
  9305              MOVE 'G'           TO COMP-TYPE
  9306              PERFORM 8582-READ-COMPENSATION-MASTER
  9307                                 THRU 8582-EXIT
  9308              IF COMP-MASTER-FOUND
  9309                 IF CO-GA-INACTIVE
  9310                    MOVE ER-2763 TO WS-ERROR
  9311                    PERFORM 9900-ERROR-FORMAT
  9312                                 THRU 9900-EXIT
  9313                    MOVE +11     TO WS-SUB1
  9314                 END-IF
  9315                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9316                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9317                    MOVE ER-2788 TO WS-ERROR
  9318                    PERFORM 9900-ERROR-FORMAT
  9319                                 THRU 9900-EXIT
  9320                    MOVE +11     TO WS-SUB1
  9321                 END-IF
  9322              END-IF
  9323           END-IF
  9324        END-PERFORM
  9325     END-IF
  9326     IF PB-COMPANY-ID = 'DCC'
  9327        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9328           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9329                                    WS-CLP-STATE
  9330        ELSE
  9331           MOVE SPACES           TO PB-I-CLP-STATE
  9332                                    WS-CLP-STATE
  9333        END-IF
  9334     END-IF
  9335
  9336     IF (PB-COMPANY-ID = 'DCC')
  9337        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9338        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9339        CONTINUE
  9340     ELSE
  9341        GO TO 0400-FIND-STATE-RECORD
  9342     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 172
* EL050.cbl
  9343     MOVE SPACES                 TO WS-CLP-STATE
  9344     MOVE +0                     TO WS-BANK-FEE
  9345                                    WS-BANK-LFEE
  9346                                    WS-BANK-NOCHRGB
  9347
  9348     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9349     IF (PB-ISSUE)
  9350        AND (PB-I-BANK-NUMBER NOT =
  9351            SPACES AND ZEROS AND LOW-VALUES)
  9352        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9353     ELSE
  9354        IF (PB-CANCELLATION)
  9355           AND (PB-CI-BANK-NUMBER NOT =
  9356                SPACES AND ZEROS AND LOW-VALUES)
  9357           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9358        END-IF
  9359     END-IF
  9360     IF COMP-FIN-RESP NOT = LOW-VALUES
  9361        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9362        MOVE PB-CARRIER          TO COMP-CARRIER
  9363        MOVE PB-GROUPING         TO COMP-GROUPING
  9364        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9365        MOVE 'B'                 TO COMP-TYPE
  9366        PERFORM 8582-READ-COMPENSATION-MASTER
  9367                                 THRU 8582-EXIT
  9368        IF COMP-MASTER-FOUND
  9369           IF CO-MAX-BANK-FEE NOT NUMERIC
  9370              MOVE +0            TO CO-MAX-BANK-FEE
  9371           END-IF
  9372           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9373              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9374           END-IF
  9375           IF CO-GA-INACTIVE
  9376              MOVE ER-2763       TO WS-ERROR
  9377              PERFORM 9900-ERROR-FORMAT
  9378                                 THRU 9900-EXIT
  9379           END-IF
  9380           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9381              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9382              MOVE ER-2788 TO WS-ERROR
  9383              PERFORM 9900-ERROR-FORMAT
  9384                                 THRU 9900-EXIT
  9385              MOVE +11     TO WS-SUB1
  9386           END-IF
  9387           IF WS-AH-BEN-CATEGORY = 'G'
  9388              MOVE CO-MAX-BANK-FEE
  9389                                 TO WS-BANK-FEE
  9390                                    PB-I-BANK-FEE
  9391           ELSE
  9392              MOVE CO-MAX-BANK-FEE-LEASE
  9393                                 TO WS-BANK-LFEE
  9394                                    PB-I-BANK-FEE
  9395           END-IF
  9396           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9397              AND (WS-AH-REFUND-CALC = 'G'))
  9398                        OR
  9399              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9400              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 173
* EL050.cbl
  9401              CONTINUE
  9402           ELSE
  9403              MOVE ER-2789 TO WS-ERROR
  9404              PERFORM 9900-ERROR-FORMAT
  9405                                 THRU 9900-EXIT
  9406           END-IF
  9407           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9408                                    PB-I-CLP-STATE
  9409           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9410           MOVE CO-CARRIER       TO BXRF-CARRIER
  9411           MOVE CO-GROUPING      TO BXRF-GROUPING
  9412           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9413           MOVE BXRF-MAX-REC-LENGTH
  9414                                 TO BXRF-REC-LENGTH
  9415           PERFORM 8584-READ-BANK-CROSS-REF
  9416                                 THRU 8584-EXIT
  9417           IF BXRF-MASTER-FOUND
  9418              MOVE ' '           TO BANK-ACCT-SW
  9419              MOVE BK-BANK-POINTER-CNT
  9420                                 TO BK-BANK-POINTER-CNT
  9421              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9422                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9423                 OR (BANK-ACCT-FOUND)
  9424                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9425                    AND (BK-AM-EXP-DT (WS-SUB1)
  9426                                 > PB-CERT-EFF-DT)
  9427                    AND (BK-AM-EFF-DT (WS-SUB1)
  9428                                 NOT > PB-CERT-EFF-DT)
  9429                    SET BANK-ACCT-FOUND TO TRUE
  9430                 END-IF
  9431              END-PERFORM
  9432              IF NOT BANK-ACCT-FOUND
  9433                 MOVE ZEROS      TO WS-BANK-FEE
  9434                                    WS-BANK-LFEE
  9435                 MOVE ER-2869    TO WS-ERROR
  9436                 PERFORM 9900-ERROR-FORMAT
  9437                                 THRU 9900-EXIT
  9438              ELSE
  9439                 PERFORM 5000-PROCESS-REPS
  9440                                 THRU 5000-EXIT
  9441                 IF AGENT-MASTER-FOUND
  9442                    MOVE +0      TO WS-BANK-FEE
  9443                                    WS-BANK-LFEE
  9444*                   MOVE AG-SPP-FEES (1)
  9445*                                TO PB-I-BANK-FEE
  9446*                                   WS-BANK-FEE
  9447                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9448                       (WS-SUB1 > +10)
  9449                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9450                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9451                       END-IF
  9452                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9453                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9454                       END-IF
  9455                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9456                          AG-SPP-FEES (WS-SUB1)
  9457                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9458                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 174
* EL050.cbl
  9459                    END-PERFORM
  9460                    IF WS-AH-BEN-CATEGORY = 'G'
  9461                       MOVE WS-BANK-FEE
  9462                                 TO PB-I-BANK-FEE
  9463                    ELSE
  9464                       MOVE WS-BANK-LFEE
  9465                                 TO PB-I-BANK-FEE
  9466                    END-IF
  9467                 END-IF
  9468              END-IF
  9469           END-IF
  9470        ELSE
  9471           MOVE ER-2879          TO WS-ERROR
  9472           PERFORM 9900-ERROR-FORMAT
  9473                                 THRU 9900-EXIT
  9474        END-IF
  9475     ELSE
  9476        MOVE ER-2879             TO WS-ERROR
  9477        PERFORM 9900-ERROR-FORMAT
  9478                                 THRU 9900-EXIT
  9479     END-IF
  9480     IF WS-AH-BEN-CATEGORY = 'G'
  9481        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9482        + WS-BANK-FEE
  9483     ELSE
  9484        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9485        + WS-BANK-LFEE
  9486     END-IF
  9487     .
  9488 0400-FIND-STATE-RECORD.
  9489
  9490     IF WK-STATE-ADDR NOT = ZEROS
  9491         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9492         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9493         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9494         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9495         IF PB-SV-STATE = CF-STATE-CODE
  9496             GO TO 0405-CONTINUE-EDIT
  9497         ELSE
  9498             NEXT SENTENCE
  9499     ELSE
  9500         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9501
  9502     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9503     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9504     MOVE '3'                    TO CNTL-REC-TYPE.
  9505     MOVE +0                     TO CNTL-SEQ-NO.
  9506
  9507     MOVE '3'                    TO RC-SW-2.
  9508     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9509
  9510     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9511        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9512        PB-SV-STATE   NOT = CF-STATE-CODE)
  9513        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9514                                    WS-TOL-AH-CLAIM
  9515                                    WS-MINIMUM-REFUND
  9516                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 175
* EL050.cbl
  9517                                    WS-TOL-AH-PREM
  9518                                    WS-TOL-LF-REFUND
  9519                                    WS-TOL-AH-REFUND
  9520                                    EC-ST-TOL-PREM-PCT
  9521                                    WS-TOL-LF-PREM-PCT
  9522                                    WS-TOL-AH-PREM-PCT
  9523                                    EC-ST-TOL-REFUND-PCT
  9524                                    WS-TOL-LF-REFUND-PCT
  9525                                    WS-TOL-AH-REFUND-PCT
  9526                                    EC-ST-TOL-PREM
  9527                                    EC-ST-TOL-REFUND
  9528                                    EC-ST-FST-PMT-DAYS-MAX
  9529                                    WS-FREE-LOOK-PERIOD
  9530                                    WS-ST-LF-PREM-TAX
  9531                                    WS-ST-AH-PREM-TAX-I
  9532                                    WS-ST-AH-PREM-TAX-G
  9533                                    WS-BANK-FEE
  9534                                    WS-BANK-LFEE
  9535                                    WS-TOL-CLP-PCT
  9536                                    WS-SPP-LEASE-COMM
  9537        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9538                                    EC-ST-FST-PMT-DAYS-CHG
  9539                                    WS-LF-REM-TERM-CALC
  9540                                    WS-LF-REFUND-CALC
  9541                                    EC-ST-LF-REM-TERM-CALC
  9542                                    EC-ST-LF-REFUND-CALC
  9543                                    WS-AH-REM-TERM-CALC
  9544                                    WS-AH-REFUND-CALC
  9545                                    WS-LF-BEN-CATEGORY
  9546                                    WS-AH-BEN-CATEGORY
  9547                                    WS-CLP-STATE
  9548                                    WS-ST-REFUND-CLAIM-FLAG
  9549                                    EC-ST-AH-REM-TERM-CALC
  9550                                    EC-ST-AH-REFUND-CALC
  9551          GO TO 0499-STATE-NOT-FOUND.
  9552
  9553     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9554
  9555 0405-CONTINUE-EDIT.
  9556
  9557     if pb-company-id = 'AHL'
  9558        continue
  9559     else
  9560        IF PB-CERT-PRIME NOT NUMERIC
  9561           MOVE ER-2722          TO WS-ERROR
  9562           PERFORM 9900-ERROR-FORMAT
  9563                                 THRU 9900-EXIT
  9564        end-if
  9565     END-IF
  9566*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9567*       MOVE +0                  TO SUB3
  9568*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9569*       IF SUB3 > +0
  9570*          MOVE ER-2722          TO WS-ERROR
  9571*          PERFORM 9900-ERROR-FORMAT
  9572*                                THRU 9900-EXIT
  9573*       END-IF
  9574*    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 176
* EL050.cbl
  9575*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9576*       IF PB-CERT-PRIME NOT NUMERIC
  9577*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9578*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9579*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9580*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9581*
  9582*          MOVE ER-2722          TO WS-ERROR
  9583*          PERFORM 9900-ERROR-FORMAT
  9584*                                THRU 9900-EXIT
  9585*       END-IF
  9586*    END-IF
  9587
  9588     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9589
  9590     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9591        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9592                                    WS-TOL-AH-CLAIM.
  9593
  9594     IF CF-ST-REFUND-MIN NOT NUMERIC
  9595        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9596
  9597     IF CF-ST-REFUND-MIN NOT = ZEROS
  9598        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9599
  9600     IF CF-ST-TOL-PREM  NOT = ZEROS
  9601        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9602                                    WS-TOL-AH-PREM
  9603        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9604
  9605     IF CF-ST-TOL-REFUND NOT = ZEROS
  9606        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9607                                    WS-TOL-AH-REFUND
  9608        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9609
  9610     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9611        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9612        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9613                                    WS-AH-REFUND-OVS-AMT
  9614                                    EC-ST-OVR-SHT-AMT.
  9615
  9616     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9617        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9618        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9619                                    WS-TOL-LF-PREM-PCT
  9620                                    WS-TOL-AH-PREM-PCT.
  9621
  9622     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9623        CF-ST-TOL-REF-PCT GREATER THAN +0
  9624        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9625                                    WS-TOL-LF-REFUND-PCT
  9626                                    WS-TOL-AH-REFUND-PCT.
  9627
  9628     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9629        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9630        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9631                                    WS-AH-REFUND-OVS-PCT
  9632                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 177
* EL050.cbl
  9633
  9634     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9635     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9636
  9637     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9638          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9639
  9640     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9641     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9642     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9643
  9644     IF CF-ST-LF-PREM-TAX NUMERIC
  9645        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9646     END-IF
  9647     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9648        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9649     END-IF
  9650     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9651        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9652     END-IF
  9653
  9654     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9655         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9656     END-IF.
  9657
  9658     IF WS-LF-BENEFIT-CD = ZEROS
  9659        GO TO 0410-CHECK-AH.
  9660
  9661     IF CF-ST-RT-CALC NOT = SPACES
  9662        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9663                                    EC-ST-LF-REM-TERM-CALC
  9664     END-IF
  9665
  9666     IF WS-LF-COVERAGE-TYPE = 'R'
  9667        IF WS-LF-EARNINGS-CALC = '5'
  9668           IF CF-ST-RF-LN-CALC > '0'
  9669              MOVE CF-ST-RF-LN-CALC
  9670                                 TO WS-LF-REFUND-CALC
  9671                                    EC-ST-LF-REFUND-CALC
  9672           END-IF
  9673        ELSE
  9674           IF CF-ST-RF-LR-CALC > '0'
  9675              MOVE CF-ST-RF-LR-CALC
  9676                                 TO WS-LF-REFUND-CALC
  9677                                    EC-ST-LF-REFUND-CALC
  9678           END-IF
  9679        END-IF
  9680     ELSE
  9681        IF CF-ST-RF-LL-CALC > '0'
  9682           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9683                                    EC-ST-LF-REFUND-CALC
  9684        END-IF
  9685     END-IF
  9686
  9687     IF CF-ST-RT-CALC NOT = SPACES
  9688        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9689                                    EC-ST-LF-REM-TERM-CALC
  9690     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 178
* EL050.cbl
  9691
  9692     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9693     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9694
  9695     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9696
  9697     IF NO-BENEFIT-FOUND
  9698        GO TO 0410-CHECK-AH.
  9699
  9700     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9701        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9702                                 TO EC-ST-LF-REM-TERM-CALC
  9703                                    WS-LF-REM-TERM-CALC
  9704     END-IF
  9705
  9706     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9707        MOVE CF-ST-REFUND-CALC (SUB3)
  9708                                 TO WS-LF-REFUND-CALC
  9709                                    EC-ST-LF-REFUND-CALC
  9710     END-IF
  9711*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9712
  9713     .
  9714 0410-CHECK-AH.
  9715
  9716     IF WS-AH-BENEFIT-CD = ZEROS
  9717        GO TO 0500-SET-ACCOUNT.
  9718
  9719     IF CF-ST-RT-CALC NOT = SPACES
  9720        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9721                                    EC-ST-AH-REM-TERM-CALC
  9722     END-IF
  9723
  9724     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9725        IF CF-ST-RF-CP-CALC > '0'
  9726           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9727                                    EC-ST-AH-REFUND-CALC
  9728        END-IF
  9729     ELSE
  9730        IF CF-ST-RF-AH-CALC > '0'
  9731           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9732                                    EC-ST-AH-REFUND-CALC
  9733        END-IF
  9734     END-IF
  9735     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9736     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9737
  9738     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9739
  9740     IF NO-BENEFIT-FOUND
  9741        GO TO 0500-SET-ACCOUNT.
  9742
  9743     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9744        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9745                                 TO WS-AH-REM-TERM-CALC
  9746                                    EC-ST-AH-REM-TERM-CALC
  9747     END-IF
  9748
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 179
* EL050.cbl
  9749     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9750        MOVE CF-ST-REFUND-CALC (SUB3)
  9751                                 TO WS-AH-REFUND-CALC
  9752                                    EC-ST-AH-REFUND-CALC
  9753     END-IF
  9754
  9755*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9756
  9757     GO TO 0500-SET-ACCOUNT.
  9758
  9759 0499-STATE-NOT-FOUND.
  9760
  9761     MOVE ER-2603                TO WS-ERROR.
  9762     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9763
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 180
* EL050.cbl
  9765
  9766 0500-SET-ACCOUNT.
  9767*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9768     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9769        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9770        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9771        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9772        MOVE '3'                 TO CNTL-REC-TYPE
  9773        MOVE +0                  TO CNTL-SEQ-NO
  9774
  9775        MOVE '3'                 TO RC-SW-2
  9776        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9777
  9778        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9779           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9780           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9781           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9782                                    WS-ST-AH-PREM-TAX-I
  9783                                    WS-ST-AH-PREM-TAX-G
  9784        ELSE
  9785           IF CF-ST-LF-PREM-TAX NUMERIC
  9786              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9787           END-IF
  9788           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9789              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9790           END-IF
  9791           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9792              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9793           END-IF
  9794        END-IF
  9795        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9796     END-IF
  9797*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9798*  FOR DCC ONLY
  9799     IF PB-COMPANY-ID = 'DCC'
  9800
  9801     MOVE ' '                    TO STAT-MASTER-SW
  9802     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9803     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9804     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9805     MOVE PB-STATE               TO ELSTAT-STATE
  9806     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9807        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9808     END-IF
  9809
  9810     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9811     SET BIN-TO-GREG             TO TRUE
  9812     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9813     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9814     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9815
  9816     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9817     IF STAT-MASTER-FOUND
  9818        MOVE 'N'                 TO STAT-MASTER-SW
  9819        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9820        IF STAT-MASTER-FOUND
  9821           IF (ELSTAT-KEY-SAVE (1:12) =
  9822                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 181
* EL050.cbl
  9823              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9824                 MOVE 'F'        TO STAT-MASTER-SW
  9825              ELSE
  9826                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9827                 IF (STAT-MASTER-FOUND)
  9828                    AND (ELSTAT-KEY-SAVE (1:12) =
  9829                        SF-CONTROL-PRIMARY (1:12))
  9830                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9831                    MOVE 'F'     TO STAT-MASTER-SW
  9832                 END-IF
  9833              END-IF
  9834           END-IF
  9835        END-IF
  9836     END-IF
  9837
  9838     IF STAT-MASTER-SW = 'F'
  9839        IF SF-ST-LF-PREM-TAX NUMERIC
  9840           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9841        END-IF
  9842        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9843           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9844        END-IF
  9845        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9846           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9847        END-IF
  9848     END-IF
  9849
  9850     END-IF
  9851     IF (PB-COMPANY-ID = 'DCC')
  9852        AND (PB-ISSUE)
  9853        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9854        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9855        AND (AM-GPCD = 06)
  9856        MOVE 'Y'                 TO WS-GOOD-HIN
  9857        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9858           MOVE PB-I-VIN         TO WS-WORK-VIN
  9859           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9860              (V1 > 16)
  9861              IF WS-WORK-VIN (V1:1) NUMERIC
  9862                 MOVE WS-WORK-VIN-N (V1)
  9863                                 TO WS-ROW-B-VAL (V1)
  9864              ELSE
  9865                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9866                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9867                    OR (V2 > 26)
  9868                 END-PERFORM
  9869                 IF V2 < 27
  9870                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9871                 ELSE
  9872                    MOVE 'N'     TO WS-GOOD-HIN
  9873                 END-IF
  9874              END-IF
  9875              COMPUTE WS-ROW-D-VAL (V1) =
  9876                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9877              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9878                 WS-ROW-D-VAL (V1)
  9879           END-PERFORM
  9880           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 182
* EL050.cbl
  9881           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9882             REMAINDER WS-VIN-REMAINDER
  9883           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9884              CONTINUE
  9885           ELSE
  9886              MOVE 'N'           TO WS-GOOD-HIN
  9887           END-IF
  9888        ELSE
  9889           MOVE 'N'              TO WS-GOOD-HIN
  9890        END-IF
  9891        IF WS-GOOD-HIN NOT = 'Y'
  9892           MOVE ER-3826           TO WS-ERROR
  9893           PERFORM 9900-ERROR-FORMAT
  9894                                 THRU 9900-EXIT
  9895        END-IF
  9896     END-IF
  9897     IF (PB-COMPANY-ID = 'DCC')
  9898        AND (PB-ISSUE)
  9899        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9900        AND (AM-GPCD NOT = 06)
  9901        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9902          MOVE PB-I-VIN          TO WS-WORK-VIN
  9903          MOVE +8                TO V2
  9904          MOVE ZEROS             TO WS-VIN-TOTAL
  9905          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9906           (V1 > 17)
  9907             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9908                MOVE ER-3825     TO WS-ERROR
  9909                PERFORM 9900-ERROR-FORMAT
  9910                                 THRU 9900-EXIT
  9911             ELSE
  9912                IF V1 = 8
  9913                   MOVE 10       TO V2
  9914                END-IF
  9915                IF V1 = 9
  9916                   MOVE 0        TO V2
  9917                END-IF
  9918                IF V1 = 10
  9919                   MOVE 9        TO V2
  9920                END-IF
  9921                IF WS-WORK-VIN (V1:1) NUMERIC
  9922                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9923                    + (WS-WORK-VIN-N (V1) * V2)
  9924                ELSE
  9925                   MOVE WS-WORK-VIN (V1:1)
  9926                                 TO WS-HEX-BYTE
  9927                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9928                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9929                    + (WS-NUM (V3) * V2)
  9930                END-IF
  9931                COMPUTE V2 = V2 - 1
  9932             END-IF
  9933          END-PERFORM
  9934          MOVE ZEROS TO WS-VIN-REMAINDER
  9935          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9936             REMAINDER WS-VIN-REMAINDER
  9937          IF ((WS-WORK-VIN (9:1) = 'X')
  9938             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 183
* EL050.cbl
  9939                     OR
  9940             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9941             CONTINUE
  9942          ELSE
  9943             MOVE ER-3826        TO WS-ERROR
  9944             PERFORM 9900-ERROR-FORMAT
  9945                                 THRU 9900-EXIT
  9946          END-IF
  9947        ELSE
  9948          MOVE ER-3826           TO WS-ERROR
  9949          PERFORM 9900-ERROR-FORMAT
  9950                                 THRU 9900-EXIT
  9951        END-IF
  9952     END-IF
  9953******************************************************************
  9954******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9955******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9956******* METHODS.
  9957******************************************************************
  9958     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9959        IF PB-CANCELLATION
  9960           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9961              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9962                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9963                IF FORM-MASTER-FOUND
  9964                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9965******************************************************************
  9966
  9967     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9968     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9969
  9970     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9971     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9972     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9973     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9974
  9975
  9976     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9977     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9978     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9979
  9980     IF AM-LF-OB-RATE NOT NUMERIC
  9981         MOVE ZERO               TO AM-LF-OB-RATE.
  9982
  9983     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9984         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9985
  9986     IF AM-AH-OB-RATE NOT NUMERIC
  9987         MOVE ZERO               TO AM-AH-OB-RATE.
  9988
  9989     IF WS-LF-JOINT-INDICATOR = 'J'
  9990         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9991     ELSE
  9992         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9993
  9994     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9995
  9996     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 184
* EL050.cbl
  9997         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9998
  9999     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10000         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10001                                       WS-IG-OVRD
 10002     ELSE
 10003         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10004             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10005                                       WS-IG-OVRD
 10006         ELSE
 10007             MOVE AM-IG             TO WS-IG-OVRD-AH
 10008                                       WS-IG-OVRD.
 10009
 10010     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10011         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10012                                       WS-IG-OVRD
 10013     ELSE
 10014         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10015             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10016                                       WS-IG-OVRD
 10017         ELSE
 10018             MOVE AM-IG             TO WS-IG-OVRD-LF
 10019                                       WS-IG-OVRD.
 10020
 10021     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10022     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10023     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10024     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10025     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10026
 10027     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10028     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10029     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10030     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10031
 10032     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10033     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10034     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10035     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10036     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10037     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10038     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10039
 10040     IF WS-ACCT-AH-DEV-PCT > +0
 10041        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10042     ELSE
 10043        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10044
 10045     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10046        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10047     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10048        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10049
 10050        IF AM-EARN-METHOD-L = 'S'
 10051            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10052                                        WS-LF-REFUND-CALC.
 10053
 10054        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 185
* EL050.cbl
 10055            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10056                                        WS-LF-REFUND-CALC.
 10057
 10058     IF WS-LF-COVERAGE-TYPE = 'R'
 10059         IF AM-EARN-METHOD-R = 'R'
 10060            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10061                                    WS-LF-REFUND-CALC.
 10062     IF WS-LF-COVERAGE-TYPE = 'R'
 10063         IF AM-EARN-METHOD-R = 'P'
 10064            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10065                                    WS-LF-REFUND-CALC.
 10066     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10067         IF AM-EARN-METHOD-L = 'R'
 10068            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10069                                    WS-LF-REFUND-CALC.
 10070     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10071         IF AM-EARN-METHOD-L = 'P'
 10072            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10073                                    WS-LF-REFUND-CALC.
 10074     IF WS-LF-COVERAGE-TYPE = 'R'
 10075         IF AM-EARN-METHOD-R = 'A'
 10076            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10077                                    WS-LF-REFUND-CALC.
 10078     IF WS-LF-COVERAGE-TYPE = 'R'
 10079         IF AM-EARN-METHOD-R = 'M'
 10080            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10081                                    WS-LF-REFUND-CALC.
 10082     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10083         IF AM-EARN-METHOD-L = 'A'
 10084            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10085                                    WS-LF-REFUND-CALC.
 10086     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10087         IF AM-EARN-METHOD-L = 'M'
 10088            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10089                                    WS-LF-REFUND-CALC.
 10090
 10091     IF AM-EARN-METHOD-A = 'R'
 10092        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10093                                    WS-AH-REFUND-CALC.
 10094     IF AM-EARN-METHOD-A = 'P'
 10095        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10096                                    WS-AH-REFUND-CALC.
 10097     IF AM-EARN-METHOD-A = 'C'
 10098        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10099                                    WS-AH-REFUND-CALC.
 10100     IF AM-EARN-METHOD-A = 'A'
 10101        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10102                                    WS-AH-REFUND-CALC.
 10103     IF AM-EARN-METHOD-A = 'M'
 10104        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10105                                    WS-AH-REFUND-CALC.
 10106     IF AM-EARN-METHOD-A = 'N'
 10107        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10108                                    WS-AH-REFUND-CALC.
 10109     IF AM-EARN-METHOD-A = 'S'
 10110        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10111                                    WS-AH-REFUND-CALC.
 10112
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 186
* EL050.cbl
 10113     IF AM-TOL-PREM NOT = ZEROS
 10114        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10115                                    WS-TOL-AH-PREM.
 10116
 10117     IF AM-OVR-SHT-AMT NUMERIC AND
 10118                  AM-OVR-SHT-AMT > 0
 10119        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10120                                    EC-AM-LF-OVR-SHT-AMT
 10121                                    WS-AH-REFUND-OVS-AMT
 10122                                    EC-AM-AH-OVR-SHT-AMT.
 10123
 10124     IF AM-OVR-SHT-PCT NUMERIC AND
 10125                    AM-OVR-SHT-PCT > 0
 10126        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10127                                    EC-AM-LF-OVR-SHT-PCT
 10128                                    WS-AH-REFUND-OVS-PCT
 10129                                    EC-AM-AH-OVR-SHT-PCT.
 10130
 10131     IF AM-TOL-REF-PCT NUMERIC AND
 10132                  AM-TOL-REF-PCT > 0
 10133        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10134                                    WS-TOL-AH-REFUND-PCT.
 10135
 10136     IF AM-TOL-REF  NOT = ZEROS  AND
 10137                  AM-TOL-REF NUMERIC
 10138        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10139                                    EC-AM-LF-TOL-REFUND
 10140                                    WS-TOL-AH-REFUND
 10141                                    EC-AM-AH-TOL-REFUND.
 10142
 10143     IF AM-TOL-CLM  NOT = ZEROS
 10144        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10145                                    WS-TOL-AH-CLAIM.
 10146
 10147     IF AM-CLP-TOL-PCT NOT NUMERIC
 10148        MOVE +0                  TO AM-CLP-TOL-PCT
 10149     END-IF
 10150
 10151     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10152        MOVE +0                  TO AM-SPP-LEASE-COMM
 10153     END-IF
 10154     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10155        MOVE WS-PL-TOL-LF-PREM-PCT
 10156                                 TO WS-TOL-LF-PREM-PCT.
 10157
 10158     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10159        MOVE WS-PL-TOL-AH-PREM-PCT
 10160                                 TO WS-TOL-AH-PREM-PCT.
 10161
 10162     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10163        MOVE WS-PL-TOL-LF-REFUND-PCT
 10164                                 TO WS-TOL-LF-REFUND-PCT.
 10165
 10166     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10167        MOVE WS-PL-TOL-AH-REFUND-PCT
 10168                                 TO WS-TOL-AH-REFUND-PCT.
 10169
 10170     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 187
* EL050.cbl
 10171        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10172
 10173     IF WS-PL-REF-OVS-PCT > +0
 10174        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10175
 10176     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10177        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10178     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10179        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10180     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10181        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10182     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10183        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10184     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10185        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10186     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10187        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10188
 10189     IF WS-AH-PL-REF-OVS-AMT > +0
 10190        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10191
 10192     IF WS-AH-PL-REF-OVS-PCT > +0
 10193        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10194
 10195     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10196     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10197
 10198     IF PB-CANCELLATION
 10199        GO TO 3000-CONTINUE-EDIT.
 10200
 10201     MOVE +1 TO SUB1.
 10202     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10203     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10204
 10205     IF CF-COMPANY-ID = 'DMD'
 10206       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10207         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10208        ELSE
 10209         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10210
 10211  0525-FIND-ACCT-COMM.
 10212     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10213        NEXT SENTENCE
 10214      ELSE
 10215         ADD +1 TO SUB1
 10216         IF SUB1 LESS +11
 10217            GO TO 0525-FIND-ACCT-COMM
 10218          ELSE
 10219             GO TO 0560-EDIT-CONTINUE.
 10220
 10221     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10222     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10223                                    PB-I-LIFE-COMMISSION.
 10224***  IF PB-COMPANY-ID = 'CRI'
 10225     IF PB-PREM-ACCTNG-ONLY
 10226         GO TO 0560-EDIT-CONTINUE.
 10227
 10228     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 188
* EL050.cbl
 10229     MOVE ' '    TO WS-CTBL-READ-SW.
 10230
 10231
 10232 0530-GET-AH-COMP.
 10233     IF NO-AH-COVERAGE  OR
 10234        NO-AH-BENEFIT-MATCH
 10235           GO TO 0540-NEXT-READ-STEP.
 10236
 10237     IF AM-A-COM (SUB1) NUMERIC
 10238        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10239         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10240         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10241         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10242         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10243     ELSE
 10244          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10245          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10246          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10247          MOVE ZEROS             TO WS-SUB1
 10248                                    WS-COMMISSION
 10249          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10250          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10251          IF WS-COMMISSION > ZEROS
 10252             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10253             GO TO 0540-NEXT-READ-STEP
 10254          END-IF
 10255          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10256          IF CTBL-TABLE-FOUND
 10257             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10258                                        PB-I-AH-TERM
 10259             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10260             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10261             GO TO 0540-NEXT-READ-STEP
 10262          ELSE
 10263             IF FIRST-TIME-THROUGH
 10264                 GO TO 0530-GET-AH-COMP
 10265             ELSE
 10266                 MOVE ER-2609                TO WS-ERROR
 10267                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10268
 10269 0540-NEXT-READ-STEP.
 10270     MOVE '0540' TO CTBL-SW.
 10271     MOVE ' '    TO WS-CTBL-READ-SW.
 10272
 10273 0540-GET-LF-COMP.
 10274     IF NO-LIFE-COVERAGE  OR
 10275        NO-LF-BENEFIT-MATCH
 10276           GO TO 0560-EDIT-CONTINUE.
 10277
 10278     IF WS-LF-JOINT-INDICATOR = 'J'
 10279        IF AM-J-COM (SUB1) NUMERIC
 10280           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10281           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10282           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10283           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10284           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10285        ELSE
 10286           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 189
* EL050.cbl
 10287           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10288           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10289           MOVE ZEROS                TO WS-SUB1
 10290                                        WS-COMMISSION
 10291           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10292           IF WS-COMMISSION > ZEROS
 10293              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10294              GO TO 0560-EDIT-CONTINUE
 10295           END-IF
 10296           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10297           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10298           IF CTBL-TABLE-FOUND
 10299              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10300              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10301              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10302              GO TO 0560-EDIT-CONTINUE
 10303           ELSE
 10304              IF FIRST-TIME-THROUGH
 10305                  GO TO 0540-GET-LF-COMP
 10306              ELSE
 10307                  MOVE ER-2609                TO WS-ERROR
 10308                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10309                  GO TO 0560-EDIT-CONTINUE.
 10310
 10311     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10312        IF AM-L-COM (SUB1) NUMERIC
 10313           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10314           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10315           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10316           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10317           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10318        ELSE
 10319           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10320           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10321           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10322           MOVE ZEROS                TO WS-SUB1
 10323                                        WS-COMMISSION
 10324           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10325           IF WS-COMMISSION IS GREATER THAN ZEROS
 10326              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10327              GO TO 0560-EDIT-CONTINUE
 10328           END-IF
 10329           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10330           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10331           IF CTBL-TABLE-FOUND
 10332              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10333              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10334              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10335              GO TO 0560-EDIT-CONTINUE
 10336           ELSE
 10337              IF FIRST-TIME-THROUGH
 10338                  GO TO 0540-GET-LF-COMP
 10339              ELSE
 10340                  MOVE ER-2609                TO WS-ERROR
 10341                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10342
 10343*    GO TO 0560-EDIT-CONTINUE.
 10344
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 190
* EL050.cbl
 10345 0560-EDIT-CONTINUE.
 10346     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10347                                    WS-AH-PMF-COMM
 10348*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10349*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10350     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10351        (SUB1 > +10)
 10352        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10353           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10354           MOVE '0530'           TO CTBL-SW
 10355           MOVE ' '              TO WS-CTBL-READ-SW
 10356           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10357           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10358           MOVE '0540'           TO CTBL-SW
 10359           MOVE ' '              TO WS-CTBL-READ-SW
 10360           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10361        END-IF
 10362     END-PERFORM
 10363     GO TO 0564-EDIT-CONTINUE
 10364     .
 10365 0561-CHECK-AH.
 10366     IF (NO-AH-COVERAGE)
 10367        OR (NO-AH-BENEFIT-MATCH)
 10368        CONTINUE
 10369     ELSE
 10370        IF (AM-A-COM (SUB1) NUMERIC)
 10371           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10372           IF (AM-COM-TYP (SUB1) = 'A')
 10373              AND (WS-AH-PMF-COMM = ZEROS)
 10374              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10375           END-IF
 10376           CONTINUE
 10377        ELSE
 10378           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10379           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10380           MOVE PB-AH-OVERRIDE-L1
 10381                                 TO CTBL-BEN-TYPE
 10382           MOVE ZEROS            TO WS-SUB1
 10383                                    WS-COMMISSION
 10384           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10385           PERFORM 8300-READ-CTBL-TABLE
 10386                                 THRU 8300-EXIT
 10387           IF CTBL-TABLE-FOUND
 10388              IF (AM-COM-TYP (SUB1) = 'A')
 10389                 AND (WS-AH-PMF-COMM = ZEROS)
 10390                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10391                                        PB-I-AH-TERM
 10392                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10393                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10394              END-IF
 10395              CONTINUE
 10396           ELSE
 10397              IF FIRST-TIME-THROUGH
 10398                 GO TO 0561-CHECK-AH
 10399              ELSE
 10400                 MOVE ER-2609    TO WS-ERROR
 10401                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10402              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 191
* EL050.cbl
 10403           END-IF
 10404        END-IF
 10405     END-IF
 10406     .
 10407 0561-EXIT.
 10408     EXIT.
 10409 0563-CHECK-LF.
 10410     IF (NO-LIFE-COVERAGE)
 10411        OR (NO-LF-BENEFIT-MATCH)
 10412        CONTINUE
 10413     ELSE
 10414        IF WS-LF-JOINT-INDICATOR = 'J'
 10415           IF AM-J-COM (SUB1) NUMERIC
 10416              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10417              IF (AM-COM-TYP (SUB1) = 'A')
 10418                 AND (WS-LF-PMF-COMM = ZEROS)
 10419                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10420              END-IF
 10421              CONTINUE
 10422           ELSE
 10423              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10424              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10425              MOVE PB-LIFE-OVERRIDE-L1
 10426                                 TO CTBL-BEN-TYPE
 10427              MOVE ZEROS         TO WS-SUB1
 10428                                    WS-COMMISSION
 10429              MOVE AM-J-COMA (SUB1)
 10430                                 TO CTBL-TABLE
 10431              PERFORM 8300-READ-CTBL-TABLE
 10432                                 THRU 8300-EXIT
 10433              IF CTBL-TABLE-FOUND
 10434                 IF (AM-COM-TYP (SUB1) = 'A')
 10435                    AND (WS-LF-PMF-COMM = ZEROS)
 10436                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10437                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10438                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10439                 END-IF
 10440                 CONTINUE
 10441              ELSE
 10442                 IF FIRST-TIME-THROUGH
 10443                    GO TO 0563-CHECK-LF
 10444                 ELSE
 10445                    MOVE ER-2609 TO WS-ERROR
 10446                    PERFORM 9900-ERROR-FORMAT
 10447                                 THRU 9900-EXIT
 10448*                   GO TO 0560-EDIT-CONTINUE
 10449                 END-IF
 10450              END-IF
 10451           END-IF
 10452        ELSE
 10453           IF AM-L-COM (SUB1) NUMERIC
 10454              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10455              IF (AM-COM-TYP (SUB1) = 'A')
 10456                 AND (WS-LF-PMF-COMM = ZEROS)
 10457                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10458              END-IF
 10459              CONTINUE
 10460           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 192
* EL050.cbl
 10461              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10462              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10463              MOVE PB-LIFE-OVERRIDE-L1
 10464                                 TO CTBL-BEN-TYPE
 10465              MOVE ZEROS         TO WS-SUB1
 10466                                    WS-COMMISSION
 10467              MOVE AM-L-COMA (SUB1)
 10468                                 TO CTBL-TABLE
 10469              PERFORM 8300-READ-CTBL-TABLE
 10470                                 THRU 8300-EXIT
 10471              IF CTBL-TABLE-FOUND
 10472                 CONTINUE
 10473              ELSE
 10474                 IF FIRST-TIME-THROUGH
 10475                    GO TO 0563-CHECK-LF
 10476                 ELSE
 10477                    MOVE ER-2609 TO WS-ERROR
 10478                    PERFORM 9900-ERROR-FORMAT
 10479                                 THRU 9900-EXIT
 10480                 END-IF
 10481              END-IF
 10482           END-IF
 10483        END-IF
 10484     END-IF
 10485     .
 10486 0563-EXIT.
 10487     EXIT.
 10488 0564-EDIT-CONTINUE.
 10489
 10490     IF  PB-COMPANY-ID EQUAL 'DMD'
 10491         IF PB-I-NUM-BILLED EQUAL ZEROS
 10492            MOVE ER-8148       TO WS-ERROR
 10493            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10494
 10495*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10496*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10497*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10498*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10499*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10500*         IF NO-CONVERSION-ERROR
 10501*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10502*         ELSE
 10503*             IF PB-COMPANY-ID EQUAL 'HAN'
 10504*                 MOVE ZEROS     TO PB-I-AGE.
 10505     IF PB-I-BIRTHDAY > LOW-VALUES
 10506        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10507        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10508        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10509        PERFORM 8500-DATE-CONVERT
 10510                                 THRU 8500-EXIT
 10511        IF NO-CONVERSION-ERROR
 10512           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10513           IF PB-I-AGE > ZEROS
 10514              IF WS-WORK-AGE NOT = PB-I-AGE
 10515                 MOVE ER-9501    TO WS-ERROR
 10516                 PERFORM 9900-ERROR-FORMAT
 10517                                 THRU 9900-EXIT
 10518              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 193
* EL050.cbl
 10519           ELSE
 10520              MOVE WS-WORK-AGE   TO PB-I-AGE
 10521           END-IF
 10522        END-IF
 10523     END-IF
 10524     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10525                                   WS-INS-AGE-SET
 10526     IF PB-I-AGE = ZEROS
 10527        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10528           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10529                                   WS-INS-AGE-SET
 10530           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10531
 10532     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10533                                   WS-AH-EDIT-AGE.
 10534
 10535     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10536        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10537        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10538        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10539        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10540        IF NO-CONVERSION-ERROR
 10541           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10542           IF PB-I-JOINT-AGE > 0
 10543              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10544                 MOVE ER-9503    TO WS-ERROR
 10545                 PERFORM 9900-ERROR-FORMAT
 10546                                 THRU 9900-EXIT
 10547              END-IF
 10548           ELSE
 10549              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10550           END-IF
 10551        ELSE
 10552           MOVE ZEROS            TO PB-I-JOINT-AGE
 10553        END-IF
 10554     END-IF
 10555     IF PB-I-JOINT-AGE NOT NUMERIC
 10556        MOVE ZERO               TO PB-I-JOINT-AGE.
 10557
 10558     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10559                                   WS-JNT-AGE-SET
 10560     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10561        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10562           (WS-AH-JOINT-INDICATOR = 'J')
 10563           IF PB-I-JOINT-AGE = ZEROS
 10564               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10565                                          WS-JNT-AGE-SET
 10566               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10567           END-IF
 10568        END-IF
 10569     END-IF
 10570
 10571     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10572     IF WS-LF-JOINT-INDICATOR = 'J'
 10573        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10574        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10575            IF  PB-I-JOINT-AGE = ZERO
 10576                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 194
* EL050.cbl
 10577                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10578            ELSE
 10579                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10580                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10581                    IF PB-COMPANY-ID NOT = 'LBL'
 10582                        MOVE ER-2685    TO WS-ERROR
 10583                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10584
 10585     IF WS-AH-JOINT-INDICATOR = 'J'
 10586        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10587            IF  PB-I-JOINT-AGE = ZERO
 10588                MOVE ER-2686       TO WS-ERROR
 10589                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10590            ELSE
 10591                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10592                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10593                                           WS-EDIT-AGE
 10594                    IF PB-COMPANY-ID NOT = 'LBL'
 10595                        MOVE ER-2685    TO WS-ERROR
 10596                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10597
 10598******************************************************************
 10599*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10600******************************************************************
 10601
 10602     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10603        (WS-AH-SPECIAL-CALC-CD = 'O')
 10604        NEXT SENTENCE
 10605     ELSE
 10606        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10607          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10608           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10609            WS-AH-JOINT-INDICATOR = 'J')  AND
 10610           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10611            MOVE ER-2627             TO WS-ERROR
 10612            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10615        (WS-AH-SPECIAL-CALC-CD = 'O')
 10616         NEXT SENTENCE
 10617     ELSE
 10618         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10619            WS-AH-JOINT-INDICATOR = 'J'
 10620             IF PB-I-JOINT-INSURED = SPACES
 10621                 IF PB-COMPANY-ID NOT = 'JAL'
 10622                     MOVE ER-2696    TO WS-ERROR
 10623                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10624
 10625     IF PB-COMPANY-ID NOT = 'BOA'
 10626        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10627           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10628           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10629               PB-I-JOINT-INSURED NOT = SPACES)
 10630                MOVE ER-2691         TO WS-ERROR
 10631                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10632
 10633     IF PB-COMPANY-ID = 'BOA'
 10634        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 195
* EL050.cbl
 10635           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10636            IF PB-I-JOINT-AGE NOT = ZEROS
 10637                MOVE ER-2691         TO WS-ERROR
 10638                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10639
 10640     IF PB-COMPANY-ID = 'CRI'
 10641        IF PB-I-SIG-SW = 'J'
 10642           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10643              WS-AH-JOINT-INDICATOR NOT = 'J'
 10644              MOVE ER-2675       TO WS-ERROR
 10645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10646
 10647     IF PB-COMPANY-ID = 'CRI'
 10648        IF PB-I-SIG-SW = 'S'
 10649           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10650              WS-AH-JOINT-INDICATOR = 'J'
 10651              MOVE ER-2676       TO WS-ERROR
 10652              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10653
 10654     IF PB-COMPANY-ID = 'CVL'
 10655         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10656            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10657              MOVE ER-2783           TO WS-ERROR
 10658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10659     IF (WS-LF-JOINT-INDICATOR = 'J')
 10660        AND (WS-AH-JOINT-INDICATOR = 'J')
 10661        AND (PB-I-LF-TERM > 120)
 10662        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10663        MOVE ER-2783             TO WS-ERROR
 10664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10665     END-IF
 10666     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10667
 10668     IF PB-I-INDV-GRP-OVRD = 'I'
 10669        MOVE ER-2666             TO WS-ERROR
 10670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10672
 10673     IF PB-I-INDV-GRP-OVRD = 'G'
 10674        MOVE ER-2666             TO WS-ERROR
 10675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10676        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10677
 10678     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10679        NEXT SENTENCE
 10680     ELSE
 10681        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10682
 10683     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10684        IF WS-ERROR = ER-2666
 10685           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10686           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10687
 10688     IF PB-COMPANY-ID = 'CID'
 10689        IF PB-STATE = 'UT' OR 'MO'
 10690           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10691                 OR '76' OR '77')
 10692                      OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 196
* EL050.cbl
 10693               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10694                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10695                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10696                   OR '2K' OR '2L'))
 10697              AND PB-I-INDV-GRP-CD = 'I'
 10698              MOVE ER-2721             TO WS-ERROR
 10699              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10700           END-IF
 10701        END-IF
 10702     END-IF
 10703
 10704     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10705     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10706        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10707     ELSE
 10708        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10709     END-IF
 10710
 10711*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10712*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10713     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10714                                    ACCOUNT-AH-CK-SW.
 10715
 10716     IF PB-REISSUED-CERT       OR
 10717        PB-REIN-ONLY-CERT      OR
 10718        PB-POLICY-IS-DECLINED  OR
 10719        PB-POLICY-IS-VOIDED
 10720*       OR PB-MONTHLY-CERT
 10721         GO TO 3000-CONTINUE-EDIT.
 10722
 10723     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10724        IF WS-EDIT-AGE           > +65
 10725           MOVE ER-2709          TO WS-ERROR
 10726           PERFORM 9900-ERROR-FORMAT
 10727                                 THRU 9900-EXIT
 10728        ELSE
 10729           IF WS-EDIT-AGE        > +55
 10730              MOVE ER-2718       TO WS-ERROR
 10731              PERFORM 9900-ERROR-FORMAT
 10732                                 THRU 9900-EXIT
 10733           END-IF
 10734        END-IF
 10735     IF PB-COMPANY-ID = 'DCC'
 10736        IF WS-EDIT-AGE           > +65
 10737           MOVE ER-2709          TO WS-ERROR
 10738           PERFORM 9900-ERROR-FORMAT
 10739                                 THRU 9900-EXIT
 10740        END-IF
 10741     END-IF
 10742     .
 10743
 10744 0565-LIFE-PLAN-LIMIT-EDITS.
 10745
 10746     IF NOT LF-PLAN-MASTER-FOUND
 10747        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10748                                    EC-AM-LF-MAX-TOT-BEN
 10749        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10750
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 197
* EL050.cbl
 10751     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10752
 10753     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10754         IF PL-LM-AGE (1) = ZEROS
 10755             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10756
 10757     IF NO-LF-BENEFIT-MATCH          OR
 10758        WS-LF-BENEFIT-CD = ZEROS     OR
 10759        WS-LF-SPECIAL-CALC-CD = 'M'
 10760        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10761
 10762     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10763     MOVE +1                     TO SUB2.
 10764
 10765     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10766        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10767           MOVE +5   TO SUB2
 10768           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10769              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10770              (PL-LM-AGE (SUB2) EQUAL +0)
 10771              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10772              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10773
 10774     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10775
 10776     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10777                               + PB-I-LF-ALT-BENEFIT-AMT.
 10778
 10779 0568-CHECK-LIFE-ATT-AGE.
 10780
 10781     IF PL-ATT-AGE NUMERIC AND
 10782        PL-ATT-AGE > +0
 10783        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10784     END-IF
 10785*    IF PL-ATT-AGE NUMERIC AND
 10786*       PL-ATT-AGE > +0
 10787*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10788*       IF PB-I-BIRTHDAY > LOW-VALUES
 10789*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10790*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10791*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10792*          SET BIN-PLUS-ELAPSED  TO TRUE
 10793*          PERFORM 8500-DATE-CONVERT
 10794*                                THRU 8500-EXIT
 10795*          IF NO-CONVERSION-ERROR
 10796*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10797*             MOVE ER-2669       TO WS-ERROR
 10798*             PERFORM 9900-ERROR-FORMAT
 10799*                                THRU 9900-EXIT
 10800*          END-IF
 10801*       ELSE
 10802*          IF WS-ATT-AGE >= PL-ATT-AGE
 10803*             MOVE ER-2669       TO WS-ERROR
 10804*             PERFORM 9900-ERROR-FORMAT
 10805*                                THRU 9900-EXIT
 10806*          END-IF
 10807*       END-IF
 10808*    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 198
* EL050.cbl
 10809     .
 10810 0570-CHECK-LIFE-LIMITS.
 10811
 10812     IF PB-COMPANY-ID EQUAL 'CRI'
 10813        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10814           IF SUB2 GREATER THAN +4
 10815              MOVE ER-2637 TO WS-ERROR
 10816              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10817              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10818
 10819     IF PB-COMPANY-ID  =  'NCL'
 10820        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10821            SUB2 GREATER THAN +8
 10822             MOVE 'U'         TO PB-BATCH-ENTRY
 10823             MOVE ER-2637     TO WS-ERROR
 10824             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10825             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10826
 10827     IF SUB2 > +8
 10828        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10829           AND (PB-I-SIG-SW = 'Y')
 10830           CONTINUE
 10831        ELSE
 10832           MOVE ER-2637          TO WS-ERROR
 10833           PERFORM 9900-ERROR-FORMAT
 10834                                 THRU 9900-EXIT
 10835        END-IF
 10836        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10837     END-IF
 10838     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10839     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10840     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10841
 10842     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10843        ADD +1  TO SUB2
 10844        GO TO 0570-CHECK-LIFE-LIMITS.
 10845
 10846     IF PB-COMPANY-ID = 'NCL'
 10847         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10848
 10849     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10850        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10851        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10852           AND (PB-I-SIG-SW = 'Y')
 10853           CONTINUE
 10854        ELSE
 10855           MOVE ER-2637          TO WS-ERROR
 10856           PERFORM 9900-ERROR-FORMAT
 10857                                 THRU 9900-EXIT
 10858        END-IF
 10859     END-IF
 10860     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10861
 10862
 10863 0570-CHECK-NCL-LIFE-LIMITS.
 10864
 10865     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10866        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 199
* EL050.cbl
 10867         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10868
 10869     IF APP-CERT-USED
 10870         IF SUB2  LESS THAN  +5
 10871             MOVE +5          TO SUB2
 10872             GO TO 0570-CHECK-LIFE-LIMITS.
 10873
 10874     MOVE ER-2637             TO WS-ERROR.
 10875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10876
 10877     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10878
 10879 0575-CHECK-NCL-SIG-SWITCH.
 10880
 10881     IF NOT APP-CERT-USED
 10882         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10883
 10884     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10885        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10886        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10887        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10888         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10889
 10890     IF SUB2 GREATER THAN +4
 10891         IF PL-LM-AGE (5) = ZEROS  AND
 10892            PL-LM-AGE (6) = ZEROS  AND
 10893            PL-LM-AGE (7) = ZEROS  AND
 10894            PL-LM-AGE (8) = ZEROS
 10895             MOVE  ER-1927        TO WS-ERROR
 10896             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10897             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10898         ELSE
 10899             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10900                 MOVE  ER-1920    TO WS-ERROR
 10901                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10902
 10903     IF PB-I-SIG-SW  = 'Y'
 10904       IF NOT PB-I-POLICY-ACCEPTED  AND
 10905          NOT PB-I-POLICY-DECLINED
 10906           MOVE 'U'               TO PB-BATCH-ENTRY
 10907           MOVE  ER-1926          TO WS-ERROR
 10908           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10909
 10910
 10911 0580-AH-PLAN-LIMIT-EDITS.
 10912
 10913     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10914        IF PB-I-AH-BENEFIT-AMT > +1250
 10915           MOVE ER-2702          TO WS-ERROR
 10916           PERFORM 9900-ERROR-FORMAT
 10917                                 THRU 9900-EXIT
 10918        END-IF
 10919     END-IF
 10920
 10921     IF (PB-COMPANY-ID = 'DCC')
 10922        AND (PB-MONTHLY-CERT)
 10923        IF PB-I-AH-BENEFIT-AMT > +3000
 10924           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 200
* EL050.cbl
 10925           PERFORM 9900-ERROR-FORMAT
 10926                                 THRU 9900-EXIT
 10927        END-IF
 10928     END-IF
 10929     IF NOT AH-PLAN-MASTER-FOUND
 10930        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10931        GO TO 3000-CONTINUE-EDIT.
 10932
 10933     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10934
 10935     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10936         IF PL-LM-AGE (1) = ZEROS
 10937             GO TO 3000-CONTINUE-EDIT.
 10938
 10939     IF NO-AH-BENEFIT-MATCH          OR
 10940        WS-AH-BENEFIT-CD = ZEROS     OR
 10941        WS-AH-SPECIAL-CALC-CD = 'M'
 10942        GO TO 3000-CONTINUE-EDIT.
 10943
 10944     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10945     MOVE +1                     TO SUB2.
 10946
 10947     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10948        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10949           MOVE +5 TO SUB2
 10950           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10951              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10952              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10953              (PL-LM-AGE (SUB2) EQUAL +0)
 10954              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10955              GO TO 3000-CONTINUE-EDIT.
 10956
 10957     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10958
 10959 0590-CHECK-AH-ATT-AGE.
 10960
 10961     IF PL-ATT-AGE NUMERIC AND
 10962        PL-ATT-AGE GREATER THAN +0
 10963        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10964     END-IF
 10965*       IF WS-ATT-AGE >= PL-ATT-AGE
 10966*          MOVE ER-3054          TO WS-ERROR
 10967*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10968     .
 10969 0597-CHECK-AH-LIMITS.
 10970
 10971     IF PB-COMPANY-ID EQUAL 'CRI'
 10972        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10973           IF SUB2 GREATER THAN +4
 10974              MOVE ER-2638       TO WS-ERROR
 10975              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10976              GO TO 3000-CONTINUE-EDIT.
 10977
 10978     IF PB-COMPANY-ID  =  'NCL'
 10979        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10980            SUB2 GREATER THAN +8
 10981             MOVE 'U'            TO PB-BATCH-ENTRY
 10982             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 201
* EL050.cbl
 10983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10984             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10985
 10986     IF SUB2 > +8
 10987        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10988           AND (PB-I-SIG-SW = 'Y')
 10989           CONTINUE
 10990        ELSE
 10991           MOVE ER-2638          TO WS-ERROR
 10992           PERFORM 9900-ERROR-FORMAT
 10993                                 THRU 9900-EXIT
 10994        END-IF
 10995        GO TO 3000-CONTINUE-EDIT
 10996     END-IF
 10997
 10998     IF PB-COMPANY-ID = 'CRI'
 10999        IF WS-ERROR = ER-2638
 11000           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11001
 11002     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11003     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11004     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11005     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11006
 11007     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11008        ADD +1                   TO SUB2
 11009        GO TO 0597-CHECK-AH-LIMITS.
 11010
 11011     IF PB-COMPANY-ID = 'NCL'
 11012         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11013
 11014     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11015        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11016        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11017                                 > PL-LM-AMT (SUB2))
 11018        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11019           AND (PB-I-SIG-SW = 'Y')
 11020           CONTINUE
 11021        ELSE
 11022           MOVE ER-2638          TO WS-ERROR
 11023           PERFORM 9900-ERROR-FORMAT
 11024                                 THRU 9900-EXIT
 11025        END-IF
 11026     END-IF
 11027
 11028     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11029         IF  WS-ERROR    EQUAL    ER-2638
 11030             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11031                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11032                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11033                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11034                MOVE  ER-1910    TO  WS-ERROR
 11035                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11036
 11037     IF PB-COMPANY-ID = 'CRI'
 11038        IF WS-ERROR = ER-2638
 11039            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11040            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 202
* EL050.cbl
 11041            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11042
 11043     GO TO 3000-CONTINUE-EDIT.
 11044
 11045 0597-CHECK-NCL-AH-LIMITS.
 11046
 11047     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11048        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11049        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11050                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11051         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11052
 11053     IF APP-CERT-USED
 11054         IF SUB2  LESS THAN  +5
 11055             MOVE +5             TO SUB2
 11056             GO TO 0597-CHECK-AH-LIMITS.
 11057
 11058     MOVE ER-2638                TO WS-ERROR.
 11059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11060
 11061     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11062
 11063 0599-CHECK-NCL-SIG-SWITCH.
 11064
 11065     IF NOT APP-CERT-USED
 11066         GO TO 3000-CONTINUE-EDIT.
 11067
 11068     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11069        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11070        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11071        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11072         GO TO 3000-CONTINUE-EDIT.
 11073
 11074     IF SUB2 GREATER THAN +4
 11075         IF PL-LM-AGE (5) = ZEROS  AND
 11076            PL-LM-AGE (6) = ZEROS  AND
 11077            PL-LM-AGE (7) = ZEROS  AND
 11078            PL-LM-AGE (8) = ZEROS
 11079             MOVE  ER-1927        TO WS-ERROR
 11080             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11081             GO TO 3000-CONTINUE-EDIT
 11082         ELSE
 11083             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11084                 MOVE  ER-1920    TO WS-ERROR
 11085                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11086
 11087     IF PB-I-SIG-SW  = 'Y'
 11088       IF NOT PB-I-POLICY-ACCEPTED  AND
 11089          NOT PB-I-POLICY-DECLINED
 11090           MOVE 'U'               TO PB-BATCH-ENTRY
 11091           MOVE  ER-1926          TO WS-ERROR
 11092           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11093
 11094******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 203
* EL050.cbl
 11096
 11097 3000-CONTINUE-EDIT.
 11098
 11099     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11100     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11101     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11102     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11103     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11104
 11105     IF BROWSE-STARTED
 11106        PERFORM 9990-RETURN THRU 9990-EXIT
 11107        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11108
 11109     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11110        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11111        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11112        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11113*       MOVE 1                   TO DC-OPTION-CODE
 11114        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11115        IF DATE-CONVERSION-ERROR
 11116           MOVE ER-2622          TO WS-ERROR
 11117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11118        ELSE
 11119           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11120              MOVE ER-2623       TO WS-ERROR
 11121              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11122           ELSE
 11123              MOVE ER-2622       TO WS-ERROR
 11124              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11127     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11128     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11129*    MOVE 1                      TO DC-OPTION-CODE.
 11130     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11131     IF DATE-CONVERSION-ERROR
 11132        GO TO 3005-EDIT-CONTINUE
 11133     ELSE
 11134        IF DC-ELAPSED-DAYS GREATER +180
 11135           MOVE ER-2613          TO WS-ERROR
 11136           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11137        ELSE
 11138           IF DC-ELAPSED-DAYS GREATER +90
 11139              MOVE ER-2612       TO WS-ERROR
 11140              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11141           ELSE
 11142             IF DC-ELAPSED-DAYS GREATER +60
 11143                MOVE ER-2614     TO WS-ERROR
 11144                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11145
 11146 3005-EDIT-CONTINUE.
 11147
 11148     IF PB-CANCELLATION
 11149         GO TO 3700-EDIT-CANCEL.
 11150
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 204
* EL050.cbl
 11152******************************************************************
 11153*                  E D I T   I S S U E                           *
 11154******************************************************************
 11155
 11156 3020-EDIT-ISSUE.
 11157
 11158      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11159      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11160      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11161      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11162      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11163
 11164     IF PB-ISSUE-FORCE
 11165        OR PB-ISSUE-DATE-FORCED
 11166        OR PB-FORCE-OFF
 11167        OR PB-OVERCHARGE-FORCE
 11168        CONTINUE
 11169     ELSE
 11170        MOVE ER-2670             TO WS-ERROR
 11171        PERFORM 9900-ERROR-FORMAT
 11172                                 THRU 9900-EXIT
 11173     END-IF
 11174     .
 11175 3022-SET-POLICY-STATUS.
 11176
 11177     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11178
 11179     IF (PB-REISSUED-CERT)
 11180             OR
 11181        ((PB-COMPANY-ID NOT = 'DCC')
 11182         AND (PB-MONTHLY-CERT))
 11183         MOVE '5'                TO PB-I-ENTRY-STATUS
 11184         MOVE 'E'                TO PB-BATCH-ENTRY
 11185     END-IF
 11186
 11187     IF PB-COMPANY-ID = 'DCC'
 11188        IF PB-MONTHLY-CERT
 11189           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11190        END-IF
 11191     END-IF
 11192     IF PB-POLICY-IS-DECLINED
 11193         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11194     IF PB-POLICY-IS-VOIDED
 11195         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11196     IF PB-NEEDS-UNDERWRITING
 11197         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11198     IF PB-REIN-ONLY-CERT
 11199         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11200     IF PB-PREM-ACCTNG-ONLY
 11201         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11202
 11203     MOVE SPACE                  TO PB-I-OB-FLAG.
 11204
 11205     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11206         MOVE ER-2665            TO WS-ERROR
 11207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11208         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11209
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 205
* EL050.cbl
 11210     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11211        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11212           MOVE 'Z'             TO PB-I-OB-FLAG.
 11213
 11214     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11215        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11216           MOVE 'Z'             TO PB-I-OB-FLAG.
 11217
 11218     IF ACCOUNT-MAST-FOUND
 11219         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11220         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11221         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11222         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11223         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11224         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11225         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11226     END-IF
 11227
 11228     IF ACCOUNT-MAST-FOUND
 11229        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11230         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11231
 11232     IF (ACCOUNT-MAST-FOUND)
 11233        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11234        IF PB-REISSUED-CERT
 11235           CONTINUE
 11236        ELSE
 11237           MOVE ER-2608          TO WS-ERROR
 11238           PERFORM 9900-ERROR-FORMAT
 11239                                 THRU 9900-EXIT
 11240         END-IF
 11241     END-IF
 11242
 11243     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11244        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11245        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11246
 11247**********   DMD CUSTOM CODE FOLLOWS  **********
 11248 3024-EDIT-DMD-FIELDS.
 11249     IF PB-COMPANY-ID NOT = 'DMD'
 11250        GO TO 3025-EDIT-REINSURANCE.
 11251
 11252*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11253*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11254*** ERROR IF THEY ARE NOT EQUAL.
 11255
 11256     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11257     SET BIN-TO-GREG               TO TRUE.
 11258     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11259     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11260**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11261
 11262     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11263     SET BIN-TO-GREG               TO TRUE.
 11264     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11265     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11266**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11267
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 206
* EL050.cbl
 11268     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11269        MOVE ER-8116               TO WS-ERROR
 11270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11273
 11274     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11275                                      WK-FULL-CERT-NO.
 11276     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11277
 11278     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11279
 11280     IF PB-VALID-LIFE
 11281        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11282     ELSE
 11283        IF PB-VALID-AH
 11284          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11285
 11286
 11287     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11288     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11289     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11290                                      DCUA-UNDRWRTR-CODE
 11291                                      DCUA-UNDRWRTR-GROUP-CODE
 11292                                      DCUA-RETURN-CODE.
 11293
 11294****************************************************************
 11295*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11296***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11297***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11298***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11299***   TO THIS RECORD.                                        ***
 11300****************************************************************
 11301     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11302     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11303     IF DCUA-SUCCESSFUL-PROCESS
 11304        GO TO 3024-EDIT-DL7-CONT.
 11305
 11306     IF DCUA-RETURN-CODE EQUAL '01'
 11307        MOVE ER-8110               TO WS-ERROR
 11308        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310        GO TO 3024-EDIT-DL7-CONT.
 11311
 11312     IF DCUA-RETURN-CODE EQUAL '02'
 11313        MOVE ER-8111               TO WS-ERROR
 11314        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11316        GO TO 3024-EDIT-DL7-CONT.
 11317
 11318     IF DCUA-RETURN-CODE EQUAL '03'
 11319        MOVE ER-8074               TO WS-ERROR
 11320        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11322        GO TO 3024-EDIT-DL7-CONT.
 11323
 11324     IF DCUA-RETURN-CODE EQUAL '04'
 11325        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 207
* EL050.cbl
 11326        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11328        GO TO 3024-EDIT-DL7-CONT.
 11329
 11330     IF DCUA-RETURN-CODE EQUAL '05'
 11331        MOVE ER-8076               TO WS-ERROR
 11332        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 3024-EDIT-DL7-CONT.
 11335
 11336     IF DCUA-RETURN-CODE EQUAL '06'
 11337        MOVE ER-8077               TO WS-ERROR
 11338        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11340        GO TO 3024-EDIT-DL7-CONT.
 11341
 11342     IF DCUA-RETURN-CODE EQUAL '07'
 11343        MOVE ER-8078               TO WS-ERROR
 11344        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11346        GO TO 3024-EDIT-DL7-CONT.
 11347
 11348     IF DCUA-RETURN-CODE EQUAL 'E1'
 11349        MOVE ER-8079               TO WS-ERROR
 11350        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 3024-EDIT-DL7-CONT.
 11353
 11354     IF DCUA-RETURN-CODE EQUAL 'E2'
 11355        MOVE ER-8080               TO WS-ERROR
 11356        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL7-CONT.
 11359
 11360     IF DCUA-RETURN-CODE EQUAL 'E3'
 11361        MOVE ER-8098               TO WS-ERROR
 11362        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364        GO TO 3024-EDIT-DL7-CONT.
 11365
 11366     IF DCUA-RETURN-CODE EQUAL 'C1'
 11367        MOVE ER-8099               TO WS-ERROR
 11368        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 3024-EDIT-DL7-CONT.
 11371
 11372     IF DCUA-RETURN-CODE EQUAL 'U1'
 11373        MOVE ER-8109               TO WS-ERROR
 11374        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11376        GO TO 3024-EDIT-DL7-CONT.
 11377
 11378     IF DCUA-RETURN-CODE EQUAL 'N1'
 11379        MOVE ER-8112               TO WS-ERROR
 11380        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11382        GO TO 3024-EDIT-DL7-CONT.
 11383
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 208
* EL050.cbl
 11384     IF DCUA-RETURN-CODE EQUAL 'N2'
 11385        MOVE ER-8113               TO WS-ERROR
 11386        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11388        GO TO 3024-EDIT-DL7-CONT.
 11389
 11390     IF DCUA-RETURN-CODE EQUAL 'N3'
 11391        MOVE ER-8114               TO WS-ERROR
 11392        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11394        GO TO 3024-EDIT-DL7-CONT.
 11395
 11396     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11397     MOVE ER-8097                  TO WS-ERROR.
 11398     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11399     GO TO 3024-EDIT-DL7-CONT.
 11400
 11401 3024-EDIT-DL7-CONT.
 11402
 11403     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11404     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11405     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11406        NEXT SENTENCE
 11407     ELSE
 11408        MOVE ER-9263               TO WS-ERROR
 11409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11410
 11411******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11412******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11413     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11414        NEXT SENTENCE
 11415     ELSE
 11416        MOVE ER-8039               TO WS-ERROR
 11417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11418
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 209
* EL050.cbl
 11420****************************************************************
 11421*** VALIDATE STATE  : DLO022                                 ***
 11422****************************************************************
 11423     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11424     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11425
 11426     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11427     IF DVSC-SUCCESSFUL-EDIT
 11428        GO TO 3024-EDIT-DL22-CONT.
 11429
 11430     IF DVSC-RETURN-CODE EQUAL '01'
 11431        MOVE ER-8300               TO WS-ERROR
 11432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433        GO TO 3024-EDIT-DL22-CONT.
 11434
 11435     IF DVSC-RETURN-CODE EQUAL '02'
 11436        MOVE ER-8301               TO WS-ERROR
 11437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11438        GO TO 3024-EDIT-DL22-CONT.
 11439
 11440     IF DVSC-RETURN-CODE EQUAL '03'
 11441        MOVE ER-8302               TO WS-ERROR
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 3024-EDIT-DL22-CONT.
 11444
 11445     IF DVSC-RETURN-CODE EQUAL 'N1'
 11446        MOVE ER-8304               TO WS-ERROR
 11447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11448        GO TO 3024-EDIT-DL22-CONT.
 11449
 11450     MOVE ER-8303                  TO WS-ERROR
 11451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11452
 11453 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 210
* EL050.cbl
 11455****************************************************************
 11456*** VALIDATE LOAN OFFICER : DLO021                           ***
 11457****************************************************************
 11458
 11459     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11460     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11461     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11462     IF DVLO-SUCCESSFUL-EDIT
 11463        GO TO 3024-EDIT-DL21-CONT.
 11464
 11465     IF DVLO-RETURN-CODE EQUAL '01'
 11466        MOVE ER-8081               TO WS-ERROR
 11467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11468        GO TO 3024-EDIT-DL21-CONT.
 11469
 11470     IF DVLO-RETURN-CODE EQUAL '02'
 11471        MOVE ER-8082               TO WS-ERROR
 11472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11473        GO TO 3024-EDIT-DL21-CONT.
 11474
 11475     IF DVLO-RETURN-CODE EQUAL '03'
 11476        MOVE ER-8083               TO WS-ERROR
 11477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11478        GO TO 3024-EDIT-DL21-CONT.
 11479
 11480     IF DVLO-RETURN-CODE EQUAL '04'
 11481        MOVE ER-8084               TO WS-ERROR
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11483        GO TO 3024-EDIT-DL21-CONT.
 11484
 11485     IF DVLO-RETURN-CODE EQUAL '05'
 11486        MOVE ER-8085               TO WS-ERROR
 11487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11488        GO TO 3024-EDIT-DL21-CONT.
 11489
 11490     MOVE ER-7825                  TO WS-ERROR
 11491     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11492     GO TO 3024-EDIT-DL21-CONT.
 11493
 11494 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 211
* EL050.cbl
 11496
 11497****************************************************************
 11498*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11499****************************************************************
 11500
 11501     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11502     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11503     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11504     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11505     IF DIPF-SUCCESSFUL-EDIT
 11506        GO TO 3024-EDIT-DL02-CONT.
 11507
 11508     IF DIPF-RETURN-CODE EQUAL '01'
 11509        MOVE ER-8086               TO WS-ERROR
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511        GO TO 3024-EDIT-DL02-CONT.
 11512
 11513     IF DIPF-RETURN-CODE EQUAL '02'
 11514        MOVE ER-8087               TO WS-ERROR
 11515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11516        GO TO 3024-EDIT-DL02-CONT.
 11517
 11518     IF DIPF-RETURN-CODE EQUAL '03'
 11519        MOVE ER-8088               TO WS-ERROR
 11520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11521        GO TO 3024-EDIT-DL02-CONT.
 11522
 11523     MOVE ER-8095                  TO WS-ERROR
 11524     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11525     GO TO 3024-EDIT-DL02-CONT.
 11526
 11527 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 212
* EL050.cbl
 11529
 11530****************************************************************
 11531*** VALIDATE BANK ID : DLO003                                ***
 11532****************************************************************
 11533
 11534     MOVE WK-GREG-CENT           TO WCG-CENT.
 11535     MOVE WK-GREG-YYMM           TO WCG-REST.
 11536     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11537        MOVE ER-8040               TO WS-ERROR
 11538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11539
 11540     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11541     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11542     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11543     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11544     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11545     IF DVBI-SUCCESSFUL-EDIT
 11546        GO TO 3024-EDIT-DL03-CONT.
 11547
 11548     IF DVBI-RETURN-CODE EQUAL '01'
 11549        MOVE ER-8089               TO WS-ERROR
 11550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11551        GO TO 3024-EDIT-DL03-CONT.
 11552
 11553     IF DVBI-RETURN-CODE EQUAL '02'
 11554        MOVE ER-8090               TO WS-ERROR
 11555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11556        GO TO 3024-EDIT-DL03-CONT.
 11557
 11558     IF DVBI-RETURN-CODE EQUAL '03'
 11559        MOVE ER-8091               TO WS-ERROR
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL03-CONT.
 11562
 11563     IF DVBI-RETURN-CODE EQUAL '04'
 11564        MOVE ER-8092               TO WS-ERROR
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL03-CONT.
 11567
 11568     IF DVBI-RETURN-CODE EQUAL '05'
 11569        MOVE ER-8093               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL03-CONT.
 11572
 11573     IF DVBI-RETURN-CODE EQUAL '06'
 11574        MOVE ER-8094               TO WS-ERROR
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL03-CONT.
 11577
 11578     MOVE ER-8096                  TO WS-ERROR
 11579     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11580     GO TO 3024-EDIT-DL03-CONT.
 11581
 11582 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 213
* EL050.cbl
 11584
 11585     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11586        NEXT SENTENCE
 11587     ELSE
 11588        MOVE ER-8042               TO WS-ERROR
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11590
 11591     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11592     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11593     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11594
 11595     IF DMPF-RETURN-CODE = '01'
 11596        MOVE ER-8067               TO WS-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598        GO TO 3024-EDIT-DL01-CONT.
 11599
 11600     IF DMPF-RETURN-CODE = '02'
 11601        MOVE ER-8068               TO WS-ERROR
 11602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11603        GO TO 3024-EDIT-DL01-CONT.
 11604
 11605     IF DMPF-RETURN-CODE = '03'
 11606        MOVE ER-8069               TO WS-ERROR
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL01-CONT.
 11609
 11610     IF DMPF-RETURN-CODE = 'E1'
 11611        MOVE ER-8070               TO WS-ERROR
 11612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613        GO TO 3024-EDIT-DL01-CONT.
 11614
 11615     IF DMPF-RETURN-CODE = 'N1'
 11616        MOVE ER-8071               TO WS-ERROR
 11617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618        GO TO 3024-EDIT-DL01-CONT.
 11619
 11620     IF DMPF-RETURN-CODE NOT = 'OK'
 11621        MOVE ER-8072               TO WS-ERROR
 11622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11623
 11624 3024-EDIT-DL01-CONT.
 11625******************************************************************
 11626***  VALIDATES RATE CODES : DLO017                             ***
 11627******************************************************************
 11628
 11629      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11630      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11631      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11632      IF DVRC-SUCCESSFUL-EDIT
 11633        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11634        GO TO 3024-CHECK-VALID-RATE.
 11635
 11636      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11637
 11638      IF DVRC-RETURN-CODE EQUAL '01'
 11639         MOVE ER-7817                   TO WS-ERROR
 11640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11641         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 214
* EL050.cbl
 11642
 11643      IF DVRC-RETURN-CODE EQUAL '02'
 11644         MOVE ER-7818                   TO WS-ERROR
 11645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11646         GO TO 3025-EDIT-REINSURANCE.
 11647
 11648      IF DVRC-RETURN-CODE EQUAL '03'
 11649         MOVE ER-7819                   TO WS-ERROR
 11650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11651         GO TO 3025-EDIT-REINSURANCE.
 11652
 11653       MOVE ER-7820                     TO WS-ERROR.
 11654       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11655       GO TO 3025-EDIT-REINSURANCE.
 11656
 11657******************************************************************
 11658***  GET PREMIUM RATES : DLO011                                ***
 11659******************************************************************
 11660
 11661 3024-CHECK-VALID-RATE.
 11662
 11663     IF VALID-RATE-CODE
 11664        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11665        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11666        MOVE SPACES                TO DPRB-RETURN-CODE
 11667        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11668     ELSE
 11669         GO TO 3025-EDIT-REINSURANCE.
 11670
 11671      IF DPRB-SUCCESSFUL-PROCESS
 11672         IF PB-VALID-LIFE
 11673             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11674             GO TO 3025-EDIT-REINSURANCE
 11675         ELSE
 11676             IF PB-VALID-AH
 11677                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11678                 GO TO 3025-EDIT-REINSURANCE.
 11679
 11680      IF DPRB-RETURN-CODE EQUAL '01'
 11681         MOVE ER-7812                   TO WS-ERROR
 11682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11683         GO TO 3025-EDIT-REINSURANCE.
 11684
 11685      IF DPRB-RETURN-CODE EQUAL '02'
 11686         MOVE ER-7813                   TO WS-ERROR
 11687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11688         GO TO 3025-EDIT-REINSURANCE.
 11689
 11690      IF DPRB-RETURN-CODE EQUAL '03'
 11691         MOVE ER-7814                   TO WS-ERROR
 11692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693         GO TO 3025-EDIT-REINSURANCE.
 11694
 11695      IF DPRB-RETURN-CODE EQUAL '04'
 11696         IF NOT DPRB-1ST-TIME
 11697            MOVE ER-7815                   TO WS-ERROR
 11698            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 215
* EL050.cbl
 11700          ELSE
 11701         IF PB-VALID-LIFE
 11702            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11703          ELSE
 11704            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11705         END-IF
 11706         MOVE SPACES                TO DOCC-RETURN-CODE
 11707         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11708         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11709         IF DOCC-RETURN-CODE = 'OK'
 11710             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11711             GO TO 3024-CHECK-VALID-RATE
 11712           ELSE
 11713             MOVE ER-7823               TO WS-ERROR
 11714             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11715             GO TO 3025-EDIT-REINSURANCE.
 11716
 11717       MOVE ER-7816                     TO WS-ERROR.
 11718       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11719       GO TO 3025-EDIT-REINSURANCE.
 11720
 11721**********   DMD CUSTOM CODE ABOVE    **********
 11722
 11723 3025-EDIT-REINSURANCE.
 11724     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11725         GO TO 3027-EDIT-CONTINUE.
 11726
 11727     MOVE LOW-VALUES               TO ERREIN-KEY.
 11728     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11729     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11730                                      REIN-CODE-2
 11731                                      REIN-CODE-3.
 11732     MOVE 'A'                      TO REIN-TYPE.
 11733
 11734     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11735
 11736     MOVE '3026' TO REIN-SW.
 11737     MOVE ' '                   TO WS-REIN-READ-SW.
 11738
 11739     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11740     IF REIN-TABLE-NOT-FOUND
 11741         GO TO 3026-NO-SPEC-TABLE.
 11742
 11743     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11744     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11745                                   WS-NSP-ST-CD-LF.
 11746     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11747                                   WS-NSP-ST-CD-AH.
 11748
 11749     GO TO 3040-EDIT-CONTINUE.
 11750
 11751 3026-NO-SPEC-TABLE.
 11752
 11753     MOVE ER-2664                TO WS-ERROR.
 11754     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11755     GO TO 3040-EDIT-CONTINUE.
 11756
 11757 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 216
* EL050.cbl
 11758
 11759     IF PB-I-REIN-TABLE = SPACES
 11760       GO TO 3040-EDIT-CONTINUE.
 11761
 11762     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11763          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11764          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11765           GO TO 3040-EDIT-CONTINUE.
 11766
 11767     MOVE LOW-VALUES            TO ERREIN-KEY.
 11768     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11769     MOVE 'A'                   TO REIN-TYPE.
 11770     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11771
 11772     MOVE '3028'                TO REIN-SW.
 11773     MOVE ' '                   TO WS-REIN-READ-SW.
 11774
 11775     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11776     IF REIN-TABLE-NOT-FOUND
 11777         GO TO 3028-NO-REIN-TABLE.
 11778
 11779     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11780     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11781                                   WS-NSP-ST-CD-LF.
 11782     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11783                                   WS-NSP-ST-CD-AH.
 11784
 11785     GO TO 3040-EDIT-CONTINUE.
 11786
 11787 3028-NO-REIN-TABLE.
 11788
 11789     MOVE ER-2615                TO WS-ERROR.
 11790     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11791     GO TO 3040-EDIT-CONTINUE.
 11792
 11793 3040-EDIT-CONTINUE.
 11794
 11795     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11796         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11797
 11798     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11799         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11800
 11801     IF (NOT PB-REISSUED-CERT)
 11802        AND (NOT PB-MONTHLY-CERT)
 11803        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11804            MOVE '001'           TO PB-I-LF-TERM
 11805            MOVE 'M'             TO PB-I-INSURED-SEX.
 11806
 11807     IF (NOT PB-REISSUED-CERT)
 11808        AND (NOT PB-MONTHLY-CERT)
 11809        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11810            MOVE '001'           TO PB-I-AH-TERM
 11811            MOVE 'M'             TO PB-I-INSURED-SEX.
 11812
 11813 3040-EDIT-1ST-PMT-DT.
 11814     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11815     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 217
* EL050.cbl
 11816         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11817
 11818******************************************************************
 11819*                                                                *
 11820*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11821*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11822*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11823*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11824*                                                                *
 11825******************************************************************
 11826
 11827     IF PB-EFF-DT-PROCESSING
 11828        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11829                                    PB-I-LF-EXPIRE-DT
 11830                                    PB-I-AH-EXPIRE-DT
 11831        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11832        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11833        MOVE ZERO                TO DC-ELAPSED-DAYS
 11834        MOVE +1                  TO DC-ELAPSED-MONTHS
 11835        SET BIN-PLUS-ELAPSED     TO TRUE
 11836*       MOVE 6                   TO DC-OPTION-CODE
 11837        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11838        IF NO-CONVERSION-ERROR
 11839           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11840
 11841******************************************************************
 11842*                                                                *
 11843*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11844*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11845*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11846*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11847*                                                                *
 11848******************************************************************
 11849
 11850     IF PB-EXT-DAYS-PROCESSING
 11851          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11852                                         PB-I-LF-EXPIRE-DT
 11853                                         PB-I-AH-EXPIRE-DT
 11854          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11855          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11856          MOVE +1                     TO DC-ELAPSED-MONTHS
 11857          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11858          SET BIN-PLUS-ELAPSED        TO TRUE
 11859*         MOVE 6                      TO DC-OPTION-CODE
 11860          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11861          IF NO-CONVERSION-ERROR
 11862             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11863
 11864******************************************************************
 11865*                                                                *
 11866*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11867*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11868*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11869*        (EXPIRE DATE - (TERM -1))  *  -1.
 11870*                                                                *
 11871******************************************************************
 11872
 11873     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 218
* EL050.cbl
 11874        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11875           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11876              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11877              MOVE PB-I-AH-TERM      TO WS-TERM
 11878           ELSE
 11879              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11880              MOVE PB-I-LF-TERM      TO WS-TERM
 11881        ELSE
 11882           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11883              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11884              MOVE PB-I-LF-TERM      TO WS-TERM
 11885           ELSE
 11886              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11887              MOVE PB-I-AH-TERM      TO WS-TERM.
 11888
 11889     IF PB-EXPIRE-DT-PROCESSING
 11890        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11891        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11892        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11893        MOVE ZERO                TO DC-ELAPSED-DAYS
 11894                                    DC-ODD-DAYS-OVER
 11895          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11896          SET BIN-PLUS-ELAPSED    TO TRUE
 11897*         MOVE 6                  TO DC-OPTION-CODE
 11898          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11899          IF NO-CONVERSION-ERROR
 11900             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11901
 11902******************************************************************
 11903*                                                                *
 11904*            1ST PAYMENT DATE PROCESSING                         *
 11905*                                                                *
 11906******************************************************************
 11907
 11908     IF PB-1ST-PMT-DT-PROCESSING
 11909        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11910                                    PB-I-AH-EXPIRE-DT
 11911        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11912
 11913     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11914         NEXT SENTENCE
 11915     ELSE
 11916         MOVE ER-2680                 TO WS-ERROR
 11917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11918         GO TO 3060-ORIG-TERM-CHECK.
 11919
 11920     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11921     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11922     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11923*    MOVE 1                      TO DC-OPTION-CODE.
 11924     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11925                                    DC-ELAPSED-DAYS
 11926                                    DC-ODD-DAYS-OVER.
 11927
 11928     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11929
 11930     IF DATE-CONVERSION-ERROR
 11931        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 219
* EL050.cbl
 11932
 11933     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11934     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11935        AND (WS-LF-COVERAGE-TYPE = 'L')
 11936        IF (DC-ELAPSED-MONTHS > 1)
 11937                      OR
 11938           ((DC-ELAPSED-MONTHS = 1)
 11939           AND (DC-ODD-DAYS-OVER > 0))
 11940           MOVE ER-2882          TO WS-ERROR
 11941           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11942        END-IF
 11943     END-IF
 11944     IF PB-EXT-DAYS-PROCESSING
 11945        CONTINUE
 11946     ELSE
 11947        IF DC-ELAPSED-MONTHS = +0
 11948           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11949        ELSE
 11950           IF (WS-LF-EARNINGS-CALC = '4')
 11951              AND (DC-ELAPSED-MONTHS > ZERO)
 11952              AND (DC-ELAPSED-DAYS > ZERO)
 11953              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11954           ELSE
 11955              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11956                                 THRU 6499-EXIT
 11957              MOVE WS-ODD-DAYS-OVER
 11958                                 TO PB-I-EXTENTION-DAYS
 11959           END-IF
 11960        END-IF
 11961     END-IF
 11962******************************************************************
 11963*                                                                *
 11964*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11965*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11966*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11967*            AND ANY ODD DAYS.                                   *
 11968*                                                                *
 11969******************************************************************
 11970
 11971     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11972                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11973     IF WS-LF-EARNINGS-CALC NOT = '4'
 11974        IF DC-ELAPSED-DAYS > ZEROS
 11975           MOVE ER-2681          TO WS-ERROR
 11976           PERFORM 9900-ERROR-FORMAT
 11977                                 THRU 9900-EXIT
 11978        END-IF
 11979     END-IF
 11980
 11981     IF WS-LF-EARNINGS-CALC NOT = '4'
 11982        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11983           MOVE ER-2681          TO WS-ERROR
 11984           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11985
 11986     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11987        (PB-I-LF-TERM NOT = ZERO) AND
 11988         NOT NO-LIFE-COVERAGE
 11989          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 220
* EL050.cbl
 11990          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11991          IF WS-LF-EARNINGS-CALC = '4'
 11992             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11993             PB-I-PAY-FREQUENCY
 11994          END-IF
 11995          MOVE ZERO              TO DC-ELAPSED-DAYS
 11996                                    DC-ODD-DAYS-OVER
 11997          MOVE 1                 TO DC-END-OF-MONTH
 11998          SET BIN-PLUS-ELAPSED        TO TRUE
 11999*         MOVE 6                 TO DC-OPTION-CODE
 12000          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12001          IF NO-CONVERSION-ERROR
 12002             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12003             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12004                (WS-LF-SPECIAL-CALC-CD = 'L')
 12005                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12006                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12007                  MOVE +1             TO DC-ELAPSED-MONTHS
 12008                  SET BIN-PLUS-ELAPSED  TO TRUE
 12009*                 MOVE 6              TO DC-OPTION-CODE
 12010                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12011                  IF NO-CONVERSION-ERROR
 12012                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12013
 12014* okay, i had to move the new att age edit down here because the
 12015* expiration date could get recalculated and i need the exp date
 12016     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12017        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12018        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12019        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12020           AND ZEROS
 12021           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12022           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12023           SET ELAPSED-BETWEEN-BIN TO TRUE
 12024           PERFORM 8500-DATE-CONVERT
 12025                                 THRU 8500-EXIT
 12026           IF NO-CONVERSION-ERROR
 12027              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12028                 MOVE ER-2669       TO WS-ERROR
 12029*                PERFORM 9900-ERROR-FORMAT
 12030*                                THRU 9900-EXIT
 12031              END-IF
 12032           END-IF
 12033        ELSE
 12034           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12035           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12036              MOVE ER-2669       TO WS-ERROR
 12037*             PERFORM 9900-ERROR-FORMAT
 12038*                                THRU 9900-EXIT
 12039           ELSE
 12040              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12041                 MOVE ER-1570    TO WS-ERROR
 12042                 PERFORM 9900-ERROR-FORMAT
 12043                                 THRU 9900-EXIT
 12044              END-IF
 12045           END-IF
 12046        END-IF
 12047        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 221
* EL050.cbl
 12048           AND ZEROS
 12049           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12050           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12051           SET ELAPSED-BETWEEN-BIN TO TRUE
 12052           PERFORM 8500-DATE-CONVERT
 12053                                 THRU 8500-EXIT
 12054           IF NO-CONVERSION-ERROR
 12055              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12056                 MOVE ER-2669       TO WS-ERROR
 12057*                PERFORM 9900-ERROR-FORMAT
 12058*                                THRU 9900-EXIT
 12059              END-IF
 12060           END-IF
 12061        ELSE
 12062           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12063             (PB-I-LF-TERM / 12)
 12064           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12065              MOVE ER-2669       TO WS-ERROR
 12066*             PERFORM 9900-ERROR-FORMAT
 12067*                                THRU 9900-EXIT
 12068           ELSE
 12069              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12070                 MOVE ER-1571    TO WS-ERROR
 12071                 PERFORM 9900-ERROR-FORMAT
 12072                                 THRU 9900-EXIT
 12073              END-IF
 12074           END-IF
 12075        END-IF
 12076        IF WS-ERROR = ER-2669
 12077           PERFORM 9900-ERROR-FORMAT
 12078                                 THRU 9900-EXIT
 12079        END-IF
 12080     END-IF
 12081     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12082        (PB-I-AH-TERM NOT = ZERO) AND
 12083         NOT NO-AH-COVERAGE
 12084          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12085             AND (PB-COMPANY-ID = 'DCC')
 12086             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12087             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12088          ELSE
 12089             IF WS-LF-EARNINGS-CALC = '4'
 12090                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12091                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12092                PB-I-PAY-FREQUENCY
 12093             ELSE
 12094                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12095                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12096             END-IF
 12097          END-IF
 12098          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12099                                         DC-ODD-DAYS-OVER
 12100          MOVE 1                      TO DC-END-OF-MONTH
 12101          SET BIN-PLUS-ELAPSED        TO TRUE
 12102*         MOVE 6                      TO DC-OPTION-CODE
 12103          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12104          IF NO-CONVERSION-ERROR
 12105             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 222
* EL050.cbl
 12106     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12107        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12108        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12109        IF PB-I-BIRTHDAY > LOW-VALUES
 12110           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12111           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12112           SET ELAPSED-BETWEEN-BIN TO TRUE
 12113           PERFORM 8500-DATE-CONVERT
 12114                                 THRU 8500-EXIT
 12115           IF NO-CONVERSION-ERROR
 12116              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12117                 MOVE ER-3054       TO WS-ERROR
 12118*                PERFORM 9900-ERROR-FORMAT
 12119*                                THRU 9900-EXIT
 12120              END-IF
 12121           END-IF
 12122        ELSE
 12123           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12124           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12125              MOVE ER-3054       TO WS-ERROR
 12126*             PERFORM 9900-ERROR-FORMAT
 12127*                                THRU 9900-EXIT
 12128           END-IF
 12129        END-IF
 12130        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12131           AND ZEROS
 12132           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12133           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12134           SET ELAPSED-BETWEEN-BIN TO TRUE
 12135           PERFORM 8500-DATE-CONVERT
 12136                                 THRU 8500-EXIT
 12137           IF NO-CONVERSION-ERROR
 12138              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12139                 MOVE ER-3054       TO WS-ERROR
 12140*                PERFORM 9900-ERROR-FORMAT
 12141*                                THRU 9900-EXIT
 12142              END-IF
 12143           END-IF
 12144        ELSE
 12145           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12146             (PB-I-AH-TERM / 12)
 12147           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12148              MOVE ER-3054       TO WS-ERROR
 12149*             PERFORM 9900-ERROR-FORMAT
 12150*                                THRU 9900-EXIT
 12151           END-IF
 12152        END-IF
 12153        IF WS-ERROR = ER-3054
 12154           PERFORM 9900-ERROR-FORMAT
 12155                                 THRU 9900-EXIT
 12156        END-IF
 12157     END-IF
 12158     MOVE SPACE                       TO DC-END-OF-MONTH.
 12159
 12160     IF PB-COMPANY-ID = 'NCB'
 12161        GO TO 3040-EDIT-EXTENSION-DAYS.
 12162
 12163     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 223
* EL050.cbl
 12164       AND
 12165        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12166        NEXT SENTENCE
 12167     ELSE
 12168        GO TO 3040-EDIT-EXTENSION-DAYS.
 12169
 12170     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12171        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12172        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12173     ELSE
 12174        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12175        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12176
 12177     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12178*    MOVE '1'      TO DC-OPTION-CODE
 12179     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12180     IF (NO-CONVERSION-ERROR)
 12181        AND (DC-ELAPSED-MONTHS > +1)
 12182        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12183        MOVE ER-2668   TO WS-ERROR
 12184        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12185
 12186 3040-EDIT-EXTENSION-DAYS.
 12187
 12188     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12189        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12190         GO TO 3050-EDIT-TERM-IN-DAYS
 12191     ELSE
 12192         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12193
 12194     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12195         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12196     ELSE
 12197        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12198           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12199           MOVE ER-2681         TO WS-ERROR
 12200           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12201
 12202     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12203        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12204        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12205         GO TO 3060-ORIG-TERM-CHECK.
 12206
 12207     GO TO 3060-ORIG-TERM-CHECK.
 12208
 12209 3050-EDIT-TERM-IN-DAYS.
 12210
 12211     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12212
 12213     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12214         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12215     ELSE
 12216         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12217            MOVE ER-2682         TO WS-ERROR
 12218            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12219
 12220     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12221                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 224
* EL050.cbl
 12222     IF WS-WORK-TERM GREATER THAN ZERO
 12223         ADD +1 TO PB-I-LF-TERM.
 12224
 12225     IF NOT NO-AH-COVERAGE
 12226         MOVE ER-2684            TO WS-ERROR
 12227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12228
 12229
 12230 3060-ORIG-TERM-CHECK.
 12231
 12232******************************************************************
 12233*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12234******************************************************************
 12235
 12236     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12237        NEXT SENTENCE
 12238     ELSE
 12239        IF NOT NO-LIFE-COVERAGE
 12240           IF PB-I-LF-TERM NUMERIC
 12241              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12242              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12243              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12244                  NEXT SENTENCE
 12245           ELSE
 12246              MOVE ER-2647       TO WS-ERROR
 12247              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12248
 12249     IF NOT NO-AH-COVERAGE
 12250         IF PB-I-AH-TERM NUMERIC
 12251            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12252            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12253            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12254             NEXT SENTENCE
 12255          ELSE
 12256              MOVE ER-2658       TO WS-ERROR
 12257              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12258
 12259     IF PB-COMPANY-ID = 'NCB'
 12260        GO TO 3070-LOAN-TERM-CHECK.
 12261
 12262     IF POLICY-HAS-AH
 12263       AND
 12264        POLICY-HAS-LIFE
 12265       AND
 12266        PB-I-LF-TERM NUMERIC
 12267       AND
 12268        PB-I-AH-TERM NUMERIC
 12269        NEXT SENTENCE
 12270     ELSE
 12271        GO TO 3070-LOAN-TERM-CHECK.
 12272
 12273     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12274     IF WS-TEX-FACT-2 LESS THAN +0
 12275        MULTIPLY +1 BY WS-TEX-FACT-2.
 12276
 12277     IF WS-TEX-FACT-2 GREATER THAN +1
 12278        MOVE ER-2668             TO WS-ERROR
 12279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 225
* EL050.cbl
 12280
 12281 3070-LOAN-TERM-CHECK.
 12282
 12283     IF (WS-LF-BENEFIT-CD = ZERO)
 12284         OR (NO-LF-BENEFIT-MATCH)
 12285            GO TO 3125-EDIT-PMT-FREQ.
 12286*    IF PB-COMPANY-ID NOT = 'DCC'
 12287*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12288*          AND 'V' AND 'W' AND 'X'
 12289*          GO TO 3125-EDIT-PMT-FREQ
 12290*       END-IF
 12291*    ELSE
 12292*       IF WS-AH-DCC-TRUNC = 'T'
 12293*          CONTINUE
 12294*       ELSE
 12295*          GO TO 3125-EDIT-PMT-FREQ
 12296*       END-IF
 12297*    END-IF
 12298     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12299                    OR
 12300        ((PB-COMPANY-ID = 'DCC')
 12301        AND (WS-AH-DCC-TRUNC = 'T'))
 12302        CONTINUE
 12303     ELSE
 12304        GO TO 3125-EDIT-PMT-FREQ
 12305     END-IF
 12306     IF PB-I-LOAN-TERM NOT NUMERIC
 12307         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12308
 12309     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12310        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12311*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12312        PB-I-LOAN-TERM NOT GREATER THAN +360
 12313         NEXT SENTENCE
 12314     ELSE
 12315         MOVE ER-2648            TO WS-ERROR
 12316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12317
 12318     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12319        MOVE ER-3058             TO WS-ERROR
 12320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321     end-if
 12322
 12323     IF WS-STATE-ABBREVIATION = 'NC'
 12324        IF PB-I-LOAN-TERM > +59
 12325           CONTINUE
 12326        ELSE
 12327           MOVE ER-2792          TO WS-ERROR
 12328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12329        END-IF
 12330     END-IF
 12331
 12332     .
 12333 3125-EDIT-PMT-FREQ.
 12334     IF (WS-LF-BENEFIT-CD = ZERO)
 12335         OR (NO-LF-BENEFIT-MATCH)
 12336            GO TO 3127-EDIT-LOAN-OFFICER.
 12337     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 226
* EL050.cbl
 12338                    OR
 12339        ((PB-COMPANY-ID = 'DCC')
 12340        AND (WS-AH-DCC-TRUNC = 'T'))
 12341                    OR
 12342         (PB-COMPANY-ID = 'AHL')
 12343        CONTINUE
 12344     ELSE
 12345        IF (PB-I-LOAN-TERM > ZEROS)
 12346           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12347           MOVE ER-1575          TO WS-ERROR
 12348           PERFORM 9900-ERROR-FORMAT
 12349                                 THRU 9900-EXIT
 12350        END-IF
 12351     END-IF
 12352     IF WS-LF-EARNINGS-CALC NOT = '4'
 12353         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12354            MOVE ER-2653         TO WS-ERROR
 12355            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12356            GO TO 3127-EDIT-LOAN-OFFICER
 12357         ELSE
 12358            GO TO 3127-EDIT-LOAN-OFFICER.
 12359
 12360     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12361         MOVE ER-2655            TO WS-ERROR
 12362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363         GO TO 3127-EDIT-LOAN-OFFICER.
 12364
 12365     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12366         MOVE ER-2654            TO WS-ERROR
 12367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12368         GO TO 3127-EDIT-LOAN-OFFICER.
 12369
 12370     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12371         GIVING WS-TEX-FACT-2
 12372             REMAINDER WS-TEX-FACT-3.
 12373
 12374*    IF WS-TEX-FACT-3 NOT = ZERO
 12375*       MOVE ER-2654             TO WS-ERROR
 12376*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12377
 12378
 12379 3127-EDIT-LOAN-OFFICER.
 12380
 12381     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12382        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12383           MOVE ER-2690          TO WS-ERROR
 12384           PERFORM 9900-ERROR-FORMAT
 12385                                 THRU 9900-EXIT
 12386        ELSE
 12387           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12388           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12389           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12390           MOVE PB-SV-STATE      TO LOFC-STATE
 12391           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12392           MOVE PB-I-LOAN-OFFICER
 12393                                 TO LOFC-CODE
 12394           PERFORM 8586-READ-LOAN-OFFICER
 12395                                 THRU 8586-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 227
* EL050.cbl
 12396           IF (NOT LOFC-MASTER-FOUND)
 12397              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12398              MOVE ER-3006       TO WS-ERROR
 12399              PERFORM 9900-ERROR-FORMAT
 12400                                 THRU 9900-EXIT
 12401           END-IF
 12402        END-IF
 12403     END-IF
 12404     .
 12405 3129-EDIT-APR.
 12406
 12407     IF (WS-LF-BENEFIT-CD = ZERO)
 12408        OR (NO-LF-BENEFIT-MATCH)
 12409        IF PB-COMPANY-ID NOT = 'DCC'
 12410           GO TO 3130-EDIT-AGE
 12411*       ELSE
 12412*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12413*             GO TO 3130-EDIT-AGE
 12414*          END-IF
 12415        END-IF
 12416     END-IF
 12417
 12418     IF (WS-STATE-ABBREVIATION = 'OH')
 12419         AND (PB-I-RATE-CLASS NOT = 'L ')
 12420         AND (PB-I-LF-TERM GREATER THAN 60)
 12421         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12422         GO TO 3129-APR-CONT.
 12423
 12424     IF (WS-STATE-ABBREVIATION = 'RI')
 12425         AND (PB-I-LF-TERM GREATER THAN 60)
 12426         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12427         GO TO 3129-APR-CONT.
 12428
 12429     IF (WS-STATE-ABBREVIATION = 'UT')
 12430         AND (PB-I-LF-TERM GREATER THAN 62)
 12431         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12432         AND (PB-CERT-EFF-DT LESS WS-830901)
 12433         GO TO 3129-APR-CONT.
 12434
 12435     IF PB-COMPANY-ID = 'LAP'
 12436        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12437           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12438              MOVE ER-2656         TO WS-ERROR
 12439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12440              GO TO 3130-EDIT-AGE.
 12441
 12442     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12443        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12444        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12445        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12446        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12447        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12448         GO TO 3130-EDIT-AGE.
 12449
 12450 3129-APR-CONT.
 12451     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12452         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12453         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 228
* EL050.cbl
 12454
 12455     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12456         WS-AH-BENEFIT-CD (1:1) = 'S')
 12457        AND (PB-COMPANY-ID = 'DCC')
 12458        AND (PB-I-LOAN-APR = ZERO)
 12459        MOVE ER-2657             TO WS-ERROR
 12460        PERFORM 9900-ERROR-FORMAT
 12461                                 THRU 9900-EXIT
 12462        GO TO 3130-EDIT-AGE
 12463     END-IF
 12464     IF PB-I-LOAN-APR = ZERO
 12465        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12466     END-IF
 12467
 12468     IF PB-I-LOAN-APR = ZERO
 12469        MOVE ER-2656             TO WS-ERROR
 12470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12471        GO TO 3130-EDIT-AGE.
 12472
 12473*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12474     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12475        MOVE ER-2657             TO WS-ERROR
 12476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12477
 12478 3130-EDIT-AGE.
 12479
 12480******************************************************************
 12481*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12482******************************************************************
 12483
 12484     IF NOT NO-LIFE-COVERAGE
 12485        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12486           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12487               MOVE ER-2628             TO WS-ERROR
 12488               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12489
 12490     IF NOT NO-AH-COVERAGE
 12491        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12492           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12493               MOVE ER-2628         TO WS-ERROR
 12494               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12495
 12496 3133-SEX-CODE.
 12497     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12498         IF WS-DEFAULT-SEX = 'M'
 12499             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12500          ELSE
 12501             IF WS-DEFAULT-SEX = 'F'
 12502             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12503
 12504     IF PB-I-INSURED-SEX = '1'
 12505         MOVE 'M' TO PB-I-INSURED-SEX.
 12506
 12507     IF PB-I-INSURED-SEX = '2'
 12508         MOVE 'F' TO PB-I-INSURED-SEX.
 12509
 12510 3134-SIG-SW-EDIT.
 12511     IF PB-I-SIG-SW = SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 229
* EL050.cbl
 12512         MOVE 'N'                TO  PB-I-SIG-SW.
 12513
 12514     IF PB-COMPANY-ID = 'NCL'
 12515         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12516             NEXT SENTENCE
 12517         ELSE
 12518             MOVE ER-1923        TO  WS-ERROR
 12519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12520     ELSE
 12521     IF PB-COMPANY-ID = 'CRI'
 12522         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12523             NEXT SENTENCE
 12524         ELSE
 12525             MOVE ER-2606        TO  WS-ERROR
 12526             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12527     ELSE
 12528     IF PB-COMPANY-ID = 'TMS'
 12529         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12530             NEXT SENTENCE
 12531         ELSE
 12532             MOVE ER-2689        TO  WS-ERROR
 12533             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12534     ELSE
 12535         IF PB-I-SIG-SW = 'Y' OR 'N'
 12536             NEXT SENTENCE
 12537         ELSE
 12538             MOVE ER-2651        TO  WS-ERROR
 12539             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12540
 12541     IF PB-COMPANY-ID = 'FLA'
 12542         IF (WS-EDIT-AGE GREATER 54  OR
 12543             WS-AH-EDIT-AGE GREATER 54)  AND
 12544            PB-I-SIG-SW = 'N'
 12545            MOVE ER-2651         TO  WS-ERROR
 12546            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548 3135-NAME-EDIT.
 12549
 12550     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12551        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12552        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12553           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12554                                 TO PB-I-JOINT-FIRST-NAME
 12555        END-PERFORM
 12556     END-IF
 12557     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12558        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12559        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12560           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12561                                 TO PB-I-JOINT-LAST-NAME
 12562        END-PERFORM
 12563     END-IF
 12564     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12565        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12566        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12567           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12568                                 TO PB-I-INSURED-FIRST-NAME
 12569        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 230
* EL050.cbl
 12570     END-IF
 12571     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12572        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12573        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12574           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12575                                 TO PB-I-INSURED-LAST-NAME
 12576        END-PERFORM
 12577     END-IF
 12578     IF PB-I-INSURED-LAST-NAME = SPACES
 12579       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12580       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12581           MOVE ER-2660    TO WS-ERROR
 12582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12583
 12584 3136-EDIT-SEX.
 12585
 12586******************************************************************
 12587*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12588******************************************************************
 12589
 12590     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12591        (WS-AH-SPECIAL-CALC-CD = 'O')
 12592        NEXT SENTENCE
 12593     ELSE
 12594        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12595           NEXT SENTENCE
 12596        ELSE
 12597           MOVE ER-2629            TO WS-ERROR
 12598           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12599
 12600 3137-EDIT-EFF-DATE.
 12601
 12602     IF PB-REISSUED-CERT       OR
 12603        PB-POLICY-IS-DECLINED  OR
 12604        PB-POLICY-IS-VOIDED
 12605         GO TO 3139-EDIT-COVERAGE-CODES.
 12606
 12607     MOVE SPACE                  TO WS-2671-SW
 12608                                    WS-2672-SW.
 12609
 12610     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12611         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12612             MOVE ER-2703        TO WS-ERROR
 12613             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12614             GO TO 3139-EDIT-COVERAGE-CODES.
 12615
 12616     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12617         GO TO 3139-EDIT-COVERAGE-CODES.
 12618
 12619     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12620     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12621*    MOVE '1'                    TO DC-OPTION-CODE.
 12622     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12623     MOVE +0                     TO DC-ELAPSED-MONTHS
 12624                                    DC-ELAPSED-DAYS.
 12625     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12626
 12627     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 231
* EL050.cbl
 12628         GO TO 3139-EDIT-COVERAGE-CODES.
 12629
 12630     IF DC-ELAPSED-DAYS GREATER +180
 12631         MOVE ER-2672            TO WS-ERROR
 12632         MOVE 'Y'                TO WS-2672-SW
 12633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12634     END-IF
 12635
 12636     IF WS-ERROR = ER-2671  AND
 12637        PB-COMPANY-ID  = 'LBL'
 12638        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12639        MOVE SPACE               TO WS-2671-SW
 12640        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12641
 12642     IF PB-ISSUE-DATE-FORCED  AND
 12643      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12644         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12645         MOVE ER-2673            TO WS-ERROR
 12646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12647         MOVE SPACE              TO WS-2671-SW
 12648                                    WS-2672-SW.
 12649
 12650     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12651         IF PB-ISSUE-DATE-FORCED
 12652             MOVE ER-2600          TO  WS-ERROR
 12653             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12654         ELSE
 12655             MOVE ER-2692          TO  WS-ERROR
 12656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12657
 12658
 12659 3139-EDIT-COVERAGE-CODES.
 12660
 12661     if pb-company-id not = 'AHL'
 12662        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12663           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12664           MOVE ER-2787          TO WS-ERROR
 12665           PERFORM 9900-ERROR-FORMAT
 12666                                 THRU 9900-EXIT
 12667        END-IF
 12668     end-if
 12669     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12670        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12671                                 > 250000.00
 12672           MOVE ER-2719          TO WS-ERROR
 12673           PERFORM 9900-ERROR-FORMAT
 12674                                 THRU 9900-EXIT
 12675        END-IF
 12676     END-IF
 12677
 12678     IF PB-POLICY-IS-DECLINED  OR
 12679        PB-POLICY-IS-VOIDED
 12680         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12681
 12682     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12683        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12684         MOVE ER-2630                TO WS-ERROR
 12685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 232
* EL050.cbl
 12686
 12687     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12688        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12689        PB-I-LF-PREMIUM-AMT = ZERO
 12690         GO TO 3140-CHECK-AH-FOR-ZERO.
 12691
 12692     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12693        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12694        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12695         GO TO 3140-CHECK-AH-FOR-ZERO.
 12696
 12697     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12698        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12699        MOVE ER-2631             TO WS-ERROR
 12700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12701     END-IF
 12702
 12703
 12704******************************************************************
 12705*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12706******************************************************************
 12707
 12708     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12709        NEXT SENTENCE
 12710     ELSE
 12711        IF PB-I-LF-BENEFIT-AMT = ZERO
 12712           MOVE ER-2632             TO WS-ERROR
 12713           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12714
 12715
 12716******************************************************************
 12717*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12718******************************************************************
 12719
 12720     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12721        CONTINUE
 12722     ELSE
 12723        IF PB-I-LF-PREMIUM-AMT = ZERO
 12724           IF (NOT PB-COMP-LF-PREM)
 12725              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12726              MOVE ER-2633       TO WS-ERROR
 12727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12728           END-IF
 12729        END-IF
 12730     END-IF
 12731     .
 12732 3140-CHECK-AH-FOR-ZERO.
 12733
 12734     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12735        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12736        PB-I-AH-PREMIUM-AMT = ZERO
 12737         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12738
 12739     IF PB-COMPANY-ID = 'CSL'  AND
 12740        PB-I-AH-BENEFIT-CD = ZERO  AND
 12741        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12742        PB-I-AH-PREMIUM-AMT = ZERO
 12743         GO TO 3140-EDIT-MAX-AMT-SIZES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 233
* EL050.cbl
 12744
 12745     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12746        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12747        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12748         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12749
 12750     IF PB-I-AH-BENEFIT-CD = ZERO
 12751         MOVE ER-2634            TO WS-ERROR
 12752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12753
 12754******************************************************************
 12755*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12756******************************************************************
 12757
 12758     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12759        NEXT SENTENCE
 12760     ELSE
 12761        IF PB-I-AH-BENEFIT-AMT = ZERO
 12762           MOVE ER-2635             TO WS-ERROR
 12763           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765******************************************************************
 12766*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12767******************************************************************
 12768
 12769     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12770        NEXT SENTENCE
 12771     ELSE
 12772        IF PB-I-AH-PREMIUM-AMT = ZERO
 12773            IF NOT PB-COMP-AH-PREM
 12774                MOVE ER-2636    TO WS-ERROR
 12775                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12776
 12777
 12778 3140-EDIT-MAX-AMT-SIZES.
 12779* CUSTOM CODE FOR CLIENT    'DMD'
 12780     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12781                                     WS-RES-MUNI-TAX
 12782                                     PB-I-STATE-TAX
 12783                                     PB-I-MUNI-TAX.
 12784
 12785     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12786
 12787     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12788        GO TO 3150-RATE-OUTSTAND-BAL.
 12789
 12790     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12791        GO TO 3150-RATE-OUTSTAND-BAL.
 12792
 12793     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12794        GO TO 3150-RATE-OUTSTAND-BAL.
 12795
 12796     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12797                             OR 'RIC')
 12798        GO TO 3150-RATE-OUTSTAND-BAL.
 12799
 12800     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12801        IF PB-I-LOAN-APR GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 234
* EL050.cbl
 12802            GO TO 3150-RATE-OUTSTAND-BAL
 12803        ELSE
 12804           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12805               GO TO 3150-RATE-OUTSTAND-BAL.
 12806
 12807     IF NOT PB-NO-MONTHS-SKIPPED
 12808        GO TO 3150-RATE-OUTSTAND-BAL.
 12809
 12810     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12811        GO TO 3150-RATE-OUTSTAND-BAL.
 12812
 12813     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12814        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12815           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12816             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12817           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12818           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12819              MOVE ER-2693     TO WS-ERROR
 12820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12821              GO TO 3150-RATE-OUTSTAND-BAL
 12822           ELSE
 12823              GO TO 3150-RATE-OUTSTAND-BAL.
 12824
 12825 3150-RATE-OUTSTAND-BAL.
 12826
 12827* DMD RATING TEST
 12828     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12829         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12830         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12831         MOVE ER-2687                 TO WS-ERROR
 12832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12833         MOVE 'B'                     TO PB-I-OB-FLAG
 12834         GO TO 3260-EDIT-CONTINUE.
 12835
 12836     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12837         IF  WS-ERROR    EQUAL    ER-2693
 12838             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12839                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12840                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12841                 MOVE  +0            TO  WS-ERROR.
 12842
 12843     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12844         IF  WS-ERROR    EQUAL    ER-2693
 12845             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12846                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12847                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12848                 MOVE  +0            TO  WS-ERROR.
 12849
 12850     IF PLAN-MASTER-AH-SW = 'Y'
 12851        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12852            IF  WS-ERROR    EQUAL    ER-2693
 12853              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12854                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12855                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12856                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12857                 MOVE  ER-1910           TO  WS-ERROR
 12858                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12859
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 235
* EL050.cbl
 12860     IF PLAN-MASTER-AH-SW = 'Y'
 12861        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12862            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12863               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12864               MOVE  ER-1910           TO  WS-ERROR
 12865               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12866
 12867     IF PLAN-MASTER-AH-SW = 'Y'
 12868        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12869            IF  WS-ERROR    EQUAL    ER-2693
 12870                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12871                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12872                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12873                 MOVE  +0       TO  WS-ERROR.
 12874
 12875     IF WS-ERROR = ER-2693
 12876        IF PB-COMPANY-ID = 'JAL' AND
 12877           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12878           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12879           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12880
 12881     IF WS-ERROR = ER-2693
 12882        IF PB-COMPANY-ID = 'NCL'  AND
 12883           PB-I-AH-BENEFIT-CD = 'OA'
 12884           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12885           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12886
 12887     IF WS-ERROR = ER-2693
 12888        IF PB-COMPANY-ID = 'CNL' AND
 12889           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12890           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12891           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12892
 12893     IF WS-ERROR = ER-2693
 12894        IF PB-COMPANY-ID = 'HER'
 12895           IF WS-LEVEL
 12896              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12897              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12898
 12899     IF ((LF-BENEFIT-FOUND) AND
 12900         (NOT NO-LIFE-COVERAGE)  AND
 12901         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12902       OR   ((AH-BENEFIT-FOUND) AND
 12903             (NOT NO-AH-COVERAGE)    AND
 12904             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12905         NEXT SENTENCE
 12906     ELSE
 12907         GO TO 3215-EDIT-RATES.
 12908
 12909     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12910        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12911           MOVE ER-2674          TO WS-ERROR
 12912           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12913           GO TO 3215-EDIT-RATES.
 12914
 12915     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12916        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12917           MOVE ER-2674          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 236
* EL050.cbl
 12918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12919           GO TO 3215-EDIT-RATES.
 12920
 12921     MOVE 'B'                    TO PB-I-OB-FLAG.
 12922
 12923     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12924         NEXT SENTENCE
 12925     ELSE
 12926         IF NOT NO-LIFE-COVERAGE
 12927             IF WS-ACCT-LF-OB-RT = ZERO
 12928                MOVE ER-2641    TO WS-ERROR
 12929                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12930
 12931     IF PB-COMPANY-ID = 'CRI'
 12932       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12933         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12934         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12935         IF WS-ERROR = ER-2675
 12936            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12937            MOVE ER-2687              TO WS-ERROR
 12938            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939         ELSE
 12940            MOVE ER-2687              TO WS-ERROR
 12941            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12942
 12943
 12944     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12945         NEXT SENTENCE
 12946     ELSE
 12947       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12948            NEXT SENTENCE
 12949       ELSE
 12950         IF NOT NO-AH-COVERAGE
 12951             IF WS-ACCT-AH-OB-RT = ZERO
 12952                MOVE ER-2642    TO WS-ERROR
 12953                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955     IF PB-COMPANY-ID = 'CRI'
 12956       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12957         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12958         IF WS-ERROR = ER-2676
 12959            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12960            MOVE ER-2687              TO WS-ERROR
 12961            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12962         ELSE
 12963            MOVE ER-2687              TO WS-ERROR
 12964            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12965
 12966     IF PB-COMPANY-ID NOT = 'GIC'
 12967         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12968            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12969     ELSE
 12970         IF PB-I-LF-PREM-CALC = ZEROS
 12971             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12972                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12973
 12974     IF PB-COMPANY-ID NOT = 'GIC'
 12975         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 237
* EL050.cbl
 12976            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12977     ELSE
 12978         IF PB-I-AH-PREM-CALC = ZEROS
 12979             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12980                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12981
 12982     MOVE ZEROS TO PB-I-MORT-CODE.
 12983
 12984     GO TO 3260-EDIT-CONTINUE.
 12985
 12986
 12987 3215-EDIT-RATES.
 12988     IF ACCOUNT-MAST-FOUND
 12989         NEXT SENTENCE
 12990     ELSE
 12991         GO TO 3999-END-EDIT.
 12992
 12993 3220-CHECK-LF-RATES.
 12994
 12995     IF PB-COMPANY-ID = 'DCC'
 12996        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12997        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12998        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12999           AND (NOT WS-LF-CASH))
 13000                           OR
 13001           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13002           AND (NOT WS-AH-CASH)))
 13003                       AND
 13004           (PB-I-ENTRY-STATUS NOT = '5')
 13005           MOVE 'M'              TO PB-BATCH-ENTRY
 13006                                    PB-I-ENTRY-STATUS
 13007        END-IF
 13008     END-IF
 13009     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13010                                    PB-I-AH-PREM-CALC
 13011                                    PB-I-LF-ALT-PREM-CALC
 13012                                    PB-I-LF-ALT-RATE
 13013                                    PB-I-LF-REI-RATE
 13014                                    PB-I-LF-ALT-REI-RATE
 13015                                    PB-I-AH-REI-RATE
 13016                                    PB-I-TOT-FEES-CALC.
 13017
 13018     IF PB-COMPANY-ID EQUAL 'DMD'
 13019        NEXT SENTENCE
 13020     ELSE
 13021        MOVE ZEROS               TO PB-I-LF-RATE
 13022                                    PB-I-AH-RATE.
 13023
 13024     IF PB-I-TOT-FEES NOT NUMERIC
 13025        MOVE ZEROS               TO PB-I-TOT-FEES
 13026     END-IF
 13027     IF PB-I-LIVES NOT NUMERIC
 13028         MOVE ZERO               TO PB-I-LIVES.
 13029
 13030     IF PB-I-NUM-BILLED NOT NUMERIC
 13031         MOVE ZERO               TO PB-I-NUM-BILLED.
 13032
 13033     IF PB-I-LF-PREM-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 238
* EL050.cbl
 13034        MOVE +0                  TO PB-I-LF-PREM-TAX
 13035     END-IF
 13036
 13037     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13038        MOVE +0                  TO PB-I-AH-PREM-TAX
 13039     END-IF
 13040
 13041     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13042        PB-I-PAY-FREQUENCY = ZEROS
 13043            MOVE 12 TO CP-PAY-FREQUENCY
 13044     ELSE
 13045            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13046
 13047     IF PB-I-STATE-TAX NOT NUMERIC
 13048         MOVE ZEROS               TO PB-I-STATE-TAX.
 13049
 13050     IF PB-I-MUNI-TAX NOT NUMERIC
 13051         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13052
 13053     MOVE SPACES                 TO CP-BEN-CATEGORY
 13054     IF PB-COMPANY-ID  = 'CSL'  AND
 13055        PB-I-LF-TERM NOT = ZERO
 13056        COMPUTE WS-PAYMENT-AMT =
 13057             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13058        COMPUTE WS-CSL-AMT1 =
 13059             PB-I-LF-TERM * AM-MAX-MON-BEN
 13060        COMPUTE WS-CSL-AMT2 =
 13061             WS-PAYMENT-AMT * PB-I-LF-TERM
 13062        IF CP-PAY-FREQUENCY NOT = 12
 13063           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13064           MOVE '8' TO WS-CSL-CALC-CD
 13065        ELSE
 13066           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13067              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13068               AM-MAX-TOT-BEN
 13069               MOVE '6' TO WS-CSL-CALC-CD
 13070           ELSE
 13071              IF (WS-CSL-AMT1  GREATER THAN
 13072                 AM-MAX-TOT-BEN) AND
 13073                 (WS-CSL-AMT2  GREATER THAN
 13074                 AM-MAX-TOT-BEN)
 13075                 MOVE '7' TO WS-CSL-CALC-CD
 13076              ELSE
 13077                 MOVE '5' TO WS-CSL-CALC-CD.
 13078
 13079     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13080         NEXT SENTENCE
 13081     ELSE
 13082         GO TO 3300-CHECK-AH-RATES.
 13083
 13084*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13085
 13086     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13087        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13088              OR
 13089           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13090           MOVE ER-2618          TO WS-ERROR
 13091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 239
* EL050.cbl
 13092           GO TO 3300-CHECK-AH-RATES.
 13093
 13094     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13095           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13096                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13097
 13098     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13099         MOVE ER-2687             TO WS-ERROR
 13100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13101         MOVE 'Z000'              TO PB-I-MORT-CODE
 13102         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13103         GO TO 3300-CHECK-AH-RATES.
 13104
 13105     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13106        IF PB-I-LIVES = ZERO
 13107           MOVE ER-2688          TO WS-ERROR
 13108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13109
 13110     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13111
 13112     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13113     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13114     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13115     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13116     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13117     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13118     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13119     MOVE '3'                    TO CP-PROCESS-TYPE.
 13120     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13121     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13122
 13123******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13124     IF PB-COMPANY-ID EQUAL 'CDL'
 13125         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13126            CP-EARN-AS-NET-PAY)
 13127             IF PB-CERT-EFF-DT GREATER  WS-931231
 13128                 MOVE '1'        TO CP-EARNING-METHOD.
 13129*******
 13130
 13131     MOVE PB-SV-STATE            TO CP-STATE.
 13132     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13133     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13134     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13135     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13136     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13137                                    CP-RATING-BENEFIT-AMT.
 13138     IF CP-STATE-STD-ABBRV = 'OR'
 13139         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13140                                         PB-I-LF-ALT-BENEFIT-AMT.
 13141     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13142     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13143     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13144     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13145     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13146     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13147     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13148     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13149     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 240
* EL050.cbl
 13150                                    CP-REMAINING-TERM
 13151                                    CP-LOAN-TERM.
 13152
 13153     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13154         NEXT SENTENCE
 13155     ELSE
 13156         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13157             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13158                                           PB-I-LF-PREMIUM-AMT.
 13159
 13160     IF PB-COMPANY-ID EQUAL 'CSL'
 13161        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13162           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13163                                         PB-I-LF-PREMIUM-AMT.
 13164
 13165     IF PB-COMPANY-ID EQUAL 'NCB'
 13166         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13167            CP-EARN-AS-NET-PAY
 13168             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13169                 PB-I-LF-PREMIUM-AMT.
 13170
 13171     IF (CP-TRUNCATED-LIFE)
 13172        or ((pb-company-id = 'AHL')
 13173           and (pb-i-loan-term > pb-i-lf-term))
 13174        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13175
 13176     IF PB-COMPANY-ID EQUAL 'CRI'
 13177        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13178
 13179     IF CP-TERM-IS-DAYS
 13180         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13181     ELSE
 13182         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13183     IF PB-COMPANY-ID = 'DCC'
 13184        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13185        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13186        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13187        IF WS-LF-BEN-CATEGORY = 'D'
 13188           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13189           MOVE PB-I-LIFE-COMMISSION
 13190                                 TO CP-DCC-ACT-COMM
 13191           MOVE WS-LF-BEN-CATEGORY
 13192                                 TO CP-BEN-CATEGORY
 13193        END-IF
 13194        IF (CP-BENEFIT-CD (1:1) = 'P')
 13195           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13196           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13197        END-IF
 13198     END-IF
 13199     IF PB-COMPANY-ID = 'CSL'
 13200         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13201         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13202         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13203
 13204     IF PB-COMPANY-ID = 'CSL'
 13205        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13206
 13207     IF (CP-SPECIAL-CALC-CD = 'H')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 241
* EL050.cbl
 13208        OR (PB-COMPANY-ID = 'DCC')
 13209         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13210                                    TO CP-ALTERNATE-BENEFIT
 13211         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13212
 13213     IF (PB-COMPANY-ID = 'CID')
 13214        AND (WS-LF-EARNINGS-CALC = 'B')
 13215        AND (CP-STATE-STD-ABBRV = 'MN')
 13216        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13217                                 TO CP-ALTERNATE-BENEFIT
 13218        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13219     END-IF
 13220     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13221     MOVE 'R'                   TO CP-RATE-FILE.
 13222     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13223
 13224     IF CP-ERROR-RATE-NOT-FOUND
 13225        MOVE ER-2641            TO WS-ERROR
 13226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13227        GO TO 3300-CHECK-AH-RATES.
 13228
 13229     IF PB-COMPANY-ID EQUAL 'CRI'
 13230        IF CP-ERROR-NO-LIMITS-CRI
 13231           IF NOT ACCOUNT-LIFE-CHECKED
 13232              MOVE ER-2607      TO WS-ERROR
 13233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13234
 13235******************************************************************
 13236*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13237*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13238******************************************************************
 13239
 13240* CALC LIFE AGE AT EXPIRATION.
 13241
 13242     COMPUTE WS-AGE-AT-EXPIRE =
 13243          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13244
 13245*    IF PB-STATE = 'CO' OR 'UT'
 13246*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13247*        MOVE 'F'            TO PB-FATAL-FLAG
 13248*        MOVE ER-2709        TO WS-ERROR
 13249*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13250*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13251
 13252*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13253*        MOVE 'X'            TO PB-FATAL-FLAG
 13254*        MOVE ER-2718        TO WS-ERROR
 13255*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13257
 13258* CALC A & H AGE AT EXPIRATION.
 13259
 13260     COMPUTE WS-AGE-AT-EXPIRE =
 13261          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13262
 13263*    IF PB-STATE = 'CO' OR 'UT'
 13264*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13265*        MOVE 'F'            TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 242
* EL050.cbl
 13266*        MOVE ER-2709        TO WS-ERROR
 13267*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13268*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13269
 13270*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13271*        MOVE 'X'            TO PB-FATAL-FLAG
 13272*        MOVE ER-2718        TO WS-ERROR
 13273*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13274*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13275
 13276     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13277        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13278
 13279     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13280        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13281
 13282     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13283        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13284
 13285     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13286         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13287         MOVE ER-2639        TO WS-ERROR
 13288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13289
 13290
 13291******************************************************************
 13292*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13293******************************************************************
 13294
 13295 PREMIUM-EDITING-IS-BYPASSED.
 13296     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13297        AND (CP-R-MAX-ATT-AGE > +0)
 13298        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13299        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13300           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13301           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13302           MOVE '1'              TO DC-OPTION-CODE
 13303           PERFORM 8500-DATE-CONVERT
 13304                                 THRU 8500-EXIT
 13305           IF NO-CONVERSION-ERROR
 13306              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13307                 MOVE ER-2661       TO WS-ERROR
 13308*                PERFORM 9900-ERROR-FORMAT
 13309*                                THRU 9900-EXIT
 13310              END-IF
 13311           END-IF
 13312        ELSE
 13313           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13314           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13315              MOVE ER-2661       TO WS-ERROR
 13316*             PERFORM 9900-ERROR-FORMAT
 13317*                                THRU 9900-EXIT
 13318           ELSE
 13319              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13320                 MOVE ER-1570    TO WS-ERROR
 13321                 PERFORM 9900-ERROR-FORMAT
 13322                                 THRU 9900-EXIT
 13323              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 243
* EL050.cbl
 13324           END-IF
 13325        END-IF
 13326        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13327           MOVE PB-I-JOINT-BIRTHDAY
 13328                                 TO DC-BIN-DATE-1
 13329           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13330           MOVE '1'              TO DC-OPTION-CODE
 13331           PERFORM 8500-DATE-CONVERT
 13332                                 THRU 8500-EXIT
 13333           IF NO-CONVERSION-ERROR
 13334              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13335                 MOVE ER-2661       TO WS-ERROR
 13336*                PERFORM 9900-ERROR-FORMAT
 13337*                                THRU 9900-EXIT
 13338              END-IF
 13339           ELSE
 13340              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13341           END-IF
 13342        ELSE
 13343           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13344             (PB-I-LF-TERM / 12)
 13345           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13346              MOVE ER-2661       TO WS-ERROR
 13347*             PERFORM 9900-ERROR-FORMAT
 13348*                                THRU 9900-EXIT
 13349           ELSE
 13350              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13351                 MOVE ER-1571    TO WS-ERROR
 13352                 PERFORM 9900-ERROR-FORMAT
 13353                                 THRU 9900-EXIT
 13354              END-IF
 13355           END-IF
 13356        END-IF
 13357        IF WS-ERROR = ER-2661
 13358           PERFORM 9900-ERROR-FORMAT
 13359                                 THRU 9900-EXIT
 13360        END-IF
 13361     END-IF
 13362*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13363*       MOVE ER-2661             TO WS-ERROR
 13364*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13365
 13366     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13367        MOVE ER-2662             TO WS-ERROR
 13368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13369
 13370     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13371        MOVE ER-2677             TO WS-ERROR
 13372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13373
 13374     IF CP-ERROR-LOAN-TERM
 13375        MOVE ER-2648             TO WS-ERROR
 13376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13377
 13378 3221-CHECK-ERROR-RATE-OPEN.
 13379
 13380     IF CP-ERROR-RATE-FILE-NOTOPEN
 13381         GO TO 3990-FILES-NOT-OPEN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 244
* EL050.cbl
 13382
 13383     IF PB-COMPANY-ID NOT = 'DMD'
 13384        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13385     END-IF
 13386     .
 13387 3221-CONTINUE.
 13388     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13389                                    WS-DCC-AH-RATE
 13390     IF PB-COMPANY-ID = 'DCC'
 13391        IF WS-LF-BEN-CATEGORY = 'D'
 13392           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13393              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13394        END-IF
 13395     END-IF
 13396     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13397*   X'A4FF' = 12/31/2009
 13398     IF (PB-COMPANY-ID = 'CID')
 13399        AND (WS-LF-EARNINGS-CALC = 'B')
 13400        AND (CP-STATE-STD-ABBRV = 'MN')
 13401        AND (PB-CERT-EFF-DT > X'A4FF')
 13402        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13403     END-IF
 13404     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13405
 13406     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13407     IF (PB-COMPANY-ID = 'DCC')
 13408        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13409        AND (PB-I-POLICY-IS-MONTHLY)
 13410        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13411        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13412     END-IF
 13413     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13414     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13415     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13416     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13417     IF (PB-COMPANY-ID = 'DCC')
 13418        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13419        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13420        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13421        MOVE ER-2786             TO WS-ERROR
 13422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13423     END-IF
 13424
 13425     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13426
 13427******************************************************************
 13428*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13429******************************************************************
 13430     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13431        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13432
 13433     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13434        GO TO 3225-CHECK-ALT-LIFE-RATE
 13435     ELSE
 13436       IF PB-I-LF-RATE = ZERO
 13437          MOVE ER-2641          TO WS-ERROR
 13438          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13439
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 245
* EL050.cbl
 13440 3225-CHECK-ALT-LIFE-RATE.
 13441
 13442     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13443        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13444        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13445         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13446
 13447     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13448         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13449             AND PB-COMPANY-ID NOT = 'DCC')
 13450                   OR
 13451              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13452              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13453              AND PB-COMPANY-ID NOT = 'DCC')
 13454             MOVE ER-2720        TO  WS-ERROR
 13455             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13456             GO TO 3225-RATING-CONT
 13457         ELSE
 13458             GO TO 3225-RATING-CONT.
 13459     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13460        AND (AM-GPCD = 01 OR 06 OR 15)
 13461        MOVE ER-2798             TO WS-ERROR
 13462        PERFORM 9900-ERROR-FORMAT
 13463                                 THRU 9900-EXIT
 13464*       GO TO 3225-RATING-CONT
 13465     END-IF
 13466     IF (PB-COMPANY-ID = 'CID')
 13467        AND (WS-LF-EARNINGS-CALC = 'B')
 13468        AND (CP-STATE-STD-ABBRV = 'MN')
 13469        AND (PB-CERT-EFF-DT > X'A4FF')
 13470        GO TO 3225-RATING-CONT
 13471     END-IF
 13472     IF PB-COMPANY-ID = 'DCC'
 13473        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13474           AND (PB-I-POLICY-IS-MONTHLY)
 13475           GO TO 3225-RATING-CONT
 13476        END-IF
 13477     END-IF
 13478
 13479     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13480        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13481        CP-EARN-AS-REG-BALLOON
 13482        NEXT SENTENCE
 13483     ELSE
 13484        MOVE '2'                 TO CP-EARNING-METHOD.
 13485
 13486 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13487
 13488     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13489
 13490     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13491        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13492        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13493         NEXT SENTENCE
 13494     ELSE
 13495         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13496
 13497     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 246
* EL050.cbl
 13498     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13499     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13500                                     CP-RATING-BENEFIT-AMT.
 13501     IF CP-STATE-STD-ABBRV = 'OR'
 13502         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13503                                         PB-I-LF-ALT-BENEFIT-AMT.
 13504     IF PB-COMPANY-ID = 'DCC'
 13505        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13506     END-IF
 13507     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13508     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13509     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13510                                    CP-REMAINING-TERM
 13511                                    CP-LOAN-TERM.
 13512     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13513        ADD +1                   TO CP-ORIGINAL-TERM
 13514                                    CP-REMAINING-TERM
 13515                                    CP-LOAN-TERM.
 13516
 13517     MOVE 'R'                   TO CP-RATE-FILE.
 13518     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13519
 13520     IF CP-ERROR-RATE-NOT-FOUND
 13521         MOVE ER-2641            TO WS-ERROR
 13522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13523         GO TO 3300-CHECK-AH-RATES.
 13524
 13525     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13526     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13527
 13528     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13529         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13530
 13531     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13532                               + PB-I-LF-ALT-BENEFIT-AMT.
 13533
 13534     IF ACCOUNT-LIFE-CHECKED  OR
 13535        PB-POLICY-IS-VOIDED   OR
 13536        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13537        GO TO 3225-CONTINUE.
 13538
 13539     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13540        GO TO 3225-CONTINUE.
 13541
 13542     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13543                             EC-RT-LF-MAX-TOT-BEN
 13544        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13545        MOVE ER-2639       TO WS-ERROR
 13546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13547
 13548 3225-CONTINUE.
 13549     IF PB-I-LF-ALT-RATE = ZERO
 13550         MOVE ER-2659            TO WS-ERROR
 13551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13552
 13553     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13554        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13555        MOVE ER-2698             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 247
* EL050.cbl
 13556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13557
 13558 3225-RATING-CONT.
 13559
 13560     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13561         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13562         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13563         IF (PB-COMPANY-ID = 'DCC')
 13564            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13565            CONTINUE
 13566         ELSE
 13567            MOVE ER-2687         TO WS-ERROR
 13568            PERFORM 9900-ERROR-FORMAT
 13569                                 THRU 9900-EXIT
 13570         END-IF
 13571         GO TO 3290-EDIT-LF-REIN-RATE
 13572     END-IF
 13573
 13574* DMD RATING TEST
 13575     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13576         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13577         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13578         MOVE ER-2687                 TO WS-ERROR
 13579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13580         GO TO 3290-EDIT-LF-REIN-RATE.
 13581
 13582 3230-CLIENT-MORT-CD-SPECIALS.
 13583
 13584     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13585     SET BIN-TO-GREG          TO TRUE.
 13586*    MOVE ' '                 TO DC-OPTION-CODE.
 13587     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13588     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13589
 13590 C-POS-3230-MORT-CD.
 13591     IF PB-COMPANY-ID = 'POS' AND
 13592        PB-SV-CARRIER = '2'
 13593         NEXT SENTENCE
 13594     ELSE
 13595         GO TO C-POS-3240-MORT-CD.
 13596
 13597     IF PB-SV-GROUPING = '030'
 13598        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13599         MOVE '2350' TO PB-I-MORT-CODE
 13600      ELSE
 13601         MOVE '3300' TO PB-I-MORT-CODE.
 13602
 13603
 13604 C-POS-3240-MORT-CD.
 13605     IF PB-COMPANY-ID = 'POS' AND
 13606        PB-SV-CARRIER = '1'
 13607         NEXT SENTENCE
 13608     ELSE
 13609         GO TO 3230-CONTINUE.
 13610
 13611     IF PB-SV-STATE = '45' OR '47'
 13612        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13613         MOVE '5200' TO PB-I-MORT-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 248
* EL050.cbl
 13614     ELSE
 13615         MOVE '8300' TO PB-I-MORT-CODE.
 13616
 13617 3230-CONTINUE.
 13618
 13619     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13620        GO TO 3240-CONTINUE
 13621     END-IF
 13622
 13623     IF PB-CERT-EFF-DT > WS-971231
 13624        GO TO 3240-CONTINUE
 13625     END-IF
 13626
 13627     IF LF-BENEFIT-FOUND AND
 13628        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13629         MOVE 'F250'       TO PB-I-MORT-CODE
 13630     ELSE
 13631         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13632             MOVE '7250'   TO PB-I-MORT-CODE
 13633         ELSE
 13634             MOVE '4251'   TO PB-I-MORT-CODE
 13635         END-IF
 13636     END-IF
 13637
 13638     .
 13639 3240-CONTINUE.
 13640
 13641     IF PB-COMPANY-ID NOT = 'GNL'
 13642         GO TO 3256-CONTINUE.
 13643
 13644     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13645         MOVE 'A300' TO PB-I-MORT-CODE
 13646     ELSE
 13647         MOVE '8350' TO PB-I-MORT-CODE.
 13648
 13649 3256-CONTINUE.
 13650     IF PB-COMPANY-ID NOT = 'ABL'
 13651         GO TO 3260-EDIT-CONTINUE.
 13652
 13653     IF PB-I-LF-TERM GREATER THAN 59
 13654         MOVE 'F550' TO PB-I-MORT-CODE
 13655     ELSE
 13656         MOVE 'E550' TO PB-I-MORT-CODE.
 13657
 13658 3260-EDIT-CONTINUE.
 13659     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13660
 13661 3290-EDIT-LF-REIN-RATE.
 13662     IF LF-REIN-NSP-NOT-USED
 13663         GO TO 3290-RATING-CONT.
 13664
 13665     IF PB-COMPANY-ID = 'DCC'
 13666        GO TO 3290-RATING-CONT.
 13667     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13668     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13669     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13670     MOVE '3'                   TO CP-PROCESS-TYPE.
 13671     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 249
* EL050.cbl
 13672
 13673******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13674     IF PB-COMPANY-ID EQUAL 'CDL'
 13675         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13676            CP-EARN-AS-NET-PAY)
 13677             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13678*            MOVE SPACE          TO DC-OPTION-CODE
 13679             SET BIN-TO-GREG     TO TRUE
 13680             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13681***  Y2K PROJ 7744
 13682             IF DC-GREG-DATE-CYMD GREATER 19931231
 13683                 MOVE '1'        TO CP-EARNING-METHOD.
 13684***  Y2K PROJ 7744
 13685*******
 13686
 13687     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13688     MOVE PB-SV-STATE           TO CP-STATE.
 13689     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13690     MOVE ZERO                  TO CP-DEVIATION-CODE
 13691                                   CP-RATE-DEV-PCT.
 13692     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13693     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13694                                   CP-RATING-BENEFIT-AMT.
 13695
 13696************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13697     IF PB-COMPANY-ID EQUAL 'NCB'
 13698         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13699            CP-EARN-AS-NET-PAY
 13700             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13701                 PB-I-LF-PREMIUM-AMT.
 13702************
 13703
 13704     IF CP-STATE-STD-ABBRV = 'OR'
 13705         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13706                                         PB-I-LF-ALT-BENEFIT-AMT.
 13707     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13708     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13709     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13710     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13711     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13712     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13713     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13714     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13715                                   CP-REMAINING-TERM
 13716                                   CP-LOAN-TERM.
 13717     IF CP-TRUNCATED-LIFE
 13718        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13719
 13720     IF CP-TERM-IS-DAYS
 13721         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13722     ELSE
 13723         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13724
 13725     IF PB-COMPANY-ID = 'DCC'
 13726        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13727     END-IF
 13728     IF PB-COMPANY-ID NOT = 'TIC'
 13729          MOVE ZERO          TO CP-CLASS-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 250
* EL050.cbl
 13730
 13731     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13732
 13733     MOVE 'R'                   TO CP-RATE-FILE.
 13734     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13735
 13736     IF CP-ERROR-RATE-NOT-FOUND
 13737        IF PB-I-OB
 13738           MOVE ER-2625      TO WS-ERROR
 13739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13740           GO TO 3299-EDIT-CONTINUE
 13741        ELSE
 13742           MOVE ER-2643      TO WS-ERROR
 13743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13744           GO TO 3299-EDIT-CONTINUE.
 13745
 13746     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13747
 13748     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13749     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13750
 13751     IF PB-I-LF-REI-RATE = ZERO
 13752         MOVE ER-2643        TO WS-ERROR
 13753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13754
 13755 3290-CHECK-ALT-REIN-RATE.
 13756
 13757     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13758        GO TO 3290-RATING-CONT.
 13759
 13760     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13761     MOVE '2'                    TO CP-EARNING-METHOD.
 13762     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13763     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13764     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13765     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13766                                     CP-RATING-BENEFIT-AMT.
 13767     IF CP-STATE-STD-ABBRV = 'OR'
 13768         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13769                                         PB-I-LF-ALT-BENEFIT-AMT.
 13770     IF PB-COMPANY-ID = 'DCC'
 13771        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13772     END-IF
 13773     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13774     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13775     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13776                                    CP-REMAINING-TERM
 13777                                    CP-LOAN-TERM.
 13778     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13779        ADD +1                   TO CP-ORIGINAL-TERM
 13780                                    CP-REMAINING-TERM
 13781                                    CP-LOAN-TERM.
 13782
 13783     MOVE 'R'                   TO CP-RATE-FILE.
 13784     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13785
 13786     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13787
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 251
* EL050.cbl
 13788     IF PB-I-LF-ALT-REI-RATE = ZERO
 13789         MOVE ER-2643            TO WS-ERROR
 13790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13791
 13792 3290-RATING-CONT.
 13793
 13794     IF PB-I-OB
 13795*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13796        GO TO 3300-CHECK-AH-RATES.
 13797
 13798 3299-EDIT-CONTINUE.
 13799
 13800     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13801         NEXT SENTENCE
 13802     ELSE
 13803         MOVE ER-2620           TO WS-ERROR
 13804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13805
 13806 3300-CHECK-AH-RATES.
 13807     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13808         NEXT SENTENCE
 13809     ELSE
 13810         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13811
 13812     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13813        ((CF-COMPANY-ID = 'DMD') AND
 13814                (NO-DMD-RATING))
 13815         IF (PB-COMPANY-ID = 'DCC')
 13816            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13817            CONTINUE
 13818         ELSE
 13819            MOVE ER-2687         TO WS-ERROR
 13820            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13821         END-IF
 13822         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13823         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13824     END-IF
 13825
 13826     IF PB-I-OB
 13827        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13828
 13829     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13830         MOVE ER-2687             TO WS-ERROR
 13831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13832         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13833         GO TO 3999-END-EDIT.
 13834
 13835*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13836
 13837     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13838        IF PB-I-AH-CRIT-PER = ZERO
 13839           IF PB-COMPANY-ID = 'DCC'
 13840              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13841              CONTINUE
 13842           ELSE
 13843              MOVE ER-2618       TO WS-ERROR
 13844              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13845              GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 252
* EL050.cbl
 13846           END-IF
 13847        END-IF
 13848     END-IF
 13849     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13850     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13851     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13852     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13853     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13854     MOVE PB-SV-STATE            TO CP-STATE.
 13855     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13856     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13857     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13858*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13859     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13860     MOVE '3'                    TO CP-PROCESS-TYPE.
 13861     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13862     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13863                                    CP-RATING-BENEFIT-AMT.
 13864     IF PB-COMPANY-ID = 'CID'
 13865               OR
 13866        CP-STATE-STD-ABBRV = 'OR'
 13867         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13868                                         PB-I-AH-TERM.
 13869     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13870        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13871           AND (PB-I-POLICY-IS-MONTHLY)
 13872           MOVE PB-I-LF-BENEFIT-AMT
 13873                                 TO CP-NET-BENEFIT-AMT
 13874           move pb-i-ah-premium-amt to cp-original-premium
 13875        END-IF
 13876     END-IF
 13877     MOVE SPACES                 TO CP-BEN-CATEGORY
 13878     IF PB-COMPANY-ID = 'DCC'
 13879        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13880        EVALUATE TRUE
 13881           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13882              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13883              MOVE PB-I-LF-BENEFIT-AMT
 13884                                 TO CP-RATING-BENEFIT-AMT
 13885              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13886           WHEN WS-AH-BEN-CATEGORY = 'G'
 13887              MOVE PB-I-UNPAID-CASH-PRICE
 13888                                 TO CP-RATING-BENEFIT-AMT
 13889           WHEN WS-AH-BEN-CATEGORY = 'D'
 13890              MOVE WS-AH-PMF-COMM
 13891                                 TO CP-DCC-PMF-COMM
 13892              MOVE PB-I-AH-COMMISSION
 13893                                 TO CP-DCC-ACT-COMM
 13894        END-EVALUATE
 13895     END-IF
 13896     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13897     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13898     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13899     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13900     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13901     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13902     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13903                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 253
* EL050.cbl
 13904                                    WS-WORK-TERM.
 13905     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13906
 13907     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13908     SET BIN-TO-GREG             TO TRUE.
 13909*    MOVE ' '                    TO DC-OPTION-CODE.
 13910     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13911     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13912
 13913     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13914     IF NOT VALID-SKIP-CODE
 13915         MOVE ER-2683            TO WS-ERROR
 13916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13917         GO TO 3320-RATE-CONTINUE.
 13918
 13919     IF PB-NO-MONTHS-SKIPPED
 13920         GO TO 3320-RATE-CONTINUE.
 13921
 13922     MOVE SPACE TO NUMBER-OF-MONTHS.
 13923
 13924     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13925         MOVE 'S'                TO SK-MO (6).
 13926     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13927         MOVE 'S'                TO SK-MO (7).
 13928     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13929         MOVE 'S'                TO SK-MO (8).
 13930     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13931         MOVE 'S'                TO SK-MO (9).
 13932     IF PB-I-SKIP-CODE = 'A'
 13933         MOVE 'S'                TO SK-MO (10).
 13934
 13935     MOVE 1                      TO SUB2.
 13936     MOVE PB-I-AH-TERM           TO SUB3.
 13937     MOVE WS-MONTH               TO SUB1.
 13938     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13939     GO TO 3320-RATE-CONTINUE.
 13940
 13941 3310-GET-SKIP-MO.
 13942     IF SUB1 = 13
 13943         MOVE 1                  TO SUB1.
 13944
 13945     IF SK-MO (SUB1) = 'S'
 13946         SUBTRACT 1 FROM WS-WORK-TERM.
 13947
 13948     ADD 1 TO SUB2
 13949              SUB1.
 13950
 13951 3320-RATE-CONTINUE.
 13952
 13953     IF WS-WORK-TERM = ZERO
 13954         MOVE 1                  TO WS-WORK-TERM.
 13955
 13956     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13957                                    CP-LOAN-TERM.
 13958
 13959     IF PB-COMPANY-ID EQUAL 'DMD'
 13960         NEXT SENTENCE
 13961     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 254
* EL050.cbl
 13962         MOVE ZERO               TO PB-I-AH-RATE
 13963                                    PB-I-AH-REI-RATE.
 13964
 13965
 13966     IF PB-COMPANY-ID EQUAL 'CRI'
 13967        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13968
 13969     IF PB-COMPANY-ID = 'CSL'
 13970         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13971         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13972         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13973         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13974
 13975     IF PB-COMPANY-ID = 'DCC'
 13976        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13977           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13978              PB-I-RATE-DEV-PCT-LF
 13979        END-IF
 13980        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13981                                 TO CP-ALTERNATE-BENEFIT
 13982        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13983        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13984        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13985     END-IF
 13986     IF (PB-COMPANY-ID = 'CID')
 13987        AND (WS-LF-EARNINGS-CALC = 'B')
 13988        AND (CP-STATE-STD-ABBRV = 'MN')
 13989        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13990     ELSE
 13991        MOVE ' '                 TO CP-AH-BALLOON-SW
 13992     END-IF
 13993     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13994     MOVE 'R'                   TO CP-RATE-FILE.
 13995     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13996
 13997     IF CP-ERROR-RATE-NOT-FOUND
 13998        IF PB-I-OB
 13999           MOVE ER-2624          TO WS-ERROR
 14000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14001           GO TO 3340-CALCULATE-PREMIUM-AMT
 14002        ELSE
 14003          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14004              NEXT SENTENCE
 14005          ELSE
 14006           MOVE ER-2642          TO WS-ERROR
 14007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14008           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14009
 14010     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14011        CP-ERROR-DIV-BY-ZERO
 14012           MOVE ER-3782          TO WS-ERROR
 14013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14014
 14015     IF PB-COMPANY-ID EQUAL 'CRI'
 14016        IF CP-ERROR-NO-LIMITS-CRI
 14017           IF NOT ACCOUNT-AH-CHECKED
 14018              MOVE ER-2607          TO WS-ERROR
 14019              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 255
* EL050.cbl
 14020
 14021     IF ACCOUNT-AH-CHECKED
 14022        NEXT SENTENCE
 14023     ELSE
 14024       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14025          MOVE ER-2640           TO WS-ERROR
 14026          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14027
 14028     IF PB-COMPANY-ID = 'CRI'
 14029         IF WS-ERROR = ER-2640
 14030             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14031     IF ACCOUNT-AH-CHECKED
 14032        CONTINUE
 14033     ELSE
 14034        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14035           AND (CP-R-MAX-ATT-AGE > +0)
 14036           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14037           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14038              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14039              MOVE PB-I-AH-EXPIRE-DT
 14040                                 TO DC-BIN-DATE-2
 14041              MOVE '1'           TO DC-OPTION-CODE
 14042              PERFORM 8500-DATE-CONVERT
 14043                                 THRU 8500-EXIT
 14044              IF NO-CONVERSION-ERROR
 14045                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14046                    MOVE ER-2661       TO WS-ERROR
 14047*                   PERFORM 9900-ERROR-FORMAT
 14048*                                THRU 9900-EXIT
 14049                 END-IF
 14050              END-IF
 14051           ELSE
 14052              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14053              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14054                 MOVE ER-2661    TO WS-ERROR
 14055*                PERFORM 9900-ERROR-FORMAT
 14056*                                THRU 9900-EXIT
 14057              ELSE
 14058                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14059                    MOVE ER-1570 TO WS-ERROR
 14060                    PERFORM 9900-ERROR-FORMAT
 14061                                 THRU 9900-EXIT
 14062                 END-IF
 14063              END-IF
 14064           END-IF
 14065           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14066              MOVE PB-I-JOINT-BIRTHDAY
 14067                                    TO DC-BIN-DATE-1
 14068              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14069              MOVE '1'              TO DC-OPTION-CODE
 14070              PERFORM 8500-DATE-CONVERT
 14071                                    THRU 8500-EXIT
 14072              IF NO-CONVERSION-ERROR
 14073                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14074                    MOVE ER-2661       TO WS-ERROR
 14075*                   PERFORM 9900-ERROR-FORMAT
 14076*                                   THRU 9900-EXIT
 14077                 END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 256
* EL050.cbl
 14078              END-IF
 14079           ELSE
 14080              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14081                (PB-I-AH-TERM / 12)
 14082              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14083                 MOVE ER-2661       TO WS-ERROR
 14084*                PERFORM 9900-ERROR-FORMAT
 14085*                                   THRU 9900-EXIT
 14086              ELSE
 14087                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14088                    MOVE ER-1571 TO WS-ERROR
 14089                    PERFORM 9900-ERROR-FORMAT
 14090                                 THRU 9900-EXIT
 14091                 END-IF
 14092              END-IF
 14093           END-IF
 14094           IF WS-ERROR = ER-2661
 14095              PERFORM 9900-ERROR-FORMAT
 14096                                    THRU 9900-EXIT
 14097           END-IF
 14098        END-IF
 14099     END-IF
 14100*    IF ACCOUNT-AH-CHECKED
 14101*       NEXT SENTENCE
 14102*    ELSE
 14103*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14104*          MOVE ER-2661          TO WS-ERROR
 14105*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14106
 14107     IF ACCOUNT-AH-CHECKED
 14108        NEXT SENTENCE
 14109     ELSE
 14110        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14111           MOVE ER-2663          TO WS-ERROR
 14112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14113
 14114     IF ACCOUNT-AH-CHECKED OR
 14115        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14116         PB-POLICY-IS-VOIDED
 14117        NEXT SENTENCE
 14118     ELSE
 14119        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14120           MOVE ER-2667            TO WS-ERROR
 14121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14122
 14123     IF PB-COMPANY-ID = 'CRI'
 14124         IF WS-ERROR = ER-2667
 14125             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14126
 14127     IF ACCOUNT-AH-CHECKED
 14128        NEXT SENTENCE
 14129     ELSE
 14130        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14131           MOVE ER-2678            TO WS-ERROR
 14132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14133
 14134     IF CP-ERROR-RATE-FILE-NOTOPEN
 14135         GO TO 3990-FILES-NOT-OPEN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 257
* EL050.cbl
 14136
 14137 3321-CONTINUE.
 14138     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14139     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14140     IF (PB-COMPANY-ID = 'DCC')
 14141        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14142        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14143                                    PB-I-LF-ALT-PREM-CALC
 14144        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14145        IF WS-AH-BEN-CATEGORY = 'G'
 14146           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14147           + PB-I-ADDL-CLP)
 14148           * (1 + WS-TOL-CLP-PCT)
 14149*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14150        ELSE
 14151           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14152           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14153*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14154        END-IF
 14155        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14156                                 TO PB-I-AH-PREM-CALC
 14157        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14158           MOVE ER-8152          TO WS-ERROR
 14159           PERFORM 9900-ERROR-FORMAT
 14160                                 THRU 9900-EXIT
 14161        ELSE
 14162           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14163                 PB-I-ADDL-CLP)
 14164              MOVE ER-8148       TO WS-ERROR
 14165              PERFORM 9900-ERROR-FORMAT
 14166                                 THRU 9900-EXIT
 14167           END-IF
 14168        END-IF
 14169     END-IF
 14170     IF (PB-COMPANY-ID = 'DCC')
 14171        AND (PB-I-POLICY-IS-MONTHLY)
 14172        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14173        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14174        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14175           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14176        END-IF
 14177     END-IF
 14178     IF (PB-COMPANY-ID = 'DCC')
 14179        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14180        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14181        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14182        MOVE ER-2786             TO WS-ERROR
 14183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14184     END-IF
 14185     MOVE +0                     TO PB-I-AH-CLP
 14186     IF PB-COMPANY-ID = 'DCC'
 14187        IF WS-AH-BEN-CATEGORY = 'D'
 14188           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14189              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14190        ELSE
 14191           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14192              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14193           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 258
* EL050.cbl
 14194        END-IF
 14195     END-IF
 14196     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14197
 14198     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14199         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14200
 14201     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14202         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14203
 14204     IF PB-COMPANY-ID = 'CRI'
 14205         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14206            PB-I-PAYMENT-AMOUNT = ZERO
 14207             NEXT SENTENCE
 14208         ELSE
 14209             COMPUTE PB-I-AH-PREM-CALC =
 14210                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14211                 (CP-PREMIUM-RATE / 100)
 14212             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14213                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14214                                             PB-I-RATE-DEV-PCT-AH.
 14215
 14216     IF PB-I-AH-RATE  = ZERO
 14217       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14218           NEXT SENTENCE
 14219       ELSE
 14220         MOVE ER-2642            TO WS-ERROR
 14221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14222
 14223     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14224     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14225     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14226     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14227     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14228     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14229
 14230     IF (PB-COMPANY-ID = 'DCC')
 14231        AND (WS-AH-BEN-CATEGORY = 'G')
 14232        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14233        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14234        IF CP-DEVIATION-CODE NOT = '000'
 14235           MOVE '000'            TO CP-DEVIATION-CODE
 14236           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14237           IF NO-CP-ERROR
 14238              COMPUTE PB-I-DDF-IU-RATE-UP =
 14239              PB-I-AH-CLP - CP-CALC-PREMIUM
 14240           ELSE
 14241              MOVE ER-3057        TO WS-ERROR
 14242              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14243           END-IF
 14244        END-IF
 14245     END-IF
 14246     .
 14247 3335-EDIT-AH-REIN-NSP-RATE.
 14248     IF AH-REIN-NSP-NOT-USED
 14249         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14250
 14251     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 259
* EL050.cbl
 14252     IF PB-COMPANY-ID = 'DCC'
 14253         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14254     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14255     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14256     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14257     MOVE PB-SV-STATE            TO CP-STATE.
 14258     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14259     MOVE ZERO                   TO CP-DEVIATION-CODE
 14260                                    CP-RATE-DEV-PCT.
 14261*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14262     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14263     MOVE '3'                    TO CP-PROCESS-TYPE.
 14264     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14265     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14266                                    CP-RATING-BENEFIT-AMT.
 14267     IF CP-STATE-STD-ABBRV = 'OR'
 14268         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14269                                         PB-I-AH-TERM.
 14270     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14271     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14272     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14273     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14274     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14275     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14276                                    CP-REMAINING-TERM
 14277                                    WS-WORK-TERM.
 14278     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14279     IF PB-COMPANY-ID = 'DCC'
 14280        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14281     END-IF
 14282     IF  PB-COMPANY-ID = 'TIC'
 14283         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14284            MOVE ZERO TO CP-CLASS-CODE.
 14285
 14286     IF PB-COMPANY-ID NOT = 'TIC'
 14287          MOVE ZERO          TO CP-CLASS-CODE.
 14288
 14289     MOVE ZERO               TO CP-DEVIATION-CODE.
 14290
 14291     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14292
 14293     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14294
 14295     MOVE 'R'                   TO CP-RATE-FILE.
 14296     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14297
 14298     IF CP-ERROR-RATE-NOT-FOUND
 14299         MOVE ER-2645        TO WS-ERROR
 14300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14301         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14302
 14303     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14304
 14305     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14306     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14307
 14308     IF PB-I-AH-REI-RATE = ZERO
 14309         MOVE ER-2645        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 260
* EL050.cbl
 14310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14311
 14312
 14313 3340-CALCULATE-PREMIUM-AMT.
 14314
 14315     IF PB-COMPANY-ID = 'NCL'
 14316         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14317             WS-AH-SPECIAL-CALC-CD = 'O')
 14318             GO TO 3999-END-EDIT.
 14319
 14320     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14321                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14322                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14323                         OR 'AHL'
 14324         NEXT SENTENCE
 14325     ELSE
 14326         IF WS-STATE-ABBREVIATION = 'CT'
 14327             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14328                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14329                 COMPUTE PB-I-LF-PREM-CALC =
 14330                                     PB-I-LF-PREM-CALC * .90
 14331                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14332                                     PB-I-LF-ALT-PREM-CALC * .90
 14333                 COMPUTE PB-I-AH-PREM-CALC =
 14334                                     PB-I-AH-PREM-CALC * .90.
 14335
 14336     IF PB-COMP-LF-PREM
 14337        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14338        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14339
 14340     IF PB-COMP-AH-PREM
 14341        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14342
 14343 3340-CHECK-DCC-TOT-FEES.
 14344     IF (PB-COMPANY-ID = 'DCC')
 14345        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14346        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14347        AND (PB-I-POLICY-IS-MONTHLY)
 14348        CONTINUE
 14349     ELSE
 14350        GO TO 3340-EDIT-LF-AH-TOL
 14351     END-IF
 14352     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14353     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14354     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14355        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14356           PB-I-RATE-DEV-PCT-LF
 14357     END-IF
 14358     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14359        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14360           PB-I-RATE-DEV-PCT-AH
 14361     END-IF
 14362     MOVE 'N'                    TO CP-BEN-CATEGORY
 14363     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14364
 14365     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14366     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14367     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 261
* EL050.cbl
 14368     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14369     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14370     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14371     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14372     MOVE '3'                    TO CP-PROCESS-TYPE.
 14373     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14374     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14375
 14376     MOVE PB-SV-STATE            TO CP-STATE.
 14377     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14378     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14379     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14380     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14381     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14382                                    CP-RATING-BENEFIT-AMT.
 14383     IF CP-STATE-STD-ABBRV = 'OR'
 14384         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14385                                         PB-I-LF-ALT-BENEFIT-AMT.
 14386     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14387     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14388     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14389     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14390     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14391     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14392     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14393     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14394     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14395                                    CP-REMAINING-TERM
 14396                                    CP-LOAN-TERM.
 14397
 14398     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14399         NEXT SENTENCE
 14400     ELSE
 14401         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14402             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14403                                           PB-I-LF-PREMIUM-AMT.
 14404
 14405     IF CP-TRUNCATED-LIFE
 14406        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14407
 14408     IF CP-TERM-IS-DAYS
 14409         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14410     ELSE
 14411         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14412
 14413     IF PB-COMPANY-ID = 'DCC'
 14414        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14415     END-IF
 14416     IF CP-SPECIAL-CALC-CD = 'H'
 14417         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14418                                    TO CP-ALTERNATE-BENEFIT
 14419         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14420     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14421     MOVE 'R'                    TO CP-RATE-FILE
 14422     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14423     IF NOT CP-ERROR-RATE-NOT-FOUND
 14424        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14425        IF (CP-DCC-LF-RATE NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 262
* EL050.cbl
 14426           AND (CP-BENEFIT-CD (1:1) = 'S')
 14427           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14428                                    PB-I-LF-PREMIUM-AMT
 14429        END-IF
 14430     ELSE
 14431        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14432     END-IF
 14433     .
 14434 3340-EDIT-LF-AH-TOL.
 14435
 14436***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14437***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14438***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14439***
 14440     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14441         PB-I-AH-PREMIUM-AMT
 14442          GIVING WS-CALC-WORK.
 14443
 14444     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14445        AND WS-CALC-WORK NOT = ZERO
 14446         MOVE ER-2649            TO WS-ERROR
 14447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14448
 14449     SUBTRACT PB-I-LF-PREM-CALC
 14450             FROM PB-I-LF-PREMIUM-AMT
 14451                 GIVING WS-UNSIGN-WRK1.
 14452
 14453     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14454             FROM PB-I-LF-ALT-PREMIUM-AMT
 14455                 GIVING WS-UNSIGN-WRK4.
 14456
 14457     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14458                                + WS-UNSIGN-WRK4.
 14459
 14460     SUBTRACT PB-I-AH-PREM-CALC
 14461             FROM PB-I-AH-PREMIUM-AMT
 14462                 GIVING WS-UNSIGN-WRK2.
 14463
 14464******************************************************************
 14465*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14466******************************************************************
 14467
 14468     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14469         MOVE ZERO TO WS-UNSIGN-WRK1.
 14470
 14471     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14472         MOVE ZERO TO WS-UNSIGN-WRK2.
 14473
 14474     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14475             GIVING WS-UNSIGN-WRK3.
 14476
 14477 3342-CONTINUE.
 14478
 14479     IF (PB-I-LF-RATE = ZERO  AND
 14480         PB-I-AH-RATE = ZERO)
 14481         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14482            WS-AH-SPECIAL-CALC-CD = 'O'
 14483              NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 263
* EL050.cbl
 14484         ELSE
 14485             GO TO 3345-EDIT-CONTINUE.
 14486
 14487     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14488         NEXT SENTENCE
 14489     ELSE
 14490     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14491        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14492           IF (PB-REISSUED-CERT         OR
 14493               PB-POLICY-IS-DECLINED    OR
 14494               PB-POLICY-IS-VOIDED)
 14495              NEXT SENTENCE
 14496           ELSE
 14497              IF WS-PREM-REJECT-SW = SPACE
 14498                 MOVE ER-2652    TO WS-ERROR
 14499                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500                 GO TO 3344-CHECK-AH
 14501              ELSE
 14502                 MOVE ER-2650    TO WS-ERROR
 14503                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14504                 GO TO 3344-CHECK-AH.
 14505
 14506***
 14507***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14508***
 14509
 14510     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14511         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14512            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14513             (1 + WS-TOL-LF-PREM-PCT)
 14514         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14515            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14516             (1 - WS-TOL-LF-PREM-PCT)
 14517     ELSE
 14518         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14519         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14520
 14521***
 14522***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14523***
 14524
 14525     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14526         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14527          WS-TOL-LF-PREM.
 14528
 14529     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14530         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14531          WS-TOL-LF-PREM.
 14532
 14533     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14534        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14535
 14536     IF (PB-REISSUED-CERT        OR
 14537         PB-POLICY-IS-DECLINED   OR
 14538         PB-POLICY-IS-VOIDED)
 14539        NEXT SENTENCE
 14540     ELSE
 14541     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 264
* EL050.cbl
 14542           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14543       OR
 14544        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14545           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14546       AND
 14547        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14548           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14549         OR
 14550          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14551           LESS WS-TOL-LF-LOW-PREM-PCT))
 14552              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14553                  MOVE ER-2652   TO  WS-ERROR
 14554                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14555              ELSE
 14556                  MOVE ER-2650   TO  WS-ERROR
 14557                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14558
 14559*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14560*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14561*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14562*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14563
 14564     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14565        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14566                      OR
 14567           ((PB-COMPANY-ID = 'DCC')
 14568           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14569           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14570           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14571        END-IF
 14572     END-IF
 14573
 14574     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14575        IF WS-COMP-MAX-CAP GREATER THAN +0
 14576           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14577              IF (PB-REISSUED-CERT         OR
 14578                  PB-POLICY-IS-DECLINED    OR
 14579                  PB-POLICY-IS-VOIDED)
 14580                 NEXT SENTENCE
 14581              ELSE
 14582                  MOVE ER-2646   TO  WS-ERROR
 14583                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14584
 14585 3344-CVL-TOLERANCE-CHECK.
 14586
 14587      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14588          GO TO 3344-CHECK-AH.
 14589
 14590      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14591          GO TO 3344-CHECK-AH.
 14592
 14593      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14594                                     WS-UNSIGN-WRK6.
 14595
 14596      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14597          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14598                                 + PB-I-LF-PREMIUM-AMT
 14599                                 - PB-I-LF-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 265
* EL050.cbl
 14600
 14601      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14602          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14603                                 + PB-I-LF-ALT-PREMIUM-AMT
 14604                                 - PB-I-LF-ALT-PREM-CALC.
 14605
 14606      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14607          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14608              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14609                 MOVE ER-2652    TO  WS-ERROR
 14610                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14611              ELSE
 14612                 MOVE ER-2650    TO  WS-ERROR
 14613                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14614
 14615      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14616          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14617              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14618                 MOVE ER-2652    TO  WS-ERROR
 14619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620              ELSE
 14621                 MOVE ER-2650    TO  WS-ERROR
 14622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14623
 14624 3344-CHECK-AH.
 14625
 14626****************************************************************
 14627***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14628***
 14629
 14630     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14631         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14632             (1 + WS-TOL-AH-PREM-PCT)
 14633         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14634             (1 - WS-TOL-AH-PREM-PCT)
 14635     ELSE
 14636         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14637         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14638
 14639***
 14640***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14641***
 14642
 14643     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14644         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14645
 14646     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14647         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14648
 14649     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14650        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14651
 14652     IF (PB-REISSUED-CERT)
 14653        OR (PB-POLICY-IS-DECLINED)
 14654        OR (PB-POLICY-IS-VOIDED)
 14655        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14656        CONTINUE
 14657     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 266
* EL050.cbl
 14658        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14659            OR
 14660           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14661           AND
 14662           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14663           OR
 14664           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14665           IF WS-PREM-REJECT-SW = SPACE
 14666              MOVE ER-3052       TO WS-ERROR
 14667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14668           ELSE
 14669              MOVE ER-3050       TO WS-ERROR
 14670              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14671           END-IF
 14672        END-IF
 14673     END-IF
 14674
 14675     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14676         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14677             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14678             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14679
 14680     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14681        IF WS-COMP-MAX-CAP GREATER THAN +0
 14682           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14683              IF (PB-REISSUED-CERT         OR
 14684                  PB-POLICY-IS-DECLINED    OR
 14685                  PB-POLICY-IS-VOIDED)
 14686                 NEXT SENTENCE
 14687              ELSE
 14688                  MOVE ER-2646   TO  WS-ERROR
 14689                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14690
 14691     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14692        (WS-COMP-MAX-CAP EQUAL +0)
 14693           GO TO 3345-EDIT-CONTINUE.
 14694
 14695     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14696        GREATER THAN WS-COMP-MAX-CAP
 14697           MOVE ER-2646          TO  WS-ERROR
 14698           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14699
 14700 3345-EDIT-CONTINUE.
 14701
 14702*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14703*       IF PB-ENTRY-BATCH   NUMERIC
 14704*          IF PB-ISSUE
 14705*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14706*          ELSE
 14707*              IF PB-CANCELLATION
 14708*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14709
 14710*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14711*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14712*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14713*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14714*        ELSE
 14715*            MOVE  ER-1909            TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 267
* EL050.cbl
 14716*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14717
 14718     IF PB-I-POLICY-ACCEPTED
 14719        IF PB-POLICY-IS-DECLINED  OR
 14720           PB-REISSUED-CERT  OR
 14721           PB-REIN-ONLY-CERT  OR
 14722           PB-POLICY-IS-VOIDED
 14723            MOVE  ER-1891         TO  WS-ERROR
 14724            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14725        ELSE
 14726            MOVE SPACE            TO  PB-BATCH-ENTRY
 14727            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14728
 14729     IF PB-I-POLICY-DECLINED
 14730        IF PB-REISSUED-CERT  OR
 14731           PB-REIN-ONLY-CERT  OR
 14732           PB-POLICY-IS-VOIDED
 14733            MOVE  ER-1906         TO  WS-ERROR
 14734            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14735        ELSE
 14736            MOVE  'D'             TO  PB-BATCH-ENTRY
 14737                                      PB-I-ENTRY-STATUS.
 14738
 14739     IF PB-I-NEEDS-UNDERWRITING
 14740        IF PB-POLICY-IS-DECLINED OR
 14741           PB-REISSUED-CERT  OR
 14742           PB-REIN-ONLY-CERT  OR
 14743           PB-POLICY-IS-VOIDED
 14744            MOVE  ER-1907         TO  WS-ERROR
 14745            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14746        ELSE
 14747            MOVE 'U'              TO  PB-BATCH-ENTRY
 14748                                      PB-I-ENTRY-STATUS.
 14749
 14750     IF PB-NEEDS-UNDERWRITING
 14751        MOVE  ER-1901             TO  WS-ERROR
 14752        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14753     IF PB-COMPANY-ID = 'DCC'
 14754        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14755        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14756        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14757           AND (NOT WS-LF-CASH))
 14758                           OR
 14759           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14760           AND (NOT WS-AH-CASH)))
 14761                       AND
 14762           (PB-I-ENTRY-STATUS NOT = '5')
 14763           MOVE 'M'              TO PB-BATCH-ENTRY
 14764                                    PB-I-ENTRY-STATUS
 14765        END-IF
 14766     END-IF
 14767     IF  PB-COMPANY-ID NOT = 'NCL'
 14768         GO TO 3999-END-EDIT.
 14769
 14770     IF PB-REISSUED-CERT  OR
 14771        PB-POLICY-IS-DECLINED  OR
 14772        PB-POLICY-IS-VOIDED  OR
 14773        PB-I-OB
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 268
* EL050.cbl
 14774         GO TO 3999-END-EDIT.
 14775
 14776     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14777         MOVE  ER-2644            TO  WS-ERROR
 14778         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14779         GO TO 3999-END-EDIT.
 14780
 14781     MOVE 'N'                     TO  FORM-MASTER-SW.
 14782     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14783
 14784     IF NOT FORM-MASTER-FOUND
 14785         GO TO 3999-END-EDIT.
 14786
 14787     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14788                                      FORM-MASTER-AH-SW.
 14789
 14790     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14791         MOVE  +1                 TO SUB6
 14792         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14793
 14794     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14795         MOVE  +1                 TO SUB6
 14796         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14797
 14798     IF LF-FORM-MASTER-FOUND  OR
 14799        AH-FORM-MASTER-FOUND
 14800         GO TO 3360-CHECK-FORM-LIMITS
 14801     ELSE
 14802         GO TO 3999-END-EDIT.
 14803
 14804******************************************************************
 14805*                  3350-GET-ERFORM                               *
 14806*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14807*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14808******************************************************************
 14809
 14810 3350-GET-ERFORM.
 14811
 14812     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14813         GO TO  3350-ERFORM-GETMAIN.
 14814
 14815     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14816     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14817     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14818     MOVE 'Y'                     TO FORM-MASTER-SW.
 14819
 14820     IF PB-CANCELLATION
 14821         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14822            PB-SV-STATE          EQUAL   FO-STATE       AND
 14823            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14824              GO TO 3350-EXIT
 14825         ELSE
 14826             NEXT SENTENCE
 14827     ELSE
 14828         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14829            PB-SV-STATE          EQUAL   FO-STATE       AND
 14830            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14831              GO TO 3350-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 269
* EL050.cbl
 14832
 14833 3350-ERFORM-GETMAIN.
 14834
 14835     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14836     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14837
 14838 3350-ERFORM-READ.
 14839
 14840     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14841     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14842     IF PB-CANCELLATION
 14843         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14844     ELSE
 14845         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14846     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14847
 14848     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14849
 14850     IF FORM-MASTER-FOUND
 14851       IF PB-CANCELLATION
 14852          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14853             PB-SV-STATE          EQUAL   FO-STATE       AND
 14854             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14855              GO  TO 3350-EXIT
 14856          ELSE
 14857              NEXT SENTENCE
 14858       ELSE
 14859          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14860             PB-SV-STATE          EQUAL   FO-STATE       AND
 14861             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14862              GO  TO 3350-EXIT.
 14863
 14864     MOVE  'N'                    TO  FORM-MASTER-SW.
 14865     MOVE  ER-1895                TO  WS-ERROR.
 14866     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14867
 14868 3350-EXIT.
 14869      EXIT.
 14870
 14871******************************************************************
 14872*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14873*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14874*   VALID FOR THE POLICY FORM USED.                              *
 14875******************************************************************
 14876
 14877 3355-EDIT-FORM-LF-BENEFITS.
 14878
 14879     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14880        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14881         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14882         GO TO   3355-EXIT.
 14883
 14884     IF  SUB6    LESS THAN   +40
 14885         ADD  +1      TO  SUB6
 14886         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14887
 14888     MOVE  ER-1896         TO  WS-ERROR.
 14889     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 270
* EL050.cbl
 14890
 14891 3355-EXIT.
 14892      EXIT.
 14893
 14894******************************************************************
 14895*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14896*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14897*   VALID FOR THE POLICY FORM USED.                              *
 14898******************************************************************
 14899
 14900 3356-EDIT-FORM-AH-BENEFITS.
 14901
 14902     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14903        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14904         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14905         GO TO  3356-EXIT.
 14906
 14907      IF  SUB6    LESS THAN     +40
 14908          ADD  +1      TO  SUB6
 14909          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14910
 14911     MOVE  ER-1897         TO  WS-ERROR.
 14912     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14913
 14914 3356-EXIT.
 14915      EXIT.
 14916
 14917******************************************************************
 14918*                  3357-BENEFIT-SEARCH                           *
 14919*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14920*   CANCELLATIONS ONLY.                                          *
 14921******************************************************************
 14922 3357-BENEFIT-SEARCH.
 14923     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14924         MOVE +1                          TO SUB6
 14925         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14926
 14927     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14928         MOVE +1                          TO SUB6
 14929         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14930
 14931 3357-EXIT.
 14932     EXIT.
 14933
 14934******************************************************************
 14935*                  3358-BENEFIT-LIFE-SEARCH                      *
 14936*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14937*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14938*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14939******************************************************************
 14940 3358-BENEFIT-LIFE-SEARCH.
 14941     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14942       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14943         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14944           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14945              IF FO-PLAN-REFUND-METHOD (SUB6)
 14946                     IS GREATER THAN SPACES
 14947                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 271
* EL050.cbl
 14948                                          WS-LF-REFUND-CALC
 14949                 GO TO 3358-EXIT.
 14950
 14951     IF SUB6 LESS THAN +40
 14952         ADD +1                 TO SUB6
 14953         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14954
 14955 3358-EXIT.
 14956     EXIT.
 14957******************************************************************
 14958*                  3359-BENEFIT-AH-SEARCH                        *
 14959*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14960*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14961*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14962******************************************************************
 14963 3359-BENEFIT-AH-SEARCH.
 14964     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14965       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14966         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14967           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14968              IF FO-PLAN-REFUND-METHOD (SUB6)
 14969                      IS GREATER THAN SPACES
 14970                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14971                                          WS-AH-REFUND-CALC
 14972                 GO TO 3359-EXIT.
 14973
 14974     IF SUB6 LESS THAN +40
 14975         ADD +1                 TO SUB6
 14976         GO TO 3359-BENEFIT-AH-SEARCH.
 14977
 14978 3359-EXIT.
 14979     EXIT.
 14980
 14981******************************************************************
 14982*                  3360-CHECK-FORM-LIMITS                        *
 14983*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14984*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14985******************************************************************
 14986
 14987 3360-CHECK-FORM-LIMITS.
 14988
 14989     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14990         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14991
 14992     IF NOT LF-FORM-MASTER-FOUND
 14993         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14994
 14995 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14996
 14997     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14998       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14999        WS-LF-JOINT-INDICATOR = 'J'  AND
 15000        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15001         IF PB-COMPANY-ID = 'NCL'
 15002            MOVE  ER-1911          TO  WS-ERROR
 15003            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15004         ELSE
 15005            MOVE  ER-1892          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 272
* EL050.cbl
 15006            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15007
 15008 3360-CHECK-FORM-LF-ATT-AGE.
 15009
 15010     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15011
 15012     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15013         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15014         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15015            IF PB-COMPANY-ID = 'NCL'
 15016                MOVE  ER-1913      TO  WS-ERROR
 15017                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15018            ELSE
 15019                MOVE  ER-1894      TO  WS-ERROR
 15020                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15021
 15022 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15023
 15024     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15025         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15026         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15027            IF PB-COMPANY-ID = 'NCL'
 15028                MOVE  ER-1914      TO  WS-ERROR
 15029                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15030            ELSE
 15031                MOVE  ER-1899      TO  WS-ERROR
 15032                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15033
 15034 3360-CHECK-FORM-LF-TERM-BAMT.
 15035
 15036     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15037         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15038         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15039           IF  PB-COMPANY-ID = 'NCL'
 15040               MOVE  ER-1916       TO  WS-ERROR
 15041               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15042           ELSE
 15043               MOVE  ER-1902       TO  WS-ERROR
 15044               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15045
 15046     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15047                                    PB-I-LF-ALT-BENEFIT-AMT.
 15048
 15049     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15050         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15051         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15052             IF  PB-COMPANY-ID = 'NCL'
 15053                 MOVE  ER-1918     TO  WS-ERROR
 15054                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15055             ELSE
 15056                 MOVE  ER-1904     TO  WS-ERROR
 15057                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15058
 15059******************************************************************
 15060*                  3360-CHECK-FORM-AH-LIMITS                     *
 15061*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15062*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 273
* EL050.cbl
 15064
 15065 3360-CHECK-FORM-AH-LIMITS.
 15066
 15067     IF NOT AH-FORM-MASTER-FOUND
 15068         GO TO 3999-END-EDIT.
 15069
 15070 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15071
 15072     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15073       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15074        WS-AH-JOINT-INDICATOR = 'J'  AND
 15075        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15076         IF PB-COMPANY-ID = 'NCL'
 15077            MOVE  ER-1912          TO  WS-ERROR
 15078            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15079         ELSE
 15080            MOVE  ER-1893          TO  WS-ERROR
 15081            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15082
 15083 3360-CHECK-FORM-AH-ATT-AGE.
 15084
 15085     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15086
 15087     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15088         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15089         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15090            IF PB-COMPANY-ID = 'NCL'
 15091                MOVE  ER-1913      TO  WS-ERROR
 15092                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15093            ELSE
 15094                MOVE  ER-1894      TO  WS-ERROR
 15095                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15096
 15097 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15098
 15099     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15100         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15101         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15102            IF PB-COMPANY-ID = 'NCL'
 15103                MOVE  ER-1915      TO  WS-ERROR
 15104                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15105            ELSE
 15106                MOVE  ER-1900      TO  WS-ERROR
 15107                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15108
 15109 3360-CHECK-FORM-AH-TERM-BAMT.
 15110
 15111     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15112         FO-AH-MAX-TERM    GREATER THAN  +0
 15113         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15114             IF  PB-COMPANY-ID = 'NCL'
 15115                 MOVE  ER-1917     TO  WS-ERROR
 15116                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15117             ELSE
 15118                  MOVE  ER-1903    TO  WS-ERROR
 15119                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15120
 15121     IF  FO-MAX-AH-AMT    NUMERIC   AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 274
* EL050.cbl
 15122         FO-MAX-AH-AMT    GREATER THAN  +0
 15123         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15124             IF  PB-COMPANY-ID = 'NCL'
 15125                 MOVE  ER-1919     TO  WS-ERROR
 15126                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15127             ELSE
 15128                 MOVE  ER-1905     TO  WS-ERROR
 15129                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15130
 15131     GO TO 3999-END-EDIT.
 15132
 15133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 275
* EL050.cbl
 15135******************************************************************
 15136*                  E D I T   C A N C E L                         *
 15137******************************************************************
 15138
 15139 3700-EDIT-CANCEL.
 15140     IF PB-COMPANY-ID = 'DMD'
 15141         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15142                                         WS-RES-MUNI-TAX
 15143                                         PB-CI-STATE-TAX
 15144                                         PB-CI-MUNI-TAX
 15145         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15146
 15147*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15148*       IF PB-ENTRY-BATCH  NUMERIC
 15149*          IF PB-CANCELLATION
 15150*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15151*          ELSE
 15152*             IF PB-ISSUE
 15153*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15154
 15155     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15156        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15157     END-IF
 15158*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15159*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15160
 15161     IF CM-ENTRY-STATUS = 'V'
 15162        MOVE ER-2780             TO WS-ERROR
 15163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15164        GO TO 3999-END-EDIT.
 15165
 15166     IF CM-ENTRY-STATUS = 'D'
 15167        MOVE ER-2781             TO WS-ERROR
 15168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15169        GO TO 3999-END-EDIT.
 15170
 15171     IF CM-ENTRY-STATUS = 'U'
 15172        MOVE ER-2782             TO WS-ERROR
 15173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15174
 15175***************************************************************
 15176*                                                             *
 15177*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15178*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15179*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15180*   OF ANOTHER COVERAGE.                                      *
 15181*                                                             *
 15182***************************************************************
 15183
 15184     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15185                                    PB-C-AH-CANCEL-VOID-SW.
 15186
 15187     IF PB-C-LF-CANCEL-AMT = ZERO
 15188        NEXT SENTENCE
 15189     ELSE
 15190        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15191           AND
 15192           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 276
* EL050.cbl
 15193               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15194               MOVE ER-2745           TO WS-ERROR
 15195               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15196
 15197     IF PB-C-AH-CANCEL-AMT = ZERO
 15198        NEXT SENTENCE
 15199     ELSE
 15200        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15201           AND
 15202           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15203               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15204               MOVE ER-2745           TO WS-ERROR
 15205               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15206
 15207     IF WS-LF-EARNINGS-CALC = '4'
 15208        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15209
 15210     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15211     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15212     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15213     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15214     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15215     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15216
 15217     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15218                                      PB-C-AH-REF-CALC.
 15219     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15220
 15221******************************************************************
 15222*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15223*             TO VALIDATE COVERAGE.                              *
 15224******************************************************************
 15225
 15226     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15227        PB-C-LF-CANCEL-AMT = ZEROS
 15228          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15229      ELSE
 15230          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15231
 15232     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15233        PB-C-AH-CANCEL-AMT = ZEROS
 15234          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15235      ELSE
 15236          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15237
 15238     EVALUATE TRUE
 15239         WHEN PB-CANCEL-FORCE             OR
 15240              PB-CANCEL-DATE-FORCED       OR
 15241              PB-FORCE-OFF
 15242                  IF PB-COMPANY-ID = 'ACE'
 15243                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15244                  END-IF
 15245         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15246               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15247              (PB-COMPANY-ID = 'ACE' )
 15248                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15249         WHEN OTHER
 15250              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 277
* EL050.cbl
 15251                 MOVE ER-2794              TO WS-ERROR
 15252              ELSE
 15253                 MOVE ER-2749              TO WS-ERROR
 15254              END-IF
 15255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15256     END-EVALUATE.
 15257
 15258
 15259*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15260*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15261*            MOVE  ER-1909            TO  WS-ERROR
 15262*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15263*        ELSE
 15264*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15265
 15266     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15267     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15268        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15269     ELSE
 15270        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15271     END-IF
 15272     .
 15273 3705-EDIT-CANCEL-DT.
 15274
 15275     IF LF-COVERAGE-CANCELLED
 15276        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15277         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15278         MOVE WS-CURRENT-MONTH-END
 15279                                 TO DC-BIN-DATE-2
 15280         SET ELAPSED-BETWEEN-BIN TO TRUE
 15281*        MOVE 1                  TO DC-OPTION-CODE
 15282         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15283         IF DATE-CONVERSION-ERROR
 15284            NEXT SENTENCE
 15285          ELSE
 15286             IF DC-ELAPSED-DAYS GREATER +180
 15287                IF PB-CANCEL-DATE-FORCED  OR
 15288                   PB-CANCEL-DATE-FORCED-NO-FEE
 15289                      MOVE ER-2751  TO WS-ERROR
 15290                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15291                 ELSE
 15292                   MOVE ER-2752  TO WS-ERROR
 15293                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15294
 15295     IF AH-COVERAGE-CANCELLED
 15296        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15297         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15298         MOVE WS-CURRENT-MONTH-END
 15299                                 TO DC-BIN-DATE-2
 15300         SET ELAPSED-BETWEEN-BIN TO TRUE
 15301*        MOVE 1                  TO DC-OPTION-CODE
 15302         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15303         IF DATE-CONVERSION-ERROR
 15304            NEXT SENTENCE
 15305          ELSE
 15306             IF DC-ELAPSED-DAYS GREATER +180
 15307                IF PB-CANCEL-DATE-FORCED OR
 15308                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 278
* EL050.cbl
 15309                      MOVE ER-2751  TO WS-ERROR
 15310                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15311                 ELSE
 15312                   MOVE ER-2752  TO WS-ERROR
 15313                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15314
 15315     IF WS-ERROR = ER-2752
 15316        AND (PB-COMPANY-ID = 'ABL'
 15317         OR  PB-COMPANY-ID = 'FGL'
 15318         OR  PB-COMPANY-ID = 'IST'
 15319         OR  PB-COMPANY-ID = 'JHL'
 15320         OR  PB-COMPANY-ID = 'LAP'
 15321         OR  PB-COMPANY-ID = 'LBL'
 15322         OR  PB-COMPANY-ID = 'NCB'
 15323         OR  PB-COMPANY-ID = 'NLI'
 15324         OR  PB-COMPANY-ID = 'OFI'
 15325         OR  PB-COMPANY-ID = 'PLI'
 15326         OR  PB-COMPANY-ID = 'TAO'
 15327         OR  PB-COMPANY-ID = 'TIC'
 15328         OR  PB-COMPANY-ID = 'HER'
 15329         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15330         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15331            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15332            MOVE ER-2762     TO WS-ERROR
 15333            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15334
 15335     IF LF-COVERAGE-CANCELLED
 15336        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15337        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15338             MOVE ER-2733         TO WS-ERROR
 15339             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15340
 15341     IF AH-COVERAGE-CANCELLED
 15342        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15343        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15344              MOVE ER-2733        TO WS-ERROR
 15345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15346
 15347     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15348        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15349        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15350           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15351            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15352              IF PB-COMPANY-ID NOT = 'LAP'
 15353               MOVE ER-2704            TO WS-ERROR
 15354               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15355
 15356     IF CERT-WAS-NOT-FOUND
 15357         GO TO 3999-END-EDIT.
 15358
 15359     IF PB-COMPANY-ID EQUAL 'CDC'
 15360        IF LF-COVERAGE-CANCELLED
 15361           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15362            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15363            MOVE PB-C-LF-CANCEL-DT
 15364                                 TO DC-BIN-DATE-2
 15365            SET ELAPSED-BETWEEN-BIN TO TRUE
 15366*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 279
* EL050.cbl
 15367            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15368            IF DATE-CONVERSION-ERROR
 15369               NEXT SENTENCE
 15370             ELSE
 15371                IF DC-ELAPSED-DAYS GREATER +60
 15372                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15373
 15374     IF PB-COMPANY-ID EQUAL 'CDC'
 15375        IF AH-COVERAGE-CANCELLED
 15376           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15377            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15378            MOVE PB-C-AH-CANCEL-DT
 15379                                 TO DC-BIN-DATE-2
 15380            MOVE +0              TO DC-ELAPSED-DAYS
 15381                                    DC-ELAPSED-MONTHS
 15382            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15383*           MOVE 1               TO DC-OPTION-CODE
 15384            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15385            IF DATE-CONVERSION-ERROR
 15386               NEXT SENTENCE
 15387             ELSE
 15388                IF DC-ELAPSED-DAYS GREATER +60
 15389                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15390
 15391     MOVE +0                     TO DC-ELAPSED-DAYS
 15392                                    DC-ELAPSED-MONTHS.
 15393
 15394     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15395        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15396          MOVE 'Z'                TO PB-CI-OB-FLAG
 15397          MOVE ER-2767            TO WS-ERROR
 15398          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15399          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15400          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15401          GO TO 3775-OVER-REF-CHK
 15402        ELSE
 15403          MOVE ZEROS              TO PB-CI-LIVES
 15404                                     PB-C-LIVES
 15405          IF PB-CI-OB-FLAG NOT = 'B'
 15406             MOVE SPACE           TO PB-CI-OB-FLAG.
 15407
 15408     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15409         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15410     ELSE
 15411         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15412
 15413     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15414        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15415            MOVE ER-2760         TO WS-ERROR
 15416            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15417
 15418     IF LF-COVERAGE-CANCELLED
 15419        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15420         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15421            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15422               MOVE ER-2774       TO WS-ERROR
 15423               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15424
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 280
* EL050.cbl
 15425     IF AH-COVERAGE-CANCELLED
 15426        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15427         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15428            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15429               MOVE ER-2775       TO WS-ERROR
 15430               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15431
 15432     IF LF-COVERAGE-CANCELLED
 15433        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15434         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15435            MOVE ER-2776         TO WS-ERROR
 15436            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15437
 15438     IF AH-COVERAGE-CANCELLED
 15439        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15440         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15441            MOVE ER-2777         TO WS-ERROR
 15442            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15443
 15444     IF LF-COVERAGE-CANCELLED
 15445        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15446         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15447         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15448         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15449*        MOVE 6                    TO DC-OPTION-CODE
 15450         SET BIN-PLUS-ELAPSED      TO TRUE
 15451         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15452         IF DATE-CONVERSION-ERROR
 15453            NEXT SENTENCE
 15454          ELSE
 15455            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15456              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15457                             OR  'FIA'
 15458                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15459               ELSE
 15460                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15461                MOVE ER-2731       TO WS-ERROR
 15462                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15463
 15464 3705-EDIT-AH-CANCEL-DT.
 15465
 15466     IF AH-COVERAGE-CANCELLED
 15467        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15468         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15469         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15470         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15471*        MOVE 6                    TO DC-OPTION-CODE
 15472         SET BIN-PLUS-ELAPSED      TO TRUE
 15473         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15474         IF DATE-CONVERSION-ERROR
 15475            NEXT SENTENCE
 15476          ELSE
 15477            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15478              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15479                              OR 'FIA'
 15480                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15481              ELSE
 15482               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 281
* EL050.cbl
 15483               MOVE ER-2771       TO WS-ERROR
 15484               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15485
 15486 3705-EDIT-CONTINUED.
 15487
 15488*    IF LF-COVERAGE-CANCELLED
 15489*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15490*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15491*            MOVE ER-2727         TO WS-ERROR
 15492*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15493*
 15494*    IF AH-COVERAGE-CANCELLED
 15495*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15496*        IF PB-COMPANY-ID = 'ACE'
 15497*           MOVE ER-2727        TO WS-ERROR
 15498*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15499*        ELSE
 15500*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15501*              MOVE ER-2727     TO WS-ERROR
 15502*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15503
 15504     IF PB-COMPANY-ID = 'ACE'
 15505       IF AH-COVERAGE-CANCELLED
 15506         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15507           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15508              MOVE ER-2732      TO WS-ERROR
 15509              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15510
 15511     IF PB-COMPANY-ID      EQUAL   'HER'
 15512        IF WS-ERROR        EQUAL   ER-2727
 15513            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15514            MOVE  ER-2725          TO  WS-ERROR
 15515            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15516
 15517     IF PB-C-CLAIM-CREATED-CANCEL
 15518            MOVE ER-2748         TO WS-ERROR
 15519            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15520
 15521     IF PB-C-LAST-NAME NOT = SPACES
 15522         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15523            MOVE ER-2747         TO WS-ERROR
 15524            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15525
 15526 3710-EDIT-LUMP-SUM-PRIOR.
 15527
 15528     IF AH-COVERAGE-CANCELLED
 15529         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15530             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15531                MOVE ER-2735    TO WS-ERROR
 15532                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15533
 15534     IF LF-COVERAGE-CANCELLED
 15535         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15536             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15537                MOVE ER-2735    TO WS-ERROR
 15538                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15539
 15540 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 282
* EL050.cbl
 15541
 15542*    IF LF-COVERAGE-CANCELLED
 15543*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15544*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15545*           (NOT PB-CI-OB)
 15546*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15547*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15548*                   MOVE ER-2732  TO WS-ERROR
 15549*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15550*
 15551*    IF AH-COVERAGE-CANCELLED
 15552*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15553*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15554*           (NOT PB-CI-OB)
 15555*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15556*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15557*                   MOVE ER-2732  TO WS-ERROR
 15558*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15559
 15560     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15561         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15562            (NOT PB-COMP-LF-CANCEL)
 15563             NEXT SENTENCE
 15564         ELSE
 15565           IF PB-C-LF-CANCEL-VOIDED
 15566              NEXT SENTENCE
 15567           ELSE
 15568              MOVE ER-2753      TO WS-ERROR
 15569              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15570
 15571     IF CANCEL-FUTURE-DT
 15572         GO TO 3999-END-EDIT.
 15573
 15574 3715-GET-REMAIN-TERM-LF.
 15575
 15576     IF NO-LF-BENEFIT-MATCH  OR
 15577        WS-LF-BENEFIT-CD = ZEROS
 15578        GO TO 3730-GET-AH-REMAIN-TERM.
 15579
 15580     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15581     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15582     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15583     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15584     MOVE PB-SV-STATE            TO CP-STATE.
 15585     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15586     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15587     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15588     MOVE '2'                    TO CP-PROCESS-TYPE.
 15589     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15590     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15591     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15592     IF (PB-COMPANY-ID = 'CID')
 15593        AND (CP-STATE-STD-ABBRV = 'WI')
 15594        MOVE '7'                 TO CP-REM-TERM-METHOD
 15595        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15596     ELSE
 15597        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15598        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 283
* EL050.cbl
 15599                                 TO CP-REM-TRM-CALC-OPTION
 15600     END-IF
 15601**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15602     IF (PB-COMPANY-ID = 'CID')
 15603        AND (CP-STATE-STD-ABBRV = 'MO')
 15604        AND (PB-CERT-EFF-DT >= X'9B41')
 15605        AND (PB-CERT-EFF-DT <= X'A2FB')
 15606        MOVE '7'                 TO CP-REM-TERM-METHOD
 15607        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15608     END-IF
 15609     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15610                                    CP-LOAN-TERM.
 15611     IF CP-TRUNCATED-LIFE
 15612        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15613
 15614     IF CP-TERM-IS-DAYS
 15615         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15616     ELSE
 15617         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15618
 15619     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15620
 15621     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15622
 15623     IF LF-COVERAGE-CANCELLED
 15624        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15625        NEXT SENTENCE
 15626      ELSE
 15627          GO TO 3730-GET-AH-REMAIN-TERM.
 15628
 15629 3720-GET-LF-REFUND.
 15630
 15631     IF PB-C-LF-CANCEL-VOIDED OR
 15632        PB-C-AH-CANCEL-VOIDED
 15633        GO TO 3780-UPDATE-CANCEL-CERT.
 15634
 15635     IF PB-COMPANY-ID EQUAL 'BOA'
 15636         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15637         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15638         GO TO 3730-GET-AH-REMAIN-TERM.
 15639
 15640     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15641        (WS-AH-SPECIAL-CALC-CD = 'M')
 15642         MOVE ER-2767            TO WS-ERROR
 15643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15644         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15645         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15646         GO TO 3780-UPDATE-CANCEL-CERT.
 15647
 15648     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15649
 15650     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15651     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15652     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15653     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15654     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15655     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15656     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 284
* EL050.cbl
 15657        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15658        IF PDEF-MASTER-FOUND
 15659           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15660              (V1 > +8)
 15661              OR (PD-PROD-CODE (V1) = 'L')
 15662           END-PERFORM
 15663           IF V1 < +9
 15664              MOVE PD-MAX-AMT (V1)
 15665                           TO CP-R-MAX-TOT-BEN
 15666                              EC-AM-LF-MAX-TOT-BEN
 15667           END-IF
 15668        ELSE
 15669        MOVE ' '                 TO PDEF-MASTER-SW
 15670        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15671        MOVE PB-STATE            TO ERPDEF-STATE
 15672        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15673        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15674        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15675        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15676        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15677        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15678        IF PDEF-MASTER-FOUND
 15679           MOVE 'N'              TO PDEF-MASTER-SW
 15680           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15681           IF PDEF-MASTER-FOUND
 15682              IF (ERPDEF-KEY-SAVE (1:16) =
 15683                           PD-CONTROL-PRIMARY (1:16))
 15684                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15685                 CONTINUE
 15686              ELSE
 15687                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15688                 IF (ERPDEF-KEY-SAVE (1:16) =
 15689                           PD-CONTROL-PRIMARY (1:16))
 15690                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15691                    CONTINUE
 15692                 ELSE
 15693                    MOVE 'N'     TO PDEF-MASTER-SW
 15694                 END-IF
 15695              END-IF
 15696              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15697
 15698              IF PDEF-MASTER-FOUND
 15699                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15700                    (V1 > +8)
 15701                    OR (PD-PROD-CODE (V1) = 'L')
 15702                 END-PERFORM
 15703                 IF V1 < +9
 15704                    MOVE PD-MAX-AMT (V1)
 15705                                 TO CP-R-MAX-TOT-BEN
 15706                                    EC-AM-LF-MAX-TOT-BEN
 15707                 END-IF
 15708              END-IF
 15709           END-IF
 15710           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15711        END-IF
 15712        END-IF
 15713     END-IF
 15714     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 285
* EL050.cbl
 15715
 15716     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15717
 15718     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15719                                    PB-C-LF-REM-TERM.
 15720
 15721     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15722     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15723
 15724     IF PB-COMPANY-ID EQUAL 'FLC'
 15725        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15726           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15727           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15728                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15729                    - CM-LF-ITD-DEATH-AMT
 15730           IF PB-C-LF-REF-CALC LESS THAN +0
 15731              MOVE +0            TO PB-C-LF-REF-CALC
 15732              GO TO 3730-GET-AH-REMAIN-TERM
 15733           ELSE
 15734              GO TO 3730-GET-AH-REMAIN-TERM.
 15735
 15736     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15737                            OR '4' OR '5' OR '6' OR '8'
 15738                            OR '9' OR 'G'
 15739        MOVE PB-C-LF-REFUND-OVERRIDE
 15740                                 TO CP-EARNING-METHOD.
 15741
 15742     if pb-company-id = 'AHL'
 15743        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15744        if cp-class-code = spaces
 15745           move zeros            to cp-class-code
 15746        end-if
 15747     ELSE
 15748        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15749     END-IF
 15750*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15751     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15752     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15753                                    CP-RATING-BENEFIT-AMT.
 15754     IF CP-STATE-STD-ABBRV = 'OR'
 15755         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15756                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15757     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15758     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15759     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15760     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15761     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15762     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15763     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15764     IF WS-DEFAULT-APR NOT NUMERIC
 15765         MOVE ZEROS TO WS-DEFAULT-APR.
 15766****   N O T E   ****
 15767*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15768*      THE OH HARD CODING IN ELCRFNDP
 15769
 15770     IF PB-COMPANY-ID = 'CID'
 15771        IF CP-STATE-STD-ABBRV = 'OH'
 15772           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 286
* EL050.cbl
 15773                                 TO CP-EARNING-METHOD
 15774        END-IF
 15775     END-IF
 15776
 15777****   N O T E   ****
 15778
 15779     IF CP-EARN-AS-NET-PAY
 15780         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15781            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15782                MOVE WS-DEFAULT-APR
 15783                                 TO  CP-LOAN-APR
 15784                MOVE ER-3780     TO  WS-ERROR
 15785                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15786            ELSE
 15787                MOVE ER-3781     TO  WS-ERROR
 15788                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15789     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15790     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15791
 15792     IF CP-REFUND-TYPE-USED NOT = SPACE
 15793         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15794
 15795     IF CP-ERROR-RATE-IS-ZERO OR
 15796        CP-ERROR-RATE-NOT-FOUND
 15797        MOVE ER-2740             TO WS-ERROR
 15798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
 15800     IF CP-ERROR-RATE-FILE-NOTOPEN
 15801        MOVE ER-2617             TO WS-ERROR
 15802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15803
 15804     IF PB-COMPANY-ID = 'DCC'
 15805        AND PB-CI-ENTRY-STATUS = 'M'
 15806        MOVE +0                  TO PB-C-LF-REF-CALC
 15807     ELSE
 15808        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15809     END-IF
 15810
 15811     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15812         GO TO 3730-GET-AH-REMAIN-TERM.
 15813
 15814*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15815*       ADD +1                   TO PB-C-LF-REM-TERM
 15816*                                   CP-REMAINING-TERM
 15817*                                   CP-ORIGINAL-TERM.
 15818
 15819     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15820     MOVE '2'                    TO CP-EARNING-METHOD
 15821                                    CP-RATING-METHOD.
 15822     IF PB-COMPANY-ID = 'CID'
 15823        IF (CP-STATE-STD-ABBRV = 'MN')
 15824           AND (PB-CERT-EFF-DT > X'A4FF')
 15825           AND (WS-LF-EARNINGS-CALC = 'B')
 15826           MOVE '5'              TO CP-EARNING-METHOD
 15827           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15828        END-IF
 15829     END-IF
 15830     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 287
* EL050.cbl
 15831                                        CP-REMAINING-BENEFIT
 15832                                        CP-RATING-BENEFIT-AMT.
 15833     IF CP-STATE-STD-ABBRV = 'OR'
 15834         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15835                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15836     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15837     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15838
 15839     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15840
 15841     IF CP-ERROR-RATE-IS-ZERO OR
 15842        CP-ERROR-RATE-NOT-FOUND
 15843        MOVE ER-2740             TO WS-ERROR
 15844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15845
 15846     IF CP-ERROR-RATE-FILE-NOTOPEN
 15847        MOVE ER-2617             TO WS-ERROR
 15848        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15849
 15850     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15851
 15852******************************************************************
 15853
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 288
* EL050.cbl
 15855 3730-GET-AH-REMAIN-TERM.
 15856     IF NO-AH-BENEFIT-MATCH  OR
 15857        WS-AH-BENEFIT-CD = ZEROS
 15858         GO TO 3770-CHECK-REFUNDS.
 15859
 15860     IF PB-CI-AH-LUMP-SUM-DISAB
 15861         IF  PB-C-AH-CANCEL-AMT = ZERO
 15862            IF NOT PB-COMP-AH-CANCEL
 15863             GO TO 3770-CHECK-REFUNDS.
 15864
 15865     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15866     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15867     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15868     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15869     MOVE PB-SV-STATE            TO CP-STATE.
 15870     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15871     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15872     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15873     MOVE '2'                    TO CP-PROCESS-TYPE.
 15874     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15875     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15876     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15877     IF (PB-COMPANY-ID = 'CID')
 15878        AND (CP-STATE-STD-ABBRV = 'WI')
 15879        MOVE '7'                 TO CP-REM-TERM-METHOD
 15880        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15881     ELSE
 15882        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15883        MOVE WS-REM-TRM-CALC-OPTION
 15884                                 TO CP-REM-TRM-CALC-OPTION
 15885     END-IF
 15886     IF (PB-COMPANY-ID = 'CID')
 15887        AND (CP-STATE-STD-ABBRV = 'MO')
 15888        AND (PB-CERT-EFF-DT >= X'9B41')
 15889        AND (PB-CERT-EFF-DT <= X'A2FB')
 15890        MOVE '7'                 TO CP-REM-TERM-METHOD
 15891        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15892     END-IF
 15893     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15894                                    CP-LOAN-TERM.
 15895     IF NOT CP-TERM-IS-DAYS
 15896         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15897
 15898     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15899
 15900     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15901
 15902     IF AH-COVERAGE-CANCELLED
 15903        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15904        NEXT SENTENCE
 15905      ELSE
 15906         GO TO 3770-CHECK-REFUNDS.
 15907
 15908 3740-GET-AH-REFUND.
 15909
 15910     IF PB-C-LF-CANCEL-VOIDED OR
 15911        PB-C-AH-CANCEL-VOIDED
 15912        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 289
* EL050.cbl
 15913
 15914     IF PB-COMPANY-ID = 'BOA'
 15915         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15916         GO TO 3770-CHECK-REFUNDS.
 15917
 15918     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15919*    MOVE ' '                    TO DC-OPTION-CODE
 15920     SET BIN-TO-GREG             TO TRUE
 15921     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15922     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15923                                    PB-C-AH-REM-TERM.
 15924     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15925     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15926
 15927     IF PB-COMPANY-ID EQUAL 'FLC'
 15928        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15929           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15930           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15931                    - CM-AH-ITD-AH-PMT)
 15932           IF PB-C-AH-REF-CALC LESS THAN +0
 15933              MOVE +0            TO PB-C-AH-REF-CALC
 15934              GO TO 3770-CHECK-REFUNDS
 15935           ELSE
 15936              GO TO 3770-CHECK-REFUNDS.
 15937
 15938     IF PB-COMPANY-ID = 'DCC'
 15939        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15940            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15941           MOVE 'S'              TO CP-EARNING-METHOD
 15942        END-IF
 15943     END-IF
 15944     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15945                            OR '4' OR '5' OR '6' OR '8'
 15946                            OR '9' OR 'G' OR 'S'
 15947        MOVE PB-C-AH-REFUND-OVERRIDE
 15948                                 TO CP-EARNING-METHOD.
 15949
 15950     if pb-company-id = 'AHL'
 15951        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15952        if cp-class-code = spaces
 15953           move zeros            to cp-class-code
 15954        end-if
 15955     ELSE
 15956        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15957     END-IF
 15958*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15959     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15960     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15961                                    CP-RATING-BENEFIT-AMT.
 15962     IF CP-STATE-STD-ABBRV = 'OR'
 15963         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15964                                         PB-CI-AH-TERM.
 15965     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15966     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15967     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15968     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15969     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15970     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 290
* EL050.cbl
 15971
 15972     IF CP-STATE-STD-ABBRV = 'OH'
 15973        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15974                                AND 'CID' AND 'DCC' AND 'AHL')
 15975           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15976              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15977              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15978              MOVE '6' TO CP-EARNING-METHOD
 15979           END-IF
 15980        END-IF
 15981        IF PB-COMPANY-ID = 'CID'
 15982           IF NO-LIFE-COVERAGE
 15983              IF CP-CRITICAL-PERIOD
 15984                 MOVE '2'       TO CP-EARNING-METHOD
 15985              ELSE
 15986                 MOVE '6'       TO CP-EARNING-METHOD
 15987              END-IF
 15988           ELSE
 15989              IF WS-LF-COVERAGE-TYPE = 'L'
 15990                 MOVE '2'       TO CP-EARNING-METHOD
 15991              ELSE
 15992                 IF (PB-CI-LF-TERM > +60) OR
 15993                    (WS-LF-EARNINGS-CALC = '5')
 15994                    IF CP-CRITICAL-PERIOD
 15995                       MOVE '2'  TO CP-EARNING-METHOD
 15996                    ELSE
 15997                       MOVE '6'  TO CP-EARNING-METHOD
 15998                    END-IF
 15999                 ELSE
 16000                    MOVE '1'     TO CP-EARNING-METHOD
 16001                 END-IF
 16002              END-IF
 16003           END-IF
 16004        END-IF
 16005     END-IF
 16006
 16007*    IF CP-STATE-STD-ABBRV = 'VA'
 16008*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16009*          IF CP-ORIGINAL-TERM GREATER 61
 16010*             MOVE '6' TO CP-EARNING-METHOD
 16011*          ELSE
 16012*             MOVE '1' TO CP-EARNING-METHOD.
 16013
 16014     IF WS-DEFAULT-APR NOT NUMERIC
 16015         MOVE ZEROS TO WS-DEFAULT-APR.
 16016     IF CP-EARN-AS-NET-PAY
 16017         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16018            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16019                MOVE WS-DEFAULT-APR
 16020                                 TO  CP-LOAN-APR
 16021                MOVE ER-3780     TO  WS-ERROR
 16022                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16023            ELSE
 16024                MOVE ER-3781     TO  WS-ERROR
 16025                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16026     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16027     IF PB-COMPANY-ID = 'DCC'
 16028        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 291
* EL050.cbl
 16029        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16030        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16031     END-IF
 16032     IF PB-COMPANY-ID = 'DCC'
 16033        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16034        AND (CP-EARNING-METHOD = 'D')
 16035        AND (CP-CANCEL-REASON NOT = 'R')
 16036        CONTINUE
 16037     ELSE
 16038        GO TO 3750-CONTINUE
 16039     END-IF
 16040     MOVE ' '                    TO DD-IU-SW
 16041     IF NOT PDEF-MASTER-FOUND
 16042        MOVE ' '                 TO PDEF-MASTER-SW
 16043        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16044        MOVE PB-STATE            TO ERPDEF-STATE
 16045        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16046        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16047        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16048        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16049        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16050        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16051        IF PDEF-MASTER-FOUND
 16052           MOVE 'N'              TO PDEF-MASTER-SW
 16053           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16054           IF PDEF-MASTER-FOUND
 16055              IF (ERPDEF-KEY-SAVE (1:16) =
 16056                           PD-CONTROL-PRIMARY (1:16))
 16057                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16058                 CONTINUE
 16059              ELSE
 16060                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16061                 IF (ERPDEF-KEY-SAVE (1:16) =
 16062                           PD-CONTROL-PRIMARY (1:16))
 16063                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16064                    CONTINUE
 16065                 ELSE
 16066                    MOVE ER-2740 TO WS-ERROR
 16067                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16068                    GO TO 3770-CHECK-REFUNDS
 16069                 END-IF
 16070              END-IF
 16071           END-IF
 16072           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16073        END-IF
 16074     END-IF
 16075     IF PDEF-MASTER-FOUND
 16076        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16077           (V1 > +8)
 16078           OR (PD-PROD-CODE (V1) = 'I')
 16079        END-PERFORM
 16080        IF V1 < +9
 16081           SET DD-IU-PRESENT        TO TRUE
 16082        END-IF
 16083        IF WS-AH-DCC-TRUNC = 'T'
 16084           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16085        ELSE
 16086           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 292
* EL050.cbl
 16087        END-IF
 16088        EVALUATE TRUE
 16089           WHEN WS-TERM > +168
 16090              MOVE 15               TO V1
 16091           WHEN WS-TERM > +156
 16092              MOVE 14               TO V1
 16093           WHEN WS-TERM > +144
 16094              MOVE 13               TO V1
 16095           WHEN WS-TERM > +132
 16096              MOVE 12               TO V1
 16097           WHEN WS-TERM > +120
 16098              MOVE 11               TO V1
 16099           WHEN WS-TERM > +108
 16100              MOVE 10               TO V1
 16101           WHEN WS-TERM > +96
 16102              MOVE 9                TO V1
 16103           WHEN WS-TERM > +84
 16104              MOVE 8                TO V1
 16105           WHEN WS-TERM > +72
 16106              MOVE 7                TO V1
 16107           WHEN WS-TERM > +60
 16108              MOVE 6                TO V1
 16109           WHEN WS-TERM > +48
 16110              MOVE 5                TO V1
 16111           WHEN WS-TERM > +36
 16112              MOVE 4                TO V1
 16113           WHEN WS-TERM > +24
 16114              MOVE 3                TO V1
 16115           WHEN WS-TERM > +12
 16116              MOVE 2                TO V1
 16117           WHEN OTHER
 16118              MOVE 1                TO V1
 16119        END-EVALUATE
 16120
 16121        EVALUATE TRUE
 16122*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16123*             < +13)
 16124*             AND (DD-IU-PRESENT)
 16125*             MOVE 2                TO V2
 16126*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16127*             MOVE 1                TO V2
 16128           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16129              MOVE 2                TO V2
 16130           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16131              MOVE 3                TO V2
 16132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16133              MOVE 4                TO V2
 16134           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16135              MOVE 5                TO V2
 16136           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16137              MOVE 6                TO V2
 16138           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16139              MOVE 7                TO V2
 16140           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16141              MOVE 8                TO V2
 16142           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16143              MOVE 9                TO V2
 16144           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 293
* EL050.cbl
 16145              MOVE 10               TO V2
 16146           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16147              MOVE 11               TO V2
 16148           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16149              MOVE 12               TO V2
 16150           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16151              MOVE 13               TO V2
 16152           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16153              MOVE 14               TO V2
 16154           WHEN OTHER
 16155              MOVE 15               TO V2
 16156        END-EVALUATE
 16157
 16158        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16159                                 TO CP-DDF-LO-FACT
 16160        MOVE PD-UEP-FACTOR (V1 V2)
 16161                                 TO CP-DDF-HI-FACT
 16162
 16163        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16164        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16165        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16166           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16167        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16168        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16169        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16170           + PD-1ST-YR-ADMIN-ALLOW
 16171
 16172        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16173*       IF PI-CLP-YN = 'Y'
 16174*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16175*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16176*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16177*       END-IF
 16178
 16179        IF DD-IU-PRESENT
 16180           MOVE 'I'              TO CP-EARNING-METHOD
 16181        END-IF
 16182        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16183                                     CP-CLP-RATE-UP
 16184        IF CP-IU-RATE-UP NOT = ZEROS
 16185           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16186              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16187           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16188              / (1 - WS-WORK-FACT)
 16189        END-IF
 16190     END-IF
 16191     .
 16192 3750-CONTINUE.
 16193     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16194
 16195     IF CP-REFUND-TYPE-USED NOT = SPACE
 16196         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16197
 16198     IF CP-ERROR-RATE-IS-ZERO OR
 16199        CP-ERROR-RATE-NOT-FOUND
 16200        MOVE ER-2740             TO WS-ERROR
 16201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16202
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 294
* EL050.cbl
 16203     IF CP-ERROR-RATE-FILE-NOTOPEN
 16204        MOVE ER-2617             TO WS-ERROR
 16205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16206     IF PB-COMPANY-ID = 'DCC'
 16207        AND PB-CI-ENTRY-STATUS = 'M'
 16208        MOVE +0                  TO PB-C-AH-REF-CALC
 16209     ELSE
 16210        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16211     END-IF
 16212     IF PB-COMPANY-ID = 'DCC'
 16213        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16214        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16215        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16216        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16217        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16218        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16219        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16220        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16221        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16222     END-IF
 16223     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 295
* EL050.cbl
 16225
 16226 3770-CHECK-REFUNDS.
 16227
 16228     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16229        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16230           MOVE ER-2766          TO WS-ERROR
 16231           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16232           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16233           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16234              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16235
 16236     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16237        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16238           MOVE ER-2766          TO WS-ERROR
 16239           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16240           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16241           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16242              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16243
 16244     IF PB-COMP-LF-CANCEL
 16245        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16246        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16247           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16248              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16249
 16250     IF PB-COMP-AH-CANCEL
 16251        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16252        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16253           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16254              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16255
 16256     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16257             GIVING WS-UNSIGN-WRK1
 16258     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16259             GIVING WS-UNSIGN-WRK2.
 16260
 16261     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16262         MOVE ZERO TO WS-UNSIGN-WRK1.
 16263
 16264     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16265         MOVE ZERO TO WS-UNSIGN-WRK2.
 16266
 16267     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16268
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 296
* EL050.cbl
 16270
 16271 3772-CONTINUE.
 16272
 16273**********************************
 16274*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16275*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16276*** DOUBLES THE TOLERANCE AMOUNT.
 16277***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16278**********************************
 16279     IF PB-COMPANY-ID = 'MON'
 16280     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16281         IF WS-REF-REJECT-SW = SPACE
 16282             MOVE ER-2754        TO WS-ERROR
 16283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16284           ELSE
 16285             MOVE ER-2736        TO WS-ERROR
 16286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16287**********************************
 16288
 16289 3773-CONTINUE.
 16290
 16291     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16292        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16293           MOVE ER-2723          TO WS-ERROR
 16294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16295
 16296     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16297        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16298           MOVE ER-2724          TO WS-ERROR
 16299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16300
 16301     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16302         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16303             (1 + WS-LF-REFUND-OVS-PCT)
 16304     ELSE
 16305         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16306
 16307     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16308         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16309             (1 - WS-TOL-LF-REFUND-PCT)
 16310     ELSE
 16311         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16312
 16313     IF (PB-COMPANY-ID = 'DCC')
 16314        AND (PB-CI-ENTRY-STATUS = 'M')
 16315        AND (PB-C-LF-CANCEL-AMT > +0)
 16316        MOVE ER-3843             TO WS-ERROR
 16317        PERFORM 9900-ERROR-FORMAT
 16318                                 THRU 9900-EXIT
 16319     END-IF
 16320     EVALUATE TRUE
 16321        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16322           CONTINUE
 16323        WHEN PB-C-LF-CANCEL-AMT = +0
 16324                 AND PB-C-LF-REF-CALC > +0
 16325           CONTINUE
 16326        WHEN WS-LF-REFUND-OVS-AMT = 0
 16327                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 297
* EL050.cbl
 16328           CONTINUE
 16329        WHEN OTHER
 16330           IF WS-TOL-LF-REFUND  = +0
 16331              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16332           END-IF
 16333           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16334                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16335                          (PB-C-LF-CANCEL-AMT))
 16336              CONTINUE
 16337           ELSE
 16338              IF WS-LF-REFUND-OVS-AMT = +0
 16339                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16340              END-IF
 16341              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16342                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16343                                       PB-C-LF-CANCEL-AMT)
 16344                 CONTINUE
 16345              ELSE
 16346                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16347                   MOVE ER-2754   TO  WS-ERROR
 16348                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16349                 ELSE
 16350                    MOVE ER-2736   TO  WS-ERROR
 16351                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16352                 END-IF
 16353              END-IF
 16354           END-IF
 16355     END-EVALUATE.
 16356
 16357     EVALUATE TRUE
 16358        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16359           CONTINUE
 16360        WHEN PB-C-LF-CANCEL-AMT = +0
 16361                 AND PB-C-LF-REF-CALC > +0
 16362           CONTINUE
 16363        WHEN OTHER
 16364           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16365               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16366              CONTINUE
 16367           ELSE
 16368              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16369               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16370                CONTINUE
 16371              ELSE
 16372                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16373                     MOVE ER-2754   TO  WS-ERROR
 16374                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16375                 ELSE
 16376                     MOVE ER-2736   TO  WS-ERROR
 16377                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16378                 END-IF
 16379              END-IF
 16380           END-IF
 16381     END-EVALUATE.
 16382
 16383     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16384         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16385             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 298
* EL050.cbl
 16386     ELSE
 16387         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16388
 16389     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16390         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16391             (1 - WS-TOL-AH-REFUND-PCT)
 16392     ELSE
 16393         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16394
 16395     IF (PB-COMPANY-ID = 'DCC')
 16396        AND (PB-CI-ENTRY-STATUS = 'M')
 16397        AND (PB-C-AH-CANCEL-AMT > +0)
 16398        MOVE ER-3843             TO WS-ERROR
 16399        PERFORM 9900-ERROR-FORMAT
 16400                                 THRU 9900-EXIT
 16401     END-IF
 16402     EVALUATE TRUE
 16403        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16404           CONTINUE
 16405*       WHEN PB-C-AH-REF-CALC = +0 AND
 16406*                  PB-C-AH-CANCEL-AMT > +0
 16407        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16408                   PB-C-AH-REF-CALC > +0
 16409           CONTINUE
 16410        WHEN WS-AH-REFUND-OVS-AMT = +0
 16411                AND WS-TOL-AH-REFUND = +0
 16412           CONTINUE
 16413        WHEN OTHER
 16414           IF WS-TOL-AH-REFUND = +0
 16415              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16416           END-IF
 16417           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16418               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16419                                         PB-C-AH-CANCEL-AMT)
 16420              CONTINUE
 16421           ELSE
 16422              IF WS-AH-REFUND-OVS-AMT = +0
 16423                 MOVE +9999999.99 TO
 16424                         WS-AH-REFUND-OVS-AMT
 16425              END-IF
 16426              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16427                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16428                                         PB-C-AH-CANCEL-AMT)
 16429                 CONTINUE
 16430              ELSE
 16431                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16432                    MOVE ER-2754   TO  WS-ERROR
 16433                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16434                 ELSE
 16435                    MOVE ER-2736   TO  WS-ERROR
 16436                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16437                 END-IF
 16438              END-IF
 16439           END-IF
 16440     END-EVALUATE.
 16441
 16442     EVALUATE TRUE
 16443        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 299
* EL050.cbl
 16444           CONTINUE
 16445*       WHEN PB-C-AH-REF-CALC > +0 AND
 16446*                  PB-C-AH-CANCEL-AMT = +0
 16447        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16448                   PB-C-AH-REF-CALC = +0
 16449           CONTINUE
 16450        WHEN OTHER
 16451           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16452               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16453              CONTINUE
 16454           ELSE
 16455              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16456                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16457                 CONTINUE
 16458              ELSE
 16459                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16460                     MOVE ER-2754   TO  WS-ERROR
 16461                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16462                 ELSE
 16463                     MOVE ER-2736   TO  WS-ERROR
 16464                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16465                 END-IF
 16466              END-IF
 16467           END-IF
 16468     END-EVALUATE.
 16469
 16470     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16471        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16472        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16473           AND  PB-C-LF-REF-CALC < +1.00
 16474           AND  PB-C-AH-REF-CALC < +1.00
 16475           CONTINUE
 16476        ELSE
 16477           IF (PB-COMPANY-ID = 'DCC')
 16478              AND (PB-CI-ENTRY-STATUS = 'M')
 16479              CONTINUE
 16480           ELSE
 16481              MOVE ER-2741       TO WS-ERROR
 16482              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16483           END-IF
 16484        END-IF
 16485     END-IF
 16486
 16487     IF (PB-C-LF-CANCEL-AMT = ZERO
 16488        AND WS-LF-BENEFIT-CD NOT = ZERO
 16489        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16490        AND PB-C-LF-REF-CALC NOT = ZERO)
 16491        OR
 16492        (PB-C-LF-CANCEL-AMT = ZERO
 16493        AND WS-LF-BENEFIT-CD NOT = ZERO
 16494        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16495             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16496                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16497                NEXT SENTENCE
 16498             ELSE
 16499                MOVE ER-2739        TO WS-ERROR
 16500                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16501
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 300
* EL050.cbl
 16502     IF (PB-C-AH-CANCEL-AMT = ZERO
 16503        AND WS-AH-BENEFIT-CD NOT = ZERO
 16504        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16505        AND PB-C-AH-REF-CALC NOT = ZERO)
 16506        OR
 16507        (PB-C-AH-CANCEL-AMT = ZERO
 16508        AND WS-AH-BENEFIT-CD NOT = ZERO
 16509        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16510             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16511                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16512                NEXT SENTENCE
 16513             ELSE
 16514                MOVE ER-2738        TO WS-ERROR
 16515                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16516
 16517 3775-OVER-REF-CHK.
 16518
 16519     IF PB-CI-ENTRY-STATUS = '5'
 16520        GO TO 3780-UPDATE-CANCEL-CERT.
 16521
 16522     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16523                              PB-CI-LF-ALT-PREMIUM-AMT.
 16524
 16525     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16526        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16527                                 PB-C-LF-REF-CALC
 16528      ELSE
 16529        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16530                                 PB-C-LF-CANCEL-AMT.
 16531
 16532     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16533        MOVE ER-2755             TO WS-ERROR
 16534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16535
 16536     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16537
 16538     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16539        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16540                                 PB-C-AH-REF-CALC
 16541      ELSE
 16542        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16543                                 PB-C-AH-CANCEL-AMT.
 16544
 16545     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16546        MOVE ER-2778             TO WS-ERROR
 16547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16548
 16549     IF PB-CI-OB-FLAG NOT = 'Z'
 16550        NEXT SENTENCE
 16551       ELSE
 16552         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16553            MOVE ER-2757           TO WS-ERROR
 16554            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16555
 16556 3780-UPDATE-CANCEL-CERT.
 16557
 16558     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16559        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 301
* EL050.cbl
 16560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16561
 16562     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16563         MOVE ER-2729              TO WS-ERROR
 16564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16565
 16566     IF PB-CI-LF-BENEFIT-CD = ZERO
 16567         GO TO 3780-UPDATE-CONT-1.
 16568
 16569     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16570         GO TO 3780-UPDATE-CONT-1.
 16571
 16572     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16573       AND
 16574        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16575       AND
 16576        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16577       AND
 16578        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16579            NEXT SENTENCE
 16580       ELSE
 16581        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16582          AND
 16583***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16584***       AND
 16585           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16586            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16587               MOVE ER-2730      TO WS-ERROR
 16588               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16589               GO TO 3999-END-EDIT
 16590            ELSE
 16591               GO TO 3999-END-EDIT
 16592        ELSE
 16593            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16594               MOVE ER-2765           TO WS-ERROR
 16595               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16596               GO TO 3785-CHECK-NH.
 16597*              GO TO 3999-END-EDIT.
 16598
 16599 3780-UPDATE-CONT-1.
 16600     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16601
 16602     IF PB-CI-AH-BENEFIT-CD = ZERO
 16603         GO TO 3780-UPDATE-CONT-2.
 16604
 16605     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16606         GO TO 3780-UPDATE-CONT-2.
 16607
 16608     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16609
 16610     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16611       AND
 16612        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16613       AND
 16614        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16615       AND
 16616        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16617            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 302
* EL050.cbl
 16618       ELSE
 16619        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16620          AND
 16621***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16622***       AND
 16623           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16624           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16625            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16626               MOVE ER-2773      TO WS-ERROR
 16627               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16628               GO TO 3999-END-EDIT
 16629            ELSE
 16630               GO TO 3999-END-EDIT
 16631            END-IF
 16632           ELSE
 16633             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16634                MOVE ER-2890 TO WS-ERROR
 16635                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16636                GO TO 3999-END-EDIT
 16637             ELSE
 16638                GO TO 3785-CHECK-NH
 16639             END-IF
 16640           END-IF
 16641          ELSE
 16642            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16643              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16644                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16645                   MOVE ER-2890 TO WS-ERROR
 16646                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647                   GO TO 3999-END-EDIT
 16648                ELSE
 16649                   MOVE ER-2765 TO WS-ERROR
 16650                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16651                   GO TO 3785-CHECK-NH
 16652                END-IF
 16653              ELSE
 16654               MOVE ER-2765      TO WS-ERROR
 16655               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16656               GO TO 3785-CHECK-NH.
 16657*              GO TO 3999-END-EDIT.
 16658
 16659 3780-UPDATE-CONT-2.
 16660
 16661     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16662        AND WS-LF-BENEFIT-CD = ZERO
 16663           MOVE ER-2743           TO WS-ERROR
 16664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16665
 16666     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16667        AND WS-AH-BENEFIT-CD = ZERO
 16668           MOVE ER-2744           TO WS-ERROR
 16669           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16670
 16671     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16672        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16673        AND
 16674        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16675         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 303
* EL050.cbl
 16676           MOVE ER-2746           TO WS-ERROR
 16677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16678
 16679     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16680       AND
 16681        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16682             MOVE ER-2737        TO WS-ERROR
 16683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16684
 16685     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16686       AND
 16687        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16688             MOVE ER-2737        TO WS-ERROR
 16689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16690
 16691     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16692         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16693             OR 'CID' OR 'DCC' OR 'AHL'
 16694             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16695         ELSE
 16696             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16697                 MOVE ER-2768    TO WS-ERROR
 16698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16699             ELSE
 16700                 MOVE ER-2756    TO WS-ERROR
 16701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16702
 16703     IF CERT-PEND-ISSUE-RETURNED
 16704        MOVE ER-2772             TO WS-ERROR
 16705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16706 3785-CHECK-NH.
 16707     IF PB-STATE NOT = 'NH'
 16708        GO TO 3999-END-EDIT
 16709     END-IF
 16710
 16711     MOVE ER-2796                TO WS-ERROR
 16712     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16713     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16714        OR (CM-NH-INTERFACE-SW = 'Y')
 16715        MOVE ER-2793             TO WS-ERROR
 16716        PERFORM 9900-ERROR-FORMAT
 16717                                 THRU 9900-EXIT
 16718     END-IF
 16719     MOVE +0                     TO WS-PAYMENT-AMT
 16720     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16721        GO TO 3999-END-EDIT
 16722     END-IF
 16723     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16724        GO TO 3999-END-EDIT
 16725     END-IF
 16726     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16727     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16728     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16729        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16730     END-IF
 16731     MOVE '1'                    TO DC-OPTION-CODE
 16732     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16733     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 304
* EL050.cbl
 16734        IF DC-ELAPSED-DAYS < +16
 16735           GO TO 3999-END-EDIT
 16736        END-IF
 16737     END-IF
 16738     MOVE +0                     TO DC-ELAPSED-DAYS
 16739     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16740     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16741     MOVE '1'                    TO DC-OPTION-CODE
 16742     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16743     IF NO-CONVERSION-ERROR
 16744        IF DC-ELAPSED-DAYS > +30
 16745           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16746        ELSE
 16747           GO TO 3999-END-EDIT
 16748        END-IF
 16749     ELSE
 16750        GO TO 3999-END-EDIT
 16751     END-IF
 16752     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16753        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16754           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16755     IF WS-PAYMENT-AMT < 600.00
 16756        GO TO 3999-END-EDIT
 16757     END-IF
 16758     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16759
 16760     IF (ERMAIL-FOUND = ' ')
 16761         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16762         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16763        GO TO 3999-END-EDIT
 16764     END-IF
 16765     MOVE ER-2795                TO WS-ERROR
 16766     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16767
 16768     GO TO 3999-END-EDIT.
 16769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 305
* EL050.cbl
 16771 3990-FILES-NOT-OPEN.
 16772
 16773     MOVE ER-2617                TO WS-ERROR.
 16774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16775     GO TO 9990-RETURN.
 16776
 16777 3999-END-EDIT.
 16778
 16779     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16780
 16781     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16782         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16783         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16784             PERFORM 9250-UNLOCK-RETURN
 16785             GO TO 9990-RETURN
 16786          ELSE
 16787             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16788             GO TO 9990-RETURN.
 16789
 16790     IF PB-CANCELLATION
 16791          GO TO 9990-RETURN.
 16792
 16793     IF CERT-WAS-NOT-FOUND
 16794        MOVE SPACES              TO CERTIFICATE-MASTER.
 16795
 16796     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16797
 16798     IF CERT-WAS-FOUND
 16799         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16800             PERFORM 9250-UNLOCK-RETURN
 16801          ELSE
 16802            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16803      ELSE
 16804         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16805
 16806     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16807        IF PB-COMPANY-ID = 'DCC' AND
 16808           (PB-CARRIER = '2' OR '4' OR '6')
 16809              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16810        END-IF
 16811     END-IF.
 16812
 16813     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16814         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16815     END-IF.
 16816
 16817     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16818     IF ((PB-COMPANY-ID = 'DCC')
 16819        AND (WS-NO-SECURE-PAY))
 16820                  OR
 16821        (WS-LF-SPECIAL-CALC-CD = 'O'
 16822        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16823        SET SKIP-ADDR-EDIT       TO TRUE
 16824     END-IF
 16825     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16826        AND (NOT SKIP-ADDR-EDIT)
 16827        MOVE ER-2963             TO WS-ERROR
 16828        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 306
* EL050.cbl
 16829                                 THRU 9900-EXIT
 16830        GO TO 9990-RETURN
 16831     END-IF
 16832     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16833     IF ERPNDM-FOUND NOT = 'X'
 16834        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16835           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16836           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16837           AND (NOT SKIP-ADDR-EDIT)
 16838           MOVE ER-2694          TO WS-ERROR
 16839           PERFORM 9900-ERROR-FORMAT
 16840                                 THRU 9900-EXIT
 16841        END-IF
 16842        MOVE ' '                 TO STATE-RECORD-ERROR
 16843        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16844        MOVE PM-STATE            TO CNTL-ACCESS
 16845        MOVE '3'                 TO CNTL-REC-TYPE
 16846        MOVE +0                  TO CNTL-SEQ-NO
 16847        MOVE '0'                 TO RC-SW-2
 16848        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16849        IF (NO-STATE-RECORD)
 16850           OR (CF-RECORD-TYPE NOT = '3')
 16851           OR (PM-STATE NOT = CF-STATE-CODE)
 16852           IF (PM-STATE = SPACES)
 16853              AND (SKIP-ADDR-EDIT)
 16854              CONTINUE
 16855           ELSE
 16856              MOVE ER-2963       TO WS-ERROR
 16857              PERFORM 9900-ERROR-FORMAT
 16858                                 THRU 9900-EXIT
 16859           END-IF
 16860        END-IF
 16861        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16862           MOVE ER-2883          TO WS-ERROR
 16863           PERFORM 9900-ERROR-FORMAT
 16864                                 THRU 9900-EXIT
 16865        END-IF
 16866        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16867           MOVE ' '                 TO STATE-RECORD-ERROR
 16868           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16869           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16870           MOVE '3'                 TO CNTL-REC-TYPE
 16871           MOVE +0                  TO CNTL-SEQ-NO
 16872           MOVE '0'                 TO RC-SW-2
 16873           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16874           IF NO-STATE-RECORD
 16875              OR (CF-RECORD-TYPE NOT = '3')
 16876              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16877              MOVE ER-2964          TO WS-ERROR
 16878              PERFORM 9900-ERROR-FORMAT
 16879                                    THRU 9900-EXIT
 16880           END-IF
 16881        END-IF
 16882     ELSE
 16883        IF NOT SKIP-ADDR-EDIT
 16884           MOVE ER-2393          TO WS-ERROR
 16885           PERFORM 9900-ERROR-FORMAT
 16886                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 307
* EL050.cbl
 16887        END-IF
 16888     END-IF
 16889
 16890     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16891
 16892     IF (ERMAIL-FOUND = ' ' AND
 16893        ERPNDM-FOUND = ' ')
 16894        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16895           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16896           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16897          OR
 16898           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16899          OR
 16900           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16901           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16902           GO TO 3999-UNLOCK-ERMAIL.
 16903
 16904     IF ERPNDM-FOUND = 'X'
 16905        GO TO 3999-UNLOCK-ERMAIL.
 16906
 16907     IF PM-INSURED-LAST-NAME      = SPACES
 16908        AND PM-INSURED-FIRST-NAME = SPACES
 16909        AND PM-ADDRESS-LINE-1     = SPACES
 16910        AND PM-ADDRESS-LINE-2     = SPACES
 16911        AND PM-CITY-STATE         = SPACES
 16912        AND PM-CRED-BENE-NAME     = SPACES
 16913        AND PM-CRED-BENE-ADDR     = SPACES
 16914        AND PM-CRED-BENE-CTYST    = SPACES
 16915        GO TO 3999-UNLOCK-ERMAIL
 16916     END-IF
 16917
 16918     MOVE SPACES                 TO MAILING-DATA.
 16919
 16920     MOVE 'MA'                   TO MA-RECORD-ID.
 16921     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16922     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16923     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16924     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16925     MOVE PB-SV-STATE            TO MA-STATE.
 16926     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16927     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16928
 16929     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16930     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16931
 16932     IF ERMAIL-FOUND = ' '
 16933        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16934     ELSE
 16935        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16936        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16937        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16938
 16939     GO TO 9990-RETURN.
 16940
 16941 3999-UNLOCK-ERMAIL.
 16942     IF ERMAIL-FOUND = ' '
 16943        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16944
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 308
* EL050.cbl
 16945     GO TO 9990-RETURN.
 16946******************************************************************
 16947
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 309
* EL050.cbl
 16949 4000-UPDATE-CANCELLED-CERT.
 16950     IF CERT-WAS-NOT-FOUND
 16951        GO TO 4299-EXIT.
 16952
 16953*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16954     IF PB-C-NH-INT-ON-REFS > ZEROS
 16955        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16956     END-IF
 16957     IF PB-C-REF-INTERFACE-SW = 'Y'
 16958        MOVE PB-C-REF-INTERFACE-SW
 16959                                 TO CM-NH-INTERFACE-SW
 16960     END-IF
 16961     IF PB-C-POST-CARD-IND = 'Y'
 16962        MOVE +8                  TO SUB
 16963        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16964        IF ERMAIL-FOUND = ' '
 16965           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16966              (SUB > +7)
 16967              OR (MA-MAIL-STATUS (SUB) = '1')
 16968           END-PERFORM
 16969        END-IF
 16970        IF (SUB > +7)
 16971           OR (ERMAIL-FOUND = 'X')
 16972           MOVE ER-3789          TO WS-ERROR
 16973           PERFORM 9900-ERROR-FORMAT
 16974                                 THRU 9900-EXIT
 16975        END-IF
 16976     ELSE
 16977        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16978     END-IF
 16979     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16980
 16981     IF PB-CI-OB-FLAG = 'Z'
 16982        GO TO 4150-SUMMARY-CERT-CANCEL.
 16983
 16984     IF PB-C-LF-CANCEL-VOIDED
 16985         PERFORM 4200-REVERSE-LF-CANCEL.
 16986     IF PB-C-AH-CANCEL-VOIDED
 16987         PERFORM 4200-REVERSE-AH-CANCEL.
 16988
 16989 4100-APPLY-LF-CANCEL.
 16990
 16991     MOVE +0                     TO WS-SUB.
 16992
 16993 4100-CHECK-LF-ERRORS.
 16994
 16995     ADD +1                       TO WS-SUB.
 16996
 16997     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16998        IF LF-COVERAGE-CANCELLED
 16999           GO TO 4100-LF-CANCEL-CONT
 17000        ELSE
 17001           GO TO 4100-UPDATE-LF-COVERAGE.
 17002
 17003     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17004                                   ER-2729 OR
 17005                                   ER-2730 OR
 17006                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 310
* EL050.cbl
 17007                                   ER-2732 OR
 17008                                   ER-2737 OR
 17009                                   ER-2740 OR
 17010                                   ER-2743 OR
 17011                                   ER-2749 OR
 17012                                   ER-2750 OR
 17013                                   ER-2755 OR
 17014                                   ER-2757 OR
 17015                                   ER-2760 OR
 17016                                   ER-2772 OR
 17017                                   ER-2774 OR
 17018                                   ER-2776 OR
 17019                                   ER-2794
 17020        GO TO 4100-UPDATE-LF-COVERAGE.
 17021
 17022     GO TO 4100-CHECK-LF-ERRORS.
 17023
 17024 4100-UPDATE-LF-COVERAGE.
 17025
 17026     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17027     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17028     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17029        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17030     END-IF
 17031     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17032                                      TO CM-CREDIT-INTERFACE-SW-2.
 17033     IF CM-LF-CANCEL-DT = LOW-VALUE
 17034         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17035
 17036     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17037         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17038                                         CM-LF-STATUS-AT-CANCEL.
 17039
 17040     GO TO 4100-APPLY-AH-CANCEL.
 17041
 17042 4100-LF-CANCEL-CONT.
 17043     IF PB-C-LF-CANCEL-VOIDED
 17044         GO TO 4100-APPLY-AH-CANCEL.
 17045
 17046     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17047         GO TO 4100-APPLY-AH-CANCEL.
 17048
 17049     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17050        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17051           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17052        ELSE
 17053           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17054
 17055     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17056     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17057
 17058     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17059         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17060
 17061     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17062        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17063         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17064         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 311
* EL050.cbl
 17065
 17066     IF PB-RECORD-RETURNED
 17067        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17068      ELSE
 17069        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17070
 17071 4100-APPLY-AH-CANCEL.
 17072
 17073     MOVE +0                      TO WS-SUB.
 17074
 17075 4100-CHECK-AH-ERRORS.
 17076
 17077     ADD +1                       TO WS-SUB.
 17078
 17079     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17080        IF AH-COVERAGE-CANCELLED
 17081           GO TO 4100-AH-CANCEL-CONT
 17082        ELSE
 17083           GO TO 4100-UPDATE-AH-COVERAGE.
 17084
 17085     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17086                                   ER-2729 OR
 17087                                   ER-2732 OR
 17088                                   ER-2737 OR
 17089                                   ER-2740 OR
 17090                                   ER-2744 OR
 17091                                   ER-2749 OR
 17092                                   ER-2750 OR
 17093                                   ER-2755 OR
 17094                                   ER-2757 OR
 17095                                   ER-2760 OR
 17096                                   ER-2771 OR
 17097                                   ER-2772 OR
 17098                                   ER-2773 OR
 17099                                   ER-2775 OR
 17100                                   ER-2777 OR
 17101                                   ER-2794
 17102        GO TO 4100-UPDATE-AH-COVERAGE.
 17103
 17104     GO TO 4100-CHECK-AH-ERRORS.
 17105
 17106 4100-UPDATE-AH-COVERAGE.
 17107
 17108     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17109     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17110     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17111     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17112                                      TO CM-CREDIT-INTERFACE-SW-2.
 17113     IF CM-AH-CANCEL-DT = LOW-VALUE
 17114         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17115
 17116     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17117         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17118                                         CM-AH-STATUS-AT-CANCEL.
 17119
 17120     IF LF-COVERAGE-CANCELLED
 17121         IF PB-RECORD-RETURNED
 17122              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 312
* EL050.cbl
 17123          ELSE
 17124              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17125
 17126     GO TO 4299-EXIT.
 17127
 17128 4100-AH-CANCEL-CONT.
 17129     IF PB-C-AH-CANCEL-VOIDED
 17130         GO TO 4299-EXIT.
 17131
 17132     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17133         GO TO 4299-EXIT.
 17134
 17135     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17136        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17137           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17138        ELSE
 17139           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17140
 17141     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17142     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17143
 17144     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17145         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17146
 17147     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17148         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17149         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17150
 17151     IF PB-RECORD-RETURNED
 17152        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17153      ELSE
 17154        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17155
 17156     GO TO 4299-EXIT.
 17157
 17158 4150-SUMMARY-CERT-CANCEL.
 17159     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17160
 17161     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17162        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17163                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17164     ELSE
 17165        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17166                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17167
 17168     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17169        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17170                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17171     ELSE
 17172        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17173                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17174
 17175     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17176        NEXT SENTENCE
 17177     ELSE
 17178        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17179
 17180     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 313
* EL050.cbl
 17181
 17182 4200-REVERSE-LF-CANCEL.
 17183     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17184
 17185     IF CM-LF-CANCEL-APPLIED
 17186        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17187        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17188        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17189
 17190     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17191
 17192     IF PB-RECORD-RETURNED
 17193        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17194       ELSE
 17195        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17196
 17197 4200-REVERSE-LF-EXIT.
 17198       EXIT.
 17199
 17200 4200-REVERSE-AH-CANCEL.
 17201     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17202
 17203     IF CM-AH-CANCEL-APPLIED
 17204        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17205        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17206        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17207
 17208     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17209
 17210     IF PB-RECORD-RETURNED
 17211        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17212       ELSE
 17213        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17214
 17215 4200-REVERSE-AH-EXIT.
 17216       EXIT.
 17217
 17218 4299-EXIT.
 17219       EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 314
* EL050.cbl
 17221
 17222 4500-UPDATE-NEW-CERT.
 17223     IF CERT-WAS-FOUND
 17224         NEXT SENTENCE
 17225       ELSE
 17226         GO TO 4520-BUILD-NEW-KEY.
 17227
 17228     IF  CLASIC-CREATED-CERT
 17229         GO TO 4999-EXIT.
 17230
 17231     IF  CERT-WAS-CREATED-FOR-CLAIM
 17232         GO TO 4520-BUILD-NEW-KEY.
 17233
 17234     IF CERT-ADDED-BATCH
 17235        IF CM-RECORD-ID = 'CM'
 17236            GO TO 4999-EXIT.
 17237
 17238 4520-BUILD-NEW-KEY.
 17239* BUILD CONTROL PRIMARY
 17240
 17241     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17242                                       CM-COMPANY-CD-A1
 17243                                       CM-COMPANY-CD-A2
 17244                                       CM-COMPANY-CD-A4
 17245                                       CM-COMPANY-CD-A5.
 17246
 17247     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17248     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17249     MOVE PB-SV-STATE               TO CM-STATE.
 17250     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17251     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17252     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17253     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17254
 17255     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17256
 17257     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17258     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17259     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17260     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17261
 17262     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17263        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17264
 17265     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17266         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17267         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17268         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17269         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17270     ELSE
 17271         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17272
 17273     IF PB-COMPANY-ID   EQUAL  'CRI'
 17274         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17275         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17276         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17277         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17278         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 315
* EL050.cbl
 17279
 17280     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17281        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17282         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17283
 17284     IF PB-COMPANY-ID  = 'LBL'
 17285        IF PB-I-JOINT-COVERAGE
 17286            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17287                                           PB-I-MEMBER-NO
 17288            GO TO 4550-CONT-CERT-PROCESS.
 17289
 17290     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17291        NEXT SENTENCE
 17292     ELSE
 17293        GO TO 4540-BUILD-MEMBER-NO.
 17294
 17295******************************************************************
 17296*                                                                *
 17297*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17298*    FOR 'MON'.                                                  *
 17299*                                                                *
 17300******************************************************************
 17301
 17302     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17303     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17304     MOVE +1                     TO WS-SUB1
 17305                                    WS-SUB2.
 17306
 17307 4530-EDIT-MEMB-NAME.
 17308
 17309     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17310        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17311        ADD +1                       TO WS-SUB2.
 17312
 17313     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17314        ADD +1                       TO WS-SUB1
 17315        GO TO 4530-EDIT-MEMB-NAME.
 17316
 17317     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17318     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17319     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17320*    MOVE SPACE                      TO DC-OPTION-CODE.
 17321     SET  BIN-TO-GREG                TO TRUE.
 17322     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17323     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17324
 17325     GO TO 4550-CONT-CERT-PROCESS.
 17326
 17327******************************************************************
 17328*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17329******************************************************************
 17330
 17331 4540-BUILD-MEMBER-NO.
 17332
 17333     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17334         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17335         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17336         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 316
* EL050.cbl
 17337         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17338     ELSE
 17339         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17340
 17341     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17342        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17343         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17344
 17345 4550-CONT-CERT-PROCESS.
 17346
 17347*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17348*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17349*    ELSE
 17350*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17351
 17352     IF CERT-WAS-CREATED-FOR-CLAIM
 17353        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17354        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17355
 17356     IF CERT-AND-CLAIM-ONLINE
 17357        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17358        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17359
 17360     MOVE 'CM'                     TO CM-RECORD-ID.
 17361     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17362
 17363     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17364        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17365        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17366     ELSE
 17367        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17368        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17369
 17370     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17371     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17372     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17373     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17374     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17375     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17376     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17377                                      CM-LF-ITD-CANCEL-AMT
 17378                                      CM-LF-ITD-DEATH-AMT
 17379                                      CM-AH-ITD-AH-PMT
 17380                                      CM-AH-ITD-LUMP-PMT
 17381                                      CM-AH-ITD-CANCEL-AMT
 17382                                      CM-LF-NSP-PREMIUM-AMT
 17383                                      CM-AH-NSP-PREMIUM-AMT.
 17384*                                     CM-CLAIM-DEDUCT-WITHHELD
 17385*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17386     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17387     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17388     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17389     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17390     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17391     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17392     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17393     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17394     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 317
* EL050.cbl
 17395     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17396     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17397     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17398
 17399     IF PB-I-LIVES NOT NUMERIC
 17400         MOVE ZERO                 TO PB-I-LIVES.
 17401
 17402     IF PB-I-NUM-BILLED NOT NUMERIC
 17403         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17404
 17405     MOVE PB-I-LIVES               TO CM-LIVES.
 17406     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17407
 17408     IF PB-COMPANY-ID EQUAL  'DMD'
 17409         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17410         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17411
 17412     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17413     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17414     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17415     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17416     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17417     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17418
 17419     IF PB-I-LF-POLICY-FEE NUMERIC
 17420        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17421     ELSE
 17422        MOVE +0                    TO CM-LF-POLICY-FEE.
 17423
 17424     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17425        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17426        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17427     ELSE
 17428        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17429
 17430     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17431     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17432     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17433     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17434     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17435     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17436     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17437     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17438     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17439
 17440     IF PB-I-AH-POLICY-FEE NUMERIC
 17441        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17442     ELSE
 17443        MOVE +0                    TO CM-AH-POLICY-FEE.
 17444
 17445     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17446        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17447     ELSE
 17448        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17449
 17450     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17451     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17452
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 318
* EL050.cbl
 17453     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17454                                      CM-LF-DEATH-EXIT-DT
 17455                                      CM-AH-SETTLEMENT-EXIT-DT.
 17456
 17457*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17458*                       'TIH' OR 'OFL' OR 'FLA' OR
 17459*                       'TII' OR 'TMS' OR 'CRI' OR
 17460*                       'NCL'
 17461     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17462
 17463     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17464         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17465            MOVE '2'                TO CM-PREMIUM-TYPE.
 17466
 17467     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17468         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17469            MOVE '2'                TO CM-PREMIUM-TYPE.
 17470
 17471     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17472         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17473     ELSE
 17474         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17475         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17476
 17477     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17478     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17479     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17480     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17481     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17482     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17483     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17484     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17485
 17486     IF PB-NO-MONTHS-SKIPPED
 17487         MOVE SPACE                 TO CM-SKIP-CODE
 17488     ELSE
 17489         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17490
 17491     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17492     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17493                                       CM-LF-STATUS-AT-CANCEL.
 17494
 17495     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17496     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17497                                       CM-AH-STATUS-AT-CANCEL.
 17498
 17499     MOVE '1'                       TO CM-ENTRY-STATUS.
 17500
 17501     IF PB-REISSUED-CERT
 17502        MOVE '5'                    TO CM-ENTRY-STATUS.
 17503
 17504     IF PB-MONTHLY-CERT
 17505        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17506
 17507     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17508     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17509     IF PB-POLICY-IS-DECLINED
 17510        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 319
* EL050.cbl
 17511
 17512     IF PB-POLICY-IS-VOIDED
 17513        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17514
 17515     IF PB-NEEDS-UNDERWRITING
 17516        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17517
 17518     IF PB-REIN-ONLY-CERT
 17519        MOVE '9'                    TO CM-ENTRY-STATUS.
 17520
 17521     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17522         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17523     ELSE
 17524         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17525
 17526     IF PB-RECORD-RETURNED
 17527        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17528      ELSE
 17529        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17530
 17531     IF PB-I-MAIL-ADDRS-PRESENT
 17532        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17533
 17534     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17535                                       CM-ENTRY-DT.
 17536
 17537 4999-EXIT.
 17538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 320
* EL050.cbl
 17540
 17541 5000-PROCESS-REPS.
 17542     MOVE ' '                    TO AGTC-MASTER-SW
 17543     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17544     MOVE CO-TYPE                TO AGTC-TYPE
 17545     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17546     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17547     IF (AGTC-MASTER-SW NOT = 'N')
 17548        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17549        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17550        PERFORM 8583-READ-ERAGTC-NEXT
 17551                                 THRU 8583-EXIT
 17552     END-IF
 17553     IF AGTC-MASTER-SW = 'N'
 17554        CONTINUE
 17555     ELSE
 17556        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17557           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17558              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17559              MOVE 'Y'           TO AGTC-MASTER-SW
 17560           END-IF
 17561        END-IF
 17562     END-IF
 17563     .
 17564 5000-EXIT.
 17565     EXIT.
 17566 6370-EDIT-INPUT-LF-CODE.
 17567     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17568        MOVE +1                  TO SUB
 17569        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17570        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17571        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17572        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17573        GO TO 6370-SEARCH-LOOP.
 17574
 17575     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17576
 17577     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17578     MOVE SPACES                 TO CNTL-ACCESS.
 17579*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17580     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17581     MOVE +0                     TO CNTL-SEQ-NO.
 17582     MOVE '4' TO RC-SW-2.
 17583     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17584
 17585     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17586        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17587        GO TO 6370-NO-LF-FOUND.
 17588
 17589     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17590     MOVE +1                     TO SUB.
 17591
 17592 6370-SEARCH-LOOP.
 17593     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17594         GO TO 6370-NO-LF-FOUND.
 17595
 17596     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17597         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 321
* EL050.cbl
 17598         GO TO 6370-HER-NET-PAY-CHECK.
 17599
 17600     ADD 1   TO SUB.
 17601*    IF SUB GREATER 120
 17602     IF SUB GREATER 200
 17603         GO TO 6370-NO-LF-FOUND.
 17604
 17605     GO TO 6370-SEARCH-LOOP.
 17606
 17607 6370-NO-LF-FOUND.
 17608
 17609     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17610
 17611 6370-HER-NET-PAY-CHECK.
 17612
 17613     IF PB-COMPANY-ID = 'CID'
 17614        IF PB-SV-STATE = 'CA' OR 'MN'
 17615           IF PB-I-LF-BENEFIT-CD = '02'
 17616              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17617           ELSE
 17618              IF PB-I-LF-BENEFIT-CD = '04'
 17619                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17620              END-IF
 17621           END-IF
 17622        END-IF
 17623     END-IF
 17624
 17625     IF PB-COMPANY-ID NOT = 'HER'
 17626         GO TO 6370-EXIT.
 17627
 17628     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17629         GO TO 6370-EXIT.
 17630
 17631     IF PB-I-LF-TERM NOT NUMERIC
 17632         MOVE ZEROS              TO PB-I-LF-TERM.
 17633
 17634     IF PB-I-LOAN-TERM NOT NUMERIC
 17635         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17636
 17637     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17638         GO TO 6370-EXIT.
 17639
 17640     IF PB-I-LF-BENEFIT-CD = '33'
 17641         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17642
 17643     IF PB-I-LF-BENEFIT-CD = '34'
 17644         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17645
 17646 6370-EXIT.
 17647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 322
* EL050.cbl
 17649
 17650 6380-EDIT-INPUT-AH-CODE.
 17651     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17652        MOVE +1                  TO SUB
 17653        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17654        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17655        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17656        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17657        GO TO 6380-SEARCH-LOOP.
 17658
 17659     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17660
 17661     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17662     MOVE SPACES                 TO CNTL-ACCESS.
 17663     MOVE 'A'                    TO CNTL-REC-TYPE.
 17664*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17665     MOVE +0                     TO CNTL-SEQ-NO.
 17666     MOVE '5' TO RC-SW-2.
 17667     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17668
 17669     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17670        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17671        GO TO 6380-NO-AH-FOUND.
 17672
 17673     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17674     MOVE +1 TO SUB.
 17675
 17676 6380-SEARCH-LOOP.
 17677     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17678         GO TO 6380-NO-AH-FOUND.
 17679
 17680     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17681         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17682         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17683
 17684     ADD 1   TO SUB.
 17685     IF SUB GREATER THAN 96
 17686*    IF SUB GREATER THAN 300
 17687         GO TO 6380-NO-AH-FOUND.
 17688
 17689     GO TO 6380-SEARCH-LOOP.
 17690
 17691 6380-NO-AH-FOUND.
 17692
 17693     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17694
 17695     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17696         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17697     ELSE
 17698         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17699
 17700 6380-CSO-AH-ONLY-CHECKS.
 17701
 17702     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17703        NEXT SENTENCE
 17704      ELSE
 17705        GO TO 6380-EXIT.
 17706
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 323
* EL050.cbl
 17707     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17708         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17709
 17710
 17711     GO TO 6380-EXIT
 17712     .
 17713 6380-CSO-LIFE-WITH-AH-CHECKS.
 17714
 17715
 17716     .
 17717 6380-EXIT.
 17718     EXIT.
 17719
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 324
* EL050.cbl
 17721
 17722 6400-COMPUTE-EXTENSION-DAYS.
 17723
 17724******************************************************************
 17725*                                                                *
 17726*                   COMPUTE EXTENSION DAYS                       *
 17727*                                                                *
 17728*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17729*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17730*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17731*    THE EXTENSION DAYS.                                         *
 17732*                                                                *
 17733******************************************************************
 17734
 17735     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17736     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17737
 17738******************************************************************
 17739*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17740*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17741******************************************************************
 17742
 17743     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17744        COMPUTE WS-ODD-DAYS-OVER =
 17745               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17746     ELSE
 17747        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17748
 17749     IF WS-ODD-DAYS-OVER = ZEROS
 17750           GO TO 6499-EXIT
 17751     ELSE
 17752        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17753           IF WS-WDF-MONTH = 02
 17754              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17755              ADD 2       TO  WS-ODD-DAYS-OVER
 17756              GO TO 6499-EXIT
 17757           ELSE
 17758              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17759                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17760                 GO TO 6499-EXIT
 17761               ELSE
 17762                 GO TO 6499-EXIT
 17763        ELSE
 17764           GO TO 6499-EXIT.
 17765
 17766 6412-CHECK-TO-DAY.
 17767
 17768        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17769           IF WS-WDT-DAY = 28
 17770              ADD 2              TO WS-ODD-DAYS-OVER
 17771           ELSE
 17772              IF WS-WDT-DAY = 29
 17773                 ADD 1           TO WS-ODD-DAYS-OVER
 17774              ELSE
 17775                 NEXT SENTENCE
 17776        ELSE
 17777           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17778              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 325
* EL050.cbl
 17779
 17780     GO TO 6499-EXIT.
 17781
 17782
 17783 6415-CHECK-LEAP-YEAR.
 17784
 17785     IF DC-DAYS-IN-MONTH = 29
 17786        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17787
 17788 6415-EXIT.
 17789     EXIT.
 17790
 17791 6499-EXIT.
 17792      EXIT.
 17793
 17794 6500-END.
 17795     EXIT.
 17796
 17797
 17798******************************************************************
 17799************* PROCEDURE DIVISION FOR EL050 ***********************
 17800********************** ELC50PD END *******************************
 17801
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 326
* EL050.cbl
 17803
 17804**START***********************************************************
 17805*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17806*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17807******************************************************************
 17808*
 17809 6600-GET-STATE-MUNICIPAL-TAX.
 17810
 17811     IF PB-COMPANY-ID NOT = 'DMD'
 17812         GO TO 6640-EXIT.
 17813
 17814     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17815     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17816     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17817*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17818*
 17819***  Y2K PROJ 7744
 17820     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17821     SET BIN-TO-GREG          TO TRUE.
 17822     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17823
 17824     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17825
 17826     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17827     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17828
 17829
 17830* EXEC CICS HANDLE CONDITION
 17831*        INVREQ    (6610-START-BROWSE)
 17832*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17833*        NOTFND    (6630-END-OF-FILE)
 17834*    END-EXEC.
 17835*    MOVE '"$8JI                 ! # #00017817' TO DFHEIV0
 17836     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17838     MOVE X'2320233030303137383137' TO DFHEIV0(25:11)
 17839     CALL 'kxdfhei1' USING DFHEIV0
 17840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17841
 17842
 17843 6610-START-BROWSE.
 17844
 17845
 17846* EXEC CICS HANDLE CONDITION
 17847*        NOTFND    (6630-END-OF-FILE)
 17848*        DISABLED  (6630-ERRESS-PROBLEM)
 17849*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17850*        ENDFILE   (6630-END-OF-FILE)
 17851*    END-EXEC.
 17852*    MOVE '"$IcJ''                ! $ #00017825' TO DFHEIV0
 17853     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17855     MOVE X'2420233030303137383235' TO DFHEIV0(25:11)
 17856     CALL 'kxdfhei1' USING DFHEIV0
 17857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17858
 17859
 17860
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 327
* EL050.cbl
 17861* EXEC CICS STARTBR
 17862*        DATASET (FILE-ID-ERRESS)
 17863*        RIDFLD  (WS-ERRESS-KEY)
 17864*        GTEQ
 17865*    END-EXEC.
 17866     MOVE 0
 17867       TO DFHEIV11
 17868*    MOVE '&,         G          &   #00017832' TO DFHEIV0
 17869     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17870     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17871     MOVE X'2020233030303137383332' TO DFHEIV0(25:11)
 17872     CALL 'kxdfhei1' USING DFHEIV0,
 17873           FILE-ID-ERRESS,
 17874           WS-ERRESS-KEY,
 17875           DFHEIV99,
 17876           DFHEIV11,
 17877           DFHEIV99
 17878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17879
 17880
 17881 6620-READ-NEXT-ERRESS-MASTER.
 17882
 17883
 17884* EXEC CICS HANDLE CONDITION
 17885*        NOTFND    (6630-END-OF-FILE)
 17886*        ENDFILE   (6630-END-OF-FILE)
 17887*        DISABLED  (6630-ERRESS-PROBLEM)
 17888*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17889*    END-EXEC.
 17890*    MOVE '"$I''cJ                ! % #00017840' TO DFHEIV0
 17891     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17893     MOVE X'2520233030303137383430' TO DFHEIV0(25:11)
 17894     CALL 'kxdfhei1' USING DFHEIV0
 17895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17896
 17897
 17898
 17899* EXEC CICS READNEXT
 17900*        DATASET (FILE-ID-ERRESS)
 17901*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17902*        RIDFLD  (WS-ERRESS-KEY)
 17903*    END-EXEC.
 17904     MOVE LENGTH OF
 17905      RESIDENT-STATE-TAX-MASTER
 17906       TO DFHEIV12
 17907     MOVE 0
 17908       TO DFHEIV11
 17909*    MOVE '&.IL                  )   #00017847' TO DFHEIV0
 17910     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17911     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17912     MOVE X'2020233030303137383437' TO DFHEIV0(25:11)
 17913     CALL 'kxdfhei1' USING DFHEIV0,
 17914           FILE-ID-ERRESS,
 17915           RESIDENT-STATE-TAX-MASTER,
 17916           DFHEIV12,
 17917           WS-ERRESS-KEY,
 17918           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 328
* EL050.cbl
 17919           DFHEIV11,
 17920           DFHEIV99,
 17921           DFHEIV99
 17922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17923
 17924
 17925     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17926
 17927* EXEC CICS ENDBR
 17928*            DATASET (FILE-ID-ERRESS)
 17929*       END-EXEC
 17930     MOVE 0
 17931       TO DFHEIV11
 17932*    MOVE '&2                    $   #00017854' TO DFHEIV0
 17933     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17935     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 17936     CALL 'kxdfhei1' USING DFHEIV0,
 17937           FILE-ID-ERRESS,
 17938           DFHEIV11,
 17939           DFHEIV99
 17940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17941        GO TO 6630-END-OF-FILE.
 17942
 17943     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17944        NEXT SENTENCE
 17945      ELSE
 17946        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17947
 17948*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17949*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17950*
 17951     MOVE +2                     TO WS-SUB1.
 17952
 17953     IF PB-ISSUE
 17954     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17955        MOVE +1                  TO WS-SUB1.
 17956
 17957     IF PB-CANCELLATION
 17958     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17959        MOVE +1                  TO WS-SUB1.
 17960*
 17961*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17962*
 17963***  Y2K PROJ 7744
 17964     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17965***  Y2K PROJ 7744
 17966
 17967*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17968* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17969* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17970
 17971     ADD 1                    TO WS-YEAR-YY.
 17972
 17973     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17974         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17975                              TO WS-RES-STATE-TAX
 17976         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 329
* EL050.cbl
 17977                              TO WS-RES-MUNI-TAX
 17978     ELSE
 17979         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17980                              TO WS-RES-STATE-TAX
 17981         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17982                              TO WS-RES-MUNI-TAX.
 17983
 17984*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17985
 17986     IF PB-CANCELLATION
 17987         GO TO 6640-CANCEL-TAX.
 17988
 17989     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17990         COMPUTE PB-I-STATE-TAX ROUNDED =
 17991                                   PB-I-LF-PREMIUM-AMT
 17992                                 * WS-RES-STATE-TAX
 17993         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17994                                   PB-I-LF-PREMIUM-AMT
 17995                                 * WS-RES-MUNI-TAX
 17996     ELSE
 17997     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17998         COMPUTE PB-I-STATE-TAX ROUNDED =
 17999                                   PB-I-AH-PREMIUM-AMT
 18000                                 * WS-RES-STATE-TAX
 18001         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18002                                   PB-I-AH-PREMIUM-AMT
 18003                                 * WS-RES-MUNI-TAX.
 18004
 18005
 18006* EXEC CICS ENDBR
 18007*         DATASET (FILE-ID-ERRESS)
 18008*    END-EXEC.
 18009     MOVE 0
 18010       TO DFHEIV11
 18011*    MOVE '&2                    $   #00017921' TO DFHEIV0
 18012     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18014     MOVE X'2020233030303137393231' TO DFHEIV0(25:11)
 18015     CALL 'kxdfhei1' USING DFHEIV0,
 18016           FILE-ID-ERRESS,
 18017           DFHEIV11,
 18018           DFHEIV99
 18019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18020
 18021
 18022     GO TO 6640-EXIT.
 18023
 18024 6640-CANCEL-TAX.
 18025     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18026
 18027     IF PB-C-LF-CANCEL-AMT > ZEROS
 18028         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18029                                   PB-C-LF-CANCEL-AMT
 18030                                 * WS-RES-STATE-TAX
 18031         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18032                                   PB-C-LF-CANCEL-AMT
 18033                                *  WS-RES-MUNI-TAX
 18034     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 330
* EL050.cbl
 18035     IF PB-C-AH-CANCEL-AMT > ZEROS
 18036         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18037                                   PB-C-AH-CANCEL-AMT
 18038                                 * WS-RES-STATE-TAX
 18039         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18040                                   PB-C-AH-CANCEL-AMT
 18041                                *  WS-RES-MUNI-TAX.
 18042
 18043
 18044* EXEC CICS ENDBR
 18045*         DATASET (FILE-ID-ERRESS)
 18046*    END-EXEC.
 18047     MOVE 0
 18048       TO DFHEIV11
 18049*    MOVE '&2                    $   #00017946' TO DFHEIV0
 18050     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18052     MOVE X'2020233030303137393436' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           FILE-ID-ERRESS,
 18055           DFHEIV11,
 18056           DFHEIV99
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18058
 18059
 18060     GO TO 6640-EXIT.
 18061
 18062 6630-END-OF-FILE.
 18063     MOVE ER-8002              TO WS-ERROR.
 18064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18065
 18066     GO TO 6640-EXIT.
 18067
 18068 6630-ERRESS-PROBLEM.
 18069     MOVE ER-8044              TO WS-ERROR.
 18070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18071
 18072 6640-EXIT.
 18073     EXIT.
 18074
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 331
* EL050.cbl
 18076 6650-GET-RES-STATE-COMM.
 18077
 18078     IF PB-COMPANY-ID NOT = 'DMD'
 18079         GO TO 6700-COMM-EXIT.
 18080
 18081     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18082     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18083     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18084     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18085     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18086     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18087     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18088
 18089*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18090*
 18091***  Y2K PROJ 7744
 18092     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18093     SET BIN-TO-GREG          TO TRUE.
 18094     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18095
 18096     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18097***  Y2K PROJ 7744
 18098
 18099     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18100
 18101
 18102* EXEC CICS HANDLE CONDITION
 18103*        INVREQ    (6660-START-BROWSE)
 18104*        DISABLED  (6690-ERRESC-PROBLEM)
 18105*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18106*        NOTFND    (6690-END-OF-FILE)
 18107*    END-EXEC.
 18108*    MOVE '"$8cJI                ! & #00017991' TO DFHEIV0
 18109     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18111     MOVE X'2620233030303137393931' TO DFHEIV0(25:11)
 18112     CALL 'kxdfhei1' USING DFHEIV0
 18113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18114
 18115
 18116
 18117* EXEC CICS RESETBR
 18118*        DATASET (FILE-ID-ERRESC)
 18119*        RIDFLD  (WS-ERRESC-KEY)
 18120*    END-EXEC.
 18121     MOVE 0
 18122       TO DFHEIV11
 18123*    MOVE '&4         G          &   #00017998' TO DFHEIV0
 18124     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18125     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18126     MOVE X'2020233030303137393938' TO DFHEIV0(25:11)
 18127     CALL 'kxdfhei1' USING DFHEIV0,
 18128           FILE-ID-ERRESC,
 18129           WS-ERRESC-KEY,
 18130           DFHEIV99,
 18131           DFHEIV11,
 18132           DFHEIV99
 18133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 332
* EL050.cbl
 18134
 18135
 18136 6660-START-BROWSE.
 18137
 18138
 18139* EXEC CICS HANDLE CONDITION
 18140*        NOTFND    (6690-END-OF-FILE)
 18141*        DISABLED  (6690-ERRESC-PROBLEM)
 18142*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18143*        ENDFILE   (6690-END-OF-FILE)
 18144*    END-EXEC.
 18145*    MOVE '"$IcJ''                ! '' #00018005' TO DFHEIV0
 18146     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18148     MOVE X'2720233030303138303035' TO DFHEIV0(25:11)
 18149     CALL 'kxdfhei1' USING DFHEIV0
 18150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18151
 18152
 18153
 18154* EXEC CICS STARTBR
 18155*        DATASET (FILE-ID-ERRESC)
 18156*        RIDFLD  (WS-ERRESC-KEY)
 18157*        GTEQ
 18158*    END-EXEC.
 18159     MOVE 0
 18160       TO DFHEIV11
 18161*    MOVE '&,         G          &   #00018012' TO DFHEIV0
 18162     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18163     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18164     MOVE X'2020233030303138303132' TO DFHEIV0(25:11)
 18165     CALL 'kxdfhei1' USING DFHEIV0,
 18166           FILE-ID-ERRESC,
 18167           WS-ERRESC-KEY,
 18168           DFHEIV99,
 18169           DFHEIV11,
 18170           DFHEIV99
 18171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18172
 18173
 18174     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18175
 18176 6670-READ-NEXT-ERRESC-MASTER.
 18177
 18178
 18179* EXEC CICS HANDLE CONDITION
 18180*        NOTFND    (6690-END-OF-FILE)
 18181*        DISABLED  (6690-ERRESC-PROBLEM)
 18182*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18183*        ENDFILE   (6690-END-OF-FILE)
 18184*    END-EXEC.
 18185*    MOVE '"$IcJ''                ! ( #00018022' TO DFHEIV0
 18186     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18188     MOVE X'2820233030303138303232' TO DFHEIV0(25:11)
 18189     CALL 'kxdfhei1' USING DFHEIV0
 18190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18191
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 333
* EL050.cbl
 18192
 18193
 18194* EXEC CICS READNEXT
 18195*        DATASET (FILE-ID-ERRESC)
 18196*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18197*        RIDFLD  (ERRESC-RECORD-KEY)
 18198*    END-EXEC.
 18199     MOVE LENGTH OF
 18200      ACCOUNT-RESIDENT-ST-COMMISSION
 18201       TO DFHEIV12
 18202     MOVE 0
 18203       TO DFHEIV11
 18204*    MOVE '&.IL                  )   #00018029' TO DFHEIV0
 18205     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18206     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18207     MOVE X'2020233030303138303239' TO DFHEIV0(25:11)
 18208     CALL 'kxdfhei1' USING DFHEIV0,
 18209           FILE-ID-ERRESC,
 18210           ACCOUNT-RESIDENT-ST-COMMISSION,
 18211           DFHEIV12,
 18212           ERRESC-RECORD-KEY,
 18213           DFHEIV99,
 18214           DFHEIV11,
 18215           DFHEIV99,
 18216           DFHEIV99
 18217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18218
 18219
 18220     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18221        NEXT SENTENCE
 18222     ELSE
 18223
 18224* EXEC CICS ENDBR
 18225*            DATASET (FILE-ID-ERRESC)
 18226*       END-EXEC
 18227     MOVE 0
 18228       TO DFHEIV11
 18229*    MOVE '&2                    $   #00018038' TO DFHEIV0
 18230     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18232     MOVE X'2020233030303138303338' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0,
 18234           FILE-ID-ERRESC,
 18235           DFHEIV11,
 18236           DFHEIV99
 18237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18238        GO TO 6690-END-OF-FILE.
 18239
 18240     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18241
 18242* EXEC CICS ENDBR
 18243*            DATASET (FILE-ID-ERRESC)
 18244*       END-EXEC
 18245     MOVE 0
 18246       TO DFHEIV11
 18247*    MOVE '&2                    $   #00018044' TO DFHEIV0
 18248     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18249     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 334
* EL050.cbl
 18250     MOVE X'2020233030303138303434' TO DFHEIV0(25:11)
 18251     CALL 'kxdfhei1' USING DFHEIV0,
 18252           FILE-ID-ERRESC,
 18253           DFHEIV11,
 18254           DFHEIV99
 18255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18256        GO TO 6690-END-OF-FILE.
 18257
 18258     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18259        NEXT SENTENCE
 18260      ELSE
 18261        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18262
 18263* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18264*
 18265     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18266
 18267     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18268
 18269     IF WS-SUB1 > ZERO
 18270         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18271             PERFORM 6680-SET-COMMISSION
 18272         ELSE
 18273             PERFORM 6680-SET-TABLE-CODE.
 18274
 18275
 18276* EXEC CICS ENDBR
 18277*         DATASET (FILE-ID-ERRESC)
 18278*    END-EXEC.
 18279     MOVE 0
 18280       TO DFHEIV11
 18281*    MOVE '&2                    $   #00018066' TO DFHEIV0
 18282     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18284     MOVE X'2020233030303138303636' TO DFHEIV0(25:11)
 18285     CALL 'kxdfhei1' USING DFHEIV0,
 18286           FILE-ID-ERRESC,
 18287           DFHEIV11,
 18288           DFHEIV99
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18290
 18291
 18292     GO TO 6700-COMM-EXIT.
 18293
 18294 6680-SET-TABLE-CODE.
 18295     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18296        MOVE ZEROS             TO WS-SUB1
 18297     ELSE
 18298* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18299* TO COMPUTE AH COMMISSION.
 18300        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18301        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18302        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18303        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18304        PERFORM 6680-READ-CTBL-TABLE
 18305        IF WS-CTBL-READ-SW NOT = 'Y'
 18306           MOVE ZEROS          TO WS-SUB1.
 18307
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 335
* EL050.cbl
 18308 6680-READ-CTBL-TABLE.
 18309*
 18310* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18311* TO COMPUTE LIFE COMMISSION
 18312
 18313     IF CTBL-SW = '0540'
 18314        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18315        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18316        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18317
 18318     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18319
 18320     IF CTBL-TABLE-FOUND
 18321        IF CTBL-SW = '0530'
 18322             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18323                                    * PB-I-AH-TERM
 18324             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18325             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18326        ELSE
 18327             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18328             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18329             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18330     ELSE
 18331        IF FIRST-TIME-THROUGH
 18332            GO TO 6680-READ-CTBL-TABLE
 18333        ELSE
 18334            MOVE ZEROS         TO WS-SUB1.
 18335
 18336 6680-SET-COMMISSION.
 18337     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18338           MOVE ZEROS          TO WS-SUB1
 18339       ELSE
 18340           MOVE RESC-COMMISSION-PER (WS-SUB)
 18341                               TO WS-COMMISSION
 18342           IF CTBL-SW = '0530'
 18343               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18344           ELSE
 18345               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18346
 18347 6680-SEARCH-CATEGORY.
 18348     ADD +1                   TO WS-SUB.
 18349     IF WS-SUB > +12
 18350         GO TO 6680-EXIT.
 18351
 18352     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18353          MOVE WS-SUB         TO WS-SUB1
 18354          GO TO 6680-EXIT.
 18355
 18356     GO TO 6680-SEARCH-CATEGORY.
 18357
 18358 6680-EXIT.
 18359     EXIT.
 18360
 18361 6690-END-OF-FILE.
 18362     GO TO 6700-COMM-EXIT.
 18363
 18364 6690-ERRESC-PROBLEM.
 18365      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 336
* EL050.cbl
 18366      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18367
 18368      GO TO 6700-COMM-EXIT.
 18369
 18370 6700-COMM-EXIT.
 18371     EXIT.
 18372
 18373 7000-GET-RATE.
 18374
 18375* EXEC CICS LINK
 18376*        PROGRAM    ('ELRATE')
 18377*        COMMAREA   (CALCULATION-PASS-AREA)
 18378*        LENGTH     (CP-COMM-LENGTH)
 18379*    END-EXEC.
 18380     MOVE 'ELRATE' TO DFHEIV1
 18381*    MOVE '."C                   (   #00018152' TO DFHEIV0
 18382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18384     MOVE X'2020233030303138313532' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0,
 18386           DFHEIV1,
 18387           CALCULATION-PASS-AREA,
 18388           CP-COMM-LENGTH,
 18389           DFHEIV99,
 18390           DFHEIV99,
 18391           DFHEIV99,
 18392           DFHEIV99
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18394
 18395
 18396 7000-EXIT.
 18397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 337
* EL050.cbl
 18399 7100-FIND-BENEFIT-IN-STATE.
 18400     MOVE 'N'                    TO BEN-SEARCH-SW.
 18401
 18402     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18403         VARYING SUB3 FROM 1 BY 1 UNTIL
 18404            ((SUB3 GREATER 50) OR
 18405              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18406               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18407
 18408     IF SUB3 NOT = 51
 18409         MOVE 'Y'                TO BEN-SEARCH-SW.
 18410
 18411     GO TO 7199-EXIT.
 18412
 18413 7100-BENEFIT-DUMMY.
 18414
 18415 7100-DUMMY-EXIT.
 18416     EXIT.
 18417
 18418 7199-EXIT.
 18419     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 338
* EL050.cbl
 18421 7200-FIND-BENEFIT.
 18422     MOVE 'N'                    TO BEN-SEARCH-SW.
 18423
 18424     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18425         VARYING SUB3 FROM 1 BY 1 UNTIL
 18426            ((SUB3 GREATER 8) OR
 18427            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18428
 18429     IF SUB3 NOT = 9
 18430         MOVE 'Y'                TO BEN-SEARCH-SW.
 18431
 18432     GO TO 7200-EXIT.
 18433
 18434 7200-BENEFIT-DUMMY.
 18435
 18436 7200-DUMMY-EXIT.
 18437     EXIT.
 18438
 18439 7200-EXIT.
 18440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 339
* EL050.cbl
 18442 7250-LOOK-FOR-RESCINDED-CLAIM.
 18443     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18444                                    W-CL-COMP-CD.
 18445     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18446                                    W-CL-CERT-NO.
 18447
 18448
 18449* EXEC CICS HANDLE CONDITION
 18450*        NOTFND  (7250-CONTINUE)
 18451*        ENDFILE (7250-CONTINUE)
 18452*    END-EXEC.
 18453*    MOVE '"$I''                  ! ) #00018210' TO DFHEIV0
 18454     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18456     MOVE X'2920233030303138323130' TO DFHEIV0(25:11)
 18457     CALL 'kxdfhei1' USING DFHEIV0
 18458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18459
 18460
 18461
 18462* EXEC CICS IGNORE CONDITION
 18463*        DUPKEY
 18464*    END-EXEC.
 18465*    MOVE '"*$                   !   #00018215' TO DFHEIV0
 18466     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18468     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 18469     CALL 'kxdfhei1' USING DFHEIV0
 18470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18471
 18472
 18473
 18474* EXEC CICS STARTBR
 18475*        DATASET   (CLMS-ID)
 18476*        RIDFLD    (ELMSTR-KEY)
 18477*        GENERIC   EQUAL
 18478*        KEYLENGTH (ELMSTR-LENGTH)
 18479*    END-EXEC.
 18480     MOVE 0
 18481       TO DFHEIV11
 18482*    MOVE '&,   KG    E          &   #00018219' TO DFHEIV0
 18483     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18485     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 18486     CALL 'kxdfhei1' USING DFHEIV0,
 18487           CLMS-ID,
 18488           ELMSTR-KEY,
 18489           ELMSTR-LENGTH,
 18490           DFHEIV11,
 18491           DFHEIV99
 18492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18493
 18494
 18495     MOVE 'Y'                    TO W-BROWSE-SW.
 18496
 18497 7250-NEXT-CLAIM.
 18498
 18499
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 340
* EL050.cbl
 18500* EXEC CICS READNEXT
 18501*        DATASET   (CLMS-ID)
 18502*        RIDFLD    (ELMSTR-KEY)
 18503*        SET       (ADDRESS OF CLAIM-MASTER)
 18504*    END-EXEC.
 18505     MOVE 0
 18506       TO DFHEIV11
 18507*    MOVE '&.S                   )   #00018230' TO DFHEIV0
 18508     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18509     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18510     MOVE X'2020233030303138323330' TO DFHEIV0(25:11)
 18511     CALL 'kxdfhei1' USING DFHEIV0,
 18512           CLMS-ID,
 18513           DFHEIV20,
 18514           DFHEIV99,
 18515           ELMSTR-KEY,
 18516           DFHEIV99,
 18517           DFHEIV11,
 18518           DFHEIV99,
 18519           DFHEIV99
 18520     SET ADDRESS OF CLAIM-MASTER TO
 18521         DFHEIV20
 18522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18523
 18524
 18525     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18526        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18527         GO TO 7250-CONTINUE
 18528     END-IF.
 18529
 18530     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18531        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18532        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18533        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18534        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18535         GO TO 7250-NEXT-CLAIM
 18536     END-IF.
 18537
 18538     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18539        OR (CL-CLAIM-TYPE = 'I')
 18540        OR (CL-CLAIM-TYPE = 'G')
 18541          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18542              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18543              GO TO 7250-CONTINUE
 18544          END-IF
 18545     END-IF.
 18546
 18547     GO TO 7250-NEXT-CLAIM.
 18548
 18549 7250-CONTINUE.
 18550
 18551     IF W-BROWSE-SW = 'Y'
 18552
 18553* EXEC CICS ENDBR
 18554*            DATASET   (CLMS-ID)
 18555*        END-EXEC
 18556     MOVE 0
 18557       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 341
* EL050.cbl
 18558*    MOVE '&2                    $   #00018263' TO DFHEIV0
 18559     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18561     MOVE X'2020233030303138323633' TO DFHEIV0(25:11)
 18562     CALL 'kxdfhei1' USING DFHEIV0,
 18563           CLMS-ID,
 18564           DFHEIV11,
 18565           DFHEIV99
 18566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18567         MOVE 'N' TO W-BROWSE-SW
 18568     END-IF.
 18569
 18570 7250-EXIT.
 18571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 342
* EL050.cbl
 18573 7300-CHECK-FOR-OPEN-CLMS.
 18574
 18575*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18576*    MOVE SPACES                 TO CNTL-ACCESS.
 18577*    MOVE '1'                    TO CNTL-REC-TYPE.
 18578*    MOVE +0                     TO CNTL-SEQ-NO.
 18579
 18580*    MOVE '3'                    TO RC-SW-1.
 18581*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18582
 18583*    IF NOT CF-COMPANY-MASTER
 18584*         PERFORM 0099-COMPANY-NOT-FOUND
 18585*         GO TO 7300-EXIT.
 18586
 18587     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18588                                    W-CL-COMP-CD.
 18589     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18590                                    W-CL-CERT-NO.
 18591
 18592
 18593* EXEC CICS HANDLE CONDITION
 18594*        NOTFND  (7300-CONTINUE)
 18595*        ENDFILE (7300-CONTINUE)
 18596*    END-EXEC.
 18597*    MOVE '"$I''                  ! * #00018291' TO DFHEIV0
 18598     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18600     MOVE X'2A20233030303138323931' TO DFHEIV0(25:11)
 18601     CALL 'kxdfhei1' USING DFHEIV0
 18602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18603
 18604
 18605
 18606* EXEC CICS IGNORE CONDITION
 18607*        DUPKEY
 18608*    END-EXEC.
 18609*    MOVE '"*$                   !   #00018296' TO DFHEIV0
 18610     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18612     MOVE X'2020233030303138323936' TO DFHEIV0(25:11)
 18613     CALL 'kxdfhei1' USING DFHEIV0
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617
 18618* EXEC CICS STARTBR
 18619*        DATASET   (CLMS-ID)
 18620*        RIDFLD    (ELMSTR-KEY)
 18621*        GENERIC   EQUAL
 18622*        KEYLENGTH (ELMSTR-LENGTH)
 18623*    END-EXEC.
 18624     MOVE 0
 18625       TO DFHEIV11
 18626*    MOVE '&,   KG    E          &   #00018300' TO DFHEIV0
 18627     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18628     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18629     MOVE X'2020233030303138333030' TO DFHEIV0(25:11)
 18630     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 343
* EL050.cbl
 18631           CLMS-ID,
 18632           ELMSTR-KEY,
 18633           ELMSTR-LENGTH,
 18634           DFHEIV11,
 18635           DFHEIV99
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638
 18639     MOVE 'Y'                    TO W-BROWSE-SW.
 18640
 18641 7300-NEXT-CLAIM.
 18642
 18643
 18644* EXEC CICS READNEXT
 18645*        DATASET   (CLMS-ID)
 18646*        RIDFLD    (ELMSTR-KEY)
 18647*        SET       (ADDRESS OF CLAIM-MASTER)
 18648*    END-EXEC.
 18649     MOVE 0
 18650       TO DFHEIV11
 18651*    MOVE '&.S                   )   #00018311' TO DFHEIV0
 18652     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18654     MOVE X'2020233030303138333131' TO DFHEIV0(25:11)
 18655     CALL 'kxdfhei1' USING DFHEIV0,
 18656           CLMS-ID,
 18657           DFHEIV20,
 18658           DFHEIV99,
 18659           ELMSTR-KEY,
 18660           DFHEIV99,
 18661           DFHEIV11,
 18662           DFHEIV99,
 18663           DFHEIV99
 18664     SET ADDRESS OF CLAIM-MASTER TO
 18665         DFHEIV20
 18666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18667
 18668
 18669     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18670        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18671         GO TO 7300-CONTINUE.
 18672
 18673     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18674        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18675        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18676        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18677        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18678         GO TO 7300-NEXT-CLAIM.
 18679
 18680*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18681     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18682        OR (CL-CLAIM-TYPE = 'I')
 18683        OR (CL-CLAIM-TYPE = 'G')
 18684        IF CLAIM-IS-OPEN
 18685           EVALUATE TRUE
 18686             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18687                 MOVE ER-2884      TO WS-ERROR
 18688             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 344
* EL050.cbl
 18689                 MOVE ER-2887      TO WS-ERROR
 18690             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18691                 MOVE ER-2886      TO WS-ERROR
 18692             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18693                 MOVE ER-2888      TO WS-ERROR
 18694             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18695                 MOVE ER-2885      TO WS-ERROR
 18696             WHEN OTHER
 18697                 MOVE ER-2768      TO WS-ERROR
 18698           END-EVALUATE
 18699           IF PB-C-AH-CANCEL-VOIDED OR
 18700              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18701                NOT AH-COVERAGE-CANCELLED)
 18702               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18703               MOVE ER-2768      TO WS-ERROR
 18704           END-IF
 18705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18706           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18707              PB-FORCE-CODE NOT EQUAL '8'
 18708               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18709           END-IF
 18710           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18711           GO TO 7300-CONTINUE
 18712        ELSE
 18713           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18714*****THIS IS A RESCISSION OR REFORMATION
 18715              IF (AH-COVERAGE-CANCELLED AND
 18716                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18717                    MOVE ER-2890 TO WS-ERROR
 18718                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18719                    GO TO 7300-CONTINUE
 18720              END-IF
 18721           ELSE
 18722              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18723               AND PB-C-AH-CANCEL-DT > SPACES
 18724                 MOVE ER-2756        TO WS-ERROR
 18725                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18726                 GO TO 7300-CONTINUE
 18727              END-IF
 18728           END-IF
 18729        END-IF
 18730     ELSE
 18731*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18732        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18733           IF CLAIM-IS-OPEN
 18734              MOVE ER-2889      TO WS-ERROR
 18735              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18736              GO TO 7300-CONTINUE
 18737           ELSE
 18738              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18739*****THIS IS A RESCISSION OR REFORMATION
 18740                 IF (LF-COVERAGE-CANCELLED AND
 18741                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18742                       MOVE ER-2890 TO WS-ERROR
 18743                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18744                       GO TO 7300-CONTINUE
 18745                 END-IF
 18746              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 345
* EL050.cbl
 18747                 IF (AH-COVERAGE-CANCELLED AND
 18748                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18749                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18750                    (LF-COVERAGE-CANCELLED AND
 18751                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18752                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18753                       MOVE ER-2965 TO WS-ERROR
 18754                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18755                       GO TO 7300-CONTINUE
 18756                 END-IF
 18757                 IF LF-COVERAGE-CANCELLED
 18758                  IF CL-TOTAL-PAID-AMT > 0
 18759                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18760                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18761                        MOVE ER-2891 TO WS-ERROR
 18762                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18763                        GO TO 7300-CONTINUE
 18764                      END-IF
 18765                    ELSE
 18766                      MOVE ER-2892 TO WS-ERROR
 18767                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18768                      GO TO 7300-CONTINUE
 18769                    END-IF
 18770                  END-IF
 18771                 END-IF
 18772              END-IF
 18773           END-IF
 18774        END-IF
 18775     END-IF
 18776
 18777     GO TO 7300-NEXT-CLAIM.
 18778
 18779 7300-CONTINUE.
 18780
 18781     IF W-BROWSE-SW = 'Y'
 18782
 18783* EXEC CICS ENDBR
 18784*            DATASET   (CLMS-ID)
 18785*        END-EXEC.
 18786     MOVE 0
 18787       TO DFHEIV11
 18788*    MOVE '&2                    $   #00018430' TO DFHEIV0
 18789     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18791     MOVE X'2020233030303138343330' TO DFHEIV0(25:11)
 18792     CALL 'kxdfhei1' USING DFHEIV0,
 18793           CLMS-ID,
 18794           DFHEIV11,
 18795           DFHEIV99
 18796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18797
 18798
 18799 7300-EXIT.
 18800     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 346
* EL050.cbl
 18802
 18803 7400-GET-REMAIN-TERM.
 18804
 18805* EXEC CICS LINK
 18806*        PROGRAM    ('ELRTRM')
 18807*        COMMAREA   (CALCULATION-PASS-AREA)
 18808*        LENGTH     (CP-COMM-LENGTH)
 18809*    END-EXEC.
 18810     MOVE 'ELRTRM' TO DFHEIV1
 18811*    MOVE '."C                   (   #00018439' TO DFHEIV0
 18812     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18814     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 18815     CALL 'kxdfhei1' USING DFHEIV0,
 18816           DFHEIV1,
 18817           CALCULATION-PASS-AREA,
 18818           CP-COMM-LENGTH,
 18819           DFHEIV99,
 18820           DFHEIV99,
 18821           DFHEIV99,
 18822           DFHEIV99
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18824
 18825
 18826 7400-EXIT.
 18827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 347
* EL050.cbl
 18829
 18830 7500-GET-REMAIN-AMOUNT.
 18831
 18832* EXEC CICS LINK
 18833*        PROGRAM    ('ELRAMT')
 18834*        COMMAREA   (CALCULATION-PASS-AREA)
 18835*        LENGTH     (CP-COMM-LENGTH)
 18836*    END-EXEC.
 18837     MOVE 'ELRAMT' TO DFHEIV1
 18838*    MOVE '."C                   (   #00018450' TO DFHEIV0
 18839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18841     MOVE X'2020233030303138343530' TO DFHEIV0(25:11)
 18842     CALL 'kxdfhei1' USING DFHEIV0,
 18843           DFHEIV1,
 18844           CALCULATION-PASS-AREA,
 18845           CP-COMM-LENGTH,
 18846           DFHEIV99,
 18847           DFHEIV99,
 18848           DFHEIV99,
 18849           DFHEIV99
 18850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18851
 18852
 18853 7500-EXIT.
 18854     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 348
* EL050.cbl
 18856
 18857 7600-GET-REFUND.
 18858
 18859* EXEC CICS LINK
 18860*        PROGRAM    ('ELRFND')
 18861*        COMMAREA   (CALCULATION-PASS-AREA)
 18862*        LENGTH     (CP-COMM-LENGTH)
 18863*    END-EXEC.
 18864     MOVE 'ELRFND' TO DFHEIV1
 18865*    MOVE '."C                   (   #00018461' TO DFHEIV0
 18866     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18868     MOVE X'2020233030303138343631' TO DFHEIV0(25:11)
 18869     CALL 'kxdfhei1' USING DFHEIV0,
 18870           DFHEIV1,
 18871           CALCULATION-PASS-AREA,
 18872           CP-COMM-LENGTH,
 18873           DFHEIV99,
 18874           DFHEIV99,
 18875           DFHEIV99,
 18876           DFHEIV99
 18877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18878
 18879
 18880 7600-EXIT.
 18881     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 349
* EL050.cbl
 18883 7700-CALL-DL1.
 18884
 18885* EXEC CICS LINK
 18886*        PROGRAM    ('DLO001')
 18887*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18888*        LENGTH     (DLO001-COMM-LENGTH)
 18889*    END-EXEC.
 18890     MOVE 'DLO001' TO DFHEIV1
 18891*    MOVE '."C                   (   #00018471' TO DFHEIV0
 18892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18894     MOVE X'2020233030303138343731' TO DFHEIV0(25:11)
 18895     CALL 'kxdfhei1' USING DFHEIV0,
 18896           DFHEIV1,
 18897           WS-DLO-MASTER-POLICY-FORM,
 18898           DLO001-COMM-LENGTH,
 18899           DFHEIV99,
 18900           DFHEIV99,
 18901           DFHEIV99,
 18902           DFHEIV99
 18903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18904
 18905
 18906 7700-EXIT.
 18907     EXIT.
 18908
 18909 7710-CALL-DL2.
 18910
 18911* EXEC CICS LINK
 18912*        PROGRAM    ('DLO002')
 18913*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18914*        LENGTH     (DLO002-COMM-LENGTH)
 18915*    END-EXEC.
 18916     MOVE 'DLO002' TO DFHEIV1
 18917*    MOVE '."C                   (   #00018481' TO DFHEIV0
 18918     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18920     MOVE X'2020233030303138343831' TO DFHEIV0(25:11)
 18921     CALL 'kxdfhei1' USING DFHEIV0,
 18922           DFHEIV1,
 18923           WS-DLO-INTERNAL-POLICY-FORM,
 18924           DLO002-COMM-LENGTH,
 18925           DFHEIV99,
 18926           DFHEIV99,
 18927           DFHEIV99,
 18928           DFHEIV99
 18929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18930
 18931
 18932 7710-EXIT.
 18933     EXIT.
 18934
 18935 7720-CALL-DL3.
 18936
 18937* EXEC CICS LINK
 18938*        PROGRAM    ('DLO003')
 18939*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18940*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 350
* EL050.cbl
 18941*    END-EXEC.
 18942     MOVE 'DLO003' TO DFHEIV1
 18943*    MOVE '."C                   (   #00018491' TO DFHEIV0
 18944     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18946     MOVE X'2020233030303138343931' TO DFHEIV0(25:11)
 18947     CALL 'kxdfhei1' USING DFHEIV0,
 18948           DFHEIV1,
 18949           WS-DLO-VALID-BANK-ID,
 18950           DLO003-COMM-LENGTH,
 18951           DFHEIV99,
 18952           DFHEIV99,
 18953           DFHEIV99,
 18954           DFHEIV99
 18955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18956
 18957
 18958 7720-EXIT.
 18959     EXIT.
 18960
 18961 7730-CALL-DL7.
 18962
 18963* EXEC CICS LINK
 18964*        PROGRAM    ('DLO007')
 18965*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18966*        LENGTH     (DLO007-COMM-LENGTH)
 18967*    END-EXEC.
 18968     MOVE 'DLO007' TO DFHEIV1
 18969*    MOVE '."C                   (   #00018501' TO DFHEIV0
 18970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18972     MOVE X'2020233030303138353031' TO DFHEIV0(25:11)
 18973     CALL 'kxdfhei1' USING DFHEIV0,
 18974           DFHEIV1,
 18975           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18976           DLO007-COMM-LENGTH,
 18977           DFHEIV99,
 18978           DFHEIV99,
 18979           DFHEIV99,
 18980           DFHEIV99
 18981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18982
 18983
 18984 7730-EXIT.
 18985     EXIT.
 18986
 18987 7740-CALL-DL11.
 18988
 18989* EXEC CICS LINK
 18990*        PROGRAM    ('DLO011')
 18991*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18992*        LENGTH     (DLO011-COMM-LENGTH)
 18993*    END-EXEC.
 18994     MOVE 'DLO011' TO DFHEIV1
 18995*    MOVE '."C                   (   #00018511' TO DFHEIV0
 18996     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18998     MOVE X'2020233030303138353131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 351
* EL050.cbl
 18999     CALL 'kxdfhei1' USING DFHEIV0,
 19000           DFHEIV1,
 19001           WS-DLO-PREM-RATES-BEN-TYPE,
 19002           DLO011-COMM-LENGTH,
 19003           DFHEIV99,
 19004           DFHEIV99,
 19005           DFHEIV99,
 19006           DFHEIV99
 19007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19008
 19009
 19010 7740-EXIT.
 19011     EXIT.
 19012
 19013 7750-CALL-DL17.
 19014
 19015* EXEC CICS LINK
 19016*        PROGRAM    ('DLO017')
 19017*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19018*        LENGTH     (DLO017-COMM-LENGTH)
 19019*    END-EXEC.
 19020     MOVE 'DLO017' TO DFHEIV1
 19021*    MOVE '."C                   (   #00018521' TO DFHEIV0
 19022     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303138353231' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0,
 19026           DFHEIV1,
 19027           WS-DLO-VALID-RATE-CODE,
 19028           DLO017-COMM-LENGTH,
 19029           DFHEIV99,
 19030           DFHEIV99,
 19031           DFHEIV99,
 19032           DFHEIV99
 19033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19034
 19035
 19036 7750-EXIT.
 19037     EXIT.
 19038
 19039 7755-CALL-DL19.
 19040
 19041* EXEC CICS LINK
 19042*        PROGRAM    ('DLO019')
 19043*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19044*        LENGTH     (DLO019-COMM-LENGTH)
 19045*    END-EXEC.
 19046     MOVE 'DLO019' TO DFHEIV1
 19047*    MOVE '."C                   (   #00018531' TO DFHEIV0
 19048     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19050     MOVE X'2020233030303138353331' TO DFHEIV0(25:11)
 19051     CALL 'kxdfhei1' USING DFHEIV0,
 19052           DFHEIV1,
 19053           WS-DLO-ORIG-COV-CAT,
 19054           DLO019-COMM-LENGTH,
 19055           DFHEIV99,
 19056           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 352
* EL050.cbl
 19057           DFHEIV99,
 19058           DFHEIV99
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062 7755-EXIT.
 19063     EXIT.
 19064
 19065 7760-CALL-DL21.
 19066
 19067* EXEC CICS LINK
 19068*        PROGRAM    ('DLO021')
 19069*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19070*        LENGTH     (DLO021-COMM-LENGTH)
 19071*    END-EXEC.
 19072     MOVE 'DLO021' TO DFHEIV1
 19073*    MOVE '."C                   (   #00018541' TO DFHEIV0
 19074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138353431' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           DFHEIV1,
 19079           WS-DLO-VALID-LOAN-OFFICER,
 19080           DLO021-COMM-LENGTH,
 19081           DFHEIV99,
 19082           DFHEIV99,
 19083           DFHEIV99,
 19084           DFHEIV99
 19085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19086
 19087
 19088 7760-EXIT.
 19089     EXIT.
 19090
 19091 7770-CALL-DL22.
 19092
 19093* EXEC CICS LINK
 19094*        PROGRAM    ('DLO022')
 19095*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19096*        LENGTH     (DLO022-COMM-LENGTH)
 19097*    END-EXEC.
 19098     MOVE 'DLO022' TO DFHEIV1
 19099*    MOVE '."C                   (   #00018551' TO DFHEIV0
 19100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19102     MOVE X'2020233030303138353531' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0,
 19104           DFHEIV1,
 19105           WS-DLO-VALID-STATE-CODE,
 19106           DLO022-COMM-LENGTH,
 19107           DFHEIV99,
 19108           DFHEIV99,
 19109           DFHEIV99,
 19110           DFHEIV99
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 353
* EL050.cbl
 19115     EXIT.
 19116
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 354
* EL050.cbl
 19118
 19119 7800-REWRITE-CERT.
 19120******************************************************************
 19121*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19122*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19123******************************************************************
 19124
 19125     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19126        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19127        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19128        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19129
 19130* EXEC CICS REWRITE
 19131*                  DATASET (CERT-ID)
 19132*                  FROM    (CERTIFICATE-MASTER)
 19133*              END-EXEC
 19134     MOVE LENGTH OF
 19135      CERTIFICATE-MASTER
 19136       TO DFHEIV11
 19137*    MOVE '&& L                  %   #00018572' TO DFHEIV0
 19138     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19139     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19140     MOVE X'2020233030303138353732' TO DFHEIV0(25:11)
 19141     CALL 'kxdfhei1' USING DFHEIV0,
 19142           CERT-ID,
 19143           CERTIFICATE-MASTER,
 19144           DFHEIV11,
 19145           DFHEIV99
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19147        GO TO 7800-EXIT.
 19148
 19149       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19150       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19151
 19152 7800-EXIT.
 19153      EXIT.
 19154
 19155 7900-DELETE-CERT.
 19156
 19157* EXEC CICS DELETE
 19158*        DATASET (CERT-ID)
 19159*    END-EXEC.
 19160*    MOVE '&(                    &   #00018585' TO DFHEIV0
 19161     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19162     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19163     MOVE X'2020233030303138353835' TO DFHEIV0(25:11)
 19164     CALL 'kxdfhei1' USING DFHEIV0,
 19165           CERT-ID,
 19166           DFHEIV99,
 19167           DFHEIV99,
 19168           DFHEIV99,
 19169           DFHEIV99
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173 7900-EXIT.
 19174     EXIT.
 19175
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 355
* EL050.cbl
 19176 8000-WRITE-CERT.
 19177
 19178* EXEC CICS HANDLE CONDITION
 19179*        DUPKEY    (8000-FREE-MAIN)
 19180*    END-EXEC.
 19181*    MOVE '"$$                   ! + #00018593' TO DFHEIV0
 19182     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19184     MOVE X'2B20233030303138353933' TO DFHEIV0(25:11)
 19185     CALL 'kxdfhei1' USING DFHEIV0
 19186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19187
 19188
 19189
 19190* EXEC CICS WRITE
 19191*        DATASET     (CERT-ID)
 19192*        FROM        (CERTIFICATE-MASTER)
 19193*        RIDFLD      (ELCERT-KEY)
 19194*    END-EXEC.
 19195     MOVE LENGTH OF
 19196      CERTIFICATE-MASTER
 19197       TO DFHEIV11
 19198*    MOVE '&$ L                  ''   #00018597' TO DFHEIV0
 19199     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303138353937' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0,
 19203           CERT-ID,
 19204           CERTIFICATE-MASTER,
 19205           DFHEIV11,
 19206           ELCERT-KEY,
 19207           DFHEIV99,
 19208           DFHEIV99
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212 8000-FREE-MAIN.
 19213
 19214 8000-EXIT.
 19215      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 356
* EL050.cbl
 19217
 19218 8100-READ-ERPNDM.
 19219
 19220* EXEC CICS HANDLE CONDITION
 19221*         NOTFND     (8100-NOTFND)
 19222*         ENDFILE    (8100-NOTFND)
 19223*    END-EXEC.
 19224*    MOVE '"$I''                  ! , #00018610' TO DFHEIV0
 19225     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19227     MOVE X'2C20233030303138363130' TO DFHEIV0(25:11)
 19228     CALL 'kxdfhei1' USING DFHEIV0
 19229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19230
 19231
 19232     MOVE SPACES                 TO ERPNDM-FOUND.
 19233     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19234
 19235
 19236* EXEC CICS READ
 19237*         DATASET   (FILE-ERPNDM)
 19238*         RIDFLD    (PM-CONTROL-PRIMARY)
 19239*         INTO      (PENDING-MAILING-DATA)
 19240*    END-EXEC.
 19241     MOVE LENGTH OF
 19242      PENDING-MAILING-DATA
 19243       TO DFHEIV11
 19244*    MOVE '&"IL       E          (   #00018618' TO DFHEIV0
 19245     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19247     MOVE X'2020233030303138363138' TO DFHEIV0(25:11)
 19248     CALL 'kxdfhei1' USING DFHEIV0,
 19249           FILE-ERPNDM,
 19250           PENDING-MAILING-DATA,
 19251           DFHEIV11,
 19252           PM-CONTROL-PRIMARY,
 19253           DFHEIV99,
 19254           DFHEIV99,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259     GO TO 8100-EXIT.
 19260
 19261 8100-NOTFND.
 19262
 19263     MOVE 'X'                    TO ERPNDM-FOUND.
 19264     MOVE ER-2694                TO WS-ERROR.
 19265     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19266     MOVE ER-2883                TO WS-ERROR
 19267     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19268     .
 19269 8100-EXIT.
 19270     EXIT.
 19271
 19272 8110-READ-ERMAIL.
 19273
 19274* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 357
* EL050.cbl
 19275*         NOTFND     (8110-NOTFND)
 19276*         ENDFILE    (8110-NOTFND)
 19277*    END-EXEC.
 19278*    MOVE '"$I''                  ! - #00018638' TO DFHEIV0
 19279     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19281     MOVE X'2D20233030303138363338' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286     MOVE SPACES                 TO ERMAIL-FOUND.
 19287     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19288     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19289     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19290     MOVE PB-SV-STATE            TO MA-STATE.
 19291
 19292
 19293* EXEC CICS READ
 19294*         UPDATE
 19295*         DATASET   (FILE-ERMAIL)
 19296*         RIDFLD    (MA-CONTROL-PRIMARY)
 19297*         INTO      (MAILING-DATA)
 19298*    END-EXEC.
 19299     MOVE LENGTH OF
 19300      MAILING-DATA
 19301       TO DFHEIV11
 19302*    MOVE '&"IL       EU         (   #00018649' TO DFHEIV0
 19303     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19304     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19305     MOVE X'2020233030303138363439' TO DFHEIV0(25:11)
 19306     CALL 'kxdfhei1' USING DFHEIV0,
 19307           FILE-ERMAIL,
 19308           MAILING-DATA,
 19309           DFHEIV11,
 19310           MA-CONTROL-PRIMARY,
 19311           DFHEIV99,
 19312           DFHEIV99,
 19313           DFHEIV99
 19314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19315
 19316
 19317     GO TO 8110-EXIT.
 19318
 19319 8110-NOTFND.
 19320     MOVE 'X'                    TO ERMAIL-FOUND.
 19321
 19322 8110-EXIT.
 19323     EXIT.
 19324
 19325 8120-REWRITE-ERMAIL.
 19326
 19327* EXEC CICS REWRITE
 19328*         DATASET    (FILE-ERMAIL)
 19329*         FROM       (MAILING-DATA)
 19330*    END-EXEC.
 19331     MOVE LENGTH OF
 19332      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 358
* EL050.cbl
 19333       TO DFHEIV11
 19334*    MOVE '&& L                  %   #00018665' TO DFHEIV0
 19335     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19337     MOVE X'2020233030303138363635' TO DFHEIV0(25:11)
 19338     CALL 'kxdfhei1' USING DFHEIV0,
 19339           FILE-ERMAIL,
 19340           MAILING-DATA,
 19341           DFHEIV11,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346 8120-EXIT.
 19347     EXIT.
 19348
 19349 8130-WRITE-ERMAIL.
 19350
 19351* EXEC CICS HANDLE CONDITION
 19352*         DUPKEY   (8130-EXIT)
 19353*    END-EXEC.
 19354*    MOVE '"$$                   ! . #00018674' TO DFHEIV0
 19355     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19357     MOVE X'2E20233030303138363734' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0
 19359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19360
 19361
 19362
 19363* EXEC CICS WRITE
 19364*         DATASET     (FILE-ERMAIL)
 19365*         RIDFLD      (MA-CONTROL-PRIMARY)
 19366*         FROM        (MAILING-DATA)
 19367*    END-EXEC.
 19368     MOVE LENGTH OF
 19369      MAILING-DATA
 19370       TO DFHEIV11
 19371*    MOVE '&$ L                  ''   #00018678' TO DFHEIV0
 19372     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19374     MOVE X'2020233030303138363738' TO DFHEIV0(25:11)
 19375     CALL 'kxdfhei1' USING DFHEIV0,
 19376           FILE-ERMAIL,
 19377           MAILING-DATA,
 19378           DFHEIV11,
 19379           MA-CONTROL-PRIMARY,
 19380           DFHEIV99,
 19381           DFHEIV99
 19382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19383
 19384
 19385 8130-EXIT.
 19386     EXIT.
 19387
 19388 8140-UNLOCK-ERMAIL.
 19389
 19390* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 359
* EL050.cbl
 19391*         DATASET   (FILE-ERMAIL)
 19392*    END-EXEC.
 19393*    MOVE '&*                    #   #00018688' TO DFHEIV0
 19394     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19395     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19396     MOVE X'2020233030303138363838' TO DFHEIV0(25:11)
 19397     CALL 'kxdfhei1' USING DFHEIV0,
 19398           FILE-ERMAIL,
 19399           DFHEIV99
 19400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19401
 19402
 19403 8140-EXIT.
 19404     EXIT.
 19405
 19406 8180-UPDATE-VIN-NUMBER.
 19407
 19408* EXEC CICS HANDLE CONDITION
 19409*        NOTFND   (8180-NOTFND)
 19410*    END-EXEC.
 19411*    MOVE '"$I                   ! / #00018696' TO DFHEIV0
 19412     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19414     MOVE X'2F20233030303138363936' TO DFHEIV0(25:11)
 19415     CALL 'kxdfhei1' USING DFHEIV0
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19420     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19421
 19422
 19423* EXEC CICS READ
 19424*        UPDATE
 19425*        DATASET  (CRTT-ID)
 19426*        RIDFLD   (WS-ELCRTT-KEY)
 19427*        INTO     (CERTIFICATE-TRAILERS)
 19428*    END-EXEC.
 19429     MOVE LENGTH OF
 19430      CERTIFICATE-TRAILERS
 19431       TO DFHEIV11
 19432*    MOVE '&"IL       EU         (   #00018703' TO DFHEIV0
 19433     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19435     MOVE X'2020233030303138373033' TO DFHEIV0(25:11)
 19436     CALL 'kxdfhei1' USING DFHEIV0,
 19437           CRTT-ID,
 19438           CERTIFICATE-TRAILERS,
 19439           DFHEIV11,
 19440           WS-ELCRTT-KEY,
 19441           DFHEIV99,
 19442           DFHEIV99,
 19443           DFHEIV99
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19448         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 360
* EL050.cbl
 19449
 19450* EXEC CICS REWRITE
 19451*           DATASET  (CRTT-ID)
 19452*           FROM     (CERTIFICATE-TRAILERS)
 19453*        END-EXEC
 19454     MOVE LENGTH OF
 19455      CERTIFICATE-TRAILERS
 19456       TO DFHEIV11
 19457*    MOVE '&& L                  %   #00018712' TO DFHEIV0
 19458     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19459     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19460     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0,
 19462           CRTT-ID,
 19463           CERTIFICATE-TRAILERS,
 19464           DFHEIV11,
 19465           DFHEIV99
 19466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19467     ELSE
 19468
 19469* EXEC CICS UNLOCK
 19470*          DATASET  (CRTT-ID)
 19471*       END-EXEC
 19472*    MOVE '&*                    #   #00018717' TO DFHEIV0
 19473     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19475     MOVE X'2020233030303138373137' TO DFHEIV0(25:11)
 19476     CALL 'kxdfhei1' USING DFHEIV0,
 19477           CRTT-ID,
 19478           DFHEIV99
 19479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19480     END-IF.
 19481
 19482     GO TO 8180-EXIT.
 19483
 19484 8180-NOTFND.
 19485
 19486     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19487     MOVE 'CS'         TO CS-RECORD-ID.
 19488     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19489     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19490     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19491     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19492
 19493* EXEC CICS WRITE
 19494*       DATASET  (CRTT-ID)
 19495*       RIDFLD   (WS-ELCRTT-KEY)
 19496*       FROM     (CERTIFICATE-TRAILERS)
 19497*    END-EXEC.
 19498     MOVE LENGTH OF
 19499      CERTIFICATE-TRAILERS
 19500       TO DFHEIV11
 19501*    MOVE '&$ L                  ''   #00018732' TO DFHEIV0
 19502     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 361
* EL050.cbl
 19507           CERTIFICATE-TRAILERS,
 19508           DFHEIV11,
 19509           WS-ELCRTT-KEY,
 19510           DFHEIV99,
 19511           DFHEIV99
 19512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19513
 19514
 19515 8180-EXIT.
 19516     EXIT.
 19517
 19518 8190-UPDATE-REFUND-CLAIM-FLAG.
 19519
 19520* EXEC CICS HANDLE CONDITION
 19521*        NOTFND   (8190-NOTFND)
 19522*    END-EXEC.
 19523*    MOVE '"$I                   ! 0 #00018742' TO DFHEIV0
 19524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19526     MOVE X'3020233030303138373432' TO DFHEIV0(25:11)
 19527     CALL 'kxdfhei1' USING DFHEIV0
 19528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19529
 19530
 19531     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19532     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19533
 19534
 19535* EXEC CICS READ
 19536*        UPDATE
 19537*        DATASET  (CRTT-ID)
 19538*        RIDFLD   (WS-ELCRTT-KEY)
 19539*        INTO     (CERTIFICATE-TRAILERS)
 19540*    END-EXEC.
 19541     MOVE LENGTH OF
 19542      CERTIFICATE-TRAILERS
 19543       TO DFHEIV11
 19544*    MOVE '&"IL       EU         (   #00018749' TO DFHEIV0
 19545     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19546     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           CRTT-ID,
 19550           CERTIFICATE-TRAILERS,
 19551           DFHEIV11,
 19552           WS-ELCRTT-KEY,
 19553           DFHEIV99,
 19554           DFHEIV99,
 19555           DFHEIV99
 19556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19557
 19558
 19559     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19560
 19561* EXEC CICS REWRITE
 19562*       DATASET  (CRTT-ID)
 19563*       FROM     (CERTIFICATE-TRAILERS)
 19564*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 362
* EL050.cbl
 19565     MOVE LENGTH OF
 19566      CERTIFICATE-TRAILERS
 19567       TO DFHEIV11
 19568*    MOVE '&& L                  %   #00018757' TO DFHEIV0
 19569     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19570     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19571     MOVE X'2020233030303138373537' TO DFHEIV0(25:11)
 19572     CALL 'kxdfhei1' USING DFHEIV0,
 19573           CRTT-ID,
 19574           CERTIFICATE-TRAILERS,
 19575           DFHEIV11,
 19576           DFHEIV99
 19577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19578
 19579
 19580     GO TO 8190-EXIT.
 19581
 19582 8190-NOTFND.
 19583
 19584     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19585     MOVE 'CS'         TO CS-RECORD-ID.
 19586     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19587     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19588     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19589     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19590
 19591* EXEC CICS WRITE
 19592*       DATASET  (CRTT-ID)
 19593*       RIDFLD   (WS-ELCRTT-KEY)
 19594*       FROM     (CERTIFICATE-TRAILERS)
 19595*    END-EXEC.
 19596     MOVE LENGTH OF
 19597      CERTIFICATE-TRAILERS
 19598       TO DFHEIV11
 19599*    MOVE '&$ L                  ''   #00018772' TO DFHEIV0
 19600     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19602     MOVE X'2020233030303138373732' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0,
 19604           CRTT-ID,
 19605           CERTIFICATE-TRAILERS,
 19606           DFHEIV11,
 19607           WS-ELCRTT-KEY,
 19608           DFHEIV99,
 19609           DFHEIV99
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19611
 19612
 19613 8190-EXIT.
 19614     EXIT.
 19615
 19616 8195-UPDATE-AGE-FLAGS.
 19617
 19618* EXEC CICS HANDLE CONDITION
 19619*        NOTFND   (8195-NOTFND)
 19620*    END-EXEC.
 19621*    MOVE '"$I                   ! 1 #00018782' TO DFHEIV0
 19622     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 363
* EL050.cbl
 19623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19624     MOVE X'3120233030303138373832' TO DFHEIV0(25:11)
 19625     CALL 'kxdfhei1' USING DFHEIV0
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19630     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19631
 19632
 19633* EXEC CICS READ
 19634*        UPDATE
 19635*        DATASET  (CRTT-ID)
 19636*        RIDFLD   (WS-ELCRTT-KEY)
 19637*        INTO     (CERTIFICATE-TRAILERS)
 19638*    END-EXEC.
 19639     MOVE LENGTH OF
 19640      CERTIFICATE-TRAILERS
 19641       TO DFHEIV11
 19642*    MOVE '&"IL       EU         (   #00018789' TO DFHEIV0
 19643     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303138373839' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           CRTT-ID,
 19648           CERTIFICATE-TRAILERS,
 19649           DFHEIV11,
 19650           WS-ELCRTT-KEY,
 19651           DFHEIV99,
 19652           DFHEIV99,
 19653           DFHEIV99
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657     IF WS-INS-AGE-SET = 'Y'
 19658        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19659     END-IF
 19660     IF WS-JNT-AGE-SET = 'Y'
 19661        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19662     END-IF
 19663
 19664
 19665* EXEC CICS REWRITE
 19666*       DATASET  (CRTT-ID)
 19667*       FROM     (CERTIFICATE-TRAILERS)
 19668*    END-EXEC.
 19669     MOVE LENGTH OF
 19670      CERTIFICATE-TRAILERS
 19671       TO DFHEIV11
 19672*    MOVE '&& L                  %   #00018803' TO DFHEIV0
 19673     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19674     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19675     MOVE X'2020233030303138383033' TO DFHEIV0(25:11)
 19676     CALL 'kxdfhei1' USING DFHEIV0,
 19677           CRTT-ID,
 19678           CERTIFICATE-TRAILERS,
 19679           DFHEIV11,
 19680           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 364
* EL050.cbl
 19681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19682
 19683
 19684     GO TO 8195-EXIT.
 19685
 19686 8195-NOTFND.
 19687
 19688     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19689     MOVE 'CS'         TO CS-RECORD-ID.
 19690     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19691     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19692     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19693     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19694     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19695
 19696* EXEC CICS WRITE
 19697*       DATASET  (CRTT-ID)
 19698*       RIDFLD   (WS-ELCRTT-KEY)
 19699*       FROM     (CERTIFICATE-TRAILERS)
 19700*    END-EXEC.
 19701     MOVE LENGTH OF
 19702      CERTIFICATE-TRAILERS
 19703       TO DFHEIV11
 19704*    MOVE '&$ L                  ''   #00018819' TO DFHEIV0
 19705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19707     MOVE X'2020233030303138383139' TO DFHEIV0(25:11)
 19708     CALL 'kxdfhei1' USING DFHEIV0,
 19709           CRTT-ID,
 19710           CERTIFICATE-TRAILERS,
 19711           DFHEIV11,
 19712           WS-ELCRTT-KEY,
 19713           DFHEIV99,
 19714           DFHEIV99
 19715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19716
 19717
 19718 8195-EXIT.
 19719     EXIT.
 19720
 19721 8200-READ-REIN-TABLE.
 19722
 19723* EXEC CICS HANDLE CONDITION
 19724*         NOTFND   (8200-NOTFND)
 19725*    END-EXEC.
 19726*    MOVE '"$I                   ! 2 #00018829' TO DFHEIV0
 19727     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19729     MOVE X'3220233030303138383239' TO DFHEIV0(25:11)
 19730     CALL 'kxdfhei1' USING DFHEIV0
 19731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19732
 19733
 19734
 19735* EXEC CICS READ
 19736*        DATASET     (REIN-ID)
 19737*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19738*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 365
* EL050.cbl
 19739*    END-EXEC.
 19740*    MOVE '&"S        E          (   #00018833' TO DFHEIV0
 19741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19743     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 19744     CALL 'kxdfhei1' USING DFHEIV0,
 19745           REIN-ID,
 19746           DFHEIV20,
 19747           DFHEIV99,
 19748           ERREIN-KEY,
 19749           DFHEIV99,
 19750           DFHEIV99,
 19751           DFHEIV99
 19752     SET ADDRESS OF REINSURANCE-RECORD TO
 19753         DFHEIV20
 19754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19755
 19756
 19757     GO TO 8200-EXIT.
 19758
 19759 8200-NOTFND.
 19760     MOVE 'N'             TO WS-REIN-READ-SW.
 19761
 19762 8200-EXIT.
 19763      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 366
* EL050.cbl
 19765
 19766 8300-READ-CTBL-TABLE.
 19767
 19768* EXEC CICS HANDLE CONDITION
 19769*        NOTFND    (8300-NOTFND)
 19770*        DISABLED  (8300-ERRESS-PROBLEM)
 19771*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19772*        ENDFILE   (8300-NOTFND)
 19773*    END-EXEC.
 19774*    MOVE '"$IcJ''                ! 3 #00018849' TO DFHEIV0
 19775     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19777     MOVE X'3320233030303138383439' TO DFHEIV0(25:11)
 19778     CALL 'kxdfhei1' USING DFHEIV0
 19779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19780
 19781
 19782
 19783* EXEC CICS READ
 19784*        DATASET     (CTBL-ID)
 19785*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19786*        RIDFLD      (ERCTBL-KEY)
 19787*    END-EXEC.
 19788*    MOVE '&"S        E          (   #00018856' TO DFHEIV0
 19789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19791     MOVE X'2020233030303138383536' TO DFHEIV0(25:11)
 19792     CALL 'kxdfhei1' USING DFHEIV0,
 19793           CTBL-ID,
 19794           DFHEIV20,
 19795           DFHEIV99,
 19796           ERCTBL-KEY,
 19797           DFHEIV99,
 19798           DFHEIV99,
 19799           DFHEIV99
 19800     SET ADDRESS OF COMM-TABLE-RECORD TO
 19801         DFHEIV20
 19802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19803
 19804
 19805     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19806
 19807     GO TO 8300-EXIT.
 19808
 19809 8300-NOTFND.
 19810
 19811     IF CTBL-SW = '0530'
 19812         MOVE 'AA'                     TO WS-AH-COMP-CD
 19813         MOVE '0550'                   TO CTBL-SW
 19814         MOVE '1'                      TO WS-CTBL-READ-SW
 19815         GO TO 8300-EXIT.
 19816
 19817     IF CTBL-SW = '0540'
 19818         MOVE 'AA'                     TO WS-LF-COMP-CD
 19819         MOVE '0550'                   TO CTBL-SW
 19820         MOVE '1'                      TO WS-CTBL-READ-SW
 19821         GO TO 8300-EXIT.
 19822
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 367
* EL050.cbl
 19823     IF CTBL-SW = '0550'
 19824         MOVE '2'                      TO WS-CTBL-READ-SW
 19825         GO TO 8300-EXIT.
 19826
 19827     GO TO 8300-EXIT.
 19828
 19829 8300-ERRESS-PROBLEM.
 19830
 19831      MOVE ER-8050              TO WS-ERROR.
 19832      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19833
 19834     GO TO 8300-EXIT.
 19835
 19836 8300-EXIT.
 19837      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 368
* EL050.cbl
 19839
 19840
 19841 8400-GETMAIN-ERFORM.
 19842
 19843
 19844* EXEC CICS   GETMAIN
 19845*        LENGTH  (500)
 19846*        SET     (ADDRESS OF FORM-MASTER)
 19847*    END-EXEC.
 19848     MOVE 500
 19849       TO DFHEIV11
 19850*    MOVE '," L                  $   #00018900' TO DFHEIV0
 19851     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19853     MOVE X'2020233030303138393030' TO DFHEIV0(25:11)
 19854     CALL 'kxdfhei1' USING DFHEIV0,
 19855           DFHEIV20,
 19856           DFHEIV11,
 19857           DFHEIV99
 19858     SET ADDRESS OF FORM-MASTER TO
 19859         DFHEIV20
 19860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19861
 19862
 19863     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19864
 19865 8400-EXIT.
 19866      EXIT.
 19867
 19868 8450-READ-FORM-MASTER.
 19869
 19870
 19871* EXEC CICS  HANDLE CONDITION
 19872*        NOTFND   (8450-FORM-NOT-FOUND)
 19873*        ENDFILE  (8450-FORM-NOT-FOUND)
 19874*    END-EXEC.
 19875*    MOVE '"$I''                  ! 4 #00018912' TO DFHEIV0
 19876     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19878     MOVE X'3420233030303138393132' TO DFHEIV0(25:11)
 19879     CALL 'kxdfhei1' USING DFHEIV0
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883
 19884* EXEC CICS   READ
 19885*        DATASET   (FORM-ID)
 19886*        RIDFLD    (ERFORM-KEY)
 19887*        INTO      (FORM-MASTER)
 19888*        GTEQ
 19889*    END-EXEC.
 19890     MOVE LENGTH OF
 19891      FORM-MASTER
 19892       TO DFHEIV11
 19893*    MOVE '&"IL       G          (   #00018917' TO DFHEIV0
 19894     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303138393137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 369
* EL050.cbl
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           FORM-ID,
 19899           FORM-MASTER,
 19900           DFHEIV11,
 19901           ERFORM-KEY,
 19902           DFHEIV99,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19906
 19907
 19908     MOVE  'Y'           TO  FORM-MASTER-SW.
 19909
 19910     GO TO  8450-EXIT.
 19911
 19912 8450-FORM-NOT-FOUND.
 19913
 19914     MOVE  'N'           TO  FORM-MASTER-SW.
 19915
 19916 8450-EXIT.
 19917      EXIT.
 19918
 19919 8500-DATE-CONVERT.
 19920
 19921* EXEC CICS LINK
 19922*        PROGRAM    ('ELDATCV')
 19923*        COMMAREA   (DATE-CONVERSION-DATA)
 19924*        LENGTH     (DC-COMM-LENGTH)
 19925*    END-EXEC.
 19926     MOVE 'ELDATCV' TO DFHEIV1
 19927*    MOVE '."C                   (   #00018936' TO DFHEIV0
 19928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19930     MOVE X'2020233030303138393336' TO DFHEIV0(25:11)
 19931     CALL 'kxdfhei1' USING DFHEIV0,
 19932           DFHEIV1,
 19933           DATE-CONVERSION-DATA,
 19934           DC-COMM-LENGTH,
 19935           DFHEIV99,
 19936           DFHEIV99,
 19937           DFHEIV99,
 19938           DFHEIV99
 19939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19940
 19941
 19942 8500-EXIT.
 19943     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 370
* EL050.cbl
 19945
 19946 8555-RELOAD-CONTROL-FILE.
 19947     CONTINUE.
 19948
 19949 8555-EXIT.
 19950     EXIT.
 19951
 19952 8557-GETMAIN-ERPLAN.
 19953
 19954
 19955* EXEC CICS GETMAIN
 19956*        LENGTH    (840)
 19957*        SET       (ADDRESS OF PLAN-RECORDS)
 19958*    END-EXEC.
 19959     MOVE 840
 19960       TO DFHEIV11
 19961*    MOVE '," L                  $   #00018954' TO DFHEIV0
 19962     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19963     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19964     MOVE X'2020233030303138393534' TO DFHEIV0(25:11)
 19965     CALL 'kxdfhei1' USING DFHEIV0,
 19966           DFHEIV20,
 19967           DFHEIV11,
 19968           DFHEIV99
 19969     SET ADDRESS OF PLAN-RECORDS TO
 19970         DFHEIV20
 19971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19972
 19973
 19974     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19975
 19976 8557-EXIT.
 19977     EXIT.
 19978
 19979 8560-GETMAIN.
 19980
 19981* EXEC CICS GETMAIN
 19982*        LENGTH    (2000)
 19983*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19984*    END-EXEC.
 19985     MOVE 2000
 19986       TO DFHEIV11
 19987*    MOVE '," L                  $   #00018965' TO DFHEIV0
 19988     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19989     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19990     MOVE X'2020233030303138393635' TO DFHEIV0(25:11)
 19991     CALL 'kxdfhei1' USING DFHEIV0,
 19992           DFHEIV20,
 19993           DFHEIV11,
 19994           DFHEIV99
 19995     SET ADDRESS OF ACCOUNT-MASTER TO
 19996         DFHEIV20
 19997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19998
 19999
 20000     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20001
 20002 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 371
* EL050.cbl
 20003     EXIT.
 20004
 20005 8570-START-ACCOUNT-MASTER.
 20006
 20007* EXEC CICS HANDLE CONDITION
 20008*        NOTFND    (0199-ACCT-NOT-FOUND)
 20009*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20010*    END-EXEC.
 20011*    MOVE '"$I''                  ! 5 #00018976' TO DFHEIV0
 20012     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20014     MOVE X'3520233030303138393736' TO DFHEIV0(25:11)
 20015     CALL 'kxdfhei1' USING DFHEIV0
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019
 20020* EXEC CICS STARTBR
 20021*        DATASET    (ACCT-ID)
 20022*        RIDFLD     (ERACCT-KEY)
 20023*        GTEQ
 20024*    END-EXEC.
 20025     MOVE 0
 20026       TO DFHEIV11
 20027*    MOVE '&,         G          &   #00018981' TO DFHEIV0
 20028     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20029     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20030     MOVE X'2020233030303138393831' TO DFHEIV0(25:11)
 20031     CALL 'kxdfhei1' USING DFHEIV0,
 20032           ACCT-ID,
 20033           ERACCT-KEY,
 20034           DFHEIV99,
 20035           DFHEIV11,
 20036           DFHEIV99
 20037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20038
 20039
 20040 8570-EXIT.
 20041     EXIT.
 20042
 20043 8580-READ-ACCOUNT-MASTER.
 20044
 20045* EXEC CICS HANDLE CONDITION
 20046*        NOTFND    (0199-ACCT-NOT-FOUND)
 20047*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20048*    END-EXEC.
 20049*    MOVE '"$I''                  ! 6 #00018991' TO DFHEIV0
 20050     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20052     MOVE X'3620233030303138393931' TO DFHEIV0(25:11)
 20053     CALL 'kxdfhei1' USING DFHEIV0
 20054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20055
 20056
 20057
 20058* EXEC CICS READNEXT
 20059*        DATASET     (ACCT-ID)
 20060*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 372
* EL050.cbl
 20061*        RIDFLD      (ERACCT-KEY)
 20062*    END-EXEC.
 20063     MOVE LENGTH OF
 20064      ACCOUNT-MASTER
 20065       TO DFHEIV12
 20066     MOVE 0
 20067       TO DFHEIV11
 20068*    MOVE '&.IL                  )   #00018996' TO DFHEIV0
 20069     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20070     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20071     MOVE X'2020233030303138393936' TO DFHEIV0(25:11)
 20072     CALL 'kxdfhei1' USING DFHEIV0,
 20073           ACCT-ID,
 20074           ACCOUNT-MASTER,
 20075           DFHEIV12,
 20076           ERACCT-KEY,
 20077           DFHEIV99,
 20078           DFHEIV11,
 20079           DFHEIV99,
 20080           DFHEIV99
 20081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20082
 20083
 20084 8580-EXIT.
 20085     EXIT.
 20086
 20087 8582-READ-COMPENSATION-MASTER.
 20088
 20089* EXEC CICS HANDLE CONDITION
 20090*        NOTFND    (8582-COMP-NOT-FOUND)
 20091*        ENDFILE   (8582-COMP-NOT-FOUND)
 20092*    END-EXEC.
 20093*    MOVE '"$I''                  ! 7 #00019006' TO DFHEIV0
 20094     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20096     MOVE X'3720233030303139303036' TO DFHEIV0(25:11)
 20097     CALL 'kxdfhei1' USING DFHEIV0
 20098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20099
 20100
 20101
 20102* EXEC CICS READ
 20103*        DATASET     (COMP-ID)
 20104*        INTO        (COMPENSATION-MASTER)
 20105*        RIDFLD      (ERCOMP-KEY)
 20106*    END-EXEC.
 20107     MOVE LENGTH OF
 20108      COMPENSATION-MASTER
 20109       TO DFHEIV11
 20110*    MOVE '&"IL       E          (   #00019011' TO DFHEIV0
 20111     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139303131' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           COMP-ID,
 20116           COMPENSATION-MASTER,
 20117           DFHEIV11,
 20118           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 373
* EL050.cbl
 20119           DFHEIV99,
 20120           DFHEIV99,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20123
 20124
 20125     MOVE 'Y'                    TO COMP-MASTER-SW
 20126
 20127     GO TO 8582-EXIT
 20128     .
 20129 8582-COMP-NOT-FOUND.
 20130
 20131     MOVE 'N'                    TO COMP-MASTER-SW.
 20132
 20133 8582-EXIT.
 20134     EXIT.
 20135
 20136 8583-READ-ERAGTC.
 20137
 20138* EXEC CICS HANDLE CONDITION
 20139*        NOTFND    (8583-AGTC-NOT-FOUND)
 20140*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20141*    END-EXEC.
 20142*    MOVE '"$I''                  ! 8 #00019029' TO DFHEIV0
 20143     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20145     MOVE X'3820233030303139303239' TO DFHEIV0(25:11)
 20146     CALL 'kxdfhei1' USING DFHEIV0
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150
 20151* EXEC CICS STARTBR
 20152*        DATASET    (AGTC-ID)
 20153*        RIDFLD     (ERAGTC-KEY)
 20154*        GTEQ
 20155*    END-EXEC.
 20156     MOVE 0
 20157       TO DFHEIV11
 20158*    MOVE '&,         G          &   #00019034' TO DFHEIV0
 20159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20161     MOVE X'2020233030303139303334' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           AGTC-ID,
 20164           ERAGTC-KEY,
 20165           DFHEIV99,
 20166           DFHEIV11,
 20167           DFHEIV99
 20168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20169
 20170
 20171 8583-READ-ERAGTC-NEXT.
 20172
 20173* EXEC CICS READNEXT
 20174*        DATASET     (AGTC-ID)
 20175*        INTO        (AGENT-COMMISSIONS)
 20176*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 374
* EL050.cbl
 20177*    END-EXEC.
 20178     MOVE LENGTH OF
 20179      AGENT-COMMISSIONS
 20180       TO DFHEIV12
 20181     MOVE 0
 20182       TO DFHEIV11
 20183*    MOVE '&.IL                  )   #00019041' TO DFHEIV0
 20184     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20185     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20186     MOVE X'2020233030303139303431' TO DFHEIV0(25:11)
 20187     CALL 'kxdfhei1' USING DFHEIV0,
 20188           AGTC-ID,
 20189           AGENT-COMMISSIONS,
 20190           DFHEIV12,
 20191           ERAGTC-KEY,
 20192           DFHEIV99,
 20193           DFHEIV11,
 20194           DFHEIV99,
 20195           DFHEIV99
 20196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20197
 20198
 20199*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20200
 20201     GO TO 8583-EXIT
 20202     .
 20203 8583-AGTC-NOT-FOUND.
 20204
 20205     MOVE 'N'                    TO AGTC-MASTER-SW.
 20206
 20207 8583-EXIT.
 20208     EXIT.
 20209
 20210 8584-READ-BANK-CROSS-REF.
 20211
 20212* EXEC CICS HANDLE CONDITION
 20213*        NOTFND    (8584-BXRF-NOT-FOUND)
 20214*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20215*    END-EXEC.
 20216*    MOVE '"$I''                  ! 9 #00019059' TO DFHEIV0
 20217     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20218     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20219     MOVE X'3920233030303139303539' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0
 20221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20222
 20223
 20224
 20225* EXEC CICS READ
 20226*        DATASET     (BXRF-ID)
 20227*        INTO        (BANK-CROSS-REFERENCE)
 20228*        RIDFLD      (ERBXRF-KEY)
 20229*        LENGTH      (BXRF-REC-LENGTH)
 20230*    END-EXEC.
 20231*    MOVE '&"IL       E          (   #00019064' TO DFHEIV0
 20232     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20234     MOVE X'2020233030303139303634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 375
* EL050.cbl
 20235     CALL 'kxdfhei1' USING DFHEIV0,
 20236           BXRF-ID,
 20237           BANK-CROSS-REFERENCE,
 20238           BXRF-REC-LENGTH,
 20239           ERBXRF-KEY,
 20240           DFHEIV99,
 20241           DFHEIV99,
 20242           DFHEIV99
 20243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20244
 20245
 20246     MOVE 'Y'                    TO BXRF-MASTER-SW
 20247
 20248     GO TO 8584-EXIT
 20249     .
 20250 8584-BXRF-NOT-FOUND.
 20251
 20252     MOVE 'N'                    TO BXRF-MASTER-SW.
 20253
 20254 8584-EXIT.
 20255     EXIT.
 20256
 20257 8585-READ-PLAN-MASTER.
 20258
 20259
 20260* EXEC CICS HANDLE CONDITION
 20261*        NOTFND    (8585-PLAN-NOT-FOUND)
 20262*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20263*    END-EXEC.
 20264*    MOVE '"$I''                  ! : #00019084' TO DFHEIV0
 20265     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20267     MOVE X'3A20233030303139303834' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
 20272
 20273* EXEC CICS READ
 20274*        DATASET     (PLAN-ID)
 20275*        INTO        (PLAN-MASTER)
 20276*        RIDFLD      (ERPLAN-KEY)
 20277*    END-EXEC.
 20278     MOVE LENGTH OF
 20279      PLAN-MASTER
 20280       TO DFHEIV11
 20281*    MOVE '&"IL       E          (   #00019089' TO DFHEIV0
 20282     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20284     MOVE X'2020233030303139303839' TO DFHEIV0(25:11)
 20285     CALL 'kxdfhei1' USING DFHEIV0,
 20286           PLAN-ID,
 20287           PLAN-MASTER,
 20288           DFHEIV11,
 20289           ERPLAN-KEY,
 20290           DFHEIV99,
 20291           DFHEIV99,
 20292           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 376
* EL050.cbl
 20293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20294
 20295
 20296     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20297
 20298     GO TO 8585-EXIT.
 20299
 20300 8585-PLAN-NOT-FOUND.
 20301
 20302     MOVE 'N'                    TO PLAN-MASTER-SW.
 20303
 20304 8585-EXIT.
 20305     EXIT.
 20306
 20307 8586-READ-LOAN-OFFICER.
 20308
 20309* EXEC CICS READ
 20310*        DATASET     (LOFC-ID)
 20311*        INTO        (LOAN-OFFICER-MASTER)
 20312*        RIDFLD      (ERLOFC-KEY)
 20313*        RESP        (WS-RESPONSE)
 20314*    END-EXEC
 20315     MOVE LENGTH OF
 20316      LOAN-OFFICER-MASTER
 20317       TO DFHEIV11
 20318*    MOVE '&"IL       E          (  N#00019107' TO DFHEIV0
 20319     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20321     MOVE X'204E233030303139313037' TO DFHEIV0(25:11)
 20322     CALL 'kxdfhei1' USING DFHEIV0,
 20323           LOFC-ID,
 20324           LOAN-OFFICER-MASTER,
 20325           DFHEIV11,
 20326           ERLOFC-KEY,
 20327           DFHEIV99,
 20328           DFHEIV99,
 20329           DFHEIV99
 20330     MOVE EIBRESP  TO WS-RESPONSE
 20331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20332
 20333     IF WS-RESP-NORMAL
 20334        MOVE 'Y'                 TO LOFC-MASTER-SW
 20335     ELSE
 20336        MOVE 'N'                 TO LOFC-MASTER-SW
 20337     END-IF
 20338     .
 20339 8586-EXIT.
 20340     EXIT.
 20341 8587-START-ERPDEF.
 20342
 20343* EXEC CICS STARTBR
 20344*       DATASET   (PDEF-ID)
 20345*       RIDFLD    (ERPDEF-KEY)
 20346*       GTEQ
 20347*       RESP      (WS-RESPONSE)
 20348*    END-EXEC
 20349     MOVE 0
 20350       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 377
* EL050.cbl
 20351*    MOVE '&,         G          &  N#00019123' TO DFHEIV0
 20352     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20353     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20354     MOVE X'204E233030303139313233' TO DFHEIV0(25:11)
 20355     CALL 'kxdfhei1' USING DFHEIV0,
 20356           PDEF-ID,
 20357           ERPDEF-KEY,
 20358           DFHEIV99,
 20359           DFHEIV11,
 20360           DFHEIV99
 20361     MOVE EIBRESP  TO WS-RESPONSE
 20362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20363     IF WS-RESP-NORMAL
 20364        MOVE 'Y'                 TO PDEF-MASTER-SW
 20365     ELSE
 20366        MOVE 'N'                 TO PDEF-MASTER-SW
 20367     END-IF
 20368     .
 20369 8587-EXIT.
 20370     EXIT.
 20371 8588-READ-ERPDEF.
 20372
 20373* EXEC CICS READNEXT
 20374*       DATASET   (PDEF-ID)
 20375*       RIDFLD    (ERPDEF-KEY)
 20376*       INTO      (PRODUCT-MASTER)
 20377*       RESP      (WS-RESPONSE)
 20378*    END-EXEC
 20379     MOVE LENGTH OF
 20380      PRODUCT-MASTER
 20381       TO DFHEIV12
 20382     MOVE 0
 20383       TO DFHEIV11
 20384*    MOVE '&.IL                  )  N#00019138' TO DFHEIV0
 20385     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20386     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20387     MOVE X'204E233030303139313338' TO DFHEIV0(25:11)
 20388     CALL 'kxdfhei1' USING DFHEIV0,
 20389           PDEF-ID,
 20390           PRODUCT-MASTER,
 20391           DFHEIV12,
 20392           ERPDEF-KEY,
 20393           DFHEIV99,
 20394           DFHEIV11,
 20395           DFHEIV99,
 20396           DFHEIV99
 20397     MOVE EIBRESP  TO WS-RESPONSE
 20398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20399     IF WS-RESP-NORMAL
 20400        MOVE 'Y'                 TO PDEF-MASTER-SW
 20401     ELSE
 20402        MOVE 'N'                 TO PDEF-MASTER-SW
 20403     END-IF
 20404     .
 20405 8588-EXIT.
 20406     EXIT.
 20407 8589-ENDBR-ERPDEF.
 20408
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 378
* EL050.cbl
 20409* EXEC CICS ENDBR
 20410*       DATASET   (PDEF-ID)
 20411*    END-EXEC
 20412     MOVE 0
 20413       TO DFHEIV11
 20414*    MOVE '&2                    $   #00019153' TO DFHEIV0
 20415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20417     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 20418     CALL 'kxdfhei1' USING DFHEIV0,
 20419           PDEF-ID,
 20420           DFHEIV11,
 20421           DFHEIV99
 20422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20423     .
 20424 8589-EXIT.
 20425     EXIT.
 20426 8590-READ-CERT-MASTER.
 20427     IF PB-COMPANY-ID = 'UCL'
 20428         GO TO 8690-READ-CERT-MASTER-UCL.
 20429
 20430
 20431* EXEC CICS HANDLE CONDITION
 20432*         NOTFND    (0299-CERT-NOT-FOUND)
 20433*    END-EXEC.
 20434*    MOVE '"$I                   ! ; #00019163' TO DFHEIV0
 20435     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20437     MOVE X'3B20233030303139313633' TO DFHEIV0(25:11)
 20438     CALL 'kxdfhei1' USING DFHEIV0
 20439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20440
 20441
 20442
 20443* EXEC CICS READ
 20444*        DATASET     (CERT-ID)
 20445*        INTO        (CERTIFICATE-MASTER)
 20446*        RIDFLD      (ELCERT-KEY)
 20447*        UPDATE
 20448*    END-EXEC.
 20449     MOVE LENGTH OF
 20450      CERTIFICATE-MASTER
 20451       TO DFHEIV11
 20452*    MOVE '&"IL       EU         (   #00019167' TO DFHEIV0
 20453     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20454     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20455     MOVE X'2020233030303139313637' TO DFHEIV0(25:11)
 20456     CALL 'kxdfhei1' USING DFHEIV0,
 20457           CERT-ID,
 20458           CERTIFICATE-MASTER,
 20459           DFHEIV11,
 20460           ELCERT-KEY,
 20461           DFHEIV99,
 20462           DFHEIV99,
 20463           DFHEIV99
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 379
* EL050.cbl
 20467 8590-EXIT.
 20468     EXIT.
 20469
 20470 8690-READ-CERT-MASTER-UCL.
 20471
 20472* EXEC CICS HANDLE CONDITION
 20473*         NOTFND    (8700-READ-CERT-MASTER)
 20474*    END-EXEC.
 20475*    MOVE '"$I                   ! < #00019178' TO DFHEIV0
 20476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20478     MOVE X'3C20233030303139313738' TO DFHEIV0(25:11)
 20479     CALL 'kxdfhei1' USING DFHEIV0
 20480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20481
 20482
 20483 8690-READ-CERT-CONT.
 20484
 20485* EXEC CICS READ
 20486*        DATASET     (CERT-ID)
 20487*        INTO        (CERTIFICATE-MASTER)
 20488*        RIDFLD      (ELCERT-KEY)
 20489*        UPDATE
 20490*    END-EXEC.
 20491     MOVE LENGTH OF
 20492      CERTIFICATE-MASTER
 20493       TO DFHEIV11
 20494*    MOVE '&"IL       EU         (   #00019183' TO DFHEIV0
 20495     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20496     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20497     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 20498     CALL 'kxdfhei1' USING DFHEIV0,
 20499           CERT-ID,
 20500           CERTIFICATE-MASTER,
 20501           DFHEIV11,
 20502           ELCERT-KEY,
 20503           DFHEIV99,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20507
 20508
 20509     GO TO 8590-EXIT.
 20510
 20511 8700-READ-CERT-MASTER.
 20512     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20513     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20514
 20515* EXEC CICS HANDLE CONDITION
 20516*         DUPKEY    (8720-COMP-ACCOUNTS)
 20517*         ENDFILE   (8730-END-BROWSE)
 20518*         NOTFND    (8740-NOT-FOUND)
 20519*    END-EXEC.
 20520*    MOVE '"$$''I                 ! = #00019195' TO DFHEIV0
 20521     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20523     MOVE X'3D20233030303139313935' TO DFHEIV0(25:11)
 20524     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 380
* EL050.cbl
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20526
 20527
 20528
 20529* EXEC CICS STARTBR
 20530*        DATASET     ('ELCERT5')
 20531*        RIDFLD      (ELCERT2-KEY)
 20532*        EQUAL
 20533*    END-EXEC.
 20534     MOVE 'ELCERT5' TO DFHEIV1
 20535     MOVE 0
 20536       TO DFHEIV11
 20537*    MOVE '&,         E          &   #00019201' TO DFHEIV0
 20538     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20540     MOVE X'2020233030303139323031' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0,
 20542           DFHEIV1,
 20543           ELCERT2-KEY,
 20544           DFHEIV99,
 20545           DFHEIV11,
 20546           DFHEIV99
 20547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20548
 20549
 20550 8710-READ-NEXT.
 20551
 20552* EXEC CICS READNEXT
 20553*        DATASET     ('ELCERT5')
 20554*        INTO        (CERTIFICATE-MASTER)
 20555*        RIDFLD      (ELCERT2-KEY)
 20556*    END-EXEC.
 20557     MOVE LENGTH OF
 20558      CERTIFICATE-MASTER
 20559       TO DFHEIV12
 20560     MOVE 'ELCERT5' TO DFHEIV1
 20561     MOVE 0
 20562       TO DFHEIV11
 20563*    MOVE '&.IL                  )   #00019208' TO DFHEIV0
 20564     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20566     MOVE X'2020233030303139323038' TO DFHEIV0(25:11)
 20567     CALL 'kxdfhei1' USING DFHEIV0,
 20568           DFHEIV1,
 20569           CERTIFICATE-MASTER,
 20570           DFHEIV12,
 20571           ELCERT2-KEY,
 20572           DFHEIV99,
 20573           DFHEIV11,
 20574           DFHEIV99,
 20575           DFHEIV99
 20576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20577
 20578
 20579 8720-COMP-ACCOUNTS.
 20580
 20581* EXEC CICS ENTER
 20582*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 381
* EL050.cbl
 20583*         FROM (PB-C-LAST-NAME)
 20584*    END-EXEC.
 20585     MOVE 001
 20586       TO DFHEIV11
 20587*    MOVE ':$F                   %   #00019215' TO DFHEIV0
 20588     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20589     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20590     MOVE X'2020233030303139323135' TO DFHEIV0(25:11)
 20591     CALL 'kxdfhei1' USING DFHEIV0,
 20592           DFHEIV11,
 20593           PB-C-LAST-NAME,
 20594           DFHEIV99,
 20595           DFHEIV99
 20596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20597
 20598
 20599
 20600* EXEC CICS ENTER
 20601*         TRACEID (002)
 20602*         FROM (CM-INSURED-LAST-NAME)
 20603*    END-EXEC.
 20604     MOVE 002
 20605       TO DFHEIV11
 20606*    MOVE ':$F                   %   #00019220' TO DFHEIV0
 20607     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20609     MOVE X'2020233030303139323230' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0,
 20611           DFHEIV11,
 20612           CM-INSURED-LAST-NAME,
 20613           DFHEIV99,
 20614           DFHEIV99
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618     IF PB-CERT-NO NOT = CM-CERT-NO
 20619         GO TO 8730-END-BROWSE.
 20620
 20621     IF PB-ACCOUNT = CM-ACCOUNT
 20622         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20623             MOVE ER-2799        TO WS-ERROR
 20624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20625             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20626             GO TO 8730-END-BROWSE.
 20627
 20628     GO TO 8710-READ-NEXT.
 20629
 20630 8730-END-BROWSE.
 20631
 20632* EXEC CICS ENDBR
 20633*         DATASET    ('ELCERT5')
 20634*    END-EXEC.
 20635     MOVE 'ELCERT5' TO DFHEIV1
 20636     MOVE 0
 20637       TO DFHEIV11
 20638*    MOVE '&2                    $   #00019238' TO DFHEIV0
 20639     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 382
* EL050.cbl
 20641     MOVE X'2020233030303139323338' TO DFHEIV0(25:11)
 20642     CALL 'kxdfhei1' USING DFHEIV0,
 20643           DFHEIV1,
 20644           DFHEIV11,
 20645           DFHEIV99
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649 8740-NOT-FOUND.
 20650     GO TO 0299-CERT-NOT-FOUND.
 20651
 20652 8750-START-ELSTAT.
 20653
 20654* EXEC CICS STARTBR
 20655*       DATASET   (STAT-ID)
 20656*       RIDFLD    (ELSTAT-KEY)
 20657*       GTEQ
 20658*       RESP      (WS-RESPONSE)
 20659*    END-EXEC
 20660     MOVE 0
 20661       TO DFHEIV11
 20662*    MOVE '&,         G          &  N#00019246' TO DFHEIV0
 20663     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20665     MOVE X'204E233030303139323436' TO DFHEIV0(25:11)
 20666     CALL 'kxdfhei1' USING DFHEIV0,
 20667           STAT-ID,
 20668           ELSTAT-KEY,
 20669           DFHEIV99,
 20670           DFHEIV11,
 20671           DFHEIV99
 20672     MOVE EIBRESP  TO WS-RESPONSE
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20674     IF WS-RESP-NORMAL
 20675        MOVE 'Y'                 TO STAT-MASTER-SW
 20676     ELSE
 20677        MOVE 'N'                 TO STAT-MASTER-SW
 20678     END-IF
 20679     .
 20680 8750-EXIT.
 20681     EXIT.
 20682 8752-READ-ELSTAT.
 20683
 20684* EXEC CICS READNEXT
 20685*       DATASET   (STAT-ID)
 20686*       RIDFLD    (ELSTAT-KEY)
 20687*       INTO      (STATE-FILE)
 20688*       RESP      (WS-RESPONSE)
 20689*    END-EXEC
 20690     MOVE LENGTH OF
 20691      STATE-FILE
 20692       TO DFHEIV12
 20693     MOVE 0
 20694       TO DFHEIV11
 20695*    MOVE '&.IL                  )  N#00019261' TO DFHEIV0
 20696     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20697     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20698     MOVE X'204E233030303139323631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 383
* EL050.cbl
 20699     CALL 'kxdfhei1' USING DFHEIV0,
 20700           STAT-ID,
 20701           STATE-FILE,
 20702           DFHEIV12,
 20703           ELSTAT-KEY,
 20704           DFHEIV99,
 20705           DFHEIV11,
 20706           DFHEIV99,
 20707           DFHEIV99
 20708     MOVE EIBRESP  TO WS-RESPONSE
 20709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20710     IF WS-RESP-NORMAL
 20711        MOVE 'Y'                 TO STAT-MASTER-SW
 20712     ELSE
 20713        MOVE 'N'                 TO STAT-MASTER-SW
 20714     END-IF
 20715     .
 20716 8752-EXIT.
 20717     EXIT.
 20718 8800-GET-COMP-RATE.
 20719     MOVE +1 TO IB.
 20720     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20721         ADD +9 TO IB
 20722         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20723             ADD +9 TO IB
 20724             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20725                MOVE ZEROS       TO WS-WK-RATE
 20726                GO TO 8800-EXIT.
 20727
 20728     IF PB-I-AGE GREATER CT-AGE (1)
 20729         ADD +3 TO IB
 20730         IF PB-I-AGE GREATER CT-AGE (2)
 20731             ADD +3 TO IB
 20732             IF PB-I-AGE GREATER CT-AGE (3)
 20733                MOVE ZEROS       TO WS-WK-RATE
 20734                GO TO 8800-EXIT.
 20735
 20736     IF WS-WORK-TERM GREATER CT-TRM (1)
 20737         ADD +1 TO IB
 20738         IF WS-WORK-TERM GREATER CT-TRM (2)
 20739             ADD +1 TO IB
 20740             IF WS-WORK-TERM GREATER CT-TRM (3)
 20741                MOVE ZEROS       TO WS-WK-RATE
 20742                GO TO 8800-EXIT.
 20743
 20744     IF CT-RT (IB) NOT NUMERIC
 20745         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20746         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20747         GO TO 8800-GET-COMP-RATE.
 20748
 20749     MOVE CT-RT (IB) TO WS-WK-RATE.
 20750
 20751 8800-EXIT.
 20752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 384
* EL050.cbl
 20754 8900-ADDRESS-FILE.
 20755     IF ERACCT-FILE-ADDRESSED
 20756         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20757         GO TO 8900-ADDRESS-EXIT.
 20758
 20759     IF ELCNTL-FILE-ADDRESSED
 20760         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20761         GO TO 8900-ADDRESS-EXIT.
 20762
 20763     IF ERPLAN-FILE-ADDRESSED
 20764         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20765         GO TO 8900-ADDRESS-EXIT.
 20766
 20767     IF ERFORM-FILE-ADDRESSED
 20768         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20769         GO TO 8900-ADDRESS-EXIT.
 20770
 20771 8900-ADDRESS-EXIT.
 20772     EXIT.
 20773
 20774 9000-READ-CONTROL.
 20775
 20776* EXEC CICS HANDLE CONDITION
 20777*        NOTFND    (9000-NOTFND)
 20778*    END-EXEC.
 20779*    MOVE '"$I                   ! > #00019332' TO DFHEIV0
 20780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20782     MOVE X'3E20233030303139333332' TO DFHEIV0(25:11)
 20783     CALL 'kxdfhei1' USING DFHEIV0
 20784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20785
 20786
 20787
 20788* EXEC CICS READ
 20789*        DATASET     (CNTL-ID)
 20790*        SET         (ADDRESS OF CONTROL-FILE)
 20791*        RIDFLD      (ELCNTL-KEY)
 20792*        GTEQ
 20793*    END-EXEC.
 20794*    MOVE '&"S        G          (   #00019336' TO DFHEIV0
 20795     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20797     MOVE X'2020233030303139333336' TO DFHEIV0(25:11)
 20798     CALL 'kxdfhei1' USING DFHEIV0,
 20799           CNTL-ID,
 20800           DFHEIV20,
 20801           DFHEIV99,
 20802           ELCNTL-KEY,
 20803           DFHEIV99,
 20804           DFHEIV99,
 20805           DFHEIV99
 20806     SET ADDRESS OF CONTROL-FILE TO
 20807         DFHEIV20
 20808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20809
 20810
 20811     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 385
* EL050.cbl
 20812
 20813 9000-NOTFND.
 20814     IF RC-SW-1 = '1'
 20815        MOVE ER-2616              TO WS-ERROR
 20816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20817        GO TO 9000-EXIT.
 20818
 20819     IF RC-SW-1 = '2'
 20820        MOVE ER-2602              TO WS-ERROR
 20821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20822
 20823 9000-EXIT.
 20824      EXIT.
 20825
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 386
* EL050.cbl
 20827 9100-READ-CONTROL.
 20828
 20829* EXEC CICS HANDLE CONDITION
 20830*        NOTFND  (9100-NOTFND)
 20831*        ENDFILE (9100-NOTFND)
 20832*    END-EXEC.
 20833*    MOVE '"$I''                  ! ? #00019360' TO DFHEIV0
 20834     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20836     MOVE X'3F20233030303139333630' TO DFHEIV0(25:11)
 20837     CALL 'kxdfhei1' USING DFHEIV0
 20838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20839
 20840
 20841
 20842* EXEC CICS READ
 20843*        DATASET     (CNTL-ID)
 20844*        INTO        (CONTROL-FILE)
 20845*        RIDFLD      (ELCNTL-KEY)
 20846*        GTEQ
 20847*    END-EXEC.
 20848     MOVE LENGTH OF
 20849      CONTROL-FILE
 20850       TO DFHEIV11
 20851*    MOVE '&"IL       G          (   #00019365' TO DFHEIV0
 20852     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20854     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 20855     CALL 'kxdfhei1' USING DFHEIV0,
 20856           CNTL-ID,
 20857           CONTROL-FILE,
 20858           DFHEIV11,
 20859           ELCNTL-KEY,
 20860           DFHEIV99,
 20861           DFHEIV99,
 20862           DFHEIV99
 20863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20864
 20865
 20866     GO TO 9100-EXIT.
 20867
 20868 9100-NOTFND.
 20869     IF RC-SW-2 = '0'
 20870        MOVE '1'                  TO STATE-RECORD-ERROR
 20871        GO TO 9100-EXIT
 20872     END-IF
 20873     IF RC-SW-2 = '1'
 20874        MOVE '1'                  TO LF-BENEFIT-ERROR
 20875        MOVE ER-2604              TO WS-ERROR
 20876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20877        GO TO 9100-EXIT.
 20878
 20879     IF RC-SW-2 = '2'
 20880        MOVE '1'                  TO AH-BENEFIT-ERROR
 20881        MOVE ER-2605              TO WS-ERROR
 20882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20883        GO TO 9100-EXIT.
 20884
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 387
* EL050.cbl
 20885     IF RC-SW-2 = '3'
 20886         MOVE ER-2603           TO WS-ERROR
 20887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20888         GO TO 9100-EXIT.
 20889
 20890     IF RC-SW-2 = '4'
 20891         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20892         GO TO 9100-EXIT.
 20893
 20894     IF RC-SW-2 = '5'
 20895         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20896         IF WS-AH-INPUT-CD-1 = SPACE
 20897             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20898         ELSE
 20899             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20900
 20901 9100-EXIT.
 20902      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 388
* EL050.cbl
 20904 9200-CONTROL-GETMAIN.
 20905
 20906* EXEC CICS GETMAIN
 20907*         LENGTH   (750)
 20908*         SET      (ADDRESS OF CONTROL-FILE)
 20909*    END-EXEC.
 20910     MOVE 750
 20911       TO DFHEIV11
 20912*    MOVE '," L                  $   #00019411' TO DFHEIV0
 20913     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20914     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20915     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 20916     CALL 'kxdfhei1' USING DFHEIV0,
 20917           DFHEIV20,
 20918           DFHEIV11,
 20919           DFHEIV99
 20920     SET ADDRESS OF CONTROL-FILE TO
 20921         DFHEIV20
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20926
 20927 9200-EXIT.
 20928     EXIT.
 20929
 20930 9250-UNLOCK-RETURN.
 20931
 20932* EXEC CICS UNLOCK
 20933*        DATASET   (CERT-ID)
 20934*    END-EXEC.
 20935*    MOVE '&*                    #   #00019422' TO DFHEIV0
 20936     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20938     MOVE X'2020233030303139343232' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0,
 20940           CERT-ID,
 20941           DFHEIV99
 20942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20943
 20944
 20945 9300-ABEND.
 20946     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20947
 20948
 20949* EXEC CICS LINK
 20950*        PROGRAM   ('EL004')
 20951*        COMMAREA  (WS-ERROR-LINE)
 20952*        LENGTH    (72)
 20953*    END-EXEC.
 20954     MOVE 'EL004' TO DFHEIV1
 20955     MOVE 72
 20956       TO DFHEIV11
 20957*    MOVE '."C                   (   #00019429' TO DFHEIV0
 20958     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20960     MOVE X'2020233030303139343239' TO DFHEIV0(25:11)
 20961     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 389
* EL050.cbl
 20962           DFHEIV1,
 20963           WS-ERROR-LINE,
 20964           DFHEIV11,
 20965           DFHEIV99,
 20966           DFHEIV99,
 20967           DFHEIV99,
 20968           DFHEIV99
 20969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20970
 20971
 20972     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20973
 20974
 20975* EXEC CICS ABEND
 20976*        ABCODE ('EL50')
 20977*    END-EXEC.
 20978     MOVE 'EL50' TO DFHEIV5
 20979*    MOVE '.,A                   "   #00019437' TO DFHEIV0
 20980     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20981     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20982     MOVE X'2020233030303139343337' TO DFHEIV0(25:11)
 20983     CALL 'kxdfhei1' USING DFHEIV0,
 20984           DFHEIV5
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20986
 20987
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 390
* EL050.cbl
 20989
 20990******************************************************************
 20991*                                                                *
 20992*            E R R O R   F O R M A T   R O U T I N E             *
 20993*                                                                *
 20994******************************************************************
 20995
 20996 9900-ERROR-FORMAT.
 20997
 20998     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20999                    PB-COMMON-ERROR (2) OR
 21000                    PB-COMMON-ERROR (3) OR
 21001                    PB-COMMON-ERROR (4) OR
 21002                    PB-COMMON-ERROR (5) OR
 21003                    PB-COMMON-ERROR (6) OR
 21004                    PB-COMMON-ERROR (7) OR
 21005                    PB-COMMON-ERROR (8) OR
 21006                    PB-COMMON-ERROR (9) OR
 21007                    PB-COMMON-ERROR (10)
 21008        GO TO 9900-EXIT.
 21009
 21010     IF PB-NO-OF-ERRORS = +10
 21011        GO TO 9900-EXIT.
 21012
 21013     ADD +1  TO PB-NO-OF-ERRORS.
 21014     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21015                                       (PB-NO-OF-ERRORS).
 21016 9900-EXIT.
 21017     EXIT.
 21018
 21019 9990-RETURN.
 21020     IF BROWSE-STARTED
 21021
 21022* EXEC CICS ENDBR
 21023*            DATASET  (ACCT-ID)
 21024*       END-EXEC.
 21025     MOVE 0
 21026       TO DFHEIV11
 21027*    MOVE '&2                    $   #00019474' TO DFHEIV0
 21028     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21030     MOVE X'2020233030303139343734' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           ACCT-ID,
 21033           DFHEIV11,
 21034           DFHEIV99
 21035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21036
 21037
 21038 9990-EXIT.
 21039     EXIT.
 21040
 21041
 21042****Check for CRTO record, add one if not found.
 21043 9991-CHECK-FOR-ELCRTO.
 21044
 21045* EXEC CICS HANDLE CONDITION
 21046*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 391
* EL050.cbl
 21047*         ENDFILE (9991-CRTO-NOT-FOUND)
 21048*     END-EXEC.
 21049*    MOVE '"$I''                  ! @ #00019484' TO DFHEIV0
 21050     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21052     MOVE X'4020233030303139343834' TO DFHEIV0(25:11)
 21053     CALL 'kxdfhei1' USING DFHEIV0
 21054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21055
 21056     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21057     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21058     MOVE +0                     TO ELCRTO-SEQ-NO
 21059
 21060
 21061* EXEC CICS READ
 21062*       DATASET   ('ELCRTO')
 21063*       INTO      (ORIGINAL-CERTIFICATE)
 21064*       RIDFLD    (ELCRTO-KEY)
 21065*       GTEQ
 21066*       RESP      (WS-RESPONSE)
 21067*    END-EXEC
 21068     MOVE LENGTH OF
 21069      ORIGINAL-CERTIFICATE
 21070       TO DFHEIV11
 21071     MOVE 'ELCRTO' TO DFHEIV1
 21072*    MOVE '&"IL       G          (  N#00019492' TO DFHEIV0
 21073     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21075     MOVE X'204E233030303139343932' TO DFHEIV0(25:11)
 21076     CALL 'kxdfhei1' USING DFHEIV0,
 21077           DFHEIV1,
 21078           ORIGINAL-CERTIFICATE,
 21079           DFHEIV11,
 21080           ELCRTO-KEY,
 21081           DFHEIV99,
 21082           DFHEIV99,
 21083           DFHEIV99
 21084     MOVE EIBRESP  TO WS-RESPONSE
 21085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21086
 21087     IF WS-RESP-NORMAL
 21088        AND (OC-CONTROL-PRIMARY (1:33) =
 21089                 PB-CONTROL-BY-ACCOUNT (1:33))
 21090        AND (OC-RECORD-TYPE =  'I')
 21091           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21092               GO TO 9991-CHECK-INDICATORS
 21093           ELSE
 21094               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21095               GO TO 9991-CRTO-ADD-REC
 21096           END-IF
 21097     END-IF.
 21098
 21099 9991-CRTO-NOT-FOUND.
 21100
 21101     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21102     MOVE 'OC'                TO OC-RECORD-ID
 21103     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21104                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 392
* EL050.cbl
 21105     MOVE +4096               TO OC-KEY-SEQ-NO.
 21106
 21107 9991-CRTO-ADD-REC.
 21108
 21109     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21110     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21111     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21112     MOVE 'I'                 TO OC-RECORD-TYPE
 21113     IF PB-ISSUE
 21114         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21115         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21116         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21117         MOVE PB-I-AGE               TO OC-INS-AGE
 21118         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21119         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21120         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21121         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21122         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21123         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21124         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21125         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21126         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21127         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21128         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21129         IF PB-I-JOINT-COMMISSION > +0
 21130             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21131         ELSE
 21132             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21133         END-IF
 21134         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21135         MOVE +0                     TO OC-LF-CANCEL-AMT
 21136                                        OC-LF-ITD-CANCEL-AMT
 21137         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21138         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21139         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21140         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21141         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21142         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21143         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21144         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21145         MOVE +0                     TO OC-AH-CANCEL-AMT
 21146                                        OC-AH-ITD-CANCEL-AMT
 21147         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21148         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21149         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21150     ELSE
 21151         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21152         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21153         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21154         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21155         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21156         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21157         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21158         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21159         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21160          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21161             MOVE SPACES             TO OC-LF-BENCD
 21162             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 393
* EL050.cbl
 21163                                        OC-LF-BEN-AMT
 21164                                        OC-LF-PRM-AMT
 21165                                        OC-LF-ALT-BEN-AMT
 21166                                        OC-LF-ALT-PRM-AMT
 21167                                        OC-LF-COMM-PCT
 21168                                        OC-LF-CANCEL-AMT
 21169             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21170             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21171         ELSE
 21172             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21173             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21174             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21175             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21176             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21177             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21178             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21179             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21180             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21181             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21182         END-IF
 21183         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21184         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21185          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21186             MOVE SPACES             TO OC-AH-BENCD
 21187             MOVE ZEROS              TO OC-AH-TERM
 21188                                        OC-AH-BEN-AMT
 21189                                        OC-AH-PRM-AMT
 21190                                        OC-AH-COMM-PCT
 21191                                        OC-AH-CANCEL-AMT
 21192                                        OC-AH-CP
 21193             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21194             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21195         ELSE
 21196             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21197             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21198             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21199             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21200             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21201             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21202             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21203             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21204             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21205         END-IF
 21206         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21207         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21208         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21209         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21210     END-IF
 21211     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21212
 21213     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21214
 21215
 21216* EXEC CICS READ
 21217*         DATASET   (FILE-ERMAIL)
 21218*         RIDFLD    (MA-CONTROL-PRIMARY)
 21219*         INTO      (MAILING-DATA)
 21220*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 394
* EL050.cbl
 21221*    END-EXEC
 21222     MOVE LENGTH OF
 21223      MAILING-DATA
 21224       TO DFHEIV11
 21225*    MOVE '&"IL       E          (  N#00019628' TO DFHEIV0
 21226     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21228     MOVE X'204E233030303139363238' TO DFHEIV0(25:11)
 21229     CALL 'kxdfhei1' USING DFHEIV0,
 21230           FILE-ERMAIL,
 21231           MAILING-DATA,
 21232           DFHEIV11,
 21233           MA-CONTROL-PRIMARY,
 21234           DFHEIV99,
 21235           DFHEIV99,
 21236           DFHEIV99
 21237     MOVE EIBRESP  TO WS-RESPONSE
 21238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21239
 21240     IF WS-RESP-NORMAL
 21241         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21242     END-IF.
 21243
 21244     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21245     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21246
 21247
 21248* EXEC CICS READ
 21249*         DATASET  (CRTT-ID)
 21250*         RIDFLD   (WS-ELCRTT-KEY)
 21251*         INTO     (CERTIFICATE-TRAILERS)
 21252*         RESP     (WS-RESPONSE)
 21253*    END-EXEC
 21254     MOVE LENGTH OF
 21255      CERTIFICATE-TRAILERS
 21256       TO DFHEIV11
 21257*    MOVE '&"IL       E          (  N#00019642' TO DFHEIV0
 21258     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21260     MOVE X'204E233030303139363432' TO DFHEIV0(25:11)
 21261     CALL 'kxdfhei1' USING DFHEIV0,
 21262           CRTT-ID,
 21263           CERTIFICATE-TRAILERS,
 21264           DFHEIV11,
 21265           WS-ELCRTT-KEY,
 21266           DFHEIV99,
 21267           DFHEIV99,
 21268           DFHEIV99
 21269     MOVE EIBRESP  TO WS-RESPONSE
 21270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21271
 21272     IF WS-RESP-NORMAL
 21273         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21274         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21275     END-IF.
 21276
 21277
 21278* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 395
* EL050.cbl
 21279*       DATASET   ('ELCRTO')
 21280*       FROM      (ORIGINAL-CERTIFICATE)
 21281*       RIDFLD    (OC-CONTROL-PRIMARY)
 21282*       RESP      (WS-RESPONSE)
 21283*    END-EXEC.
 21284     MOVE LENGTH OF
 21285      ORIGINAL-CERTIFICATE
 21286       TO DFHEIV11
 21287     MOVE 'ELCRTO' TO DFHEIV1
 21288*    MOVE '&$ L                  ''  N#00019654' TO DFHEIV0
 21289     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21290     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21291     MOVE X'204E233030303139363534' TO DFHEIV0(25:11)
 21292     CALL 'kxdfhei1' USING DFHEIV0,
 21293           DFHEIV1,
 21294           ORIGINAL-CERTIFICATE,
 21295           DFHEIV11,
 21296           OC-CONTROL-PRIMARY,
 21297           DFHEIV99,
 21298           DFHEIV99
 21299     MOVE EIBRESP  TO WS-RESPONSE
 21300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21301
 21302
 21303     GO TO 9991-EXIT.
 21304
 21305 9991-CHECK-INDICATORS.
 21306
 21307     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21308         GO TO 9991-EXIT
 21309     END-IF.
 21310
 21311     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21312         GO TO 9991-EXIT
 21313     END-IF.
 21314
 21315
 21316* EXEC CICS READ
 21317*       DATASET   ('ELCRTO')
 21318*       INTO      (ORIGINAL-CERTIFICATE)
 21319*       RIDFLD    (OC-CONTROL-PRIMARY)
 21320*       UPDATE
 21321*       RESP      (WS-RESPONSE)
 21322*    END-EXEC
 21323     MOVE LENGTH OF
 21324      ORIGINAL-CERTIFICATE
 21325       TO DFHEIV11
 21326     MOVE 'ELCRTO' TO DFHEIV1
 21327*    MOVE '&"IL       EU         (  N#00019673' TO DFHEIV0
 21328     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21329     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21330     MOVE X'204E233030303139363733' TO DFHEIV0(25:11)
 21331     CALL 'kxdfhei1' USING DFHEIV0,
 21332           DFHEIV1,
 21333           ORIGINAL-CERTIFICATE,
 21334           DFHEIV11,
 21335           OC-CONTROL-PRIMARY,
 21336           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 396
* EL050.cbl
 21337           DFHEIV99,
 21338           DFHEIV99
 21339     MOVE EIBRESP  TO WS-RESPONSE
 21340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21341     IF WS-RESP-NORMAL
 21342        IF PB-ISSUE
 21343          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21344          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21345          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21346          MOVE PB-I-AGE               TO OC-INS-AGE
 21347          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21348          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21349          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21350          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21351          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21352          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21353          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21354          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21355          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21356          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21357          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21358          IF PB-I-JOINT-COMMISSION > +0
 21359              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21360          ELSE
 21361              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21362          END-IF
 21363          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21364          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21365          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21366          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21367          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21368          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21369          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21370          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21371          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21372
 21373          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21374
 21375* EXEC CICS READ
 21376*             DATASET   (FILE-ERMAIL)
 21377*             RIDFLD    (MA-CONTROL-PRIMARY)
 21378*             INTO      (MAILING-DATA)
 21379*             RESP      (WS-RESPONSE)
 21380*         END-EXEC
 21381     MOVE LENGTH OF
 21382      MAILING-DATA
 21383       TO DFHEIV11
 21384*    MOVE '&"IL       E          (  N#00019713' TO DFHEIV0
 21385     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21387     MOVE X'204E233030303139373133' TO DFHEIV0(25:11)
 21388     CALL 'kxdfhei1' USING DFHEIV0,
 21389           FILE-ERMAIL,
 21390           MAILING-DATA,
 21391           DFHEIV11,
 21392           MA-CONTROL-PRIMARY,
 21393           DFHEIV99,
 21394           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 397
* EL050.cbl
 21395           DFHEIV99
 21396     MOVE EIBRESP  TO WS-RESPONSE
 21397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21398          IF WS-RESP-NORMAL
 21399             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21400          END-IF
 21401
 21402          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21403          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21404
 21405* EXEC CICS READ
 21406*             DATASET  (CRTT-ID)
 21407*             RIDFLD   (WS-ELCRTT-KEY)
 21408*             INTO     (CERTIFICATE-TRAILERS)
 21409*             RESP     (WS-RESPONSE)
 21410*         END-EXEC
 21411     MOVE LENGTH OF
 21412      CERTIFICATE-TRAILERS
 21413       TO DFHEIV11
 21414*    MOVE '&"IL       E          (  N#00019725' TO DFHEIV0
 21415     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21417     MOVE X'204E233030303139373235' TO DFHEIV0(25:11)
 21418     CALL 'kxdfhei1' USING DFHEIV0,
 21419           CRTT-ID,
 21420           CERTIFICATE-TRAILERS,
 21421           DFHEIV11,
 21422           WS-ELCRTT-KEY,
 21423           DFHEIV99,
 21424           DFHEIV99,
 21425           DFHEIV99
 21426     MOVE EIBRESP  TO WS-RESPONSE
 21427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21428          IF WS-RESP-NORMAL
 21429             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21430                               OC-INS-AGE-DEFAULT-FLAG
 21431             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21432                               OC-JNT-AGE-DEFAULT-FLAG
 21433          END-IF
 21434
 21435        ELSE
 21436          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21437             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21438             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21439             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21440          END-IF
 21441          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21442             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21443             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21444             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21445          END-IF
 21446          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21447        END-IF
 21448
 21449* EXEC CICS REWRITE
 21450*          DATASET   ('ELCRTO')
 21451*          FROM      (ORIGINAL-CERTIFICATE)
 21452*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 398
* EL050.cbl
 21453*       END-EXEC
 21454     MOVE LENGTH OF
 21455      ORIGINAL-CERTIFICATE
 21456       TO DFHEIV11
 21457     MOVE 'ELCRTO' TO DFHEIV1
 21458*    MOVE '&& L                  %  N#00019751' TO DFHEIV0
 21459     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21461     MOVE X'204E233030303139373531' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0,
 21463           DFHEIV1,
 21464           ORIGINAL-CERTIFICATE,
 21465           DFHEIV11,
 21466           DFHEIV99
 21467     MOVE EIBRESP  TO WS-RESPONSE
 21468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21469     END-IF.
 21470
 21471 9991-EXIT.
 21472     EXIT.
 21473
 21474
 21475 9999-RETURN.
 21476     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21477
 21478
 21479* EXEC CICS RETURN
 21480*    END-EXEC.
 21481*    MOVE '.(                    ''   #00019765' TO DFHEIV0
 21482     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21484     MOVE X'2020233030303139373635' TO DFHEIV0(25:11)
 21485     CALL 'kxdfhei1' USING DFHEIV0,
 21486           DFHEIV99,
 21487           DFHEIV99,
 21488           DFHEIV99,
 21489           DFHEIV99,
 21490           DFHEIV99,
 21491           DFHEIV99
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21493
 21494
 21495
 21496* GOBACK.
 21497     MOVE '9%                    "   ' TO DFHEIV0
 21498     MOVE 'EL050' TO DFHEIV1
 21499     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21500     GOBACK.
 21501
 21502 9999-DFHBACK SECTION.
 21503     MOVE '9%                    "   ' TO DFHEIV0
 21504     MOVE 'EL050' TO DFHEIV1
 21505     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21506     GOBACK.
 21507 9999-DFHEXIT.
 21508     IF DFHEIGDJ EQUAL 0001
 21509         NEXT SENTENCE
 21510     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 399
* EL050.cbl
 21511         GO TO 9300-ABEND,
 21512               3990-FILES-NOT-OPEN
 21513         DEPENDING ON DFHEIGDI
 21514     ELSE IF DFHEIGDJ EQUAL 3
 21515         GO TO 6610-START-BROWSE,
 21516               6630-ERRESS-PROBLEM,
 21517               6630-END-OF-FILE
 21518         DEPENDING ON DFHEIGDI
 21519     ELSE IF DFHEIGDJ EQUAL 4
 21520         GO TO 6630-END-OF-FILE,
 21521               6630-ERRESS-PROBLEM,
 21522               6630-ERRESS-PROBLEM,
 21523               6630-END-OF-FILE
 21524         DEPENDING ON DFHEIGDI
 21525     ELSE IF DFHEIGDJ EQUAL 5
 21526         GO TO 6630-END-OF-FILE,
 21527               6630-END-OF-FILE,
 21528               6630-ERRESS-PROBLEM,
 21529               6630-ERRESS-PROBLEM
 21530         DEPENDING ON DFHEIGDI
 21531     ELSE IF DFHEIGDJ EQUAL 6
 21532         GO TO 6660-START-BROWSE,
 21533               6690-ERRESC-PROBLEM,
 21534               6690-ERRESC-PROBLEM,
 21535               6690-END-OF-FILE
 21536         DEPENDING ON DFHEIGDI
 21537     ELSE IF DFHEIGDJ EQUAL 7
 21538         GO TO 6690-END-OF-FILE,
 21539               6690-ERRESC-PROBLEM,
 21540               6690-ERRESC-PROBLEM,
 21541               6690-END-OF-FILE
 21542         DEPENDING ON DFHEIGDI
 21543     ELSE IF DFHEIGDJ EQUAL 8
 21544         GO TO 6690-END-OF-FILE,
 21545               6690-ERRESC-PROBLEM,
 21546               6690-ERRESC-PROBLEM,
 21547               6690-END-OF-FILE
 21548         DEPENDING ON DFHEIGDI
 21549     ELSE IF DFHEIGDJ EQUAL 9
 21550         GO TO 7250-CONTINUE,
 21551               7250-CONTINUE
 21552         DEPENDING ON DFHEIGDI
 21553     ELSE IF DFHEIGDJ EQUAL 10
 21554         GO TO 7300-CONTINUE,
 21555               7300-CONTINUE
 21556         DEPENDING ON DFHEIGDI
 21557     ELSE IF DFHEIGDJ EQUAL 11
 21558         GO TO 8000-FREE-MAIN
 21559         DEPENDING ON DFHEIGDI
 21560     ELSE IF DFHEIGDJ EQUAL 12
 21561         GO TO 8100-NOTFND,
 21562               8100-NOTFND
 21563         DEPENDING ON DFHEIGDI
 21564     ELSE IF DFHEIGDJ EQUAL 13
 21565         GO TO 8110-NOTFND,
 21566               8110-NOTFND
 21567         DEPENDING ON DFHEIGDI
 21568     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 400
* EL050.cbl
 21569         GO TO 8130-EXIT
 21570         DEPENDING ON DFHEIGDI
 21571     ELSE IF DFHEIGDJ EQUAL 15
 21572         GO TO 8180-NOTFND
 21573         DEPENDING ON DFHEIGDI
 21574     ELSE IF DFHEIGDJ EQUAL 16
 21575         GO TO 8190-NOTFND
 21576         DEPENDING ON DFHEIGDI
 21577     ELSE IF DFHEIGDJ EQUAL 17
 21578         GO TO 8195-NOTFND
 21579         DEPENDING ON DFHEIGDI
 21580     ELSE IF DFHEIGDJ EQUAL 18
 21581         GO TO 8200-NOTFND
 21582         DEPENDING ON DFHEIGDI
 21583     ELSE IF DFHEIGDJ EQUAL 19
 21584         GO TO 8300-NOTFND,
 21585               8300-ERRESS-PROBLEM,
 21586               8300-ERRESS-PROBLEM,
 21587               8300-NOTFND
 21588         DEPENDING ON DFHEIGDI
 21589     ELSE IF DFHEIGDJ EQUAL 20
 21590         GO TO 8450-FORM-NOT-FOUND,
 21591               8450-FORM-NOT-FOUND
 21592         DEPENDING ON DFHEIGDI
 21593     ELSE IF DFHEIGDJ EQUAL 21
 21594         GO TO 0199-ACCT-NOT-FOUND,
 21595               0199-ACCT-NOT-FOUND
 21596         DEPENDING ON DFHEIGDI
 21597     ELSE IF DFHEIGDJ EQUAL 22
 21598         GO TO 0199-ACCT-NOT-FOUND,
 21599               0199-ACCT-NOT-FOUND
 21600         DEPENDING ON DFHEIGDI
 21601     ELSE IF DFHEIGDJ EQUAL 23
 21602         GO TO 8582-COMP-NOT-FOUND,
 21603               8582-COMP-NOT-FOUND
 21604         DEPENDING ON DFHEIGDI
 21605     ELSE IF DFHEIGDJ EQUAL 24
 21606         GO TO 8583-AGTC-NOT-FOUND,
 21607               8583-AGTC-NOT-FOUND
 21608         DEPENDING ON DFHEIGDI
 21609     ELSE IF DFHEIGDJ EQUAL 25
 21610         GO TO 8584-BXRF-NOT-FOUND,
 21611               8584-BXRF-NOT-FOUND
 21612         DEPENDING ON DFHEIGDI
 21613     ELSE IF DFHEIGDJ EQUAL 26
 21614         GO TO 8585-PLAN-NOT-FOUND,
 21615               8585-PLAN-NOT-FOUND
 21616         DEPENDING ON DFHEIGDI
 21617     ELSE IF DFHEIGDJ EQUAL 27
 21618         GO TO 0299-CERT-NOT-FOUND
 21619         DEPENDING ON DFHEIGDI
 21620     ELSE IF DFHEIGDJ EQUAL 28
 21621         GO TO 8700-READ-CERT-MASTER
 21622         DEPENDING ON DFHEIGDI
 21623     ELSE IF DFHEIGDJ EQUAL 29
 21624         GO TO 8720-COMP-ACCOUNTS,
 21625               8730-END-BROWSE,
 21626               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 401
* EL050.cbl
 21627         DEPENDING ON DFHEIGDI
 21628     ELSE IF DFHEIGDJ EQUAL 30
 21629         GO TO 9000-NOTFND
 21630         DEPENDING ON DFHEIGDI
 21631     ELSE IF DFHEIGDJ EQUAL 31
 21632         GO TO 9100-NOTFND,
 21633               9100-NOTFND
 21634         DEPENDING ON DFHEIGDI
 21635     ELSE IF DFHEIGDJ EQUAL 32
 21636         GO TO 9991-CRTO-NOT-FOUND,
 21637               9991-CRTO-NOT-FOUND
 21638         DEPENDING ON DFHEIGDI.
 21639     MOVE '9%                    "   ' TO DFHEIV0
 21640     MOVE 'EL050' TO DFHEIV1
 21641     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21642     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87395
