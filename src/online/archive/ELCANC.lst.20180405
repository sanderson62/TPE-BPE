* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   1
* ELCANC.cbl
* Options: int("ELCANC.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELCANC.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELCANC.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELCANC.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELCANC.
     4*
     5*AUTHOR.     PABLO.
     6*            OMAHA, NE.
     7
     8*DATE-COMPILED.
     9
    10*SECURITY.   *****************************************************
    11*            *                                                   *
    12*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   2
* ELCANC.cbl
    14*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    15*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    16*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    17*            *                                                   *
    18*            *****************************************************
    19
    20*REMARKS.    *****************************************************
    21*            *                                                   *
    22*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    23*            *    OPTION SPECIFIED, CREATE A PENDING BATCH       *
    24*            *    AND CANCEL RECORD.                             *
    25*            *                                                   *
    26*            *    ORIGINAL BENEFIT = CP-ORIGINAL-BENEFIT         *
    27*            *    ORIGINAL TERM = CP-ORIGINAL-TERM               *
    28*            *    REMAINING-TERM  = CP-REMAINING-TERM            *
    29*            *    A.P.R (FOR NET PAY) = CP-LOAN-APR              *
    30*            *    BENEFIT TYPE = CP-BENEFIT-TYPE                 *
    31*            *    METHOD = CP-EARNING-METHOD                     *
    32*            *    IF COMPANY SPECIAL METHOD  - PUT COMPANY       *
    33*            *     I.D. IN CP-COMPANY-ID.                        *
    34*            *                                                   *
    35*            *****************************************************
    36******************************************************************
    37*                   C H A N G E   L O G
    38*
    39* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    40*-----------------------------------------------------------------
    41*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    42* EFFECTIVE    NUMBER
    43*-----------------------------------------------------------------
    44* 122711    2011022800001  AJRA  INCREMENT CERT SUFFIX
    45* 010412    2011022800001  AJRA  NAPERSOFT
    46* 091312    2012091100004  AJRA  FIX 1ST PMT DT PROCESS
    47* 091812  IR2012091400003  AJRA  POPULATE CARR,GRP,ST ON CANCEL
    48* 092512  IR2012092500004  AJRA  HANDLE DUPREC ON ADD
    49* 101512    2011022800001  AJRA  INCREASE DELAY ON BACKGROUND EDIT
    50* 120512    2012101700001  AJRA  FIX NON NUMERIC BATCH NO
    51* 121012    2012121000001  AJRA  FIX NEW BATCH NO
    52* 122712  CR2012101700002  AJRA  PUT P IN EC FIELD IF NO COMM PCTS
    53*                                ON CERT BUT COMM PCTS ON ACCT
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    56* 100917  CR2017092000002  PEMA  Copy Elcrtt to new cert issue.
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   3
* ELCANC.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64 77  FILLER   PIC X(32) VALUE '********************************'.
    65 77  FILLER   PIC X(32) VALUE '**  ELCANC  WORKING STORAGE   **'.
    66 77  FILLER   PIC X(32) VALUE '********* VMOD 2.001 ***********'.
    67 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    68     88  CERT-FOUND                  VALUE 'Y'.
    69 77  WS-ELCNTL-SW                PIC X  VALUE ' '.
    70     88  CNTL-FOUND                  VALUE 'Y'.
    71 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    72     88  ACCT-FOUND                  VALUE 'Y'.
    73 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    74     88  PNDB-FOUND                  VALUE 'Y'.
    75 77  SUB1                        PIC S999 COMP-3 VALUE +0.
    76 77  WS-BATCH-NO-N               PIC 9(6).
    77 77  WS-BATCH-NO                 PIC X(6).
    78 77  WS-NEXT-SEQ-NO              PIC 9(4) BINARY VALUE ZEROS.
    79 77  WS-RESPONSE         PIC S9(8)   COMP.
    80     88  RESP-NORMAL              VALUE +00.
    81     88  RESP-ERROR               VALUE +01.
    82     88  RESP-NOTFND              VALUE +13.
    83     88  RESP-DUPREC              VALUE +14.
    84     88  RESP-DUPKEY              VALUE +15.
    85
    86 01  ws-hold-erpndb              pic x(585).
    87 01  WS-ELCERT-KEY               PIC X(33).
    88 01  ws-elcrtt-key               pic x(34).
    89 01  WS-WORK.
    90     05  WS-WRK-SFX-COMP         PIC S9(4) COMP.
    91     05  WS-WRK-SFX-R REDEFINES WS-WRK-SFX-COMP.
    92         10  FILLER              PIC X.
    93         10  WS-WRK-SFX          PIC X.
    94
    95 01  WS-ERPNDB-KEY.
    96     05  PNDB-COMPANY-CD         PIC X.
    97     05  PNDB-BATCH-NO           PIC X(6).
    98     05  PNDB-BATCH-SEQ          PIC 9(4) BINARY.
    99     05  PNDB-BATCH-CHG-SEQ      PIC 9(4) BINARY.
   100 01  WS-ERPNDB2-KEY.
   101     05  F                       PIC X(32).
   102     05  PNDB2-CERT-SUFFIX       PIC X.
   103     05  PNDB2-SEQ-NO            PIC 9(4) BINARY.
   104     05  PNDB2-REC-TYPE          PIC X.
   105 01  WS-ERACCT-KEY.
   106     05  ACCT-COMPANY-CD         PIC X.
   107     05  ACCT-CARRIER            PIC X.
   108     05  ACCT-GROUP              PIC X(6).
   109     05  ACCT-STATE              PIC XX.
   110     05  ACCT-ACCOUNT            PIC X(10).
   111     05  ACCT-EXP-DT             PIC XX.
   112     05  F                       PIC X(4).
   113 01  WS-ELCNTL-KEY.
   114     05  CNTL-COMP-ID            PIC XXX.
   115     05  CNTL-REC-TYPE           PIC X.
   116     05  CNTL-ACCESS             PIC XXXX.
   117     05  CNTL-SEQ-NO             PIC 9(4) BINARY.
   118 01  BATCH-TO-PROCESS.
   119     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   4
* ELCANC.cbl
   120     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
   121     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
   122     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
   123 01  CANCEL-GEN-PASS-AREA.
   124     05  CG-OPTION-CODE          PIC X.
   125         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   126         88  CG-FLAT-CANCEL        VALUE '1'.
   127         88  CG-CANCEL             VALUE '2'.
   128         88  CG-CANCEL-REISSUE     VALUE '3'.
   129         88  CG-FLAT-CANCEL-SAME-BATCH VALUE '4'.
   130     05  CG-ERROR-CODE           PIC 99.
   131         88  CG-SUCCESS            VALUE 00.
   132         88  CG-DATE-ERROR         VALUE 01.
   133         88  CG-CERT-NOT-FOUND     VALUE 02.
   134         88  CG-AMOUNT-ERROR       VALUE 04.
   135         88  CG-OPTION-ERROR       VALUE 05.
   136         88  CG-PREV-CAN           VALUE 06.
   137         88  CG-INVALID-DATA       VALUE 07.
   138         88  CG-NO-ACCT-MSTR       VALUE 08.
   139         88  CG-SFX-A-EXIST        VALUE 09.
   140         88  CG-MISC-ERROR         VALUE 99.
   141     05  CG-COMPANY-ID           PIC XXX.
   142     05  CG-PROC-ID              PIC XXXX.
   143     05  CG-CURRENT-DT           PIC XX.
   144     05  CG-MONTH-END-DT         PIC XX.
   145     05  CG-CERT-KEY.
   146         10  CG-CERT-COMPANY-CD  PIC X.
   147         10  CG-CERT-CARRIER     PIC X.
   148         10  CG-CERT-GROUP       PIC X(6).
   149         10  CG-CERT-STATE       PIC XX.
   150         10  CG-CERT-ACCOUNT     PIC X(10).
   151         10  CG-CERT-EFF-DT      PIC XX.
   152         10  CG-CERT-CERT-NO     PIC X(11).
   153     05  CG-LF-CAN-DATA.
   154         10  CG-LF-CAN-DT        PIC XX.
   155         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   156     05  CG-AH-CAN-DATA.
   157         10  CG-AH-CAN-DT        PIC XX.
   158         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   159     05  CG-CERT-PROFILE-DATA.
   160         10  CG-INS-LNAME        PIC X(15).
   161         10  CG-INS-FNAME        PIC X(10).
   162         10  CG-INS-MID-INIT     PIC X.
   163         10  CG-INS-AGE          PIC 99.
   164         10  CG-JNT-LNAME        PIC X(15).
   165         10  CG-JNT-FNAME        PIC X(10).
   166         10  CG-JNT-MID-INIT     PIC X.
   167         10  CG-JNT-AGE          PIC 99.
   168     05  CG-LF-ISS-DATA.
   169         10  CG-LF-BENCD         PIC XX.
   170         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   171         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   172     05  CG-AH-ISS-DATA.
   173         10  CG-AH-BENCD         PIC XX.
   174         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   175     05  CG-BATCH-NO             PIC X(6).
   176     05  CG-BATCH-SEQ-NO         PIC 9(4) COMP.
   177     05  CG-DCC-REASON-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   5
* ELCANC.cbl
   178     05  CG-COMM-PCT-ZERO        PIC X.
   179     05  cg-vin                  pic x(17).
   180     05  FILLER                  PIC X(287).
   181*                          COPY ELCCNTL.
   182******************************************************************
   183*                                                                *
   184*                                                                *
   185*                            ELCCNTL.                            *
   186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   187*                            VMOD=2.059                          *
   188*                                                                *
   189*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   190*                                                                *
   191*   FILE TYPE = VSAM,KSDS                                        *
   192*   RECORD SIZE = 750  RECFORM = FIXED                           *
   193*                                                                *
   194*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   195*       ALTERNATE INDEX = NONE                                   *
   196*                                                                *
   197*   LOG = YES                                                    *
   198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   199******************************************************************
   200*                   C H A N G E   L O G
   201*
   202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   203*-----------------------------------------------------------------
   204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   205* EFFECTIVE    NUMBER
   206*-----------------------------------------------------------------
   207* 082503                   PEMA  ADD BENEFIT GROUP
   208* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   209* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   210* 092705    2005050300006  PEMA  ADD SPP LEASES
   211* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   212* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   213* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   214* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   215* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   216* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   217* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   218* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   219* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   220* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   221******************************************************************
   222*
   223 01  CONTROL-FILE.
   224     12  CF-RECORD-ID                       PIC XX.
   225         88  VALID-CF-ID                        VALUE 'CF'.
   226
   227     12  CF-CONTROL-PRIMARY.
   228         16  CF-COMPANY-ID                  PIC XXX.
   229         16  CF-RECORD-TYPE                 PIC X.
   230             88  CF-COMPANY-MASTER              VALUE '1'.
   231             88  CF-PROCESSOR-MASTER            VALUE '2'.
   232             88  CF-STATE-MASTER                VALUE '3'.
   233             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   234             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   235             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   6
* ELCANC.cbl
   236             88  CF-MORTALITY-MASTER            VALUE '7'.
   237             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   238             88  CF-TERMINAL-MASTER             VALUE '9'.
   239             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   240             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   241             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   242             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   243             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   244             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   245             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   246             88  CF-REMINDERS-MASTER            VALUE 'R'.
   247             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   248         16  CF-ACCESS-CD-GENL              PIC X(4).
   249         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   250             20  CF-PROCESSOR               PIC X(4).
   251         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   252             20  CF-STATE-CODE              PIC XX.
   253             20  FILLER                     PIC XX.
   254         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   255             20  FILLER                     PIC XX.
   256             20  CF-HI-BEN-IN-REC           PIC XX.
   257         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   258             20  FILLER                     PIC XXX.
   259             20  CF-CARRIER-CNTL            PIC X.
   260         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   261             20  FILLER                     PIC XX.
   262             20  CF-HI-TYPE-IN-REC          PIC 99.
   263         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   264             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   265                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   266             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   267             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   268         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   269             20  FILLER                     PIC X.
   270             20  CF-CUSTOM-REPORT-NO        PIC 999.
   271         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   272             20  FILLER                     PIC XX.
   273             20  CF-MORTGAGE-PLAN           PIC XX.
   274         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   275
   276     12  CF-LAST-MAINT-DT                   PIC XX.
   277     12  CF-LAST-MAINT-BY                   PIC X(4).
   278     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   279
   280     12  CF-RECORD-BODY                     PIC X(728).
   281
   282
   283****************************************************************
   284*             COMPANY MASTER RECORD                            *
   285****************************************************************
   286
   287     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   288         16  CF-COMPANY-ADDRESS.
   289             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   290             20  CF-CL-IN-CARE-OF           PIC X(30).
   291             20  CF-CL-ADDR-LINE-1          PIC X(30).
   292             20  CF-CL-ADDR-LINE-2          PIC X(30).
   293             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   7
* ELCANC.cbl
   294             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   295             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   296         16  CF-COMPANY-CD                  PIC X.
   297         16  CF-COMPANY-PASSWORD            PIC X(8).
   298         16  CF-SECURITY-OPTION             PIC X.
   299             88  ALL-SECURITY                   VALUE '1'.
   300             88  COMPANY-VERIFY                 VALUE '2'.
   301             88  PROCESSOR-VERIFY               VALUE '3'.
   302             88  NO-SECURITY                    VALUE '4'.
   303             88  ALL-BUT-TERM                   VALUE '5'.
   304         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   305             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   306         16  CF-LGX-INTERFACE-CNTL          PIC X.
   307             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   308         16  CF-INFORCE-LOCATION            PIC X.
   309             88  CERTS-ARE-ONLINE               VALUE '1'.
   310             88  CERTS-ARE-OFFLINE              VALUE '2'.
   311             88  NO-CERTS-AVAILABLE             VALUE '3'.
   312         16  CF-LOWER-CASE-LETTERS          PIC X.
   313         16  CF-CERT-ACCESS-CONTROL         PIC X.
   314             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   315             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   316             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   317             88  CF-ACCNT-CNTL                  VALUE '3'.
   318             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   319
   320         16  CF-FORMS-PRINTER-ID            PIC X(4).
   321         16  CF-CHECK-PRINTER-ID            PIC X(4).
   322
   323         16  CF-LGX-CREDIT-USER             PIC X.
   324             88  CO-IS-NOT-USER                 VALUE 'N'.
   325             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   326
   327         16 CF-CREDIT-CALC-CODES.
   328             20  CF-CR-REM-TERM-CALC PIC X.
   329               88  CR-EARN-AFTER-15TH           VALUE '1'.
   330               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   331               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   332               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   333               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   334               88  CR-EARN-AFTER-14TH           VALUE '6'.
   335               88  CR-EARN-AFTER-16TH           VALUE '7'.
   336             20  CF-CR-R78-METHOD           PIC X.
   337               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   338               88  DONT-USE-PLUS-ONE            VALUE '1'.
   339
   340         16  CF-CLAIM-CONTROL-COUNTS.
   341             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   342                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   343
   344             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   345                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   346
   347             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   348                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   349
   350             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   351                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   8
* ELCANC.cbl
   352
   353         16  CF-CURRENT-MONTH-END           PIC XX.
   354
   355         16  CF-CO-CALC-QUOTE-TOLERANCE.
   356             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   357             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   358             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   359             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   360                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   361                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   362             20  CF-CO-PREM-REJECT-SW       PIC X.
   363                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   364                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   365             20  CF-CO-REF-REJECT-SW        PIC X.
   366                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   367                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   368
   369         16  CF-CO-REPORTING-DT             PIC XX.
   370         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   371         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   372           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   373           88  CF-CO-MONTH-END                  VALUE '1'.
   374
   375         16  CF-LGX-CLAIM-USER              PIC X.
   376             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   377             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   378
   379         16  CF-CREDIT-EDIT-CONTROLS.
   380             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   381             20  CF-MIN-AGE                 PIC 99.
   382             20  CF-DEFAULT-AGE             PIC 99.
   383             20  CF-MIN-TERM                PIC S999      COMP-3.
   384             20  CF-MAX-TERM                PIC S999      COMP-3.
   385             20  CF-DEFAULT-SEX             PIC X.
   386             20  CF-JOINT-AGE-INPUT         PIC X.
   387                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   388             20  CF-BIRTH-DATE-INPUT        PIC X.
   389                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   390             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   391                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   392                 88  CF-ZERO-CARRIER            VALUE '1'.
   393                 88  CF-ZERO-GROUPING           VALUE '2'.
   394                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   395             20  CF-EDIT-SW                 PIC X.
   396                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   397             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   398             20  CF-CR-PR-METHOD            PIC X.
   399               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   400               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   401             20  FILLER                     PIC X.
   402
   403         16  CF-CREDIT-MISC-CONTROLS.
   404             20  CF-REIN-TABLE-SW           PIC X.
   405                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   406             20  CF-COMP-TABLE-SW           PIC X.
   407                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   408             20  CF-EXPERIENCE-RETENTION-AGE
   409                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page   9
* ELCANC.cbl
   410             20  CF-CONVERSION-DT           PIC XX.
   411             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   412             20  CF-RUN-FREQUENCY-SW        PIC X.
   413                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   414                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   415
   416             20  CF-CR-CHECK-NO-CONTROL.
   417                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   418                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   419                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   420                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   421                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   422                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   423
   424                 24  CF-CR-CHECK-COUNT       REDEFINES
   425                     CF-CR-CHECK-COUNTER      PIC X(4).
   426
   427                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   428                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   429
   430                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   431                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   432                 24  CF-MAIL-PROCESSING       PIC X.
   433                     88  MAIL-PROCESSING          VALUE 'Y'.
   434
   435         16  CF-MISC-SYSTEM-CONTROL.
   436             20  CF-SYSTEM-C                 PIC X.
   437                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   438             20  CF-SYSTEM-D                 PIC X.
   439                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   440             20  CF-SOC-SEC-NO-SW            PIC X.
   441                 88  SOC-SEC-NO-USED             VALUE '1'.
   442             20  CF-MEMBER-NO-SW             PIC X.
   443                 88  MEMBER-NO-USED              VALUE '1'.
   444             20  CF-TAX-ID-NUMBER            PIC X(11).
   445             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   446             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   447                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   448                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   449                 88  CF-ALL-APPROVED             VALUE 'Y'.
   450                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   451             20  CF-SYSTEM-E                 PIC X.
   452                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   453
   454         16  CF-LGX-LIFE-USER               PIC X.
   455             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   456             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   457
   458         16  CF-CR-MONTH-END-DT             PIC XX.
   459
   460         16  CF-FILE-MAINT-DATES.
   461             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   462                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   463             20  CF-LAST-BATCH       REDEFINES
   464                 CF-LAST-BATCH-NO               PIC X(4).
   465             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   466             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   467             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  10
* ELCANC.cbl
   468             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   469             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   470             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   471             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   472             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   473             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   474             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   475
   476         16  CF-NEXT-COMPANY-ID             PIC XXX.
   477         16  FILLER                         PIC X.
   478
   479         16  CF-ALT-MORT-CODE               PIC X(4).
   480         16  CF-MEMBER-CAPTION              PIC X(10).
   481
   482         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   483             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   484             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   485             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   486             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   487             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   488
   489         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   490
   491         16  CF-LIFE-OVERRIDE-L1            PIC X.
   492         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   493         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   494         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   495
   496         16  CF-AH-OVERRIDE-L1              PIC X.
   497         16  CF-AH-OVERRIDE-L2              PIC XX.
   498         16  CF-AH-OVERRIDE-L6              PIC X(6).
   499         16  CF-AH-OVERRIDE-L12             PIC X(12).
   500
   501         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   502         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   503
   504         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   505         16  CF-AR-LAST-EL860-DT            PIC XX.
   506         16  CF-MP-MONTH-END-DT             PIC XX.
   507
   508         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   509         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   510             88  CF-CLAIM-PAID-TO               VALUE '1'.
   511
   512         16  CF-AR-MONTH-END-DT             PIC XX.
   513
   514         16  CF-CRDTCRD-USER                PIC X.
   515             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   516             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   517
   518         16  CF-CC-MONTH-END-DT             PIC XX.
   519
   520         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   521
   522         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   523             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   524             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   525             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  11
* ELCANC.cbl
   526         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   527         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   528         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   529         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   530             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   531             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   532         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   533         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   534         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   535             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   536         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   537
   538         16  CF-CL-ZIP-CODE.
   539             20  CF-CL-ZIP-PRIME.
   540                 24  CF-CL-ZIP-1ST          PIC X.
   541                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   542                 24  FILLER                 PIC X(4).
   543             20  CF-CL-ZIP-PLUS4            PIC X(4).
   544         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   545             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   546             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   547             20  FILLER                     PIC XXX.
   548
   549         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   550         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   551         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   552         16  CF-CO-OPTION-START-DATE        PIC XX.
   553         16  CF-REM-TRM-CALC-OPTION         PIC X.
   554           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   555                                                      '3' '4'.
   556           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   557           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   558           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   559           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   560           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   561           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   562
   563         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   564
   565         16  CF-PAYMENT-APPROVAL-LEVELS.
   566             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   567             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   568             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   569             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   570             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   571             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   572
   573         16  CF-END-USER-REPORTING-USER     PIC X.
   574             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   575             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   576
   577         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   578             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   579             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   580
   581         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   582
   583         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  12
* ELCANC.cbl
   584         16  FILLER                         PIC X.
   585
   586         16  CF-CREDIT-ARCHIVE-CNTL.
   587             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   588             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   589             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   590
   591         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   592
   593         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   594             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   595             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   596
   597         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   598             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   599             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   600
   601         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   602
   603         16  CF-CO-ACH-ID-CODE              PIC  X.
   604             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
   605             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
   606             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
   607         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
   608         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
   609         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
   610         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
   611         16  CF-CO-ACH-RECV-NAME            PIC X(23).
   612         16  CF-CO-ACH-RECV-NO              PIC X(08).
   613         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
   614         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
   615         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
   616                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
   617         16  CF-CO-ACH-TRACE-SPACE REDEFINES
   618                 CF-CO-ACH-TRACE-NO         PIC X(4).
   619
   620         16  CF-CO-OVER-SHORT.
   621             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
   622             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
   623
   624*         16  FILLER                         PIC X(102).
   625         16  CF-PAYMENT-APPROVAL-LEVELS-2.
   626             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
   627             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
   628
   629         16  CF-AH-APPROVAL-DAYS.
   630             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
   631             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
   632             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
   633             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
   634
   635         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
   636
   637         16  CF-APPROV-LEV-5.
   638             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
   639             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
   640             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
   641
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  13
* ELCANC.cbl
   642         16  FILLER                         PIC X(68).
   643****************************************************************
   644*             PROCESSOR/USER RECORD                            *
   645****************************************************************
   646
   647     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   648         16  CF-PROCESSOR-NAME              PIC X(30).
   649         16  CF-PROCESSOR-PASSWORD          PIC X(11).
   650         16  CF-PROCESSOR-TITLE             PIC X(26).
   651         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
   652                 88  MESSAGE-YES                VALUE 'Y'.
   653                 88  MESSAGE-NO                 VALUE ' ' 'N'.
   654
   655*****************************************************
   656****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
   657****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
   658****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
   659****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
   660*****************************************************
   661
   662         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
   663             20  CF-ADMINISTRATION-CONTROLS PIC XX.
   664             20  CF-APPLICATION-FORCE       PIC X.
   665             20  CF-INDIVIDUAL-APP.
   666                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
   667                     28  CF-BROWSE-APP      PIC X.
   668                     28  CF-UPDATE-APP      PIC X.
   669
   670         16  CF-CURRENT-TERM-ON             PIC X(4).
   671         16  CF-PROCESSOR-LIMITS-CLAIMS.
   672             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
   673             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
   674             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
   675             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
   676             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
   677             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
   678             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
   679         16  CF-PROCESSOR-CARRIER           PIC X.
   680             88  NO-CARRIER-SECURITY            VALUE ' '.
   681         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
   682             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
   683         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
   684             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
   685         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
   686             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
   687
   688         16  CF-PROC-SYS-ACCESS-SW.
   689             20  CF-PROC-CREDIT-CLAIMS-SW.
   690                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
   691                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
   692                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
   693                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
   694             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
   695                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
   696                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
   697             20  CF-PROC-LIFE-GNRLDGR-SW.
   698                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
   699                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  14
* ELCANC.cbl
   700                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
   701                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
   702             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
   703                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
   704                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
   705         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
   706             CF-PROC-SYS-ACCESS-SW              PIC X(4).
   707             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
   708         16  CF-PROCESSOR-PRINTER               PIC X(4).
   709
   710         16  CF-APPROVAL-LEVEL                  PIC X.
   711             88  APPROVAL-LEVEL-1                   VALUE '1'.
   712             88  APPROVAL-LEVEL-2                   VALUE '2'.
   713             88  APPROVAL-LEVEL-3                   VALUE '3'.
   714             88  APPROVAL-LEVEL-4                   VALUE '4'.
   715             88  APPROVAL-LEVEL-5                   VALUE '5'.
   716
   717         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
   718
   719         16  CF-LANGUAGE-TYPE                   PIC X.
   720             88  CF-LANG-IS-ENG                     VALUE 'E'.
   721             88  CF-LANG-IS-FR                      VALUE 'F'.
   722
   723         16  CF-CSR-IND                         PIC X.
   724         16  FILLER                             PIC X(239).
   725
   726****************************************************************
   727*             PROCESSOR/REMINDERS RECORD                       *
   728****************************************************************
   729
   730     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
   731         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
   732             20  CF-START-REMIND-DT         PIC XX.
   733             20  CF-END-REMIND-DT           PIC XX.
   734             20  CF-REMINDER-TEXT           PIC X(50).
   735         16  FILLER                         PIC X(296).
   736
   737
   738****************************************************************
   739*             STATE MASTER RECORD                              *
   740****************************************************************
   741
   742     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   743         16  CF-STATE-ABBREVIATION          PIC XX.
   744         16  CF-STATE-NAME                  PIC X(25).
   745         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
   746         16  CF-ST-CALC-QUOTE-TOLERANCE.
   747             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
   748             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
   749             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
   750             20  CF-ST-CLAIM-REJECT-SW      PIC X.
   751                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
   752                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
   753             20  CF-ST-PREM-REJECT-SW       PIC X.
   754                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
   755                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
   756             20  CF-ST-REF-REJECT-SW        PIC X.
   757                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  15
* ELCANC.cbl
   758                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
   759         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
   760         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
   761         16  CF-ST-REFUND-RULES.
   762             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
   763             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
   764             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
   765         16  CF-ST-FST-PMT-EXTENSION.
   766             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
   767             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
   768                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
   769                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
   770                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
   771                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
   772         16  CF-ST-STATE-CALL.
   773             20  CF-ST-CALL-UNEARNED        PIC X.
   774             20  CF-ST-CALL-RPT-CNTL        PIC X.
   775             20  CF-ST-CALL-RATE-DEV        PIC XXX.
   776         16  CF-REPLACEMENT-LAW-SW          PIC X.
   777             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
   778             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
   779         16  CF-REPLACEMENT-LETTER          PIC X(4).
   780         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
   781         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
   782         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
   783         16  CF-ST-SPLIT-PAYMENT            PIC X.
   784         16  FILLER                         PIC X.
   785         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
   786             20  CF-ST-BENEFIT-CD           PIC XX.
   787             20  CF-ST-BENEFIT-KIND         PIC X.
   788                 88  CF-ST-LIFE-KIND            VALUE 'L'.
   789                 88  CF-ST-AH-KIND              VALUE 'A'.
   790             20  CF-ST-REM-TERM-CALC        PIC X.
   791                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
   792                 88  ST-EARN-AFTER-15TH         VALUE '1'.
   793                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
   794                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
   795                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
   796                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
   797                 88  ST-EARN-AFTER-14TH         VALUE '6'.
   798                 88  ST-EARN-AFTER-16TH         VALUE '7'.
   799
   800             20  CF-ST-REFUND-CALC          PIC X.
   801                 88  ST-REFUND-NOT-USED         VALUE SPACE.
   802                 88  ST-REFD-BY-R78             VALUE '1'.
   803                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
   804                 88  ST-REFD-AS-CALIF           VALUE '3'.
   805                 88  ST-REFD-AS-TEXAS           VALUE '4'.
   806                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
   807                 88  ST-REFD-ANTICIPATION       VALUE '6'.
   808                 88  ST-REFD-UTAH               VALUE '7'.
   809                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
   810                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
   811                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
   812
   813             20  CF-ST-EARNING-CALC         PIC X.
   814                 88  ST-EARNING-NOT-USED        VALUE SPACE.
   815                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  16
* ELCANC.cbl
   816                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
   817                 88  ST-EARN-AS-CALIF           VALUE '3'.
   818                 88  ST-EARN-AS-TEXAS           VALUE '4'.
   819                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
   820                 88  ST-EARN-ANTICIPATION       VALUE '6'.
   821                 88  ST-EARN-MEAN               VALUE '8'.
   822                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
   823
   824             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
   825                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
   826                 88  ST-OVRD-BY-R78             VALUE '1'.
   827                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
   828                 88  ST-OVRD-AS-CALIF           VALUE '3'.
   829                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
   830                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
   831                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
   832                 88  ST-OVRD-MEAN               VALUE '8'.
   833                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
   834             20  cf-st-extra-periods        pic 9.
   835*            20  FILLER                     PIC X.
   836
   837         16  CF-ST-COMMISSION-CAPS.
   838             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
   839             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
   840             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
   841             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
   842         16  CF-COMM-CAP-LIMIT-TO           PIC X.
   843                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
   844
   845         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
   846
   847         16  CF-ST-STATUTORY-INTEREST.
   848             20  CF-ST-STAT-DATE-FROM       PIC X.
   849                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
   850                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
   851             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
   852             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
   853             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
   854             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
   855             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
   856
   857         16  CF-ST-OVER-SHORT.
   858             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
   859             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
   860
   861         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
   862
   863         16  CF-ST-RT-CALC                  PIC X.
   864
   865         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
   866         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
   867         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
   868         16  CF-ST-RF-LR-CALC               PIC X.
   869         16  CF-ST-RF-LL-CALC               PIC X.
   870         16  CF-ST-RF-LN-CALC               PIC X.
   871         16  CF-ST-RF-AH-CALC               PIC X.
   872         16  CF-ST-RF-CP-CALC               PIC X.
   873*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  17
* ELCANC.cbl
   874*CIDMOD         16  FILLER                         PIC X(192).
   875         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
   876             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
   877         16  CF-ST-REF-AH-DEATH-IND         PIC X.
   878         16  CF-ST-VFY-2ND-BENE             PIC X.
   879         16  CF-ST-CAUSAL-STATE             PIC X.
   880         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
   881         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
   882         16  CF-ST-AGENT-SIG-EDIT           PIC X.
   883             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
   884         16  CF-ST-NET-ONLY-STATE           PIC X.
   885             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
   886         16  FILLER                         PIC X(181).
   887
   888****************************************************************
   889*             BENEFIT MASTER RECORD                            *
   890****************************************************************
   891
   892     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   893         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
   894             20  CF-BENEFIT-CODE            PIC XX.
   895             20  CF-BENEFIT-NUMERIC  REDEFINES
   896                 CF-BENEFIT-CODE            PIC XX.
   897             20  CF-BENEFIT-ALPHA           PIC XXX.
   898             20  CF-BENEFIT-DESCRIP         PIC X(10).
   899             20  CF-BENEFIT-COMMENT         PIC X(10).
   900
   901             20  CF-LF-COVERAGE-TYPE        PIC X.
   902                 88  CF-REDUCING                VALUE 'R'.
   903                 88  CF-LEVEL                   VALUE 'L' 'P'.
   904
   905             20  CF-SPECIAL-CALC-CD         PIC X.
   906                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
   907                 88  CF-NP-0-MO-INT             VALUE 'A'.
   908                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
   909                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
   910                 88  CF-TERM-IN-DAYS            VALUE 'D'.
   911                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
   912                 88  CF-FARM-PLAN               VALUE 'F'.
   913                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
   914                 88  CF-2-MTH-INTEREST          VALUE 'I'.
   915                 88  CF-3-MTH-INTEREST          VALUE 'J'.
   916                 88  CF-4-MTH-INTEREST          VALUE 'K'.
   917                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
   918                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
   919                 88  CF-PRUDENTIAL              VALUE 'P'.
   920                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
   921                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
   922                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
   923                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
   924                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
   925                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
   926
   927             20  CF-JOINT-INDICATOR         PIC X.
   928                 88  CF-JOINT-COVERAGE          VALUE 'J'.
   929
   930*            20  FILLER                     PIC X(12).
   931             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  18
* ELCANC.cbl
   932             20  FILLER                     PIC X(09).
   933             20  CF-BENEFIT-CATEGORY        PIC X.
   934             20  CF-LOAN-TYPE               PIC X(8).
   935
   936             20  CF-CO-REM-TERM-CALC        PIC X.
   937                 88  CO-EARN-AFTER-15TH         VALUE '1'.
   938                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
   939                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
   940                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
   941                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
   942
   943             20  CF-CO-EARNINGS-CALC        PIC X.
   944                 88  CO-EARN-BY-R78             VALUE '1'.
   945                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
   946                 88  CO-EARN-AS-CALIF           VALUE '3'.
   947                 88  CO-EARN-AS-TEXAS           VALUE '4'.
   948                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
   949                 88  CO-EARN-ANTICIPATION       VALUE '6'.
   950                 88  CO-EARN-AS-MEAN            VALUE '8'.
   951                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
   952
   953             20  CF-CO-REFUND-CALC          PIC X.
   954                 88  CO-REFUND-NOT-USED         VALUE SPACE.
   955                 88  CO-REFD-BY-R78             VALUE '1'.
   956                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
   957                 88  CO-REFD-AS-CALIF           VALUE '3'.
   958                 88  CO-REFD-AS-TEXAS           VALUE '4'.
   959                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
   960                 88  CO-REFD-ANTICIPATION       VALUE '6'.
   961                 88  CO-REFD-MEAN               VALUE '8'.
   962                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
   963                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
   964                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
   965
   966             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
   967                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
   968                 88  CO-OVRD-BY-R78             VALUE '1'.
   969                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
   970                 88  CO-OVRD-AS-CALIF           VALUE '3'.
   971                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
   972                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
   973                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
   974                 88  CO-OVRD-MEAN               VALUE '8'.
   975                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
   976
   977             20  CF-CO-BEN-I-G-CD           PIC X.
   978                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
   979                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
   980                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
   981
   982         16  FILLER                         PIC X(304).
   983
   984
   985****************************************************************
   986*             CARRIER MASTER RECORD                            *
   987****************************************************************
   988
   989     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  19
* ELCANC.cbl
   990         16  CF-ADDRESS-DATA.
   991             20  CF-MAIL-TO-NAME            PIC X(30).
   992             20  CF-IN-CARE-OF              PIC X(30).
   993             20  CF-ADDRESS-LINE-1          PIC X(30).
   994             20  CF-ADDRESS-LINE-2          PIC X(30).
   995             20  CF-CITY-STATE              PIC X(30).
   996             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
   997             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
   998
   999         16  CF-CLAIM-NO-CONTROL.
  1000             20  CF-CLAIM-NO-METHOD         PIC X.
  1001                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1002                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1003                 88  CLAIM-NO-SEQ               VALUE '3'.
  1004                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1005             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1006                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1007                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1008                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1009
  1010         16  CF-CHECK-NO-CONTROL.
  1011             20  CF-CHECK-NO-METHOD         PIC X.
  1012                 88  CHECK-NO-MANUAL            VALUE '1'.
  1013                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1014                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1015                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1016             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1017                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1018
  1019         16  CF-DOMICILE-STATE              PIC XX.
  1020
  1021         16  CF-EXPENSE-CONTROLS.
  1022             20  CF-EXPENSE-METHOD          PIC X.
  1023                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1024                 88  DOLLARS-PER-PMT            VALUE '2'.
  1025                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1026                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1027             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1028             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1029
  1030         16  CF-CORRESPONDENCE-CONTROL.
  1031             20  CF-LETTER-RESEND-OPT       PIC X.
  1032                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1033                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1034             20  FILLER                     PIC X(4).
  1035
  1036         16  CF-RESERVE-CONTROLS.
  1037             20  CF-MANUAL-SW               PIC X.
  1038                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1039             20  CF-FUTURE-SW               PIC X.
  1040                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1041             20  CF-PTC-SW                  PIC X.
  1042                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1043             20  CF-IBNR-SW                 PIC X.
  1044                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1045             20  CF-PTC-LF-SW               PIC X.
  1046                 88  CF-LF-PTC-USED             VALUE '1'.
  1047             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  20
* ELCANC.cbl
  1048                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1049                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1050                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1051             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1052
  1053         16  CF-CLAIM-CALC-METHOD           PIC X.
  1054             88  360-PLUS-MONTHS                VALUE '1'.
  1055             88  365-PLUS-MONTHS                VALUE '2'.
  1056             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1057             88  360-DAILY                      VALUE '4'.
  1058             88  365-DAILY                      VALUE '5'.
  1059
  1060         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1061         16  FILLER                         PIC X(11).
  1062
  1063         16  CF-LIMIT-AMOUNTS.
  1064             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1065             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1066             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1067             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1068             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1069             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1070             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1071             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1072             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1073             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1074
  1075         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1076         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1077         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1078
  1079         16  CF-ZIP-CODE.
  1080             20  CF-ZIP-PRIME.
  1081                 24  CF-ZIP-1ST             PIC X.
  1082                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1083                 24  FILLER                 PIC X(4).
  1084             20  CF-ZIP-PLUS4               PIC X(4).
  1085         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1086             20  CF-CAN-POSTAL-1            PIC XXX.
  1087             20  CF-CAN-POSTAL-2            PIC XXX.
  1088             20  FILLER                     PIC XXX.
  1089
  1090         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1091         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1092         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1093
  1094         16  CF-RATING-SWITCH               PIC X.
  1095             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1096             88  CF-NO-RATING                   VALUE 'N'.
  1097
  1098         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1099
  1100         16  CF-CARRIER-OVER-SHORT.
  1101             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1102             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1103
  1104         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1105         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  21
* ELCANC.cbl
  1106             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1107             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1108         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1109         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1110         16  FILLER                         PIC X(444).
  1111*        16  FILLER                         PIC X(452).
  1112
  1113
  1114****************************************************************
  1115*             MORTALITY MASTER RECORD                          *
  1116****************************************************************
  1117
  1118     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1119         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1120                                INDEXED BY CF-MORT-NDX.
  1121             20  CF-MORT-TABLE              PIC X(5).
  1122             20  CF-MORT-TABLE-TYPE         PIC X.
  1123                 88  CF-MORT-JOINT              VALUE 'J'.
  1124                 88  CF-MORT-SINGLE             VALUE 'S'.
  1125                 88  CF-MORT-COMBINED           VALUE 'C'.
  1126                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1127                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1128             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1129             20  CF-MORT-AGE-METHOD         PIC XX.
  1130                 88  CF-AGE-LAST                VALUE 'AL'.
  1131                 88  CF-AGE-NEAR                VALUE 'AN'.
  1132             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1133             20  CF-MORT-ADJUSTMENT-DIRECTION
  1134                                            PIC X.
  1135                 88  CF-MINUS                   VALUE '-'.
  1136                 88  CF-PLUS                    VALUE '+'.
  1137             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1138             20  CF-MORT-JOINT-CODE         PIC X.
  1139                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1140             20  CF-MORT-PC-Q               PIC X.
  1141                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1142             20  CF-MORT-TABLE-CODE         PIC X(4).
  1143             20  CF-MORT-COMMENTS           PIC X(15).
  1144             20  FILLER                     PIC X(14).
  1145
  1146         16  FILLER                         PIC X(251).
  1147
  1148
  1149****************************************************************
  1150*             BUSSINESS TYPE MASTER RECORD                     *
  1151****************************************************************
  1152
  1153     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1154* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1155* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1156* AND RECORD 05 IS TYPES 81-99
  1157         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1158             20  CF-BUSINESS-TITLE          PIC  X(19).
  1159             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1160                                            PIC S9V9(4) COMP-3.
  1161             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1162             20  FILLER                     PIC  X.
  1163         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  22
* ELCANC.cbl
  1164
  1165
  1166****************************************************************
  1167*             TERMINAL MASTER RECORD                           *
  1168****************************************************************
  1169
  1170     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1171
  1172         16  CF-COMPANY-TERMINALS.
  1173             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1174                                  PIC X(4).
  1175         16  FILLER               PIC X(248).
  1176
  1177
  1178****************************************************************
  1179*             LIFE EDIT MASTER RECORD                          *
  1180****************************************************************
  1181
  1182     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1183         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1184             20  CF-LIFE-CODE-IN            PIC XX.
  1185             20  CF-LIFE-CODE-OUT           PIC XX.
  1186         16  FILLER                         PIC X(248).
  1187
  1188
  1189****************************************************************
  1190*             AH EDIT MASTER RECORD                            *
  1191****************************************************************
  1192
  1193     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1194         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1195             20  CF-AH-CODE-IN              PIC XXX.
  1196             20  CF-AH-CODE-OUT             PIC XX.
  1197         16  FILLER                         PIC X(248).
  1198
  1199
  1200****************************************************************
  1201*             CREDIBILITY TABLES                               *
  1202****************************************************************
  1203
  1204     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1205         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1206                             INDEXED BY CF-CRDB-NDX.
  1207             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1208             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1209             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1210         16  FILLER                         PIC  X(332).
  1211
  1212
  1213****************************************************************
  1214*             REPORT CUSTOMIZATION RECORD                      *
  1215****************************************************************
  1216
  1217     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1218         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1219             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1220             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1221             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  23
* ELCANC.cbl
  1222**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1223****       A T-TRANSFER.                                   ****
  1224             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1225
  1226         16  FILLER                         PIC XX.
  1227
  1228         16  CF-CARRIER-CNTL-OPT.
  1229             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1230                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1231                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1232             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1233                                            PIC X.
  1234         16  CF-GROUP-CNTL-OPT.
  1235             20  CF-GROUP-OPT-SEQ           PIC 9.
  1236                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1237                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1238             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1239                                            PIC X(6).
  1240         16  CF-STATE-CNTL-OPT.
  1241             20  CF-STATE-OPT-SEQ           PIC 9.
  1242                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1243                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1244             20  CF-STATE-SELECT OCCURS 3 TIMES
  1245                                            PIC XX.
  1246         16  CF-ACCOUNT-CNTL-OPT.
  1247             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1248                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1249                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1250             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1251                                            PIC X(10).
  1252         16  CF-BUS-TYP-CNTL-OPT.
  1253             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1254                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1255                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1256             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1257                                            PIC XX.
  1258         16  CF-LF-TYP-CNTL-OPT.
  1259             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1260                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1261                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1262             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1263                                            PIC XX.
  1264         16  CF-AH-TYP-CNTL-OPT.
  1265             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1266                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1267                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1268             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1269                                            PIC XX.
  1270         16  CF-REPTCD1-CNTL-OPT.
  1271             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1272                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1273                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1274             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1275                                            PIC X(10).
  1276         16  CF-REPTCD2-CNTL-OPT.
  1277             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1278                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1279                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  24
* ELCANC.cbl
  1280             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1281                                            PIC X(10).
  1282         16  CF-USER1-CNTL-OPT.
  1283             20  CF-USER1-OPT-SEQ           PIC 9.
  1284                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1285                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1286             20  CF-USER1-SELECT OCCURS 3 TIMES
  1287                                            PIC X(10).
  1288         16  CF-USER2-CNTL-OPT.
  1289             20  CF-USER2-OPT-SEQ           PIC 9.
  1290                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1291                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1292             20  CF-USER2-SELECT OCCURS 3 TIMES
  1293                                            PIC X(10).
  1294         16  CF-USER3-CNTL-OPT.
  1295             20  CF-USER3-OPT-SEQ           PIC 9.
  1296                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1297                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1298             20  CF-USER3-SELECT OCCURS 3 TIMES
  1299                                            PIC X(10).
  1300         16  CF-USER4-CNTL-OPT.
  1301             20  CF-USER4-OPT-SEQ           PIC 9.
  1302                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1303                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1304             20  CF-USER4-SELECT OCCURS 3 TIMES
  1305                                            PIC X(10).
  1306         16  CF-USER5-CNTL-OPT.
  1307             20  CF-USER5-OPT-SEQ           PIC 9.
  1308                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1309                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1310             20  CF-USER5-SELECT OCCURS 3 TIMES
  1311                                            PIC X(10).
  1312         16  CF-REINS-CNTL-OPT.
  1313             20  CF-REINS-OPT-SEQ           PIC 9.
  1314                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1315                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1316             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1317                 24  CF-REINS-PRIME         PIC XXX.
  1318                 24  CF-REINS-SUB           PIC XXX.
  1319
  1320         16  CF-AGENT-CNTL-OPT.
  1321             20  CF-AGENT-OPT-SEQ           PIC 9.
  1322                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1323                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1324             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1325                                            PIC X(10).
  1326
  1327         16  FILLER                         PIC X(43).
  1328
  1329         16  CF-LOSS-RATIO-SELECT.
  1330             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1331             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1332         16  CF-ENTRY-DATE-SELECT.
  1333             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1334             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1335         16  CF-EFFECTIVE-DATE-SELECT.
  1336             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1337             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  25
* ELCANC.cbl
  1338
  1339         16  CF-EXCEPTION-LIST-IND          PIC X.
  1340             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1341
  1342         16  FILLER                         PIC X(318).
  1343
  1344****************************************************************
  1345*                  EXCEPTION REPORTING RECORD                  *
  1346****************************************************************
  1347
  1348     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1349         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1350             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1351
  1352         16  CF-COMBINED-LIFE-AH-OPT.
  1353             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1354             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1355             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1356             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1357
  1358         16  CF-LIFE-OPT.
  1359             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1360             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1361             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1362             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1363             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1364             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1365             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1366             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1367             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1368             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1369
  1370         16  CF-AH-OPT.
  1371             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1372             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1373             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1374             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1375             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1376             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1377             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1378             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1379             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1380             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1381
  1382         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1383             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1384             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1385             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1386
  1387         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1388
  1389         16  FILLER                         PIC X(673).
  1390
  1391
  1392****************************************************************
  1393*             MORTGAGE SYSTEM PLAN RECORD                      *
  1394****************************************************************
  1395
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  26
* ELCANC.cbl
  1396     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1397         16  CF-PLAN-TYPE                   PIC X.
  1398             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1399             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1400             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1401         16  CF-PLAN-ABBREV                 PIC XXX.
  1402         16  CF-PLAN-DESCRIPT               PIC X(10).
  1403         16  CF-PLAN-NOTES                  PIC X(20).
  1404         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1405         16  CF-PLAN-UNDERWRITING.
  1406             20  CF-PLAN-TERM-DATA.
  1407                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1408                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1409             20  CF-PLAN-AGE-DATA.
  1410                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1411                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1412                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1413             20  CF-PLAN-BENEFIT-DATA.
  1414                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1415                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1416                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1417                                            PIC S9(7)V99  COMP-3.
  1418         16  CF-PLAN-POLICY-FORMS.
  1419             20  CF-POLICY-FORM             PIC X(12).
  1420             20  CF-MASTER-APPLICATION      PIC X(12).
  1421             20  CF-MASTER-POLICY           PIC X(12).
  1422         16  CF-PLAN-RATING.
  1423             20  CF-RATE-CODE               PIC X(5).
  1424             20  CF-SEX-RATING              PIC X.
  1425                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1426                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1427             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1428             20  CF-SUB-STD-TYPE            PIC X.
  1429                 88  CF-PCT-OF-PREM            VALUE '1'.
  1430                 88  CF-PCT-OF-BENE            VALUE '2'.
  1431         16  CF-PLAN-PREM-TOLERANCES.
  1432             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1433             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1434         16  CF-PLAN-PYMT-TOLERANCES.
  1435             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1436             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1437         16  CF-PLAN-MISC-DATA.
  1438             20  FILLER                     PIC X.
  1439             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1440             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1441         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1442         16  CF-PLAN-IND-GRP                PIC X.
  1443             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1444                                                     '1'.
  1445             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1446                                                     '2'.
  1447         16  CF-MIB-SEARCH-SW               PIC X.
  1448             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1449             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1450             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1451             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1452         16  CF-ALPHA-SEARCH-SW             PIC X.
  1453             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  27
* ELCANC.cbl
  1454             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1455             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1456             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1457             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1458             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1459             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1460             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1461             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1462             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1463                                                     'A' 'B' 'C'
  1464                                                     'X' 'Y' 'Z'.
  1465         16  CF-EFF-DT-RULE-SW              PIC X.
  1466             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1467             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1468             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1469             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1470             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1471         16  FILLER                         PIC X(4).
  1472         16  CF-HEALTH-QUESTIONS            PIC X.
  1473             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1474         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1475         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1476         16  CF-PLAN-SNGL-JNT               PIC X.
  1477             88  CF-COMBINED-PLAN              VALUE 'C'.
  1478             88  CF-JNT-PLAN                   VALUE 'J'.
  1479             88  CF-SNGL-PLAN                  VALUE 'S'.
  1480         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1481         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1482         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1483         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1484         16  CF-RERATE-CNTL                 PIC  X.
  1485             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1486             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1487             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1488             88  CF-AUTO-RECALC                 VALUE '4'.
  1489         16  CF-BENEFIT-TYPE                PIC  X.
  1490             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1491             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1492         16  CF-POLICY-FEE                  PIC S999V99
  1493                                                    COMP-3.
  1494         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1495         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1496         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1497         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1498         16  FILLER                         PIC  X(32).
  1499         16  CF-TERMINATION-FORM            PIC  X(04).
  1500         16  FILLER                         PIC  X(08).
  1501         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1502                                                       COMP-3.
  1503         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1504         16  CF-ISSUE-LETTER                PIC  X(4).
  1505         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1506         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1507             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1508             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1509         16  CF-MP-REFUND-CALC              PIC X.
  1510             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1511             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  28
* ELCANC.cbl
  1512             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1513             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1514             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1515             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1516             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1517             88  CF-MP-REFD-MEAN                VALUE '8'.
  1518         16  CF-ALT-RATE-CODE               PIC  X(5).
  1519
  1520
  1521         16  FILLER                         PIC X(498).
  1522****************************************************************
  1523*             MORTGAGE COMPANY MASTER RECORD                   *
  1524****************************************************************
  1525
  1526     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1527         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1528         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1529             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1530             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1531             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1532             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1533             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1534
  1535         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1536         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1537         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1538         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1539         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1540
  1541         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1542             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1543         16  CF-MP-RECON-USE-IND            PIC X(1).
  1544             88  CF-MP-USE-RECON             VALUE 'Y'.
  1545         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1546             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1547         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1548             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1549             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1550         16  FILLER                         PIC X(1).
  1551         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1552             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1553         16  CF-MORTG-MIB-VERSION           PIC X.
  1554             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1555             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1556             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1557         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1558             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1559                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1560             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1561                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1562             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1563                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1564             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1565                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1566             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1567                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1568             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1569                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  29
* ELCANC.cbl
  1570         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1571         16  FILLER                         PIC X(7).
  1572         16  CF-MORTG-DESTINATION-SYMBOL.
  1573             20  CF-MORTG-MIB-COMM          PIC X(5).
  1574             20  CF-MORTG-MIB-TERM          PIC X(5).
  1575         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1576             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1577         16  FILLER                         PIC X(03).
  1578         16  CF-MP-CHECK-NO-CONTROL.
  1579             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1580                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1581                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1582                                                ' ' LOW-VALUES.
  1583                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1584                                               VALUE '3'.
  1585         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1586         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1587         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1588             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1589                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1590             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1591                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1592             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1593                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1594             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1595                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1596             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1597                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1598             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1599                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1600         16  CF-MORTG-BILLING-AREA.
  1601             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1602                                            PIC X.
  1603         16  CF-MORTG-MONTH-END-DT          PIC XX.
  1604         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  1605         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  1606         16  CF-MORTG-MIB-DEST-SW           PIC X.
  1607             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  1608             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  1609         16  FILLER                         PIC X.
  1610         16  CF-MORTG-LABEL-CONTROL         PIC X.
  1611             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  1612             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  1613         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  1614         16  FILLER                         PIC X(8).
  1615         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  1616         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  1617         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  1618         16  CF-ACH-COMPANY-ID.
  1619             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  1620                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  1621                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  1622                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  1623             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  1624         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  1625             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  1626         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  1627             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  30
* ELCANC.cbl
  1628             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  1629         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  1630         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  1631         16  FILLER                         PIC X(536).
  1632
  1633****************************************************************
  1634*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  1635****************************************************************
  1636
  1637     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  1638         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  1639             20  CF-FEMALE-HEIGHT.
  1640                 24  CF-FEMALE-FT           PIC 99.
  1641                 24  CF-FEMALE-IN           PIC 99.
  1642             20  CF-FEMALE-MIN-WT           PIC 999.
  1643             20  CF-FEMALE-MAX-WT           PIC 999.
  1644         16  FILLER                         PIC X(428).
  1645
  1646     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  1647         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  1648             20  CF-MALE-HEIGHT.
  1649                 24  CF-MALE-FT             PIC 99.
  1650                 24  CF-MALE-IN             PIC 99.
  1651             20  CF-MALE-MIN-WT             PIC 999.
  1652             20  CF-MALE-MAX-WT             PIC 999.
  1653         16  FILLER                         PIC X(428).
  1654******************************************************************
  1655*             AUTOMATIC ACTIVITY RECORD                          *
  1656******************************************************************
  1657     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  1658         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  1659             20  CF-SYS-ACTIVE-SW           PIC X(01).
  1660             20  CF-SYS-LETTER-ID           PIC X(04).
  1661             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  1662             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  1663             20  CF-SYS-RESET-SW            PIC X(01).
  1664             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  1665             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  1666
  1667         16  FILLER                         PIC X(50).
  1668
  1669         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  1670             20  CF-USER-ACTIVE-SW          PIC X(01).
  1671             20  CF-USER-LETTER-ID          PIC X(04).
  1672             20  CF-USER-RESEND-DAYS        PIC 9(03).
  1673             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  1674             20  CF-USER-RESET-SW           PIC X(01).
  1675             20  CF-USER-REPORT-DAYS        PIC 9(03).
  1676             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  1677             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  1678
  1679         16  FILLER                         PIC X(246).
  1680*                          COPY ELCCERT.
  1681******************************************************************
  1682*                                                                *
  1683*                            ELCCERT.                            *
  1684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1685*                            VMOD=2.013                          *
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  31
* ELCANC.cbl
  1686*                                                                *
  1687*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1688*                                                                *
  1689*   FILE TYPE = VSAM,KSDS                                        *
  1690*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1691*                                                                *
  1692*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1693*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1694*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1695*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1696*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1697*                                                                *
  1698*   LOG = YES                                                    *
  1699*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1700******************************************************************
  1701*                   C H A N G E   L O G
  1702*
  1703* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1704*-----------------------------------------------------------------
  1705*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1706* EFFECTIVE    NUMBER
  1707*-----------------------------------------------------------------
  1708* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1709* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1710* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1711* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1712* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1713* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1714* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1715* 032612  CR2011110200001  PEMA  AHL CHANGES
  1716* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1717* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1718******************************************************************
  1719
  1720 01  CERTIFICATE-MASTER.
  1721     12  CM-RECORD-ID                      PIC XX.
  1722         88  VALID-CM-ID                      VALUE 'CM'.
  1723
  1724     12  CM-CONTROL-PRIMARY.
  1725         16  CM-COMPANY-CD                 PIC X.
  1726         16  CM-CARRIER                    PIC X.
  1727         16  CM-GROUPING.
  1728             20  CM-GROUPING-PREFIX        PIC X(3).
  1729             20  CM-GROUPING-PRIME         PIC X(3).
  1730         16  CM-STATE                      PIC XX.
  1731         16  CM-ACCOUNT.
  1732             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1733             20  CM-ACCOUNT-PRIME          PIC X(6).
  1734         16  CM-CERT-EFF-DT                PIC XX.
  1735         16  CM-CERT-NO.
  1736             20  CM-CERT-PRIME             PIC X(10).
  1737             20  CM-CERT-SFX               PIC X.
  1738
  1739     12  CM-CONTROL-BY-NAME.
  1740         16  CM-COMPANY-CD-A1              PIC X.
  1741         16  CM-INSURED-LAST-NAME          PIC X(15).
  1742         16  CM-INSURED-INITIALS.
  1743             20  CM-INSURED-INITIAL1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  32
* ELCANC.cbl
  1744             20  CM-INSURED-INITIAL2       PIC X.
  1745
  1746     12  CM-CONTROL-BY-SSN.
  1747         16  CM-COMPANY-CD-A2              PIC X.
  1748         16  CM-SOC-SEC-NO.
  1749             20  CM-SSN-STATE              PIC XX.
  1750             20  CM-SSN-ACCOUNT            PIC X(6).
  1751             20  CM-SSN-LN3.
  1752                 25  CM-INSURED-INITIALS-A2.
  1753                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1754                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1755                 25 CM-PART-LAST-NAME-A2         PIC X.
  1756
  1757     12  CM-CONTROL-BY-CERT-NO.
  1758         16  CM-COMPANY-CD-A4              PIC X.
  1759         16  CM-CERT-NO-A4                 PIC X(11).
  1760
  1761     12  CM-CONTROL-BY-MEMB.
  1762         16  CM-COMPANY-CD-A5              PIC X.
  1763         16  CM-MEMBER-NO.
  1764             20  CM-MEMB-STATE             PIC XX.
  1765             20  CM-MEMB-ACCOUNT           PIC X(6).
  1766             20  CM-MEMB-LN4.
  1767                 25  CM-INSURED-INITIALS-A5.
  1768                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1769                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1770                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1771
  1772     12  CM-INSURED-PROFILE-DATA.
  1773         16  CM-INSURED-FIRST-NAME.
  1774             20  CM-INSURED-1ST-INIT       PIC X.
  1775             20  FILLER                    PIC X(9).
  1776         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1777         16  CM-INSURED-SEX                PIC X.
  1778             88  CM-SEX-MALE                  VALUE 'M'.
  1779             88  CM-SEX-FEMAL                 VALUE 'F'.
  1780         16  CM-INSURED-JOINT-AGE          PIC 99.
  1781         16  CM-JOINT-INSURED-NAME.
  1782             20  CM-JT-LAST-NAME           PIC X(15).
  1783             20  CM-JT-FIRST-NAME.
  1784                 24  CM-JT-1ST-INIT        PIC X.
  1785                 24  FILLER                PIC X(9).
  1786             20  CM-JT-INITIAL             PIC X.
  1787
  1788     12  CM-LIFE-DATA.
  1789         16  CM-LF-BENEFIT-CD              PIC XX.
  1790         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1791         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1792         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1793         16  CM-LF-DEV-CODE                PIC XXX.
  1794         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1795         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1796         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1797         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1798         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1799         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1800         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1801         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  33
* ELCANC.cbl
  1802         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1803         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1804         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1805         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1806         16  cm-temp-epiq                  pic xx.
  1807             88  EPIQ-CLASS                  value 'EQ'.
  1808*        16  FILLER                        PIC XX.
  1809
  1810     12  CM-AH-DATA.
  1811         16  CM-AH-BENEFIT-CD              PIC XX.
  1812         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1813         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1814         16  CM-AH-DEV-CODE                PIC XXX.
  1815         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1816         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1817         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1818         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1819         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1820         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1821         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1822         16  CM-AH-PAID-THRU-DT            PIC XX.
  1823             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1824         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1825         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1826         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1827         16  FILLER                        PIC X.
  1828
  1829     12  CM-LOAN-INFORMATION.
  1830         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1831         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1832                                           PIC S9(5)V99  COMP-3.
  1833         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1834         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1835         16  CM-PAY-FREQUENCY              PIC S99.
  1836         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1837         16  CM-RATE-CLASS                 PIC XX.
  1838         16  CM-BENEFICIARY                PIC X(25).
  1839         16  CM-POLICY-FORM-NO             PIC X(12).
  1840         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1841         16  CM-LAST-ADD-ON-DT             PIC XX.
  1842         16  CM-DEDUCTIBLE-AMOUNTS.
  1843             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1844             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1845         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1846             20  CM-RESIDENT-STATE         PIC XX.
  1847             20  CM-RATE-CODE              PIC X(4).
  1848             20  FILLER                    PIC XX.
  1849         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1850             20  CM-LOAN-OFFICER           PIC X(5).
  1851             20  FILLER                    PIC XXX.
  1852         16  CM-CSR-CODE                   PIC XXX.
  1853         16  CM-UNDERWRITING-CODE          PIC X.
  1854             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1855         16  CM-POST-CARD-IND              PIC X.
  1856         16  CM-NH-INTERFACE-SW            PIC X.
  1857         16  CM-PREMIUM-TYPE               PIC X.
  1858             88  CM-SING-PRM                  VALUE '1'.
  1859             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  34
* ELCANC.cbl
  1860             88  CM-OPEN-END                  VALUE '3'.
  1861         16  CM-IND-GRP-TYPE               PIC X.
  1862             88  CM-INDIVIDUAL                VALUE 'I'.
  1863             88  CM-GROUP                     VALUE 'G'.
  1864         16  CM-SKIP-CODE                  PIC X.
  1865             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1866             88  SKIP-JULY                    VALUE '1'.
  1867             88  SKIP-AUGUST                  VALUE '2'.
  1868             88  SKIP-SEPTEMBER               VALUE '3'.
  1869             88  SKIP-JULY-AUG                VALUE '4'.
  1870             88  SKIP-AUG-SEPT                VALUE '5'.
  1871             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1872             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1873             88  SKIP-JUNE                    VALUE '8'.
  1874             88  SKIP-JUNE-JULY               VALUE '9'.
  1875             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1876             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1877         16  CM-PAYMENT-MODE               PIC X.
  1878             88  PAY-MONTHLY                  VALUE SPACE.
  1879             88  PAY-WEEKLY                   VALUE '1'.
  1880             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1881             88  PAY-BI-WEEKLY                VALUE '3'.
  1882             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1883         16  CM-LOAN-NUMBER                PIC X(8).
  1884         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1885         16  CM-OLD-LOF                    PIC XXX.
  1886*        16  CM-LOAN-OFFICER               PIC XXX.
  1887         16  CM-REIN-TABLE                 PIC XXX.
  1888         16  CM-SPECIAL-REIN-CODE          PIC X.
  1889         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1890         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1891         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1892
  1893     12  CM-STATUS-DATA.
  1894         16  CM-ENTRY-STATUS               PIC X.
  1895         16  CM-ENTRY-DT                   PIC XX.
  1896
  1897         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1898         16  CM-LF-CANCEL-DT               PIC XX.
  1899         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1900
  1901         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1902         16  CM-LF-DEATH-DT                PIC XX.
  1903         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1904
  1905         16  CM-LF-CURRENT-STATUS          PIC X.
  1906             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1907                                                'M' '4' '5' '9'.
  1908             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1909             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1910             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1911             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1912             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1913             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1914             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1915             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1916             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1917             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  35
* ELCANC.cbl
  1918             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1919             88  CM-LF-DECLINED               VALUE 'D'.
  1920             88  CM-LF-VOIDED                 VALUE 'V'.
  1921
  1922         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1923         16  CM-AH-CANCEL-DT               PIC XX.
  1924         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1925
  1926         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1927         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1928         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1929
  1930         16  CM-AH-CURRENT-STATUS          PIC X.
  1931             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1932                                                'M' '4' '5' '9'.
  1933             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1934             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1935             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1936             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1937             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1938             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1939             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1940             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1941             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1942             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1943             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1944             88  CM-AH-DECLINED               VALUE 'D'.
  1945             88  CM-AH-VOIDED                 VALUE 'V'.
  1946
  1947         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1948             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1949             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1950             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1951         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1952
  1953         16  CM-ENTRY-BATCH                PIC X(6).
  1954         16  CM-LF-EXIT-BATCH              PIC X(6).
  1955         16  CM-AH-EXIT-BATCH              PIC X(6).
  1956         16  CM-LAST-MONTH-END             PIC XX.
  1957
  1958     12  CM-NOTE-SW                        PIC X.
  1959         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1960         88  CERT-NOTES-PRESENT               VALUE '1'.
  1961         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1962         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1963         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1964         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1965         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1966         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1967     12  CM-COMP-EXCP-SW                   PIC X.
  1968         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1969         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1970     12  CM-INSURED-ADDRESS-SW             PIC X.
  1971         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1972         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1973
  1974*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1975     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  36
* ELCANC.cbl
  1976     12  FILLER                            PIC X.
  1977
  1978*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1979     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1980     12  FILLER                            PIC X.
  1981*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1982     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1983
  1984     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1985         88  CERT-ADDED-BATCH                 VALUE ' '.
  1986         88  CERT-ADDED-ONLINE                VALUE '1'.
  1987         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1988         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1989         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1990     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1991         88  CERT-AS-LOADED                   VALUE ' '.
  1992         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1993         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1994         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1995         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1996         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1997         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1998         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1999
  2000     12  CM-ACCOUNT-COMM-PCTS.
  2001         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2002         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2003
  2004     12  CM-USER-FIELD                     PIC X.
  2005     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2006     12  CM-CLP-STATE                      PIC XX.
  2007     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2008     12  CM-USER-RESERVED                  PIC XXX.
  2009     12  FILLER REDEFINES CM-USER-RESERVED.
  2010         16  CM-AH-CLASS-CD                PIC XX.
  2011         16  F                             PIC X.
  2012******************************************************************
  2013*                          COPY ELCCRTT.
  2014******************************************************************
  2015*                                                                *
  2016*                            ELCCRTT.                            *
  2017*                                                                *
  2018*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2019*                                                                *
  2020*   FILE TYPE = VSAM,KSDS                                        *
  2021*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2022*                                                                *
  2023*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2024*                                                                *
  2025*   LOG = YES                                                    *
  2026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2027******************************************************************
  2028*                   C H A N G E   L O G
  2029*
  2030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2031*-----------------------------------------------------------------
  2032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2033* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  37
* ELCANC.cbl
  2034*-----------------------------------------------------------------
  2035* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2036* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2037* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2038* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2039* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2040* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2041* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2042* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2043* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2044******************************************************************
  2045
  2046 01  CERTIFICATE-TRAILERS.
  2047     12  CS-RECORD-ID                      PIC XX.
  2048         88  VALID-CS-ID                      VALUE 'CS'.
  2049
  2050     12  CS-CONTROL-PRIMARY.
  2051         16  CS-COMPANY-CD                 PIC X.
  2052         16  CS-CARRIER                    PIC X.
  2053         16  CS-GROUPING                   PIC X(6).
  2054         16  CS-STATE                      PIC XX.
  2055         16  CS-ACCOUNT                    PIC X(10).
  2056         16  CS-CERT-EFF-DT                PIC XX.
  2057         16  CS-CERT-NO.
  2058             20  CS-CERT-PRIME             PIC X(10).
  2059             20  CS-CERT-SFX               PIC X.
  2060         16  CS-TRAILER-TYPE               PIC X.
  2061             88  COMM-TRLR           VALUE 'A'.
  2062             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2063             88  CERT-DATA-TRLR      VALUE 'C'.
  2064
  2065     12  CS-DATA-AREA                      PIC X(516).
  2066
  2067     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2068         16  CS-BANK-COMMISSION-AREA.
  2069             20  CS-BANK-COMMS       OCCURS 10.
  2070                 24  CS-AGT                PIC X(10).
  2071                 24  CS-COM-TYP            PIC X.
  2072                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2073                 24  CS-RECALC-LV-INDIC    PIC X.
  2074                 24  FILLER                PIC X(10).
  2075         16  FILLER                        PIC X(256).
  2076
  2077     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2078****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2079         16  CS-MB-CLAIM-DATA OCCURS 24.
  2080             20  CS-CLAIM-NO               PIC X(7).
  2081             20  CS-CLAIM-TYPE             PIC X.
  2082                 88  CS-AH-CLM               VALUE 'A'.
  2083                 88  CS-IU-CLM               VALUE 'I'.
  2084                 88  CS-GP-CLM               VALUE 'G'.
  2085                 88  CS-LF-CLM               VALUE 'L'.
  2086                 88  CS-PR-CLM               VALUE 'P'.
  2087                 88  CS-FL-CLM               VALUE 'F'.
  2088             20  CS-INSURED-TYPE           PIC X.
  2089                 88  CS-PRIM-INSURED          VALUE 'P'.
  2090                 88  CS-CO-BORROWER           VALUE 'C'.
  2091             20  CS-BENEFIT-PERIOD         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  38
* ELCANC.cbl
  2092             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2093             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2094             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2095         16  FILLER                        PIC X(12).
  2096     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2097         16  CS-VIN-NUMBER                 PIC X(17).
  2098         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2099         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2100         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2101         16  cs-agent-name.
  2102             20  cs-agent-fname            pic x(20).
  2103             20  cs-agent-mi               pic x.
  2104             20  cs-agent-lname            pic x(25).
  2105         16  cs-license-no                 pic x(15).
  2106         16  cs-npn-number                 pic x(10).
  2107         16  cs-agent-edit-status          pic x.
  2108             88  cs-ae-refer-to-manager      value 'M'.
  2109             88  cs-ae-cover-sheet           value 'C'.
  2110             88  cs-ae-sig-form              value 'S'.
  2111             88  cs-ae-verified              value 'V'.
  2112             88  cs-unidentified-signature   value 'U'.
  2113             88  cs-cert-returned            value 'R'.
  2114             88  cs-accept-no-commission     value 'N'.
  2115         16  cs-year                       pic 9999.
  2116         16  cs-make                       pic x(20).
  2117         16  cs-model                      pic x(20).
  2118         16  cs-future                     pic x(20).
  2119         16  cs-vehicle-odometer           pic s9(7) comp-3.
  2120         16  FILLER                        PIC X(356). *> was 420
  2121*        16  FILLER                        PIC X(496).
  2122*                          COPY ERCACCT.
  2123******************************************************************
  2124*                                                                *
  2125*                                                                *
  2126*                            ERCACCT                             *
  2127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2128*                            VMOD=2.031                          *
  2129*                                                                *
  2130*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2131*                                                                *
  2132*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2133*   VSAM ACCOUNT MASTER FILES.                                   *
  2134*                                                                *
  2135*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2136*                                                                *
  2137*   FILE TYPE = VSAM,KSDS                                        *
  2138*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2139*                                                                *
  2140*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2141*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2142*                                                                *
  2143*   LOG = NO                                                     *
  2144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2145*                                                                *
  2146*                                                                *
  2147******************************************************************
  2148*                   C H A N G E   L O G
  2149*
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  39
* ELCANC.cbl
  2150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2151*-----------------------------------------------------------------
  2152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2153* EFFECTIVE    NUMBER
  2154*-----------------------------------------------------------------
  2155* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2156* 092705    2005050300006  PEMA  ADD SPP LEASES
  2157* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2158* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2159* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2160* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2161* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2162* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2163******************************************************************
  2164
  2165 01  ACCOUNT-MASTER.
  2166     12  AM-RECORD-ID                      PIC XX.
  2167         88  VALID-AM-ID                      VALUE 'AM'.
  2168
  2169     12  AM-CONTROL-PRIMARY.
  2170         16  AM-COMPANY-CD                 PIC X.
  2171         16  AM-MSTR-CNTRL.
  2172             20  AM-CONTROL-A.
  2173                 24  AM-CARRIER            PIC X.
  2174                 24  AM-GROUPING.
  2175                     28 AM-GROUPING-PREFIX PIC XXX.
  2176                     28 AM-GROUPING-PRIME  PIC XXX.
  2177                 24  AM-STATE              PIC XX.
  2178                 24  AM-ACCOUNT.
  2179                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2180                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2181             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2182                                           PIC X(19).
  2183             20  AM-CNTRL-B.
  2184                 24  AM-EXPIRATION-DT      PIC XX.
  2185                 24  FILLER                PIC X(4).
  2186             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2187                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2188
  2189     12  AM-CONTROL-BY-VAR-GRP.
  2190         16  AM-COMPANY-CD-A1              PIC X.
  2191         16  AM-VG-CARRIER                 PIC X.
  2192         16  AM-VG-GROUPING                PIC X(6).
  2193         16  AM-VG-STATE                   PIC XX.
  2194         16  AM-VG-ACCOUNT                 PIC X(10).
  2195         16  AM-VG-DATE.
  2196             20  AM-VG-EXPIRATION-DT       PIC XX.
  2197             20  FILLER                    PIC X(4).
  2198         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2199                                           PIC 9(11)      COMP-3.
  2200     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2201         16  FILLER                        PIC X(10).
  2202         16  AM-VG-KEY3.
  2203             20  AM-VG3-ACCOUNT            PIC X(10).
  2204             20  AM-VG3-EXP-DT             PIC XX.
  2205         16  FILLER                        PIC X(4).
  2206     12  AM-MAINT-INFORMATION.
  2207         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  40
* ELCANC.cbl
  2208         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2209         16  AM-LAST-MAINT-USER            PIC X(4).
  2210         16  FILLER                        PIC XX.
  2211
  2212     12  AM-EFFECTIVE-DT                   PIC XX.
  2213     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2214
  2215     12  AM-PREV-DATES  COMP-3.
  2216         16  AM-PREV-EXP-DT                PIC 9(11).
  2217         16  AM-PREV-EFF-DT                PIC 9(11).
  2218
  2219     12  AM-REPORT-CODE-1                  PIC X(10).
  2220     12  AM-REPORT-CODE-2                  PIC X(10).
  2221
  2222     12  AM-CITY-CODE                      PIC X(4).
  2223     12  AM-COUNTY-PARISH                  PIC X(6).
  2224
  2225     12  AM-NAME                           PIC X(30).
  2226     12  AM-PERSON                         PIC X(30).
  2227     12  AM-ADDRS                          PIC X(30).
  2228     12  AM-CITY.
  2229         16  AM-ADDR-CITY                  PIC X(28).
  2230         16  AM-ADDR-STATE                 PIC XX.
  2231     12  AM-ZIP.
  2232         16  AM-ZIP-PRIME.
  2233             20  AM-ZIP-PRI-1ST            PIC X.
  2234                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2235             20  FILLER                    PIC X(4).
  2236         16  AM-ZIP-PLUS4                  PIC X(4).
  2237     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2238         16  AM-CAN-POSTAL-1               PIC XXX.
  2239         16  AM-CAN-POSTAL-2               PIC XXX.
  2240         16  FILLER                        PIC XXX.
  2241     12  AM-TEL-NO.
  2242         16  AM-AREA-CODE                  PIC 999.
  2243         16  AM-TEL-PRE                    PIC 999.
  2244         16  AM-TEL-NBR                    PIC 9(4).
  2245     12  AM-TEL-LOC                        PIC X.
  2246         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2247         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2248
  2249     12  AM-COMM-STRUCTURE.
  2250         16  AM-DEFN-1.
  2251             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2252                 24  AM-AGT.
  2253                     28  AM-AGT-PREFIX     PIC X(4).
  2254                     28  AM-AGT-PRIME      PIC X(6).
  2255                 24  AM-COM-TYP            PIC X.
  2256                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2257                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2258                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2259                 24  AM-RECALC-LV-INDIC    PIC X.
  2260                 24  AM-RETRO-LV-INDIC     PIC X.
  2261                 24  AM-GL-CODES           PIC X.
  2262                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2263                 24  FILLER                PIC X(01).
  2264         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2265             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  41
* ELCANC.cbl
  2266                 24  FILLER                PIC X(11).
  2267                 24  AM-L-COMA             PIC XXX.
  2268                 24  AM-J-COMA             PIC XXX.
  2269                 24  AM-A-COMA             PIC XXX.
  2270                 24  FILLER                PIC X(6).
  2271
  2272     12  AM-COMM-CHANGE-STATUS             PIC X.
  2273         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2274
  2275     12  AM-CSR-CODE                       PIC X(4).
  2276
  2277     12  AM-BILLING-STATUS                 PIC X.
  2278         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2279         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2280     12  AM-AUTO-REFUND-SW                 PIC X.
  2281         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2282         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2283     12  AM-GPCD                           PIC 99.
  2284     12  AM-IG                             PIC X.
  2285         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2286         88  AM-HAS-GROUP                     VALUE '2'.
  2287     12  AM-STATUS                         PIC X.
  2288         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2289         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2290         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2291         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2292         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2293         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2294         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2295         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2296         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2297         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2298     12  AM-REMIT-TO                       PIC 99.
  2299     12  AM-ID-NO                          PIC X(11).
  2300
  2301     12  AM-CAL-TABLE                      PIC XX.
  2302     12  AM-LF-DEVIATION                   PIC XXX.
  2303     12  AM-AH-DEVIATION                   PIC XXX.
  2304     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2305     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2306     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2307     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2308     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2309     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2310
  2311     12  AM-USER-FIELDS.
  2312         16  AM-FLD-1                      PIC XX.
  2313         16  AM-FLD-2                      PIC XX.
  2314         16  AM-FLD-3                      PIC XX.
  2315         16  AM-FLD-4                      PIC XX.
  2316         16  AM-FLD-5                      PIC XX.
  2317
  2318     12  AM-1ST-PROD-DATE.
  2319         16  AM-1ST-PROD-YR                PIC XX.
  2320         16  AM-1ST-PROD-MO                PIC XX.
  2321         16  AM-1ST-PROD-DA                PIC XX.
  2322     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2323     12  AM-CERTS-PURGED-DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  42
* ELCANC.cbl
  2324         16  AM-PUR-YR                     PIC XX.
  2325         16  AM-PUR-MO                     PIC XX.
  2326         16  AM-PUR-DA                     PIC XX.
  2327     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2328     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2329     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2330     12  AM-INACTIVE-DATE.
  2331         16  AM-INA-MO                     PIC 99.
  2332         16  AM-INA-DA                     PIC 99.
  2333         16  AM-INA-YR                     PIC 99.
  2334     12  AM-AR-HI-CERT-DATE                PIC XX.
  2335
  2336     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2337     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2338
  2339     12  AM-OB-PAYMENT-MODE                PIC X.
  2340         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2341         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2342         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2343         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2344
  2345     12  AM-AH-ONLY-INDICATOR              PIC X.
  2346         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2347         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2348
  2349     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2350
  2351     12  AM-OVER-SHORT.
  2352         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2353         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2354
  2355     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2356     12  AM-DCC-CLP-STATE                  PIC XX.
  2357
  2358     12  AM-RECALC-COMM                    PIC X.
  2359     12  AM-RECALC-REIN                    PIC X.
  2360
  2361     12  AM-REI-TABLE                      PIC XXX.
  2362     12  AM-REI-ET-LF                      PIC X.
  2363     12  AM-REI-ET-AH                      PIC X.
  2364     12  AM-REI-PE-LF                      PIC X.
  2365     12  AM-REI-PE-AH                      PIC X.
  2366     12  AM-REI-PRT-ST                     PIC X.
  2367     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2368     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2369     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2370     12  AM-REI-GROUP-A                    PIC X(6).
  2371     12  AM-REI-MORT                       PIC X(4).
  2372     12  AM-REI-PRT-OW                     PIC X.
  2373     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2374     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2375     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2376     12  AM-REI-GROUP-B                    PIC X(6).
  2377
  2378     12  AM-TRUST-TYPE                     PIC X(2).
  2379
  2380     12  AM-EMPLOYER-STMT-USED             PIC X.
  2381     12  AM-GROUPED-CHECKS-Y-N             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  43
* ELCANC.cbl
  2382
  2383     12  AM-STD-AH-TYPE                    PIC XX.
  2384     12  AM-EARN-METHODS.
  2385         16  AM-EARN-METHOD-R              PIC X.
  2386             88 AM-REF-RL-R78                 VALUE 'R'.
  2387             88 AM-REF-RL-PR                  VALUE 'P'.
  2388             88 AM-REF-RL-MEAN                VALUE 'M'.
  2389             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2390         16  AM-EARN-METHOD-L              PIC X.
  2391             88 AM-REF-LL-R78                 VALUE 'R'.
  2392             88 AM-REF-LL-PR                  VALUE 'P'.
  2393             88 AM-REF-LL-MEAN                VALUE 'M'.
  2394             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2395         16  AM-EARN-METHOD-A              PIC X.
  2396             88 AM-REF-AH-R78                 VALUE 'R'.
  2397             88 AM-REF-AH-PR                  VALUE 'P'.
  2398             88 AM-REF-AH-MEAN                VALUE 'M'.
  2399             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2400             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2401             88 AM-REF-AH-NET                 VALUE 'N'.
  2402
  2403     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2404     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2405     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2406
  2407     12  AM-RET-Y-N                        PIC X.
  2408     12  AM-RET-P-E                        PIC X.
  2409     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2410     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2411     12  AM-RET-GRP                        PIC X(6).
  2412     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2413         16  AM-POOL-PRIME                 PIC XXX.
  2414         16  AM-POOL-SUB                   PIC XXX.
  2415     12  AM-RETRO-EARNINGS.
  2416         16  AM-RET-EARN-R                 PIC X.
  2417         16  AM-RET-EARN-L                 PIC X.
  2418         16  AM-RET-EARN-A                 PIC X.
  2419     12  AM-RET-ST-TAX-USE                 PIC X.
  2420         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2421         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2422     12  AM-RETRO-BEG-EARNINGS.
  2423         16  AM-RET-BEG-EARN-R             PIC X.
  2424         16  AM-RET-BEG-EARN-L             PIC X.
  2425         16  AM-RET-BEG-EARN-A             PIC X.
  2426     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2427     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2428
  2429     12  AM-USER-SELECT-OPTIONS.
  2430         16  AM-USER-SELECT-1              PIC X(10).
  2431         16  AM-USER-SELECT-2              PIC X(10).
  2432         16  AM-USER-SELECT-3              PIC X(10).
  2433         16  AM-USER-SELECT-4              PIC X(10).
  2434         16  AM-USER-SELECT-5              PIC X(10).
  2435
  2436     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2437
  2438     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2439
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  44
* ELCANC.cbl
  2440     12  AM-RPT045A-SWITCH                 PIC X.
  2441         88  RPT045A-OFF                   VALUE 'N'.
  2442
  2443     12  AM-INSURANCE-LIMITS.
  2444         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2445         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2446
  2447     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2448         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2449
  2450     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2451         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2452         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2453
  2454     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2455
  2456     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2457     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2458     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2459     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2460     12  AM-DCC-UEF-STATE                  PIC XX.
  2461     12  FILLER                            PIC XXX.
  2462     12  AM-REPORT-CODE-3                  PIC X(10).
  2463*    12  FILLER                            PIC X(22).
  2464
  2465     12  AM-RESERVE-DATE.
  2466         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2467         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2468         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2469
  2470     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2471     12  AM-NOTIFICATION-TYPES.
  2472         16  AM-NOTIF-OF-LETTERS           PIC X.
  2473         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2474         16  AM-NOTIF-OF-REPORTS           PIC X.
  2475         16  AM-NOTIF-OF-STATUS            PIC X.
  2476
  2477     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2478         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2479         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2480         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2481         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2482
  2483     12  AM-BENEFIT-CONTROLS.
  2484         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2485             20  AM-BENEFIT-CODE           PIC XX.
  2486             20  AM-BENEFIT-TYPE           PIC X.
  2487             20  AM-BENEFIT-REVISION       PIC XXX.
  2488             20  AM-BENEFIT-REM-TERM       PIC X.
  2489             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2490             20  FILLER                    PIC XX.
  2491         16  FILLER                        PIC X(80).
  2492
  2493     12  AM-TRANSFER-DATA.
  2494         16  AM-TRANSFERRED-FROM.
  2495             20  AM-TRNFROM-CARRIER        PIC X.
  2496             20  AM-TRNFROM-GROUPING.
  2497                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  45
* ELCANC.cbl
  2498                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2499             20  AM-TRNFROM-STATE          PIC XX.
  2500             20  AM-TRNFROM-ACCOUNT.
  2501                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2502                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2503             20  AM-TRNFROM-DTE            PIC XX.
  2504         16  AM-TRANSFERRED-TO.
  2505             20  AM-TRNTO-CARRIER          PIC X.
  2506             20  AM-TRNTO-GROUPING.
  2507                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2508                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2509             20  AM-TRNTO-STATE            PIC XX.
  2510             20  AM-TRNTO-ACCOUNT.
  2511                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2512                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2513             20  AM-TRNTO-DTE              PIC XX.
  2514         16  FILLER                        PIC X(10).
  2515
  2516     12  AM-SAVED-REMIT-TO                 PIC 99.
  2517
  2518     12  AM-COMM-STRUCTURE-SAVED.
  2519         16  AM-DEFN-1-SAVED.
  2520             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2521                 24  AM-AGT-SV             PIC X(10).
  2522                 24  AM-COM-TYP-SV         PIC X.
  2523                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2524                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2525                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2526                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2527                 24  FILLER                PIC X.
  2528                 24  AM-GL-CODES-SV        PIC X.
  2529                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2530                 24  FILLER                PIC X.
  2531         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2532             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2533                 24  FILLER                PIC X(11).
  2534                 24  AM-L-COMA-SV          PIC XXX.
  2535                 24  AM-J-COMA-SV          PIC XXX.
  2536                 24  AM-A-COMA-SV          PIC XXX.
  2537                 24  FILLER                PIC X(6).
  2538
  2539     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2540         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2541            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2542            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2543            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2544
  2545     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2546     12  FILLER                            PIC X(120).
  2547
  2548     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2549         16  AM-CONTROL-NAME               PIC X(30).
  2550         16  AM-EXECUTIVE-ONE.
  2551             20  AM-EXEC1-NAME             PIC X(15).
  2552             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2553                                                          COMP-3.
  2554             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2555                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  46
* ELCANC.cbl
  2556         16  AM-EXECUTIVE-TWO.
  2557             20  AM-EXEC2-NAME             PIC X(15).
  2558             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2559                                                          COMP-3.
  2560             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2561                                                          COMP-3.
  2562
  2563     12  AM-RETRO-ADDITIONAL-DATA.
  2564         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2565         16  AM-RETRO-PREM-P-E             PIC X.
  2566         16  AM-RETRO-CLMS-P-I             PIC X.
  2567         16  AM-RETRO-RET-BRACKET-LF.
  2568             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2569                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2570                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2571             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2572                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2573                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2574             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2575                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2576                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2577         16  AM-RETRO-RET-BRACKET-AH.
  2578             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2579                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2580                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2581                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2582             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2583                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2584                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2585             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2586                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2587                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2588
  2589     12  AM-COMMENTS.
  2590         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2591
  2592     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2593         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2594         16  AM-FLI-BILLING-CODE           PIC X.
  2595         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2596         16  AM-FLI-UNITED-IDENT           PIC X.
  2597         16  AM-FLI-INTEREST-LOST-DATA.
  2598             20  AM-FLI-BANK-NO            PIC X(5).
  2599             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2600             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2601             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2602         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2603             20  AM-FLI-AGT                PIC X(9).
  2604             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2605             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2606         16  FILLER                        PIC X(102).
  2607
  2608     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2609         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2610             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2611             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2612             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2613             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  47
* ELCANC.cbl
  2614             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2615         16  FILLER                          PIC X(10).
  2616******************************************************************
  2617*                          COPY ERCPNDB.
  2618******************************************************************
  2619*                                                                *
  2620*                                                                *
  2621*                            ERCPNDB.                            *
  2622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2623*                            VMOD=2.025                          *
  2624*                                                                *
  2625*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2626*                                                                *
  2627******************************************************************
  2628*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2629*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2630******************************************************************
  2631*                                                                *
  2632*                                                                *
  2633*   FILE TYPE = VSAM,KSDS                                        *
  2634*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2635*                                                                *
  2636*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2637*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2638*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2639*                                                 RKP=13,LEN=36  *
  2640*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2641*                                      AND CHG-SEQ.)             *
  2642*                                                RKP=49,LEN=11   *
  2643*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2644*                                      AND CHG-SEQ.)             *
  2645*                                                RKP=60,LEN=15   *
  2646*                                                                *
  2647*   LOG = NO                                                     *
  2648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2649******************************************************************
  2650******************************************************************
  2651*                   C H A N G E   L O G
  2652*
  2653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2654*-----------------------------------------------------------------
  2655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2656* EFFECTIVE    NUMBER
  2657*-----------------------------------------------------------------
  2658* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2659* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2660* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2661* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2662* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2663* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2664* 032306                   PEMA  ADD BOW LOAN NUMBER
  2665* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2666* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2667* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2668* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2669* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2670* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2671* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  48
* ELCANC.cbl
  2672* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2673* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2674* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2675* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  2676******************************************************************
  2677
  2678 01  PENDING-BUSINESS.
  2679     12  PB-RECORD-ID                     PIC XX.
  2680         88  VALID-PB-ID                        VALUE 'PB'.
  2681
  2682     12  PB-CONTROL-PRIMARY.
  2683         16  PB-COMPANY-CD                PIC X.
  2684         16  PB-ENTRY-BATCH               PIC X(6).
  2685         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2686         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2687
  2688     12  PB-CONTROL-BY-ACCOUNT.
  2689         16  PB-COMPANY-CD-A1             PIC X.
  2690         16  PB-CARRIER                   PIC X.
  2691         16  PB-GROUPING.
  2692             20  PB-GROUPING-PREFIX       PIC XXX.
  2693             20  PB-GROUPING-PRIME        PIC XXX.
  2694         16  PB-STATE                     PIC XX.
  2695         16  PB-ACCOUNT.
  2696             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2697             20  PB-ACCOUNT-PRIME         PIC X(6).
  2698         16  PB-CERT-EFF-DT               PIC XX.
  2699         16  PB-CERT-NO.
  2700             20  PB-CERT-PRIME            PIC X(10).
  2701             20  PB-CERT-SFX              PIC X.
  2702         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2703
  2704         16  PB-RECORD-TYPE               PIC X.
  2705             88  PB-MAILING-DATA                VALUE '0'.
  2706             88  PB-ISSUE                       VALUE '1'.
  2707             88  PB-CANCELLATION                VALUE '2'.
  2708             88  PB-BATCH-TRAILER               VALUE '9'.
  2709
  2710     12  PB-CONTROL-BY-ORIG-BATCH.
  2711         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2712         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2713         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2714         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2715
  2716     12  PB-CONTROL-BY-CSR.
  2717         16  PB-CSR-COMPANY-CD            PIC X.
  2718         16  PB-CSR-ID                    PIC X(4).
  2719         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2720         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2721         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2722******************************************************************
  2723*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2724******************************************************************
  2725
  2726     12  PB-LAST-MAINT-DT                 PIC XX.
  2727     12  PB-LAST-MAINT-BY                 PIC X(4).
  2728     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2729
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  49
* ELCANC.cbl
  2730     12  PB-RECORD-BODY                   PIC X(375).
  2731
  2732     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2733         16  PB-CERT-ORIGIN               PIC X.
  2734             88  CLASIC-CREATED-CERT         VALUE '1'.
  2735         16  PB-I-NAME.
  2736             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2737             20  PB-I-INSURED-FIRST-NAME.
  2738                 24  PB-I-INSURED-1ST-INIT PIC X.
  2739                 24  FILLER                PIC X(9).
  2740             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2741         16  PB-I-AGE                     PIC S99   COMP-3.
  2742         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2743         16  PB-I-BIRTHDAY                PIC XX.
  2744         16  PB-I-INSURED-SEX             PIC X.
  2745             88  PB-SEX-MALE     VALUE 'M'.
  2746             88  PB-SEX-FEMALE   VALUE 'F'.
  2747
  2748         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2749         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2750         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2751         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2752         16  PB-I-SKIP-CODE               PIC X.
  2753             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2754             88  PB-SKIP-JULY              VALUE '1'.
  2755             88  PB-SKIP-AUGUST            VALUE '2'.
  2756             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2757             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2758             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2759             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2760             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2761             88  PB-SKIP-JUNE              VALUE '8'.
  2762             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2763             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2764             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2765         16  PB-I-TERM-TYPE               PIC X.
  2766             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2767             88  PB-PAID-WEEKLY            VALUE 'W'.
  2768             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2769             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2770             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2771         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2772         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2773         16  PB-I-DATA-ENTRY-SW           PIC X.
  2774             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2775             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2776             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2777             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2778         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2779         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2780*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2781         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2782         16  FILLER                       PIC X.
  2783
  2784         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2785             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2786             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2787                                                   '90' THRU '99'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  50
* ELCANC.cbl
  2788         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2789                                          PIC XX.
  2790         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2791         16  PB-I-AMOUNT-FINANCED REDEFINES
  2792                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2793         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2794         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2795                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2796         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2797         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2798         16  PB-I-CLP-AMOUNT REDEFINES
  2799                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2800         16  PB-I-LF-CALC-FLAG            PIC X.
  2801             88 PB-COMP-LF-PREM               VALUE '?'.
  2802         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2803         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2804         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2805         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2806         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2807         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2808         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2809         16  PB-I-LF-ABBR                 PIC XXX.
  2810         16  PB-I-LF-INPUT-CD             PIC XX.
  2811
  2812         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2813             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2814             88  PB-INVALID-AH               VALUE '  ' '00'
  2815                                                   '90' THRU '99'.
  2816         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2817         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2818         16  PB-I-AH-CALC-FLAG            PIC X.
  2819             88 PB-COMP-AH-PREM                  VALUE '?'.
  2820         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2821         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2822         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2823         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2824         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2825         16  PB-I-AH-ABBR                 PIC XXX.
  2826         16  PB-I-AH-INPUT-CD             PIC XXX.
  2827
  2828         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2829         16  PB-I-REIN-TABLE              PIC XXX.
  2830         16  PB-I-BUSINESS-TYPE           PIC 99.
  2831         16  PB-I-INDV-GRP-CD             PIC X.
  2832         16  PB-I-MORT-CODE.
  2833             20  PB-I-TABLE               PIC X.
  2834             20  PB-I-INTEREST            PIC XX.
  2835             20  PB-I-MORT-TYP            PIC X.
  2836         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2837         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2838         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2839         16  PB-I-INDV-GRP-OVRD           PIC X.
  2840         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2841         16  PB-I-SIG-SW                  PIC X.
  2842             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2843         16  PB-I-RATE-CLASS              PIC XX.
  2844         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2845         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  51
* ELCANC.cbl
  2846         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2847         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2848         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2849         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2850         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2851         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2852         16  PB-I-OB-FLAG                 PIC X.
  2853             88  PB-I-OB                      VALUE 'B'.
  2854             88  PB-I-SUMMARY                 VALUE 'Z'.
  2855         16  PB-I-ENTRY-STATUS            PIC X.
  2856             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2857                                              'M' '5' '9' '2'.
  2858             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2859             88  PB-I-POLICY-PENDING          VALUE '2'.
  2860             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2861             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2862             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2863             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2864             88  PB-I-REIN-ONLY               VALUE '9'.
  2865             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2866             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2867             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2868             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2869         16  PB-I-INT-CODE                PIC X.
  2870             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2871             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2872         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2873         16  PB-I-SOC-SEC-NO              PIC X(11).
  2874         16  PB-I-MEMBER-NO               PIC X(12).
  2875         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2876*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2877         16  PB-I-OLD-LOF                 PIC XXX.
  2878         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2879         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2880         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2881         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2882         16  PB-I-LIFE-INDICATOR          PIC X.
  2883             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2884         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2885         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2886                                          PIC S9(5)V99    COMP-3.
  2887         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2888             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2889             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2890         16  PB-I-1ST-PMT-DT              PIC XX.
  2891         16  PB-I-JOINT-INSURED.
  2892             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2893             20 PB-I-JOINT-FIRST-NAME.
  2894                24  PB-I-JOINT-FIRST-INIT PIC X.
  2895                24  FILLER                PIC X(9).
  2896             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2897*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2898         16  PB-I-BENEFICIARY-NAME.
  2899             20  PB-I-BANK-NUMBER         PIC X(10).
  2900             20  FILLER                   PIC X(15).
  2901         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2902         16  PB-I-REFERENCE               PIC X(12).
  2903         16  FILLER REDEFINES PB-I-REFERENCE.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  52
* ELCANC.cbl
  2904             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2905             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2906             20  PB-I-CLP-STATE           PIC XX.
  2907         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2908             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2909             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2910             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2911         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2912         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2913         16  PB-I-RESIDENT-STATE          PIC XX.
  2914         16  PB-I-RATE-CODE               PIC X(4).
  2915         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2916         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2917         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2918         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2919         16  PB-I-BANK-NOCHRGB            PIC 99.
  2920         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2921         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2922
  2923     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2924         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2925             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2926         16  PB-C-CANCEL-ORIGIN           PIC X.
  2927             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2928         16  PB-C-LF-CANCEL-DT            PIC XX.
  2929         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2930         16  PB-C-LF-CALC-REQ             PIC X.
  2931             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2932         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2933         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2934         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2935             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2936         16  PB-C-AH-CANCEL-DT            PIC XX.
  2937         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2938         16  PB-C-AH-CALC-REQ             PIC X.
  2939             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2940         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2941         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2942         16  PB-C-LAST-NAME               PIC X(15).
  2943         16  PB-C-REFUND-SW               PIC X.
  2944             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2945             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2946         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2947         16  PB-C-PAYEE-CODE              PIC X(6).
  2948         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2949         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2950         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2951         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2952         16  PB-C-REFERENCE               PIC X(12).
  2953         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2954         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2955         16  PB-C-POST-CARD-IND           PIC X.
  2956         16  PB-C-CANCEL-REASON           PIC X.
  2957         16  PB-C-REF-INTERFACE-SW        PIC X.
  2958         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2959         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2960         16  FILLER                       PIC X(01).
  2961*        16  FILLER                       PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  53
* ELCANC.cbl
  2962         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2963*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2964         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2965         16  PB-CANCELED-CERT-DATA.
  2966             20  PB-CI-INSURED-NAME.
  2967                 24  PB-CI-LAST-NAME      PIC X(15).
  2968                 24  PB-CI-INITIALS       PIC XX.
  2969             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2970             20  PB-CI-INSURED-SEX        PIC X.
  2971             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2972             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2973             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2974             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2975             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2976             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2977             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2978             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2979             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2980             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2981             20  PB-CI-RATE-CLASS         PIC XX.
  2982             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2983             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2984             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2985             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2986             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2987             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2988             20  PB-CI-LF-ABBR            PIC X(3).
  2989             20  PB-CI-AH-ABBR            PIC X(3).
  2990             20  PB-CI-OB-FLAG            PIC X.
  2991                 88  PB-CI-OB                VALUE 'B'.
  2992             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2993                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2994                                           'M' '4' '5' '9' '2'.
  2995                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2996                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2997                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2998                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2999                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3000                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  3001                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3002                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3003                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3004                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3005                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3006                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3007                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3008             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3009                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3010                                           'M' '4' '5' '9' '2'.
  3011                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3012                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3013                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3014                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3015                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3016                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  3017                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3018                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3019                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  54
* ELCANC.cbl
  3020                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3021                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3022                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3023                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3024             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3025             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3026             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3027             20  PB-CI-MEMBER-NO          PIC X(12).
  3028             20  PB-CI-INT-CODE           PIC X.
  3029                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3030                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3031             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3032             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3033             20  PB-CI-COMP-EXCP-SW       PIC X.
  3034                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3035                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3036             20  PB-CI-ENTRY-STATUS       PIC X.
  3037             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3038             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3039             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3040             20  PB-CI-DEATH-DT           PIC XX.
  3041             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3042             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3043             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3044             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3045             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3046             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3047             20  PB-CI-ENTRY-DT              PIC XX.
  3048             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3049             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3050             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3051             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3052             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3053             20  PB-CI-OLD-LOF               PIC XXX.
  3054*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3055             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3056             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3057             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3058             20  PB-CI-INDV-GRP-CD           PIC X.
  3059             20  PB-CI-BENEFICIARY-NAME.
  3060                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3061                 24  FILLER                  PIC X(15).
  3062             20  PB-CI-NOTE-SW               PIC X.
  3063             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3064             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3065             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3066             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3067             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3068             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3069             20  PB-CI-FIRST-NAME            PIC X(10).
  3070             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  3071
  3072         16  FILLER                       PIC X(13).
  3073*032306  16  FILLER                       PIC X(27).
  3074*        16  FILLER                       PIC X(46).
  3075
  3076     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3077         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  55
* ELCANC.cbl
  3078         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3079         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3080         16  PB-M-INSURED-MID-INIT        PIC X.
  3081         16  PB-M-INSURED-AGE             PIC 99.
  3082         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3083         16  PB-M-INSURED-SEX             PIC X.
  3084         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3085         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3086         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3087         16  PB-M-INSURED-CITY-STATE.
  3088             20  PB-M-INSURED-CITY        PIC X(28).
  3089             20  PB-M-INSURED-STATE       PIC XX.
  3090         16  PB-M-INSURED-ZIP-CODE.
  3091             20  PB-M-INSURED-ZIP-PRIME.
  3092                 24  PB-M-INSURED-ZIP-1   PIC X.
  3093                     88  PB-M-CANADIAN-POST-CODE
  3094                                             VALUE 'A' THRU 'Z'.
  3095                 24  FILLER               PIC X(4).
  3096             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3097         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3098                                        PB-M-INSURED-ZIP-CODE.
  3099             20  PM-M-INS-CAN-POST1       PIC XXX.
  3100             20  PM-M-INS-CAN-POST2       PIC XXX.
  3101             20  FILLER                   PIC XXX.
  3102         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3103         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3104         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3105         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3106         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3107         16  PB-M-CRED-BENE-CITYST.
  3108             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3109             20  PB-M-CRED-BENE-STATE     PIC XX.
  3110         16  FILLER                       PIC X(92).
  3111
  3112     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3113         16  FILLER                       PIC X(10).
  3114         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3115         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3116         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3117         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3118         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3119         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3120         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3121         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3122         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3123         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3124         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3125         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3126         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3127         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3128         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3129         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3130         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3131         16  PB-ACCOUNT-NAME              PIC X(30).
  3132         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3133         16  PB-REFERENCE                 PIC X(12).
  3134         16  PB-B-RECEIVED-DT             PIC XX.
  3135         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  56
* ELCANC.cbl
  3136
  3137     12  PB-RECORD-STATUS.
  3138         16  PB-CREDIT-SELECT-DT          PIC XX.
  3139         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3140         16  PB-BILLED-DT                 PIC XX.
  3141         16  PB-BILLING-STATUS            PIC X.
  3142             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3143             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3144             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3145         16  PB-RECORD-BILL               PIC X.
  3146             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3147             88  PB-RECORD-RETURNED           VALUE 'R'.
  3148             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3149             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3150             88  PB-OVERRIDE-AH               VALUE 'A'.
  3151             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3152         16  PB-BATCH-ENTRY               PIC X.
  3153             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3154             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3155             88  PB-REISSUED-CERT             VALUE 'E'.
  3156             88  PB-CASH-CERT                 VALUE 'C'.
  3157             88  PB-MONTHLY-CERT              VALUE 'M'.
  3158             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3159             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3160             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3161         16  PB-FORCE-CODE                PIC X.
  3162             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3163             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3164             88  PB-CANCEL-FORCE              VALUE '8'.
  3165             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3166             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3167             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3168             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3169             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3170             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3171             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  3172             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3173         16  PB-FATAL-FLAG                PIC X.
  3174             88  PB-FATAL-ERRORS              VALUE 'X'.
  3175         16  PB-FORCE-ER-CD               PIC X.
  3176             88  PB-FORCE-ERRORS              VALUE 'F'.
  3177             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3178         16  PB-WARN-ER-CD                PIC X.
  3179             88  PB-WARNING-ERRORS            VALUE 'W'.
  3180         16  FILLER                       PIC X.
  3181         16  PB-OUT-BAL-CD                PIC X.
  3182             88  PB-OUT-OF-BAL                VALUE 'O'.
  3183         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3184         16  PB-AH-OVERRIDE-L1            PIC X.
  3185         16  PB-INPUT-DT                  PIC XX.
  3186         16  PB-INPUT-BY                  PIC X(4).
  3187         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3188         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3189         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3190         16  PB-LF-EARNING-METHOD         PIC X.
  3191         16  PB-AH-EARNING-METHOD         PIC X.
  3192         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3193         16  PB-AH-TERM-CALC-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  57
* ELCANC.cbl
  3194         16  PB-REIN-CD                   PIC XXX.
  3195         16  PB-LF-REFUND-TYPE            PIC X.
  3196         16  PB-AH-REFUND-TYPE            PIC X.
  3197         16  PB-ACCT-EFF-DT               PIC XX.
  3198         16  PB-ACCT-EXP-DT               PIC XX.
  3199         16  PB-COMPANY-ID                PIC X(3).
  3200         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3201         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3202         16  PB-SV-CARRIER                PIC X.
  3203         16  PB-SV-GROUPING               PIC X(6).
  3204         16  PB-SV-STATE                  PIC XX.
  3205         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3206         16  PB-GA-BILLING-INFO.
  3207             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3208                                          PIC XX.
  3209         16  PB-SV-REMIT-TO  REDEFINES
  3210             PB-GA-BILLING-INFO           PIC X(10).
  3211         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3212         16  PB-I-LOAN-OFFICER            PIC X(5).
  3213         16  PB-I-VIN                     PIC X(17).
  3214
  3215         16  FILLER                       PIC X(04).
  3216         16  IMNET-BYPASS-SW              PIC X.
  3217
  3218******************************************************************
  3219*                COMMON EDIT ERRORS                              *
  3220******************************************************************
  3221
  3222     12  PB-COMMON-ERRORS.
  3223         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3224                                           PIC S9(4)     COMP.
  3225
  3226******************************************************************
  3227*                          COPY ERCPNDM.
  3228******************************************************************
  3229*                                                                *
  3230*                                                                *
  3231*                            ERCPNDM                             *
  3232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3233*                            VMOD=2.003                          *
  3234*                                                                *
  3235*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  3236*                                                                *
  3237*   FILE TYPE = VSAM,KSDS                                        *
  3238*   RECORD SIZE = 374   RECFORM = FIX                            *
  3239*                                                                *
  3240*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  3241*   ALTERNATE PATH    = NOT USED                                 *
  3242*                                                                *
  3243*   LOG = YES                                                    *
  3244*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3245******************************************************************
  3246*                   C H A N G E   L O G
  3247*
  3248* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3249*-----------------------------------------------------------------
  3250*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3251* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  58
* ELCANC.cbl
  3252*-----------------------------------------------------------------
  3253* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3254* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  3255* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3256******************************************************************
  3257
  3258 01  PENDING-MAILING-DATA.
  3259     12  PM-RECORD-ID                      PIC XX.
  3260         88  VALID-MA-ID                       VALUE 'PM'.
  3261
  3262     12  PM-CONTROL-PRIMARY.
  3263         16  PM-COMPANY-CD                 PIC X.
  3264         16  PM-ENTRY-BATCH                PIC X(6).
  3265         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  3266         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  3267
  3268     12  FILLER                            PIC X(14).
  3269
  3270     12  PM-ACCESS-CONTROL.
  3271         16  PM-SOURCE-SYSTEM              PIC XX.
  3272             88  PM-FROM-CREDIT                VALUE 'CR'.
  3273             88  PM-FROM-VSI                   VALUE 'VS'.
  3274             88  PM-FROM-WARRANTY              VALUE 'WA'.
  3275             88  PM-FROM-OTHER                 VALUE 'OT'.
  3276         16  PM-RECORD-ADD-DT              PIC XX.
  3277         16  PM-RECORD-ADDED-BY            PIC XXXX.
  3278         16  PM-LAST-MAINT-DT              PIC XX.
  3279         16  PM-LAST-MAINT-BY              PIC XXXX.
  3280         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3281
  3282     12  PM-PROFILE-INFO.
  3283         16  PM-QUALIFY-CODE-1             PIC XX.
  3284         16  PM-QUALIFY-CODE-2             PIC XX.
  3285         16  PM-QUALIFY-CODE-3             PIC XX.
  3286         16  PM-QUALIFY-CODE-4             PIC XX.
  3287         16  PM-QUALIFY-CODE-5             PIC XX.
  3288
  3289         16  PM-INSURED-LAST-NAME          PIC X(15).
  3290         16  PM-INSURED-FIRST-NAME         PIC X(10).
  3291         16  PM-INSURED-MIDDLE-INIT        PIC X.
  3292         16  PM-INSURED-ISSUE-AGE          PIC 99.
  3293         16  PM-INSURED-BIRTH-DT           PIC XX.
  3294         16  PM-INSURED-SEX                PIC X.
  3295             88  PM-SEX-MALE                   VALUE 'M'.
  3296             88  PM-SEX-FEMALE                 VALUE 'F'.
  3297         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  3298
  3299         16  PM-ADDRESS-CORRECTED          PIC X.
  3300         16  PM-JOINT-BIRTH-DT             PIC XX.
  3301*        16  FILLER                        PIC X(12).
  3302
  3303         16  PM-ADDRESS-LINE-1             PIC X(30).
  3304         16  PM-ADDRESS-LINE-2             PIC X(30).
  3305         16  PM-CITY-STATE.
  3306             20  PM-CITY                   PIC X(28).
  3307             20  PM-STATE                  PIC XX.
  3308         16  PM-ZIP.
  3309             20  PM-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  59
* ELCANC.cbl
  3310                 24  PM-ZIP-1              PIC X.
  3311                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3312                 24  FILLER                PIC X(4).
  3313             20  PM-ZIP-PLUS4              PIC X(4).
  3314         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  3315             20  PM-CAN-POST1              PIC XXX.
  3316             20  PM-CAN-POST2              PIC XXX.
  3317             20  FILLER                    PIC XXX.
  3318
  3319         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  3320
  3321         16  FILLER                        PIC X(03).
  3322
  3323     12  PM-CRED-BENE-INFO.
  3324         16  PM-CRED-BENE-NAME             PIC X(25).
  3325         16  PM-CRED-BENE-ADDR             PIC X(30).
  3326         16  PM-CRED-BENE-ADDR2            PIC X(30).
  3327         16  PM-CRED-BENE-CTYST.
  3328             20  PM-CRED-BENE-CITY         PIC X(28).
  3329             20  PM-CRED-BENE-STATE        PIC XX.
  3330         16  PM-CRED-BENE-ZIP.
  3331             20  PM-CB-ZIP-CODE.
  3332                 24  PM-CB-ZIP-1           PIC X.
  3333                     88  PM-CB-CANADIAN-POST-CODE
  3334                                  VALUE 'A' THRU 'Z'.
  3335                 24  FILLER                PIC X(4).
  3336             20  PM-CB-ZIP-PLUS4           PIC X(4).
  3337         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  3338             20  PM-CB-CAN-POST1           PIC XXX.
  3339             20  PM-CB-CAN-POST2           PIC XXX.
  3340             20  FILLER                    PIC XXX.
  3341     12  PM-POST-CARD-MAIL-DATA.
  3342         16  PM-MAIL-DATA OCCURS 7.
  3343             20  PM-MAIL-TYPE              PIC X.
  3344                 88  PM-12MO-MAILING           VALUE '1'.
  3345                 88  PM-EXP-MAILING            VALUE '2'.
  3346             20  PM-MAIL-STATUS            PIC X.
  3347                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  3348                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  3349                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  3350             20  PM-MAIL-DATE              PIC XX.
  3351     12  FILLER                            PIC XX.
  3352     12  FILLER                            PIC X(12).
  3353*    12  FILLER                            PIC X(30).
  3354
  3355******************************************************************
  3356*                          COPY ERCMAIL.
  3357******************************************************************
  3358*                                                                *
  3359*                                                                *
  3360*                            ERCMAIL                             *
  3361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3362*                            VMOD=2.003                          *
  3363*                                                                *
  3364*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3365*                                                                *
  3366*   FILE TYPE = VSAM,KSDS                                        *
  3367*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  60
* ELCANC.cbl
  3368*                                                                *
  3369*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3370*   ALTERNATE PATH    = NOT USED                                 *
  3371*                                                                *
  3372*   LOG = YES                                                    *
  3373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3374******************************************************************
  3375*                   C H A N G E   L O G
  3376*
  3377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3378*-----------------------------------------------------------------
  3379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3380* EFFECTIVE    NUMBER
  3381*-----------------------------------------------------------------
  3382* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3383* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3384* 111108                   PEMA  ADD CRED BENE ADDR2
  3385******************************************************************
  3386
  3387 01  MAILING-DATA.
  3388     12  MA-RECORD-ID                      PIC XX.
  3389         88  VALID-MA-ID                       VALUE 'MA'.
  3390
  3391     12  MA-CONTROL-PRIMARY.
  3392         16  MA-COMPANY-CD                 PIC X.
  3393         16  MA-CARRIER                    PIC X.
  3394         16  MA-GROUPING.
  3395             20  MA-GROUPING-PREFIX        PIC XXX.
  3396             20  MA-GROUPING-PRIME         PIC XXX.
  3397         16  MA-STATE                      PIC XX.
  3398         16  MA-ACCOUNT.
  3399             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3400             20  MA-ACCOUNT-PRIME          PIC X(6).
  3401         16  MA-CERT-EFF-DT                PIC XX.
  3402         16  MA-CERT-NO.
  3403             20  MA-CERT-PRIME             PIC X(10).
  3404             20  MA-CERT-SFX               PIC X.
  3405
  3406     12  FILLER                            PIC XX.
  3407
  3408     12  MA-ACCESS-CONTROL.
  3409         16  MA-SOURCE-SYSTEM              PIC XX.
  3410             88  MA-FROM-CREDIT                VALUE 'CR'.
  3411             88  MA-FROM-VSI                   VALUE 'VS'.
  3412             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3413             88  MA-FROM-OTHER                 VALUE 'OT'.
  3414         16  MA-RECORD-ADD-DT              PIC XX.
  3415         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3416         16  MA-LAST-MAINT-DT              PIC XX.
  3417         16  MA-LAST-MAINT-BY              PIC XXXX.
  3418         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3419
  3420     12  MA-PROFILE-INFO.
  3421         16  MA-QUALIFY-CODE-1             PIC XX.
  3422         16  MA-QUALIFY-CODE-2             PIC XX.
  3423         16  MA-QUALIFY-CODE-3             PIC XX.
  3424         16  MA-QUALIFY-CODE-4             PIC XX.
  3425         16  MA-QUALIFY-CODE-5             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  61
* ELCANC.cbl
  3426
  3427         16  MA-INSURED-LAST-NAME          PIC X(15).
  3428         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3429         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3430         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3431         16  MA-INSURED-BIRTH-DT           PIC XX.
  3432         16  MA-INSURED-SEX                PIC X.
  3433             88  MA-SEX-MALE                   VALUE 'M'.
  3434             88  MA-SEX-FEMALE                 VALUE 'F'.
  3435         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3436
  3437         16  MA-ADDRESS-CORRECTED          PIC X.
  3438         16  MA-JOINT-BIRTH-DT             PIC XX.
  3439*        16  FILLER                        PIC X(12).
  3440
  3441         16  MA-ADDRESS-LINE-1             PIC X(30).
  3442         16  MA-ADDRESS-LINE-2             PIC X(30).
  3443         16  MA-CITY-STATE.
  3444             20  MA-CITY                   PIC X(28).
  3445             20  MA-ADDR-STATE             PIC XX.
  3446         16  MA-ZIP.
  3447             20  MA-ZIP-CODE.
  3448                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3449                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3450                 24  FILLER                PIC X(4).
  3451             20  MA-ZIP-PLUS4              PIC X(4).
  3452         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3453             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3454             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3455             20  FILLER                    PIC X(3).
  3456
  3457         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3458
  3459         16  FILLER                        PIC XXX.
  3460*        16  FILLER                        PIC X(10).
  3461
  3462     12  MA-CRED-BENE-INFO.
  3463         16  MA-CRED-BENE-NAME                 PIC X(25).
  3464         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3465         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3466         16  MA-CRED-BENE-CTYST.
  3467             20  MA-CRED-BENE-CITY             PIC X(28).
  3468             20  MA-CRED-BENE-STATE            PIC XX.
  3469         16  MA-CRED-BENE-ZIP.
  3470             20  MA-CB-ZIP-CODE.
  3471                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3472                     88  MA-CB-CANADIAN-POST-CODE
  3473                                           VALUE 'A' THRU 'Z'.
  3474                 24  FILLER                    PIC X(4).
  3475             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3476         16  MA-CB-CANADIAN-POSTAL-CODE
  3477                            REDEFINES MA-CRED-BENE-ZIP.
  3478             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3479             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3480             20  FILLER                        PIC X(3).
  3481     12  MA-POST-CARD-MAIL-DATA.
  3482         16  MA-MAIL-DATA OCCURS 7.
  3483             20  MA-MAIL-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  62
* ELCANC.cbl
  3484                 88  MA-12MO-MAILING           VALUE '1'.
  3485                 88  MA-EXP-MAILING            VALUE '2'.
  3486             20  MA-MAIL-STATUS            PIC X.
  3487                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3488                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3489                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3490             20  MA-MAIL-DATE              PIC XX.
  3491     12  FILLER                            PIC XX.
  3492     12  FILLER                            PIC XX.
  3493*    12  FILLER                            PIC X(30).
  3494******************************************************************
  3495*                          COPY ELCDATE.
  3496******************************************************************
  3497*                                                                *
  3498*                                                                *
  3499*                            ELCDATE.                            *
  3500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3501*                            VMOD=2.003
  3502*                                                                *
  3503*                                                                *
  3504*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3505*                 LENGTH = 200                                   *
  3506******************************************************************
  3507
  3508 01  DATE-CONVERSION-DATA.
  3509     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3510     12  DC-OPTION-CODE                PIC X.
  3511         88  BIN-TO-GREG                VALUE ' '.
  3512         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3513         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3514         88  YMD-GREG-TO-BIN            VALUE '3'.
  3515         88  MDY-GREG-TO-BIN            VALUE '4'.
  3516         88  JULIAN-TO-BIN              VALUE '5'.
  3517         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3518         88  FIND-CENTURY               VALUE '7'.
  3519         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3520         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3521         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3522         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3523         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3524         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3525         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3526         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3527         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3528         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3529         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3530         88  BIN-3-TO-GREG              VALUE 'I'.
  3531         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3532         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3533         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3534         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3535         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3536         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3537         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3538         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3539         88  THREE-CHARACTER-BIN
  3540                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3541         88  GREGORIAN-TO-BIN
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  63
* ELCANC.cbl
  3542                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3543         88  BIN-TO-GREGORIAN
  3544                  VALUES ' ' '1' 'I' '8' 'G'.
  3545         88  JULIAN-TO-BINARY
  3546                  VALUES '5' 'C' 'E' 'F'.
  3547     12  DC-ERROR-CODE                 PIC X.
  3548         88  NO-CONVERSION-ERROR        VALUE ' '.
  3549         88  DATE-CONVERSION-ERROR
  3550                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3551         88  DATE-IS-ZERO               VALUE '1'.
  3552         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3553         88  DATE-IS-INVALID            VALUE '3'.
  3554         88  DATE1-GREATER-DATE2        VALUE '4'.
  3555         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3556         88  DATE-INVALID-OPTION        VALUE '9'.
  3557         88  INVALID-CENTURY            VALUE 'A'.
  3558         88  ONLY-CENTURY               VALUE 'B'.
  3559         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3560         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3561     12  DC-END-OF-MONTH               PIC X.
  3562         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3563     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3564         88  USE-NORMAL-PROCESS         VALUE ' '.
  3565         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3566         88  ADJUST-UP-100-YRS          VALUE '2'.
  3567     12  FILLER                        PIC X.
  3568     12  DC-CONVERSION-DATES.
  3569         16  DC-BIN-DATE-1             PIC XX.
  3570         16  DC-BIN-DATE-2             PIC XX.
  3571         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3572         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3573                       DC-GREG-DATE-1-EDIT.
  3574             20  DC-EDIT1-MONTH        PIC 99.
  3575             20  SLASH1-1              PIC X.
  3576             20  DC-EDIT1-DAY          PIC 99.
  3577             20  SLASH1-2              PIC X.
  3578             20  DC-EDIT1-YEAR         PIC 99.
  3579         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3580         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3581                     DC-GREG-DATE-2-EDIT.
  3582             20  DC-EDIT2-MONTH        PIC 99.
  3583             20  SLASH2-1              PIC X.
  3584             20  DC-EDIT2-DAY          PIC 99.
  3585             20  SLASH2-2              PIC X.
  3586             20  DC-EDIT2-YEAR         PIC 99.
  3587         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3588         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3589                     DC-GREG-DATE-1-YMD.
  3590             20  DC-YMD-YEAR           PIC 99.
  3591             20  DC-YMD-MONTH          PIC 99.
  3592             20  DC-YMD-DAY            PIC 99.
  3593         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3594         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3595                      DC-GREG-DATE-1-MDY.
  3596             20  DC-MDY-MONTH          PIC 99.
  3597             20  DC-MDY-DAY            PIC 99.
  3598             20  DC-MDY-YEAR           PIC 99.
  3599         16  DC-GREG-DATE-1-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  64
* ELCANC.cbl
  3600             20  DC-ALPHA-MONTH        PIC X(10).
  3601             20  DC-ALPHA-DAY          PIC 99.
  3602             20  FILLER                PIC XX.
  3603             20  DC-ALPHA-CENTURY.
  3604                 24 DC-ALPHA-CEN-N     PIC 99.
  3605             20  DC-ALPHA-YEAR         PIC 99.
  3606         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3607         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3608         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3609         16  DC-JULIAN-DATE            PIC 9(05).
  3610         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3611                                       PIC 9(05).
  3612         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3613             20  DC-JULIAN-YEAR        PIC 99.
  3614             20  DC-JULIAN-DAYS        PIC 999.
  3615         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3616         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3617         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3618     12  DATE-CONVERSION-VARIBLES.
  3619         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3620         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3621             20  FILLER                PIC 9(3).
  3622             20  HOLD-CEN-1-CCYY.
  3623                 24  HOLD-CEN-1-CC     PIC 99.
  3624                 24  HOLD-CEN-1-YY     PIC 99.
  3625             20  HOLD-CEN-1-MO         PIC 99.
  3626             20  HOLD-CEN-1-DA         PIC 99.
  3627         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3628             20  HOLD-CEN-1-R-MO       PIC 99.
  3629             20  HOLD-CEN-1-R-DA       PIC 99.
  3630             20  HOLD-CEN-1-R-CCYY.
  3631                 24  HOLD-CEN-1-R-CC   PIC 99.
  3632                 24  HOLD-CEN-1-R-YY   PIC 99.
  3633             20  FILLER                PIC 9(3).
  3634         16  HOLD-CENTURY-1-X.
  3635             20  FILLER                PIC X(3)  VALUE SPACES.
  3636             20  HOLD-CEN-1-X-CCYY.
  3637                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3638                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3639             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3640             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3641         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3642             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3643             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3644             20  HOLD-CEN-1-R-X-CCYY.
  3645                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3646                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3647             20  FILLER                PIC XXX.
  3648         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3649         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3650         16  DC-JULIAN-DATE-1          PIC 9(07).
  3651         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3652             20  DC-JULIAN-1-CCYY.
  3653                 24  DC-JULIAN-1-CC    PIC 99.
  3654                 24  DC-JULIAN-1-YR    PIC 99.
  3655             20  DC-JULIAN-DA-1        PIC 999.
  3656         16  DC-JULIAN-DATE-2          PIC 9(07).
  3657         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  65
* ELCANC.cbl
  3658             20  DC-JULIAN-2-CCYY.
  3659                 24  DC-JULIAN-2-CC    PIC 99.
  3660                 24  DC-JULIAN-2-YR    PIC 99.
  3661             20  DC-JULIAN-DA-2        PIC 999.
  3662         16  DC-GREG-DATE-A-EDIT.
  3663             20  DC-EDITA-MONTH        PIC 99.
  3664             20  SLASHA-1              PIC X VALUE '/'.
  3665             20  DC-EDITA-DAY          PIC 99.
  3666             20  SLASHA-2              PIC X VALUE '/'.
  3667             20  DC-EDITA-CCYY.
  3668                 24  DC-EDITA-CENT     PIC 99.
  3669                 24  DC-EDITA-YEAR     PIC 99.
  3670         16  DC-GREG-DATE-B-EDIT.
  3671             20  DC-EDITB-MONTH        PIC 99.
  3672             20  SLASHB-1              PIC X VALUE '/'.
  3673             20  DC-EDITB-DAY          PIC 99.
  3674             20  SLASHB-2              PIC X VALUE '/'.
  3675             20  DC-EDITB-CCYY.
  3676                 24  DC-EDITB-CENT     PIC 99.
  3677                 24  DC-EDITB-YEAR     PIC 99.
  3678         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3679         16  DC-GREG-DATE-CYMD-R REDEFINES
  3680                              DC-GREG-DATE-CYMD.
  3681             20  DC-CYMD-CEN           PIC 99.
  3682             20  DC-CYMD-YEAR          PIC 99.
  3683             20  DC-CYMD-MONTH         PIC 99.
  3684             20  DC-CYMD-DAY           PIC 99.
  3685         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3686         16  DC-GREG-DATE-MDCY-R REDEFINES
  3687                              DC-GREG-DATE-MDCY.
  3688             20  DC-MDCY-MONTH         PIC 99.
  3689             20  DC-MDCY-DAY           PIC 99.
  3690             20  DC-MDCY-CEN           PIC 99.
  3691             20  DC-MDCY-YEAR          PIC 99.
  3692    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3693        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3694    12  DC-EL310-DATE                  PIC X(21).
  3695    12  FILLER                         PIC X(28).
  3696
  3697****************************************************************
  3698*
  3699* Copyright (c) 2007-2013 Dell Inc.
  3700* All rights reserved.
  3701*
  3702****************************************************************
  3703 01  DFHEIV.
  3704   02  DFHEIV0               PIC X(35).
  3705   02  DFHEIV1               PIC X(08).
  3706   02  DFHEIV2               PIC X(08).
  3707   02  DFHEIV3               PIC X(08).
  3708   02  DFHEIV4               PIC X(06).
  3709   02  DFHEIV5               PIC X(04).
  3710   02  DFHEIV6               PIC X(04).
  3711   02  DFHEIV7               PIC X(02).
  3712   02  DFHEIV8               PIC X(02).
  3713   02  DFHEIV9               PIC X(01).
  3714   02  DFHEIV10              PIC S9(7) COMP-3.
  3715   02  DFHEIV11              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  66
* ELCANC.cbl
  3716   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3717   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3718   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3719   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3720   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3721   02  DFHEIV17              PIC X(04).
  3722   02  DFHEIV18              PIC X(04).
  3723   02  DFHEIV19              PIC X(04).
  3724   02  DFHEIV20              USAGE IS POINTER.
  3725   02  DFHEIV21              USAGE IS POINTER.
  3726   02  DFHEIV22              USAGE IS POINTER.
  3727   02  DFHEIV23              USAGE IS POINTER.
  3728   02  DFHEIV24              USAGE IS POINTER.
  3729   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3730   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3731   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3732   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3733   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3734   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3735   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3736   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3737   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3738   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3739   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3740   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3741   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3742   02  FILLER                PIC X(02).
  3743   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3744   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3745   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3746   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3747   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3748   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3749   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3750 LINKAGE  SECTION.
  3751*****************************************************************
  3752*                                                               *
  3753* Copyright (c) 2007-2013 Dell Inc.                             *
  3754* All rights reserved.                                          *
  3755*                                                               *
  3756*****************************************************************
  3757 01  dfheiblk.
  3758     02  eibtime          pic s9(7) comp-3.
  3759     02  eibdate          pic s9(7) comp-3.
  3760     02  eibtrnid         pic x(4).
  3761     02  eibtaskn         pic s9(7) comp-3.
  3762     02  eibtrmid         pic x(4).
  3763     02  dfheigdi         pic s9(4) comp.
  3764     02  eibcposn         pic s9(4) comp.
  3765     02  eibcalen         pic s9(4) comp.
  3766     02  eibaid           pic x(1).
  3767     02  eibfiller1       pic x(1).
  3768     02  eibfn            pic x(2).
  3769     02  eibfiller2       pic x(2).
  3770     02  eibrcode         pic x(6).
  3771     02  eibfiller3       pic x(2).
  3772     02  eibds            pic x(8).
  3773     02  eibreqid         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  67
* ELCANC.cbl
  3774     02  eibrsrce         pic x(8).
  3775     02  eibsync          pic x(1).
  3776     02  eibfree          pic x(1).
  3777     02  eibrecv          pic x(1).
  3778     02  eibsend          pic x(1).
  3779     02  eibatt           pic x(1).
  3780     02  eibeoc           pic x(1).
  3781     02  eibfmh           pic x(1).
  3782     02  eibcompl         pic x(1).
  3783     02  eibsig           pic x(1).
  3784     02  eibconf          pic x(1).
  3785     02  eiberr           pic x(1).
  3786     02  eibrldbk         pic x(1).
  3787     02  eiberrcd         pic x(4).
  3788     02  eibsynrb         pic x(1).
  3789     02  eibnodat         pic x(1).
  3790     02  eibfiller5       pic x(2).
  3791     02  eibresp          pic s9(8) comp.
  3792     02  eibresp2         pic s9(8) comp.
  3793     02  dfheigdj         pic s9(4) comp.
  3794     02  dfheigdk         pic s9(4) comp.
  3795 01  DFHCOMMAREA                 PIC X(450).
  3796
  3797 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3798 0000-DFHEXIT SECTION.
  3799     MOVE '9#                    $   ' TO DFHEIV0.
  3800     MOVE 'ELCANC' TO DFHEIV1.
  3801     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3802     MOVE DFHCOMMAREA            TO CANCEL-GEN-PASS-AREA
  3803     MOVE ZEROS                  TO CG-ERROR-CODE
  3804     MOVE ' '                    TO WS-ELCERT-SW
  3805                                    WS-ERACCT-SW
  3806                                    WS-ERPNDB-SW
  3807                                    WS-ELCNTL-SW
  3808     PERFORM 0010-CHECK-FOR-ERRORS THRU 0010-EXIT
  3809     IF NOT CG-SUCCESS
  3810        GO TO 5000-RETURN
  3811     END-IF
  3812     PERFORM 0050-BUILD-CANCEL   THRU 0050-EXIT
  3813     MOVE CM-COMPANY-CD          TO EDIT-COMPANY-CD
  3814     MOVE WS-BATCH-NO            TO EDIT-BATCH
  3815     MOVE CG-COMPANY-ID          TO EDIT-COMPANY-ID
  3816     MOVE SPACES                 TO EDIT-RESTART-BATCH
  3817     IF CG-CANCEL-REISSUE
  3818        PERFORM 0100-BUILD-ISSUE THRU 0100-EXIT
  3819     END-IF
  3820     MOVE WS-BATCH-NO            TO CG-BATCH-NO
  3821     IF CG-FLAT-CANCEL-SAME-BATCH
  3822        PERFORM 0120-UPDATE-BATCH-HDR
  3823                                 THRU 0120-EXIT
  3824     ELSE
  3825        PERFORM 0055-BUILD-BATCH-HDR
  3826                                 THRU 0055-EXIT
  3827     END-IF
  3828
  3829     MOVE PB-B-HIGHEST-SEQ-NO  TO CG-BATCH-SEQ-NO
  3830
  3831* EXEC CICS START
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  68
* ELCANC.cbl
  3832*         TRANSID       ('EXEB')
  3833*         FROM          (BATCH-TO-PROCESS)
  3834*    END-EXEC
  3835     MOVE LENGTH OF
  3836      BATCH-TO-PROCESS
  3837       TO DFHEIV11
  3838     MOVE 'EXEB' TO DFHEIV5
  3839*    MOVE '0( LF                 1   #00003826' TO DFHEIV0
  3840     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  3841     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  3842     MOVE X'2020233030303033383236' TO DFHEIV0(25:11)
  3843     CALL 'kxdfhei1' USING DFHEIV0,
  3844           DFHEIV99,
  3845           DFHEIV5,
  3846           DFHEIV99,
  3847           BATCH-TO-PROCESS,
  3848           DFHEIV11,
  3849           DFHEIV99,
  3850           DFHEIV99,
  3851           DFHEIV99,
  3852           DFHEIV99,
  3853           DFHEIV99,
  3854           DFHEIV99,
  3855           DFHEIV99,
  3856           DFHEIV99,
  3857           DFHEIV99,
  3858           DFHEIV99,
  3859           DFHEIV99
  3860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3861
  3862* EXEC CICS DELAY
  3863*       INTERVAL    (03)
  3864*    END-EXEC
  3865     MOVE 03 TO DFHEIV10
  3866*    MOVE '0$I                   &   #00003830' TO DFHEIV0
  3867     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3869     MOVE X'2020233030303033383330' TO DFHEIV0(25:11)
  3870     CALL 'kxdfhei1' USING DFHEIV0,
  3871           DFHEIV10,
  3872           DFHEIV99,
  3873           DFHEIV99,
  3874           DFHEIV99,
  3875           DFHEIV99
  3876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3877     GO TO 5000-RETURN
  3878     .
  3879 0010-CHECK-FOR-ERRORS.
  3880     IF NOT CG-VALID-OPTION
  3881        SET CG-OPTION-ERROR      TO TRUE
  3882        GO TO 0010-EXIT
  3883     END-IF
  3884     MOVE CG-CERT-KEY            TO WS-ELCERT-KEY
  3885     PERFORM 0020-READ-ELCERT    THRU 0020-EXIT
  3886     IF NOT CERT-FOUND
  3887        SET CG-CERT-NOT-FOUND    TO TRUE
  3888        GO TO 0010-EXIT
  3889     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  69
* ELCANC.cbl
  3890     PERFORM 0040-READ-ERACCT    THRU 0040-EXIT
  3891     IF NOT ACCT-FOUND
  3892        SET CG-NO-ACCT-MSTR      TO TRUE
  3893        GO TO 0010-EXIT
  3894     END-IF
  3895     MOVE CM-CONTROL-PRIMARY     TO WS-ERPNDB2-KEY
  3896     MOVE 0                      TO PNDB2-SEQ-NO
  3897     MOVE '2'                    TO PNDB2-REC-TYPE
  3898     PERFORM 0030-READ-ERPNDB2   THRU 0030-EXIT
  3899     IF PNDB-FOUND
  3900        SET CG-PREV-CAN          TO TRUE
  3901        GO TO 0010-EXIT
  3902     END-IF
  3903     IF ((CG-LF-CAN-DT NOT = LOW-VALUES)
  3904        AND (CM-LF-CANCEL-DT NOT = LOW-VALUES))
  3905                 OR
  3906        ((CG-AH-CAN-DT NOT = LOW-VALUES)
  3907        AND (CM-AH-CANCEL-DT NOT = LOW-VALUES))
  3908        SET CG-PREV-CAN          TO TRUE
  3909        GO TO 0010-EXIT
  3910     END-IF
  3911     IF (CM-LF-CANCEL-DT NOT = LOW-VALUES)
  3912       AND (CM-AH-CANCEL-DT NOT = LOW-VALUES)
  3913        SET CG-PREV-CAN          TO TRUE
  3914        GO TO 0010-EXIT
  3915     END-IF
  3916
  3917     IF ((CG-LF-CAN-DT NOT = LOW-VALUES)
  3918        AND (CG-LF-CAN-AMT = ZEROS))
  3919                 OR
  3920        ((CG-AH-CAN-DT NOT = LOW-VALUES)
  3921        AND (CG-AH-CAN-AMT = ZEROS))
  3922        SET CG-INVALID-DATA      TO TRUE
  3923        GO TO 0010-EXIT
  3924     END-IF
  3925     IF CG-CANCEL-REISSUE
  3926        MOVE ' '                 TO WS-ERPNDB-SW
  3927        MOVE CM-CONTROL-PRIMARY  TO WS-ERPNDB2-KEY
  3928        IF CM-CERT-SFX GREATER THAN SPACES
  3929           MOVE CM-CERT-SFX      TO WS-WRK-SFX
  3930           ADD +1                TO WS-WRK-SFX-COMP
  3931           MOVE WS-WRK-SFX       TO PNDB2-CERT-SUFFIX
  3932        ELSE
  3933           MOVE 'A'              TO PNDB2-CERT-SUFFIX
  3934        END-IF
  3935        MOVE 0                   TO PNDB2-SEQ-NO
  3936        MOVE '1'                 TO PNDB2-REC-TYPE
  3937        PERFORM 0030-READ-ERPNDB2
  3938                                 THRU 0030-EXIT
  3939        IF PNDB-FOUND
  3940           SET CG-SFX-A-EXIST    TO TRUE
  3941           GO TO 0010-EXIT
  3942        END-IF
  3943     END-IF
  3944     .
  3945 0010-EXIT.
  3946     EXIT.
  3947 0020-READ-ELCERT.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  70
* ELCANC.cbl
  3948
  3949* EXEC CICS READ
  3950*       DATASET ('ELCERT')
  3951*       RIDFLD  (WS-ELCERT-KEY)
  3952*       INTO    (CERTIFICATE-MASTER)
  3953*       RESP    (WS-RESPONSE)
  3954*    END-EXEC
  3955     MOVE LENGTH OF
  3956      CERTIFICATE-MASTER
  3957       TO DFHEIV11
  3958     MOVE 'ELCERT' TO DFHEIV1
  3959*    MOVE '&"IL       E          (  N#00003904' TO DFHEIV0
  3960     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3961     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3962     MOVE X'204E233030303033393034' TO DFHEIV0(25:11)
  3963     CALL 'kxdfhei1' USING DFHEIV0,
  3964           DFHEIV1,
  3965           CERTIFICATE-MASTER,
  3966           DFHEIV11,
  3967           WS-ELCERT-KEY,
  3968           DFHEIV99,
  3969           DFHEIV99,
  3970           DFHEIV99
  3971     MOVE EIBRESP  TO WS-RESPONSE
  3972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3973     IF RESP-NORMAL
  3974        SET CERT-FOUND TO TRUE
  3975     END-IF
  3976     .
  3977 0020-EXIT.
  3978     EXIT.
  3979 0030-READ-ERPNDB2.
  3980
  3981* EXEC CICS READ
  3982*       DATASET ('ERPNDB2')
  3983*       RIDFLD  (WS-ERPNDB2-KEY)
  3984*       INTO    (PENDING-BUSINESS)
  3985*       RESP    (WS-RESPONSE)
  3986*    END-EXEC
  3987     MOVE LENGTH OF
  3988      PENDING-BUSINESS
  3989       TO DFHEIV11
  3990     MOVE 'ERPNDB2' TO DFHEIV1
  3991*    MOVE '&"IL       E          (  N#00003917' TO DFHEIV0
  3992     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3993     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3994     MOVE X'204E233030303033393137' TO DFHEIV0(25:11)
  3995     CALL 'kxdfhei1' USING DFHEIV0,
  3996           DFHEIV1,
  3997           PENDING-BUSINESS,
  3998           DFHEIV11,
  3999           WS-ERPNDB2-KEY,
  4000           DFHEIV99,
  4001           DFHEIV99,
  4002           DFHEIV99
  4003     MOVE EIBRESP  TO WS-RESPONSE
  4004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4005     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  71
* ELCANC.cbl
  4006        SET PNDB-FOUND TO TRUE
  4007     END-IF
  4008     .
  4009 0030-EXIT.
  4010     EXIT.
  4011 0040-READ-ERACCT.
  4012     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  4013     MOVE CM-CONTROL-PRIMARY (1:22)
  4014                                 TO WS-ERACCT-KEY (1:22)
  4015
  4016* EXEC CICS STARTBR
  4017*       DATASET     ('ERACCT')
  4018*       RIDFLD      (WS-ERACCT-KEY)
  4019*       GTEQ
  4020*       RESP        (WS-RESPONSE)
  4021*    END-EXEC
  4022     MOVE 'ERACCT' TO DFHEIV1
  4023     MOVE 0
  4024       TO DFHEIV11
  4025*    MOVE '&,         G          &  N#00003933' TO DFHEIV0
  4026     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4027     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4028     MOVE X'204E233030303033393333' TO DFHEIV0(25:11)
  4029     CALL 'kxdfhei1' USING DFHEIV0,
  4030           DFHEIV1,
  4031           WS-ERACCT-KEY,
  4032           DFHEIV99,
  4033           DFHEIV11,
  4034           DFHEIV99
  4035     MOVE EIBRESP  TO WS-RESPONSE
  4036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4037     IF NOT RESP-NORMAL
  4038        SET CG-NO-ACCT-MSTR      TO TRUE
  4039        DISPLAY ' NO ACCT MSTR START ' WS-RESPONSE
  4040        GO TO 0040-EXIT
  4041     END-IF
  4042     .
  4043 0040-CONTINUE.
  4044
  4045* EXEC CICS READNEXT
  4046*       DATASET ('ERACCT')
  4047*       RIDFLD  (WS-ERACCT-KEY)
  4048*       INTO    (ACCOUNT-MASTER)
  4049*       RESP    (WS-RESPONSE)
  4050*    END-EXEC
  4051     MOVE LENGTH OF
  4052      ACCOUNT-MASTER
  4053       TO DFHEIV12
  4054     MOVE 'ERACCT' TO DFHEIV1
  4055     MOVE 0
  4056       TO DFHEIV11
  4057*    MOVE '&.IL                  )  N#00003946' TO DFHEIV0
  4058     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4059     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4060     MOVE X'204E233030303033393436' TO DFHEIV0(25:11)
  4061     CALL 'kxdfhei1' USING DFHEIV0,
  4062           DFHEIV1,
  4063           ACCOUNT-MASTER,
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  72
* ELCANC.cbl
  4064           DFHEIV12,
  4065           WS-ERACCT-KEY,
  4066           DFHEIV99,
  4067           DFHEIV11,
  4068           DFHEIV99,
  4069           DFHEIV99
  4070     MOVE EIBRESP  TO WS-RESPONSE
  4071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4072     IF (RESP-NORMAL)
  4073        AND (CM-CONTROL-PRIMARY (1:20) =
  4074           AM-CONTROL-PRIMARY (1:20))
  4075        IF CM-CERT-EFF-DT = AM-EXPIRATION-DT
  4076           DISPLAY ' READ ERACCT AGAIN ' CM-CERT-NO
  4077           GO TO 0040-CONTINUE
  4078        END-IF
  4079        IF (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  4080           AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  4081           SET ACCT-FOUND TO TRUE
  4082        END-IF
  4083     END-IF
  4084
  4085* EXEC CICS ENDBR
  4086*       DATASET ('ERACCT')
  4087*       RESP    (WS-RESPONSE)
  4088*    END-EXEC
  4089     MOVE 'ERACCT' TO DFHEIV1
  4090     MOVE 0
  4091       TO DFHEIV11
  4092*    MOVE '&2                    $  N#00003964' TO DFHEIV0
  4093     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4094     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4095     MOVE X'204E233030303033393634' TO DFHEIV0(25:11)
  4096     CALL 'kxdfhei1' USING DFHEIV0,
  4097           DFHEIV1,
  4098           DFHEIV11,
  4099           DFHEIV99
  4100     MOVE EIBRESP  TO WS-RESPONSE
  4101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4102     .
  4103 0040-EXIT.
  4104     EXIT.
  4105 0050-BUILD-CANCEL.
  4106     if cg-batch-no not = spaces
  4107        move cg-batch-no         to ws-batch-no
  4108     else
  4109        PERFORM 0060-READ-ELCNTL THRU 0060-EXIT
  4110        IF NOT CNTL-FOUND
  4111           SET CG-MISC-ERROR TO TRUE
  4112           GO TO 0050-EXIT
  4113        END-IF
  4114     end-if
  4115     PERFORM 0070-INIT-PNDB-CAN  THRU 0070-EXIT
  4116     MOVE CM-INSURED-LAST-NAME   TO PB-C-LAST-NAME
  4117     IF CG-FLAT-CANCEL OR CG-FLAT-CANCEL-SAME-BATCH
  4118        IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  4119          AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  4120           MOVE CM-CERT-EFF-DT   TO CG-LF-CAN-DT
  4121           COMPUTE CG-LF-CAN-AMT = CM-LF-PREMIUM-AMT +
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  73
* ELCANC.cbl
  4122              CM-LF-ALT-PREMIUM-AMT
  4123        END-IF
  4124        IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  4125          AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  4126           MOVE CM-CERT-EFF-DT   TO CG-AH-CAN-DT
  4127           MOVE CM-AH-PREMIUM-AMT TO CG-AH-CAN-AMT
  4128        END-IF
  4129     END-IF
  4130     MOVE CG-LF-CAN-DT           TO PB-C-LF-CANCEL-DT
  4131     MOVE CG-AH-CAN-DT           TO PB-C-AH-CANCEL-DT
  4132     MOVE CG-LF-CAN-AMT          TO PB-C-LF-CANCEL-AMT
  4133     MOVE CG-AH-CAN-AMT          TO PB-C-AH-CANCEL-AMT
  4134     evaluate cg-option-code
  4135        when '3'
  4136           move '3'              to pb-c-cancel-reason
  4137        when '1'
  4138           move '2'              to pb-c-cancel-reason
  4139        when '2'
  4140           move '5'              to pb-c-cancel-reason
  4141        when '4'
  4142           move '4'              to pb-c-cancel-reason
  4143     end-evaluate
  4144     IF CG-COMPANY-ID = 'DCC' or 'VPP'
  4145         MOVE CG-DCC-REASON-CD   TO PB-C-CANCEL-REASON
  4146     END-IF
  4147     MOVE CF-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1
  4148     MOVE CF-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1
  4149*    MOVE 'A'                    TO JP-RECORD-TYPE.
  4150*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  4151*    MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  4152*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  4153     IF CG-FLAT-CANCEL-SAME-BATCH
  4154        MOVE PENDING-BUSINESS    TO WS-HOLD-ERPNDB
  4155        PERFORM 0110-GET-NEXT-SEQ THRU 0110-EXIT
  4156        IF RESP-NORMAL
  4157           MOVE WS-HOLD-ERPNDB   TO PENDING-BUSINESS
  4158           MOVE WS-NEXT-SEQ-NO   TO PB-BATCH-SEQ-NO
  4159                                    PB-ORIGINAL-SEQ-NO
  4160                                    PB-CSR-BATCH-SEQ-NO
  4161        ELSE
  4162           SET CG-MISC-ERROR TO TRUE
  4163           GO TO 0050-EXIT
  4164        END-IF
  4165     END-IF
  4166     SET RESP-DUPKEY             TO TRUE
  4167     PERFORM UNTIL NOT RESP-DUPKEY
  4168
  4169* EXEC CICS WRITE
  4170*           DATASET ('ERPNDB')
  4171*           FROM    (PENDING-BUSINESS)
  4172*           RIDFLD  (PB-CONTROL-PRIMARY)
  4173*           RESP    (WS-RESPONSE)
  4174*       END-EXEC
  4175     MOVE LENGTH OF
  4176      PENDING-BUSINESS
  4177       TO DFHEIV11
  4178     MOVE 'ERPNDB' TO DFHEIV1
  4179*    MOVE '&$ L                  ''  N#00004034' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  74
* ELCANC.cbl
  4180     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4182     MOVE X'204E233030303034303334' TO DFHEIV0(25:11)
  4183     CALL 'kxdfhei1' USING DFHEIV0,
  4184           DFHEIV1,
  4185           PENDING-BUSINESS,
  4186           DFHEIV11,
  4187           PB-CONTROL-PRIMARY,
  4188           DFHEIV99,
  4189           DFHEIV99
  4190     MOVE EIBRESP  TO WS-RESPONSE
  4191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4192        IF RESP-DUPREC
  4193            SET RESP-DUPKEY TO TRUE
  4194        END-IF
  4195        IF RESP-DUPKEY
  4196           ADD +1                TO PB-BATCH-SEQ-NO
  4197           MOVE PB-BATCH-SEQ-NO  TO WS-NEXT-SEQ-NO
  4198                                    PB-ORIGINAL-SEQ-NO
  4199                                    PB-CSR-BATCH-SEQ-NO
  4200        END-IF
  4201     END-PERFORM
  4202     IF NOT RESP-NORMAL
  4203        SET CG-MISC-ERROR TO TRUE
  4204        DISPLAY ' ERPNDB CAN WRITE ERROR ' WS-RESPONSE
  4205        GO TO 0050-EXIT
  4206     END-IF
  4207     .
  4208 0050-EXIT.
  4209     EXIT.
  4210 0055-BUILD-BATCH-HDR.
  4211     PERFORM 0090-INIT-PNDB-BATCH THRU 0090-EXIT
  4212     MOVE CG-CERT-CARRIER        TO PB-CARRIER
  4213                                    PB-SV-CARRIER
  4214     MOVE CG-CERT-GROUP          TO PB-GROUPING
  4215                                    PB-SV-GROUPING
  4216     MOVE CG-CERT-STATE          TO PB-STATE
  4217                                    PB-SV-STATE
  4218     MOVE CG-CERT-ACCOUNT        TO PB-ACCOUNT
  4219     MOVE '9'                    TO PB-RECORD-TYPE
  4220     MOVE +1                     TO PB-B-CANCEL-CNT-REMITTED
  4221     MOVE CG-LF-CAN-AMT          TO PB-B-LF-CAN-PRM-REMITTED
  4222     MOVE CG-AH-CAN-AMT          TO PB-B-AH-CAN-PRM-REMITTED
  4223     MOVE CG-MONTH-END-DT        TO PB-CREDIT-SELECT-DT
  4224     MOVE +1                     TO PB-B-HIGHEST-SEQ-NO
  4225     MOVE CG-PROC-ID             TO PB-LAST-MAINT-BY
  4226                                    PB-INPUT-BY
  4227     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS
  4228     MOVE CG-CURRENT-DT          TO PB-LAST-MAINT-DT
  4229                                    PB-INPUT-DT
  4230                                    PB-B-RECEIVED-DT
  4231     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH
  4232     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD
  4233     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  4234     MOVE AM-CSR-CODE            TO PB-CSR-ID.
  4235     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  4236     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO
  4237     MOVE AM-NAME                TO  PB-ACCOUNT-NAME
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  75
* ELCANC.cbl
  4238     IF CG-CANCEL-REISSUE
  4239        MOVE +1                  TO PB-B-ISSUE-CNT-REMITTED
  4240        MOVE +2                  TO PB-B-HIGHEST-SEQ-NO
  4241        if cg-lf-bencd not = '  ' and '00'
  4242           if cg-lf-prem-amt not = 9999999.99
  4243              move cg-lf-prem-amt to pb-b-lf-iss-prm-remitted
  4244              ADD CG-LF-ALT-PREM-AMT TO PB-B-LF-ISS-PRM-REMITTED
  4245           end-if
  4246        end-if
  4247        if cg-ah-bencd not = '  ' and '00'
  4248           if cg-ah-prem-amt not = 9999999.99
  4249              move cg-ah-prem-amt to pb-b-ah-iss-prm-remitted
  4250           end-if
  4251        end-if
  4252     END-IF
  4253
  4254* EXEC CICS WRITE
  4255*        DATASET('ERPNDB')
  4256*        FROM   (PENDING-BUSINESS)
  4257*        RIDFLD (PB-CONTROL-PRIMARY)
  4258*        RESP    (WS-RESPONSE)
  4259*    END-EXEC
  4260     MOVE LENGTH OF
  4261      PENDING-BUSINESS
  4262       TO DFHEIV11
  4263     MOVE 'ERPNDB' TO DFHEIV1
  4264*    MOVE '&$ L                  ''  N#00004101' TO DFHEIV0
  4265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4267     MOVE X'204E233030303034313031' TO DFHEIV0(25:11)
  4268     CALL 'kxdfhei1' USING DFHEIV0,
  4269           DFHEIV1,
  4270           PENDING-BUSINESS,
  4271           DFHEIV11,
  4272           PB-CONTROL-PRIMARY,
  4273           DFHEIV99,
  4274           DFHEIV99
  4275     MOVE EIBRESP  TO WS-RESPONSE
  4276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4277     IF NOT RESP-NORMAL
  4278        SET CG-MISC-ERROR TO TRUE
  4279        DISPLAY ' ERPNDB BTCH WRITE ERROR ' WS-RESPONSE
  4280     END-IF
  4281     .
  4282 0055-EXIT.
  4283     EXIT.
  4284 0060-READ-ELCNTL.
  4285     MOVE CG-COMPANY-ID          TO WS-ELCNTL-KEY
  4286     MOVE '1'                    TO CNTL-REC-TYPE
  4287     MOVE ZEROS                  TO CNTL-SEQ-NO
  4288
  4289* EXEC CICS READ
  4290*       UPDATE
  4291*       DATASET ('ELCNTL')
  4292*       RIDFLD  (WS-ELCNTL-KEY)
  4293*       INTO    (CONTROL-FILE)
  4294*       RESP    (WS-RESPONSE)
  4295*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  76
* ELCANC.cbl
  4296     MOVE LENGTH OF
  4297      CONTROL-FILE
  4298       TO DFHEIV11
  4299     MOVE 'ELCNTL' TO DFHEIV1
  4300*    MOVE '&"IL       EU         (  N#00004118' TO DFHEIV0
  4301     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4302     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4303     MOVE X'204E233030303034313138' TO DFHEIV0(25:11)
  4304     CALL 'kxdfhei1' USING DFHEIV0,
  4305           DFHEIV1,
  4306           CONTROL-FILE,
  4307           DFHEIV11,
  4308           WS-ELCNTL-KEY,
  4309           DFHEIV99,
  4310           DFHEIV99,
  4311           DFHEIV99
  4312     MOVE EIBRESP  TO WS-RESPONSE
  4313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4314     IF NOT RESP-NORMAL
  4315        GO TO 0060-EXIT
  4316     END-IF
  4317     IF CF-LAST-BATCH-NO NOT NUMERIC
  4318        MOVE +0                  TO CF-LAST-BATCH-NO
  4319     END-IF
  4320     ADD +1                      TO CF-LAST-BATCH-NO
  4321     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO-N
  4322     MOVE WS-BATCH-NO-N          TO WS-BATCH-NO
  4323
  4324* EXEC CICS REWRITE
  4325*       DATASET   ('ELCNTL')
  4326*       FROM      (CONTROL-FILE)
  4327*       RESP      (WS-RESPONSE)
  4328*    END-EXEC
  4329     MOVE LENGTH OF
  4330      CONTROL-FILE
  4331       TO DFHEIV11
  4332     MOVE 'ELCNTL' TO DFHEIV1
  4333*    MOVE '&& L                  %  N#00004134' TO DFHEIV0
  4334     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4335     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4336     MOVE X'204E233030303034313334' TO DFHEIV0(25:11)
  4337     CALL 'kxdfhei1' USING DFHEIV0,
  4338           DFHEIV1,
  4339           CONTROL-FILE,
  4340           DFHEIV11,
  4341           DFHEIV99
  4342     MOVE EIBRESP  TO WS-RESPONSE
  4343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4344     IF NOT RESP-NORMAL
  4345        GO TO 0060-EXIT
  4346     END-IF
  4347     SET CNTL-FOUND              TO TRUE
  4348     .
  4349 0060-EXIT.
  4350     EXIT.
  4351 0070-INIT-PNDB-CAN.
  4352     MOVE 'PB'                   TO PENDING-BUSINESS
  4353     INITIALIZE PB-CANCEL-RECORD
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  77
* ELCANC.cbl
  4354     MOVE CM-CONTROL-PRIMARY     TO PB-CONTROL-BY-ACCOUNT
  4355     MOVE PB-CARRIER             TO PB-SV-CARRIER
  4356     MOVE PB-GROUPING            TO PB-SV-GROUPING
  4357     MOVE PB-STATE               TO PB-SV-STATE
  4358     MOVE +0                     TO PB-ALT-CHG-SEQ-NO
  4359                                    PB-BATCH-CHG-SEQ-NO
  4360                                    PB-CSR-BATCH-CHG-SEQ-NO
  4361     MOVE '2'                    TO PB-RECORD-TYPE
  4362     MOVE CM-COMPANY-CD          TO PB-COMPANY-CD
  4363                                    PB-CSR-COMPANY-CD
  4364     MOVE WS-BATCH-NO            TO PB-ENTRY-BATCH
  4365                                    PB-CSR-ENTRY-BATCH
  4366     MOVE +1                     TO PB-BATCH-SEQ-NO
  4367                                    PB-CSR-BATCH-SEQ-NO
  4368     MOVE AM-CSR-CODE            TO PB-CSR-ID
  4369     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH
  4370     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS
  4371     MOVE CG-PROC-ID             TO PB-LAST-MAINT-BY
  4372                                    PB-INPUT-BY
  4373     MOVE CG-CURRENT-DT          TO PB-LAST-MAINT-DT
  4374                                    PB-INPUT-DT
  4375     MOVE CG-COMPANY-ID          TO PB-COMPANY-ID
  4376     MOVE +0                     TO PB-NO-OF-ERRORS
  4377     MOVE LOW-VALUES             TO PB-COMMON-ERRORS
  4378     MOVE ZEROS                  TO PB-C-LF-REF-CALC
  4379                                    PB-C-AH-REF-CALC
  4380                                    PB-C-LF-RFND-CLP
  4381                                    PB-C-AH-RFND-CLP
  4382                                    PB-CI-INSURED-AGE
  4383                                    PB-CI-LF-TERM
  4384                                    PB-CI-AH-TERM
  4385                                    PB-CI-LF-BENEFIT-CD
  4386                                    PB-CI-LF-BENEFIT-AMT
  4387                                    PB-CI-LF-ALT-BENEFIT-AMT
  4388                                    PB-CI-LF-PREMIUM-AMT
  4389                                    PB-CI-LF-ALT-PREMIUM-AMT
  4390                                    PB-CI-AH-BENEFIT-CD
  4391                                    PB-CI-AH-BENEFIT-AMT
  4392                                    PB-CI-AH-PREMIUM-AMT
  4393                                    PB-CI-PAY-FREQUENCY
  4394                                    PB-CI-LOAN-APR
  4395                                    PB-CI-LOAN-TERM
  4396                                    PB-CI-LIFE-COMMISSION
  4397                                    PB-CI-AH-COMMISSION
  4398                                    PB-CI-CURR-SEQ
  4399                                    PB-CI-AH-CANCEL-AMT
  4400                                    PB-CI-LF-CANCEL-AMT
  4401                                    PB-CI-RATE-DEV-PCT-LF
  4402                                    PB-CI-RATE-DEV-PCT-AH
  4403                                    PB-CI-EXTENTION-DAYS
  4404                                    PB-CI-TERM-IN-DAYS
  4405                                    PB-CI-LIVES
  4406                                    PB-CI-LF-CRIT-PER
  4407                                    PB-CI-AH-CRIT-PER
  4408                                    PB-C-LF-REM-TERM
  4409                                    PB-C-AH-REM-TERM
  4410                                    PB-CHG-COUNT
  4411                                    PB-LF-BILLED-AMTS
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  78
* ELCANC.cbl
  4412                                    PB-AH-BILLED-AMTS
  4413                                    PB-C-NH-INT-ON-REFS
  4414                                    PB-CALC-TOLERANCE
  4415     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  4416                                    PB-CI-AH-SETTLEMENT-DT
  4417                                    PB-CI-DEATH-DT
  4418                                    PB-CI-LF-PRIOR-CANCEL-DT
  4419                                    PB-CI-AH-PRIOR-CANCEL-DT
  4420                                    PB-CI-ENTRY-DT
  4421                                    PB-CI-LF-EXPIRE-DT
  4422                                    PB-CI-AH-EXPIRE-DT
  4423                                    PB-CI-LOAN-1ST-PMT-DT
  4424                                    PB-C-LF-CANCEL-DT
  4425                                    PB-C-AH-CANCEL-DT
  4426                                    PB-CREDIT-ACCEPT-DT
  4427                                    PB-BILLED-DT
  4428                                    PB-ACCT-EFF-DT
  4429                                    PB-ACCT-EXP-DT
  4430     MOVE CG-MONTH-END-DT        TO PB-CREDIT-SELECT-DT
  4431*     MOVE 'X'                    TO PB-FATAL-FLAG
  4432     IF CG-CANCEL-REISSUE
  4433        MOVE '8'                 TO PB-FORCE-CODE
  4434     END-IF
  4435     .
  4436 0070-EXIT.
  4437     EXIT.
  4438 0080-INIT-PNDB-ISS.
  4439     MOVE 'PB'                   TO PENDING-BUSINESS
  4440     INITIALIZE PB-ISSUE-RECORD
  4441     MOVE CM-CONTROL-PRIMARY     TO PB-CONTROL-BY-ACCOUNT
  4442     IF CM-CERT-SFX GREATER THAN SPACES
  4443        MOVE CM-CERT-SFX         TO WS-WRK-SFX
  4444        ADD +1                   TO WS-WRK-SFX-COMP
  4445        MOVE WS-WRK-SFX          TO PB-CERT-SFX
  4446     ELSE
  4447        MOVE 'A'                 TO PB-CERT-SFX
  4448     END-IF
  4449     MOVE +0                     TO PB-ALT-CHG-SEQ-NO
  4450                                    PB-BATCH-CHG-SEQ-NO
  4451                                    PB-CSR-BATCH-CHG-SEQ-NO
  4452     MOVE '1'                    TO PB-RECORD-TYPE
  4453     MOVE CM-COMPANY-CD          TO PB-COMPANY-CD
  4454                                    PB-CSR-COMPANY-CD
  4455     MOVE WS-BATCH-NO            TO PB-ENTRY-BATCH
  4456                                    PB-CSR-ENTRY-BATCH
  4457     MOVE +2                     TO PB-BATCH-SEQ-NO
  4458                                    PB-CSR-BATCH-SEQ-NO
  4459     MOVE AM-CSR-CODE            TO PB-CSR-ID
  4460     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH
  4461     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS
  4462     MOVE CG-PROC-ID             TO PB-LAST-MAINT-BY
  4463                                    PB-INPUT-BY
  4464     MOVE CG-CURRENT-DT          TO PB-LAST-MAINT-DT
  4465                                    PB-INPUT-DT
  4466     MOVE CG-COMPANY-ID          TO PB-COMPANY-ID
  4467     MOVE +0                     TO PB-NO-OF-ERRORS
  4468     MOVE LOW-VALUES             TO PB-COMMON-ERRORS
  4469     MOVE CG-MONTH-END-DT        TO PB-CREDIT-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  79
* ELCANC.cbl
  4470     MOVE ZEROS                  TO PB-I-LF-BENEFIT-CD
  4471                                    PB-I-AH-BENEFIT-CD
  4472*     MOVE 'X'                    TO PB-FATAL-FLAG
  4473*     MOVE 'A'                    TO PB-FORCE-CODE
  4474     MOVE ZEROS                  TO PB-CHG-COUNT
  4475                                    PB-LF-BILLED-AMTS
  4476                                    PB-AH-BILLED-AMTS
  4477                                    PB-CALC-TOLERANCE
  4478     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4479                                    PB-BILLED-DT
  4480                                    PB-ACCT-EFF-DT
  4481                                    PB-ACCT-EXP-DT
  4482     .
  4483 0080-EXIT.
  4484     EXIT.
  4485 0090-INIT-PNDB-BATCH.
  4486     MOVE 'PB'                   TO PENDING-BUSINESS
  4487     MOVE CM-COMPANY-CD          TO PB-COMPANY-CD
  4488                                    PB-COMPANY-CD-A1
  4489     MOVE CG-COMPANY-ID          TO PB-COMPANY-ID
  4490     MOVE WS-BATCH-NO            TO PB-ENTRY-BATCH
  4491                                    PB-CERT-NO
  4492     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  4493     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  4494     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  4495                                    PB-ALT-CHG-SEQ-NO
  4496     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-REMITTED
  4497                                    PB-B-LF-ISS-PRM-ENTERED
  4498                                    PB-B-AH-ISS-PRM-REMITTED
  4499                                    PB-B-AH-ISS-PRM-ENTERED
  4500                                    PB-B-ISSUE-CNT-REMITTED
  4501                                    PB-B-ISSUE-CNT-ENTERED
  4502                                    PB-B-CANCEL-CNT-ENTERED
  4503                                    PB-B-LF-CAN-PRM-ENTERED
  4504                                    PB-B-AH-CAN-PRM-ENTERED
  4505                                    PB-B-LF-ISS-PRM-COMPUTED
  4506                                    PB-B-LF-CAN-PRM-COMPUTED
  4507                                    PB-B-AH-ISS-PRM-COMPUTED
  4508                                    PB-B-AH-CAN-PRM-COMPUTED
  4509                                    PB-LF-BILLED-AMTS
  4510                                    PB-AH-BILLED-AMTS
  4511                                    PB-CHG-COUNT
  4512                                    PB-CALC-TOLERANCE
  4513     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4514                                    PB-BILLED-DT
  4515                                    PB-ACCT-EFF-DT
  4516                                    PB-ACCT-EXP-DT
  4517     .
  4518 0090-EXIT.
  4519     EXIT.
  4520 0100-BUILD-ISSUE.
  4521     PERFORM 0080-INIT-PNDB-ISS  THRU 0080-EXIT
  4522     MOVE CG-INS-FNAME           TO PB-I-INSURED-FIRST-NAME
  4523     MOVE CG-INS-LNAME           TO PB-I-INSURED-LAST-NAME
  4524     MOVE CG-INS-MID-INIT        TO PB-I-INSURED-MIDDLE-INIT
  4525     MOVE CG-INS-AGE             TO PB-i-age
  4526     MOVE CG-JNT-FNAME           TO PB-I-JOINT-FIRST-NAME
  4527     MOVE CG-JNT-LNAME           TO PB-I-JOINT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  80
* ELCANC.cbl
  4528     MOVE CG-JNT-MID-INIT        TO PB-I-JOINT-MIDDLE-INIT
  4529     MOVE CG-JNT-AGE             TO PB-i-joint-age
  4530     move cg-vin                 to pb-i-vin
  4531     MOVE CM-LOAN-1ST-PMT-DT     TO PB-I-1ST-PMT-DT
  4532     MOVE '4'                    TO PB-I-DATA-ENTRY-SW
  4533     MOVE CM-LOAN-APR            TO PB-I-LOAN-APR
  4534     MOVE CM-SOC-SEC-NO          TO PB-I-SOC-SEC-NO
  4535     MOVE CM-LOAN-TERM           TO PB-I-LOAN-TERM
  4536     MOVE CM-LOAN-OFFICER        TO PB-I-LOAN-OFFICER
  4537     IF CG-LF-BENCD NOT = '00' AND '  '
  4538        MOVE CF-LIFE-OVERRIDE-L1 TO PB-LIFE-OVERRIDE-L1
  4539        MOVE CG-LF-BENCD         TO PB-I-LIFE-BENEFIT-CD
  4540                                    PB-I-LF-INPUT-CD
  4541        MOVE CM-LF-ORIG-TERM     TO PB-I-LF-TERM
  4542        MOVE CM-LF-BENEFIT-AMT   TO PB-I-LF-BENEFIT-AMT
  4543        IF CG-LF-PREM-AMT = +9999999.99
  4544           MOVE '?'              TO PB-I-LF-CALC-FLAG
  4545        ELSE
  4546           MOVE CG-LF-PREM-AMT   TO PB-I-LF-PREMIUM-AMT
  4547        END-IF
  4548        MOVE CG-LF-ALT-PREM-AMT  TO PB-I-LF-ALT-PREMIUM-AMT
  4549        MOVE CM-LF-ALT-BENEFIT-AMT TO PB-I-LF-ALT-BENEFIT-AMT
  4550        MOVE CM-LF-LOAN-EXPIRE-DT TO PB-I-LF-EXPIRE-DT
  4551        MOVE CM-LF-CRITICAL-PERIOD TO PB-I-LF-CRIT-PER
  4552     END-IF
  4553     IF CG-AH-BENCD NOT = '00' AND '  '
  4554        MOVE CF-AH-OVERRIDE-L1   TO PB-AH-OVERRIDE-L1
  4555        MOVE CG-AH-BENCD         TO PB-I-AH-BENEFIT-CD
  4556                                    PB-I-AH-INPUT-CD
  4557        MOVE CM-AH-ORIG-TERM     TO PB-I-AH-TERM
  4558        MOVE CM-AH-BENEFIT-AMT   TO PB-I-AH-BENEFIT-AMT
  4559        IF CG-AH-PREM-AMT = +9999999.99
  4560           MOVE '?'              TO PB-I-AH-CALC-FLAG
  4561        ELSE
  4562           MOVE CG-AH-PREM-AMT   TO PB-I-AH-PREMIUM-AMT
  4563        END-IF
  4564        MOVE CM-AH-LOAN-EXPIRE-DT TO PB-I-AH-EXPIRE-DT
  4565        MOVE CM-AH-CRITICAL-PERIOD TO PB-I-AH-CRIT-PER
  4566     END-IF
  4567
  4568     IF CG-COMM-PCT-ZERO = 'Y'
  4569        IF ACCT-FOUND
  4570            PERFORM VARYING SUB1 FROM +1 BY +1
  4571                    UNTIL SUB1 > +10
  4572              IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F'
  4573                 IF AM-A-COMA (SUB1) > SPACES OR
  4574                    AM-J-COMA (SUB1) > SPACES OR
  4575                    AM-L-COMA (SUB1) > SPACES
  4576                       MOVE 'P' TO CG-COMM-PCT-ZERO
  4577                 END-IF
  4578              END-IF
  4579            END-PERFORM
  4580        END-IF
  4581     END-IF
  4582     IF CG-COMM-PCT-ZERO = 'P'
  4583         MOVE 'P' TO PB-BATCH-ENTRY
  4584     END-IF
  4585     PERFORM 0200-CHECK-MAIL  THRU 0200-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  81
* ELCANC.cbl
  4586     perform 0300-check-cert-trailer
  4587                              thru 0300-exit
  4588
  4589* EXEC CICS WRITE
  4590*        DATASET ('ERPNDB')
  4591*        FROM    (PENDING-BUSINESS)
  4592*        RIDFLD  (PB-CONTROL-PRIMARY)
  4593*        RESP    (WS-RESPONSE)
  4594*    END-EXEC
  4595     MOVE LENGTH OF
  4596      PENDING-BUSINESS
  4597       TO DFHEIV11
  4598     MOVE 'ERPNDB' TO DFHEIV1
  4599*    MOVE '&$ L                  ''  N#00004383' TO DFHEIV0
  4600     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4602     MOVE X'204E233030303034333833' TO DFHEIV0(25:11)
  4603     CALL 'kxdfhei1' USING DFHEIV0,
  4604           DFHEIV1,
  4605           PENDING-BUSINESS,
  4606           DFHEIV11,
  4607           PB-CONTROL-PRIMARY,
  4608           DFHEIV99,
  4609           DFHEIV99
  4610     MOVE EIBRESP  TO WS-RESPONSE
  4611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4612     IF NOT RESP-NORMAL
  4613        SET CG-MISC-ERROR TO TRUE
  4614        DISPLAY ' ERPNDB ISS WRITE ERROR ' WS-RESPONSE
  4615     END-IF
  4616     .
  4617 0100-EXIT.
  4618     EXIT.
  4619 0110-GET-NEXT-SEQ.
  4620     MOVE PB-CONTROL-PRIMARY     TO WS-ERPNDB-KEY
  4621     MOVE 9999                   TO PNDB-BATCH-SEQ
  4622
  4623* EXEC CICS READ
  4624*       DATASET ('ERPNDB')
  4625*       RIDFLD  (WS-ERPNDB-KEY)
  4626*       INTO    (PENDING-BUSINESS)
  4627*       RESP    (WS-RESPONSE)
  4628*    END-EXEC
  4629     MOVE LENGTH OF
  4630      PENDING-BUSINESS
  4631       TO DFHEIV11
  4632     MOVE 'ERPNDB' TO DFHEIV1
  4633*    MOVE '&"IL       E          (  N#00004399' TO DFHEIV0
  4634     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4636     MOVE X'204E233030303034333939' TO DFHEIV0(25:11)
  4637     CALL 'kxdfhei1' USING DFHEIV0,
  4638           DFHEIV1,
  4639           PENDING-BUSINESS,
  4640           DFHEIV11,
  4641           WS-ERPNDB-KEY,
  4642           DFHEIV99,
  4643           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  82
* ELCANC.cbl
  4644           DFHEIV99
  4645     MOVE EIBRESP  TO WS-RESPONSE
  4646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4647     IF NOT RESP-NORMAL
  4648        DISPLAY ' BAD READ ON BATCH HEADER '
  4649        GO TO 0110-EXIT
  4650     END-IF
  4651     COMPUTE WS-NEXT-SEQ-NO = PB-B-HIGHEST-SEQ-NO + +1
  4652     .
  4653 0110-EXIT.
  4654     EXIT.
  4655 0120-UPDATE-BATCH-HDR.
  4656     MOVE PB-CONTROL-PRIMARY     TO WS-ERPNDB-KEY
  4657     MOVE 9999                   TO PNDB-BATCH-SEQ
  4658
  4659* EXEC CICS READ
  4660*       DATASET ('ERPNDB')
  4661*       RIDFLD  (WS-ERPNDB-KEY)
  4662*       INTO    (PENDING-BUSINESS)
  4663*       UPDATE
  4664*       RESP    (WS-RESPONSE)
  4665*    END-EXEC
  4666     MOVE LENGTH OF
  4667      PENDING-BUSINESS
  4668       TO DFHEIV11
  4669     MOVE 'ERPNDB' TO DFHEIV1
  4670*    MOVE '&"IL       EU         (  N#00004416' TO DFHEIV0
  4671     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4673     MOVE X'204E233030303034343136' TO DFHEIV0(25:11)
  4674     CALL 'kxdfhei1' USING DFHEIV0,
  4675           DFHEIV1,
  4676           PENDING-BUSINESS,
  4677           DFHEIV11,
  4678           WS-ERPNDB-KEY,
  4679           DFHEIV99,
  4680           DFHEIV99,
  4681           DFHEIV99
  4682     MOVE EIBRESP  TO WS-RESPONSE
  4683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4684     IF NOT RESP-NORMAL
  4685        DISPLAY ' BAD READ UPDATE ON BATCH HEADER '
  4686        GO TO 0120-EXIT
  4687     END-IF
  4688     MOVE WS-NEXT-SEQ-NO         TO PB-B-HIGHEST-SEQ-NO
  4689     ADD +1                      TO PB-B-CANCEL-CNT-ENTERED
  4690                                    PB-B-CANCEL-CNT-REMITTED
  4691     COMPUTE PB-B-LF-CAN-PRM-REMITTED = PB-B-LF-CAN-PRM-REMITTED
  4692        + CG-LF-CAN-AMT
  4693     COMPUTE PB-B-LF-CAN-PRM-ENTERED  = PB-B-LF-CAN-PRM-ENTERED
  4694        + CG-LF-CAN-AMT
  4695     COMPUTE PB-B-LF-CAN-PRM-COMPUTED = PB-B-LF-CAN-PRM-COMPUTED
  4696        + CG-LF-CAN-AMT
  4697     COMPUTE PB-B-AH-CAN-PRM-REMITTED = PB-B-AH-CAN-PRM-REMITTED
  4698        + CG-AH-CAN-AMT
  4699     COMPUTE PB-B-AH-CAN-PRM-ENTERED  = PB-B-AH-CAN-PRM-ENTERED
  4700        + CG-AH-CAN-AMT
  4701     COMPUTE PB-B-AH-CAN-PRM-COMPUTED = PB-B-AH-CAN-PRM-COMPUTED
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  83
* ELCANC.cbl
  4702        + CG-AH-CAN-AMT
  4703
  4704* EXEC CICS REWRITE
  4705*       DATASET   ('ERPNDB')
  4706*       FROM      (PENDING-BUSINESS)
  4707*       RESP      (WS-RESPONSE)
  4708*    END-EXEC
  4709     MOVE LENGTH OF
  4710      PENDING-BUSINESS
  4711       TO DFHEIV11
  4712     MOVE 'ERPNDB' TO DFHEIV1
  4713*    MOVE '&& L                  %  N#00004442' TO DFHEIV0
  4714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4716     MOVE X'204E233030303034343432' TO DFHEIV0(25:11)
  4717     CALL 'kxdfhei1' USING DFHEIV0,
  4718           DFHEIV1,
  4719           PENDING-BUSINESS,
  4720           DFHEIV11,
  4721           DFHEIV99
  4722     MOVE EIBRESP  TO WS-RESPONSE
  4723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4724     IF NOT RESP-NORMAL
  4725        DISPLAY ' BAD REWRITE ON BATCH HEADER '
  4726        GO TO 0120-EXIT
  4727     END-IF
  4728     .
  4729 0120-EXIT.
  4730     EXIT.
  4731 0200-CHECK-MAIL.
  4732
  4733* EXEC CICS READ
  4734*       DATASET ('ERMAIL')
  4735*       RIDFLD  (WS-ELCERT-KEY)
  4736*       INTO    (MAILING-DATA)
  4737*       RESP    (WS-RESPONSE)
  4738*    END-EXEC
  4739     MOVE LENGTH OF
  4740      MAILING-DATA
  4741       TO DFHEIV11
  4742     MOVE 'ERMAIL' TO DFHEIV1
  4743*    MOVE '&"IL       E          (  N#00004455' TO DFHEIV0
  4744     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4746     MOVE X'204E233030303034343535' TO DFHEIV0(25:11)
  4747     CALL 'kxdfhei1' USING DFHEIV0,
  4748           DFHEIV1,
  4749           MAILING-DATA,
  4750           DFHEIV11,
  4751           WS-ELCERT-KEY,
  4752           DFHEIV99,
  4753           DFHEIV99,
  4754           DFHEIV99
  4755     MOVE EIBRESP  TO WS-RESPONSE
  4756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4757     IF NOT RESP-NORMAL
  4758        GO TO 0200-EXIT
  4759     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  84
* ELCANC.cbl
  4760     MOVE 'PM'                   TO PENDING-MAILING-DATA
  4761     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY
  4762     MOVE 'CR'                   TO PM-SOURCE-SYSTEM
  4763     MOVE CG-CURRENT-DT          TO PM-RECORD-ADD-DT
  4764     MOVE CG-PROC-ID             TO PM-RECORD-ADDED-BY
  4765     move ma-profile-info        to pm-profile-info
  4766     move ma-cred-bene-info      to pm-cred-bene-info
  4767     move ma-post-card-mail-data to pm-post-card-mail-data
  4768
  4769* EXEC CICS WRITE
  4770*        DATASET ('ERPNDM')
  4771*        FROM    (PENDING-MAILING-DATA)
  4772*        RIDFLD  (PM-CONTROL-PRIMARY)
  4773*        RESP    (WS-RESPONSE)
  4774*    END-EXEC
  4775     MOVE LENGTH OF
  4776      PENDING-MAILING-DATA
  4777       TO DFHEIV11
  4778     MOVE 'ERPNDM' TO DFHEIV1
  4779*    MOVE '&$ L                  ''  N#00004472' TO DFHEIV0
  4780     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4782     MOVE X'204E233030303034343732' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0,
  4784           DFHEIV1,
  4785           PENDING-MAILING-DATA,
  4786           DFHEIV11,
  4787           PM-CONTROL-PRIMARY,
  4788           DFHEIV99,
  4789           DFHEIV99
  4790     MOVE EIBRESP  TO WS-RESPONSE
  4791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4792     IF NOT RESP-NORMAL
  4793        SET CG-MISC-ERROR TO TRUE
  4794        DISPLAY ' ERPNDM ISS WRITE ERROR ' WS-RESPONSE
  4795        GO TO 0200-EXIT
  4796     END-IF
  4797     SET PB-I-MAIL-ADDRS-PRESENT TO TRUE
  4798     MOVE MA-INSURED-BIRTH-DT    TO PB-I-BIRTHDAY
  4799     MOVE MA-CRED-BENE-NAME      TO PB-I-BENEFICIARY-NAME
  4800     .
  4801 0200-EXIT.
  4802     EXIT.
  4803 0300-CHECK-CERT-TRAILER.
  4804
  4805     move ws-elcert-key          to ws-elcrtt-key
  4806     move 'C'                    to ws-elcrtt-key (34:1)
  4807
  4808
  4809* EXEC CICS READ
  4810*       DATASET ('ELCRTT')
  4811*       RIDFLD  (WS-ELCrtt-KEY)
  4812*       INTO    (CERTIFICATE-TRAILERS)
  4813*       RESP    (WS-RESPONSE)
  4814*    END-EXEC
  4815     MOVE LENGTH OF
  4816      CERTIFICATE-TRAILERS
  4817       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  85
* ELCANC.cbl
  4818     MOVE 'ELCRTT' TO DFHEIV1
  4819*    MOVE '&"IL       E          (  N#00004494' TO DFHEIV0
  4820     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4822     MOVE X'204E233030303034343934' TO DFHEIV0(25:11)
  4823     CALL 'kxdfhei1' USING DFHEIV0,
  4824           DFHEIV1,
  4825           CERTIFICATE-TRAILERS,
  4826           DFHEIV11,
  4827           WS-ELCrtt-KEY,
  4828           DFHEIV99,
  4829           DFHEIV99,
  4830           DFHEIV99
  4831     MOVE EIBRESP  TO WS-RESPONSE
  4832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4833
  4834     IF NOT RESP-NORMAL  *>  No worries,
  4835        GO TO 0300-EXIT  *>  not necessary to have one
  4836     END-IF
  4837
  4838     MOVE PB-CONTROL-by-account  TO cs-CONTROL-PRIMARY
  4839     move 'C'                    to cs-trailer-type
  4840     MOVE 'CS'                   TO CS-RECORD-ID
  4841
  4842
  4843* EXEC CICS WRITE
  4844*        DATASET ('ELCRTT')
  4845*        FROM    (CERTIFICATE-TRAILERS)
  4846*        RIDFLD  (CS-CONTROL-PRIMARY)
  4847*        RESP    (WS-RESPONSE)
  4848*    END-EXEC
  4849     MOVE LENGTH OF
  4850      CERTIFICATE-TRAILERS
  4851       TO DFHEIV11
  4852     MOVE 'ELCRTT' TO DFHEIV1
  4853*    MOVE '&$ L                  ''  N#00004509' TO DFHEIV0
  4854     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4855     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4856     MOVE X'204E233030303034353039' TO DFHEIV0(25:11)
  4857     CALL 'kxdfhei1' USING DFHEIV0,
  4858           DFHEIV1,
  4859           CERTIFICATE-TRAILERS,
  4860           DFHEIV11,
  4861           CS-CONTROL-PRIMARY,
  4862           DFHEIV99,
  4863           DFHEIV99
  4864     MOVE EIBRESP  TO WS-RESPONSE
  4865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4866
  4867     IF NOT RESP-NORMAL
  4868        SET CG-MISC-ERROR TO TRUE
  4869        DISPLAY ' ELCRTT ISS WRITE ERROR ' WS-RESPONSE
  4870        GO TO 0300-EXIT
  4871     END-IF
  4872
  4873     .
  4874 0300-EXIT.
  4875     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  86
* ELCANC.cbl
  4876 5000-RETURN.
  4877     MOVE CANCEL-GEN-PASS-AREA   TO DFHCOMMAREA
  4878
  4879* EXEC CICS RETURN
  4880*        END-EXEC.
  4881*    MOVE '.(                    ''   #00004527' TO DFHEIV0
  4882     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4883     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4884     MOVE X'2020233030303034353237' TO DFHEIV0(25:11)
  4885     CALL 'kxdfhei1' USING DFHEIV0,
  4886           DFHEIV99,
  4887           DFHEIV99,
  4888           DFHEIV99,
  4889           DFHEIV99,
  4890           DFHEIV99,
  4891           DFHEIV99
  4892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4893
  4894
  4895
  4896* GOBACK.
  4897     MOVE '9%                    "   ' TO DFHEIV0
  4898     MOVE 'ELCANC' TO DFHEIV1
  4899     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4900     GOBACK.
  4901
  4902 0030-CNVT-DT.
  4903
  4904
  4905* EXEC CICS LINK
  4906*        PROGRAM    ('ELDATCV')
  4907*        COMMAREA   (DATE-CONVERSION-DATA)
  4908*        LENGTH     (DC-COMM-LENGTH)
  4909*    END-EXEC.
  4910     MOVE 'ELDATCV' TO DFHEIV1
  4911*    MOVE '."C                   (   #00004534' TO DFHEIV0
  4912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4914     MOVE X'2020233030303034353334' TO DFHEIV0(25:11)
  4915     CALL 'kxdfhei1' USING DFHEIV0,
  4916           DFHEIV1,
  4917           DATE-CONVERSION-DATA,
  4918           DC-COMM-LENGTH,
  4919           DFHEIV99,
  4920           DFHEIV99,
  4921           DFHEIV99,
  4922           DFHEIV99
  4923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4924
  4925
  4926 0030-CNVT-EXIT.
  4927     EXIT.
  4928
  4929
  4930 9999-DFHBACK SECTION.
  4931     MOVE '9%                    "   ' TO DFHEIV0
  4932     MOVE 'ELCANC' TO DFHEIV1
  4933     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Oct-17 11:45 Page  87
* ELCANC.cbl
  4934     GOBACK.
  4935 9999-DFHEXIT.
  4936     IF DFHEIGDJ EQUAL 0001
  4937         NEXT SENTENCE.
  4938     MOVE '9%                    "   ' TO DFHEIV0
  4939     MOVE 'ELCANC' TO DFHEIV1
  4940     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4941     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8220     Code:        8757
