* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46
    47 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   3
* EL050.cbl
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51
    52 77  FILLER   PIC X(32) VALUE '********************************'.
    53 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    54 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    55
    56 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    57 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    58                                   USAGE POINTER.
    59 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    62                                   USAGE IS POINTER.
    63 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    64 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    65                                   USAGE IS POINTER.
    66 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    67 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    68                                   USAGE IS POINTER.
    69
    70 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    72                                   USAGE IS POINTER.
    73
    74*    COPY ELC50WS.
    75*****************************************************************
    76*                                                               *
    77*                            ELC50WS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.061.                        *
    80*                                                               *
    81*   THIS IS THE WORKING STORAGE FOR EL050                       *
    82*                                   EL517                       *
    83*****************************************************************
    84******************************************************************
    85*                   C H A N G E   L O G
    86*
    87* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    88*-----------------------------------------------------------------
    89*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    90* EFFECTIVE    NUMBER
    91*-----------------------------------------------------------------
    92* 123102                   PEMA  ADD DCC PROCESSING
    93* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    94* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    95* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    96* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    97* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    98* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    99* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   100* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   101* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   102* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   103* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   104* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   105* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   106* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   4
* EL050.cbl
   107* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   108* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   109* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   110* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   111* 030309  CR2009021700001  PEMA  ADD ER-2883
   112* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   113* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   114* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   115* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   116* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   117* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   118* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   119* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   120* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   121* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   122* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   123* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   124* 061412  CR2011022800001  AJRA  NAPERSOFT
   125* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   126* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   127*-----------------------------------------------------------------
   128
   129 01  WORK-AREAS.
   130
   131*****************************************************************
   132*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   133*****************************************************************
   134
   135     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   136     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   137     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   138     12  WS-NAME-EDIT-WORK-AREA.
   139         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   140         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   141             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   142         16  WS-WORK-NAME.
   143             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   144             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   145             20  FILLER           PIC X(10)     VALUE SPACES.
   146         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   147             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   148
   149*****************************************************************
   150*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   151*****************************************************************
   152
   153     12  WS-ERRESC-KEY.
   154         16 WS-ERRESC-SEARCH-KEY.
   155             20  WS-ERRESC-COMPANY-CD PIC  X.
   156             20  WS-ERRESC-CARRIER    PIC  X.
   157             20  WS-ERRESC-GROUP      PIC X(6).
   158             20  WS-ERRESC-STATE      PIC XX.
   159             20  WS-ERRESC-ACCOUNT    PIC X(10).
   160         16 WS-ERRESC-RESIDUAL-KEY.
   161             20  WS-ERRESC-AGENT      PIC X(10).
   162             20  WS-ERRESC-RES-STATE  PIC XX.
   163             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   164*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   5
* EL050.cbl
   165     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   166     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   167
   168*RESIDENT STATE TAX MASTER(ERRESS)
   169*
   170     12  WS-ERRESS-KEY.
   171         16  WS-ERRESS-COMPANY-CD      PIC  X.
   172         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   173         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   174         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   175*                                          YYYYMMDD
   176
   177     12  WS-CONTRACT-DATE              PIC 9(8).
   178*                                          YYYYMMDD
   179     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   180     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   181         16 WS-YEAR-YY                 PIC   9999.
   182         16 FILLER                     PIC 9(4).
   183*                                          YYYYMMDD
   184     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   185     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   186     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   188
   189     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   190         88  DPRB-1ST-TIME                      VALUE ' '.
   191
   192*****************************************************************
   193*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   194*****************************************************************
   195
   196     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   197     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   198     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   199     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   200     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   202     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   203     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   204     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   205     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   206         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   207         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   208     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   209         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   210         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   211     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   212
   213     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   214     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   215
   216     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   217     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   6
* EL050.cbl
   223     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   228     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   230     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   231     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   252     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   253     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   254     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   255     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   264     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   265     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   266     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   267     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   268     12  WS-2671-SW               PIC X         VALUE SPACE.
   269     12  WS-2672-SW               PIC X         VALUE SPACE.
   270     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   271         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   272     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   273         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   274     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   275
   276     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   277         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   278         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   279         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   280         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   7
* EL050.cbl
   281
   282     12  WS-CREDIT-EDIT-CONTROLS.
   283         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   284         16  WS-MIN-AGE           PIC 99                VALUE  0.
   285         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   286         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   287         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   288         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   289
   290     12  WS-AGE-FIELDS.
   291         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   292         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   293         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   295
   296     12  WS-SAVE-ALLOWABLE-BENEFIT.
   297         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   298         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   299         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   300         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   301         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   302         16  FILLER                      PIC XX.
   303
   304     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   305     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   306     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   307     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   308     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   309     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   310     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   311     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   312     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   313     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   314
   315     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   316     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   317     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   318     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   319     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   320     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   321     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   322     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   323         88  WS-REDUCING              VALUE 'R'.
   324         88  WS-LEVEL                 VALUE 'L' 'P'.
   325     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   326
   327     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   328     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   329     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   330     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   331     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   332     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   333     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   334     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   335     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   336
   337     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   338     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   8
* EL050.cbl
   339     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   340     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   341     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   342     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   345     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   346     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   347     12  WS-ACCT-SIG-SW.
   348         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   349         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   350     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   351     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   352     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   353     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   354     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-INITIALS.
   359         16  WS-INIT-1            PIC X         VALUE SPACES.
   360         16  WS-INIT-2            PIC X         VALUE SPACES.
   361
   362     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   363     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   364     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   365     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   366     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   367*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   368     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   369     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   370     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   375     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   376     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   377     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   378     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   379     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   380     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   382     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   384     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   385     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390******** FLA
   391     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   392     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   395     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   396********
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page   9
* EL050.cbl
   397     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   398     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   399     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   401     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   402     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   403     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   404     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   405     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   406     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   407
   408     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   409         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   410                                         '0' THRU '9'.
   411
   412     12  NUMBER-OF-MONTHS.
   413         16  SK-MO OCCURS 12 TIMES PIC X.
   414
   415     12  WS-WORK-DATE.
   416         16  WS-YEAR            PIC 99    VALUE 00.
   417         16  WS-MONTH           PIC 99    VALUE 00.
   418         16  WS-DAY             PIC 99    VALUE 00.
   419
   420     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   421     12  WS-WORK-CRIT-DEV       REDEFINES
   422         WS-WORK-LF-CRIT-PER    PIC X(03).
   423
   424     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   425     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   426
   427     12  WS-WORK-DATE-FROM.
   428         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   429         16  FILLER             PIC X  VALUE SPACE.
   430         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X         VALUE SPACE.
   432         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   433
   434     12  WS-WORK-DATE-THRU.
   435         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   436         16  FILLER             PIC X         VALUE SPACE.
   437         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   440
   441     12  WS-LF-INPUT-CD.
   442         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   443         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   444
   445     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   446     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   447         16  WS-AH-INPUT-CD-1   PIC X.
   448         16  WS-AH-INPUT-CD-2-3 PIC XX.
   449
   450     12  WS-SWITCHES.
   451         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   452         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   453             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   454         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  10
* EL050.cbl
   455             88  BANK-ACCT-FOUND          VALUE 'Y'.
   456         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   457             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   458         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   459             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   460         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   461             88  COMP-MASTER-FOUND        VALUE 'Y'.
   462         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   463             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   464         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   465             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   466         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   467             88  STAT-MASTER-FOUND        VALUE 'Y'.
   468         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   469             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   471             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   472         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   473             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   475             88  FORM-MASTER-FOUND        VALUE 'Y'.
   476         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   477             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   478         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   479             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   481             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   482         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   483             88  NO-BENEFIT-FOUND         VALUE 'N'.
   484         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   485             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   486         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   488         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   489             88  AH-BENEFIT-FOUND         VALUE ' '.
   490             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   491         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   492             88  LF-BENEFIT-FOUND         VALUE ' '.
   493             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   494         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   495             88  NO-STATE-RECORD          VALUE '1'.
   496         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   497             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   498         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   499             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   501             88  CERT-WAS-FOUND           VALUE ' '.
   502             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   503         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   504             88  BROWSE-STARTED           VALUE 'Y'.
   505         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   506             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   507         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   508             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   509         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   510             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   511         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   512             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  11
* EL050.cbl
   513         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   514             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   516             88  APP-CERT-USED            VALUE 'Y' 'A'.
   517         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   518             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   519             88  FIRST-TIME-THROUGH       VALUE '1'.
   520             88  CTBL-NOT-FOUND           VALUE '2'.
   521
   522         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   523             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   524
   525         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   526             88  DLO-ERROR-FOUND          VALUE 'Y'.
   527
   528********FLA
   529     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   530     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   531********
   532     12  RC-SW-1                  PIC X           VALUE '0'.
   533     12  RC-SW-2                  PIC X           VALUE '0'.
   534     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   535     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   536     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   537     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   538     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   544     12  LIT-SPACES               PIC X           VALUE SPACES.
   545     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   546     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   547     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   548     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   549     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   550     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   551     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   552         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   553         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   554     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   555         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   556
   557 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   558     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   559     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   560 01  WS-CRI-SSN-WORK-AREA.
   561     05  WS-CRI-SOC-SEC-NO.
   562         10  WS-SS-REPT-CD       PIC X(5).
   563         10  WS-SS-LAST-NAME     PIC X(5).
   564         10  WS-SS-INITIAL       PIC X.
   565
   566     05  WS-CRI-REPORT-CODE.
   567         10  FILLER              PIC X(5).
   568         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   569
   570     05  WS-CRI-LAST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  12
* EL050.cbl
   571         10  WS-CRI-NAME-MOVE    PIC X(5).
   572         10  FILLER              PIC X(10).
   573
   574 01  WS-NUM-TABLE                PIC X(26)  VALUE
   575     '12345678012345070923456789'.
   576 01  FILLER REDEFINES WS-NUM-TABLE.
   577     05  WS-NUM OCCURS 26        PIC 9.
   578 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   579 01  V1                          PIC S999 COMP-3.
   580 01  V2                          PIC S999 COMP-3.
   581 01  V3                          PIC S999 COMP-3.
   582 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   583 01  FILLER REDEFINES WS-WORK-VIN.
   584     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   585 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   586 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   587 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   588 01  WS-HEX-WORK.
   589     05  FILLER                  PIC X  VALUE LOW-VALUES.
   590     05  WS-HEX-BYTE             PIC X.
   591 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   592 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   593 01  WS-WORK-HIN-ROW-B.
   594     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   595
   596 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   597 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   598     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   599 01  WS-ROW-D-TABLE.
   600     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   601
   602 01  WS-HIN-TABLE-B.
   603     05  F                       PIC XX VALUE 'A2'.
   604     05  F                       PIC XX VALUE 'B3'.
   605     05  F                       PIC XX VALUE 'C4'.
   606     05  F                       PIC XX VALUE 'D5'.
   607     05  F                       PIC XX VALUE 'E6'.
   608     05  F                       PIC XX VALUE 'F7'.
   609     05  F                       PIC XX VALUE 'G8'.
   610     05  F                       PIC XX VALUE 'H9'.
   611     05  F                       PIC XX VALUE 'I1'.
   612     05  F                       PIC XX VALUE 'J2'.
   613     05  F                       PIC XX VALUE 'K3'.
   614     05  F                       PIC XX VALUE 'L4'.
   615     05  F                       PIC XX VALUE 'M5'.
   616     05  F                       PIC XX VALUE 'N6'.
   617     05  F                       PIC XX VALUE 'O0'.
   618     05  F                       PIC XX VALUE 'P7'.
   619     05  F                       PIC XX VALUE 'Q0'.
   620     05  F                       PIC XX VALUE 'R8'.
   621     05  F                       PIC XX VALUE 'S9'.
   622     05  F                       PIC XX VALUE 'T2'.
   623     05  F                       PIC XX VALUE 'U3'.
   624     05  F                       PIC XX VALUE 'V4'.
   625     05  F                       PIC XX VALUE 'W5'.
   626     05  F                       PIC XX VALUE 'X6'.
   627     05  F                       PIC XX VALUE 'Y7'.
   628     05  F                       PIC XX VALUE 'Z8'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  13
* EL050.cbl
   629 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   630     05  WS-VAL-IN               PIC X.
   631     05  WS-VAL-OUT              PIC 9.
   632 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   633 01  WS-COMPARE-BINARY-DATES.
   634     05  WS-971231                PIC XX VALUE X'92FF'.
   635     05  WS-931231                PIC XX VALUE X'8CFF'.
   636     05  WS-791231                PIC XX VALUE X'77FF'.
   637     05  WS-771001                PIC XX VALUE X'74A1'.
   638     05  WS-820301                PIC XX VALUE X'7B41'.
   639     05  WS-831031                PIC XX VALUE X'7DBF'.
   640     05  WS-831231                PIC XX VALUE X'7DFF'.
   641     05  WS-810831                PIC XX VALUE X'7A7F'.
   642     05  WS-830901                PIC XX VALUE X'7D81'.
   643
   644 01  FILE-ACCESS-IDS.
   645     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   646     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   647     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   648     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   649     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   650     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   651     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   652     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   653     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   654     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   655     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   656     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   657     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   658     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   659     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   660     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   661     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   662 01  DD-IU-SW                    PIC X   VALUE ' '.
   663     88  DD-IU-PRESENT                 VALUE 'Y'.
   664
   665 01  ACCESS-KEYS.
   666     12  ELMSTR-KEY.
   667         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   668         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   669     12  W-CLAIM-KEY.
   670         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   671         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   672
   673     12  ELCNTL-KEY.
   674         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   675         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   676         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   677         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   678
   679     12  ELCERT-KEY.
   680         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   681         16  CERT-CARRIER         PIC X       VALUE SPACE.
   682         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   683         16  CERT-STATE           PIC XX      VALUE SPACES.
   684         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   685         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   686         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  14
* EL050.cbl
   687
   688     12  ELCERT2-KEY.
   689         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   690         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   691
   692     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   693
   694     12  ELCERT-SAVE.
   695         16  FILLER                      PIC XX    VALUE SPACES.
   696
   697         16  WCS-CONTROL-PRIMARY.
   698             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   699             20  WCS-CARRIER             PIC X     VALUE SPACE.
   700             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   701             20  WCS-STATE               PIC XX    VALUE SPACES.
   702             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   703             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   704             20  WCS-CERT-NO.
   705                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   706                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   707
   708         16  CS-CONTROL-BY-NAME.
   709             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   710             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   711             20  CS-INSURED-INITIALS.
   712                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   713                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   714
   715         16  CS-CONTROL-BY-SSN.
   716             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   717             20  CS-SOC-SEC-NO.
   718                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   719                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   720                 24  CS-SSN-LN3.
   721                     28 CS-INSURED-INITIALS-A2   PIC XX
   722                                     VALUE SPACES.
   723                     28 CS-PART-LAST-NAME-A2     PIC X
   724                                     VALUE SPACE.
   725
   726         16  CS-CONTROL-BY-CERT-NO.
   727             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   728             20  CS-CERT-NO-A4           PIC X(11)
   729                                     VALUE SPACES.
   730
   731         16  CS-CONTROL-BY-MEMB.
   732             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   733             20  CS-MEMBER-NO.
   734                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   735                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   736                 24  CS-MEMB-LN4.
   737                     28 CS-INSURED-INITIALS-A5   PIC XX
   738                                      VALUE SPACES.
   739                     28 CS-PART-LAST-NAME-A5     PIC XX
   740                                      VALUE SPACES.
   741
   742         16  FILLER              PIC X(360) VALUE SPACES.
   743
   744     12  ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  15
* EL050.cbl
   745         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   746         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   747         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   748         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   749         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   750         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   751
   752     12  ERCOMP-KEY.
   753         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   754         16  COMP-CARRIER         PIC X     VALUE SPACES.
   755         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   756         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   757         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   758         16  COMP-TYPE            PIC X     VALUE SPACES.
   759
   760     12  ERLOFC-KEY.
   761         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   762         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   763         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   764         16  LOFC-STATE           PIC XX    VALUE SPACES.
   765         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   766         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   767
   768     12  WS-ELCRTT-KEY.
   769         16  WS-ELCRTT-PRIMARY       PIC X(33).
   770         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   771
   772     12  ERBXRF-KEY.
   773         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   774         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   775         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   776         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   777
   778     12  ERAGTC-KEY.
   779         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   780         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   781         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   782         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   783         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   784         16  AGTC-TYPE            PIC X     VALUE SPACES.
   785
   786     12  ERPLAN-KEY.
   787         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   788         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   789         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   790         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   791         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   792         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   793         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   794         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   795
   796     12  ERFORM-KEY.
   797         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   798         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   799         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   800         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   801
   802     12  ERREIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  16
* EL050.cbl
   803         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   804         16  REIN-TYPE            PIC X     VALUE SPACES.
   805         16  REIN-TABLE-CO.
   806             20  REIN-CODE-1      PIC X     VALUE SPACE.
   807             20  REIN-CODE-2      PIC X     VALUE SPACE.
   808             20  REIN-CODE-3      PIC X     VALUE SPACE.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810
   811     12  ERCTBL-KEY.
   812         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   813         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   814         16  CTBL-CNTRL-2.
   815             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   816             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   817
   818     12  ELCRTO-KEY.
   819         16  ELCRTO-COMPANY-CD       PIC X.
   820         16  ELCRTO-CARRIER          PIC X.
   821         16  ELCRTO-GROUPING         PIC X(6).
   822         16  ELCRTO-STATE            PIC XX.
   823         16  ELCRTO-ACCOUNT          PIC X(10).
   824         16  ELCRTO-CERT-EFF-DT      PIC XX.
   825         16  ELCRTO-CERT-NO.
   826             20  ELCRTO-CERT-PRIME   PIC X(10).
   827             20  ELCRTO-CERT-SFX     PIC X.
   828         16  ELCRTO-RECORD-TYPE      PIC X.
   829         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   830
   831
   832     12  WS-ACCESS.
   833         16  FILLER               PIC XX    VALUE SPACES.
   834         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   835
   836     12  WS-CARR-ACCESS.
   837         16  FILLER               PIC X(3)  VALUE SPACES.
   838         16  WS-CARR              PIC X     VALUE SPACE.
   839*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   840*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   841     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   842         88  WS-DMD-LF-RATING   VALUE 'Y'.
   843         88  WS-DMD-AH-RATING   VALUE 'Y'.
   844         88  WS-DMD-NO-RATING   VALUE 'N'.
   845
   846     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   847         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   848                                         'NJ' 'NL'
   849                                         'PJ' 'PL'
   850                                         'SJ' 'SL'.
   851     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   852         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   853                                         'NI' 'NJ' 'NL' 'NU'
   854                                         'PJ' 'PL' 'PI' 'PU'
   855                                         'SI' 'SJ' 'SL' 'SU'
   856                                         'MX' 'MY' 'MZ'.
   857 01  ERPDEF-KEY-SAVE             PIC X(18).
   858 01  ERPDEF-KEY.
   859     12  ERPDEF-COMPANY-CD       PIC X.
   860     12  ERPDEF-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  17
* EL050.cbl
   861     12  ERPDEF-PROD-CD          PIC XXX.
   862     12  F                       PIC X(7).
   863     12  ERPDEF-BEN-TYPE         PIC X.
   864     12  ERPDEF-BEN-CODE         PIC XX.
   865     12  ERPDEF-EXP-DT           PIC XX.
   866
   867 01  ELSTAT-KEY-SAVE             PIC X(20).
   868 01  ELSTAT-KEY.
   869     12  ELSTAT-COMPANY-ID       PIC XXX.
   870     12  ELSTAT-CARRIER          PIC X.
   871     12  ELSTAT-GROUP            PIC X(6).
   872     12  ELSTAT-STATE            PIC XX.
   873     12  ELSTAT-EXP-DT           PIC 9(8).
   874 01  WS-ERROR-VALUES.
   875     12  ER-1570                     PIC S9(4)   VALUE +1570.
   876     12  ER-1571                     PIC S9(4)   VALUE +1571.
   877     12  ER-1575                     PIC S9(4)   VALUE +1575.
   878     12  ER-1891                     PIC S9(4)   VALUE +1891.
   879     12  ER-1892                     PIC S9(4)   VALUE +1892.
   880     12  ER-1893                     PIC S9(4)   VALUE +1893.
   881     12  ER-1894                     PIC S9(4)   VALUE +1894.
   882     12  ER-1895                     PIC S9(4)   VALUE +1895.
   883     12  ER-1896                     PIC S9(4)   VALUE +1896.
   884     12  ER-1897                     PIC S9(4)   VALUE +1897.
   885     12  ER-1898                     PIC S9(4)   VALUE +1898.
   886     12  ER-1899                     PIC S9(4)   VALUE +1899.
   887     12  ER-1900                     PIC S9(4)   VALUE +1900.
   888     12  ER-1901                     PIC S9(4)   VALUE +1901.
   889     12  ER-1902                     PIC S9(4)   VALUE +1902.
   890     12  ER-1903                     PIC S9(4)   VALUE +1903.
   891     12  ER-1904                     PIC S9(4)   VALUE +1904.
   892     12  ER-1905                     PIC S9(4)   VALUE +1905.
   893     12  ER-1906                     PIC S9(4)   VALUE +1906.
   894     12  ER-1907                     PIC S9(4)   VALUE +1907.
   895     12  ER-1909                     PIC S9(4)   VALUE +1909.
   896     12  ER-1910                     PIC S9(4)   VALUE +1910.
   897     12  ER-1911                     PIC S9(4)   VALUE +1911.
   898     12  ER-1912                     PIC S9(4)   VALUE +1912.
   899     12  ER-1913                     PIC S9(4)   VALUE +1913.
   900     12  ER-1914                     PIC S9(4)   VALUE +1914.
   901     12  ER-1915                     PIC S9(4)   VALUE +1915.
   902     12  ER-1916                     PIC S9(4)   VALUE +1916.
   903     12  ER-1917                     PIC S9(4)   VALUE +1917.
   904     12  ER-1918                     PIC S9(4)   VALUE +1918.
   905     12  ER-1919                     PIC S9(4)   VALUE +1919.
   906     12  ER-1920                     PIC S9(4)   VALUE +1920.
   907     12  ER-1921                     PIC S9(4)   VALUE +1921.
   908     12  ER-1922                     PIC S9(4)   VALUE +1922.
   909     12  ER-1923                     PIC S9(4)   VALUE +1923.
   910     12  ER-1924                     PIC S9(4)   VALUE +1924.
   911     12  ER-1925                     PIC S9(4)   VALUE +1925.
   912     12  ER-1926                     PIC S9(4)   VALUE +1926.
   913     12  ER-1927                     PIC S9(4)   VALUE +1927.
   914     12  ER-2393                     PIC S9(4)   VALUE +2393.
   915     12  ER-2600                     PIC S9(4)   VALUE +2600.
   916     12  ER-2601                     PIC S9(4)   VALUE +2601.
   917     12  ER-2602                     PIC S9(4)   VALUE +2602.
   918     12  ER-2603                     PIC S9(4)   VALUE +2603.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  18
* EL050.cbl
   919     12  ER-2604                     PIC S9(4)   VALUE +2604.
   920     12  ER-2605                     PIC S9(4)   VALUE +2605.
   921     12  ER-2606                     PIC S9(4)   VALUE +2606.
   922     12  ER-2607                     PIC S9(4)   VALUE +2607.
   923     12  ER-2608                     PIC S9(4)   VALUE +2608.
   924     12  ER-2609                     PIC S9(4)   VALUE +2609.
   925     12  ER-2610                     PIC S9(4)   VALUE +2610.
   926     12  ER-2611                     PIC S9(4)   VALUE +2611.
   927     12  ER-2612                     PIC S9(4)   VALUE +2612.
   928     12  ER-2613                     PIC S9(4)   VALUE +2613.
   929     12  ER-2614                     PIC S9(4)   VALUE +2614.
   930     12  ER-2615                     PIC S9(4)   VALUE +2615.
   931     12  ER-2616                     PIC S9(4)   VALUE +2616.
   932     12  ER-2617                     PIC S9(4)   VALUE +2617.
   933     12  ER-2618                     PIC S9(4)   VALUE +2618.
   934     12  ER-2619                     PIC S9(4)   VALUE +2619.
   935     12  ER-2620                     PIC S9(4)   VALUE +2620.
   936     12  ER-2621                     PIC S9(4)   VALUE +2621.
   937     12  ER-2622                     PIC S9(4)   VALUE +2622.
   938     12  ER-2623                     PIC S9(4)   VALUE +2623.
   939     12  ER-2624                     PIC S9(4)   VALUE +2624.
   940     12  ER-2625                     PIC S9(4)   VALUE +2625.
   941     12  ER-2626                     PIC S9(4)   VALUE +2626.
   942     12  ER-2627                     PIC S9(4)   VALUE +2627.
   943     12  ER-2628                     PIC S9(4)   VALUE +2628.
   944     12  ER-2629                     PIC S9(4)   VALUE +2629.
   945     12  ER-2630                     PIC S9(4)   VALUE +2630.
   946     12  ER-2631                     PIC S9(4)   VALUE +2631.
   947     12  ER-2632                     PIC S9(4)   VALUE +2632.
   948     12  ER-2633                     PIC S9(4)   VALUE +2633.
   949     12  ER-2634                     PIC S9(4)   VALUE +2634.
   950     12  ER-2635                     PIC S9(4)   VALUE +2635.
   951     12  ER-2636                     PIC S9(4)   VALUE +2636.
   952     12  ER-2637                     PIC S9(4)   VALUE +2637.
   953     12  ER-2638                     PIC S9(4)   VALUE +2638.
   954     12  ER-2639                     PIC S9(4)   VALUE +2639.
   955     12  ER-2640                     PIC S9(4)   VALUE +2640.
   956     12  ER-2641                     PIC S9(4)   VALUE +2641.
   957     12  ER-2642                     PIC S9(4)   VALUE +2642.
   958     12  ER-2643                     PIC S9(4)   VALUE +2643.
   959     12  ER-2644                     PIC S9(4)   VALUE +2644.
   960     12  ER-2645                     PIC S9(4)   VALUE +2645.
   961     12  ER-2646                     PIC S9(4)   VALUE +2646.
   962     12  ER-2647                     PIC S9(4)   VALUE +2647.
   963     12  ER-2648                     PIC S9(4)   VALUE +2648.
   964     12  ER-2649                     PIC S9(4)   VALUE +2649.
   965     12  ER-2650                     PIC S9(4)   VALUE +2650.
   966     12  ER-2651                     PIC S9(4)   VALUE +2651.
   967     12  ER-2652                     PIC S9(4)   VALUE +2652.
   968     12  ER-2653                     PIC S9(4)   VALUE +2653.
   969     12  ER-2654                     PIC S9(4)   VALUE +2654.
   970     12  ER-2655                     PIC S9(4)   VALUE +2655.
   971     12  ER-2656                     PIC S9(4)   VALUE +2656.
   972     12  ER-2657                     PIC S9(4)   VALUE +2657.
   973     12  ER-2658                     PIC S9(4)   VALUE +2658.
   974     12  ER-2659                     PIC S9(4)   VALUE +2659.
   975     12  ER-2660                     PIC S9(4)   VALUE +2660.
   976     12  ER-2661                     PIC S9(4)   VALUE +2661.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  19
* EL050.cbl
   977     12  ER-2662                     PIC S9(4)   VALUE +2662.
   978     12  ER-2663                     PIC S9(4)   VALUE +2663.
   979     12  ER-2664                     PIC S9(4)   VALUE +2664.
   980     12  ER-2665                     PIC S9(4)   VALUE +2665.
   981     12  ER-2666                     PIC S9(4)   VALUE +2666.
   982     12  ER-2667                     PIC S9(4)   VALUE +2667.
   983     12  ER-2668                     PIC S9(4)   VALUE +2668.
   984     12  ER-2669                     PIC S9(4)   VALUE +2669.
   985     12  ER-2670                     PIC S9(4)   VALUE +2670.
   986     12  ER-2671                     PIC S9(4)   VALUE +2671.
   987     12  ER-2672                     PIC S9(4)   VALUE +2672.
   988     12  ER-2673                     PIC S9(4)   VALUE +2673.
   989     12  ER-2674                     PIC S9(4)   VALUE +2674.
   990     12  ER-2675                     PIC S9(4)   VALUE +2675.
   991     12  ER-2676                     PIC S9(4)   VALUE +2676.
   992     12  ER-2677                     PIC S9(4)   VALUE +2677.
   993     12  ER-2678                     PIC S9(4)   VALUE +2678.
   994     12  ER-2679                     PIC S9(4)   VALUE +2679.
   995     12  ER-2680                     PIC S9(4)   VALUE +2680.
   996     12  ER-2681                     PIC S9(4)   VALUE +2681.
   997     12  ER-2682                     PIC S9(4)   VALUE +2682.
   998     12  ER-2683                     PIC S9(4)   VALUE +2683.
   999     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1000     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1001     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1002     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1003     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1004     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1005     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1006     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1007     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1008     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1009     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1010     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1011     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1012     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1013     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1014     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1015     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1016     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1017     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1018     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1019     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1020     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1021     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1022     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1023     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1024     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1025     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1026     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1027     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1028     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1029     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1030     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1031     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1032     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1033     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1034     12  ER-2729                     PIC S9(4)   VALUE +2729.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  20
* EL050.cbl
  1035     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1036     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1037     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1038     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1039     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1040     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1041     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1042     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1043     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1044     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1045     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1046     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1047     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1048     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1049     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1050     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1051     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1052     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1053     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1054     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1055     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1056     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1057     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1058     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1059     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1060     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1061     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1062     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1063     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1064     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1065     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1066     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1067     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1068     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1069     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1070     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1071     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1072     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1073     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1074     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1075     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1076     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1077     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1078     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1079     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1080     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1081     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1082     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1083     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1084     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1085     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1086     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1087     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1088     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1089     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1090     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1091     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1092     12  ER-2789                     PIC S9(4)   VALUE +2789.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  21
* EL050.cbl
  1093     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1094     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1095     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1096     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1097     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1098     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1099     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1100     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1101     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1102     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1103     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1104     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1105     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1106     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1107     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1108     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1109     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1110     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1111     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1112     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1113     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1114     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1115     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1116     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1117     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1118     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1119     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1120     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1121     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1122     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1123     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1124     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1125     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1126     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1127     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1128     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1129     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1130     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1131     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1132     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1133     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1134     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1135     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1136     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1137     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1138     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1139     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1140     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1141     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1142     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1143     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1144     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1145     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1146     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1147     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1148     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1149     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1150     12  ER-8041                     PIC S9(4)   VALUE +8041.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  22
* EL050.cbl
  1151     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1152     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1153     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1154     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1155     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1156     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1157     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1158     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1159     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1160     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1161     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1162     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1163     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1164     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1165     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1166     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1167     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1168     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1169     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1170     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1171     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1172     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1173     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1174     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1175     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1176     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1177     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1178     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1179     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1180     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1181     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1182     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1183     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1184     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1185     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1186     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1187     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1188     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1189     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1190     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1191     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1192     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1193     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1194     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1195     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1196     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1197     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1198     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1199     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1200     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1201     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1202     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1203     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1204     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1205     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1206     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1207     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1208     12  ER-8315                     PIC S9(4)   VALUE +8315.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  23
* EL050.cbl
  1209     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1210     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1211     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1212     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1213     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1214     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1215     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1216******************************************************************
  1217***************   END OF ELC50WS     ****************************
  1218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  24
* EL050.cbl
  1221 01  WORKING-STORAGE-WORK-AREAS.
  1222     12  WS-RESPONSE             PIC S9(8)  COMP.
  1223         88  WS-RESP-NORMAL           VALUE +00.
  1224         88  WS-RESP-ERROR            VALUE +01.
  1225         88  WS-RESP-NOTFND           VALUE +13.
  1226         88  WS-RESP-DUPREC           VALUE +14.
  1227         88  WS-RESP-ENDFILE          VALUE +20.
  1228     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1229     12  WORK-AREAS.
  1230         16  WK-CONV-GREG.
  1231             24  WCG-CENT             PIC XX.
  1232             24  WCG-REST             PIC X(4).
  1233         16  WORK-GREGORIAN-DATE.
  1234             24  WK-GREG-CENT         PIC XX.
  1235             24  WK-GREG-DATE-YYMMDD.
  1236                 28  WK-GREG-YYMM     PIC X(4).
  1237                 28  WK-GREG-DD       PIC XX.
  1238
  1239         16  WORK-SELECT-DATE.
  1240             24  WK-SELECT-CENT            PIC XX.
  1241             24  WK-SELECT-DATE-YYMMDD.
  1242                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1243                 28  FILLER                PIC XX.
  1244
  1245         16  WK-FORM-NO.
  1246             24  WK-FORM-BANK-ID       PIC X(5).
  1247             24  WK-FORM-UNDRWRTR      PIC X(1).
  1248             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1249
  1250         16  WK-MEMBER-NO.
  1251             24  WK-MEMBER-1-6        PIC X(6).
  1252             24  WK-MEMBER-7-12       PIC X(6).
  1253
  1254         16  WK-FULL-CERT-NO.
  1255             24  WK-CERT-POS-1-2      PIC X(2).
  1256             24  WK-CERT-POS-3        PIC X(1).
  1257             24  WK-CERT-POS-4        PIC X(1).
  1258             24  WK-CERT-POS-5-6      PIC X(2).
  1259             24  WK-CERT-POS-7        PIC X(1).
  1260             24  WK-CERT-POS-8-11     PIC X(4).
  1261
  1262         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1263             88  VALID-RATE-CODE        VALUE 'Y'.
  1264             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1265
  1266         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1267         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1268         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1269         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1270         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1271         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1272         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1273         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1274         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1275         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1276
  1277* DLO001
  1278 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  25
* EL050.cbl
  1279     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1280     12  DMPF-RETURN-CODE          PIC XX.
  1281         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1282         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1283         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1284         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1285         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1286         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1287
  1288* DLO002
  1289 01  WS-DLO-INTERNAL-POLICY-FORM.
  1290     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1291     12  DIPF-RETURN-CODE          PIC XX.
  1292         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1293         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1294         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1295         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1296         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1297         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1298
  1299* DLO003
  1300 01  WS-DLO-VALID-BANK-ID.
  1301     12  DVBI-BANK-ID              PIC X(5).
  1302     12  DVBI-BANK-ID-TYPE         PIC X.
  1303         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1304         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1305         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1306         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1307         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1308     12  DVBI-RETURN-CODE          PIC XX.
  1309         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1310         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1311         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1312         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1313         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1314         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1315         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1316         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1317         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1318
  1319* DLO007
  1320 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1321     12  DCUA-RES-STATE            PIC XX.
  1322     12  DCUA-BEN-TYPE             PIC XX.
  1323     12  DCUA-SYS-IDENT            PIC X.
  1324         88  DCUA-CLAIM                        VALUE 'C'.
  1325         88  DCUA-PREMIUM                      VALUE 'P'.
  1326     12  DCUA-COVERAGE-RULE        PIC X.
  1327     12  DCUA-CLIENT-ID            PIC X(10).
  1328     12  DCUA-EFF-DATE             PIC X(8).
  1329     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1330     12  DCUA-RETURN-CODE          PIC XX.
  1331         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1332     12  DCUA-CERT-NUMBER          PIC X(11).
  1333     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1334     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1335
  1336* DLO011
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  26
* EL050.cbl
  1337 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1338     12  DPRB-RATE-CODE            PIC X(4).
  1339     12  DPRB-COVERAGE-CATEG       PIC X.
  1340     12  DPRB-RETURN-CODE          PIC XX.
  1341         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1342         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1343         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1344         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1345         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1346         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1347         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1348         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1349         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1350     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1351     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1352     12  DPRB-BEN-TYPE             PIC XX.
  1353
  1354* DLO017
  1355 01  WS-DLO-VALID-RATE-CODE.
  1356     12  DVRC-RATE-CODE            PIC X(4).
  1357     12  DVRC-RETURN-CODE          PIC XX.
  1358         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1360         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1361         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1362         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1363         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1364
  1365* DLO019
  1366 01  WS-DLO-ORIG-COV-CAT.
  1367     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1368     12  DOCC-RETURN-CODE          PIC XX.
  1369     12  DOCC-ORIG-COV-CAT         PIC X.
  1370     12  DOCC-UNDERWITER           PIC XX.
  1371     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1372     12  DOCC-FILLER               PIC X(6).
  1373
  1374* DLO021
  1375 01  WS-DLO-VALID-LOAN-OFFICER.
  1376     12  DVLO-LOAN-OFFICER.
  1377         16  DVLO-BILL-TYPE        PIC X.
  1378         16  DVLO-BILL-SOURCE      PIC X.
  1379         16  DVLO-BATCH-TYPE       PIC X.
  1380     12  DVLO-RETURN-CODE          PIC XX.
  1381         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1383         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1384         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1385         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1386         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1387
  1388* DLO022
  1389 01  WS-DLO-VALID-STATE-CODE.
  1390     12  DVSC-STATE-CODE           PIC XX.
  1391     12  DVSC-RETURN-CODE          PIC XX.
  1392         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1393
  1394* DLO023
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  27
* EL050.cbl
  1395 01  WS-DLO-VALID-CODE-VALUES.
  1396     12  DVCV-SYSTEM-ID            PIC XX.
  1397         88  DVCV-CLAIMS                       VALUE 'CL'.
  1398         88  DVCV-CREDIT                       VALUE 'CR'.
  1399     12  DVCV-RECORD-TYPE          PIC XX.
  1400         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1401         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1402         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1403         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1404         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1405         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1406         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1407         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1408     12  DVCV-RECORD-KEY           PIC X(6).
  1409     12  DVCV-RETURN-CODE          PIC XX.
  1410         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1411         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1412         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1413         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1414         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1415         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1416         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1417     12  DVCV-CODE-DESC            PIC X(60).
  1418     12  DVCV-GEN-DESC-1           PIC X(20).
  1419     12  DVCV-GEN-DESC-2           PIC X(20).
  1420     12  DVCV-GEN-DESC-3           PIC X(20).
  1421
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  28
* EL050.cbl
  1423*    COPY ERCBXRF.
  1424******************************************************************
  1425*                                                                *
  1426*                                                                *
  1427*                            ERCBXRF                             *
  1428*                                                                *
  1429*   ONLINE CREDIT SYSTEM                                         *
  1430*                                                                *
  1431*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1432*                                                                *
  1433*   FILE TYPE = VSAM,KSDS                                        *
  1434*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1435*                                                                *
  1436*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1437*       ALTERNATE PATH = NONE                                    *
  1438*                                                                *
  1439*   LOG = NO                                                     *
  1440*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1441*                                                                *
  1442******************************************************************
  1443
  1444 01  BANK-CROSS-REFERENCE.
  1445     12  BK-RECORD-ID                PIC XX.
  1446         88  VALID-BK-ID             VALUE 'BK'.
  1447
  1448     12  BK-CONTROL-PRIMARY.
  1449         16  BK-COMPANY-CD           PIC X.
  1450         16  BK-CARRIER              PIC X.
  1451         16  BK-GROUPING             PIC X(6).
  1452         16  BK-BANK-NO              PIC X(10).
  1453
  1454     12  BK-MAINT-INFORMATION.
  1455         16  BK-LAST-MAINT-DT        PIC XX.
  1456         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1457         16  BK-LAST-MAINT-USER      PIC X(4).
  1458         16  FILLER                  PIC X(9).
  1459
  1460     12  FILLER                      PIC X(37).
  1461
  1462     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1463
  1464     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1465                            DEPENDING ON BK-BANK-POINTER-CNT.
  1466         16  BK-AM-ACCOUNT           PIC X(10).
  1467         16  BK-AM-EXP-DT            PIC XX.
  1468         16  BK-AM-EFF-DT            PIC XX.
  1469         16  BK-AM-STATE             PIC XX.
  1470         16  FILLER                  PIC X(20).
  1471
  1472******************************************************************
  1473
  1474*    COPY ERCCOMP.
  1475******************************************************************
  1476*                                                                *
  1477*                                                                *
  1478*                            ERCCOMP                             *
  1479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1480*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  29
* EL050.cbl
  1481*                                                                *
  1482*   ONLINE CREDIT SYSTEM                                         *
  1483*                                                                *
  1484*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1485*                                                                *
  1486*   FILE TYPE = VSAM,KSDS                                        *
  1487*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1488*                                                                *
  1489*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1490*       ALTERNATE PATH = NONE                                    *
  1491*                                                                *
  1492*   LOG = NO                                                     *
  1493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1494*                                                                *
  1495******************************************************************
  1496*                   C H A N G E   L O G
  1497*
  1498* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1499*-----------------------------------------------------------------
  1500*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1501* EFFECTIVE    NUMBER
  1502*-----------------------------------------------------------------
  1503* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1504* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1505* 092205    2005050300006  PEMA  ADD LEASE FEE
  1506* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1507* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1508* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1509* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1510* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1511* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1512******************************************************************
  1513
  1514 01  COMPENSATION-MASTER.
  1515     12  CO-RECORD-ID                          PIC XX.
  1516         88  VALID-CO-ID                          VALUE 'CO'.
  1517
  1518     12  CO-CONTROL-PRIMARY.
  1519         16  CO-COMPANY-CD                     PIC X.
  1520         16  CO-CONTROL.
  1521             20  CO-CTL-1.
  1522                 24  CO-CARR-GROUP.
  1523                     28  CO-CARRIER            PIC X.
  1524                     28  CO-GROUPING.
  1525                         32  CO-GROUP-PREFIX   PIC XXX.
  1526                         32  CO-GROUP-PRIME    PIC XXX.
  1527                 24  CO-RESP-NO.
  1528                     28  CO-RESP-PREFIX        PIC X(4).
  1529                     28  CO-RESP-PRIME         PIC X(6).
  1530             20  CO-CTL-2.
  1531                 24  CO-ACCOUNT.
  1532                     28  CO-ACCT-PREFIX        PIC X(4).
  1533                     28  CO-ACCT-PRIME         PIC X(6).
  1534         16  CO-TYPE                           PIC X.
  1535             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1536             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1537             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1538
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  30
* EL050.cbl
  1539     12  CO-MAINT-INFORMATION.
  1540         16  CO-LAST-MAINT-DT                  PIC XX.
  1541         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1542         16  CO-LAST-MAINT-USER                PIC X(4).
  1543     12  FILLER                                PIC XX.
  1544     12  CO-STMT-TYPE                          PIC XXX.
  1545     12  CO-COMP-TYPE                          PIC X.
  1546         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1547     12  CO-STMT-OWNER                         PIC X(4).
  1548     12  CO-BALANCE-CONTROL                    PIC X.
  1549         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1550         88  CO-NO-BALANCE                        VALUE 'N'.
  1551
  1552     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1553         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1554         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1555         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1556
  1557     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1558         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1559         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1560
  1561     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1562     12  CO-GA-DIRECT-DEP                      PIC X.
  1563     12  CO-FUTURE-SPACE                       PIC X.
  1564         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1565
  1566     12  CO-ACCT-NAME                          PIC X(30).
  1567     12  CO-MAIL-NAME                          PIC X(30).
  1568     12  CO-ADDR-1                             PIC X(30).
  1569     12  CO-ADDR-2                             PIC X(30).
  1570     12  CO-ADDR-3.
  1571         16  CO-ADDR-CITY                      PIC X(27).
  1572         16  CO-ADDR-STATE                     PIC XX.
  1573     12  CO-CSO-1099                           PIC X.
  1574     12  CO-ZIP.
  1575         16  CO-ZIP-PRIME.
  1576             20  CO-ZIP-PRI-1ST                PIC X.
  1577                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1578             20  FILLER                        PIC X(4).
  1579         16  CO-ZIP-PLUS4                      PIC X(4).
  1580     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1581         16  CO-CAN-POSTAL-1                   PIC XXX.
  1582         16  CO-CAN-POSTAL-2                   PIC XXX.
  1583         16  FILLER                            PIC XXX.
  1584     12  CO-SOC-SEC                            PIC X(13).
  1585     12  CO-TELEPHONE.
  1586         16  CO-AREA-CODE                      PIC XXX.
  1587         16  CO-PREFIX                         PIC XXX.
  1588         16  CO-PHONE                          PIC X(4).
  1589
  1590     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1591
  1592     12  CO-AR-BAL-LEVEL                       PIC X.
  1593         88  CO-AR-REF-LVL                        VALUE '1'.
  1594         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1595         88  CO-AR-BILL-LVL                       VALUE '2'.
  1596         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  31
* EL050.cbl
  1597         88  CO-AR-FR-LVL                         VALUE '4'.
  1598
  1599     12  CO-AR-NORMAL-PRINT                    PIC X.
  1600         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1601         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1602
  1603     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1604
  1605     12  CO-AR-REPORTING                       PIC X.
  1606         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1607         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1608
  1609     12  CO-AR-PULL-CHECK                      PIC X.
  1610         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1611         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1612
  1613     12  CO-AR-BALANCE-PRINT                   PIC X.
  1614         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1615
  1616     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1617         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1618         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1619         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1620
  1621     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1622
  1623     12  CO-USER-CODE                          PIC X.
  1624     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1625
  1626******************************************************************
  1627*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1628*    THE LAST MONTH END RUN.
  1629******************************************************************
  1630
  1631     12  CO-LAST-ACTIVITY-DATE.
  1632         16  CO-ACT-YEAR                       PIC 99.
  1633         16  CO-ACT-MONTH                      PIC 99.
  1634         16  CO-ACT-DAY                        PIC 99.
  1635
  1636     12  CO-LAST-STMT-DT.
  1637         16  CO-LAST-STMT-YEAR                 PIC 99.
  1638         16  CO-LAST-STMT-MONTH                PIC 99.
  1639         16  CO-LAST-STMT-DAY                  PIC 99.
  1640
  1641     12  CO-MO-END-TOTALS.
  1642         16  CO-MONTHLY-TOTALS.
  1643             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1644             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1645             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1646             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1647             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1648
  1649         16  CO-AGING-TOTALS.
  1650             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1651             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1652             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1653             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1654
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  32
* EL050.cbl
  1655         16  CO-YTD-TOTALS.
  1656             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1657             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1658
  1659         16  CO-OVER-UNDER-TOTALS.
  1660             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1661             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1662
  1663     12  CO-MISCELLANEOUS-TOTALS.
  1664         16  CO-FICA-TOTALS.
  1665             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1666             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1667
  1668         16  CO-CLAIM-TOTALS.
  1669             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1670             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1671
  1672******************************************************************
  1673*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1674*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1675******************************************************************
  1676
  1677     12  CO-CURRENT-TOTALS.
  1678         16  CO-CURRENT-LAST-STMT-DT.
  1679             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1680             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1681             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1682
  1683         16  CO-CURRENT-MONTHLY-TOTALS.
  1684             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1685             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1686             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1687             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1689
  1690         16  CO-CURRENT-AGING-TOTALS.
  1691             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1692             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1693             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1694             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1695
  1696         16  CO-CURRENT-YTD-TOTALS.
  1697             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1698             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1699
  1700     12  CO-PAID-COMM-TOTALS.
  1701         16  CO-YTD-PAID-COMMS.
  1702             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1703             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1704
  1705     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1706         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1707         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1708
  1709     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1710         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1711         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1712         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  33
* EL050.cbl
  1713         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1714         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1715         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1716         88  CO-FINAL-LETTER                  VALUE 'F'.
  1717         88  CO-RECONCILING                   VALUE 'R'.
  1718         88  CO-PHONE-CALL                    VALUE 'P'.
  1719         88  CO-LEGAL                         VALUE 'L'.
  1720         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1721         88  CO-WRITE-OFF                     VALUE 'W'.
  1722         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1723
  1724     12  CO-CSR-CODE                       PIC X(4).
  1725
  1726     12  CO-GA-STATUS-INFO.
  1727         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1728         16  CO-GA-TERMINATION-DT          PIC XX.
  1729         16  CO-GA-STATUS-CODE             PIC X.
  1730             88  CO-GA-ACTIVE                 VALUE 'A'.
  1731             88  CO-GA-INACTIVE               VALUE 'I'.
  1732             88  CO-GA-PENDING                VALUE 'P'.
  1733         16  CO-GA-COMMENTS.
  1734             20  CO-GA-COMMENT-1           PIC X(40).
  1735             20  CO-GA-COMMENT-2           PIC X(40).
  1736             20  CO-GA-COMMENT-3           PIC X(40).
  1737             20  CO-GA-COMMENT-4           PIC X(40).
  1738
  1739     12  CO-RPTCD2                         PIC X(10).
  1740     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1741         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1742         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1743
  1744     12  CO-TYPE-AGENT                     PIC X(01).
  1745         88  CO-CORPORATION                   VALUE 'C'.
  1746         88  CO-PARTNERSHIP                   VALUE 'P'.
  1747         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1748         88  CO-TRUST                         VALUE 'T'.
  1749         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1750
  1751     12  CO-FAXNO.
  1752         16  CO-FAX-AREA-CODE                  PIC XXX.
  1753         16  CO-FAX-PREFIX                     PIC XXX.
  1754         16  CO-FAX-PHONE                      PIC X(4).
  1755
  1756     12  CO-BANK-INFORMATION.
  1757         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1758         16  CO-BANK-TRANSIT-NON REDEFINES
  1759             CO-BANK-TRANSIT-NO                PIC 9(8).
  1760
  1761         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1762     12  CO-MISC-DEDUCT-INFO REDEFINES
  1763                  CO-BANK-INFORMATION.
  1764         16  CO-MD-GL-ACCT                     PIC X(10).
  1765         16  CO-MD-DIV                         PIC XX.
  1766         16  CO-MD-CENTER                      PIC X(4).
  1767         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1768         16  CO-CREATE-AP-CHECK                PIC X.
  1769         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1770         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  34
* EL050.cbl
  1771     12  CO-ACH-STATUS                         PIC X.
  1772         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1773         88  CO-ACH-PENDING                        VALUE 'P'.
  1774
  1775     12  CO-BILL-SW                            PIC X.
  1776     12  CO-CONTROL-NAME                       PIC X(30).
  1777     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1778     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1779     12  CO-CLP-STATE                          PIC XX.
  1780     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1781     12  CO-SPP-REFUND-EDIT                    PIC X.
  1782
  1783******************************************************************
  1784
  1785*    COPY ERCAGTC.
  1786******************************************************************
  1787*                                                                *
  1788*                                                                *
  1789*                            ERCAGTC                             *
  1790*                            VMOD=2.001                          *
  1791*                                                                *
  1792*   ONLINE CREDIT SYSTEM                                         *
  1793*                                                                *
  1794*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1795*                                                                *
  1796*   FILE TYPE = VSAM,KSDS                                        *
  1797*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1798*                                                                *
  1799*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1800*       ALTERNATE PATH = NONE                                    *
  1801*                                                                *
  1802*   LOG = NO                                                     *
  1803*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1804*                                                                *
  1805******************************************************************
  1806*                   C H A N G E   L O G
  1807*
  1808* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1809*-----------------------------------------------------------------
  1810*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1811* EFFECTIVE    NUMBER
  1812*-----------------------------------------------------------------
  1813* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1814* 111004                         NEW FILE AND COPYBOOK
  1815* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1816******************************************************************
  1817 01  AGENT-COMMISSIONS.
  1818     12  AG-RECORD-ID                          PIC XX.
  1819         88  VALID-CO-ID                          VALUE 'AG'.
  1820     12  AG-CONTROL-PRIMARY.
  1821         16  AG-COMPANY-CD                     PIC X.
  1822         16  AG-CONTROL.
  1823             20  AG-CTL-1.
  1824                 24  AG-CARR-GROUP.
  1825                     28  AG-CARRIER            PIC X.
  1826                     28  AG-GROUPING           PIC X(6).
  1827                 24  AG-BANK                   PIC X(10).
  1828             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  35
* EL050.cbl
  1829                 24  AG-EXP-DT                 PIC XX.
  1830         16  AG-TYPE                           PIC X.
  1831             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1832             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1833     12  AG-MAINT-INFORMATION.
  1834         16  AG-LAST-MAINT-DT                  PIC XX.
  1835         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1836         16  AG-LAST-MAINT-USER                PIC X(4).
  1837         16  FILLER                            PIC X(10).
  1838     12  AG-EFF-DT                             PIC XX.
  1839     12  AG-COMM-STRUCTURE.
  1840         16  AG-AGT-COMMS OCCURS 10.
  1841             20  AG-AGT                PIC X(10).
  1842             20  AG-COM-TYP            PIC X.
  1843             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1844             20  AG-RECALC-LV-INDIC    PIC X.
  1845             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1846             20  AG-LRCALC-LV-INDIC    PIC X.
  1847             20  FILLER                PIC X(05).
  1848     12  FILLER                  PIC X(145).
  1849******************************************************************
  1850*    COPY ERCRESS.
  1851******************************************************************
  1852*                                                                *
  1853*                            ERCRESS                             *
  1854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1855*                            VMOD=2.002                          *
  1856*                                                                *
  1857*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1858*                                                                *
  1859*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1860*   VSAM RESIDENT STATE TAX MASTER                              *
  1861*                                                                *
  1862*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1863*                                                                *
  1864*   FILE TYPE = VSAM,KSDS                                        *
  1865*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1866*                                                                *
  1867*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1868*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1869*                                                                *
  1870*   LOG = NO                                                     *
  1871*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1872*                                                                *
  1873*                                                                *
  1874******************************************************************
  1875
  1876 01  RESIDENT-STATE-TAX-MASTER.
  1877
  1878     10  ERRESS-PRIMARY-KEY.
  1879         15  RES-COMPANY-CD        PIC X.
  1880         15  RES-RESIDENT-STATE    PIC XX.
  1881         15  RES-COVERAGE-CATEGORY PIC X.
  1882         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1883*                                      YYYYMMDD
  1884*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1885
  1886     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  36
* EL050.cbl
  1887
  1888         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1889         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1890         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1891         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1892
  1893     10 RES-RECALC-SW              PIC   X.
  1894         88 RECALC                VALUE 'Y'.
  1895         88 NO-RECALC             VALUE 'N'.
  1896     10  RES-MAINT-BY              PIC X(4).
  1897     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1898     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1899*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  37
* EL050.cbl
  1901*    COPY ERCRESC.
  1902******************************************************************
  1903*                                                                *
  1904*                            ERCRESC                             *
  1905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1906*                            VMOD=2.003                          *
  1907*                                                                *
  1908*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1909*                                                                *
  1910*   FILE TYPE = VSAM,KSDS                                        *
  1911*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1912*                                                                *
  1913*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1914*       ALTERNATE PATH1 = NONE                                   *
  1915*                                                                *
  1916*   LOG = NO                                                     *
  1917*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1918*                                                                *
  1919******************************************************************
  1920
  1921 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1922
  1923     10  ERRESC-RECORD-KEY.
  1924         15  RESC-COMPANY-CD           PIC   X.
  1925         15  RESC-CARRIER              PIC   X.
  1926         15  RESC-GROUP                PIC   X(6).
  1927         15  RESC-STATE                PIC   XX.
  1928         15  RESC-ACCOUNT              PIC   X(10).
  1929         15  RESC-AGENT                PIC   X(10).
  1930         15  RESC-RESIDENT-STATE       PIC   XX.
  1931         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1932*                                           YYYYMMDD
  1933     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1934
  1935     10  RESC-COMM-RECORD-DATA.
  1936         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1937             20 RESC-COVERAGE-CAT      PIC    X.
  1938             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1939             20 RESC-COMMISSION-TAB REDEFINES
  1940                RESC-COMMISSION-PER    PIC  XXX.
  1941
  1942     10  RESC-MAINT-BY                 PIC X(4).
  1943     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1944     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1945*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  38
* EL050.cbl
  1947*    COPY ERCPLAN.
  1948******************************************************************
  1949*                                                                *
  1950*                                                                *
  1951*                            ERCPLAN                             *
  1952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1953*                            VMOD=2.003                          *
  1954*                                                                *
  1955*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1956*                                                                *
  1957*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1958*   PLAN MASTER                                                  *
  1959*                                                                *
  1960*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 420   RECFORM = FIX                            *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1966*       ALTERNATE PATH1 = N/A                                    *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971*                                                                *
  1972******************************************************************
  1973
  1974 01  PLAN-MASTER.
  1975     12  PL-RECORD-ID                      PIC XX.
  1976         88  VALID-PL-ID                      VALUE 'PL'.
  1977
  1978     12  PL-CONTROL-PRIMARY.
  1979         16  PL-COMPANY-CD                 PIC X.
  1980         16  PL-MSTR-CNTRL.
  1981             20  PL-CONTROL-A.
  1982                 24  PL-CARRIER            PIC X.
  1983                 24  PL-GROUPING           PIC X(6).
  1984                 24  PL-STATE              PIC XX.
  1985                 24  PL-ACCOUNT            PIC X(10).
  1986             20  PL-BENEFIT-TYPE           PIC X.
  1987             20  PL-BENEFIT-CODE           PIC XX.
  1988             20  PL-REVISION-NO            PIC X(3).
  1989
  1990     12  PL-CONTROL-BY-VAR-GRP.
  1991         16  PL-COMPANY-CD-A1              PIC X.
  1992         16  PL-VG-CARRIER                 PIC X.
  1993         16  PL-VG-GROUPING                PIC X(6).
  1994         16  PL-VG-STATE                   PIC XX.
  1995         16  PL-VG-ACCOUNT                 PIC X(10).
  1996         16  PL-BENEFIT-TYPE-A1            PIC X.
  1997         16  PL-BENEFIT-CODE-A1            PIC XX.
  1998         16  PL-REVISION-NO-A1             PIC 999.
  1999
  2000     12  PL-MAINT-INFORMATION.
  2001         16  PL-LAST-MAINT-DT              PIC XX.
  2002         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2003         16  PL-LAST-MAINT-USER            PIC X(4).
  2004         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  39
* EL050.cbl
  2005
  2006     12  PL-LIABILITY-LIMITS.
  2007         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2008         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2009             20  PL-LM-AGE                 PIC S99        COMP-3.
  2010             20  PL-LM-DUR                 PIC S999       COMP-3.
  2011             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2012             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2013
  2014     12  FILLER                            PIC X(30).
  2015
  2016     12  PL-GL-ACCOUNT-NOS.
  2017         16  PL-PREMIUM-GL                 PIC X(8).
  2018         16  PL-COMM-GL                    PIC X(8).
  2019         16  PL-CLAIM-GL                   PIC X(8).
  2020     12  FILLER                            PIC X(24).
  2021     12  PL-TOLERANCES.
  2022         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2023         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2024         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2025         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2026         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2027         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2028     12  PL-OVER-SHORT.
  2029         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2030         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2031     12  FILLER                            PIC X(24).
  2032     12  PLAN-MISC.
  2033         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2034         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2035         16  PL-IG                         PIC X.
  2036         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2037         16  PL-POLICY-FORM                PIC X(12).
  2038         16  PL-EDIT-FOR-FORM              PIC X(01).
  2039         16  PL-DEV-CODE                   PIC XXX.
  2040         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2041         16  PL-CALC-METHOD                PIC X.
  2042         16  PL-BENEFIT-GROUP              PIC X(05).
  2043         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2044
  2045         16  FILLER                        PIC X(99).
  2046******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  40
* EL050.cbl
  2048*    COPY ELCCERT.
  2049******************************************************************
  2050*                                                                *
  2051*                            ELCCERT.                            *
  2052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2053*                            VMOD=2.013                          *
  2054*                                                                *
  2055*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2056*                                                                *
  2057*   FILE TYPE = VSAM,KSDS                                        *
  2058*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2059*                                                                *
  2060*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2061*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2062*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2063*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2064*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2065*                                                                *
  2066*   LOG = YES                                                    *
  2067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2068******************************************************************
  2069*                   C H A N G E   L O G
  2070*
  2071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2072*-----------------------------------------------------------------
  2073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2074* EFFECTIVE    NUMBER
  2075*-----------------------------------------------------------------
  2076* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2077* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2078* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2079* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2080* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2081* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2082* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2083* 032612  CR2011110200001  PEMA  AHL CHANGES
  2084******************************************************************
  2085
  2086 01  CERTIFICATE-MASTER.
  2087     12  CM-RECORD-ID                      PIC XX.
  2088         88  VALID-CM-ID                      VALUE 'CM'.
  2089
  2090     12  CM-CONTROL-PRIMARY.
  2091         16  CM-COMPANY-CD                 PIC X.
  2092         16  CM-CARRIER                    PIC X.
  2093         16  CM-GROUPING.
  2094             20  CM-GROUPING-PREFIX        PIC X(3).
  2095             20  CM-GROUPING-PRIME         PIC X(3).
  2096         16  CM-STATE                      PIC XX.
  2097         16  CM-ACCOUNT.
  2098             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2099             20  CM-ACCOUNT-PRIME          PIC X(6).
  2100         16  CM-CERT-EFF-DT                PIC XX.
  2101         16  CM-CERT-NO.
  2102             20  CM-CERT-PRIME             PIC X(10).
  2103             20  CM-CERT-SFX               PIC X.
  2104
  2105     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  41
* EL050.cbl
  2106         16  CM-COMPANY-CD-A1              PIC X.
  2107         16  CM-INSURED-LAST-NAME          PIC X(15).
  2108         16  CM-INSURED-INITIALS.
  2109             20  CM-INSURED-INITIAL1       PIC X.
  2110             20  CM-INSURED-INITIAL2       PIC X.
  2111
  2112     12  CM-CONTROL-BY-SSN.
  2113         16  CM-COMPANY-CD-A2              PIC X.
  2114         16  CM-SOC-SEC-NO.
  2115             20  CM-SSN-STATE              PIC XX.
  2116             20  CM-SSN-ACCOUNT            PIC X(6).
  2117             20  CM-SSN-LN3.
  2118                 25  CM-INSURED-INITIALS-A2.
  2119                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2120                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2121                 25 CM-PART-LAST-NAME-A2         PIC X.
  2122
  2123     12  CM-CONTROL-BY-CERT-NO.
  2124         16  CM-COMPANY-CD-A4              PIC X.
  2125         16  CM-CERT-NO-A4                 PIC X(11).
  2126
  2127     12  CM-CONTROL-BY-MEMB.
  2128         16  CM-COMPANY-CD-A5              PIC X.
  2129         16  CM-MEMBER-NO.
  2130             20  CM-MEMB-STATE             PIC XX.
  2131             20  CM-MEMB-ACCOUNT           PIC X(6).
  2132             20  CM-MEMB-LN4.
  2133                 25  CM-INSURED-INITIALS-A5.
  2134                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2135                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2136                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2137
  2138     12  CM-INSURED-PROFILE-DATA.
  2139         16  CM-INSURED-FIRST-NAME.
  2140             20  CM-INSURED-1ST-INIT       PIC X.
  2141             20  FILLER                    PIC X(9).
  2142         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2143         16  CM-INSURED-SEX                PIC X.
  2144             88  CM-SEX-MALE                  VALUE 'M'.
  2145             88  CM-SEX-FEMAL                 VALUE 'F'.
  2146         16  CM-INSURED-JOINT-AGE          PIC 99.
  2147         16  CM-JOINT-INSURED-NAME.
  2148             20  CM-JT-LAST-NAME           PIC X(15).
  2149             20  CM-JT-FIRST-NAME.
  2150                 24  CM-JT-1ST-INIT        PIC X.
  2151                 24  FILLER                PIC X(9).
  2152             20  CM-JT-INITIAL             PIC X.
  2153
  2154     12  CM-LIFE-DATA.
  2155         16  CM-LF-BENEFIT-CD              PIC XX.
  2156         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2157         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2158         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2159         16  CM-LF-DEV-CODE                PIC XXX.
  2160         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2161         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2162         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2163         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  42
* EL050.cbl
  2164         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2165         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2167         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2169         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2170         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2171         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2172         16  FILLER                        PIC XX.
  2173
  2174     12  CM-AH-DATA.
  2175         16  CM-AH-BENEFIT-CD              PIC XX.
  2176         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2177         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2178         16  CM-AH-DEV-CODE                PIC XXX.
  2179         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2180         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2181         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2182         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2183         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2186         16  CM-AH-PAID-THRU-DT            PIC XX.
  2187             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2188         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2189         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2190         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2191         16  FILLER                        PIC X.
  2192
  2193     12  CM-LOAN-INFORMATION.
  2194         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2195         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2196                                           PIC S9(5)V99  COMP-3.
  2197         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2198         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2199         16  CM-PAY-FREQUENCY              PIC S99.
  2200         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2201         16  CM-RATE-CLASS                 PIC XX.
  2202         16  CM-BENEFICIARY                PIC X(25).
  2203         16  CM-POLICY-FORM-NO             PIC X(12).
  2204         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2205         16  CM-LAST-ADD-ON-DT             PIC XX.
  2206         16  CM-DEDUCTIBLE-AMOUNTS.
  2207             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2208             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2209         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-RESIDENT-STATE         PIC XX.
  2211             20  CM-RATE-CODE              PIC X(4).
  2212             20  FILLER                    PIC XX.
  2213         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2214             20  CM-LOAN-OFFICER           PIC X(5).
  2215             20  FILLER                    PIC XXX.
  2216         16  CM-CSR-CODE                   PIC XXX.
  2217         16  CM-UNDERWRITING-CODE          PIC X.
  2218             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2219         16  CM-POST-CARD-IND              PIC X.
  2220         16  CM-NH-INTERFACE-SW            PIC X.
  2221         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  43
* EL050.cbl
  2222             88  CM-SING-PRM                  VALUE '1'.
  2223             88  CM-O-B-COVERAGE              VALUE '2'.
  2224             88  CM-OPEN-END                  VALUE '3'.
  2225         16  CM-IND-GRP-TYPE               PIC X.
  2226             88  CM-INDIVIDUAL                VALUE 'I'.
  2227             88  CM-GROUP                     VALUE 'G'.
  2228         16  CM-SKIP-CODE                  PIC X.
  2229             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2230             88  SKIP-JULY                    VALUE '1'.
  2231             88  SKIP-AUGUST                  VALUE '2'.
  2232             88  SKIP-SEPTEMBER               VALUE '3'.
  2233             88  SKIP-JULY-AUG                VALUE '4'.
  2234             88  SKIP-AUG-SEPT                VALUE '5'.
  2235             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2236             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2237             88  SKIP-JUNE                    VALUE '8'.
  2238             88  SKIP-JUNE-JULY               VALUE '9'.
  2239             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2240             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2241         16  CM-PAYMENT-MODE               PIC X.
  2242             88  PAY-MONTHLY                  VALUE SPACE.
  2243             88  PAY-WEEKLY                   VALUE '1'.
  2244             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2245             88  PAY-BI-WEEKLY                VALUE '3'.
  2246             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2247         16  CM-LOAN-NUMBER                PIC X(8).
  2248         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2249         16  CM-OLD-LOF                    PIC XXX.
  2250*        16  CM-LOAN-OFFICER               PIC XXX.
  2251         16  CM-REIN-TABLE                 PIC XXX.
  2252         16  CM-SPECIAL-REIN-CODE          PIC X.
  2253         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2254         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2255         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2256
  2257     12  CM-STATUS-DATA.
  2258         16  CM-ENTRY-STATUS               PIC X.
  2259         16  CM-ENTRY-DT                   PIC XX.
  2260
  2261         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2262         16  CM-LF-CANCEL-DT               PIC XX.
  2263         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2264
  2265         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2266         16  CM-LF-DEATH-DT                PIC XX.
  2267         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2268
  2269         16  CM-LF-CURRENT-STATUS          PIC X.
  2270             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2271                                                'M' '4' '5' '9'.
  2272             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2273             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2274             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2275             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2276             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2277             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2278             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2279             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  44
* EL050.cbl
  2280             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2281             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2282             88  CM-LF-DECLINED               VALUE 'D'.
  2283             88  CM-LF-VOIDED                 VALUE 'V'.
  2284
  2285         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2286         16  CM-AH-CANCEL-DT               PIC XX.
  2287         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2288
  2289         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2290         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2291         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2292
  2293         16  CM-AH-CURRENT-STATUS          PIC X.
  2294             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2295                                                'M' '4' '5' '9'.
  2296             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2297             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2298             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2299             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2300             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2301             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2302             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2303             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2304             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2305             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2306             88  CM-AH-DECLINED               VALUE 'D'.
  2307             88  CM-AH-VOIDED                 VALUE 'V'.
  2308
  2309         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2310             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2311             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2312             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2313         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2314
  2315         16  CM-ENTRY-BATCH                PIC X(6).
  2316         16  CM-LF-EXIT-BATCH              PIC X(6).
  2317         16  CM-AH-EXIT-BATCH              PIC X(6).
  2318         16  CM-LAST-MONTH-END             PIC XX.
  2319
  2320     12  CM-NOTE-SW                        PIC X.
  2321         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2322         88  CERT-NOTES-PRESENT               VALUE '1'.
  2323         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2324         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2325         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2326         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2327         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2328         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2329     12  CM-COMP-EXCP-SW                   PIC X.
  2330         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2331         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2332     12  CM-INSURED-ADDRESS-SW             PIC X.
  2333         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2334         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2335
  2336*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2337     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  45
* EL050.cbl
  2338     12  FILLER                            PIC X.
  2339
  2340*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2341     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2342     12  FILLER                            PIC X.
  2343*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2345
  2346     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2347         88  CERT-ADDED-BATCH                 VALUE ' '.
  2348         88  CERT-ADDED-ONLINE                VALUE '1'.
  2349         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2350         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2351         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2352     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2353         88  CERT-AS-LOADED                   VALUE ' '.
  2354         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2355         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2356         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2357         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2358         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2359         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2360         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2361
  2362     12  CM-ACCOUNT-COMM-PCTS.
  2363         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2364         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2365
  2366     12  CM-USER-FIELD                     PIC X.
  2367     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2368     12  CM-CLP-STATE                      PIC XX.
  2369     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2370     12  CM-USER-RESERVED                  PIC XXX.
  2371     12  FILLER REDEFINES CM-USER-RESERVED.
  2372         16  CM-AH-CLASS-CD                PIC XX.
  2373         16  F                             PIC X.
  2374******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  46
* EL050.cbl
  2376*    COPY ERCMAIL.
  2377******************************************************************
  2378*                                                                *
  2379*                                                                *
  2380*                            ERCMAIL                             *
  2381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2382*                            VMOD=2.003                          *
  2383*                                                                *
  2384*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2385*                                                                *
  2386*   FILE TYPE = VSAM,KSDS                                        *
  2387*   RECORD SIZE = 374   RECFORM = FIX                            *
  2388*                                                                *
  2389*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2390*   ALTERNATE PATH    = NOT USED                                 *
  2391*                                                                *
  2392*   LOG = YES                                                    *
  2393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2394******************************************************************
  2395*                   C H A N G E   L O G
  2396*
  2397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2398*-----------------------------------------------------------------
  2399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2400* EFFECTIVE    NUMBER
  2401*-----------------------------------------------------------------
  2402* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2403* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2404* 111108                   PEMA  ADD CRED BENE ADDR2
  2405******************************************************************
  2406
  2407 01  MAILING-DATA.
  2408     12  MA-RECORD-ID                      PIC XX.
  2409         88  VALID-MA-ID                       VALUE 'MA'.
  2410
  2411     12  MA-CONTROL-PRIMARY.
  2412         16  MA-COMPANY-CD                 PIC X.
  2413         16  MA-CARRIER                    PIC X.
  2414         16  MA-GROUPING.
  2415             20  MA-GROUPING-PREFIX        PIC XXX.
  2416             20  MA-GROUPING-PRIME         PIC XXX.
  2417         16  MA-STATE                      PIC XX.
  2418         16  MA-ACCOUNT.
  2419             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2420             20  MA-ACCOUNT-PRIME          PIC X(6).
  2421         16  MA-CERT-EFF-DT                PIC XX.
  2422         16  MA-CERT-NO.
  2423             20  MA-CERT-PRIME             PIC X(10).
  2424             20  MA-CERT-SFX               PIC X.
  2425
  2426     12  FILLER                            PIC XX.
  2427
  2428     12  MA-ACCESS-CONTROL.
  2429         16  MA-SOURCE-SYSTEM              PIC XX.
  2430             88  MA-FROM-CREDIT                VALUE 'CR'.
  2431             88  MA-FROM-VSI                   VALUE 'VS'.
  2432             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2433             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  47
* EL050.cbl
  2434         16  MA-RECORD-ADD-DT              PIC XX.
  2435         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2436         16  MA-LAST-MAINT-DT              PIC XX.
  2437         16  MA-LAST-MAINT-BY              PIC XXXX.
  2438         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2439
  2440     12  MA-PROFILE-INFO.
  2441         16  MA-QUALIFY-CODE-1             PIC XX.
  2442         16  MA-QUALIFY-CODE-2             PIC XX.
  2443         16  MA-QUALIFY-CODE-3             PIC XX.
  2444         16  MA-QUALIFY-CODE-4             PIC XX.
  2445         16  MA-QUALIFY-CODE-5             PIC XX.
  2446
  2447         16  MA-INSURED-LAST-NAME          PIC X(15).
  2448         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2449         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2450         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2451         16  MA-INSURED-BIRTH-DT           PIC XX.
  2452         16  MA-INSURED-SEX                PIC X.
  2453             88  MA-SEX-MALE                   VALUE 'M'.
  2454             88  MA-SEX-FEMALE                 VALUE 'F'.
  2455         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2456
  2457         16  MA-ADDRESS-CORRECTED          PIC X.
  2458         16  MA-JOINT-BIRTH-DT             PIC XX.
  2459*        16  FILLER                        PIC X(12).
  2460
  2461         16  MA-ADDRESS-LINE-1             PIC X(30).
  2462         16  MA-ADDRESS-LINE-2             PIC X(30).
  2463         16  MA-CITY-STATE.
  2464             20  MA-CITY                   PIC X(28).
  2465             20  MA-ADDR-STATE             PIC XX.
  2466         16  MA-ZIP.
  2467             20  MA-ZIP-CODE.
  2468                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2469                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2470                 24  FILLER                PIC X(4).
  2471             20  MA-ZIP-PLUS4              PIC X(4).
  2472         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2473             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2474             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2475             20  FILLER                    PIC X(3).
  2476
  2477         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2478
  2479         16  FILLER                        PIC XXX.
  2480*        16  FILLER                        PIC X(10).
  2481
  2482     12  MA-CRED-BENE-INFO.
  2483         16  MA-CRED-BENE-NAME                 PIC X(25).
  2484         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2485         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2486         16  MA-CRED-BENE-CTYST.
  2487             20  MA-CRED-BENE-CITY             PIC X(28).
  2488             20  MA-CRED-BENE-STATE            PIC XX.
  2489         16  MA-CRED-BENE-ZIP.
  2490             20  MA-CB-ZIP-CODE.
  2491                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  48
* EL050.cbl
  2492                     88  MA-CB-CANADIAN-POST-CODE
  2493                                           VALUE 'A' THRU 'Z'.
  2494                 24  FILLER                    PIC X(4).
  2495             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2496         16  MA-CB-CANADIAN-POSTAL-CODE
  2497                            REDEFINES MA-CRED-BENE-ZIP.
  2498             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2499             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2500             20  FILLER                        PIC X(3).
  2501     12  MA-POST-CARD-MAIL-DATA.
  2502         16  MA-MAIL-DATA OCCURS 7.
  2503             20  MA-MAIL-TYPE              PIC X.
  2504                 88  MA-12MO-MAILING           VALUE '1'.
  2505                 88  MA-EXP-MAILING            VALUE '2'.
  2506             20  MA-MAIL-STATUS            PIC X.
  2507                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2508                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2509                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2510             20  MA-MAIL-DATE              PIC XX.
  2511     12  FILLER                            PIC XX.
  2512     12  FILLER                            PIC XX.
  2513*    12  FILLER                            PIC X(30).
  2514******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  49
* EL050.cbl
  2516*    COPY ERCPNDM.
  2517******************************************************************
  2518*                                                                *
  2519*                                                                *
  2520*                            ERCPNDM                             *
  2521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2522*                            VMOD=2.003                          *
  2523*                                                                *
  2524*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2525*                                                                *
  2526*   FILE TYPE = VSAM,KSDS                                        *
  2527*   RECORD SIZE = 374   RECFORM = FIX                            *
  2528*                                                                *
  2529*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2530*   ALTERNATE PATH    = NOT USED                                 *
  2531*                                                                *
  2532*   LOG = YES                                                    *
  2533*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2534******************************************************************
  2535*                   C H A N G E   L O G
  2536*
  2537* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2538*-----------------------------------------------------------------
  2539*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2540* EFFECTIVE    NUMBER
  2541*-----------------------------------------------------------------
  2542* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2543* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2544* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2545******************************************************************
  2546
  2547 01  PENDING-MAILING-DATA.
  2548     12  PM-RECORD-ID                      PIC XX.
  2549         88  VALID-MA-ID                       VALUE 'PM'.
  2550
  2551     12  PM-CONTROL-PRIMARY.
  2552         16  PM-COMPANY-CD                 PIC X.
  2553         16  PM-ENTRY-BATCH                PIC X(6).
  2554         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2555         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2556
  2557     12  FILLER                            PIC X(14).
  2558
  2559     12  PM-ACCESS-CONTROL.
  2560         16  PM-SOURCE-SYSTEM              PIC XX.
  2561             88  PM-FROM-CREDIT                VALUE 'CR'.
  2562             88  PM-FROM-VSI                   VALUE 'VS'.
  2563             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2564             88  PM-FROM-OTHER                 VALUE 'OT'.
  2565         16  PM-RECORD-ADD-DT              PIC XX.
  2566         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2567         16  PM-LAST-MAINT-DT              PIC XX.
  2568         16  PM-LAST-MAINT-BY              PIC XXXX.
  2569         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2570
  2571     12  PM-PROFILE-INFO.
  2572         16  PM-QUALIFY-CODE-1             PIC XX.
  2573         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  50
* EL050.cbl
  2574         16  PM-QUALIFY-CODE-3             PIC XX.
  2575         16  PM-QUALIFY-CODE-4             PIC XX.
  2576         16  PM-QUALIFY-CODE-5             PIC XX.
  2577
  2578         16  PM-INSURED-LAST-NAME          PIC X(15).
  2579         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2580         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2581         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2582         16  PM-INSURED-BIRTH-DT           PIC XX.
  2583         16  PM-INSURED-SEX                PIC X.
  2584             88  PM-SEX-MALE                   VALUE 'M'.
  2585             88  PM-SEX-FEMALE                 VALUE 'F'.
  2586         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2587
  2588         16  PM-ADDRESS-CORRECTED          PIC X.
  2589         16  PM-JOINT-BIRTH-DT             PIC XX.
  2590*        16  FILLER                        PIC X(12).
  2591
  2592         16  PM-ADDRESS-LINE-1             PIC X(30).
  2593         16  PM-ADDRESS-LINE-2             PIC X(30).
  2594         16  PM-CITY-STATE.
  2595             20  PM-CITY                   PIC X(28).
  2596             20  PM-STATE                  PIC XX.
  2597         16  PM-ZIP.
  2598             20  PM-ZIP-CODE.
  2599                 24  PM-ZIP-1              PIC X.
  2600                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2601                 24  FILLER                PIC X(4).
  2602             20  PM-ZIP-PLUS4              PIC X(4).
  2603         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2604             20  PM-CAN-POST1              PIC XXX.
  2605             20  PM-CAN-POST2              PIC XXX.
  2606             20  FILLER                    PIC XXX.
  2607
  2608         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2609
  2610         16  FILLER                        PIC X(03).
  2611
  2612     12  PM-CRED-BENE-INFO.
  2613         16  PM-CRED-BENE-NAME             PIC X(25).
  2614         16  PM-CRED-BENE-ADDR             PIC X(30).
  2615         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2616         16  PM-CRED-BENE-CTYST.
  2617             20  PM-CRED-BENE-CITY         PIC X(28).
  2618             20  PM-CRED-BENE-STATE        PIC XX.
  2619         16  PM-CRED-BENE-ZIP.
  2620             20  PM-CB-ZIP-CODE.
  2621                 24  PM-CB-ZIP-1           PIC X.
  2622                     88  PM-CB-CANADIAN-POST-CODE
  2623                                  VALUE 'A' THRU 'Z'.
  2624                 24  FILLER                PIC X(4).
  2625             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2626         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2627             20  PM-CB-CAN-POST1           PIC XXX.
  2628             20  PM-CB-CAN-POST2           PIC XXX.
  2629             20  FILLER                    PIC XXX.
  2630     12  PM-POST-CARD-MAIL-DATA.
  2631         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  51
* EL050.cbl
  2632             20  PM-MAIL-TYPE              PIC X.
  2633                 88  PM-12MO-MAILING           VALUE '1'.
  2634                 88  PM-EXP-MAILING            VALUE '2'.
  2635             20  PM-MAIL-STATUS            PIC X.
  2636                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2637                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2638                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2639             20  PM-MAIL-DATE              PIC XX.
  2640     12  FILLER                            PIC XX.
  2641     12  FILLER                            PIC X(12).
  2642*    12  FILLER                            PIC X(30).
  2643
  2644******************************************************************
  2645*                                COPY ERCLOFC.
  2646******************************************************************
  2647*                                                                *
  2648*                                                                *
  2649*                            ERCLOFC                             *
  2650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2651*                            VMOD=2.003                          *
  2652*                                                                *
  2653*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2654*                                                                *
  2655*   FILE TYPE = VSAM,KSDS                                        *
  2656*   RECORD SIZE = 670   RECFORM = FIX                            *
  2657*                                                                *
  2658*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2659*                                                                *
  2660*   LOG = YES                                                    *
  2661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2662*                                                                *
  2663******************************************************************
  2664
  2665 01  LOAN-OFFICER-MASTER.
  2666     12  LO-RECORD-ID                PIC XX.
  2667         88  VALID-LO-ID                VALUE 'LO'.
  2668
  2669     12  LO-CONTROL-PRIMARY.
  2670         16  LO-COMPANY-CD           PIC X.
  2671         16  LO-CARRIER              PIC X.
  2672         16  LO-GROUPING.
  2673             20  LO-GROUPING-PREFIX  PIC XXX.
  2674             20  LO-GROUPING-PRIME   PIC XXX.
  2675         16  LO-STATE                PIC XX.
  2676         16  LO-ACCOUNT.
  2677             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2678             20  LO-ACCOUNT-PRIME    PIC X(6).
  2679         16  LO-OFFICER-CODE         PIC X(5).
  2680
  2681     12  LO-OFFICER-NAME             PIC X(30).
  2682
  2683     12  LO-LAST-MAINT-DT            PIC XX.
  2684     12  LO-LAST-USER                PIC X(4).
  2685     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2686
  2687     12  LO-COMP-CONTROL             PIC X.
  2688             88  LO-SHOW-COMP           VALUE 'Y'.
  2689             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  52
* EL050.cbl
  2690     12  LO-DETAIL-CONTROL           PIC X.
  2691             88  LO-PRINT-DETAIL        VALUE 'D'.
  2692             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2693
  2694     12  LO-SV-CARRIER               PIC X.
  2695     12  LO-SV-GROUPING              PIC X(6).
  2696     12  LO-SV-STATE                 PIC XX.
  2697
  2698     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2699     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2700
  2701     12  LO-OFFICER-INFO.
  2702         16  FILLER OCCURS 12 TIMES.
  2703             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2704             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2705             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2706             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2707             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2708             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2710             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2711     12  FILLER                      PIC X(198).
  2712******************************************************************
  2713*                                COPY ERCPDEF.
  2714******************************************************************
  2715*                                                                *
  2716*                                                                *
  2717*                            ERCPDEF.                            *
  2718*                                                                *
  2719*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2720*                                                                *
  2721*    FILE TYPE = VSAM,KSDS                                       *
  2722*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2723*                                                                *
  2724*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2725*                                                                *
  2726*    LOG = YES                                                   *
  2727*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2728******************************************************************
  2729 01  PRODUCT-MASTER.
  2730    12  PD-RECORD-ID                 PIC X(02).
  2731        88  VALID-PD-ID                  VALUE 'PD'.
  2732    12  PD-CONTROL-PRIMARY.
  2733        16  PD-COMPANY-CD            PIC X.
  2734        16  PD-STATE                 PIC XX.
  2735        16  PD-PRODUCT-CD            PIC XXX.
  2736        16  PD-FILLER                PIC X(7).
  2737        16  PD-BEN-TYPE              PIC X.
  2738        16  PD-BEN-CODE              PIC XX.
  2739        16  PD-PROD-EXP-DT           PIC XX.
  2740    12  FILLER                       PIC X(50).
  2741    12  PD-PRODUCT-DATA OCCURS 8.
  2742        16  PD-PROD-CODE             PIC X.
  2743            88  PD-PROD-LIFE           VALUE 'L'.
  2744            88  PD-PROD-PROP           VALUE 'P'.
  2745            88  PD-PROD-AH             VALUE 'A'.
  2746            88  PD-PROD-IU             VALUE 'I'.
  2747            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  53
* EL050.cbl
  2748        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2749        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2750        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2751        16  PD-MAX-TERM              PIC S999        COMP-3.
  2752        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2753        16  FILLER                   PIC X.
  2754        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2755        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2756        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2757        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2758        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2759        16  PD-REC-CRIT-PERIOD       PIC X.
  2760        16  PD-RTW-MOS               PIC 99.
  2761        16  FILLER                   PIC X(5).
  2762    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2763    12  PD-TERM-LIMITS OCCURS 15.
  2764        16  PD-LOW-TERM              PIC S999        COMP-3.
  2765        16  PD-HI-TERM               PIC S999        COMP-3.
  2766*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2767    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2768        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2769        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2770    12  PD-EARN-FACTORS.
  2771        16  FILLER OCCURS 15.
  2772            20  FILLER OCCURS 15.
  2773                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2774    12  PD-PRODUCT-DESC              PIC X(80).
  2775    12  PD-TRUNCATED                 PIC X.
  2776    12  FILLER                       PIC X(59).
  2777    12  PD-MAINT-INFORMATION.
  2778        16  PD-LAST-MAINT-DT         PIC X(02).
  2779        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2780        16  PD-LAST-MAINT-BY         PIC X(04).
  2781*                                COPY ELCSTATE.
  2782******************************************************************
  2783*                                                                *
  2784*                                                                *
  2785*                            ELCSTATE.                           *
  2786*                                                                *
  2787*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2788*                                                                *
  2789*   FILE TYPE = VSAM,KSDS                                        *
  2790*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2791*                                                                *
  2792*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2793*       ALTERNATE INDEX = NONE                                   *
  2794*                                                                *
  2795*   LOG = YES                                                    *
  2796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2797******************************************************************
  2798*                   C H A N G E   L O G
  2799*
  2800* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2801*-----------------------------------------------------------------
  2802*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2803* EFFECTIVE    NUMBER
  2804*-----------------------------------------------------------------
  2805* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  54
* EL050.cbl
  2806******************************************************************
  2807*
  2808 01  STATE-FILE.
  2809     12  SF-RECORD-ID                       PIC XX.
  2810         88  VALID-CF-ID                        VALUE 'SF'.
  2811     12  SF-CONTROL-PRIMARY.
  2812         16  SF-COMPANY-ID                  PIC XXX.
  2813         16  SF-CARRIER-CODE                PIC X.
  2814         16  SF-GROUPING                    PIC X(6).
  2815         16  SF-STATE-CODE                  PIC XX.
  2816         16  SF-EXPIRE-DATE                 PIC 9(8).
  2817****************************************************************
  2818*             STATE CONTROLS
  2819****************************************************************
  2820     12  SF-LAST-MAINT-DT                   PIC XX.
  2821     12  SF-LAST-MAINT-BY                   PIC X(4).
  2822     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2823     12  SF-STATE-RT-CONTROLS.
  2824         16  SF-ST-RT-CALC                  PIC X.
  2825     12  SF-ST-TAX-CONTROLS.
  2826         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2827         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2828         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2829     12  SF-ST-REFUND-OPTIONS.
  2830         16  SF-ST-RF-LR-CALC               PIC X.
  2831         16  SF-ST-RF-LL-CALC               PIC X.
  2832         16  SF-ST-RF-LN-CALC               PIC X.
  2833         16  SF-ST-RF-AH-CALC               PIC X.
  2834         16  SF-ST-RF-CP-CALC               PIC X.
  2835     12  SF-ST-UNEARN-PREM-OPTIONS.
  2836         16  SF-ST-LUEP-R78                 PIC X.
  2837         16  SF-ST-LUEP-PRO                 PIC X.
  2838         16  SF-ST-LUEP-ST                  PIC X.
  2839         16  SF-ST-LUEP-DOM                 PIC X.
  2840         16  SF-ST-AUEP-R78                 PIC X.
  2841         16  SF-ST-AUEP-PRO                 PIC X.
  2842         16  SF-ST-AUEP-ST                  PIC X.
  2843         16  SF-ST-AUEP-DOM                 PIC X.
  2844         16  SF-ST-CUEP-R78                 PIC X.
  2845         16  SF-ST-CUEP-PRO                 PIC X.
  2846         16  SF-ST-CUEP-ST                  PIC X.
  2847         16  SF-ST-CUEP-DOM                 PIC X.
  2848     12  SF-ST-EARN-PREM-OPTIONS.
  2849         16  SF-ST-LEP-R78                  PIC X.
  2850         16  SF-ST-LEP-PRO                  PIC X.
  2851         16  SF-ST-LEP-ST                   PIC X.
  2852         16  SF-ST-LEP-DOM                  PIC X.
  2853         16  SF-ST-AEP-R78                  PIC X.
  2854         16  SF-ST-AEP-PRO                  PIC X.
  2855         16  SF-ST-AEP-ST                   PIC X.
  2856         16  SF-ST-AEP-DOM                  PIC X.
  2857         16  SF-ST-CEP-R78                  PIC X.
  2858         16  SF-ST-CEP-PRO                  PIC X.
  2859         16  SF-ST-CEP-ST                   PIC X.
  2860         16  SF-ST-CEP-DOM                  PIC X.
  2861     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  55
* EL050.cbl
  2863*    COPY ELCCRTT.
  2864******************************************************************
  2865*                                                                *
  2866*                            ELCCRTT.                            *
  2867*                                                                *
  2868*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2869*                                                                *
  2870*   FILE TYPE = VSAM,KSDS                                        *
  2871*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2872*                                                                *
  2873*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2874*                                                                *
  2875*   LOG = YES                                                    *
  2876*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2877******************************************************************
  2878*                   C H A N G E   L O G
  2879*
  2880* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2881*-----------------------------------------------------------------
  2882*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2883* EFFECTIVE    NUMBER
  2884*-----------------------------------------------------------------
  2885* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2886* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2887* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2888* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2889******************************************************************
  2890
  2891 01  CERTIFICATE-TRAILERS.
  2892     12  CS-RECORD-ID                      PIC XX.
  2893         88  VALID-CS-ID                      VALUE 'CS'.
  2894
  2895     12  CS-CONTROL-PRIMARY.
  2896         16  CS-COMPANY-CD                 PIC X.
  2897         16  CS-CARRIER                    PIC X.
  2898         16  CS-GROUPING                   PIC X(6).
  2899         16  CS-STATE                      PIC XX.
  2900         16  CS-ACCOUNT                    PIC X(10).
  2901         16  CS-CERT-EFF-DT                PIC XX.
  2902         16  CS-CERT-NO.
  2903             20  CS-CERT-PRIME             PIC X(10).
  2904             20  CS-CERT-SFX               PIC X.
  2905         16  CS-TRAILER-TYPE               PIC X.
  2906             88  COMM-TRLR           VALUE 'A'.
  2907             88  FUTURE-TRLR         VALUE 'B'.
  2908             88  CERT-DATA-TRLR      VALUE 'C'.
  2909
  2910     12  CS-DATA-AREA                      PIC X(516).
  2911
  2912     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2913         16  CS-BANK-COMMISSION-AREA.
  2914             20  CS-BANK-COMMS       OCCURS 10.
  2915                 24  CS-AGT                PIC X(10).
  2916                 24  CS-COM-TYP            PIC X.
  2917                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2918                 24  CS-RECALC-LV-INDIC    PIC X.
  2919                 24  FILLER                PIC X(10).
  2920         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  56
* EL050.cbl
  2921
  2922     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2923         16  CS-VIN-NUMBER                 PIC X(17).
  2924         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2925         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2926         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2927         16  FILLER                        PIC X(496).
  2928******************************************************************
  2929*    COPY ELCCRTO.
  2930******************************************************************
  2931*                                                                *
  2932*                            ELCCRTO.                            *
  2933*                                                                *
  2934*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2935*                                                                *
  2936*   FILE TYPE = VSAM,KSDS                                        *
  2937*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2938*                                                                *
  2939*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2940*                                                                *
  2941*   LOG = YES                                                    *
  2942*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2943******************************************************************
  2944*                   C H A N G E   L O G
  2945*
  2946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2947*-----------------------------------------------------------------
  2948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2949* EFFECTIVE    NUMBER
  2950*-----------------------------------------------------------------
  2951* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2952* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2953* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2954* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2955******************************************************************
  2956 01  ORIGINAL-CERTIFICATE.
  2957     12  OC-RECORD-ID                      PIC XX.
  2958         88  VALID-OC-ID                      VALUE 'OC'.
  2959     12  OC-CONTROL-PRIMARY.
  2960         16  OC-COMPANY-CD                 PIC X.
  2961         16  OC-CARRIER                    PIC X.
  2962         16  OC-GROUPING                   PIC X(6).
  2963         16  OC-STATE                      PIC XX.
  2964         16  OC-ACCOUNT                    PIC X(10).
  2965         16  OC-CERT-EFF-DT                PIC XX.
  2966         16  OC-CERT-NO.
  2967             20  OC-CERT-PRIME             PIC X(10).
  2968             20  OC-CERT-SFX               PIC X.
  2969         16  OC-RECORD-TYPE                PIC X.
  2970         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2971     12  OC-LAST-MAINT-DT                  PIC XX.
  2972     12  OC-LAST-MAINT-BY                  PIC X(4).
  2973     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2974     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2975     12  FILLER                            PIC X(49).
  2976     12  OC-ORIG-REC.
  2977         16  OC-INS-LAST-NAME              PIC X(15).
  2978         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  57
* EL050.cbl
  2979         16  OC-INS-MIDDLE-INIT            PIC X.
  2980         16  OC-INS-AGE                    PIC S999     COMP-3.
  2981         16  OC-JNT-LAST-NAME              PIC X(15).
  2982         16  OC-JNT-FIRST-NAME             PIC X(10).
  2983         16  OC-JNT-MIDDLE-INIT            PIC X.
  2984         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2985         16  OC-LF-BENCD                   PIC XX.
  2986         16  OC-LF-TERM                    PIC S999      COMP-3.
  2987         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2988         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2989         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2990         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2991         16  OC-LF-EXP-DT                  PIC XX.
  2992         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2993         16  OC-LF-CANCEL-DT               PIC XX.
  2994         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2995         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2996         16  OC-AH-BENCD                   PIC XX.
  2997         16  OC-AH-TERM                    PIC S999      COMP-3.
  2998         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2999         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3000         16  OC-AH-EXP-DT                  PIC XX.
  3001         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3002         16  OC-AH-CP                      PIC 99.
  3003         16  OC-AH-CANCEL-DT               PIC XX.
  3004         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3005         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3006         16  OC-CRED-BENE-NAME             PIC X(25).
  3007         16  OC-1ST-PMT-DT                 PIC XX.
  3008         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3009         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3010         16  FILLER                        PIC X(213).
  3011
  3012     12  FILLER                            PIC X(50).
  3013******************************************************************
  3014
  3015*    COPY ELCDATE.
  3016******************************************************************
  3017*                                                                *
  3018*                                                                *
  3019*                            ELCDATE.                            *
  3020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3021*                            VMOD=2.003
  3022*                                                                *
  3023*                                                                *
  3024*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3025*                 LENGTH = 200                                   *
  3026******************************************************************
  3027
  3028 01  DATE-CONVERSION-DATA.
  3029     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3030     12  DC-OPTION-CODE                PIC X.
  3031         88  BIN-TO-GREG                VALUE ' '.
  3032         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3033         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3034         88  YMD-GREG-TO-BIN            VALUE '3'.
  3035         88  MDY-GREG-TO-BIN            VALUE '4'.
  3036         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  58
* EL050.cbl
  3037         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3038         88  FIND-CENTURY               VALUE '7'.
  3039         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3040         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3041         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3042         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3043         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3044         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3045         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3046         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3047         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3048         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3049         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3050         88  BIN-3-TO-GREG              VALUE 'I'.
  3051         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3052         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3053         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3054         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3055         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3056         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3057         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3058         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3059         88  THREE-CHARACTER-BIN
  3060                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3061         88  GREGORIAN-TO-BIN
  3062                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3063         88  BIN-TO-GREGORIAN
  3064                  VALUES ' ' '1' 'I' '8' 'G'.
  3065         88  JULIAN-TO-BINARY
  3066                  VALUES '5' 'C' 'E' 'F'.
  3067     12  DC-ERROR-CODE                 PIC X.
  3068         88  NO-CONVERSION-ERROR        VALUE ' '.
  3069         88  DATE-CONVERSION-ERROR
  3070                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3071         88  DATE-IS-ZERO               VALUE '1'.
  3072         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3073         88  DATE-IS-INVALID            VALUE '3'.
  3074         88  DATE1-GREATER-DATE2        VALUE '4'.
  3075         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3076         88  DATE-INVALID-OPTION        VALUE '9'.
  3077         88  INVALID-CENTURY            VALUE 'A'.
  3078         88  ONLY-CENTURY               VALUE 'B'.
  3079         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3080         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3081     12  DC-END-OF-MONTH               PIC X.
  3082         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3083     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3084         88  USE-NORMAL-PROCESS         VALUE ' '.
  3085         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3086         88  ADJUST-UP-100-YRS          VALUE '2'.
  3087     12  FILLER                        PIC X.
  3088     12  DC-CONVERSION-DATES.
  3089         16  DC-BIN-DATE-1             PIC XX.
  3090         16  DC-BIN-DATE-2             PIC XX.
  3091         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3092         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3093                       DC-GREG-DATE-1-EDIT.
  3094             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  59
* EL050.cbl
  3095             20  SLASH1-1              PIC X.
  3096             20  DC-EDIT1-DAY          PIC 99.
  3097             20  SLASH1-2              PIC X.
  3098             20  DC-EDIT1-YEAR         PIC 99.
  3099         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3100         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3101                     DC-GREG-DATE-2-EDIT.
  3102             20  DC-EDIT2-MONTH        PIC 99.
  3103             20  SLASH2-1              PIC X.
  3104             20  DC-EDIT2-DAY          PIC 99.
  3105             20  SLASH2-2              PIC X.
  3106             20  DC-EDIT2-YEAR         PIC 99.
  3107         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3108         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3109                     DC-GREG-DATE-1-YMD.
  3110             20  DC-YMD-YEAR           PIC 99.
  3111             20  DC-YMD-MONTH          PIC 99.
  3112             20  DC-YMD-DAY            PIC 99.
  3113         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3114         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3115                      DC-GREG-DATE-1-MDY.
  3116             20  DC-MDY-MONTH          PIC 99.
  3117             20  DC-MDY-DAY            PIC 99.
  3118             20  DC-MDY-YEAR           PIC 99.
  3119         16  DC-GREG-DATE-1-ALPHA.
  3120             20  DC-ALPHA-MONTH        PIC X(10).
  3121             20  DC-ALPHA-DAY          PIC 99.
  3122             20  FILLER                PIC XX.
  3123             20  DC-ALPHA-CENTURY.
  3124                 24 DC-ALPHA-CEN-N     PIC 99.
  3125             20  DC-ALPHA-YEAR         PIC 99.
  3126         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3127         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3128         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3129         16  DC-JULIAN-DATE            PIC 9(05).
  3130         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3131                                       PIC 9(05).
  3132         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3133             20  DC-JULIAN-YEAR        PIC 99.
  3134             20  DC-JULIAN-DAYS        PIC 999.
  3135         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3136         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3137         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3138     12  DATE-CONVERSION-VARIBLES.
  3139         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3140         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3141             20  FILLER                PIC 9(3).
  3142             20  HOLD-CEN-1-CCYY.
  3143                 24  HOLD-CEN-1-CC     PIC 99.
  3144                 24  HOLD-CEN-1-YY     PIC 99.
  3145             20  HOLD-CEN-1-MO         PIC 99.
  3146             20  HOLD-CEN-1-DA         PIC 99.
  3147         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3148             20  HOLD-CEN-1-R-MO       PIC 99.
  3149             20  HOLD-CEN-1-R-DA       PIC 99.
  3150             20  HOLD-CEN-1-R-CCYY.
  3151                 24  HOLD-CEN-1-R-CC   PIC 99.
  3152                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  60
* EL050.cbl
  3153             20  FILLER                PIC 9(3).
  3154         16  HOLD-CENTURY-1-X.
  3155             20  FILLER                PIC X(3)  VALUE SPACES.
  3156             20  HOLD-CEN-1-X-CCYY.
  3157                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3158                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3159             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3160             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3161         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3162             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3163             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3164             20  HOLD-CEN-1-R-X-CCYY.
  3165                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3166                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3167             20  FILLER                PIC XXX.
  3168         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3169         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3170         16  DC-JULIAN-DATE-1          PIC 9(07).
  3171         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3172             20  DC-JULIAN-1-CCYY.
  3173                 24  DC-JULIAN-1-CC    PIC 99.
  3174                 24  DC-JULIAN-1-YR    PIC 99.
  3175             20  DC-JULIAN-DA-1        PIC 999.
  3176         16  DC-JULIAN-DATE-2          PIC 9(07).
  3177         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3178             20  DC-JULIAN-2-CCYY.
  3179                 24  DC-JULIAN-2-CC    PIC 99.
  3180                 24  DC-JULIAN-2-YR    PIC 99.
  3181             20  DC-JULIAN-DA-2        PIC 999.
  3182         16  DC-GREG-DATE-A-EDIT.
  3183             20  DC-EDITA-MONTH        PIC 99.
  3184             20  SLASHA-1              PIC X VALUE '/'.
  3185             20  DC-EDITA-DAY          PIC 99.
  3186             20  SLASHA-2              PIC X VALUE '/'.
  3187             20  DC-EDITA-CCYY.
  3188                 24  DC-EDITA-CENT     PIC 99.
  3189                 24  DC-EDITA-YEAR     PIC 99.
  3190         16  DC-GREG-DATE-B-EDIT.
  3191             20  DC-EDITB-MONTH        PIC 99.
  3192             20  SLASHB-1              PIC X VALUE '/'.
  3193             20  DC-EDITB-DAY          PIC 99.
  3194             20  SLASHB-2              PIC X VALUE '/'.
  3195             20  DC-EDITB-CCYY.
  3196                 24  DC-EDITB-CENT     PIC 99.
  3197                 24  DC-EDITB-YEAR     PIC 99.
  3198         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3199         16  DC-GREG-DATE-CYMD-R REDEFINES
  3200                              DC-GREG-DATE-CYMD.
  3201             20  DC-CYMD-CEN           PIC 99.
  3202             20  DC-CYMD-YEAR          PIC 99.
  3203             20  DC-CYMD-MONTH         PIC 99.
  3204             20  DC-CYMD-DAY           PIC 99.
  3205         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3206         16  DC-GREG-DATE-MDCY-R REDEFINES
  3207                              DC-GREG-DATE-MDCY.
  3208             20  DC-MDCY-MONTH         PIC 99.
  3209             20  DC-MDCY-DAY           PIC 99.
  3210             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  61
* EL050.cbl
  3211             20  DC-MDCY-YEAR          PIC 99.
  3212    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3213        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3214    12  DC-EL310-DATE                  PIC X(21).
  3215    12  FILLER                         PIC X(28).
  3216
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  62
* EL050.cbl
  3218*    COPY ELCCALC.
  3219******************************************************************
  3220*                                                                *
  3221*                           ELCCALC.                            *
  3222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3223*                            VMOD=2.025                          *
  3224*                                                                *
  3225*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3226*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3227*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3228*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3229*                                                                *
  3230*  PASSED TO ELRTRM                                              *
  3231*  -----------------                                             *
  3232*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3233*  ORIGINAL TERM                                                 *
  3234*  BEGINNING DATE                                                *
  3235*  ENDING DATE                                                   *
  3236*  COMPANY I.D.                                                  *
  3237*  ACCOUNT MASTER USER FIELD                                     *
  3238*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3239*  FREE LOOK DAYS                                                *
  3240*                                                                *
  3241*  RETURNED FROM ELRTRM                                          *
  3242*  ---------------------                                         *
  3243*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3244*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3245*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3246*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3247*----------------------------------------------------------------*
  3248*  PASSED TO ELRAMT                                              *
  3249*  ----------------                                              *
  3250*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3251*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3252*  ORIGINAL AMOUNT                                               *
  3253*  ALTERNATE BENEFIT (BALLON)                                    *
  3254*  A.P.R. - NET PAY ONLY                                         *
  3255*  METHOD
  3256*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3257*  COMPANY I.D.                                                  *
  3258*  BENEFIT TYPE                                                  *
  3259*                                                                *
  3260*  RETURNED FROM ELRAMT                                          *
  3261*  --------------------                                          *
  3262*  REMAINING AMOUNT 1 - CURRENT                                  *
  3263*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3264*  REMAINING AMOUNT FACTOR
  3265*----------------------------------------------------------------*
  3266*  PASSED TO ELRESV                                              *
  3267*  -----------------                                             *
  3268*  CERTIFICATE EFFECTIVE DATE                                    *
  3269*  VALUATION DATE                                                *
  3270*  PAID THRU DATE                                                *
  3271*  BENEFIT                                                       *
  3272*  INCURRED DATE                                                 *
  3273*  REPORTED DATE                                                 *
  3274*  ISSUE AGE                                                     *
  3275*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  63
* EL050.cbl
  3276*  CDT PERCENT                                                   *
  3277*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3278* *CLAIM TYPE (LIFE, A/H)                                        *
  3279* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3280* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3281*                                                                *
  3282*  RETURNED FROM ELRESV                                          *
  3283*  --------------------                                          *
  3284*  CDT TABLE USED                                                *
  3285*  CDT FACTOR USED                                               *
  3286*  PAY TO CURRENT RESERVE                                        *
  3287*  I.B.N.R. - A/H ONLY                                           *
  3288*  FUTURE (ACCRUED) AH ONLY                                      *
  3289*----------------------------------------------------------------*
  3290*  PASSED TO ELRATE                                              *
  3291*  ----------------                                              *
  3292*  CERT ISSUE DATE                                               *
  3293*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3294*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3295*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3296*  STATE CODE (CLIENT DEFINED)                                   *
  3297*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3298*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3299*  DEVIATION CODE                                                *
  3300*  ISSUE AGE                                                     *
  3301*  ORIGINAL BENEFIT AMOUNT                                       *
  3302*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3303*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3304*  BENEFIT KIND (LIFE OR A/H)                                    *
  3305*  A.P.R.                                                        *
  3306*  METHOD
  3307*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3308*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3309*  COMPANY I.D. (3 CHARACTER)                                    *
  3310*  BENEFIT CODE                                                  *
  3311*  BENEFIT OVERRIDE CODE                                         *
  3312*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3313*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3314*  JOINT INDICATOR (CSL ONLY)                                    *
  3315*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3316*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3317*                                                                *
  3318*  RETURNED FROM ELRATE                                          *
  3319*  --------------------                                          *
  3320*  CALCULATED PREMIUM                                            *
  3321*  PREMIUM RATE                                                  *
  3322*  MORTALITY CODE                                                *
  3323*  MAX ATTAINED AGE                                              *
  3324*  MAX AGE                                                       *
  3325*  MAX TERM                                                      *
  3326*  MAX MONTHLY BENEFIT                                           *
  3327*  MAX TOTAL BENIFIT                                             *
  3328*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3329*----------------------------------------------------------------*
  3330*  PASSED TO ELRFND                                              *
  3331*  ----------------                                              *
  3332*  CERT ISSUE DATE                                               *
  3333*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  64
* EL050.cbl
  3334*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3335*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3336*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3337*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3338*  STATE CODE (CLIENT DEFINED)                                   *
  3339*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3340*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3341*  DEVIATION CODE                                                *
  3342*  ISSUE AGE                                                     *
  3343*  ORIGINAL BENEFIT AMOUNT                                       *
  3344*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3345*  PROCESS TYPE (CANCEL)                                         *
  3346*  BENEFIT KIND (LIFE OR A/H)                                    *
  3347*  A.P.R.                                                        *
  3348*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3349*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3350*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3351*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3352*  COMPANY I.D. (3 CHARACTER)                                    *
  3353*  BENEFIT CODE                                                  *
  3354*  BENEFIT OVERRIDE CODE                                         *
  3355*                                                                *
  3356*  RETURNED FROM ELRFND                                          *
  3357*  --------------------                                          *
  3358*  CALCULATED REFUND                                             *
  3359*----------------------------------------------------------------*
  3360*  PASSED TO ELEARN                                              *
  3361*  ----------------                                              *
  3362*  CERT ISSUE DATE                                               *
  3363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3364*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3365*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3366*  STATE CODE (CLIENT DEFINED)                                   *
  3367*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3368*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3369*  DEVIATION CODE                                                *
  3370*  ISSUE AGE                                                     *
  3371*  ORIGINAL BENEFIT AMOUNT                                       *
  3372*  BENEFIT KIND (LIFE OR A/H)                                    *
  3373*  A.P.R.                                                        *
  3374*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3375*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3376*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3377*  COMPANY I.D. (3 CHARACTER)                                    *
  3378*  BENEFIT CODE                                                  *
  3379*  BENEFIT OVERRIDE CODE                                         *
  3380*                                                                *
  3381*  RETURNED FROM ELEARN                                          *
  3382*  --------------------                                          *
  3383*  INDICATED  EARNINGS                                           *
  3384*----------------------------------------------------------------*
  3385*                 LENGTH = 450                                   *
  3386*                                                                *
  3387******************************************************************
  3388******************************************************************
  3389*                   C H A N G E   L O G
  3390*
  3391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  65
* EL050.cbl
  3392*-----------------------------------------------------------------
  3393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3394* EFFECTIVE    NUMBER
  3395*-----------------------------------------------------------------
  3396* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3397* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3398* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3399* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3400* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3401* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3402* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3403* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3404* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3405******************************************************************
  3406
  3407 01  CALCULATION-PASS-AREA.
  3408     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3409                                     COMP.
  3410
  3411     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3412       88  NO-CP-ERROR                             VALUE ZERO.
  3413       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3414                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3415       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3416       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3417       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3418       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3419       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3420       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3421       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3422       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3423       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3424       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3425       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3426       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3427       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3428       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3429       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3430       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3431       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3432
  3433     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3434       88  NO-CP-ERROR-2                           VALUE ZERO.
  3435***********************  INPUT AREAS ****************************
  3436
  3437     12  CP-CALCULATION-AREA.
  3438         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3439         16  CP-CERT-EFF-DT        PIC XX.
  3440         16  CP-VALUATION-DT       PIC XX.
  3441         16  CP-PAID-THRU-DT       PIC XX.
  3442         16  CP-BENEFIT-TYPE       PIC X.
  3443           88  CP-AH                               VALUE 'A' 'D'
  3444                                                   'I' 'U'.
  3445           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3446           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3447         16  CP-INCURRED-DT        PIC XX.
  3448         16  CP-REPORTED-DT        PIC XX.
  3449         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  66
* EL050.cbl
  3450         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3451         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3452                                     COMP-3.
  3453         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3454                                     COMP-3.
  3455         16  CP-CDT-METHOD         PIC X.
  3456           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3457           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3458           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3459         16  CP-CLAIM-TYPE         PIC X.
  3460           88  CP-AH-CLAIM                         VALUE 'A'.
  3461           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3462         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3463                                     COMP-3.
  3464         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3465                                     COMP-3.
  3466         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3467                                     COMP-3.
  3468         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3473                                     COMP-3.
  3474         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-REM-TERM-METHOD    PIC X.
  3477           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3478           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3479           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3480           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3481           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3482           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3483           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3484         16  CP-EARNING-METHOD     PIC X.
  3485           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3486           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3487           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3488           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3489           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3490           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3491           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3492           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3493           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3494           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3495           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3496           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3497           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3498           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3499         16  CP-PROCESS-TYPE       PIC X.
  3500           88  CP-CLAIM                            VALUE '1'.
  3501           88  CP-CANCEL                           VALUE '2'.
  3502           88  CP-ISSUE                            VALUE '3'.
  3503         16  CP-SPECIAL-CALC-CD    PIC X.
  3504           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3505           88  CP-1-MTH-INTEREST               VALUE ' '.
  3506           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3507           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  67
* EL050.cbl
  3508           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3509           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3510           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3511           88  CP-FARM-PLAN                    VALUE 'F'.
  3512           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3513           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3514           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3515           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3516           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3517           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3518           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3519           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3520           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3521           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3522                                                     'W' 'X'.
  3523           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3524           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3525           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3526           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3527           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3528           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3529           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3530           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3531           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3532           88  CP-CSL-METH-1                   VALUE '5'.
  3533           88  CP-CSL-METH-2                   VALUE '6'.
  3534           88  CP-CSL-METH-3                   VALUE '7'.
  3535           88  CP-CSL-METH-4                   VALUE '8'.
  3536
  3537         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3538                                     COMP-3.
  3539         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3540         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3541         16  CP-STATE              PIC XX          VALUE SPACE.
  3542         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3543         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3544           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3545               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3546         16  CP-R78-OPTION         PIC X.
  3547           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3548           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3549
  3550         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3551         16  CP-IBNR-RESERVE-SW    PIC X.
  3552         16  CP-CLAIM-STATUS       PIC X.
  3553         16  CP-RATE-FILE          PIC X.
  3554         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3555                                     COMP-3.
  3556
  3557         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3558         16  CP-AH-OVERRIDE-CODE   PIC X.
  3559
  3560         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3563                                   PIC S9(5)V99 COMP-3.
  3564         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3565                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  68
* EL050.cbl
  3566         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3569                                     COMP-3.
  3570         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3571                                  PIC S9(7)V99 COMP-3.
  3572
  3573         16  CP-PAID-FROM-DATE     PIC X(02).
  3574         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3575         16  CP-EXT-DAYS-CALC      PIC X.
  3576           88  CP-EXT-NO-CHG                   VALUE ' '.
  3577           88  CP-EXT-CHG-LF                   VALUE '1'.
  3578           88  CP-EXT-CHG-AH                   VALUE '2'.
  3579           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3580         16  CP-DOMICILE-STATE     PIC XX.
  3581         16  CP-CARRIER            PIC X.
  3582         16  CP-REIN-FLAG          PIC X.
  3583         16  CP-REM-TRM-CALC-OPTION PIC X.
  3584           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3585                      '2' '3' '4' '5'.
  3586           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3587           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3588           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3589           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3590           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3591           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3592           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3593           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3594         16  CP-SIG-SWITCH         PIC X.
  3595         16  CP-RATING-METHOD      PIC X.
  3596           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3597           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3598           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3599           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3600           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3601           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3602           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3603           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3604           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3605         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3606                                     COMP-3.
  3607         16  CP-BEN-CATEGORY       PIC X.
  3608         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3609         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3610                                   PIC S99V9(5) COMP-3.
  3611         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3612         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3613                                   PIC S99V9(5) COMP-3.
  3614         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3615         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3616         16  CP-EXPIRE-DT          PIC XX.
  3617         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3618         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3619         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3620         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3621         16  CP-DDF-SPEC-CALC      PIC X.
  3622             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3623             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  69
* EL050.cbl
  3624         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3625         16  CP-CANCEL-REASON      PIC X.
  3626         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3627         16  CP-PMT-MODE           PIC X.
  3628         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3629         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3630         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3631         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3632         16  FILLER                PIC X.
  3633
  3634***************    OUTPUT FROM ELRESV   ************************
  3635
  3636         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3637
  3638         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3639                                     COMP-3.
  3640         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3645                                     COMP-3.
  3646         16  FILLER                PIC X(09).
  3647***************    OUTPUT FROM ELRTRM   *************************
  3648
  3649         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3650                                     COMP-3.
  3651         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3652                                     COMP-3.
  3653         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3656                                     COMP-3.
  3657         16  FILLER                PIC X(12).
  3658
  3659***************    OUTPUT FROM ELRAMT   *************************
  3660
  3661         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  FILLER                PIC X(12).
  3666
  3667***************    OUTPUT FROM ELRATE   *************************
  3668
  3669         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-MORTALITY-CODE     PIC X(4).
  3674         16  CP-RATE-EDIT-FLAG     PIC X.
  3675             88  CP-RATES-NEED-APR                  VALUE '1'.
  3676         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3679         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3680         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3681                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  70
* EL050.cbl
  3682         16  FILLER                PIC X(07).
  3683
  3684***************    OUTPUT FROM ELRFND   *************************
  3685
  3686         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-REFUND-TYPE-USED   PIC X.
  3689           88  CP-R-AS-R78                         VALUE '1'.
  3690           88  CP-R-AS-PRORATA                     VALUE '2'.
  3691           88  CP-R-AS-CALIF                       VALUE '3'.
  3692           88  CP-R-AS-TEXAS                       VALUE '4'.
  3693           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3694           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3695           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3696           88  CP-R-AS-MEAN                        VALUE '8'.
  3697           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3698           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3699           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3700           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3701           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3702           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3703         16  FILLER                PIC X(12).
  3704
  3705***************    OUTPUT FROM ELEARN   *************************
  3706
  3707         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3716                                     COMP-3.
  3717         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-EARNING-TYPE-USED  PIC X.
  3720           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3721           88  CP-E-AS-R78                         VALUE '1'.
  3722           88  CP-E-AS-PRORATA                     VALUE '2'.
  3723           88  CP-E-AS-TEXAS                       VALUE '4'.
  3724           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3725           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3726           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3727           88  CP-E-AS-MEAN                        VALUE '8'.
  3728           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3729         16  FILLER                PIC X(12).
  3730
  3731***************    OUTPUT FROM ELPMNT   *************************
  3732
  3733         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  FILLER                PIC X(12).
  3738
  3739***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  71
* EL050.cbl
  3740         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3753             88  OPEN-RATE-FILE                   VALUE 'O'.
  3754             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3755             88  IO-ERROR                         VALUE 'E'.
  3756
  3757         16  CP-FIRST-PAY-DATE     PIC XX.
  3758
  3759         16  CP-JOINT-INDICATOR    PIC X.
  3760
  3761         16  CP-RESERVE-REMAINING-TERM
  3762                                   PIC S9(4)V9    VALUE ZERO
  3763                                     COMP-3.
  3764
  3765         16  CP-INSURED-BIRTH-DT   PIC XX.
  3766
  3767         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3768                                     COMP-3.
  3769
  3770         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3771                                     COMP-3.
  3772
  3773         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3774                                     COMP-3.
  3775
  3776         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3777                                     COMP-3.
  3778
  3779         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3780                                     COMP-3.
  3781
  3782         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3783                                     COMP-3.
  3784
  3785         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3789             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3790
  3791         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3796         16  FILLER                PIC X(15).
  3797******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  72
* EL050.cbl
  3799******************************************************************
  3800*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3801*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3802*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3803*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3804*** MODIFICATION.                                              ***
  3805*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3806*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3807******************************************************************
  3808*    COPY ERCPNDB.
  3809******************************************************************
  3810*                                                                *
  3811*                                                                *
  3812*                            ERCPNDB.                            *
  3813*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3814*                            VMOD=2.025                          *
  3815*                                                                *
  3816*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3817*                                                                *
  3818******************************************************************
  3819*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3820*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3821******************************************************************
  3822*                                                                *
  3823*                                                                *
  3824*   FILE TYPE = VSAM,KSDS                                        *
  3825*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3826*                                                                *
  3827*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3828*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3829*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3830*                                                 RKP=13,LEN=36  *
  3831*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3832*                                      AND CHG-SEQ.)             *
  3833*                                                RKP=49,LEN=11   *
  3834*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3835*                                      AND CHG-SEQ.)             *
  3836*                                                RKP=60,LEN=15   *
  3837*                                                                *
  3838*   LOG = NO                                                     *
  3839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3840******************************************************************
  3841******************************************************************
  3842*                   C H A N G E   L O G
  3843*
  3844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3845*-----------------------------------------------------------------
  3846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3847* EFFECTIVE    NUMBER
  3848*-----------------------------------------------------------------
  3849* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3850* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3851* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3852* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3853* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3854* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3855* 032306                   PEMA  ADD BOW LOAN NUMBER
  3856* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  73
* EL050.cbl
  3857* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3858* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3859* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3860* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3861* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3862* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3863* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3864******************************************************************
  3865
  3866 01  PENDING-BUSINESS.
  3867     12  PB-RECORD-ID                     PIC XX.
  3868         88  VALID-PB-ID                        VALUE 'PB'.
  3869
  3870     12  PB-CONTROL-PRIMARY.
  3871         16  PB-COMPANY-CD                PIC X.
  3872         16  PB-ENTRY-BATCH               PIC X(6).
  3873         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3874         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3875
  3876     12  PB-CONTROL-BY-ACCOUNT.
  3877         16  PB-COMPANY-CD-A1             PIC X.
  3878         16  PB-CARRIER                   PIC X.
  3879         16  PB-GROUPING.
  3880             20  PB-GROUPING-PREFIX       PIC XXX.
  3881             20  PB-GROUPING-PRIME        PIC XXX.
  3882         16  PB-STATE                     PIC XX.
  3883         16  PB-ACCOUNT.
  3884             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3885             20  PB-ACCOUNT-PRIME         PIC X(6).
  3886         16  PB-CERT-EFF-DT               PIC XX.
  3887         16  PB-CERT-NO.
  3888             20  PB-CERT-PRIME            PIC X(10).
  3889             20  PB-CERT-SFX              PIC X.
  3890         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3891
  3892         16  PB-RECORD-TYPE               PIC X.
  3893             88  PB-MAILING-DATA                VALUE '0'.
  3894             88  PB-ISSUE                       VALUE '1'.
  3895             88  PB-CANCELLATION                VALUE '2'.
  3896             88  PB-BATCH-TRAILER               VALUE '9'.
  3897
  3898     12  PB-CONTROL-BY-ORIG-BATCH.
  3899         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3900         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3901         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3902         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3903
  3904     12  PB-CONTROL-BY-CSR.
  3905         16  PB-CSR-COMPANY-CD            PIC X.
  3906         16  PB-CSR-ID                    PIC X(4).
  3907         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3908         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3909         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3910******************************************************************
  3911*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3912******************************************************************
  3913
  3914     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  74
* EL050.cbl
  3915     12  PB-LAST-MAINT-BY                 PIC X(4).
  3916     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3917
  3918     12  PB-RECORD-BODY                   PIC X(375).
  3919
  3920     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3921         16  PB-CERT-ORIGIN               PIC X.
  3922             88  CLASIC-CREATED-CERT         VALUE '1'.
  3923         16  PB-I-NAME.
  3924             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3925             20  PB-I-INSURED-FIRST-NAME.
  3926                 24  PB-I-INSURED-1ST-INIT PIC X.
  3927                 24  FILLER                PIC X(9).
  3928             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3929         16  PB-I-AGE                     PIC S99   COMP-3.
  3930         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3931         16  PB-I-BIRTHDAY                PIC XX.
  3932         16  PB-I-INSURED-SEX             PIC X.
  3933             88  PB-SEX-MALE     VALUE 'M'.
  3934             88  PB-SEX-FEMALE   VALUE 'F'.
  3935
  3936         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3937         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3938         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3939         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3940         16  PB-I-SKIP-CODE               PIC X.
  3941             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3942             88  PB-SKIP-JULY              VALUE '1'.
  3943             88  PB-SKIP-AUGUST            VALUE '2'.
  3944             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3945             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3946             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3947             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3948             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3949             88  PB-SKIP-JUNE              VALUE '8'.
  3950             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3951             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3952             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3953         16  PB-I-TERM-TYPE               PIC X.
  3954             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3955             88  PB-PAID-WEEKLY            VALUE 'W'.
  3956             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3957             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3958             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3959         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3960         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3961         16  PB-I-DATA-ENTRY-SW           PIC X.
  3962             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3963             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3964             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3965             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3966         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3967         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3968*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3969         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3970         16  FILLER                       PIC X.
  3971
  3972         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  75
* EL050.cbl
  3973             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3974             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3975                                                   '90' THRU '99'.
  3976         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3977                                          PIC XX.
  3978         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3979         16  PB-I-AMOUNT-FINANCED REDEFINES
  3980                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3981         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3982         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3983                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3984         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3985         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3986         16  PB-I-CLP-AMOUNT REDEFINES
  3987                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3988         16  PB-I-LF-CALC-FLAG            PIC X.
  3989             88 PB-COMP-LF-PREM               VALUE '?'.
  3990         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3991         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3992         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3993         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3994         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3995         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3997         16  PB-I-LF-ABBR                 PIC XXX.
  3998         16  PB-I-LF-INPUT-CD             PIC XX.
  3999
  4000         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4001             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4002             88  PB-INVALID-AH               VALUE '  ' '00'
  4003                                                   '90' THRU '99'.
  4004         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4005         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4006         16  PB-I-AH-CALC-FLAG            PIC X.
  4007             88 PB-COMP-AH-PREM                  VALUE '?'.
  4008         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4009         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4010         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4011         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4012         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4013         16  PB-I-AH-ABBR                 PIC XXX.
  4014         16  PB-I-AH-INPUT-CD             PIC XXX.
  4015
  4016         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4017         16  PB-I-REIN-TABLE              PIC XXX.
  4018         16  PB-I-BUSINESS-TYPE           PIC 99.
  4019         16  PB-I-INDV-GRP-CD             PIC X.
  4020         16  PB-I-MORT-CODE.
  4021             20  PB-I-TABLE               PIC X.
  4022             20  PB-I-INTEREST            PIC XX.
  4023             20  PB-I-MORT-TYP            PIC X.
  4024         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4025         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4026         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4027         16  PB-I-INDV-GRP-OVRD           PIC X.
  4028         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4029         16  PB-I-SIG-SW                  PIC X.
  4030             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  76
* EL050.cbl
  4031         16  PB-I-RATE-CLASS              PIC XX.
  4032         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4033         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4034         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4035         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4036         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4037         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4038         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4039         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4040         16  PB-I-OB-FLAG                 PIC X.
  4041             88  PB-I-OB                      VALUE 'B'.
  4042             88  PB-I-SUMMARY                 VALUE 'Z'.
  4043         16  PB-I-ENTRY-STATUS            PIC X.
  4044             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4045                                              'M' '5' '9' '2'.
  4046             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4047             88  PB-I-POLICY-PENDING          VALUE '2'.
  4048             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4049             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4050             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4051             88  PB-I-REIN-ONLY               VALUE '9'.
  4052             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4053             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4054             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4055             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4056         16  PB-I-INT-CODE                PIC X.
  4057             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4058             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4059         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4060         16  PB-I-SOC-SEC-NO              PIC X(11).
  4061         16  PB-I-MEMBER-NO               PIC X(12).
  4062         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4063*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4064         16  PB-I-OLD-LOF                 PIC XXX.
  4065         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4066         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4067         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4068         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4069         16  PB-I-LIFE-INDICATOR          PIC X.
  4070             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4071         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4072         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4073                                          PIC S9(5)V99    COMP-3.
  4074         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4075             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4076             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4077         16  PB-I-1ST-PMT-DT              PIC XX.
  4078         16  PB-I-JOINT-INSURED.
  4079             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4080             20 PB-I-JOINT-FIRST-NAME.
  4081                24  PB-I-JOINT-FIRST-INIT PIC X.
  4082                24  FILLER                PIC X(9).
  4083             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4084*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4085         16  PB-I-BENEFICIARY-NAME.
  4086             20  PB-I-BANK-NUMBER         PIC X(10).
  4087             20  FILLER                   PIC X(15).
  4088         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  77
* EL050.cbl
  4089         16  PB-I-REFERENCE               PIC X(12).
  4090         16  FILLER REDEFINES PB-I-REFERENCE.
  4091             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4092             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4093             20  PB-I-CLP-STATE           PIC XX.
  4094         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4095             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4096             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4097             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4098         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4099         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4100         16  PB-I-RESIDENT-STATE          PIC XX.
  4101         16  PB-I-RATE-CODE               PIC X(4).
  4102         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4103         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4104         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4105         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4106         16  PB-I-BANK-NOCHRGB            PIC 99.
  4107         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4108         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4109
  4110     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4111         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4112             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4113         16  PB-C-CANCEL-ORIGIN           PIC X.
  4114             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4115         16  PB-C-LF-CANCEL-DT            PIC XX.
  4116         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4117         16  PB-C-LF-CALC-REQ             PIC X.
  4118             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4119         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4120         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4121         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4122             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4123         16  PB-C-AH-CANCEL-DT            PIC XX.
  4124         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4125         16  PB-C-AH-CALC-REQ             PIC X.
  4126             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4127         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4128         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4129         16  PB-C-LAST-NAME               PIC X(15).
  4130         16  PB-C-REFUND-SW               PIC X.
  4131             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4132             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4133         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4134         16  PB-C-PAYEE-CODE              PIC X(6).
  4135         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4136         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4137         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4138         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4139         16  PB-C-REFERENCE               PIC X(12).
  4140         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4141         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4142         16  PB-C-POST-CARD-IND           PIC X.
  4143         16  PB-C-CANCEL-REASON           PIC X.
  4144         16  PB-C-REF-INTERFACE-SW        PIC X.
  4145         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4146         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  78
* EL050.cbl
  4147         16  FILLER                       PIC X(01).
  4148*        16  FILLER                       PIC X(18).
  4149         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4150*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4151         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4152         16  PB-CANCELED-CERT-DATA.
  4153             20  PB-CI-INSURED-NAME.
  4154                 24  PB-CI-LAST-NAME      PIC X(15).
  4155                 24  PB-CI-INITIALS       PIC XX.
  4156             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4157             20  PB-CI-INSURED-SEX        PIC X.
  4158             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4159             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4160             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4161             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4162             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4163             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4164             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4165             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4166             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4167             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4168             20  PB-CI-RATE-CLASS         PIC XX.
  4169             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4170             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4171             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4172             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4173             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4174             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4175             20  PB-CI-LF-ABBR            PIC X(3).
  4176             20  PB-CI-AH-ABBR            PIC X(3).
  4177             20  PB-CI-OB-FLAG            PIC X.
  4178                 88  PB-CI-OB                VALUE 'B'.
  4179             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4180                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4181                                           'M' '4' '5' '9' '2'.
  4182                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4183                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4184                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4185                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4186                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4187                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4188                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4189                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4190                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4191                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4192                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4193                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4194             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4195                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4196                                           'M' '4' '5' '9' '2'.
  4197                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4198                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4199                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4200                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4201                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4202                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4203                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4204                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  79
* EL050.cbl
  4205                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4206                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4207                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4208                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4209             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4210             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4211             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4212             20  PB-CI-MEMBER-NO          PIC X(12).
  4213             20  PB-CI-INT-CODE           PIC X.
  4214                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4215                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4216             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4217             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4218             20  PB-CI-COMP-EXCP-SW       PIC X.
  4219                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4220                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4221             20  PB-CI-ENTRY-STATUS       PIC X.
  4222             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4223             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4224             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4225             20  PB-CI-DEATH-DT           PIC XX.
  4226             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4227             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4228             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4229             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4230             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4231             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4232             20  PB-CI-ENTRY-DT              PIC XX.
  4233             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4234             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4235             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4236             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4237             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4238             20  PB-CI-OLD-LOF               PIC XXX.
  4239*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4240             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4241             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4242             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4243             20  PB-CI-INDV-GRP-CD           PIC X.
  4244             20  PB-CI-BENEFICIARY-NAME.
  4245                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4246                 24  FILLER                  PIC X(15).
  4247             20  PB-CI-NOTE-SW               PIC X.
  4248             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4249             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4250             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4251             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4252             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4253             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4254             20  PB-CI-FIRST-NAME            PIC X(10).
  4255             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4256
  4257         16  FILLER                       PIC X(13).
  4258*032306  16  FILLER                       PIC X(27).
  4259*        16  FILLER                       PIC X(46).
  4260
  4261     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4262         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  80
* EL050.cbl
  4263         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4264         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4265         16  PB-M-INSURED-MID-INIT        PIC X.
  4266         16  PB-M-INSURED-AGE             PIC 99.
  4267         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4268         16  PB-M-INSURED-SEX             PIC X.
  4269         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4270         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4271         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4272         16  PB-M-INSURED-CITY-STATE.
  4273             20  PB-M-INSURED-CITY        PIC X(28).
  4274             20  PB-M-INSURED-STATE       PIC XX.
  4275         16  PB-M-INSURED-ZIP-CODE.
  4276             20  PB-M-INSURED-ZIP-PRIME.
  4277                 24  PB-M-INSURED-ZIP-1   PIC X.
  4278                     88  PB-M-CANADIAN-POST-CODE
  4279                                             VALUE 'A' THRU 'Z'.
  4280                 24  FILLER               PIC X(4).
  4281             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4282         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4283                                        PB-M-INSURED-ZIP-CODE.
  4284             20  PM-M-INS-CAN-POST1       PIC XXX.
  4285             20  PM-M-INS-CAN-POST2       PIC XXX.
  4286             20  FILLER                   PIC XXX.
  4287         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4288         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4289         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4290         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4291         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4292         16  PB-M-CRED-BENE-CITYST.
  4293             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4294             20  PB-M-CRED-BENE-STATE     PIC XX.
  4295         16  FILLER                       PIC X(92).
  4296
  4297     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4298         16  FILLER                       PIC X(10).
  4299         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4300         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4301         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4302         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4303         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4304         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4305         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4306         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4307         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4308         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4309         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4310         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4311         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4312         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4313         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4314         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4315         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4316         16  PB-ACCOUNT-NAME              PIC X(30).
  4317         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4318         16  PB-REFERENCE                 PIC X(12).
  4319         16  PB-B-RECEIVED-DT             PIC XX.
  4320         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  81
* EL050.cbl
  4321
  4322     12  PB-RECORD-STATUS.
  4323         16  PB-CREDIT-SELECT-DT          PIC XX.
  4324         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4325         16  PB-BILLED-DT                 PIC XX.
  4326         16  PB-BILLING-STATUS            PIC X.
  4327             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4328             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4329             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4330         16  PB-RECORD-BILL               PIC X.
  4331             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4332             88  PB-RECORD-RETURNED           VALUE 'R'.
  4333             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4334             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4335             88  PB-OVERRIDE-AH               VALUE 'A'.
  4336             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4337         16  PB-BATCH-ENTRY               PIC X.
  4338             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4339             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4340             88  PB-REISSUED-CERT             VALUE 'E'.
  4341             88  PB-MONTHLY-CERT              VALUE 'M'.
  4342             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4343             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4344             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4345         16  PB-FORCE-CODE                PIC X.
  4346             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4347             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4348             88  PB-CANCEL-FORCE              VALUE '8'.
  4349             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4350             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4351             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4352             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4353             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4354             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4355             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4356         16  PB-FATAL-FLAG                PIC X.
  4357             88  PB-FATAL-ERRORS              VALUE 'X'.
  4358         16  PB-FORCE-ER-CD               PIC X.
  4359             88  PB-FORCE-ERRORS              VALUE 'F'.
  4360             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4361         16  PB-WARN-ER-CD                PIC X.
  4362             88  PB-WARNING-ERRORS            VALUE 'W'.
  4363         16  FILLER                       PIC X.
  4364         16  PB-OUT-BAL-CD                PIC X.
  4365             88  PB-OUT-OF-BAL                VALUE 'O'.
  4366         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4367         16  PB-AH-OVERRIDE-L1            PIC X.
  4368         16  PB-INPUT-DT                  PIC XX.
  4369         16  PB-INPUT-BY                  PIC X(4).
  4370         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4371         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4372         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4373         16  PB-LF-EARNING-METHOD         PIC X.
  4374         16  PB-AH-EARNING-METHOD         PIC X.
  4375         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4376         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4377         16  PB-REIN-CD                   PIC XXX.
  4378         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  82
* EL050.cbl
  4379         16  PB-AH-REFUND-TYPE            PIC X.
  4380         16  PB-ACCT-EFF-DT               PIC XX.
  4381         16  PB-ACCT-EXP-DT               PIC XX.
  4382         16  PB-COMPANY-ID                PIC X(3).
  4383         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4384         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4385         16  PB-SV-CARRIER                PIC X.
  4386         16  PB-SV-GROUPING               PIC X(6).
  4387         16  PB-SV-STATE                  PIC XX.
  4388         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4389         16  PB-GA-BILLING-INFO.
  4390             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4391                                          PIC XX.
  4392         16  PB-SV-REMIT-TO  REDEFINES
  4393             PB-GA-BILLING-INFO           PIC X(10).
  4394         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4395         16  PB-I-LOAN-OFFICER            PIC X(5).
  4396         16  PB-I-VIN                     PIC X(17).
  4397
  4398         16  FILLER                       PIC X(04).
  4399         16  IMNET-BYPASS-SW              PIC X.
  4400
  4401******************************************************************
  4402*                COMMON EDIT ERRORS                              *
  4403******************************************************************
  4404
  4405     12  PB-COMMON-ERRORS.
  4406         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4407                                           PIC S9(4)     COMP.
  4408
  4409******************************************************************
  4410
  4411* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4412*    COPY ELC50W1.
  4413******************************************************************
  4414*                                                                *
  4415*                                                                *
  4416*                             ELC50W1                            *
  4417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4418*                            VMOD=2.004                          *
  4419*                                                                *
  4420*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4421*                                                                *
  4422*                                                                *
  4423******************************************************************
  4424
  4425     12  WK-WORK-AREA.
  4426         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4427         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4428         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4429         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4430         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4431         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4432         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4433         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4434         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4435         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4436         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  83
* EL050.cbl
  4437         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4438         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4439         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4440         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4441         16  WK-CREDIT-EDIT-CONTROLS.
  4442             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4443             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4444             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4445             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4446             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4447             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4448         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4449         16  WK-SAVE-REIN-DATA.
  4450             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4451             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4452             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4453         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4454             88  ENTRY-FROM-EL6311       VALUE '6'.
  4455         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4456         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4457     12  WK-RECORD-ADDRESSES.
  4458         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4459         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4460         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4461         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4462         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4463         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4464         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4465         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4466     12  WK-OVER-SHORT-AREA.
  4467         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4468         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4469         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4470             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4471         16  FILLER                   PIC X(5) VALUE SPACES.
  4472
  4473*    COPY ELCEDITC.
  4474******************************************************************
  4475*                                                                *
  4476*                                                                *
  4477*                            ELCEDITC                            *
  4478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4479*                            VMOD=2.012                          *
  4480*                                                                *
  4481*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4482*                     EL6313, EL050 AND EL517.                   *
  4483*                                                                *
  4484******************************************************************
  4485******************************************************************
  4486*                   C H A N G E   L O G
  4487*
  4488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4489*-----------------------------------------------------------------
  4490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4491* EFFECTIVE    NUMBER
  4492*-----------------------------------------------------------------
  4493* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4494******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  84
* EL050.cbl
  4495
  4496     12  EDIT-CRITERIA-DATA.
  4497         16  EC-CO-MONTH-END-DT       PIC XX.
  4498         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4499         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4500         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4501         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4502         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4503         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4504         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4505         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4506         16  EC-CO-REM-TERM-CALC      PIC X.
  4507               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4508               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4509               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4510               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4511
  4512         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4513               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4514               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4515               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4516               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4517               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4518               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4519               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4520               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4521               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4522               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4523
  4524         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4525               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4526               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4527               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4528               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4529               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4530               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4531               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4532               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4533
  4534         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4535                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4536                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4537
  4538         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4539                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4540                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4541                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4542                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4543                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4544                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4545                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4546                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4547
  4548         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4549               88  EC-BR-REDUCING                   VALUE 'R'.
  4550               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4551
  4552         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  85
* EL050.cbl
  4553         16  EC-BR-LF-DESC             PIC X(10).
  4554         16  EC-BR-AH-DESC             PIC X(10).
  4555         16  EC-BR-LF-COMMENT          PIC X(10).
  4556         16  EC-BR-AH-COMMENT          PIC X(10).
  4557
  4558         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4559               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4560               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4561               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4562               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4563
  4564         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4565               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4566               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4567               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4568               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4569
  4570         16  EC-BR-LF-REFUND-CALC      PIC X.
  4571                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4572                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4573                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4574                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4575                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4576                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4577                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4578
  4579         16  EC-BR-AH-REFUND-CALC      PIC X.
  4580                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4581                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4582                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4583                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4584                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4585                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4586                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4587                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4588
  4589         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4590                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4591                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4592                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4593
  4594         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4595                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4596                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4597                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4598
  4599         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4600         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4601         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4602         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4603
  4604         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4605         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4606                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4607                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4608                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4609                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4610
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  86
* EL050.cbl
  4611         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4612               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4613               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4614               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4615               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4616               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4617
  4618         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4619               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4620               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4621               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4622               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4623               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4624
  4625         16  EC-ST-LF-REFUND-CALC      PIC X.
  4626                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4627                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4628                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4629                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4630                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4631                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4632                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4633                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4634
  4635         16  EC-ST-AH-REFUND-CALC      PIC X.
  4636                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4637                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4638                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4639                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4640                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4641                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4642                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4643                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4644
  4645         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4646         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4647         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4648         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4649         16  EC-AM-EXPIRATION-DT       PIC XX.
  4650         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4651         16  EC-AM-CLASS-CD            PIC XX.
  4652         16  EC-AM-LF-DEVIATION        PIC XXX.
  4653         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4654         16  EC-AM-AH-DEVIATION        PIC XXX.
  4655         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4656         16  EC-AM-PHONE-NO            PIC X(10).
  4657
  4658         16  EC-AM-LF-REFUND-CALC      PIC X.
  4659                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4662                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4663                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4664                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4665                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4666
  4667         16  EC-AM-AH-REFUND-CALC      PIC X.
  4668                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  87
* EL050.cbl
  4669                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4670                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4671                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4672                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4673                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4674                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4675
  4676         16  EC-AM-BEN-I-G-CD          PIC X.
  4677                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4678                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4679                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4680
  4681         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4682         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4683         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4684         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4685         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4686         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4687         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4688         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4689         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4690
  4691         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4692         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4693         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4694         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4695         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4696         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4697         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4698         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4699         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4700         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4701         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4702         16  EC-RT-LF-NSP-ST           PIC XX.
  4703         16  EC-RT-AH-NSP-ST           PIC XX.
  4704         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4705         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4706
  4707         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4708             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4709                                             'M' '5' '9' '2'.
  4710             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4711             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4712             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4713             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4714             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4715             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4716             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4717             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4718             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4719             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4720
  4721         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4722             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4723                                             'M' '5' '9' '2'.
  4724             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4725             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4726             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  88
* EL050.cbl
  4727             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4728             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4729             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4730             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4731             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4732             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4733             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4734
  4735         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4736         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4737         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4738         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4739         16  EC-CM-DEATH-DT            PIC XX.
  4740
  4741*DMD CUSTOM CODING FIELDS BELOW
  4742*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4743         16  EC-BR-DMD-RATING-SW       PIC X.
  4744                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4745                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4746                 88  NO-DMD-RATING               VALUE 'N'.
  4747
  4748         16  EC-NEW-CERT               PIC X(11).
  4749         16  EC-NEW-STATE              PIC XX.
  4750         16  FILLER                    PIC X.
  4751*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4752         16  OVER-SHORT-EDIT-FIELDS.
  4753             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4754             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4755             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4756             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4757             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4758             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4759             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4760             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4761             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4762         16  FILLER                    PIC X(71).
  4763******************************************************************
  4764
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  89
* EL050.cbl
  4766*    COPY ELCDIFRD.
  4767******************************************************************
  4768*                                                                *
  4769*                                                                *
  4770*                            ELCDIFRD.                           *
  4771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4772*                            VMOD=2.004                          *
  4773*                                                                *
  4774*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4775*                                                                *
  4776******************************************************************
  4777*
  4778  01  WS-DIFFERENCE-CALCULATION.
  4779        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4780        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4781        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4782        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4783        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4784        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4785        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4786        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4787        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4788        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4789        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4790
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  90
* EL050.cbl
  4792****************************************************************
  4793*
  4794* Copyright (c) 2007 by Clerity Solutions, Inc.
  4795* All rights reserved.
  4796*
  4797****************************************************************
  4798 01  DFHEIV.
  4799   02  DFHEIV0               PIC X(35).
  4800   02  DFHEIV1               PIC X(08).
  4801   02  DFHEIV2               PIC X(08).
  4802   02  DFHEIV3               PIC X(08).
  4803   02  DFHEIV4               PIC X(06).
  4804   02  DFHEIV5               PIC X(04).
  4805   02  DFHEIV6               PIC X(04).
  4806   02  DFHEIV7               PIC X(02).
  4807   02  DFHEIV8               PIC X(02).
  4808   02  DFHEIV9               PIC X(01).
  4809   02  DFHEIV10              PIC S9(7) COMP-3.
  4810   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4811   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4812   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4813   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4814   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4815   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4816   02  DFHEIV17              PIC X(04).
  4817   02  DFHEIV18              PIC X(04).
  4818   02  DFHEIV19              PIC X(04).
  4819   02  DFHEIV20              USAGE IS POINTER.
  4820   02  DFHEIV21              USAGE IS POINTER.
  4821   02  DFHEIV22              USAGE IS POINTER.
  4822   02  DFHEIV23              USAGE IS POINTER.
  4823   02  DFHEIV24              USAGE IS POINTER.
  4824   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4825   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4826   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4827   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4828   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4829   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4830   02  FILLER                PIC X(02).
  4831   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4832   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4833   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4834   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4835   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4836 LINKAGE  SECTION.
  4837*****************************************************************
  4838*                                                               *
  4839* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4840* All rights reserved.                                          *
  4841*                                                               *
  4842*****************************************************************
  4843 01  dfheiblk.
  4844     02  eibtime          pic s9(7) comp-3.
  4845     02  eibdate          pic s9(7) comp-3.
  4846     02  eibtrnid         pic x(4).
  4847     02  eibtaskn         pic s9(7) comp-3.
  4848     02  eibtrmid         pic x(4).
  4849     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  91
* EL050.cbl
  4850     02  eibcposn         pic s9(4) comp.
  4851     02  eibcalen         pic s9(4) comp.
  4852     02  eibaid           pic x(1).
  4853     02  eibfiller1       pic x(1).
  4854     02  eibfn            pic x(2).
  4855     02  eibfiller2       pic x(2).
  4856     02  eibrcode         pic x(6).
  4857     02  eibfiller3       pic x(2).
  4858     02  eibds            pic x(8).
  4859     02  eibreqid         pic x(8).
  4860     02  eibrsrce         pic x(8).
  4861     02  eibsync          pic x(1).
  4862     02  eibfree          pic x(1).
  4863     02  eibrecv          pic x(1).
  4864     02  eibsend          pic x(1).
  4865     02  eibatt           pic x(1).
  4866     02  eibeoc           pic x(1).
  4867     02  eibfmh           pic x(1).
  4868     02  eibcompl         pic x(1).
  4869     02  eibsig           pic x(1).
  4870     02  eibconf          pic x(1).
  4871     02  eiberr           pic x(1).
  4872     02  eibrldbk         pic x(1).
  4873     02  eiberrcd         pic x(4).
  4874     02  eibsynrb         pic x(1).
  4875     02  eibnodat         pic x(1).
  4876     02  eibfiller5       pic x(2).
  4877     02  eibresp          pic 9(09) comp.
  4878     02  eibresp2         pic 9(09) comp.
  4879     02  dfheigdj         pic s9(4) comp.
  4880     02  dfheigdk         pic s9(4) comp.
  4881
  4882 01  DFHCOMMAREA                   PIC X(1036).
  4883
  4884*01 PARMLIST .
  4885*    02  FILLER                    PIC S9(8)   COMP.
  4886*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4887*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4888*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4889*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4890*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4891*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4892*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4893
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  92
* EL050.cbl
  4895*    COPY ELCCNTL.
  4896******************************************************************
  4897*                                                                *
  4898*                                                                *
  4899*                            ELCCNTL.                            *
  4900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4901*                            VMOD=2.059                          *
  4902*                                                                *
  4903*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4904*                                                                *
  4905*   FILE TYPE = VSAM,KSDS                                        *
  4906*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4907*                                                                *
  4908*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4909*       ALTERNATE INDEX = NONE                                   *
  4910*                                                                *
  4911*   LOG = YES                                                    *
  4912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4913******************************************************************
  4914*                   C H A N G E   L O G
  4915*
  4916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4917*-----------------------------------------------------------------
  4918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4919* EFFECTIVE    NUMBER
  4920*-----------------------------------------------------------------
  4921* 082503                   PEMA  ADD BENEFIT GROUP
  4922* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4923* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4924* 092705    2005050300006  PEMA  ADD SPP LEASES
  4925* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4926* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4927* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4928* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4929* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4930* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4931******************************************************************
  4932*
  4933 01  CONTROL-FILE.
  4934     12  CF-RECORD-ID                       PIC XX.
  4935         88  VALID-CF-ID                        VALUE 'CF'.
  4936
  4937     12  CF-CONTROL-PRIMARY.
  4938         16  CF-COMPANY-ID                  PIC XXX.
  4939         16  CF-RECORD-TYPE                 PIC X.
  4940             88  CF-COMPANY-MASTER              VALUE '1'.
  4941             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4942             88  CF-STATE-MASTER                VALUE '3'.
  4943             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4944             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4945             88  CF-CARRIER-MASTER              VALUE '6'.
  4946             88  CF-MORTALITY-MASTER            VALUE '7'.
  4947             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4948             88  CF-TERMINAL-MASTER             VALUE '9'.
  4949             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4950             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4951             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4952             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  93
* EL050.cbl
  4953             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4954             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4955             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4956             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4957             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4958         16  CF-ACCESS-CD-GENL              PIC X(4).
  4959         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4960             20  CF-PROCESSOR               PIC X(4).
  4961         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4962             20  CF-STATE-CODE              PIC XX.
  4963             20  FILLER                     PIC XX.
  4964         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4965             20  FILLER                     PIC XX.
  4966             20  CF-HI-BEN-IN-REC           PIC XX.
  4967         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4968             20  FILLER                     PIC XXX.
  4969             20  CF-CARRIER-CNTL            PIC X.
  4970         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4971             20  FILLER                     PIC XX.
  4972             20  CF-HI-TYPE-IN-REC          PIC 99.
  4973         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4974             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4975                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4976             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4977             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4978         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4979             20  FILLER                     PIC X.
  4980             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4981         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4982             20  FILLER                     PIC XX.
  4983             20  CF-MORTGAGE-PLAN           PIC XX.
  4984         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4985
  4986     12  CF-LAST-MAINT-DT                   PIC XX.
  4987     12  CF-LAST-MAINT-BY                   PIC X(4).
  4988     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4989
  4990     12  CF-RECORD-BODY                     PIC X(728).
  4991
  4992
  4993****************************************************************
  4994*             COMPANY MASTER RECORD                            *
  4995****************************************************************
  4996
  4997     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4998         16  CF-COMPANY-ADDRESS.
  4999             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5000             20  CF-CL-IN-CARE-OF           PIC X(30).
  5001             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5002             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5003             20  CF-CL-CITY-STATE           PIC X(30).
  5004             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5005             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5006         16  CF-COMPANY-CD                  PIC X.
  5007         16  CF-COMPANY-PASSWORD            PIC X(8).
  5008         16  CF-SECURITY-OPTION             PIC X.
  5009             88  ALL-SECURITY                   VALUE '1'.
  5010             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  94
* EL050.cbl
  5011             88  PROCESSOR-VERIFY               VALUE '3'.
  5012             88  NO-SECURITY                    VALUE '4'.
  5013             88  ALL-BUT-TERM                   VALUE '5'.
  5014         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5015             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5016         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5017             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5018         16  CF-INFORCE-LOCATION            PIC X.
  5019             88  CERTS-ARE-ONLINE               VALUE '1'.
  5020             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5021             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5022         16  CF-LOWER-CASE-LETTERS          PIC X.
  5023         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5024             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5025             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5026             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5027             88  CF-ACCNT-CNTL                  VALUE '3'.
  5028             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5029
  5030         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5031         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5032
  5033         16  CF-LGX-CREDIT-USER             PIC X.
  5034             88  CO-IS-NOT-USER                 VALUE 'N'.
  5035             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5036
  5037         16 CF-CREDIT-CALC-CODES.
  5038             20  CF-CR-REM-TERM-CALC PIC X.
  5039               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5040               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5041               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5042               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5043               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5044               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5045               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5046             20  CF-CR-R78-METHOD           PIC X.
  5047               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5048               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5049
  5050         16  CF-CLAIM-CONTROL-COUNTS.
  5051             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5052                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5053
  5054             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5055                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5056
  5057             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5058                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5059
  5060             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5061                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5062
  5063         16  CF-CURRENT-MONTH-END           PIC XX.
  5064
  5065         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5066             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5067             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5068             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  95
* EL050.cbl
  5069             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5070                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5071                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5072             20  CF-CO-PREM-REJECT-SW       PIC X.
  5073                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5074                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5075             20  CF-CO-REF-REJECT-SW        PIC X.
  5076                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5077                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5078
  5079         16  CF-CO-REPORTING-DT             PIC XX.
  5080         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5081         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5082           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5083           88  CF-CO-MONTH-END                  VALUE '1'.
  5084
  5085         16  CF-LGX-CLAIM-USER              PIC X.
  5086             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5087             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5088
  5089         16  CF-CREDIT-EDIT-CONTROLS.
  5090             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5091             20  CF-MIN-AGE                 PIC 99.
  5092             20  CF-DEFAULT-AGE             PIC 99.
  5093             20  CF-MIN-TERM                PIC S999      COMP-3.
  5094             20  CF-MAX-TERM                PIC S999      COMP-3.
  5095             20  CF-DEFAULT-SEX             PIC X.
  5096             20  CF-JOINT-AGE-INPUT         PIC X.
  5097                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5098             20  CF-BIRTH-DATE-INPUT        PIC X.
  5099                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5100             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5101                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5102                 88  CF-ZERO-CARRIER            VALUE '1'.
  5103                 88  CF-ZERO-GROUPING           VALUE '2'.
  5104                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5105             20  CF-EDIT-SW                 PIC X.
  5106                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5107             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5108             20  CF-CR-PR-METHOD            PIC X.
  5109               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5110               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5111             20  FILLER                     PIC X.
  5112
  5113         16  CF-CREDIT-MISC-CONTROLS.
  5114             20  CF-REIN-TABLE-SW           PIC X.
  5115                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5116             20  CF-COMP-TABLE-SW           PIC X.
  5117                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5118             20  CF-EXPERIENCE-RETENTION-AGE
  5119                                            PIC S9        COMP-3.
  5120             20  CF-CONVERSION-DT           PIC XX.
  5121             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5122             20  CF-RUN-FREQUENCY-SW        PIC X.
  5123                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5124                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5125
  5126             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  96
* EL050.cbl
  5127                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5128                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5129                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5130                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5131                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5132                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5133
  5134                 24  CF-CR-CHECK-COUNT       REDEFINES
  5135                     CF-CR-CHECK-COUNTER      PIC X(4).
  5136
  5137                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5138                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5139
  5140                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5141                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5142                 24  CF-MAIL-PROCESSING       PIC X.
  5143                     88  MAIL-PROCESSING          VALUE 'Y'.
  5144
  5145         16  CF-MISC-SYSTEM-CONTROL.
  5146             20  CF-SYSTEM-C                 PIC X.
  5147                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5148             20  CF-SYSTEM-D                 PIC X.
  5149                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5150             20  CF-SOC-SEC-NO-SW            PIC X.
  5151                 88  SOC-SEC-NO-USED             VALUE '1'.
  5152             20  CF-MEMBER-NO-SW             PIC X.
  5153                 88  MEMBER-NO-USED              VALUE '1'.
  5154             20  CF-TAX-ID-NUMBER            PIC X(11).
  5155             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5156             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5157                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5158                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5159                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5160                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5161             20  CF-SYSTEM-E                 PIC X.
  5162                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5163
  5164         16  CF-LGX-LIFE-USER               PIC X.
  5165             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5166             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5167
  5168         16  CF-CR-MONTH-END-DT             PIC XX.
  5169
  5170         16  CF-FILE-MAINT-DATES.
  5171             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5172                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5173             20  CF-LAST-BATCH       REDEFINES
  5174                 CF-LAST-BATCH-NO               PIC X(4).
  5175             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5176             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5177             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5178             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5179             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5180             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5181             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5182             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5183             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5184             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  97
* EL050.cbl
  5185
  5186         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5187         16  FILLER                         PIC X.
  5188
  5189         16  CF-ALT-MORT-CODE               PIC X(4).
  5190         16  CF-MEMBER-CAPTION              PIC X(10).
  5191
  5192         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5193             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5194             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5195             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5196             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5197             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5198
  5199         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5200
  5201         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5202         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5203         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5204         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5205
  5206         16  CF-AH-OVERRIDE-L1              PIC X.
  5207         16  CF-AH-OVERRIDE-L2              PIC XX.
  5208         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5209         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5210
  5211         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5212         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5213
  5214         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5215         16  CF-AR-LAST-EL860-DT            PIC XX.
  5216         16  CF-MP-MONTH-END-DT             PIC XX.
  5217
  5218         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5219         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5220             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5221
  5222         16  CF-AR-MONTH-END-DT             PIC XX.
  5223
  5224         16  CF-CRDTCRD-USER                PIC X.
  5225             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5227
  5228         16  CF-CC-MONTH-END-DT             PIC XX.
  5229
  5230         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5231
  5232         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5233             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5234             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5235             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5236         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5237         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5238         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5239         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5240             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5241             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5242         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  98
* EL050.cbl
  5243         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5244         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5245             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5246         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5247
  5248         16  CF-CL-ZIP-CODE.
  5249             20  CF-CL-ZIP-PRIME.
  5250                 24  CF-CL-ZIP-1ST          PIC X.
  5251                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5252                 24  FILLER                 PIC X(4).
  5253             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5254         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5255             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5256             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5257             20  FILLER                     PIC XXX.
  5258
  5259         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5260         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5261         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5262         16  CF-CO-OPTION-START-DATE        PIC XX.
  5263         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5264           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5265                                                      '3' '4'.
  5266           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5267           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5268           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5269           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5270           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5271           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5272
  5273         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5274
  5275         16  CF-PAYMENT-APPROVAL-LEVELS.
  5276             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5277             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5278             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5279             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5280             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5281             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5282
  5283         16  CF-END-USER-REPORTING-USER     PIC X.
  5284             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5285             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5286
  5287         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5288             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5289             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5292
  5293         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5294         16  FILLER                         PIC X.
  5295
  5296         16  CF-CREDIT-ARCHIVE-CNTL.
  5297             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5298             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5299             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5300
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page  99
* EL050.cbl
  5301         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5302
  5303         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5304             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5305             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5306
  5307         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5308             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5309             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5310
  5311         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5312
  5313         16  CF-CO-ACH-ID-CODE              PIC  X.
  5314             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5315             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5316             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5317         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5318         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5319         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5320         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5321         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5322         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5323         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5324         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5325         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5326                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5327         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5328                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5329
  5330         16  CF-CO-OVER-SHORT.
  5331             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5332             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5333
  5334*         16  FILLER                         PIC X(102).
  5335         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5336             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5337             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5338
  5339         16  CF-AH-APPROVAL-DAYS.
  5340             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5341             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5342             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5343             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5344
  5345         16  FILLER                         PIC X(82).
  5346****************************************************************
  5347*             PROCESSOR/USER RECORD                            *
  5348****************************************************************
  5349
  5350     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5351         16  CF-PROCESSOR-NAME              PIC X(30).
  5352         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5353         16  CF-PROCESSOR-TITLE             PIC X(26).
  5354         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5355                 88  MESSAGE-YES                VALUE 'Y'.
  5356                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5357
  5358*****************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 100
* EL050.cbl
  5359****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5360****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5361****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5362****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5363*****************************************************
  5364
  5365         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5366             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5367             20  CF-APPLICATION-FORCE       PIC X.
  5368             20  CF-INDIVIDUAL-APP.
  5369                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5370                     28  CF-BROWSE-APP      PIC X.
  5371                     28  CF-UPDATE-APP      PIC X.
  5372
  5373         16  CF-CURRENT-TERM-ON             PIC X(4).
  5374         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5375             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5376             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5377             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5378             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5379             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5380             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5381             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5382         16  CF-PROCESSOR-CARRIER           PIC X.
  5383             88  NO-CARRIER-SECURITY            VALUE ' '.
  5384         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5385             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5386         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5387             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5388         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5389             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5390
  5391         16  CF-PROC-SYS-ACCESS-SW.
  5392             20  CF-PROC-CREDIT-CLAIMS-SW.
  5393                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5394                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5395                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5396                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5397             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5398                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5399                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5400             20  CF-PROC-LIFE-GNRLDGR-SW.
  5401                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5402                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5403                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5404                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5405             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5406                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5407                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5408         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5409             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5410             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5411         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5412
  5413         16  CF-APPROVAL-LEVEL                  PIC X.
  5414             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5415             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5416             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 101
* EL050.cbl
  5417             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5418
  5419         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5420
  5421         16  CF-LANGUAGE-TYPE                   PIC X.
  5422             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5423             88  CF-LANG-IS-FR                      VALUE 'F'.
  5424
  5425         16  CF-CSR-IND                         PIC X.
  5426         16  FILLER                             PIC X(239).
  5427
  5428****************************************************************
  5429*             PROCESSOR/REMINDERS RECORD                       *
  5430****************************************************************
  5431
  5432     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5433         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5434             20  CF-START-REMIND-DT         PIC XX.
  5435             20  CF-END-REMIND-DT           PIC XX.
  5436             20  CF-REMINDER-TEXT           PIC X(50).
  5437         16  FILLER                         PIC X(296).
  5438
  5439
  5440****************************************************************
  5441*             STATE MASTER RECORD                              *
  5442****************************************************************
  5443
  5444     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5445         16  CF-STATE-ABBREVIATION          PIC XX.
  5446         16  CF-STATE-NAME                  PIC X(25).
  5447         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5448         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5449             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5450             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5451             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5452             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5453                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5454                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5455             20  CF-ST-PREM-REJECT-SW       PIC X.
  5456                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5457                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5458             20  CF-ST-REF-REJECT-SW        PIC X.
  5459                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5460                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5461         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5462         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5463         16  CF-ST-REFUND-RULES.
  5464             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5465             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5466             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5467         16  CF-ST-FST-PMT-EXTENSION.
  5468             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5469             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5470                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5471                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5472                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5473                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5474         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 102
* EL050.cbl
  5475             20  CF-ST-CALL-UNEARNED        PIC X.
  5476             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5477             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5478         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5479             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5480             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5481         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5482         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5483         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5484         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5485         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5486         16  FILLER                         PIC X.
  5487         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5488             20  CF-ST-BENEFIT-CD           PIC XX.
  5489             20  CF-ST-BENEFIT-KIND         PIC X.
  5490                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5491                 88  CF-ST-AH-KIND              VALUE 'A'.
  5492             20  CF-ST-REM-TERM-CALC        PIC X.
  5493                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5494                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5495                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5496                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5497                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5498                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5499                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5500                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5501
  5502             20  CF-ST-REFUND-CALC          PIC X.
  5503                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5504                 88  ST-REFD-BY-R78             VALUE '1'.
  5505                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5506                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5507                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5508                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5509                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5510                 88  ST-REFD-UTAH               VALUE '7'.
  5511                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5512                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5513                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5514
  5515             20  CF-ST-EARNING-CALC         PIC X.
  5516                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5517                 88  ST-EARN-BY-R78             VALUE '1'.
  5518                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5519                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5520                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5521                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5522                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5523                 88  ST-EARN-MEAN               VALUE '8'.
  5524                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5525
  5526             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5527                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5528                 88  ST-OVRD-BY-R78             VALUE '1'.
  5529                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5530                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5531                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5532                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 103
* EL050.cbl
  5533                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5534                 88  ST-OVRD-MEAN               VALUE '8'.
  5535                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5536             20  FILLER                     PIC X.
  5537
  5538         16  CF-ST-COMMISSION-CAPS.
  5539             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5540             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5541             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5542             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5543         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5544                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5545
  5546         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5547
  5548         16  CF-ST-STATUTORY-INTEREST.
  5549             20  CF-ST-STAT-DATE-FROM       PIC X.
  5550                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5551                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5552             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5553             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5554             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5555             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5556             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5557
  5558         16  CF-ST-OVER-SHORT.
  5559             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5560             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5561
  5562         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5563
  5564         16  CF-ST-RT-CALC                  PIC X.
  5565
  5566         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5567         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5568         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5569         16  CF-ST-RF-LR-CALC               PIC X.
  5570         16  CF-ST-RF-LL-CALC               PIC X.
  5571         16  CF-ST-RF-LN-CALC               PIC X.
  5572         16  CF-ST-RF-AH-CALC               PIC X.
  5573         16  CF-ST-RF-CP-CALC               PIC X.
  5574*        16  FILLER                         PIC X(206).
  5575*CIDMOD         16  FILLER                         PIC X(192).
  5576         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5577             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5578         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5579         16  CF-ST-VFY-2ND-BENE             PIC X.
  5580         16  FILLER                         PIC X(186).
  5581
  5582****************************************************************
  5583*             BENEFIT MASTER RECORD                            *
  5584****************************************************************
  5585
  5586     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5587         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5588             20  CF-BENEFIT-CODE            PIC XX.
  5589             20  CF-BENEFIT-NUMERIC  REDEFINES
  5590                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 104
* EL050.cbl
  5591             20  CF-BENEFIT-ALPHA           PIC XXX.
  5592             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5593             20  CF-BENEFIT-COMMENT         PIC X(10).
  5594
  5595             20  CF-LF-COVERAGE-TYPE        PIC X.
  5596                 88  CF-REDUCING                VALUE 'R'.
  5597                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5598
  5599             20  CF-SPECIAL-CALC-CD         PIC X.
  5600                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5601                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5602                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5603                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5604                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5605                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5606                 88  CF-FARM-PLAN               VALUE 'F'.
  5607                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5608                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5609                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5610                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5611                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5612                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5613                 88  CF-PRUDENTIAL              VALUE 'P'.
  5614                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5615                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5616                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5617                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5618                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5619                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5620
  5621             20  CF-JOINT-INDICATOR         PIC X.
  5622                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5623
  5624*            20  FILLER                     PIC X(12).
  5625             20  FILLER                     PIC X(11).
  5626             20  CF-BENEFIT-CATEGORY        PIC X.
  5627             20  CF-LOAN-TYPE               PIC X(8).
  5628
  5629             20  CF-CO-REM-TERM-CALC        PIC X.
  5630                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5631                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5632                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5633                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5634                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5635
  5636             20  CF-CO-EARNINGS-CALC        PIC X.
  5637                 88  CO-EARN-BY-R78             VALUE '1'.
  5638                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5639                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5640                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5641                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5642                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5643                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5644                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5645
  5646             20  CF-CO-REFUND-CALC          PIC X.
  5647                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5648                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 105
* EL050.cbl
  5649                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5650                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5651                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5652                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5653                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5654                 88  CO-REFD-MEAN               VALUE '8'.
  5655                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5656                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5657                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5658
  5659             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5660                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5661                 88  CO-OVRD-BY-R78             VALUE '1'.
  5662                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5663                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5664                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5665                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5666                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5667                 88  CO-OVRD-MEAN               VALUE '8'.
  5668                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5669
  5670             20  CF-CO-BEN-I-G-CD           PIC X.
  5671                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5672                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5673                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5674
  5675         16  FILLER                         PIC X(304).
  5676
  5677
  5678****************************************************************
  5679*             CARRIER MASTER RECORD                            *
  5680****************************************************************
  5681
  5682     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5683         16  CF-ADDRESS-DATA.
  5684             20  CF-MAIL-TO-NAME            PIC X(30).
  5685             20  CF-IN-CARE-OF              PIC X(30).
  5686             20  CF-ADDRESS-LINE-1          PIC X(30).
  5687             20  CF-ADDRESS-LINE-2          PIC X(30).
  5688             20  CF-CITY-STATE              PIC X(30).
  5689             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5690             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5691
  5692         16  CF-CLAIM-NO-CONTROL.
  5693             20  CF-CLAIM-NO-METHOD         PIC X.
  5694                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5695                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5696                 88  CLAIM-NO-SEQ               VALUE '3'.
  5697                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5698             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5699                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5700                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5701                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5702
  5703         16  CF-CHECK-NO-CONTROL.
  5704             20  CF-CHECK-NO-METHOD         PIC X.
  5705                 88  CHECK-NO-MANUAL            VALUE '1'.
  5706                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 106
* EL050.cbl
  5707                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5708                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5709             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5710                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5711
  5712         16  CF-DOMICILE-STATE              PIC XX.
  5713
  5714         16  CF-EXPENSE-CONTROLS.
  5715             20  CF-EXPENSE-METHOD          PIC X.
  5716                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5717                 88  DOLLARS-PER-PMT            VALUE '2'.
  5718                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5719                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5720             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5721             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5722
  5723         16  CF-CORRESPONDENCE-CONTROL.
  5724             20  CF-LETTER-RESEND-OPT       PIC X.
  5725                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5726                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5727             20  FILLER                     PIC X(4).
  5728
  5729         16  CF-RESERVE-CONTROLS.
  5730             20  CF-MANUAL-SW               PIC X.
  5731                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5732             20  CF-FUTURE-SW               PIC X.
  5733                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5734             20  CF-PTC-SW                  PIC X.
  5735                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5736             20  CF-IBNR-SW                 PIC X.
  5737                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5738             20  CF-PTC-LF-SW               PIC X.
  5739                 88  CF-LF-PTC-USED             VALUE '1'.
  5740             20  CF-CDT-ACCESS-METHOD       PIC X.
  5741                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5742                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5743                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5744             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5745
  5746         16  CF-CLAIM-CALC-METHOD           PIC X.
  5747             88  360-PLUS-MONTHS                VALUE '1'.
  5748             88  365-PLUS-MONTHS                VALUE '2'.
  5749             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5750             88  360-DAILY                      VALUE '4'.
  5751             88  365-DAILY                      VALUE '5'.
  5752
  5753         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5754         16  FILLER                         PIC X(11).
  5755
  5756         16  CF-LIMIT-AMOUNTS.
  5757             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5758             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5759             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5760             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5761             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5762             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5763             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5764             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 107
* EL050.cbl
  5765             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5766             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5767
  5768         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5769         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5770         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5771
  5772         16  CF-ZIP-CODE.
  5773             20  CF-ZIP-PRIME.
  5774                 24  CF-ZIP-1ST             PIC X.
  5775                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5776                 24  FILLER                 PIC X(4).
  5777             20  CF-ZIP-PLUS4               PIC X(4).
  5778         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5779             20  CF-CAN-POSTAL-1            PIC XXX.
  5780             20  CF-CAN-POSTAL-2            PIC XXX.
  5781             20  FILLER                     PIC XXX.
  5782
  5783         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5784         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5785         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5786
  5787         16  CF-RATING-SWITCH               PIC X.
  5788             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5789             88  CF-NO-RATING                   VALUE 'N'.
  5790
  5791         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5792
  5793         16  CF-CARRIER-OVER-SHORT.
  5794             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5795             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5796
  5797         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5798         16  CF-SECPAY-SWITCH               PIC X.
  5799             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5800             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5801         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5802         16  FILLER                         PIC X(448).
  5803*        16  FILLER                         PIC X(452).
  5804
  5805
  5806****************************************************************
  5807*             MORTALITY MASTER RECORD                          *
  5808****************************************************************
  5809
  5810     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5811         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5812                                INDEXED BY CF-MORT-NDX.
  5813             20  CF-MORT-TABLE              PIC X(5).
  5814             20  CF-MORT-TABLE-TYPE         PIC X.
  5815                 88  CF-MORT-JOINT              VALUE 'J'.
  5816                 88  CF-MORT-SINGLE             VALUE 'S'.
  5817                 88  CF-MORT-COMBINED           VALUE 'C'.
  5818                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5819                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5820             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5821             20  CF-MORT-AGE-METHOD         PIC XX.
  5822                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 108
* EL050.cbl
  5823                 88  CF-AGE-NEAR                VALUE 'AN'.
  5824             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5825             20  CF-MORT-ADJUSTMENT-DIRECTION
  5826                                            PIC X.
  5827                 88  CF-MINUS                   VALUE '-'.
  5828                 88  CF-PLUS                    VALUE '+'.
  5829             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5830             20  CF-MORT-JOINT-CODE         PIC X.
  5831                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5832             20  CF-MORT-PC-Q               PIC X.
  5833                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5834             20  CF-MORT-TABLE-CODE         PIC X(4).
  5835             20  CF-MORT-COMMENTS           PIC X(15).
  5836             20  FILLER                     PIC X(14).
  5837
  5838         16  FILLER                         PIC X(251).
  5839
  5840
  5841****************************************************************
  5842*             BUSSINESS TYPE MASTER RECORD                     *
  5843****************************************************************
  5844
  5845     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5846* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5847* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5848* AND RECORD 05 IS TYPES 81-99
  5849         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5850             20  CF-BUSINESS-TITLE          PIC  X(19).
  5851             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5852                                            PIC S9V9(4) COMP-3.
  5853             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5854             20  FILLER                     PIC  X.
  5855         16  FILLER                         PIC  X(248).
  5856
  5857
  5858****************************************************************
  5859*             TERMINAL MASTER RECORD                           *
  5860****************************************************************
  5861
  5862     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5863
  5864         16  CF-COMPANY-TERMINALS.
  5865             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5866                                  PIC X(4).
  5867         16  FILLER               PIC X(248).
  5868
  5869
  5870****************************************************************
  5871*             LIFE EDIT MASTER RECORD                          *
  5872****************************************************************
  5873
  5874     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5875         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5876             20  CF-LIFE-CODE-IN            PIC XX.
  5877             20  CF-LIFE-CODE-OUT           PIC XX.
  5878         16  FILLER                         PIC X(248).
  5879
  5880
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 109
* EL050.cbl
  5881****************************************************************
  5882*             AH EDIT MASTER RECORD                            *
  5883****************************************************************
  5884
  5885     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5886         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5887             20  CF-AH-CODE-IN              PIC XXX.
  5888             20  CF-AH-CODE-OUT             PIC XX.
  5889         16  FILLER                         PIC X(248).
  5890
  5891
  5892****************************************************************
  5893*             CREDIBILITY TABLES                               *
  5894****************************************************************
  5895
  5896     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5897         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5898                             INDEXED BY CF-CRDB-NDX.
  5899             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5900             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5901             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5902         16  FILLER                         PIC  X(332).
  5903
  5904
  5905****************************************************************
  5906*             REPORT CUSTOMIZATION RECORD                      *
  5907****************************************************************
  5908
  5909     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5910         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5911             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5912             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5913             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5914**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5915****       A T-TRANSFER.                                   ****
  5916             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5917
  5918         16  FILLER                         PIC XX.
  5919
  5920         16  CF-CARRIER-CNTL-OPT.
  5921             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5922                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5923                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5924             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5925                                            PIC X.
  5926         16  CF-GROUP-CNTL-OPT.
  5927             20  CF-GROUP-OPT-SEQ           PIC 9.
  5928                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5929                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5930             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5931                                            PIC X(6).
  5932         16  CF-STATE-CNTL-OPT.
  5933             20  CF-STATE-OPT-SEQ           PIC 9.
  5934                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5935                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5936             20  CF-STATE-SELECT OCCURS 3 TIMES
  5937                                            PIC XX.
  5938         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 110
* EL050.cbl
  5939             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5940                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5941                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5942             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5943                                            PIC X(10).
  5944         16  CF-BUS-TYP-CNTL-OPT.
  5945             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5946                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5947                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5948             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5949                                            PIC XX.
  5950         16  CF-LF-TYP-CNTL-OPT.
  5951             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5952                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5953                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5954             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5955                                            PIC XX.
  5956         16  CF-AH-TYP-CNTL-OPT.
  5957             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5958                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5959                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5960             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5961                                            PIC XX.
  5962         16  CF-REPTCD1-CNTL-OPT.
  5963             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5964                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5965                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5966             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5967                                            PIC X(10).
  5968         16  CF-REPTCD2-CNTL-OPT.
  5969             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5970                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5971                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5972             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5973                                            PIC X(10).
  5974         16  CF-USER1-CNTL-OPT.
  5975             20  CF-USER1-OPT-SEQ           PIC 9.
  5976                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5977                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5978             20  CF-USER1-SELECT OCCURS 3 TIMES
  5979                                            PIC X(10).
  5980         16  CF-USER2-CNTL-OPT.
  5981             20  CF-USER2-OPT-SEQ           PIC 9.
  5982                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5983                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5984             20  CF-USER2-SELECT OCCURS 3 TIMES
  5985                                            PIC X(10).
  5986         16  CF-USER3-CNTL-OPT.
  5987             20  CF-USER3-OPT-SEQ           PIC 9.
  5988                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5989                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5990             20  CF-USER3-SELECT OCCURS 3 TIMES
  5991                                            PIC X(10).
  5992         16  CF-USER4-CNTL-OPT.
  5993             20  CF-USER4-OPT-SEQ           PIC 9.
  5994                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5995                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5996             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 111
* EL050.cbl
  5997                                            PIC X(10).
  5998         16  CF-USER5-CNTL-OPT.
  5999             20  CF-USER5-OPT-SEQ           PIC 9.
  6000                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6001                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6002             20  CF-USER5-SELECT OCCURS 3 TIMES
  6003                                            PIC X(10).
  6004         16  CF-REINS-CNTL-OPT.
  6005             20  CF-REINS-OPT-SEQ           PIC 9.
  6006                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6007                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6008             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6009                 24  CF-REINS-PRIME         PIC XXX.
  6010                 24  CF-REINS-SUB           PIC XXX.
  6011
  6012         16  CF-AGENT-CNTL-OPT.
  6013             20  CF-AGENT-OPT-SEQ           PIC 9.
  6014                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6015                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6016             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6017                                            PIC X(10).
  6018
  6019         16  FILLER                         PIC X(43).
  6020
  6021         16  CF-LOSS-RATIO-SELECT.
  6022             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6023             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6024         16  CF-ENTRY-DATE-SELECT.
  6025             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6026             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6027         16  CF-EFFECTIVE-DATE-SELECT.
  6028             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6029             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6030
  6031         16  CF-EXCEPTION-LIST-IND          PIC X.
  6032             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6033
  6034         16  FILLER                         PIC X(318).
  6035
  6036****************************************************************
  6037*                  EXCEPTION REPORTING RECORD                  *
  6038****************************************************************
  6039
  6040     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6041         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6042             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6043
  6044         16  CF-COMBINED-LIFE-AH-OPT.
  6045             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6046             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6047             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6048             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6049
  6050         16  CF-LIFE-OPT.
  6051             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6052             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6053             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6054             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 112
* EL050.cbl
  6055             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6056             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6057             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6058             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6059             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6060             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6061
  6062         16  CF-AH-OPT.
  6063             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6064             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6065             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6066             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6067             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6068             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6069             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6070             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6071             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6072             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6073
  6074         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6075             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6076             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6077             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6078
  6079         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6080
  6081         16  FILLER                         PIC X(673).
  6082
  6083
  6084****************************************************************
  6085*             MORTGAGE SYSTEM PLAN RECORD                      *
  6086****************************************************************
  6087
  6088     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6089         16  CF-PLAN-TYPE                   PIC X.
  6090             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6091             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6092             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6093         16  CF-PLAN-ABBREV                 PIC XXX.
  6094         16  CF-PLAN-DESCRIPT               PIC X(10).
  6095         16  CF-PLAN-NOTES                  PIC X(20).
  6096         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6097         16  CF-PLAN-UNDERWRITING.
  6098             20  CF-PLAN-TERM-DATA.
  6099                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6100                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6101             20  CF-PLAN-AGE-DATA.
  6102                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6103                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6104                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6105             20  CF-PLAN-BENEFIT-DATA.
  6106                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6107                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6108                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6109                                            PIC S9(7)V99  COMP-3.
  6110         16  CF-PLAN-POLICY-FORMS.
  6111             20  CF-POLICY-FORM             PIC X(12).
  6112             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 113
* EL050.cbl
  6113             20  CF-MASTER-POLICY           PIC X(12).
  6114         16  CF-PLAN-RATING.
  6115             20  CF-RATE-CODE               PIC X(5).
  6116             20  CF-SEX-RATING              PIC X.
  6117                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6118                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6119             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6120             20  CF-SUB-STD-TYPE            PIC X.
  6121                 88  CF-PCT-OF-PREM            VALUE '1'.
  6122                 88  CF-PCT-OF-BENE            VALUE '2'.
  6123         16  CF-PLAN-PREM-TOLERANCES.
  6124             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6125             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6126         16  CF-PLAN-PYMT-TOLERANCES.
  6127             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6128             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6129         16  CF-PLAN-MISC-DATA.
  6130             20  FILLER                     PIC X.
  6131             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6132             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6133         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6134         16  CF-PLAN-IND-GRP                PIC X.
  6135             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6136                                                     '1'.
  6137             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6138                                                     '2'.
  6139         16  CF-MIB-SEARCH-SW               PIC X.
  6140             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6141             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6142             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6143             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6144         16  CF-ALPHA-SEARCH-SW             PIC X.
  6145             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6146             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6147             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6148             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6149             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6150             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6151             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6152             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6153             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6154             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6155                                                     'A' 'B' 'C'
  6156                                                     'X' 'Y' 'Z'.
  6157         16  CF-EFF-DT-RULE-SW              PIC X.
  6158             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6159             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6160             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6161             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6162             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6163         16  FILLER                         PIC X(4).
  6164         16  CF-HEALTH-QUESTIONS            PIC X.
  6165             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6166         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6167         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6168         16  CF-PLAN-SNGL-JNT               PIC X.
  6169             88  CF-COMBINED-PLAN              VALUE 'C'.
  6170             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 114
* EL050.cbl
  6171             88  CF-SNGL-PLAN                  VALUE 'S'.
  6172         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6173         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6174         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6175         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6176         16  CF-RERATE-CNTL                 PIC  X.
  6177             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6178             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6179             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6180             88  CF-AUTO-RECALC                 VALUE '4'.
  6181         16  CF-BENEFIT-TYPE                PIC  X.
  6182             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6183             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6184         16  CF-POLICY-FEE                  PIC S999V99
  6185                                                    COMP-3.
  6186         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6187         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6188         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6189         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6190         16  FILLER                         PIC  X(32).
  6191         16  CF-TERMINATION-FORM            PIC  X(04).
  6192         16  FILLER                         PIC  X(08).
  6193         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6194                                                       COMP-3.
  6195         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6196         16  CF-ISSUE-LETTER                PIC  X(4).
  6197         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6198         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6199             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6200             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6201         16  CF-MP-REFUND-CALC              PIC X.
  6202             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6203             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6204             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6205             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6206             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6207             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6208             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6209             88  CF-MP-REFD-MEAN                VALUE '8'.
  6210         16  CF-ALT-RATE-CODE               PIC  X(5).
  6211
  6212
  6213         16  FILLER                         PIC X(498).
  6214****************************************************************
  6215*             MORTGAGE COMPANY MASTER RECORD                   *
  6216****************************************************************
  6217
  6218     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6219         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6220         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6221             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6222             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6223             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6224             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6225             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6226
  6227         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6228         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 115
* EL050.cbl
  6229         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6230         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6231         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6232
  6233         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6234             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6235         16  CF-MP-RECON-USE-IND            PIC X(1).
  6236             88  CF-MP-USE-RECON             VALUE 'Y'.
  6237         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6238             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6239         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6240             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6241             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6242         16  FILLER                         PIC X(1).
  6243         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6244             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6245         16  CF-MORTG-MIB-VERSION           PIC X.
  6246             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6247             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6248             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6249         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6250             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6251                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6252             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6253                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6254             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6255                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6256             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6257                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6258             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6259                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6260             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6261                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6262         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6263         16  FILLER                         PIC X(7).
  6264         16  CF-MORTG-DESTINATION-SYMBOL.
  6265             20  CF-MORTG-MIB-COMM          PIC X(5).
  6266             20  CF-MORTG-MIB-TERM          PIC X(5).
  6267         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6268             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6269         16  FILLER                         PIC X(03).
  6270         16  CF-MP-CHECK-NO-CONTROL.
  6271             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6272                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6273                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6274                                                ' ' LOW-VALUES.
  6275                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6276                                               VALUE '3'.
  6277         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6278         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6279         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6280             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6281                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6282             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6283                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6284             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6285                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6286             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 116
* EL050.cbl
  6287                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6288             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6289                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6290             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6291                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6292         16  CF-MORTG-BILLING-AREA.
  6293             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6294                                            PIC X.
  6295         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6296         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6297         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6298         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6299             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6300             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6301         16  FILLER                         PIC X.
  6302         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6303             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6304             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6305         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6306         16  FILLER                         PIC X(8).
  6307         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6308         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6309         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6310         16  CF-ACH-COMPANY-ID.
  6311             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6312                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6313                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6314                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6315             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6316         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6317             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6318         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6319             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6320             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6321         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6322         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6323         16  FILLER                         PIC X(536).
  6324
  6325****************************************************************
  6326*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6327****************************************************************
  6328
  6329     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6330         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6331             20  CF-FEMALE-HEIGHT.
  6332                 24  CF-FEMALE-FT           PIC 99.
  6333                 24  CF-FEMALE-IN           PIC 99.
  6334             20  CF-FEMALE-MIN-WT           PIC 999.
  6335             20  CF-FEMALE-MAX-WT           PIC 999.
  6336         16  FILLER                         PIC X(428).
  6337
  6338     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6339         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6340             20  CF-MALE-HEIGHT.
  6341                 24  CF-MALE-FT             PIC 99.
  6342                 24  CF-MALE-IN             PIC 99.
  6343             20  CF-MALE-MIN-WT             PIC 999.
  6344             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 117
* EL050.cbl
  6345         16  FILLER                         PIC X(428).
  6346******************************************************************
  6347*             AUTOMATIC ACTIVITY RECORD                          *
  6348******************************************************************
  6349     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6350         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6351             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6352             20  CF-SYS-LETTER-ID           PIC X(04).
  6353             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6354             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6355             20  CF-SYS-RESET-SW            PIC X(01).
  6356             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6357             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6358
  6359         16  FILLER                         PIC X(50).
  6360
  6361         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6362             20  CF-USER-ACTIVE-SW          PIC X(01).
  6363             20  CF-USER-LETTER-ID          PIC X(04).
  6364             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6365             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6366             20  CF-USER-RESET-SW           PIC X(01).
  6367             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6368             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6369             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6370
  6371         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 118
* EL050.cbl
  6373*    COPY ERCACCT.
  6374******************************************************************
  6375*                                                                *
  6376*                                                                *
  6377*                            ERCACCT                             *
  6378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6379*                            VMOD=2.031                          *
  6380*                                                                *
  6381*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6382*                                                                *
  6383*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6384*   VSAM ACCOUNT MASTER FILES.                                   *
  6385*                                                                *
  6386*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6387*                                                                *
  6388*   FILE TYPE = VSAM,KSDS                                        *
  6389*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6390*                                                                *
  6391*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6392*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6393*                                                                *
  6394*   LOG = NO                                                     *
  6395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6396*                                                                *
  6397*                                                                *
  6398******************************************************************
  6399*                   C H A N G E   L O G
  6400*
  6401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6402*-----------------------------------------------------------------
  6403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6404* EFFECTIVE    NUMBER
  6405*-----------------------------------------------------------------
  6406* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6407* 092705    2005050300006  PEMA  ADD SPP LEASES
  6408* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6409* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6410* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6411* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6412* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6413******************************************************************
  6414
  6415 01  ACCOUNT-MASTER.
  6416     12  AM-RECORD-ID                      PIC XX.
  6417         88  VALID-AM-ID                      VALUE 'AM'.
  6418
  6419     12  AM-CONTROL-PRIMARY.
  6420         16  AM-COMPANY-CD                 PIC X.
  6421         16  AM-MSTR-CNTRL.
  6422             20  AM-CONTROL-A.
  6423                 24  AM-CARRIER            PIC X.
  6424                 24  AM-GROUPING.
  6425                     28 AM-GROUPING-PREFIX PIC XXX.
  6426                     28 AM-GROUPING-PRIME  PIC XXX.
  6427                 24  AM-STATE              PIC XX.
  6428                 24  AM-ACCOUNT.
  6429                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6430                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 119
* EL050.cbl
  6431             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6432                                           PIC X(19).
  6433             20  AM-CNTRL-B.
  6434                 24  AM-EXPIRATION-DT      PIC XX.
  6435                 24  FILLER                PIC X(4).
  6436             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6437                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6438
  6439     12  AM-CONTROL-BY-VAR-GRP.
  6440         16  AM-COMPANY-CD-A1              PIC X.
  6441         16  AM-VG-CARRIER                 PIC X.
  6442         16  AM-VG-GROUPING                PIC X(6).
  6443         16  AM-VG-STATE                   PIC XX.
  6444         16  AM-VG-ACCOUNT                 PIC X(10).
  6445         16  AM-VG-DATE.
  6446             20  AM-VG-EXPIRATION-DT       PIC XX.
  6447             20  FILLER                    PIC X(4).
  6448         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6449                                           PIC 9(11)      COMP-3.
  6450     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6451         16  FILLER                        PIC X(10).
  6452         16  AM-VG-KEY3.
  6453             20  AM-VG3-ACCOUNT            PIC X(10).
  6454             20  AM-VG3-EXP-DT             PIC XX.
  6455         16  FILLER                        PIC X(4).
  6456     12  AM-MAINT-INFORMATION.
  6457         16  AM-LAST-MAINT-DT              PIC XX.
  6458         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6459         16  AM-LAST-MAINT-USER            PIC X(4).
  6460         16  FILLER                        PIC XX.
  6461
  6462     12  AM-EFFECTIVE-DT                   PIC XX.
  6463     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6464
  6465     12  AM-PREV-DATES  COMP-3.
  6466         16  AM-PREV-EXP-DT                PIC 9(11).
  6467         16  AM-PREV-EFF-DT                PIC 9(11).
  6468
  6469     12  AM-REPORT-CODE-1                  PIC X(10).
  6470     12  AM-REPORT-CODE-2                  PIC X(10).
  6471
  6472     12  AM-CITY-CODE                      PIC X(4).
  6473     12  AM-COUNTY-PARISH                  PIC X(6).
  6474
  6475     12  AM-NAME                           PIC X(30).
  6476     12  AM-PERSON                         PIC X(30).
  6477     12  AM-ADDRS                          PIC X(30).
  6478     12  AM-CITY.
  6479         16  AM-ADDR-CITY                  PIC X(28).
  6480         16  AM-ADDR-STATE                 PIC XX.
  6481     12  AM-ZIP.
  6482         16  AM-ZIP-PRIME.
  6483             20  AM-ZIP-PRI-1ST            PIC X.
  6484                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6485             20  FILLER                    PIC X(4).
  6486         16  AM-ZIP-PLUS4                  PIC X(4).
  6487     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6488         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 120
* EL050.cbl
  6489         16  AM-CAN-POSTAL-2               PIC XXX.
  6490         16  FILLER                        PIC XXX.
  6491     12  AM-TEL-NO.
  6492         16  AM-AREA-CODE                  PIC 999.
  6493         16  AM-TEL-PRE                    PIC 999.
  6494         16  AM-TEL-NBR                    PIC 9(4).
  6495     12  AM-TEL-LOC                        PIC X.
  6496         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6497         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6498
  6499     12  AM-COMM-STRUCTURE.
  6500         16  AM-DEFN-1.
  6501             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6502                 24  AM-AGT.
  6503                     28  AM-AGT-PREFIX     PIC X(4).
  6504                     28  AM-AGT-PRIME      PIC X(6).
  6505                 24  AM-COM-TYP            PIC X.
  6506                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6507                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6508                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6509                 24  AM-RECALC-LV-INDIC    PIC X.
  6510                 24  AM-RETRO-LV-INDIC     PIC X.
  6511                 24  AM-GL-CODES           PIC X.
  6512                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6513                 24  FILLER                PIC X(01).
  6514         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6515             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6516                 24  FILLER                PIC X(11).
  6517                 24  AM-L-COMA             PIC XXX.
  6518                 24  AM-J-COMA             PIC XXX.
  6519                 24  AM-A-COMA             PIC XXX.
  6520                 24  FILLER                PIC X(6).
  6521
  6522     12  AM-COMM-CHANGE-STATUS             PIC X.
  6523         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6524
  6525     12  AM-CSR-CODE                       PIC X(4).
  6526
  6527     12  AM-BILLING-STATUS                 PIC X.
  6528         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6529         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6530     12  AM-AUTO-REFUND-SW                 PIC X.
  6531         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6532         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6533     12  AM-GPCD                           PIC 99.
  6534     12  AM-IG                             PIC X.
  6535         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6536         88  AM-HAS-GROUP                     VALUE '2'.
  6537     12  AM-STATUS                         PIC X.
  6538         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6539         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6540         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6541         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6542         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6543         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6544     12  AM-REMIT-TO                       PIC 99.
  6545     12  AM-ID-NO                          PIC X(11).
  6546
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 121
* EL050.cbl
  6547     12  AM-CAL-TABLE                      PIC XX.
  6548     12  AM-LF-DEVIATION                   PIC XXX.
  6549     12  AM-AH-DEVIATION                   PIC XXX.
  6550     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6551     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6552     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6553     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6554     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6555     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6556
  6557     12  AM-USER-FIELDS.
  6558         16  AM-FLD-1                      PIC XX.
  6559         16  AM-FLD-2                      PIC XX.
  6560         16  AM-FLD-3                      PIC XX.
  6561         16  AM-FLD-4                      PIC XX.
  6562         16  AM-FLD-5                      PIC XX.
  6563
  6564     12  AM-1ST-PROD-DATE.
  6565         16  AM-1ST-PROD-YR                PIC XX.
  6566         16  AM-1ST-PROD-MO                PIC XX.
  6567         16  AM-1ST-PROD-DA                PIC XX.
  6568     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6569     12  AM-CERTS-PURGED-DATE.
  6570         16  AM-PUR-YR                     PIC XX.
  6571         16  AM-PUR-MO                     PIC XX.
  6572         16  AM-PUR-DA                     PIC XX.
  6573     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6574     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6575     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6576     12  AM-INACTIVE-DATE.
  6577         16  AM-INA-MO                     PIC 99.
  6578         16  AM-INA-DA                     PIC 99.
  6579         16  AM-INA-YR                     PIC 99.
  6580     12  AM-AR-HI-CERT-DATE                PIC XX.
  6581
  6582     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6583     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6584
  6585     12  AM-OB-PAYMENT-MODE                PIC X.
  6586         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6587         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6588         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6589         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6590
  6591     12  AM-AH-ONLY-INDICATOR              PIC X.
  6592         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6593         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6594
  6595     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6596
  6597     12  AM-OVER-SHORT.
  6598         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6599         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6600
  6601     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6602     12  AM-DCC-CLP-STATE                  PIC XX.
  6603
  6604     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 122
* EL050.cbl
  6605     12  AM-RECALC-REIN                    PIC X.
  6606
  6607     12  AM-REI-TABLE                      PIC XXX.
  6608     12  AM-REI-ET-LF                      PIC X.
  6609     12  AM-REI-ET-AH                      PIC X.
  6610     12  AM-REI-PE-LF                      PIC X.
  6611     12  AM-REI-PE-AH                      PIC X.
  6612     12  AM-REI-PRT-ST                     PIC X.
  6613     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6614     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6615     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6616     12  AM-REI-GROUP-A                    PIC X(6).
  6617     12  AM-REI-MORT                       PIC X(4).
  6618     12  AM-REI-PRT-OW                     PIC X.
  6619     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6620     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6621     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6622     12  AM-REI-GROUP-B                    PIC X(6).
  6623
  6624     12  AM-TRUST-TYPE                     PIC X(2).
  6625
  6626     12  AM-EMPLOYER-STMT-USED             PIC X.
  6627     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6628
  6629     12  AM-STD-AH-TYPE                    PIC XX.
  6630     12  AM-EARN-METHODS.
  6631         16  AM-EARN-METHOD-R              PIC X.
  6632             88 AM-REF-RL-R78                 VALUE 'R'.
  6633             88 AM-REF-RL-PR                  VALUE 'P'.
  6634             88 AM-REF-RL-MEAN                VALUE 'M'.
  6635             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6636         16  AM-EARN-METHOD-L              PIC X.
  6637             88 AM-REF-LL-R78                 VALUE 'R'.
  6638             88 AM-REF-LL-PR                  VALUE 'P'.
  6639             88 AM-REF-LL-MEAN                VALUE 'M'.
  6640             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6641         16  AM-EARN-METHOD-A              PIC X.
  6642             88 AM-REF-AH-R78                 VALUE 'R'.
  6643             88 AM-REF-AH-PR                  VALUE 'P'.
  6644             88 AM-REF-AH-MEAN                VALUE 'M'.
  6645             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6646             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6647             88 AM-REF-AH-NET                 VALUE 'N'.
  6648
  6649     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6650     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6651     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6652
  6653     12  AM-RET-Y-N                        PIC X.
  6654     12  AM-RET-P-E                        PIC X.
  6655     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6656     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6657     12  AM-RET-GRP                        PIC X(6).
  6658     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6659         16  AM-POOL-PRIME                 PIC XXX.
  6660         16  AM-POOL-SUB                   PIC XXX.
  6661     12  AM-RETRO-EARNINGS.
  6662         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 123
* EL050.cbl
  6663         16  AM-RET-EARN-L                 PIC X.
  6664         16  AM-RET-EARN-A                 PIC X.
  6665     12  AM-RET-ST-TAX-USE                 PIC X.
  6666         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6667         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6668     12  AM-RETRO-BEG-EARNINGS.
  6669         16  AM-RET-BEG-EARN-R             PIC X.
  6670         16  AM-RET-BEG-EARN-L             PIC X.
  6671         16  AM-RET-BEG-EARN-A             PIC X.
  6672     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6673     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6674
  6675     12  AM-USER-SELECT-OPTIONS.
  6676         16  AM-USER-SELECT-1              PIC X(10).
  6677         16  AM-USER-SELECT-2              PIC X(10).
  6678         16  AM-USER-SELECT-3              PIC X(10).
  6679         16  AM-USER-SELECT-4              PIC X(10).
  6680         16  AM-USER-SELECT-5              PIC X(10).
  6681
  6682     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6683
  6684     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6685
  6686     12  AM-RPT045A-SWITCH                 PIC X.
  6687         88  RPT045A-OFF                   VALUE 'N'.
  6688
  6689     12  AM-INSURANCE-LIMITS.
  6690         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6691         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6692
  6693     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6694         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6695
  6696     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6697         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6698         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6699
  6700     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6701
  6702     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6703     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6704     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6705     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6706     12  AM-DCC-UEF-STATE                  PIC XX.
  6707     12  FILLER                            PIC XXX.
  6708     12  AM-REPORT-CODE-3                  PIC X(10).
  6709*    12  FILLER                            PIC X(22).
  6710
  6711     12  AM-RESERVE-DATE.
  6712         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6713         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6714         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6715
  6716     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6717     12  AM-NOTIFICATION-TYPES.
  6718         16  AM-NOTIF-OF-LETTERS           PIC X.
  6719         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6720         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 124
* EL050.cbl
  6721         16  AM-NOTIF-OF-STATUS            PIC X.
  6722
  6723     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6724         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6725         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6726         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6727         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6728
  6729     12  AM-BENEFIT-CONTROLS.
  6730         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6731             20  AM-BENEFIT-CODE           PIC XX.
  6732             20  AM-BENEFIT-TYPE           PIC X.
  6733             20  AM-BENEFIT-REVISION       PIC XXX.
  6734             20  AM-BENEFIT-REM-TERM       PIC X.
  6735             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6736             20  FILLER                    PIC XX.
  6737         16  FILLER                        PIC X(80).
  6738
  6739     12  AM-TRANSFER-DATA.
  6740         16  AM-TRANSFERRED-FROM.
  6741             20  AM-TRNFROM-CARRIER        PIC X.
  6742             20  AM-TRNFROM-GROUPING.
  6743                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6744                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6745             20  AM-TRNFROM-STATE          PIC XX.
  6746             20  AM-TRNFROM-ACCOUNT.
  6747                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6748                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6749             20  AM-TRNFROM-DTE            PIC XX.
  6750         16  AM-TRANSFERRED-TO.
  6751             20  AM-TRNTO-CARRIER          PIC X.
  6752             20  AM-TRNTO-GROUPING.
  6753                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6754                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6755             20  AM-TRNTO-STATE            PIC XX.
  6756             20  AM-TRNTO-ACCOUNT.
  6757                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6758                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6759             20  AM-TRNTO-DTE              PIC XX.
  6760         16  FILLER                        PIC X(10).
  6761
  6762     12  AM-SAVED-REMIT-TO                 PIC 99.
  6763
  6764     12  AM-COMM-STRUCTURE-SAVED.
  6765         16  AM-DEFN-1-SAVED.
  6766             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6767                 24  AM-AGT-SV             PIC X(10).
  6768                 24  AM-COM-TYP-SV         PIC X.
  6769                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6770                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6771                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6772                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6773                 24  FILLER                PIC X.
  6774                 24  AM-GL-CODES-SV        PIC X.
  6775                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6776                 24  FILLER                PIC X.
  6777         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6778             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 125
* EL050.cbl
  6779                 24  FILLER                PIC X(11).
  6780                 24  AM-L-COMA-SV          PIC XXX.
  6781                 24  AM-J-COMA-SV          PIC XXX.
  6782                 24  AM-A-COMA-SV          PIC XXX.
  6783                 24  FILLER                PIC X(6).
  6784
  6785     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6786         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6787            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6788            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6789            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6790
  6791     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6792     12  FILLER                            PIC X(120).
  6793
  6794     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6795         16  AM-CONTROL-NAME               PIC X(30).
  6796         16  AM-EXECUTIVE-ONE.
  6797             20  AM-EXEC1-NAME             PIC X(15).
  6798             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6799                                                          COMP-3.
  6800             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6801                                                          COMP-3.
  6802         16  AM-EXECUTIVE-TWO.
  6803             20  AM-EXEC2-NAME             PIC X(15).
  6804             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6805                                                          COMP-3.
  6806             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6807                                                          COMP-3.
  6808
  6809     12  AM-RETRO-ADDITIONAL-DATA.
  6810         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6811         16  AM-RETRO-PREM-P-E             PIC X.
  6812         16  AM-RETRO-CLMS-P-I             PIC X.
  6813         16  AM-RETRO-RET-BRACKET-LF.
  6814             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6815                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6816                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6817             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6818                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6819                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6820             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6821                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6822                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6823         16  AM-RETRO-RET-BRACKET-AH.
  6824             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6825                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6826                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6827                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6828             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6829                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6830                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6831             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6832                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6833                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6834
  6835     12  AM-COMMENTS.
  6836         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 126
* EL050.cbl
  6837
  6838     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6839         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6840         16  AM-FLI-BILLING-CODE           PIC X.
  6841         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6842         16  AM-FLI-UNITED-IDENT           PIC X.
  6843         16  AM-FLI-INTEREST-LOST-DATA.
  6844             20  AM-FLI-BANK-NO            PIC X(5).
  6845             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6846             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6847             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6848         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6849             20  AM-FLI-AGT                PIC X(9).
  6850             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6851             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6852         16  FILLER                        PIC X(102).
  6853
  6854     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6855         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6856             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6857             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6858             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6859             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6860             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6861         16  FILLER                          PIC X(10).
  6862******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 127
* EL050.cbl
  6864*    COPY ERCREIN.
  6865******************************************************************
  6866*                                                                *
  6867*                            ERCREIN                             *
  6868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6869*                            VMOD=2.010                          *
  6870*                                                                *
  6871*   ONLINE CREDIT SYSTEM                                         *
  6872*                                                                *
  6873*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6874*                                                                *
  6875*   FILE TYPE = VSAM,KSDS                                        *
  6876*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6877*                                                                *
  6878*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6879*       ALTERNATE PATH = NONE                                    *
  6880*                                                                *
  6881*   LOG = NO                                                     *
  6882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6883*                                                                *
  6884******************************************************************
  6885*                   C H A N G E   L O G
  6886*
  6887* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6888*-----------------------------------------------------------------
  6889*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6890* EFFECTIVE    NUMBER
  6891*-----------------------------------------------------------------
  6892* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6893* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6894******************************************************************
  6895 01  REINSURANCE-RECORD.
  6896     12  RE-RECORD-ID                      PIC XX.
  6897         88  VALID-RE-ID                      VALUE 'RE'.
  6898
  6899     12  RE-CONTROL-PRIMARY.
  6900         16  RE-COMPANY-CD                 PIC X.
  6901         16  RE-KEY.
  6902             20  RE-CODE                   PIC X.
  6903                 88  RE-TABLE-RECORD          VALUE 'A'.
  6904                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6905             20  RE-TABLE                  PIC XXX.
  6906             20  FILLER                    PIC XXX.
  6907         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6908             20  FILLER                    PIC X.
  6909             20  RE-COMPANY.
  6910                 24  RE-COMP-PRIME         PIC XXX.
  6911                 24  RE-COMP-SUB           PIC XXX.
  6912
  6913     12  RE-MAINT-INFORMATION.
  6914         16  RE-LAST-MAINT-DT              PIC XX.
  6915         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6916         16  RE-LAST-MAINT-USER            PIC X(4).
  6917         16  FILLER                        PIC X(10).
  6918
  6919     12  RE-TABLE-DATA.
  6920         16  RE-100-COMP                   PIC 99.
  6921
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 128
* EL050.cbl
  6922         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6923             20  RE-REI-COMP-NO.
  6924                 24  RE-REI-COMP           PIC XXX.
  6925                 24  RE-REI-COMP-SUB       PIC XXX.
  6926             20  RE-LF-QC                  PIC X.
  6927             20  RE-AH-QC                  PIC X.
  6928             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6929             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6930             20  RE-LFAGE-LO               PIC 99.
  6931             20  RE-LFAGE-HI               PIC 99.
  6932             20  RE-AHAGE-LO               PIC 99.
  6933             20  RE-AHAGE-HI               PIC 99.
  6934             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6935             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6936             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6937             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6938             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6939             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6940             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6941             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6942             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6943             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6944             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6945             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6946             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6947             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6948             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6949             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6950             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6951             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6952             20  RE-LF-BEN-CODE            PIC X.
  6953             20  RE-AH-BEN-CODE            PIC X.
  6954             20  RE-INTERACTIVE            PIC X.
  6955             20  RE-REMAINING              PIC X.
  6956             20  RE-LF-RUNOFF-SW           PIC X.
  6957             20  RE-AH-RUNOFF-SW           PIC X.
  6958             20  FILLER                    PIC X(19).
  6959
  6960         16  RE-COMP-INFO-END              PIC X(6).
  6961         16  RE-NSP-ST-CD-LF               PIC XX.
  6962         16  RE-NSP-ST-CD-AH               PIC XX.
  6963         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6964             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6965
  6966         16  FILLER                        PIC X(27).
  6967
  6968     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6969         16  RE-NAME                       PIC X(30).
  6970         16  RE-LF-PE                      PIC X.
  6971         16  RE-AH-PE                      PIC X.
  6972         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6973         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6974         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6975         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6976         16  RE-PRT-ST                     PIC X.
  6977         16  RE-PRT-OW                     PIC X.
  6978         16  RE-MORT-CODE                  PIC X(4).
  6979         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 129
* EL050.cbl
  6980         16  RE-ZERO-LF-FEE                PIC X.
  6981         16  RE-ZERO-AH-FEE                PIC X.
  6982         16  RE-CEDE-NAME                  PIC X(30).
  6983         16  RE-LF-COMM                    PIC X.
  6984         16  RE-AH-COMM                    PIC X.
  6985         16  RE-LF-TAX                     PIC X.
  6986         16  RE-AH-TAX                     PIC X.
  6987         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6988         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6989         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6990
  6991         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6992             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6993
  6994         16  RE-LF-CEDING-FEE-BRACKETS.
  6995             20  RE-LF-FEE-METHOD          PIC X.
  6996                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6997                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6998                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6999                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7000             20  RE-LF-FEE-BASIS           PIC X.
  7001                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7002                 88  RE-LF-NET-CEDED               VALUE '2'.
  7003                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7004                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7005                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7006                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7007                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7008                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7009             20  FILLER                    PIC XXX.
  7010             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7011                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7012                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7013
  7014         16  RE-AH-CEDING-FEE-BRACKETS.
  7015             20  RE-AH-FEE-METHOD          PIC X.
  7016                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7017                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7018                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7019                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7020             20  RE-AH-FEE-BASIS           PIC X.
  7021                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7022                 88  RE-AH-NET-CEDED               VALUE '2'.
  7023                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7024                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7025                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7026                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7027                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7028                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7029             20  FILLER                    PIC XXX.
  7030             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7031                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7032                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7033
  7034         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7035
  7036         16  RE-OLD-CEDING-STMT            PIC X.
  7037
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 130
* EL050.cbl
  7038         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7039         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7040         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7041         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7042         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7043         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7044         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7045         16  RE-MORT-SW                    PIC X.
  7046         16  RE-CEDING-TYPE-FLAG           PIC X.
  7047             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7048             88  RE-CEDED                          VALUE 'C'.
  7049             88  RE-ASSUMED                        VALUE 'A'.
  7050             88  RE-PHANTOM                        VALUE 'P'.
  7051
  7052         16  RE-CEDING-STMT-OPT-A          PIC X.
  7053             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7054         16  RE-CEDING-STMT-OPT-B          PIC X.
  7055             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7056         16  RE-CEDING-STMT-OPT-C          PIC X.
  7057             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7058         16  RE-CEDING-STMT-OPT-D          PIC X.
  7059             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7060         16  RE-CEDING-STMT-OPT-E          PIC X.
  7061             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7062
  7063         16  RE-PRT-CRSV                   PIC X.
  7064
  7065         16  RE-GL-CENTER                  PIC X(4).
  7066
  7067         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7068
  7069         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7070
  7071         16  RE-EARN-STOP-CODE             PIC X.
  7072             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7073             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7074
  7075         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7076             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7077
  7078         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7079         16  FILLER                        PIC X(2281).
  7080
  7081         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7082
  7083******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 131
* EL050.cbl
  7085*    COPY ERCCTBL.
  7086******************************************************************
  7087*                                                                *
  7088*                                                                *
  7089*                            ERCCTBL                             *
  7090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7091*                            VMOD=2.003
  7092*                                                                *
  7093*   ONLINE CREDIT SYSTEM                                         *
  7094*                                                                *
  7095*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7096*                                                                *
  7097*   FILE TYPE = VSAM,KSDS                                        *
  7098*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7099*                                                                *
  7100*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7101*       ALTERNATE PATH = NONE                                    *
  7102*                                                                *
  7103*   LOG = NO                                                     *
  7104*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7105*                                                                *
  7106*                                                                *
  7107******************************************************************
  7108
  7109 01  COMM-TABLE-RECORD.
  7110     12  CT-RECORD-ID                      PIC XX.
  7111         88  VALID-CT-ID                      VALUE 'CT'.
  7112
  7113     12  CT-CONTROL-PRIMARY.
  7114         16  CT-COMPANY-CD                 PIC X.
  7115         16  CT-TABLE                      PIC XXX.
  7116         16  CT-CNTRL-2.
  7117             20  CT-BEN-TYPE               PIC X.
  7118             20  CT-BEN-CODE               PIC XX.
  7119
  7120     12  CT-MAINT-INFORMATION.
  7121         16  CT-LAST-MAINT-DT              PIC XX.
  7122         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7123         16  CT-LAST-MAINT-USER            PIC X(4).
  7124         16  FILLER                        PIC X(31).
  7125
  7126     12  CT-LIMITS.
  7127         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7128
  7129         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7130
  7131         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7132
  7133     12  CT-RATES.
  7134         16  CT-RTX          OCCURS 27 TIMES.
  7135             20  CT-RT                     PIC SV9(5)     COMP-3.
  7136             20  CT-RT-R   REDEFINES
  7137                 CT-RT                     PIC XXX.
  7138
  7139     12  FILLER                            PIC  X(42).
  7140
  7141******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 132
* EL050.cbl
  7143*    COPY ERCFORM.
  7144******************************************************************
  7145*                                                                *
  7146*                                                                *
  7147*                            ERCFORM.                            *
  7148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7149*                            VMOD=2.003                          *
  7150*                                                                *
  7151*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7152*                                                                *
  7153*    FILE TYPE = VSAM,KSDS                                       *
  7154*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7155*                                                                *
  7156*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7157*                                                                *
  7158*    LOG = YES                                                   *
  7159*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7160******************************************************************
  7161 01  FORM-MASTER.
  7162    12  FO-RECORD-ID                 PIC X(02).
  7163        88  VALID-FO-ID                  VALUE 'FO'.
  7164
  7165    12  FO-CONTROL-PRIMARY.
  7166        16  FO-COMPANY-CD            PIC X(01).
  7167        16  FO-STATE                 PIC X(02).
  7168        16  FO-FORM-ID               PIC X(12).
  7169        16  FO-FORM-EXP-DT           PIC X(02).
  7170
  7171    12  FO-POLICY-FORM-DATA.
  7172        16  FO-IND-GRP-CD            PIC X(01).
  7173        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7174        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7175        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7176        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7177        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7178        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7179        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7180        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7181        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7182        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7183        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7184        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7185        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7186        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7187        16  FO-APP-CERT-USE-CD       PIC X(01).
  7188
  7189    12  FILLER                       PIC X(29).
  7190
  7191    12  FO-FORM-PLAN-TABLE.
  7192        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7193            20  FO-PLAN-TYPE         PIC X(01).
  7194            20  FO-PLAN-ID           PIC X(02).
  7195            20  FO-PLAN-TERM         PIC 9(03).
  7196            20  FO-PLAN-REFUND-METHOD
  7197                                     PIC X.
  7198
  7199    12  FILLER                       PIC X(30).
  7200
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 133
* EL050.cbl
  7201    12  FO-COMMENTS-AREA.
  7202        16  FO-COMMENT-LINE-1        PIC X(78).
  7203
  7204    12  FILLER                       PIC X(20).
  7205
  7206    12  FO-MAINT-INFORMATION.
  7207        16  FO-LAST-MAINT-DT         PIC X(02).
  7208        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7209        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 134
* EL050.cbl
  7211*    COPY ELCMSTR.
  7212******************************************************************
  7213*                                                                *
  7214*                            ELCMSTR.                            *
  7215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7216*                            VMOD=2.012                          *
  7217*                                                                *
  7218*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7219*                                                                *
  7220*   FILE TYPE = VSAM,KSDS                                        *
  7221*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7222*                                                                *
  7223*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7224*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7225*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7226*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7227*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7228*                                                 RKP=75,LEN=21  *
  7229*                                                                *
  7230*   **** NOTE ****                                               *
  7231*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7232*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7233*                                                                *
  7234*   LOG = YES                                                    *
  7235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7236******************************************************************
  7237*                   C H A N G E   L O G
  7238*
  7239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7240*-----------------------------------------------------------------
  7241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7242* EFFECTIVE    NUMBER
  7243*-----------------------------------------------------------------
  7244* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7245* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7246******************************************************************
  7247 01  CLAIM-MASTER.
  7248     12  CL-RECORD-ID                PIC XX.
  7249         88  VALID-CL-ID         VALUE 'CL'.
  7250
  7251     12  CL-CONTROL-PRIMARY.
  7252         16  CL-COMPANY-CD           PIC X.
  7253         16  CL-CARRIER              PIC X.
  7254         16  CL-CLAIM-NO             PIC X(7).
  7255         16  CL-CERT-NO.
  7256             20  CL-CERT-PRIME       PIC X(10).
  7257             20  CL-CERT-SFX         PIC X.
  7258
  7259     12  CL-CONTROL-BY-NAME.
  7260         16  CL-COMPANY-CD-A1        PIC X.
  7261         16  CL-INSURED-LAST-NAME    PIC X(15).
  7262         16  CL-INSURED-NAME.
  7263             20  CL-INSURED-1ST-NAME PIC X(12).
  7264             20  CL-INSURED-MID-INIT PIC X.
  7265
  7266     12  CL-CONTROL-BY-SSN.
  7267         16  CL-COMPANY-CD-A2        PIC X.
  7268         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 135
* EL050.cbl
  7269             20  CL-SSN-STATE        PIC XX.
  7270             20  CL-SSN-ACCOUNT      PIC X(6).
  7271             20  CL-SSN-LN3          PIC X(3).
  7272
  7273     12  CL-CONTROL-BY-CERT-NO.
  7274         16  CL-COMPANY-CD-A4        PIC X.
  7275         16  CL-CERT-NO-A4.
  7276             20  CL-CERT-A4-PRIME    PIC X(10).
  7277             20  CL-CERT-A4-SFX      PIC X.
  7278
  7279     12  CL-CONTROL-BY-CCN.
  7280         16  CL-COMPANY-CD-A5        PIC X.
  7281         16  CL-CCN-A5.
  7282             20  CL-CCN.
  7283                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7284                 24  CL-CCN-PRIME-A5 PIC X(12).
  7285             20  CL-CCN-FILLER-A5    PIC X(4).
  7286
  7287     12  CL-INSURED-PROFILE-DATA.
  7288         16  CL-INSURED-BIRTH-DT     PIC XX.
  7289         16  CL-INSURED-SEX-CD       PIC X.
  7290             88  INSURED-IS-MALE        VALUE 'M'.
  7291             88  INSURED-IS-FEMALE      VALUE 'F'.
  7292             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7293         16  CL-INSURED-OCC-CD       PIC X(6).
  7294         16  FILLER                  PIC X(5).
  7295
  7296     12  CL-PROCESSING-INFO.
  7297         16  CL-PROCESSOR-ID         PIC X(4).
  7298         16  CL-CLAIM-STATUS         PIC X.
  7299             88  CLAIM-IS-OPEN          VALUE 'O'.
  7300             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7301         16  CL-CLAIM-TYPE           PIC X.
  7302*            88  AH-CLAIM               VALUE 'A'.
  7303*            88  LIFE-CLAIM             VALUE 'L'.
  7304*            88  PROPERTY-CLAIM         VALUE 'P'.
  7305*            88  IUI-CLAIM              VALUE 'I'.
  7306*            88  GAP-CLAIM              VALUE 'G'.
  7307         16  CL-CLAIM-PREM-TYPE      PIC X.
  7308             88  SINGLE-PREMIUM         VALUE '1'.
  7309             88  O-B-COVERAGE           VALUE '2'.
  7310             88  OPEN-END-COVERAGE      VALUE '3'.
  7311         16  CL-INCURRED-DT          PIC XX.
  7312         16  CL-REPORTED-DT          PIC XX.
  7313         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7314         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7315         16  CL-LAST-PMT-DT          PIC XX.
  7316         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7317         16  CL-PAID-THRU-DT         PIC XX.
  7318         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7319         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7320         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7321         16  CL-PMT-CALC-METHOD      PIC X.
  7322             88  CL-360-DAY-YR          VALUE '1'.
  7323             88  CL-365-DAY-YR          VALUE '2'.
  7324             88  CL-FULL-MONTHS         VALUE '3'.
  7325         16  CL-CAUSE-CD             PIC X(6).
  7326
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 136
* EL050.cbl
  7327         16  CL-PRIME-CERT-NO.
  7328             20  CL-PRIME-CERT-PRIME PIC X(10).
  7329             20  CL-PRIME-CERT-SFX   PIC X.
  7330
  7331         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7332             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7333             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7334
  7335         16  CL-MICROFILM-NO         PIC X(10).
  7336         16  CL-PROG-FORM-TYPE       PIC X.
  7337         16  CL-LAST-ADD-ON-DT       PIC XX.
  7338
  7339         16  CL-LAST-REOPEN-DT       PIC XX.
  7340         16  CL-LAST-CLOSE-DT        PIC XX.
  7341         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7342             88  FINAL-PAID             VALUE '1'.
  7343             88  CLAIM-DENIED           VALUE '2'.
  7344             88  AUTO-CLOSE             VALUE '3'.
  7345             88  MANUAL-CLOSE           VALUE '4'.
  7346             88  BENEFITS-CHANGED       VALUE 'C'.
  7347             88  SETUP-ERRORS           VALUE 'E'.
  7348         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7349         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7350         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7351             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7352         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7353         16  FILLER                  PIC X.
  7354
  7355     12  CL-CERTIFICATE-DATA.
  7356         16  CL-CERT-ORIGIN          PIC X.
  7357             88  CERT-WAS-ONLINE        VALUE '1'.
  7358             88  CERT-WAS-CREATED       VALUE '2'.
  7359             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7360         16  CL-CERT-KEY-DATA.
  7361             20  CL-CERT-CARRIER     PIC X.
  7362             20  CL-CERT-GROUPING    PIC X(6).
  7363             20  CL-CERT-STATE       PIC XX.
  7364             20  CL-CERT-ACCOUNT.
  7365                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7366                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7367             20  CL-CERT-EFF-DT      PIC XX.
  7368
  7369     12  CL-STATUS-CONTROLS.
  7370         16  CL-PRIORITY-CD          PIC X.
  7371             88  CONFIDENTIAL-DATA      VALUE '8'.
  7372             88  HIGHEST-PRIORITY       VALUE '9'.
  7373         16  CL-SUPV-ATTN-CD         PIC X.
  7374             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7375             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7376         16  CL-PURGED-DT            PIC XX.
  7377         16  CL-RESTORED-DT          PIC XX.
  7378         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7379         16  CL-NEXT-RESEND-DT       PIC XX.
  7380         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7381         16  FILLER                  PIC XX.
  7382         16  CL-LAST-MAINT-DT        PIC XX.
  7383         16  CL-LAST-MAINT-USER      PIC X(4).
  7384         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 137
* EL050.cbl
  7385         16  CL-LAST-MAINT-TYPE      PIC X.
  7386             88  CLAIM-SET-UP           VALUE ' '.
  7387             88  PAYMENT-MADE           VALUE '1'.
  7388             88  LETTER-SENT            VALUE '2'.
  7389             88  MASTER-WAS-ALTERED     VALUE '3'.
  7390             88  MASTER-WAS-RESTORED    VALUE '4'.
  7391             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7392             88  FILE-CONVERTED         VALUE '6'.
  7393             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7394             88  ERROR-CORRECTION       VALUE 'E'.
  7395         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7396         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7397         16  CL-BENEFICIARY          PIC X(10).
  7398         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7399         16  CL-DENIAL-TYPE          PIC X.
  7400             88  CL-TYPE-DENIAL          VALUE '1'.
  7401             88  CL-TYPE-RESCISSION      VALUE '2'.
  7402             88  CL-TYPE-REFORMATION     VALUE '3'.
  7403             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7404             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7405         16  FILLER                  PIC X(5).
  7406
  7407     12  CL-TRAILER-CONTROLS.
  7408         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7409             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7410             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7411             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7412         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7413         16  FILLER                  PIC XX.
  7414         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7415         16  CL-ADDRESS-TRAILER-CNT.
  7416             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7417                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7418             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7419                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7420             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7421                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7422             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7423                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7424             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7425                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7426             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7427                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7428             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7429                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7430
  7431     12  CL-CV-REFERENCE-NO.
  7432         16  CL-CV-REFNO-PRIME       PIC X(18).
  7433         16  CL-CV-REFNO-SFX         PIC XX.
  7434
  7435     12  CL-FILE-LOCATION            PIC X(4).
  7436
  7437     12  CL-PROCESS-ERRORS.
  7438         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7439             88  NO-FATAL-ERRORS        VALUE ZERO.
  7440         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7441             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7442
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 138
* EL050.cbl
  7443     12  CL-PRODUCT-CD               PIC X.
  7444
  7445     12  CL-CURRENT-KEY-DATA.
  7446         16  CL-CURRENT-CARRIER      PIC X.
  7447         16  CL-CURRENT-GROUPING     PIC X(6).
  7448         16  CL-CURRENT-STATE        PIC XX.
  7449         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7450
  7451     12  CL-ASSOCIATES               PIC X.
  7452         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7453         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7454         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7455         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7456
  7457     12  CL-ACTIVITY-CODE            PIC 99.
  7458     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7459     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7460
  7461     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7462     12  CL-LAG-REPORT-CODE          PIC 9.
  7463     12  CL-LOAN-TYPE                PIC XX.
  7464     12  CL-LEGAL-STATE              PIC XX.
  7465
  7466*    12  FILLER                      PIC X(5).
  7467     12  CL-YESNOSW                  PIC X.
  7468     12  FILLER                      PIC X(4).
  7469
  7470 01  PLAN-RECORDS.
  7471     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7472     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7473
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 139
* EL050.cbl
  7475 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7476                          ACCOUNT-MASTER REINSURANCE-RECORD
  7477                          COMM-TABLE-RECORD FORM-MASTER
  7478                          CLAIM-MASTER PLAN-RECORDS.
  7479 0000-DFHEXIT SECTION.
  7480     MOVE '9#                    $   ' TO DFHEIV0.
  7481     MOVE 'EL050' TO DFHEIV1.
  7482     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7483
  7484     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7485
  7486
  7487* EXEC CICS  HANDLE CONDITION
  7488*           ERROR    (9300-ABEND)
  7489*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7490*    END-EXEC.
  7491*    MOVE '"$.J                  ! " #00007482' TO DFHEIV0
  7492     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7494     MOVE X'2220233030303037343832' TO DFHEIV0(25:11)
  7495     CALL 'kxdfhei1' USING DFHEIV0
  7496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7497
  7498
  7499 0000-COPY-PROCEDURE-DIV.
  7500*                          COPY ELC50PD.
  7501******************************************************************
  7502*                                                                *
  7503*                            ELC50PD                             *
  7504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7505*                            VMOD=2.188                          *
  7506*                                                                *
  7507******************************************************************
  7508*                   C H A N G E   L O G
  7509*
  7510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7511*-----------------------------------------------------------------
  7512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7513* EFFECTIVE    NUMBER
  7514*-----------------------------------------------------------------
  7515* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7516* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7517* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7518*                             2709 AND 2718
  7519* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7520* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7521* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7523* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7524*                                IS OPEN OR CNC DT < PD THRU
  7525* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7526* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7527* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7528* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7529* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7530* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7531* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7532* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 140
* EL050.cbl
  7533* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7534* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7535* 020906                   PEMA  EXPAND LOAN OFFICER
  7536* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7537* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7538* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7539* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7540* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7541* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7542* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7543* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7544* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7545* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7546* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7547* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7548* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7549* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7550* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7551* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7552* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7553* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7554* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7555* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7556* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7557* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7558* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7559* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7560* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7561*                                UPDATE VIN ON CERT TRAILER
  7562* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7563* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7564* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7565* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7567* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7568* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7569* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7570* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7571* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7572* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7573* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7574* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7575* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7576* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7577* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7578* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7579* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7580* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7581* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7582* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7583* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7584* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7585* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7586* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7587* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7588* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7589* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7590* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 141
* EL050.cbl
  7591* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7592* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7593* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7594* 032912  CR2011110200001  PEMA  AHL CHANGES
  7595* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7596* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7597* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7598* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7599* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7600* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7601* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7602* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7603* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7604* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7605******************************************************************
  7606************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7607******************************************************************
  7608
  7609     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7610
  7611     MOVE SPACES                 TO PB-FATAL-FLAG
  7612                                    PB-FORCE-ER-CD
  7613                                    PB-WARN-ER-CD
  7614                                    PB-OUT-BAL-CD.
  7615
  7616     MOVE SPACE                  TO WS-IG-OVRD-AH
  7617                                    WS-IG-OVRD-LF
  7618                                    WS-IG-OVRD-AM
  7619                                    WS-IG-OVRD
  7620                                    WS-IG-OVRD-AH-PL
  7621                                    WS-IG-OVRD-LF-PL
  7622                                    WS-IG-OVRD-AH-BEN
  7623                                    WS-IG-OVRD-LF-BEN.
  7624
  7625******************************************************************
  7626*************       INITIALIZE COMMON ERRORS       ***************
  7627******************************************************************
  7628
  7629     MOVE +0                     TO PB-NO-OF-ERRORS.
  7630     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7631
  7632******************************************************************
  7633
  7634     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7635     SET JULIAN-TO-BIN           TO TRUE.
  7636*    MOVE 5                      TO DC-OPTION-CODE.
  7637     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7638     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7639
  7640     MOVE ZERO                   TO  SUB4.
  7641
  7642 0040-INITIALIZE-GA-BILL-DT.
  7643
  7644     ADD +1                      TO  SUB4.
  7645
  7646     IF  SUB4 GREATER THAN +5
  7647         GO TO 0050-CHECK-CNTL-FOUND.
  7648
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 142
* EL050.cbl
  7649     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7650         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7651
  7652     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7653
  7654 0050-CHECK-CNTL-FOUND.
  7655
  7656     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7657        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7658                                         WS-AH-REM-TERM-CALC
  7659                                         EC-CO-REM-TERM-CALC
  7660        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7661        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7662        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7663                                         WS-TOL-AH-CLAIM
  7664        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7665                                         WS-TOL-AH-PREM
  7666                                         EC-CO-TOL-PREM
  7667        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7668                                         WS-TOL-AH-REFUND
  7669                                         EC-CO-TOL-REFUND
  7670        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7671                                         WS-AH-REFUND-OVS-AMT
  7672                                         EC-CO-OVR-SHT-AMT
  7673        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7674                                         WS-TOL-AH-PREM-PCT
  7675                                         EC-CO-TOL-PREM-PCT
  7676        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7677                                         WS-TOL-AH-REFUND-PCT
  7678                                         EC-CO-TOL-REFUND-PCT
  7679        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7680                                         WS-AH-REFUND-OVS-PCT
  7681                                         EC-CO-OVR-SHT-PCT
  7682        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7683        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7684        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7685        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7686        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7687        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7688        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7689        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7690        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7691        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7692        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7693        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7694                                         EC-CO-MONTH-END-DT
  7695        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7696          GO TO 0100-READ-ACCT.
  7697
  7698     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7699     MOVE SPACES                 TO CNTL-ACCESS.
  7700     MOVE '1'                    TO CNTL-REC-TYPE.
  7701     MOVE +0                     TO CNTL-SEQ-NO.
  7702
  7703     MOVE '1' TO RC-SW-1.
  7704     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7705     IF NOT CF-COMPANY-MASTER
  7706         MOVE ZEROS             TO WK-CO-TOL-PREM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 143
* EL050.cbl
  7707                                   WK-CO-TOL-CLAIM
  7708                                   WK-CO-TOL-REFUND
  7709                                   WK-REFUND-OVS-AMT
  7710                                   WK-REFUND-OVS-PCT
  7711                                   WK-CO-TOL-PREM-PCT
  7712                                   WK-CO-TOL-REFUND-PCT
  7713                                   WK-DEFAULT-APR
  7714                                   WK-CO-MAX-CAP
  7715        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7716                                   WK-CR-R78-METHOD
  7717                                   WK-CO-REF-REJECT-SW
  7718                                   WK-CO-PREM-REJECT-SW
  7719                                   WK-REM-TRM-CALC-OPTION
  7720                                   WK-BIRTH-DATE-INPUT
  7721                                   WK-JOINT-AGE-INPUT
  7722        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7723        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7724        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7725        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7726          GO TO 0099-COMPANY-NOT-FOUND.
  7727
  7728     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7729        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7730     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7731        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7732     IF CF-CO-TOL-CAP NOT NUMERIC
  7733        MOVE +0                    TO CF-CO-TOL-CAP.
  7734     IF CF-DEFAULT-APR NOT NUMERIC
  7735        MOVE +0                    TO CF-DEFAULT-APR.
  7736
  7737     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7738     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7739     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7740     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7741     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7742     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7743     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7744     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7745     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7746     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7747     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7748     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7749
  7750     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7751          CF-CO-OVR-SHT-AMT > +0
  7752        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7753
  7754     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7755          CF-CO-OVR-SHT-PCT > +0
  7756        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7757
  7758     IF CF-VALID-REM-TRM-OPTION
  7759         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7760     ELSE
  7761         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7762
  7763     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7764     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 144
* EL050.cbl
  7765     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7766     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7767
  7768     GO TO 0050-CHECK-CNTL-FOUND.
  7769
  7770 0099-COMPANY-NOT-FOUND.
  7771
  7772     MOVE ER-2616                TO WS-ERROR.
  7773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7774
  7775 0100-READ-ACCT.
  7776
  7777     MOVE SPACES                 TO DATE-RANGE-SW.
  7778
  7779     IF WK-ACCT-ADDR = ZEROS
  7780        GO TO 0102-ACCT-GETMAIN.
  7781
  7782     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7783     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7784     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7785
  7786     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7787        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7788        GO TO 0105-READ-ACCT
  7789     END-IF
  7790
  7791     IF PB-CARRIER NOT = SPACES
  7792        IF PB-CARRIER NOT = AM-VG-CARRIER
  7793           GO TO 0105-READ-ACCT.
  7794
  7795     IF PB-STATE NOT = SPACES
  7796        IF PB-STATE NOT = AM-VG-STATE
  7797           GO TO 0105-READ-ACCT.
  7798
  7799     IF PB-GROUPING NOT = SPACES
  7800        IF PB-GROUPING NOT = AM-VG-GROUPING
  7801           GO TO 0105-READ-ACCT.
  7802
  7803     MOVE 'X'                 TO DATE-RANGE-SW.
  7804
  7805     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7806        MOVE 'X'                 TO DATE-RANGE-SW
  7807        GO TO 0105-READ-ACCT.
  7808
  7809     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7810        GO TO 0105-READ-ACCT.
  7811
  7812     GO TO 0180-ACCOUNT-FOUND.
  7813
  7814 0102-ACCT-GETMAIN.
  7815     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7816     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7817
  7818 0105-READ-ACCT.
  7819     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7820     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7821     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7822     MOVE PB-STATE               TO ACCT-STATE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 145
* EL050.cbl
  7823     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7824     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7825
  7826     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7827
  7828     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7829
  7830 0110-FIND-ACCT-TOLERANCES-LOOP.
  7831     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7832
  7833     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7834        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7835        GO TO 0199-ACCT-NOT-FOUND
  7836     END-IF
  7837     IF PB-CARRIER NOT = SPACES
  7838        IF PB-CARRIER NOT = AM-VG-CARRIER
  7839           GO TO 0199-ACCT-NOT-FOUND.
  7840
  7841     IF PB-STATE NOT = SPACES
  7842        IF PB-STATE NOT = AM-VG-STATE
  7843           GO TO 0199-ACCT-NOT-FOUND.
  7844
  7845     IF PB-GROUPING NOT = SPACES
  7846        IF PB-GROUPING NOT = AM-VG-GROUPING
  7847           GO TO 0199-ACCT-NOT-FOUND.
  7848
  7849     MOVE 'X'                    TO DATE-RANGE-SW.
  7850
  7851     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7852        MOVE 'X'                 TO DATE-RANGE-SW
  7853        GO TO 0199-ACCT-NOT-FOUND.
  7854
  7855     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7856        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7857
  7858 0180-ACCOUNT-FOUND.
  7859     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7860     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7861     MOVE AM-STATE               TO PB-SV-STATE.
  7862     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7863
  7864     IF AM-CANCEL-FEE  NOT NUMERIC
  7865        MOVE ZEROS TO AM-CANCEL-FEE.
  7866
  7867     IF AM-MAX-MON-BEN NOT NUMERIC
  7868        MOVE ZEROS TO AM-MAX-MON-BEN.
  7869
  7870     IF AM-MAX-TOT-BEN NOT NUMERIC
  7871        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7872
  7873     IF AM-CLP-TOL-PCT NOT NUMERIC
  7874        MOVE +0                  TO AM-CLP-TOL-PCT
  7875     END-IF
  7876     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7877        MOVE +0                  TO AM-SPP-LEASE-COMM
  7878     END-IF
  7879     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7880        MOVE ER-2611             TO   WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 146
* EL050.cbl
  7881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7882
  7883     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7884        MOVE ER-2621             TO   WS-ERROR
  7885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7886
  7887     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7888        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7889        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7890        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7891         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7892
  7893     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7894     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7895     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7896     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7897     IF AM-CLP-TOL-PCT NOT = ZEROS
  7898        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7899     END-IF
  7900     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7901        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7902     END-IF
  7903*    IF PB-COMPANY-ID = 'DCC'
  7904*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7905*                                   WS-ADMIN-FEES
  7906*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7907*          (SUB5 > +10)
  7908*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7909*             AND (AM-A-COM (SUB5) NUMERIC)
  7910*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7911*                + (AM-A-COM (SUB5) * 1000)
  7912*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7913*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7914*                + (AM-A-COM (SUB5) * 1000)
  7915*             END-IF
  7916*             IF AM-COM-TYP (SUB5) = 'N'
  7917*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7918*                + (AM-A-COM (SUB5) * 1000)
  7919*             END-IF
  7920*          END-IF
  7921*       END-PERFORM
  7922*    END-IF
  7923     IF (PB-COMPANY-ID = 'DCC')
  7924        AND (PB-ISSUE)
  7925        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7926        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7927           (SUB5 > +10)
  7928           MOVE +0 TO WS-WK-RATE
  7929           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7930              IF (AM-A-COM (SUB5) NUMERIC)
  7931                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7932                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7933              ELSE
  7934                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7935                 IF PB-ISSUE
  7936                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7937                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7938                 ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 147
* EL050.cbl
  7939                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7940                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7941                 END-IF
  7942                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7943                 MOVE ZEROS             TO WS-SUB1
  7944                                           WS-COMMISSION
  7945                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7946                 MOVE '0530'               TO CTBL-SW
  7947                 MOVE ' '                  TO WS-CTBL-READ-SW
  7948                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7949                 IF FIRST-TIME-THROUGH
  7950                    MOVE 'AA'              TO CTBL-BEN-CODE
  7951                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7952                 END-IF
  7953                 IF CTBL-TABLE-FOUND
  7954                    IF PB-ISSUE
  7955                       COMPUTE WS-COMM-CK-AMT =
  7956                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7957                    ELSE
  7958                       COMPUTE WS-COMM-CK-AMT =
  7959                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7960                    END-IF
  7961                    PERFORM 8800-GET-COMP-RATE
  7962                              THRU 8800-EXIT
  7963                 END-IF
  7964              END-IF
  7965              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7966                + (WS-WK-RATE * 1000)
  7967           END-IF
  7968        END-PERFORM
  7969     END-IF
  7970     IF PB-COMPANY-ID EQUAL 'CRI'
  7971         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7972
  7973     IF PB-COMPANY-ID EQUAL 'NCL'
  7974         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7975     END-IF
  7976
  7977     GO TO 0200-READ-CERT.
  7978
  7979 0199-ACCT-NOT-FOUND.
  7980
  7981     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7982
  7983     IF DATE-RANGE-SW NOT = SPACES
  7984        MOVE ER-2601             TO WS-ERROR
  7985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7986     ELSE
  7987        MOVE ER-2619             TO WS-ERROR
  7988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7989
  7990     GO TO 9990-RETURN.
  7991
  7992 0200-READ-CERT.
  7993
  7994     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7995     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7996     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 148
* EL050.cbl
  7997     MOVE PB-SV-STATE            TO CERT-STATE.
  7998     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7999     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8000     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8001
  8002     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8003
  8004     IF CERT-WAS-NOT-FOUND
  8005        GO TO 0299-CERT-NOT-FOUND.
  8006
  8007     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8008        MOVE ER-2759             TO WS-ERROR
  8009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8010        GO TO 0298-UNLOCK-RETURN.
  8011
  8012     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8013         MOVE ER-2758            TO WS-ERROR
  8014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8015         GO TO 0298-UNLOCK-RETURN.
  8016
  8017     IF PB-ISSUE
  8018        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8019           IF CERT-WAS-CREATED-FOR-CLAIM
  8020              NEXT SENTENCE
  8021            ELSE
  8022              MOVE ER-2626       TO WS-ERROR
  8023              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8024              GO TO 0298-UNLOCK-RETURN.
  8025
  8026     IF NOT PB-CANCELLATION
  8027        GO TO 0300-CONTINUE-EDIT.
  8028
  8029     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8030     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8031     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8032     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8033     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8034     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8035
  8036     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8037     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8038     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8039     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8040     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8041     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8042     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8043     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8044     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8045
  8046     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8047     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8048     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8049     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8050     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8051     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8052     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8053
  8054     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 149
* EL050.cbl
  8055     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8056
  8057     MOVE CM-CREDIT-INTERFACE-SW-1
  8058                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8059     MOVE CM-CREDIT-INTERFACE-SW-2
  8060                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8061
  8062     IF CM-O-B-COVERAGE
  8063         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8064
  8065     IF CM-LIVES NOT NUMERIC
  8066         MOVE ZERO                TO CM-LIVES.
  8067
  8068     IF CM-BILLED NOT NUMERIC
  8069         MOVE ZERO                TO CM-BILLED.
  8070
  8071     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8072         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8073         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8074         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8075         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8076         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8077         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8078         MOVE CM-LIVES             TO PB-CI-LIVES
  8079*The next line causes a problem with my change  I dont think it is
  8080*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8081
  8082     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8083     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8084     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8085     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8086     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8087     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8088
  8089     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8090     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8091     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8092     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8093
  8094     IF CM-LIFE-COMM-PCT NUMERIC
  8095         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8096     ELSE
  8097         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8098
  8099     IF CM-AH-COMM-PCT NUMERIC
  8100         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8101     ELSE
  8102         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8103
  8104     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8105
  8106     IF CM-LOAN-APR       NOT NUMERIC
  8107           MOVE ZERO               TO CM-LOAN-APR.
  8108
  8109     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8110           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8111
  8112     IF CM-LOAN-TERM      NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 150
* EL050.cbl
  8113           MOVE ZERO               TO CM-LOAN-TERM.
  8114
  8115     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8116           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8117
  8118     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8119           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8120
  8121     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8122     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8123     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8124     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8125     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8126     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8127     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8128     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8129     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8130     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8131     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8132     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8133
  8134     IF CM-STATE = CM-SSN-STATE
  8135         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8136
  8137     IF CM-STATE NOT = CM-MEMB-STATE
  8138         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8139
  8140     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8141
  8142     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8143        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8144        IF CM-ADDL-CLP NOT NUMERIC
  8145           MOVE +0               TO CM-ADDL-CLP
  8146        END-IF
  8147        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8148        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8149           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8150        END-IF
  8151     END-IF
  8152     IF PB-COMPANY-ID = 'DCC'
  8153        MOVE +0                  TO WS-ADMIN-FEES
  8154                                    WS-CSO-ADMIN-FEE
  8155                                    WS-COMM-AND-MFEE
  8156                                    WS-1ST-YR-ALLOW
  8157        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8158           (SUB5 > +10)
  8159           MOVE +0 TO WS-WK-RATE
  8160           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8161              IF (AM-A-COM (SUB5) NUMERIC)
  8162                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8163                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8164              ELSE
  8165                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8166                 IF PB-ISSUE
  8167                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8168                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8169                 ELSE
  8170                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 151
* EL050.cbl
  8171                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8172                 END-IF
  8173                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8174                 MOVE ZEROS             TO WS-SUB1
  8175                                           WS-COMMISSION
  8176                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8177                 MOVE '0530'               TO CTBL-SW
  8178                 MOVE ' '                  TO WS-CTBL-READ-SW
  8179                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8180                 IF FIRST-TIME-THROUGH
  8181                    MOVE 'AA'              TO CTBL-BEN-CODE
  8182                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8183                 END-IF
  8184                 IF CTBL-TABLE-FOUND
  8185                    IF PB-ISSUE
  8186                       COMPUTE WS-COMM-CK-AMT =
  8187                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8188                    ELSE
  8189                       COMPUTE WS-COMM-CK-AMT =
  8190                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8191                    END-IF
  8192                    PERFORM 8800-GET-COMP-RATE
  8193                              THRU 8800-EXIT
  8194                 END-IF
  8195              END-IF
  8196              IF AM-COM-TYP (SUB5) = 'I'
  8197                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8198                   + (WS-WK-RATE * 1000)
  8199              END-IF
  8200              IF AM-COM-TYP (SUB5) = 'N'
  8201                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8202                   + (WS-WK-RATE * 1000)
  8203              END-IF
  8204              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8205                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8206                   + (WS-WK-RATE * 1000)
  8207              END-IF
  8208              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8209                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8210                   + (WS-WK-RATE * 1000)
  8211              END-IF
  8212           END-IF
  8213        END-PERFORM
  8214     END-IF
  8215     GO TO 0300-CONTINUE-EDIT.
  8216
  8217 0298-UNLOCK-RETURN.
  8218      PERFORM 9250-UNLOCK-RETURN
  8219      GO TO 9990-RETURN.
  8220
  8221 0299-CERT-NOT-FOUND.
  8222
  8223     MOVE '1'                     TO CERT-STATUS-SW.
  8224
  8225     IF PB-COMPANY-ID = 'UCL'
  8226         IF WS-ERROR = ER-2799
  8227             GO TO 3000-CONTINUE-EDIT.
  8228
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 152
* EL050.cbl
  8229     IF NOT PB-CANCELLATION
  8230         GO TO 0300-CONTINUE-EDIT.
  8231
  8232     MOVE ER-2726                  TO  WS-ERROR.
  8233     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8234     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8235     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8236                                    PB-CI-LF-TERM
  8237                                    PB-C-LF-REM-TERM
  8238                                    PB-CI-AH-TERM
  8239                                    PB-C-AH-REM-TERM
  8240                                    PB-CI-LF-BENEFIT-CD
  8241                                    PB-CI-LF-BENEFIT-AMT
  8242                                    PB-CI-LF-ALT-BENEFIT-AMT
  8243                                    PB-CI-LF-PREMIUM-AMT
  8244                                    PB-CI-LF-ALT-PREMIUM-AMT
  8245                                    PB-CI-AH-BENEFIT-CD
  8246                                    PB-CI-AH-BENEFIT-AMT
  8247                                    PB-CI-AH-PREMIUM-AMT
  8248                                    PB-CI-PAY-FREQUENCY
  8249                                    PB-CI-LOAN-APR
  8250                                    PB-CI-LOAN-TERM
  8251                                    PB-CI-LIFE-COMMISSION
  8252                                    PB-CI-AH-COMMISSION
  8253                                    PB-CI-CURR-SEQ
  8254                                    PB-CI-AH-CANCEL-AMT
  8255                                    PB-CI-LF-CANCEL-AMT
  8256                                    PB-CI-RATE-DEV-PCT-LF
  8257                                    PB-CI-RATE-DEV-PCT-AH
  8258                                    PB-CI-EXTENTION-DAYS
  8259                                    PB-CI-TERM-IN-DAYS
  8260                                    PB-CI-LIVES
  8261                                    PB-CI-LF-CRIT-PER
  8262                                    PB-CI-AH-CRIT-PER
  8263                                    PB-CI-ADDL-CLP
  8264                                    PB-CI-DDF-IU-RATE-UP.
  8265
  8266     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8267                                    PB-CI-AH-SETTLEMENT-DT
  8268                                    PB-CI-DEATH-DT
  8269                                    PB-CI-LF-PRIOR-CANCEL-DT
  8270                                    PB-CI-AH-PRIOR-CANCEL-DT
  8271                                    PB-CI-ENTRY-DT
  8272                                    PB-CI-LF-EXPIRE-DT
  8273                                    PB-CI-AH-EXPIRE-DT
  8274                                    PB-CI-LOAN-1ST-PMT-DT.
  8275
  8276     IF ACCOUNT-MAST-FOUND
  8277        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8278        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8279
  8280     GO TO 3000-CONTINUE-EDIT.
  8281
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 153
* EL050.cbl
  8283
  8284 0300-CONTINUE-EDIT.
  8285
  8286     IF PB-ISSUE
  8287        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8288            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8289
  8290     IF PB-ISSUE
  8291        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8292            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8293
  8294     IF PB-ISSUE
  8295       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8296          (AM-NO-AH-ONLY)
  8297           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8298               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8299                   MOVE ER-2679 TO WS-ERROR
  8300                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8301
  8302     IF PB-ISSUE
  8303        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8304        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8305        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8306     ELSE
  8307        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8308        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8309        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8310
  8311     MOVE 'N'                    TO PLAN-MASTER-SW
  8312                                    PLAN-MASTER-LIFE-SW
  8313                                    FORM-MASTER-SW
  8314                                    WS-APP-CERT-SW.
  8315
  8316     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8317                                    WS-PL-TOL-LF-REFUND
  8318                                    WS-PL-REF-OVS-AMT
  8319                                    WS-PL-TOL-LF-PREM-PCT
  8320                                    WS-PL-TOL-LF-REFUND-PCT
  8321                                    WS-PL-REF-OVS-PCT
  8322                                    WS-PL-TOL-LF-CLAIM.
  8323
  8324     IF PB-COMPANY-ID = 'NCL'
  8325       IF PB-ISSUE
  8326         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8327             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8328             IF FORM-MASTER-FOUND
  8329                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8330
  8331     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8332        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8333
  8334********************** MON CODE **********************
  8335     IF PB-COMPANY-ID = 'MON'
  8336     IF PB-ISSUE
  8337     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8338        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8339             PB-I-LOAN-APR = ZERO)
  8340               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 154
* EL050.cbl
  8341******************************************************
  8342
  8343     IF PB-COMPANY-ID = 'NCL'
  8344       IF PB-ISSUE
  8345           IF FORM-MASTER-FOUND
  8346             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8347                AM-DISMBR-COVERAGE
  8348                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8349                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8350                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8351                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8352                                           PB-I-LIFE-BENEFIT-CD.
  8353
  8354     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8355
  8356     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8357         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8358         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8359         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8360         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8361         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8362           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8363             GO TO 0301-LIFE-BENEFIT-SEARCH
  8364         ELSE
  8365             NEXT SENTENCE
  8366     ELSE
  8367         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8368
  8369     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8370     MOVE '4'                    TO CNTL-REC-TYPE.
  8371     MOVE +0                     TO CNTL-SEQ-NO.
  8372     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8373
  8374     MOVE '1' TO RC-SW-2.
  8375     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8376
  8377     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8378        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8379         GO TO 0305-BENEFIT-NOT-FOUND.
  8380
  8381     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8382
  8383 0301-LIFE-BENEFIT-SEARCH.
  8384
  8385     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8386
  8387     IF NO-BENEFIT-FOUND
  8388        GO TO 0305-BENEFIT-NOT-FOUND.
  8389
  8390     IF WS-BEN-CD = '99'
  8391        GO TO 0305-BENEFIT-NOT-FOUND.
  8392
  8393     IF PB-COMPANY-ID = 'NCL'
  8394         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8395             GO TO 0304-LIFE-BENEFIT-FOUND.
  8396
  8397     MOVE +1                     TO SUB5.
  8398     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 155
* EL050.cbl
  8399
  8400* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8401* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8402     IF PB-COMPANY-ID = 'DMD'
  8403         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8404
  8405 0302-EDIT-ACCT-LF-BENEFITS.
  8406
  8407     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8408        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8409           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8410                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8411           GO TO 03XX-GET-LIFE-ERPLAN.
  8412
  8413     IF SUB5 LESS THAN +20
  8414        ADD +1                   TO SUB5
  8415        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8416
  8417     MOVE +1                     TO SUB5.
  8418
  8419     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8420        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8421
  8422 0303-EDIT-DMD-EXTRA-BENEFITS.
  8423
  8424     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8425        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8426           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8427                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8428           GO TO 03XX-GET-LIFE-ERPLAN.
  8429
  8430     IF SUB5 LESS THAN +30
  8431        ADD +1                   TO SUB5
  8432        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8433
  8434     MOVE +1                     TO SUB5.
  8435
  8436 03XX-EDIT-FOR-NINETY-LF.
  8437
  8438***************************************************************
  8439*                                                             *
  8440*    NINETY BENEFIT PLAN TYPES:                               *
  8441*                                                             *
  8442*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8443*      92 = ALL GROUP REDUCING BENEFITS                       *
  8444*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8445*      94 = ALL GROUP LEVEL BENEFITS                          *
  8446*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8447*           BENEFIT CONTROLS.                                 *
  8448*      99 = ALL BENEFITS                                      *
  8449*                                                             *
  8450***************************************************************
  8451
  8452     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8453                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8454
  8455     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8456       AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 156
* EL050.cbl
  8457        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8458        GO TO 03XX-GET-LIFE-ERPLAN.
  8459
  8460     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8461       AND
  8462        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8463        IF CF-REDUCING (SUB3)
  8464           IF (PB-I-INDV-GRP-OVRD = 'I')
  8465              OR
  8466           ((AM-IG = '1') AND
  8467           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8468              OR
  8469           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8470           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8471           (AM-IG NOT = '2'))
  8472              GO TO 03XX-GET-LIFE-ERPLAN.
  8473
  8474     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8475       AND
  8476        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8477        IF CF-REDUCING (SUB3)
  8478           IF (PB-I-INDV-GRP-OVRD = 'G')
  8479              OR
  8480           ((AM-IG = '2') AND
  8481           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8482              OR
  8483           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8484           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8485           (AM-IG NOT = '1'))
  8486              GO TO 03XX-GET-LIFE-ERPLAN.
  8487
  8488     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8489       AND
  8490        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8491        IF CF-LEVEL    (SUB3)
  8492           IF (PB-I-INDV-GRP-OVRD = 'I')
  8493              OR
  8494           ((AM-IG = '1') AND
  8495           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8496              OR
  8497           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8498           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8499            (AM-IG NOT = '2'))
  8500              GO TO 03XX-GET-LIFE-ERPLAN.
  8501
  8502     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8503       AND
  8504        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8505        IF CF-LEVEL    (SUB3)
  8506           IF (PB-I-INDV-GRP-OVRD = 'G')
  8507              OR
  8508           ((AM-IG = '2') AND
  8509           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8510              OR
  8511           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8512           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8513           (AM-IG NOT = '1'))
  8514              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 157
* EL050.cbl
  8515
  8516     IF SUB5 LESS THAN +20
  8517        ADD +1                   TO SUB5
  8518        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8519
  8520     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8521
  8522     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8523        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8524
  8525     MOVE +1                     TO SUB5.
  8526
  8527 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8528
  8529     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8530                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8531
  8532     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8533       AND
  8534        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8535        GO TO 03XX-GET-LIFE-ERPLAN.
  8536
  8537     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8538       AND
  8539        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8540        IF CF-REDUCING (SUB3)
  8541           IF (PB-I-INDV-GRP-OVRD = 'I')
  8542              OR
  8543           ((AM-IG = '1') AND
  8544           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8545              OR
  8546           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8547           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8548           (AM-IG NOT = '2'))
  8549              GO TO 03XX-GET-LIFE-ERPLAN.
  8550
  8551     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8552       AND
  8553        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8554        IF CF-REDUCING (SUB3)
  8555           IF (PB-I-INDV-GRP-OVRD = 'G')
  8556              OR
  8557           ((AM-IG = '2') AND
  8558           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8559              OR
  8560           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8561           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8562           (AM-IG NOT = '1'))
  8563              GO TO 03XX-GET-LIFE-ERPLAN.
  8564
  8565     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8566       AND
  8567        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8568        IF CF-LEVEL    (SUB3)
  8569           IF (PB-I-INDV-GRP-OVRD = 'I')
  8570              OR
  8571           ((AM-IG = '1') AND
  8572           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 158
* EL050.cbl
  8573              OR
  8574           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8575           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8576            (AM-IG NOT = '2'))
  8577              GO TO 03XX-GET-LIFE-ERPLAN.
  8578
  8579     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8580       AND
  8581        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8582        IF CF-LEVEL    (SUB3)
  8583           IF (PB-I-INDV-GRP-OVRD = 'G')
  8584              OR
  8585           ((AM-IG = '2') AND
  8586           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8587              OR
  8588           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8589           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8590           (AM-IG NOT = '1'))
  8591              GO TO 03XX-GET-LIFE-ERPLAN.
  8592
  8593     IF SUB5 LESS THAN +30
  8594        ADD +1                   TO SUB5
  8595        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8596
  8597     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8598
  8599 03XX-EDIT-FOR-NINETY-LF-CONT.
  8600
  8601     MOVE +99                    TO SUB5.
  8602
  8603     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8604        IF PB-ISSUE
  8605           MOVE ER-1924          TO  WS-ERROR
  8606           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8607
  8608     GO TO 0304-LIFE-BENEFIT-FOUND.
  8609
  8610 03XX-GET-LIFE-ERPLAN.
  8611
  8612     IF WK-PLAN-ADDR EQUAL +0
  8613        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8614
  8615     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8616     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8617     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8618     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8619     MOVE 'Y'                    TO PLAN-MASTER-SW
  8620                                    PLAN-MASTER-LIFE-SW.
  8621     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8622
  8623 03XX-ERPLAN-LIFE-GETMAIN.
  8624
  8625     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8626     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8627
  8628 03XX-ERPLAN-LIFE-READ.
  8629
  8630     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 159
* EL050.cbl
  8631     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8632     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8633     MOVE PB-SV-STATE            TO PLAN-STATE.
  8634     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8635     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8636     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8637     MOVE WS-SAVE-BENEFIT-REVISION
  8638                                 TO PLAN-REVISION-NO.
  8639
  8640     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8641     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8642
  8643     IF PB-COMPANY-ID = 'NCL'
  8644       IF NOT LF-PLAN-MASTER-FOUND
  8645         IF NOT PB-POLICY-IS-DECLINED  AND
  8646            NOT PB-POLICY-IS-VOIDED
  8647             MOVE  ER-1921         TO  WS-ERROR
  8648             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8649             GO TO 0304-LIFE-BENEFIT-FOUND.
  8650
  8651     IF NOT LF-PLAN-MASTER-FOUND
  8652        GO TO 0304-LIFE-BENEFIT-FOUND.
  8653
  8654 XXXX-CHECK-LF-PLAN-KEY.
  8655
  8656     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8657        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8658        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8659        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8660        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8661        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8662        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8663        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8664        MOVE 'N'                 TO PLAN-MASTER-SW
  8665          GO TO 03XX-ERPLAN-LIFE-READ.
  8666
  8667     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8668
  8669     IF  PB-CANCELLATION
  8670         GO TO  0303-LF-ACCT-BEN-FOUND.
  8671
  8672     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8673        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8674           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8675           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8676              MOVE ER-2644             TO WS-ERROR
  8677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8678           ELSE
  8679              NEXT SENTENCE
  8680        ELSE
  8681           IF PB-COMPANY-ID NOT = 'NCL'
  8682              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8683                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8684
  8685 0303-LF-ACCT-BEN-FOUND.
  8686
  8687     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8688
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 160
* EL050.cbl
  8689     IF PL-DEV-CODE NOT = SPACES
  8690        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8691
  8692     IF PL-DEV-PCT NUMERIC AND
  8693        PL-DEV-PCT NOT = ZEROS
  8694        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8695
  8696     IF PL-TOL-PREM-AMT GREATER THAN +0
  8697        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8698
  8699     IF PL-TOL-REF-AMT GREATER THAN +0
  8700        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8701
  8702     IF PL-TOL-PREM-PCT GREATER THAN +0
  8703        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8704
  8705     IF PL-TOL-REF-PCT GREATER THAN +0
  8706        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8707
  8708     IF PL-TOL-CLM-AMT GREATER THAN +0
  8709        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8710
  8711     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8712                          PL-OVER-SHORT-AMT > +0
  8713        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8714
  8715     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8716                          PL-OVER-SHORT-PCT > +0
  8717        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8718
  8719     IF PL-SALES-TAX NUMERIC AND
  8720                          PL-SALES-TAX > +0
  8721         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8722
  8723     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8724        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8725                                    WS-IG-OVRD-AM.
  8726
  8727 0304-LIFE-BENEFIT-FOUND.
  8728
  8729     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8730
  8731     IF PB-ISSUE
  8732        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8733     ELSE
  8734        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8735
  8736     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8737     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8738     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8739     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8740     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8741                                         WS-LF-REFUND-CALC.
  8742
  8743     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8744        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8745
  8746     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 161
* EL050.cbl
  8747        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8748     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8749
  8750     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8751     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8752     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8753     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8754     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8755     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8756
  8757     IF PB-COMPANY-ID = 'NCL'  AND
  8758        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8759         NEXT SENTENCE
  8760     ELSE
  8761         IF SUB5 NOT GREATER THAN +20
  8762            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8763               MOVE WS-SAVE-BENEFIT-REM-TERM
  8764                                      TO WS-AM-LF-BENE-REM-TERM
  8765                                         EC-BR-LF-REM-TERM-CALC.
  8766
  8767     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8768     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8769
  8770     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8771
  8772 0305-BENEFIT-NOT-FOUND.
  8773
  8774     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8775     MOVE ER-2604                TO WS-ERROR.
  8776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8777
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 162
* EL050.cbl
  8779
  8780 0310-FIND-AH-BENEFIT-RECORD.
  8781
  8782     MOVE 'N'                    TO PLAN-MASTER-SW
  8783                                    PLAN-MASTER-AH-SW.
  8784
  8785     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8786                                    WS-PL-TOL-AH-REFUND
  8787                                    WS-AH-PL-REF-OVS-AMT
  8788                                    WS-PL-TOL-AH-PREM-PCT
  8789                                    WS-PL-TOL-AH-REFUND-PCT
  8790                                    WS-AH-PL-REF-OVS-PCT
  8791                                    WS-PL-TOL-AH-CLAIM.
  8792     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8793
  8794
  8795     if pb-issue
  8796        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8797           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8798        end-if
  8799        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8800           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8801           GO TO 0399-BENEFIT-NOT-FOUND
  8802        end-if
  8803     end-if
  8804
  8805     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8806        GO TO 0400-FIND-CARRIER.
  8807
  8808     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8809
  8810     IF WK-AH-BEN-ADDR NOT = ZEROS
  8811         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8812         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8813         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8814         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8815           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8816             GO TO 0311-AH-BENEFIT-SEARCH
  8817         ELSE
  8818             NEXT SENTENCE
  8819     ELSE
  8820         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8821
  8822     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8823     MOVE '5'                    TO CNTL-REC-TYPE.
  8824     MOVE +0                     TO CNTL-SEQ-NO.
  8825     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8826
  8827     MOVE '2' TO RC-SW-2.
  8828     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8829
  8830     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8831        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8832          GO TO 0399-BENEFIT-NOT-FOUND.
  8833
  8834     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8835
  8836 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 163
* EL050.cbl
  8837
  8838     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8839
  8840     IF NO-BENEFIT-FOUND
  8841         GO TO 0399-BENEFIT-NOT-FOUND.
  8842
  8843     IF WS-BEN-CD = '99'
  8844        GO TO 0399-BENEFIT-NOT-FOUND.
  8845
  8846     IF PB-COMPANY-ID  =  'NCL'
  8847         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8848             GO TO 0314-A-H-BENEFIT-FOUND.
  8849
  8850     MOVE +1                     TO SUB5.
  8851     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8852
  8853* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8854* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8855     IF PB-COMPANY-ID = 'DMD'
  8856         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8857
  8858 0312-EDIT-ACCT-AH-BENEFITS.
  8859
  8860     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8861        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8862           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8863                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8864           GO TO 03XX-GET-AH-ERPLAN.
  8865
  8866     IF SUB5 LESS THAN +20
  8867        ADD +1                   TO SUB5
  8868        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8869
  8870     MOVE +1                     TO SUB5.
  8871
  8872     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8873        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8874
  8875 0313-EDIT-DMD-EXTRA-BENEFITS.
  8876
  8877     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8878        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8879           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8880                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8881           GO TO 03XX-GET-AH-ERPLAN.
  8882
  8883     IF SUB5 LESS THAN +30
  8884        ADD +1                   TO SUB5
  8885        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8886
  8887     MOVE +1                     TO SUB5.
  8888
  8889 03XX-EDIT-FOR-NINETY-AH.
  8890
  8891***************************************************************
  8892*                                                             *
  8893*    NINETY BENEFIT PLAN TYPES:                               *
  8894*                                                             *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 164
* EL050.cbl
  8895*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8896*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8897*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8898*           BENEFIT CONTROLS.                                 *
  8899*      99 = ALL BENEFITS.                                     *
  8900*                                                             *
  8901***************************************************************
  8902
  8903     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8904                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8905
  8906     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8907       AND
  8908        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8909        GO TO 03XX-GET-AH-ERPLAN.
  8910
  8911     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8912       AND
  8913        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8914           IF (PB-I-INDV-GRP-OVRD = 'I')
  8915              OR
  8916           ((AM-IG = '1') AND
  8917           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8918              OR
  8919           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8920           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8921           (AM-IG NOT = '2'))
  8922              GO TO 03XX-GET-AH-ERPLAN.
  8923
  8924     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8925       AND
  8926        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8927           IF (PB-I-INDV-GRP-OVRD = 'G')
  8928              OR
  8929           ((AM-IG = '2') AND
  8930           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8931              OR
  8932           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8933           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8934           (AM-IG NOT = '1'))
  8935              GO TO 03XX-GET-AH-ERPLAN.
  8936
  8937     IF SUB5 LESS THAN +20
  8938        ADD +1                   TO SUB5
  8939        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8940
  8941     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8942        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8943
  8944     MOVE +1                    TO SUB5.
  8945
  8946 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8947
  8948     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8949                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8950
  8951     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8952       AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 165
* EL050.cbl
  8953        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8954        GO TO 03XX-GET-AH-ERPLAN.
  8955
  8956     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8957       AND
  8958        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8959           IF (PB-I-INDV-GRP-OVRD = 'I')
  8960              OR
  8961           ((AM-IG = '1') AND
  8962           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8963              OR
  8964           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8965           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8966           (AM-IG NOT = '2'))
  8967              GO TO 03XX-GET-AH-ERPLAN.
  8968
  8969     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8970       AND
  8971        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8972           IF (PB-I-INDV-GRP-OVRD = 'G')
  8973              OR
  8974           ((AM-IG = '2') AND
  8975           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8976              OR
  8977           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8978           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8979           (AM-IG NOT = '1'))
  8980              GO TO 03XX-GET-AH-ERPLAN.
  8981
  8982     IF SUB5 LESS THAN +30
  8983        ADD +1                   TO SUB5
  8984        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8985
  8986 03XX-EDIT-FOR-NINETY-AH-CONT.
  8987
  8988     MOVE +99                    TO SUB5.
  8989
  8990     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8991
  8992     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8993        IF PB-ISSUE
  8994           MOVE ER-1925          TO  WS-ERROR
  8995           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8996
  8997     GO TO 0314-A-H-BENEFIT-FOUND.
  8998
  8999 03XX-GET-AH-ERPLAN.
  9000
  9001     IF WK-PLAN-ADDR EQUAL +0
  9002         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9003
  9004     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9005     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9006     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9007     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9008     MOVE 'Y'                    TO PLAN-MASTER-SW
  9009                                    PLAN-MASTER-AH-SW.
  9010*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 166
* EL050.cbl
  9011     GO TO 03XX-ERPLAN-AH-READ.
  9012
  9013 03XX-ERPLAN-AH-GETMAIN.
  9014
  9015     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9016     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9017
  9018 03XX-ERPLAN-AH-READ.
  9019
  9020     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9021     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9022     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9023     MOVE PB-SV-STATE            TO PLAN-STATE.
  9024     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9025     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9026     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9027     MOVE WS-SAVE-BENEFIT-REVISION
  9028                                 TO PLAN-REVISION-NO.
  9029
  9030     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9031     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9032
  9033     IF PB-COMPANY-ID = 'NCL'
  9034       IF NOT AH-PLAN-MASTER-FOUND
  9035         IF NOT PB-POLICY-IS-DECLINED  AND
  9036            NOT PB-POLICY-IS-VOIDED
  9037             MOVE  ER-1922         TO  WS-ERROR
  9038             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9039             GO TO 0314-A-H-BENEFIT-FOUND.
  9040
  9041     IF NOT AH-PLAN-MASTER-FOUND
  9042        GO TO 0314-A-H-BENEFIT-FOUND.
  9043
  9044 XXXX-CHECK-AH-PLAN-KEY.
  9045
  9046     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9047        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9048        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9049        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9050        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9051        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9052        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9053        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9054        MOVE 'N'                 TO PLAN-MASTER-SW
  9055          GO TO 03XX-ERPLAN-AH-READ.
  9056
  9057     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9058
  9059     IF  PB-CANCELLATION
  9060         GO TO  0313-AH-ACCT-BEN-FOUND.
  9061
  9062     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9063       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9064          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9065          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9066             MOVE ER-2644             TO WS-ERROR
  9067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9068          ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 167
* EL050.cbl
  9069             NEXT SENTENCE
  9070       ELSE
  9071          IF PB-COMPANY-ID NOT = 'NCL'
  9072             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9073                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9074
  9075 0313-AH-ACCT-BEN-FOUND.
  9076
  9077     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9078
  9079     IF PL-DEV-CODE NOT = SPACES
  9080        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9081
  9082     IF PL-DEV-PCT NUMERIC AND
  9083        PL-DEV-PCT NOT = ZEROS
  9084        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9085
  9086     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9087        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9088
  9089     IF PL-TOL-REF-AMT NOT EQUAL +0
  9090        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9091
  9092     IF PL-TOL-PREM-PCT GREATER THAN +0
  9093        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9094
  9095     IF PL-TOL-REF-PCT GREATER THAN +0
  9096        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9097
  9098     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9099        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9100
  9101     IF PL-OVER-SHORT-AMT NUMERIC AND
  9102                          PL-OVER-SHORT-AMT > +0
  9103        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9104
  9105     IF PL-OVER-SHORT-PCT NUMERIC AND
  9106                          PL-OVER-SHORT-PCT > +0
  9107        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9108
  9109     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9110        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9111        IF WS-IG-OVRD-AM EQUAL SPACES
  9112            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9113
  9114 0314-A-H-BENEFIT-FOUND.
  9115
  9116     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9117
  9118     IF PB-ISSUE
  9119        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9120       ELSE
  9121        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9122
  9123     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9124     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9125     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9126     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 168
* EL050.cbl
  9127                                         WS-AH-REFUND-CALC.
  9128
  9129     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9130        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9131
  9132     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9133        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9134     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9135
  9136     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9137     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9138     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9139     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9140     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9141     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9142
  9143     IF PB-COMPANY-ID = 'NCL'  AND
  9144        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9145         NEXT SENTENCE
  9146     ELSE
  9147         IF SUB5 NOT GREATER THAN +20
  9148            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9149                MOVE WS-SAVE-BENEFIT-REM-TERM
  9150                                      TO WS-AM-AH-BENE-REM-TERM
  9151                                         EC-BR-AH-REM-TERM-CALC.
  9152
  9153     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9154     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9155
  9156     GO TO 0400-FIND-CARRIER.
  9157
  9158 0399-BENEFIT-NOT-FOUND.
  9159
  9160     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9161     MOVE ER-2605                TO WS-ERROR.
  9162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9163
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 169
* EL050.cbl
  9165
  9166 0400-FIND-CARRIER.
  9167
  9168     MOVE PB-SV-CARRIER          TO WS-CARR.
  9169
  9170     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9171     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9172     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9173     MOVE '6'                    TO CNTL-REC-TYPE.
  9174
  9175*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9176     MOVE SPACE                  TO WS-DMD-RATING-SW
  9177                                    EC-BR-DMD-RATING-SW.
  9178
  9179     MOVE '2'                    TO RC-SW-1.
  9180     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9181
  9182     IF NOT CF-CARRIER-MASTER
  9183        GO TO 0400-CARRIER-NOT-FOUND.
  9184
  9185 0400-BUILD-CARR-TOL.
  9186
  9187     IF CF-CR-TOL-PREM NUMERIC AND
  9188        CF-CR-TOL-PREM GREATER THAN +0
  9189        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9190                                    WS-TOL-AH-PREM.
  9191
  9192     IF CF-CR-TOL-REFUND NUMERIC AND
  9193        CF-CR-TOL-REFUND GREATER THAN +0
  9194        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9195                                    WS-TOL-AH-REFUND.
  9196
  9197     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9198        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9199        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9200                                    WS-AH-REFUND-OVS-AMT.
  9201
  9202     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9203        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9204        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9205                                    WS-AH-REFUND-OVS-PCT.
  9206
  9207     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9208        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9209        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9210                                    WS-TOL-AH-PREM-PCT.
  9211
  9212     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9213        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9214        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9215                                     WS-TOL-AH-REFUND-PCT.
  9216
  9217     IF CF-COMPANY-ID EQUAL 'DMD'
  9218         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9219                                    EC-BR-DMD-RATING-SW.
  9220
  9221     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9222     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 170
* EL050.cbl
  9223        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9224     END-IF
  9225     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9226        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9227     END-IF
  9228     IF WS-TOL-CLP-PCT = ZEROS
  9229        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9230     END-IF
  9231
  9232     IF WS-SPP-LEASE-COMM = ZEROS
  9233        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9234     END-IF
  9235     GO TO 0400-FIND-ERPDEF.
  9236
  9237 0400-CARRIER-NOT-FOUND.
  9238
  9239     MOVE ER-2602                TO WS-ERROR.
  9240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9241
  9242 0400-FIND-ERPDEF.
  9243     IF PB-COMPANY-ID = 'DCC'
  9244        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9245        CONTINUE
  9246     ELSE
  9247        GO TO 0400-FIND-ERCOMP
  9248     END-IF
  9249     MOVE ' '                    TO PDEF-MASTER-SW
  9250     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9251     MOVE PB-STATE               TO ERPDEF-STATE
  9252     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9253     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9254     IF PB-ISSUE
  9255        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9256     ELSE
  9257        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9258     END-IF
  9259     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9260     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9261     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9262     IF PDEF-MASTER-FOUND
  9263        MOVE 'N'                 TO PDEF-MASTER-SW
  9264        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9265        IF PDEF-MASTER-FOUND
  9266           IF (ERPDEF-KEY-SAVE (1:16) =
  9267                        PD-CONTROL-PRIMARY (1:16))
  9268              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9269              CONTINUE
  9270           ELSE
  9271              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9272              IF (ERPDEF-KEY-SAVE (1:16) =
  9273                        PD-CONTROL-PRIMARY (1:16))
  9274                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9275                 CONTINUE
  9276              ELSE
  9277                 MOVE 'N'        TO PDEF-MASTER-SW
  9278              END-IF
  9279           END-IF
  9280        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 171
* EL050.cbl
  9281        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9282     END-IF
  9283     IF PDEF-MASTER-FOUND
  9284        IF PD-TRUNCATED = 'Y'
  9285           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9286        END-IF
  9287     END-IF
  9288     .
  9289 0400-FIND-ERCOMP.
  9290     IF PB-COMPANY-ID = 'DCC'
  9291        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9292           (WS-SUB1 > +10)
  9293           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9294                 OR 'A' OR 'N'
  9295              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9296              MOVE PB-CARRIER    TO COMP-CARRIER
  9297              MOVE PB-GROUPING   TO COMP-GROUPING
  9298              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9299              MOVE AM-AGT (WS-SUB1)
  9300                                 TO COMP-FIN-RESP
  9301              MOVE 'G'           TO COMP-TYPE
  9302              PERFORM 8582-READ-COMPENSATION-MASTER
  9303                                 THRU 8582-EXIT
  9304              IF COMP-MASTER-FOUND
  9305                 IF CO-GA-INACTIVE
  9306                    MOVE ER-2763 TO WS-ERROR
  9307                    PERFORM 9900-ERROR-FORMAT
  9308                                 THRU 9900-EXIT
  9309                    MOVE +11     TO WS-SUB1
  9310                 END-IF
  9311                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9312                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9313                    MOVE ER-2788 TO WS-ERROR
  9314                    PERFORM 9900-ERROR-FORMAT
  9315                                 THRU 9900-EXIT
  9316                    MOVE +11     TO WS-SUB1
  9317                 END-IF
  9318              END-IF
  9319           END-IF
  9320        END-PERFORM
  9321     END-IF
  9322     IF PB-COMPANY-ID = 'DCC'
  9323        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9324           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9325                                    WS-CLP-STATE
  9326        ELSE
  9327           MOVE SPACES           TO PB-I-CLP-STATE
  9328                                    WS-CLP-STATE
  9329        END-IF
  9330     END-IF
  9331
  9332     IF (PB-COMPANY-ID = 'DCC')
  9333        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9334        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9335        CONTINUE
  9336     ELSE
  9337        GO TO 0400-FIND-STATE-RECORD
  9338     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 172
* EL050.cbl
  9339     MOVE SPACES                 TO WS-CLP-STATE
  9340     MOVE +0                     TO WS-BANK-FEE
  9341                                    WS-BANK-LFEE
  9342                                    WS-BANK-NOCHRGB
  9343
  9344     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9345     IF (PB-ISSUE)
  9346        AND (PB-I-BANK-NUMBER NOT =
  9347            SPACES AND ZEROS AND LOW-VALUES)
  9348        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9349     ELSE
  9350        IF (PB-CANCELLATION)
  9351           AND (PB-CI-BANK-NUMBER NOT =
  9352                SPACES AND ZEROS AND LOW-VALUES)
  9353           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9354        END-IF
  9355     END-IF
  9356     IF COMP-FIN-RESP NOT = LOW-VALUES
  9357        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9358        MOVE PB-CARRIER          TO COMP-CARRIER
  9359        MOVE PB-GROUPING         TO COMP-GROUPING
  9360        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9361        MOVE 'B'                 TO COMP-TYPE
  9362        PERFORM 8582-READ-COMPENSATION-MASTER
  9363                                 THRU 8582-EXIT
  9364        IF COMP-MASTER-FOUND
  9365           IF CO-MAX-BANK-FEE NOT NUMERIC
  9366              MOVE +0            TO CO-MAX-BANK-FEE
  9367           END-IF
  9368           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9369              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9370           END-IF
  9371           IF CO-GA-INACTIVE
  9372              MOVE ER-2763       TO WS-ERROR
  9373              PERFORM 9900-ERROR-FORMAT
  9374                                 THRU 9900-EXIT
  9375           END-IF
  9376           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9377              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9378              MOVE ER-2788 TO WS-ERROR
  9379              PERFORM 9900-ERROR-FORMAT
  9380                                 THRU 9900-EXIT
  9381              MOVE +11     TO WS-SUB1
  9382           END-IF
  9383           IF WS-AH-BEN-CATEGORY = 'G'
  9384              MOVE CO-MAX-BANK-FEE
  9385                                 TO WS-BANK-FEE
  9386                                    PB-I-BANK-FEE
  9387           ELSE
  9388              MOVE CO-MAX-BANK-FEE-LEASE
  9389                                 TO WS-BANK-LFEE
  9390                                    PB-I-BANK-FEE
  9391           END-IF
  9392           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9393              AND (WS-AH-REFUND-CALC = 'G'))
  9394                        OR
  9395              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9396              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 173
* EL050.cbl
  9397              CONTINUE
  9398           ELSE
  9399              MOVE ER-2789 TO WS-ERROR
  9400              PERFORM 9900-ERROR-FORMAT
  9401                                 THRU 9900-EXIT
  9402           END-IF
  9403           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9404                                    PB-I-CLP-STATE
  9405           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9406           MOVE CO-CARRIER       TO BXRF-CARRIER
  9407           MOVE CO-GROUPING      TO BXRF-GROUPING
  9408           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9409           MOVE BXRF-MAX-REC-LENGTH
  9410                                 TO BXRF-REC-LENGTH
  9411           PERFORM 8584-READ-BANK-CROSS-REF
  9412                                 THRU 8584-EXIT
  9413           IF BXRF-MASTER-FOUND
  9414              MOVE ' '           TO BANK-ACCT-SW
  9415              MOVE BK-BANK-POINTER-CNT
  9416                                 TO BK-BANK-POINTER-CNT
  9417              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9418                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9419                 OR (BANK-ACCT-FOUND)
  9420                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9421                    AND (BK-AM-EXP-DT (WS-SUB1)
  9422                                 > PB-CERT-EFF-DT)
  9423                    AND (BK-AM-EFF-DT (WS-SUB1)
  9424                                 NOT > PB-CERT-EFF-DT)
  9425                    SET BANK-ACCT-FOUND TO TRUE
  9426                 END-IF
  9427              END-PERFORM
  9428              IF NOT BANK-ACCT-FOUND
  9429                 MOVE ZEROS      TO WS-BANK-FEE
  9430                                    WS-BANK-LFEE
  9431                 MOVE ER-2869    TO WS-ERROR
  9432                 PERFORM 9900-ERROR-FORMAT
  9433                                 THRU 9900-EXIT
  9434              ELSE
  9435                 PERFORM 5000-PROCESS-REPS
  9436                                 THRU 5000-EXIT
  9437                 IF AGENT-MASTER-FOUND
  9438                    MOVE +0      TO WS-BANK-FEE
  9439                                    WS-BANK-LFEE
  9440*                   MOVE AG-SPP-FEES (1)
  9441*                                TO PB-I-BANK-FEE
  9442*                                   WS-BANK-FEE
  9443                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9444                       (WS-SUB1 > +10)
  9445                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9446                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9447                       END-IF
  9448                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9449                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9450                       END-IF
  9451                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9452                          AG-SPP-FEES (WS-SUB1)
  9453                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9454                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 174
* EL050.cbl
  9455                    END-PERFORM
  9456                    IF WS-AH-BEN-CATEGORY = 'G'
  9457                       MOVE WS-BANK-FEE
  9458                                 TO PB-I-BANK-FEE
  9459                    ELSE
  9460                       MOVE WS-BANK-LFEE
  9461                                 TO PB-I-BANK-FEE
  9462                    END-IF
  9463                 END-IF
  9464              END-IF
  9465           END-IF
  9466        ELSE
  9467           MOVE ER-2879          TO WS-ERROR
  9468           PERFORM 9900-ERROR-FORMAT
  9469                                 THRU 9900-EXIT
  9470        END-IF
  9471     ELSE
  9472        MOVE ER-2879             TO WS-ERROR
  9473        PERFORM 9900-ERROR-FORMAT
  9474                                 THRU 9900-EXIT
  9475     END-IF
  9476     IF WS-AH-BEN-CATEGORY = 'G'
  9477        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9478        + WS-BANK-FEE
  9479     ELSE
  9480        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9481        + WS-BANK-LFEE
  9482     END-IF
  9483     .
  9484 0400-FIND-STATE-RECORD.
  9485
  9486     IF WK-STATE-ADDR NOT = ZEROS
  9487         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9488         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9489         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9490         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9491         IF PB-SV-STATE = CF-STATE-CODE
  9492             GO TO 0405-CONTINUE-EDIT
  9493         ELSE
  9494             NEXT SENTENCE
  9495     ELSE
  9496         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9497
  9498     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9499     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9500     MOVE '3'                    TO CNTL-REC-TYPE.
  9501     MOVE +0                     TO CNTL-SEQ-NO.
  9502
  9503     MOVE '3'                    TO RC-SW-2.
  9504     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9505
  9506     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9507        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9508        PB-SV-STATE   NOT = CF-STATE-CODE)
  9509        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9510                                    WS-TOL-AH-CLAIM
  9511                                    WS-MINIMUM-REFUND
  9512                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 175
* EL050.cbl
  9513                                    WS-TOL-AH-PREM
  9514                                    WS-TOL-LF-REFUND
  9515                                    WS-TOL-AH-REFUND
  9516                                    EC-ST-TOL-PREM-PCT
  9517                                    WS-TOL-LF-PREM-PCT
  9518                                    WS-TOL-AH-PREM-PCT
  9519                                    EC-ST-TOL-REFUND-PCT
  9520                                    WS-TOL-LF-REFUND-PCT
  9521                                    WS-TOL-AH-REFUND-PCT
  9522                                    EC-ST-TOL-PREM
  9523                                    EC-ST-TOL-REFUND
  9524                                    EC-ST-FST-PMT-DAYS-MAX
  9525                                    WS-FREE-LOOK-PERIOD
  9526                                    WS-ST-LF-PREM-TAX
  9527                                    WS-ST-AH-PREM-TAX-I
  9528                                    WS-ST-AH-PREM-TAX-G
  9529                                    WS-BANK-FEE
  9530                                    WS-BANK-LFEE
  9531                                    WS-TOL-CLP-PCT
  9532                                    WS-SPP-LEASE-COMM
  9533        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9534                                    EC-ST-FST-PMT-DAYS-CHG
  9535                                    WS-LF-REM-TERM-CALC
  9536                                    WS-LF-REFUND-CALC
  9537                                    EC-ST-LF-REM-TERM-CALC
  9538                                    EC-ST-LF-REFUND-CALC
  9539                                    WS-AH-REM-TERM-CALC
  9540                                    WS-AH-REFUND-CALC
  9541                                    WS-LF-BEN-CATEGORY
  9542                                    WS-AH-BEN-CATEGORY
  9543                                    WS-CLP-STATE
  9544                                    WS-ST-REFUND-CLAIM-FLAG
  9545                                    EC-ST-AH-REM-TERM-CALC
  9546                                    EC-ST-AH-REFUND-CALC
  9547          GO TO 0499-STATE-NOT-FOUND.
  9548
  9549     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9550
  9551 0405-CONTINUE-EDIT.
  9552
  9553     if pb-company-id = 'AHL'
  9554        continue
  9555     else
  9556        IF PB-CERT-PRIME NOT NUMERIC
  9557           MOVE ER-2722          TO WS-ERROR
  9558           PERFORM 9900-ERROR-FORMAT
  9559                                 THRU 9900-EXIT
  9560        end-if
  9561     END-IF
  9562*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9563*       MOVE +0                  TO SUB3
  9564*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9565*       IF SUB3 > +0
  9566*          MOVE ER-2722          TO WS-ERROR
  9567*          PERFORM 9900-ERROR-FORMAT
  9568*                                THRU 9900-EXIT
  9569*       END-IF
  9570*    END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 176
* EL050.cbl
  9571*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9572*       IF PB-CERT-PRIME NOT NUMERIC
  9573*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9574*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9575*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9576*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9577*
  9578*          MOVE ER-2722          TO WS-ERROR
  9579*          PERFORM 9900-ERROR-FORMAT
  9580*                                THRU 9900-EXIT
  9581*       END-IF
  9582*    END-IF
  9583
  9584     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9585
  9586     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9587        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9588                                    WS-TOL-AH-CLAIM.
  9589
  9590     IF CF-ST-REFUND-MIN NOT NUMERIC
  9591        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9592
  9593     IF CF-ST-REFUND-MIN NOT = ZEROS
  9594        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9595
  9596     IF CF-ST-TOL-PREM  NOT = ZEROS
  9597        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9598                                    WS-TOL-AH-PREM
  9599        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9600
  9601     IF CF-ST-TOL-REFUND NOT = ZEROS
  9602        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9603                                    WS-TOL-AH-REFUND
  9604        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9605
  9606     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9607        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9608        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9609                                    WS-AH-REFUND-OVS-AMT
  9610                                    EC-ST-OVR-SHT-AMT.
  9611
  9612     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9613        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9614        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9615                                    WS-TOL-LF-PREM-PCT
  9616                                    WS-TOL-AH-PREM-PCT.
  9617
  9618     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9619        CF-ST-TOL-REF-PCT GREATER THAN +0
  9620        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9621                                    WS-TOL-LF-REFUND-PCT
  9622                                    WS-TOL-AH-REFUND-PCT.
  9623
  9624     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9625        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9626        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9627                                    WS-AH-REFUND-OVS-PCT
  9628                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 177
* EL050.cbl
  9629
  9630     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9631     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9632
  9633     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9634          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9635
  9636     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9637     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9638     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9639
  9640     IF CF-ST-LF-PREM-TAX NUMERIC
  9641        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9642     END-IF
  9643     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9644        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9645     END-IF
  9646     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9647        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9648     END-IF
  9649
  9650     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9651         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9652     END-IF.
  9653
  9654     IF WS-LF-BENEFIT-CD = ZEROS
  9655        GO TO 0410-CHECK-AH.
  9656
  9657     IF CF-ST-RT-CALC NOT = SPACES
  9658        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9659                                    EC-ST-LF-REM-TERM-CALC
  9660     END-IF
  9661
  9662     IF WS-LF-COVERAGE-TYPE = 'R'
  9663        IF WS-LF-EARNINGS-CALC = '5'
  9664           IF CF-ST-RF-LN-CALC > '0'
  9665              MOVE CF-ST-RF-LN-CALC
  9666                                 TO WS-LF-REFUND-CALC
  9667                                    EC-ST-LF-REFUND-CALC
  9668           END-IF
  9669        ELSE
  9670           IF CF-ST-RF-LR-CALC > '0'
  9671              MOVE CF-ST-RF-LR-CALC
  9672                                 TO WS-LF-REFUND-CALC
  9673                                    EC-ST-LF-REFUND-CALC
  9674           END-IF
  9675        END-IF
  9676     ELSE
  9677        IF CF-ST-RF-LL-CALC > '0'
  9678           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9679                                    EC-ST-LF-REFUND-CALC
  9680        END-IF
  9681     END-IF
  9682
  9683     IF CF-ST-RT-CALC NOT = SPACES
  9684        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9685                                    EC-ST-LF-REM-TERM-CALC
  9686     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 178
* EL050.cbl
  9687
  9688     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9689     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9690
  9691     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9692
  9693     IF NO-BENEFIT-FOUND
  9694        GO TO 0410-CHECK-AH.
  9695
  9696     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9697        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9698                                 TO EC-ST-LF-REM-TERM-CALC
  9699                                    WS-LF-REM-TERM-CALC
  9700     END-IF
  9701
  9702     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9703        MOVE CF-ST-REFUND-CALC (SUB3)
  9704                                 TO WS-LF-REFUND-CALC
  9705                                    EC-ST-LF-REFUND-CALC
  9706     END-IF
  9707*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9708
  9709     .
  9710 0410-CHECK-AH.
  9711
  9712     IF WS-AH-BENEFIT-CD = ZEROS
  9713        GO TO 0500-SET-ACCOUNT.
  9714
  9715     IF CF-ST-RT-CALC NOT = SPACES
  9716        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9717                                    EC-ST-AH-REM-TERM-CALC
  9718     END-IF
  9719
  9720     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9721        IF CF-ST-RF-CP-CALC > '0'
  9722           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9723                                    EC-ST-AH-REFUND-CALC
  9724        END-IF
  9725     ELSE
  9726        IF CF-ST-RF-AH-CALC > '0'
  9727           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9728                                    EC-ST-AH-REFUND-CALC
  9729        END-IF
  9730     END-IF
  9731     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9732     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9733
  9734     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9735
  9736     IF NO-BENEFIT-FOUND
  9737        GO TO 0500-SET-ACCOUNT.
  9738
  9739     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9740        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9741                                 TO WS-AH-REM-TERM-CALC
  9742                                    EC-ST-AH-REM-TERM-CALC
  9743     END-IF
  9744
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 179
* EL050.cbl
  9745     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9746        MOVE CF-ST-REFUND-CALC (SUB3)
  9747                                 TO WS-AH-REFUND-CALC
  9748                                    EC-ST-AH-REFUND-CALC
  9749     END-IF
  9750
  9751*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9752
  9753     GO TO 0500-SET-ACCOUNT.
  9754
  9755 0499-STATE-NOT-FOUND.
  9756
  9757     MOVE ER-2603                TO WS-ERROR.
  9758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9759
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 180
* EL050.cbl
  9761
  9762 0500-SET-ACCOUNT.
  9763*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9764     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9765        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9766        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9767        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9768        MOVE '3'                 TO CNTL-REC-TYPE
  9769        MOVE +0                  TO CNTL-SEQ-NO
  9770
  9771        MOVE '3'                 TO RC-SW-2
  9772        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9773
  9774        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9775           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9776           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9777           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9778                                    WS-ST-AH-PREM-TAX-I
  9779                                    WS-ST-AH-PREM-TAX-G
  9780        ELSE
  9781           IF CF-ST-LF-PREM-TAX NUMERIC
  9782              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9783           END-IF
  9784           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9785              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9786           END-IF
  9787           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9788              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9789           END-IF
  9790        END-IF
  9791        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9792     END-IF
  9793*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9794*  FOR DCC ONLY
  9795     IF PB-COMPANY-ID = 'DCC'
  9796
  9797     MOVE ' '                    TO STAT-MASTER-SW
  9798     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9799     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9800     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9801     MOVE PB-STATE               TO ELSTAT-STATE
  9802     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9803        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9804     END-IF
  9805
  9806     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9807     SET BIN-TO-GREG             TO TRUE
  9808     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9809     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9810     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9811
  9812     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9813     IF STAT-MASTER-FOUND
  9814        MOVE 'N'                 TO STAT-MASTER-SW
  9815        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9816        IF STAT-MASTER-FOUND
  9817           IF (ELSTAT-KEY-SAVE (1:12) =
  9818                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 181
* EL050.cbl
  9819              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9820                 MOVE 'F'        TO STAT-MASTER-SW
  9821              ELSE
  9822                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9823                 IF (STAT-MASTER-FOUND)
  9824                    AND (ELSTAT-KEY-SAVE (1:12) =
  9825                        SF-CONTROL-PRIMARY (1:12))
  9826                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9827                    MOVE 'F'     TO STAT-MASTER-SW
  9828                 END-IF
  9829              END-IF
  9830           END-IF
  9831        END-IF
  9832     END-IF
  9833
  9834     IF STAT-MASTER-SW = 'F'
  9835        IF SF-ST-LF-PREM-TAX NUMERIC
  9836           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9837        END-IF
  9838        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9839           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9840        END-IF
  9841        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9842           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9843        END-IF
  9844     END-IF
  9845
  9846     END-IF
  9847     IF (PB-COMPANY-ID = 'DCC')
  9848        AND (PB-ISSUE)
  9849        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9850        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9851        AND (AM-GPCD = 06)
  9852        MOVE 'Y'                 TO WS-GOOD-HIN
  9853        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9854           MOVE PB-I-VIN         TO WS-WORK-VIN
  9855           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9856              (V1 > 16)
  9857              IF WS-WORK-VIN (V1:1) NUMERIC
  9858                 MOVE WS-WORK-VIN-N (V1)
  9859                                 TO WS-ROW-B-VAL (V1)
  9860              ELSE
  9861                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9862                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9863                    OR (V2 > 26)
  9864                 END-PERFORM
  9865                 IF V2 < 27
  9866                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9867                 ELSE
  9868                    MOVE 'N'     TO WS-GOOD-HIN
  9869                 END-IF
  9870              END-IF
  9871              COMPUTE WS-ROW-D-VAL (V1) =
  9872                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9873              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9874                 WS-ROW-D-VAL (V1)
  9875           END-PERFORM
  9876           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 182
* EL050.cbl
  9877           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9878             REMAINDER WS-VIN-REMAINDER
  9879           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9880              CONTINUE
  9881           ELSE
  9882              MOVE 'N'           TO WS-GOOD-HIN
  9883           END-IF
  9884        ELSE
  9885           MOVE 'N'              TO WS-GOOD-HIN
  9886        END-IF
  9887        IF WS-GOOD-HIN NOT = 'Y'
  9888           MOVE ER-3826           TO WS-ERROR
  9889           PERFORM 9900-ERROR-FORMAT
  9890                                 THRU 9900-EXIT
  9891        END-IF
  9892     END-IF
  9893     IF (PB-COMPANY-ID = 'DCC')
  9894        AND (PB-ISSUE)
  9895        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9896        AND (AM-GPCD NOT = 06)
  9897        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9898          MOVE PB-I-VIN          TO WS-WORK-VIN
  9899          MOVE +8                TO V2
  9900          MOVE ZEROS             TO WS-VIN-TOTAL
  9901          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9902           (V1 > 17)
  9903             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9904                MOVE ER-3825     TO WS-ERROR
  9905                PERFORM 9900-ERROR-FORMAT
  9906                                 THRU 9900-EXIT
  9907             ELSE
  9908                IF V1 = 8
  9909                   MOVE 10       TO V2
  9910                END-IF
  9911                IF V1 = 9
  9912                   MOVE 0        TO V2
  9913                END-IF
  9914                IF V1 = 10
  9915                   MOVE 9        TO V2
  9916                END-IF
  9917                IF WS-WORK-VIN (V1:1) NUMERIC
  9918                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9919                    + (WS-WORK-VIN-N (V1) * V2)
  9920                ELSE
  9921                   MOVE WS-WORK-VIN (V1:1)
  9922                                 TO WS-HEX-BYTE
  9923                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9924                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9925                    + (WS-NUM (V3) * V2)
  9926                END-IF
  9927                COMPUTE V2 = V2 - 1
  9928             END-IF
  9929          END-PERFORM
  9930          MOVE ZEROS TO WS-VIN-REMAINDER
  9931          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9932             REMAINDER WS-VIN-REMAINDER
  9933          IF ((WS-WORK-VIN (9:1) = 'X')
  9934             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 183
* EL050.cbl
  9935                     OR
  9936             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9937             CONTINUE
  9938          ELSE
  9939             MOVE ER-3826        TO WS-ERROR
  9940             PERFORM 9900-ERROR-FORMAT
  9941                                 THRU 9900-EXIT
  9942          END-IF
  9943        ELSE
  9944          MOVE ER-3826           TO WS-ERROR
  9945          PERFORM 9900-ERROR-FORMAT
  9946                                 THRU 9900-EXIT
  9947        END-IF
  9948     END-IF
  9949******************************************************************
  9950******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9951******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9952******* METHODS.
  9953******************************************************************
  9954     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9955        IF PB-CANCELLATION
  9956           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9957              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9958                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9959                IF FORM-MASTER-FOUND
  9960                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9961******************************************************************
  9962
  9963     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9964     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9965
  9966     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9967     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9968     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9969     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9970
  9971
  9972     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9973     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9974     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9975
  9976     IF AM-LF-OB-RATE NOT NUMERIC
  9977         MOVE ZERO               TO AM-LF-OB-RATE.
  9978
  9979     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9980         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9981
  9982     IF AM-AH-OB-RATE NOT NUMERIC
  9983         MOVE ZERO               TO AM-AH-OB-RATE.
  9984
  9985     IF WS-LF-JOINT-INDICATOR = 'J'
  9986         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9987     ELSE
  9988         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9989
  9990     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9991
  9992     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 184
* EL050.cbl
  9993         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9994
  9995     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9996         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9997                                       WS-IG-OVRD
  9998     ELSE
  9999         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10000             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10001                                       WS-IG-OVRD
 10002         ELSE
 10003             MOVE AM-IG             TO WS-IG-OVRD-AH
 10004                                       WS-IG-OVRD.
 10005
 10006     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10007         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10008                                       WS-IG-OVRD
 10009     ELSE
 10010         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10011             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10012                                       WS-IG-OVRD
 10013         ELSE
 10014             MOVE AM-IG             TO WS-IG-OVRD-LF
 10015                                       WS-IG-OVRD.
 10016
 10017     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10018     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10019     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10020     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10021     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10022
 10023     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10024     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10025     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10026     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10027
 10028     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10029     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10030     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10031     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10032     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10033     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10034     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10035
 10036     IF WS-ACCT-AH-DEV-PCT > +0
 10037        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10038     ELSE
 10039        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10040
 10041     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10042        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10043     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10044        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10045
 10046        IF AM-EARN-METHOD-L = 'S'
 10047            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10048                                        WS-LF-REFUND-CALC.
 10049
 10050        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 185
* EL050.cbl
 10051            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10052                                        WS-LF-REFUND-CALC.
 10053
 10054     IF WS-LF-COVERAGE-TYPE = 'R'
 10055         IF AM-EARN-METHOD-R = 'R'
 10056            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10057                                    WS-LF-REFUND-CALC.
 10058     IF WS-LF-COVERAGE-TYPE = 'R'
 10059         IF AM-EARN-METHOD-R = 'P'
 10060            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10061                                    WS-LF-REFUND-CALC.
 10062     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10063         IF AM-EARN-METHOD-L = 'R'
 10064            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10065                                    WS-LF-REFUND-CALC.
 10066     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10067         IF AM-EARN-METHOD-L = 'P'
 10068            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10069                                    WS-LF-REFUND-CALC.
 10070     IF WS-LF-COVERAGE-TYPE = 'R'
 10071         IF AM-EARN-METHOD-R = 'A'
 10072            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10073                                    WS-LF-REFUND-CALC.
 10074     IF WS-LF-COVERAGE-TYPE = 'R'
 10075         IF AM-EARN-METHOD-R = 'M'
 10076            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10077                                    WS-LF-REFUND-CALC.
 10078     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10079         IF AM-EARN-METHOD-L = 'A'
 10080            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10081                                    WS-LF-REFUND-CALC.
 10082     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10083         IF AM-EARN-METHOD-L = 'M'
 10084            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10085                                    WS-LF-REFUND-CALC.
 10086
 10087     IF AM-EARN-METHOD-A = 'R'
 10088        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10089                                    WS-AH-REFUND-CALC.
 10090     IF AM-EARN-METHOD-A = 'P'
 10091        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10092                                    WS-AH-REFUND-CALC.
 10093     IF AM-EARN-METHOD-A = 'C'
 10094        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10095                                    WS-AH-REFUND-CALC.
 10096     IF AM-EARN-METHOD-A = 'A'
 10097        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10098                                    WS-AH-REFUND-CALC.
 10099     IF AM-EARN-METHOD-A = 'M'
 10100        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10101                                    WS-AH-REFUND-CALC.
 10102     IF AM-EARN-METHOD-A = 'N'
 10103        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10104                                    WS-AH-REFUND-CALC.
 10105     IF AM-EARN-METHOD-A = 'S'
 10106        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10107                                    WS-AH-REFUND-CALC.
 10108
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 186
* EL050.cbl
 10109     IF AM-TOL-PREM NOT = ZEROS
 10110        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10111                                    WS-TOL-AH-PREM.
 10112
 10113     IF AM-OVR-SHT-AMT NUMERIC AND
 10114                  AM-OVR-SHT-AMT > 0
 10115        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10116                                    EC-AM-LF-OVR-SHT-AMT
 10117                                    WS-AH-REFUND-OVS-AMT
 10118                                    EC-AM-AH-OVR-SHT-AMT.
 10119
 10120     IF AM-OVR-SHT-PCT NUMERIC AND
 10121                    AM-OVR-SHT-PCT > 0
 10122        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10123                                    EC-AM-LF-OVR-SHT-PCT
 10124                                    WS-AH-REFUND-OVS-PCT
 10125                                    EC-AM-AH-OVR-SHT-PCT.
 10126
 10127     IF AM-TOL-REF-PCT NUMERIC AND
 10128                  AM-TOL-REF-PCT > 0
 10129        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10130                                    WS-TOL-AH-REFUND-PCT.
 10131
 10132     IF AM-TOL-REF  NOT = ZEROS  AND
 10133                  AM-TOL-REF NUMERIC
 10134        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10135                                    EC-AM-LF-TOL-REFUND
 10136                                    WS-TOL-AH-REFUND
 10137                                    EC-AM-AH-TOL-REFUND.
 10138
 10139     IF AM-TOL-CLM  NOT = ZEROS
 10140        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10141                                    WS-TOL-AH-CLAIM.
 10142
 10143     IF AM-CLP-TOL-PCT NOT NUMERIC
 10144        MOVE +0                  TO AM-CLP-TOL-PCT
 10145     END-IF
 10146
 10147     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10148        MOVE +0                  TO AM-SPP-LEASE-COMM
 10149     END-IF
 10150     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10151        MOVE WS-PL-TOL-LF-PREM-PCT
 10152                                 TO WS-TOL-LF-PREM-PCT.
 10153
 10154     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10155        MOVE WS-PL-TOL-AH-PREM-PCT
 10156                                 TO WS-TOL-AH-PREM-PCT.
 10157
 10158     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10159        MOVE WS-PL-TOL-LF-REFUND-PCT
 10160                                 TO WS-TOL-LF-REFUND-PCT.
 10161
 10162     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10163        MOVE WS-PL-TOL-AH-REFUND-PCT
 10164                                 TO WS-TOL-AH-REFUND-PCT.
 10165
 10166     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 187
* EL050.cbl
 10167        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10168
 10169     IF WS-PL-REF-OVS-PCT > +0
 10170        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10171
 10172     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10173        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10174     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10175        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10176     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10177        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10178     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10179        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10180     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10181        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10182     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10183        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10184
 10185     IF WS-AH-PL-REF-OVS-AMT > +0
 10186        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10187
 10188     IF WS-AH-PL-REF-OVS-PCT > +0
 10189        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10190
 10191     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10192     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10193
 10194     IF PB-CANCELLATION
 10195        GO TO 3000-CONTINUE-EDIT.
 10196
 10197     MOVE +1 TO SUB1.
 10198     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10199     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10200
 10201     IF CF-COMPANY-ID = 'DMD'
 10202       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10203         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10204        ELSE
 10205         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10206
 10207  0525-FIND-ACCT-COMM.
 10208     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10209        NEXT SENTENCE
 10210      ELSE
 10211         ADD +1 TO SUB1
 10212         IF SUB1 LESS +11
 10213            GO TO 0525-FIND-ACCT-COMM
 10214          ELSE
 10215             GO TO 0560-EDIT-CONTINUE.
 10216
 10217     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10218     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10219                                    PB-I-LIFE-COMMISSION.
 10220***  IF PB-COMPANY-ID = 'CRI'
 10221     IF PB-PREM-ACCTNG-ONLY
 10222         GO TO 0560-EDIT-CONTINUE.
 10223
 10224     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 188
* EL050.cbl
 10225     MOVE ' '    TO WS-CTBL-READ-SW.
 10226
 10227
 10228 0530-GET-AH-COMP.
 10229     IF NO-AH-COVERAGE  OR
 10230        NO-AH-BENEFIT-MATCH
 10231           GO TO 0540-NEXT-READ-STEP.
 10232
 10233     IF AM-A-COM (SUB1) NUMERIC
 10234        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10235         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10236         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10237         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10238         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10239     ELSE
 10240          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10241          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10242          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10243          MOVE ZEROS             TO WS-SUB1
 10244                                    WS-COMMISSION
 10245          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10246          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10247          IF WS-COMMISSION > ZEROS
 10248             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10249             GO TO 0540-NEXT-READ-STEP
 10250          END-IF
 10251          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10252          IF CTBL-TABLE-FOUND
 10253             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10254                                        PB-I-AH-TERM
 10255             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10256             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10257             GO TO 0540-NEXT-READ-STEP
 10258          ELSE
 10259             IF FIRST-TIME-THROUGH
 10260                 GO TO 0530-GET-AH-COMP
 10261             ELSE
 10262                 MOVE ER-2609                TO WS-ERROR
 10263                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10264
 10265 0540-NEXT-READ-STEP.
 10266     MOVE '0540' TO CTBL-SW.
 10267     MOVE ' '    TO WS-CTBL-READ-SW.
 10268
 10269 0540-GET-LF-COMP.
 10270     IF NO-LIFE-COVERAGE  OR
 10271        NO-LF-BENEFIT-MATCH
 10272           GO TO 0560-EDIT-CONTINUE.
 10273
 10274     IF WS-LF-JOINT-INDICATOR = 'J'
 10275        IF AM-J-COM (SUB1) NUMERIC
 10276           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10277           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10278           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10279           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10280           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10281        ELSE
 10282           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 189
* EL050.cbl
 10283           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10284           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10285           MOVE ZEROS                TO WS-SUB1
 10286                                        WS-COMMISSION
 10287           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10288           IF WS-COMMISSION > ZEROS
 10289              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10290              GO TO 0560-EDIT-CONTINUE
 10291           END-IF
 10292           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10293           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10294           IF CTBL-TABLE-FOUND
 10295              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10296              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10297              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10298              GO TO 0560-EDIT-CONTINUE
 10299           ELSE
 10300              IF FIRST-TIME-THROUGH
 10301                  GO TO 0540-GET-LF-COMP
 10302              ELSE
 10303                  MOVE ER-2609                TO WS-ERROR
 10304                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10305                  GO TO 0560-EDIT-CONTINUE.
 10306
 10307     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10308        IF AM-L-COM (SUB1) NUMERIC
 10309           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10310           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10311           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10312           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10313           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10314        ELSE
 10315           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10316           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10317           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10318           MOVE ZEROS                TO WS-SUB1
 10319                                        WS-COMMISSION
 10320           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10321           IF WS-COMMISSION IS GREATER THAN ZEROS
 10322              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10323              GO TO 0560-EDIT-CONTINUE
 10324           END-IF
 10325           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10326           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10327           IF CTBL-TABLE-FOUND
 10328              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10329              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10330              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10331              GO TO 0560-EDIT-CONTINUE
 10332           ELSE
 10333              IF FIRST-TIME-THROUGH
 10334                  GO TO 0540-GET-LF-COMP
 10335              ELSE
 10336                  MOVE ER-2609                TO WS-ERROR
 10337                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10338
 10339*    GO TO 0560-EDIT-CONTINUE.
 10340
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 190
* EL050.cbl
 10341 0560-EDIT-CONTINUE.
 10342     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10343                                    WS-AH-PMF-COMM
 10344*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10345*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10346     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10347        (SUB1 > +10)
 10348        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10349           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10350           MOVE '0530'           TO CTBL-SW
 10351           MOVE ' '              TO WS-CTBL-READ-SW
 10352           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10353           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10354           MOVE '0540'           TO CTBL-SW
 10355           MOVE ' '              TO WS-CTBL-READ-SW
 10356           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10357        END-IF
 10358     END-PERFORM
 10359     GO TO 0564-EDIT-CONTINUE
 10360     .
 10361 0561-CHECK-AH.
 10362     IF (NO-AH-COVERAGE)
 10363        OR (NO-AH-BENEFIT-MATCH)
 10364        CONTINUE
 10365     ELSE
 10366        IF (AM-A-COM (SUB1) NUMERIC)
 10367           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10368           IF (AM-COM-TYP (SUB1) = 'A')
 10369              AND (WS-AH-PMF-COMM = ZEROS)
 10370              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10371           END-IF
 10372           CONTINUE
 10373        ELSE
 10374           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10375           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10376           MOVE PB-AH-OVERRIDE-L1
 10377                                 TO CTBL-BEN-TYPE
 10378           MOVE ZEROS            TO WS-SUB1
 10379                                    WS-COMMISSION
 10380           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10381           PERFORM 8300-READ-CTBL-TABLE
 10382                                 THRU 8300-EXIT
 10383           IF CTBL-TABLE-FOUND
 10384              IF (AM-COM-TYP (SUB1) = 'A')
 10385                 AND (WS-AH-PMF-COMM = ZEROS)
 10386                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10387                                        PB-I-AH-TERM
 10388                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10389                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10390              END-IF
 10391              CONTINUE
 10392           ELSE
 10393              IF FIRST-TIME-THROUGH
 10394                 GO TO 0561-CHECK-AH
 10395              ELSE
 10396                 MOVE ER-2609    TO WS-ERROR
 10397                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10398              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 191
* EL050.cbl
 10399           END-IF
 10400        END-IF
 10401     END-IF
 10402     .
 10403 0561-EXIT.
 10404     EXIT.
 10405 0563-CHECK-LF.
 10406     IF (NO-LIFE-COVERAGE)
 10407        OR (NO-LF-BENEFIT-MATCH)
 10408        CONTINUE
 10409     ELSE
 10410        IF WS-LF-JOINT-INDICATOR = 'J'
 10411           IF AM-J-COM (SUB1) NUMERIC
 10412              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10413              IF (AM-COM-TYP (SUB1) = 'A')
 10414                 AND (WS-LF-PMF-COMM = ZEROS)
 10415                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10416              END-IF
 10417              CONTINUE
 10418           ELSE
 10419              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10420              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10421              MOVE PB-LIFE-OVERRIDE-L1
 10422                                 TO CTBL-BEN-TYPE
 10423              MOVE ZEROS         TO WS-SUB1
 10424                                    WS-COMMISSION
 10425              MOVE AM-J-COMA (SUB1)
 10426                                 TO CTBL-TABLE
 10427              PERFORM 8300-READ-CTBL-TABLE
 10428                                 THRU 8300-EXIT
 10429              IF CTBL-TABLE-FOUND
 10430                 IF (AM-COM-TYP (SUB1) = 'A')
 10431                    AND (WS-LF-PMF-COMM = ZEROS)
 10432                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10433                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10434                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10435                 END-IF
 10436                 CONTINUE
 10437              ELSE
 10438                 IF FIRST-TIME-THROUGH
 10439                    GO TO 0563-CHECK-LF
 10440                 ELSE
 10441                    MOVE ER-2609 TO WS-ERROR
 10442                    PERFORM 9900-ERROR-FORMAT
 10443                                 THRU 9900-EXIT
 10444*                   GO TO 0560-EDIT-CONTINUE
 10445                 END-IF
 10446              END-IF
 10447           END-IF
 10448        ELSE
 10449           IF AM-L-COM (SUB1) NUMERIC
 10450              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10451              IF (AM-COM-TYP (SUB1) = 'A')
 10452                 AND (WS-LF-PMF-COMM = ZEROS)
 10453                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10454              END-IF
 10455              CONTINUE
 10456           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 192
* EL050.cbl
 10457              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10458              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10459              MOVE PB-LIFE-OVERRIDE-L1
 10460                                 TO CTBL-BEN-TYPE
 10461              MOVE ZEROS         TO WS-SUB1
 10462                                    WS-COMMISSION
 10463              MOVE AM-L-COMA (SUB1)
 10464                                 TO CTBL-TABLE
 10465              PERFORM 8300-READ-CTBL-TABLE
 10466                                 THRU 8300-EXIT
 10467              IF CTBL-TABLE-FOUND
 10468                 CONTINUE
 10469              ELSE
 10470                 IF FIRST-TIME-THROUGH
 10471                    GO TO 0563-CHECK-LF
 10472                 ELSE
 10473                    MOVE ER-2609 TO WS-ERROR
 10474                    PERFORM 9900-ERROR-FORMAT
 10475                                 THRU 9900-EXIT
 10476                 END-IF
 10477              END-IF
 10478           END-IF
 10479        END-IF
 10480     END-IF
 10481     .
 10482 0563-EXIT.
 10483     EXIT.
 10484 0564-EDIT-CONTINUE.
 10485
 10486     IF  PB-COMPANY-ID EQUAL 'DMD'
 10487         IF PB-I-NUM-BILLED EQUAL ZEROS
 10488            MOVE ER-8148       TO WS-ERROR
 10489            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10490
 10491*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10492*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10493*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10494*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10495*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10496*         IF NO-CONVERSION-ERROR
 10497*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10498*         ELSE
 10499*             IF PB-COMPANY-ID EQUAL 'HAN'
 10500*                 MOVE ZEROS     TO PB-I-AGE.
 10501     IF PB-I-BIRTHDAY > LOW-VALUES
 10502        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10503        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10504        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10505        PERFORM 8500-DATE-CONVERT
 10506                                 THRU 8500-EXIT
 10507        IF NO-CONVERSION-ERROR
 10508           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10509           IF PB-I-AGE > ZEROS
 10510              IF WS-WORK-AGE NOT = PB-I-AGE
 10511                 MOVE ER-9501    TO WS-ERROR
 10512                 PERFORM 9900-ERROR-FORMAT
 10513                                 THRU 9900-EXIT
 10514              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 193
* EL050.cbl
 10515           ELSE
 10516              MOVE WS-WORK-AGE   TO PB-I-AGE
 10517           END-IF
 10518        END-IF
 10519     END-IF
 10520     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10521                                   WS-INS-AGE-SET
 10522     IF PB-I-AGE = ZEROS
 10523        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10524           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10525                                   WS-INS-AGE-SET
 10526           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10527
 10528     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10529                                   WS-AH-EDIT-AGE.
 10530
 10531     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10532        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10533        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10534        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10535        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10536        IF NO-CONVERSION-ERROR
 10537           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10538           IF PB-I-JOINT-AGE > 0
 10539              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10540                 MOVE ER-9503    TO WS-ERROR
 10541                 PERFORM 9900-ERROR-FORMAT
 10542                                 THRU 9900-EXIT
 10543              END-IF
 10544           ELSE
 10545              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10546           END-IF
 10547        ELSE
 10548           MOVE ZEROS            TO PB-I-JOINT-AGE
 10549        END-IF
 10550     END-IF
 10551     IF PB-I-JOINT-AGE NOT NUMERIC
 10552        MOVE ZERO               TO PB-I-JOINT-AGE.
 10553
 10554     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10555                                   WS-JNT-AGE-SET
 10556     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10557        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10558           (WS-AH-JOINT-INDICATOR = 'J')
 10559           IF PB-I-JOINT-AGE = ZEROS
 10560               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10561                                          WS-JNT-AGE-SET
 10562               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10563           END-IF
 10564        END-IF
 10565     END-IF
 10566
 10567     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10568     IF WS-LF-JOINT-INDICATOR = 'J'
 10569        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10570        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10571            IF  PB-I-JOINT-AGE = ZERO
 10572                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 194
* EL050.cbl
 10573                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10574            ELSE
 10575                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10576                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10577                    IF PB-COMPANY-ID NOT = 'LBL'
 10578                        MOVE ER-2685    TO WS-ERROR
 10579                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10580
 10581     IF WS-AH-JOINT-INDICATOR = 'J'
 10582        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10583            IF  PB-I-JOINT-AGE = ZERO
 10584                MOVE ER-2686       TO WS-ERROR
 10585                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10586            ELSE
 10587                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10588                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10589                                           WS-EDIT-AGE
 10590                    IF PB-COMPANY-ID NOT = 'LBL'
 10591                        MOVE ER-2685    TO WS-ERROR
 10592                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10593
 10594******************************************************************
 10595*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10596******************************************************************
 10597
 10598     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10599        (WS-AH-SPECIAL-CALC-CD = 'O')
 10600        NEXT SENTENCE
 10601     ELSE
 10602        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10603          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10604           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10605            WS-AH-JOINT-INDICATOR = 'J')  AND
 10606           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10607            MOVE ER-2627             TO WS-ERROR
 10608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10609
 10610     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10611        (WS-AH-SPECIAL-CALC-CD = 'O')
 10612         NEXT SENTENCE
 10613     ELSE
 10614         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10615            WS-AH-JOINT-INDICATOR = 'J'
 10616             IF PB-I-JOINT-INSURED = SPACES
 10617                 IF PB-COMPANY-ID NOT = 'JAL'
 10618                     MOVE ER-2696    TO WS-ERROR
 10619                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10620
 10621     IF PB-COMPANY-ID NOT = 'BOA'
 10622        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10623           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10624           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10625               PB-I-JOINT-INSURED NOT = SPACES)
 10626                MOVE ER-2691         TO WS-ERROR
 10627                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10628
 10629     IF PB-COMPANY-ID = 'BOA'
 10630        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 195
* EL050.cbl
 10631           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10632            IF PB-I-JOINT-AGE NOT = ZEROS
 10633                MOVE ER-2691         TO WS-ERROR
 10634                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10635
 10636     IF PB-COMPANY-ID = 'CRI'
 10637        IF PB-I-SIG-SW = 'J'
 10638           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10639              WS-AH-JOINT-INDICATOR NOT = 'J'
 10640              MOVE ER-2675       TO WS-ERROR
 10641              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10642
 10643     IF PB-COMPANY-ID = 'CRI'
 10644        IF PB-I-SIG-SW = 'S'
 10645           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10646              WS-AH-JOINT-INDICATOR = 'J'
 10647              MOVE ER-2676       TO WS-ERROR
 10648              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10649
 10650     IF PB-COMPANY-ID = 'CVL'
 10651         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10652            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10653              MOVE ER-2783           TO WS-ERROR
 10654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10655     IF (WS-LF-JOINT-INDICATOR = 'J')
 10656        AND (WS-AH-JOINT-INDICATOR = 'J')
 10657        AND (PB-I-LF-TERM > 120)
 10658        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10659        MOVE ER-2783             TO WS-ERROR
 10660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10661     END-IF
 10662     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10663
 10664     IF PB-I-INDV-GRP-OVRD = 'I'
 10665        MOVE ER-2666             TO WS-ERROR
 10666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10667        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10668
 10669     IF PB-I-INDV-GRP-OVRD = 'G'
 10670        MOVE ER-2666             TO WS-ERROR
 10671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10672        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10673
 10674     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10675        NEXT SENTENCE
 10676     ELSE
 10677        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10678
 10679     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10680        IF WS-ERROR = ER-2666
 10681           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10682           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10683
 10684     IF PB-COMPANY-ID = 'CID'
 10685        IF PB-STATE = 'UT' OR 'MO'
 10686           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10687                 OR '76' OR '77')
 10688                      OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 196
* EL050.cbl
 10689               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10690                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10691                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10692                   OR '2K' OR '2L'))
 10693              AND PB-I-INDV-GRP-CD = 'I'
 10694              MOVE ER-2721             TO WS-ERROR
 10695              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10696           END-IF
 10697        END-IF
 10698     END-IF
 10699
 10700     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10701     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10702        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10703     ELSE
 10704        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10705     END-IF
 10706
 10707*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10708*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10709     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10710                                    ACCOUNT-AH-CK-SW.
 10711
 10712     IF PB-REISSUED-CERT       OR
 10713        PB-REIN-ONLY-CERT      OR
 10714        PB-POLICY-IS-DECLINED  OR
 10715        PB-POLICY-IS-VOIDED
 10716*       OR PB-MONTHLY-CERT
 10717         GO TO 3000-CONTINUE-EDIT.
 10718
 10719     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10720        IF WS-EDIT-AGE           > +65
 10721           MOVE ER-2709          TO WS-ERROR
 10722           PERFORM 9900-ERROR-FORMAT
 10723                                 THRU 9900-EXIT
 10724        ELSE
 10725           IF WS-EDIT-AGE        > +55
 10726              MOVE ER-2718       TO WS-ERROR
 10727              PERFORM 9900-ERROR-FORMAT
 10728                                 THRU 9900-EXIT
 10729           END-IF
 10730        END-IF
 10731     IF PB-COMPANY-ID = 'DCC'
 10732        IF WS-EDIT-AGE           > +65
 10733           MOVE ER-2709          TO WS-ERROR
 10734           PERFORM 9900-ERROR-FORMAT
 10735                                 THRU 9900-EXIT
 10736        END-IF
 10737     END-IF
 10738     .
 10739
 10740 0565-LIFE-PLAN-LIMIT-EDITS.
 10741
 10742     IF NOT LF-PLAN-MASTER-FOUND
 10743        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10744                                    EC-AM-LF-MAX-TOT-BEN
 10745        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10746
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 197
* EL050.cbl
 10747     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10748
 10749     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10750         IF PL-LM-AGE (1) = ZEROS
 10751             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10752
 10753     IF NO-LF-BENEFIT-MATCH          OR
 10754        WS-LF-BENEFIT-CD = ZEROS     OR
 10755        WS-LF-SPECIAL-CALC-CD = 'M'
 10756        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10757
 10758     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10759     MOVE +1                     TO SUB2.
 10760
 10761     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10762        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10763           MOVE +5   TO SUB2
 10764           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10765              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10766              (PL-LM-AGE (SUB2) EQUAL +0)
 10767              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10768              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10769
 10770     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10771
 10772     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10773                               + PB-I-LF-ALT-BENEFIT-AMT.
 10774
 10775 0568-CHECK-LIFE-ATT-AGE.
 10776
 10777     IF PL-ATT-AGE NUMERIC AND
 10778        PL-ATT-AGE > +0
 10779        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10780     END-IF
 10781*    IF PL-ATT-AGE NUMERIC AND
 10782*       PL-ATT-AGE > +0
 10783*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10784*       IF PB-I-BIRTHDAY > LOW-VALUES
 10785*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10786*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10787*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10788*          SET BIN-PLUS-ELAPSED  TO TRUE
 10789*          PERFORM 8500-DATE-CONVERT
 10790*                                THRU 8500-EXIT
 10791*          IF NO-CONVERSION-ERROR
 10792*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10793*             MOVE ER-2669       TO WS-ERROR
 10794*             PERFORM 9900-ERROR-FORMAT
 10795*                                THRU 9900-EXIT
 10796*          END-IF
 10797*       ELSE
 10798*          IF WS-ATT-AGE >= PL-ATT-AGE
 10799*             MOVE ER-2669       TO WS-ERROR
 10800*             PERFORM 9900-ERROR-FORMAT
 10801*                                THRU 9900-EXIT
 10802*          END-IF
 10803*       END-IF
 10804*    END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 198
* EL050.cbl
 10805     .
 10806 0570-CHECK-LIFE-LIMITS.
 10807
 10808     IF PB-COMPANY-ID EQUAL 'CRI'
 10809        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10810           IF SUB2 GREATER THAN +4
 10811              MOVE ER-2637 TO WS-ERROR
 10812              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10813              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10814
 10815     IF PB-COMPANY-ID  =  'NCL'
 10816        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10817            SUB2 GREATER THAN +8
 10818             MOVE 'U'         TO PB-BATCH-ENTRY
 10819             MOVE ER-2637     TO WS-ERROR
 10820             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10821             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10822
 10823     IF SUB2 > +8
 10824        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10825           AND (PB-I-SIG-SW = 'Y')
 10826           CONTINUE
 10827        ELSE
 10828           MOVE ER-2637          TO WS-ERROR
 10829           PERFORM 9900-ERROR-FORMAT
 10830                                 THRU 9900-EXIT
 10831        END-IF
 10832        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10833     END-IF
 10834     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10835     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10836     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10837
 10838     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10839        ADD +1  TO SUB2
 10840        GO TO 0570-CHECK-LIFE-LIMITS.
 10841
 10842     IF PB-COMPANY-ID = 'NCL'
 10843         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10844
 10845     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10846        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10847        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10848           AND (PB-I-SIG-SW = 'Y')
 10849           CONTINUE
 10850        ELSE
 10851           MOVE ER-2637          TO WS-ERROR
 10852           PERFORM 9900-ERROR-FORMAT
 10853                                 THRU 9900-EXIT
 10854        END-IF
 10855     END-IF
 10856     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10857
 10858
 10859 0570-CHECK-NCL-LIFE-LIMITS.
 10860
 10861     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10862        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 199
* EL050.cbl
 10863         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10864
 10865     IF APP-CERT-USED
 10866         IF SUB2  LESS THAN  +5
 10867             MOVE +5          TO SUB2
 10868             GO TO 0570-CHECK-LIFE-LIMITS.
 10869
 10870     MOVE ER-2637             TO WS-ERROR.
 10871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10872
 10873     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10874
 10875 0575-CHECK-NCL-SIG-SWITCH.
 10876
 10877     IF NOT APP-CERT-USED
 10878         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10879
 10880     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10881        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10882        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10883        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10884         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10885
 10886     IF SUB2 GREATER THAN +4
 10887         IF PL-LM-AGE (5) = ZEROS  AND
 10888            PL-LM-AGE (6) = ZEROS  AND
 10889            PL-LM-AGE (7) = ZEROS  AND
 10890            PL-LM-AGE (8) = ZEROS
 10891             MOVE  ER-1927        TO WS-ERROR
 10892             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10893             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10894         ELSE
 10895             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10896                 MOVE  ER-1920    TO WS-ERROR
 10897                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10898
 10899     IF PB-I-SIG-SW  = 'Y'
 10900       IF NOT PB-I-POLICY-ACCEPTED  AND
 10901          NOT PB-I-POLICY-DECLINED
 10902           MOVE 'U'               TO PB-BATCH-ENTRY
 10903           MOVE  ER-1926          TO WS-ERROR
 10904           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10905
 10906
 10907 0580-AH-PLAN-LIMIT-EDITS.
 10908
 10909     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10910        IF PB-I-AH-BENEFIT-AMT > +1250
 10911           MOVE ER-2702          TO WS-ERROR
 10912           PERFORM 9900-ERROR-FORMAT
 10913                                 THRU 9900-EXIT
 10914        END-IF
 10915     END-IF
 10916
 10917     IF (PB-COMPANY-ID = 'DCC')
 10918        AND (PB-MONTHLY-CERT)
 10919        IF PB-I-AH-BENEFIT-AMT > +3000
 10920           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 200
* EL050.cbl
 10921           PERFORM 9900-ERROR-FORMAT
 10922                                 THRU 9900-EXIT
 10923        END-IF
 10924     END-IF
 10925     IF NOT AH-PLAN-MASTER-FOUND
 10926        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10927        GO TO 3000-CONTINUE-EDIT.
 10928
 10929     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10930
 10931     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10932         IF PL-LM-AGE (1) = ZEROS
 10933             GO TO 3000-CONTINUE-EDIT.
 10934
 10935     IF NO-AH-BENEFIT-MATCH          OR
 10936        WS-AH-BENEFIT-CD = ZEROS     OR
 10937        WS-AH-SPECIAL-CALC-CD = 'M'
 10938        GO TO 3000-CONTINUE-EDIT.
 10939
 10940     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10941     MOVE +1                     TO SUB2.
 10942
 10943     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10944        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10945           MOVE +5 TO SUB2
 10946           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10947              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10948              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10949              (PL-LM-AGE (SUB2) EQUAL +0)
 10950              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10951              GO TO 3000-CONTINUE-EDIT.
 10952
 10953     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10954
 10955 0590-CHECK-AH-ATT-AGE.
 10956
 10957     IF PL-ATT-AGE NUMERIC AND
 10958        PL-ATT-AGE GREATER THAN +0
 10959        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10960     END-IF
 10961*       IF WS-ATT-AGE >= PL-ATT-AGE
 10962*          MOVE ER-3054          TO WS-ERROR
 10963*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10964     .
 10965 0597-CHECK-AH-LIMITS.
 10966
 10967     IF PB-COMPANY-ID EQUAL 'CRI'
 10968        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10969           IF SUB2 GREATER THAN +4
 10970              MOVE ER-2638       TO WS-ERROR
 10971              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10972              GO TO 3000-CONTINUE-EDIT.
 10973
 10974     IF PB-COMPANY-ID  =  'NCL'
 10975        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10976            SUB2 GREATER THAN +8
 10977             MOVE 'U'            TO PB-BATCH-ENTRY
 10978             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 201
* EL050.cbl
 10979             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10980             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10981
 10982     IF SUB2 > +8
 10983        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10984           AND (PB-I-SIG-SW = 'Y')
 10985           CONTINUE
 10986        ELSE
 10987           MOVE ER-2638          TO WS-ERROR
 10988           PERFORM 9900-ERROR-FORMAT
 10989                                 THRU 9900-EXIT
 10990        END-IF
 10991        GO TO 3000-CONTINUE-EDIT
 10992     END-IF
 10993
 10994     IF PB-COMPANY-ID = 'CRI'
 10995        IF WS-ERROR = ER-2638
 10996           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10997
 10998     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10999     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11000     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11001     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11002
 11003     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11004        ADD +1                   TO SUB2
 11005        GO TO 0597-CHECK-AH-LIMITS.
 11006
 11007     IF PB-COMPANY-ID = 'NCL'
 11008         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11009
 11010     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11011        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11012        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11013                                 > PL-LM-AMT (SUB2))
 11014        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11015           AND (PB-I-SIG-SW = 'Y')
 11016           CONTINUE
 11017        ELSE
 11018           MOVE ER-2638          TO WS-ERROR
 11019           PERFORM 9900-ERROR-FORMAT
 11020                                 THRU 9900-EXIT
 11021        END-IF
 11022     END-IF
 11023
 11024     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11025         IF  WS-ERROR    EQUAL    ER-2638
 11026             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11027                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11028                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11029                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11030                MOVE  ER-1910    TO  WS-ERROR
 11031                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11032
 11033     IF PB-COMPANY-ID = 'CRI'
 11034        IF WS-ERROR = ER-2638
 11035            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11036            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 202
* EL050.cbl
 11037            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11038
 11039     GO TO 3000-CONTINUE-EDIT.
 11040
 11041 0597-CHECK-NCL-AH-LIMITS.
 11042
 11043     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11044        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11045        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11046                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11047         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11048
 11049     IF APP-CERT-USED
 11050         IF SUB2  LESS THAN  +5
 11051             MOVE +5             TO SUB2
 11052             GO TO 0597-CHECK-AH-LIMITS.
 11053
 11054     MOVE ER-2638                TO WS-ERROR.
 11055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11056
 11057     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11058
 11059 0599-CHECK-NCL-SIG-SWITCH.
 11060
 11061     IF NOT APP-CERT-USED
 11062         GO TO 3000-CONTINUE-EDIT.
 11063
 11064     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11065        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11066        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11067        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11068         GO TO 3000-CONTINUE-EDIT.
 11069
 11070     IF SUB2 GREATER THAN +4
 11071         IF PL-LM-AGE (5) = ZEROS  AND
 11072            PL-LM-AGE (6) = ZEROS  AND
 11073            PL-LM-AGE (7) = ZEROS  AND
 11074            PL-LM-AGE (8) = ZEROS
 11075             MOVE  ER-1927        TO WS-ERROR
 11076             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11077             GO TO 3000-CONTINUE-EDIT
 11078         ELSE
 11079             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11080                 MOVE  ER-1920    TO WS-ERROR
 11081                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11082
 11083     IF PB-I-SIG-SW  = 'Y'
 11084       IF NOT PB-I-POLICY-ACCEPTED  AND
 11085          NOT PB-I-POLICY-DECLINED
 11086           MOVE 'U'               TO PB-BATCH-ENTRY
 11087           MOVE  ER-1926          TO WS-ERROR
 11088           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11089
 11090******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 203
* EL050.cbl
 11092
 11093 3000-CONTINUE-EDIT.
 11094
 11095     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11096     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11097     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11098     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11099     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11100
 11101     IF BROWSE-STARTED
 11102        PERFORM 9990-RETURN THRU 9990-EXIT
 11103        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11104
 11105     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11106        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11107        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11108        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11109*       MOVE 1                   TO DC-OPTION-CODE
 11110        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11111        IF DATE-CONVERSION-ERROR
 11112           MOVE ER-2622          TO WS-ERROR
 11113           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11114        ELSE
 11115           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11116              MOVE ER-2623       TO WS-ERROR
 11117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11118           ELSE
 11119              MOVE ER-2622       TO WS-ERROR
 11120              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11121
 11122     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11123     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11124     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11125*    MOVE 1                      TO DC-OPTION-CODE.
 11126     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11127     IF DATE-CONVERSION-ERROR
 11128        GO TO 3005-EDIT-CONTINUE
 11129     ELSE
 11130        IF DC-ELAPSED-DAYS GREATER +180
 11131           MOVE ER-2613          TO WS-ERROR
 11132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11133        ELSE
 11134           IF DC-ELAPSED-DAYS GREATER +90
 11135              MOVE ER-2612       TO WS-ERROR
 11136              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11137           ELSE
 11138             IF DC-ELAPSED-DAYS GREATER +60
 11139                MOVE ER-2614     TO WS-ERROR
 11140                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11141
 11142 3005-EDIT-CONTINUE.
 11143
 11144     IF PB-CANCELLATION
 11145         GO TO 3700-EDIT-CANCEL.
 11146
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 204
* EL050.cbl
 11148******************************************************************
 11149*                  E D I T   I S S U E                           *
 11150******************************************************************
 11151
 11152 3020-EDIT-ISSUE.
 11153
 11154      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11155      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11156      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11157      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11158      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11159
 11160     IF PB-ISSUE-FORCE
 11161        OR PB-ISSUE-DATE-FORCED
 11162        OR PB-FORCE-OFF
 11163        OR PB-OVERCHARGE-FORCE
 11164        CONTINUE
 11165     ELSE
 11166        MOVE ER-2670             TO WS-ERROR
 11167        PERFORM 9900-ERROR-FORMAT
 11168                                 THRU 9900-EXIT
 11169     END-IF
 11170     .
 11171 3022-SET-POLICY-STATUS.
 11172
 11173     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11174
 11175     IF (PB-REISSUED-CERT)
 11176             OR
 11177        ((PB-COMPANY-ID NOT = 'DCC')
 11178         AND (PB-MONTHLY-CERT))
 11179         MOVE '5'                TO PB-I-ENTRY-STATUS
 11180         MOVE 'E'                TO PB-BATCH-ENTRY
 11181     END-IF
 11182
 11183     IF PB-COMPANY-ID = 'DCC'
 11184        IF PB-MONTHLY-CERT
 11185           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11186        END-IF
 11187     END-IF
 11188     IF PB-POLICY-IS-DECLINED
 11189         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11190     IF PB-POLICY-IS-VOIDED
 11191         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11192     IF PB-NEEDS-UNDERWRITING
 11193         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11194     IF PB-REIN-ONLY-CERT
 11195         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11196     IF PB-PREM-ACCTNG-ONLY
 11197         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11198
 11199     MOVE SPACE                  TO PB-I-OB-FLAG.
 11200
 11201     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11202         MOVE ER-2665            TO WS-ERROR
 11203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11204         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11205
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 205
* EL050.cbl
 11206     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11207        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11208           MOVE 'Z'             TO PB-I-OB-FLAG.
 11209
 11210     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11211        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11212           MOVE 'Z'             TO PB-I-OB-FLAG.
 11213
 11214     IF ACCOUNT-MAST-FOUND
 11215         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11216         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11217         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11218         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11219         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11220         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11221         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11222     END-IF
 11223
 11224     IF ACCOUNT-MAST-FOUND
 11225        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11226         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11227
 11228     IF (ACCOUNT-MAST-FOUND)
 11229        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11230        IF PB-REISSUED-CERT
 11231           CONTINUE
 11232        ELSE
 11233           MOVE ER-2608          TO WS-ERROR
 11234           PERFORM 9900-ERROR-FORMAT
 11235                                 THRU 9900-EXIT
 11236         END-IF
 11237     END-IF
 11238
 11239     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11240        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11241        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11242
 11243**********   DMD CUSTOM CODE FOLLOWS  **********
 11244 3024-EDIT-DMD-FIELDS.
 11245     IF PB-COMPANY-ID NOT = 'DMD'
 11246        GO TO 3025-EDIT-REINSURANCE.
 11247
 11248*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11249*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11250*** ERROR IF THEY ARE NOT EQUAL.
 11251
 11252     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11253     SET BIN-TO-GREG               TO TRUE.
 11254     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11255     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11256**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11257
 11258     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11259     SET BIN-TO-GREG               TO TRUE.
 11260     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11261     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11262**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11263
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 206
* EL050.cbl
 11264     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11265        MOVE ER-8116               TO WS-ERROR
 11266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11267
 11268     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11269
 11270     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11271                                      WK-FULL-CERT-NO.
 11272     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11273
 11274     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11275
 11276     IF PB-VALID-LIFE
 11277        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11278     ELSE
 11279        IF PB-VALID-AH
 11280          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11281
 11282
 11283     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11284     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11285     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11286                                      DCUA-UNDRWRTR-CODE
 11287                                      DCUA-UNDRWRTR-GROUP-CODE
 11288                                      DCUA-RETURN-CODE.
 11289
 11290****************************************************************
 11291*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11292***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11293***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11294***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11295***   TO THIS RECORD.                                        ***
 11296****************************************************************
 11297     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11298     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11299     IF DCUA-SUCCESSFUL-PROCESS
 11300        GO TO 3024-EDIT-DL7-CONT.
 11301
 11302     IF DCUA-RETURN-CODE EQUAL '01'
 11303        MOVE ER-8110               TO WS-ERROR
 11304        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11306        GO TO 3024-EDIT-DL7-CONT.
 11307
 11308     IF DCUA-RETURN-CODE EQUAL '02'
 11309        MOVE ER-8111               TO WS-ERROR
 11310        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11312        GO TO 3024-EDIT-DL7-CONT.
 11313
 11314     IF DCUA-RETURN-CODE EQUAL '03'
 11315        MOVE ER-8074               TO WS-ERROR
 11316        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11318        GO TO 3024-EDIT-DL7-CONT.
 11319
 11320     IF DCUA-RETURN-CODE EQUAL '04'
 11321        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 207
* EL050.cbl
 11322        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11324        GO TO 3024-EDIT-DL7-CONT.
 11325
 11326     IF DCUA-RETURN-CODE EQUAL '05'
 11327        MOVE ER-8076               TO WS-ERROR
 11328        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330        GO TO 3024-EDIT-DL7-CONT.
 11331
 11332     IF DCUA-RETURN-CODE EQUAL '06'
 11333        MOVE ER-8077               TO WS-ERROR
 11334        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11336        GO TO 3024-EDIT-DL7-CONT.
 11337
 11338     IF DCUA-RETURN-CODE EQUAL '07'
 11339        MOVE ER-8078               TO WS-ERROR
 11340        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11342        GO TO 3024-EDIT-DL7-CONT.
 11343
 11344     IF DCUA-RETURN-CODE EQUAL 'E1'
 11345        MOVE ER-8079               TO WS-ERROR
 11346        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11348        GO TO 3024-EDIT-DL7-CONT.
 11349
 11350     IF DCUA-RETURN-CODE EQUAL 'E2'
 11351        MOVE ER-8080               TO WS-ERROR
 11352        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11354        GO TO 3024-EDIT-DL7-CONT.
 11355
 11356     IF DCUA-RETURN-CODE EQUAL 'E3'
 11357        MOVE ER-8098               TO WS-ERROR
 11358        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11359        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11360        GO TO 3024-EDIT-DL7-CONT.
 11361
 11362     IF DCUA-RETURN-CODE EQUAL 'C1'
 11363        MOVE ER-8099               TO WS-ERROR
 11364        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11366        GO TO 3024-EDIT-DL7-CONT.
 11367
 11368     IF DCUA-RETURN-CODE EQUAL 'U1'
 11369        MOVE ER-8109               TO WS-ERROR
 11370        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11372        GO TO 3024-EDIT-DL7-CONT.
 11373
 11374     IF DCUA-RETURN-CODE EQUAL 'N1'
 11375        MOVE ER-8112               TO WS-ERROR
 11376        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11378        GO TO 3024-EDIT-DL7-CONT.
 11379
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 208
* EL050.cbl
 11380     IF DCUA-RETURN-CODE EQUAL 'N2'
 11381        MOVE ER-8113               TO WS-ERROR
 11382        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11384        GO TO 3024-EDIT-DL7-CONT.
 11385
 11386     IF DCUA-RETURN-CODE EQUAL 'N3'
 11387        MOVE ER-8114               TO WS-ERROR
 11388        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390        GO TO 3024-EDIT-DL7-CONT.
 11391
 11392     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11393     MOVE ER-8097                  TO WS-ERROR.
 11394     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11395     GO TO 3024-EDIT-DL7-CONT.
 11396
 11397 3024-EDIT-DL7-CONT.
 11398
 11399     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11400     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11401     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11402        NEXT SENTENCE
 11403     ELSE
 11404        MOVE ER-9263               TO WS-ERROR
 11405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11406
 11407******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11408******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11409     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11410        NEXT SENTENCE
 11411     ELSE
 11412        MOVE ER-8039               TO WS-ERROR
 11413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11414
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 209
* EL050.cbl
 11416****************************************************************
 11417*** VALIDATE STATE  : DLO022                                 ***
 11418****************************************************************
 11419     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11420     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11421
 11422     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11423     IF DVSC-SUCCESSFUL-EDIT
 11424        GO TO 3024-EDIT-DL22-CONT.
 11425
 11426     IF DVSC-RETURN-CODE EQUAL '01'
 11427        MOVE ER-8300               TO WS-ERROR
 11428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11429        GO TO 3024-EDIT-DL22-CONT.
 11430
 11431     IF DVSC-RETURN-CODE EQUAL '02'
 11432        MOVE ER-8301               TO WS-ERROR
 11433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11434        GO TO 3024-EDIT-DL22-CONT.
 11435
 11436     IF DVSC-RETURN-CODE EQUAL '03'
 11437        MOVE ER-8302               TO WS-ERROR
 11438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11439        GO TO 3024-EDIT-DL22-CONT.
 11440
 11441     IF DVSC-RETURN-CODE EQUAL 'N1'
 11442        MOVE ER-8304               TO WS-ERROR
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 3024-EDIT-DL22-CONT.
 11445
 11446     MOVE ER-8303                  TO WS-ERROR
 11447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11448
 11449 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 210
* EL050.cbl
 11451****************************************************************
 11452*** VALIDATE LOAN OFFICER : DLO021                           ***
 11453****************************************************************
 11454
 11455     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11456     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11457     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11458     IF DVLO-SUCCESSFUL-EDIT
 11459        GO TO 3024-EDIT-DL21-CONT.
 11460
 11461     IF DVLO-RETURN-CODE EQUAL '01'
 11462        MOVE ER-8081               TO WS-ERROR
 11463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11464        GO TO 3024-EDIT-DL21-CONT.
 11465
 11466     IF DVLO-RETURN-CODE EQUAL '02'
 11467        MOVE ER-8082               TO WS-ERROR
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469        GO TO 3024-EDIT-DL21-CONT.
 11470
 11471     IF DVLO-RETURN-CODE EQUAL '03'
 11472        MOVE ER-8083               TO WS-ERROR
 11473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474        GO TO 3024-EDIT-DL21-CONT.
 11475
 11476     IF DVLO-RETURN-CODE EQUAL '04'
 11477        MOVE ER-8084               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL21-CONT.
 11480
 11481     IF DVLO-RETURN-CODE EQUAL '05'
 11482        MOVE ER-8085               TO WS-ERROR
 11483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484        GO TO 3024-EDIT-DL21-CONT.
 11485
 11486     MOVE ER-7825                  TO WS-ERROR
 11487     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11488     GO TO 3024-EDIT-DL21-CONT.
 11489
 11490 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 211
* EL050.cbl
 11492
 11493****************************************************************
 11494*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11495****************************************************************
 11496
 11497     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11498     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11499     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11500     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11501     IF DIPF-SUCCESSFUL-EDIT
 11502        GO TO 3024-EDIT-DL02-CONT.
 11503
 11504     IF DIPF-RETURN-CODE EQUAL '01'
 11505        MOVE ER-8086               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL02-CONT.
 11508
 11509     IF DIPF-RETURN-CODE EQUAL '02'
 11510        MOVE ER-8087               TO WS-ERROR
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL02-CONT.
 11513
 11514     IF DIPF-RETURN-CODE EQUAL '03'
 11515        MOVE ER-8088               TO WS-ERROR
 11516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517        GO TO 3024-EDIT-DL02-CONT.
 11518
 11519     MOVE ER-8095                  TO WS-ERROR
 11520     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11521     GO TO 3024-EDIT-DL02-CONT.
 11522
 11523 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 212
* EL050.cbl
 11525
 11526****************************************************************
 11527*** VALIDATE BANK ID : DLO003                                ***
 11528****************************************************************
 11529
 11530     MOVE WK-GREG-CENT           TO WCG-CENT.
 11531     MOVE WK-GREG-YYMM           TO WCG-REST.
 11532     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11533        MOVE ER-8040               TO WS-ERROR
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11535
 11536     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11537     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11538     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11539     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11540     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11541     IF DVBI-SUCCESSFUL-EDIT
 11542        GO TO 3024-EDIT-DL03-CONT.
 11543
 11544     IF DVBI-RETURN-CODE EQUAL '01'
 11545        MOVE ER-8089               TO WS-ERROR
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL03-CONT.
 11548
 11549     IF DVBI-RETURN-CODE EQUAL '02'
 11550        MOVE ER-8090               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL03-CONT.
 11553
 11554     IF DVBI-RETURN-CODE EQUAL '03'
 11555        MOVE ER-8091               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL03-CONT.
 11558
 11559     IF DVBI-RETURN-CODE EQUAL '04'
 11560        MOVE ER-8092               TO WS-ERROR
 11561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11562        GO TO 3024-EDIT-DL03-CONT.
 11563
 11564     IF DVBI-RETURN-CODE EQUAL '05'
 11565        MOVE ER-8093               TO WS-ERROR
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL03-CONT.
 11568
 11569     IF DVBI-RETURN-CODE EQUAL '06'
 11570        MOVE ER-8094               TO WS-ERROR
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL03-CONT.
 11573
 11574     MOVE ER-8096                  TO WS-ERROR
 11575     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11576     GO TO 3024-EDIT-DL03-CONT.
 11577
 11578 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 213
* EL050.cbl
 11580
 11581     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11582        NEXT SENTENCE
 11583     ELSE
 11584        MOVE ER-8042               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11586
 11587     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11588     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11589     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11590
 11591     IF DMPF-RETURN-CODE = '01'
 11592        MOVE ER-8067               TO WS-ERROR
 11593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11594        GO TO 3024-EDIT-DL01-CONT.
 11595
 11596     IF DMPF-RETURN-CODE = '02'
 11597        MOVE ER-8068               TO WS-ERROR
 11598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11599        GO TO 3024-EDIT-DL01-CONT.
 11600
 11601     IF DMPF-RETURN-CODE = '03'
 11602        MOVE ER-8069               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11604        GO TO 3024-EDIT-DL01-CONT.
 11605
 11606     IF DMPF-RETURN-CODE = 'E1'
 11607        MOVE ER-8070               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL01-CONT.
 11610
 11611     IF DMPF-RETURN-CODE = 'N1'
 11612        MOVE ER-8071               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL01-CONT.
 11615
 11616     IF DMPF-RETURN-CODE NOT = 'OK'
 11617        MOVE ER-8072               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11619
 11620 3024-EDIT-DL01-CONT.
 11621******************************************************************
 11622***  VALIDATES RATE CODES : DLO017                             ***
 11623******************************************************************
 11624
 11625      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11626      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11627      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11628      IF DVRC-SUCCESSFUL-EDIT
 11629        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11630        GO TO 3024-CHECK-VALID-RATE.
 11631
 11632      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11633
 11634      IF DVRC-RETURN-CODE EQUAL '01'
 11635         MOVE ER-7817                   TO WS-ERROR
 11636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11637         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 214
* EL050.cbl
 11638
 11639      IF DVRC-RETURN-CODE EQUAL '02'
 11640         MOVE ER-7818                   TO WS-ERROR
 11641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11642         GO TO 3025-EDIT-REINSURANCE.
 11643
 11644      IF DVRC-RETURN-CODE EQUAL '03'
 11645         MOVE ER-7819                   TO WS-ERROR
 11646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11647         GO TO 3025-EDIT-REINSURANCE.
 11648
 11649       MOVE ER-7820                     TO WS-ERROR.
 11650       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11651       GO TO 3025-EDIT-REINSURANCE.
 11652
 11653******************************************************************
 11654***  GET PREMIUM RATES : DLO011                                ***
 11655******************************************************************
 11656
 11657 3024-CHECK-VALID-RATE.
 11658
 11659     IF VALID-RATE-CODE
 11660        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11661        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11662        MOVE SPACES                TO DPRB-RETURN-CODE
 11663        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11664     ELSE
 11665         GO TO 3025-EDIT-REINSURANCE.
 11666
 11667      IF DPRB-SUCCESSFUL-PROCESS
 11668         IF PB-VALID-LIFE
 11669             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11670             GO TO 3025-EDIT-REINSURANCE
 11671         ELSE
 11672             IF PB-VALID-AH
 11673                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11674                 GO TO 3025-EDIT-REINSURANCE.
 11675
 11676      IF DPRB-RETURN-CODE EQUAL '01'
 11677         MOVE ER-7812                   TO WS-ERROR
 11678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679         GO TO 3025-EDIT-REINSURANCE.
 11680
 11681      IF DPRB-RETURN-CODE EQUAL '02'
 11682         MOVE ER-7813                   TO WS-ERROR
 11683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11684         GO TO 3025-EDIT-REINSURANCE.
 11685
 11686      IF DPRB-RETURN-CODE EQUAL '03'
 11687         MOVE ER-7814                   TO WS-ERROR
 11688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689         GO TO 3025-EDIT-REINSURANCE.
 11690
 11691      IF DPRB-RETURN-CODE EQUAL '04'
 11692         IF NOT DPRB-1ST-TIME
 11693            MOVE ER-7815                   TO WS-ERROR
 11694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11695            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 215
* EL050.cbl
 11696          ELSE
 11697         IF PB-VALID-LIFE
 11698            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11699          ELSE
 11700            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11701         END-IF
 11702         MOVE SPACES                TO DOCC-RETURN-CODE
 11703         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11704         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11705         IF DOCC-RETURN-CODE = 'OK'
 11706             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11707             GO TO 3024-CHECK-VALID-RATE
 11708           ELSE
 11709             MOVE ER-7823               TO WS-ERROR
 11710             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11711             GO TO 3025-EDIT-REINSURANCE.
 11712
 11713       MOVE ER-7816                     TO WS-ERROR.
 11714       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11715       GO TO 3025-EDIT-REINSURANCE.
 11716
 11717**********   DMD CUSTOM CODE ABOVE    **********
 11718
 11719 3025-EDIT-REINSURANCE.
 11720     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11721         GO TO 3027-EDIT-CONTINUE.
 11722
 11723     MOVE LOW-VALUES               TO ERREIN-KEY.
 11724     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11725     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11726                                      REIN-CODE-2
 11727                                      REIN-CODE-3.
 11728     MOVE 'A'                      TO REIN-TYPE.
 11729
 11730     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11731
 11732     MOVE '3026' TO REIN-SW.
 11733     MOVE ' '                   TO WS-REIN-READ-SW.
 11734
 11735     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11736     IF REIN-TABLE-NOT-FOUND
 11737         GO TO 3026-NO-SPEC-TABLE.
 11738
 11739     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11740     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11741                                   WS-NSP-ST-CD-LF.
 11742     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11743                                   WS-NSP-ST-CD-AH.
 11744
 11745     GO TO 3040-EDIT-CONTINUE.
 11746
 11747 3026-NO-SPEC-TABLE.
 11748
 11749     MOVE ER-2664                TO WS-ERROR.
 11750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11751     GO TO 3040-EDIT-CONTINUE.
 11752
 11753 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 216
* EL050.cbl
 11754
 11755     IF PB-I-REIN-TABLE = SPACES
 11756       GO TO 3040-EDIT-CONTINUE.
 11757
 11758     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11759          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11760          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11761           GO TO 3040-EDIT-CONTINUE.
 11762
 11763     MOVE LOW-VALUES            TO ERREIN-KEY.
 11764     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11765     MOVE 'A'                   TO REIN-TYPE.
 11766     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11767
 11768     MOVE '3028'                TO REIN-SW.
 11769     MOVE ' '                   TO WS-REIN-READ-SW.
 11770
 11771     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11772     IF REIN-TABLE-NOT-FOUND
 11773         GO TO 3028-NO-REIN-TABLE.
 11774
 11775     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11776     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11777                                   WS-NSP-ST-CD-LF.
 11778     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11779                                   WS-NSP-ST-CD-AH.
 11780
 11781     GO TO 3040-EDIT-CONTINUE.
 11782
 11783 3028-NO-REIN-TABLE.
 11784
 11785     MOVE ER-2615                TO WS-ERROR.
 11786     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11787     GO TO 3040-EDIT-CONTINUE.
 11788
 11789 3040-EDIT-CONTINUE.
 11790
 11791     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11792         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11793
 11794     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11795         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11796
 11797     IF (NOT PB-REISSUED-CERT)
 11798        AND (NOT PB-MONTHLY-CERT)
 11799        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11800            MOVE '001'           TO PB-I-LF-TERM
 11801            MOVE 'M'             TO PB-I-INSURED-SEX.
 11802
 11803     IF (NOT PB-REISSUED-CERT)
 11804        AND (NOT PB-MONTHLY-CERT)
 11805        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11806            MOVE '001'           TO PB-I-AH-TERM
 11807            MOVE 'M'             TO PB-I-INSURED-SEX.
 11808
 11809 3040-EDIT-1ST-PMT-DT.
 11810     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11811     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 217
* EL050.cbl
 11812         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11813
 11814******************************************************************
 11815*                                                                *
 11816*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11817*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11818*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11819*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11820*                                                                *
 11821******************************************************************
 11822
 11823     IF PB-EFF-DT-PROCESSING
 11824        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11825                                    PB-I-LF-EXPIRE-DT
 11826                                    PB-I-AH-EXPIRE-DT
 11827        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11828        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11829        MOVE ZERO                TO DC-ELAPSED-DAYS
 11830        MOVE +1                  TO DC-ELAPSED-MONTHS
 11831        SET BIN-PLUS-ELAPSED     TO TRUE
 11832*       MOVE 6                   TO DC-OPTION-CODE
 11833        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11834        IF NO-CONVERSION-ERROR
 11835           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11836
 11837******************************************************************
 11838*                                                                *
 11839*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11840*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11841*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11842*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11843*                                                                *
 11844******************************************************************
 11845
 11846     IF PB-EXT-DAYS-PROCESSING
 11847          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11848                                         PB-I-LF-EXPIRE-DT
 11849                                         PB-I-AH-EXPIRE-DT
 11850          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11851          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11852          MOVE +1                     TO DC-ELAPSED-MONTHS
 11853          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11854          SET BIN-PLUS-ELAPSED        TO TRUE
 11855*         MOVE 6                      TO DC-OPTION-CODE
 11856          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11857          IF NO-CONVERSION-ERROR
 11858             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11859
 11860******************************************************************
 11861*                                                                *
 11862*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11863*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11864*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11865*        (EXPIRE DATE - (TERM -1))  *  -1.
 11866*                                                                *
 11867******************************************************************
 11868
 11869     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 218
* EL050.cbl
 11870        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11871           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11872              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11873              MOVE PB-I-AH-TERM      TO WS-TERM
 11874           ELSE
 11875              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11876              MOVE PB-I-LF-TERM      TO WS-TERM
 11877        ELSE
 11878           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11879              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11880              MOVE PB-I-LF-TERM      TO WS-TERM
 11881           ELSE
 11882              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11883              MOVE PB-I-AH-TERM      TO WS-TERM.
 11884
 11885     IF PB-EXPIRE-DT-PROCESSING
 11886        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11887        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11888        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11889        MOVE ZERO                TO DC-ELAPSED-DAYS
 11890                                    DC-ODD-DAYS-OVER
 11891          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11892          SET BIN-PLUS-ELAPSED    TO TRUE
 11893*         MOVE 6                  TO DC-OPTION-CODE
 11894          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11895          IF NO-CONVERSION-ERROR
 11896             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11897
 11898******************************************************************
 11899*                                                                *
 11900*            1ST PAYMENT DATE PROCESSING                         *
 11901*                                                                *
 11902******************************************************************
 11903
 11904     IF PB-1ST-PMT-DT-PROCESSING
 11905        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11906                                    PB-I-AH-EXPIRE-DT
 11907        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11908
 11909     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11910         NEXT SENTENCE
 11911     ELSE
 11912         MOVE ER-2680                 TO WS-ERROR
 11913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         GO TO 3060-ORIG-TERM-CHECK.
 11915
 11916     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11917     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11918     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11919*    MOVE 1                      TO DC-OPTION-CODE.
 11920     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11921                                    DC-ELAPSED-DAYS
 11922                                    DC-ODD-DAYS-OVER.
 11923
 11924     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11925
 11926     IF DATE-CONVERSION-ERROR
 11927        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 219
* EL050.cbl
 11928
 11929     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11930     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11931        AND (WS-LF-COVERAGE-TYPE = 'L')
 11932        IF (DC-ELAPSED-MONTHS > 1)
 11933                      OR
 11934           ((DC-ELAPSED-MONTHS = 1)
 11935           AND (DC-ODD-DAYS-OVER > 0))
 11936           MOVE ER-2882          TO WS-ERROR
 11937           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938        END-IF
 11939     END-IF
 11940     IF PB-EXT-DAYS-PROCESSING
 11941        CONTINUE
 11942     ELSE
 11943        IF DC-ELAPSED-MONTHS = +0
 11944           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11945        ELSE
 11946           IF (WS-LF-EARNINGS-CALC = '4')
 11947              AND (DC-ELAPSED-MONTHS > ZERO)
 11948              AND (DC-ELAPSED-DAYS > ZERO)
 11949              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11950           ELSE
 11951              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11952                                 THRU 6499-EXIT
 11953              MOVE WS-ODD-DAYS-OVER
 11954                                 TO PB-I-EXTENTION-DAYS
 11955           END-IF
 11956        END-IF
 11957     END-IF
 11958******************************************************************
 11959*                                                                *
 11960*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11961*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11962*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11963*            AND ANY ODD DAYS.                                   *
 11964*                                                                *
 11965******************************************************************
 11966
 11967     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11968                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11969     IF WS-LF-EARNINGS-CALC NOT = '4'
 11970        IF DC-ELAPSED-DAYS > ZEROS
 11971           MOVE ER-2681          TO WS-ERROR
 11972           PERFORM 9900-ERROR-FORMAT
 11973                                 THRU 9900-EXIT
 11974        END-IF
 11975     END-IF
 11976
 11977     IF WS-LF-EARNINGS-CALC NOT = '4'
 11978        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11979           MOVE ER-2681          TO WS-ERROR
 11980           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11981
 11982     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11983        (PB-I-LF-TERM NOT = ZERO) AND
 11984         NOT NO-LIFE-COVERAGE
 11985          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 220
* EL050.cbl
 11986          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11987          IF WS-LF-EARNINGS-CALC = '4'
 11988             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11989             PB-I-PAY-FREQUENCY
 11990          END-IF
 11991          MOVE ZERO              TO DC-ELAPSED-DAYS
 11992                                    DC-ODD-DAYS-OVER
 11993          MOVE 1                 TO DC-END-OF-MONTH
 11994          SET BIN-PLUS-ELAPSED        TO TRUE
 11995*         MOVE 6                 TO DC-OPTION-CODE
 11996          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11997          IF NO-CONVERSION-ERROR
 11998             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11999             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12000                (WS-LF-SPECIAL-CALC-CD = 'L')
 12001                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12002                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12003                  MOVE +1             TO DC-ELAPSED-MONTHS
 12004                  SET BIN-PLUS-ELAPSED  TO TRUE
 12005*                 MOVE 6              TO DC-OPTION-CODE
 12006                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12007                  IF NO-CONVERSION-ERROR
 12008                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12009
 12010* okay, i had to move the new att age edit down here because the
 12011* expiration date could get recalculated and i need the exp date
 12012     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12013        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12014        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12015        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12016           AND ZEROS
 12017           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12018           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12019           SET ELAPSED-BETWEEN-BIN TO TRUE
 12020           PERFORM 8500-DATE-CONVERT
 12021                                 THRU 8500-EXIT
 12022           IF NO-CONVERSION-ERROR
 12023              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12024                 MOVE ER-2669       TO WS-ERROR
 12025*                PERFORM 9900-ERROR-FORMAT
 12026*                                THRU 9900-EXIT
 12027              END-IF
 12028           END-IF
 12029        ELSE
 12030           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12031           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12032              MOVE ER-2669       TO WS-ERROR
 12033*             PERFORM 9900-ERROR-FORMAT
 12034*                                THRU 9900-EXIT
 12035           ELSE
 12036              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12037                 MOVE ER-1570    TO WS-ERROR
 12038                 PERFORM 9900-ERROR-FORMAT
 12039                                 THRU 9900-EXIT
 12040              END-IF
 12041           END-IF
 12042        END-IF
 12043        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 221
* EL050.cbl
 12044           AND ZEROS
 12045           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12046           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12047           SET ELAPSED-BETWEEN-BIN TO TRUE
 12048           PERFORM 8500-DATE-CONVERT
 12049                                 THRU 8500-EXIT
 12050           IF NO-CONVERSION-ERROR
 12051              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12052                 MOVE ER-2669       TO WS-ERROR
 12053*                PERFORM 9900-ERROR-FORMAT
 12054*                                THRU 9900-EXIT
 12055              END-IF
 12056           END-IF
 12057        ELSE
 12058           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12059             (PB-I-LF-TERM / 12)
 12060           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12061              MOVE ER-2669       TO WS-ERROR
 12062*             PERFORM 9900-ERROR-FORMAT
 12063*                                THRU 9900-EXIT
 12064           ELSE
 12065              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12066                 MOVE ER-1571    TO WS-ERROR
 12067                 PERFORM 9900-ERROR-FORMAT
 12068                                 THRU 9900-EXIT
 12069              END-IF
 12070           END-IF
 12071        END-IF
 12072        IF WS-ERROR = ER-2669
 12073           PERFORM 9900-ERROR-FORMAT
 12074                                 THRU 9900-EXIT
 12075        END-IF
 12076     END-IF
 12077     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12078        (PB-I-AH-TERM NOT = ZERO) AND
 12079         NOT NO-AH-COVERAGE
 12080          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12081             AND (PB-COMPANY-ID = 'DCC')
 12082             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12083             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12084          ELSE
 12085             IF WS-LF-EARNINGS-CALC = '4'
 12086                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12087                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12088                PB-I-PAY-FREQUENCY
 12089             ELSE
 12090                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12091                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12092             END-IF
 12093          END-IF
 12094          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12095                                         DC-ODD-DAYS-OVER
 12096          MOVE 1                      TO DC-END-OF-MONTH
 12097          SET BIN-PLUS-ELAPSED        TO TRUE
 12098*         MOVE 6                      TO DC-OPTION-CODE
 12099          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12100          IF NO-CONVERSION-ERROR
 12101             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 222
* EL050.cbl
 12102     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12103        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12104        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12105        IF PB-I-BIRTHDAY > LOW-VALUES
 12106           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12107           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12108           SET ELAPSED-BETWEEN-BIN TO TRUE
 12109           PERFORM 8500-DATE-CONVERT
 12110                                 THRU 8500-EXIT
 12111           IF NO-CONVERSION-ERROR
 12112              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12113                 MOVE ER-3054       TO WS-ERROR
 12114*                PERFORM 9900-ERROR-FORMAT
 12115*                                THRU 9900-EXIT
 12116              END-IF
 12117           END-IF
 12118        ELSE
 12119           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12120           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12121              MOVE ER-3054       TO WS-ERROR
 12122*             PERFORM 9900-ERROR-FORMAT
 12123*                                THRU 9900-EXIT
 12124           END-IF
 12125        END-IF
 12126        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12127           AND ZEROS
 12128           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12129           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12130           SET ELAPSED-BETWEEN-BIN TO TRUE
 12131           PERFORM 8500-DATE-CONVERT
 12132                                 THRU 8500-EXIT
 12133           IF NO-CONVERSION-ERROR
 12134              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12135                 MOVE ER-3054       TO WS-ERROR
 12136*                PERFORM 9900-ERROR-FORMAT
 12137*                                THRU 9900-EXIT
 12138              END-IF
 12139           END-IF
 12140        ELSE
 12141           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12142             (PB-I-AH-TERM / 12)
 12143           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12144              MOVE ER-3054       TO WS-ERROR
 12145*             PERFORM 9900-ERROR-FORMAT
 12146*                                THRU 9900-EXIT
 12147           END-IF
 12148        END-IF
 12149        IF WS-ERROR = ER-3054
 12150           PERFORM 9900-ERROR-FORMAT
 12151                                 THRU 9900-EXIT
 12152        END-IF
 12153     END-IF
 12154     MOVE SPACE                       TO DC-END-OF-MONTH.
 12155
 12156     IF PB-COMPANY-ID = 'NCB'
 12157        GO TO 3040-EDIT-EXTENSION-DAYS.
 12158
 12159     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 223
* EL050.cbl
 12160       AND
 12161        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12162        NEXT SENTENCE
 12163     ELSE
 12164        GO TO 3040-EDIT-EXTENSION-DAYS.
 12165
 12166     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12167        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12168        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12169     ELSE
 12170        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12171        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12172
 12173     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12174*    MOVE '1'      TO DC-OPTION-CODE
 12175     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12176     IF (NO-CONVERSION-ERROR)
 12177        AND (DC-ELAPSED-MONTHS > +1)
 12178        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12179        MOVE ER-2668   TO WS-ERROR
 12180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12181
 12182 3040-EDIT-EXTENSION-DAYS.
 12183
 12184     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12185        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12186         GO TO 3050-EDIT-TERM-IN-DAYS
 12187     ELSE
 12188         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12189
 12190     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12191         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12192     ELSE
 12193        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12194           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12195           MOVE ER-2681         TO WS-ERROR
 12196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12197
 12198     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12199        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12200        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12201         GO TO 3060-ORIG-TERM-CHECK.
 12202
 12203     GO TO 3060-ORIG-TERM-CHECK.
 12204
 12205 3050-EDIT-TERM-IN-DAYS.
 12206
 12207     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12208
 12209     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12210         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12211     ELSE
 12212         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12213            MOVE ER-2682         TO WS-ERROR
 12214            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12215
 12216     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12217                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 224
* EL050.cbl
 12218     IF WS-WORK-TERM GREATER THAN ZERO
 12219         ADD +1 TO PB-I-LF-TERM.
 12220
 12221     IF NOT NO-AH-COVERAGE
 12222         MOVE ER-2684            TO WS-ERROR
 12223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12224
 12225
 12226 3060-ORIG-TERM-CHECK.
 12227
 12228******************************************************************
 12229*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12230******************************************************************
 12231
 12232     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12233        NEXT SENTENCE
 12234     ELSE
 12235        IF NOT NO-LIFE-COVERAGE
 12236           IF PB-I-LF-TERM NUMERIC
 12237              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12238              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12239              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12240                  NEXT SENTENCE
 12241           ELSE
 12242              MOVE ER-2647       TO WS-ERROR
 12243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12244
 12245     IF NOT NO-AH-COVERAGE
 12246         IF PB-I-AH-TERM NUMERIC
 12247            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12248            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12249            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12250             NEXT SENTENCE
 12251          ELSE
 12252              MOVE ER-2658       TO WS-ERROR
 12253              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12254
 12255     IF PB-COMPANY-ID = 'NCB'
 12256        GO TO 3070-LOAN-TERM-CHECK.
 12257
 12258     IF POLICY-HAS-AH
 12259       AND
 12260        POLICY-HAS-LIFE
 12261       AND
 12262        PB-I-LF-TERM NUMERIC
 12263       AND
 12264        PB-I-AH-TERM NUMERIC
 12265        NEXT SENTENCE
 12266     ELSE
 12267        GO TO 3070-LOAN-TERM-CHECK.
 12268
 12269     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12270     IF WS-TEX-FACT-2 LESS THAN +0
 12271        MULTIPLY +1 BY WS-TEX-FACT-2.
 12272
 12273     IF WS-TEX-FACT-2 GREATER THAN +1
 12274        MOVE ER-2668             TO WS-ERROR
 12275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 225
* EL050.cbl
 12276
 12277 3070-LOAN-TERM-CHECK.
 12278
 12279     IF (WS-LF-BENEFIT-CD = ZERO)
 12280         OR (NO-LF-BENEFIT-MATCH)
 12281            GO TO 3125-EDIT-PMT-FREQ.
 12282*    IF PB-COMPANY-ID NOT = 'DCC'
 12283*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12284*          AND 'V' AND 'W' AND 'X'
 12285*          GO TO 3125-EDIT-PMT-FREQ
 12286*       END-IF
 12287*    ELSE
 12288*       IF WS-AH-DCC-TRUNC = 'T'
 12289*          CONTINUE
 12290*       ELSE
 12291*          GO TO 3125-EDIT-PMT-FREQ
 12292*       END-IF
 12293*    END-IF
 12294     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12295                    OR
 12296        ((PB-COMPANY-ID = 'DCC')
 12297        AND (WS-AH-DCC-TRUNC = 'T'))
 12298        CONTINUE
 12299     ELSE
 12300        GO TO 3125-EDIT-PMT-FREQ
 12301     END-IF
 12302     IF PB-I-LOAN-TERM NOT NUMERIC
 12303         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12304
 12305     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12306        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12307*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12308        PB-I-LOAN-TERM NOT GREATER THAN +360
 12309         NEXT SENTENCE
 12310     ELSE
 12311         MOVE ER-2648            TO WS-ERROR
 12312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12313
 12314     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12315        MOVE ER-3058             TO WS-ERROR
 12316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12317     end-if
 12318
 12319     IF WS-STATE-ABBREVIATION = 'NC'
 12320        IF PB-I-LOAN-TERM > +59
 12321           CONTINUE
 12322        ELSE
 12323           MOVE ER-2792          TO WS-ERROR
 12324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12325        END-IF
 12326     END-IF
 12327
 12328     .
 12329 3125-EDIT-PMT-FREQ.
 12330     IF (WS-LF-BENEFIT-CD = ZERO)
 12331         OR (NO-LF-BENEFIT-MATCH)
 12332            GO TO 3127-EDIT-LOAN-OFFICER.
 12333     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 226
* EL050.cbl
 12334                    OR
 12335        ((PB-COMPANY-ID = 'DCC')
 12336        AND (WS-AH-DCC-TRUNC = 'T'))
 12337                    OR
 12338         (PB-COMPANY-ID = 'AHL')
 12339        CONTINUE
 12340     ELSE
 12341        IF (PB-I-LOAN-TERM > ZEROS)
 12342           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12343           MOVE ER-1575          TO WS-ERROR
 12344           PERFORM 9900-ERROR-FORMAT
 12345                                 THRU 9900-EXIT
 12346        END-IF
 12347     END-IF
 12348     IF WS-LF-EARNINGS-CALC NOT = '4'
 12349         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12350            MOVE ER-2653         TO WS-ERROR
 12351            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12352            GO TO 3127-EDIT-LOAN-OFFICER
 12353         ELSE
 12354            GO TO 3127-EDIT-LOAN-OFFICER.
 12355
 12356     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12357         MOVE ER-2655            TO WS-ERROR
 12358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12359         GO TO 3127-EDIT-LOAN-OFFICER.
 12360
 12361     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12362         MOVE ER-2654            TO WS-ERROR
 12363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12364         GO TO 3127-EDIT-LOAN-OFFICER.
 12365
 12366     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12367         GIVING WS-TEX-FACT-2
 12368             REMAINDER WS-TEX-FACT-3.
 12369
 12370*    IF WS-TEX-FACT-3 NOT = ZERO
 12371*       MOVE ER-2654             TO WS-ERROR
 12372*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12373
 12374
 12375 3127-EDIT-LOAN-OFFICER.
 12376
 12377     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12378        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12379           MOVE ER-2690          TO WS-ERROR
 12380           PERFORM 9900-ERROR-FORMAT
 12381                                 THRU 9900-EXIT
 12382        ELSE
 12383           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12384           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12385           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12386           MOVE PB-SV-STATE      TO LOFC-STATE
 12387           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12388           MOVE PB-I-LOAN-OFFICER
 12389                                 TO LOFC-CODE
 12390           PERFORM 8586-READ-LOAN-OFFICER
 12391                                 THRU 8586-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 227
* EL050.cbl
 12392           IF (NOT LOFC-MASTER-FOUND)
 12393              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12394              MOVE ER-3006       TO WS-ERROR
 12395              PERFORM 9900-ERROR-FORMAT
 12396                                 THRU 9900-EXIT
 12397           END-IF
 12398        END-IF
 12399     END-IF
 12400     .
 12401 3129-EDIT-APR.
 12402
 12403     IF (WS-LF-BENEFIT-CD = ZERO)
 12404        OR (NO-LF-BENEFIT-MATCH)
 12405        IF PB-COMPANY-ID NOT = 'DCC'
 12406           GO TO 3130-EDIT-AGE
 12407*       ELSE
 12408*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12409*             GO TO 3130-EDIT-AGE
 12410*          END-IF
 12411        END-IF
 12412     END-IF
 12413
 12414     IF (WS-STATE-ABBREVIATION = 'OH')
 12415         AND (PB-I-RATE-CLASS NOT = 'L ')
 12416         AND (PB-I-LF-TERM GREATER THAN 60)
 12417         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12418         GO TO 3129-APR-CONT.
 12419
 12420     IF (WS-STATE-ABBREVIATION = 'RI')
 12421         AND (PB-I-LF-TERM GREATER THAN 60)
 12422         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12423         GO TO 3129-APR-CONT.
 12424
 12425     IF (WS-STATE-ABBREVIATION = 'UT')
 12426         AND (PB-I-LF-TERM GREATER THAN 62)
 12427         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12428         AND (PB-CERT-EFF-DT LESS WS-830901)
 12429         GO TO 3129-APR-CONT.
 12430
 12431     IF PB-COMPANY-ID = 'LAP'
 12432        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12433           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12434              MOVE ER-2656         TO WS-ERROR
 12435              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12436              GO TO 3130-EDIT-AGE.
 12437
 12438     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12439        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12440        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12441        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12442        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12443        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12444         GO TO 3130-EDIT-AGE.
 12445
 12446 3129-APR-CONT.
 12447     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12448         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12449         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 228
* EL050.cbl
 12450
 12451     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12452         WS-AH-BENEFIT-CD (1:1) = 'S')
 12453        AND (PB-COMPANY-ID = 'DCC')
 12454        AND (PB-I-LOAN-APR = ZERO)
 12455        MOVE ER-2657             TO WS-ERROR
 12456        PERFORM 9900-ERROR-FORMAT
 12457                                 THRU 9900-EXIT
 12458        GO TO 3130-EDIT-AGE
 12459     END-IF
 12460     IF PB-I-LOAN-APR = ZERO
 12461        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12462     END-IF
 12463
 12464     IF PB-I-LOAN-APR = ZERO
 12465        MOVE ER-2656             TO WS-ERROR
 12466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12467        GO TO 3130-EDIT-AGE.
 12468
 12469*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12470     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12471        MOVE ER-2657             TO WS-ERROR
 12472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473
 12474 3130-EDIT-AGE.
 12475
 12476******************************************************************
 12477*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12478******************************************************************
 12479
 12480     IF NOT NO-LIFE-COVERAGE
 12481        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12482           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12483               MOVE ER-2628             TO WS-ERROR
 12484               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12485
 12486     IF NOT NO-AH-COVERAGE
 12487        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12488           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12489               MOVE ER-2628         TO WS-ERROR
 12490               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12491
 12492 3133-SEX-CODE.
 12493     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12494         IF WS-DEFAULT-SEX = 'M'
 12495             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12496          ELSE
 12497             IF WS-DEFAULT-SEX = 'F'
 12498             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12499
 12500     IF PB-I-INSURED-SEX = '1'
 12501         MOVE 'M' TO PB-I-INSURED-SEX.
 12502
 12503     IF PB-I-INSURED-SEX = '2'
 12504         MOVE 'F' TO PB-I-INSURED-SEX.
 12505
 12506 3134-SIG-SW-EDIT.
 12507     IF PB-I-SIG-SW = SPACE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 229
* EL050.cbl
 12508         MOVE 'N'                TO  PB-I-SIG-SW.
 12509
 12510     IF PB-COMPANY-ID = 'NCL'
 12511         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12512             NEXT SENTENCE
 12513         ELSE
 12514             MOVE ER-1923        TO  WS-ERROR
 12515             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12516     ELSE
 12517     IF PB-COMPANY-ID = 'CRI'
 12518         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12519             NEXT SENTENCE
 12520         ELSE
 12521             MOVE ER-2606        TO  WS-ERROR
 12522             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12523     ELSE
 12524     IF PB-COMPANY-ID = 'TMS'
 12525         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12526             NEXT SENTENCE
 12527         ELSE
 12528             MOVE ER-2689        TO  WS-ERROR
 12529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12530     ELSE
 12531         IF PB-I-SIG-SW = 'Y' OR 'N'
 12532             NEXT SENTENCE
 12533         ELSE
 12534             MOVE ER-2651        TO  WS-ERROR
 12535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12536
 12537     IF PB-COMPANY-ID = 'FLA'
 12538         IF (WS-EDIT-AGE GREATER 54  OR
 12539             WS-AH-EDIT-AGE GREATER 54)  AND
 12540            PB-I-SIG-SW = 'N'
 12541            MOVE ER-2651         TO  WS-ERROR
 12542            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12543
 12544 3135-NAME-EDIT.
 12545
 12546     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12547        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12548        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12549           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12550                                 TO PB-I-JOINT-FIRST-NAME
 12551        END-PERFORM
 12552     END-IF
 12553     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12554        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12555        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12556           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12557                                 TO PB-I-JOINT-LAST-NAME
 12558        END-PERFORM
 12559     END-IF
 12560     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12561        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12562        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12563           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12564                                 TO PB-I-INSURED-FIRST-NAME
 12565        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 230
* EL050.cbl
 12566     END-IF
 12567     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12568        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12569        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12570           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12571                                 TO PB-I-INSURED-LAST-NAME
 12572        END-PERFORM
 12573     END-IF
 12574     IF PB-I-INSURED-LAST-NAME = SPACES
 12575       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12576       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12577           MOVE ER-2660    TO WS-ERROR
 12578           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12579
 12580 3136-EDIT-SEX.
 12581
 12582******************************************************************
 12583*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12584******************************************************************
 12585
 12586     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12587        (WS-AH-SPECIAL-CALC-CD = 'O')
 12588        NEXT SENTENCE
 12589     ELSE
 12590        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12591           NEXT SENTENCE
 12592        ELSE
 12593           MOVE ER-2629            TO WS-ERROR
 12594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12595
 12596 3137-EDIT-EFF-DATE.
 12597
 12598     IF PB-REISSUED-CERT       OR
 12599        PB-POLICY-IS-DECLINED  OR
 12600        PB-POLICY-IS-VOIDED
 12601         GO TO 3139-EDIT-COVERAGE-CODES.
 12602
 12603     MOVE SPACE                  TO WS-2671-SW
 12604                                    WS-2672-SW.
 12605
 12606     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12607         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12608             MOVE ER-2703        TO WS-ERROR
 12609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12610             GO TO 3139-EDIT-COVERAGE-CODES.
 12611
 12612     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12613         GO TO 3139-EDIT-COVERAGE-CODES.
 12614
 12615     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12616     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12617*    MOVE '1'                    TO DC-OPTION-CODE.
 12618     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12619     MOVE +0                     TO DC-ELAPSED-MONTHS
 12620                                    DC-ELAPSED-DAYS.
 12621     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12622
 12623     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 231
* EL050.cbl
 12624         GO TO 3139-EDIT-COVERAGE-CODES.
 12625
 12626     IF DC-ELAPSED-DAYS GREATER +180
 12627         MOVE ER-2672            TO WS-ERROR
 12628         MOVE 'Y'                TO WS-2672-SW
 12629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12630     END-IF
 12631
 12632     IF WS-ERROR = ER-2671  AND
 12633        PB-COMPANY-ID  = 'LBL'
 12634        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12635        MOVE SPACE               TO WS-2671-SW
 12636        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12637
 12638     IF PB-ISSUE-DATE-FORCED  AND
 12639      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12640         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12641         MOVE ER-2673            TO WS-ERROR
 12642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12643         MOVE SPACE              TO WS-2671-SW
 12644                                    WS-2672-SW.
 12645
 12646     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12647         IF PB-ISSUE-DATE-FORCED
 12648             MOVE ER-2600          TO  WS-ERROR
 12649             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12650         ELSE
 12651             MOVE ER-2692          TO  WS-ERROR
 12652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12653
 12654
 12655 3139-EDIT-COVERAGE-CODES.
 12656
 12657     if pb-company-id not = 'AHL'
 12658        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12659           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12660           MOVE ER-2787          TO WS-ERROR
 12661           PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
 12663        END-IF
 12664     end-if
 12665     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12666        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12667                                 > 250000.00
 12668           MOVE ER-2719          TO WS-ERROR
 12669           PERFORM 9900-ERROR-FORMAT
 12670                                 THRU 9900-EXIT
 12671        END-IF
 12672     END-IF
 12673
 12674     IF PB-POLICY-IS-DECLINED  OR
 12675        PB-POLICY-IS-VOIDED
 12676         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12677
 12678     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12679        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12680         MOVE ER-2630                TO WS-ERROR
 12681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 232
* EL050.cbl
 12682
 12683     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12684        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12685        PB-I-LF-PREMIUM-AMT = ZERO
 12686         GO TO 3140-CHECK-AH-FOR-ZERO.
 12687
 12688     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12689        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12690        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12691         GO TO 3140-CHECK-AH-FOR-ZERO.
 12692
 12693     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12694        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12695        MOVE ER-2631             TO WS-ERROR
 12696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12697     END-IF
 12698
 12699
 12700******************************************************************
 12701*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12702******************************************************************
 12703
 12704     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12705        NEXT SENTENCE
 12706     ELSE
 12707        IF PB-I-LF-BENEFIT-AMT = ZERO
 12708           MOVE ER-2632             TO WS-ERROR
 12709           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12710
 12711
 12712******************************************************************
 12713*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12714******************************************************************
 12715
 12716     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12717        CONTINUE
 12718     ELSE
 12719        IF PB-I-LF-PREMIUM-AMT = ZERO
 12720           IF (NOT PB-COMP-LF-PREM)
 12721              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12722              MOVE ER-2633       TO WS-ERROR
 12723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12724           END-IF
 12725        END-IF
 12726     END-IF
 12727     .
 12728 3140-CHECK-AH-FOR-ZERO.
 12729
 12730     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12731        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12732        PB-I-AH-PREMIUM-AMT = ZERO
 12733         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12734
 12735     IF PB-COMPANY-ID = 'CSL'  AND
 12736        PB-I-AH-BENEFIT-CD = ZERO  AND
 12737        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12738        PB-I-AH-PREMIUM-AMT = ZERO
 12739         GO TO 3140-EDIT-MAX-AMT-SIZES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 233
* EL050.cbl
 12740
 12741     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12742        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12743        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12744         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12745
 12746     IF PB-I-AH-BENEFIT-CD = ZERO
 12747         MOVE ER-2634            TO WS-ERROR
 12748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12749
 12750******************************************************************
 12751*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12752******************************************************************
 12753
 12754     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12755        NEXT SENTENCE
 12756     ELSE
 12757        IF PB-I-AH-BENEFIT-AMT = ZERO
 12758           MOVE ER-2635             TO WS-ERROR
 12759           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12760
 12761******************************************************************
 12762*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12763******************************************************************
 12764
 12765     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12766        NEXT SENTENCE
 12767     ELSE
 12768        IF PB-I-AH-PREMIUM-AMT = ZERO
 12769            IF NOT PB-COMP-AH-PREM
 12770                MOVE ER-2636    TO WS-ERROR
 12771                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12772
 12773
 12774 3140-EDIT-MAX-AMT-SIZES.
 12775* CUSTOM CODE FOR CLIENT    'DMD'
 12776     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12777                                     WS-RES-MUNI-TAX
 12778                                     PB-I-STATE-TAX
 12779                                     PB-I-MUNI-TAX.
 12780
 12781     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12782
 12783     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12784        GO TO 3150-RATE-OUTSTAND-BAL.
 12785
 12786     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12787        GO TO 3150-RATE-OUTSTAND-BAL.
 12788
 12789     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12790        GO TO 3150-RATE-OUTSTAND-BAL.
 12791
 12792     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12793                             OR 'RIC')
 12794        GO TO 3150-RATE-OUTSTAND-BAL.
 12795
 12796     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12797        IF PB-I-LOAN-APR GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 234
* EL050.cbl
 12798            GO TO 3150-RATE-OUTSTAND-BAL
 12799        ELSE
 12800           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12801               GO TO 3150-RATE-OUTSTAND-BAL.
 12802
 12803     IF NOT PB-NO-MONTHS-SKIPPED
 12804        GO TO 3150-RATE-OUTSTAND-BAL.
 12805
 12806     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12807        GO TO 3150-RATE-OUTSTAND-BAL.
 12808
 12809     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12810        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12811           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12812             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12813           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12814           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12815              MOVE ER-2693     TO WS-ERROR
 12816              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12817              GO TO 3150-RATE-OUTSTAND-BAL
 12818           ELSE
 12819              GO TO 3150-RATE-OUTSTAND-BAL.
 12820
 12821 3150-RATE-OUTSTAND-BAL.
 12822
 12823* DMD RATING TEST
 12824     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12825         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12826         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12827         MOVE ER-2687                 TO WS-ERROR
 12828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12829         MOVE 'B'                     TO PB-I-OB-FLAG
 12830         GO TO 3260-EDIT-CONTINUE.
 12831
 12832     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12833         IF  WS-ERROR    EQUAL    ER-2693
 12834             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12835                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12836                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12837                 MOVE  +0            TO  WS-ERROR.
 12838
 12839     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12840         IF  WS-ERROR    EQUAL    ER-2693
 12841             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12842                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12843                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12844                 MOVE  +0            TO  WS-ERROR.
 12845
 12846     IF PLAN-MASTER-AH-SW = 'Y'
 12847        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12848            IF  WS-ERROR    EQUAL    ER-2693
 12849              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12850                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12851                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12852                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12853                 MOVE  ER-1910           TO  WS-ERROR
 12854                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12855
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 235
* EL050.cbl
 12856     IF PLAN-MASTER-AH-SW = 'Y'
 12857        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12858            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12859               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12860               MOVE  ER-1910           TO  WS-ERROR
 12861               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12862
 12863     IF PLAN-MASTER-AH-SW = 'Y'
 12864        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12865            IF  WS-ERROR    EQUAL    ER-2693
 12866                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12867                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12868                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12869                 MOVE  +0       TO  WS-ERROR.
 12870
 12871     IF WS-ERROR = ER-2693
 12872        IF PB-COMPANY-ID = 'JAL' AND
 12873           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12874           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12875           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12876
 12877     IF WS-ERROR = ER-2693
 12878        IF PB-COMPANY-ID = 'NCL'  AND
 12879           PB-I-AH-BENEFIT-CD = 'OA'
 12880           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12881           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12882
 12883     IF WS-ERROR = ER-2693
 12884        IF PB-COMPANY-ID = 'CNL' AND
 12885           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12886           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12887           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12888
 12889     IF WS-ERROR = ER-2693
 12890        IF PB-COMPANY-ID = 'HER'
 12891           IF WS-LEVEL
 12892              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12893              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12894
 12895     IF ((LF-BENEFIT-FOUND) AND
 12896         (NOT NO-LIFE-COVERAGE)  AND
 12897         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12898       OR   ((AH-BENEFIT-FOUND) AND
 12899             (NOT NO-AH-COVERAGE)    AND
 12900             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12901         NEXT SENTENCE
 12902     ELSE
 12903         GO TO 3215-EDIT-RATES.
 12904
 12905     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12906        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12907           MOVE ER-2674          TO WS-ERROR
 12908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12909           GO TO 3215-EDIT-RATES.
 12910
 12911     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12912        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12913           MOVE ER-2674          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 236
* EL050.cbl
 12914           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12915           GO TO 3215-EDIT-RATES.
 12916
 12917     MOVE 'B'                    TO PB-I-OB-FLAG.
 12918
 12919     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12920         NEXT SENTENCE
 12921     ELSE
 12922         IF NOT NO-LIFE-COVERAGE
 12923             IF WS-ACCT-LF-OB-RT = ZERO
 12924                MOVE ER-2641    TO WS-ERROR
 12925                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12926
 12927     IF PB-COMPANY-ID = 'CRI'
 12928       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12929         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12930         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12931         IF WS-ERROR = ER-2675
 12932            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12933            MOVE ER-2687              TO WS-ERROR
 12934            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12935         ELSE
 12936            MOVE ER-2687              TO WS-ERROR
 12937            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12938
 12939
 12940     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12941         NEXT SENTENCE
 12942     ELSE
 12943       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12944            NEXT SENTENCE
 12945       ELSE
 12946         IF NOT NO-AH-COVERAGE
 12947             IF WS-ACCT-AH-OB-RT = ZERO
 12948                MOVE ER-2642    TO WS-ERROR
 12949                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12950
 12951     IF PB-COMPANY-ID = 'CRI'
 12952       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12953         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12954         IF WS-ERROR = ER-2676
 12955            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12956            MOVE ER-2687              TO WS-ERROR
 12957            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12958         ELSE
 12959            MOVE ER-2687              TO WS-ERROR
 12960            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12961
 12962     IF PB-COMPANY-ID NOT = 'GIC'
 12963         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12964            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12965     ELSE
 12966         IF PB-I-LF-PREM-CALC = ZEROS
 12967             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12968                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12969
 12970     IF PB-COMPANY-ID NOT = 'GIC'
 12971         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 237
* EL050.cbl
 12972            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12973     ELSE
 12974         IF PB-I-AH-PREM-CALC = ZEROS
 12975             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12976                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12977
 12978     MOVE ZEROS TO PB-I-MORT-CODE.
 12979
 12980     GO TO 3260-EDIT-CONTINUE.
 12981
 12982
 12983 3215-EDIT-RATES.
 12984     IF ACCOUNT-MAST-FOUND
 12985         NEXT SENTENCE
 12986     ELSE
 12987         GO TO 3999-END-EDIT.
 12988
 12989 3220-CHECK-LF-RATES.
 12990
 12991     IF PB-COMPANY-ID = 'DCC'
 12992        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12993        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12994        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12995           AND (NOT WS-LF-CASH))
 12996                           OR
 12997           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12998           AND (NOT WS-AH-CASH)))
 12999                       AND
 13000           (PB-I-ENTRY-STATUS NOT = '5')
 13001           MOVE 'M'              TO PB-BATCH-ENTRY
 13002                                    PB-I-ENTRY-STATUS
 13003        END-IF
 13004     END-IF
 13005     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13006                                    PB-I-AH-PREM-CALC
 13007                                    PB-I-LF-ALT-PREM-CALC
 13008                                    PB-I-LF-ALT-RATE
 13009                                    PB-I-LF-REI-RATE
 13010                                    PB-I-LF-ALT-REI-RATE
 13011                                    PB-I-AH-REI-RATE
 13012                                    PB-I-TOT-FEES-CALC.
 13013
 13014     IF PB-COMPANY-ID EQUAL 'DMD'
 13015        NEXT SENTENCE
 13016     ELSE
 13017        MOVE ZEROS               TO PB-I-LF-RATE
 13018                                    PB-I-AH-RATE.
 13019
 13020     IF PB-I-TOT-FEES NOT NUMERIC
 13021        MOVE ZEROS               TO PB-I-TOT-FEES
 13022     END-IF
 13023     IF PB-I-LIVES NOT NUMERIC
 13024         MOVE ZERO               TO PB-I-LIVES.
 13025
 13026     IF PB-I-NUM-BILLED NOT NUMERIC
 13027         MOVE ZERO               TO PB-I-NUM-BILLED.
 13028
 13029     IF PB-I-LF-PREM-TAX NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 238
* EL050.cbl
 13030        MOVE +0                  TO PB-I-LF-PREM-TAX
 13031     END-IF
 13032
 13033     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13034        MOVE +0                  TO PB-I-AH-PREM-TAX
 13035     END-IF
 13036
 13037     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13038        PB-I-PAY-FREQUENCY = ZEROS
 13039            MOVE 12 TO CP-PAY-FREQUENCY
 13040     ELSE
 13041            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13042
 13043     IF PB-I-STATE-TAX NOT NUMERIC
 13044         MOVE ZEROS               TO PB-I-STATE-TAX.
 13045
 13046     IF PB-I-MUNI-TAX NOT NUMERIC
 13047         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13048
 13049     MOVE SPACES                 TO CP-BEN-CATEGORY
 13050     IF PB-COMPANY-ID  = 'CSL'  AND
 13051        PB-I-LF-TERM NOT = ZERO
 13052        COMPUTE WS-PAYMENT-AMT =
 13053             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13054        COMPUTE WS-CSL-AMT1 =
 13055             PB-I-LF-TERM * AM-MAX-MON-BEN
 13056        COMPUTE WS-CSL-AMT2 =
 13057             WS-PAYMENT-AMT * PB-I-LF-TERM
 13058        IF CP-PAY-FREQUENCY NOT = 12
 13059           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13060           MOVE '8' TO WS-CSL-CALC-CD
 13061        ELSE
 13062           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13063              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13064               AM-MAX-TOT-BEN
 13065               MOVE '6' TO WS-CSL-CALC-CD
 13066           ELSE
 13067              IF (WS-CSL-AMT1  GREATER THAN
 13068                 AM-MAX-TOT-BEN) AND
 13069                 (WS-CSL-AMT2  GREATER THAN
 13070                 AM-MAX-TOT-BEN)
 13071                 MOVE '7' TO WS-CSL-CALC-CD
 13072              ELSE
 13073                 MOVE '5' TO WS-CSL-CALC-CD.
 13074
 13075     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13076         NEXT SENTENCE
 13077     ELSE
 13078         GO TO 3300-CHECK-AH-RATES.
 13079
 13080*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13081
 13082     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13083        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13084              OR
 13085           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13086           MOVE ER-2618          TO WS-ERROR
 13087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 239
* EL050.cbl
 13088           GO TO 3300-CHECK-AH-RATES.
 13089
 13090     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13091           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13092                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13093
 13094     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13095         MOVE ER-2687             TO WS-ERROR
 13096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13097         MOVE 'Z000'              TO PB-I-MORT-CODE
 13098         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13099         GO TO 3300-CHECK-AH-RATES.
 13100
 13101     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13102        IF PB-I-LIVES = ZERO
 13103           MOVE ER-2688          TO WS-ERROR
 13104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13105
 13106     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13107
 13108     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13109     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13110     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13111     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13112     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13113     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13114     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13115     MOVE '3'                    TO CP-PROCESS-TYPE.
 13116     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13117     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13118
 13119******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13120     IF PB-COMPANY-ID EQUAL 'CDL'
 13121         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13122            CP-EARN-AS-NET-PAY)
 13123             IF PB-CERT-EFF-DT GREATER  WS-931231
 13124                 MOVE '1'        TO CP-EARNING-METHOD.
 13125*******
 13126
 13127     MOVE PB-SV-STATE            TO CP-STATE.
 13128     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13129     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13130     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13131     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13132     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13133                                    CP-RATING-BENEFIT-AMT.
 13134     IF CP-STATE-STD-ABBRV = 'OR'
 13135         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13136                                         PB-I-LF-ALT-BENEFIT-AMT.
 13137     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13138     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13139     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13140     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13141     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13142     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13143     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13144     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13145     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 240
* EL050.cbl
 13146                                    CP-REMAINING-TERM
 13147                                    CP-LOAN-TERM.
 13148
 13149     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13150         NEXT SENTENCE
 13151     ELSE
 13152         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13153             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13154                                           PB-I-LF-PREMIUM-AMT.
 13155
 13156     IF PB-COMPANY-ID EQUAL 'CSL'
 13157        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13158           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13159                                         PB-I-LF-PREMIUM-AMT.
 13160
 13161     IF PB-COMPANY-ID EQUAL 'NCB'
 13162         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13163            CP-EARN-AS-NET-PAY
 13164             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13165                 PB-I-LF-PREMIUM-AMT.
 13166
 13167     IF (CP-TRUNCATED-LIFE)
 13168        or ((pb-company-id = 'AHL')
 13169           and (pb-i-loan-term > pb-i-lf-term))
 13170        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13171
 13172     IF PB-COMPANY-ID EQUAL 'CRI'
 13173        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13174
 13175     IF CP-TERM-IS-DAYS
 13176         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13177     ELSE
 13178         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13179     IF PB-COMPANY-ID = 'DCC'
 13180        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13181        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13182        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13183        IF WS-LF-BEN-CATEGORY = 'D'
 13184           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13185           MOVE PB-I-LIFE-COMMISSION
 13186                                 TO CP-DCC-ACT-COMM
 13187           MOVE WS-LF-BEN-CATEGORY
 13188                                 TO CP-BEN-CATEGORY
 13189        END-IF
 13190        IF (CP-BENEFIT-CD (1:1) = 'P')
 13191           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13192           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13193        END-IF
 13194     END-IF
 13195     IF PB-COMPANY-ID = 'CSL'
 13196         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13197         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13198         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13199
 13200     IF PB-COMPANY-ID = 'CSL'
 13201        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13202
 13203     IF (CP-SPECIAL-CALC-CD = 'H')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 241
* EL050.cbl
 13204        OR (PB-COMPANY-ID = 'DCC')
 13205         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13206                                    TO CP-ALTERNATE-BENEFIT
 13207         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13208
 13209     IF (PB-COMPANY-ID = 'CID')
 13210        AND (WS-LF-EARNINGS-CALC = 'B')
 13211        AND (CP-STATE-STD-ABBRV = 'MN')
 13212        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13213                                 TO CP-ALTERNATE-BENEFIT
 13214        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13215     END-IF
 13216     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13217     MOVE 'R'                   TO CP-RATE-FILE.
 13218     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13219
 13220     IF CP-ERROR-RATE-NOT-FOUND
 13221        MOVE ER-2641            TO WS-ERROR
 13222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13223        GO TO 3300-CHECK-AH-RATES.
 13224
 13225     IF PB-COMPANY-ID EQUAL 'CRI'
 13226        IF CP-ERROR-NO-LIMITS-CRI
 13227           IF NOT ACCOUNT-LIFE-CHECKED
 13228              MOVE ER-2607      TO WS-ERROR
 13229              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13230
 13231******************************************************************
 13232*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13233*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13234******************************************************************
 13235
 13236* CALC LIFE AGE AT EXPIRATION.
 13237
 13238     COMPUTE WS-AGE-AT-EXPIRE =
 13239          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13240
 13241*    IF PB-STATE = 'CO' OR 'UT'
 13242*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13243*        MOVE 'F'            TO PB-FATAL-FLAG
 13244*        MOVE ER-2709        TO WS-ERROR
 13245*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13246*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13247
 13248*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13249*        MOVE 'X'            TO PB-FATAL-FLAG
 13250*        MOVE ER-2718        TO WS-ERROR
 13251*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13252*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13253
 13254* CALC A & H AGE AT EXPIRATION.
 13255
 13256     COMPUTE WS-AGE-AT-EXPIRE =
 13257          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13258
 13259*    IF PB-STATE = 'CO' OR 'UT'
 13260*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13261*        MOVE 'F'            TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 242
* EL050.cbl
 13262*        MOVE ER-2709        TO WS-ERROR
 13263*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13264*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13265
 13266*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13267*        MOVE 'X'            TO PB-FATAL-FLAG
 13268*        MOVE ER-2718        TO WS-ERROR
 13269*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13270*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13271
 13272     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13273        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13274
 13275     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13276        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13277
 13278     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13279        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13280
 13281     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13282         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13283         MOVE ER-2639        TO WS-ERROR
 13284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13285
 13286
 13287******************************************************************
 13288*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13289******************************************************************
 13290
 13291 PREMIUM-EDITING-IS-BYPASSED.
 13292     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13293        AND (CP-R-MAX-ATT-AGE > +0)
 13294        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13295        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13296           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13297           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13298           MOVE '1'              TO DC-OPTION-CODE
 13299           PERFORM 8500-DATE-CONVERT
 13300                                 THRU 8500-EXIT
 13301           IF NO-CONVERSION-ERROR
 13302              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13303                 MOVE ER-2661       TO WS-ERROR
 13304*                PERFORM 9900-ERROR-FORMAT
 13305*                                THRU 9900-EXIT
 13306              END-IF
 13307           END-IF
 13308        ELSE
 13309           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13310           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13311              MOVE ER-2661       TO WS-ERROR
 13312*             PERFORM 9900-ERROR-FORMAT
 13313*                                THRU 9900-EXIT
 13314           ELSE
 13315              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13316                 MOVE ER-1570    TO WS-ERROR
 13317                 PERFORM 9900-ERROR-FORMAT
 13318                                 THRU 9900-EXIT
 13319              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 243
* EL050.cbl
 13320           END-IF
 13321        END-IF
 13322        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13323           MOVE PB-I-JOINT-BIRTHDAY
 13324                                 TO DC-BIN-DATE-1
 13325           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13326           MOVE '1'              TO DC-OPTION-CODE
 13327           PERFORM 8500-DATE-CONVERT
 13328                                 THRU 8500-EXIT
 13329           IF NO-CONVERSION-ERROR
 13330              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13331                 MOVE ER-2661       TO WS-ERROR
 13332*                PERFORM 9900-ERROR-FORMAT
 13333*                                THRU 9900-EXIT
 13334              END-IF
 13335           ELSE
 13336              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13337           END-IF
 13338        ELSE
 13339           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13340             (PB-I-LF-TERM / 12)
 13341           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13342              MOVE ER-2661       TO WS-ERROR
 13343*             PERFORM 9900-ERROR-FORMAT
 13344*                                THRU 9900-EXIT
 13345           ELSE
 13346              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13347                 MOVE ER-1571    TO WS-ERROR
 13348                 PERFORM 9900-ERROR-FORMAT
 13349                                 THRU 9900-EXIT
 13350              END-IF
 13351           END-IF
 13352        END-IF
 13353        IF WS-ERROR = ER-2661
 13354           PERFORM 9900-ERROR-FORMAT
 13355                                 THRU 9900-EXIT
 13356        END-IF
 13357     END-IF
 13358*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13359*       MOVE ER-2661             TO WS-ERROR
 13360*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13361
 13362     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13363        MOVE ER-2662             TO WS-ERROR
 13364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13365
 13366     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13367        MOVE ER-2677             TO WS-ERROR
 13368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13369
 13370     IF CP-ERROR-LOAN-TERM
 13371        MOVE ER-2648             TO WS-ERROR
 13372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13373
 13374 3221-CHECK-ERROR-RATE-OPEN.
 13375
 13376     IF CP-ERROR-RATE-FILE-NOTOPEN
 13377         GO TO 3990-FILES-NOT-OPEN.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 244
* EL050.cbl
 13378
 13379     IF PB-COMPANY-ID NOT = 'DMD'
 13380        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13381     END-IF
 13382     .
 13383 3221-CONTINUE.
 13384     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13385                                    WS-DCC-AH-RATE
 13386     IF PB-COMPANY-ID = 'DCC'
 13387        IF WS-LF-BEN-CATEGORY = 'D'
 13388           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13389              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13390        END-IF
 13391     END-IF
 13392     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13393*   X'A4FF' = 12/31/2009
 13394     IF (PB-COMPANY-ID = 'CID')
 13395        AND (WS-LF-EARNINGS-CALC = 'B')
 13396        AND (CP-STATE-STD-ABBRV = 'MN')
 13397        AND (PB-CERT-EFF-DT > X'A4FF')
 13398        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13399     END-IF
 13400     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13401
 13402     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13403     IF (PB-COMPANY-ID = 'DCC')
 13404        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13405        AND (PB-I-POLICY-IS-MONTHLY)
 13406        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13407        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13408     END-IF
 13409     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13410     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13411     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13412     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13413     IF (PB-COMPANY-ID = 'DCC')
 13414        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13415        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13416        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13417        MOVE ER-2786             TO WS-ERROR
 13418        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13419     END-IF
 13420
 13421     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13422
 13423******************************************************************
 13424*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13425******************************************************************
 13426     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13427        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13428
 13429     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13430        GO TO 3225-CHECK-ALT-LIFE-RATE
 13431     ELSE
 13432       IF PB-I-LF-RATE = ZERO
 13433          MOVE ER-2641          TO WS-ERROR
 13434          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13435
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 245
* EL050.cbl
 13436 3225-CHECK-ALT-LIFE-RATE.
 13437
 13438     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13439        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13440        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13441         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13442
 13443     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13444         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13445             AND PB-COMPANY-ID NOT = 'DCC')
 13446                   OR
 13447              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13448              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13449              AND PB-COMPANY-ID NOT = 'DCC')
 13450             MOVE ER-2720        TO  WS-ERROR
 13451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13452             GO TO 3225-RATING-CONT
 13453         ELSE
 13454             GO TO 3225-RATING-CONT.
 13455     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13456        AND (AM-GPCD = 01 OR 06 OR 15)
 13457        MOVE ER-2798             TO WS-ERROR
 13458        PERFORM 9900-ERROR-FORMAT
 13459                                 THRU 9900-EXIT
 13460*       GO TO 3225-RATING-CONT
 13461     END-IF
 13462     IF (PB-COMPANY-ID = 'CID')
 13463        AND (WS-LF-EARNINGS-CALC = 'B')
 13464        AND (CP-STATE-STD-ABBRV = 'MN')
 13465        AND (PB-CERT-EFF-DT > X'A4FF')
 13466        GO TO 3225-RATING-CONT
 13467     END-IF
 13468     IF PB-COMPANY-ID = 'DCC'
 13469        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13470           AND (PB-I-POLICY-IS-MONTHLY)
 13471           GO TO 3225-RATING-CONT
 13472        END-IF
 13473     END-IF
 13474
 13475     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13476        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13477        CP-EARN-AS-REG-BALLOON
 13478        NEXT SENTENCE
 13479     ELSE
 13480        MOVE '2'                 TO CP-EARNING-METHOD.
 13481
 13482 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13483
 13484     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13485
 13486     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13487        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13488        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13489         NEXT SENTENCE
 13490     ELSE
 13491         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13492
 13493     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 246
* EL050.cbl
 13494     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13495     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13496                                     CP-RATING-BENEFIT-AMT.
 13497     IF CP-STATE-STD-ABBRV = 'OR'
 13498         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13499                                         PB-I-LF-ALT-BENEFIT-AMT.
 13500     IF PB-COMPANY-ID = 'DCC'
 13501        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13502     END-IF
 13503     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13504     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13505     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13506                                    CP-REMAINING-TERM
 13507                                    CP-LOAN-TERM.
 13508     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13509        ADD +1                   TO CP-ORIGINAL-TERM
 13510                                    CP-REMAINING-TERM
 13511                                    CP-LOAN-TERM.
 13512
 13513     MOVE 'R'                   TO CP-RATE-FILE.
 13514     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13515
 13516     IF CP-ERROR-RATE-NOT-FOUND
 13517         MOVE ER-2641            TO WS-ERROR
 13518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13519         GO TO 3300-CHECK-AH-RATES.
 13520
 13521     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13522     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13523
 13524     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13525         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13526
 13527     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13528                               + PB-I-LF-ALT-BENEFIT-AMT.
 13529
 13530     IF ACCOUNT-LIFE-CHECKED  OR
 13531        PB-POLICY-IS-VOIDED   OR
 13532        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13533        GO TO 3225-CONTINUE.
 13534
 13535     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13536        GO TO 3225-CONTINUE.
 13537
 13538     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13539                             EC-RT-LF-MAX-TOT-BEN
 13540        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13541        MOVE ER-2639       TO WS-ERROR
 13542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13543
 13544 3225-CONTINUE.
 13545     IF PB-I-LF-ALT-RATE = ZERO
 13546         MOVE ER-2659            TO WS-ERROR
 13547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13548
 13549     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13550        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13551        MOVE ER-2698             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 247
* EL050.cbl
 13552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13553
 13554 3225-RATING-CONT.
 13555
 13556     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13557         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13558         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13559         IF (PB-COMPANY-ID = 'DCC')
 13560            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13561            CONTINUE
 13562         ELSE
 13563            MOVE ER-2687         TO WS-ERROR
 13564            PERFORM 9900-ERROR-FORMAT
 13565                                 THRU 9900-EXIT
 13566         END-IF
 13567         GO TO 3290-EDIT-LF-REIN-RATE
 13568     END-IF
 13569
 13570* DMD RATING TEST
 13571     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13572         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13573         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13574         MOVE ER-2687                 TO WS-ERROR
 13575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13576         GO TO 3290-EDIT-LF-REIN-RATE.
 13577
 13578 3230-CLIENT-MORT-CD-SPECIALS.
 13579
 13580     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13581     SET BIN-TO-GREG          TO TRUE.
 13582*    MOVE ' '                 TO DC-OPTION-CODE.
 13583     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13584     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13585
 13586 C-POS-3230-MORT-CD.
 13587     IF PB-COMPANY-ID = 'POS' AND
 13588        PB-SV-CARRIER = '2'
 13589         NEXT SENTENCE
 13590     ELSE
 13591         GO TO C-POS-3240-MORT-CD.
 13592
 13593     IF PB-SV-GROUPING = '030'
 13594        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13595         MOVE '2350' TO PB-I-MORT-CODE
 13596      ELSE
 13597         MOVE '3300' TO PB-I-MORT-CODE.
 13598
 13599
 13600 C-POS-3240-MORT-CD.
 13601     IF PB-COMPANY-ID = 'POS' AND
 13602        PB-SV-CARRIER = '1'
 13603         NEXT SENTENCE
 13604     ELSE
 13605         GO TO 3230-CONTINUE.
 13606
 13607     IF PB-SV-STATE = '45' OR '47'
 13608        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13609         MOVE '5200' TO PB-I-MORT-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 248
* EL050.cbl
 13610     ELSE
 13611         MOVE '8300' TO PB-I-MORT-CODE.
 13612
 13613 3230-CONTINUE.
 13614
 13615     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13616        GO TO 3240-CONTINUE
 13617     END-IF
 13618
 13619     IF PB-CERT-EFF-DT > WS-971231
 13620        GO TO 3240-CONTINUE
 13621     END-IF
 13622
 13623     IF LF-BENEFIT-FOUND AND
 13624        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13625         MOVE 'F250'       TO PB-I-MORT-CODE
 13626     ELSE
 13627         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13628             MOVE '7250'   TO PB-I-MORT-CODE
 13629         ELSE
 13630             MOVE '4251'   TO PB-I-MORT-CODE
 13631         END-IF
 13632     END-IF
 13633
 13634     .
 13635 3240-CONTINUE.
 13636
 13637     IF PB-COMPANY-ID NOT = 'GNL'
 13638         GO TO 3256-CONTINUE.
 13639
 13640     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13641         MOVE 'A300' TO PB-I-MORT-CODE
 13642     ELSE
 13643         MOVE '8350' TO PB-I-MORT-CODE.
 13644
 13645 3256-CONTINUE.
 13646     IF PB-COMPANY-ID NOT = 'ABL'
 13647         GO TO 3260-EDIT-CONTINUE.
 13648
 13649     IF PB-I-LF-TERM GREATER THAN 59
 13650         MOVE 'F550' TO PB-I-MORT-CODE
 13651     ELSE
 13652         MOVE 'E550' TO PB-I-MORT-CODE.
 13653
 13654 3260-EDIT-CONTINUE.
 13655     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13656
 13657 3290-EDIT-LF-REIN-RATE.
 13658     IF LF-REIN-NSP-NOT-USED
 13659         GO TO 3290-RATING-CONT.
 13660
 13661     IF PB-COMPANY-ID = 'DCC'
 13662        GO TO 3290-RATING-CONT.
 13663     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13664     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13665     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13666     MOVE '3'                   TO CP-PROCESS-TYPE.
 13667     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 249
* EL050.cbl
 13668
 13669******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13670     IF PB-COMPANY-ID EQUAL 'CDL'
 13671         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13672            CP-EARN-AS-NET-PAY)
 13673             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13674*            MOVE SPACE          TO DC-OPTION-CODE
 13675             SET BIN-TO-GREG     TO TRUE
 13676             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13677***  Y2K PROJ 7744
 13678             IF DC-GREG-DATE-CYMD GREATER 19931231
 13679                 MOVE '1'        TO CP-EARNING-METHOD.
 13680***  Y2K PROJ 7744
 13681*******
 13682
 13683     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13684     MOVE PB-SV-STATE           TO CP-STATE.
 13685     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13686     MOVE ZERO                  TO CP-DEVIATION-CODE
 13687                                   CP-RATE-DEV-PCT.
 13688     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13689     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13690                                   CP-RATING-BENEFIT-AMT.
 13691
 13692************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13693     IF PB-COMPANY-ID EQUAL 'NCB'
 13694         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13695            CP-EARN-AS-NET-PAY
 13696             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13697                 PB-I-LF-PREMIUM-AMT.
 13698************
 13699
 13700     IF CP-STATE-STD-ABBRV = 'OR'
 13701         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13702                                         PB-I-LF-ALT-BENEFIT-AMT.
 13703     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13704     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13705     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13706     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13707     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13708     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13709     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13710     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13711                                   CP-REMAINING-TERM
 13712                                   CP-LOAN-TERM.
 13713     IF CP-TRUNCATED-LIFE
 13714        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13715
 13716     IF CP-TERM-IS-DAYS
 13717         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13718     ELSE
 13719         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13720
 13721     IF PB-COMPANY-ID = 'DCC'
 13722        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13723     END-IF
 13724     IF PB-COMPANY-ID NOT = 'TIC'
 13725          MOVE ZERO          TO CP-CLASS-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 250
* EL050.cbl
 13726
 13727     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13728
 13729     MOVE 'R'                   TO CP-RATE-FILE.
 13730     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13731
 13732     IF CP-ERROR-RATE-NOT-FOUND
 13733        IF PB-I-OB
 13734           MOVE ER-2625      TO WS-ERROR
 13735           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13736           GO TO 3299-EDIT-CONTINUE
 13737        ELSE
 13738           MOVE ER-2643      TO WS-ERROR
 13739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13740           GO TO 3299-EDIT-CONTINUE.
 13741
 13742     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13743
 13744     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13745     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13746
 13747     IF PB-I-LF-REI-RATE = ZERO
 13748         MOVE ER-2643        TO WS-ERROR
 13749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13750
 13751 3290-CHECK-ALT-REIN-RATE.
 13752
 13753     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13754        GO TO 3290-RATING-CONT.
 13755
 13756     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13757     MOVE '2'                    TO CP-EARNING-METHOD.
 13758     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13759     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13760     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13761     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13762                                     CP-RATING-BENEFIT-AMT.
 13763     IF CP-STATE-STD-ABBRV = 'OR'
 13764         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13765                                         PB-I-LF-ALT-BENEFIT-AMT.
 13766     IF PB-COMPANY-ID = 'DCC'
 13767        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13768     END-IF
 13769     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13770     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13771     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13772                                    CP-REMAINING-TERM
 13773                                    CP-LOAN-TERM.
 13774     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13775        ADD +1                   TO CP-ORIGINAL-TERM
 13776                                    CP-REMAINING-TERM
 13777                                    CP-LOAN-TERM.
 13778
 13779     MOVE 'R'                   TO CP-RATE-FILE.
 13780     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13781
 13782     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13783
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 251
* EL050.cbl
 13784     IF PB-I-LF-ALT-REI-RATE = ZERO
 13785         MOVE ER-2643            TO WS-ERROR
 13786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13787
 13788 3290-RATING-CONT.
 13789
 13790     IF PB-I-OB
 13791*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13792        GO TO 3300-CHECK-AH-RATES.
 13793
 13794 3299-EDIT-CONTINUE.
 13795
 13796     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13797         NEXT SENTENCE
 13798     ELSE
 13799         MOVE ER-2620           TO WS-ERROR
 13800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13801
 13802 3300-CHECK-AH-RATES.
 13803     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13804         NEXT SENTENCE
 13805     ELSE
 13806         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13807
 13808     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13809        ((CF-COMPANY-ID = 'DMD') AND
 13810                (NO-DMD-RATING))
 13811         IF (PB-COMPANY-ID = 'DCC')
 13812            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13813            CONTINUE
 13814         ELSE
 13815            MOVE ER-2687         TO WS-ERROR
 13816            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13817         END-IF
 13818         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13819         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13820     END-IF
 13821
 13822     IF PB-I-OB
 13823        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13824
 13825     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13826         MOVE ER-2687             TO WS-ERROR
 13827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13828         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13829         GO TO 3999-END-EDIT.
 13830
 13831*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13832
 13833     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13834        IF PB-I-AH-CRIT-PER = ZERO
 13835           IF PB-COMPANY-ID = 'DCC'
 13836              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13837              CONTINUE
 13838           ELSE
 13839              MOVE ER-2618       TO WS-ERROR
 13840              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13841              GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 252
* EL050.cbl
 13842           END-IF
 13843        END-IF
 13844     END-IF
 13845     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13846     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13847     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13848     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13849     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13850     MOVE PB-SV-STATE            TO CP-STATE.
 13851     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13852     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13853     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13854*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13855     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13856     MOVE '3'                    TO CP-PROCESS-TYPE.
 13857     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13858     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13859                                    CP-RATING-BENEFIT-AMT.
 13860     IF PB-COMPANY-ID = 'CID'
 13861               OR
 13862        CP-STATE-STD-ABBRV = 'OR'
 13863         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13864                                         PB-I-AH-TERM.
 13865     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13866        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13867           AND (PB-I-POLICY-IS-MONTHLY)
 13868           MOVE PB-I-LF-BENEFIT-AMT
 13869                                 TO CP-NET-BENEFIT-AMT
 13870           move pb-i-ah-premium-amt to cp-original-premium
 13871        END-IF
 13872     END-IF
 13873     MOVE SPACES                 TO CP-BEN-CATEGORY
 13874     IF PB-COMPANY-ID = 'DCC'
 13875        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13876        EVALUATE TRUE
 13877           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13878              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13879              MOVE PB-I-LF-BENEFIT-AMT
 13880                                 TO CP-RATING-BENEFIT-AMT
 13881              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13882           WHEN WS-AH-BEN-CATEGORY = 'G'
 13883              MOVE PB-I-UNPAID-CASH-PRICE
 13884                                 TO CP-RATING-BENEFIT-AMT
 13885           WHEN WS-AH-BEN-CATEGORY = 'D'
 13886              MOVE WS-AH-PMF-COMM
 13887                                 TO CP-DCC-PMF-COMM
 13888              MOVE PB-I-AH-COMMISSION
 13889                                 TO CP-DCC-ACT-COMM
 13890        END-EVALUATE
 13891     END-IF
 13892     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13893     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13894     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13895     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13896     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13897     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13898     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13899                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 253
* EL050.cbl
 13900                                    WS-WORK-TERM.
 13901     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13902
 13903     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13904     SET BIN-TO-GREG             TO TRUE.
 13905*    MOVE ' '                    TO DC-OPTION-CODE.
 13906     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13907     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13908
 13909     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13910     IF NOT VALID-SKIP-CODE
 13911         MOVE ER-2683            TO WS-ERROR
 13912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913         GO TO 3320-RATE-CONTINUE.
 13914
 13915     IF PB-NO-MONTHS-SKIPPED
 13916         GO TO 3320-RATE-CONTINUE.
 13917
 13918     MOVE SPACE TO NUMBER-OF-MONTHS.
 13919
 13920     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13921         MOVE 'S'                TO SK-MO (6).
 13922     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13923         MOVE 'S'                TO SK-MO (7).
 13924     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13925         MOVE 'S'                TO SK-MO (8).
 13926     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13927         MOVE 'S'                TO SK-MO (9).
 13928     IF PB-I-SKIP-CODE = 'A'
 13929         MOVE 'S'                TO SK-MO (10).
 13930
 13931     MOVE 1                      TO SUB2.
 13932     MOVE PB-I-AH-TERM           TO SUB3.
 13933     MOVE WS-MONTH               TO SUB1.
 13934     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13935     GO TO 3320-RATE-CONTINUE.
 13936
 13937 3310-GET-SKIP-MO.
 13938     IF SUB1 = 13
 13939         MOVE 1                  TO SUB1.
 13940
 13941     IF SK-MO (SUB1) = 'S'
 13942         SUBTRACT 1 FROM WS-WORK-TERM.
 13943
 13944     ADD 1 TO SUB2
 13945              SUB1.
 13946
 13947 3320-RATE-CONTINUE.
 13948
 13949     IF WS-WORK-TERM = ZERO
 13950         MOVE 1                  TO WS-WORK-TERM.
 13951
 13952     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13953                                    CP-LOAN-TERM.
 13954
 13955     IF PB-COMPANY-ID EQUAL 'DMD'
 13956         NEXT SENTENCE
 13957     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 254
* EL050.cbl
 13958         MOVE ZERO               TO PB-I-AH-RATE
 13959                                    PB-I-AH-REI-RATE.
 13960
 13961
 13962     IF PB-COMPANY-ID EQUAL 'CRI'
 13963        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13964
 13965     IF PB-COMPANY-ID = 'CSL'
 13966         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13967         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13968         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13969         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13970
 13971     IF PB-COMPANY-ID = 'DCC'
 13972        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13973           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13974              PB-I-RATE-DEV-PCT-LF
 13975        END-IF
 13976        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13977                                 TO CP-ALTERNATE-BENEFIT
 13978        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13979        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13980        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13981     END-IF
 13982     IF (PB-COMPANY-ID = 'CID')
 13983        AND (WS-LF-EARNINGS-CALC = 'B')
 13984        AND (CP-STATE-STD-ABBRV = 'MN')
 13985        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13986     ELSE
 13987        MOVE ' '                 TO CP-AH-BALLOON-SW
 13988     END-IF
 13989     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13990     MOVE 'R'                   TO CP-RATE-FILE.
 13991     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13992
 13993     IF CP-ERROR-RATE-NOT-FOUND
 13994        IF PB-I-OB
 13995           MOVE ER-2624          TO WS-ERROR
 13996           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997           GO TO 3340-CALCULATE-PREMIUM-AMT
 13998        ELSE
 13999          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14000              NEXT SENTENCE
 14001          ELSE
 14002           MOVE ER-2642          TO WS-ERROR
 14003           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14004           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14005
 14006     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14007        CP-ERROR-DIV-BY-ZERO
 14008           MOVE ER-3782          TO WS-ERROR
 14009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14010
 14011     IF PB-COMPANY-ID EQUAL 'CRI'
 14012        IF CP-ERROR-NO-LIMITS-CRI
 14013           IF NOT ACCOUNT-AH-CHECKED
 14014              MOVE ER-2607          TO WS-ERROR
 14015              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 255
* EL050.cbl
 14016
 14017     IF ACCOUNT-AH-CHECKED
 14018        NEXT SENTENCE
 14019     ELSE
 14020       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14021          MOVE ER-2640           TO WS-ERROR
 14022          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14023
 14024     IF PB-COMPANY-ID = 'CRI'
 14025         IF WS-ERROR = ER-2640
 14026             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14027     IF ACCOUNT-AH-CHECKED
 14028        CONTINUE
 14029     ELSE
 14030        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14031           AND (CP-R-MAX-ATT-AGE > +0)
 14032           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14033           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14034              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14035              MOVE PB-I-AH-EXPIRE-DT
 14036                                 TO DC-BIN-DATE-2
 14037              MOVE '1'           TO DC-OPTION-CODE
 14038              PERFORM 8500-DATE-CONVERT
 14039                                 THRU 8500-EXIT
 14040              IF NO-CONVERSION-ERROR
 14041                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14042                    MOVE ER-2661       TO WS-ERROR
 14043*                   PERFORM 9900-ERROR-FORMAT
 14044*                                THRU 9900-EXIT
 14045                 END-IF
 14046              END-IF
 14047           ELSE
 14048              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14049              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14050                 MOVE ER-2661    TO WS-ERROR
 14051*                PERFORM 9900-ERROR-FORMAT
 14052*                                THRU 9900-EXIT
 14053              ELSE
 14054                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14055                    MOVE ER-1570 TO WS-ERROR
 14056                    PERFORM 9900-ERROR-FORMAT
 14057                                 THRU 9900-EXIT
 14058                 END-IF
 14059              END-IF
 14060           END-IF
 14061           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14062              MOVE PB-I-JOINT-BIRTHDAY
 14063                                    TO DC-BIN-DATE-1
 14064              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14065              MOVE '1'              TO DC-OPTION-CODE
 14066              PERFORM 8500-DATE-CONVERT
 14067                                    THRU 8500-EXIT
 14068              IF NO-CONVERSION-ERROR
 14069                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14070                    MOVE ER-2661       TO WS-ERROR
 14071*                   PERFORM 9900-ERROR-FORMAT
 14072*                                   THRU 9900-EXIT
 14073                 END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 256
* EL050.cbl
 14074              END-IF
 14075           ELSE
 14076              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14077                (PB-I-AH-TERM / 12)
 14078              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14079                 MOVE ER-2661       TO WS-ERROR
 14080*                PERFORM 9900-ERROR-FORMAT
 14081*                                   THRU 9900-EXIT
 14082              ELSE
 14083                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14084                    MOVE ER-1571 TO WS-ERROR
 14085                    PERFORM 9900-ERROR-FORMAT
 14086                                 THRU 9900-EXIT
 14087                 END-IF
 14088              END-IF
 14089           END-IF
 14090           IF WS-ERROR = ER-2661
 14091              PERFORM 9900-ERROR-FORMAT
 14092                                    THRU 9900-EXIT
 14093           END-IF
 14094        END-IF
 14095     END-IF
 14096*    IF ACCOUNT-AH-CHECKED
 14097*       NEXT SENTENCE
 14098*    ELSE
 14099*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14100*          MOVE ER-2661          TO WS-ERROR
 14101*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14102
 14103     IF ACCOUNT-AH-CHECKED
 14104        NEXT SENTENCE
 14105     ELSE
 14106        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14107           MOVE ER-2663          TO WS-ERROR
 14108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14109
 14110     IF ACCOUNT-AH-CHECKED OR
 14111        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14112         PB-POLICY-IS-VOIDED
 14113        NEXT SENTENCE
 14114     ELSE
 14115        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14116           MOVE ER-2667            TO WS-ERROR
 14117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14118
 14119     IF PB-COMPANY-ID = 'CRI'
 14120         IF WS-ERROR = ER-2667
 14121             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14122
 14123     IF ACCOUNT-AH-CHECKED
 14124        NEXT SENTENCE
 14125     ELSE
 14126        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14127           MOVE ER-2678            TO WS-ERROR
 14128           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14129
 14130     IF CP-ERROR-RATE-FILE-NOTOPEN
 14131         GO TO 3990-FILES-NOT-OPEN.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 257
* EL050.cbl
 14132
 14133 3321-CONTINUE.
 14134     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14135     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14136     IF (PB-COMPANY-ID = 'DCC')
 14137        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14138        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14139                                    PB-I-LF-ALT-PREM-CALC
 14140        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14141        IF WS-AH-BEN-CATEGORY = 'G'
 14142           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14143           + PB-I-ADDL-CLP)
 14144           * (1 + WS-TOL-CLP-PCT)
 14145*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14146        ELSE
 14147           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14148           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14149*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14150        END-IF
 14151        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14152                                 TO PB-I-AH-PREM-CALC
 14153        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14154           MOVE ER-8152          TO WS-ERROR
 14155           PERFORM 9900-ERROR-FORMAT
 14156                                 THRU 9900-EXIT
 14157        ELSE
 14158           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14159                 PB-I-ADDL-CLP)
 14160              MOVE ER-8148       TO WS-ERROR
 14161              PERFORM 9900-ERROR-FORMAT
 14162                                 THRU 9900-EXIT
 14163           END-IF
 14164        END-IF
 14165     END-IF
 14166     IF (PB-COMPANY-ID = 'DCC')
 14167        AND (PB-I-POLICY-IS-MONTHLY)
 14168        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14169        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14170        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14171           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14172        END-IF
 14173     END-IF
 14174     IF (PB-COMPANY-ID = 'DCC')
 14175        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14176        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14177        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14178        MOVE ER-2786             TO WS-ERROR
 14179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14180     END-IF
 14181     MOVE +0                     TO PB-I-AH-CLP
 14182     IF PB-COMPANY-ID = 'DCC'
 14183        IF WS-AH-BEN-CATEGORY = 'D'
 14184           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14185              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14186        ELSE
 14187           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14188              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14189           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 258
* EL050.cbl
 14190        END-IF
 14191     END-IF
 14192     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14193
 14194     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14195         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14196
 14197     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14198         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14199
 14200     IF PB-COMPANY-ID = 'CRI'
 14201         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14202            PB-I-PAYMENT-AMOUNT = ZERO
 14203             NEXT SENTENCE
 14204         ELSE
 14205             COMPUTE PB-I-AH-PREM-CALC =
 14206                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14207                 (CP-PREMIUM-RATE / 100)
 14208             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14209                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14210                                             PB-I-RATE-DEV-PCT-AH.
 14211
 14212     IF PB-I-AH-RATE  = ZERO
 14213       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14214           NEXT SENTENCE
 14215       ELSE
 14216         MOVE ER-2642            TO WS-ERROR
 14217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14218
 14219     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14220     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14221     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14222     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14223     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14224     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14225
 14226     IF (PB-COMPANY-ID = 'DCC')
 14227        AND (WS-AH-BEN-CATEGORY = 'G')
 14228        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14229        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14230        IF CP-DEVIATION-CODE NOT = '000'
 14231           MOVE '000'            TO CP-DEVIATION-CODE
 14232           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14233           IF NO-CP-ERROR
 14234              COMPUTE PB-I-DDF-IU-RATE-UP =
 14235              PB-I-AH-CLP - CP-CALC-PREMIUM
 14236           ELSE
 14237              MOVE ER-3057        TO WS-ERROR
 14238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14239           END-IF
 14240        END-IF
 14241     END-IF
 14242     .
 14243 3335-EDIT-AH-REIN-NSP-RATE.
 14244     IF AH-REIN-NSP-NOT-USED
 14245         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14246
 14247     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 259
* EL050.cbl
 14248     IF PB-COMPANY-ID = 'DCC'
 14249         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14250     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14251     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14252     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14253     MOVE PB-SV-STATE            TO CP-STATE.
 14254     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14255     MOVE ZERO                   TO CP-DEVIATION-CODE
 14256                                    CP-RATE-DEV-PCT.
 14257*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14258     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14259     MOVE '3'                    TO CP-PROCESS-TYPE.
 14260     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14261     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14262                                    CP-RATING-BENEFIT-AMT.
 14263     IF CP-STATE-STD-ABBRV = 'OR'
 14264         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14265                                         PB-I-AH-TERM.
 14266     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14267     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14268     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14269     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14270     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14271     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14272                                    CP-REMAINING-TERM
 14273                                    WS-WORK-TERM.
 14274     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14275     IF PB-COMPANY-ID = 'DCC'
 14276        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14277     END-IF
 14278     IF  PB-COMPANY-ID = 'TIC'
 14279         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14280            MOVE ZERO TO CP-CLASS-CODE.
 14281
 14282     IF PB-COMPANY-ID NOT = 'TIC'
 14283          MOVE ZERO          TO CP-CLASS-CODE.
 14284
 14285     MOVE ZERO               TO CP-DEVIATION-CODE.
 14286
 14287     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14288
 14289     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14290
 14291     MOVE 'R'                   TO CP-RATE-FILE.
 14292     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14293
 14294     IF CP-ERROR-RATE-NOT-FOUND
 14295         MOVE ER-2645        TO WS-ERROR
 14296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14298
 14299     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14300
 14301     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14302     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14303
 14304     IF PB-I-AH-REI-RATE = ZERO
 14305         MOVE ER-2645        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 260
* EL050.cbl
 14306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14307
 14308
 14309 3340-CALCULATE-PREMIUM-AMT.
 14310
 14311     IF PB-COMPANY-ID = 'NCL'
 14312         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14313             WS-AH-SPECIAL-CALC-CD = 'O')
 14314             GO TO 3999-END-EDIT.
 14315
 14316     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14317                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14318                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14319                         OR 'AHL'
 14320         NEXT SENTENCE
 14321     ELSE
 14322         IF WS-STATE-ABBREVIATION = 'CT'
 14323             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14324                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14325                 COMPUTE PB-I-LF-PREM-CALC =
 14326                                     PB-I-LF-PREM-CALC * .90
 14327                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14328                                     PB-I-LF-ALT-PREM-CALC * .90
 14329                 COMPUTE PB-I-AH-PREM-CALC =
 14330                                     PB-I-AH-PREM-CALC * .90.
 14331
 14332     IF PB-COMP-LF-PREM
 14333        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14334        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14335
 14336     IF PB-COMP-AH-PREM
 14337        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14338
 14339 3340-CHECK-DCC-TOT-FEES.
 14340     IF (PB-COMPANY-ID = 'DCC')
 14341        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14342        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14343        AND (PB-I-POLICY-IS-MONTHLY)
 14344        CONTINUE
 14345     ELSE
 14346        GO TO 3340-EDIT-LF-AH-TOL
 14347     END-IF
 14348     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14349     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14350     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14351        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14352           PB-I-RATE-DEV-PCT-LF
 14353     END-IF
 14354     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14355        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14356           PB-I-RATE-DEV-PCT-AH
 14357     END-IF
 14358     MOVE 'N'                    TO CP-BEN-CATEGORY
 14359     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14360
 14361     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14362     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14363     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 261
* EL050.cbl
 14364     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14365     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14366     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14367     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14368     MOVE '3'                    TO CP-PROCESS-TYPE.
 14369     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14370     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14371
 14372     MOVE PB-SV-STATE            TO CP-STATE.
 14373     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14374     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14375     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14376     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14377     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14378                                    CP-RATING-BENEFIT-AMT.
 14379     IF CP-STATE-STD-ABBRV = 'OR'
 14380         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14381                                         PB-I-LF-ALT-BENEFIT-AMT.
 14382     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14383     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14384     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14385     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14386     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14387     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14388     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14389     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14390     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14391                                    CP-REMAINING-TERM
 14392                                    CP-LOAN-TERM.
 14393
 14394     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14395         NEXT SENTENCE
 14396     ELSE
 14397         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14398             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14399                                           PB-I-LF-PREMIUM-AMT.
 14400
 14401     IF CP-TRUNCATED-LIFE
 14402        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14403
 14404     IF CP-TERM-IS-DAYS
 14405         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14406     ELSE
 14407         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14408
 14409     IF PB-COMPANY-ID = 'DCC'
 14410        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14411     END-IF
 14412     IF CP-SPECIAL-CALC-CD = 'H'
 14413         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14414                                    TO CP-ALTERNATE-BENEFIT
 14415         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14416     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14417     MOVE 'R'                    TO CP-RATE-FILE
 14418     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14419     IF NOT CP-ERROR-RATE-NOT-FOUND
 14420        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14421        IF (CP-DCC-LF-RATE NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 262
* EL050.cbl
 14422           AND (CP-BENEFIT-CD (1:1) = 'S')
 14423           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14424                                    PB-I-LF-PREMIUM-AMT
 14425        END-IF
 14426     ELSE
 14427        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14428     END-IF
 14429     .
 14430 3340-EDIT-LF-AH-TOL.
 14431
 14432***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14433***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14434***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14435***
 14436     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14437         PB-I-AH-PREMIUM-AMT
 14438          GIVING WS-CALC-WORK.
 14439
 14440     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14441        AND WS-CALC-WORK NOT = ZERO
 14442         MOVE ER-2649            TO WS-ERROR
 14443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14444
 14445     SUBTRACT PB-I-LF-PREM-CALC
 14446             FROM PB-I-LF-PREMIUM-AMT
 14447                 GIVING WS-UNSIGN-WRK1.
 14448
 14449     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14450             FROM PB-I-LF-ALT-PREMIUM-AMT
 14451                 GIVING WS-UNSIGN-WRK4.
 14452
 14453     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14454                                + WS-UNSIGN-WRK4.
 14455
 14456     SUBTRACT PB-I-AH-PREM-CALC
 14457             FROM PB-I-AH-PREMIUM-AMT
 14458                 GIVING WS-UNSIGN-WRK2.
 14459
 14460******************************************************************
 14461*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14462******************************************************************
 14463
 14464     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14465         MOVE ZERO TO WS-UNSIGN-WRK1.
 14466
 14467     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14468         MOVE ZERO TO WS-UNSIGN-WRK2.
 14469
 14470     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14471             GIVING WS-UNSIGN-WRK3.
 14472
 14473 3342-CONTINUE.
 14474
 14475     IF (PB-I-LF-RATE = ZERO  AND
 14476         PB-I-AH-RATE = ZERO)
 14477         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14478            WS-AH-SPECIAL-CALC-CD = 'O'
 14479              NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 263
* EL050.cbl
 14480         ELSE
 14481             GO TO 3345-EDIT-CONTINUE.
 14482
 14483     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14484         NEXT SENTENCE
 14485     ELSE
 14486     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14487        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14488           IF (PB-REISSUED-CERT         OR
 14489               PB-POLICY-IS-DECLINED    OR
 14490               PB-POLICY-IS-VOIDED)
 14491              NEXT SENTENCE
 14492           ELSE
 14493              IF WS-PREM-REJECT-SW = SPACE
 14494                 MOVE ER-2652    TO WS-ERROR
 14495                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14496                 GO TO 3344-CHECK-AH
 14497              ELSE
 14498                 MOVE ER-2650    TO WS-ERROR
 14499                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500                 GO TO 3344-CHECK-AH.
 14501
 14502***
 14503***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14504***
 14505
 14506     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14507         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14508            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14509             (1 + WS-TOL-LF-PREM-PCT)
 14510         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14511            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14512             (1 - WS-TOL-LF-PREM-PCT)
 14513     ELSE
 14514         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14515         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14516
 14517***
 14518***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14519***
 14520
 14521     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14522         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14523          WS-TOL-LF-PREM.
 14524
 14525     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14526         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14527          WS-TOL-LF-PREM.
 14528
 14529     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14530        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14531
 14532     IF (PB-REISSUED-CERT        OR
 14533         PB-POLICY-IS-DECLINED   OR
 14534         PB-POLICY-IS-VOIDED)
 14535        NEXT SENTENCE
 14536     ELSE
 14537     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 264
* EL050.cbl
 14538           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14539       OR
 14540        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14541           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14542       AND
 14543        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14544           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14545         OR
 14546          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14547           LESS WS-TOL-LF-LOW-PREM-PCT))
 14548              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14549                  MOVE ER-2652   TO  WS-ERROR
 14550                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14551              ELSE
 14552                  MOVE ER-2650   TO  WS-ERROR
 14553                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14554
 14555*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14556*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14557*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14558*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14559
 14560     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14561        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14562                      OR
 14563           ((PB-COMPANY-ID = 'DCC')
 14564           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14565           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14566           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14567        END-IF
 14568     END-IF
 14569
 14570     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14571        IF WS-COMP-MAX-CAP GREATER THAN +0
 14572           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14573              IF (PB-REISSUED-CERT         OR
 14574                  PB-POLICY-IS-DECLINED    OR
 14575                  PB-POLICY-IS-VOIDED)
 14576                 NEXT SENTENCE
 14577              ELSE
 14578                  MOVE ER-2646   TO  WS-ERROR
 14579                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14580
 14581 3344-CVL-TOLERANCE-CHECK.
 14582
 14583      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14584          GO TO 3344-CHECK-AH.
 14585
 14586      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14587          GO TO 3344-CHECK-AH.
 14588
 14589      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14590                                     WS-UNSIGN-WRK6.
 14591
 14592      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14593          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14594                                 + PB-I-LF-PREMIUM-AMT
 14595                                 - PB-I-LF-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 265
* EL050.cbl
 14596
 14597      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14598          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14599                                 + PB-I-LF-ALT-PREMIUM-AMT
 14600                                 - PB-I-LF-ALT-PREM-CALC.
 14601
 14602      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14603          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14604              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14605                 MOVE ER-2652    TO  WS-ERROR
 14606                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14607              ELSE
 14608                 MOVE ER-2650    TO  WS-ERROR
 14609                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14610
 14611      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14612          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14613              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14614                 MOVE ER-2652    TO  WS-ERROR
 14615                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14616              ELSE
 14617                 MOVE ER-2650    TO  WS-ERROR
 14618                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14619
 14620 3344-CHECK-AH.
 14621
 14622****************************************************************
 14623***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14624***
 14625
 14626     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14627         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14628             (1 + WS-TOL-AH-PREM-PCT)
 14629         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14630             (1 - WS-TOL-AH-PREM-PCT)
 14631     ELSE
 14632         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14633         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14634
 14635***
 14636***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14637***
 14638
 14639     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14640         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14641
 14642     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14643         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14644
 14645     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14646        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14647
 14648     IF (PB-REISSUED-CERT)
 14649        OR (PB-POLICY-IS-DECLINED)
 14650        OR (PB-POLICY-IS-VOIDED)
 14651        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14652        CONTINUE
 14653     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 266
* EL050.cbl
 14654        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14655            OR
 14656           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14657           AND
 14658           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14659           OR
 14660           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14661           IF WS-PREM-REJECT-SW = SPACE
 14662              MOVE ER-3052       TO WS-ERROR
 14663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14664           ELSE
 14665              MOVE ER-3050       TO WS-ERROR
 14666              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14667           END-IF
 14668        END-IF
 14669     END-IF
 14670
 14671     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14672         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14673             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14674             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14675
 14676     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14677        IF WS-COMP-MAX-CAP GREATER THAN +0
 14678           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14679              IF (PB-REISSUED-CERT         OR
 14680                  PB-POLICY-IS-DECLINED    OR
 14681                  PB-POLICY-IS-VOIDED)
 14682                 NEXT SENTENCE
 14683              ELSE
 14684                  MOVE ER-2646   TO  WS-ERROR
 14685                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14686
 14687     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14688        (WS-COMP-MAX-CAP EQUAL +0)
 14689           GO TO 3345-EDIT-CONTINUE.
 14690
 14691     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14692        GREATER THAN WS-COMP-MAX-CAP
 14693           MOVE ER-2646          TO  WS-ERROR
 14694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14695
 14696 3345-EDIT-CONTINUE.
 14697
 14698*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14699*       IF PB-ENTRY-BATCH   NUMERIC
 14700*          IF PB-ISSUE
 14701*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14702*          ELSE
 14703*              IF PB-CANCELLATION
 14704*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14705
 14706*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14707*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14708*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14709*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14710*        ELSE
 14711*            MOVE  ER-1909            TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 267
* EL050.cbl
 14712*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14713
 14714     IF PB-I-POLICY-ACCEPTED
 14715        IF PB-POLICY-IS-DECLINED  OR
 14716           PB-REISSUED-CERT  OR
 14717           PB-REIN-ONLY-CERT  OR
 14718           PB-POLICY-IS-VOIDED
 14719            MOVE  ER-1891         TO  WS-ERROR
 14720            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14721        ELSE
 14722            MOVE SPACE            TO  PB-BATCH-ENTRY
 14723            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14724
 14725     IF PB-I-POLICY-DECLINED
 14726        IF PB-REISSUED-CERT  OR
 14727           PB-REIN-ONLY-CERT  OR
 14728           PB-POLICY-IS-VOIDED
 14729            MOVE  ER-1906         TO  WS-ERROR
 14730            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14731        ELSE
 14732            MOVE  'D'             TO  PB-BATCH-ENTRY
 14733                                      PB-I-ENTRY-STATUS.
 14734
 14735     IF PB-I-NEEDS-UNDERWRITING
 14736        IF PB-POLICY-IS-DECLINED OR
 14737           PB-REISSUED-CERT  OR
 14738           PB-REIN-ONLY-CERT  OR
 14739           PB-POLICY-IS-VOIDED
 14740            MOVE  ER-1907         TO  WS-ERROR
 14741            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14742        ELSE
 14743            MOVE 'U'              TO  PB-BATCH-ENTRY
 14744                                      PB-I-ENTRY-STATUS.
 14745
 14746     IF PB-NEEDS-UNDERWRITING
 14747        MOVE  ER-1901             TO  WS-ERROR
 14748        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14749     IF PB-COMPANY-ID = 'DCC'
 14750        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14751        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14752        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14753           AND (NOT WS-LF-CASH))
 14754                           OR
 14755           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14756           AND (NOT WS-AH-CASH)))
 14757                       AND
 14758           (PB-I-ENTRY-STATUS NOT = '5')
 14759           MOVE 'M'              TO PB-BATCH-ENTRY
 14760                                    PB-I-ENTRY-STATUS
 14761        END-IF
 14762     END-IF
 14763     IF  PB-COMPANY-ID NOT = 'NCL'
 14764         GO TO 3999-END-EDIT.
 14765
 14766     IF PB-REISSUED-CERT  OR
 14767        PB-POLICY-IS-DECLINED  OR
 14768        PB-POLICY-IS-VOIDED  OR
 14769        PB-I-OB
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 268
* EL050.cbl
 14770         GO TO 3999-END-EDIT.
 14771
 14772     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14773         MOVE  ER-2644            TO  WS-ERROR
 14774         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14775         GO TO 3999-END-EDIT.
 14776
 14777     MOVE 'N'                     TO  FORM-MASTER-SW.
 14778     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14779
 14780     IF NOT FORM-MASTER-FOUND
 14781         GO TO 3999-END-EDIT.
 14782
 14783     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14784                                      FORM-MASTER-AH-SW.
 14785
 14786     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14787         MOVE  +1                 TO SUB6
 14788         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14789
 14790     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14791         MOVE  +1                 TO SUB6
 14792         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14793
 14794     IF LF-FORM-MASTER-FOUND  OR
 14795        AH-FORM-MASTER-FOUND
 14796         GO TO 3360-CHECK-FORM-LIMITS
 14797     ELSE
 14798         GO TO 3999-END-EDIT.
 14799
 14800******************************************************************
 14801*                  3350-GET-ERFORM                               *
 14802*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14803*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14804******************************************************************
 14805
 14806 3350-GET-ERFORM.
 14807
 14808     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14809         GO TO  3350-ERFORM-GETMAIN.
 14810
 14811     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14812     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14813     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14814     MOVE 'Y'                     TO FORM-MASTER-SW.
 14815
 14816     IF PB-CANCELLATION
 14817         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14818            PB-SV-STATE          EQUAL   FO-STATE       AND
 14819            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14820              GO TO 3350-EXIT
 14821         ELSE
 14822             NEXT SENTENCE
 14823     ELSE
 14824         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14825            PB-SV-STATE          EQUAL   FO-STATE       AND
 14826            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14827              GO TO 3350-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 269
* EL050.cbl
 14828
 14829 3350-ERFORM-GETMAIN.
 14830
 14831     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14832     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14833
 14834 3350-ERFORM-READ.
 14835
 14836     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14837     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14838     IF PB-CANCELLATION
 14839         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14840     ELSE
 14841         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14842     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14843
 14844     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14845
 14846     IF FORM-MASTER-FOUND
 14847       IF PB-CANCELLATION
 14848          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14849             PB-SV-STATE          EQUAL   FO-STATE       AND
 14850             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14851              GO  TO 3350-EXIT
 14852          ELSE
 14853              NEXT SENTENCE
 14854       ELSE
 14855          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14856             PB-SV-STATE          EQUAL   FO-STATE       AND
 14857             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14858              GO  TO 3350-EXIT.
 14859
 14860     MOVE  'N'                    TO  FORM-MASTER-SW.
 14861     MOVE  ER-1895                TO  WS-ERROR.
 14862     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14863
 14864 3350-EXIT.
 14865      EXIT.
 14866
 14867******************************************************************
 14868*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14869*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14870*   VALID FOR THE POLICY FORM USED.                              *
 14871******************************************************************
 14872
 14873 3355-EDIT-FORM-LF-BENEFITS.
 14874
 14875     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14876        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14877         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14878         GO TO   3355-EXIT.
 14879
 14880     IF  SUB6    LESS THAN   +40
 14881         ADD  +1      TO  SUB6
 14882         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14883
 14884     MOVE  ER-1896         TO  WS-ERROR.
 14885     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 270
* EL050.cbl
 14886
 14887 3355-EXIT.
 14888      EXIT.
 14889
 14890******************************************************************
 14891*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14892*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14893*   VALID FOR THE POLICY FORM USED.                              *
 14894******************************************************************
 14895
 14896 3356-EDIT-FORM-AH-BENEFITS.
 14897
 14898     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14899        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14900         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14901         GO TO  3356-EXIT.
 14902
 14903      IF  SUB6    LESS THAN     +40
 14904          ADD  +1      TO  SUB6
 14905          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14906
 14907     MOVE  ER-1897         TO  WS-ERROR.
 14908     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14909
 14910 3356-EXIT.
 14911      EXIT.
 14912
 14913******************************************************************
 14914*                  3357-BENEFIT-SEARCH                           *
 14915*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14916*   CANCELLATIONS ONLY.                                          *
 14917******************************************************************
 14918 3357-BENEFIT-SEARCH.
 14919     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14920         MOVE +1                          TO SUB6
 14921         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14922
 14923     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14924         MOVE +1                          TO SUB6
 14925         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14926
 14927 3357-EXIT.
 14928     EXIT.
 14929
 14930******************************************************************
 14931*                  3358-BENEFIT-LIFE-SEARCH                      *
 14932*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14933*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14934*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14935******************************************************************
 14936 3358-BENEFIT-LIFE-SEARCH.
 14937     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14938       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14939         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14940           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14941              IF FO-PLAN-REFUND-METHOD (SUB6)
 14942                     IS GREATER THAN SPACES
 14943                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 271
* EL050.cbl
 14944                                          WS-LF-REFUND-CALC
 14945                 GO TO 3358-EXIT.
 14946
 14947     IF SUB6 LESS THAN +40
 14948         ADD +1                 TO SUB6
 14949         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14950
 14951 3358-EXIT.
 14952     EXIT.
 14953******************************************************************
 14954*                  3359-BENEFIT-AH-SEARCH                        *
 14955*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14956*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14957*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14958******************************************************************
 14959 3359-BENEFIT-AH-SEARCH.
 14960     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14961       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14962         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14963           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14964              IF FO-PLAN-REFUND-METHOD (SUB6)
 14965                      IS GREATER THAN SPACES
 14966                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14967                                          WS-AH-REFUND-CALC
 14968                 GO TO 3359-EXIT.
 14969
 14970     IF SUB6 LESS THAN +40
 14971         ADD +1                 TO SUB6
 14972         GO TO 3359-BENEFIT-AH-SEARCH.
 14973
 14974 3359-EXIT.
 14975     EXIT.
 14976
 14977******************************************************************
 14978*                  3360-CHECK-FORM-LIMITS                        *
 14979*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14980*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14981******************************************************************
 14982
 14983 3360-CHECK-FORM-LIMITS.
 14984
 14985     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14986         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14987
 14988     IF NOT LF-FORM-MASTER-FOUND
 14989         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14990
 14991 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14992
 14993     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14994       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14995        WS-LF-JOINT-INDICATOR = 'J'  AND
 14996        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14997         IF PB-COMPANY-ID = 'NCL'
 14998            MOVE  ER-1911          TO  WS-ERROR
 14999            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15000         ELSE
 15001            MOVE  ER-1892          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 272
* EL050.cbl
 15002            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15003
 15004 3360-CHECK-FORM-LF-ATT-AGE.
 15005
 15006     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15007
 15008     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15009         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15010         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15011            IF PB-COMPANY-ID = 'NCL'
 15012                MOVE  ER-1913      TO  WS-ERROR
 15013                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15014            ELSE
 15015                MOVE  ER-1894      TO  WS-ERROR
 15016                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15017
 15018 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15019
 15020     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15021         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15022         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15023            IF PB-COMPANY-ID = 'NCL'
 15024                MOVE  ER-1914      TO  WS-ERROR
 15025                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15026            ELSE
 15027                MOVE  ER-1899      TO  WS-ERROR
 15028                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15029
 15030 3360-CHECK-FORM-LF-TERM-BAMT.
 15031
 15032     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15033         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15034         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15035           IF  PB-COMPANY-ID = 'NCL'
 15036               MOVE  ER-1916       TO  WS-ERROR
 15037               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15038           ELSE
 15039               MOVE  ER-1902       TO  WS-ERROR
 15040               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15041
 15042     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15043                                    PB-I-LF-ALT-BENEFIT-AMT.
 15044
 15045     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15046         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15047         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15048             IF  PB-COMPANY-ID = 'NCL'
 15049                 MOVE  ER-1918     TO  WS-ERROR
 15050                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15051             ELSE
 15052                 MOVE  ER-1904     TO  WS-ERROR
 15053                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15054
 15055******************************************************************
 15056*                  3360-CHECK-FORM-AH-LIMITS                     *
 15057*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15058*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 273
* EL050.cbl
 15060
 15061 3360-CHECK-FORM-AH-LIMITS.
 15062
 15063     IF NOT AH-FORM-MASTER-FOUND
 15064         GO TO 3999-END-EDIT.
 15065
 15066 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15067
 15068     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15069       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15070        WS-AH-JOINT-INDICATOR = 'J'  AND
 15071        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15072         IF PB-COMPANY-ID = 'NCL'
 15073            MOVE  ER-1912          TO  WS-ERROR
 15074            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15075         ELSE
 15076            MOVE  ER-1893          TO  WS-ERROR
 15077            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15078
 15079 3360-CHECK-FORM-AH-ATT-AGE.
 15080
 15081     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15082
 15083     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15084         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15085         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15086            IF PB-COMPANY-ID = 'NCL'
 15087                MOVE  ER-1913      TO  WS-ERROR
 15088                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15089            ELSE
 15090                MOVE  ER-1894      TO  WS-ERROR
 15091                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15092
 15093 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15094
 15095     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15096         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15097         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15098            IF PB-COMPANY-ID = 'NCL'
 15099                MOVE  ER-1915      TO  WS-ERROR
 15100                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15101            ELSE
 15102                MOVE  ER-1900      TO  WS-ERROR
 15103                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15104
 15105 3360-CHECK-FORM-AH-TERM-BAMT.
 15106
 15107     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15108         FO-AH-MAX-TERM    GREATER THAN  +0
 15109         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15110             IF  PB-COMPANY-ID = 'NCL'
 15111                 MOVE  ER-1917     TO  WS-ERROR
 15112                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15113             ELSE
 15114                  MOVE  ER-1903    TO  WS-ERROR
 15115                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15116
 15117     IF  FO-MAX-AH-AMT    NUMERIC   AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 274
* EL050.cbl
 15118         FO-MAX-AH-AMT    GREATER THAN  +0
 15119         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15120             IF  PB-COMPANY-ID = 'NCL'
 15121                 MOVE  ER-1919     TO  WS-ERROR
 15122                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15123             ELSE
 15124                 MOVE  ER-1905     TO  WS-ERROR
 15125                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15126
 15127     GO TO 3999-END-EDIT.
 15128
 15129******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 275
* EL050.cbl
 15131******************************************************************
 15132*                  E D I T   C A N C E L                         *
 15133******************************************************************
 15134
 15135 3700-EDIT-CANCEL.
 15136     IF PB-COMPANY-ID = 'DMD'
 15137         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15138                                         WS-RES-MUNI-TAX
 15139                                         PB-CI-STATE-TAX
 15140                                         PB-CI-MUNI-TAX
 15141         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15142
 15143*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15144*       IF PB-ENTRY-BATCH  NUMERIC
 15145*          IF PB-CANCELLATION
 15146*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15147*          ELSE
 15148*             IF PB-ISSUE
 15149*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15150
 15151     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15152        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15153     END-IF
 15154*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15155*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15156
 15157     IF CM-ENTRY-STATUS = 'V'
 15158        MOVE ER-2780             TO WS-ERROR
 15159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15160        GO TO 3999-END-EDIT.
 15161
 15162     IF CM-ENTRY-STATUS = 'D'
 15163        MOVE ER-2781             TO WS-ERROR
 15164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15165        GO TO 3999-END-EDIT.
 15166
 15167     IF CM-ENTRY-STATUS = 'U'
 15168        MOVE ER-2782             TO WS-ERROR
 15169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15170
 15171***************************************************************
 15172*                                                             *
 15173*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15174*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15175*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15176*   OF ANOTHER COVERAGE.                                      *
 15177*                                                             *
 15178***************************************************************
 15179
 15180     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15181                                    PB-C-AH-CANCEL-VOID-SW.
 15182
 15183     IF PB-C-LF-CANCEL-AMT = ZERO
 15184        NEXT SENTENCE
 15185     ELSE
 15186        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15187           AND
 15188           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 276
* EL050.cbl
 15189               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15190               MOVE ER-2745           TO WS-ERROR
 15191               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15192
 15193     IF PB-C-AH-CANCEL-AMT = ZERO
 15194        NEXT SENTENCE
 15195     ELSE
 15196        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15197           AND
 15198           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15199               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15200               MOVE ER-2745           TO WS-ERROR
 15201               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15202
 15203     IF WS-LF-EARNINGS-CALC = '4'
 15204        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15205
 15206     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15207     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15208     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15209     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15210     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15211     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15212
 15213     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15214                                      PB-C-AH-REF-CALC.
 15215     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15216
 15217******************************************************************
 15218*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15219*             TO VALIDATE COVERAGE.                              *
 15220******************************************************************
 15221
 15222     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15223        PB-C-LF-CANCEL-AMT = ZEROS
 15224          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15225      ELSE
 15226          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15227
 15228     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15229        PB-C-AH-CANCEL-AMT = ZEROS
 15230          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15231      ELSE
 15232          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15233
 15234     EVALUATE TRUE
 15235         WHEN PB-CANCEL-FORCE             OR
 15236              PB-CANCEL-DATE-FORCED       OR
 15237              PB-FORCE-OFF
 15238                  IF PB-COMPANY-ID = 'ACE'
 15239                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15240                  END-IF
 15241         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15242               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15243              (PB-COMPANY-ID = 'ACE' )
 15244                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15245         WHEN OTHER
 15246              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 277
* EL050.cbl
 15247                 MOVE ER-2794              TO WS-ERROR
 15248              ELSE
 15249                 MOVE ER-2749              TO WS-ERROR
 15250              END-IF
 15251              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15252     END-EVALUATE.
 15253
 15254
 15255*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15256*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15257*            MOVE  ER-1909            TO  WS-ERROR
 15258*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15259*        ELSE
 15260*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15261
 15262     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15263     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15264        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15265     ELSE
 15266        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15267     END-IF
 15268     .
 15269 3705-EDIT-CANCEL-DT.
 15270
 15271     IF LF-COVERAGE-CANCELLED
 15272        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15273         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15274         MOVE WS-CURRENT-MONTH-END
 15275                                 TO DC-BIN-DATE-2
 15276         SET ELAPSED-BETWEEN-BIN TO TRUE
 15277*        MOVE 1                  TO DC-OPTION-CODE
 15278         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15279         IF DATE-CONVERSION-ERROR
 15280            NEXT SENTENCE
 15281          ELSE
 15282             IF DC-ELAPSED-DAYS GREATER +180
 15283                IF PB-CANCEL-DATE-FORCED  OR
 15284                   PB-CANCEL-DATE-FORCED-NO-FEE
 15285                      MOVE ER-2751  TO WS-ERROR
 15286                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15287                 ELSE
 15288                   MOVE ER-2752  TO WS-ERROR
 15289                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290
 15291     IF AH-COVERAGE-CANCELLED
 15292        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15293         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15294         MOVE WS-CURRENT-MONTH-END
 15295                                 TO DC-BIN-DATE-2
 15296         SET ELAPSED-BETWEEN-BIN TO TRUE
 15297*        MOVE 1                  TO DC-OPTION-CODE
 15298         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15299         IF DATE-CONVERSION-ERROR
 15300            NEXT SENTENCE
 15301          ELSE
 15302             IF DC-ELAPSED-DAYS GREATER +180
 15303                IF PB-CANCEL-DATE-FORCED OR
 15304                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 278
* EL050.cbl
 15305                      MOVE ER-2751  TO WS-ERROR
 15306                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15307                 ELSE
 15308                   MOVE ER-2752  TO WS-ERROR
 15309                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15310
 15311     IF WS-ERROR = ER-2752
 15312        AND (PB-COMPANY-ID = 'ABL'
 15313         OR  PB-COMPANY-ID = 'FGL'
 15314         OR  PB-COMPANY-ID = 'IST'
 15315         OR  PB-COMPANY-ID = 'JHL'
 15316         OR  PB-COMPANY-ID = 'LAP'
 15317         OR  PB-COMPANY-ID = 'LBL'
 15318         OR  PB-COMPANY-ID = 'NCB'
 15319         OR  PB-COMPANY-ID = 'NLI'
 15320         OR  PB-COMPANY-ID = 'OFI'
 15321         OR  PB-COMPANY-ID = 'PLI'
 15322         OR  PB-COMPANY-ID = 'TAO'
 15323         OR  PB-COMPANY-ID = 'TIC'
 15324         OR  PB-COMPANY-ID = 'HER'
 15325         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15326         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15327            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15328            MOVE ER-2762     TO WS-ERROR
 15329            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15330
 15331     IF LF-COVERAGE-CANCELLED
 15332        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15333        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15334             MOVE ER-2733         TO WS-ERROR
 15335             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15336
 15337     IF AH-COVERAGE-CANCELLED
 15338        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15339        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15340              MOVE ER-2733        TO WS-ERROR
 15341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342
 15343     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15344        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15345        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15346           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15347            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15348              IF PB-COMPANY-ID NOT = 'LAP'
 15349               MOVE ER-2704            TO WS-ERROR
 15350               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15351
 15352     IF CERT-WAS-NOT-FOUND
 15353         GO TO 3999-END-EDIT.
 15354
 15355     IF PB-COMPANY-ID EQUAL 'CDC'
 15356        IF LF-COVERAGE-CANCELLED
 15357           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15358            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15359            MOVE PB-C-LF-CANCEL-DT
 15360                                 TO DC-BIN-DATE-2
 15361            SET ELAPSED-BETWEEN-BIN TO TRUE
 15362*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 279
* EL050.cbl
 15363            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15364            IF DATE-CONVERSION-ERROR
 15365               NEXT SENTENCE
 15366             ELSE
 15367                IF DC-ELAPSED-DAYS GREATER +60
 15368                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15369
 15370     IF PB-COMPANY-ID EQUAL 'CDC'
 15371        IF AH-COVERAGE-CANCELLED
 15372           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15373            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15374            MOVE PB-C-AH-CANCEL-DT
 15375                                 TO DC-BIN-DATE-2
 15376            MOVE +0              TO DC-ELAPSED-DAYS
 15377                                    DC-ELAPSED-MONTHS
 15378            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15379*           MOVE 1               TO DC-OPTION-CODE
 15380            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15381            IF DATE-CONVERSION-ERROR
 15382               NEXT SENTENCE
 15383             ELSE
 15384                IF DC-ELAPSED-DAYS GREATER +60
 15385                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15386
 15387     MOVE +0                     TO DC-ELAPSED-DAYS
 15388                                    DC-ELAPSED-MONTHS.
 15389
 15390     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15391        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15392          MOVE 'Z'                TO PB-CI-OB-FLAG
 15393          MOVE ER-2767            TO WS-ERROR
 15394          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15395          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15396          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15397          GO TO 3775-OVER-REF-CHK
 15398        ELSE
 15399          MOVE ZEROS              TO PB-CI-LIVES
 15400                                     PB-C-LIVES
 15401          IF PB-CI-OB-FLAG NOT = 'B'
 15402             MOVE SPACE           TO PB-CI-OB-FLAG.
 15403
 15404     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15405         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15406     ELSE
 15407         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15408
 15409     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15410        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15411            MOVE ER-2760         TO WS-ERROR
 15412            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15413
 15414     IF LF-COVERAGE-CANCELLED
 15415        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15416         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15417            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15418               MOVE ER-2774       TO WS-ERROR
 15419               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15420
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 280
* EL050.cbl
 15421     IF AH-COVERAGE-CANCELLED
 15422        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15423         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15424            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15425               MOVE ER-2775       TO WS-ERROR
 15426               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15427
 15428     IF LF-COVERAGE-CANCELLED
 15429        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15430         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15431            MOVE ER-2776         TO WS-ERROR
 15432            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15433
 15434     IF AH-COVERAGE-CANCELLED
 15435        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15436         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15437            MOVE ER-2777         TO WS-ERROR
 15438            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15439
 15440     IF LF-COVERAGE-CANCELLED
 15441        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15442         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15443         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15444         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15445*        MOVE 6                    TO DC-OPTION-CODE
 15446         SET BIN-PLUS-ELAPSED      TO TRUE
 15447         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15448         IF DATE-CONVERSION-ERROR
 15449            NEXT SENTENCE
 15450          ELSE
 15451            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15452              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15453                             OR  'FIA'
 15454                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15455               ELSE
 15456                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15457                MOVE ER-2731       TO WS-ERROR
 15458                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15459
 15460 3705-EDIT-AH-CANCEL-DT.
 15461
 15462     IF AH-COVERAGE-CANCELLED
 15463        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15464         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15465         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15466         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15467*        MOVE 6                    TO DC-OPTION-CODE
 15468         SET BIN-PLUS-ELAPSED      TO TRUE
 15469         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15470         IF DATE-CONVERSION-ERROR
 15471            NEXT SENTENCE
 15472          ELSE
 15473            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15474              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15475                              OR 'FIA'
 15476                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15477              ELSE
 15478               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 281
* EL050.cbl
 15479               MOVE ER-2771       TO WS-ERROR
 15480               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15481
 15482 3705-EDIT-CONTINUED.
 15483
 15484*    IF LF-COVERAGE-CANCELLED
 15485*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15486*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15487*            MOVE ER-2727         TO WS-ERROR
 15488*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15489*
 15490*    IF AH-COVERAGE-CANCELLED
 15491*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15492*        IF PB-COMPANY-ID = 'ACE'
 15493*           MOVE ER-2727        TO WS-ERROR
 15494*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15495*        ELSE
 15496*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15497*              MOVE ER-2727     TO WS-ERROR
 15498*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15499
 15500     IF PB-COMPANY-ID = 'ACE'
 15501       IF AH-COVERAGE-CANCELLED
 15502         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15503           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15504              MOVE ER-2732      TO WS-ERROR
 15505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15506
 15507     IF PB-COMPANY-ID      EQUAL   'HER'
 15508        IF WS-ERROR        EQUAL   ER-2727
 15509            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15510            MOVE  ER-2725          TO  WS-ERROR
 15511            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15512
 15513     IF PB-C-CLAIM-CREATED-CANCEL
 15514            MOVE ER-2748         TO WS-ERROR
 15515            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15516
 15517     IF PB-C-LAST-NAME NOT = SPACES
 15518         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15519            MOVE ER-2747         TO WS-ERROR
 15520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522 3710-EDIT-LUMP-SUM-PRIOR.
 15523
 15524     IF AH-COVERAGE-CANCELLED
 15525         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15526             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15527                MOVE ER-2735    TO WS-ERROR
 15528                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15529
 15530     IF LF-COVERAGE-CANCELLED
 15531         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15532             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15533                MOVE ER-2735    TO WS-ERROR
 15534                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15535
 15536 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 282
* EL050.cbl
 15537
 15538*    IF LF-COVERAGE-CANCELLED
 15539*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15540*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15541*           (NOT PB-CI-OB)
 15542*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15543*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15544*                   MOVE ER-2732  TO WS-ERROR
 15545*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15546*
 15547*    IF AH-COVERAGE-CANCELLED
 15548*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15549*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15550*           (NOT PB-CI-OB)
 15551*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15552*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15553*                   MOVE ER-2732  TO WS-ERROR
 15554*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15555
 15556     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15557         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15558            (NOT PB-COMP-LF-CANCEL)
 15559             NEXT SENTENCE
 15560         ELSE
 15561           IF PB-C-LF-CANCEL-VOIDED
 15562              NEXT SENTENCE
 15563           ELSE
 15564              MOVE ER-2753      TO WS-ERROR
 15565              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15566
 15567     IF CANCEL-FUTURE-DT
 15568         GO TO 3999-END-EDIT.
 15569
 15570 3715-GET-REMAIN-TERM-LF.
 15571
 15572     IF NO-LF-BENEFIT-MATCH  OR
 15573        WS-LF-BENEFIT-CD = ZEROS
 15574        GO TO 3730-GET-AH-REMAIN-TERM.
 15575
 15576     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15577     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15578     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15579     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15580     MOVE PB-SV-STATE            TO CP-STATE.
 15581     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15582     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15583     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15584     MOVE '2'                    TO CP-PROCESS-TYPE.
 15585     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15586     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15587     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15588     IF (PB-COMPANY-ID = 'CID')
 15589        AND (CP-STATE-STD-ABBRV = 'WI')
 15590        MOVE '7'                 TO CP-REM-TERM-METHOD
 15591        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15592     ELSE
 15593        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15594        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 283
* EL050.cbl
 15595                                 TO CP-REM-TRM-CALC-OPTION
 15596     END-IF
 15597**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15598     IF (PB-COMPANY-ID = 'CID')
 15599        AND (CP-STATE-STD-ABBRV = 'MO')
 15600        AND (PB-CERT-EFF-DT >= X'9B41')
 15601        AND (PB-CERT-EFF-DT <= X'A2FB')
 15602        MOVE '7'                 TO CP-REM-TERM-METHOD
 15603        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15604     END-IF
 15605     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15606                                    CP-LOAN-TERM.
 15607     IF CP-TRUNCATED-LIFE
 15608        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15609
 15610     IF CP-TERM-IS-DAYS
 15611         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15612     ELSE
 15613         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15614
 15615     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15616
 15617     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15618
 15619     IF LF-COVERAGE-CANCELLED
 15620        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15621        NEXT SENTENCE
 15622      ELSE
 15623          GO TO 3730-GET-AH-REMAIN-TERM.
 15624
 15625 3720-GET-LF-REFUND.
 15626
 15627     IF PB-C-LF-CANCEL-VOIDED OR
 15628        PB-C-AH-CANCEL-VOIDED
 15629        GO TO 3780-UPDATE-CANCEL-CERT.
 15630
 15631     IF PB-COMPANY-ID EQUAL 'BOA'
 15632         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15633         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15634         GO TO 3730-GET-AH-REMAIN-TERM.
 15635
 15636     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15637        (WS-AH-SPECIAL-CALC-CD = 'M')
 15638         MOVE ER-2767            TO WS-ERROR
 15639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15640         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15641         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15642         GO TO 3780-UPDATE-CANCEL-CERT.
 15643
 15644     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15645
 15646     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15647     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15648     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15649     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15650     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15651     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15652     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 284
* EL050.cbl
 15653        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15654        IF PDEF-MASTER-FOUND
 15655           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15656              (V1 > +8)
 15657              OR (PD-PROD-CODE (V1) = 'L')
 15658           END-PERFORM
 15659           IF V1 < +9
 15660              MOVE PD-MAX-AMT (V1)
 15661                           TO CP-R-MAX-TOT-BEN
 15662                              EC-AM-LF-MAX-TOT-BEN
 15663           END-IF
 15664        ELSE
 15665        MOVE ' '                 TO PDEF-MASTER-SW
 15666        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15667        MOVE PB-STATE            TO ERPDEF-STATE
 15668        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15669        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15670        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15671        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15672        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15673        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15674        IF PDEF-MASTER-FOUND
 15675           MOVE 'N'              TO PDEF-MASTER-SW
 15676           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15677           IF PDEF-MASTER-FOUND
 15678              IF (ERPDEF-KEY-SAVE (1:16) =
 15679                           PD-CONTROL-PRIMARY (1:16))
 15680                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15681                 CONTINUE
 15682              ELSE
 15683                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15684                 IF (ERPDEF-KEY-SAVE (1:16) =
 15685                           PD-CONTROL-PRIMARY (1:16))
 15686                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15687                    CONTINUE
 15688                 ELSE
 15689                    MOVE 'N'     TO PDEF-MASTER-SW
 15690                 END-IF
 15691              END-IF
 15692              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15693
 15694              IF PDEF-MASTER-FOUND
 15695                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15696                    (V1 > +8)
 15697                    OR (PD-PROD-CODE (V1) = 'L')
 15698                 END-PERFORM
 15699                 IF V1 < +9
 15700                    MOVE PD-MAX-AMT (V1)
 15701                                 TO CP-R-MAX-TOT-BEN
 15702                                    EC-AM-LF-MAX-TOT-BEN
 15703                 END-IF
 15704              END-IF
 15705           END-IF
 15706           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15707        END-IF
 15708        END-IF
 15709     END-IF
 15710     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 285
* EL050.cbl
 15711
 15712     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15713
 15714     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15715                                    PB-C-LF-REM-TERM.
 15716
 15717     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15718     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15719
 15720     IF PB-COMPANY-ID EQUAL 'FLC'
 15721        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15722           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15723           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15724                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15725                    - CM-LF-ITD-DEATH-AMT
 15726           IF PB-C-LF-REF-CALC LESS THAN +0
 15727              MOVE +0            TO PB-C-LF-REF-CALC
 15728              GO TO 3730-GET-AH-REMAIN-TERM
 15729           ELSE
 15730              GO TO 3730-GET-AH-REMAIN-TERM.
 15731
 15732     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15733                            OR '4' OR '5' OR '6' OR '8'
 15734                            OR '9' OR 'G'
 15735        MOVE PB-C-LF-REFUND-OVERRIDE
 15736                                 TO CP-EARNING-METHOD.
 15737
 15738     if pb-company-id = 'AHL'
 15739        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15740        if cp-class-code = spaces
 15741           move zeros            to cp-class-code
 15742        end-if
 15743     ELSE
 15744        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15745     END-IF
 15746*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15747     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15748     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15749                                    CP-RATING-BENEFIT-AMT.
 15750     IF CP-STATE-STD-ABBRV = 'OR'
 15751         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15752                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15753     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15754     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15755     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15756     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15757     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15758     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15759     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15760     IF WS-DEFAULT-APR NOT NUMERIC
 15761         MOVE ZEROS TO WS-DEFAULT-APR.
 15762****   N O T E   ****
 15763*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15764*      THE OH HARD CODING IN ELCRFNDP
 15765
 15766     IF PB-COMPANY-ID = 'CID'
 15767        IF CP-STATE-STD-ABBRV = 'OH'
 15768           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 286
* EL050.cbl
 15769                                 TO CP-EARNING-METHOD
 15770        END-IF
 15771     END-IF
 15772
 15773****   N O T E   ****
 15774
 15775     IF CP-EARN-AS-NET-PAY
 15776         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15777            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15778                MOVE WS-DEFAULT-APR
 15779                                 TO  CP-LOAN-APR
 15780                MOVE ER-3780     TO  WS-ERROR
 15781                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15782            ELSE
 15783                MOVE ER-3781     TO  WS-ERROR
 15784                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15785     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15786     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15787
 15788     IF CP-REFUND-TYPE-USED NOT = SPACE
 15789         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15790
 15791     IF CP-ERROR-RATE-IS-ZERO OR
 15792        CP-ERROR-RATE-NOT-FOUND
 15793        MOVE ER-2740             TO WS-ERROR
 15794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15795
 15796     IF CP-ERROR-RATE-FILE-NOTOPEN
 15797        MOVE ER-2617             TO WS-ERROR
 15798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
 15800     IF PB-COMPANY-ID = 'DCC'
 15801        AND PB-CI-ENTRY-STATUS = 'M'
 15802        MOVE +0                  TO PB-C-LF-REF-CALC
 15803     ELSE
 15804        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15805     END-IF
 15806
 15807     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15808         GO TO 3730-GET-AH-REMAIN-TERM.
 15809
 15810*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15811*       ADD +1                   TO PB-C-LF-REM-TERM
 15812*                                   CP-REMAINING-TERM
 15813*                                   CP-ORIGINAL-TERM.
 15814
 15815     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15816     MOVE '2'                    TO CP-EARNING-METHOD
 15817                                    CP-RATING-METHOD.
 15818     IF PB-COMPANY-ID = 'CID'
 15819        IF (CP-STATE-STD-ABBRV = 'MN')
 15820           AND (PB-CERT-EFF-DT > X'A4FF')
 15821           AND (WS-LF-EARNINGS-CALC = 'B')
 15822           MOVE '5'              TO CP-EARNING-METHOD
 15823           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15824        END-IF
 15825     END-IF
 15826     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 287
* EL050.cbl
 15827                                        CP-REMAINING-BENEFIT
 15828                                        CP-RATING-BENEFIT-AMT.
 15829     IF CP-STATE-STD-ABBRV = 'OR'
 15830         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15831                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15832     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15833     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15834
 15835     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15836
 15837     IF CP-ERROR-RATE-IS-ZERO OR
 15838        CP-ERROR-RATE-NOT-FOUND
 15839        MOVE ER-2740             TO WS-ERROR
 15840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15841
 15842     IF CP-ERROR-RATE-FILE-NOTOPEN
 15843        MOVE ER-2617             TO WS-ERROR
 15844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15845
 15846     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15847
 15848******************************************************************
 15849
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 288
* EL050.cbl
 15851 3730-GET-AH-REMAIN-TERM.
 15852     IF NO-AH-BENEFIT-MATCH  OR
 15853        WS-AH-BENEFIT-CD = ZEROS
 15854         GO TO 3770-CHECK-REFUNDS.
 15855
 15856     IF PB-CI-AH-LUMP-SUM-DISAB
 15857         IF  PB-C-AH-CANCEL-AMT = ZERO
 15858            IF NOT PB-COMP-AH-CANCEL
 15859             GO TO 3770-CHECK-REFUNDS.
 15860
 15861     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15862     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15863     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15864     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15865     MOVE PB-SV-STATE            TO CP-STATE.
 15866     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15867     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15868     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15869     MOVE '2'                    TO CP-PROCESS-TYPE.
 15870     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15871     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15872     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15873     IF (PB-COMPANY-ID = 'CID')
 15874        AND (CP-STATE-STD-ABBRV = 'WI')
 15875        MOVE '7'                 TO CP-REM-TERM-METHOD
 15876        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15877     ELSE
 15878        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15879        MOVE WS-REM-TRM-CALC-OPTION
 15880                                 TO CP-REM-TRM-CALC-OPTION
 15881     END-IF
 15882     IF (PB-COMPANY-ID = 'CID')
 15883        AND (CP-STATE-STD-ABBRV = 'MO')
 15884        AND (PB-CERT-EFF-DT >= X'9B41')
 15885        AND (PB-CERT-EFF-DT <= X'A2FB')
 15886        MOVE '7'                 TO CP-REM-TERM-METHOD
 15887        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15888     END-IF
 15889     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15890                                    CP-LOAN-TERM.
 15891     IF NOT CP-TERM-IS-DAYS
 15892         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15893
 15894     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15895
 15896     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15897
 15898     IF AH-COVERAGE-CANCELLED
 15899        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15900        NEXT SENTENCE
 15901      ELSE
 15902         GO TO 3770-CHECK-REFUNDS.
 15903
 15904 3740-GET-AH-REFUND.
 15905
 15906     IF PB-C-LF-CANCEL-VOIDED OR
 15907        PB-C-AH-CANCEL-VOIDED
 15908        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 289
* EL050.cbl
 15909
 15910     IF PB-COMPANY-ID = 'BOA'
 15911         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15912         GO TO 3770-CHECK-REFUNDS.
 15913
 15914     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15915*    MOVE ' '                    TO DC-OPTION-CODE
 15916     SET BIN-TO-GREG             TO TRUE
 15917     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15918     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15919                                    PB-C-AH-REM-TERM.
 15920     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15921     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15922
 15923     IF PB-COMPANY-ID EQUAL 'FLC'
 15924        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15925           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15926           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15927                    - CM-AH-ITD-AH-PMT)
 15928           IF PB-C-AH-REF-CALC LESS THAN +0
 15929              MOVE +0            TO PB-C-AH-REF-CALC
 15930              GO TO 3770-CHECK-REFUNDS
 15931           ELSE
 15932              GO TO 3770-CHECK-REFUNDS.
 15933
 15934     IF PB-COMPANY-ID = 'DCC'
 15935        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15936            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15937           MOVE 'S'              TO CP-EARNING-METHOD
 15938        END-IF
 15939     END-IF
 15940     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15941                            OR '4' OR '5' OR '6' OR '8'
 15942                            OR '9' OR 'G' OR 'S'
 15943        MOVE PB-C-AH-REFUND-OVERRIDE
 15944                                 TO CP-EARNING-METHOD.
 15945
 15946     if pb-company-id = 'AHL'
 15947        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15948        if cp-class-code = spaces
 15949           move zeros            to cp-class-code
 15950        end-if
 15951     ELSE
 15952        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15953     END-IF
 15954*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15955     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15956     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15957                                    CP-RATING-BENEFIT-AMT.
 15958     IF CP-STATE-STD-ABBRV = 'OR'
 15959         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15960                                         PB-CI-AH-TERM.
 15961     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15962     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15963     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15964     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15965     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15966     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 290
* EL050.cbl
 15967
 15968     IF CP-STATE-STD-ABBRV = 'OH'
 15969        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15970                                AND 'CID' AND 'DCC' AND 'AHL')
 15971           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15972              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15973              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15974              MOVE '6' TO CP-EARNING-METHOD
 15975           END-IF
 15976        END-IF
 15977        IF PB-COMPANY-ID = 'CID'
 15978           IF NO-LIFE-COVERAGE
 15979              IF CP-CRITICAL-PERIOD
 15980                 MOVE '2'       TO CP-EARNING-METHOD
 15981              ELSE
 15982                 MOVE '6'       TO CP-EARNING-METHOD
 15983              END-IF
 15984           ELSE
 15985              IF WS-LF-COVERAGE-TYPE = 'L'
 15986                 MOVE '2'       TO CP-EARNING-METHOD
 15987              ELSE
 15988                 IF (PB-CI-LF-TERM > +60) OR
 15989                    (WS-LF-EARNINGS-CALC = '5')
 15990                    IF CP-CRITICAL-PERIOD
 15991                       MOVE '2'  TO CP-EARNING-METHOD
 15992                    ELSE
 15993                       MOVE '6'  TO CP-EARNING-METHOD
 15994                    END-IF
 15995                 ELSE
 15996                    MOVE '1'     TO CP-EARNING-METHOD
 15997                 END-IF
 15998              END-IF
 15999           END-IF
 16000        END-IF
 16001     END-IF
 16002
 16003*    IF CP-STATE-STD-ABBRV = 'VA'
 16004*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16005*          IF CP-ORIGINAL-TERM GREATER 61
 16006*             MOVE '6' TO CP-EARNING-METHOD
 16007*          ELSE
 16008*             MOVE '1' TO CP-EARNING-METHOD.
 16009
 16010     IF WS-DEFAULT-APR NOT NUMERIC
 16011         MOVE ZEROS TO WS-DEFAULT-APR.
 16012     IF CP-EARN-AS-NET-PAY
 16013         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16014            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16015                MOVE WS-DEFAULT-APR
 16016                                 TO  CP-LOAN-APR
 16017                MOVE ER-3780     TO  WS-ERROR
 16018                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16019            ELSE
 16020                MOVE ER-3781     TO  WS-ERROR
 16021                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16022     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16023     IF PB-COMPANY-ID = 'DCC'
 16024        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 291
* EL050.cbl
 16025        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16026        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16027     END-IF
 16028     IF PB-COMPANY-ID = 'DCC'
 16029        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16030        AND (CP-EARNING-METHOD = 'D')
 16031        AND (CP-CANCEL-REASON NOT = 'R')
 16032        CONTINUE
 16033     ELSE
 16034        GO TO 3750-CONTINUE
 16035     END-IF
 16036     MOVE ' '                    TO DD-IU-SW
 16037     IF NOT PDEF-MASTER-FOUND
 16038        MOVE ' '                 TO PDEF-MASTER-SW
 16039        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16040        MOVE PB-STATE            TO ERPDEF-STATE
 16041        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16042        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16043        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16044        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16045        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16046        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16047        IF PDEF-MASTER-FOUND
 16048           MOVE 'N'              TO PDEF-MASTER-SW
 16049           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16050           IF PDEF-MASTER-FOUND
 16051              IF (ERPDEF-KEY-SAVE (1:16) =
 16052                           PD-CONTROL-PRIMARY (1:16))
 16053                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16054                 CONTINUE
 16055              ELSE
 16056                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16057                 IF (ERPDEF-KEY-SAVE (1:16) =
 16058                           PD-CONTROL-PRIMARY (1:16))
 16059                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16060                    CONTINUE
 16061                 ELSE
 16062                    MOVE ER-2740 TO WS-ERROR
 16063                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16064                    GO TO 3770-CHECK-REFUNDS
 16065                 END-IF
 16066              END-IF
 16067           END-IF
 16068           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16069        END-IF
 16070     END-IF
 16071     IF PDEF-MASTER-FOUND
 16072        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16073           (V1 > +8)
 16074           OR (PD-PROD-CODE (V1) = 'I')
 16075        END-PERFORM
 16076        IF V1 < +9
 16077           SET DD-IU-PRESENT        TO TRUE
 16078        END-IF
 16079        IF WS-AH-DCC-TRUNC = 'T'
 16080           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16081        ELSE
 16082           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 292
* EL050.cbl
 16083        END-IF
 16084        EVALUATE TRUE
 16085           WHEN WS-TERM > +168
 16086              MOVE 15               TO V1
 16087           WHEN WS-TERM > +156
 16088              MOVE 14               TO V1
 16089           WHEN WS-TERM > +144
 16090              MOVE 13               TO V1
 16091           WHEN WS-TERM > +132
 16092              MOVE 12               TO V1
 16093           WHEN WS-TERM > +120
 16094              MOVE 11               TO V1
 16095           WHEN WS-TERM > +108
 16096              MOVE 10               TO V1
 16097           WHEN WS-TERM > +96
 16098              MOVE 9                TO V1
 16099           WHEN WS-TERM > +84
 16100              MOVE 8                TO V1
 16101           WHEN WS-TERM > +72
 16102              MOVE 7                TO V1
 16103           WHEN WS-TERM > +60
 16104              MOVE 6                TO V1
 16105           WHEN WS-TERM > +48
 16106              MOVE 5                TO V1
 16107           WHEN WS-TERM > +36
 16108              MOVE 4                TO V1
 16109           WHEN WS-TERM > +24
 16110              MOVE 3                TO V1
 16111           WHEN WS-TERM > +12
 16112              MOVE 2                TO V1
 16113           WHEN OTHER
 16114              MOVE 1                TO V1
 16115        END-EVALUATE
 16116
 16117        EVALUATE TRUE
 16118*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16119*             < +13)
 16120*             AND (DD-IU-PRESENT)
 16121*             MOVE 2                TO V2
 16122*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16123*             MOVE 1                TO V2
 16124           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16125              MOVE 2                TO V2
 16126           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16127              MOVE 3                TO V2
 16128           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16129              MOVE 4                TO V2
 16130           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16131              MOVE 5                TO V2
 16132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16133              MOVE 6                TO V2
 16134           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16135              MOVE 7                TO V2
 16136           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16137              MOVE 8                TO V2
 16138           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16139              MOVE 9                TO V2
 16140           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 293
* EL050.cbl
 16141              MOVE 10               TO V2
 16142           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16143              MOVE 11               TO V2
 16144           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16145              MOVE 12               TO V2
 16146           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16147              MOVE 13               TO V2
 16148           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16149              MOVE 14               TO V2
 16150           WHEN OTHER
 16151              MOVE 15               TO V2
 16152        END-EVALUATE
 16153
 16154        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16155                                 TO CP-DDF-LO-FACT
 16156        MOVE PD-UEP-FACTOR (V1 V2)
 16157                                 TO CP-DDF-HI-FACT
 16158
 16159        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16160        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16161        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16162           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16163        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16164        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16165        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16166           + PD-1ST-YR-ADMIN-ALLOW
 16167
 16168        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16169*       IF PI-CLP-YN = 'Y'
 16170*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16171*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16172*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16173*       END-IF
 16174
 16175        IF DD-IU-PRESENT
 16176           MOVE 'I'              TO CP-EARNING-METHOD
 16177        END-IF
 16178        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16179                                     CP-CLP-RATE-UP
 16180        IF CP-IU-RATE-UP NOT = ZEROS
 16181           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16182              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16183           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16184              / (1 - WS-WORK-FACT)
 16185        END-IF
 16186     END-IF
 16187     .
 16188 3750-CONTINUE.
 16189     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16190
 16191     IF CP-REFUND-TYPE-USED NOT = SPACE
 16192         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16193
 16194     IF CP-ERROR-RATE-IS-ZERO OR
 16195        CP-ERROR-RATE-NOT-FOUND
 16196        MOVE ER-2740             TO WS-ERROR
 16197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16198
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 294
* EL050.cbl
 16199     IF CP-ERROR-RATE-FILE-NOTOPEN
 16200        MOVE ER-2617             TO WS-ERROR
 16201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16202     IF PB-COMPANY-ID = 'DCC'
 16203        AND PB-CI-ENTRY-STATUS = 'M'
 16204        MOVE +0                  TO PB-C-AH-REF-CALC
 16205     ELSE
 16206        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16207     END-IF
 16208     IF PB-COMPANY-ID = 'DCC'
 16209        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16210        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16211        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16212        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16213        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16214        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16215        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16216        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16217        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16218     END-IF
 16219     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 295
* EL050.cbl
 16221
 16222 3770-CHECK-REFUNDS.
 16223
 16224     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16225        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16226           MOVE ER-2766          TO WS-ERROR
 16227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16229           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16230              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16231
 16232     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16233        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16234           MOVE ER-2766          TO WS-ERROR
 16235           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16236           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16237           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16238              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16239
 16240     IF PB-COMP-LF-CANCEL
 16241        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16242        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16243           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16244              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16245
 16246     IF PB-COMP-AH-CANCEL
 16247        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16248        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16249           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16250              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16251
 16252     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16253             GIVING WS-UNSIGN-WRK1
 16254     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16255             GIVING WS-UNSIGN-WRK2.
 16256
 16257     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16258         MOVE ZERO TO WS-UNSIGN-WRK1.
 16259
 16260     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16261         MOVE ZERO TO WS-UNSIGN-WRK2.
 16262
 16263     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16264
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 296
* EL050.cbl
 16266
 16267 3772-CONTINUE.
 16268
 16269**********************************
 16270*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16271*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16272*** DOUBLES THE TOLERANCE AMOUNT.
 16273***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16274**********************************
 16275     IF PB-COMPANY-ID = 'MON'
 16276     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16277         IF WS-REF-REJECT-SW = SPACE
 16278             MOVE ER-2754        TO WS-ERROR
 16279             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16280           ELSE
 16281             MOVE ER-2736        TO WS-ERROR
 16282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16283**********************************
 16284
 16285 3773-CONTINUE.
 16286
 16287     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16288        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16289           MOVE ER-2723          TO WS-ERROR
 16290           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16291
 16292     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16293        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16294           MOVE ER-2724          TO WS-ERROR
 16295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16296
 16297     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16298         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16299             (1 + WS-LF-REFUND-OVS-PCT)
 16300     ELSE
 16301         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16302
 16303     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16304         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16305             (1 - WS-TOL-LF-REFUND-PCT)
 16306     ELSE
 16307         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16308
 16309     IF (PB-COMPANY-ID = 'DCC')
 16310        AND (PB-CI-ENTRY-STATUS = 'M')
 16311        AND (PB-C-LF-CANCEL-AMT > +0)
 16312        MOVE ER-3843             TO WS-ERROR
 16313        PERFORM 9900-ERROR-FORMAT
 16314                                 THRU 9900-EXIT
 16315     END-IF
 16316     EVALUATE TRUE
 16317        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16318           CONTINUE
 16319        WHEN PB-C-LF-CANCEL-AMT = +0
 16320                 AND PB-C-LF-REF-CALC > +0
 16321           CONTINUE
 16322        WHEN WS-LF-REFUND-OVS-AMT = 0
 16323                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 297
* EL050.cbl
 16324           CONTINUE
 16325        WHEN OTHER
 16326           IF WS-TOL-LF-REFUND  = +0
 16327              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16328           END-IF
 16329           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16330                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16331                          (PB-C-LF-CANCEL-AMT))
 16332              CONTINUE
 16333           ELSE
 16334              IF WS-LF-REFUND-OVS-AMT = +0
 16335                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16336              END-IF
 16337              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16338                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16339                                       PB-C-LF-CANCEL-AMT)
 16340                 CONTINUE
 16341              ELSE
 16342                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16343                   MOVE ER-2754   TO  WS-ERROR
 16344                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16345                 ELSE
 16346                    MOVE ER-2736   TO  WS-ERROR
 16347                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16348                 END-IF
 16349              END-IF
 16350           END-IF
 16351     END-EVALUATE.
 16352
 16353     EVALUATE TRUE
 16354        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16355           CONTINUE
 16356        WHEN PB-C-LF-CANCEL-AMT = +0
 16357                 AND PB-C-LF-REF-CALC > +0
 16358           CONTINUE
 16359        WHEN OTHER
 16360           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16361               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16362              CONTINUE
 16363           ELSE
 16364              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16365               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16366                CONTINUE
 16367              ELSE
 16368                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16369                     MOVE ER-2754   TO  WS-ERROR
 16370                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16371                 ELSE
 16372                     MOVE ER-2736   TO  WS-ERROR
 16373                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16374                 END-IF
 16375              END-IF
 16376           END-IF
 16377     END-EVALUATE.
 16378
 16379     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16380         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16381             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 298
* EL050.cbl
 16382     ELSE
 16383         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16384
 16385     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16386         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16387             (1 - WS-TOL-AH-REFUND-PCT)
 16388     ELSE
 16389         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16390
 16391     IF (PB-COMPANY-ID = 'DCC')
 16392        AND (PB-CI-ENTRY-STATUS = 'M')
 16393        AND (PB-C-AH-CANCEL-AMT > +0)
 16394        MOVE ER-3843             TO WS-ERROR
 16395        PERFORM 9900-ERROR-FORMAT
 16396                                 THRU 9900-EXIT
 16397     END-IF
 16398     EVALUATE TRUE
 16399        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16400           CONTINUE
 16401*       WHEN PB-C-AH-REF-CALC = +0 AND
 16402*                  PB-C-AH-CANCEL-AMT > +0
 16403        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16404                   PB-C-AH-REF-CALC > +0
 16405           CONTINUE
 16406        WHEN WS-AH-REFUND-OVS-AMT = +0
 16407                AND WS-TOL-AH-REFUND = +0
 16408           CONTINUE
 16409        WHEN OTHER
 16410           IF WS-TOL-AH-REFUND = +0
 16411              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16412           END-IF
 16413           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16414               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16415                                         PB-C-AH-CANCEL-AMT)
 16416              CONTINUE
 16417           ELSE
 16418              IF WS-AH-REFUND-OVS-AMT = +0
 16419                 MOVE +9999999.99 TO
 16420                         WS-AH-REFUND-OVS-AMT
 16421              END-IF
 16422              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16423                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16424                                         PB-C-AH-CANCEL-AMT)
 16425                 CONTINUE
 16426              ELSE
 16427                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16428                    MOVE ER-2754   TO  WS-ERROR
 16429                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16430                 ELSE
 16431                    MOVE ER-2736   TO  WS-ERROR
 16432                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16433                 END-IF
 16434              END-IF
 16435           END-IF
 16436     END-EVALUATE.
 16437
 16438     EVALUATE TRUE
 16439        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 299
* EL050.cbl
 16440           CONTINUE
 16441*       WHEN PB-C-AH-REF-CALC > +0 AND
 16442*                  PB-C-AH-CANCEL-AMT = +0
 16443        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16444                   PB-C-AH-REF-CALC = +0
 16445           CONTINUE
 16446        WHEN OTHER
 16447           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16448               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16449              CONTINUE
 16450           ELSE
 16451              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16452                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16453                 CONTINUE
 16454              ELSE
 16455                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16456                     MOVE ER-2754   TO  WS-ERROR
 16457                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16458                 ELSE
 16459                     MOVE ER-2736   TO  WS-ERROR
 16460                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16461                 END-IF
 16462              END-IF
 16463           END-IF
 16464     END-EVALUATE.
 16465
 16466     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16467        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16468        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16469           AND  PB-C-LF-REF-CALC < +1.00
 16470           AND  PB-C-AH-REF-CALC < +1.00
 16471           CONTINUE
 16472        ELSE
 16473           IF (PB-COMPANY-ID = 'DCC')
 16474              AND (PB-CI-ENTRY-STATUS = 'M')
 16475              CONTINUE
 16476           ELSE
 16477              MOVE ER-2741       TO WS-ERROR
 16478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16479           END-IF
 16480        END-IF
 16481     END-IF
 16482
 16483     IF (PB-C-LF-CANCEL-AMT = ZERO
 16484        AND WS-LF-BENEFIT-CD NOT = ZERO
 16485        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16486        AND PB-C-LF-REF-CALC NOT = ZERO)
 16487        OR
 16488        (PB-C-LF-CANCEL-AMT = ZERO
 16489        AND WS-LF-BENEFIT-CD NOT = ZERO
 16490        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16491             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16492                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16493                NEXT SENTENCE
 16494             ELSE
 16495                MOVE ER-2739        TO WS-ERROR
 16496                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16497
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 300
* EL050.cbl
 16498     IF (PB-C-AH-CANCEL-AMT = ZERO
 16499        AND WS-AH-BENEFIT-CD NOT = ZERO
 16500        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16501        AND PB-C-AH-REF-CALC NOT = ZERO)
 16502        OR
 16503        (PB-C-AH-CANCEL-AMT = ZERO
 16504        AND WS-AH-BENEFIT-CD NOT = ZERO
 16505        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16506             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16507                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16508                NEXT SENTENCE
 16509             ELSE
 16510                MOVE ER-2738        TO WS-ERROR
 16511                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16512
 16513 3775-OVER-REF-CHK.
 16514
 16515     IF PB-CI-ENTRY-STATUS = '5'
 16516        GO TO 3780-UPDATE-CANCEL-CERT.
 16517
 16518     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16519                              PB-CI-LF-ALT-PREMIUM-AMT.
 16520
 16521     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16522        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16523                                 PB-C-LF-REF-CALC
 16524      ELSE
 16525        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16526                                 PB-C-LF-CANCEL-AMT.
 16527
 16528     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16529        MOVE ER-2755             TO WS-ERROR
 16530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16531
 16532     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16533
 16534     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16535        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16536                                 PB-C-AH-REF-CALC
 16537      ELSE
 16538        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16539                                 PB-C-AH-CANCEL-AMT.
 16540
 16541     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16542        MOVE ER-2778             TO WS-ERROR
 16543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16544
 16545     IF PB-CI-OB-FLAG NOT = 'Z'
 16546        NEXT SENTENCE
 16547       ELSE
 16548         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16549            MOVE ER-2757           TO WS-ERROR
 16550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16551
 16552 3780-UPDATE-CANCEL-CERT.
 16553
 16554     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16555        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 301
* EL050.cbl
 16556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16557
 16558     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16559         MOVE ER-2729              TO WS-ERROR
 16560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16561
 16562     IF PB-CI-LF-BENEFIT-CD = ZERO
 16563         GO TO 3780-UPDATE-CONT-1.
 16564
 16565     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16566         GO TO 3780-UPDATE-CONT-1.
 16567
 16568     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16569       AND
 16570        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16571       AND
 16572        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16573       AND
 16574        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16575            NEXT SENTENCE
 16576       ELSE
 16577        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16578          AND
 16579***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16580***       AND
 16581           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16582            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16583               MOVE ER-2730      TO WS-ERROR
 16584               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16585               GO TO 3999-END-EDIT
 16586            ELSE
 16587               GO TO 3999-END-EDIT
 16588        ELSE
 16589            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16590               MOVE ER-2765           TO WS-ERROR
 16591               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16592               GO TO 3785-CHECK-NH.
 16593*              GO TO 3999-END-EDIT.
 16594
 16595 3780-UPDATE-CONT-1.
 16596     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16597
 16598     IF PB-CI-AH-BENEFIT-CD = ZERO
 16599         GO TO 3780-UPDATE-CONT-2.
 16600
 16601     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16602         GO TO 3780-UPDATE-CONT-2.
 16603
 16604     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16605
 16606     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16607       AND
 16608        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16609       AND
 16610        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16611       AND
 16612        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16613            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 302
* EL050.cbl
 16614       ELSE
 16615        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16616          AND
 16617***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16618***       AND
 16619           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16620           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16621            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16622               MOVE ER-2773      TO WS-ERROR
 16623               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16624               GO TO 3999-END-EDIT
 16625            ELSE
 16626               GO TO 3999-END-EDIT
 16627            END-IF
 16628           ELSE
 16629             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16630                MOVE ER-2890 TO WS-ERROR
 16631                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16632                GO TO 3999-END-EDIT
 16633             ELSE
 16634                GO TO 3785-CHECK-NH
 16635             END-IF
 16636           END-IF
 16637          ELSE
 16638            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16639              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16640                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16641                   MOVE ER-2890 TO WS-ERROR
 16642                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16643                   GO TO 3999-END-EDIT
 16644                ELSE
 16645                   MOVE ER-2765 TO WS-ERROR
 16646                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647                   GO TO 3785-CHECK-NH
 16648                END-IF
 16649              ELSE
 16650               MOVE ER-2765      TO WS-ERROR
 16651               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16652               GO TO 3785-CHECK-NH.
 16653*              GO TO 3999-END-EDIT.
 16654
 16655 3780-UPDATE-CONT-2.
 16656
 16657     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16658        AND WS-LF-BENEFIT-CD = ZERO
 16659           MOVE ER-2743           TO WS-ERROR
 16660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16661
 16662     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16663        AND WS-AH-BENEFIT-CD = ZERO
 16664           MOVE ER-2744           TO WS-ERROR
 16665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666
 16667     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16668        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16669        AND
 16670        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16671         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 303
* EL050.cbl
 16672           MOVE ER-2746           TO WS-ERROR
 16673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16674
 16675     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16676       AND
 16677        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16678             MOVE ER-2737        TO WS-ERROR
 16679             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16680
 16681     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16682       AND
 16683        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16684             MOVE ER-2737        TO WS-ERROR
 16685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16686
 16687     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16688         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16689             OR 'CID' OR 'DCC' OR 'AHL'
 16690             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16691         ELSE
 16692             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16693                 MOVE ER-2768    TO WS-ERROR
 16694                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16695             ELSE
 16696                 MOVE ER-2756    TO WS-ERROR
 16697                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16698
 16699     IF CERT-PEND-ISSUE-RETURNED
 16700        MOVE ER-2772             TO WS-ERROR
 16701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16702 3785-CHECK-NH.
 16703     IF PB-STATE NOT = 'NH'
 16704        GO TO 3999-END-EDIT
 16705     END-IF
 16706
 16707     MOVE ER-2796                TO WS-ERROR
 16708     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16709     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16710        OR (CM-NH-INTERFACE-SW = 'Y')
 16711        MOVE ER-2793             TO WS-ERROR
 16712        PERFORM 9900-ERROR-FORMAT
 16713                                 THRU 9900-EXIT
 16714     END-IF
 16715     MOVE +0                     TO WS-PAYMENT-AMT
 16716     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16717        GO TO 3999-END-EDIT
 16718     END-IF
 16719     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16720        GO TO 3999-END-EDIT
 16721     END-IF
 16722     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16723     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16724     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16725        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16726     END-IF
 16727     MOVE '1'                    TO DC-OPTION-CODE
 16728     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16729     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 304
* EL050.cbl
 16730        IF DC-ELAPSED-DAYS < +16
 16731           GO TO 3999-END-EDIT
 16732        END-IF
 16733     END-IF
 16734     MOVE +0                     TO DC-ELAPSED-DAYS
 16735     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16736     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16737     MOVE '1'                    TO DC-OPTION-CODE
 16738     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16739     IF NO-CONVERSION-ERROR
 16740        IF DC-ELAPSED-DAYS > +30
 16741           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16742        ELSE
 16743           GO TO 3999-END-EDIT
 16744        END-IF
 16745     ELSE
 16746        GO TO 3999-END-EDIT
 16747     END-IF
 16748     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16749        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16750           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16751     IF WS-PAYMENT-AMT < 600.00
 16752        GO TO 3999-END-EDIT
 16753     END-IF
 16754     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16755
 16756     IF (ERMAIL-FOUND = ' ')
 16757         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16758         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16759        GO TO 3999-END-EDIT
 16760     END-IF
 16761     MOVE ER-2795                TO WS-ERROR
 16762     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16763
 16764     GO TO 3999-END-EDIT.
 16765******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 305
* EL050.cbl
 16767 3990-FILES-NOT-OPEN.
 16768
 16769     MOVE ER-2617                TO WS-ERROR.
 16770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16771     GO TO 9990-RETURN.
 16772
 16773 3999-END-EDIT.
 16774
 16775     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16776
 16777     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16778         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16779         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16780             PERFORM 9250-UNLOCK-RETURN
 16781             GO TO 9990-RETURN
 16782          ELSE
 16783             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16784             GO TO 9990-RETURN.
 16785
 16786     IF PB-CANCELLATION
 16787          GO TO 9990-RETURN.
 16788
 16789     IF CERT-WAS-NOT-FOUND
 16790        MOVE SPACES              TO CERTIFICATE-MASTER.
 16791
 16792     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16793
 16794     IF CERT-WAS-FOUND
 16795         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16796             PERFORM 9250-UNLOCK-RETURN
 16797          ELSE
 16798            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16799      ELSE
 16800         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16801
 16802     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16803        IF PB-COMPANY-ID = 'DCC' AND
 16804           (PB-CARRIER = '2' OR '4' OR '6')
 16805              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16806        END-IF
 16807     END-IF.
 16808
 16809     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16810         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16811     END-IF.
 16812
 16813     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16814     IF ((PB-COMPANY-ID = 'DCC')
 16815        AND (WS-NO-SECURE-PAY))
 16816                  OR
 16817        (WS-LF-SPECIAL-CALC-CD = 'O'
 16818        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16819        SET SKIP-ADDR-EDIT       TO TRUE
 16820     END-IF
 16821     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16822        AND (NOT SKIP-ADDR-EDIT)
 16823        MOVE ER-2963             TO WS-ERROR
 16824        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 306
* EL050.cbl
 16825                                 THRU 9900-EXIT
 16826        GO TO 9990-RETURN
 16827     END-IF
 16828     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16829     IF ERPNDM-FOUND NOT = 'X'
 16830        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16831           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16832           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16833           AND (NOT SKIP-ADDR-EDIT)
 16834           MOVE ER-2694          TO WS-ERROR
 16835           PERFORM 9900-ERROR-FORMAT
 16836                                 THRU 9900-EXIT
 16837        END-IF
 16838        MOVE ' '                 TO STATE-RECORD-ERROR
 16839        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16840        MOVE PM-STATE            TO CNTL-ACCESS
 16841        MOVE '3'                 TO CNTL-REC-TYPE
 16842        MOVE +0                  TO CNTL-SEQ-NO
 16843        MOVE '0'                 TO RC-SW-2
 16844        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16845        IF (NO-STATE-RECORD)
 16846           OR (CF-RECORD-TYPE NOT = '3')
 16847           OR (PM-STATE NOT = CF-STATE-CODE)
 16848           IF (PM-STATE = SPACES)
 16849              AND (SKIP-ADDR-EDIT)
 16850              CONTINUE
 16851           ELSE
 16852              MOVE ER-2963       TO WS-ERROR
 16853              PERFORM 9900-ERROR-FORMAT
 16854                                 THRU 9900-EXIT
 16855           END-IF
 16856        END-IF
 16857        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16858           MOVE ER-2883          TO WS-ERROR
 16859           PERFORM 9900-ERROR-FORMAT
 16860                                 THRU 9900-EXIT
 16861        END-IF
 16862        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16863           MOVE ' '                 TO STATE-RECORD-ERROR
 16864           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16865           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16866           MOVE '3'                 TO CNTL-REC-TYPE
 16867           MOVE +0                  TO CNTL-SEQ-NO
 16868           MOVE '0'                 TO RC-SW-2
 16869           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16870           IF NO-STATE-RECORD
 16871              OR (CF-RECORD-TYPE NOT = '3')
 16872              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16873              MOVE ER-2964          TO WS-ERROR
 16874              PERFORM 9900-ERROR-FORMAT
 16875                                    THRU 9900-EXIT
 16876           END-IF
 16877        END-IF
 16878     ELSE
 16879        IF NOT SKIP-ADDR-EDIT
 16880           MOVE ER-2393          TO WS-ERROR
 16881           PERFORM 9900-ERROR-FORMAT
 16882                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 307
* EL050.cbl
 16883        END-IF
 16884     END-IF
 16885
 16886     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16887
 16888     IF (ERMAIL-FOUND = ' ' AND
 16889        ERPNDM-FOUND = ' ')
 16890        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16891           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16892           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16893          OR
 16894           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16895          OR
 16896           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16897           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16898           GO TO 3999-UNLOCK-ERMAIL.
 16899
 16900     IF ERPNDM-FOUND = 'X'
 16901        GO TO 3999-UNLOCK-ERMAIL.
 16902
 16903     IF PM-INSURED-LAST-NAME      = SPACES
 16904        AND PM-INSURED-FIRST-NAME = SPACES
 16905        AND PM-ADDRESS-LINE-1     = SPACES
 16906        AND PM-ADDRESS-LINE-2     = SPACES
 16907        AND PM-CITY-STATE         = SPACES
 16908        AND PM-CRED-BENE-NAME     = SPACES
 16909        AND PM-CRED-BENE-ADDR     = SPACES
 16910        AND PM-CRED-BENE-CTYST    = SPACES
 16911        GO TO 3999-UNLOCK-ERMAIL
 16912     END-IF
 16913
 16914     MOVE SPACES                 TO MAILING-DATA.
 16915
 16916     MOVE 'MA'                   TO MA-RECORD-ID.
 16917     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16918     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16919     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16920     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16921     MOVE PB-SV-STATE            TO MA-STATE.
 16922     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16923     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16924
 16925     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16926     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16927
 16928     IF ERMAIL-FOUND = ' '
 16929        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16930     ELSE
 16931        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16932        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16933        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16934
 16935     GO TO 9990-RETURN.
 16936
 16937 3999-UNLOCK-ERMAIL.
 16938     IF ERMAIL-FOUND = ' '
 16939        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16940
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 308
* EL050.cbl
 16941     GO TO 9990-RETURN.
 16942******************************************************************
 16943
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 309
* EL050.cbl
 16945 4000-UPDATE-CANCELLED-CERT.
 16946     IF CERT-WAS-NOT-FOUND
 16947        GO TO 4299-EXIT.
 16948
 16949*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16950     IF PB-C-NH-INT-ON-REFS > ZEROS
 16951        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16952     END-IF
 16953     IF PB-C-REF-INTERFACE-SW = 'Y'
 16954        MOVE PB-C-REF-INTERFACE-SW
 16955                                 TO CM-NH-INTERFACE-SW
 16956     END-IF
 16957     IF PB-C-POST-CARD-IND = 'Y'
 16958        MOVE +8                  TO SUB
 16959        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16960        IF ERMAIL-FOUND = ' '
 16961           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16962              (SUB > +7)
 16963              OR (MA-MAIL-STATUS (SUB) = '1')
 16964           END-PERFORM
 16965        END-IF
 16966        IF (SUB > +7)
 16967           OR (ERMAIL-FOUND = 'X')
 16968           MOVE ER-3789          TO WS-ERROR
 16969           PERFORM 9900-ERROR-FORMAT
 16970                                 THRU 9900-EXIT
 16971        END-IF
 16972     ELSE
 16973        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16974     END-IF
 16975     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16976
 16977     IF PB-CI-OB-FLAG = 'Z'
 16978        GO TO 4150-SUMMARY-CERT-CANCEL.
 16979
 16980     IF PB-C-LF-CANCEL-VOIDED
 16981         PERFORM 4200-REVERSE-LF-CANCEL.
 16982     IF PB-C-AH-CANCEL-VOIDED
 16983         PERFORM 4200-REVERSE-AH-CANCEL.
 16984
 16985 4100-APPLY-LF-CANCEL.
 16986
 16987     MOVE +0                     TO WS-SUB.
 16988
 16989 4100-CHECK-LF-ERRORS.
 16990
 16991     ADD +1                       TO WS-SUB.
 16992
 16993     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16994        IF LF-COVERAGE-CANCELLED
 16995           GO TO 4100-LF-CANCEL-CONT
 16996        ELSE
 16997           GO TO 4100-UPDATE-LF-COVERAGE.
 16998
 16999     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17000                                   ER-2729 OR
 17001                                   ER-2730 OR
 17002                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 310
* EL050.cbl
 17003                                   ER-2732 OR
 17004                                   ER-2737 OR
 17005                                   ER-2740 OR
 17006                                   ER-2743 OR
 17007                                   ER-2749 OR
 17008                                   ER-2750 OR
 17009                                   ER-2755 OR
 17010                                   ER-2757 OR
 17011                                   ER-2760 OR
 17012                                   ER-2772 OR
 17013                                   ER-2774 OR
 17014                                   ER-2776 OR
 17015                                   ER-2794
 17016        GO TO 4100-UPDATE-LF-COVERAGE.
 17017
 17018     GO TO 4100-CHECK-LF-ERRORS.
 17019
 17020 4100-UPDATE-LF-COVERAGE.
 17021
 17022     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17023     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17024     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17025        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17026     END-IF
 17027     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17028                                      TO CM-CREDIT-INTERFACE-SW-2.
 17029     IF CM-LF-CANCEL-DT = LOW-VALUE
 17030         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17031
 17032     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17033         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17034                                         CM-LF-STATUS-AT-CANCEL.
 17035
 17036     GO TO 4100-APPLY-AH-CANCEL.
 17037
 17038 4100-LF-CANCEL-CONT.
 17039     IF PB-C-LF-CANCEL-VOIDED
 17040         GO TO 4100-APPLY-AH-CANCEL.
 17041
 17042     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17043         GO TO 4100-APPLY-AH-CANCEL.
 17044
 17045     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17046        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17047           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17048        ELSE
 17049           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17050
 17051     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17052     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17053
 17054     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17055         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17056
 17057     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17058        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17059         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17060         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 311
* EL050.cbl
 17061
 17062     IF PB-RECORD-RETURNED
 17063        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17064      ELSE
 17065        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17066
 17067 4100-APPLY-AH-CANCEL.
 17068
 17069     MOVE +0                      TO WS-SUB.
 17070
 17071 4100-CHECK-AH-ERRORS.
 17072
 17073     ADD +1                       TO WS-SUB.
 17074
 17075     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17076        IF AH-COVERAGE-CANCELLED
 17077           GO TO 4100-AH-CANCEL-CONT
 17078        ELSE
 17079           GO TO 4100-UPDATE-AH-COVERAGE.
 17080
 17081     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17082                                   ER-2729 OR
 17083                                   ER-2732 OR
 17084                                   ER-2737 OR
 17085                                   ER-2740 OR
 17086                                   ER-2744 OR
 17087                                   ER-2749 OR
 17088                                   ER-2750 OR
 17089                                   ER-2755 OR
 17090                                   ER-2757 OR
 17091                                   ER-2760 OR
 17092                                   ER-2771 OR
 17093                                   ER-2772 OR
 17094                                   ER-2773 OR
 17095                                   ER-2775 OR
 17096                                   ER-2777 OR
 17097                                   ER-2794
 17098        GO TO 4100-UPDATE-AH-COVERAGE.
 17099
 17100     GO TO 4100-CHECK-AH-ERRORS.
 17101
 17102 4100-UPDATE-AH-COVERAGE.
 17103
 17104     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17105     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17106     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17107     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17108                                      TO CM-CREDIT-INTERFACE-SW-2.
 17109     IF CM-AH-CANCEL-DT = LOW-VALUE
 17110         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17111
 17112     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17113         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17114                                         CM-AH-STATUS-AT-CANCEL.
 17115
 17116     IF LF-COVERAGE-CANCELLED
 17117         IF PB-RECORD-RETURNED
 17118              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 312
* EL050.cbl
 17119          ELSE
 17120              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17121
 17122     GO TO 4299-EXIT.
 17123
 17124 4100-AH-CANCEL-CONT.
 17125     IF PB-C-AH-CANCEL-VOIDED
 17126         GO TO 4299-EXIT.
 17127
 17128     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17129         GO TO 4299-EXIT.
 17130
 17131     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17132        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17133           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17134        ELSE
 17135           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17136
 17137     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17138     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17139
 17140     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17141         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17142
 17143     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17144         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17145         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17146
 17147     IF PB-RECORD-RETURNED
 17148        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17149      ELSE
 17150        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17151
 17152     GO TO 4299-EXIT.
 17153
 17154 4150-SUMMARY-CERT-CANCEL.
 17155     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17156
 17157     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17158        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17159                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17160     ELSE
 17161        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17162                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17163
 17164     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17165        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17166                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17167     ELSE
 17168        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17169                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17170
 17171     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17172        NEXT SENTENCE
 17173     ELSE
 17174        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17175
 17176     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 313
* EL050.cbl
 17177
 17178 4200-REVERSE-LF-CANCEL.
 17179     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17180
 17181     IF CM-LF-CANCEL-APPLIED
 17182        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17183        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17184        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17185
 17186     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17187
 17188     IF PB-RECORD-RETURNED
 17189        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17190       ELSE
 17191        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17192
 17193 4200-REVERSE-LF-EXIT.
 17194       EXIT.
 17195
 17196 4200-REVERSE-AH-CANCEL.
 17197     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17198
 17199     IF CM-AH-CANCEL-APPLIED
 17200        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17201        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17202        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17203
 17204     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17205
 17206     IF PB-RECORD-RETURNED
 17207        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17208       ELSE
 17209        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17210
 17211 4200-REVERSE-AH-EXIT.
 17212       EXIT.
 17213
 17214 4299-EXIT.
 17215       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 314
* EL050.cbl
 17217
 17218 4500-UPDATE-NEW-CERT.
 17219     IF CERT-WAS-FOUND
 17220         NEXT SENTENCE
 17221       ELSE
 17222         GO TO 4520-BUILD-NEW-KEY.
 17223
 17224     IF  CLASIC-CREATED-CERT
 17225         GO TO 4999-EXIT.
 17226
 17227     IF  CERT-WAS-CREATED-FOR-CLAIM
 17228         GO TO 4520-BUILD-NEW-KEY.
 17229
 17230     IF CERT-ADDED-BATCH
 17231        IF CM-RECORD-ID = 'CM'
 17232            GO TO 4999-EXIT.
 17233
 17234 4520-BUILD-NEW-KEY.
 17235* BUILD CONTROL PRIMARY
 17236
 17237     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17238                                       CM-COMPANY-CD-A1
 17239                                       CM-COMPANY-CD-A2
 17240                                       CM-COMPANY-CD-A4
 17241                                       CM-COMPANY-CD-A5.
 17242
 17243     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17244     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17245     MOVE PB-SV-STATE               TO CM-STATE.
 17246     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17247     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17248     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17249     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17250
 17251     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17252
 17253     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17254     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17255     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17256     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17257
 17258     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17259        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17260
 17261     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17262         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17263         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17264         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17265         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17266     ELSE
 17267         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17268
 17269     IF PB-COMPANY-ID   EQUAL  'CRI'
 17270         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17271         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17272         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17273         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17274         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 315
* EL050.cbl
 17275
 17276     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17277        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17278         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17279
 17280     IF PB-COMPANY-ID  = 'LBL'
 17281        IF PB-I-JOINT-COVERAGE
 17282            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17283                                           PB-I-MEMBER-NO
 17284            GO TO 4550-CONT-CERT-PROCESS.
 17285
 17286     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17287        NEXT SENTENCE
 17288     ELSE
 17289        GO TO 4540-BUILD-MEMBER-NO.
 17290
 17291******************************************************************
 17292*                                                                *
 17293*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17294*    FOR 'MON'.                                                  *
 17295*                                                                *
 17296******************************************************************
 17297
 17298     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17299     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17300     MOVE +1                     TO WS-SUB1
 17301                                    WS-SUB2.
 17302
 17303 4530-EDIT-MEMB-NAME.
 17304
 17305     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17306        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17307        ADD +1                       TO WS-SUB2.
 17308
 17309     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17310        ADD +1                       TO WS-SUB1
 17311        GO TO 4530-EDIT-MEMB-NAME.
 17312
 17313     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17314     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17315     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17316*    MOVE SPACE                      TO DC-OPTION-CODE.
 17317     SET  BIN-TO-GREG                TO TRUE.
 17318     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17319     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17320
 17321     GO TO 4550-CONT-CERT-PROCESS.
 17322
 17323******************************************************************
 17324*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17325******************************************************************
 17326
 17327 4540-BUILD-MEMBER-NO.
 17328
 17329     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17330         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17331         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17332         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 316
* EL050.cbl
 17333         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17334     ELSE
 17335         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17336
 17337     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17338        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17339         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17340
 17341 4550-CONT-CERT-PROCESS.
 17342
 17343*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17344*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17345*    ELSE
 17346*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17347
 17348     IF CERT-WAS-CREATED-FOR-CLAIM
 17349        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17350        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17351
 17352     IF CERT-AND-CLAIM-ONLINE
 17353        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17354        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17355
 17356     MOVE 'CM'                     TO CM-RECORD-ID.
 17357     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17358
 17359     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17360        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17361        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17362     ELSE
 17363        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17364        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17365
 17366     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17367     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17368     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17369     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17370     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17371     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17372     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17373                                      CM-LF-ITD-CANCEL-AMT
 17374                                      CM-LF-ITD-DEATH-AMT
 17375                                      CM-AH-ITD-AH-PMT
 17376                                      CM-AH-ITD-LUMP-PMT
 17377                                      CM-AH-ITD-CANCEL-AMT
 17378                                      CM-LF-NSP-PREMIUM-AMT
 17379                                      CM-AH-NSP-PREMIUM-AMT.
 17380*                                     CM-CLAIM-DEDUCT-WITHHELD
 17381*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17382     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17383     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17384     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17385     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17386     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17387     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17388     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17389     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17390     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 317
* EL050.cbl
 17391     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17392     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17393     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17394
 17395     IF PB-I-LIVES NOT NUMERIC
 17396         MOVE ZERO                 TO PB-I-LIVES.
 17397
 17398     IF PB-I-NUM-BILLED NOT NUMERIC
 17399         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17400
 17401     MOVE PB-I-LIVES               TO CM-LIVES.
 17402     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17403
 17404     IF PB-COMPANY-ID EQUAL  'DMD'
 17405         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17406         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17407
 17408     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17409     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17410     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17411     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17412     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17413     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17414
 17415     IF PB-I-LF-POLICY-FEE NUMERIC
 17416        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17417     ELSE
 17418        MOVE +0                    TO CM-LF-POLICY-FEE.
 17419
 17420     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17421        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17422        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17423     ELSE
 17424        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17425
 17426     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17427     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17428     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17429     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17430     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17431     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17432     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17433     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17434     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17435
 17436     IF PB-I-AH-POLICY-FEE NUMERIC
 17437        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17438     ELSE
 17439        MOVE +0                    TO CM-AH-POLICY-FEE.
 17440
 17441     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17442        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17443     ELSE
 17444        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17445
 17446     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17447     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17448
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 318
* EL050.cbl
 17449     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17450                                      CM-LF-DEATH-EXIT-DT
 17451                                      CM-AH-SETTLEMENT-EXIT-DT.
 17452
 17453*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17454*                       'TIH' OR 'OFL' OR 'FLA' OR
 17455*                       'TII' OR 'TMS' OR 'CRI' OR
 17456*                       'NCL'
 17457     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17458
 17459     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17460         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17461            MOVE '2'                TO CM-PREMIUM-TYPE.
 17462
 17463     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17464         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17465            MOVE '2'                TO CM-PREMIUM-TYPE.
 17466
 17467     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17468         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17469     ELSE
 17470         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17471         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17472
 17473     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17474     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17475     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17476     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17477     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17478     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17479     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17480     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17481
 17482     IF PB-NO-MONTHS-SKIPPED
 17483         MOVE SPACE                 TO CM-SKIP-CODE
 17484     ELSE
 17485         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17486
 17487     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17488     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17489                                       CM-LF-STATUS-AT-CANCEL.
 17490
 17491     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17492     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17493                                       CM-AH-STATUS-AT-CANCEL.
 17494
 17495     MOVE '1'                       TO CM-ENTRY-STATUS.
 17496
 17497     IF PB-REISSUED-CERT
 17498        MOVE '5'                    TO CM-ENTRY-STATUS.
 17499
 17500     IF PB-MONTHLY-CERT
 17501        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17502
 17503     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17504     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17505     IF PB-POLICY-IS-DECLINED
 17506        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 319
* EL050.cbl
 17507
 17508     IF PB-POLICY-IS-VOIDED
 17509        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17510
 17511     IF PB-NEEDS-UNDERWRITING
 17512        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17513
 17514     IF PB-REIN-ONLY-CERT
 17515        MOVE '9'                    TO CM-ENTRY-STATUS.
 17516
 17517     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17518         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17519     ELSE
 17520         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17521
 17522     IF PB-RECORD-RETURNED
 17523        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17524      ELSE
 17525        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17526
 17527     IF PB-I-MAIL-ADDRS-PRESENT
 17528        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17529
 17530     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17531                                       CM-ENTRY-DT.
 17532
 17533 4999-EXIT.
 17534     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 320
* EL050.cbl
 17536
 17537 5000-PROCESS-REPS.
 17538     MOVE ' '                    TO AGTC-MASTER-SW
 17539     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17540     MOVE CO-TYPE                TO AGTC-TYPE
 17541     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17542     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17543     IF (AGTC-MASTER-SW NOT = 'N')
 17544        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17545        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17546        PERFORM 8583-READ-ERAGTC-NEXT
 17547                                 THRU 8583-EXIT
 17548     END-IF
 17549     IF AGTC-MASTER-SW = 'N'
 17550        CONTINUE
 17551     ELSE
 17552        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17553           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17554              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17555              MOVE 'Y'           TO AGTC-MASTER-SW
 17556           END-IF
 17557        END-IF
 17558     END-IF
 17559     .
 17560 5000-EXIT.
 17561     EXIT.
 17562 6370-EDIT-INPUT-LF-CODE.
 17563     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17564        MOVE +1                  TO SUB
 17565        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17566        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17567        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17568        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17569        GO TO 6370-SEARCH-LOOP.
 17570
 17571     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17572
 17573     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17574     MOVE SPACES                 TO CNTL-ACCESS.
 17575*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17576     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17577     MOVE +0                     TO CNTL-SEQ-NO.
 17578     MOVE '4' TO RC-SW-2.
 17579     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17580
 17581     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17582        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17583        GO TO 6370-NO-LF-FOUND.
 17584
 17585     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17586     MOVE +1                     TO SUB.
 17587
 17588 6370-SEARCH-LOOP.
 17589     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17590         GO TO 6370-NO-LF-FOUND.
 17591
 17592     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17593         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 321
* EL050.cbl
 17594         GO TO 6370-HER-NET-PAY-CHECK.
 17595
 17596     ADD 1   TO SUB.
 17597*    IF SUB GREATER 120
 17598     IF SUB GREATER 200
 17599         GO TO 6370-NO-LF-FOUND.
 17600
 17601     GO TO 6370-SEARCH-LOOP.
 17602
 17603 6370-NO-LF-FOUND.
 17604
 17605     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17606
 17607 6370-HER-NET-PAY-CHECK.
 17608
 17609     IF PB-COMPANY-ID = 'CID'
 17610        IF PB-SV-STATE = 'CA' OR 'MN'
 17611           IF PB-I-LF-BENEFIT-CD = '02'
 17612              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17613           ELSE
 17614              IF PB-I-LF-BENEFIT-CD = '04'
 17615                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17616              END-IF
 17617           END-IF
 17618        END-IF
 17619     END-IF
 17620
 17621     IF PB-COMPANY-ID NOT = 'HER'
 17622         GO TO 6370-EXIT.
 17623
 17624     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17625         GO TO 6370-EXIT.
 17626
 17627     IF PB-I-LF-TERM NOT NUMERIC
 17628         MOVE ZEROS              TO PB-I-LF-TERM.
 17629
 17630     IF PB-I-LOAN-TERM NOT NUMERIC
 17631         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17632
 17633     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17634         GO TO 6370-EXIT.
 17635
 17636     IF PB-I-LF-BENEFIT-CD = '33'
 17637         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17638
 17639     IF PB-I-LF-BENEFIT-CD = '34'
 17640         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17641
 17642 6370-EXIT.
 17643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 322
* EL050.cbl
 17645
 17646 6380-EDIT-INPUT-AH-CODE.
 17647     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17648        MOVE +1                  TO SUB
 17649        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17650        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17651        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17652        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17653        GO TO 6380-SEARCH-LOOP.
 17654
 17655     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17656
 17657     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17658     MOVE SPACES                 TO CNTL-ACCESS.
 17659     MOVE 'A'                    TO CNTL-REC-TYPE.
 17660*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17661     MOVE +0                     TO CNTL-SEQ-NO.
 17662     MOVE '5' TO RC-SW-2.
 17663     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17664
 17665     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17666        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17667        GO TO 6380-NO-AH-FOUND.
 17668
 17669     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17670     MOVE +1 TO SUB.
 17671
 17672 6380-SEARCH-LOOP.
 17673     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17674         GO TO 6380-NO-AH-FOUND.
 17675
 17676     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17677         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17678         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17679
 17680     ADD 1   TO SUB.
 17681     IF SUB GREATER THAN 96
 17682*    IF SUB GREATER THAN 300
 17683         GO TO 6380-NO-AH-FOUND.
 17684
 17685     GO TO 6380-SEARCH-LOOP.
 17686
 17687 6380-NO-AH-FOUND.
 17688
 17689     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17690
 17691     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17692         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17693     ELSE
 17694         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17695
 17696 6380-CSO-AH-ONLY-CHECKS.
 17697
 17698     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17699        NEXT SENTENCE
 17700      ELSE
 17701        GO TO 6380-EXIT.
 17702
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 323
* EL050.cbl
 17703     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17704         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17705
 17706
 17707     GO TO 6380-EXIT
 17708     .
 17709 6380-CSO-LIFE-WITH-AH-CHECKS.
 17710
 17711
 17712     .
 17713 6380-EXIT.
 17714     EXIT.
 17715
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 324
* EL050.cbl
 17717
 17718 6400-COMPUTE-EXTENSION-DAYS.
 17719
 17720******************************************************************
 17721*                                                                *
 17722*                   COMPUTE EXTENSION DAYS                       *
 17723*                                                                *
 17724*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17725*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17726*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17727*    THE EXTENSION DAYS.                                         *
 17728*                                                                *
 17729******************************************************************
 17730
 17731     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17732     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17733
 17734******************************************************************
 17735*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17736*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17737******************************************************************
 17738
 17739     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17740        COMPUTE WS-ODD-DAYS-OVER =
 17741               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17742     ELSE
 17743        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17744
 17745     IF WS-ODD-DAYS-OVER = ZEROS
 17746           GO TO 6499-EXIT
 17747     ELSE
 17748        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17749           IF WS-WDF-MONTH = 02
 17750              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17751              ADD 2       TO  WS-ODD-DAYS-OVER
 17752              GO TO 6499-EXIT
 17753           ELSE
 17754              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17755                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17756                 GO TO 6499-EXIT
 17757               ELSE
 17758                 GO TO 6499-EXIT
 17759        ELSE
 17760           GO TO 6499-EXIT.
 17761
 17762 6412-CHECK-TO-DAY.
 17763
 17764        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17765           IF WS-WDT-DAY = 28
 17766              ADD 2              TO WS-ODD-DAYS-OVER
 17767           ELSE
 17768              IF WS-WDT-DAY = 29
 17769                 ADD 1           TO WS-ODD-DAYS-OVER
 17770              ELSE
 17771                 NEXT SENTENCE
 17772        ELSE
 17773           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17774              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 325
* EL050.cbl
 17775
 17776     GO TO 6499-EXIT.
 17777
 17778
 17779 6415-CHECK-LEAP-YEAR.
 17780
 17781     IF DC-DAYS-IN-MONTH = 29
 17782        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17783
 17784 6415-EXIT.
 17785     EXIT.
 17786
 17787 6499-EXIT.
 17788      EXIT.
 17789
 17790 6500-END.
 17791     EXIT.
 17792
 17793
 17794******************************************************************
 17795************* PROCEDURE DIVISION FOR EL050 ***********************
 17796********************** ELC50PD END *******************************
 17797
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 326
* EL050.cbl
 17799
 17800**START***********************************************************
 17801*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17802*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17803******************************************************************
 17804*
 17805 6600-GET-STATE-MUNICIPAL-TAX.
 17806
 17807     IF PB-COMPANY-ID NOT = 'DMD'
 17808         GO TO 6640-EXIT.
 17809
 17810     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17811     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17812     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17813*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17814*
 17815***  Y2K PROJ 7744
 17816     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17817     SET BIN-TO-GREG          TO TRUE.
 17818     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17819
 17820     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17821
 17822     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17823     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17824
 17825
 17826* EXEC CICS HANDLE CONDITION
 17827*        INVREQ    (6610-START-BROWSE)
 17828*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17829*        NOTFND    (6630-END-OF-FILE)
 17830*    END-EXEC.
 17831*    MOVE '"$8JI                 ! # #00017813' TO DFHEIV0
 17832     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17834     MOVE X'2320233030303137383133' TO DFHEIV0(25:11)
 17835     CALL 'kxdfhei1' USING DFHEIV0
 17836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17837
 17838
 17839 6610-START-BROWSE.
 17840
 17841
 17842* EXEC CICS HANDLE CONDITION
 17843*        NOTFND    (6630-END-OF-FILE)
 17844*        DISABLED  (6630-ERRESS-PROBLEM)
 17845*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17846*        ENDFILE   (6630-END-OF-FILE)
 17847*    END-EXEC.
 17848*    MOVE '"$IcJ''                ! $ #00017821' TO DFHEIV0
 17849     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17851     MOVE X'2420233030303137383231' TO DFHEIV0(25:11)
 17852     CALL 'kxdfhei1' USING DFHEIV0
 17853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17854
 17855
 17856
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 327
* EL050.cbl
 17857* EXEC CICS STARTBR
 17858*        DATASET (FILE-ID-ERRESS)
 17859*        RIDFLD  (WS-ERRESS-KEY)
 17860*        GTEQ
 17861*    END-EXEC.
 17862     MOVE 0
 17863       TO DFHEIV11
 17864*    MOVE '&,         G          &   #00017828' TO DFHEIV0
 17865     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17866     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17867     MOVE X'2020233030303137383238' TO DFHEIV0(25:11)
 17868     CALL 'kxdfhei1' USING DFHEIV0,
 17869           FILE-ID-ERRESS,
 17870           WS-ERRESS-KEY,
 17871           DFHEIV99,
 17872           DFHEIV11,
 17873           DFHEIV99
 17874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17875
 17876
 17877 6620-READ-NEXT-ERRESS-MASTER.
 17878
 17879
 17880* EXEC CICS HANDLE CONDITION
 17881*        NOTFND    (6630-END-OF-FILE)
 17882*        ENDFILE   (6630-END-OF-FILE)
 17883*        DISABLED  (6630-ERRESS-PROBLEM)
 17884*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17885*    END-EXEC.
 17886*    MOVE '"$I''cJ                ! % #00017836' TO DFHEIV0
 17887     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17889     MOVE X'2520233030303137383336' TO DFHEIV0(25:11)
 17890     CALL 'kxdfhei1' USING DFHEIV0
 17891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17892
 17893
 17894
 17895* EXEC CICS READNEXT
 17896*        DATASET (FILE-ID-ERRESS)
 17897*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17898*        RIDFLD  (WS-ERRESS-KEY)
 17899*    END-EXEC.
 17900     MOVE LENGTH OF
 17901      RESIDENT-STATE-TAX-MASTER
 17902       TO DFHEIV12
 17903     MOVE 0
 17904       TO DFHEIV11
 17905*    MOVE '&.IL                  )   #00017843' TO DFHEIV0
 17906     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17907     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17908     MOVE X'2020233030303137383433' TO DFHEIV0(25:11)
 17909     CALL 'kxdfhei1' USING DFHEIV0,
 17910           FILE-ID-ERRESS,
 17911           RESIDENT-STATE-TAX-MASTER,
 17912           DFHEIV12,
 17913           WS-ERRESS-KEY,
 17914           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 328
* EL050.cbl
 17915           DFHEIV11,
 17916           DFHEIV99,
 17917           DFHEIV99
 17918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17919
 17920
 17921     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17922
 17923* EXEC CICS ENDBR
 17924*            DATASET (FILE-ID-ERRESS)
 17925*       END-EXEC
 17926     MOVE 0
 17927       TO DFHEIV11
 17928*    MOVE '&2                    $   #00017850' TO DFHEIV0
 17929     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17930     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17931     MOVE X'2020233030303137383530' TO DFHEIV0(25:11)
 17932     CALL 'kxdfhei1' USING DFHEIV0,
 17933           FILE-ID-ERRESS,
 17934           DFHEIV11,
 17935           DFHEIV99
 17936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17937        GO TO 6630-END-OF-FILE.
 17938
 17939     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17940        NEXT SENTENCE
 17941      ELSE
 17942        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17943
 17944*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17945*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17946*
 17947     MOVE +2                     TO WS-SUB1.
 17948
 17949     IF PB-ISSUE
 17950     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17951        MOVE +1                  TO WS-SUB1.
 17952
 17953     IF PB-CANCELLATION
 17954     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17955        MOVE +1                  TO WS-SUB1.
 17956*
 17957*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17958*
 17959***  Y2K PROJ 7744
 17960     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17961***  Y2K PROJ 7744
 17962
 17963*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17964* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17965* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17966
 17967     ADD 1                    TO WS-YEAR-YY.
 17968
 17969     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17970         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17971                              TO WS-RES-STATE-TAX
 17972         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 329
* EL050.cbl
 17973                              TO WS-RES-MUNI-TAX
 17974     ELSE
 17975         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17976                              TO WS-RES-STATE-TAX
 17977         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17978                              TO WS-RES-MUNI-TAX.
 17979
 17980*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17981
 17982     IF PB-CANCELLATION
 17983         GO TO 6640-CANCEL-TAX.
 17984
 17985     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17986         COMPUTE PB-I-STATE-TAX ROUNDED =
 17987                                   PB-I-LF-PREMIUM-AMT
 17988                                 * WS-RES-STATE-TAX
 17989         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17990                                   PB-I-LF-PREMIUM-AMT
 17991                                 * WS-RES-MUNI-TAX
 17992     ELSE
 17993     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17994         COMPUTE PB-I-STATE-TAX ROUNDED =
 17995                                   PB-I-AH-PREMIUM-AMT
 17996                                 * WS-RES-STATE-TAX
 17997         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17998                                   PB-I-AH-PREMIUM-AMT
 17999                                 * WS-RES-MUNI-TAX.
 18000
 18001
 18002* EXEC CICS ENDBR
 18003*         DATASET (FILE-ID-ERRESS)
 18004*    END-EXEC.
 18005     MOVE 0
 18006       TO DFHEIV11
 18007*    MOVE '&2                    $   #00017917' TO DFHEIV0
 18008     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18009     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18010     MOVE X'2020233030303137393137' TO DFHEIV0(25:11)
 18011     CALL 'kxdfhei1' USING DFHEIV0,
 18012           FILE-ID-ERRESS,
 18013           DFHEIV11,
 18014           DFHEIV99
 18015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18016
 18017
 18018     GO TO 6640-EXIT.
 18019
 18020 6640-CANCEL-TAX.
 18021     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18022
 18023     IF PB-C-LF-CANCEL-AMT > ZEROS
 18024         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18025                                   PB-C-LF-CANCEL-AMT
 18026                                 * WS-RES-STATE-TAX
 18027         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18028                                   PB-C-LF-CANCEL-AMT
 18029                                *  WS-RES-MUNI-TAX
 18030     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 330
* EL050.cbl
 18031     IF PB-C-AH-CANCEL-AMT > ZEROS
 18032         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18033                                   PB-C-AH-CANCEL-AMT
 18034                                 * WS-RES-STATE-TAX
 18035         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18036                                   PB-C-AH-CANCEL-AMT
 18037                                *  WS-RES-MUNI-TAX.
 18038
 18039
 18040* EXEC CICS ENDBR
 18041*         DATASET (FILE-ID-ERRESS)
 18042*    END-EXEC.
 18043     MOVE 0
 18044       TO DFHEIV11
 18045*    MOVE '&2                    $   #00017942' TO DFHEIV0
 18046     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18048     MOVE X'2020233030303137393432' TO DFHEIV0(25:11)
 18049     CALL 'kxdfhei1' USING DFHEIV0,
 18050           FILE-ID-ERRESS,
 18051           DFHEIV11,
 18052           DFHEIV99
 18053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18054
 18055
 18056     GO TO 6640-EXIT.
 18057
 18058 6630-END-OF-FILE.
 18059     MOVE ER-8002              TO WS-ERROR.
 18060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18061
 18062     GO TO 6640-EXIT.
 18063
 18064 6630-ERRESS-PROBLEM.
 18065     MOVE ER-8044              TO WS-ERROR.
 18066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18067
 18068 6640-EXIT.
 18069     EXIT.
 18070
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 331
* EL050.cbl
 18072 6650-GET-RES-STATE-COMM.
 18073
 18074     IF PB-COMPANY-ID NOT = 'DMD'
 18075         GO TO 6700-COMM-EXIT.
 18076
 18077     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18078     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18079     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18080     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18081     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18082     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18083     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18084
 18085*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18086*
 18087***  Y2K PROJ 7744
 18088     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18089     SET BIN-TO-GREG          TO TRUE.
 18090     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18091
 18092     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18093***  Y2K PROJ 7744
 18094
 18095     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18096
 18097
 18098* EXEC CICS HANDLE CONDITION
 18099*        INVREQ    (6660-START-BROWSE)
 18100*        DISABLED  (6690-ERRESC-PROBLEM)
 18101*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18102*        NOTFND    (6690-END-OF-FILE)
 18103*    END-EXEC.
 18104*    MOVE '"$8cJI                ! & #00017987' TO DFHEIV0
 18105     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18107     MOVE X'2620233030303137393837' TO DFHEIV0(25:11)
 18108     CALL 'kxdfhei1' USING DFHEIV0
 18109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18110
 18111
 18112
 18113* EXEC CICS RESETBR
 18114*        DATASET (FILE-ID-ERRESC)
 18115*        RIDFLD  (WS-ERRESC-KEY)
 18116*    END-EXEC.
 18117     MOVE 0
 18118       TO DFHEIV11
 18119*    MOVE '&4         G          &   #00017994' TO DFHEIV0
 18120     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18121     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18122     MOVE X'2020233030303137393934' TO DFHEIV0(25:11)
 18123     CALL 'kxdfhei1' USING DFHEIV0,
 18124           FILE-ID-ERRESC,
 18125           WS-ERRESC-KEY,
 18126           DFHEIV99,
 18127           DFHEIV11,
 18128           DFHEIV99
 18129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 332
* EL050.cbl
 18130
 18131
 18132 6660-START-BROWSE.
 18133
 18134
 18135* EXEC CICS HANDLE CONDITION
 18136*        NOTFND    (6690-END-OF-FILE)
 18137*        DISABLED  (6690-ERRESC-PROBLEM)
 18138*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18139*        ENDFILE   (6690-END-OF-FILE)
 18140*    END-EXEC.
 18141*    MOVE '"$IcJ''                ! '' #00018001' TO DFHEIV0
 18142     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18144     MOVE X'2720233030303138303031' TO DFHEIV0(25:11)
 18145     CALL 'kxdfhei1' USING DFHEIV0
 18146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18147
 18148
 18149
 18150* EXEC CICS STARTBR
 18151*        DATASET (FILE-ID-ERRESC)
 18152*        RIDFLD  (WS-ERRESC-KEY)
 18153*        GTEQ
 18154*    END-EXEC.
 18155     MOVE 0
 18156       TO DFHEIV11
 18157*    MOVE '&,         G          &   #00018008' TO DFHEIV0
 18158     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18159     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18160     MOVE X'2020233030303138303038' TO DFHEIV0(25:11)
 18161     CALL 'kxdfhei1' USING DFHEIV0,
 18162           FILE-ID-ERRESC,
 18163           WS-ERRESC-KEY,
 18164           DFHEIV99,
 18165           DFHEIV11,
 18166           DFHEIV99
 18167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18168
 18169
 18170     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18171
 18172 6670-READ-NEXT-ERRESC-MASTER.
 18173
 18174
 18175* EXEC CICS HANDLE CONDITION
 18176*        NOTFND    (6690-END-OF-FILE)
 18177*        DISABLED  (6690-ERRESC-PROBLEM)
 18178*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18179*        ENDFILE   (6690-END-OF-FILE)
 18180*    END-EXEC.
 18181*    MOVE '"$IcJ''                ! ( #00018018' TO DFHEIV0
 18182     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18184     MOVE X'2820233030303138303138' TO DFHEIV0(25:11)
 18185     CALL 'kxdfhei1' USING DFHEIV0
 18186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18187
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 333
* EL050.cbl
 18188
 18189
 18190* EXEC CICS READNEXT
 18191*        DATASET (FILE-ID-ERRESC)
 18192*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18193*        RIDFLD  (ERRESC-RECORD-KEY)
 18194*    END-EXEC.
 18195     MOVE LENGTH OF
 18196      ACCOUNT-RESIDENT-ST-COMMISSION
 18197       TO DFHEIV12
 18198     MOVE 0
 18199       TO DFHEIV11
 18200*    MOVE '&.IL                  )   #00018025' TO DFHEIV0
 18201     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18202     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18203     MOVE X'2020233030303138303235' TO DFHEIV0(25:11)
 18204     CALL 'kxdfhei1' USING DFHEIV0,
 18205           FILE-ID-ERRESC,
 18206           ACCOUNT-RESIDENT-ST-COMMISSION,
 18207           DFHEIV12,
 18208           ERRESC-RECORD-KEY,
 18209           DFHEIV99,
 18210           DFHEIV11,
 18211           DFHEIV99,
 18212           DFHEIV99
 18213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18214
 18215
 18216     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18217        NEXT SENTENCE
 18218     ELSE
 18219
 18220* EXEC CICS ENDBR
 18221*            DATASET (FILE-ID-ERRESC)
 18222*       END-EXEC
 18223     MOVE 0
 18224       TO DFHEIV11
 18225*    MOVE '&2                    $   #00018034' TO DFHEIV0
 18226     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18227     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18228     MOVE X'2020233030303138303334' TO DFHEIV0(25:11)
 18229     CALL 'kxdfhei1' USING DFHEIV0,
 18230           FILE-ID-ERRESC,
 18231           DFHEIV11,
 18232           DFHEIV99
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18234        GO TO 6690-END-OF-FILE.
 18235
 18236     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18237
 18238* EXEC CICS ENDBR
 18239*            DATASET (FILE-ID-ERRESC)
 18240*       END-EXEC
 18241     MOVE 0
 18242       TO DFHEIV11
 18243*    MOVE '&2                    $   #00018040' TO DFHEIV0
 18244     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18245     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 334
* EL050.cbl
 18246     MOVE X'2020233030303138303430' TO DFHEIV0(25:11)
 18247     CALL 'kxdfhei1' USING DFHEIV0,
 18248           FILE-ID-ERRESC,
 18249           DFHEIV11,
 18250           DFHEIV99
 18251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18252        GO TO 6690-END-OF-FILE.
 18253
 18254     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18255        NEXT SENTENCE
 18256      ELSE
 18257        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18258
 18259* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18260*
 18261     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18262
 18263     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18264
 18265     IF WS-SUB1 > ZERO
 18266         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18267             PERFORM 6680-SET-COMMISSION
 18268         ELSE
 18269             PERFORM 6680-SET-TABLE-CODE.
 18270
 18271
 18272* EXEC CICS ENDBR
 18273*         DATASET (FILE-ID-ERRESC)
 18274*    END-EXEC.
 18275     MOVE 0
 18276       TO DFHEIV11
 18277*    MOVE '&2                    $   #00018062' TO DFHEIV0
 18278     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18280     MOVE X'2020233030303138303632' TO DFHEIV0(25:11)
 18281     CALL 'kxdfhei1' USING DFHEIV0,
 18282           FILE-ID-ERRESC,
 18283           DFHEIV11,
 18284           DFHEIV99
 18285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18286
 18287
 18288     GO TO 6700-COMM-EXIT.
 18289
 18290 6680-SET-TABLE-CODE.
 18291     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18292        MOVE ZEROS             TO WS-SUB1
 18293     ELSE
 18294* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18295* TO COMPUTE AH COMMISSION.
 18296        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18297        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18298        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18299        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18300        PERFORM 6680-READ-CTBL-TABLE
 18301        IF WS-CTBL-READ-SW NOT = 'Y'
 18302           MOVE ZEROS          TO WS-SUB1.
 18303
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 335
* EL050.cbl
 18304 6680-READ-CTBL-TABLE.
 18305*
 18306* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18307* TO COMPUTE LIFE COMMISSION
 18308
 18309     IF CTBL-SW = '0540'
 18310        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18311        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18312        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18313
 18314     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18315
 18316     IF CTBL-TABLE-FOUND
 18317        IF CTBL-SW = '0530'
 18318             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18319                                    * PB-I-AH-TERM
 18320             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18321             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18322        ELSE
 18323             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18324             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18325             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18326     ELSE
 18327        IF FIRST-TIME-THROUGH
 18328            GO TO 6680-READ-CTBL-TABLE
 18329        ELSE
 18330            MOVE ZEROS         TO WS-SUB1.
 18331
 18332 6680-SET-COMMISSION.
 18333     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18334           MOVE ZEROS          TO WS-SUB1
 18335       ELSE
 18336           MOVE RESC-COMMISSION-PER (WS-SUB)
 18337                               TO WS-COMMISSION
 18338           IF CTBL-SW = '0530'
 18339               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18340           ELSE
 18341               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18342
 18343 6680-SEARCH-CATEGORY.
 18344     ADD +1                   TO WS-SUB.
 18345     IF WS-SUB > +12
 18346         GO TO 6680-EXIT.
 18347
 18348     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18349          MOVE WS-SUB         TO WS-SUB1
 18350          GO TO 6680-EXIT.
 18351
 18352     GO TO 6680-SEARCH-CATEGORY.
 18353
 18354 6680-EXIT.
 18355     EXIT.
 18356
 18357 6690-END-OF-FILE.
 18358     GO TO 6700-COMM-EXIT.
 18359
 18360 6690-ERRESC-PROBLEM.
 18361      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 336
* EL050.cbl
 18362      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18363
 18364      GO TO 6700-COMM-EXIT.
 18365
 18366 6700-COMM-EXIT.
 18367     EXIT.
 18368
 18369 7000-GET-RATE.
 18370
 18371* EXEC CICS LINK
 18372*        PROGRAM    ('ELRATE')
 18373*        COMMAREA   (CALCULATION-PASS-AREA)
 18374*        LENGTH     (CP-COMM-LENGTH)
 18375*    END-EXEC.
 18376     MOVE 'ELRATE' TO DFHEIV1
 18377*    MOVE '."C                   (   #00018148' TO DFHEIV0
 18378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18380     MOVE X'2020233030303138313438' TO DFHEIV0(25:11)
 18381     CALL 'kxdfhei1' USING DFHEIV0,
 18382           DFHEIV1,
 18383           CALCULATION-PASS-AREA,
 18384           CP-COMM-LENGTH,
 18385           DFHEIV99,
 18386           DFHEIV99,
 18387           DFHEIV99,
 18388           DFHEIV99
 18389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18390
 18391
 18392 7000-EXIT.
 18393     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 337
* EL050.cbl
 18395 7100-FIND-BENEFIT-IN-STATE.
 18396     MOVE 'N'                    TO BEN-SEARCH-SW.
 18397
 18398     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18399         VARYING SUB3 FROM 1 BY 1 UNTIL
 18400            ((SUB3 GREATER 50) OR
 18401              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18402               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18403
 18404     IF SUB3 NOT = 51
 18405         MOVE 'Y'                TO BEN-SEARCH-SW.
 18406
 18407     GO TO 7199-EXIT.
 18408
 18409 7100-BENEFIT-DUMMY.
 18410
 18411 7100-DUMMY-EXIT.
 18412     EXIT.
 18413
 18414 7199-EXIT.
 18415     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 338
* EL050.cbl
 18417 7200-FIND-BENEFIT.
 18418     MOVE 'N'                    TO BEN-SEARCH-SW.
 18419
 18420     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18421         VARYING SUB3 FROM 1 BY 1 UNTIL
 18422            ((SUB3 GREATER 8) OR
 18423            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18424
 18425     IF SUB3 NOT = 9
 18426         MOVE 'Y'                TO BEN-SEARCH-SW.
 18427
 18428     GO TO 7200-EXIT.
 18429
 18430 7200-BENEFIT-DUMMY.
 18431
 18432 7200-DUMMY-EXIT.
 18433     EXIT.
 18434
 18435 7200-EXIT.
 18436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 339
* EL050.cbl
 18438 7250-LOOK-FOR-RESCINDED-CLAIM.
 18439     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18440                                    W-CL-COMP-CD.
 18441     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18442                                    W-CL-CERT-NO.
 18443
 18444
 18445* EXEC CICS HANDLE CONDITION
 18446*        NOTFND  (7250-CONTINUE)
 18447*        ENDFILE (7250-CONTINUE)
 18448*    END-EXEC.
 18449*    MOVE '"$I''                  ! ) #00018206' TO DFHEIV0
 18450     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18452     MOVE X'2920233030303138323036' TO DFHEIV0(25:11)
 18453     CALL 'kxdfhei1' USING DFHEIV0
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18455
 18456
 18457
 18458* EXEC CICS IGNORE CONDITION
 18459*        DUPKEY
 18460*    END-EXEC.
 18461*    MOVE '"*$                   !   #00018211' TO DFHEIV0
 18462     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18464     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 18465     CALL 'kxdfhei1' USING DFHEIV0
 18466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18467
 18468
 18469
 18470* EXEC CICS STARTBR
 18471*        DATASET   (CLMS-ID)
 18472*        RIDFLD    (ELMSTR-KEY)
 18473*        GENERIC   EQUAL
 18474*        KEYLENGTH (ELMSTR-LENGTH)
 18475*    END-EXEC.
 18476     MOVE 0
 18477       TO DFHEIV11
 18478*    MOVE '&,   KG    E          &   #00018215' TO DFHEIV0
 18479     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18481     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 18482     CALL 'kxdfhei1' USING DFHEIV0,
 18483           CLMS-ID,
 18484           ELMSTR-KEY,
 18485           ELMSTR-LENGTH,
 18486           DFHEIV11,
 18487           DFHEIV99
 18488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18489
 18490
 18491     MOVE 'Y'                    TO W-BROWSE-SW.
 18492
 18493 7250-NEXT-CLAIM.
 18494
 18495
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 340
* EL050.cbl
 18496* EXEC CICS READNEXT
 18497*        DATASET   (CLMS-ID)
 18498*        RIDFLD    (ELMSTR-KEY)
 18499*        SET       (ADDRESS OF CLAIM-MASTER)
 18500*    END-EXEC.
 18501     MOVE 0
 18502       TO DFHEIV11
 18503*    MOVE '&.S                   )   #00018226' TO DFHEIV0
 18504     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18505     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18506     MOVE X'2020233030303138323236' TO DFHEIV0(25:11)
 18507     CALL 'kxdfhei1' USING DFHEIV0,
 18508           CLMS-ID,
 18509           DFHEIV20,
 18510           DFHEIV99,
 18511           ELMSTR-KEY,
 18512           DFHEIV99,
 18513           DFHEIV11,
 18514           DFHEIV99,
 18515           DFHEIV99
 18516     SET ADDRESS OF CLAIM-MASTER TO
 18517         DFHEIV20
 18518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18519
 18520
 18521     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18522        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18523         GO TO 7250-CONTINUE
 18524     END-IF.
 18525
 18526     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18527        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18528        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18529        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18530        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18531         GO TO 7250-NEXT-CLAIM
 18532     END-IF.
 18533
 18534     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18535        OR (CL-CLAIM-TYPE = 'I')
 18536        OR (CL-CLAIM-TYPE = 'G')
 18537          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18538              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18539              GO TO 7250-CONTINUE
 18540          END-IF
 18541     END-IF.
 18542
 18543     GO TO 7250-NEXT-CLAIM.
 18544
 18545 7250-CONTINUE.
 18546
 18547     IF W-BROWSE-SW = 'Y'
 18548
 18549* EXEC CICS ENDBR
 18550*            DATASET   (CLMS-ID)
 18551*        END-EXEC
 18552     MOVE 0
 18553       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 341
* EL050.cbl
 18554*    MOVE '&2                    $   #00018259' TO DFHEIV0
 18555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303138323539' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           CLMS-ID,
 18560           DFHEIV11,
 18561           DFHEIV99
 18562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18563         MOVE 'N' TO W-BROWSE-SW
 18564     END-IF.
 18565
 18566 7250-EXIT.
 18567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 342
* EL050.cbl
 18569 7300-CHECK-FOR-OPEN-CLMS.
 18570
 18571*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18572*    MOVE SPACES                 TO CNTL-ACCESS.
 18573*    MOVE '1'                    TO CNTL-REC-TYPE.
 18574*    MOVE +0                     TO CNTL-SEQ-NO.
 18575
 18576*    MOVE '3'                    TO RC-SW-1.
 18577*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18578
 18579*    IF NOT CF-COMPANY-MASTER
 18580*         PERFORM 0099-COMPANY-NOT-FOUND
 18581*         GO TO 7300-EXIT.
 18582
 18583     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18584                                    W-CL-COMP-CD.
 18585     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18586                                    W-CL-CERT-NO.
 18587
 18588
 18589* EXEC CICS HANDLE CONDITION
 18590*        NOTFND  (7300-CONTINUE)
 18591*        ENDFILE (7300-CONTINUE)
 18592*    END-EXEC.
 18593*    MOVE '"$I''                  ! * #00018287' TO DFHEIV0
 18594     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18596     MOVE X'2A20233030303138323837' TO DFHEIV0(25:11)
 18597     CALL 'kxdfhei1' USING DFHEIV0
 18598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18599
 18600
 18601
 18602* EXEC CICS IGNORE CONDITION
 18603*        DUPKEY
 18604*    END-EXEC.
 18605*    MOVE '"*$                   !   #00018292' TO DFHEIV0
 18606     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18608     MOVE X'2020233030303138323932' TO DFHEIV0(25:11)
 18609     CALL 'kxdfhei1' USING DFHEIV0
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18611
 18612
 18613
 18614* EXEC CICS STARTBR
 18615*        DATASET   (CLMS-ID)
 18616*        RIDFLD    (ELMSTR-KEY)
 18617*        GENERIC   EQUAL
 18618*        KEYLENGTH (ELMSTR-LENGTH)
 18619*    END-EXEC.
 18620     MOVE 0
 18621       TO DFHEIV11
 18622*    MOVE '&,   KG    E          &   #00018296' TO DFHEIV0
 18623     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18624     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18625     MOVE X'2020233030303138323936' TO DFHEIV0(25:11)
 18626     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 343
* EL050.cbl
 18627           CLMS-ID,
 18628           ELMSTR-KEY,
 18629           ELMSTR-LENGTH,
 18630           DFHEIV11,
 18631           DFHEIV99
 18632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18633
 18634
 18635     MOVE 'Y'                    TO W-BROWSE-SW.
 18636
 18637 7300-NEXT-CLAIM.
 18638
 18639
 18640* EXEC CICS READNEXT
 18641*        DATASET   (CLMS-ID)
 18642*        RIDFLD    (ELMSTR-KEY)
 18643*        SET       (ADDRESS OF CLAIM-MASTER)
 18644*    END-EXEC.
 18645     MOVE 0
 18646       TO DFHEIV11
 18647*    MOVE '&.S                   )   #00018307' TO DFHEIV0
 18648     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18649     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18650     MOVE X'2020233030303138333037' TO DFHEIV0(25:11)
 18651     CALL 'kxdfhei1' USING DFHEIV0,
 18652           CLMS-ID,
 18653           DFHEIV20,
 18654           DFHEIV99,
 18655           ELMSTR-KEY,
 18656           DFHEIV99,
 18657           DFHEIV11,
 18658           DFHEIV99,
 18659           DFHEIV99
 18660     SET ADDRESS OF CLAIM-MASTER TO
 18661         DFHEIV20
 18662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18663
 18664
 18665     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18666        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18667         GO TO 7300-CONTINUE.
 18668
 18669     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18670        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18671        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18672        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18673        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18674         GO TO 7300-NEXT-CLAIM.
 18675
 18676*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18677     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18678        OR (CL-CLAIM-TYPE = 'I')
 18679        OR (CL-CLAIM-TYPE = 'G')
 18680        IF CLAIM-IS-OPEN
 18681           EVALUATE TRUE
 18682             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18683                 MOVE ER-2884      TO WS-ERROR
 18684             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 344
* EL050.cbl
 18685                 MOVE ER-2887      TO WS-ERROR
 18686             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18687                 MOVE ER-2886      TO WS-ERROR
 18688             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18689                 MOVE ER-2888      TO WS-ERROR
 18690             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18691                 MOVE ER-2885      TO WS-ERROR
 18692             WHEN OTHER
 18693                 MOVE ER-2768      TO WS-ERROR
 18694           END-EVALUATE
 18695           IF PB-C-AH-CANCEL-VOIDED OR
 18696              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18697                NOT AH-COVERAGE-CANCELLED)
 18698               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18699               MOVE ER-2768      TO WS-ERROR
 18700           END-IF
 18701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18702           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18703              PB-FORCE-CODE NOT EQUAL '8'
 18704               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18705           END-IF
 18706           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18707           GO TO 7300-CONTINUE
 18708        ELSE
 18709           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18710*****THIS IS A RESCISSION OR REFORMATION
 18711              IF (AH-COVERAGE-CANCELLED AND
 18712                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18713                    MOVE ER-2890 TO WS-ERROR
 18714                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18715                    GO TO 7300-CONTINUE
 18716              END-IF
 18717           ELSE
 18718              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18719               AND PB-C-AH-CANCEL-DT > SPACES
 18720                 MOVE ER-2756        TO WS-ERROR
 18721                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18722                 GO TO 7300-CONTINUE
 18723              END-IF
 18724           END-IF
 18725        END-IF
 18726     ELSE
 18727*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18728        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18729           IF CLAIM-IS-OPEN
 18730              MOVE ER-2889      TO WS-ERROR
 18731              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18732              GO TO 7300-CONTINUE
 18733           ELSE
 18734              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18735*****THIS IS A RESCISSION OR REFORMATION
 18736                 IF (LF-COVERAGE-CANCELLED AND
 18737                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18738                       MOVE ER-2890 TO WS-ERROR
 18739                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18740                       GO TO 7300-CONTINUE
 18741                 END-IF
 18742              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 345
* EL050.cbl
 18743                 IF (AH-COVERAGE-CANCELLED AND
 18744                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18745                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18746                    (LF-COVERAGE-CANCELLED AND
 18747                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18748                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18749                       MOVE ER-2965 TO WS-ERROR
 18750                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18751                       GO TO 7300-CONTINUE
 18752                 END-IF
 18753                 IF LF-COVERAGE-CANCELLED
 18754                  IF CL-TOTAL-PAID-AMT > 0
 18755                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18756                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18757                        MOVE ER-2891 TO WS-ERROR
 18758                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18759                        GO TO 7300-CONTINUE
 18760                      END-IF
 18761                    ELSE
 18762                      MOVE ER-2892 TO WS-ERROR
 18763                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18764                      GO TO 7300-CONTINUE
 18765                    END-IF
 18766                  END-IF
 18767                 END-IF
 18768              END-IF
 18769           END-IF
 18770        END-IF
 18771     END-IF
 18772
 18773     GO TO 7300-NEXT-CLAIM.
 18774
 18775 7300-CONTINUE.
 18776
 18777     IF W-BROWSE-SW = 'Y'
 18778
 18779* EXEC CICS ENDBR
 18780*            DATASET   (CLMS-ID)
 18781*        END-EXEC.
 18782     MOVE 0
 18783       TO DFHEIV11
 18784*    MOVE '&2                    $   #00018426' TO DFHEIV0
 18785     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18787     MOVE X'2020233030303138343236' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0,
 18789           CLMS-ID,
 18790           DFHEIV11,
 18791           DFHEIV99
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795 7300-EXIT.
 18796     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 346
* EL050.cbl
 18798
 18799 7400-GET-REMAIN-TERM.
 18800
 18801* EXEC CICS LINK
 18802*        PROGRAM    ('ELRTRM')
 18803*        COMMAREA   (CALCULATION-PASS-AREA)
 18804*        LENGTH     (CP-COMM-LENGTH)
 18805*    END-EXEC.
 18806     MOVE 'ELRTRM' TO DFHEIV1
 18807*    MOVE '."C                   (   #00018435' TO DFHEIV0
 18808     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18810     MOVE X'2020233030303138343335' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0,
 18812           DFHEIV1,
 18813           CALCULATION-PASS-AREA,
 18814           CP-COMM-LENGTH,
 18815           DFHEIV99,
 18816           DFHEIV99,
 18817           DFHEIV99,
 18818           DFHEIV99
 18819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18820
 18821
 18822 7400-EXIT.
 18823     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 347
* EL050.cbl
 18825
 18826 7500-GET-REMAIN-AMOUNT.
 18827
 18828* EXEC CICS LINK
 18829*        PROGRAM    ('ELRAMT')
 18830*        COMMAREA   (CALCULATION-PASS-AREA)
 18831*        LENGTH     (CP-COMM-LENGTH)
 18832*    END-EXEC.
 18833     MOVE 'ELRAMT' TO DFHEIV1
 18834*    MOVE '."C                   (   #00018446' TO DFHEIV0
 18835     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18837     MOVE X'2020233030303138343436' TO DFHEIV0(25:11)
 18838     CALL 'kxdfhei1' USING DFHEIV0,
 18839           DFHEIV1,
 18840           CALCULATION-PASS-AREA,
 18841           CP-COMM-LENGTH,
 18842           DFHEIV99,
 18843           DFHEIV99,
 18844           DFHEIV99,
 18845           DFHEIV99
 18846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18847
 18848
 18849 7500-EXIT.
 18850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 348
* EL050.cbl
 18852
 18853 7600-GET-REFUND.
 18854
 18855* EXEC CICS LINK
 18856*        PROGRAM    ('ELRFND')
 18857*        COMMAREA   (CALCULATION-PASS-AREA)
 18858*        LENGTH     (CP-COMM-LENGTH)
 18859*    END-EXEC.
 18860     MOVE 'ELRFND' TO DFHEIV1
 18861*    MOVE '."C                   (   #00018457' TO DFHEIV0
 18862     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18864     MOVE X'2020233030303138343537' TO DFHEIV0(25:11)
 18865     CALL 'kxdfhei1' USING DFHEIV0,
 18866           DFHEIV1,
 18867           CALCULATION-PASS-AREA,
 18868           CP-COMM-LENGTH,
 18869           DFHEIV99,
 18870           DFHEIV99,
 18871           DFHEIV99,
 18872           DFHEIV99
 18873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18874
 18875
 18876 7600-EXIT.
 18877     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 349
* EL050.cbl
 18879 7700-CALL-DL1.
 18880
 18881* EXEC CICS LINK
 18882*        PROGRAM    ('DLO001')
 18883*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18884*        LENGTH     (DLO001-COMM-LENGTH)
 18885*    END-EXEC.
 18886     MOVE 'DLO001' TO DFHEIV1
 18887*    MOVE '."C                   (   #00018467' TO DFHEIV0
 18888     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18890     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 18891     CALL 'kxdfhei1' USING DFHEIV0,
 18892           DFHEIV1,
 18893           WS-DLO-MASTER-POLICY-FORM,
 18894           DLO001-COMM-LENGTH,
 18895           DFHEIV99,
 18896           DFHEIV99,
 18897           DFHEIV99,
 18898           DFHEIV99
 18899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18900
 18901
 18902 7700-EXIT.
 18903     EXIT.
 18904
 18905 7710-CALL-DL2.
 18906
 18907* EXEC CICS LINK
 18908*        PROGRAM    ('DLO002')
 18909*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18910*        LENGTH     (DLO002-COMM-LENGTH)
 18911*    END-EXEC.
 18912     MOVE 'DLO002' TO DFHEIV1
 18913*    MOVE '."C                   (   #00018477' TO DFHEIV0
 18914     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18916     MOVE X'2020233030303138343737' TO DFHEIV0(25:11)
 18917     CALL 'kxdfhei1' USING DFHEIV0,
 18918           DFHEIV1,
 18919           WS-DLO-INTERNAL-POLICY-FORM,
 18920           DLO002-COMM-LENGTH,
 18921           DFHEIV99,
 18922           DFHEIV99,
 18923           DFHEIV99,
 18924           DFHEIV99
 18925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18926
 18927
 18928 7710-EXIT.
 18929     EXIT.
 18930
 18931 7720-CALL-DL3.
 18932
 18933* EXEC CICS LINK
 18934*        PROGRAM    ('DLO003')
 18935*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18936*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 350
* EL050.cbl
 18937*    END-EXEC.
 18938     MOVE 'DLO003' TO DFHEIV1
 18939*    MOVE '."C                   (   #00018487' TO DFHEIV0
 18940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18942     MOVE X'2020233030303138343837' TO DFHEIV0(25:11)
 18943     CALL 'kxdfhei1' USING DFHEIV0,
 18944           DFHEIV1,
 18945           WS-DLO-VALID-BANK-ID,
 18946           DLO003-COMM-LENGTH,
 18947           DFHEIV99,
 18948           DFHEIV99,
 18949           DFHEIV99,
 18950           DFHEIV99
 18951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18952
 18953
 18954 7720-EXIT.
 18955     EXIT.
 18956
 18957 7730-CALL-DL7.
 18958
 18959* EXEC CICS LINK
 18960*        PROGRAM    ('DLO007')
 18961*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18962*        LENGTH     (DLO007-COMM-LENGTH)
 18963*    END-EXEC.
 18964     MOVE 'DLO007' TO DFHEIV1
 18965*    MOVE '."C                   (   #00018497' TO DFHEIV0
 18966     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303138343937' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0,
 18970           DFHEIV1,
 18971           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18972           DLO007-COMM-LENGTH,
 18973           DFHEIV99,
 18974           DFHEIV99,
 18975           DFHEIV99,
 18976           DFHEIV99
 18977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18978
 18979
 18980 7730-EXIT.
 18981     EXIT.
 18982
 18983 7740-CALL-DL11.
 18984
 18985* EXEC CICS LINK
 18986*        PROGRAM    ('DLO011')
 18987*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18988*        LENGTH     (DLO011-COMM-LENGTH)
 18989*    END-EXEC.
 18990     MOVE 'DLO011' TO DFHEIV1
 18991*    MOVE '."C                   (   #00018507' TO DFHEIV0
 18992     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18993     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18994     MOVE X'2020233030303138353037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 351
* EL050.cbl
 18995     CALL 'kxdfhei1' USING DFHEIV0,
 18996           DFHEIV1,
 18997           WS-DLO-PREM-RATES-BEN-TYPE,
 18998           DLO011-COMM-LENGTH,
 18999           DFHEIV99,
 19000           DFHEIV99,
 19001           DFHEIV99,
 19002           DFHEIV99
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006 7740-EXIT.
 19007     EXIT.
 19008
 19009 7750-CALL-DL17.
 19010
 19011* EXEC CICS LINK
 19012*        PROGRAM    ('DLO017')
 19013*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19014*        LENGTH     (DLO017-COMM-LENGTH)
 19015*    END-EXEC.
 19016     MOVE 'DLO017' TO DFHEIV1
 19017*    MOVE '."C                   (   #00018517' TO DFHEIV0
 19018     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19019     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19020     MOVE X'2020233030303138353137' TO DFHEIV0(25:11)
 19021     CALL 'kxdfhei1' USING DFHEIV0,
 19022           DFHEIV1,
 19023           WS-DLO-VALID-RATE-CODE,
 19024           DLO017-COMM-LENGTH,
 19025           DFHEIV99,
 19026           DFHEIV99,
 19027           DFHEIV99,
 19028           DFHEIV99
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032 7750-EXIT.
 19033     EXIT.
 19034
 19035 7755-CALL-DL19.
 19036
 19037* EXEC CICS LINK
 19038*        PROGRAM    ('DLO019')
 19039*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19040*        LENGTH     (DLO019-COMM-LENGTH)
 19041*    END-EXEC.
 19042     MOVE 'DLO019' TO DFHEIV1
 19043*    MOVE '."C                   (   #00018527' TO DFHEIV0
 19044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303138353237' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
 19048           DFHEIV1,
 19049           WS-DLO-ORIG-COV-CAT,
 19050           DLO019-COMM-LENGTH,
 19051           DFHEIV99,
 19052           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 352
* EL050.cbl
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058 7755-EXIT.
 19059     EXIT.
 19060
 19061 7760-CALL-DL21.
 19062
 19063* EXEC CICS LINK
 19064*        PROGRAM    ('DLO021')
 19065*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19066*        LENGTH     (DLO021-COMM-LENGTH)
 19067*    END-EXEC.
 19068     MOVE 'DLO021' TO DFHEIV1
 19069*    MOVE '."C                   (   #00018537' TO DFHEIV0
 19070     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19071     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303138353337' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           DFHEIV1,
 19075           WS-DLO-VALID-LOAN-OFFICER,
 19076           DLO021-COMM-LENGTH,
 19077           DFHEIV99,
 19078           DFHEIV99,
 19079           DFHEIV99,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19082
 19083
 19084 7760-EXIT.
 19085     EXIT.
 19086
 19087 7770-CALL-DL22.
 19088
 19089* EXEC CICS LINK
 19090*        PROGRAM    ('DLO022')
 19091*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19092*        LENGTH     (DLO022-COMM-LENGTH)
 19093*    END-EXEC.
 19094     MOVE 'DLO022' TO DFHEIV1
 19095*    MOVE '."C                   (   #00018547' TO DFHEIV0
 19096     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19098     MOVE X'2020233030303138353437' TO DFHEIV0(25:11)
 19099     CALL 'kxdfhei1' USING DFHEIV0,
 19100           DFHEIV1,
 19101           WS-DLO-VALID-STATE-CODE,
 19102           DLO022-COMM-LENGTH,
 19103           DFHEIV99,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99
 19107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19108
 19109
 19110 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 353
* EL050.cbl
 19111     EXIT.
 19112
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 354
* EL050.cbl
 19114
 19115 7800-REWRITE-CERT.
 19116******************************************************************
 19117*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19118*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19119******************************************************************
 19120
 19121     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19122        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19123        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19124        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19125
 19126* EXEC CICS REWRITE
 19127*                  DATASET (CERT-ID)
 19128*                  FROM    (CERTIFICATE-MASTER)
 19129*              END-EXEC
 19130     MOVE LENGTH OF
 19131      CERTIFICATE-MASTER
 19132       TO DFHEIV11
 19133*    MOVE '&& L                  %   #00018568' TO DFHEIV0
 19134     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19135     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19136     MOVE X'2020233030303138353638' TO DFHEIV0(25:11)
 19137     CALL 'kxdfhei1' USING DFHEIV0,
 19138           CERT-ID,
 19139           CERTIFICATE-MASTER,
 19140           DFHEIV11,
 19141           DFHEIV99
 19142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19143        GO TO 7800-EXIT.
 19144
 19145       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19146       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19147
 19148 7800-EXIT.
 19149      EXIT.
 19150
 19151 7900-DELETE-CERT.
 19152
 19153* EXEC CICS DELETE
 19154*        DATASET (CERT-ID)
 19155*    END-EXEC.
 19156*    MOVE '&(                    &   #00018581' TO DFHEIV0
 19157     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19159     MOVE X'2020233030303138353831' TO DFHEIV0(25:11)
 19160     CALL 'kxdfhei1' USING DFHEIV0,
 19161           CERT-ID,
 19162           DFHEIV99,
 19163           DFHEIV99,
 19164           DFHEIV99,
 19165           DFHEIV99
 19166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19167
 19168
 19169 7900-EXIT.
 19170     EXIT.
 19171
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 355
* EL050.cbl
 19172 8000-WRITE-CERT.
 19173
 19174* EXEC CICS HANDLE CONDITION
 19175*        DUPKEY    (8000-FREE-MAIN)
 19176*    END-EXEC.
 19177*    MOVE '"$$                   ! + #00018589' TO DFHEIV0
 19178     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19180     MOVE X'2B20233030303138353839' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0
 19182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19183
 19184
 19185
 19186* EXEC CICS WRITE
 19187*        DATASET     (CERT-ID)
 19188*        FROM        (CERTIFICATE-MASTER)
 19189*        RIDFLD      (ELCERT-KEY)
 19190*    END-EXEC.
 19191     MOVE LENGTH OF
 19192      CERTIFICATE-MASTER
 19193       TO DFHEIV11
 19194*    MOVE '&$ L                  ''   #00018593' TO DFHEIV0
 19195     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19197     MOVE X'2020233030303138353933' TO DFHEIV0(25:11)
 19198     CALL 'kxdfhei1' USING DFHEIV0,
 19199           CERT-ID,
 19200           CERTIFICATE-MASTER,
 19201           DFHEIV11,
 19202           ELCERT-KEY,
 19203           DFHEIV99,
 19204           DFHEIV99
 19205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19206
 19207
 19208 8000-FREE-MAIN.
 19209
 19210 8000-EXIT.
 19211      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 356
* EL050.cbl
 19213
 19214 8100-READ-ERPNDM.
 19215
 19216* EXEC CICS HANDLE CONDITION
 19217*         NOTFND     (8100-NOTFND)
 19218*         ENDFILE    (8100-NOTFND)
 19219*    END-EXEC.
 19220*    MOVE '"$I''                  ! , #00018606' TO DFHEIV0
 19221     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19223     MOVE X'2C20233030303138363036' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0
 19225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19226
 19227
 19228     MOVE SPACES                 TO ERPNDM-FOUND.
 19229     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19230
 19231
 19232* EXEC CICS READ
 19233*         DATASET   (FILE-ERPNDM)
 19234*         RIDFLD    (PM-CONTROL-PRIMARY)
 19235*         INTO      (PENDING-MAILING-DATA)
 19236*    END-EXEC.
 19237     MOVE LENGTH OF
 19238      PENDING-MAILING-DATA
 19239       TO DFHEIV11
 19240*    MOVE '&"IL       E          (   #00018614' TO DFHEIV0
 19241     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19243     MOVE X'2020233030303138363134' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0,
 19245           FILE-ERPNDM,
 19246           PENDING-MAILING-DATA,
 19247           DFHEIV11,
 19248           PM-CONTROL-PRIMARY,
 19249           DFHEIV99,
 19250           DFHEIV99,
 19251           DFHEIV99
 19252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19253
 19254
 19255     GO TO 8100-EXIT.
 19256
 19257 8100-NOTFND.
 19258
 19259     MOVE 'X'                    TO ERPNDM-FOUND.
 19260     MOVE ER-2694                TO WS-ERROR.
 19261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19262     MOVE ER-2883                TO WS-ERROR
 19263     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19264     .
 19265 8100-EXIT.
 19266     EXIT.
 19267
 19268 8110-READ-ERMAIL.
 19269
 19270* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 357
* EL050.cbl
 19271*         NOTFND     (8110-NOTFND)
 19272*         ENDFILE    (8110-NOTFND)
 19273*    END-EXEC.
 19274*    MOVE '"$I''                  ! - #00018634' TO DFHEIV0
 19275     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19277     MOVE X'2D20233030303138363334' TO DFHEIV0(25:11)
 19278     CALL 'kxdfhei1' USING DFHEIV0
 19279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19280
 19281
 19282     MOVE SPACES                 TO ERMAIL-FOUND.
 19283     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19284     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19285     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19286     MOVE PB-SV-STATE            TO MA-STATE.
 19287
 19288
 19289* EXEC CICS READ
 19290*         UPDATE
 19291*         DATASET   (FILE-ERMAIL)
 19292*         RIDFLD    (MA-CONTROL-PRIMARY)
 19293*         INTO      (MAILING-DATA)
 19294*    END-EXEC.
 19295     MOVE LENGTH OF
 19296      MAILING-DATA
 19297       TO DFHEIV11
 19298*    MOVE '&"IL       EU         (   #00018645' TO DFHEIV0
 19299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19300     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19301     MOVE X'2020233030303138363435' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0,
 19303           FILE-ERMAIL,
 19304           MAILING-DATA,
 19305           DFHEIV11,
 19306           MA-CONTROL-PRIMARY,
 19307           DFHEIV99,
 19308           DFHEIV99,
 19309           DFHEIV99
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19311
 19312
 19313     GO TO 8110-EXIT.
 19314
 19315 8110-NOTFND.
 19316     MOVE 'X'                    TO ERMAIL-FOUND.
 19317
 19318 8110-EXIT.
 19319     EXIT.
 19320
 19321 8120-REWRITE-ERMAIL.
 19322
 19323* EXEC CICS REWRITE
 19324*         DATASET    (FILE-ERMAIL)
 19325*         FROM       (MAILING-DATA)
 19326*    END-EXEC.
 19327     MOVE LENGTH OF
 19328      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 358
* EL050.cbl
 19329       TO DFHEIV11
 19330*    MOVE '&& L                  %   #00018661' TO DFHEIV0
 19331     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19332     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19333     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 19334     CALL 'kxdfhei1' USING DFHEIV0,
 19335           FILE-ERMAIL,
 19336           MAILING-DATA,
 19337           DFHEIV11,
 19338           DFHEIV99
 19339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19340
 19341
 19342 8120-EXIT.
 19343     EXIT.
 19344
 19345 8130-WRITE-ERMAIL.
 19346
 19347* EXEC CICS HANDLE CONDITION
 19348*         DUPKEY   (8130-EXIT)
 19349*    END-EXEC.
 19350*    MOVE '"$$                   ! . #00018670' TO DFHEIV0
 19351     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19353     MOVE X'2E20233030303138363730' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0
 19355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19356
 19357
 19358
 19359* EXEC CICS WRITE
 19360*         DATASET     (FILE-ERMAIL)
 19361*         RIDFLD      (MA-CONTROL-PRIMARY)
 19362*         FROM        (MAILING-DATA)
 19363*    END-EXEC.
 19364     MOVE LENGTH OF
 19365      MAILING-DATA
 19366       TO DFHEIV11
 19367*    MOVE '&$ L                  ''   #00018674' TO DFHEIV0
 19368     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19370     MOVE X'2020233030303138363734' TO DFHEIV0(25:11)
 19371     CALL 'kxdfhei1' USING DFHEIV0,
 19372           FILE-ERMAIL,
 19373           MAILING-DATA,
 19374           DFHEIV11,
 19375           MA-CONTROL-PRIMARY,
 19376           DFHEIV99,
 19377           DFHEIV99
 19378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19379
 19380
 19381 8130-EXIT.
 19382     EXIT.
 19383
 19384 8140-UNLOCK-ERMAIL.
 19385
 19386* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 359
* EL050.cbl
 19387*         DATASET   (FILE-ERMAIL)
 19388*    END-EXEC.
 19389*    MOVE '&*                    #   #00018684' TO DFHEIV0
 19390     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19391     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19392     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
 19393     CALL 'kxdfhei1' USING DFHEIV0,
 19394           FILE-ERMAIL,
 19395           DFHEIV99
 19396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19397
 19398
 19399 8140-EXIT.
 19400     EXIT.
 19401
 19402 8180-UPDATE-VIN-NUMBER.
 19403
 19404* EXEC CICS HANDLE CONDITION
 19405*        NOTFND   (8180-NOTFND)
 19406*    END-EXEC.
 19407*    MOVE '"$I                   ! / #00018692' TO DFHEIV0
 19408     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19410     MOVE X'2F20233030303138363932' TO DFHEIV0(25:11)
 19411     CALL 'kxdfhei1' USING DFHEIV0
 19412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19413
 19414
 19415     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19416     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19417
 19418
 19419* EXEC CICS READ
 19420*        UPDATE
 19421*        DATASET  (CRTT-ID)
 19422*        RIDFLD   (WS-ELCRTT-KEY)
 19423*        INTO     (CERTIFICATE-TRAILERS)
 19424*    END-EXEC.
 19425     MOVE LENGTH OF
 19426      CERTIFICATE-TRAILERS
 19427       TO DFHEIV11
 19428*    MOVE '&"IL       EU         (   #00018699' TO DFHEIV0
 19429     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19430     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303138363939' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           CRTT-ID,
 19434           CERTIFICATE-TRAILERS,
 19435           DFHEIV11,
 19436           WS-ELCRTT-KEY,
 19437           DFHEIV99,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19441
 19442
 19443     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19444         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 360
* EL050.cbl
 19445
 19446* EXEC CICS REWRITE
 19447*           DATASET  (CRTT-ID)
 19448*           FROM     (CERTIFICATE-TRAILERS)
 19449*        END-EXEC
 19450     MOVE LENGTH OF
 19451      CERTIFICATE-TRAILERS
 19452       TO DFHEIV11
 19453*    MOVE '&& L                  %   #00018708' TO DFHEIV0
 19454     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19455     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19456     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19457     CALL 'kxdfhei1' USING DFHEIV0,
 19458           CRTT-ID,
 19459           CERTIFICATE-TRAILERS,
 19460           DFHEIV11,
 19461           DFHEIV99
 19462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19463     ELSE
 19464
 19465* EXEC CICS UNLOCK
 19466*          DATASET  (CRTT-ID)
 19467*       END-EXEC
 19468*    MOVE '&*                    #   #00018713' TO DFHEIV0
 19469     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19470     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19471     MOVE X'2020233030303138373133' TO DFHEIV0(25:11)
 19472     CALL 'kxdfhei1' USING DFHEIV0,
 19473           CRTT-ID,
 19474           DFHEIV99
 19475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19476     END-IF.
 19477
 19478     GO TO 8180-EXIT.
 19479
 19480 8180-NOTFND.
 19481
 19482     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19483     MOVE 'CS'         TO CS-RECORD-ID.
 19484     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19485     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19486     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19487     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19488
 19489* EXEC CICS WRITE
 19490*       DATASET  (CRTT-ID)
 19491*       RIDFLD   (WS-ELCRTT-KEY)
 19492*       FROM     (CERTIFICATE-TRAILERS)
 19493*    END-EXEC.
 19494     MOVE LENGTH OF
 19495      CERTIFICATE-TRAILERS
 19496       TO DFHEIV11
 19497*    MOVE '&$ L                  ''   #00018728' TO DFHEIV0
 19498     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19500     MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
 19501     CALL 'kxdfhei1' USING DFHEIV0,
 19502           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 361
* EL050.cbl
 19503           CERTIFICATE-TRAILERS,
 19504           DFHEIV11,
 19505           WS-ELCRTT-KEY,
 19506           DFHEIV99,
 19507           DFHEIV99
 19508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19509
 19510
 19511 8180-EXIT.
 19512     EXIT.
 19513
 19514 8190-UPDATE-REFUND-CLAIM-FLAG.
 19515
 19516* EXEC CICS HANDLE CONDITION
 19517*        NOTFND   (8190-NOTFND)
 19518*    END-EXEC.
 19519*    MOVE '"$I                   ! 0 #00018738' TO DFHEIV0
 19520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19522     MOVE X'3020233030303138373338' TO DFHEIV0(25:11)
 19523     CALL 'kxdfhei1' USING DFHEIV0
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19525
 19526
 19527     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19528     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19529
 19530
 19531* EXEC CICS READ
 19532*        UPDATE
 19533*        DATASET  (CRTT-ID)
 19534*        RIDFLD   (WS-ELCRTT-KEY)
 19535*        INTO     (CERTIFICATE-TRAILERS)
 19536*    END-EXEC.
 19537     MOVE LENGTH OF
 19538      CERTIFICATE-TRAILERS
 19539       TO DFHEIV11
 19540*    MOVE '&"IL       EU         (   #00018745' TO DFHEIV0
 19541     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19542     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19543     MOVE X'2020233030303138373435' TO DFHEIV0(25:11)
 19544     CALL 'kxdfhei1' USING DFHEIV0,
 19545           CRTT-ID,
 19546           CERTIFICATE-TRAILERS,
 19547           DFHEIV11,
 19548           WS-ELCRTT-KEY,
 19549           DFHEIV99,
 19550           DFHEIV99,
 19551           DFHEIV99
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
 19555     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19556
 19557* EXEC CICS REWRITE
 19558*       DATASET  (CRTT-ID)
 19559*       FROM     (CERTIFICATE-TRAILERS)
 19560*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 362
* EL050.cbl
 19561     MOVE LENGTH OF
 19562      CERTIFICATE-TRAILERS
 19563       TO DFHEIV11
 19564*    MOVE '&& L                  %   #00018753' TO DFHEIV0
 19565     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19566     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19567     MOVE X'2020233030303138373533' TO DFHEIV0(25:11)
 19568     CALL 'kxdfhei1' USING DFHEIV0,
 19569           CRTT-ID,
 19570           CERTIFICATE-TRAILERS,
 19571           DFHEIV11,
 19572           DFHEIV99
 19573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19574
 19575
 19576     GO TO 8190-EXIT.
 19577
 19578 8190-NOTFND.
 19579
 19580     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19581     MOVE 'CS'         TO CS-RECORD-ID.
 19582     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19583     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19584     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19585     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19586
 19587* EXEC CICS WRITE
 19588*       DATASET  (CRTT-ID)
 19589*       RIDFLD   (WS-ELCRTT-KEY)
 19590*       FROM     (CERTIFICATE-TRAILERS)
 19591*    END-EXEC.
 19592     MOVE LENGTH OF
 19593      CERTIFICATE-TRAILERS
 19594       TO DFHEIV11
 19595*    MOVE '&$ L                  ''   #00018768' TO DFHEIV0
 19596     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303138373638' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           CRTT-ID,
 19601           CERTIFICATE-TRAILERS,
 19602           DFHEIV11,
 19603           WS-ELCRTT-KEY,
 19604           DFHEIV99,
 19605           DFHEIV99
 19606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19607
 19608
 19609 8190-EXIT.
 19610     EXIT.
 19611
 19612 8195-UPDATE-AGE-FLAGS.
 19613
 19614* EXEC CICS HANDLE CONDITION
 19615*        NOTFND   (8195-NOTFND)
 19616*    END-EXEC.
 19617*    MOVE '"$I                   ! 1 #00018778' TO DFHEIV0
 19618     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 363
* EL050.cbl
 19619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19620     MOVE X'3120233030303138373738' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0
 19622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19623
 19624
 19625     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19626     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19627
 19628
 19629* EXEC CICS READ
 19630*        UPDATE
 19631*        DATASET  (CRTT-ID)
 19632*        RIDFLD   (WS-ELCRTT-KEY)
 19633*        INTO     (CERTIFICATE-TRAILERS)
 19634*    END-EXEC.
 19635     MOVE LENGTH OF
 19636      CERTIFICATE-TRAILERS
 19637       TO DFHEIV11
 19638*    MOVE '&"IL       EU         (   #00018785' TO DFHEIV0
 19639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19640     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19641     MOVE X'2020233030303138373835' TO DFHEIV0(25:11)
 19642     CALL 'kxdfhei1' USING DFHEIV0,
 19643           CRTT-ID,
 19644           CERTIFICATE-TRAILERS,
 19645           DFHEIV11,
 19646           WS-ELCRTT-KEY,
 19647           DFHEIV99,
 19648           DFHEIV99,
 19649           DFHEIV99
 19650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19651
 19652
 19653     IF WS-INS-AGE-SET = 'Y'
 19654        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19655     END-IF
 19656     IF WS-JNT-AGE-SET = 'Y'
 19657        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19658     END-IF
 19659
 19660
 19661* EXEC CICS REWRITE
 19662*       DATASET  (CRTT-ID)
 19663*       FROM     (CERTIFICATE-TRAILERS)
 19664*    END-EXEC.
 19665     MOVE LENGTH OF
 19666      CERTIFICATE-TRAILERS
 19667       TO DFHEIV11
 19668*    MOVE '&& L                  %   #00018799' TO DFHEIV0
 19669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19671     MOVE X'2020233030303138373939' TO DFHEIV0(25:11)
 19672     CALL 'kxdfhei1' USING DFHEIV0,
 19673           CRTT-ID,
 19674           CERTIFICATE-TRAILERS,
 19675           DFHEIV11,
 19676           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 364
* EL050.cbl
 19677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19678
 19679
 19680     GO TO 8195-EXIT.
 19681
 19682 8195-NOTFND.
 19683
 19684     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19685     MOVE 'CS'         TO CS-RECORD-ID.
 19686     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19687     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19688     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19689     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19690     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19691
 19692* EXEC CICS WRITE
 19693*       DATASET  (CRTT-ID)
 19694*       RIDFLD   (WS-ELCRTT-KEY)
 19695*       FROM     (CERTIFICATE-TRAILERS)
 19696*    END-EXEC.
 19697     MOVE LENGTH OF
 19698      CERTIFICATE-TRAILERS
 19699       TO DFHEIV11
 19700*    MOVE '&$ L                  ''   #00018815' TO DFHEIV0
 19701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19703     MOVE X'2020233030303138383135' TO DFHEIV0(25:11)
 19704     CALL 'kxdfhei1' USING DFHEIV0,
 19705           CRTT-ID,
 19706           CERTIFICATE-TRAILERS,
 19707           DFHEIV11,
 19708           WS-ELCRTT-KEY,
 19709           DFHEIV99,
 19710           DFHEIV99
 19711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19712
 19713
 19714 8195-EXIT.
 19715     EXIT.
 19716
 19717 8200-READ-REIN-TABLE.
 19718
 19719* EXEC CICS HANDLE CONDITION
 19720*         NOTFND   (8200-NOTFND)
 19721*    END-EXEC.
 19722*    MOVE '"$I                   ! 2 #00018825' TO DFHEIV0
 19723     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19725     MOVE X'3220233030303138383235' TO DFHEIV0(25:11)
 19726     CALL 'kxdfhei1' USING DFHEIV0
 19727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19728
 19729
 19730
 19731* EXEC CICS READ
 19732*        DATASET     (REIN-ID)
 19733*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19734*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 365
* EL050.cbl
 19735*    END-EXEC.
 19736*    MOVE '&"S        E          (   #00018829' TO DFHEIV0
 19737     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19739     MOVE X'2020233030303138383239' TO DFHEIV0(25:11)
 19740     CALL 'kxdfhei1' USING DFHEIV0,
 19741           REIN-ID,
 19742           DFHEIV20,
 19743           DFHEIV99,
 19744           ERREIN-KEY,
 19745           DFHEIV99,
 19746           DFHEIV99,
 19747           DFHEIV99
 19748     SET ADDRESS OF REINSURANCE-RECORD TO
 19749         DFHEIV20
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753     GO TO 8200-EXIT.
 19754
 19755 8200-NOTFND.
 19756     MOVE 'N'             TO WS-REIN-READ-SW.
 19757
 19758 8200-EXIT.
 19759      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 366
* EL050.cbl
 19761
 19762 8300-READ-CTBL-TABLE.
 19763
 19764* EXEC CICS HANDLE CONDITION
 19765*        NOTFND    (8300-NOTFND)
 19766*        DISABLED  (8300-ERRESS-PROBLEM)
 19767*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19768*        ENDFILE   (8300-NOTFND)
 19769*    END-EXEC.
 19770*    MOVE '"$IcJ''                ! 3 #00018845' TO DFHEIV0
 19771     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19773     MOVE X'3320233030303138383435' TO DFHEIV0(25:11)
 19774     CALL 'kxdfhei1' USING DFHEIV0
 19775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19776
 19777
 19778
 19779* EXEC CICS READ
 19780*        DATASET     (CTBL-ID)
 19781*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19782*        RIDFLD      (ERCTBL-KEY)
 19783*    END-EXEC.
 19784*    MOVE '&"S        E          (   #00018852' TO DFHEIV0
 19785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19787     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19788     CALL 'kxdfhei1' USING DFHEIV0,
 19789           CTBL-ID,
 19790           DFHEIV20,
 19791           DFHEIV99,
 19792           ERCTBL-KEY,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99
 19796     SET ADDRESS OF COMM-TABLE-RECORD TO
 19797         DFHEIV20
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19802
 19803     GO TO 8300-EXIT.
 19804
 19805 8300-NOTFND.
 19806
 19807     IF CTBL-SW = '0530'
 19808         MOVE 'AA'                     TO WS-AH-COMP-CD
 19809         MOVE '0550'                   TO CTBL-SW
 19810         MOVE '1'                      TO WS-CTBL-READ-SW
 19811         GO TO 8300-EXIT.
 19812
 19813     IF CTBL-SW = '0540'
 19814         MOVE 'AA'                     TO WS-LF-COMP-CD
 19815         MOVE '0550'                   TO CTBL-SW
 19816         MOVE '1'                      TO WS-CTBL-READ-SW
 19817         GO TO 8300-EXIT.
 19818
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 367
* EL050.cbl
 19819     IF CTBL-SW = '0550'
 19820         MOVE '2'                      TO WS-CTBL-READ-SW
 19821         GO TO 8300-EXIT.
 19822
 19823     GO TO 8300-EXIT.
 19824
 19825 8300-ERRESS-PROBLEM.
 19826
 19827      MOVE ER-8050              TO WS-ERROR.
 19828      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19829
 19830     GO TO 8300-EXIT.
 19831
 19832 8300-EXIT.
 19833      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 368
* EL050.cbl
 19835
 19836
 19837 8400-GETMAIN-ERFORM.
 19838
 19839
 19840* EXEC CICS   GETMAIN
 19841*        LENGTH  (500)
 19842*        SET     (ADDRESS OF FORM-MASTER)
 19843*    END-EXEC.
 19844     MOVE 500
 19845       TO DFHEIV11
 19846*    MOVE '," L                  $   #00018896' TO DFHEIV0
 19847     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19848     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19849     MOVE X'2020233030303138383936' TO DFHEIV0(25:11)
 19850     CALL 'kxdfhei1' USING DFHEIV0,
 19851           DFHEIV20,
 19852           DFHEIV11,
 19853           DFHEIV99
 19854     SET ADDRESS OF FORM-MASTER TO
 19855         DFHEIV20
 19856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19857
 19858
 19859     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19860
 19861 8400-EXIT.
 19862      EXIT.
 19863
 19864 8450-READ-FORM-MASTER.
 19865
 19866
 19867* EXEC CICS  HANDLE CONDITION
 19868*        NOTFND   (8450-FORM-NOT-FOUND)
 19869*        ENDFILE  (8450-FORM-NOT-FOUND)
 19870*    END-EXEC.
 19871*    MOVE '"$I''                  ! 4 #00018908' TO DFHEIV0
 19872     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19874     MOVE X'3420233030303138393038' TO DFHEIV0(25:11)
 19875     CALL 'kxdfhei1' USING DFHEIV0
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19877
 19878
 19879
 19880* EXEC CICS   READ
 19881*        DATASET   (FORM-ID)
 19882*        RIDFLD    (ERFORM-KEY)
 19883*        INTO      (FORM-MASTER)
 19884*        GTEQ
 19885*    END-EXEC.
 19886     MOVE LENGTH OF
 19887      FORM-MASTER
 19888       TO DFHEIV11
 19889*    MOVE '&"IL       G          (   #00018913' TO DFHEIV0
 19890     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19892     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 369
* EL050.cbl
 19893     CALL 'kxdfhei1' USING DFHEIV0,
 19894           FORM-ID,
 19895           FORM-MASTER,
 19896           DFHEIV11,
 19897           ERFORM-KEY,
 19898           DFHEIV99,
 19899           DFHEIV99,
 19900           DFHEIV99
 19901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19902
 19903
 19904     MOVE  'Y'           TO  FORM-MASTER-SW.
 19905
 19906     GO TO  8450-EXIT.
 19907
 19908 8450-FORM-NOT-FOUND.
 19909
 19910     MOVE  'N'           TO  FORM-MASTER-SW.
 19911
 19912 8450-EXIT.
 19913      EXIT.
 19914
 19915 8500-DATE-CONVERT.
 19916
 19917* EXEC CICS LINK
 19918*        PROGRAM    ('ELDATCV')
 19919*        COMMAREA   (DATE-CONVERSION-DATA)
 19920*        LENGTH     (DC-COMM-LENGTH)
 19921*    END-EXEC.
 19922     MOVE 'ELDATCV' TO DFHEIV1
 19923*    MOVE '."C                   (   #00018932' TO DFHEIV0
 19924     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19926     MOVE X'2020233030303138393332' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           DFHEIV1,
 19929           DATE-CONVERSION-DATA,
 19930           DC-COMM-LENGTH,
 19931           DFHEIV99,
 19932           DFHEIV99,
 19933           DFHEIV99,
 19934           DFHEIV99
 19935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19936
 19937
 19938 8500-EXIT.
 19939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 370
* EL050.cbl
 19941
 19942 8555-RELOAD-CONTROL-FILE.
 19943     CONTINUE.
 19944
 19945 8555-EXIT.
 19946     EXIT.
 19947
 19948 8557-GETMAIN-ERPLAN.
 19949
 19950
 19951* EXEC CICS GETMAIN
 19952*        LENGTH    (840)
 19953*        SET       (ADDRESS OF PLAN-RECORDS)
 19954*    END-EXEC.
 19955     MOVE 840
 19956       TO DFHEIV11
 19957*    MOVE '," L                  $   #00018950' TO DFHEIV0
 19958     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19959     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19960     MOVE X'2020233030303138393530' TO DFHEIV0(25:11)
 19961     CALL 'kxdfhei1' USING DFHEIV0,
 19962           DFHEIV20,
 19963           DFHEIV11,
 19964           DFHEIV99
 19965     SET ADDRESS OF PLAN-RECORDS TO
 19966         DFHEIV20
 19967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19968
 19969
 19970     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19971
 19972 8557-EXIT.
 19973     EXIT.
 19974
 19975 8560-GETMAIN.
 19976
 19977* EXEC CICS GETMAIN
 19978*        LENGTH    (2000)
 19979*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19980*    END-EXEC.
 19981     MOVE 2000
 19982       TO DFHEIV11
 19983*    MOVE '," L                  $   #00018961' TO DFHEIV0
 19984     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19985     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19986     MOVE X'2020233030303138393631' TO DFHEIV0(25:11)
 19987     CALL 'kxdfhei1' USING DFHEIV0,
 19988           DFHEIV20,
 19989           DFHEIV11,
 19990           DFHEIV99
 19991     SET ADDRESS OF ACCOUNT-MASTER TO
 19992         DFHEIV20
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19994
 19995
 19996     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19997
 19998 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 371
* EL050.cbl
 19999     EXIT.
 20000
 20001 8570-START-ACCOUNT-MASTER.
 20002
 20003* EXEC CICS HANDLE CONDITION
 20004*        NOTFND    (0199-ACCT-NOT-FOUND)
 20005*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20006*    END-EXEC.
 20007*    MOVE '"$I''                  ! 5 #00018972' TO DFHEIV0
 20008     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20010     MOVE X'3520233030303138393732' TO DFHEIV0(25:11)
 20011     CALL 'kxdfhei1' USING DFHEIV0
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20013
 20014
 20015
 20016* EXEC CICS STARTBR
 20017*        DATASET    (ACCT-ID)
 20018*        RIDFLD     (ERACCT-KEY)
 20019*        GTEQ
 20020*    END-EXEC.
 20021     MOVE 0
 20022       TO DFHEIV11
 20023*    MOVE '&,         G          &   #00018977' TO DFHEIV0
 20024     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20026     MOVE X'2020233030303138393737' TO DFHEIV0(25:11)
 20027     CALL 'kxdfhei1' USING DFHEIV0,
 20028           ACCT-ID,
 20029           ERACCT-KEY,
 20030           DFHEIV99,
 20031           DFHEIV11,
 20032           DFHEIV99
 20033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20034
 20035
 20036 8570-EXIT.
 20037     EXIT.
 20038
 20039 8580-READ-ACCOUNT-MASTER.
 20040
 20041* EXEC CICS HANDLE CONDITION
 20042*        NOTFND    (0199-ACCT-NOT-FOUND)
 20043*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20044*    END-EXEC.
 20045*    MOVE '"$I''                  ! 6 #00018987' TO DFHEIV0
 20046     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20048     MOVE X'3620233030303138393837' TO DFHEIV0(25:11)
 20049     CALL 'kxdfhei1' USING DFHEIV0
 20050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20051
 20052
 20053
 20054* EXEC CICS READNEXT
 20055*        DATASET     (ACCT-ID)
 20056*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 372
* EL050.cbl
 20057*        RIDFLD      (ERACCT-KEY)
 20058*    END-EXEC.
 20059     MOVE LENGTH OF
 20060      ACCOUNT-MASTER
 20061       TO DFHEIV12
 20062     MOVE 0
 20063       TO DFHEIV11
 20064*    MOVE '&.IL                  )   #00018992' TO DFHEIV0
 20065     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20067     MOVE X'2020233030303138393932' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0,
 20069           ACCT-ID,
 20070           ACCOUNT-MASTER,
 20071           DFHEIV12,
 20072           ERACCT-KEY,
 20073           DFHEIV99,
 20074           DFHEIV11,
 20075           DFHEIV99,
 20076           DFHEIV99
 20077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20078
 20079
 20080 8580-EXIT.
 20081     EXIT.
 20082
 20083 8582-READ-COMPENSATION-MASTER.
 20084
 20085* EXEC CICS HANDLE CONDITION
 20086*        NOTFND    (8582-COMP-NOT-FOUND)
 20087*        ENDFILE   (8582-COMP-NOT-FOUND)
 20088*    END-EXEC.
 20089*    MOVE '"$I''                  ! 7 #00019002' TO DFHEIV0
 20090     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20092     MOVE X'3720233030303139303032' TO DFHEIV0(25:11)
 20093     CALL 'kxdfhei1' USING DFHEIV0
 20094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20095
 20096
 20097
 20098* EXEC CICS READ
 20099*        DATASET     (COMP-ID)
 20100*        INTO        (COMPENSATION-MASTER)
 20101*        RIDFLD      (ERCOMP-KEY)
 20102*    END-EXEC.
 20103     MOVE LENGTH OF
 20104      COMPENSATION-MASTER
 20105       TO DFHEIV11
 20106*    MOVE '&"IL       E          (   #00019007' TO DFHEIV0
 20107     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20109     MOVE X'2020233030303139303037' TO DFHEIV0(25:11)
 20110     CALL 'kxdfhei1' USING DFHEIV0,
 20111           COMP-ID,
 20112           COMPENSATION-MASTER,
 20113           DFHEIV11,
 20114           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 373
* EL050.cbl
 20115           DFHEIV99,
 20116           DFHEIV99,
 20117           DFHEIV99
 20118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20119
 20120
 20121     MOVE 'Y'                    TO COMP-MASTER-SW
 20122
 20123     GO TO 8582-EXIT
 20124     .
 20125 8582-COMP-NOT-FOUND.
 20126
 20127     MOVE 'N'                    TO COMP-MASTER-SW.
 20128
 20129 8582-EXIT.
 20130     EXIT.
 20131
 20132 8583-READ-ERAGTC.
 20133
 20134* EXEC CICS HANDLE CONDITION
 20135*        NOTFND    (8583-AGTC-NOT-FOUND)
 20136*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20137*    END-EXEC.
 20138*    MOVE '"$I''                  ! 8 #00019025' TO DFHEIV0
 20139     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20141     MOVE X'3820233030303139303235' TO DFHEIV0(25:11)
 20142     CALL 'kxdfhei1' USING DFHEIV0
 20143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20144
 20145
 20146
 20147* EXEC CICS STARTBR
 20148*        DATASET    (AGTC-ID)
 20149*        RIDFLD     (ERAGTC-KEY)
 20150*        GTEQ
 20151*    END-EXEC.
 20152     MOVE 0
 20153       TO DFHEIV11
 20154*    MOVE '&,         G          &   #00019030' TO DFHEIV0
 20155     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303139303330' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           AGTC-ID,
 20160           ERAGTC-KEY,
 20161           DFHEIV99,
 20162           DFHEIV11,
 20163           DFHEIV99
 20164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20165
 20166
 20167 8583-READ-ERAGTC-NEXT.
 20168
 20169* EXEC CICS READNEXT
 20170*        DATASET     (AGTC-ID)
 20171*        INTO        (AGENT-COMMISSIONS)
 20172*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 374
* EL050.cbl
 20173*    END-EXEC.
 20174     MOVE LENGTH OF
 20175      AGENT-COMMISSIONS
 20176       TO DFHEIV12
 20177     MOVE 0
 20178       TO DFHEIV11
 20179*    MOVE '&.IL                  )   #00019037' TO DFHEIV0
 20180     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20182     MOVE X'2020233030303139303337' TO DFHEIV0(25:11)
 20183     CALL 'kxdfhei1' USING DFHEIV0,
 20184           AGTC-ID,
 20185           AGENT-COMMISSIONS,
 20186           DFHEIV12,
 20187           ERAGTC-KEY,
 20188           DFHEIV99,
 20189           DFHEIV11,
 20190           DFHEIV99,
 20191           DFHEIV99
 20192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20193
 20194
 20195*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20196
 20197     GO TO 8583-EXIT
 20198     .
 20199 8583-AGTC-NOT-FOUND.
 20200
 20201     MOVE 'N'                    TO AGTC-MASTER-SW.
 20202
 20203 8583-EXIT.
 20204     EXIT.
 20205
 20206 8584-READ-BANK-CROSS-REF.
 20207
 20208* EXEC CICS HANDLE CONDITION
 20209*        NOTFND    (8584-BXRF-NOT-FOUND)
 20210*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20211*    END-EXEC.
 20212*    MOVE '"$I''                  ! 9 #00019055' TO DFHEIV0
 20213     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20215     MOVE X'3920233030303139303535' TO DFHEIV0(25:11)
 20216     CALL 'kxdfhei1' USING DFHEIV0
 20217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20218
 20219
 20220
 20221* EXEC CICS READ
 20222*        DATASET     (BXRF-ID)
 20223*        INTO        (BANK-CROSS-REFERENCE)
 20224*        RIDFLD      (ERBXRF-KEY)
 20225*        LENGTH      (BXRF-REC-LENGTH)
 20226*    END-EXEC.
 20227*    MOVE '&"IL       E          (   #00019060' TO DFHEIV0
 20228     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20230     MOVE X'2020233030303139303630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 375
* EL050.cbl
 20231     CALL 'kxdfhei1' USING DFHEIV0,
 20232           BXRF-ID,
 20233           BANK-CROSS-REFERENCE,
 20234           BXRF-REC-LENGTH,
 20235           ERBXRF-KEY,
 20236           DFHEIV99,
 20237           DFHEIV99,
 20238           DFHEIV99
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242     MOVE 'Y'                    TO BXRF-MASTER-SW
 20243
 20244     GO TO 8584-EXIT
 20245     .
 20246 8584-BXRF-NOT-FOUND.
 20247
 20248     MOVE 'N'                    TO BXRF-MASTER-SW.
 20249
 20250 8584-EXIT.
 20251     EXIT.
 20252
 20253 8585-READ-PLAN-MASTER.
 20254
 20255
 20256* EXEC CICS HANDLE CONDITION
 20257*        NOTFND    (8585-PLAN-NOT-FOUND)
 20258*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20259*    END-EXEC.
 20260*    MOVE '"$I''                  ! : #00019080' TO DFHEIV0
 20261     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20263     MOVE X'3A20233030303139303830' TO DFHEIV0(25:11)
 20264     CALL 'kxdfhei1' USING DFHEIV0
 20265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20266
 20267
 20268
 20269* EXEC CICS READ
 20270*        DATASET     (PLAN-ID)
 20271*        INTO        (PLAN-MASTER)
 20272*        RIDFLD      (ERPLAN-KEY)
 20273*    END-EXEC.
 20274     MOVE LENGTH OF
 20275      PLAN-MASTER
 20276       TO DFHEIV11
 20277*    MOVE '&"IL       E          (   #00019085' TO DFHEIV0
 20278     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20280     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
 20281     CALL 'kxdfhei1' USING DFHEIV0,
 20282           PLAN-ID,
 20283           PLAN-MASTER,
 20284           DFHEIV11,
 20285           ERPLAN-KEY,
 20286           DFHEIV99,
 20287           DFHEIV99,
 20288           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 376
* EL050.cbl
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20293
 20294     GO TO 8585-EXIT.
 20295
 20296 8585-PLAN-NOT-FOUND.
 20297
 20298     MOVE 'N'                    TO PLAN-MASTER-SW.
 20299
 20300 8585-EXIT.
 20301     EXIT.
 20302
 20303 8586-READ-LOAN-OFFICER.
 20304
 20305* EXEC CICS READ
 20306*        DATASET     (LOFC-ID)
 20307*        INTO        (LOAN-OFFICER-MASTER)
 20308*        RIDFLD      (ERLOFC-KEY)
 20309*        RESP        (WS-RESPONSE)
 20310*    END-EXEC
 20311     MOVE LENGTH OF
 20312      LOAN-OFFICER-MASTER
 20313       TO DFHEIV11
 20314*    MOVE '&"IL       E          (  N#00019103' TO DFHEIV0
 20315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20317     MOVE X'204E233030303139313033' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           LOFC-ID,
 20320           LOAN-OFFICER-MASTER,
 20321           DFHEIV11,
 20322           ERLOFC-KEY,
 20323           DFHEIV99,
 20324           DFHEIV99,
 20325           DFHEIV99
 20326     MOVE EIBRESP  TO WS-RESPONSE
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20328
 20329     IF WS-RESP-NORMAL
 20330        MOVE 'Y'                 TO LOFC-MASTER-SW
 20331     ELSE
 20332        MOVE 'N'                 TO LOFC-MASTER-SW
 20333     END-IF
 20334     .
 20335 8586-EXIT.
 20336     EXIT.
 20337 8587-START-ERPDEF.
 20338
 20339* EXEC CICS STARTBR
 20340*       DATASET   (PDEF-ID)
 20341*       RIDFLD    (ERPDEF-KEY)
 20342*       GTEQ
 20343*       RESP      (WS-RESPONSE)
 20344*    END-EXEC
 20345     MOVE 0
 20346       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 377
* EL050.cbl
 20347*    MOVE '&,         G          &  N#00019119' TO DFHEIV0
 20348     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20350     MOVE X'204E233030303139313139' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
 20352           PDEF-ID,
 20353           ERPDEF-KEY,
 20354           DFHEIV99,
 20355           DFHEIV11,
 20356           DFHEIV99
 20357     MOVE EIBRESP  TO WS-RESPONSE
 20358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20359     IF WS-RESP-NORMAL
 20360        MOVE 'Y'                 TO PDEF-MASTER-SW
 20361     ELSE
 20362        MOVE 'N'                 TO PDEF-MASTER-SW
 20363     END-IF
 20364     .
 20365 8587-EXIT.
 20366     EXIT.
 20367 8588-READ-ERPDEF.
 20368
 20369* EXEC CICS READNEXT
 20370*       DATASET   (PDEF-ID)
 20371*       RIDFLD    (ERPDEF-KEY)
 20372*       INTO      (PRODUCT-MASTER)
 20373*       RESP      (WS-RESPONSE)
 20374*    END-EXEC
 20375     MOVE LENGTH OF
 20376      PRODUCT-MASTER
 20377       TO DFHEIV12
 20378     MOVE 0
 20379       TO DFHEIV11
 20380*    MOVE '&.IL                  )  N#00019134' TO DFHEIV0
 20381     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20382     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20383     MOVE X'204E233030303139313334' TO DFHEIV0(25:11)
 20384     CALL 'kxdfhei1' USING DFHEIV0,
 20385           PDEF-ID,
 20386           PRODUCT-MASTER,
 20387           DFHEIV12,
 20388           ERPDEF-KEY,
 20389           DFHEIV99,
 20390           DFHEIV11,
 20391           DFHEIV99,
 20392           DFHEIV99
 20393     MOVE EIBRESP  TO WS-RESPONSE
 20394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20395     IF WS-RESP-NORMAL
 20396        MOVE 'Y'                 TO PDEF-MASTER-SW
 20397     ELSE
 20398        MOVE 'N'                 TO PDEF-MASTER-SW
 20399     END-IF
 20400     .
 20401 8588-EXIT.
 20402     EXIT.
 20403 8589-ENDBR-ERPDEF.
 20404
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 378
* EL050.cbl
 20405* EXEC CICS ENDBR
 20406*       DATASET   (PDEF-ID)
 20407*    END-EXEC
 20408     MOVE 0
 20409       TO DFHEIV11
 20410*    MOVE '&2                    $   #00019149' TO DFHEIV0
 20411     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20413     MOVE X'2020233030303139313439' TO DFHEIV0(25:11)
 20414     CALL 'kxdfhei1' USING DFHEIV0,
 20415           PDEF-ID,
 20416           DFHEIV11,
 20417           DFHEIV99
 20418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20419     .
 20420 8589-EXIT.
 20421     EXIT.
 20422 8590-READ-CERT-MASTER.
 20423     IF PB-COMPANY-ID = 'UCL'
 20424         GO TO 8690-READ-CERT-MASTER-UCL.
 20425
 20426
 20427* EXEC CICS HANDLE CONDITION
 20428*         NOTFND    (0299-CERT-NOT-FOUND)
 20429*    END-EXEC.
 20430*    MOVE '"$I                   ! ; #00019159' TO DFHEIV0
 20431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20433     MOVE X'3B20233030303139313539' TO DFHEIV0(25:11)
 20434     CALL 'kxdfhei1' USING DFHEIV0
 20435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20436
 20437
 20438
 20439* EXEC CICS READ
 20440*        DATASET     (CERT-ID)
 20441*        INTO        (CERTIFICATE-MASTER)
 20442*        RIDFLD      (ELCERT-KEY)
 20443*        UPDATE
 20444*    END-EXEC.
 20445     MOVE LENGTH OF
 20446      CERTIFICATE-MASTER
 20447       TO DFHEIV11
 20448*    MOVE '&"IL       EU         (   #00019163' TO DFHEIV0
 20449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303139313633' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           CERT-ID,
 20454           CERTIFICATE-MASTER,
 20455           DFHEIV11,
 20456           ELCERT-KEY,
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99
 20460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20461
 20462
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 379
* EL050.cbl
 20463 8590-EXIT.
 20464     EXIT.
 20465
 20466 8690-READ-CERT-MASTER-UCL.
 20467
 20468* EXEC CICS HANDLE CONDITION
 20469*         NOTFND    (8700-READ-CERT-MASTER)
 20470*    END-EXEC.
 20471*    MOVE '"$I                   ! < #00019174' TO DFHEIV0
 20472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20474     MOVE X'3C20233030303139313734' TO DFHEIV0(25:11)
 20475     CALL 'kxdfhei1' USING DFHEIV0
 20476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20477
 20478
 20479 8690-READ-CERT-CONT.
 20480
 20481* EXEC CICS READ
 20482*        DATASET     (CERT-ID)
 20483*        INTO        (CERTIFICATE-MASTER)
 20484*        RIDFLD      (ELCERT-KEY)
 20485*        UPDATE
 20486*    END-EXEC.
 20487     MOVE LENGTH OF
 20488      CERTIFICATE-MASTER
 20489       TO DFHEIV11
 20490*    MOVE '&"IL       EU         (   #00019179' TO DFHEIV0
 20491     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20493     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 20494     CALL 'kxdfhei1' USING DFHEIV0,
 20495           CERT-ID,
 20496           CERTIFICATE-MASTER,
 20497           DFHEIV11,
 20498           ELCERT-KEY,
 20499           DFHEIV99,
 20500           DFHEIV99,
 20501           DFHEIV99
 20502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20503
 20504
 20505     GO TO 8590-EXIT.
 20506
 20507 8700-READ-CERT-MASTER.
 20508     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20509     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20510
 20511* EXEC CICS HANDLE CONDITION
 20512*         DUPKEY    (8720-COMP-ACCOUNTS)
 20513*         ENDFILE   (8730-END-BROWSE)
 20514*         NOTFND    (8740-NOT-FOUND)
 20515*    END-EXEC.
 20516*    MOVE '"$$''I                 ! = #00019191' TO DFHEIV0
 20517     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20519     MOVE X'3D20233030303139313931' TO DFHEIV0(25:11)
 20520     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 380
* EL050.cbl
 20521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20522
 20523
 20524
 20525* EXEC CICS STARTBR
 20526*        DATASET     ('ELCERT5')
 20527*        RIDFLD      (ELCERT2-KEY)
 20528*        EQUAL
 20529*    END-EXEC.
 20530     MOVE 'ELCERT5' TO DFHEIV1
 20531     MOVE 0
 20532       TO DFHEIV11
 20533*    MOVE '&,         E          &   #00019197' TO DFHEIV0
 20534     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20536     MOVE X'2020233030303139313937' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0,
 20538           DFHEIV1,
 20539           ELCERT2-KEY,
 20540           DFHEIV99,
 20541           DFHEIV11,
 20542           DFHEIV99
 20543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20544
 20545
 20546 8710-READ-NEXT.
 20547
 20548* EXEC CICS READNEXT
 20549*        DATASET     ('ELCERT5')
 20550*        INTO        (CERTIFICATE-MASTER)
 20551*        RIDFLD      (ELCERT2-KEY)
 20552*    END-EXEC.
 20553     MOVE LENGTH OF
 20554      CERTIFICATE-MASTER
 20555       TO DFHEIV12
 20556     MOVE 'ELCERT5' TO DFHEIV1
 20557     MOVE 0
 20558       TO DFHEIV11
 20559*    MOVE '&.IL                  )   #00019204' TO DFHEIV0
 20560     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303139323034' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           DFHEIV1,
 20565           CERTIFICATE-MASTER,
 20566           DFHEIV12,
 20567           ELCERT2-KEY,
 20568           DFHEIV99,
 20569           DFHEIV11,
 20570           DFHEIV99,
 20571           DFHEIV99
 20572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20573
 20574
 20575 8720-COMP-ACCOUNTS.
 20576
 20577* EXEC CICS ENTER
 20578*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 381
* EL050.cbl
 20579*         FROM (PB-C-LAST-NAME)
 20580*    END-EXEC.
 20581     MOVE 001
 20582       TO DFHEIV11
 20583*    MOVE ':$F                   %   #00019211' TO DFHEIV0
 20584     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20585     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20586     MOVE X'2020233030303139323131' TO DFHEIV0(25:11)
 20587     CALL 'kxdfhei1' USING DFHEIV0,
 20588           DFHEIV11,
 20589           PB-C-LAST-NAME,
 20590           DFHEIV99,
 20591           DFHEIV99
 20592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20593
 20594
 20595
 20596* EXEC CICS ENTER
 20597*         TRACEID (002)
 20598*         FROM (CM-INSURED-LAST-NAME)
 20599*    END-EXEC.
 20600     MOVE 002
 20601       TO DFHEIV11
 20602*    MOVE ':$F                   %   #00019216' TO DFHEIV0
 20603     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20604     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20605     MOVE X'2020233030303139323136' TO DFHEIV0(25:11)
 20606     CALL 'kxdfhei1' USING DFHEIV0,
 20607           DFHEIV11,
 20608           CM-INSURED-LAST-NAME,
 20609           DFHEIV99,
 20610           DFHEIV99
 20611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20612
 20613
 20614     IF PB-CERT-NO NOT = CM-CERT-NO
 20615         GO TO 8730-END-BROWSE.
 20616
 20617     IF PB-ACCOUNT = CM-ACCOUNT
 20618         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20619             MOVE ER-2799        TO WS-ERROR
 20620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20621             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20622             GO TO 8730-END-BROWSE.
 20623
 20624     GO TO 8710-READ-NEXT.
 20625
 20626 8730-END-BROWSE.
 20627
 20628* EXEC CICS ENDBR
 20629*         DATASET    ('ELCERT5')
 20630*    END-EXEC.
 20631     MOVE 'ELCERT5' TO DFHEIV1
 20632     MOVE 0
 20633       TO DFHEIV11
 20634*    MOVE '&2                    $   #00019234' TO DFHEIV0
 20635     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 382
* EL050.cbl
 20637     MOVE X'2020233030303139323334' TO DFHEIV0(25:11)
 20638     CALL 'kxdfhei1' USING DFHEIV0,
 20639           DFHEIV1,
 20640           DFHEIV11,
 20641           DFHEIV99
 20642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20643
 20644
 20645 8740-NOT-FOUND.
 20646     GO TO 0299-CERT-NOT-FOUND.
 20647
 20648 8750-START-ELSTAT.
 20649
 20650* EXEC CICS STARTBR
 20651*       DATASET   (STAT-ID)
 20652*       RIDFLD    (ELSTAT-KEY)
 20653*       GTEQ
 20654*       RESP      (WS-RESPONSE)
 20655*    END-EXEC
 20656     MOVE 0
 20657       TO DFHEIV11
 20658*    MOVE '&,         G          &  N#00019242' TO DFHEIV0
 20659     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20661     MOVE X'204E233030303139323432' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           STAT-ID,
 20664           ELSTAT-KEY,
 20665           DFHEIV99,
 20666           DFHEIV11,
 20667           DFHEIV99
 20668     MOVE EIBRESP  TO WS-RESPONSE
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20670     IF WS-RESP-NORMAL
 20671        MOVE 'Y'                 TO STAT-MASTER-SW
 20672     ELSE
 20673        MOVE 'N'                 TO STAT-MASTER-SW
 20674     END-IF
 20675     .
 20676 8750-EXIT.
 20677     EXIT.
 20678 8752-READ-ELSTAT.
 20679
 20680* EXEC CICS READNEXT
 20681*       DATASET   (STAT-ID)
 20682*       RIDFLD    (ELSTAT-KEY)
 20683*       INTO      (STATE-FILE)
 20684*       RESP      (WS-RESPONSE)
 20685*    END-EXEC
 20686     MOVE LENGTH OF
 20687      STATE-FILE
 20688       TO DFHEIV12
 20689     MOVE 0
 20690       TO DFHEIV11
 20691*    MOVE '&.IL                  )  N#00019257' TO DFHEIV0
 20692     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20694     MOVE X'204E233030303139323537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 383
* EL050.cbl
 20695     CALL 'kxdfhei1' USING DFHEIV0,
 20696           STAT-ID,
 20697           STATE-FILE,
 20698           DFHEIV12,
 20699           ELSTAT-KEY,
 20700           DFHEIV99,
 20701           DFHEIV11,
 20702           DFHEIV99,
 20703           DFHEIV99
 20704     MOVE EIBRESP  TO WS-RESPONSE
 20705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20706     IF WS-RESP-NORMAL
 20707        MOVE 'Y'                 TO STAT-MASTER-SW
 20708     ELSE
 20709        MOVE 'N'                 TO STAT-MASTER-SW
 20710     END-IF
 20711     .
 20712 8752-EXIT.
 20713     EXIT.
 20714 8800-GET-COMP-RATE.
 20715     MOVE +1 TO IB.
 20716     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20717         ADD +9 TO IB
 20718         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20719             ADD +9 TO IB
 20720             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20721                MOVE ZEROS       TO WS-WK-RATE
 20722                GO TO 8800-EXIT.
 20723
 20724     IF PB-I-AGE GREATER CT-AGE (1)
 20725         ADD +3 TO IB
 20726         IF PB-I-AGE GREATER CT-AGE (2)
 20727             ADD +3 TO IB
 20728             IF PB-I-AGE GREATER CT-AGE (3)
 20729                MOVE ZEROS       TO WS-WK-RATE
 20730                GO TO 8800-EXIT.
 20731
 20732     IF WS-WORK-TERM GREATER CT-TRM (1)
 20733         ADD +1 TO IB
 20734         IF WS-WORK-TERM GREATER CT-TRM (2)
 20735             ADD +1 TO IB
 20736             IF WS-WORK-TERM GREATER CT-TRM (3)
 20737                MOVE ZEROS       TO WS-WK-RATE
 20738                GO TO 8800-EXIT.
 20739
 20740     IF CT-RT (IB) NOT NUMERIC
 20741         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20742         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20743         GO TO 8800-GET-COMP-RATE.
 20744
 20745     MOVE CT-RT (IB) TO WS-WK-RATE.
 20746
 20747 8800-EXIT.
 20748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 384
* EL050.cbl
 20750 8900-ADDRESS-FILE.
 20751     IF ERACCT-FILE-ADDRESSED
 20752         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20753         GO TO 8900-ADDRESS-EXIT.
 20754
 20755     IF ELCNTL-FILE-ADDRESSED
 20756         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20757         GO TO 8900-ADDRESS-EXIT.
 20758
 20759     IF ERPLAN-FILE-ADDRESSED
 20760         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20761         GO TO 8900-ADDRESS-EXIT.
 20762
 20763     IF ERFORM-FILE-ADDRESSED
 20764         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20765         GO TO 8900-ADDRESS-EXIT.
 20766
 20767 8900-ADDRESS-EXIT.
 20768     EXIT.
 20769
 20770 9000-READ-CONTROL.
 20771
 20772* EXEC CICS HANDLE CONDITION
 20773*        NOTFND    (9000-NOTFND)
 20774*    END-EXEC.
 20775*    MOVE '"$I                   ! > #00019328' TO DFHEIV0
 20776     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20778     MOVE X'3E20233030303139333238' TO DFHEIV0(25:11)
 20779     CALL 'kxdfhei1' USING DFHEIV0
 20780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20781
 20782
 20783
 20784* EXEC CICS READ
 20785*        DATASET     (CNTL-ID)
 20786*        SET         (ADDRESS OF CONTROL-FILE)
 20787*        RIDFLD      (ELCNTL-KEY)
 20788*        GTEQ
 20789*    END-EXEC.
 20790*    MOVE '&"S        G          (   #00019332' TO DFHEIV0
 20791     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20793     MOVE X'2020233030303139333332' TO DFHEIV0(25:11)
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           CNTL-ID,
 20796           DFHEIV20,
 20797           DFHEIV99,
 20798           ELCNTL-KEY,
 20799           DFHEIV99,
 20800           DFHEIV99,
 20801           DFHEIV99
 20802     SET ADDRESS OF CONTROL-FILE TO
 20803         DFHEIV20
 20804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20805
 20806
 20807     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 385
* EL050.cbl
 20808
 20809 9000-NOTFND.
 20810     IF RC-SW-1 = '1'
 20811        MOVE ER-2616              TO WS-ERROR
 20812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20813        GO TO 9000-EXIT.
 20814
 20815     IF RC-SW-1 = '2'
 20816        MOVE ER-2602              TO WS-ERROR
 20817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20818
 20819 9000-EXIT.
 20820      EXIT.
 20821
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 386
* EL050.cbl
 20823 9100-READ-CONTROL.
 20824
 20825* EXEC CICS HANDLE CONDITION
 20826*        NOTFND  (9100-NOTFND)
 20827*        ENDFILE (9100-NOTFND)
 20828*    END-EXEC.
 20829*    MOVE '"$I''                  ! ? #00019356' TO DFHEIV0
 20830     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20832     MOVE X'3F20233030303139333536' TO DFHEIV0(25:11)
 20833     CALL 'kxdfhei1' USING DFHEIV0
 20834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20835
 20836
 20837
 20838* EXEC CICS READ
 20839*        DATASET     (CNTL-ID)
 20840*        INTO        (CONTROL-FILE)
 20841*        RIDFLD      (ELCNTL-KEY)
 20842*        GTEQ
 20843*    END-EXEC.
 20844     MOVE LENGTH OF
 20845      CONTROL-FILE
 20846       TO DFHEIV11
 20847*    MOVE '&"IL       G          (   #00019361' TO DFHEIV0
 20848     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20850     MOVE X'2020233030303139333631' TO DFHEIV0(25:11)
 20851     CALL 'kxdfhei1' USING DFHEIV0,
 20852           CNTL-ID,
 20853           CONTROL-FILE,
 20854           DFHEIV11,
 20855           ELCNTL-KEY,
 20856           DFHEIV99,
 20857           DFHEIV99,
 20858           DFHEIV99
 20859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20860
 20861
 20862     GO TO 9100-EXIT.
 20863
 20864 9100-NOTFND.
 20865     IF RC-SW-2 = '0'
 20866        MOVE '1'                  TO STATE-RECORD-ERROR
 20867        GO TO 9100-EXIT
 20868     END-IF
 20869     IF RC-SW-2 = '1'
 20870        MOVE '1'                  TO LF-BENEFIT-ERROR
 20871        MOVE ER-2604              TO WS-ERROR
 20872        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20873        GO TO 9100-EXIT.
 20874
 20875     IF RC-SW-2 = '2'
 20876        MOVE '1'                  TO AH-BENEFIT-ERROR
 20877        MOVE ER-2605              TO WS-ERROR
 20878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20879        GO TO 9100-EXIT.
 20880
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 387
* EL050.cbl
 20881     IF RC-SW-2 = '3'
 20882         MOVE ER-2603           TO WS-ERROR
 20883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20884         GO TO 9100-EXIT.
 20885
 20886     IF RC-SW-2 = '4'
 20887         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20888         GO TO 9100-EXIT.
 20889
 20890     IF RC-SW-2 = '5'
 20891         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20892         IF WS-AH-INPUT-CD-1 = SPACE
 20893             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20894         ELSE
 20895             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20896
 20897 9100-EXIT.
 20898      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 388
* EL050.cbl
 20900 9200-CONTROL-GETMAIN.
 20901
 20902* EXEC CICS GETMAIN
 20903*         LENGTH   (750)
 20904*         SET      (ADDRESS OF CONTROL-FILE)
 20905*    END-EXEC.
 20906     MOVE 750
 20907       TO DFHEIV11
 20908*    MOVE '," L                  $   #00019407' TO DFHEIV0
 20909     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20910     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20911     MOVE X'2020233030303139343037' TO DFHEIV0(25:11)
 20912     CALL 'kxdfhei1' USING DFHEIV0,
 20913           DFHEIV20,
 20914           DFHEIV11,
 20915           DFHEIV99
 20916     SET ADDRESS OF CONTROL-FILE TO
 20917         DFHEIV20
 20918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20919
 20920
 20921     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20922
 20923 9200-EXIT.
 20924     EXIT.
 20925
 20926 9250-UNLOCK-RETURN.
 20927
 20928* EXEC CICS UNLOCK
 20929*        DATASET   (CERT-ID)
 20930*    END-EXEC.
 20931*    MOVE '&*                    #   #00019418' TO DFHEIV0
 20932     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20933     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20934     MOVE X'2020233030303139343138' TO DFHEIV0(25:11)
 20935     CALL 'kxdfhei1' USING DFHEIV0,
 20936           CERT-ID,
 20937           DFHEIV99
 20938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20939
 20940
 20941 9300-ABEND.
 20942     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20943
 20944
 20945* EXEC CICS LINK
 20946*        PROGRAM   ('EL004')
 20947*        COMMAREA  (WS-ERROR-LINE)
 20948*        LENGTH    (72)
 20949*    END-EXEC.
 20950     MOVE 'EL004' TO DFHEIV1
 20951     MOVE 72
 20952       TO DFHEIV11
 20953*    MOVE '."C                   (   #00019425' TO DFHEIV0
 20954     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303139343235' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 389
* EL050.cbl
 20958           DFHEIV1,
 20959           WS-ERROR-LINE,
 20960           DFHEIV11,
 20961           DFHEIV99,
 20962           DFHEIV99,
 20963           DFHEIV99,
 20964           DFHEIV99
 20965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20966
 20967
 20968     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20969
 20970
 20971* EXEC CICS ABEND
 20972*        ABCODE ('EL50')
 20973*    END-EXEC.
 20974     MOVE 'EL50' TO DFHEIV5
 20975*    MOVE '.,A                   "   #00019433' TO DFHEIV0
 20976     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20977     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20978     MOVE X'2020233030303139343333' TO DFHEIV0(25:11)
 20979     CALL 'kxdfhei1' USING DFHEIV0,
 20980           DFHEIV5
 20981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20982
 20983
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 390
* EL050.cbl
 20985
 20986******************************************************************
 20987*                                                                *
 20988*            E R R O R   F O R M A T   R O U T I N E             *
 20989*                                                                *
 20990******************************************************************
 20991
 20992 9900-ERROR-FORMAT.
 20993
 20994     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20995                    PB-COMMON-ERROR (2) OR
 20996                    PB-COMMON-ERROR (3) OR
 20997                    PB-COMMON-ERROR (4) OR
 20998                    PB-COMMON-ERROR (5) OR
 20999                    PB-COMMON-ERROR (6) OR
 21000                    PB-COMMON-ERROR (7) OR
 21001                    PB-COMMON-ERROR (8) OR
 21002                    PB-COMMON-ERROR (9) OR
 21003                    PB-COMMON-ERROR (10)
 21004        GO TO 9900-EXIT.
 21005
 21006     IF PB-NO-OF-ERRORS = +10
 21007        GO TO 9900-EXIT.
 21008
 21009     ADD +1  TO PB-NO-OF-ERRORS.
 21010     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21011                                       (PB-NO-OF-ERRORS).
 21012 9900-EXIT.
 21013     EXIT.
 21014
 21015 9990-RETURN.
 21016     IF BROWSE-STARTED
 21017
 21018* EXEC CICS ENDBR
 21019*            DATASET  (ACCT-ID)
 21020*       END-EXEC.
 21021     MOVE 0
 21022       TO DFHEIV11
 21023*    MOVE '&2                    $   #00019470' TO DFHEIV0
 21024     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21026     MOVE X'2020233030303139343730' TO DFHEIV0(25:11)
 21027     CALL 'kxdfhei1' USING DFHEIV0,
 21028           ACCT-ID,
 21029           DFHEIV11,
 21030           DFHEIV99
 21031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21032
 21033
 21034 9990-EXIT.
 21035     EXIT.
 21036
 21037
 21038****Check for CRTO record, add one if not found.
 21039 9991-CHECK-FOR-ELCRTO.
 21040
 21041* EXEC CICS HANDLE CONDITION
 21042*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 391
* EL050.cbl
 21043*         ENDFILE (9991-CRTO-NOT-FOUND)
 21044*     END-EXEC.
 21045*    MOVE '"$I''                  ! @ #00019480' TO DFHEIV0
 21046     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21048     MOVE X'4020233030303139343830' TO DFHEIV0(25:11)
 21049     CALL 'kxdfhei1' USING DFHEIV0
 21050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21051
 21052     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21053     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21054     MOVE +0                     TO ELCRTO-SEQ-NO
 21055
 21056
 21057* EXEC CICS READ
 21058*       DATASET   ('ELCRTO')
 21059*       INTO      (ORIGINAL-CERTIFICATE)
 21060*       RIDFLD    (ELCRTO-KEY)
 21061*       GTEQ
 21062*       RESP      (WS-RESPONSE)
 21063*    END-EXEC
 21064     MOVE LENGTH OF
 21065      ORIGINAL-CERTIFICATE
 21066       TO DFHEIV11
 21067     MOVE 'ELCRTO' TO DFHEIV1
 21068*    MOVE '&"IL       G          (  N#00019488' TO DFHEIV0
 21069     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21071     MOVE X'204E233030303139343838' TO DFHEIV0(25:11)
 21072     CALL 'kxdfhei1' USING DFHEIV0,
 21073           DFHEIV1,
 21074           ORIGINAL-CERTIFICATE,
 21075           DFHEIV11,
 21076           ELCRTO-KEY,
 21077           DFHEIV99,
 21078           DFHEIV99,
 21079           DFHEIV99
 21080     MOVE EIBRESP  TO WS-RESPONSE
 21081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21082
 21083     IF WS-RESP-NORMAL
 21084        AND (OC-CONTROL-PRIMARY (1:33) =
 21085                 PB-CONTROL-BY-ACCOUNT (1:33))
 21086        AND (OC-RECORD-TYPE =  'I')
 21087           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21088               GO TO 9991-EXIT
 21089           ELSE
 21090               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21091               GO TO 9991-CRTO-ADD-REC
 21092           END-IF
 21093     END-IF.
 21094
 21095 9991-CRTO-NOT-FOUND.
 21096
 21097     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21098     MOVE 'OC'                TO OC-RECORD-ID
 21099     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21100                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 392
* EL050.cbl
 21101     MOVE +4096               TO OC-KEY-SEQ-NO.
 21102
 21103 9991-CRTO-ADD-REC.
 21104
 21105     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21106     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21107     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21108     MOVE 'I'                 TO OC-RECORD-TYPE
 21109     IF PB-ISSUE
 21110         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21111         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21112         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21113         MOVE PB-I-AGE               TO OC-INS-AGE
 21114         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21115         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21116         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21117         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21118         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21119         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21120         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21121         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21122         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21123         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21124         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21125         IF PB-I-JOINT-COMMISSION > +0
 21126             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21127         ELSE
 21128             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21129         END-IF
 21130         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21131         MOVE +0                     TO OC-LF-CANCEL-AMT
 21132                                        OC-LF-ITD-CANCEL-AMT
 21133         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21134         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21135         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21136         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21137         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21138         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21139         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21140         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21141         MOVE +0                     TO OC-AH-CANCEL-AMT
 21142                                        OC-AH-ITD-CANCEL-AMT
 21143         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21144     ELSE
 21145         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21146         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21147         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21148         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21149         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21150         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21151         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21152         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21153         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21154          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21155             MOVE SPACES             TO OC-LF-BENCD
 21156             MOVE ZEROS              TO OC-LF-TERM
 21157                                        OC-LF-BEN-AMT
 21158                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 393
* EL050.cbl
 21159                                        OC-LF-ALT-BEN-AMT
 21160                                        OC-LF-ALT-PRM-AMT
 21161                                        OC-LF-COMM-PCT
 21162                                        OC-LF-CANCEL-AMT
 21163             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21164             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21165         ELSE
 21166             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21167             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21168             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21169             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21170             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21171             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21172             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21173             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21174             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21175             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21176         END-IF
 21177         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21178         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21179          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21180             MOVE SPACES             TO OC-AH-BENCD
 21181             MOVE ZEROS              TO OC-AH-TERM
 21182                                        OC-AH-BEN-AMT
 21183                                        OC-AH-PRM-AMT
 21184                                        OC-AH-COMM-PCT
 21185                                        OC-AH-CANCEL-AMT
 21186                                        OC-AH-CP
 21187             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21188             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21189         ELSE
 21190             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21191             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21192             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21193             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21194             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21195             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21196             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21197             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21198             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21199         END-IF
 21200         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21201         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21202     END-IF
 21203     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21204
 21205     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21206
 21207
 21208* EXEC CICS READ
 21209*         DATASET   (FILE-ERMAIL)
 21210*         RIDFLD    (MA-CONTROL-PRIMARY)
 21211*         INTO      (MAILING-DATA)
 21212*         RESP      (WS-RESPONSE)
 21213*    END-EXEC
 21214     MOVE LENGTH OF
 21215      MAILING-DATA
 21216       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 394
* EL050.cbl
 21217*    MOVE '&"IL       E          (  N#00019620' TO DFHEIV0
 21218     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21220     MOVE X'204E233030303139363230' TO DFHEIV0(25:11)
 21221     CALL 'kxdfhei1' USING DFHEIV0,
 21222           FILE-ERMAIL,
 21223           MAILING-DATA,
 21224           DFHEIV11,
 21225           MA-CONTROL-PRIMARY,
 21226           DFHEIV99,
 21227           DFHEIV99,
 21228           DFHEIV99
 21229     MOVE EIBRESP  TO WS-RESPONSE
 21230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21231
 21232     IF WS-RESP-NORMAL
 21233         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21234     END-IF.
 21235
 21236     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21237     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21238
 21239
 21240* EXEC CICS READ
 21241*         DATASET  (CRTT-ID)
 21242*         RIDFLD   (WS-ELCRTT-KEY)
 21243*         INTO     (CERTIFICATE-TRAILERS)
 21244*         RESP     (WS-RESPONSE)
 21245*    END-EXEC
 21246     MOVE LENGTH OF
 21247      CERTIFICATE-TRAILERS
 21248       TO DFHEIV11
 21249*    MOVE '&"IL       E          (  N#00019634' TO DFHEIV0
 21250     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21252     MOVE X'204E233030303139363334' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0,
 21254           CRTT-ID,
 21255           CERTIFICATE-TRAILERS,
 21256           DFHEIV11,
 21257           WS-ELCRTT-KEY,
 21258           DFHEIV99,
 21259           DFHEIV99,
 21260           DFHEIV99
 21261     MOVE EIBRESP  TO WS-RESPONSE
 21262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21263
 21264     IF WS-RESP-NORMAL
 21265         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21266         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21267     END-IF.
 21268
 21269
 21270* EXEC CICS WRITE
 21271*       DATASET   ('ELCRTO')
 21272*       FROM      (ORIGINAL-CERTIFICATE)
 21273*       RIDFLD    (OC-CONTROL-PRIMARY)
 21274*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 395
* EL050.cbl
 21275*    END-EXEC.
 21276     MOVE LENGTH OF
 21277      ORIGINAL-CERTIFICATE
 21278       TO DFHEIV11
 21279     MOVE 'ELCRTO' TO DFHEIV1
 21280*    MOVE '&$ L                  ''  N#00019646' TO DFHEIV0
 21281     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21282     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21283     MOVE X'204E233030303139363436' TO DFHEIV0(25:11)
 21284     CALL 'kxdfhei1' USING DFHEIV0,
 21285           DFHEIV1,
 21286           ORIGINAL-CERTIFICATE,
 21287           DFHEIV11,
 21288           OC-CONTROL-PRIMARY,
 21289           DFHEIV99,
 21290           DFHEIV99
 21291     MOVE EIBRESP  TO WS-RESPONSE
 21292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21293
 21294
 21295 9991-EXIT.
 21296     EXIT.
 21297
 21298
 21299 9999-RETURN.
 21300     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21301
 21302
 21303* EXEC CICS RETURN
 21304*    END-EXEC.
 21305*    MOVE '.(                    ''   #00019660' TO DFHEIV0
 21306     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21308     MOVE X'2020233030303139363630' TO DFHEIV0(25:11)
 21309     CALL 'kxdfhei1' USING DFHEIV0,
 21310           DFHEIV99,
 21311           DFHEIV99,
 21312           DFHEIV99,
 21313           DFHEIV99,
 21314           DFHEIV99,
 21315           DFHEIV99
 21316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21317
 21318
 21319
 21320* GOBACK.
 21321     MOVE '9%                    "   ' TO DFHEIV0
 21322     MOVE 'EL050' TO DFHEIV1
 21323     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21324     GOBACK.
 21325
 21326 9999-DFHBACK SECTION.
 21327     MOVE '9%                    "   ' TO DFHEIV0
 21328     MOVE 'EL050' TO DFHEIV1
 21329     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21330     GOBACK.
 21331 9999-DFHEXIT.
 21332     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 396
* EL050.cbl
 21333         NEXT SENTENCE
 21334     ELSE IF DFHEIGDJ EQUAL 2
 21335         GO TO 9300-ABEND,
 21336               3990-FILES-NOT-OPEN
 21337         DEPENDING ON DFHEIGDI
 21338     ELSE IF DFHEIGDJ EQUAL 3
 21339         GO TO 6610-START-BROWSE,
 21340               6630-ERRESS-PROBLEM,
 21341               6630-END-OF-FILE
 21342         DEPENDING ON DFHEIGDI
 21343     ELSE IF DFHEIGDJ EQUAL 4
 21344         GO TO 6630-END-OF-FILE,
 21345               6630-ERRESS-PROBLEM,
 21346               6630-ERRESS-PROBLEM,
 21347               6630-END-OF-FILE
 21348         DEPENDING ON DFHEIGDI
 21349     ELSE IF DFHEIGDJ EQUAL 5
 21350         GO TO 6630-END-OF-FILE,
 21351               6630-END-OF-FILE,
 21352               6630-ERRESS-PROBLEM,
 21353               6630-ERRESS-PROBLEM
 21354         DEPENDING ON DFHEIGDI
 21355     ELSE IF DFHEIGDJ EQUAL 6
 21356         GO TO 6660-START-BROWSE,
 21357               6690-ERRESC-PROBLEM,
 21358               6690-ERRESC-PROBLEM,
 21359               6690-END-OF-FILE
 21360         DEPENDING ON DFHEIGDI
 21361     ELSE IF DFHEIGDJ EQUAL 7
 21362         GO TO 6690-END-OF-FILE,
 21363               6690-ERRESC-PROBLEM,
 21364               6690-ERRESC-PROBLEM,
 21365               6690-END-OF-FILE
 21366         DEPENDING ON DFHEIGDI
 21367     ELSE IF DFHEIGDJ EQUAL 8
 21368         GO TO 6690-END-OF-FILE,
 21369               6690-ERRESC-PROBLEM,
 21370               6690-ERRESC-PROBLEM,
 21371               6690-END-OF-FILE
 21372         DEPENDING ON DFHEIGDI
 21373     ELSE IF DFHEIGDJ EQUAL 9
 21374         GO TO 7250-CONTINUE,
 21375               7250-CONTINUE
 21376         DEPENDING ON DFHEIGDI
 21377     ELSE IF DFHEIGDJ EQUAL 10
 21378         GO TO 7300-CONTINUE,
 21379               7300-CONTINUE
 21380         DEPENDING ON DFHEIGDI
 21381     ELSE IF DFHEIGDJ EQUAL 11
 21382         GO TO 8000-FREE-MAIN
 21383         DEPENDING ON DFHEIGDI
 21384     ELSE IF DFHEIGDJ EQUAL 12
 21385         GO TO 8100-NOTFND,
 21386               8100-NOTFND
 21387         DEPENDING ON DFHEIGDI
 21388     ELSE IF DFHEIGDJ EQUAL 13
 21389         GO TO 8110-NOTFND,
 21390               8110-NOTFND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 397
* EL050.cbl
 21391         DEPENDING ON DFHEIGDI
 21392     ELSE IF DFHEIGDJ EQUAL 14
 21393         GO TO 8130-EXIT
 21394         DEPENDING ON DFHEIGDI
 21395     ELSE IF DFHEIGDJ EQUAL 15
 21396         GO TO 8180-NOTFND
 21397         DEPENDING ON DFHEIGDI
 21398     ELSE IF DFHEIGDJ EQUAL 16
 21399         GO TO 8190-NOTFND
 21400         DEPENDING ON DFHEIGDI
 21401     ELSE IF DFHEIGDJ EQUAL 17
 21402         GO TO 8195-NOTFND
 21403         DEPENDING ON DFHEIGDI
 21404     ELSE IF DFHEIGDJ EQUAL 18
 21405         GO TO 8200-NOTFND
 21406         DEPENDING ON DFHEIGDI
 21407     ELSE IF DFHEIGDJ EQUAL 19
 21408         GO TO 8300-NOTFND,
 21409               8300-ERRESS-PROBLEM,
 21410               8300-ERRESS-PROBLEM,
 21411               8300-NOTFND
 21412         DEPENDING ON DFHEIGDI
 21413     ELSE IF DFHEIGDJ EQUAL 20
 21414         GO TO 8450-FORM-NOT-FOUND,
 21415               8450-FORM-NOT-FOUND
 21416         DEPENDING ON DFHEIGDI
 21417     ELSE IF DFHEIGDJ EQUAL 21
 21418         GO TO 0199-ACCT-NOT-FOUND,
 21419               0199-ACCT-NOT-FOUND
 21420         DEPENDING ON DFHEIGDI
 21421     ELSE IF DFHEIGDJ EQUAL 22
 21422         GO TO 0199-ACCT-NOT-FOUND,
 21423               0199-ACCT-NOT-FOUND
 21424         DEPENDING ON DFHEIGDI
 21425     ELSE IF DFHEIGDJ EQUAL 23
 21426         GO TO 8582-COMP-NOT-FOUND,
 21427               8582-COMP-NOT-FOUND
 21428         DEPENDING ON DFHEIGDI
 21429     ELSE IF DFHEIGDJ EQUAL 24
 21430         GO TO 8583-AGTC-NOT-FOUND,
 21431               8583-AGTC-NOT-FOUND
 21432         DEPENDING ON DFHEIGDI
 21433     ELSE IF DFHEIGDJ EQUAL 25
 21434         GO TO 8584-BXRF-NOT-FOUND,
 21435               8584-BXRF-NOT-FOUND
 21436         DEPENDING ON DFHEIGDI
 21437     ELSE IF DFHEIGDJ EQUAL 26
 21438         GO TO 8585-PLAN-NOT-FOUND,
 21439               8585-PLAN-NOT-FOUND
 21440         DEPENDING ON DFHEIGDI
 21441     ELSE IF DFHEIGDJ EQUAL 27
 21442         GO TO 0299-CERT-NOT-FOUND
 21443         DEPENDING ON DFHEIGDI
 21444     ELSE IF DFHEIGDJ EQUAL 28
 21445         GO TO 8700-READ-CERT-MASTER
 21446         DEPENDING ON DFHEIGDI
 21447     ELSE IF DFHEIGDJ EQUAL 29
 21448         GO TO 8720-COMP-ACCOUNTS,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-13 11:57 Page 398
* EL050.cbl
 21449               8730-END-BROWSE,
 21450               8740-NOT-FOUND
 21451         DEPENDING ON DFHEIGDI
 21452     ELSE IF DFHEIGDJ EQUAL 30
 21453         GO TO 9000-NOTFND
 21454         DEPENDING ON DFHEIGDI
 21455     ELSE IF DFHEIGDJ EQUAL 31
 21456         GO TO 9100-NOTFND,
 21457               9100-NOTFND
 21458         DEPENDING ON DFHEIGDI
 21459     ELSE IF DFHEIGDJ EQUAL 32
 21460         GO TO 9991-CRTO-NOT-FOUND,
 21461               9991-CRTO-NOT-FOUND
 21462         DEPENDING ON DFHEIGDI.
 21463     MOVE '9%                    "   ' TO DFHEIV0
 21464     MOVE 'EL050' TO DFHEIV1
 21465     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21466     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       86339
