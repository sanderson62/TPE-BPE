* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   3
* EL050.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER   PIC X(32) VALUE '********************************'.
    52 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    53 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    54
    55 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    56 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    57                                   USAGE POINTER.
    58 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    59 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    61                                   USAGE IS POINTER.
    62 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73*    COPY ELC50WS.
    74*****************************************************************
    75*                                                               *
    76*                            ELC50WS.                           *
    77*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    78*                            VMOD=2.061.                        *
    79*                                                               *
    80*   THIS IS THE WORKING STORAGE FOR EL050                       *
    81*                                   EL517                       *
    82*****************************************************************
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 123102                   PEMA  ADD DCC PROCESSING
    92* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    93* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    94* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    95* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    96* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    97* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    98* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    99* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   100* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   101* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   102* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   103* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   104* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   105* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   4
* EL050.cbl
   106* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   107* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   108* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   109* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   110* 030309  CR2009021700001  PEMA  ADD ER-2883
   111* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   113* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   114* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   115* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   116* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   117* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   118* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   119* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   120* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   121* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   122* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   123* 061412  CR2011022800001  AJRA  NAPERSOFT
   124*-----------------------------------------------------------------
   125
   126 01  WORK-AREAS.
   127
   128*****************************************************************
   129*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   130*****************************************************************
   131
   132     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   133     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   134     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   135     12  WS-NAME-EDIT-WORK-AREA.
   136         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   137         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   138             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   139         16  WS-WORK-NAME.
   140             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   141             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   142             20  FILLER           PIC X(10)     VALUE SPACES.
   143         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   144             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   145
   146*****************************************************************
   147*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   148*****************************************************************
   149
   150     12  WS-ERRESC-KEY.
   151         16 WS-ERRESC-SEARCH-KEY.
   152             20  WS-ERRESC-COMPANY-CD PIC  X.
   153             20  WS-ERRESC-CARRIER    PIC  X.
   154             20  WS-ERRESC-GROUP      PIC X(6).
   155             20  WS-ERRESC-STATE      PIC XX.
   156             20  WS-ERRESC-ACCOUNT    PIC X(10).
   157         16 WS-ERRESC-RESIDUAL-KEY.
   158             20  WS-ERRESC-AGENT      PIC X(10).
   159             20  WS-ERRESC-RES-STATE  PIC XX.
   160             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   161*                                          YYYYMMDD
   162     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   163     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   5
* EL050.cbl
   164
   165*RESIDENT STATE TAX MASTER(ERRESS)
   166*
   167     12  WS-ERRESS-KEY.
   168         16  WS-ERRESS-COMPANY-CD      PIC  X.
   169         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   170         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   171         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   172*                                          YYYYMMDD
   173
   174     12  WS-CONTRACT-DATE              PIC 9(8).
   175*                                          YYYYMMDD
   176     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   177     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   178         16 WS-YEAR-YY                 PIC   9999.
   179         16 FILLER                     PIC 9(4).
   180*                                          YYYYMMDD
   181     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   182     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   183     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   185
   186     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   187         88  DPRB-1ST-TIME                      VALUE ' '.
   188
   189*****************************************************************
   190*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   191*****************************************************************
   192
   193     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   194     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   195     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   196     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   197     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   198     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   199     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   200     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   201     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   202     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   203         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   204         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   205     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   206         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   207         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   208     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   209
   210     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   211     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   212
   213     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   214     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   6
* EL050.cbl
   222     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   227     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   228     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   249     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   250     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   251     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   252     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   261     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   262     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   263     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   264     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   265     12  WS-2671-SW               PIC X         VALUE SPACE.
   266     12  WS-2672-SW               PIC X         VALUE SPACE.
   267     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   268         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   269     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   270         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   271     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   272
   273     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   274         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   275         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   276         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   277         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   278
   279     12  WS-CREDIT-EDIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   7
* EL050.cbl
   280         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   281         16  WS-MIN-AGE           PIC 99                VALUE  0.
   282         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   283         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   284         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   285         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   286
   287     12  WS-SAVE-ALLOWABLE-BENEFIT.
   288         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   289         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   290         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   291         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   292         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   293         16  FILLER                      PIC XX.
   294
   295     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   296     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   297     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   298     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   299     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   300     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   301     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   302     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   303     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   304     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   305
   306     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   307     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   308     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   309     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   310     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   311     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   312     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   313     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   314         88  WS-REDUCING              VALUE 'R'.
   315         88  WS-LEVEL                 VALUE 'L' 'P'.
   316     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   317
   318     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   319     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   320     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   321     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   322     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   323     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   324     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   325     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   326     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   327
   328     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   329     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   330     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   332     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   333     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   334     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   335     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   336     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   337     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   8
* EL050.cbl
   338     12  WS-ACCT-SIG-SW.
   339         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   340         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   341     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   343     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   346     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   347     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   348     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   349     12  WS-INITIALS.
   350         16  WS-INIT-1            PIC X         VALUE SPACES.
   351         16  WS-INIT-2            PIC X         VALUE SPACES.
   352
   353     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   354     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   355     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   356     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   357     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   358*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   359     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   361     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   362     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   363     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   364     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   365     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   366     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   367     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   369     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   370     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   371     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   372     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   373     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   374     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   377     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   378     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   379     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   380     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   381******** FLA
   382     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   386     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   387********
   388     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   389     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   390     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   391     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   392     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   393     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   394     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   395     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page   9
* EL050.cbl
   396     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   397     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   398
   399     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   400         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   401                                         '0' THRU '9'.
   402
   403     12  NUMBER-OF-MONTHS.
   404         16  SK-MO OCCURS 12 TIMES PIC X.
   405
   406     12  WS-WORK-DATE.
   407         16  WS-YEAR            PIC 99    VALUE 00.
   408         16  WS-MONTH           PIC 99    VALUE 00.
   409         16  WS-DAY             PIC 99    VALUE 00.
   410
   411     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   412     12  WS-WORK-CRIT-DEV       REDEFINES
   413         WS-WORK-LF-CRIT-PER    PIC X(03).
   414
   415     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   416     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   417
   418     12  WS-WORK-DATE-FROM.
   419         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X  VALUE SPACE.
   421         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   424
   425     12  WS-WORK-DATE-THRU.
   426         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   427         16  FILLER             PIC X         VALUE SPACE.
   428         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   429         16  FILLER             PIC X         VALUE SPACE.
   430         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   431
   432     12  WS-LF-INPUT-CD.
   433         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   434         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   435
   436     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   437     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   438         16  WS-AH-INPUT-CD-1   PIC X.
   439         16  WS-AH-INPUT-CD-2-3 PIC XX.
   440
   441     12  WS-SWITCHES.
   442         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   443         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   444             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   445         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   446             88  BANK-ACCT-FOUND          VALUE 'Y'.
   447         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   448             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   449         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   450             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   451         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   452             88  COMP-MASTER-FOUND        VALUE 'Y'.
   453         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  10
* EL050.cbl
   454             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   455         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   456             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   457         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   458             88  STAT-MASTER-FOUND        VALUE 'Y'.
   459         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   460             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   461         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   462             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   463         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   464             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   465         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   466             88  FORM-MASTER-FOUND        VALUE 'Y'.
   467         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   468             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   469         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   470             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   471         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   472             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   473         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   474             88  NO-BENEFIT-FOUND         VALUE 'N'.
   475         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   476             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   477         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   478             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   479         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   480             88  AH-BENEFIT-FOUND         VALUE ' '.
   481             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   482         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   483             88  LF-BENEFIT-FOUND         VALUE ' '.
   484             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   485         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   486             88  NO-STATE-RECORD          VALUE '1'.
   487         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   488             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   489         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   490             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   491         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   492             88  CERT-WAS-FOUND           VALUE ' '.
   493             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   494         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   495             88  BROWSE-STARTED           VALUE 'Y'.
   496         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   497             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   498         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   499             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   500         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   501             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   502         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   503             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   504         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   505             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   506         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   507             88  APP-CERT-USED            VALUE 'Y' 'A'.
   508         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   509             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   510             88  FIRST-TIME-THROUGH       VALUE '1'.
   511             88  CTBL-NOT-FOUND           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  11
* EL050.cbl
   512
   513         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   514             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   515
   516         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   517             88  DLO-ERROR-FOUND          VALUE 'Y'.
   518
   519********FLA
   520     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   521     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   522********
   523     12  RC-SW-1                  PIC X           VALUE '0'.
   524     12  RC-SW-2                  PIC X           VALUE '0'.
   525     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   526     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   527     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   530     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   531     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   532     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   533     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   534     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   535     12  LIT-SPACES               PIC X           VALUE SPACES.
   536     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   537     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   538     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   539     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   540     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   541     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   542     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   543         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   544         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   545     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   546         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   547
   548 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   549     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   550     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   551 01  WS-CRI-SSN-WORK-AREA.
   552     05  WS-CRI-SOC-SEC-NO.
   553         10  WS-SS-REPT-CD       PIC X(5).
   554         10  WS-SS-LAST-NAME     PIC X(5).
   555         10  WS-SS-INITIAL       PIC X.
   556
   557     05  WS-CRI-REPORT-CODE.
   558         10  FILLER              PIC X(5).
   559         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   560
   561     05  WS-CRI-LAST-NAME.
   562         10  WS-CRI-NAME-MOVE    PIC X(5).
   563         10  FILLER              PIC X(10).
   564
   565 01  WS-NUM-TABLE                PIC X(26)  VALUE
   566     '12345678012345070923456789'.
   567 01  FILLER REDEFINES WS-NUM-TABLE.
   568     05  WS-NUM OCCURS 26        PIC 9.
   569 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  12
* EL050.cbl
   570 01  V1                          PIC S999 COMP-3.
   571 01  V2                          PIC S999 COMP-3.
   572 01  V3                          PIC S999 COMP-3.
   573 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   574 01  FILLER REDEFINES WS-WORK-VIN.
   575     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   576 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   577 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   578 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   579 01  WS-HEX-WORK.
   580     05  FILLER                  PIC X  VALUE LOW-VALUES.
   581     05  WS-HEX-BYTE             PIC X.
   582 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   583 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   584 01  WS-WORK-HIN-ROW-B.
   585     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   586
   587 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   588 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   589     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   590 01  WS-ROW-D-TABLE.
   591     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   592
   593 01  WS-HIN-TABLE-B.
   594     05  F                       PIC XX VALUE 'A2'.
   595     05  F                       PIC XX VALUE 'B3'.
   596     05  F                       PIC XX VALUE 'C4'.
   597     05  F                       PIC XX VALUE 'D5'.
   598     05  F                       PIC XX VALUE 'E6'.
   599     05  F                       PIC XX VALUE 'F7'.
   600     05  F                       PIC XX VALUE 'G8'.
   601     05  F                       PIC XX VALUE 'H9'.
   602     05  F                       PIC XX VALUE 'I1'.
   603     05  F                       PIC XX VALUE 'J2'.
   604     05  F                       PIC XX VALUE 'K3'.
   605     05  F                       PIC XX VALUE 'L4'.
   606     05  F                       PIC XX VALUE 'M5'.
   607     05  F                       PIC XX VALUE 'N6'.
   608     05  F                       PIC XX VALUE 'O0'.
   609     05  F                       PIC XX VALUE 'P7'.
   610     05  F                       PIC XX VALUE 'Q0'.
   611     05  F                       PIC XX VALUE 'R8'.
   612     05  F                       PIC XX VALUE 'S9'.
   613     05  F                       PIC XX VALUE 'T2'.
   614     05  F                       PIC XX VALUE 'U3'.
   615     05  F                       PIC XX VALUE 'V4'.
   616     05  F                       PIC XX VALUE 'W5'.
   617     05  F                       PIC XX VALUE 'X6'.
   618     05  F                       PIC XX VALUE 'Y7'.
   619     05  F                       PIC XX VALUE 'Z8'.
   620 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   621     05  WS-VAL-IN               PIC X.
   622     05  WS-VAL-OUT              PIC 9.
   623 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   624 01  WS-COMPARE-BINARY-DATES.
   625     05  WS-971231                PIC XX VALUE X'92FF'.
   626     05  WS-931231                PIC XX VALUE X'8CFF'.
   627     05  WS-791231                PIC XX VALUE X'77FF'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  13
* EL050.cbl
   628     05  WS-771001                PIC XX VALUE X'74A1'.
   629     05  WS-820301                PIC XX VALUE X'7B41'.
   630     05  WS-831031                PIC XX VALUE X'7DBF'.
   631     05  WS-831231                PIC XX VALUE X'7DFF'.
   632     05  WS-810831                PIC XX VALUE X'7A7F'.
   633     05  WS-830901                PIC XX VALUE X'7D81'.
   634
   635 01  FILE-ACCESS-IDS.
   636     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   637     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   638     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   639     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   640     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   641     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   642     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   643     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   644     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   645     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   646     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   647     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   648     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   649     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   650     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   651     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   652     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   653 01  DD-IU-SW                    PIC X   VALUE ' '.
   654     88  DD-IU-PRESENT                 VALUE 'Y'.
   655
   656 01  ACCESS-KEYS.
   657     12  ELMSTR-KEY.
   658         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   659         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   660     12  W-CLAIM-KEY.
   661         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   662         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   663
   664     12  ELCNTL-KEY.
   665         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   666         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   667         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   668         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   669
   670     12  ELCERT-KEY.
   671         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  CERT-CARRIER         PIC X       VALUE SPACE.
   673         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   674         16  CERT-STATE           PIC XX      VALUE SPACES.
   675         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   676         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   677         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   678
   679     12  ELCERT2-KEY.
   680         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   681         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   682
   683     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   684
   685     12  ELCERT-SAVE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  14
* EL050.cbl
   686         16  FILLER                      PIC XX    VALUE SPACES.
   687
   688         16  WCS-CONTROL-PRIMARY.
   689             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   690             20  WCS-CARRIER             PIC X     VALUE SPACE.
   691             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   692             20  WCS-STATE               PIC XX    VALUE SPACES.
   693             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   694             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   695             20  WCS-CERT-NO.
   696                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   697                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   698
   699         16  CS-CONTROL-BY-NAME.
   700             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   701             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   702             20  CS-INSURED-INITIALS.
   703                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   704                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   705
   706         16  CS-CONTROL-BY-SSN.
   707             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   708             20  CS-SOC-SEC-NO.
   709                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   710                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   711                 24  CS-SSN-LN3.
   712                     28 CS-INSURED-INITIALS-A2   PIC XX
   713                                     VALUE SPACES.
   714                     28 CS-PART-LAST-NAME-A2     PIC X
   715                                     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-CERT-NO.
   718             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   719             20  CS-CERT-NO-A4           PIC X(11)
   720                                     VALUE SPACES.
   721
   722         16  CS-CONTROL-BY-MEMB.
   723             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   724             20  CS-MEMBER-NO.
   725                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   726                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   727                 24  CS-MEMB-LN4.
   728                     28 CS-INSURED-INITIALS-A5   PIC XX
   729                                      VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A5     PIC XX
   731                                      VALUE SPACES.
   732
   733         16  FILLER              PIC X(360) VALUE SPACES.
   734
   735     12  ERACCT-KEY.
   736         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   737         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   738         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   739         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   740         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   741         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   742
   743     12  ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  15
* EL050.cbl
   744         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   745         16  COMP-CARRIER         PIC X     VALUE SPACES.
   746         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   747         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   748         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  COMP-TYPE            PIC X     VALUE SPACES.
   750
   751     12  ERLOFC-KEY.
   752         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   754         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   755         16  LOFC-STATE           PIC XX    VALUE SPACES.
   756         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   758
   759     12  WS-ELCRTT-KEY.
   760         16  WS-ELCRTT-PRIMARY       PIC X(33).
   761         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   762
   763     12  ERBXRF-KEY.
   764         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   766         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   767         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   768
   769     12  ERAGTC-KEY.
   770         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   772         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   774         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   775         16  AGTC-TYPE            PIC X     VALUE SPACES.
   776
   777     12  ERPLAN-KEY.
   778         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   779         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   780         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   781         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   782         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   783         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   784         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   785         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   786
   787     12  ERFORM-KEY.
   788         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   790         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   791         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   792
   793     12  ERREIN-KEY.
   794         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   795         16  REIN-TYPE            PIC X     VALUE SPACES.
   796         16  REIN-TABLE-CO.
   797             20  REIN-CODE-1      PIC X     VALUE SPACE.
   798             20  REIN-CODE-2      PIC X     VALUE SPACE.
   799             20  REIN-CODE-3      PIC X     VALUE SPACE.
   800         16  FILLER               PIC X(3)  VALUE SPACES.
   801
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  16
* EL050.cbl
   802     12  ERCTBL-KEY.
   803         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   804         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   805         16  CTBL-CNTRL-2.
   806             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   807             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   808
   809     12  ELCRTO-KEY.
   810         16  ELCRTO-COMPANY-CD       PIC X.
   811         16  ELCRTO-CARRIER          PIC X.
   812         16  ELCRTO-GROUPING         PIC X(6).
   813         16  ELCRTO-STATE            PIC XX.
   814         16  ELCRTO-ACCOUNT          PIC X(10).
   815         16  ELCRTO-CERT-EFF-DT      PIC XX.
   816         16  ELCRTO-CERT-NO.
   817             20  ELCRTO-CERT-PRIME   PIC X(10).
   818             20  ELCRTO-CERT-SFX     PIC X.
   819         16  ELCRTO-RECORD-TYPE      PIC X.
   820         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   821
   822
   823     12  WS-ACCESS.
   824         16  FILLER               PIC XX    VALUE SPACES.
   825         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   826
   827     12  WS-CARR-ACCESS.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829         16  WS-CARR              PIC X     VALUE SPACE.
   830*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   831*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   832     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   833         88  WS-DMD-LF-RATING   VALUE 'Y'.
   834         88  WS-DMD-AH-RATING   VALUE 'Y'.
   835         88  WS-DMD-NO-RATING   VALUE 'N'.
   836
   837     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   838         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   839                                         'NJ' 'NL'
   840                                         'PJ' 'PL'
   841                                         'SJ' 'SL'.
   842     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   843         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   844                                         'NI' 'NJ' 'NL' 'NU'
   845                                         'PJ' 'PL' 'PI' 'PU'
   846                                         'SI' 'SJ' 'SL' 'SU'
   847                                         'MX' 'MY' 'MZ'.
   848 01  ERPDEF-KEY-SAVE             PIC X(18).
   849 01  ERPDEF-KEY.
   850     12  ERPDEF-COMPANY-CD       PIC X.
   851     12  ERPDEF-STATE            PIC XX.
   852     12  ERPDEF-PROD-CD          PIC XXX.
   853     12  F                       PIC X(7).
   854     12  ERPDEF-BEN-TYPE         PIC X.
   855     12  ERPDEF-BEN-CODE         PIC XX.
   856     12  ERPDEF-EXP-DT           PIC XX.
   857
   858 01  ELSTAT-KEY-SAVE             PIC X(20).
   859 01  ELSTAT-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  17
* EL050.cbl
   860     12  ELSTAT-COMPANY-ID       PIC XXX.
   861     12  ELSTAT-CARRIER          PIC X.
   862     12  ELSTAT-GROUP            PIC X(6).
   863     12  ELSTAT-STATE            PIC XX.
   864     12  ELSTAT-EXP-DT           PIC 9(8).
   865 01  WS-ERROR-VALUES.
   866     12  ER-1570                     PIC S9(4)   VALUE +1570.
   867     12  ER-1571                     PIC S9(4)   VALUE +1571.
   868     12  ER-1575                     PIC S9(4)   VALUE +1575.
   869     12  ER-1891                     PIC S9(4)   VALUE +1891.
   870     12  ER-1892                     PIC S9(4)   VALUE +1892.
   871     12  ER-1893                     PIC S9(4)   VALUE +1893.
   872     12  ER-1894                     PIC S9(4)   VALUE +1894.
   873     12  ER-1895                     PIC S9(4)   VALUE +1895.
   874     12  ER-1896                     PIC S9(4)   VALUE +1896.
   875     12  ER-1897                     PIC S9(4)   VALUE +1897.
   876     12  ER-1898                     PIC S9(4)   VALUE +1898.
   877     12  ER-1899                     PIC S9(4)   VALUE +1899.
   878     12  ER-1900                     PIC S9(4)   VALUE +1900.
   879     12  ER-1901                     PIC S9(4)   VALUE +1901.
   880     12  ER-1902                     PIC S9(4)   VALUE +1902.
   881     12  ER-1903                     PIC S9(4)   VALUE +1903.
   882     12  ER-1904                     PIC S9(4)   VALUE +1904.
   883     12  ER-1905                     PIC S9(4)   VALUE +1905.
   884     12  ER-1906                     PIC S9(4)   VALUE +1906.
   885     12  ER-1907                     PIC S9(4)   VALUE +1907.
   886     12  ER-1909                     PIC S9(4)   VALUE +1909.
   887     12  ER-1910                     PIC S9(4)   VALUE +1910.
   888     12  ER-1911                     PIC S9(4)   VALUE +1911.
   889     12  ER-1912                     PIC S9(4)   VALUE +1912.
   890     12  ER-1913                     PIC S9(4)   VALUE +1913.
   891     12  ER-1914                     PIC S9(4)   VALUE +1914.
   892     12  ER-1915                     PIC S9(4)   VALUE +1915.
   893     12  ER-1916                     PIC S9(4)   VALUE +1916.
   894     12  ER-1917                     PIC S9(4)   VALUE +1917.
   895     12  ER-1918                     PIC S9(4)   VALUE +1918.
   896     12  ER-1919                     PIC S9(4)   VALUE +1919.
   897     12  ER-1920                     PIC S9(4)   VALUE +1920.
   898     12  ER-1921                     PIC S9(4)   VALUE +1921.
   899     12  ER-1922                     PIC S9(4)   VALUE +1922.
   900     12  ER-1923                     PIC S9(4)   VALUE +1923.
   901     12  ER-1924                     PIC S9(4)   VALUE +1924.
   902     12  ER-1925                     PIC S9(4)   VALUE +1925.
   903     12  ER-1926                     PIC S9(4)   VALUE +1926.
   904     12  ER-1927                     PIC S9(4)   VALUE +1927.
   905     12  ER-2393                     PIC S9(4)   VALUE +2393.
   906     12  ER-2600                     PIC S9(4)   VALUE +2600.
   907     12  ER-2601                     PIC S9(4)   VALUE +2601.
   908     12  ER-2602                     PIC S9(4)   VALUE +2602.
   909     12  ER-2603                     PIC S9(4)   VALUE +2603.
   910     12  ER-2604                     PIC S9(4)   VALUE +2604.
   911     12  ER-2605                     PIC S9(4)   VALUE +2605.
   912     12  ER-2606                     PIC S9(4)   VALUE +2606.
   913     12  ER-2607                     PIC S9(4)   VALUE +2607.
   914     12  ER-2608                     PIC S9(4)   VALUE +2608.
   915     12  ER-2609                     PIC S9(4)   VALUE +2609.
   916     12  ER-2610                     PIC S9(4)   VALUE +2610.
   917     12  ER-2611                     PIC S9(4)   VALUE +2611.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  18
* EL050.cbl
   918     12  ER-2612                     PIC S9(4)   VALUE +2612.
   919     12  ER-2613                     PIC S9(4)   VALUE +2613.
   920     12  ER-2614                     PIC S9(4)   VALUE +2614.
   921     12  ER-2615                     PIC S9(4)   VALUE +2615.
   922     12  ER-2616                     PIC S9(4)   VALUE +2616.
   923     12  ER-2617                     PIC S9(4)   VALUE +2617.
   924     12  ER-2618                     PIC S9(4)   VALUE +2618.
   925     12  ER-2619                     PIC S9(4)   VALUE +2619.
   926     12  ER-2620                     PIC S9(4)   VALUE +2620.
   927     12  ER-2621                     PIC S9(4)   VALUE +2621.
   928     12  ER-2622                     PIC S9(4)   VALUE +2622.
   929     12  ER-2623                     PIC S9(4)   VALUE +2623.
   930     12  ER-2624                     PIC S9(4)   VALUE +2624.
   931     12  ER-2625                     PIC S9(4)   VALUE +2625.
   932     12  ER-2626                     PIC S9(4)   VALUE +2626.
   933     12  ER-2627                     PIC S9(4)   VALUE +2627.
   934     12  ER-2628                     PIC S9(4)   VALUE +2628.
   935     12  ER-2629                     PIC S9(4)   VALUE +2629.
   936     12  ER-2630                     PIC S9(4)   VALUE +2630.
   937     12  ER-2631                     PIC S9(4)   VALUE +2631.
   938     12  ER-2632                     PIC S9(4)   VALUE +2632.
   939     12  ER-2633                     PIC S9(4)   VALUE +2633.
   940     12  ER-2634                     PIC S9(4)   VALUE +2634.
   941     12  ER-2635                     PIC S9(4)   VALUE +2635.
   942     12  ER-2636                     PIC S9(4)   VALUE +2636.
   943     12  ER-2637                     PIC S9(4)   VALUE +2637.
   944     12  ER-2638                     PIC S9(4)   VALUE +2638.
   945     12  ER-2639                     PIC S9(4)   VALUE +2639.
   946     12  ER-2640                     PIC S9(4)   VALUE +2640.
   947     12  ER-2641                     PIC S9(4)   VALUE +2641.
   948     12  ER-2642                     PIC S9(4)   VALUE +2642.
   949     12  ER-2643                     PIC S9(4)   VALUE +2643.
   950     12  ER-2644                     PIC S9(4)   VALUE +2644.
   951     12  ER-2645                     PIC S9(4)   VALUE +2645.
   952     12  ER-2646                     PIC S9(4)   VALUE +2646.
   953     12  ER-2647                     PIC S9(4)   VALUE +2647.
   954     12  ER-2648                     PIC S9(4)   VALUE +2648.
   955     12  ER-2649                     PIC S9(4)   VALUE +2649.
   956     12  ER-2650                     PIC S9(4)   VALUE +2650.
   957     12  ER-2651                     PIC S9(4)   VALUE +2651.
   958     12  ER-2652                     PIC S9(4)   VALUE +2652.
   959     12  ER-2653                     PIC S9(4)   VALUE +2653.
   960     12  ER-2654                     PIC S9(4)   VALUE +2654.
   961     12  ER-2655                     PIC S9(4)   VALUE +2655.
   962     12  ER-2656                     PIC S9(4)   VALUE +2656.
   963     12  ER-2657                     PIC S9(4)   VALUE +2657.
   964     12  ER-2658                     PIC S9(4)   VALUE +2658.
   965     12  ER-2659                     PIC S9(4)   VALUE +2659.
   966     12  ER-2660                     PIC S9(4)   VALUE +2660.
   967     12  ER-2661                     PIC S9(4)   VALUE +2661.
   968     12  ER-2662                     PIC S9(4)   VALUE +2662.
   969     12  ER-2663                     PIC S9(4)   VALUE +2663.
   970     12  ER-2664                     PIC S9(4)   VALUE +2664.
   971     12  ER-2665                     PIC S9(4)   VALUE +2665.
   972     12  ER-2666                     PIC S9(4)   VALUE +2666.
   973     12  ER-2667                     PIC S9(4)   VALUE +2667.
   974     12  ER-2668                     PIC S9(4)   VALUE +2668.
   975     12  ER-2669                     PIC S9(4)   VALUE +2669.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  19
* EL050.cbl
   976     12  ER-2670                     PIC S9(4)   VALUE +2670.
   977     12  ER-2671                     PIC S9(4)   VALUE +2671.
   978     12  ER-2672                     PIC S9(4)   VALUE +2672.
   979     12  ER-2673                     PIC S9(4)   VALUE +2673.
   980     12  ER-2674                     PIC S9(4)   VALUE +2674.
   981     12  ER-2675                     PIC S9(4)   VALUE +2675.
   982     12  ER-2676                     PIC S9(4)   VALUE +2676.
   983     12  ER-2677                     PIC S9(4)   VALUE +2677.
   984     12  ER-2678                     PIC S9(4)   VALUE +2678.
   985     12  ER-2679                     PIC S9(4)   VALUE +2679.
   986     12  ER-2680                     PIC S9(4)   VALUE +2680.
   987     12  ER-2681                     PIC S9(4)   VALUE +2681.
   988     12  ER-2682                     PIC S9(4)   VALUE +2682.
   989     12  ER-2683                     PIC S9(4)   VALUE +2683.
   990     12  ER-2684                     PIC S9(4)   VALUE +2684.
   991     12  ER-2685                     PIC S9(4)   VALUE +2685.
   992     12  ER-2686                     PIC S9(4)   VALUE +2686.
   993     12  ER-2687                     PIC S9(4)   VALUE +2687.
   994     12  ER-2688                     PIC S9(4)   VALUE +2688.
   995     12  ER-2689                     PIC S9(4)   VALUE +2689.
   996     12  ER-2690                     PIC S9(4)   VALUE +2690.
   997     12  ER-2691                     PIC S9(4)   VALUE +2691.
   998     12  ER-2692                     PIC S9(4)   VALUE +2692.
   999     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1000     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1001     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1002     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1003     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1004     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1005     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1006     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1007     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1008     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1009     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1010     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1011     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1012     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1013     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1014     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1015     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1016     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1017     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1018     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1019     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1020     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1021     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1022     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1023     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1024     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1025     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1026     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1027     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1028     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1029     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1030     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1031     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1032     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1033     12  ER-2737                     PIC S9(4)   VALUE +2737.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  20
* EL050.cbl
  1034     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1035     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1036     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1037     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1038     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1039     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1040     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1041     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1042     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1043     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1044     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1045     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1046     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1047     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1048     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1049     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1050     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1051     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1052     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1053     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1054     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1055     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1056     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1057     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1058     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1059     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1060     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1061     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1062     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1063     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1064     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1065     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1066     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1067     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1068     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1069     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1070     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1071     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1072     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1073     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1074     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1075     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1076     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1077     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1078     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1079     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1080     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1081     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1082     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1083     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1084     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1085     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1086     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1087     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1088     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1089     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1090     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1091     12  ER-2869                     PIC S9(4)   VALUE +2869.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  21
* EL050.cbl
  1092     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1093     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1094     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1095     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1096     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1097     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1098     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1099     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1100     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1101     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1102     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1103     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1104     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1105     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1106     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1107     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1108     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1109     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1110     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1111     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1112     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1113     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1114     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1115     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1116     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1117     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1118     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1119     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1120     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1121     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1122     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1123     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1124     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1125     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1126     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1127     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1128     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1129     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1130     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1131     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1132     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1133     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1134     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1135     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1136     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1137     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1138     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1139     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1140     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1141     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1142     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1143     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1144     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1145     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1146     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1147     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1148     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1149     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  22
* EL050.cbl
  1150     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1151     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1152     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1153     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1154     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1155     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1156     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1157     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1158     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1159     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1160     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1161     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1162     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1163     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1164     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1165     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1166     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1167     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1168     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1169     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1170     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1171     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1172     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1173     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1174     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1175     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1176     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1177     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1178     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1179     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1180     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1181     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1182     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1183     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1184     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1185     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1186     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1187     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1188     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1189     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1190     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1191     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1192     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1193     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1194     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1195     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1196     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1197     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1198     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1199     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1200     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1201     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1202     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1203     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1204     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1205     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1206******************************************************************
  1207***************   END OF ELC50WS     ****************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  23
* EL050.cbl
  1208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  24
* EL050.cbl
  1211 01  WORKING-STORAGE-WORK-AREAS.
  1212     12  WS-RESPONSE             PIC S9(8)  COMP.
  1213         88  WS-RESP-NORMAL           VALUE +00.
  1214         88  WS-RESP-ERROR            VALUE +01.
  1215         88  WS-RESP-NOTFND           VALUE +13.
  1216         88  WS-RESP-DUPREC           VALUE +14.
  1217         88  WS-RESP-ENDFILE          VALUE +20.
  1218     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1219     12  WORK-AREAS.
  1220         16  WK-CONV-GREG.
  1221             24  WCG-CENT             PIC XX.
  1222             24  WCG-REST             PIC X(4).
  1223         16  WORK-GREGORIAN-DATE.
  1224             24  WK-GREG-CENT         PIC XX.
  1225             24  WK-GREG-DATE-YYMMDD.
  1226                 28  WK-GREG-YYMM     PIC X(4).
  1227                 28  WK-GREG-DD       PIC XX.
  1228
  1229         16  WORK-SELECT-DATE.
  1230             24  WK-SELECT-CENT            PIC XX.
  1231             24  WK-SELECT-DATE-YYMMDD.
  1232                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1233                 28  FILLER                PIC XX.
  1234
  1235         16  WK-FORM-NO.
  1236             24  WK-FORM-BANK-ID       PIC X(5).
  1237             24  WK-FORM-UNDRWRTR      PIC X(1).
  1238             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1239
  1240         16  WK-MEMBER-NO.
  1241             24  WK-MEMBER-1-6        PIC X(6).
  1242             24  WK-MEMBER-7-12       PIC X(6).
  1243
  1244         16  WK-FULL-CERT-NO.
  1245             24  WK-CERT-POS-1-2      PIC X(2).
  1246             24  WK-CERT-POS-3        PIC X(1).
  1247             24  WK-CERT-POS-4        PIC X(1).
  1248             24  WK-CERT-POS-5-6      PIC X(2).
  1249             24  WK-CERT-POS-7        PIC X(1).
  1250             24  WK-CERT-POS-8-11     PIC X(4).
  1251
  1252         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1253             88  VALID-RATE-CODE        VALUE 'Y'.
  1254             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1255
  1256         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1257         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1258         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1259         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1260         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1261         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1262         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1263         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1264         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1265         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1266
  1267* DLO001
  1268 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  25
* EL050.cbl
  1269     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1270     12  DMPF-RETURN-CODE          PIC XX.
  1271         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1272         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1273         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1274         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1275         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1276         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1277
  1278* DLO002
  1279 01  WS-DLO-INTERNAL-POLICY-FORM.
  1280     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DIPF-RETURN-CODE          PIC XX.
  1282         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1287         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO003
  1290 01  WS-DLO-VALID-BANK-ID.
  1291     12  DVBI-BANK-ID              PIC X(5).
  1292     12  DVBI-BANK-ID-TYPE         PIC X.
  1293         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1294         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1295         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1296         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1297         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1298     12  DVBI-RETURN-CODE          PIC XX.
  1299         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1300         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1301         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1302         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1303         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1304         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1305         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1306         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1307         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1308
  1309* DLO007
  1310 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1311     12  DCUA-RES-STATE            PIC XX.
  1312     12  DCUA-BEN-TYPE             PIC XX.
  1313     12  DCUA-SYS-IDENT            PIC X.
  1314         88  DCUA-CLAIM                        VALUE 'C'.
  1315         88  DCUA-PREMIUM                      VALUE 'P'.
  1316     12  DCUA-COVERAGE-RULE        PIC X.
  1317     12  DCUA-CLIENT-ID            PIC X(10).
  1318     12  DCUA-EFF-DATE             PIC X(8).
  1319     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1320     12  DCUA-RETURN-CODE          PIC XX.
  1321         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1322     12  DCUA-CERT-NUMBER          PIC X(11).
  1323     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1324     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1325
  1326* DLO011
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  26
* EL050.cbl
  1327 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1328     12  DPRB-RATE-CODE            PIC X(4).
  1329     12  DPRB-COVERAGE-CATEG       PIC X.
  1330     12  DPRB-RETURN-CODE          PIC XX.
  1331         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1332         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1333         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1334         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1335         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1336         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1337         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1338         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1339         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1340     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1341     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1342     12  DPRB-BEN-TYPE             PIC XX.
  1343
  1344* DLO017
  1345 01  WS-DLO-VALID-RATE-CODE.
  1346     12  DVRC-RATE-CODE            PIC X(4).
  1347     12  DVRC-RETURN-CODE          PIC XX.
  1348         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1349         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1350         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1351         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1352         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1353         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1354
  1355* DLO019
  1356 01  WS-DLO-ORIG-COV-CAT.
  1357     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1358     12  DOCC-RETURN-CODE          PIC XX.
  1359     12  DOCC-ORIG-COV-CAT         PIC X.
  1360     12  DOCC-UNDERWITER           PIC XX.
  1361     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1362     12  DOCC-FILLER               PIC X(6).
  1363
  1364* DLO021
  1365 01  WS-DLO-VALID-LOAN-OFFICER.
  1366     12  DVLO-LOAN-OFFICER.
  1367         16  DVLO-BILL-TYPE        PIC X.
  1368         16  DVLO-BILL-SOURCE      PIC X.
  1369         16  DVLO-BATCH-TYPE       PIC X.
  1370     12  DVLO-RETURN-CODE          PIC XX.
  1371         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1373         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1374         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1375         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1376         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1377
  1378* DLO022
  1379 01  WS-DLO-VALID-STATE-CODE.
  1380     12  DVSC-STATE-CODE           PIC XX.
  1381     12  DVSC-RETURN-CODE          PIC XX.
  1382         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383
  1384* DLO023
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  27
* EL050.cbl
  1385 01  WS-DLO-VALID-CODE-VALUES.
  1386     12  DVCV-SYSTEM-ID            PIC XX.
  1387         88  DVCV-CLAIMS                       VALUE 'CL'.
  1388         88  DVCV-CREDIT                       VALUE 'CR'.
  1389     12  DVCV-RECORD-TYPE          PIC XX.
  1390         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1391         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1392         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1393         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1394         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1395         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1396         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1397         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1398     12  DVCV-RECORD-KEY           PIC X(6).
  1399     12  DVCV-RETURN-CODE          PIC XX.
  1400         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1401         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1402         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1403         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1404         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1405         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1406         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1407     12  DVCV-CODE-DESC            PIC X(60).
  1408     12  DVCV-GEN-DESC-1           PIC X(20).
  1409     12  DVCV-GEN-DESC-2           PIC X(20).
  1410     12  DVCV-GEN-DESC-3           PIC X(20).
  1411
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  28
* EL050.cbl
  1413*    COPY ERCBXRF.
  1414******************************************************************
  1415*                                                                *
  1416*                                                                *
  1417*                            ERCBXRF                             *
  1418*                                                                *
  1419*   ONLINE CREDIT SYSTEM                                         *
  1420*                                                                *
  1421*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1422*                                                                *
  1423*   FILE TYPE = VSAM,KSDS                                        *
  1424*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1425*                                                                *
  1426*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1427*       ALTERNATE PATH = NONE                                    *
  1428*                                                                *
  1429*   LOG = NO                                                     *
  1430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1431*                                                                *
  1432******************************************************************
  1433
  1434 01  BANK-CROSS-REFERENCE.
  1435     12  BK-RECORD-ID                PIC XX.
  1436         88  VALID-BK-ID             VALUE 'BK'.
  1437
  1438     12  BK-CONTROL-PRIMARY.
  1439         16  BK-COMPANY-CD           PIC X.
  1440         16  BK-CARRIER              PIC X.
  1441         16  BK-GROUPING             PIC X(6).
  1442         16  BK-BANK-NO              PIC X(10).
  1443
  1444     12  BK-MAINT-INFORMATION.
  1445         16  BK-LAST-MAINT-DT        PIC XX.
  1446         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1447         16  BK-LAST-MAINT-USER      PIC X(4).
  1448         16  FILLER                  PIC X(9).
  1449
  1450     12  FILLER                      PIC X(37).
  1451
  1452     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1453
  1454     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1455                            DEPENDING ON BK-BANK-POINTER-CNT.
  1456         16  BK-AM-ACCOUNT           PIC X(10).
  1457         16  BK-AM-EXP-DT            PIC XX.
  1458         16  BK-AM-EFF-DT            PIC XX.
  1459         16  BK-AM-STATE             PIC XX.
  1460         16  FILLER                  PIC X(20).
  1461
  1462******************************************************************
  1463
  1464*    COPY ERCCOMP.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ERCCOMP                             *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  29
* EL050.cbl
  1471*                                                                *
  1472*   ONLINE CREDIT SYSTEM                                         *
  1473*                                                                *
  1474*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1475*                                                                *
  1476*   FILE TYPE = VSAM,KSDS                                        *
  1477*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1478*                                                                *
  1479*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1480*       ALTERNATE PATH = NONE                                    *
  1481*                                                                *
  1482*   LOG = NO                                                     *
  1483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1484*                                                                *
  1485******************************************************************
  1486*                   C H A N G E   L O G
  1487*
  1488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1489*-----------------------------------------------------------------
  1490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1491* EFFECTIVE    NUMBER
  1492*-----------------------------------------------------------------
  1493* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1494* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1495* 092205    2005050300006  PEMA  ADD LEASE FEE
  1496* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1497* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1498* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1499* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1500* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1501* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1502******************************************************************
  1503
  1504 01  COMPENSATION-MASTER.
  1505     12  CO-RECORD-ID                          PIC XX.
  1506         88  VALID-CO-ID                          VALUE 'CO'.
  1507
  1508     12  CO-CONTROL-PRIMARY.
  1509         16  CO-COMPANY-CD                     PIC X.
  1510         16  CO-CONTROL.
  1511             20  CO-CTL-1.
  1512                 24  CO-CARR-GROUP.
  1513                     28  CO-CARRIER            PIC X.
  1514                     28  CO-GROUPING.
  1515                         32  CO-GROUP-PREFIX   PIC XXX.
  1516                         32  CO-GROUP-PRIME    PIC XXX.
  1517                 24  CO-RESP-NO.
  1518                     28  CO-RESP-PREFIX        PIC X(4).
  1519                     28  CO-RESP-PRIME         PIC X(6).
  1520             20  CO-CTL-2.
  1521                 24  CO-ACCOUNT.
  1522                     28  CO-ACCT-PREFIX        PIC X(4).
  1523                     28  CO-ACCT-PRIME         PIC X(6).
  1524         16  CO-TYPE                           PIC X.
  1525             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1526             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1527             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1528
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  30
* EL050.cbl
  1529     12  CO-MAINT-INFORMATION.
  1530         16  CO-LAST-MAINT-DT                  PIC XX.
  1531         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1532         16  CO-LAST-MAINT-USER                PIC X(4).
  1533     12  FILLER                                PIC XX.
  1534     12  CO-STMT-TYPE                          PIC XXX.
  1535     12  CO-COMP-TYPE                          PIC X.
  1536         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1537     12  CO-STMT-OWNER                         PIC X(4).
  1538     12  CO-BALANCE-CONTROL                    PIC X.
  1539         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1540         88  CO-NO-BALANCE                        VALUE 'N'.
  1541
  1542     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1543         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1544         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1545         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1546
  1547     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1548         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1549         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1550
  1551     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1552     12  CO-GA-DIRECT-DEP                      PIC X.
  1553     12  CO-FUTURE-SPACE                       PIC X.
  1554         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1555
  1556     12  CO-ACCT-NAME                          PIC X(30).
  1557     12  CO-MAIL-NAME                          PIC X(30).
  1558     12  CO-ADDR-1                             PIC X(30).
  1559     12  CO-ADDR-2                             PIC X(30).
  1560     12  CO-ADDR-3.
  1561         16  CO-ADDR-CITY                      PIC X(27).
  1562         16  CO-ADDR-STATE                     PIC XX.
  1563     12  CO-CSO-1099                           PIC X.
  1564     12  CO-ZIP.
  1565         16  CO-ZIP-PRIME.
  1566             20  CO-ZIP-PRI-1ST                PIC X.
  1567                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1568             20  FILLER                        PIC X(4).
  1569         16  CO-ZIP-PLUS4                      PIC X(4).
  1570     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1571         16  CO-CAN-POSTAL-1                   PIC XXX.
  1572         16  CO-CAN-POSTAL-2                   PIC XXX.
  1573         16  FILLER                            PIC XXX.
  1574     12  CO-SOC-SEC                            PIC X(13).
  1575     12  CO-TELEPHONE.
  1576         16  CO-AREA-CODE                      PIC XXX.
  1577         16  CO-PREFIX                         PIC XXX.
  1578         16  CO-PHONE                          PIC X(4).
  1579
  1580     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1581
  1582     12  CO-AR-BAL-LEVEL                       PIC X.
  1583         88  CO-AR-REF-LVL                        VALUE '1'.
  1584         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1585         88  CO-AR-BILL-LVL                       VALUE '2'.
  1586         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  31
* EL050.cbl
  1587         88  CO-AR-FR-LVL                         VALUE '4'.
  1588
  1589     12  CO-AR-NORMAL-PRINT                    PIC X.
  1590         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1591         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1592
  1593     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1594
  1595     12  CO-AR-REPORTING                       PIC X.
  1596         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1597         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1598
  1599     12  CO-AR-PULL-CHECK                      PIC X.
  1600         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1601         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1602
  1603     12  CO-AR-BALANCE-PRINT                   PIC X.
  1604         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1605
  1606     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1607         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1608         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1609         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1610
  1611     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1612
  1613     12  CO-USER-CODE                          PIC X.
  1614     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1615
  1616******************************************************************
  1617*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1618*    THE LAST MONTH END RUN.
  1619******************************************************************
  1620
  1621     12  CO-LAST-ACTIVITY-DATE.
  1622         16  CO-ACT-YEAR                       PIC 99.
  1623         16  CO-ACT-MONTH                      PIC 99.
  1624         16  CO-ACT-DAY                        PIC 99.
  1625
  1626     12  CO-LAST-STMT-DT.
  1627         16  CO-LAST-STMT-YEAR                 PIC 99.
  1628         16  CO-LAST-STMT-MONTH                PIC 99.
  1629         16  CO-LAST-STMT-DAY                  PIC 99.
  1630
  1631     12  CO-MO-END-TOTALS.
  1632         16  CO-MONTHLY-TOTALS.
  1633             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1634             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1635             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1636             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1637             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1638
  1639         16  CO-AGING-TOTALS.
  1640             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1641             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1642             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1643             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1644
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  32
* EL050.cbl
  1645         16  CO-YTD-TOTALS.
  1646             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1647             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1648
  1649         16  CO-OVER-UNDER-TOTALS.
  1650             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1651             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1652
  1653     12  CO-MISCELLANEOUS-TOTALS.
  1654         16  CO-FICA-TOTALS.
  1655             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1656             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CLAIM-TOTALS.
  1659             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1660             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1661
  1662******************************************************************
  1663*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1664*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1665******************************************************************
  1666
  1667     12  CO-CURRENT-TOTALS.
  1668         16  CO-CURRENT-LAST-STMT-DT.
  1669             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1670             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1671             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1672
  1673         16  CO-CURRENT-MONTHLY-TOTALS.
  1674             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1675             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1676             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1677             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1678             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1679
  1680         16  CO-CURRENT-AGING-TOTALS.
  1681             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1682             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1683             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1684             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1685
  1686         16  CO-CURRENT-YTD-TOTALS.
  1687             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1689
  1690     12  CO-PAID-COMM-TOTALS.
  1691         16  CO-YTD-PAID-COMMS.
  1692             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1693             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1694
  1695     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1696         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1697         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1698
  1699     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1700         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1701         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1702         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  33
* EL050.cbl
  1703         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1704         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1705         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1706         88  CO-FINAL-LETTER                  VALUE 'F'.
  1707         88  CO-RECONCILING                   VALUE 'R'.
  1708         88  CO-PHONE-CALL                    VALUE 'P'.
  1709         88  CO-LEGAL                         VALUE 'L'.
  1710         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1711         88  CO-WRITE-OFF                     VALUE 'W'.
  1712         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1713
  1714     12  CO-CSR-CODE                       PIC X(4).
  1715
  1716     12  CO-GA-STATUS-INFO.
  1717         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1718         16  CO-GA-TERMINATION-DT          PIC XX.
  1719         16  CO-GA-STATUS-CODE             PIC X.
  1720             88  CO-GA-ACTIVE                 VALUE 'A'.
  1721             88  CO-GA-INACTIVE               VALUE 'I'.
  1722             88  CO-GA-PENDING                VALUE 'P'.
  1723         16  CO-GA-COMMENTS.
  1724             20  CO-GA-COMMENT-1           PIC X(40).
  1725             20  CO-GA-COMMENT-2           PIC X(40).
  1726             20  CO-GA-COMMENT-3           PIC X(40).
  1727             20  CO-GA-COMMENT-4           PIC X(40).
  1728
  1729     12  CO-RPTCD2                         PIC X(10).
  1730     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1731         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1732         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1733
  1734     12  CO-TYPE-AGENT                     PIC X(01).
  1735         88  CO-CORPORATION                   VALUE 'C'.
  1736         88  CO-PARTNERSHIP                   VALUE 'P'.
  1737         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1738         88  CO-TRUST                         VALUE 'T'.
  1739         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1740
  1741     12  CO-FAXNO.
  1742         16  CO-FAX-AREA-CODE                  PIC XXX.
  1743         16  CO-FAX-PREFIX                     PIC XXX.
  1744         16  CO-FAX-PHONE                      PIC X(4).
  1745
  1746     12  CO-BANK-INFORMATION.
  1747         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1748         16  CO-BANK-TRANSIT-NON REDEFINES
  1749             CO-BANK-TRANSIT-NO                PIC 9(8).
  1750
  1751         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1752     12  CO-MISC-DEDUCT-INFO REDEFINES
  1753                  CO-BANK-INFORMATION.
  1754         16  CO-MD-GL-ACCT                     PIC X(10).
  1755         16  CO-MD-DIV                         PIC XX.
  1756         16  CO-MD-CENTER                      PIC X(4).
  1757         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1758         16  CO-CREATE-AP-CHECK                PIC X.
  1759         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1760         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  34
* EL050.cbl
  1761     12  CO-ACH-STATUS                         PIC X.
  1762         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1763         88  CO-ACH-PENDING                        VALUE 'P'.
  1764
  1765     12  CO-BILL-SW                            PIC X.
  1766     12  CO-CONTROL-NAME                       PIC X(30).
  1767     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1768     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1769     12  CO-CLP-STATE                          PIC XX.
  1770     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1771     12  CO-SPP-REFUND-EDIT                    PIC X.
  1772
  1773******************************************************************
  1774
  1775*    COPY ERCAGTC.
  1776******************************************************************
  1777*                                                                *
  1778*                                                                *
  1779*                            ERCAGTC                             *
  1780*                            VMOD=2.001                          *
  1781*                                                                *
  1782*   ONLINE CREDIT SYSTEM                                         *
  1783*                                                                *
  1784*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1785*                                                                *
  1786*   FILE TYPE = VSAM,KSDS                                        *
  1787*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1788*                                                                *
  1789*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1790*       ALTERNATE PATH = NONE                                    *
  1791*                                                                *
  1792*   LOG = NO                                                     *
  1793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1794*                                                                *
  1795******************************************************************
  1796*                   C H A N G E   L O G
  1797*
  1798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1799*-----------------------------------------------------------------
  1800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1801* EFFECTIVE    NUMBER
  1802*-----------------------------------------------------------------
  1803* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1804* 111004                         NEW FILE AND COPYBOOK
  1805* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1806******************************************************************
  1807 01  AGENT-COMMISSIONS.
  1808     12  AG-RECORD-ID                          PIC XX.
  1809         88  VALID-CO-ID                          VALUE 'AG'.
  1810     12  AG-CONTROL-PRIMARY.
  1811         16  AG-COMPANY-CD                     PIC X.
  1812         16  AG-CONTROL.
  1813             20  AG-CTL-1.
  1814                 24  AG-CARR-GROUP.
  1815                     28  AG-CARRIER            PIC X.
  1816                     28  AG-GROUPING           PIC X(6).
  1817                 24  AG-BANK                   PIC X(10).
  1818             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  35
* EL050.cbl
  1819                 24  AG-EXP-DT                 PIC XX.
  1820         16  AG-TYPE                           PIC X.
  1821             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1822             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1823     12  AG-MAINT-INFORMATION.
  1824         16  AG-LAST-MAINT-DT                  PIC XX.
  1825         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1826         16  AG-LAST-MAINT-USER                PIC X(4).
  1827         16  FILLER                            PIC X(10).
  1828     12  AG-EFF-DT                             PIC XX.
  1829     12  AG-COMM-STRUCTURE.
  1830         16  AG-AGT-COMMS OCCURS 10.
  1831             20  AG-AGT                PIC X(10).
  1832             20  AG-COM-TYP            PIC X.
  1833             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1834             20  AG-RECALC-LV-INDIC    PIC X.
  1835             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1836             20  AG-LRCALC-LV-INDIC    PIC X.
  1837             20  FILLER                PIC X(05).
  1838     12  FILLER                  PIC X(145).
  1839******************************************************************
  1840*    COPY ERCRESS.
  1841******************************************************************
  1842*                                                                *
  1843*                            ERCRESS                             *
  1844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1845*                            VMOD=2.002                          *
  1846*                                                                *
  1847*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1848*                                                                *
  1849*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1850*   VSAM RESIDENT STATE TAX MASTER                              *
  1851*                                                                *
  1852*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1853*                                                                *
  1854*   FILE TYPE = VSAM,KSDS                                        *
  1855*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1856*                                                                *
  1857*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1858*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1859*                                                                *
  1860*   LOG = NO                                                     *
  1861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1862*                                                                *
  1863*                                                                *
  1864******************************************************************
  1865
  1866 01  RESIDENT-STATE-TAX-MASTER.
  1867
  1868     10  ERRESS-PRIMARY-KEY.
  1869         15  RES-COMPANY-CD        PIC X.
  1870         15  RES-RESIDENT-STATE    PIC XX.
  1871         15  RES-COVERAGE-CATEGORY PIC X.
  1872         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1873*                                      YYYYMMDD
  1874*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1875
  1876     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  36
* EL050.cbl
  1877
  1878         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1879         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1880         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1881         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1882
  1883     10 RES-RECALC-SW              PIC   X.
  1884         88 RECALC                VALUE 'Y'.
  1885         88 NO-RECALC             VALUE 'N'.
  1886     10  RES-MAINT-BY              PIC X(4).
  1887     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1888     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1889*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  37
* EL050.cbl
  1891*    COPY ERCRESC.
  1892******************************************************************
  1893*                                                                *
  1894*                            ERCRESC                             *
  1895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1896*                            VMOD=2.003                          *
  1897*                                                                *
  1898*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1899*                                                                *
  1900*   FILE TYPE = VSAM,KSDS                                        *
  1901*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1902*                                                                *
  1903*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1904*       ALTERNATE PATH1 = NONE                                   *
  1905*                                                                *
  1906*   LOG = NO                                                     *
  1907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1908*                                                                *
  1909******************************************************************
  1910
  1911 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1912
  1913     10  ERRESC-RECORD-KEY.
  1914         15  RESC-COMPANY-CD           PIC   X.
  1915         15  RESC-CARRIER              PIC   X.
  1916         15  RESC-GROUP                PIC   X(6).
  1917         15  RESC-STATE                PIC   XX.
  1918         15  RESC-ACCOUNT              PIC   X(10).
  1919         15  RESC-AGENT                PIC   X(10).
  1920         15  RESC-RESIDENT-STATE       PIC   XX.
  1921         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1922*                                           YYYYMMDD
  1923     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1924
  1925     10  RESC-COMM-RECORD-DATA.
  1926         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1927             20 RESC-COVERAGE-CAT      PIC    X.
  1928             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1929             20 RESC-COMMISSION-TAB REDEFINES
  1930                RESC-COMMISSION-PER    PIC  XXX.
  1931
  1932     10  RESC-MAINT-BY                 PIC X(4).
  1933     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1934     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1935*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  38
* EL050.cbl
  1937*    COPY ERCPLAN.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                            ERCPLAN                             *
  1942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1943*                            VMOD=2.003                          *
  1944*                                                                *
  1945*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1946*                                                                *
  1947*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1948*   PLAN MASTER                                                  *
  1949*                                                                *
  1950*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 420   RECFORM = FIX                            *
  1954*                                                                *
  1955*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1956*       ALTERNATE PATH1 = N/A                                    *
  1957*                                                                *
  1958*   LOG = NO                                                     *
  1959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1960*                                                                *
  1961*                                                                *
  1962******************************************************************
  1963
  1964 01  PLAN-MASTER.
  1965     12  PL-RECORD-ID                      PIC XX.
  1966         88  VALID-PL-ID                      VALUE 'PL'.
  1967
  1968     12  PL-CONTROL-PRIMARY.
  1969         16  PL-COMPANY-CD                 PIC X.
  1970         16  PL-MSTR-CNTRL.
  1971             20  PL-CONTROL-A.
  1972                 24  PL-CARRIER            PIC X.
  1973                 24  PL-GROUPING           PIC X(6).
  1974                 24  PL-STATE              PIC XX.
  1975                 24  PL-ACCOUNT            PIC X(10).
  1976             20  PL-BENEFIT-TYPE           PIC X.
  1977             20  PL-BENEFIT-CODE           PIC XX.
  1978             20  PL-REVISION-NO            PIC X(3).
  1979
  1980     12  PL-CONTROL-BY-VAR-GRP.
  1981         16  PL-COMPANY-CD-A1              PIC X.
  1982         16  PL-VG-CARRIER                 PIC X.
  1983         16  PL-VG-GROUPING                PIC X(6).
  1984         16  PL-VG-STATE                   PIC XX.
  1985         16  PL-VG-ACCOUNT                 PIC X(10).
  1986         16  PL-BENEFIT-TYPE-A1            PIC X.
  1987         16  PL-BENEFIT-CODE-A1            PIC XX.
  1988         16  PL-REVISION-NO-A1             PIC 999.
  1989
  1990     12  PL-MAINT-INFORMATION.
  1991         16  PL-LAST-MAINT-DT              PIC XX.
  1992         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1993         16  PL-LAST-MAINT-USER            PIC X(4).
  1994         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  39
* EL050.cbl
  1995
  1996     12  PL-LIABILITY-LIMITS.
  1997         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1998         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1999             20  PL-LM-AGE                 PIC S99        COMP-3.
  2000             20  PL-LM-DUR                 PIC S999       COMP-3.
  2001             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2002             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2003
  2004     12  FILLER                            PIC X(30).
  2005
  2006     12  PL-GL-ACCOUNT-NOS.
  2007         16  PL-PREMIUM-GL                 PIC X(8).
  2008         16  PL-COMM-GL                    PIC X(8).
  2009         16  PL-CLAIM-GL                   PIC X(8).
  2010     12  FILLER                            PIC X(24).
  2011     12  PL-TOLERANCES.
  2012         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2013         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2014         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2015         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2016         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2017         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2018     12  PL-OVER-SHORT.
  2019         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2020         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2021     12  FILLER                            PIC X(24).
  2022     12  PLAN-MISC.
  2023         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2024         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2025         16  PL-IG                         PIC X.
  2026         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2027         16  PL-POLICY-FORM                PIC X(12).
  2028         16  PL-EDIT-FOR-FORM              PIC X(01).
  2029         16  PL-DEV-CODE                   PIC XXX.
  2030         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2031         16  PL-CALC-METHOD                PIC X.
  2032         16  PL-BENEFIT-GROUP              PIC X(05).
  2033         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2034
  2035         16  FILLER                        PIC X(99).
  2036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  40
* EL050.cbl
  2038*    COPY ELCCERT.
  2039******************************************************************
  2040*                                                                *
  2041*                            ELCCERT.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.013                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2051*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2052*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2053*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2054*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2055*                                                                *
  2056*   LOG = YES                                                    *
  2057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2058******************************************************************
  2059*                   C H A N G E   L O G
  2060*
  2061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2062*-----------------------------------------------------------------
  2063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2064* EFFECTIVE    NUMBER
  2065*-----------------------------------------------------------------
  2066* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2067* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2068* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2069* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2070* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2071* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2072* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2073* 032612  CR2011110200001  PEMA  AHL CHANGES
  2074******************************************************************
  2075
  2076 01  CERTIFICATE-MASTER.
  2077     12  CM-RECORD-ID                      PIC XX.
  2078         88  VALID-CM-ID                      VALUE 'CM'.
  2079
  2080     12  CM-CONTROL-PRIMARY.
  2081         16  CM-COMPANY-CD                 PIC X.
  2082         16  CM-CARRIER                    PIC X.
  2083         16  CM-GROUPING.
  2084             20  CM-GROUPING-PREFIX        PIC X(3).
  2085             20  CM-GROUPING-PRIME         PIC X(3).
  2086         16  CM-STATE                      PIC XX.
  2087         16  CM-ACCOUNT.
  2088             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2089             20  CM-ACCOUNT-PRIME          PIC X(6).
  2090         16  CM-CERT-EFF-DT                PIC XX.
  2091         16  CM-CERT-NO.
  2092             20  CM-CERT-PRIME             PIC X(10).
  2093             20  CM-CERT-SFX               PIC X.
  2094
  2095     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  41
* EL050.cbl
  2096         16  CM-COMPANY-CD-A1              PIC X.
  2097         16  CM-INSURED-LAST-NAME          PIC X(15).
  2098         16  CM-INSURED-INITIALS.
  2099             20  CM-INSURED-INITIAL1       PIC X.
  2100             20  CM-INSURED-INITIAL2       PIC X.
  2101
  2102     12  CM-CONTROL-BY-SSN.
  2103         16  CM-COMPANY-CD-A2              PIC X.
  2104         16  CM-SOC-SEC-NO.
  2105             20  CM-SSN-STATE              PIC XX.
  2106             20  CM-SSN-ACCOUNT            PIC X(6).
  2107             20  CM-SSN-LN3.
  2108                 25  CM-INSURED-INITIALS-A2.
  2109                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2110                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2111                 25 CM-PART-LAST-NAME-A2         PIC X.
  2112
  2113     12  CM-CONTROL-BY-CERT-NO.
  2114         16  CM-COMPANY-CD-A4              PIC X.
  2115         16  CM-CERT-NO-A4                 PIC X(11).
  2116
  2117     12  CM-CONTROL-BY-MEMB.
  2118         16  CM-COMPANY-CD-A5              PIC X.
  2119         16  CM-MEMBER-NO.
  2120             20  CM-MEMB-STATE             PIC XX.
  2121             20  CM-MEMB-ACCOUNT           PIC X(6).
  2122             20  CM-MEMB-LN4.
  2123                 25  CM-INSURED-INITIALS-A5.
  2124                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2125                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2126                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2127
  2128     12  CM-INSURED-PROFILE-DATA.
  2129         16  CM-INSURED-FIRST-NAME.
  2130             20  CM-INSURED-1ST-INIT       PIC X.
  2131             20  FILLER                    PIC X(9).
  2132         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2133         16  CM-INSURED-SEX                PIC X.
  2134             88  CM-SEX-MALE                  VALUE 'M'.
  2135             88  CM-SEX-FEMAL                 VALUE 'F'.
  2136         16  CM-INSURED-JOINT-AGE          PIC 99.
  2137         16  CM-JOINT-INSURED-NAME.
  2138             20  CM-JT-LAST-NAME           PIC X(15).
  2139             20  CM-JT-FIRST-NAME.
  2140                 24  CM-JT-1ST-INIT        PIC X.
  2141                 24  FILLER                PIC X(9).
  2142             20  CM-JT-INITIAL             PIC X.
  2143
  2144     12  CM-LIFE-DATA.
  2145         16  CM-LF-BENEFIT-CD              PIC XX.
  2146         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2147         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2148         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2149         16  CM-LF-DEV-CODE                PIC XXX.
  2150         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2151         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2152         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2153         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  42
* EL050.cbl
  2154         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2155         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2156         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2157         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2158         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2159         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2160         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2161         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2162         16  FILLER                        PIC XX.
  2163
  2164     12  CM-AH-DATA.
  2165         16  CM-AH-BENEFIT-CD              PIC XX.
  2166         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2167         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2168         16  CM-AH-DEV-CODE                PIC XXX.
  2169         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2171         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2173         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2174         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2175         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2176         16  CM-AH-PAID-THRU-DT            PIC XX.
  2177             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2178         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2181         16  FILLER                        PIC X.
  2182
  2183     12  CM-LOAN-INFORMATION.
  2184         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2185         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2186                                           PIC S9(5)V99  COMP-3.
  2187         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2188         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2189         16  CM-PAY-FREQUENCY              PIC S99.
  2190         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2191         16  CM-RATE-CLASS                 PIC XX.
  2192         16  CM-BENEFICIARY                PIC X(25).
  2193         16  CM-POLICY-FORM-NO             PIC X(12).
  2194         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2195         16  CM-LAST-ADD-ON-DT             PIC XX.
  2196         16  CM-DEDUCTIBLE-AMOUNTS.
  2197             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2198             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2199         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2200             20  CM-RESIDENT-STATE         PIC XX.
  2201             20  CM-RATE-CODE              PIC X(4).
  2202             20  FILLER                    PIC XX.
  2203         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2204             20  CM-LOAN-OFFICER           PIC X(5).
  2205             20  FILLER                    PIC XXX.
  2206         16  CM-CSR-CODE                   PIC XXX.
  2207         16  CM-UNDERWRITING-CODE          PIC X.
  2208             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2209         16  CM-POST-CARD-IND              PIC X.
  2210         16  CM-NH-INTERFACE-SW            PIC X.
  2211         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  43
* EL050.cbl
  2212             88  CM-SING-PRM                  VALUE '1'.
  2213             88  CM-O-B-COVERAGE              VALUE '2'.
  2214             88  CM-OPEN-END                  VALUE '3'.
  2215         16  CM-IND-GRP-TYPE               PIC X.
  2216             88  CM-INDIVIDUAL                VALUE 'I'.
  2217             88  CM-GROUP                     VALUE 'G'.
  2218         16  CM-SKIP-CODE                  PIC X.
  2219             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2220             88  SKIP-JULY                    VALUE '1'.
  2221             88  SKIP-AUGUST                  VALUE '2'.
  2222             88  SKIP-SEPTEMBER               VALUE '3'.
  2223             88  SKIP-JULY-AUG                VALUE '4'.
  2224             88  SKIP-AUG-SEPT                VALUE '5'.
  2225             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2226             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2227             88  SKIP-JUNE                    VALUE '8'.
  2228             88  SKIP-JUNE-JULY               VALUE '9'.
  2229             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2230             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2231         16  CM-PAYMENT-MODE               PIC X.
  2232             88  PAY-MONTHLY                  VALUE SPACE.
  2233             88  PAY-WEEKLY                   VALUE '1'.
  2234             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2235             88  PAY-BI-WEEKLY                VALUE '3'.
  2236             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2237         16  CM-LOAN-NUMBER                PIC X(8).
  2238         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2239         16  CM-OLD-LOF                    PIC XXX.
  2240*        16  CM-LOAN-OFFICER               PIC XXX.
  2241         16  CM-REIN-TABLE                 PIC XXX.
  2242         16  CM-SPECIAL-REIN-CODE          PIC X.
  2243         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2244         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2245         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2246
  2247     12  CM-STATUS-DATA.
  2248         16  CM-ENTRY-STATUS               PIC X.
  2249         16  CM-ENTRY-DT                   PIC XX.
  2250
  2251         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-LF-CANCEL-DT               PIC XX.
  2253         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2256         16  CM-LF-DEATH-DT                PIC XX.
  2257         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2258
  2259         16  CM-LF-CURRENT-STATUS          PIC X.
  2260             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2264             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  44
* EL050.cbl
  2270             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-LF-DECLINED               VALUE 'D'.
  2273             88  CM-LF-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2276         16  CM-AH-CANCEL-DT               PIC XX.
  2277         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2278
  2279         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2280         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2281         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2282
  2283         16  CM-AH-CURRENT-STATUS          PIC X.
  2284             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2285                                                'M' '4' '5' '9'.
  2286             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2287             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2288             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2289             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2290             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2291             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2292             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2293             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2294             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2295             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2296             88  CM-AH-DECLINED               VALUE 'D'.
  2297             88  CM-AH-VOIDED                 VALUE 'V'.
  2298
  2299         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2300             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2301             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2302             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2303         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2304
  2305         16  CM-ENTRY-BATCH                PIC X(6).
  2306         16  CM-LF-EXIT-BATCH              PIC X(6).
  2307         16  CM-AH-EXIT-BATCH              PIC X(6).
  2308         16  CM-LAST-MONTH-END             PIC XX.
  2309
  2310     12  CM-NOTE-SW                        PIC X.
  2311         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2312         88  CERT-NOTES-PRESENT               VALUE '1'.
  2313         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2314         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2315         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2316         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2317         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2318         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2319     12  CM-COMP-EXCP-SW                   PIC X.
  2320         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2321         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2322     12  CM-INSURED-ADDRESS-SW             PIC X.
  2323         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2324         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2325
  2326*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2327     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  45
* EL050.cbl
  2328     12  FILLER                            PIC X.
  2329
  2330*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2331     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2332     12  FILLER                            PIC X.
  2333*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2334     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2335
  2336     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2337         88  CERT-ADDED-BATCH                 VALUE ' '.
  2338         88  CERT-ADDED-ONLINE                VALUE '1'.
  2339         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2340         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2341         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2342     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2343         88  CERT-AS-LOADED                   VALUE ' '.
  2344         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2345         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2346         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2347         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2348         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2349         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2350         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2351
  2352     12  CM-ACCOUNT-COMM-PCTS.
  2353         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2354         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2355
  2356     12  CM-USER-FIELD                     PIC X.
  2357     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2358     12  CM-CLP-STATE                      PIC XX.
  2359     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2360     12  CM-USER-RESERVED                  PIC XXX.
  2361     12  FILLER REDEFINES CM-USER-RESERVED.
  2362         16  CM-AH-CLASS-CD                PIC XX.
  2363         16  F                             PIC X.
  2364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  46
* EL050.cbl
  2366*    COPY ERCMAIL.
  2367******************************************************************
  2368*                                                                *
  2369*                                                                *
  2370*                            ERCMAIL                             *
  2371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2372*                            VMOD=2.003                          *
  2373*                                                                *
  2374*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2375*                                                                *
  2376*   FILE TYPE = VSAM,KSDS                                        *
  2377*   RECORD SIZE = 374   RECFORM = FIX                            *
  2378*                                                                *
  2379*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2380*   ALTERNATE PATH    = NOT USED                                 *
  2381*                                                                *
  2382*   LOG = YES                                                    *
  2383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2384******************************************************************
  2385*                   C H A N G E   L O G
  2386*
  2387* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2388*-----------------------------------------------------------------
  2389*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2390* EFFECTIVE    NUMBER
  2391*-----------------------------------------------------------------
  2392* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2393* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2394* 111108                   PEMA  ADD CRED BENE ADDR2
  2395******************************************************************
  2396
  2397 01  MAILING-DATA.
  2398     12  MA-RECORD-ID                      PIC XX.
  2399         88  VALID-MA-ID                       VALUE 'MA'.
  2400
  2401     12  MA-CONTROL-PRIMARY.
  2402         16  MA-COMPANY-CD                 PIC X.
  2403         16  MA-CARRIER                    PIC X.
  2404         16  MA-GROUPING.
  2405             20  MA-GROUPING-PREFIX        PIC XXX.
  2406             20  MA-GROUPING-PRIME         PIC XXX.
  2407         16  MA-STATE                      PIC XX.
  2408         16  MA-ACCOUNT.
  2409             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2410             20  MA-ACCOUNT-PRIME          PIC X(6).
  2411         16  MA-CERT-EFF-DT                PIC XX.
  2412         16  MA-CERT-NO.
  2413             20  MA-CERT-PRIME             PIC X(10).
  2414             20  MA-CERT-SFX               PIC X.
  2415
  2416     12  FILLER                            PIC XX.
  2417
  2418     12  MA-ACCESS-CONTROL.
  2419         16  MA-SOURCE-SYSTEM              PIC XX.
  2420             88  MA-FROM-CREDIT                VALUE 'CR'.
  2421             88  MA-FROM-VSI                   VALUE 'VS'.
  2422             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2423             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  47
* EL050.cbl
  2424         16  MA-RECORD-ADD-DT              PIC XX.
  2425         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2426         16  MA-LAST-MAINT-DT              PIC XX.
  2427         16  MA-LAST-MAINT-BY              PIC XXXX.
  2428         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2429
  2430     12  MA-PROFILE-INFO.
  2431         16  MA-QUALIFY-CODE-1             PIC XX.
  2432         16  MA-QUALIFY-CODE-2             PIC XX.
  2433         16  MA-QUALIFY-CODE-3             PIC XX.
  2434         16  MA-QUALIFY-CODE-4             PIC XX.
  2435         16  MA-QUALIFY-CODE-5             PIC XX.
  2436
  2437         16  MA-INSURED-LAST-NAME          PIC X(15).
  2438         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2439         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2440         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2441         16  MA-INSURED-BIRTH-DT           PIC XX.
  2442         16  MA-INSURED-SEX                PIC X.
  2443             88  MA-SEX-MALE                   VALUE 'M'.
  2444             88  MA-SEX-FEMALE                 VALUE 'F'.
  2445         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2446
  2447         16  MA-ADDRESS-CORRECTED          PIC X.
  2448         16  MA-JOINT-BIRTH-DT             PIC XX.
  2449*        16  FILLER                        PIC X(12).
  2450
  2451         16  MA-ADDRESS-LINE-1             PIC X(30).
  2452         16  MA-ADDRESS-LINE-2             PIC X(30).
  2453         16  MA-CITY-STATE.
  2454             20  MA-CITY                   PIC X(28).
  2455             20  MA-ADDR-STATE             PIC XX.
  2456         16  MA-ZIP.
  2457             20  MA-ZIP-CODE.
  2458                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2459                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2460                 24  FILLER                PIC X(4).
  2461             20  MA-ZIP-PLUS4              PIC X(4).
  2462         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2463             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2464             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2465             20  FILLER                    PIC X(3).
  2466
  2467         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2468
  2469         16  FILLER                        PIC XXX.
  2470*        16  FILLER                        PIC X(10).
  2471
  2472     12  MA-CRED-BENE-INFO.
  2473         16  MA-CRED-BENE-NAME                 PIC X(25).
  2474         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2475         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2476         16  MA-CRED-BENE-CTYST.
  2477             20  MA-CRED-BENE-CITY             PIC X(28).
  2478             20  MA-CRED-BENE-STATE            PIC XX.
  2479         16  MA-CRED-BENE-ZIP.
  2480             20  MA-CB-ZIP-CODE.
  2481                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  48
* EL050.cbl
  2482                     88  MA-CB-CANADIAN-POST-CODE
  2483                                           VALUE 'A' THRU 'Z'.
  2484                 24  FILLER                    PIC X(4).
  2485             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2486         16  MA-CB-CANADIAN-POSTAL-CODE
  2487                            REDEFINES MA-CRED-BENE-ZIP.
  2488             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2489             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2490             20  FILLER                        PIC X(3).
  2491     12  MA-POST-CARD-MAIL-DATA.
  2492         16  MA-MAIL-DATA OCCURS 7.
  2493             20  MA-MAIL-TYPE              PIC X.
  2494                 88  MA-12MO-MAILING           VALUE '1'.
  2495                 88  MA-EXP-MAILING            VALUE '2'.
  2496             20  MA-MAIL-STATUS            PIC X.
  2497                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2498                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2499                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2500             20  MA-MAIL-DATE              PIC XX.
  2501     12  FILLER                            PIC XX.
  2502     12  FILLER                            PIC XX.
  2503*    12  FILLER                            PIC X(30).
  2504******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  49
* EL050.cbl
  2506*    COPY ERCPNDM.
  2507******************************************************************
  2508*                                                                *
  2509*                                                                *
  2510*                            ERCPNDM                             *
  2511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2512*                            VMOD=2.003                          *
  2513*                                                                *
  2514*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2515*                                                                *
  2516*   FILE TYPE = VSAM,KSDS                                        *
  2517*   RECORD SIZE = 374   RECFORM = FIX                            *
  2518*                                                                *
  2519*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2520*   ALTERNATE PATH    = NOT USED                                 *
  2521*                                                                *
  2522*   LOG = YES                                                    *
  2523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2524******************************************************************
  2525*                   C H A N G E   L O G
  2526*
  2527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2528*-----------------------------------------------------------------
  2529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2530* EFFECTIVE    NUMBER
  2531*-----------------------------------------------------------------
  2532* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2533* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2535******************************************************************
  2536
  2537 01  PENDING-MAILING-DATA.
  2538     12  PM-RECORD-ID                      PIC XX.
  2539         88  VALID-MA-ID                       VALUE 'PM'.
  2540
  2541     12  PM-CONTROL-PRIMARY.
  2542         16  PM-COMPANY-CD                 PIC X.
  2543         16  PM-ENTRY-BATCH                PIC X(6).
  2544         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2545         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2546
  2547     12  FILLER                            PIC X(14).
  2548
  2549     12  PM-ACCESS-CONTROL.
  2550         16  PM-SOURCE-SYSTEM              PIC XX.
  2551             88  PM-FROM-CREDIT                VALUE 'CR'.
  2552             88  PM-FROM-VSI                   VALUE 'VS'.
  2553             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2554             88  PM-FROM-OTHER                 VALUE 'OT'.
  2555         16  PM-RECORD-ADD-DT              PIC XX.
  2556         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2557         16  PM-LAST-MAINT-DT              PIC XX.
  2558         16  PM-LAST-MAINT-BY              PIC XXXX.
  2559         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2560
  2561     12  PM-PROFILE-INFO.
  2562         16  PM-QUALIFY-CODE-1             PIC XX.
  2563         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  50
* EL050.cbl
  2564         16  PM-QUALIFY-CODE-3             PIC XX.
  2565         16  PM-QUALIFY-CODE-4             PIC XX.
  2566         16  PM-QUALIFY-CODE-5             PIC XX.
  2567
  2568         16  PM-INSURED-LAST-NAME          PIC X(15).
  2569         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2570         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2571         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2572         16  PM-INSURED-BIRTH-DT           PIC XX.
  2573         16  PM-INSURED-SEX                PIC X.
  2574             88  PM-SEX-MALE                   VALUE 'M'.
  2575             88  PM-SEX-FEMALE                 VALUE 'F'.
  2576         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2577
  2578         16  PM-ADDRESS-CORRECTED          PIC X.
  2579         16  PM-JOINT-BIRTH-DT             PIC XX.
  2580*        16  FILLER                        PIC X(12).
  2581
  2582         16  PM-ADDRESS-LINE-1             PIC X(30).
  2583         16  PM-ADDRESS-LINE-2             PIC X(30).
  2584         16  PM-CITY-STATE.
  2585             20  PM-CITY                   PIC X(28).
  2586             20  PM-STATE                  PIC XX.
  2587         16  PM-ZIP.
  2588             20  PM-ZIP-CODE.
  2589                 24  PM-ZIP-1              PIC X.
  2590                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-ZIP-PLUS4              PIC X(4).
  2593         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2594             20  PM-CAN-POST1              PIC XXX.
  2595             20  PM-CAN-POST2              PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597
  2598         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2599
  2600         16  FILLER                        PIC X(03).
  2601
  2602     12  PM-CRED-BENE-INFO.
  2603         16  PM-CRED-BENE-NAME             PIC X(25).
  2604         16  PM-CRED-BENE-ADDR             PIC X(30).
  2605         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2606         16  PM-CRED-BENE-CTYST.
  2607             20  PM-CRED-BENE-CITY         PIC X(28).
  2608             20  PM-CRED-BENE-STATE        PIC XX.
  2609         16  PM-CRED-BENE-ZIP.
  2610             20  PM-CB-ZIP-CODE.
  2611                 24  PM-CB-ZIP-1           PIC X.
  2612                     88  PM-CB-CANADIAN-POST-CODE
  2613                                  VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2616         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2617             20  PM-CB-CAN-POST1           PIC XXX.
  2618             20  PM-CB-CAN-POST2           PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620     12  PM-POST-CARD-MAIL-DATA.
  2621         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  51
* EL050.cbl
  2622             20  PM-MAIL-TYPE              PIC X.
  2623                 88  PM-12MO-MAILING           VALUE '1'.
  2624                 88  PM-EXP-MAILING            VALUE '2'.
  2625             20  PM-MAIL-STATUS            PIC X.
  2626                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2627                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2628                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2629             20  PM-MAIL-DATE              PIC XX.
  2630     12  FILLER                            PIC XX.
  2631     12  FILLER                            PIC X(12).
  2632*    12  FILLER                            PIC X(30).
  2633
  2634******************************************************************
  2635*                                COPY ERCLOFC.
  2636******************************************************************
  2637*                                                                *
  2638*                                                                *
  2639*                            ERCLOFC                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.003                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 670   RECFORM = FIX                            *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2649*                                                                *
  2650*   LOG = YES                                                    *
  2651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2652*                                                                *
  2653******************************************************************
  2654
  2655 01  LOAN-OFFICER-MASTER.
  2656     12  LO-RECORD-ID                PIC XX.
  2657         88  VALID-LO-ID                VALUE 'LO'.
  2658
  2659     12  LO-CONTROL-PRIMARY.
  2660         16  LO-COMPANY-CD           PIC X.
  2661         16  LO-CARRIER              PIC X.
  2662         16  LO-GROUPING.
  2663             20  LO-GROUPING-PREFIX  PIC XXX.
  2664             20  LO-GROUPING-PRIME   PIC XXX.
  2665         16  LO-STATE                PIC XX.
  2666         16  LO-ACCOUNT.
  2667             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2668             20  LO-ACCOUNT-PRIME    PIC X(6).
  2669         16  LO-OFFICER-CODE         PIC X(5).
  2670
  2671     12  LO-OFFICER-NAME             PIC X(30).
  2672
  2673     12  LO-LAST-MAINT-DT            PIC XX.
  2674     12  LO-LAST-USER                PIC X(4).
  2675     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2676
  2677     12  LO-COMP-CONTROL             PIC X.
  2678             88  LO-SHOW-COMP           VALUE 'Y'.
  2679             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  52
* EL050.cbl
  2680     12  LO-DETAIL-CONTROL           PIC X.
  2681             88  LO-PRINT-DETAIL        VALUE 'D'.
  2682             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2683
  2684     12  LO-SV-CARRIER               PIC X.
  2685     12  LO-SV-GROUPING              PIC X(6).
  2686     12  LO-SV-STATE                 PIC XX.
  2687
  2688     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2689     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2690
  2691     12  LO-OFFICER-INFO.
  2692         16  FILLER OCCURS 12 TIMES.
  2693             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2694             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2695             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2696             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2697             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2698             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2699             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2700             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2701     12  FILLER                      PIC X(198).
  2702******************************************************************
  2703*                                COPY ERCPDEF.
  2704******************************************************************
  2705*                                                                *
  2706*                                                                *
  2707*                            ERCPDEF.                            *
  2708*                                                                *
  2709*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2710*                                                                *
  2711*    FILE TYPE = VSAM,KSDS                                       *
  2712*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2713*                                                                *
  2714*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2715*                                                                *
  2716*    LOG = YES                                                   *
  2717*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2718******************************************************************
  2719 01  PRODUCT-MASTER.
  2720    12  PD-RECORD-ID                 PIC X(02).
  2721        88  VALID-PD-ID                  VALUE 'PD'.
  2722    12  PD-CONTROL-PRIMARY.
  2723        16  PD-COMPANY-CD            PIC X.
  2724        16  PD-STATE                 PIC XX.
  2725        16  PD-PRODUCT-CD            PIC XXX.
  2726        16  PD-FILLER                PIC X(7).
  2727        16  PD-BEN-TYPE              PIC X.
  2728        16  PD-BEN-CODE              PIC XX.
  2729        16  PD-PROD-EXP-DT           PIC XX.
  2730    12  FILLER                       PIC X(50).
  2731    12  PD-PRODUCT-DATA OCCURS 8.
  2732        16  PD-PROD-CODE             PIC X.
  2733            88  PD-PROD-LIFE           VALUE 'L'.
  2734            88  PD-PROD-PROP           VALUE 'P'.
  2735            88  PD-PROD-AH             VALUE 'A'.
  2736            88  PD-PROD-IU             VALUE 'I'.
  2737            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  53
* EL050.cbl
  2738        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2739        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2740        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2741        16  PD-MAX-TERM              PIC S999        COMP-3.
  2742        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2743        16  FILLER                   PIC X.
  2744        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2745        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2746        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2747        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2748        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2749        16  PD-REC-CRIT-PERIOD       PIC X.
  2750        16  PD-RTW-MOS               PIC 99.
  2751        16  FILLER                   PIC X(5).
  2752    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2753    12  PD-TERM-LIMITS OCCURS 15.
  2754        16  PD-LOW-TERM              PIC S999        COMP-3.
  2755        16  PD-HI-TERM               PIC S999        COMP-3.
  2756*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2757    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2758        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2759        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2760    12  PD-EARN-FACTORS.
  2761        16  FILLER OCCURS 15.
  2762            20  FILLER OCCURS 15.
  2763                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2764    12  PD-PRODUCT-DESC              PIC X(80).
  2765    12  PD-TRUNCATED                 PIC X.
  2766    12  FILLER                       PIC X(59).
  2767    12  PD-MAINT-INFORMATION.
  2768        16  PD-LAST-MAINT-DT         PIC X(02).
  2769        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2770        16  PD-LAST-MAINT-BY         PIC X(04).
  2771*                                COPY ELCSTATE.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ELCSTATE.                           *
  2776*                                                                *
  2777*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2778*                                                                *
  2779*   FILE TYPE = VSAM,KSDS                                        *
  2780*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2781*                                                                *
  2782*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2783*       ALTERNATE INDEX = NONE                                   *
  2784*                                                                *
  2785*   LOG = YES                                                    *
  2786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2787******************************************************************
  2788*                   C H A N G E   L O G
  2789*
  2790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2791*-----------------------------------------------------------------
  2792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2793* EFFECTIVE    NUMBER
  2794*-----------------------------------------------------------------
  2795* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  54
* EL050.cbl
  2796******************************************************************
  2797*
  2798 01  STATE-FILE.
  2799     12  SF-RECORD-ID                       PIC XX.
  2800         88  VALID-CF-ID                        VALUE 'SF'.
  2801     12  SF-CONTROL-PRIMARY.
  2802         16  SF-COMPANY-ID                  PIC XXX.
  2803         16  SF-CARRIER-CODE                PIC X.
  2804         16  SF-GROUPING                    PIC X(6).
  2805         16  SF-STATE-CODE                  PIC XX.
  2806         16  SF-EXPIRE-DATE                 PIC 9(8).
  2807****************************************************************
  2808*             STATE CONTROLS
  2809****************************************************************
  2810     12  SF-LAST-MAINT-DT                   PIC XX.
  2811     12  SF-LAST-MAINT-BY                   PIC X(4).
  2812     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2813     12  SF-STATE-RT-CONTROLS.
  2814         16  SF-ST-RT-CALC                  PIC X.
  2815     12  SF-ST-TAX-CONTROLS.
  2816         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2817         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2818         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2819     12  SF-ST-REFUND-OPTIONS.
  2820         16  SF-ST-RF-LR-CALC               PIC X.
  2821         16  SF-ST-RF-LL-CALC               PIC X.
  2822         16  SF-ST-RF-LN-CALC               PIC X.
  2823         16  SF-ST-RF-AH-CALC               PIC X.
  2824         16  SF-ST-RF-CP-CALC               PIC X.
  2825     12  SF-ST-UNEARN-PREM-OPTIONS.
  2826         16  SF-ST-LUEP-R78                 PIC X.
  2827         16  SF-ST-LUEP-PRO                 PIC X.
  2828         16  SF-ST-LUEP-ST                  PIC X.
  2829         16  SF-ST-LUEP-DOM                 PIC X.
  2830         16  SF-ST-AUEP-R78                 PIC X.
  2831         16  SF-ST-AUEP-PRO                 PIC X.
  2832         16  SF-ST-AUEP-ST                  PIC X.
  2833         16  SF-ST-AUEP-DOM                 PIC X.
  2834         16  SF-ST-CUEP-R78                 PIC X.
  2835         16  SF-ST-CUEP-PRO                 PIC X.
  2836         16  SF-ST-CUEP-ST                  PIC X.
  2837         16  SF-ST-CUEP-DOM                 PIC X.
  2838     12  SF-ST-EARN-PREM-OPTIONS.
  2839         16  SF-ST-LEP-R78                  PIC X.
  2840         16  SF-ST-LEP-PRO                  PIC X.
  2841         16  SF-ST-LEP-ST                   PIC X.
  2842         16  SF-ST-LEP-DOM                  PIC X.
  2843         16  SF-ST-AEP-R78                  PIC X.
  2844         16  SF-ST-AEP-PRO                  PIC X.
  2845         16  SF-ST-AEP-ST                   PIC X.
  2846         16  SF-ST-AEP-DOM                  PIC X.
  2847         16  SF-ST-CEP-R78                  PIC X.
  2848         16  SF-ST-CEP-PRO                  PIC X.
  2849         16  SF-ST-CEP-ST                   PIC X.
  2850         16  SF-ST-CEP-DOM                  PIC X.
  2851     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  55
* EL050.cbl
  2853*    COPY ELCCRTT.
  2854******************************************************************
  2855*                                                                *
  2856*                            ELCCRTT.                            *
  2857*                                                                *
  2858*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2859*                                                                *
  2860*   FILE TYPE = VSAM,KSDS                                        *
  2861*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2862*                                                                *
  2863*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2864*                                                                *
  2865*   LOG = YES                                                    *
  2866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2876* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2877* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2878******************************************************************
  2879
  2880 01  CERTIFICATE-TRAILERS.
  2881     12  CS-RECORD-ID                      PIC XX.
  2882         88  VALID-CS-ID                      VALUE 'CS'.
  2883
  2884     12  CS-CONTROL-PRIMARY.
  2885         16  CS-COMPANY-CD                 PIC X.
  2886         16  CS-CARRIER                    PIC X.
  2887         16  CS-GROUPING                   PIC X(6).
  2888         16  CS-STATE                      PIC XX.
  2889         16  CS-ACCOUNT                    PIC X(10).
  2890         16  CS-CERT-EFF-DT                PIC XX.
  2891         16  CS-CERT-NO.
  2892             20  CS-CERT-PRIME             PIC X(10).
  2893             20  CS-CERT-SFX               PIC X.
  2894         16  CS-TRAILER-TYPE               PIC X.
  2895             88  COMM-TRLR           VALUE 'A'.
  2896             88  FUTURE-TRLR         VALUE 'B'.
  2897             88  CERT-DATA-TRLR      VALUE 'C'.
  2898
  2899     12  CS-DATA-AREA                      PIC X(516).
  2900
  2901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2902         16  CS-BANK-COMMISSION-AREA.
  2903             20  CS-BANK-COMMS       OCCURS 10.
  2904                 24  CS-AGT                PIC X(10).
  2905                 24  CS-COM-TYP            PIC X.
  2906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2907                 24  CS-RECALC-LV-INDIC    PIC X.
  2908                 24  FILLER                PIC X(10).
  2909         16  FILLER                        PIC X(256).
  2910
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  56
* EL050.cbl
  2911     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2912         16  CS-VIN-NUMBER                 PIC X(17).
  2913         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2914         16  FILLER                        PIC X(498).
  2915******************************************************************
  2916*    COPY ELCCRTO.
  2917******************************************************************
  2918*                                                                *
  2919*                            ELCCRTO.                            *
  2920*                                                                *
  2921*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2922*                                                                *
  2923*   FILE TYPE = VSAM,KSDS                                        *
  2924*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2925*                                                                *
  2926*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2927*                                                                *
  2928*   LOG = YES                                                    *
  2929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2930******************************************************************
  2931*                   C H A N G E   L O G
  2932*
  2933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2934*-----------------------------------------------------------------
  2935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2936* EFFECTIVE    NUMBER
  2937*-----------------------------------------------------------------
  2938* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2939* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2940* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2941******************************************************************
  2942 01  ORIGINAL-CERTIFICATE.
  2943     12  OC-RECORD-ID                      PIC XX.
  2944         88  VALID-OC-ID                      VALUE 'OC'.
  2945     12  OC-CONTROL-PRIMARY.
  2946         16  OC-COMPANY-CD                 PIC X.
  2947         16  OC-CARRIER                    PIC X.
  2948         16  OC-GROUPING                   PIC X(6).
  2949         16  OC-STATE                      PIC XX.
  2950         16  OC-ACCOUNT                    PIC X(10).
  2951         16  OC-CERT-EFF-DT                PIC XX.
  2952         16  OC-CERT-NO.
  2953             20  OC-CERT-PRIME             PIC X(10).
  2954             20  OC-CERT-SFX               PIC X.
  2955         16  OC-RECORD-TYPE                PIC X.
  2956         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2957     12  OC-LAST-MAINT-DT                  PIC XX.
  2958     12  OC-LAST-MAINT-BY                  PIC X(4).
  2959     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2960     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2961     12  FILLER                            PIC X(49).
  2962     12  OC-ORIG-REC.
  2963         16  OC-INS-LAST-NAME              PIC X(15).
  2964         16  OC-INS-FIRST-NAME             PIC X(10).
  2965         16  OC-INS-MIDDLE-INIT            PIC X.
  2966         16  OC-INS-AGE                    PIC S999     COMP-3.
  2967         16  OC-JNT-LAST-NAME              PIC X(15).
  2968         16  OC-JNT-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  57
* EL050.cbl
  2969         16  OC-JNT-MIDDLE-INIT            PIC X.
  2970         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2971         16  OC-LF-BENCD                   PIC XX.
  2972         16  OC-LF-TERM                    PIC S999      COMP-3.
  2973         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2974         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2975         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2976         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2977         16  OC-LF-EXP-DT                  PIC XX.
  2978         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2979         16  OC-LF-CANCEL-DT               PIC XX.
  2980         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2981         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2982         16  OC-AH-BENCD                   PIC XX.
  2983         16  OC-AH-TERM                    PIC S999      COMP-3.
  2984         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2985         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2986         16  OC-AH-EXP-DT                  PIC XX.
  2987         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2988         16  OC-AH-CP                      PIC 99.
  2989         16  OC-AH-CANCEL-DT               PIC XX.
  2990         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2991         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2992         16  OC-CRED-BENE-NAME             PIC X(25).
  2993         16  OC-1ST-PMT-DT                 PIC XX.
  2994         16  FILLER                        PIC X(215).
  2995
  2996     12  FILLER                            PIC X(50).
  2997******************************************************************
  2998
  2999*    COPY ELCDATE.
  3000******************************************************************
  3001*                                                                *
  3002*                                                                *
  3003*                            ELCDATE.                            *
  3004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3005*                            VMOD=2.003
  3006*                                                                *
  3007*                                                                *
  3008*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3009*                 LENGTH = 200                                   *
  3010******************************************************************
  3011
  3012 01  DATE-CONVERSION-DATA.
  3013     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3014     12  DC-OPTION-CODE                PIC X.
  3015         88  BIN-TO-GREG                VALUE ' '.
  3016         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3017         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3018         88  YMD-GREG-TO-BIN            VALUE '3'.
  3019         88  MDY-GREG-TO-BIN            VALUE '4'.
  3020         88  JULIAN-TO-BIN              VALUE '5'.
  3021         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3022         88  FIND-CENTURY               VALUE '7'.
  3023         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3024         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3025         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3026         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  58
* EL050.cbl
  3027         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3028         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3029         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3030         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3031         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3032         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3033         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3034         88  BIN-3-TO-GREG              VALUE 'I'.
  3035         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3036         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3037         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3038         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3039         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3040         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3041         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3042         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3043         88  THREE-CHARACTER-BIN
  3044                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3045         88  GREGORIAN-TO-BIN
  3046                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3047         88  BIN-TO-GREGORIAN
  3048                  VALUES ' ' '1' 'I' '8' 'G'.
  3049         88  JULIAN-TO-BINARY
  3050                  VALUES '5' 'C' 'E' 'F'.
  3051     12  DC-ERROR-CODE                 PIC X.
  3052         88  NO-CONVERSION-ERROR        VALUE ' '.
  3053         88  DATE-CONVERSION-ERROR
  3054                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3055         88  DATE-IS-ZERO               VALUE '1'.
  3056         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3057         88  DATE-IS-INVALID            VALUE '3'.
  3058         88  DATE1-GREATER-DATE2        VALUE '4'.
  3059         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3060         88  DATE-INVALID-OPTION        VALUE '9'.
  3061         88  INVALID-CENTURY            VALUE 'A'.
  3062         88  ONLY-CENTURY               VALUE 'B'.
  3063         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3064         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3065     12  DC-END-OF-MONTH               PIC X.
  3066         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3067     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3068         88  USE-NORMAL-PROCESS         VALUE ' '.
  3069         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3070         88  ADJUST-UP-100-YRS          VALUE '2'.
  3071     12  FILLER                        PIC X.
  3072     12  DC-CONVERSION-DATES.
  3073         16  DC-BIN-DATE-1             PIC XX.
  3074         16  DC-BIN-DATE-2             PIC XX.
  3075         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3076         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3077                       DC-GREG-DATE-1-EDIT.
  3078             20  DC-EDIT1-MONTH        PIC 99.
  3079             20  SLASH1-1              PIC X.
  3080             20  DC-EDIT1-DAY          PIC 99.
  3081             20  SLASH1-2              PIC X.
  3082             20  DC-EDIT1-YEAR         PIC 99.
  3083         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3084         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  59
* EL050.cbl
  3085                     DC-GREG-DATE-2-EDIT.
  3086             20  DC-EDIT2-MONTH        PIC 99.
  3087             20  SLASH2-1              PIC X.
  3088             20  DC-EDIT2-DAY          PIC 99.
  3089             20  SLASH2-2              PIC X.
  3090             20  DC-EDIT2-YEAR         PIC 99.
  3091         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3092         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3093                     DC-GREG-DATE-1-YMD.
  3094             20  DC-YMD-YEAR           PIC 99.
  3095             20  DC-YMD-MONTH          PIC 99.
  3096             20  DC-YMD-DAY            PIC 99.
  3097         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3098         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3099                      DC-GREG-DATE-1-MDY.
  3100             20  DC-MDY-MONTH          PIC 99.
  3101             20  DC-MDY-DAY            PIC 99.
  3102             20  DC-MDY-YEAR           PIC 99.
  3103         16  DC-GREG-DATE-1-ALPHA.
  3104             20  DC-ALPHA-MONTH        PIC X(10).
  3105             20  DC-ALPHA-DAY          PIC 99.
  3106             20  FILLER                PIC XX.
  3107             20  DC-ALPHA-CENTURY.
  3108                 24 DC-ALPHA-CEN-N     PIC 99.
  3109             20  DC-ALPHA-YEAR         PIC 99.
  3110         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3111         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3112         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3113         16  DC-JULIAN-DATE            PIC 9(05).
  3114         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3115                                       PIC 9(05).
  3116         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3117             20  DC-JULIAN-YEAR        PIC 99.
  3118             20  DC-JULIAN-DAYS        PIC 999.
  3119         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3120         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3121         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3122     12  DATE-CONVERSION-VARIBLES.
  3123         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3124         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3125             20  FILLER                PIC 9(3).
  3126             20  HOLD-CEN-1-CCYY.
  3127                 24  HOLD-CEN-1-CC     PIC 99.
  3128                 24  HOLD-CEN-1-YY     PIC 99.
  3129             20  HOLD-CEN-1-MO         PIC 99.
  3130             20  HOLD-CEN-1-DA         PIC 99.
  3131         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3132             20  HOLD-CEN-1-R-MO       PIC 99.
  3133             20  HOLD-CEN-1-R-DA       PIC 99.
  3134             20  HOLD-CEN-1-R-CCYY.
  3135                 24  HOLD-CEN-1-R-CC   PIC 99.
  3136                 24  HOLD-CEN-1-R-YY   PIC 99.
  3137             20  FILLER                PIC 9(3).
  3138         16  HOLD-CENTURY-1-X.
  3139             20  FILLER                PIC X(3)  VALUE SPACES.
  3140             20  HOLD-CEN-1-X-CCYY.
  3141                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3142                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  60
* EL050.cbl
  3143             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3144             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3145         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3146             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3147             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3148             20  HOLD-CEN-1-R-X-CCYY.
  3149                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3150                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3151             20  FILLER                PIC XXX.
  3152         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3153         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3154         16  DC-JULIAN-DATE-1          PIC 9(07).
  3155         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3156             20  DC-JULIAN-1-CCYY.
  3157                 24  DC-JULIAN-1-CC    PIC 99.
  3158                 24  DC-JULIAN-1-YR    PIC 99.
  3159             20  DC-JULIAN-DA-1        PIC 999.
  3160         16  DC-JULIAN-DATE-2          PIC 9(07).
  3161         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3162             20  DC-JULIAN-2-CCYY.
  3163                 24  DC-JULIAN-2-CC    PIC 99.
  3164                 24  DC-JULIAN-2-YR    PIC 99.
  3165             20  DC-JULIAN-DA-2        PIC 999.
  3166         16  DC-GREG-DATE-A-EDIT.
  3167             20  DC-EDITA-MONTH        PIC 99.
  3168             20  SLASHA-1              PIC X VALUE '/'.
  3169             20  DC-EDITA-DAY          PIC 99.
  3170             20  SLASHA-2              PIC X VALUE '/'.
  3171             20  DC-EDITA-CCYY.
  3172                 24  DC-EDITA-CENT     PIC 99.
  3173                 24  DC-EDITA-YEAR     PIC 99.
  3174         16  DC-GREG-DATE-B-EDIT.
  3175             20  DC-EDITB-MONTH        PIC 99.
  3176             20  SLASHB-1              PIC X VALUE '/'.
  3177             20  DC-EDITB-DAY          PIC 99.
  3178             20  SLASHB-2              PIC X VALUE '/'.
  3179             20  DC-EDITB-CCYY.
  3180                 24  DC-EDITB-CENT     PIC 99.
  3181                 24  DC-EDITB-YEAR     PIC 99.
  3182         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3183         16  DC-GREG-DATE-CYMD-R REDEFINES
  3184                              DC-GREG-DATE-CYMD.
  3185             20  DC-CYMD-CEN           PIC 99.
  3186             20  DC-CYMD-YEAR          PIC 99.
  3187             20  DC-CYMD-MONTH         PIC 99.
  3188             20  DC-CYMD-DAY           PIC 99.
  3189         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3190         16  DC-GREG-DATE-MDCY-R REDEFINES
  3191                              DC-GREG-DATE-MDCY.
  3192             20  DC-MDCY-MONTH         PIC 99.
  3193             20  DC-MDCY-DAY           PIC 99.
  3194             20  DC-MDCY-CEN           PIC 99.
  3195             20  DC-MDCY-YEAR          PIC 99.
  3196    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3197        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3198    12  DC-EL310-DATE                  PIC X(21).
  3199    12  FILLER                         PIC X(28).
  3200
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  61
* EL050.cbl
  3202*    COPY ELCCALC.
  3203******************************************************************
  3204*                                                                *
  3205*                           ELCCALC.                            *
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3207*                            VMOD=2.025                          *
  3208*                                                                *
  3209*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3210*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3211*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3212*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3213*                                                                *
  3214*  PASSED TO ELRTRM                                              *
  3215*  -----------------                                             *
  3216*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3217*  ORIGINAL TERM                                                 *
  3218*  BEGINNING DATE                                                *
  3219*  ENDING DATE                                                   *
  3220*  COMPANY I.D.                                                  *
  3221*  ACCOUNT MASTER USER FIELD                                     *
  3222*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3223*  FREE LOOK DAYS                                                *
  3224*                                                                *
  3225*  RETURNED FROM ELRTRM                                          *
  3226*  ---------------------                                         *
  3227*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3228*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3229*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3230*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3231*----------------------------------------------------------------*
  3232*  PASSED TO ELRAMT                                              *
  3233*  ----------------                                              *
  3234*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3235*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3236*  ORIGINAL AMOUNT                                               *
  3237*  ALTERNATE BENEFIT (BALLON)                                    *
  3238*  A.P.R. - NET PAY ONLY                                         *
  3239*  METHOD
  3240*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3241*  COMPANY I.D.                                                  *
  3242*  BENEFIT TYPE                                                  *
  3243*                                                                *
  3244*  RETURNED FROM ELRAMT                                          *
  3245*  --------------------                                          *
  3246*  REMAINING AMOUNT 1 - CURRENT                                  *
  3247*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3248*  REMAINING AMOUNT FACTOR
  3249*----------------------------------------------------------------*
  3250*  PASSED TO ELRESV                                              *
  3251*  -----------------                                             *
  3252*  CERTIFICATE EFFECTIVE DATE                                    *
  3253*  VALUATION DATE                                                *
  3254*  PAID THRU DATE                                                *
  3255*  BENEFIT                                                       *
  3256*  INCURRED DATE                                                 *
  3257*  REPORTED DATE                                                 *
  3258*  ISSUE AGE                                                     *
  3259*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  62
* EL050.cbl
  3260*  CDT PERCENT                                                   *
  3261*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3262* *CLAIM TYPE (LIFE, A/H)                                        *
  3263* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3264* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3265*                                                                *
  3266*  RETURNED FROM ELRESV                                          *
  3267*  --------------------                                          *
  3268*  CDT TABLE USED                                                *
  3269*  CDT FACTOR USED                                               *
  3270*  PAY TO CURRENT RESERVE                                        *
  3271*  I.B.N.R. - A/H ONLY                                           *
  3272*  FUTURE (ACCRUED) AH ONLY                                      *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELRATE                                              *
  3275*  ----------------                                              *
  3276*  CERT ISSUE DATE                                               *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3279*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3280*  STATE CODE (CLIENT DEFINED)                                   *
  3281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3283*  DEVIATION CODE                                                *
  3284*  ISSUE AGE                                                     *
  3285*  ORIGINAL BENEFIT AMOUNT                                       *
  3286*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3287*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3288*  BENEFIT KIND (LIFE OR A/H)                                    *
  3289*  A.P.R.                                                        *
  3290*  METHOD
  3291*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3292*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3293*  COMPANY I.D. (3 CHARACTER)                                    *
  3294*  BENEFIT CODE                                                  *
  3295*  BENEFIT OVERRIDE CODE                                         *
  3296*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3297*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3298*  JOINT INDICATOR (CSL ONLY)                                    *
  3299*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3300*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3301*                                                                *
  3302*  RETURNED FROM ELRATE                                          *
  3303*  --------------------                                          *
  3304*  CALCULATED PREMIUM                                            *
  3305*  PREMIUM RATE                                                  *
  3306*  MORTALITY CODE                                                *
  3307*  MAX ATTAINED AGE                                              *
  3308*  MAX AGE                                                       *
  3309*  MAX TERM                                                      *
  3310*  MAX MONTHLY BENEFIT                                           *
  3311*  MAX TOTAL BENIFIT                                             *
  3312*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3313*----------------------------------------------------------------*
  3314*  PASSED TO ELRFND                                              *
  3315*  ----------------                                              *
  3316*  CERT ISSUE DATE                                               *
  3317*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  63
* EL050.cbl
  3318*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3320*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3321*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3322*  STATE CODE (CLIENT DEFINED)                                   *
  3323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3325*  DEVIATION CODE                                                *
  3326*  ISSUE AGE                                                     *
  3327*  ORIGINAL BENEFIT AMOUNT                                       *
  3328*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3329*  PROCESS TYPE (CANCEL)                                         *
  3330*  BENEFIT KIND (LIFE OR A/H)                                    *
  3331*  A.P.R.                                                        *
  3332*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3333*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3334*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3335*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3336*  COMPANY I.D. (3 CHARACTER)                                    *
  3337*  BENEFIT CODE                                                  *
  3338*  BENEFIT OVERRIDE CODE                                         *
  3339*                                                                *
  3340*  RETURNED FROM ELRFND                                          *
  3341*  --------------------                                          *
  3342*  CALCULATED REFUND                                             *
  3343*----------------------------------------------------------------*
  3344*  PASSED TO ELEARN                                              *
  3345*  ----------------                                              *
  3346*  CERT ISSUE DATE                                               *
  3347*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3348*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3349*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3350*  STATE CODE (CLIENT DEFINED)                                   *
  3351*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3352*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3353*  DEVIATION CODE                                                *
  3354*  ISSUE AGE                                                     *
  3355*  ORIGINAL BENEFIT AMOUNT                                       *
  3356*  BENEFIT KIND (LIFE OR A/H)                                    *
  3357*  A.P.R.                                                        *
  3358*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3359*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3360*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3361*  COMPANY I.D. (3 CHARACTER)                                    *
  3362*  BENEFIT CODE                                                  *
  3363*  BENEFIT OVERRIDE CODE                                         *
  3364*                                                                *
  3365*  RETURNED FROM ELEARN                                          *
  3366*  --------------------                                          *
  3367*  INDICATED  EARNINGS                                           *
  3368*----------------------------------------------------------------*
  3369*                 LENGTH = 450                                   *
  3370*                                                                *
  3371******************************************************************
  3372******************************************************************
  3373*                   C H A N G E   L O G
  3374*
  3375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  64
* EL050.cbl
  3376*-----------------------------------------------------------------
  3377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3378* EFFECTIVE    NUMBER
  3379*-----------------------------------------------------------------
  3380* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3381* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3382* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3383* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3384* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3385* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3386* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3387* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3388* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3389******************************************************************
  3390
  3391 01  CALCULATION-PASS-AREA.
  3392     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3393                                     COMP.
  3394
  3395     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3396       88  NO-CP-ERROR                             VALUE ZERO.
  3397       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3398                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3399       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3400       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3401       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3402       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3403       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3404       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3405       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3406       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3407       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3408       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3409       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3410       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3411       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3412       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3413       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3414       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3415       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3416
  3417     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR-2                           VALUE ZERO.
  3419***********************  INPUT AREAS ****************************
  3420
  3421     12  CP-CALCULATION-AREA.
  3422         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3423         16  CP-CERT-EFF-DT        PIC XX.
  3424         16  CP-VALUATION-DT       PIC XX.
  3425         16  CP-PAID-THRU-DT       PIC XX.
  3426         16  CP-BENEFIT-TYPE       PIC X.
  3427           88  CP-AH                               VALUE 'A' 'D'
  3428                                                   'I' 'U'.
  3429           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3430           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3431         16  CP-INCURRED-DT        PIC XX.
  3432         16  CP-REPORTED-DT        PIC XX.
  3433         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  65
* EL050.cbl
  3434         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3435         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-CDT-METHOD         PIC X.
  3440           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3441           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3442           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3443         16  CP-CLAIM-TYPE         PIC X.
  3444           88  CP-AH-CLAIM                         VALUE 'A'.
  3445           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3446         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3447                                     COMP-3.
  3448         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3449                                     COMP-3.
  3450         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3451                                     COMP-3.
  3452         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3453                                     COMP-3.
  3454         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3455                                     COMP-3.
  3456         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3457                                     COMP-3.
  3458         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-REM-TERM-METHOD    PIC X.
  3461           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3462           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3463           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3464           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3465           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3466           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3467           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3468         16  CP-EARNING-METHOD     PIC X.
  3469           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3470           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3471           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3472           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3473           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3474           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3475           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3476           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3477           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3478           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3479           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3480           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3481           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3482           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3483         16  CP-PROCESS-TYPE       PIC X.
  3484           88  CP-CLAIM                            VALUE '1'.
  3485           88  CP-CANCEL                           VALUE '2'.
  3486           88  CP-ISSUE                            VALUE '3'.
  3487         16  CP-SPECIAL-CALC-CD    PIC X.
  3488           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3489           88  CP-1-MTH-INTEREST               VALUE ' '.
  3490           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3491           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  66
* EL050.cbl
  3492           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3493           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3494           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3495           88  CP-FARM-PLAN                    VALUE 'F'.
  3496           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3497           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3498           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3499           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3500           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3501           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3502           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3503           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3504           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3505           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3506                                                     'W' 'X'.
  3507           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3508           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3509           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3510           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3511           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3512           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3513           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3514           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3515           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3516           88  CP-CSL-METH-1                   VALUE '5'.
  3517           88  CP-CSL-METH-2                   VALUE '6'.
  3518           88  CP-CSL-METH-3                   VALUE '7'.
  3519           88  CP-CSL-METH-4                   VALUE '8'.
  3520
  3521         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3524         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3525         16  CP-STATE              PIC XX          VALUE SPACE.
  3526         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3527         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3528           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3529               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3530         16  CP-R78-OPTION         PIC X.
  3531           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3532           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3533
  3534         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3535         16  CP-IBNR-RESERVE-SW    PIC X.
  3536         16  CP-CLAIM-STATUS       PIC X.
  3537         16  CP-RATE-FILE          PIC X.
  3538         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3539                                     COMP-3.
  3540
  3541         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3542         16  CP-AH-OVERRIDE-CODE   PIC X.
  3543
  3544         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3547                                   PIC S9(5)V99 COMP-3.
  3548         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  67
* EL050.cbl
  3550         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3553                                     COMP-3.
  3554         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3555                                  PIC S9(7)V99 COMP-3.
  3556
  3557         16  CP-PAID-FROM-DATE     PIC X(02).
  3558         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3559         16  CP-EXT-DAYS-CALC      PIC X.
  3560           88  CP-EXT-NO-CHG                   VALUE ' '.
  3561           88  CP-EXT-CHG-LF                   VALUE '1'.
  3562           88  CP-EXT-CHG-AH                   VALUE '2'.
  3563           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3564         16  CP-DOMICILE-STATE     PIC XX.
  3565         16  CP-CARRIER            PIC X.
  3566         16  CP-REIN-FLAG          PIC X.
  3567         16  CP-REM-TRM-CALC-OPTION PIC X.
  3568           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3569                      '2' '3' '4' '5'.
  3570           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3571           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3572           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3573           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3574           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3575           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3576           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3577           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3578         16  CP-SIG-SWITCH         PIC X.
  3579         16  CP-RATING-METHOD      PIC X.
  3580           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3581           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3582           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3583           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3584           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3585           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3586           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3587           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3588           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3589         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3590                                     COMP-3.
  3591         16  CP-BEN-CATEGORY       PIC X.
  3592         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3593         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3594                                   PIC S99V9(5) COMP-3.
  3595         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3596         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3597                                   PIC S99V9(5) COMP-3.
  3598         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3599         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3600         16  CP-EXPIRE-DT          PIC XX.
  3601         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3602         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3603         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3604         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3605         16  CP-DDF-SPEC-CALC      PIC X.
  3606             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3607             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  68
* EL050.cbl
  3608         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3609         16  CP-CANCEL-REASON      PIC X.
  3610         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3611         16  CP-PMT-MODE           PIC X.
  3612         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3613         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3614         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3615         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3616         16  FILLER                PIC X.
  3617
  3618***************    OUTPUT FROM ELRESV   ************************
  3619
  3620         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3621
  3622         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3627                                     COMP-3.
  3628         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3629                                     COMP-3.
  3630         16  FILLER                PIC X(09).
  3631***************    OUTPUT FROM ELRTRM   *************************
  3632
  3633         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3638                                     COMP-3.
  3639         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3640                                     COMP-3.
  3641         16  FILLER                PIC X(12).
  3642
  3643***************    OUTPUT FROM ELRAMT   *************************
  3644
  3645         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649         16  FILLER                PIC X(12).
  3650
  3651***************    OUTPUT FROM ELRATE   *************************
  3652
  3653         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-MORTALITY-CODE     PIC X(4).
  3658         16  CP-RATE-EDIT-FLAG     PIC X.
  3659             88  CP-RATES-NEED-APR                  VALUE '1'.
  3660         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3663         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3664         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3665                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  69
* EL050.cbl
  3666         16  FILLER                PIC X(07).
  3667
  3668***************    OUTPUT FROM ELRFND   *************************
  3669
  3670         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-REFUND-TYPE-USED   PIC X.
  3673           88  CP-R-AS-R78                         VALUE '1'.
  3674           88  CP-R-AS-PRORATA                     VALUE '2'.
  3675           88  CP-R-AS-CALIF                       VALUE '3'.
  3676           88  CP-R-AS-TEXAS                       VALUE '4'.
  3677           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3678           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3679           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3680           88  CP-R-AS-MEAN                        VALUE '8'.
  3681           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3682           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3683           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3684           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3685           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3686           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3687         16  FILLER                PIC X(12).
  3688
  3689***************    OUTPUT FROM ELEARN   *************************
  3690
  3691         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-EARNING-TYPE-USED  PIC X.
  3704           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3705           88  CP-E-AS-R78                         VALUE '1'.
  3706           88  CP-E-AS-PRORATA                     VALUE '2'.
  3707           88  CP-E-AS-TEXAS                       VALUE '4'.
  3708           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3709           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3710           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3711           88  CP-E-AS-MEAN                        VALUE '8'.
  3712           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3713         16  FILLER                PIC X(12).
  3714
  3715***************    OUTPUT FROM ELPMNT   *************************
  3716
  3717         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  FILLER                PIC X(12).
  3722
  3723***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  70
* EL050.cbl
  3724         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3737             88  OPEN-RATE-FILE                   VALUE 'O'.
  3738             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3739             88  IO-ERROR                         VALUE 'E'.
  3740
  3741         16  CP-FIRST-PAY-DATE     PIC XX.
  3742
  3743         16  CP-JOINT-INDICATOR    PIC X.
  3744
  3745         16  CP-RESERVE-REMAINING-TERM
  3746                                   PIC S9(4)V9    VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-INSURED-BIRTH-DT   PIC XX.
  3750
  3751         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3755                                     COMP-3.
  3756
  3757         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759
  3760         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3761                                     COMP-3.
  3762
  3763         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3764                                     COMP-3.
  3765
  3766         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3767                                     COMP-3.
  3768
  3769         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3770                                     COMP-3.
  3771
  3772         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3773             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3774
  3775         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3780         16  FILLER                PIC X(15).
  3781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  71
* EL050.cbl
  3783******************************************************************
  3784*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3785*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3786*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3787*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3788*** MODIFICATION.                                              ***
  3789*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3790*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3791******************************************************************
  3792*    COPY ERCPNDB.
  3793******************************************************************
  3794*                                                                *
  3795*                                                                *
  3796*                            ERCPNDB.                            *
  3797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3798*                            VMOD=2.025                          *
  3799*                                                                *
  3800*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3801*                                                                *
  3802******************************************************************
  3803*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3804*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3805******************************************************************
  3806*                                                                *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3812*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3813*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3814*                                                 RKP=13,LEN=36  *
  3815*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3816*                                      AND CHG-SEQ.)             *
  3817*                                                RKP=49,LEN=11   *
  3818*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3819*                                      AND CHG-SEQ.)             *
  3820*                                                RKP=60,LEN=15   *
  3821*                                                                *
  3822*   LOG = NO                                                     *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825******************************************************************
  3826*                   C H A N G E   L O G
  3827*
  3828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3829*-----------------------------------------------------------------
  3830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3831* EFFECTIVE    NUMBER
  3832*-----------------------------------------------------------------
  3833* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3834* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3835* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3836* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3837* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3838* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3839* 032306                   PEMA  ADD BOW LOAN NUMBER
  3840* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  72
* EL050.cbl
  3841* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3842* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3843* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3844* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3845* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3847* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3848******************************************************************
  3849
  3850 01  PENDING-BUSINESS.
  3851     12  PB-RECORD-ID                     PIC XX.
  3852         88  VALID-PB-ID                        VALUE 'PB'.
  3853
  3854     12  PB-CONTROL-PRIMARY.
  3855         16  PB-COMPANY-CD                PIC X.
  3856         16  PB-ENTRY-BATCH               PIC X(6).
  3857         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3858         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3859
  3860     12  PB-CONTROL-BY-ACCOUNT.
  3861         16  PB-COMPANY-CD-A1             PIC X.
  3862         16  PB-CARRIER                   PIC X.
  3863         16  PB-GROUPING.
  3864             20  PB-GROUPING-PREFIX       PIC XXX.
  3865             20  PB-GROUPING-PRIME        PIC XXX.
  3866         16  PB-STATE                     PIC XX.
  3867         16  PB-ACCOUNT.
  3868             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3869             20  PB-ACCOUNT-PRIME         PIC X(6).
  3870         16  PB-CERT-EFF-DT               PIC XX.
  3871         16  PB-CERT-NO.
  3872             20  PB-CERT-PRIME            PIC X(10).
  3873             20  PB-CERT-SFX              PIC X.
  3874         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3875
  3876         16  PB-RECORD-TYPE               PIC X.
  3877             88  PB-MAILING-DATA                VALUE '0'.
  3878             88  PB-ISSUE                       VALUE '1'.
  3879             88  PB-CANCELLATION                VALUE '2'.
  3880             88  PB-BATCH-TRAILER               VALUE '9'.
  3881
  3882     12  PB-CONTROL-BY-ORIG-BATCH.
  3883         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3884         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3885         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3886         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3887
  3888     12  PB-CONTROL-BY-CSR.
  3889         16  PB-CSR-COMPANY-CD            PIC X.
  3890         16  PB-CSR-ID                    PIC X(4).
  3891         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3892         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3893         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3894******************************************************************
  3895*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3896******************************************************************
  3897
  3898     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  73
* EL050.cbl
  3899     12  PB-LAST-MAINT-BY                 PIC X(4).
  3900     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3901
  3902     12  PB-RECORD-BODY                   PIC X(375).
  3903
  3904     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3905         16  PB-CERT-ORIGIN               PIC X.
  3906             88  CLASIC-CREATED-CERT         VALUE '1'.
  3907         16  PB-I-NAME.
  3908             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3909             20  PB-I-INSURED-FIRST-NAME.
  3910                 24  PB-I-INSURED-1ST-INIT PIC X.
  3911                 24  FILLER                PIC X(9).
  3912             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3913         16  PB-I-AGE                     PIC S99   COMP-3.
  3914         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3915         16  PB-I-BIRTHDAY                PIC XX.
  3916         16  PB-I-INSURED-SEX             PIC X.
  3917             88  PB-SEX-MALE     VALUE 'M'.
  3918             88  PB-SEX-FEMALE   VALUE 'F'.
  3919
  3920         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3921         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3922         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3923         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3924         16  PB-I-SKIP-CODE               PIC X.
  3925             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3926             88  PB-SKIP-JULY              VALUE '1'.
  3927             88  PB-SKIP-AUGUST            VALUE '2'.
  3928             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3929             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3930             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3931             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3932             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3933             88  PB-SKIP-JUNE              VALUE '8'.
  3934             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3935             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3936             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3937         16  PB-I-TERM-TYPE               PIC X.
  3938             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3939             88  PB-PAID-WEEKLY            VALUE 'W'.
  3940             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3941             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3942             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3943         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3944         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3945         16  PB-I-DATA-ENTRY-SW           PIC X.
  3946             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3947             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3948             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3949             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3950         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3951         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3952*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3953         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3954         16  FILLER                       PIC X.
  3955
  3956         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  74
* EL050.cbl
  3957             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3958             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3959                                                   '90' THRU '99'.
  3960         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3961                                          PIC XX.
  3962         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3963         16  PB-I-AMOUNT-FINANCED REDEFINES
  3964                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3965         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3966         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3967                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3968         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3969         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3970         16  PB-I-CLP-AMOUNT REDEFINES
  3971                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3972         16  PB-I-LF-CALC-FLAG            PIC X.
  3973             88 PB-COMP-LF-PREM               VALUE '?'.
  3974         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3975         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3976         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3977         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3978         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3979         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3980         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3981         16  PB-I-LF-ABBR                 PIC XXX.
  3982         16  PB-I-LF-INPUT-CD             PIC XX.
  3983
  3984         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3985             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3986             88  PB-INVALID-AH               VALUE '  ' '00'
  3987                                                   '90' THRU '99'.
  3988         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3990         16  PB-I-AH-CALC-FLAG            PIC X.
  3991             88 PB-COMP-AH-PREM                  VALUE '?'.
  3992         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3993         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3994         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3995         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3997         16  PB-I-AH-ABBR                 PIC XXX.
  3998         16  PB-I-AH-INPUT-CD             PIC XXX.
  3999
  4000         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4001         16  PB-I-REIN-TABLE              PIC XXX.
  4002         16  PB-I-BUSINESS-TYPE           PIC 99.
  4003         16  PB-I-INDV-GRP-CD             PIC X.
  4004         16  PB-I-MORT-CODE.
  4005             20  PB-I-TABLE               PIC X.
  4006             20  PB-I-INTEREST            PIC XX.
  4007             20  PB-I-MORT-TYP            PIC X.
  4008         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4009         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4010         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4011         16  PB-I-INDV-GRP-OVRD           PIC X.
  4012         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4013         16  PB-I-SIG-SW                  PIC X.
  4014             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  75
* EL050.cbl
  4015         16  PB-I-RATE-CLASS              PIC XX.
  4016         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4017         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4018         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4019         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4020         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4021         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4022         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4023         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4024         16  PB-I-OB-FLAG                 PIC X.
  4025             88  PB-I-OB                      VALUE 'B'.
  4026             88  PB-I-SUMMARY                 VALUE 'Z'.
  4027         16  PB-I-ENTRY-STATUS            PIC X.
  4028             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4029                                              'M' '5' '9' '2'.
  4030             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4031             88  PB-I-POLICY-PENDING          VALUE '2'.
  4032             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4033             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4034             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4035             88  PB-I-REIN-ONLY               VALUE '9'.
  4036             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4037             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4038             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4039             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4040         16  PB-I-INT-CODE                PIC X.
  4041             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4042             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4043         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4044         16  PB-I-SOC-SEC-NO              PIC X(11).
  4045         16  PB-I-MEMBER-NO               PIC X(12).
  4046         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4047*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4048         16  PB-I-OLD-LOF                 PIC XXX.
  4049         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4050         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4051         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4052         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4053         16  PB-I-LIFE-INDICATOR          PIC X.
  4054             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4055         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4056         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4057                                          PIC S9(5)V99    COMP-3.
  4058         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4059             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4060             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4061         16  PB-I-1ST-PMT-DT              PIC XX.
  4062         16  PB-I-JOINT-INSURED.
  4063             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4064             20 PB-I-JOINT-FIRST-NAME.
  4065                24  PB-I-JOINT-FIRST-INIT PIC X.
  4066                24  FILLER                PIC X(9).
  4067             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4068*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4069         16  PB-I-BENEFICIARY-NAME.
  4070             20  PB-I-BANK-NUMBER         PIC X(10).
  4071             20  FILLER                   PIC X(15).
  4072         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  76
* EL050.cbl
  4073         16  PB-I-REFERENCE               PIC X(12).
  4074         16  FILLER REDEFINES PB-I-REFERENCE.
  4075             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4076             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4077             20  PB-I-CLP-STATE           PIC XX.
  4078         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4079             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4080             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4081             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4082         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4083         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4084         16  PB-I-RESIDENT-STATE          PIC XX.
  4085         16  PB-I-RATE-CODE               PIC X(4).
  4086         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4087         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4088         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4089         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4090         16  PB-I-BANK-NOCHRGB            PIC 99.
  4091         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4092         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4093
  4094     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4095         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4096             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4097         16  PB-C-CANCEL-ORIGIN           PIC X.
  4098             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4099         16  PB-C-LF-CANCEL-DT            PIC XX.
  4100         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4101         16  PB-C-LF-CALC-REQ             PIC X.
  4102             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4103         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4104         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4105         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4106             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4107         16  PB-C-AH-CANCEL-DT            PIC XX.
  4108         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4109         16  PB-C-AH-CALC-REQ             PIC X.
  4110             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4111         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4112         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4113         16  PB-C-LAST-NAME               PIC X(15).
  4114         16  PB-C-REFUND-SW               PIC X.
  4115             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4116             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4117         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4118         16  PB-C-PAYEE-CODE              PIC X(6).
  4119         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4120         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4121         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4122         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4123         16  PB-C-REFERENCE               PIC X(12).
  4124         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4125         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4126         16  PB-C-POST-CARD-IND           PIC X.
  4127         16  PB-C-CANCEL-REASON           PIC X.
  4128         16  PB-C-REF-INTERFACE-SW        PIC X.
  4129         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4130         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  77
* EL050.cbl
  4131         16  FILLER                       PIC X(01).
  4132*        16  FILLER                       PIC X(18).
  4133         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4134*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4135         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4136         16  PB-CANCELED-CERT-DATA.
  4137             20  PB-CI-INSURED-NAME.
  4138                 24  PB-CI-LAST-NAME      PIC X(15).
  4139                 24  PB-CI-INITIALS       PIC XX.
  4140             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4141             20  PB-CI-INSURED-SEX        PIC X.
  4142             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4143             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4144             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4145             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4146             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4147             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4148             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4149             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4150             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4151             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4152             20  PB-CI-RATE-CLASS         PIC XX.
  4153             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4154             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4155             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4156             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4157             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4158             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4159             20  PB-CI-LF-ABBR            PIC X(3).
  4160             20  PB-CI-AH-ABBR            PIC X(3).
  4161             20  PB-CI-OB-FLAG            PIC X.
  4162                 88  PB-CI-OB                VALUE 'B'.
  4163             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4164                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4165                                           'M' '4' '5' '9' '2'.
  4166                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4167                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4168                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4169                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4170                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4171                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4172                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4173                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4174                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4175                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4176                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4177                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4178             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4179                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4180                                           'M' '4' '5' '9' '2'.
  4181                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4182                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4183                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4184                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4185                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4186                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4187                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4188                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  78
* EL050.cbl
  4189                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4190                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4191                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4192                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4193             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4194             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4195             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4196             20  PB-CI-MEMBER-NO          PIC X(12).
  4197             20  PB-CI-INT-CODE           PIC X.
  4198                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4199                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4200             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4201             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4202             20  PB-CI-COMP-EXCP-SW       PIC X.
  4203                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4204                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4205             20  PB-CI-ENTRY-STATUS       PIC X.
  4206             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4207             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4208             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4209             20  PB-CI-DEATH-DT           PIC XX.
  4210             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4211             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4212             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4213             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4214             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4215             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4216             20  PB-CI-ENTRY-DT              PIC XX.
  4217             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4218             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4219             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4220             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4221             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4222             20  PB-CI-OLD-LOF               PIC XXX.
  4223*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4224             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4225             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4226             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4227             20  PB-CI-INDV-GRP-CD           PIC X.
  4228             20  PB-CI-BENEFICIARY-NAME.
  4229                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4230                 24  FILLER                  PIC X(15).
  4231             20  PB-CI-NOTE-SW               PIC X.
  4232             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4233             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4234             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4235             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4236             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4237             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4238             20  PB-CI-FIRST-NAME            PIC X(10).
  4239             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4240
  4241         16  FILLER                       PIC X(13).
  4242*032306  16  FILLER                       PIC X(27).
  4243*        16  FILLER                       PIC X(46).
  4244
  4245     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4246         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  79
* EL050.cbl
  4247         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4248         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4249         16  PB-M-INSURED-MID-INIT        PIC X.
  4250         16  PB-M-INSURED-AGE             PIC 99.
  4251         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4252         16  PB-M-INSURED-SEX             PIC X.
  4253         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4254         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4255         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4256         16  PB-M-INSURED-CITY-STATE.
  4257             20  PB-M-INSURED-CITY        PIC X(28).
  4258             20  PB-M-INSURED-STATE       PIC XX.
  4259         16  PB-M-INSURED-ZIP-CODE.
  4260             20  PB-M-INSURED-ZIP-PRIME.
  4261                 24  PB-M-INSURED-ZIP-1   PIC X.
  4262                     88  PB-M-CANADIAN-POST-CODE
  4263                                             VALUE 'A' THRU 'Z'.
  4264                 24  FILLER               PIC X(4).
  4265             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4266         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4267                                        PB-M-INSURED-ZIP-CODE.
  4268             20  PM-M-INS-CAN-POST1       PIC XXX.
  4269             20  PM-M-INS-CAN-POST2       PIC XXX.
  4270             20  FILLER                   PIC XXX.
  4271         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4272         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4273         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4274         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4275         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4276         16  PB-M-CRED-BENE-CITYST.
  4277             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4278             20  PB-M-CRED-BENE-STATE     PIC XX.
  4279         16  FILLER                       PIC X(92).
  4280
  4281     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4282         16  FILLER                       PIC X(10).
  4283         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4284         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4285         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4286         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4287         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4288         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4289         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4290         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4291         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4292         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4293         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4294         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4295         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4296         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4297         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4298         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4299         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4300         16  PB-ACCOUNT-NAME              PIC X(30).
  4301         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4302         16  PB-REFERENCE                 PIC X(12).
  4303         16  PB-B-RECEIVED-DT             PIC XX.
  4304         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  80
* EL050.cbl
  4305
  4306     12  PB-RECORD-STATUS.
  4307         16  PB-CREDIT-SELECT-DT          PIC XX.
  4308         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4309         16  PB-BILLED-DT                 PIC XX.
  4310         16  PB-BILLING-STATUS            PIC X.
  4311             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4312             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4313             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4314         16  PB-RECORD-BILL               PIC X.
  4315             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4316             88  PB-RECORD-RETURNED           VALUE 'R'.
  4317             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4318             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4319             88  PB-OVERRIDE-AH               VALUE 'A'.
  4320             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4321         16  PB-BATCH-ENTRY               PIC X.
  4322             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4323             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4324             88  PB-REISSUED-CERT             VALUE 'E'.
  4325             88  PB-MONTHLY-CERT              VALUE 'M'.
  4326             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4327             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4328             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4329         16  PB-FORCE-CODE                PIC X.
  4330             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4331             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4332             88  PB-CANCEL-FORCE              VALUE '8'.
  4333             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4334             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4335             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4336             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4337             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4338             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4339             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4340         16  PB-FATAL-FLAG                PIC X.
  4341             88  PB-FATAL-ERRORS              VALUE 'X'.
  4342         16  PB-FORCE-ER-CD               PIC X.
  4343             88  PB-FORCE-ERRORS              VALUE 'F'.
  4344             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4345         16  PB-WARN-ER-CD                PIC X.
  4346             88  PB-WARNING-ERRORS            VALUE 'W'.
  4347         16  FILLER                       PIC X.
  4348         16  PB-OUT-BAL-CD                PIC X.
  4349             88  PB-OUT-OF-BAL                VALUE 'O'.
  4350         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4351         16  PB-AH-OVERRIDE-L1            PIC X.
  4352         16  PB-INPUT-DT                  PIC XX.
  4353         16  PB-INPUT-BY                  PIC X(4).
  4354         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4355         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4356         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4357         16  PB-LF-EARNING-METHOD         PIC X.
  4358         16  PB-AH-EARNING-METHOD         PIC X.
  4359         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4360         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4361         16  PB-REIN-CD                   PIC XXX.
  4362         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  81
* EL050.cbl
  4363         16  PB-AH-REFUND-TYPE            PIC X.
  4364         16  PB-ACCT-EFF-DT               PIC XX.
  4365         16  PB-ACCT-EXP-DT               PIC XX.
  4366         16  PB-COMPANY-ID                PIC X(3).
  4367         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4368         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4369         16  PB-SV-CARRIER                PIC X.
  4370         16  PB-SV-GROUPING               PIC X(6).
  4371         16  PB-SV-STATE                  PIC XX.
  4372         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4373         16  PB-GA-BILLING-INFO.
  4374             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4375                                          PIC XX.
  4376         16  PB-SV-REMIT-TO  REDEFINES
  4377             PB-GA-BILLING-INFO           PIC X(10).
  4378         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4379         16  PB-I-LOAN-OFFICER            PIC X(5).
  4380         16  PB-I-VIN                     PIC X(17).
  4381
  4382         16  FILLER                       PIC X(04).
  4383         16  IMNET-BYPASS-SW              PIC X.
  4384
  4385******************************************************************
  4386*                COMMON EDIT ERRORS                              *
  4387******************************************************************
  4388
  4389     12  PB-COMMON-ERRORS.
  4390         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4391                                           PIC S9(4)     COMP.
  4392
  4393******************************************************************
  4394
  4395* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4396*    COPY ELC50W1.
  4397******************************************************************
  4398*                                                                *
  4399*                                                                *
  4400*                             ELC50W1                            *
  4401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4402*                            VMOD=2.004                          *
  4403*                                                                *
  4404*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4405*                                                                *
  4406*                                                                *
  4407******************************************************************
  4408
  4409     12  WK-WORK-AREA.
  4410         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4411         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4412         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4413         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4414         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4415         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4416         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4417         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4418         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4419         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4420         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  82
* EL050.cbl
  4421         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4422         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4423         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4424         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4425         16  WK-CREDIT-EDIT-CONTROLS.
  4426             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4427             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4428             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4429             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4430             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4431             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4432         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4433         16  WK-SAVE-REIN-DATA.
  4434             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4435             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4436             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4437         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4438             88  ENTRY-FROM-EL6311       VALUE '6'.
  4439         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4440         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4441     12  WK-RECORD-ADDRESSES.
  4442         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4443         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4444         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4445         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4446         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4447         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4448         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4449         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4450     12  WK-OVER-SHORT-AREA.
  4451         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4452         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4453         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4454             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4455         16  FILLER                   PIC X(5) VALUE SPACES.
  4456
  4457*    COPY ELCEDITC.
  4458******************************************************************
  4459*                                                                *
  4460*                                                                *
  4461*                            ELCEDITC                            *
  4462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4463*                            VMOD=2.012                          *
  4464*                                                                *
  4465*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4466*                     EL6313, EL050 AND EL517.                   *
  4467*                                                                *
  4468******************************************************************
  4469******************************************************************
  4470*                   C H A N G E   L O G
  4471*
  4472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4473*-----------------------------------------------------------------
  4474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4475* EFFECTIVE    NUMBER
  4476*-----------------------------------------------------------------
  4477* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4478******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  83
* EL050.cbl
  4479
  4480     12  EDIT-CRITERIA-DATA.
  4481         16  EC-CO-MONTH-END-DT       PIC XX.
  4482         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4483         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4484         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4485         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4486         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4487         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4488         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4489         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4490         16  EC-CO-REM-TERM-CALC      PIC X.
  4491               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4492               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4493               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4494               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4495
  4496         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4497               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4498               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4499               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4500               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4501               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4502               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4503               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4504               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4505               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4506               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4507
  4508         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4509               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4510               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4511               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4512               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4513               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4514               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4515               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4516               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4517
  4518         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4519                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4520                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4521
  4522         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4523                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4524                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4525                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4526                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4527                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4528                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4529                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4530                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4531
  4532         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4533               88  EC-BR-REDUCING                   VALUE 'R'.
  4534               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4535
  4536         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  84
* EL050.cbl
  4537         16  EC-BR-LF-DESC             PIC X(10).
  4538         16  EC-BR-AH-DESC             PIC X(10).
  4539         16  EC-BR-LF-COMMENT          PIC X(10).
  4540         16  EC-BR-AH-COMMENT          PIC X(10).
  4541
  4542         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4543               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4544               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4545               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4546               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4547
  4548         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4549               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4550               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4551               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4552               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4553
  4554         16  EC-BR-LF-REFUND-CALC      PIC X.
  4555                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4556                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4557                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4558                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4559                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4560                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4561                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4562
  4563         16  EC-BR-AH-REFUND-CALC      PIC X.
  4564                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4565                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4566                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4567                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4568                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4569                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4570                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4571                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4572
  4573         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4574                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4575                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4576                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4577
  4578         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4579                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4580                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4581                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4582
  4583         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4584         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4585         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4586         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4587
  4588         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4589         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4590                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4591                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4592                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4593                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4594
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  85
* EL050.cbl
  4595         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4596               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4597               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4598               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4599               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4600               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4601
  4602         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4603               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4604               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4605               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4606               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4607               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4608
  4609         16  EC-ST-LF-REFUND-CALC      PIC X.
  4610                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4611                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4612                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4613                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4614                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4615                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4616                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4617                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4618
  4619         16  EC-ST-AH-REFUND-CALC      PIC X.
  4620                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4621                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4622                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4623                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4624                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4625                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4626                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4627                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4628
  4629         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4630         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4631         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4632         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4633         16  EC-AM-EXPIRATION-DT       PIC XX.
  4634         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4635         16  EC-AM-CLASS-CD            PIC XX.
  4636         16  EC-AM-LF-DEVIATION        PIC XXX.
  4637         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4638         16  EC-AM-AH-DEVIATION        PIC XXX.
  4639         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4640         16  EC-AM-PHONE-NO            PIC X(10).
  4641
  4642         16  EC-AM-LF-REFUND-CALC      PIC X.
  4643                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4644                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4645                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4650
  4651         16  EC-AM-AH-REFUND-CALC      PIC X.
  4652                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  86
* EL050.cbl
  4653                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4654                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4655                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4656                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4657                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4658                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4659
  4660         16  EC-AM-BEN-I-G-CD          PIC X.
  4661                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4662                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4663                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4664
  4665         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4666         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4667         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4668         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4669         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4670         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4671         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4672         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4673         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4674
  4675         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4676         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4677         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4678         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4679         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4680         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4681         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4682         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4683         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4684         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4685         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4686         16  EC-RT-LF-NSP-ST           PIC XX.
  4687         16  EC-RT-AH-NSP-ST           PIC XX.
  4688         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4689         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4690
  4691         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4692             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4693                                             'M' '5' '9' '2'.
  4694             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4695             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4696             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4697             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4698             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4699             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4700             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4701             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4702             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4703             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4704
  4705         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4706             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4707                                             'M' '5' '9' '2'.
  4708             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4709             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4710             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  87
* EL050.cbl
  4711             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4712             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4713             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4714             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4715             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4716             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4717             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4718
  4719         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4720         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4721         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4722         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4723         16  EC-CM-DEATH-DT            PIC XX.
  4724
  4725*DMD CUSTOM CODING FIELDS BELOW
  4726*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4727         16  EC-BR-DMD-RATING-SW       PIC X.
  4728                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4729                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4730                 88  NO-DMD-RATING               VALUE 'N'.
  4731
  4732         16  EC-NEW-CERT               PIC X(11).
  4733         16  EC-NEW-STATE              PIC XX.
  4734         16  FILLER                    PIC X.
  4735*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4736         16  OVER-SHORT-EDIT-FIELDS.
  4737             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4738             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4739             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4740             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4741             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4742             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4743             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4744             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4745             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4746         16  FILLER                    PIC X(71).
  4747******************************************************************
  4748
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  88
* EL050.cbl
  4750*    COPY ELCDIFRD.
  4751******************************************************************
  4752*                                                                *
  4753*                                                                *
  4754*                            ELCDIFRD.                           *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.004                          *
  4757*                                                                *
  4758*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4759*                                                                *
  4760******************************************************************
  4761*
  4762  01  WS-DIFFERENCE-CALCULATION.
  4763        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4764        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4765        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4766        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4767        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4768        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4769        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4770        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4771        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4772        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4773        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4774
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  89
* EL050.cbl
  4776****************************************************************
  4777*
  4778* Copyright (c) 2007 by Clerity Solutions, Inc.
  4779* All rights reserved.
  4780*
  4781****************************************************************
  4782 01  DFHEIV.
  4783   02  DFHEIV0               PIC X(35).
  4784   02  DFHEIV1               PIC X(08).
  4785   02  DFHEIV2               PIC X(08).
  4786   02  DFHEIV3               PIC X(08).
  4787   02  DFHEIV4               PIC X(06).
  4788   02  DFHEIV5               PIC X(04).
  4789   02  DFHEIV6               PIC X(04).
  4790   02  DFHEIV7               PIC X(02).
  4791   02  DFHEIV8               PIC X(02).
  4792   02  DFHEIV9               PIC X(01).
  4793   02  DFHEIV10              PIC S9(7) COMP-3.
  4794   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4795   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4796   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4797   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4798   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4799   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4800   02  DFHEIV17              PIC X(04).
  4801   02  DFHEIV18              PIC X(04).
  4802   02  DFHEIV19              PIC X(04).
  4803   02  DFHEIV20              USAGE IS POINTER.
  4804   02  DFHEIV21              USAGE IS POINTER.
  4805   02  DFHEIV22              USAGE IS POINTER.
  4806   02  DFHEIV23              USAGE IS POINTER.
  4807   02  DFHEIV24              USAGE IS POINTER.
  4808   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4809   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4810   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4811   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4812   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4813   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4814   02  FILLER                PIC X(02).
  4815   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4816   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4817   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4818   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4819   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4820 LINKAGE  SECTION.
  4821*****************************************************************
  4822*                                                               *
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4824* All rights reserved.                                          *
  4825*                                                               *
  4826*****************************************************************
  4827 01  dfheiblk.
  4828     02  eibtime          pic s9(7) comp-3.
  4829     02  eibdate          pic s9(7) comp-3.
  4830     02  eibtrnid         pic x(4).
  4831     02  eibtaskn         pic s9(7) comp-3.
  4832     02  eibtrmid         pic x(4).
  4833     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  90
* EL050.cbl
  4834     02  eibcposn         pic s9(4) comp.
  4835     02  eibcalen         pic s9(4) comp.
  4836     02  eibaid           pic x(1).
  4837     02  eibfiller1       pic x(1).
  4838     02  eibfn            pic x(2).
  4839     02  eibfiller2       pic x(2).
  4840     02  eibrcode         pic x(6).
  4841     02  eibfiller3       pic x(2).
  4842     02  eibds            pic x(8).
  4843     02  eibreqid         pic x(8).
  4844     02  eibrsrce         pic x(8).
  4845     02  eibsync          pic x(1).
  4846     02  eibfree          pic x(1).
  4847     02  eibrecv          pic x(1).
  4848     02  eibsend          pic x(1).
  4849     02  eibatt           pic x(1).
  4850     02  eibeoc           pic x(1).
  4851     02  eibfmh           pic x(1).
  4852     02  eibcompl         pic x(1).
  4853     02  eibsig           pic x(1).
  4854     02  eibconf          pic x(1).
  4855     02  eiberr           pic x(1).
  4856     02  eibrldbk         pic x(1).
  4857     02  eiberrcd         pic x(4).
  4858     02  eibsynrb         pic x(1).
  4859     02  eibnodat         pic x(1).
  4860     02  eibfiller5       pic x(2).
  4861     02  eibresp          pic 9(09) comp.
  4862     02  eibresp2         pic 9(09) comp.
  4863     02  dfheigdj         pic s9(4) comp.
  4864     02  dfheigdk         pic s9(4) comp.
  4865
  4866 01  DFHCOMMAREA                   PIC X(1036).
  4867
  4868*01 PARMLIST .
  4869*    02  FILLER                    PIC S9(8)   COMP.
  4870*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4871*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4872*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4873*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4874*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4875*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4876*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4877
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  91
* EL050.cbl
  4879*    COPY ELCCNTL.
  4880******************************************************************
  4881*                                                                *
  4882*                                                                *
  4883*                            ELCCNTL.                            *
  4884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4885*                            VMOD=2.059                          *
  4886*                                                                *
  4887*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4888*                                                                *
  4889*   FILE TYPE = VSAM,KSDS                                        *
  4890*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4891*                                                                *
  4892*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4893*       ALTERNATE INDEX = NONE                                   *
  4894*                                                                *
  4895*   LOG = YES                                                    *
  4896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4897******************************************************************
  4898*                   C H A N G E   L O G
  4899*
  4900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4901*-----------------------------------------------------------------
  4902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4903* EFFECTIVE    NUMBER
  4904*-----------------------------------------------------------------
  4905* 082503                   PEMA  ADD BENEFIT GROUP
  4906* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4907* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4908* 092705    2005050300006  PEMA  ADD SPP LEASES
  4909* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4910* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4911* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4912* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4913* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4914* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4915******************************************************************
  4916*
  4917 01  CONTROL-FILE.
  4918     12  CF-RECORD-ID                       PIC XX.
  4919         88  VALID-CF-ID                        VALUE 'CF'.
  4920
  4921     12  CF-CONTROL-PRIMARY.
  4922         16  CF-COMPANY-ID                  PIC XXX.
  4923         16  CF-RECORD-TYPE                 PIC X.
  4924             88  CF-COMPANY-MASTER              VALUE '1'.
  4925             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4926             88  CF-STATE-MASTER                VALUE '3'.
  4927             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4928             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4929             88  CF-CARRIER-MASTER              VALUE '6'.
  4930             88  CF-MORTALITY-MASTER            VALUE '7'.
  4931             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4932             88  CF-TERMINAL-MASTER             VALUE '9'.
  4933             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4934             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4935             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4936             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  92
* EL050.cbl
  4937             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4938             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4939             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4940             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4941             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4942         16  CF-ACCESS-CD-GENL              PIC X(4).
  4943         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4944             20  CF-PROCESSOR               PIC X(4).
  4945         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4946             20  CF-STATE-CODE              PIC XX.
  4947             20  FILLER                     PIC XX.
  4948         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4949             20  FILLER                     PIC XX.
  4950             20  CF-HI-BEN-IN-REC           PIC XX.
  4951         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4952             20  FILLER                     PIC XXX.
  4953             20  CF-CARRIER-CNTL            PIC X.
  4954         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4955             20  FILLER                     PIC XX.
  4956             20  CF-HI-TYPE-IN-REC          PIC 99.
  4957         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4958             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4959                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4960             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4961             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4962         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4963             20  FILLER                     PIC X.
  4964             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4965         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  FILLER                     PIC XX.
  4967             20  CF-MORTGAGE-PLAN           PIC XX.
  4968         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4969
  4970     12  CF-LAST-MAINT-DT                   PIC XX.
  4971     12  CF-LAST-MAINT-BY                   PIC X(4).
  4972     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4973
  4974     12  CF-RECORD-BODY                     PIC X(728).
  4975
  4976
  4977****************************************************************
  4978*             COMPANY MASTER RECORD                            *
  4979****************************************************************
  4980
  4981     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4982         16  CF-COMPANY-ADDRESS.
  4983             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4984             20  CF-CL-IN-CARE-OF           PIC X(30).
  4985             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4986             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4987             20  CF-CL-CITY-STATE           PIC X(30).
  4988             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4989             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4990         16  CF-COMPANY-CD                  PIC X.
  4991         16  CF-COMPANY-PASSWORD            PIC X(8).
  4992         16  CF-SECURITY-OPTION             PIC X.
  4993             88  ALL-SECURITY                   VALUE '1'.
  4994             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  93
* EL050.cbl
  4995             88  PROCESSOR-VERIFY               VALUE '3'.
  4996             88  NO-SECURITY                    VALUE '4'.
  4997             88  ALL-BUT-TERM                   VALUE '5'.
  4998         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4999             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5000         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5001             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5002         16  CF-INFORCE-LOCATION            PIC X.
  5003             88  CERTS-ARE-ONLINE               VALUE '1'.
  5004             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5005             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5006         16  CF-LOWER-CASE-LETTERS          PIC X.
  5007         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5008             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5009             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5010             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5011             88  CF-ACCNT-CNTL                  VALUE '3'.
  5012             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5013
  5014         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5015         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5016
  5017         16  CF-LGX-CREDIT-USER             PIC X.
  5018             88  CO-IS-NOT-USER                 VALUE 'N'.
  5019             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5020
  5021         16 CF-CREDIT-CALC-CODES.
  5022             20  CF-CR-REM-TERM-CALC PIC X.
  5023               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5024               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5025               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5026               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5027               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5028               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5029               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5030             20  CF-CR-R78-METHOD           PIC X.
  5031               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5032               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5033
  5034         16  CF-CLAIM-CONTROL-COUNTS.
  5035             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5036                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5037
  5038             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5039                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5040
  5041             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5042                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5043
  5044             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5045                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5046
  5047         16  CF-CURRENT-MONTH-END           PIC XX.
  5048
  5049         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5050             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5051             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5052             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  94
* EL050.cbl
  5053             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5054                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5055                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5056             20  CF-CO-PREM-REJECT-SW       PIC X.
  5057                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5058                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5059             20  CF-CO-REF-REJECT-SW        PIC X.
  5060                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5061                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5062
  5063         16  CF-CO-REPORTING-DT             PIC XX.
  5064         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5065         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5066           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5067           88  CF-CO-MONTH-END                  VALUE '1'.
  5068
  5069         16  CF-LGX-CLAIM-USER              PIC X.
  5070             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5072
  5073         16  CF-CREDIT-EDIT-CONTROLS.
  5074             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5075             20  CF-MIN-AGE                 PIC 99.
  5076             20  CF-DEFAULT-AGE             PIC 99.
  5077             20  CF-MIN-TERM                PIC S999      COMP-3.
  5078             20  CF-MAX-TERM                PIC S999      COMP-3.
  5079             20  CF-DEFAULT-SEX             PIC X.
  5080             20  CF-JOINT-AGE-INPUT         PIC X.
  5081                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5082             20  CF-BIRTH-DATE-INPUT        PIC X.
  5083                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5084             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5085                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5086                 88  CF-ZERO-CARRIER            VALUE '1'.
  5087                 88  CF-ZERO-GROUPING           VALUE '2'.
  5088                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5089             20  CF-EDIT-SW                 PIC X.
  5090                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5091             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5092             20  CF-CR-PR-METHOD            PIC X.
  5093               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5094               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5095             20  FILLER                     PIC X.
  5096
  5097         16  CF-CREDIT-MISC-CONTROLS.
  5098             20  CF-REIN-TABLE-SW           PIC X.
  5099                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5100             20  CF-COMP-TABLE-SW           PIC X.
  5101                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5102             20  CF-EXPERIENCE-RETENTION-AGE
  5103                                            PIC S9        COMP-3.
  5104             20  CF-CONVERSION-DT           PIC XX.
  5105             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5106             20  CF-RUN-FREQUENCY-SW        PIC X.
  5107                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5108                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5109
  5110             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  95
* EL050.cbl
  5111                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5112                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5113                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5114                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5115                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5116                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5117
  5118                 24  CF-CR-CHECK-COUNT       REDEFINES
  5119                     CF-CR-CHECK-COUNTER      PIC X(4).
  5120
  5121                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5122                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5123
  5124                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5125                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5126                 24  CF-MAIL-PROCESSING       PIC X.
  5127                     88  MAIL-PROCESSING          VALUE 'Y'.
  5128
  5129         16  CF-MISC-SYSTEM-CONTROL.
  5130             20  CF-SYSTEM-C                 PIC X.
  5131                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5132             20  CF-SYSTEM-D                 PIC X.
  5133                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5134             20  CF-SOC-SEC-NO-SW            PIC X.
  5135                 88  SOC-SEC-NO-USED             VALUE '1'.
  5136             20  CF-MEMBER-NO-SW             PIC X.
  5137                 88  MEMBER-NO-USED              VALUE '1'.
  5138             20  CF-TAX-ID-NUMBER            PIC X(11).
  5139             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5140             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5141                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5142                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5143                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5144                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5145             20  CF-SYSTEM-E                 PIC X.
  5146                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5147
  5148         16  CF-LGX-LIFE-USER               PIC X.
  5149             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5150             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5151
  5152         16  CF-CR-MONTH-END-DT             PIC XX.
  5153
  5154         16  CF-FILE-MAINT-DATES.
  5155             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5156                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5157             20  CF-LAST-BATCH       REDEFINES
  5158                 CF-LAST-BATCH-NO               PIC X(4).
  5159             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5160             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5161             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5162             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5163             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5164             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5165             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5166             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5167             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5168             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  96
* EL050.cbl
  5169
  5170         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5171         16  FILLER                         PIC X.
  5172
  5173         16  CF-ALT-MORT-CODE               PIC X(4).
  5174         16  CF-MEMBER-CAPTION              PIC X(10).
  5175
  5176         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5177             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5178             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5179             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5180             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5181             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5182
  5183         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5184
  5185         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5186         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5187         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5188         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5189
  5190         16  CF-AH-OVERRIDE-L1              PIC X.
  5191         16  CF-AH-OVERRIDE-L2              PIC XX.
  5192         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5193         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5194
  5195         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5196         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5197
  5198         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5199         16  CF-AR-LAST-EL860-DT            PIC XX.
  5200         16  CF-MP-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5203         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5204             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5205
  5206         16  CF-AR-MONTH-END-DT             PIC XX.
  5207
  5208         16  CF-CRDTCRD-USER                PIC X.
  5209             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5210             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5211
  5212         16  CF-CC-MONTH-END-DT             PIC XX.
  5213
  5214         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5215
  5216         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5217             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5218             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5219             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5220         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5221         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5222         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5223         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5224             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5225             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5226         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  97
* EL050.cbl
  5227         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5228         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5229             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5230         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5231
  5232         16  CF-CL-ZIP-CODE.
  5233             20  CF-CL-ZIP-PRIME.
  5234                 24  CF-CL-ZIP-1ST          PIC X.
  5235                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5236                 24  FILLER                 PIC X(4).
  5237             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5238         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5239             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5240             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5241             20  FILLER                     PIC XXX.
  5242
  5243         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5244         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5245         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5246         16  CF-CO-OPTION-START-DATE        PIC XX.
  5247         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5248           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5249                                                      '3' '4'.
  5250           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5251           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5252           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5253           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5254           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5255           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5256
  5257         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5258
  5259         16  CF-PAYMENT-APPROVAL-LEVELS.
  5260             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5261             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5262             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5263             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5264             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5265             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5266
  5267         16  CF-END-USER-REPORTING-USER     PIC X.
  5268             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5269             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5270
  5271         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5272             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5273             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5274
  5275         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5276
  5277         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5278         16  FILLER                         PIC X.
  5279
  5280         16  CF-CREDIT-ARCHIVE-CNTL.
  5281             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5282             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5283             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5284
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  98
* EL050.cbl
  5285         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5286
  5287         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5288             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5289             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5292             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5293             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5294
  5295         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5296
  5297         16  CF-CO-ACH-ID-CODE              PIC  X.
  5298             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5299             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5300             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5301         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5302         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5303         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5304         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5305         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5306         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5307         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5308         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5309         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5310                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5311         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5312                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5313
  5314         16  CF-CO-OVER-SHORT.
  5315             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5316             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5317
  5318*         16  FILLER                         PIC X(102).
  5319         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5320             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5321             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5322
  5323         16  CF-AH-APPROVAL-DAYS.
  5324             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5325             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5326             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5327             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5328
  5329         16  FILLER                         PIC X(82).
  5330****************************************************************
  5331*             PROCESSOR/USER RECORD                            *
  5332****************************************************************
  5333
  5334     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-PROCESSOR-NAME              PIC X(30).
  5336         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5337         16  CF-PROCESSOR-TITLE             PIC X(26).
  5338         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5339                 88  MESSAGE-YES                VALUE 'Y'.
  5340                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5341
  5342*****************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page  99
* EL050.cbl
  5343****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5344****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5345****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5346****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5347*****************************************************
  5348
  5349         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5350             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5351             20  CF-APPLICATION-FORCE       PIC X.
  5352             20  CF-INDIVIDUAL-APP.
  5353                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5354                     28  CF-BROWSE-APP      PIC X.
  5355                     28  CF-UPDATE-APP      PIC X.
  5356
  5357         16  CF-CURRENT-TERM-ON             PIC X(4).
  5358         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5359             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5360             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5361             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5362             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5363             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5364             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5365             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5366         16  CF-PROCESSOR-CARRIER           PIC X.
  5367             88  NO-CARRIER-SECURITY            VALUE ' '.
  5368         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5369             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5370         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5371             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5372         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5373             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5374
  5375         16  CF-PROC-SYS-ACCESS-SW.
  5376             20  CF-PROC-CREDIT-CLAIMS-SW.
  5377                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5378                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5379                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5380                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5381             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5382                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5383                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5384             20  CF-PROC-LIFE-GNRLDGR-SW.
  5385                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5386                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5387                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5388                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5389             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5390                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5391                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5392         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5393             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5394             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5395         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5396
  5397         16  CF-APPROVAL-LEVEL                  PIC X.
  5398             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5399             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5400             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 100
* EL050.cbl
  5401             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5402
  5403         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5404
  5405         16  CF-LANGUAGE-TYPE                   PIC X.
  5406             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5407             88  CF-LANG-IS-FR                      VALUE 'F'.
  5408
  5409         16  CF-CSR-IND                         PIC X.
  5410         16  FILLER                             PIC X(239).
  5411
  5412****************************************************************
  5413*             PROCESSOR/REMINDERS RECORD                       *
  5414****************************************************************
  5415
  5416     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5417         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5418             20  CF-START-REMIND-DT         PIC XX.
  5419             20  CF-END-REMIND-DT           PIC XX.
  5420             20  CF-REMINDER-TEXT           PIC X(50).
  5421         16  FILLER                         PIC X(296).
  5422
  5423
  5424****************************************************************
  5425*             STATE MASTER RECORD                              *
  5426****************************************************************
  5427
  5428     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-STATE-ABBREVIATION          PIC XX.
  5430         16  CF-STATE-NAME                  PIC X(25).
  5431         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5432         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5433             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5434             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5435             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5436             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5437                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5438                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5439             20  CF-ST-PREM-REJECT-SW       PIC X.
  5440                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5441                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5442             20  CF-ST-REF-REJECT-SW        PIC X.
  5443                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5444                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5445         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5446         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5447         16  CF-ST-REFUND-RULES.
  5448             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5449             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5450             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5451         16  CF-ST-FST-PMT-EXTENSION.
  5452             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5453             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5454                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5455                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5456                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5457                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5458         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 101
* EL050.cbl
  5459             20  CF-ST-CALL-UNEARNED        PIC X.
  5460             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5461             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5462         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5463             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5464             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5465         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5466         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5467         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5468         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5469         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5470         16  FILLER                         PIC X.
  5471         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5472             20  CF-ST-BENEFIT-CD           PIC XX.
  5473             20  CF-ST-BENEFIT-KIND         PIC X.
  5474                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5475                 88  CF-ST-AH-KIND              VALUE 'A'.
  5476             20  CF-ST-REM-TERM-CALC        PIC X.
  5477                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5478                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5479                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5480                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5481                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5482                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5483                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5484                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5485
  5486             20  CF-ST-REFUND-CALC          PIC X.
  5487                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5488                 88  ST-REFD-BY-R78             VALUE '1'.
  5489                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5490                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5491                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5492                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5493                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5494                 88  ST-REFD-UTAH               VALUE '7'.
  5495                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5496                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5497                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5498
  5499             20  CF-ST-EARNING-CALC         PIC X.
  5500                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5501                 88  ST-EARN-BY-R78             VALUE '1'.
  5502                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5503                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5504                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5505                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5506                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5507                 88  ST-EARN-MEAN               VALUE '8'.
  5508                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5509
  5510             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5511                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5512                 88  ST-OVRD-BY-R78             VALUE '1'.
  5513                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5514                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5515                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5516                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 102
* EL050.cbl
  5517                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5518                 88  ST-OVRD-MEAN               VALUE '8'.
  5519                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5520             20  FILLER                     PIC X.
  5521
  5522         16  CF-ST-COMMISSION-CAPS.
  5523             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5524             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5525             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5526             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5527         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5528                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5529
  5530         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5531
  5532         16  CF-ST-STATUTORY-INTEREST.
  5533             20  CF-ST-STAT-DATE-FROM       PIC X.
  5534                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5535                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5536             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5537             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5538             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5539             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5540             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5541
  5542         16  CF-ST-OVER-SHORT.
  5543             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5544             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5545
  5546         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5547
  5548         16  CF-ST-RT-CALC                  PIC X.
  5549
  5550         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5551         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5552         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5553         16  CF-ST-RF-LR-CALC               PIC X.
  5554         16  CF-ST-RF-LL-CALC               PIC X.
  5555         16  CF-ST-RF-LN-CALC               PIC X.
  5556         16  CF-ST-RF-AH-CALC               PIC X.
  5557         16  CF-ST-RF-CP-CALC               PIC X.
  5558*        16  FILLER                         PIC X(206).
  5559*CIDMOD         16  FILLER                         PIC X(192).
  5560         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5561             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5562         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5563         16  CF-ST-VFY-2ND-BENE             PIC X.
  5564         16  FILLER                         PIC X(186).
  5565
  5566****************************************************************
  5567*             BENEFIT MASTER RECORD                            *
  5568****************************************************************
  5569
  5570     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5571         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5572             20  CF-BENEFIT-CODE            PIC XX.
  5573             20  CF-BENEFIT-NUMERIC  REDEFINES
  5574                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 103
* EL050.cbl
  5575             20  CF-BENEFIT-ALPHA           PIC XXX.
  5576             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5577             20  CF-BENEFIT-COMMENT         PIC X(10).
  5578
  5579             20  CF-LF-COVERAGE-TYPE        PIC X.
  5580                 88  CF-REDUCING                VALUE 'R'.
  5581                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5582
  5583             20  CF-SPECIAL-CALC-CD         PIC X.
  5584                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5585                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5586                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5587                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5588                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5589                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5590                 88  CF-FARM-PLAN               VALUE 'F'.
  5591                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5592                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5593                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5594                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5595                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5596                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5597                 88  CF-PRUDENTIAL              VALUE 'P'.
  5598                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5599                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5600                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5601                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5602                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5603                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5604
  5605             20  CF-JOINT-INDICATOR         PIC X.
  5606                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5607
  5608*            20  FILLER                     PIC X(12).
  5609             20  FILLER                     PIC X(11).
  5610             20  CF-BENEFIT-CATEGORY        PIC X.
  5611             20  CF-LOAN-TYPE               PIC X(8).
  5612
  5613             20  CF-CO-REM-TERM-CALC        PIC X.
  5614                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5615                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5616                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5617                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5618                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5619
  5620             20  CF-CO-EARNINGS-CALC        PIC X.
  5621                 88  CO-EARN-BY-R78             VALUE '1'.
  5622                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5623                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5624                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5625                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5626                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5627                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5628                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5629
  5630             20  CF-CO-REFUND-CALC          PIC X.
  5631                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5632                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 104
* EL050.cbl
  5633                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5634                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5635                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5636                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5637                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5638                 88  CO-REFD-MEAN               VALUE '8'.
  5639                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5640                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5641                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5642
  5643             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5644                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5645                 88  CO-OVRD-BY-R78             VALUE '1'.
  5646                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5648                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5649                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5651                 88  CO-OVRD-MEAN               VALUE '8'.
  5652                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-BEN-I-G-CD           PIC X.
  5655                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5656                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5657                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5658
  5659         16  FILLER                         PIC X(304).
  5660
  5661
  5662****************************************************************
  5663*             CARRIER MASTER RECORD                            *
  5664****************************************************************
  5665
  5666     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5667         16  CF-ADDRESS-DATA.
  5668             20  CF-MAIL-TO-NAME            PIC X(30).
  5669             20  CF-IN-CARE-OF              PIC X(30).
  5670             20  CF-ADDRESS-LINE-1          PIC X(30).
  5671             20  CF-ADDRESS-LINE-2          PIC X(30).
  5672             20  CF-CITY-STATE              PIC X(30).
  5673             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5674             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5675
  5676         16  CF-CLAIM-NO-CONTROL.
  5677             20  CF-CLAIM-NO-METHOD         PIC X.
  5678                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5679                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5680                 88  CLAIM-NO-SEQ               VALUE '3'.
  5681                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5682             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5683                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5684                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5685                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5686
  5687         16  CF-CHECK-NO-CONTROL.
  5688             20  CF-CHECK-NO-METHOD         PIC X.
  5689                 88  CHECK-NO-MANUAL            VALUE '1'.
  5690                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 105
* EL050.cbl
  5691                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5692                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5693             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5694                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5695
  5696         16  CF-DOMICILE-STATE              PIC XX.
  5697
  5698         16  CF-EXPENSE-CONTROLS.
  5699             20  CF-EXPENSE-METHOD          PIC X.
  5700                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5701                 88  DOLLARS-PER-PMT            VALUE '2'.
  5702                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5703                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5704             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5705             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5706
  5707         16  CF-CORRESPONDENCE-CONTROL.
  5708             20  CF-LETTER-RESEND-OPT       PIC X.
  5709                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5710                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5711             20  FILLER                     PIC X(4).
  5712
  5713         16  CF-RESERVE-CONTROLS.
  5714             20  CF-MANUAL-SW               PIC X.
  5715                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5716             20  CF-FUTURE-SW               PIC X.
  5717                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5718             20  CF-PTC-SW                  PIC X.
  5719                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5720             20  CF-IBNR-SW                 PIC X.
  5721                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5722             20  CF-PTC-LF-SW               PIC X.
  5723                 88  CF-LF-PTC-USED             VALUE '1'.
  5724             20  CF-CDT-ACCESS-METHOD       PIC X.
  5725                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5726                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5727                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5728             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5729
  5730         16  CF-CLAIM-CALC-METHOD           PIC X.
  5731             88  360-PLUS-MONTHS                VALUE '1'.
  5732             88  365-PLUS-MONTHS                VALUE '2'.
  5733             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5734             88  360-DAILY                      VALUE '4'.
  5735             88  365-DAILY                      VALUE '5'.
  5736
  5737         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5738         16  FILLER                         PIC X(11).
  5739
  5740         16  CF-LIMIT-AMOUNTS.
  5741             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5742             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5743             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5744             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5745             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5746             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5747             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5748             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 106
* EL050.cbl
  5749             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5750             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5751
  5752         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5753         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5754         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5755
  5756         16  CF-ZIP-CODE.
  5757             20  CF-ZIP-PRIME.
  5758                 24  CF-ZIP-1ST             PIC X.
  5759                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5760                 24  FILLER                 PIC X(4).
  5761             20  CF-ZIP-PLUS4               PIC X(4).
  5762         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5763             20  CF-CAN-POSTAL-1            PIC XXX.
  5764             20  CF-CAN-POSTAL-2            PIC XXX.
  5765             20  FILLER                     PIC XXX.
  5766
  5767         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5768         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5769         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5770
  5771         16  CF-RATING-SWITCH               PIC X.
  5772             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5773             88  CF-NO-RATING                   VALUE 'N'.
  5774
  5775         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5776
  5777         16  CF-CARRIER-OVER-SHORT.
  5778             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5779             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5780
  5781         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5782         16  CF-SECPAY-SWITCH               PIC X.
  5783             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5784             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5785         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5786         16  FILLER                         PIC X(448).
  5787*        16  FILLER                         PIC X(452).
  5788
  5789
  5790****************************************************************
  5791*             MORTALITY MASTER RECORD                          *
  5792****************************************************************
  5793
  5794     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5796                                INDEXED BY CF-MORT-NDX.
  5797             20  CF-MORT-TABLE              PIC X(5).
  5798             20  CF-MORT-TABLE-TYPE         PIC X.
  5799                 88  CF-MORT-JOINT              VALUE 'J'.
  5800                 88  CF-MORT-SINGLE             VALUE 'S'.
  5801                 88  CF-MORT-COMBINED           VALUE 'C'.
  5802                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5803                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5804             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5805             20  CF-MORT-AGE-METHOD         PIC XX.
  5806                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 107
* EL050.cbl
  5807                 88  CF-AGE-NEAR                VALUE 'AN'.
  5808             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5809             20  CF-MORT-ADJUSTMENT-DIRECTION
  5810                                            PIC X.
  5811                 88  CF-MINUS                   VALUE '-'.
  5812                 88  CF-PLUS                    VALUE '+'.
  5813             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5814             20  CF-MORT-JOINT-CODE         PIC X.
  5815                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5816             20  CF-MORT-PC-Q               PIC X.
  5817                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5818             20  CF-MORT-TABLE-CODE         PIC X(4).
  5819             20  CF-MORT-COMMENTS           PIC X(15).
  5820             20  FILLER                     PIC X(14).
  5821
  5822         16  FILLER                         PIC X(251).
  5823
  5824
  5825****************************************************************
  5826*             BUSSINESS TYPE MASTER RECORD                     *
  5827****************************************************************
  5828
  5829     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5830* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5831* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5832* AND RECORD 05 IS TYPES 81-99
  5833         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5834             20  CF-BUSINESS-TITLE          PIC  X(19).
  5835             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5836                                            PIC S9V9(4) COMP-3.
  5837             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5838             20  FILLER                     PIC  X.
  5839         16  FILLER                         PIC  X(248).
  5840
  5841
  5842****************************************************************
  5843*             TERMINAL MASTER RECORD                           *
  5844****************************************************************
  5845
  5846     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5847
  5848         16  CF-COMPANY-TERMINALS.
  5849             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5850                                  PIC X(4).
  5851         16  FILLER               PIC X(248).
  5852
  5853
  5854****************************************************************
  5855*             LIFE EDIT MASTER RECORD                          *
  5856****************************************************************
  5857
  5858     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5859         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5860             20  CF-LIFE-CODE-IN            PIC XX.
  5861             20  CF-LIFE-CODE-OUT           PIC XX.
  5862         16  FILLER                         PIC X(248).
  5863
  5864
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 108
* EL050.cbl
  5865****************************************************************
  5866*             AH EDIT MASTER RECORD                            *
  5867****************************************************************
  5868
  5869     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5870         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5871             20  CF-AH-CODE-IN              PIC XXX.
  5872             20  CF-AH-CODE-OUT             PIC XX.
  5873         16  FILLER                         PIC X(248).
  5874
  5875
  5876****************************************************************
  5877*             CREDIBILITY TABLES                               *
  5878****************************************************************
  5879
  5880     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5881         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5882                             INDEXED BY CF-CRDB-NDX.
  5883             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5884             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5885             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5886         16  FILLER                         PIC  X(332).
  5887
  5888
  5889****************************************************************
  5890*             REPORT CUSTOMIZATION RECORD                      *
  5891****************************************************************
  5892
  5893     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5894         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5895             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5896             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5897             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5898**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5899****       A T-TRANSFER.                                   ****
  5900             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5901
  5902         16  FILLER                         PIC XX.
  5903
  5904         16  CF-CARRIER-CNTL-OPT.
  5905             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5906                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5907                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5908             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5909                                            PIC X.
  5910         16  CF-GROUP-CNTL-OPT.
  5911             20  CF-GROUP-OPT-SEQ           PIC 9.
  5912                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5914             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5915                                            PIC X(6).
  5916         16  CF-STATE-CNTL-OPT.
  5917             20  CF-STATE-OPT-SEQ           PIC 9.
  5918                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5920             20  CF-STATE-SELECT OCCURS 3 TIMES
  5921                                            PIC XX.
  5922         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 109
* EL050.cbl
  5923             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5924                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5925                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5926             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5927                                            PIC X(10).
  5928         16  CF-BUS-TYP-CNTL-OPT.
  5929             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5930                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5932             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5933                                            PIC XX.
  5934         16  CF-LF-TYP-CNTL-OPT.
  5935             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5936                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5937                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5938             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5939                                            PIC XX.
  5940         16  CF-AH-TYP-CNTL-OPT.
  5941             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5942                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5943                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5944             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5945                                            PIC XX.
  5946         16  CF-REPTCD1-CNTL-OPT.
  5947             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5948                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5950             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-REPTCD2-CNTL-OPT.
  5953             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5954                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5956             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5957                                            PIC X(10).
  5958         16  CF-USER1-CNTL-OPT.
  5959             20  CF-USER1-OPT-SEQ           PIC 9.
  5960                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5961                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5962             20  CF-USER1-SELECT OCCURS 3 TIMES
  5963                                            PIC X(10).
  5964         16  CF-USER2-CNTL-OPT.
  5965             20  CF-USER2-OPT-SEQ           PIC 9.
  5966                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5967                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5968             20  CF-USER2-SELECT OCCURS 3 TIMES
  5969                                            PIC X(10).
  5970         16  CF-USER3-CNTL-OPT.
  5971             20  CF-USER3-OPT-SEQ           PIC 9.
  5972                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5973                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5974             20  CF-USER3-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-USER4-CNTL-OPT.
  5977             20  CF-USER4-OPT-SEQ           PIC 9.
  5978                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5979                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5980             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 110
* EL050.cbl
  5981                                            PIC X(10).
  5982         16  CF-USER5-CNTL-OPT.
  5983             20  CF-USER5-OPT-SEQ           PIC 9.
  5984                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER5-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-REINS-CNTL-OPT.
  5989             20  CF-REINS-OPT-SEQ           PIC 9.
  5990                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5992             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5993                 24  CF-REINS-PRIME         PIC XXX.
  5994                 24  CF-REINS-SUB           PIC XXX.
  5995
  5996         16  CF-AGENT-CNTL-OPT.
  5997             20  CF-AGENT-OPT-SEQ           PIC 9.
  5998                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6000             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6001                                            PIC X(10).
  6002
  6003         16  FILLER                         PIC X(43).
  6004
  6005         16  CF-LOSS-RATIO-SELECT.
  6006             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6007             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6008         16  CF-ENTRY-DATE-SELECT.
  6009             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6010             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6011         16  CF-EFFECTIVE-DATE-SELECT.
  6012             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6013             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6014
  6015         16  CF-EXCEPTION-LIST-IND          PIC X.
  6016             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6017
  6018         16  FILLER                         PIC X(318).
  6019
  6020****************************************************************
  6021*                  EXCEPTION REPORTING RECORD                  *
  6022****************************************************************
  6023
  6024     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6025         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6026             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6027
  6028         16  CF-COMBINED-LIFE-AH-OPT.
  6029             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6030             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6031             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6032             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6033
  6034         16  CF-LIFE-OPT.
  6035             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6036             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6037             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6038             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 111
* EL050.cbl
  6039             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6040             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6041             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6042             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6043             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6044             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6045
  6046         16  CF-AH-OPT.
  6047             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6048             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6049             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6050             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6051             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6052             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6053             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6054             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6055             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6056             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6057
  6058         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6059             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6060             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6061             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6062
  6063         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6064
  6065         16  FILLER                         PIC X(673).
  6066
  6067
  6068****************************************************************
  6069*             MORTGAGE SYSTEM PLAN RECORD                      *
  6070****************************************************************
  6071
  6072     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6073         16  CF-PLAN-TYPE                   PIC X.
  6074             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6075             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6076             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6077         16  CF-PLAN-ABBREV                 PIC XXX.
  6078         16  CF-PLAN-DESCRIPT               PIC X(10).
  6079         16  CF-PLAN-NOTES                  PIC X(20).
  6080         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6081         16  CF-PLAN-UNDERWRITING.
  6082             20  CF-PLAN-TERM-DATA.
  6083                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6084                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6085             20  CF-PLAN-AGE-DATA.
  6086                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6087                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6088                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6089             20  CF-PLAN-BENEFIT-DATA.
  6090                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6091                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6092                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6093                                            PIC S9(7)V99  COMP-3.
  6094         16  CF-PLAN-POLICY-FORMS.
  6095             20  CF-POLICY-FORM             PIC X(12).
  6096             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 112
* EL050.cbl
  6097             20  CF-MASTER-POLICY           PIC X(12).
  6098         16  CF-PLAN-RATING.
  6099             20  CF-RATE-CODE               PIC X(5).
  6100             20  CF-SEX-RATING              PIC X.
  6101                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6102                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6103             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6104             20  CF-SUB-STD-TYPE            PIC X.
  6105                 88  CF-PCT-OF-PREM            VALUE '1'.
  6106                 88  CF-PCT-OF-BENE            VALUE '2'.
  6107         16  CF-PLAN-PREM-TOLERANCES.
  6108             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6109             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6110         16  CF-PLAN-PYMT-TOLERANCES.
  6111             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6112             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6113         16  CF-PLAN-MISC-DATA.
  6114             20  FILLER                     PIC X.
  6115             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6116             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6117         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6118         16  CF-PLAN-IND-GRP                PIC X.
  6119             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6120                                                     '1'.
  6121             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6122                                                     '2'.
  6123         16  CF-MIB-SEARCH-SW               PIC X.
  6124             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6125             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6126             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6127             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6128         16  CF-ALPHA-SEARCH-SW             PIC X.
  6129             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6130             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6131             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6132             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6133             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6134             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6135             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6136             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6137             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6138             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6139                                                     'A' 'B' 'C'
  6140                                                     'X' 'Y' 'Z'.
  6141         16  CF-EFF-DT-RULE-SW              PIC X.
  6142             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6143             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6144             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6145             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6146             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6147         16  FILLER                         PIC X(4).
  6148         16  CF-HEALTH-QUESTIONS            PIC X.
  6149             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6150         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6151         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6152         16  CF-PLAN-SNGL-JNT               PIC X.
  6153             88  CF-COMBINED-PLAN              VALUE 'C'.
  6154             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 113
* EL050.cbl
  6155             88  CF-SNGL-PLAN                  VALUE 'S'.
  6156         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6157         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6158         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6159         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6160         16  CF-RERATE-CNTL                 PIC  X.
  6161             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6162             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6163             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6164             88  CF-AUTO-RECALC                 VALUE '4'.
  6165         16  CF-BENEFIT-TYPE                PIC  X.
  6166             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6167             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6168         16  CF-POLICY-FEE                  PIC S999V99
  6169                                                    COMP-3.
  6170         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6171         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6172         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6173         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6174         16  FILLER                         PIC  X(32).
  6175         16  CF-TERMINATION-FORM            PIC  X(04).
  6176         16  FILLER                         PIC  X(08).
  6177         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6178                                                       COMP-3.
  6179         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6180         16  CF-ISSUE-LETTER                PIC  X(4).
  6181         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6182         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6183             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6184             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6185         16  CF-MP-REFUND-CALC              PIC X.
  6186             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6187             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6188             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6189             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6190             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6191             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6192             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6193             88  CF-MP-REFD-MEAN                VALUE '8'.
  6194         16  CF-ALT-RATE-CODE               PIC  X(5).
  6195
  6196
  6197         16  FILLER                         PIC X(498).
  6198****************************************************************
  6199*             MORTGAGE COMPANY MASTER RECORD                   *
  6200****************************************************************
  6201
  6202     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6203         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6204         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6205             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6206             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6207             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6208             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6209             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6210
  6211         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6212         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 114
* EL050.cbl
  6213         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6214         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6215         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6216
  6217         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6218             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6219         16  CF-MP-RECON-USE-IND            PIC X(1).
  6220             88  CF-MP-USE-RECON             VALUE 'Y'.
  6221         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6222             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6223         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6224             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6225             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6226         16  FILLER                         PIC X(1).
  6227         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6228             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6229         16  CF-MORTG-MIB-VERSION           PIC X.
  6230             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6231             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6232             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6233         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6234             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6235                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6236             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6237                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6238             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6239                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6240             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6241                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6242             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6243                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6244             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6245                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6246         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6247         16  FILLER                         PIC X(7).
  6248         16  CF-MORTG-DESTINATION-SYMBOL.
  6249             20  CF-MORTG-MIB-COMM          PIC X(5).
  6250             20  CF-MORTG-MIB-TERM          PIC X(5).
  6251         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6252             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6253         16  FILLER                         PIC X(03).
  6254         16  CF-MP-CHECK-NO-CONTROL.
  6255             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6256                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6257                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6258                                                ' ' LOW-VALUES.
  6259                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6260                                               VALUE '3'.
  6261         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6262         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6263         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6264             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6265                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6266             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6267                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6268             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6269                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6270             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 115
* EL050.cbl
  6271                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6272             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6273                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6274             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6275                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6276         16  CF-MORTG-BILLING-AREA.
  6277             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6278                                            PIC X.
  6279         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6280         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6281         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6282         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6283             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6284             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6285         16  FILLER                         PIC X.
  6286         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6287             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6288             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6289         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6290         16  FILLER                         PIC X(8).
  6291         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6292         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6293         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6294         16  CF-ACH-COMPANY-ID.
  6295             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6296                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6297                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6298                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6299             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6300         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6301             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6302         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6303             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6304             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6305         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6306         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6307         16  FILLER                         PIC X(536).
  6308
  6309****************************************************************
  6310*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6311****************************************************************
  6312
  6313     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6314         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6315             20  CF-FEMALE-HEIGHT.
  6316                 24  CF-FEMALE-FT           PIC 99.
  6317                 24  CF-FEMALE-IN           PIC 99.
  6318             20  CF-FEMALE-MIN-WT           PIC 999.
  6319             20  CF-FEMALE-MAX-WT           PIC 999.
  6320         16  FILLER                         PIC X(428).
  6321
  6322     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6323         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6324             20  CF-MALE-HEIGHT.
  6325                 24  CF-MALE-FT             PIC 99.
  6326                 24  CF-MALE-IN             PIC 99.
  6327             20  CF-MALE-MIN-WT             PIC 999.
  6328             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 116
* EL050.cbl
  6329         16  FILLER                         PIC X(428).
  6330******************************************************************
  6331*             AUTOMATIC ACTIVITY RECORD                          *
  6332******************************************************************
  6333     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6334         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6335             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6336             20  CF-SYS-LETTER-ID           PIC X(04).
  6337             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6338             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6339             20  CF-SYS-RESET-SW            PIC X(01).
  6340             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6341             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6342
  6343         16  FILLER                         PIC X(50).
  6344
  6345         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6346             20  CF-USER-ACTIVE-SW          PIC X(01).
  6347             20  CF-USER-LETTER-ID          PIC X(04).
  6348             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6349             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6350             20  CF-USER-RESET-SW           PIC X(01).
  6351             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6352             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6353             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6354
  6355         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 117
* EL050.cbl
  6357*    COPY ERCACCT.
  6358******************************************************************
  6359*                                                                *
  6360*                                                                *
  6361*                            ERCACCT                             *
  6362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6363*                            VMOD=2.031                          *
  6364*                                                                *
  6365*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6366*                                                                *
  6367*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6368*   VSAM ACCOUNT MASTER FILES.                                   *
  6369*                                                                *
  6370*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6371*                                                                *
  6372*   FILE TYPE = VSAM,KSDS                                        *
  6373*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6374*                                                                *
  6375*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6376*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6377*                                                                *
  6378*   LOG = NO                                                     *
  6379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6380*                                                                *
  6381*                                                                *
  6382******************************************************************
  6383*                   C H A N G E   L O G
  6384*
  6385* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6386*-----------------------------------------------------------------
  6387*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6388* EFFECTIVE    NUMBER
  6389*-----------------------------------------------------------------
  6390* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6391* 092705    2005050300006  PEMA  ADD SPP LEASES
  6392* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6393* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6394* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6395* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6396* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6397******************************************************************
  6398
  6399 01  ACCOUNT-MASTER.
  6400     12  AM-RECORD-ID                      PIC XX.
  6401         88  VALID-AM-ID                      VALUE 'AM'.
  6402
  6403     12  AM-CONTROL-PRIMARY.
  6404         16  AM-COMPANY-CD                 PIC X.
  6405         16  AM-MSTR-CNTRL.
  6406             20  AM-CONTROL-A.
  6407                 24  AM-CARRIER            PIC X.
  6408                 24  AM-GROUPING.
  6409                     28 AM-GROUPING-PREFIX PIC XXX.
  6410                     28 AM-GROUPING-PRIME  PIC XXX.
  6411                 24  AM-STATE              PIC XX.
  6412                 24  AM-ACCOUNT.
  6413                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6414                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 118
* EL050.cbl
  6415             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6416                                           PIC X(19).
  6417             20  AM-CNTRL-B.
  6418                 24  AM-EXPIRATION-DT      PIC XX.
  6419                 24  FILLER                PIC X(4).
  6420             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6421                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6422
  6423     12  AM-CONTROL-BY-VAR-GRP.
  6424         16  AM-COMPANY-CD-A1              PIC X.
  6425         16  AM-VG-CARRIER                 PIC X.
  6426         16  AM-VG-GROUPING                PIC X(6).
  6427         16  AM-VG-STATE                   PIC XX.
  6428         16  AM-VG-ACCOUNT                 PIC X(10).
  6429         16  AM-VG-DATE.
  6430             20  AM-VG-EXPIRATION-DT       PIC XX.
  6431             20  FILLER                    PIC X(4).
  6432         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6433                                           PIC 9(11)      COMP-3.
  6434     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6435         16  FILLER                        PIC X(10).
  6436         16  AM-VG-KEY3.
  6437             20  AM-VG3-ACCOUNT            PIC X(10).
  6438             20  AM-VG3-EXP-DT             PIC XX.
  6439         16  FILLER                        PIC X(4).
  6440     12  AM-MAINT-INFORMATION.
  6441         16  AM-LAST-MAINT-DT              PIC XX.
  6442         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6443         16  AM-LAST-MAINT-USER            PIC X(4).
  6444         16  FILLER                        PIC XX.
  6445
  6446     12  AM-EFFECTIVE-DT                   PIC XX.
  6447     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6448
  6449     12  AM-PREV-DATES  COMP-3.
  6450         16  AM-PREV-EXP-DT                PIC 9(11).
  6451         16  AM-PREV-EFF-DT                PIC 9(11).
  6452
  6453     12  AM-REPORT-CODE-1                  PIC X(10).
  6454     12  AM-REPORT-CODE-2                  PIC X(10).
  6455
  6456     12  AM-CITY-CODE                      PIC X(4).
  6457     12  AM-COUNTY-PARISH                  PIC X(6).
  6458
  6459     12  AM-NAME                           PIC X(30).
  6460     12  AM-PERSON                         PIC X(30).
  6461     12  AM-ADDRS                          PIC X(30).
  6462     12  AM-CITY.
  6463         16  AM-ADDR-CITY                  PIC X(28).
  6464         16  AM-ADDR-STATE                 PIC XX.
  6465     12  AM-ZIP.
  6466         16  AM-ZIP-PRIME.
  6467             20  AM-ZIP-PRI-1ST            PIC X.
  6468                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6469             20  FILLER                    PIC X(4).
  6470         16  AM-ZIP-PLUS4                  PIC X(4).
  6471     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6472         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 119
* EL050.cbl
  6473         16  AM-CAN-POSTAL-2               PIC XXX.
  6474         16  FILLER                        PIC XXX.
  6475     12  AM-TEL-NO.
  6476         16  AM-AREA-CODE                  PIC 999.
  6477         16  AM-TEL-PRE                    PIC 999.
  6478         16  AM-TEL-NBR                    PIC 9(4).
  6479     12  AM-TEL-LOC                        PIC X.
  6480         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6481         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6482
  6483     12  AM-COMM-STRUCTURE.
  6484         16  AM-DEFN-1.
  6485             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6486                 24  AM-AGT.
  6487                     28  AM-AGT-PREFIX     PIC X(4).
  6488                     28  AM-AGT-PRIME      PIC X(6).
  6489                 24  AM-COM-TYP            PIC X.
  6490                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6491                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6492                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6493                 24  AM-RECALC-LV-INDIC    PIC X.
  6494                 24  AM-RETRO-LV-INDIC     PIC X.
  6495                 24  AM-GL-CODES           PIC X.
  6496                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6497                 24  FILLER                PIC X(01).
  6498         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6499             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6500                 24  FILLER                PIC X(11).
  6501                 24  AM-L-COMA             PIC XXX.
  6502                 24  AM-J-COMA             PIC XXX.
  6503                 24  AM-A-COMA             PIC XXX.
  6504                 24  FILLER                PIC X(6).
  6505
  6506     12  AM-COMM-CHANGE-STATUS             PIC X.
  6507         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6508
  6509     12  AM-CSR-CODE                       PIC X(4).
  6510
  6511     12  AM-BILLING-STATUS                 PIC X.
  6512         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6513         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6514     12  AM-AUTO-REFUND-SW                 PIC X.
  6515         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6516         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6517     12  AM-GPCD                           PIC 99.
  6518     12  AM-IG                             PIC X.
  6519         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6520         88  AM-HAS-GROUP                     VALUE '2'.
  6521     12  AM-STATUS                         PIC X.
  6522         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6523         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6524         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6525         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6526         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6527         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6528     12  AM-REMIT-TO                       PIC 99.
  6529     12  AM-ID-NO                          PIC X(11).
  6530
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 120
* EL050.cbl
  6531     12  AM-CAL-TABLE                      PIC XX.
  6532     12  AM-LF-DEVIATION                   PIC XXX.
  6533     12  AM-AH-DEVIATION                   PIC XXX.
  6534     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6535     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6536     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6537     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6538     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6539     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6540
  6541     12  AM-USER-FIELDS.
  6542         16  AM-FLD-1                      PIC XX.
  6543         16  AM-FLD-2                      PIC XX.
  6544         16  AM-FLD-3                      PIC XX.
  6545         16  AM-FLD-4                      PIC XX.
  6546         16  AM-FLD-5                      PIC XX.
  6547
  6548     12  AM-1ST-PROD-DATE.
  6549         16  AM-1ST-PROD-YR                PIC XX.
  6550         16  AM-1ST-PROD-MO                PIC XX.
  6551         16  AM-1ST-PROD-DA                PIC XX.
  6552     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6553     12  AM-CERTS-PURGED-DATE.
  6554         16  AM-PUR-YR                     PIC XX.
  6555         16  AM-PUR-MO                     PIC XX.
  6556         16  AM-PUR-DA                     PIC XX.
  6557     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6558     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6559     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6560     12  AM-INACTIVE-DATE.
  6561         16  AM-INA-MO                     PIC 99.
  6562         16  AM-INA-DA                     PIC 99.
  6563         16  AM-INA-YR                     PIC 99.
  6564     12  AM-AR-HI-CERT-DATE                PIC XX.
  6565
  6566     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6567     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6568
  6569     12  AM-OB-PAYMENT-MODE                PIC X.
  6570         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6571         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6572         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6573         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6574
  6575     12  AM-AH-ONLY-INDICATOR              PIC X.
  6576         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6577         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6578
  6579     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6580
  6581     12  AM-OVER-SHORT.
  6582         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6583         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6584
  6585     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6586     12  AM-DCC-CLP-STATE                  PIC XX.
  6587
  6588     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 121
* EL050.cbl
  6589     12  AM-RECALC-REIN                    PIC X.
  6590
  6591     12  AM-REI-TABLE                      PIC XXX.
  6592     12  AM-REI-ET-LF                      PIC X.
  6593     12  AM-REI-ET-AH                      PIC X.
  6594     12  AM-REI-PE-LF                      PIC X.
  6595     12  AM-REI-PE-AH                      PIC X.
  6596     12  AM-REI-PRT-ST                     PIC X.
  6597     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6598     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6599     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6600     12  AM-REI-GROUP-A                    PIC X(6).
  6601     12  AM-REI-MORT                       PIC X(4).
  6602     12  AM-REI-PRT-OW                     PIC X.
  6603     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6604     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6605     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6606     12  AM-REI-GROUP-B                    PIC X(6).
  6607
  6608     12  AM-TRUST-TYPE                     PIC X(2).
  6609
  6610     12  AM-EMPLOYER-STMT-USED             PIC X.
  6611     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6612
  6613     12  AM-STD-AH-TYPE                    PIC XX.
  6614     12  AM-EARN-METHODS.
  6615         16  AM-EARN-METHOD-R              PIC X.
  6616             88 AM-REF-RL-R78                 VALUE 'R'.
  6617             88 AM-REF-RL-PR                  VALUE 'P'.
  6618             88 AM-REF-RL-MEAN                VALUE 'M'.
  6619             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6620         16  AM-EARN-METHOD-L              PIC X.
  6621             88 AM-REF-LL-R78                 VALUE 'R'.
  6622             88 AM-REF-LL-PR                  VALUE 'P'.
  6623             88 AM-REF-LL-MEAN                VALUE 'M'.
  6624             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6625         16  AM-EARN-METHOD-A              PIC X.
  6626             88 AM-REF-AH-R78                 VALUE 'R'.
  6627             88 AM-REF-AH-PR                  VALUE 'P'.
  6628             88 AM-REF-AH-MEAN                VALUE 'M'.
  6629             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6630             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6631             88 AM-REF-AH-NET                 VALUE 'N'.
  6632
  6633     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6634     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6635     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6636
  6637     12  AM-RET-Y-N                        PIC X.
  6638     12  AM-RET-P-E                        PIC X.
  6639     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6640     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6641     12  AM-RET-GRP                        PIC X(6).
  6642     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6643         16  AM-POOL-PRIME                 PIC XXX.
  6644         16  AM-POOL-SUB                   PIC XXX.
  6645     12  AM-RETRO-EARNINGS.
  6646         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 122
* EL050.cbl
  6647         16  AM-RET-EARN-L                 PIC X.
  6648         16  AM-RET-EARN-A                 PIC X.
  6649     12  AM-RET-ST-TAX-USE                 PIC X.
  6650         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6651         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6652     12  AM-RETRO-BEG-EARNINGS.
  6653         16  AM-RET-BEG-EARN-R             PIC X.
  6654         16  AM-RET-BEG-EARN-L             PIC X.
  6655         16  AM-RET-BEG-EARN-A             PIC X.
  6656     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6657     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6658
  6659     12  AM-USER-SELECT-OPTIONS.
  6660         16  AM-USER-SELECT-1              PIC X(10).
  6661         16  AM-USER-SELECT-2              PIC X(10).
  6662         16  AM-USER-SELECT-3              PIC X(10).
  6663         16  AM-USER-SELECT-4              PIC X(10).
  6664         16  AM-USER-SELECT-5              PIC X(10).
  6665
  6666     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6667
  6668     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6669
  6670     12  AM-RPT045A-SWITCH                 PIC X.
  6671         88  RPT045A-OFF                   VALUE 'N'.
  6672
  6673     12  AM-INSURANCE-LIMITS.
  6674         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6675         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6676
  6677     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6678         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6679
  6680     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6681         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6682         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6683
  6684     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6685
  6686     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6687     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6688     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6689     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6690     12  AM-DCC-UEF-STATE                  PIC XX.
  6691     12  FILLER                            PIC XXX.
  6692     12  AM-REPORT-CODE-3                  PIC X(10).
  6693*    12  FILLER                            PIC X(22).
  6694
  6695     12  AM-RESERVE-DATE.
  6696         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6697         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6698         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6699
  6700     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6701     12  AM-NOTIFICATION-TYPES.
  6702         16  AM-NOTIF-OF-LETTERS           PIC X.
  6703         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6704         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 123
* EL050.cbl
  6705         16  AM-NOTIF-OF-STATUS            PIC X.
  6706
  6707     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6708         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6709         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6710         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6711         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6712
  6713     12  AM-BENEFIT-CONTROLS.
  6714         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6715             20  AM-BENEFIT-CODE           PIC XX.
  6716             20  AM-BENEFIT-TYPE           PIC X.
  6717             20  AM-BENEFIT-REVISION       PIC XXX.
  6718             20  AM-BENEFIT-REM-TERM       PIC X.
  6719             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6720             20  FILLER                    PIC XX.
  6721         16  FILLER                        PIC X(80).
  6722
  6723     12  AM-TRANSFER-DATA.
  6724         16  AM-TRANSFERRED-FROM.
  6725             20  AM-TRNFROM-CARRIER        PIC X.
  6726             20  AM-TRNFROM-GROUPING.
  6727                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6728                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6729             20  AM-TRNFROM-STATE          PIC XX.
  6730             20  AM-TRNFROM-ACCOUNT.
  6731                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6732                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6733             20  AM-TRNFROM-DTE            PIC XX.
  6734         16  AM-TRANSFERRED-TO.
  6735             20  AM-TRNTO-CARRIER          PIC X.
  6736             20  AM-TRNTO-GROUPING.
  6737                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6738                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6739             20  AM-TRNTO-STATE            PIC XX.
  6740             20  AM-TRNTO-ACCOUNT.
  6741                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6742                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6743             20  AM-TRNTO-DTE              PIC XX.
  6744         16  FILLER                        PIC X(10).
  6745
  6746     12  AM-SAVED-REMIT-TO                 PIC 99.
  6747
  6748     12  AM-COMM-STRUCTURE-SAVED.
  6749         16  AM-DEFN-1-SAVED.
  6750             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6751                 24  AM-AGT-SV             PIC X(10).
  6752                 24  AM-COM-TYP-SV         PIC X.
  6753                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6754                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6755                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6756                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6757                 24  FILLER                PIC X.
  6758                 24  AM-GL-CODES-SV        PIC X.
  6759                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6760                 24  FILLER                PIC X.
  6761         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6762             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 124
* EL050.cbl
  6763                 24  FILLER                PIC X(11).
  6764                 24  AM-L-COMA-SV          PIC XXX.
  6765                 24  AM-J-COMA-SV          PIC XXX.
  6766                 24  AM-A-COMA-SV          PIC XXX.
  6767                 24  FILLER                PIC X(6).
  6768
  6769     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6770         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6771            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6772            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6773            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6774
  6775     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6776     12  FILLER                            PIC X(120).
  6777
  6778     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6779         16  AM-CONTROL-NAME               PIC X(30).
  6780         16  AM-EXECUTIVE-ONE.
  6781             20  AM-EXEC1-NAME             PIC X(15).
  6782             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6783                                                          COMP-3.
  6784             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6785                                                          COMP-3.
  6786         16  AM-EXECUTIVE-TWO.
  6787             20  AM-EXEC2-NAME             PIC X(15).
  6788             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6789                                                          COMP-3.
  6790             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6791                                                          COMP-3.
  6792
  6793     12  AM-RETRO-ADDITIONAL-DATA.
  6794         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6795         16  AM-RETRO-PREM-P-E             PIC X.
  6796         16  AM-RETRO-CLMS-P-I             PIC X.
  6797         16  AM-RETRO-RET-BRACKET-LF.
  6798             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6799                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6800                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6801             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6802                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6803                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6804             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6805                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6806                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6807         16  AM-RETRO-RET-BRACKET-AH.
  6808             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6809                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6810                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6811                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6812             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6813                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6814                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6815             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6816                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6817                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6818
  6819     12  AM-COMMENTS.
  6820         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 125
* EL050.cbl
  6821
  6822     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6823         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6824         16  AM-FLI-BILLING-CODE           PIC X.
  6825         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6826         16  AM-FLI-UNITED-IDENT           PIC X.
  6827         16  AM-FLI-INTEREST-LOST-DATA.
  6828             20  AM-FLI-BANK-NO            PIC X(5).
  6829             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6830             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6831             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6832         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6833             20  AM-FLI-AGT                PIC X(9).
  6834             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6835             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6836         16  FILLER                        PIC X(102).
  6837
  6838     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6839         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6840             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6841             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6842             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6843             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6844             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6845         16  FILLER                          PIC X(10).
  6846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 126
* EL050.cbl
  6848*    COPY ERCREIN.
  6849******************************************************************
  6850*                                                                *
  6851*                            ERCREIN                             *
  6852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6853*                            VMOD=2.010                          *
  6854*                                                                *
  6855*   ONLINE CREDIT SYSTEM                                         *
  6856*                                                                *
  6857*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6858*                                                                *
  6859*   FILE TYPE = VSAM,KSDS                                        *
  6860*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6861*                                                                *
  6862*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6863*       ALTERNATE PATH = NONE                                    *
  6864*                                                                *
  6865*   LOG = NO                                                     *
  6866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6867*                                                                *
  6868******************************************************************
  6869*                   C H A N G E   L O G
  6870*
  6871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6872*-----------------------------------------------------------------
  6873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6874* EFFECTIVE    NUMBER
  6875*-----------------------------------------------------------------
  6876* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6877* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6878******************************************************************
  6879 01  REINSURANCE-RECORD.
  6880     12  RE-RECORD-ID                      PIC XX.
  6881         88  VALID-RE-ID                      VALUE 'RE'.
  6882
  6883     12  RE-CONTROL-PRIMARY.
  6884         16  RE-COMPANY-CD                 PIC X.
  6885         16  RE-KEY.
  6886             20  RE-CODE                   PIC X.
  6887                 88  RE-TABLE-RECORD          VALUE 'A'.
  6888                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6889             20  RE-TABLE                  PIC XXX.
  6890             20  FILLER                    PIC XXX.
  6891         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6892             20  FILLER                    PIC X.
  6893             20  RE-COMPANY.
  6894                 24  RE-COMP-PRIME         PIC XXX.
  6895                 24  RE-COMP-SUB           PIC XXX.
  6896
  6897     12  RE-MAINT-INFORMATION.
  6898         16  RE-LAST-MAINT-DT              PIC XX.
  6899         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6900         16  RE-LAST-MAINT-USER            PIC X(4).
  6901         16  FILLER                        PIC X(10).
  6902
  6903     12  RE-TABLE-DATA.
  6904         16  RE-100-COMP                   PIC 99.
  6905
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 127
* EL050.cbl
  6906         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6907             20  RE-REI-COMP-NO.
  6908                 24  RE-REI-COMP           PIC XXX.
  6909                 24  RE-REI-COMP-SUB       PIC XXX.
  6910             20  RE-LF-QC                  PIC X.
  6911             20  RE-AH-QC                  PIC X.
  6912             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6913             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6914             20  RE-LFAGE-LO               PIC 99.
  6915             20  RE-LFAGE-HI               PIC 99.
  6916             20  RE-AHAGE-LO               PIC 99.
  6917             20  RE-AHAGE-HI               PIC 99.
  6918             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6919             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6920             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6921             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6922             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6923             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6924             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6925             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6926             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6927             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6928             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6929             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6930             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6931             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6932             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6933             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6934             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6935             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6936             20  RE-LF-BEN-CODE            PIC X.
  6937             20  RE-AH-BEN-CODE            PIC X.
  6938             20  RE-INTERACTIVE            PIC X.
  6939             20  RE-REMAINING              PIC X.
  6940             20  RE-LF-RUNOFF-SW           PIC X.
  6941             20  RE-AH-RUNOFF-SW           PIC X.
  6942             20  FILLER                    PIC X(19).
  6943
  6944         16  RE-COMP-INFO-END              PIC X(6).
  6945         16  RE-NSP-ST-CD-LF               PIC XX.
  6946         16  RE-NSP-ST-CD-AH               PIC XX.
  6947         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6948             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6949
  6950         16  FILLER                        PIC X(27).
  6951
  6952     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6953         16  RE-NAME                       PIC X(30).
  6954         16  RE-LF-PE                      PIC X.
  6955         16  RE-AH-PE                      PIC X.
  6956         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6957         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6958         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6959         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6960         16  RE-PRT-ST                     PIC X.
  6961         16  RE-PRT-OW                     PIC X.
  6962         16  RE-MORT-CODE                  PIC X(4).
  6963         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 128
* EL050.cbl
  6964         16  RE-ZERO-LF-FEE                PIC X.
  6965         16  RE-ZERO-AH-FEE                PIC X.
  6966         16  RE-CEDE-NAME                  PIC X(30).
  6967         16  RE-LF-COMM                    PIC X.
  6968         16  RE-AH-COMM                    PIC X.
  6969         16  RE-LF-TAX                     PIC X.
  6970         16  RE-AH-TAX                     PIC X.
  6971         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6972         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6973         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6974
  6975         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6976             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6977
  6978         16  RE-LF-CEDING-FEE-BRACKETS.
  6979             20  RE-LF-FEE-METHOD          PIC X.
  6980                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6981                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6982                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6983                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6984             20  RE-LF-FEE-BASIS           PIC X.
  6985                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6986                 88  RE-LF-NET-CEDED               VALUE '2'.
  6987                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6988                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6989                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6990                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6991                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6992                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6993             20  FILLER                    PIC XXX.
  6994             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6995                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6996                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6997
  6998         16  RE-AH-CEDING-FEE-BRACKETS.
  6999             20  RE-AH-FEE-METHOD          PIC X.
  7000                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7001                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7002                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7003                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7004             20  RE-AH-FEE-BASIS           PIC X.
  7005                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7006                 88  RE-AH-NET-CEDED               VALUE '2'.
  7007                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7008                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7009                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7010                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7011                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7012                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7013             20  FILLER                    PIC XXX.
  7014             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7015                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7016                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7017
  7018         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7019
  7020         16  RE-OLD-CEDING-STMT            PIC X.
  7021
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 129
* EL050.cbl
  7022         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7023         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7024         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7025         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7026         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7027         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7028         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7029         16  RE-MORT-SW                    PIC X.
  7030         16  RE-CEDING-TYPE-FLAG           PIC X.
  7031             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7032             88  RE-CEDED                          VALUE 'C'.
  7033             88  RE-ASSUMED                        VALUE 'A'.
  7034             88  RE-PHANTOM                        VALUE 'P'.
  7035
  7036         16  RE-CEDING-STMT-OPT-A          PIC X.
  7037             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7038         16  RE-CEDING-STMT-OPT-B          PIC X.
  7039             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7040         16  RE-CEDING-STMT-OPT-C          PIC X.
  7041             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7042         16  RE-CEDING-STMT-OPT-D          PIC X.
  7043             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7044         16  RE-CEDING-STMT-OPT-E          PIC X.
  7045             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7046
  7047         16  RE-PRT-CRSV                   PIC X.
  7048
  7049         16  RE-GL-CENTER                  PIC X(4).
  7050
  7051         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7052
  7053         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7054
  7055         16  RE-EARN-STOP-CODE             PIC X.
  7056             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7057             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7058
  7059         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7060             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7061
  7062         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7063         16  FILLER                        PIC X(2281).
  7064
  7065         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7066
  7067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 130
* EL050.cbl
  7069*    COPY ERCCTBL.
  7070******************************************************************
  7071*                                                                *
  7072*                                                                *
  7073*                            ERCCTBL                             *
  7074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7075*                            VMOD=2.003
  7076*                                                                *
  7077*   ONLINE CREDIT SYSTEM                                         *
  7078*                                                                *
  7079*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7083*                                                                *
  7084*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7085*       ALTERNATE PATH = NONE                                    *
  7086*                                                                *
  7087*   LOG = NO                                                     *
  7088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7089*                                                                *
  7090*                                                                *
  7091******************************************************************
  7092
  7093 01  COMM-TABLE-RECORD.
  7094     12  CT-RECORD-ID                      PIC XX.
  7095         88  VALID-CT-ID                      VALUE 'CT'.
  7096
  7097     12  CT-CONTROL-PRIMARY.
  7098         16  CT-COMPANY-CD                 PIC X.
  7099         16  CT-TABLE                      PIC XXX.
  7100         16  CT-CNTRL-2.
  7101             20  CT-BEN-TYPE               PIC X.
  7102             20  CT-BEN-CODE               PIC XX.
  7103
  7104     12  CT-MAINT-INFORMATION.
  7105         16  CT-LAST-MAINT-DT              PIC XX.
  7106         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7107         16  CT-LAST-MAINT-USER            PIC X(4).
  7108         16  FILLER                        PIC X(31).
  7109
  7110     12  CT-LIMITS.
  7111         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7112
  7113         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7114
  7115         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7116
  7117     12  CT-RATES.
  7118         16  CT-RTX          OCCURS 27 TIMES.
  7119             20  CT-RT                     PIC SV9(5)     COMP-3.
  7120             20  CT-RT-R   REDEFINES
  7121                 CT-RT                     PIC XXX.
  7122
  7123     12  FILLER                            PIC  X(42).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 131
* EL050.cbl
  7127*    COPY ERCFORM.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCFORM.                            *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003                          *
  7134*                                                                *
  7135*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7136*                                                                *
  7137*    FILE TYPE = VSAM,KSDS                                       *
  7138*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7139*                                                                *
  7140*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7141*                                                                *
  7142*    LOG = YES                                                   *
  7143*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7144******************************************************************
  7145 01  FORM-MASTER.
  7146    12  FO-RECORD-ID                 PIC X(02).
  7147        88  VALID-FO-ID                  VALUE 'FO'.
  7148
  7149    12  FO-CONTROL-PRIMARY.
  7150        16  FO-COMPANY-CD            PIC X(01).
  7151        16  FO-STATE                 PIC X(02).
  7152        16  FO-FORM-ID               PIC X(12).
  7153        16  FO-FORM-EXP-DT           PIC X(02).
  7154
  7155    12  FO-POLICY-FORM-DATA.
  7156        16  FO-IND-GRP-CD            PIC X(01).
  7157        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7158        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7159        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7160        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7161        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7162        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7163        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7164        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7165        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7166        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7167        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7168        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7169        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7170        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7171        16  FO-APP-CERT-USE-CD       PIC X(01).
  7172
  7173    12  FILLER                       PIC X(29).
  7174
  7175    12  FO-FORM-PLAN-TABLE.
  7176        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7177            20  FO-PLAN-TYPE         PIC X(01).
  7178            20  FO-PLAN-ID           PIC X(02).
  7179            20  FO-PLAN-TERM         PIC 9(03).
  7180            20  FO-PLAN-REFUND-METHOD
  7181                                     PIC X.
  7182
  7183    12  FILLER                       PIC X(30).
  7184
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 132
* EL050.cbl
  7185    12  FO-COMMENTS-AREA.
  7186        16  FO-COMMENT-LINE-1        PIC X(78).
  7187
  7188    12  FILLER                       PIC X(20).
  7189
  7190    12  FO-MAINT-INFORMATION.
  7191        16  FO-LAST-MAINT-DT         PIC X(02).
  7192        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7193        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 133
* EL050.cbl
  7195*    COPY ELCMSTR.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCMSTR.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.012                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7206*                                                                *
  7207*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7208*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7209*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7210*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7211*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7212*                                                 RKP=75,LEN=21  *
  7213*                                                                *
  7214*   **** NOTE ****                                               *
  7215*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7216*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220******************************************************************
  7221*                   C H A N G E   L O G
  7222*
  7223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7224*-----------------------------------------------------------------
  7225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7226* EFFECTIVE    NUMBER
  7227*-----------------------------------------------------------------
  7228* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7229* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7230******************************************************************
  7231 01  CLAIM-MASTER.
  7232     12  CL-RECORD-ID                PIC XX.
  7233         88  VALID-CL-ID         VALUE 'CL'.
  7234
  7235     12  CL-CONTROL-PRIMARY.
  7236         16  CL-COMPANY-CD           PIC X.
  7237         16  CL-CARRIER              PIC X.
  7238         16  CL-CLAIM-NO             PIC X(7).
  7239         16  CL-CERT-NO.
  7240             20  CL-CERT-PRIME       PIC X(10).
  7241             20  CL-CERT-SFX         PIC X.
  7242
  7243     12  CL-CONTROL-BY-NAME.
  7244         16  CL-COMPANY-CD-A1        PIC X.
  7245         16  CL-INSURED-LAST-NAME    PIC X(15).
  7246         16  CL-INSURED-NAME.
  7247             20  CL-INSURED-1ST-NAME PIC X(12).
  7248             20  CL-INSURED-MID-INIT PIC X.
  7249
  7250     12  CL-CONTROL-BY-SSN.
  7251         16  CL-COMPANY-CD-A2        PIC X.
  7252         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 134
* EL050.cbl
  7253             20  CL-SSN-STATE        PIC XX.
  7254             20  CL-SSN-ACCOUNT      PIC X(6).
  7255             20  CL-SSN-LN3          PIC X(3).
  7256
  7257     12  CL-CONTROL-BY-CERT-NO.
  7258         16  CL-COMPANY-CD-A4        PIC X.
  7259         16  CL-CERT-NO-A4.
  7260             20  CL-CERT-A4-PRIME    PIC X(10).
  7261             20  CL-CERT-A4-SFX      PIC X.
  7262
  7263     12  CL-CONTROL-BY-CCN.
  7264         16  CL-COMPANY-CD-A5        PIC X.
  7265         16  CL-CCN-A5.
  7266             20  CL-CCN.
  7267                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7268                 24  CL-CCN-PRIME-A5 PIC X(12).
  7269             20  CL-CCN-FILLER-A5    PIC X(4).
  7270
  7271     12  CL-INSURED-PROFILE-DATA.
  7272         16  CL-INSURED-BIRTH-DT     PIC XX.
  7273         16  CL-INSURED-SEX-CD       PIC X.
  7274             88  INSURED-IS-MALE        VALUE 'M'.
  7275             88  INSURED-IS-FEMALE      VALUE 'F'.
  7276             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7277         16  CL-INSURED-OCC-CD       PIC X(6).
  7278         16  FILLER                  PIC X(5).
  7279
  7280     12  CL-PROCESSING-INFO.
  7281         16  CL-PROCESSOR-ID         PIC X(4).
  7282         16  CL-CLAIM-STATUS         PIC X.
  7283             88  CLAIM-IS-OPEN          VALUE 'O'.
  7284             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7285         16  CL-CLAIM-TYPE           PIC X.
  7286*            88  AH-CLAIM               VALUE 'A'.
  7287*            88  LIFE-CLAIM             VALUE 'L'.
  7288*            88  PROPERTY-CLAIM         VALUE 'P'.
  7289*            88  IUI-CLAIM              VALUE 'I'.
  7290*            88  GAP-CLAIM              VALUE 'G'.
  7291         16  CL-CLAIM-PREM-TYPE      PIC X.
  7292             88  SINGLE-PREMIUM         VALUE '1'.
  7293             88  O-B-COVERAGE           VALUE '2'.
  7294             88  OPEN-END-COVERAGE      VALUE '3'.
  7295         16  CL-INCURRED-DT          PIC XX.
  7296         16  CL-REPORTED-DT          PIC XX.
  7297         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7298         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7299         16  CL-LAST-PMT-DT          PIC XX.
  7300         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7301         16  CL-PAID-THRU-DT         PIC XX.
  7302         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7303         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7304         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7305         16  CL-PMT-CALC-METHOD      PIC X.
  7306             88  CL-360-DAY-YR          VALUE '1'.
  7307             88  CL-365-DAY-YR          VALUE '2'.
  7308             88  CL-FULL-MONTHS         VALUE '3'.
  7309         16  CL-CAUSE-CD             PIC X(6).
  7310
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 135
* EL050.cbl
  7311         16  CL-PRIME-CERT-NO.
  7312             20  CL-PRIME-CERT-PRIME PIC X(10).
  7313             20  CL-PRIME-CERT-SFX   PIC X.
  7314
  7315         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7316             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7317             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7318
  7319         16  CL-MICROFILM-NO         PIC X(10).
  7320         16  CL-PROG-FORM-TYPE       PIC X.
  7321         16  CL-LAST-ADD-ON-DT       PIC XX.
  7322
  7323         16  CL-LAST-REOPEN-DT       PIC XX.
  7324         16  CL-LAST-CLOSE-DT        PIC XX.
  7325         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7326             88  FINAL-PAID             VALUE '1'.
  7327             88  CLAIM-DENIED           VALUE '2'.
  7328             88  AUTO-CLOSE             VALUE '3'.
  7329             88  MANUAL-CLOSE           VALUE '4'.
  7330             88  BENEFITS-CHANGED       VALUE 'C'.
  7331             88  SETUP-ERRORS           VALUE 'E'.
  7332         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7333         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7334         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7335             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7336         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7337         16  FILLER                  PIC X.
  7338
  7339     12  CL-CERTIFICATE-DATA.
  7340         16  CL-CERT-ORIGIN          PIC X.
  7341             88  CERT-WAS-ONLINE        VALUE '1'.
  7342             88  CERT-WAS-CREATED       VALUE '2'.
  7343             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7344         16  CL-CERT-KEY-DATA.
  7345             20  CL-CERT-CARRIER     PIC X.
  7346             20  CL-CERT-GROUPING    PIC X(6).
  7347             20  CL-CERT-STATE       PIC XX.
  7348             20  CL-CERT-ACCOUNT.
  7349                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7350                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7351             20  CL-CERT-EFF-DT      PIC XX.
  7352
  7353     12  CL-STATUS-CONTROLS.
  7354         16  CL-PRIORITY-CD          PIC X.
  7355             88  CONFIDENTIAL-DATA      VALUE '8'.
  7356             88  HIGHEST-PRIORITY       VALUE '9'.
  7357         16  CL-SUPV-ATTN-CD         PIC X.
  7358             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7359             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7360         16  CL-PURGED-DT            PIC XX.
  7361         16  CL-RESTORED-DT          PIC XX.
  7362         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7363         16  CL-NEXT-RESEND-DT       PIC XX.
  7364         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7365         16  FILLER                  PIC XX.
  7366         16  CL-LAST-MAINT-DT        PIC XX.
  7367         16  CL-LAST-MAINT-USER      PIC X(4).
  7368         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 136
* EL050.cbl
  7369         16  CL-LAST-MAINT-TYPE      PIC X.
  7370             88  CLAIM-SET-UP           VALUE ' '.
  7371             88  PAYMENT-MADE           VALUE '1'.
  7372             88  LETTER-SENT            VALUE '2'.
  7373             88  MASTER-WAS-ALTERED     VALUE '3'.
  7374             88  MASTER-WAS-RESTORED    VALUE '4'.
  7375             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7376             88  FILE-CONVERTED         VALUE '6'.
  7377             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7378             88  ERROR-CORRECTION       VALUE 'E'.
  7379         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7380         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7381         16  CL-BENEFICIARY          PIC X(10).
  7382         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7383         16  CL-DENIAL-TYPE          PIC X.
  7384             88  CL-TYPE-DENIAL          VALUE '1'.
  7385             88  CL-TYPE-RESCISSION      VALUE '2'.
  7386             88  CL-TYPE-REFORMATION     VALUE '3'.
  7387             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7388             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7389         16  FILLER                  PIC X(5).
  7390
  7391     12  CL-TRAILER-CONTROLS.
  7392         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7393             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7394             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7395             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7396         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7397         16  FILLER                  PIC XX.
  7398         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7399         16  CL-ADDRESS-TRAILER-CNT.
  7400             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7401                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7402             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7403                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7404             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7405                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7406             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7407                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7408             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7409                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7410             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7411                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7412             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7413                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7414
  7415     12  CL-CV-REFERENCE-NO.
  7416         16  CL-CV-REFNO-PRIME       PIC X(18).
  7417         16  CL-CV-REFNO-SFX         PIC XX.
  7418
  7419     12  CL-FILE-LOCATION            PIC X(4).
  7420
  7421     12  CL-PROCESS-ERRORS.
  7422         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7423             88  NO-FATAL-ERRORS        VALUE ZERO.
  7424         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7425             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7426
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 137
* EL050.cbl
  7427     12  CL-PRODUCT-CD               PIC X.
  7428
  7429     12  CL-CURRENT-KEY-DATA.
  7430         16  CL-CURRENT-CARRIER      PIC X.
  7431         16  CL-CURRENT-GROUPING     PIC X(6).
  7432         16  CL-CURRENT-STATE        PIC XX.
  7433         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7434
  7435     12  CL-ASSOCIATES               PIC X.
  7436         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7437         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7438         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7439         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7440
  7441     12  CL-ACTIVITY-CODE            PIC 99.
  7442     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7443     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7444
  7445     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7446     12  CL-LAG-REPORT-CODE          PIC 9.
  7447     12  CL-LOAN-TYPE                PIC XX.
  7448     12  CL-LEGAL-STATE              PIC XX.
  7449
  7450*    12  FILLER                      PIC X(5).
  7451     12  CL-YESNOSW                  PIC X.
  7452     12  FILLER                      PIC X(4).
  7453
  7454 01  PLAN-RECORDS.
  7455     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7456     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7457
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 138
* EL050.cbl
  7459 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7460                          ACCOUNT-MASTER REINSURANCE-RECORD
  7461                          COMM-TABLE-RECORD FORM-MASTER
  7462                          CLAIM-MASTER PLAN-RECORDS.
  7463 0000-DFHEXIT SECTION.
  7464     MOVE '9#                    $   ' TO DFHEIV0.
  7465     MOVE 'EL050' TO DFHEIV1.
  7466     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7467
  7468     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7469
  7470
  7471* EXEC CICS  HANDLE CONDITION
  7472*           ERROR    (9300-ABEND)
  7473*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7474*    END-EXEC.
  7475*    MOVE '"$.J                  ! " #00007466' TO DFHEIV0
  7476     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7478     MOVE X'2220233030303037343636' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7481
  7482
  7483 0000-COPY-PROCEDURE-DIV.
  7484*                          COPY ELC50PD.
  7485******************************************************************
  7486*                                                                *
  7487*                            ELC50PD                             *
  7488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7489*                            VMOD=2.188                          *
  7490*                                                                *
  7491******************************************************************
  7492*                   C H A N G E   L O G
  7493*
  7494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7495*-----------------------------------------------------------------
  7496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7497* EFFECTIVE    NUMBER
  7498*-----------------------------------------------------------------
  7499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7500* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7501* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7502*                             2709 AND 2718
  7503* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7504* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7505* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7507* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7508*                                IS OPEN OR CNC DT < PD THRU
  7509* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7510* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7511* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7512* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7513* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7514* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7515* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7516* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 139
* EL050.cbl
  7517* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7518* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7519* 020906                   PEMA  EXPAND LOAN OFFICER
  7520* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7521* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7522* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7523* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7524* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7525* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7526* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7527* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7528* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7529* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7530* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7531* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7532* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7533* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7534* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7535* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7536* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7537* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7538* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7539* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7540* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7541* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7542* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7543* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7544* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7545*                                UPDATE VIN ON CERT TRAILER
  7546* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7547* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7548* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7549* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7550* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7551* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7552* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7553* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7554* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7555* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7556* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7557* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7558* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7559* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7560* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7561* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7562* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7563* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7564* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7565* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7566* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7567* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7568* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7569* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7570* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7571* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7572* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7573* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7574* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 140
* EL050.cbl
  7575* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7576* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7577* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7578* 032912  CR2011110200001  PEMA  AHL CHANGES
  7579* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7580* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7581* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7582* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7583* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7584* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7585* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7586* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7587******************************************************************
  7588************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7589******************************************************************
  7590
  7591     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7592
  7593     MOVE SPACES                 TO PB-FATAL-FLAG
  7594                                    PB-FORCE-ER-CD
  7595                                    PB-WARN-ER-CD
  7596                                    PB-OUT-BAL-CD.
  7597
  7598     MOVE SPACE                  TO WS-IG-OVRD-AH
  7599                                    WS-IG-OVRD-LF
  7600                                    WS-IG-OVRD-AM
  7601                                    WS-IG-OVRD
  7602                                    WS-IG-OVRD-AH-PL
  7603                                    WS-IG-OVRD-LF-PL
  7604                                    WS-IG-OVRD-AH-BEN
  7605                                    WS-IG-OVRD-LF-BEN.
  7606
  7607******************************************************************
  7608*************       INITIALIZE COMMON ERRORS       ***************
  7609******************************************************************
  7610
  7611     MOVE +0                     TO PB-NO-OF-ERRORS.
  7612     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7613
  7614******************************************************************
  7615
  7616     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7617     SET JULIAN-TO-BIN           TO TRUE.
  7618*    MOVE 5                      TO DC-OPTION-CODE.
  7619     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7620     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7621
  7622     MOVE ZERO                   TO  SUB4.
  7623
  7624 0040-INITIALIZE-GA-BILL-DT.
  7625
  7626     ADD +1                      TO  SUB4.
  7627
  7628     IF  SUB4 GREATER THAN +5
  7629         GO TO 0050-CHECK-CNTL-FOUND.
  7630
  7631     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7632         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 141
* EL050.cbl
  7633
  7634     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7635
  7636 0050-CHECK-CNTL-FOUND.
  7637
  7638     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7639        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7640                                         WS-AH-REM-TERM-CALC
  7641                                         EC-CO-REM-TERM-CALC
  7642        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7643        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7644        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7645                                         WS-TOL-AH-CLAIM
  7646        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7647                                         WS-TOL-AH-PREM
  7648                                         EC-CO-TOL-PREM
  7649        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7650                                         WS-TOL-AH-REFUND
  7651                                         EC-CO-TOL-REFUND
  7652        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7653                                         WS-AH-REFUND-OVS-AMT
  7654                                         EC-CO-OVR-SHT-AMT
  7655        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7656                                         WS-TOL-AH-PREM-PCT
  7657                                         EC-CO-TOL-PREM-PCT
  7658        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7659                                         WS-TOL-AH-REFUND-PCT
  7660                                         EC-CO-TOL-REFUND-PCT
  7661        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7662                                         WS-AH-REFUND-OVS-PCT
  7663                                         EC-CO-OVR-SHT-PCT
  7664        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7665        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7666        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7667        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7668        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7669        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7670        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7671        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7672        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7673        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7674        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7675        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7676                                         EC-CO-MONTH-END-DT
  7677        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7678          GO TO 0100-READ-ACCT.
  7679
  7680     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7681     MOVE SPACES                 TO CNTL-ACCESS.
  7682     MOVE '1'                    TO CNTL-REC-TYPE.
  7683     MOVE +0                     TO CNTL-SEQ-NO.
  7684
  7685     MOVE '1' TO RC-SW-1.
  7686     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7687     IF NOT CF-COMPANY-MASTER
  7688         MOVE ZEROS             TO WK-CO-TOL-PREM
  7689                                   WK-CO-TOL-CLAIM
  7690                                   WK-CO-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 142
* EL050.cbl
  7691                                   WK-REFUND-OVS-AMT
  7692                                   WK-REFUND-OVS-PCT
  7693                                   WK-CO-TOL-PREM-PCT
  7694                                   WK-CO-TOL-REFUND-PCT
  7695                                   WK-DEFAULT-APR
  7696                                   WK-CO-MAX-CAP
  7697        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7698                                   WK-CR-R78-METHOD
  7699                                   WK-CO-REF-REJECT-SW
  7700                                   WK-CO-PREM-REJECT-SW
  7701                                   WK-REM-TRM-CALC-OPTION
  7702                                   WK-BIRTH-DATE-INPUT
  7703                                   WK-JOINT-AGE-INPUT
  7704        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7705        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7706        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7707        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7708          GO TO 0099-COMPANY-NOT-FOUND.
  7709
  7710     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7711        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7712     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7713        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7714     IF CF-CO-TOL-CAP NOT NUMERIC
  7715        MOVE +0                    TO CF-CO-TOL-CAP.
  7716     IF CF-DEFAULT-APR NOT NUMERIC
  7717        MOVE +0                    TO CF-DEFAULT-APR.
  7718
  7719     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7720     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7721     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7722     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7723     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7724     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7725     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7726     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7727     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7728     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7729     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7730     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7731
  7732     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7733          CF-CO-OVR-SHT-AMT > +0
  7734        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7735
  7736     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7737          CF-CO-OVR-SHT-PCT > +0
  7738        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7739
  7740     IF CF-VALID-REM-TRM-OPTION
  7741         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7742     ELSE
  7743         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7744
  7745     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7746     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7747     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7748     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 143
* EL050.cbl
  7749
  7750     GO TO 0050-CHECK-CNTL-FOUND.
  7751
  7752 0099-COMPANY-NOT-FOUND.
  7753
  7754     MOVE ER-2616                TO WS-ERROR.
  7755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7756
  7757 0100-READ-ACCT.
  7758
  7759     MOVE SPACES                 TO DATE-RANGE-SW.
  7760
  7761     IF WK-ACCT-ADDR = ZEROS
  7762        GO TO 0102-ACCT-GETMAIN.
  7763
  7764     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7765     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7766     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7767
  7768     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7769        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7770        GO TO 0105-READ-ACCT
  7771     END-IF
  7772
  7773     IF PB-CARRIER NOT = SPACES
  7774        IF PB-CARRIER NOT = AM-VG-CARRIER
  7775           GO TO 0105-READ-ACCT.
  7776
  7777     IF PB-STATE NOT = SPACES
  7778        IF PB-STATE NOT = AM-VG-STATE
  7779           GO TO 0105-READ-ACCT.
  7780
  7781     IF PB-GROUPING NOT = SPACES
  7782        IF PB-GROUPING NOT = AM-VG-GROUPING
  7783           GO TO 0105-READ-ACCT.
  7784
  7785     MOVE 'X'                 TO DATE-RANGE-SW.
  7786
  7787     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7788        MOVE 'X'                 TO DATE-RANGE-SW
  7789        GO TO 0105-READ-ACCT.
  7790
  7791     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7792        GO TO 0105-READ-ACCT.
  7793
  7794     GO TO 0180-ACCOUNT-FOUND.
  7795
  7796 0102-ACCT-GETMAIN.
  7797     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7798     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7799
  7800 0105-READ-ACCT.
  7801     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7802     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7803     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7804     MOVE PB-STATE               TO ACCT-STATE.
  7805     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7806     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 144
* EL050.cbl
  7807
  7808     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7809
  7810     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7811
  7812 0110-FIND-ACCT-TOLERANCES-LOOP.
  7813     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7814
  7815     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7816        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7817        GO TO 0199-ACCT-NOT-FOUND
  7818     END-IF
  7819     IF PB-CARRIER NOT = SPACES
  7820        IF PB-CARRIER NOT = AM-VG-CARRIER
  7821           GO TO 0199-ACCT-NOT-FOUND.
  7822
  7823     IF PB-STATE NOT = SPACES
  7824        IF PB-STATE NOT = AM-VG-STATE
  7825           GO TO 0199-ACCT-NOT-FOUND.
  7826
  7827     IF PB-GROUPING NOT = SPACES
  7828        IF PB-GROUPING NOT = AM-VG-GROUPING
  7829           GO TO 0199-ACCT-NOT-FOUND.
  7830
  7831     MOVE 'X'                    TO DATE-RANGE-SW.
  7832
  7833     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7834        MOVE 'X'                 TO DATE-RANGE-SW
  7835        GO TO 0199-ACCT-NOT-FOUND.
  7836
  7837     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7838        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7839
  7840 0180-ACCOUNT-FOUND.
  7841     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7842     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7843     MOVE AM-STATE               TO PB-SV-STATE.
  7844     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7845
  7846     IF AM-CANCEL-FEE  NOT NUMERIC
  7847        MOVE ZEROS TO AM-CANCEL-FEE.
  7848
  7849     IF AM-MAX-MON-BEN NOT NUMERIC
  7850        MOVE ZEROS TO AM-MAX-MON-BEN.
  7851
  7852     IF AM-MAX-TOT-BEN NOT NUMERIC
  7853        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7854
  7855     IF AM-CLP-TOL-PCT NOT NUMERIC
  7856        MOVE +0                  TO AM-CLP-TOL-PCT
  7857     END-IF
  7858     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7859        MOVE +0                  TO AM-SPP-LEASE-COMM
  7860     END-IF
  7861     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7862        MOVE ER-2611             TO   WS-ERROR
  7863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7864
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 145
* EL050.cbl
  7865     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7866        MOVE ER-2621             TO   WS-ERROR
  7867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7868
  7869     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7870        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7871        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7872        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7873         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7874
  7875     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7876     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7877     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7878     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7879     IF AM-CLP-TOL-PCT NOT = ZEROS
  7880        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7881     END-IF
  7882     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7883        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7884     END-IF
  7885*    IF PB-COMPANY-ID = 'DCC'
  7886*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7887*                                   WS-ADMIN-FEES
  7888*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7889*          (SUB5 > +10)
  7890*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7891*             AND (AM-A-COM (SUB5) NUMERIC)
  7892*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7893*                + (AM-A-COM (SUB5) * 1000)
  7894*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7895*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7896*                + (AM-A-COM (SUB5) * 1000)
  7897*             END-IF
  7898*             IF AM-COM-TYP (SUB5) = 'N'
  7899*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7900*                + (AM-A-COM (SUB5) * 1000)
  7901*             END-IF
  7902*          END-IF
  7903*       END-PERFORM
  7904*    END-IF
  7905     IF (PB-COMPANY-ID = 'DCC')
  7906        AND (PB-ISSUE)
  7907        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7908        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7909           (SUB5 > +10)
  7910           MOVE +0 TO WS-WK-RATE
  7911           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7912              IF (AM-A-COM (SUB5) NUMERIC)
  7913                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7914                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7915              ELSE
  7916                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7917                 IF PB-ISSUE
  7918                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7919                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7920                 ELSE
  7921                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7922                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 146
* EL050.cbl
  7923                 END-IF
  7924                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7925                 MOVE ZEROS             TO WS-SUB1
  7926                                           WS-COMMISSION
  7927                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7928                 MOVE '0530'               TO CTBL-SW
  7929                 MOVE ' '                  TO WS-CTBL-READ-SW
  7930                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7931                 IF FIRST-TIME-THROUGH
  7932                    MOVE 'AA'              TO CTBL-BEN-CODE
  7933                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7934                 END-IF
  7935                 IF CTBL-TABLE-FOUND
  7936                    IF PB-ISSUE
  7937                       COMPUTE WS-COMM-CK-AMT =
  7938                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7939                    ELSE
  7940                       COMPUTE WS-COMM-CK-AMT =
  7941                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7942                    END-IF
  7943                    PERFORM 8800-GET-COMP-RATE
  7944                              THRU 8800-EXIT
  7945                 END-IF
  7946              END-IF
  7947              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7948                + (WS-WK-RATE * 1000)
  7949           END-IF
  7950        END-PERFORM
  7951     END-IF
  7952     IF PB-COMPANY-ID EQUAL 'CRI'
  7953         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7954
  7955     IF PB-COMPANY-ID EQUAL 'NCL'
  7956         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7957     END-IF
  7958
  7959     GO TO 0200-READ-CERT.
  7960
  7961 0199-ACCT-NOT-FOUND.
  7962
  7963     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7964
  7965     IF DATE-RANGE-SW NOT = SPACES
  7966        MOVE ER-2601             TO WS-ERROR
  7967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7968     ELSE
  7969        MOVE ER-2619             TO WS-ERROR
  7970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7971
  7972     GO TO 9990-RETURN.
  7973
  7974 0200-READ-CERT.
  7975
  7976     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7977     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7978     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7979     MOVE PB-SV-STATE            TO CERT-STATE.
  7980     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 147
* EL050.cbl
  7981     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7982     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7983
  7984     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7985
  7986     IF CERT-WAS-NOT-FOUND
  7987        GO TO 0299-CERT-NOT-FOUND.
  7988
  7989     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7990        MOVE ER-2759             TO WS-ERROR
  7991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7992        GO TO 0298-UNLOCK-RETURN.
  7993
  7994     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7995         MOVE ER-2758            TO WS-ERROR
  7996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7997         GO TO 0298-UNLOCK-RETURN.
  7998
  7999     IF PB-ISSUE
  8000        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8001           IF CERT-WAS-CREATED-FOR-CLAIM
  8002              NEXT SENTENCE
  8003            ELSE
  8004              MOVE ER-2626       TO WS-ERROR
  8005              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8006              GO TO 0298-UNLOCK-RETURN.
  8007
  8008     IF NOT PB-CANCELLATION
  8009        GO TO 0300-CONTINUE-EDIT.
  8010
  8011     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8012     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8013     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8014     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8015     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8016     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8017
  8018     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8019     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8020     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8021     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8022     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8023     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8024     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8025     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8026     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8027
  8028     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8029     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8030     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8031     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8032     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8033     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8034     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8035
  8036     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8037     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8038
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 148
* EL050.cbl
  8039     MOVE CM-CREDIT-INTERFACE-SW-1
  8040                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8041     MOVE CM-CREDIT-INTERFACE-SW-2
  8042                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8043
  8044     IF CM-O-B-COVERAGE
  8045         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8046
  8047     IF CM-LIVES NOT NUMERIC
  8048         MOVE ZERO                TO CM-LIVES.
  8049
  8050     IF CM-BILLED NOT NUMERIC
  8051         MOVE ZERO                TO CM-BILLED.
  8052
  8053     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8054         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8055         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8056         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8057         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8058         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8059         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8060         MOVE CM-LIVES             TO PB-CI-LIVES
  8061*The next line causes a problem with my change  I dont think it is
  8062*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8063
  8064     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8065     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8066     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8067     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8068     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8069     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8070
  8071     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8072     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8073     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8074     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8075
  8076     IF CM-LIFE-COMM-PCT NUMERIC
  8077         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8078     ELSE
  8079         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8080
  8081     IF CM-AH-COMM-PCT NUMERIC
  8082         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8083     ELSE
  8084         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8085
  8086     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8087
  8088     IF CM-LOAN-APR       NOT NUMERIC
  8089           MOVE ZERO               TO CM-LOAN-APR.
  8090
  8091     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8092           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8093
  8094     IF CM-LOAN-TERM      NOT NUMERIC
  8095           MOVE ZERO               TO CM-LOAN-TERM.
  8096
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 149
* EL050.cbl
  8097     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8098           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8099
  8100     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8101           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8102
  8103     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8104     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8105     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8106     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8107     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8108     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8109     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8110     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8111     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8112     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8113     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8114     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8115
  8116     IF CM-STATE = CM-SSN-STATE
  8117         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8118
  8119     IF CM-STATE NOT = CM-MEMB-STATE
  8120         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8121
  8122     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8123
  8124     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8125        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8126        IF CM-ADDL-CLP NOT NUMERIC
  8127           MOVE +0               TO CM-ADDL-CLP
  8128        END-IF
  8129        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8130        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8131           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8132        END-IF
  8133     END-IF
  8134     IF PB-COMPANY-ID = 'DCC'
  8135        MOVE +0                  TO WS-ADMIN-FEES
  8136                                    WS-CSO-ADMIN-FEE
  8137                                    WS-COMM-AND-MFEE
  8138                                    WS-1ST-YR-ALLOW
  8139        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8140           (SUB5 > +10)
  8141           MOVE +0 TO WS-WK-RATE
  8142           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8143              IF (AM-A-COM (SUB5) NUMERIC)
  8144                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8145                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8146              ELSE
  8147                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8148                 IF PB-ISSUE
  8149                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8150                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8151                 ELSE
  8152                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8153                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8154                 END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 150
* EL050.cbl
  8155                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8156                 MOVE ZEROS             TO WS-SUB1
  8157                                           WS-COMMISSION
  8158                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8159                 MOVE '0530'               TO CTBL-SW
  8160                 MOVE ' '                  TO WS-CTBL-READ-SW
  8161                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8162                 IF FIRST-TIME-THROUGH
  8163                    MOVE 'AA'              TO CTBL-BEN-CODE
  8164                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8165                 END-IF
  8166                 IF CTBL-TABLE-FOUND
  8167                    IF PB-ISSUE
  8168                       COMPUTE WS-COMM-CK-AMT =
  8169                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8170                    ELSE
  8171                       COMPUTE WS-COMM-CK-AMT =
  8172                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8173                    END-IF
  8174                    PERFORM 8800-GET-COMP-RATE
  8175                              THRU 8800-EXIT
  8176                 END-IF
  8177              END-IF
  8178              IF AM-COM-TYP (SUB5) = 'I'
  8179                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8180                   + (WS-WK-RATE * 1000)
  8181              END-IF
  8182              IF AM-COM-TYP (SUB5) = 'N'
  8183                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8184                   + (WS-WK-RATE * 1000)
  8185              END-IF
  8186              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8187                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8188                   + (WS-WK-RATE * 1000)
  8189              END-IF
  8190              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8191                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8192                   + (WS-WK-RATE * 1000)
  8193              END-IF
  8194           END-IF
  8195        END-PERFORM
  8196     END-IF
  8197     GO TO 0300-CONTINUE-EDIT.
  8198
  8199 0298-UNLOCK-RETURN.
  8200      PERFORM 9250-UNLOCK-RETURN
  8201      GO TO 9990-RETURN.
  8202
  8203 0299-CERT-NOT-FOUND.
  8204
  8205     MOVE '1'                     TO CERT-STATUS-SW.
  8206
  8207     IF PB-COMPANY-ID = 'UCL'
  8208         IF WS-ERROR = ER-2799
  8209             GO TO 3000-CONTINUE-EDIT.
  8210
  8211     IF NOT PB-CANCELLATION
  8212         GO TO 0300-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 151
* EL050.cbl
  8213
  8214     MOVE ER-2726                  TO  WS-ERROR.
  8215     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8216     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8217     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8218                                    PB-CI-LF-TERM
  8219                                    PB-C-LF-REM-TERM
  8220                                    PB-CI-AH-TERM
  8221                                    PB-C-AH-REM-TERM
  8222                                    PB-CI-LF-BENEFIT-CD
  8223                                    PB-CI-LF-BENEFIT-AMT
  8224                                    PB-CI-LF-ALT-BENEFIT-AMT
  8225                                    PB-CI-LF-PREMIUM-AMT
  8226                                    PB-CI-LF-ALT-PREMIUM-AMT
  8227                                    PB-CI-AH-BENEFIT-CD
  8228                                    PB-CI-AH-BENEFIT-AMT
  8229                                    PB-CI-AH-PREMIUM-AMT
  8230                                    PB-CI-PAY-FREQUENCY
  8231                                    PB-CI-LOAN-APR
  8232                                    PB-CI-LOAN-TERM
  8233                                    PB-CI-LIFE-COMMISSION
  8234                                    PB-CI-AH-COMMISSION
  8235                                    PB-CI-CURR-SEQ
  8236                                    PB-CI-AH-CANCEL-AMT
  8237                                    PB-CI-LF-CANCEL-AMT
  8238                                    PB-CI-RATE-DEV-PCT-LF
  8239                                    PB-CI-RATE-DEV-PCT-AH
  8240                                    PB-CI-EXTENTION-DAYS
  8241                                    PB-CI-TERM-IN-DAYS
  8242                                    PB-CI-LIVES
  8243                                    PB-CI-LF-CRIT-PER
  8244                                    PB-CI-AH-CRIT-PER
  8245                                    PB-CI-ADDL-CLP
  8246                                    PB-CI-DDF-IU-RATE-UP.
  8247
  8248     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8249                                    PB-CI-AH-SETTLEMENT-DT
  8250                                    PB-CI-DEATH-DT
  8251                                    PB-CI-LF-PRIOR-CANCEL-DT
  8252                                    PB-CI-AH-PRIOR-CANCEL-DT
  8253                                    PB-CI-ENTRY-DT
  8254                                    PB-CI-LF-EXPIRE-DT
  8255                                    PB-CI-AH-EXPIRE-DT
  8256                                    PB-CI-LOAN-1ST-PMT-DT.
  8257
  8258     IF ACCOUNT-MAST-FOUND
  8259        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8260        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8261
  8262     GO TO 3000-CONTINUE-EDIT.
  8263
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 152
* EL050.cbl
  8265
  8266 0300-CONTINUE-EDIT.
  8267
  8268     IF PB-ISSUE
  8269        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8270            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8271
  8272     IF PB-ISSUE
  8273        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8274            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8275
  8276     IF PB-ISSUE
  8277       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8278          (AM-NO-AH-ONLY)
  8279           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8280               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8281                   MOVE ER-2679 TO WS-ERROR
  8282                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8283
  8284     IF PB-ISSUE
  8285        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8286        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8287        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8288     ELSE
  8289        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8290        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8291        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8292
  8293     MOVE 'N'                    TO PLAN-MASTER-SW
  8294                                    PLAN-MASTER-LIFE-SW
  8295                                    FORM-MASTER-SW
  8296                                    WS-APP-CERT-SW.
  8297
  8298     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8299                                    WS-PL-TOL-LF-REFUND
  8300                                    WS-PL-REF-OVS-AMT
  8301                                    WS-PL-TOL-LF-PREM-PCT
  8302                                    WS-PL-TOL-LF-REFUND-PCT
  8303                                    WS-PL-REF-OVS-PCT
  8304                                    WS-PL-TOL-LF-CLAIM.
  8305
  8306     IF PB-COMPANY-ID = 'NCL'
  8307       IF PB-ISSUE
  8308         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8309             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8310             IF FORM-MASTER-FOUND
  8311                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8312
  8313     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8314        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8315
  8316********************** MON CODE **********************
  8317     IF PB-COMPANY-ID = 'MON'
  8318     IF PB-ISSUE
  8319     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8320        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8321             PB-I-LOAN-APR = ZERO)
  8322               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 153
* EL050.cbl
  8323******************************************************
  8324
  8325     IF PB-COMPANY-ID = 'NCL'
  8326       IF PB-ISSUE
  8327           IF FORM-MASTER-FOUND
  8328             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8329                AM-DISMBR-COVERAGE
  8330                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8331                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8332                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8333                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8334                                           PB-I-LIFE-BENEFIT-CD.
  8335
  8336     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8337
  8338     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8339         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8340         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8341         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8342         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8343         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8344           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8345             GO TO 0301-LIFE-BENEFIT-SEARCH
  8346         ELSE
  8347             NEXT SENTENCE
  8348     ELSE
  8349         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8350
  8351     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8352     MOVE '4'                    TO CNTL-REC-TYPE.
  8353     MOVE +0                     TO CNTL-SEQ-NO.
  8354     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8355
  8356     MOVE '1' TO RC-SW-2.
  8357     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8358
  8359     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8360        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8361         GO TO 0305-BENEFIT-NOT-FOUND.
  8362
  8363     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8364
  8365 0301-LIFE-BENEFIT-SEARCH.
  8366
  8367     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8368
  8369     IF NO-BENEFIT-FOUND
  8370        GO TO 0305-BENEFIT-NOT-FOUND.
  8371
  8372     IF WS-BEN-CD = '99'
  8373        GO TO 0305-BENEFIT-NOT-FOUND.
  8374
  8375     IF PB-COMPANY-ID = 'NCL'
  8376         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8377             GO TO 0304-LIFE-BENEFIT-FOUND.
  8378
  8379     MOVE +1                     TO SUB5.
  8380     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 154
* EL050.cbl
  8381
  8382* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8383* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8384     IF PB-COMPANY-ID = 'DMD'
  8385         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8386
  8387 0302-EDIT-ACCT-LF-BENEFITS.
  8388
  8389     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8390        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8391           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8392                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8393           GO TO 03XX-GET-LIFE-ERPLAN.
  8394
  8395     IF SUB5 LESS THAN +20
  8396        ADD +1                   TO SUB5
  8397        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8398
  8399     MOVE +1                     TO SUB5.
  8400
  8401     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8402        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8403
  8404 0303-EDIT-DMD-EXTRA-BENEFITS.
  8405
  8406     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8407        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8408           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8409                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8410           GO TO 03XX-GET-LIFE-ERPLAN.
  8411
  8412     IF SUB5 LESS THAN +30
  8413        ADD +1                   TO SUB5
  8414        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8415
  8416     MOVE +1                     TO SUB5.
  8417
  8418 03XX-EDIT-FOR-NINETY-LF.
  8419
  8420***************************************************************
  8421*                                                             *
  8422*    NINETY BENEFIT PLAN TYPES:                               *
  8423*                                                             *
  8424*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8425*      92 = ALL GROUP REDUCING BENEFITS                       *
  8426*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8427*      94 = ALL GROUP LEVEL BENEFITS                          *
  8428*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8429*           BENEFIT CONTROLS.                                 *
  8430*      99 = ALL BENEFITS                                      *
  8431*                                                             *
  8432***************************************************************
  8433
  8434     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8435                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8436
  8437     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8438       AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 155
* EL050.cbl
  8439        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8440        GO TO 03XX-GET-LIFE-ERPLAN.
  8441
  8442     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8443       AND
  8444        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8445        IF CF-REDUCING (SUB3)
  8446           IF (PB-I-INDV-GRP-OVRD = 'I')
  8447              OR
  8448           ((AM-IG = '1') AND
  8449           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8450              OR
  8451           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8452           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8453           (AM-IG NOT = '2'))
  8454              GO TO 03XX-GET-LIFE-ERPLAN.
  8455
  8456     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8457       AND
  8458        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8459        IF CF-REDUCING (SUB3)
  8460           IF (PB-I-INDV-GRP-OVRD = 'G')
  8461              OR
  8462           ((AM-IG = '2') AND
  8463           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8464              OR
  8465           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8466           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8467           (AM-IG NOT = '1'))
  8468              GO TO 03XX-GET-LIFE-ERPLAN.
  8469
  8470     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8471       AND
  8472        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8473        IF CF-LEVEL    (SUB3)
  8474           IF (PB-I-INDV-GRP-OVRD = 'I')
  8475              OR
  8476           ((AM-IG = '1') AND
  8477           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8478              OR
  8479           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8480           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8481            (AM-IG NOT = '2'))
  8482              GO TO 03XX-GET-LIFE-ERPLAN.
  8483
  8484     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8485       AND
  8486        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8487        IF CF-LEVEL    (SUB3)
  8488           IF (PB-I-INDV-GRP-OVRD = 'G')
  8489              OR
  8490           ((AM-IG = '2') AND
  8491           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8492              OR
  8493           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8494           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8495           (AM-IG NOT = '1'))
  8496              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 156
* EL050.cbl
  8497
  8498     IF SUB5 LESS THAN +20
  8499        ADD +1                   TO SUB5
  8500        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8501
  8502     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8503
  8504     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8505        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8506
  8507     MOVE +1                     TO SUB5.
  8508
  8509 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8510
  8511     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8512                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8513
  8514     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8515       AND
  8516        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8517        GO TO 03XX-GET-LIFE-ERPLAN.
  8518
  8519     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8520       AND
  8521        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8522        IF CF-REDUCING (SUB3)
  8523           IF (PB-I-INDV-GRP-OVRD = 'I')
  8524              OR
  8525           ((AM-IG = '1') AND
  8526           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8527              OR
  8528           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8529           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8530           (AM-IG NOT = '2'))
  8531              GO TO 03XX-GET-LIFE-ERPLAN.
  8532
  8533     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8534       AND
  8535        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8536        IF CF-REDUCING (SUB3)
  8537           IF (PB-I-INDV-GRP-OVRD = 'G')
  8538              OR
  8539           ((AM-IG = '2') AND
  8540           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8541              OR
  8542           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8543           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8544           (AM-IG NOT = '1'))
  8545              GO TO 03XX-GET-LIFE-ERPLAN.
  8546
  8547     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8548       AND
  8549        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8550        IF CF-LEVEL    (SUB3)
  8551           IF (PB-I-INDV-GRP-OVRD = 'I')
  8552              OR
  8553           ((AM-IG = '1') AND
  8554           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 157
* EL050.cbl
  8555              OR
  8556           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8557           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8558            (AM-IG NOT = '2'))
  8559              GO TO 03XX-GET-LIFE-ERPLAN.
  8560
  8561     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8562       AND
  8563        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8564        IF CF-LEVEL    (SUB3)
  8565           IF (PB-I-INDV-GRP-OVRD = 'G')
  8566              OR
  8567           ((AM-IG = '2') AND
  8568           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8569              OR
  8570           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8571           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8572           (AM-IG NOT = '1'))
  8573              GO TO 03XX-GET-LIFE-ERPLAN.
  8574
  8575     IF SUB5 LESS THAN +30
  8576        ADD +1                   TO SUB5
  8577        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8578
  8579     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8580
  8581 03XX-EDIT-FOR-NINETY-LF-CONT.
  8582
  8583     MOVE +99                    TO SUB5.
  8584
  8585     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8586        IF PB-ISSUE
  8587           MOVE ER-1924          TO  WS-ERROR
  8588           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8589
  8590     GO TO 0304-LIFE-BENEFIT-FOUND.
  8591
  8592 03XX-GET-LIFE-ERPLAN.
  8593
  8594     IF WK-PLAN-ADDR EQUAL +0
  8595        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8596
  8597     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8598     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8599     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8600     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8601     MOVE 'Y'                    TO PLAN-MASTER-SW
  8602                                    PLAN-MASTER-LIFE-SW.
  8603     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8604
  8605 03XX-ERPLAN-LIFE-GETMAIN.
  8606
  8607     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8608     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8609
  8610 03XX-ERPLAN-LIFE-READ.
  8611
  8612     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 158
* EL050.cbl
  8613     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8614     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8615     MOVE PB-SV-STATE            TO PLAN-STATE.
  8616     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8617     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8618     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8619     MOVE WS-SAVE-BENEFIT-REVISION
  8620                                 TO PLAN-REVISION-NO.
  8621
  8622     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8623     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8624
  8625     IF PB-COMPANY-ID = 'NCL'
  8626       IF NOT LF-PLAN-MASTER-FOUND
  8627         IF NOT PB-POLICY-IS-DECLINED  AND
  8628            NOT PB-POLICY-IS-VOIDED
  8629             MOVE  ER-1921         TO  WS-ERROR
  8630             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8631             GO TO 0304-LIFE-BENEFIT-FOUND.
  8632
  8633     IF NOT LF-PLAN-MASTER-FOUND
  8634        GO TO 0304-LIFE-BENEFIT-FOUND.
  8635
  8636 XXXX-CHECK-LF-PLAN-KEY.
  8637
  8638     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8639        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8640        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8641        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8642        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8643        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8644        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8645        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8646        MOVE 'N'                 TO PLAN-MASTER-SW
  8647          GO TO 03XX-ERPLAN-LIFE-READ.
  8648
  8649     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8650
  8651     IF  PB-CANCELLATION
  8652         GO TO  0303-LF-ACCT-BEN-FOUND.
  8653
  8654     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8655        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8656           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8657           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8658              MOVE ER-2644             TO WS-ERROR
  8659              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8660           ELSE
  8661              NEXT SENTENCE
  8662        ELSE
  8663           IF PB-COMPANY-ID NOT = 'NCL'
  8664              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8665                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8666
  8667 0303-LF-ACCT-BEN-FOUND.
  8668
  8669     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8670
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 159
* EL050.cbl
  8671     IF PL-DEV-CODE NOT = SPACES
  8672        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8673
  8674     IF PL-DEV-PCT NUMERIC AND
  8675        PL-DEV-PCT NOT = ZEROS
  8676        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8677
  8678     IF PL-TOL-PREM-AMT GREATER THAN +0
  8679        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8680
  8681     IF PL-TOL-REF-AMT GREATER THAN +0
  8682        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8683
  8684     IF PL-TOL-PREM-PCT GREATER THAN +0
  8685        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8686
  8687     IF PL-TOL-REF-PCT GREATER THAN +0
  8688        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8689
  8690     IF PL-TOL-CLM-AMT GREATER THAN +0
  8691        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8692
  8693     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8694                          PL-OVER-SHORT-AMT > +0
  8695        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8696
  8697     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8698                          PL-OVER-SHORT-PCT > +0
  8699        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8700
  8701     IF PL-SALES-TAX NUMERIC AND
  8702                          PL-SALES-TAX > +0
  8703         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8704
  8705     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8706        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8707                                    WS-IG-OVRD-AM.
  8708
  8709 0304-LIFE-BENEFIT-FOUND.
  8710
  8711     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8712
  8713     IF PB-ISSUE
  8714        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8715     ELSE
  8716        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8717
  8718     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8719     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8720     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8721     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8722     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8723                                         WS-LF-REFUND-CALC.
  8724
  8725     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8726        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8727
  8728     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 160
* EL050.cbl
  8729        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8730     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8731
  8732     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8733     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8734     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8735     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8736     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8737     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8738
  8739     IF PB-COMPANY-ID = 'NCL'  AND
  8740        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8741         NEXT SENTENCE
  8742     ELSE
  8743         IF SUB5 NOT GREATER THAN +20
  8744            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8745               MOVE WS-SAVE-BENEFIT-REM-TERM
  8746                                      TO WS-AM-LF-BENE-REM-TERM
  8747                                         EC-BR-LF-REM-TERM-CALC.
  8748
  8749     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8750     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8751
  8752     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8753
  8754 0305-BENEFIT-NOT-FOUND.
  8755
  8756     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8757     MOVE ER-2604                TO WS-ERROR.
  8758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8759
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 161
* EL050.cbl
  8761
  8762 0310-FIND-AH-BENEFIT-RECORD.
  8763
  8764     MOVE 'N'                    TO PLAN-MASTER-SW
  8765                                    PLAN-MASTER-AH-SW.
  8766
  8767     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8768                                    WS-PL-TOL-AH-REFUND
  8769                                    WS-AH-PL-REF-OVS-AMT
  8770                                    WS-PL-TOL-AH-PREM-PCT
  8771                                    WS-PL-TOL-AH-REFUND-PCT
  8772                                    WS-AH-PL-REF-OVS-PCT
  8773                                    WS-PL-TOL-AH-CLAIM.
  8774     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8775
  8776
  8777     if pb-issue
  8778        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8779           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8780        end-if
  8781        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8782           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8783           GO TO 0399-BENEFIT-NOT-FOUND
  8784        end-if
  8785     end-if
  8786
  8787     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8788        GO TO 0400-FIND-CARRIER.
  8789
  8790     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8791
  8792     IF WK-AH-BEN-ADDR NOT = ZEROS
  8793         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8794         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8795         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8796         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8797           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8798             GO TO 0311-AH-BENEFIT-SEARCH
  8799         ELSE
  8800             NEXT SENTENCE
  8801     ELSE
  8802         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8803
  8804     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8805     MOVE '5'                    TO CNTL-REC-TYPE.
  8806     MOVE +0                     TO CNTL-SEQ-NO.
  8807     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8808
  8809     MOVE '2' TO RC-SW-2.
  8810     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8811
  8812     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8813        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8814          GO TO 0399-BENEFIT-NOT-FOUND.
  8815
  8816     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8817
  8818 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 162
* EL050.cbl
  8819
  8820     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8821
  8822     IF NO-BENEFIT-FOUND
  8823         GO TO 0399-BENEFIT-NOT-FOUND.
  8824
  8825     IF WS-BEN-CD = '99'
  8826        GO TO 0399-BENEFIT-NOT-FOUND.
  8827
  8828     IF PB-COMPANY-ID  =  'NCL'
  8829         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8830             GO TO 0314-A-H-BENEFIT-FOUND.
  8831
  8832     MOVE +1                     TO SUB5.
  8833     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8834
  8835* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8836* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8837     IF PB-COMPANY-ID = 'DMD'
  8838         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8839
  8840 0312-EDIT-ACCT-AH-BENEFITS.
  8841
  8842     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8843        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8844           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8845                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8846           GO TO 03XX-GET-AH-ERPLAN.
  8847
  8848     IF SUB5 LESS THAN +20
  8849        ADD +1                   TO SUB5
  8850        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8851
  8852     MOVE +1                     TO SUB5.
  8853
  8854     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8855        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8856
  8857 0313-EDIT-DMD-EXTRA-BENEFITS.
  8858
  8859     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8860        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8861           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8862                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8863           GO TO 03XX-GET-AH-ERPLAN.
  8864
  8865     IF SUB5 LESS THAN +30
  8866        ADD +1                   TO SUB5
  8867        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8868
  8869     MOVE +1                     TO SUB5.
  8870
  8871 03XX-EDIT-FOR-NINETY-AH.
  8872
  8873***************************************************************
  8874*                                                             *
  8875*    NINETY BENEFIT PLAN TYPES:                               *
  8876*                                                             *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 163
* EL050.cbl
  8877*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8878*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8879*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8880*           BENEFIT CONTROLS.                                 *
  8881*      99 = ALL BENEFITS.                                     *
  8882*                                                             *
  8883***************************************************************
  8884
  8885     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8886                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8887
  8888     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8889       AND
  8890        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8891        GO TO 03XX-GET-AH-ERPLAN.
  8892
  8893     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8894       AND
  8895        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8896           IF (PB-I-INDV-GRP-OVRD = 'I')
  8897              OR
  8898           ((AM-IG = '1') AND
  8899           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8900              OR
  8901           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8902           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8903           (AM-IG NOT = '2'))
  8904              GO TO 03XX-GET-AH-ERPLAN.
  8905
  8906     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8907       AND
  8908        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8909           IF (PB-I-INDV-GRP-OVRD = 'G')
  8910              OR
  8911           ((AM-IG = '2') AND
  8912           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8913              OR
  8914           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8915           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8916           (AM-IG NOT = '1'))
  8917              GO TO 03XX-GET-AH-ERPLAN.
  8918
  8919     IF SUB5 LESS THAN +20
  8920        ADD +1                   TO SUB5
  8921        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8922
  8923     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8924        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8925
  8926     MOVE +1                    TO SUB5.
  8927
  8928 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8929
  8930     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8931                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8932
  8933     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8934       AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 164
* EL050.cbl
  8935        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8936        GO TO 03XX-GET-AH-ERPLAN.
  8937
  8938     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8939       AND
  8940        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8941           IF (PB-I-INDV-GRP-OVRD = 'I')
  8942              OR
  8943           ((AM-IG = '1') AND
  8944           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8945              OR
  8946           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8947           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8948           (AM-IG NOT = '2'))
  8949              GO TO 03XX-GET-AH-ERPLAN.
  8950
  8951     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8952       AND
  8953        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8954           IF (PB-I-INDV-GRP-OVRD = 'G')
  8955              OR
  8956           ((AM-IG = '2') AND
  8957           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8958              OR
  8959           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8960           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8961           (AM-IG NOT = '1'))
  8962              GO TO 03XX-GET-AH-ERPLAN.
  8963
  8964     IF SUB5 LESS THAN +30
  8965        ADD +1                   TO SUB5
  8966        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8967
  8968 03XX-EDIT-FOR-NINETY-AH-CONT.
  8969
  8970     MOVE +99                    TO SUB5.
  8971
  8972     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8973
  8974     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8975        IF PB-ISSUE
  8976           MOVE ER-1925          TO  WS-ERROR
  8977           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8978
  8979     GO TO 0314-A-H-BENEFIT-FOUND.
  8980
  8981 03XX-GET-AH-ERPLAN.
  8982
  8983     IF WK-PLAN-ADDR EQUAL +0
  8984         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8985
  8986     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8987     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8988     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8989     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8990     MOVE 'Y'                    TO PLAN-MASTER-SW
  8991                                    PLAN-MASTER-AH-SW.
  8992*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 165
* EL050.cbl
  8993     GO TO 03XX-ERPLAN-AH-READ.
  8994
  8995 03XX-ERPLAN-AH-GETMAIN.
  8996
  8997     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8998     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8999
  9000 03XX-ERPLAN-AH-READ.
  9001
  9002     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9003     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9004     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9005     MOVE PB-SV-STATE            TO PLAN-STATE.
  9006     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9007     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9008     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9009     MOVE WS-SAVE-BENEFIT-REVISION
  9010                                 TO PLAN-REVISION-NO.
  9011
  9012     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9013     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9014
  9015     IF PB-COMPANY-ID = 'NCL'
  9016       IF NOT AH-PLAN-MASTER-FOUND
  9017         IF NOT PB-POLICY-IS-DECLINED  AND
  9018            NOT PB-POLICY-IS-VOIDED
  9019             MOVE  ER-1922         TO  WS-ERROR
  9020             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9021             GO TO 0314-A-H-BENEFIT-FOUND.
  9022
  9023     IF NOT AH-PLAN-MASTER-FOUND
  9024        GO TO 0314-A-H-BENEFIT-FOUND.
  9025
  9026 XXXX-CHECK-AH-PLAN-KEY.
  9027
  9028     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9029        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9030        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9031        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9032        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9033        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9034        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9035        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9036        MOVE 'N'                 TO PLAN-MASTER-SW
  9037          GO TO 03XX-ERPLAN-AH-READ.
  9038
  9039     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9040
  9041     IF  PB-CANCELLATION
  9042         GO TO  0313-AH-ACCT-BEN-FOUND.
  9043
  9044     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9045       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9046          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9047          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9048             MOVE ER-2644             TO WS-ERROR
  9049             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9050          ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 166
* EL050.cbl
  9051             NEXT SENTENCE
  9052       ELSE
  9053          IF PB-COMPANY-ID NOT = 'NCL'
  9054             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9055                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9056
  9057 0313-AH-ACCT-BEN-FOUND.
  9058
  9059     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9060
  9061     IF PL-DEV-CODE NOT = SPACES
  9062        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9063
  9064     IF PL-DEV-PCT NUMERIC AND
  9065        PL-DEV-PCT NOT = ZEROS
  9066        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9067
  9068     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9069        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9070
  9071     IF PL-TOL-REF-AMT NOT EQUAL +0
  9072        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9073
  9074     IF PL-TOL-PREM-PCT GREATER THAN +0
  9075        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9076
  9077     IF PL-TOL-REF-PCT GREATER THAN +0
  9078        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9079
  9080     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9081        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9082
  9083     IF PL-OVER-SHORT-AMT NUMERIC AND
  9084                          PL-OVER-SHORT-AMT > +0
  9085        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9086
  9087     IF PL-OVER-SHORT-PCT NUMERIC AND
  9088                          PL-OVER-SHORT-PCT > +0
  9089        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9090
  9091     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9092        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9093        IF WS-IG-OVRD-AM EQUAL SPACES
  9094            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9095
  9096 0314-A-H-BENEFIT-FOUND.
  9097
  9098     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9099
  9100     IF PB-ISSUE
  9101        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9102       ELSE
  9103        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9104
  9105     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9106     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9107     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9108     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 167
* EL050.cbl
  9109                                         WS-AH-REFUND-CALC.
  9110
  9111     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9112        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9113
  9114     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9115        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9116     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9117
  9118     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9119     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9120     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9121     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9122     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9123     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9124
  9125     IF PB-COMPANY-ID = 'NCL'  AND
  9126        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9127         NEXT SENTENCE
  9128     ELSE
  9129         IF SUB5 NOT GREATER THAN +20
  9130            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9131                MOVE WS-SAVE-BENEFIT-REM-TERM
  9132                                      TO WS-AM-AH-BENE-REM-TERM
  9133                                         EC-BR-AH-REM-TERM-CALC.
  9134
  9135     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9136     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9137
  9138     GO TO 0400-FIND-CARRIER.
  9139
  9140 0399-BENEFIT-NOT-FOUND.
  9141
  9142     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9143     MOVE ER-2605                TO WS-ERROR.
  9144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9145
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 168
* EL050.cbl
  9147
  9148 0400-FIND-CARRIER.
  9149
  9150     MOVE PB-SV-CARRIER          TO WS-CARR.
  9151
  9152     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9153     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9154     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9155     MOVE '6'                    TO CNTL-REC-TYPE.
  9156
  9157*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9158     MOVE SPACE                  TO WS-DMD-RATING-SW
  9159                                    EC-BR-DMD-RATING-SW.
  9160
  9161     MOVE '2'                    TO RC-SW-1.
  9162     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9163
  9164     IF NOT CF-CARRIER-MASTER
  9165        GO TO 0400-CARRIER-NOT-FOUND.
  9166
  9167 0400-BUILD-CARR-TOL.
  9168
  9169     IF CF-CR-TOL-PREM NUMERIC AND
  9170        CF-CR-TOL-PREM GREATER THAN +0
  9171        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9172                                    WS-TOL-AH-PREM.
  9173
  9174     IF CF-CR-TOL-REFUND NUMERIC AND
  9175        CF-CR-TOL-REFUND GREATER THAN +0
  9176        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9177                                    WS-TOL-AH-REFUND.
  9178
  9179     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9180        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9181        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9182                                    WS-AH-REFUND-OVS-AMT.
  9183
  9184     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9185        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9186        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9187                                    WS-AH-REFUND-OVS-PCT.
  9188
  9189     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9190        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9191        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9192                                    WS-TOL-AH-PREM-PCT.
  9193
  9194     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9195        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9196        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9197                                     WS-TOL-AH-REFUND-PCT.
  9198
  9199     IF CF-COMPANY-ID EQUAL 'DMD'
  9200         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9201                                    EC-BR-DMD-RATING-SW.
  9202
  9203     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9204     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 169
* EL050.cbl
  9205        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9206     END-IF
  9207     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9208        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9209     END-IF
  9210     IF WS-TOL-CLP-PCT = ZEROS
  9211        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9212     END-IF
  9213
  9214     IF WS-SPP-LEASE-COMM = ZEROS
  9215        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9216     END-IF
  9217     GO TO 0400-FIND-ERPDEF.
  9218
  9219 0400-CARRIER-NOT-FOUND.
  9220
  9221     MOVE ER-2602                TO WS-ERROR.
  9222     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9223
  9224 0400-FIND-ERPDEF.
  9225     IF PB-COMPANY-ID = 'DCC'
  9226        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9227        CONTINUE
  9228     ELSE
  9229        GO TO 0400-FIND-ERCOMP
  9230     END-IF
  9231     MOVE ' '                    TO PDEF-MASTER-SW
  9232     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9233     MOVE PB-STATE               TO ERPDEF-STATE
  9234     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9235     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9236     IF PB-ISSUE
  9237        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9238     ELSE
  9239        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9240     END-IF
  9241     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9242     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9243     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9244     IF PDEF-MASTER-FOUND
  9245        MOVE 'N'                 TO PDEF-MASTER-SW
  9246        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9247        IF PDEF-MASTER-FOUND
  9248           IF (ERPDEF-KEY-SAVE (1:16) =
  9249                        PD-CONTROL-PRIMARY (1:16))
  9250              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9251              CONTINUE
  9252           ELSE
  9253              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9254              IF (ERPDEF-KEY-SAVE (1:16) =
  9255                        PD-CONTROL-PRIMARY (1:16))
  9256                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9257                 CONTINUE
  9258              ELSE
  9259                 MOVE 'N'        TO PDEF-MASTER-SW
  9260              END-IF
  9261           END-IF
  9262        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 170
* EL050.cbl
  9263        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9264     END-IF
  9265     IF PDEF-MASTER-FOUND
  9266        IF PD-TRUNCATED = 'Y'
  9267           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9268        END-IF
  9269     END-IF
  9270     .
  9271 0400-FIND-ERCOMP.
  9272     IF PB-COMPANY-ID = 'DCC'
  9273        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9274           (WS-SUB1 > +10)
  9275           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9276                 OR 'A' OR 'N'
  9277              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9278              MOVE PB-CARRIER    TO COMP-CARRIER
  9279              MOVE PB-GROUPING   TO COMP-GROUPING
  9280              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9281              MOVE AM-AGT (WS-SUB1)
  9282                                 TO COMP-FIN-RESP
  9283              MOVE 'G'           TO COMP-TYPE
  9284              PERFORM 8582-READ-COMPENSATION-MASTER
  9285                                 THRU 8582-EXIT
  9286              IF COMP-MASTER-FOUND
  9287                 IF CO-GA-INACTIVE
  9288                    MOVE ER-2763 TO WS-ERROR
  9289                    PERFORM 9900-ERROR-FORMAT
  9290                                 THRU 9900-EXIT
  9291                    MOVE +11     TO WS-SUB1
  9292                 END-IF
  9293                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9294                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9295                    MOVE ER-2788 TO WS-ERROR
  9296                    PERFORM 9900-ERROR-FORMAT
  9297                                 THRU 9900-EXIT
  9298                    MOVE +11     TO WS-SUB1
  9299                 END-IF
  9300              END-IF
  9301           END-IF
  9302        END-PERFORM
  9303     END-IF
  9304     IF PB-COMPANY-ID = 'DCC'
  9305        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9306           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9307                                    WS-CLP-STATE
  9308        ELSE
  9309           MOVE SPACES           TO PB-I-CLP-STATE
  9310                                    WS-CLP-STATE
  9311        END-IF
  9312     END-IF
  9313
  9314     IF (PB-COMPANY-ID = 'DCC')
  9315        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9316        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9317        CONTINUE
  9318     ELSE
  9319        GO TO 0400-FIND-STATE-RECORD
  9320     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 171
* EL050.cbl
  9321     MOVE SPACES                 TO WS-CLP-STATE
  9322     MOVE +0                     TO WS-BANK-FEE
  9323                                    WS-BANK-LFEE
  9324                                    WS-BANK-NOCHRGB
  9325
  9326     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9327     IF (PB-ISSUE)
  9328        AND (PB-I-BANK-NUMBER NOT =
  9329            SPACES AND ZEROS AND LOW-VALUES)
  9330        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9331     ELSE
  9332        IF (PB-CANCELLATION)
  9333           AND (PB-CI-BANK-NUMBER NOT =
  9334                SPACES AND ZEROS AND LOW-VALUES)
  9335           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9336        END-IF
  9337     END-IF
  9338     IF COMP-FIN-RESP NOT = LOW-VALUES
  9339        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9340        MOVE PB-CARRIER          TO COMP-CARRIER
  9341        MOVE PB-GROUPING         TO COMP-GROUPING
  9342        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9343        MOVE 'B'                 TO COMP-TYPE
  9344        PERFORM 8582-READ-COMPENSATION-MASTER
  9345                                 THRU 8582-EXIT
  9346        IF COMP-MASTER-FOUND
  9347           IF CO-MAX-BANK-FEE NOT NUMERIC
  9348              MOVE +0            TO CO-MAX-BANK-FEE
  9349           END-IF
  9350           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9351              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9352           END-IF
  9353           IF CO-GA-INACTIVE
  9354              MOVE ER-2763       TO WS-ERROR
  9355              PERFORM 9900-ERROR-FORMAT
  9356                                 THRU 9900-EXIT
  9357           END-IF
  9358           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9359              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9360              MOVE ER-2788 TO WS-ERROR
  9361              PERFORM 9900-ERROR-FORMAT
  9362                                 THRU 9900-EXIT
  9363              MOVE +11     TO WS-SUB1
  9364           END-IF
  9365           IF WS-AH-BEN-CATEGORY = 'G'
  9366              MOVE CO-MAX-BANK-FEE
  9367                                 TO WS-BANK-FEE
  9368                                    PB-I-BANK-FEE
  9369           ELSE
  9370              MOVE CO-MAX-BANK-FEE-LEASE
  9371                                 TO WS-BANK-LFEE
  9372                                    PB-I-BANK-FEE
  9373           END-IF
  9374           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9375              AND (WS-AH-REFUND-CALC = 'G'))
  9376                        OR
  9377              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9378              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 172
* EL050.cbl
  9379              CONTINUE
  9380           ELSE
  9381              MOVE ER-2789 TO WS-ERROR
  9382              PERFORM 9900-ERROR-FORMAT
  9383                                 THRU 9900-EXIT
  9384           END-IF
  9385           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9386                                    PB-I-CLP-STATE
  9387           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9388           MOVE CO-CARRIER       TO BXRF-CARRIER
  9389           MOVE CO-GROUPING      TO BXRF-GROUPING
  9390           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9391           MOVE BXRF-MAX-REC-LENGTH
  9392                                 TO BXRF-REC-LENGTH
  9393           PERFORM 8584-READ-BANK-CROSS-REF
  9394                                 THRU 8584-EXIT
  9395           IF BXRF-MASTER-FOUND
  9396              MOVE ' '           TO BANK-ACCT-SW
  9397              MOVE BK-BANK-POINTER-CNT
  9398                                 TO BK-BANK-POINTER-CNT
  9399              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9400                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9401                 OR (BANK-ACCT-FOUND)
  9402                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9403                    AND (BK-AM-EXP-DT (WS-SUB1)
  9404                                 > PB-CERT-EFF-DT)
  9405                    AND (BK-AM-EFF-DT (WS-SUB1)
  9406                                 NOT > PB-CERT-EFF-DT)
  9407                    SET BANK-ACCT-FOUND TO TRUE
  9408                 END-IF
  9409              END-PERFORM
  9410              IF NOT BANK-ACCT-FOUND
  9411                 MOVE ZEROS      TO WS-BANK-FEE
  9412                                    WS-BANK-LFEE
  9413                 MOVE ER-2869    TO WS-ERROR
  9414                 PERFORM 9900-ERROR-FORMAT
  9415                                 THRU 9900-EXIT
  9416              ELSE
  9417                 PERFORM 5000-PROCESS-REPS
  9418                                 THRU 5000-EXIT
  9419                 IF AGENT-MASTER-FOUND
  9420                    MOVE +0      TO WS-BANK-FEE
  9421                                    WS-BANK-LFEE
  9422*                   MOVE AG-SPP-FEES (1)
  9423*                                TO PB-I-BANK-FEE
  9424*                                   WS-BANK-FEE
  9425                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9426                       (WS-SUB1 > +10)
  9427                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9428                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9429                       END-IF
  9430                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9431                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9432                       END-IF
  9433                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9434                          AG-SPP-FEES (WS-SUB1)
  9435                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9436                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 173
* EL050.cbl
  9437                    END-PERFORM
  9438                    IF WS-AH-BEN-CATEGORY = 'G'
  9439                       MOVE WS-BANK-FEE
  9440                                 TO PB-I-BANK-FEE
  9441                    ELSE
  9442                       MOVE WS-BANK-LFEE
  9443                                 TO PB-I-BANK-FEE
  9444                    END-IF
  9445                 END-IF
  9446              END-IF
  9447           END-IF
  9448        ELSE
  9449           MOVE ER-2879          TO WS-ERROR
  9450           PERFORM 9900-ERROR-FORMAT
  9451                                 THRU 9900-EXIT
  9452        END-IF
  9453     ELSE
  9454        MOVE ER-2879             TO WS-ERROR
  9455        PERFORM 9900-ERROR-FORMAT
  9456                                 THRU 9900-EXIT
  9457     END-IF
  9458     IF WS-AH-BEN-CATEGORY = 'G'
  9459        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9460        + WS-BANK-FEE
  9461     ELSE
  9462        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9463        + WS-BANK-LFEE
  9464     END-IF
  9465     .
  9466 0400-FIND-STATE-RECORD.
  9467
  9468     IF WK-STATE-ADDR NOT = ZEROS
  9469         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9470         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9471         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9472         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9473         IF PB-SV-STATE = CF-STATE-CODE
  9474             GO TO 0405-CONTINUE-EDIT
  9475         ELSE
  9476             NEXT SENTENCE
  9477     ELSE
  9478         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9479
  9480     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9481     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9482     MOVE '3'                    TO CNTL-REC-TYPE.
  9483     MOVE +0                     TO CNTL-SEQ-NO.
  9484
  9485     MOVE '3'                    TO RC-SW-2.
  9486     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9487
  9488     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9489        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9490        PB-SV-STATE   NOT = CF-STATE-CODE)
  9491        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9492                                    WS-TOL-AH-CLAIM
  9493                                    WS-MINIMUM-REFUND
  9494                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 174
* EL050.cbl
  9495                                    WS-TOL-AH-PREM
  9496                                    WS-TOL-LF-REFUND
  9497                                    WS-TOL-AH-REFUND
  9498                                    EC-ST-TOL-PREM-PCT
  9499                                    WS-TOL-LF-PREM-PCT
  9500                                    WS-TOL-AH-PREM-PCT
  9501                                    EC-ST-TOL-REFUND-PCT
  9502                                    WS-TOL-LF-REFUND-PCT
  9503                                    WS-TOL-AH-REFUND-PCT
  9504                                    EC-ST-TOL-PREM
  9505                                    EC-ST-TOL-REFUND
  9506                                    EC-ST-FST-PMT-DAYS-MAX
  9507                                    WS-FREE-LOOK-PERIOD
  9508                                    WS-ST-LF-PREM-TAX
  9509                                    WS-ST-AH-PREM-TAX-I
  9510                                    WS-ST-AH-PREM-TAX-G
  9511                                    WS-BANK-FEE
  9512                                    WS-BANK-LFEE
  9513                                    WS-TOL-CLP-PCT
  9514                                    WS-SPP-LEASE-COMM
  9515        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9516                                    EC-ST-FST-PMT-DAYS-CHG
  9517                                    WS-LF-REM-TERM-CALC
  9518                                    WS-LF-REFUND-CALC
  9519                                    EC-ST-LF-REM-TERM-CALC
  9520                                    EC-ST-LF-REFUND-CALC
  9521                                    WS-AH-REM-TERM-CALC
  9522                                    WS-AH-REFUND-CALC
  9523                                    WS-LF-BEN-CATEGORY
  9524                                    WS-AH-BEN-CATEGORY
  9525                                    WS-CLP-STATE
  9526                                    WS-ST-REFUND-CLAIM-FLAG
  9527                                    EC-ST-AH-REM-TERM-CALC
  9528                                    EC-ST-AH-REFUND-CALC
  9529          GO TO 0499-STATE-NOT-FOUND.
  9530
  9531     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9532
  9533 0405-CONTINUE-EDIT.
  9534
  9535     if pb-company-id = 'AHL'
  9536        continue
  9537     else
  9538        IF PB-CERT-PRIME NOT NUMERIC
  9539           MOVE ER-2722          TO WS-ERROR
  9540           PERFORM 9900-ERROR-FORMAT
  9541                                 THRU 9900-EXIT
  9542        end-if
  9543     END-IF
  9544*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9545*       MOVE +0                  TO SUB3
  9546*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9547*       IF SUB3 > +0
  9548*          MOVE ER-2722          TO WS-ERROR
  9549*          PERFORM 9900-ERROR-FORMAT
  9550*                                THRU 9900-EXIT
  9551*       END-IF
  9552*    END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 175
* EL050.cbl
  9553*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9554*       IF PB-CERT-PRIME NOT NUMERIC
  9555*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9556*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9557*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9558*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9559*
  9560*          MOVE ER-2722          TO WS-ERROR
  9561*          PERFORM 9900-ERROR-FORMAT
  9562*                                THRU 9900-EXIT
  9563*       END-IF
  9564*    END-IF
  9565
  9566     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9567
  9568     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9569        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9570                                    WS-TOL-AH-CLAIM.
  9571
  9572     IF CF-ST-REFUND-MIN NOT NUMERIC
  9573        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9574
  9575     IF CF-ST-REFUND-MIN NOT = ZEROS
  9576        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9577
  9578     IF CF-ST-TOL-PREM  NOT = ZEROS
  9579        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9580                                    WS-TOL-AH-PREM
  9581        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9582
  9583     IF CF-ST-TOL-REFUND NOT = ZEROS
  9584        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9585                                    WS-TOL-AH-REFUND
  9586        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9587
  9588     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9589        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9590        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9591                                    WS-AH-REFUND-OVS-AMT
  9592                                    EC-ST-OVR-SHT-AMT.
  9593
  9594     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9595        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9596        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9597                                    WS-TOL-LF-PREM-PCT
  9598                                    WS-TOL-AH-PREM-PCT.
  9599
  9600     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9601        CF-ST-TOL-REF-PCT GREATER THAN +0
  9602        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9603                                    WS-TOL-LF-REFUND-PCT
  9604                                    WS-TOL-AH-REFUND-PCT.
  9605
  9606     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9607        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9608        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9609                                    WS-AH-REFUND-OVS-PCT
  9610                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 176
* EL050.cbl
  9611
  9612     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9613     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9614
  9615     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9616          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9617
  9618     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9619     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9620     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9621
  9622     IF CF-ST-LF-PREM-TAX NUMERIC
  9623        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9624     END-IF
  9625     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9626        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9627     END-IF
  9628     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9629        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9630     END-IF
  9631
  9632     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9633         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9634     END-IF.
  9635
  9636     IF WS-LF-BENEFIT-CD = ZEROS
  9637        GO TO 0410-CHECK-AH.
  9638
  9639     IF CF-ST-RT-CALC NOT = SPACES
  9640        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9641                                    EC-ST-LF-REM-TERM-CALC
  9642     END-IF
  9643
  9644     IF WS-LF-COVERAGE-TYPE = 'R'
  9645        IF WS-LF-EARNINGS-CALC = '5'
  9646           IF CF-ST-RF-LN-CALC > '0'
  9647              MOVE CF-ST-RF-LN-CALC
  9648                                 TO WS-LF-REFUND-CALC
  9649                                    EC-ST-LF-REFUND-CALC
  9650           END-IF
  9651        ELSE
  9652           IF CF-ST-RF-LR-CALC > '0'
  9653              MOVE CF-ST-RF-LR-CALC
  9654                                 TO WS-LF-REFUND-CALC
  9655                                    EC-ST-LF-REFUND-CALC
  9656           END-IF
  9657        END-IF
  9658     ELSE
  9659        IF CF-ST-RF-LL-CALC > '0'
  9660           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9661                                    EC-ST-LF-REFUND-CALC
  9662        END-IF
  9663     END-IF
  9664
  9665     IF CF-ST-RT-CALC NOT = SPACES
  9666        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9667                                    EC-ST-LF-REM-TERM-CALC
  9668     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 177
* EL050.cbl
  9669
  9670     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9671     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9672
  9673     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9674
  9675     IF NO-BENEFIT-FOUND
  9676        GO TO 0410-CHECK-AH.
  9677
  9678     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9679        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9680                                 TO EC-ST-LF-REM-TERM-CALC
  9681                                    WS-LF-REM-TERM-CALC
  9682     END-IF
  9683
  9684     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9685        MOVE CF-ST-REFUND-CALC (SUB3)
  9686                                 TO WS-LF-REFUND-CALC
  9687                                    EC-ST-LF-REFUND-CALC
  9688     END-IF
  9689*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9690
  9691     .
  9692 0410-CHECK-AH.
  9693
  9694     IF WS-AH-BENEFIT-CD = ZEROS
  9695        GO TO 0500-SET-ACCOUNT.
  9696
  9697     IF CF-ST-RT-CALC NOT = SPACES
  9698        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9699                                    EC-ST-AH-REM-TERM-CALC
  9700     END-IF
  9701
  9702     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9703        IF CF-ST-RF-CP-CALC > '0'
  9704           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9705                                    EC-ST-AH-REFUND-CALC
  9706        END-IF
  9707     ELSE
  9708        IF CF-ST-RF-AH-CALC > '0'
  9709           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9710                                    EC-ST-AH-REFUND-CALC
  9711        END-IF
  9712     END-IF
  9713     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9714     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9715
  9716     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9717
  9718     IF NO-BENEFIT-FOUND
  9719        GO TO 0500-SET-ACCOUNT.
  9720
  9721     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9722        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9723                                 TO WS-AH-REM-TERM-CALC
  9724                                    EC-ST-AH-REM-TERM-CALC
  9725     END-IF
  9726
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 178
* EL050.cbl
  9727     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9728        MOVE CF-ST-REFUND-CALC (SUB3)
  9729                                 TO WS-AH-REFUND-CALC
  9730                                    EC-ST-AH-REFUND-CALC
  9731     END-IF
  9732
  9733*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9734
  9735     GO TO 0500-SET-ACCOUNT.
  9736
  9737 0499-STATE-NOT-FOUND.
  9738
  9739     MOVE ER-2603                TO WS-ERROR.
  9740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9741
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 179
* EL050.cbl
  9743
  9744 0500-SET-ACCOUNT.
  9745*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9746     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9747        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9748        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9749        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9750        MOVE '3'                 TO CNTL-REC-TYPE
  9751        MOVE +0                  TO CNTL-SEQ-NO
  9752
  9753        MOVE '3'                 TO RC-SW-2
  9754        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9755
  9756        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9757           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9758           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9759           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9760                                    WS-ST-AH-PREM-TAX-I
  9761                                    WS-ST-AH-PREM-TAX-G
  9762        ELSE
  9763           IF CF-ST-LF-PREM-TAX NUMERIC
  9764              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9765           END-IF
  9766           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9767              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9768           END-IF
  9769           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9770              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9771           END-IF
  9772        END-IF
  9773        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9774     END-IF
  9775*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9776*  FOR DCC ONLY
  9777     IF PB-COMPANY-ID = 'DCC'
  9778
  9779     MOVE ' '                    TO STAT-MASTER-SW
  9780     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9781     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9782     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9783     MOVE PB-STATE               TO ELSTAT-STATE
  9784     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9785        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9786     END-IF
  9787
  9788     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9789     SET BIN-TO-GREG             TO TRUE
  9790     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9791     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9792     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9793
  9794     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9795     IF STAT-MASTER-FOUND
  9796        MOVE 'N'                 TO STAT-MASTER-SW
  9797        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9798        IF STAT-MASTER-FOUND
  9799           IF (ELSTAT-KEY-SAVE (1:12) =
  9800                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 180
* EL050.cbl
  9801              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9802                 MOVE 'F'        TO STAT-MASTER-SW
  9803              ELSE
  9804                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9805                 IF (STAT-MASTER-FOUND)
  9806                    AND (ELSTAT-KEY-SAVE (1:12) =
  9807                        SF-CONTROL-PRIMARY (1:12))
  9808                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9809                    MOVE 'F'     TO STAT-MASTER-SW
  9810                 END-IF
  9811              END-IF
  9812           END-IF
  9813        END-IF
  9814     END-IF
  9815
  9816     IF STAT-MASTER-SW = 'F'
  9817        IF SF-ST-LF-PREM-TAX NUMERIC
  9818           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9819        END-IF
  9820        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9821           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9822        END-IF
  9823        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9824           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9825        END-IF
  9826     END-IF
  9827
  9828     END-IF
  9829     IF (PB-COMPANY-ID = 'DCC')
  9830        AND (PB-ISSUE)
  9831        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9832        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9833        AND (AM-GPCD = 06)
  9834        MOVE 'Y'                 TO WS-GOOD-HIN
  9835        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9836           MOVE PB-I-VIN         TO WS-WORK-VIN
  9837           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9838              (V1 > 16)
  9839              IF WS-WORK-VIN (V1:1) NUMERIC
  9840                 MOVE WS-WORK-VIN-N (V1)
  9841                                 TO WS-ROW-B-VAL (V1)
  9842              ELSE
  9843                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9844                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9845                    OR (V2 > 26)
  9846                 END-PERFORM
  9847                 IF V2 < 27
  9848                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9849                 ELSE
  9850                    MOVE 'N'     TO WS-GOOD-HIN
  9851                 END-IF
  9852              END-IF
  9853              COMPUTE WS-ROW-D-VAL (V1) =
  9854                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9855              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9856                 WS-ROW-D-VAL (V1)
  9857           END-PERFORM
  9858           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 181
* EL050.cbl
  9859           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9860             REMAINDER WS-VIN-REMAINDER
  9861           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9862              CONTINUE
  9863           ELSE
  9864              MOVE 'N'           TO WS-GOOD-HIN
  9865           END-IF
  9866        ELSE
  9867           MOVE 'N'              TO WS-GOOD-HIN
  9868        END-IF
  9869        IF WS-GOOD-HIN NOT = 'Y'
  9870           MOVE ER-3826           TO WS-ERROR
  9871           PERFORM 9900-ERROR-FORMAT
  9872                                 THRU 9900-EXIT
  9873        END-IF
  9874     END-IF
  9875     IF (PB-COMPANY-ID = 'DCC')
  9876        AND (PB-ISSUE)
  9877        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9878        AND (AM-GPCD NOT = 06)
  9879        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9880          MOVE PB-I-VIN          TO WS-WORK-VIN
  9881          MOVE +8                TO V2
  9882          MOVE ZEROS             TO WS-VIN-TOTAL
  9883          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9884           (V1 > 17)
  9885             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9886                MOVE ER-3825     TO WS-ERROR
  9887                PERFORM 9900-ERROR-FORMAT
  9888                                 THRU 9900-EXIT
  9889             ELSE
  9890                IF V1 = 8
  9891                   MOVE 10       TO V2
  9892                END-IF
  9893                IF V1 = 9
  9894                   MOVE 0        TO V2
  9895                END-IF
  9896                IF V1 = 10
  9897                   MOVE 9        TO V2
  9898                END-IF
  9899                IF WS-WORK-VIN (V1:1) NUMERIC
  9900                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9901                    + (WS-WORK-VIN-N (V1) * V2)
  9902                ELSE
  9903                   MOVE WS-WORK-VIN (V1:1)
  9904                                 TO WS-HEX-BYTE
  9905                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9906                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9907                    + (WS-NUM (V3) * V2)
  9908                END-IF
  9909                COMPUTE V2 = V2 - 1
  9910             END-IF
  9911          END-PERFORM
  9912          MOVE ZEROS TO WS-VIN-REMAINDER
  9913          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9914             REMAINDER WS-VIN-REMAINDER
  9915          IF ((WS-WORK-VIN (9:1) = 'X')
  9916             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 182
* EL050.cbl
  9917                     OR
  9918             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9919             CONTINUE
  9920          ELSE
  9921             MOVE ER-3826        TO WS-ERROR
  9922             PERFORM 9900-ERROR-FORMAT
  9923                                 THRU 9900-EXIT
  9924          END-IF
  9925        ELSE
  9926          MOVE ER-3826           TO WS-ERROR
  9927          PERFORM 9900-ERROR-FORMAT
  9928                                 THRU 9900-EXIT
  9929        END-IF
  9930     END-IF
  9931******************************************************************
  9932******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9933******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9934******* METHODS.
  9935******************************************************************
  9936     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9937        IF PB-CANCELLATION
  9938           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9939              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9940                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9941                IF FORM-MASTER-FOUND
  9942                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9943******************************************************************
  9944
  9945     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9946     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9947
  9948     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9949     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9950     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9951     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9952
  9953
  9954     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9955     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9956     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9957
  9958     IF AM-LF-OB-RATE NOT NUMERIC
  9959         MOVE ZERO               TO AM-LF-OB-RATE.
  9960
  9961     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9962         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9963
  9964     IF AM-AH-OB-RATE NOT NUMERIC
  9965         MOVE ZERO               TO AM-AH-OB-RATE.
  9966
  9967     IF WS-LF-JOINT-INDICATOR = 'J'
  9968         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9969     ELSE
  9970         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9971
  9972     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9973
  9974     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 183
* EL050.cbl
  9975         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9976
  9977     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9978         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9979                                       WS-IG-OVRD
  9980     ELSE
  9981         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9982             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9983                                       WS-IG-OVRD
  9984         ELSE
  9985             MOVE AM-IG             TO WS-IG-OVRD-AH
  9986                                       WS-IG-OVRD.
  9987
  9988     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9989         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9990                                       WS-IG-OVRD
  9991     ELSE
  9992         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9993             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9994                                       WS-IG-OVRD
  9995         ELSE
  9996             MOVE AM-IG             TO WS-IG-OVRD-LF
  9997                                       WS-IG-OVRD.
  9998
  9999     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10000     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10001     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10002     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10003     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10004
 10005     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10006     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10007     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10008     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10009
 10010     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10011     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10012     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10013     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10014     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10015     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10016     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10017
 10018     IF WS-ACCT-AH-DEV-PCT > +0
 10019        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10020     ELSE
 10021        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10022
 10023     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10024        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10025     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10026        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10027
 10028        IF AM-EARN-METHOD-L = 'S'
 10029            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10030                                        WS-LF-REFUND-CALC.
 10031
 10032        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 184
* EL050.cbl
 10033            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10034                                        WS-LF-REFUND-CALC.
 10035
 10036     IF WS-LF-COVERAGE-TYPE = 'R'
 10037         IF AM-EARN-METHOD-R = 'R'
 10038            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10039                                    WS-LF-REFUND-CALC.
 10040     IF WS-LF-COVERAGE-TYPE = 'R'
 10041         IF AM-EARN-METHOD-R = 'P'
 10042            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10043                                    WS-LF-REFUND-CALC.
 10044     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10045         IF AM-EARN-METHOD-L = 'R'
 10046            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10047                                    WS-LF-REFUND-CALC.
 10048     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10049         IF AM-EARN-METHOD-L = 'P'
 10050            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10051                                    WS-LF-REFUND-CALC.
 10052     IF WS-LF-COVERAGE-TYPE = 'R'
 10053         IF AM-EARN-METHOD-R = 'A'
 10054            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10055                                    WS-LF-REFUND-CALC.
 10056     IF WS-LF-COVERAGE-TYPE = 'R'
 10057         IF AM-EARN-METHOD-R = 'M'
 10058            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10059                                    WS-LF-REFUND-CALC.
 10060     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10061         IF AM-EARN-METHOD-L = 'A'
 10062            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10063                                    WS-LF-REFUND-CALC.
 10064     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10065         IF AM-EARN-METHOD-L = 'M'
 10066            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10067                                    WS-LF-REFUND-CALC.
 10068
 10069     IF AM-EARN-METHOD-A = 'R'
 10070        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10071                                    WS-AH-REFUND-CALC.
 10072     IF AM-EARN-METHOD-A = 'P'
 10073        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10074                                    WS-AH-REFUND-CALC.
 10075     IF AM-EARN-METHOD-A = 'C'
 10076        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10077                                    WS-AH-REFUND-CALC.
 10078     IF AM-EARN-METHOD-A = 'A'
 10079        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10080                                    WS-AH-REFUND-CALC.
 10081     IF AM-EARN-METHOD-A = 'M'
 10082        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10083                                    WS-AH-REFUND-CALC.
 10084     IF AM-EARN-METHOD-A = 'N'
 10085        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10086                                    WS-AH-REFUND-CALC.
 10087     IF AM-EARN-METHOD-A = 'S'
 10088        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10089                                    WS-AH-REFUND-CALC.
 10090
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 185
* EL050.cbl
 10091     IF AM-TOL-PREM NOT = ZEROS
 10092        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10093                                    WS-TOL-AH-PREM.
 10094
 10095     IF AM-OVR-SHT-AMT NUMERIC AND
 10096                  AM-OVR-SHT-AMT > 0
 10097        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10098                                    EC-AM-LF-OVR-SHT-AMT
 10099                                    WS-AH-REFUND-OVS-AMT
 10100                                    EC-AM-AH-OVR-SHT-AMT.
 10101
 10102     IF AM-OVR-SHT-PCT NUMERIC AND
 10103                    AM-OVR-SHT-PCT > 0
 10104        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10105                                    EC-AM-LF-OVR-SHT-PCT
 10106                                    WS-AH-REFUND-OVS-PCT
 10107                                    EC-AM-AH-OVR-SHT-PCT.
 10108
 10109     IF AM-TOL-REF-PCT NUMERIC AND
 10110                  AM-TOL-REF-PCT > 0
 10111        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10112                                    WS-TOL-AH-REFUND-PCT.
 10113
 10114     IF AM-TOL-REF  NOT = ZEROS  AND
 10115                  AM-TOL-REF NUMERIC
 10116        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10117                                    EC-AM-LF-TOL-REFUND
 10118                                    WS-TOL-AH-REFUND
 10119                                    EC-AM-AH-TOL-REFUND.
 10120
 10121     IF AM-TOL-CLM  NOT = ZEROS
 10122        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10123                                    WS-TOL-AH-CLAIM.
 10124
 10125     IF AM-CLP-TOL-PCT NOT NUMERIC
 10126        MOVE +0                  TO AM-CLP-TOL-PCT
 10127     END-IF
 10128
 10129     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10130        MOVE +0                  TO AM-SPP-LEASE-COMM
 10131     END-IF
 10132     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10133        MOVE WS-PL-TOL-LF-PREM-PCT
 10134                                 TO WS-TOL-LF-PREM-PCT.
 10135
 10136     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10137        MOVE WS-PL-TOL-AH-PREM-PCT
 10138                                 TO WS-TOL-AH-PREM-PCT.
 10139
 10140     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10141        MOVE WS-PL-TOL-LF-REFUND-PCT
 10142                                 TO WS-TOL-LF-REFUND-PCT.
 10143
 10144     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10145        MOVE WS-PL-TOL-AH-REFUND-PCT
 10146                                 TO WS-TOL-AH-REFUND-PCT.
 10147
 10148     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 186
* EL050.cbl
 10149        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10150
 10151     IF WS-PL-REF-OVS-PCT > +0
 10152        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10153
 10154     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10155        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10156     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10157        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10158     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10159        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10160     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10161        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10162     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10163        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10164     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10165        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10166
 10167     IF WS-AH-PL-REF-OVS-AMT > +0
 10168        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10169
 10170     IF WS-AH-PL-REF-OVS-PCT > +0
 10171        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10172
 10173     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10174     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10175
 10176     IF PB-CANCELLATION
 10177        GO TO 3000-CONTINUE-EDIT.
 10178
 10179     MOVE +1 TO SUB1.
 10180     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10181     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10182
 10183     IF CF-COMPANY-ID = 'DMD'
 10184       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10185         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10186        ELSE
 10187         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10188
 10189  0525-FIND-ACCT-COMM.
 10190     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10191        NEXT SENTENCE
 10192      ELSE
 10193         ADD +1 TO SUB1
 10194         IF SUB1 LESS +11
 10195            GO TO 0525-FIND-ACCT-COMM
 10196          ELSE
 10197             GO TO 0560-EDIT-CONTINUE.
 10198
 10199     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10200     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10201                                    PB-I-LIFE-COMMISSION.
 10202***  IF PB-COMPANY-ID = 'CRI'
 10203     IF PB-PREM-ACCTNG-ONLY
 10204         GO TO 0560-EDIT-CONTINUE.
 10205
 10206     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 187
* EL050.cbl
 10207     MOVE ' '    TO WS-CTBL-READ-SW.
 10208
 10209
 10210 0530-GET-AH-COMP.
 10211     IF NO-AH-COVERAGE  OR
 10212        NO-AH-BENEFIT-MATCH
 10213           GO TO 0540-NEXT-READ-STEP.
 10214
 10215     IF AM-A-COM (SUB1) NUMERIC
 10216        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10217         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10218         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10219         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10220         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10221     ELSE
 10222          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10223          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10224          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10225          MOVE ZEROS             TO WS-SUB1
 10226                                    WS-COMMISSION
 10227          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10228          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10229          IF WS-COMMISSION > ZEROS
 10230             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10231             GO TO 0540-NEXT-READ-STEP
 10232          END-IF
 10233          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10234          IF CTBL-TABLE-FOUND
 10235             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10236                                        PB-I-AH-TERM
 10237             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10238             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10239             GO TO 0540-NEXT-READ-STEP
 10240          ELSE
 10241             IF FIRST-TIME-THROUGH
 10242                 GO TO 0530-GET-AH-COMP
 10243             ELSE
 10244                 MOVE ER-2609                TO WS-ERROR
 10245                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10246
 10247 0540-NEXT-READ-STEP.
 10248     MOVE '0540' TO CTBL-SW.
 10249     MOVE ' '    TO WS-CTBL-READ-SW.
 10250
 10251 0540-GET-LF-COMP.
 10252     IF NO-LIFE-COVERAGE  OR
 10253        NO-LF-BENEFIT-MATCH
 10254           GO TO 0560-EDIT-CONTINUE.
 10255
 10256     IF WS-LF-JOINT-INDICATOR = 'J'
 10257        IF AM-J-COM (SUB1) NUMERIC
 10258           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10259           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10260           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10261           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10262           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10263        ELSE
 10264           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 188
* EL050.cbl
 10265           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10266           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10267           MOVE ZEROS                TO WS-SUB1
 10268                                        WS-COMMISSION
 10269           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10270           IF WS-COMMISSION > ZEROS
 10271              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10272              GO TO 0560-EDIT-CONTINUE
 10273           END-IF
 10274           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10275           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10276           IF CTBL-TABLE-FOUND
 10277              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10278              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10279              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10280              GO TO 0560-EDIT-CONTINUE
 10281           ELSE
 10282              IF FIRST-TIME-THROUGH
 10283                  GO TO 0540-GET-LF-COMP
 10284              ELSE
 10285                  MOVE ER-2609                TO WS-ERROR
 10286                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10287                  GO TO 0560-EDIT-CONTINUE.
 10288
 10289     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10290        IF AM-L-COM (SUB1) NUMERIC
 10291           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10292           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10293           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10294           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10295           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10296        ELSE
 10297           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10298           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10299           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10300           MOVE ZEROS                TO WS-SUB1
 10301                                        WS-COMMISSION
 10302           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10303           IF WS-COMMISSION IS GREATER THAN ZEROS
 10304              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10305              GO TO 0560-EDIT-CONTINUE
 10306           END-IF
 10307           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10308           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10309           IF CTBL-TABLE-FOUND
 10310              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10311              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10312              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10313              GO TO 0560-EDIT-CONTINUE
 10314           ELSE
 10315              IF FIRST-TIME-THROUGH
 10316                  GO TO 0540-GET-LF-COMP
 10317              ELSE
 10318                  MOVE ER-2609                TO WS-ERROR
 10319                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10320
 10321*    GO TO 0560-EDIT-CONTINUE.
 10322
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 189
* EL050.cbl
 10323 0560-EDIT-CONTINUE.
 10324     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10325                                    WS-AH-PMF-COMM
 10326*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10327*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10328     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10329        (SUB1 > +10)
 10330        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10331           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10332           MOVE '0530'           TO CTBL-SW
 10333           MOVE ' '              TO WS-CTBL-READ-SW
 10334           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10335           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10336           MOVE '0540'           TO CTBL-SW
 10337           MOVE ' '              TO WS-CTBL-READ-SW
 10338           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10339        END-IF
 10340     END-PERFORM
 10341     GO TO 0564-EDIT-CONTINUE
 10342     .
 10343 0561-CHECK-AH.
 10344     IF (NO-AH-COVERAGE)
 10345        OR (NO-AH-BENEFIT-MATCH)
 10346        CONTINUE
 10347     ELSE
 10348        IF (AM-A-COM (SUB1) NUMERIC)
 10349           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10350           IF (AM-COM-TYP (SUB1) = 'A')
 10351              AND (WS-AH-PMF-COMM = ZEROS)
 10352              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10353           END-IF
 10354           CONTINUE
 10355        ELSE
 10356           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10357           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10358           MOVE PB-AH-OVERRIDE-L1
 10359                                 TO CTBL-BEN-TYPE
 10360           MOVE ZEROS            TO WS-SUB1
 10361                                    WS-COMMISSION
 10362           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10363           PERFORM 8300-READ-CTBL-TABLE
 10364                                 THRU 8300-EXIT
 10365           IF CTBL-TABLE-FOUND
 10366              IF (AM-COM-TYP (SUB1) = 'A')
 10367                 AND (WS-AH-PMF-COMM = ZEROS)
 10368                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10369                                        PB-I-AH-TERM
 10370                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10371                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10372              END-IF
 10373              CONTINUE
 10374           ELSE
 10375              IF FIRST-TIME-THROUGH
 10376                 GO TO 0561-CHECK-AH
 10377              ELSE
 10378                 MOVE ER-2609    TO WS-ERROR
 10379                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10380              END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 190
* EL050.cbl
 10381           END-IF
 10382        END-IF
 10383     END-IF
 10384     .
 10385 0561-EXIT.
 10386     EXIT.
 10387 0563-CHECK-LF.
 10388     IF (NO-LIFE-COVERAGE)
 10389        OR (NO-LF-BENEFIT-MATCH)
 10390        CONTINUE
 10391     ELSE
 10392        IF WS-LF-JOINT-INDICATOR = 'J'
 10393           IF AM-J-COM (SUB1) NUMERIC
 10394              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10395              IF (AM-COM-TYP (SUB1) = 'A')
 10396                 AND (WS-LF-PMF-COMM = ZEROS)
 10397                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10398              END-IF
 10399              CONTINUE
 10400           ELSE
 10401              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10402              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10403              MOVE PB-LIFE-OVERRIDE-L1
 10404                                 TO CTBL-BEN-TYPE
 10405              MOVE ZEROS         TO WS-SUB1
 10406                                    WS-COMMISSION
 10407              MOVE AM-J-COMA (SUB1)
 10408                                 TO CTBL-TABLE
 10409              PERFORM 8300-READ-CTBL-TABLE
 10410                                 THRU 8300-EXIT
 10411              IF CTBL-TABLE-FOUND
 10412                 IF (AM-COM-TYP (SUB1) = 'A')
 10413                    AND (WS-LF-PMF-COMM = ZEROS)
 10414                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10415                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10416                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10417                 END-IF
 10418                 CONTINUE
 10419              ELSE
 10420                 IF FIRST-TIME-THROUGH
 10421                    GO TO 0563-CHECK-LF
 10422                 ELSE
 10423                    MOVE ER-2609 TO WS-ERROR
 10424                    PERFORM 9900-ERROR-FORMAT
 10425                                 THRU 9900-EXIT
 10426*                   GO TO 0560-EDIT-CONTINUE
 10427                 END-IF
 10428              END-IF
 10429           END-IF
 10430        ELSE
 10431           IF AM-L-COM (SUB1) NUMERIC
 10432              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10433              IF (AM-COM-TYP (SUB1) = 'A')
 10434                 AND (WS-LF-PMF-COMM = ZEROS)
 10435                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10436              END-IF
 10437              CONTINUE
 10438           ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 191
* EL050.cbl
 10439              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10440              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10441              MOVE PB-LIFE-OVERRIDE-L1
 10442                                 TO CTBL-BEN-TYPE
 10443              MOVE ZEROS         TO WS-SUB1
 10444                                    WS-COMMISSION
 10445              MOVE AM-L-COMA (SUB1)
 10446                                 TO CTBL-TABLE
 10447              PERFORM 8300-READ-CTBL-TABLE
 10448                                 THRU 8300-EXIT
 10449              IF CTBL-TABLE-FOUND
 10450                 CONTINUE
 10451              ELSE
 10452                 IF FIRST-TIME-THROUGH
 10453                    GO TO 0563-CHECK-LF
 10454                 ELSE
 10455                    MOVE ER-2609 TO WS-ERROR
 10456                    PERFORM 9900-ERROR-FORMAT
 10457                                 THRU 9900-EXIT
 10458                 END-IF
 10459              END-IF
 10460           END-IF
 10461        END-IF
 10462     END-IF
 10463     .
 10464 0563-EXIT.
 10465     EXIT.
 10466 0564-EDIT-CONTINUE.
 10467
 10468     IF  PB-COMPANY-ID EQUAL 'DMD'
 10469         IF PB-I-NUM-BILLED EQUAL ZEROS
 10470            MOVE ER-8148       TO WS-ERROR
 10471            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10472
 10473*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10474*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10475*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10476*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10477*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10478*         IF NO-CONVERSION-ERROR
 10479*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10480*         ELSE
 10481*             IF PB-COMPANY-ID EQUAL 'HAN'
 10482*                 MOVE ZEROS     TO PB-I-AGE.
 10483     IF PB-I-BIRTHDAY > LOW-VALUES
 10484        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10485        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10486        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10487        PERFORM 8500-DATE-CONVERT
 10488                                 THRU 8500-EXIT
 10489        IF NO-CONVERSION-ERROR
 10490           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10491           IF PB-I-AGE > ZEROS
 10492              IF WS-WORK-AGE NOT = PB-I-AGE
 10493                 MOVE ER-9501    TO WS-ERROR
 10494                 PERFORM 9900-ERROR-FORMAT
 10495                                 THRU 9900-EXIT
 10496              END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 192
* EL050.cbl
 10497           ELSE
 10498              MOVE WS-WORK-AGE   TO PB-I-AGE
 10499           END-IF
 10500        END-IF
 10501     END-IF
 10502     IF PB-I-AGE = ZEROS
 10503        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10504           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10505
 10506     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10507                                   WS-AH-EDIT-AGE.
 10508
 10509     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10510        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10511        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10512        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10513        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10514        IF NO-CONVERSION-ERROR
 10515           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10516           IF PB-I-JOINT-AGE > 0
 10517              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10518                 MOVE ER-9503    TO WS-ERROR
 10519                 PERFORM 9900-ERROR-FORMAT
 10520                                 THRU 9900-EXIT
 10521              END-IF
 10522           ELSE
 10523              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10524           END-IF
 10525        ELSE
 10526           MOVE ZEROS            TO PB-I-JOINT-AGE
 10527        END-IF
 10528     END-IF
 10529     IF PB-I-JOINT-AGE NOT NUMERIC
 10530        MOVE ZERO               TO PB-I-JOINT-AGE.
 10531
 10532     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10533        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10534           (WS-AH-JOINT-INDICATOR = 'J')
 10535           IF PB-I-JOINT-AGE = ZEROS
 10536               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10537           END-IF
 10538        END-IF
 10539     END-IF
 10540
 10541     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10542     IF WS-LF-JOINT-INDICATOR = 'J'
 10543        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10544        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10545            IF  PB-I-JOINT-AGE = ZERO
 10546                MOVE ER-2686       TO WS-ERROR
 10547                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10548            ELSE
 10549                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10550                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10551                    IF PB-COMPANY-ID NOT = 'LBL'
 10552                        MOVE ER-2685    TO WS-ERROR
 10553                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10554
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 193
* EL050.cbl
 10555     IF WS-AH-JOINT-INDICATOR = 'J'
 10556        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10557            IF  PB-I-JOINT-AGE = ZERO
 10558                MOVE ER-2686       TO WS-ERROR
 10559                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10560            ELSE
 10561                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10562                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10563                                           WS-EDIT-AGE
 10564                    IF PB-COMPANY-ID NOT = 'LBL'
 10565                        MOVE ER-2685    TO WS-ERROR
 10566                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10567
 10568******************************************************************
 10569*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10570******************************************************************
 10571
 10572     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10573        (WS-AH-SPECIAL-CALC-CD = 'O')
 10574        NEXT SENTENCE
 10575     ELSE
 10576        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10577          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10578           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10579            WS-AH-JOINT-INDICATOR = 'J')  AND
 10580           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10581            MOVE ER-2627             TO WS-ERROR
 10582            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10583
 10584     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10585        (WS-AH-SPECIAL-CALC-CD = 'O')
 10586         NEXT SENTENCE
 10587     ELSE
 10588         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10589            WS-AH-JOINT-INDICATOR = 'J'
 10590             IF PB-I-JOINT-INSURED = SPACES
 10591                 IF PB-COMPANY-ID NOT = 'JAL'
 10592                     MOVE ER-2696    TO WS-ERROR
 10593                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10594
 10595     IF PB-COMPANY-ID NOT = 'BOA'
 10596        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10597           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10598           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10599               PB-I-JOINT-INSURED NOT = SPACES)
 10600                MOVE ER-2691         TO WS-ERROR
 10601                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10602
 10603     IF PB-COMPANY-ID = 'BOA'
 10604        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10605           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10606            IF PB-I-JOINT-AGE NOT = ZEROS
 10607                MOVE ER-2691         TO WS-ERROR
 10608                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10609
 10610     IF PB-COMPANY-ID = 'CRI'
 10611        IF PB-I-SIG-SW = 'J'
 10612           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 194
* EL050.cbl
 10613              WS-AH-JOINT-INDICATOR NOT = 'J'
 10614              MOVE ER-2675       TO WS-ERROR
 10615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10616
 10617     IF PB-COMPANY-ID = 'CRI'
 10618        IF PB-I-SIG-SW = 'S'
 10619           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10620              WS-AH-JOINT-INDICATOR = 'J'
 10621              MOVE ER-2676       TO WS-ERROR
 10622              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10623
 10624     IF PB-COMPANY-ID = 'CVL'
 10625         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10626            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10627              MOVE ER-2783           TO WS-ERROR
 10628              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10629     IF (WS-LF-JOINT-INDICATOR = 'J')
 10630        AND (WS-AH-JOINT-INDICATOR = 'J')
 10631        AND (PB-I-LF-TERM > 120)
 10632        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10633        MOVE ER-2783             TO WS-ERROR
 10634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10635     END-IF
 10636     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10637
 10638     IF PB-I-INDV-GRP-OVRD = 'I'
 10639        MOVE ER-2666             TO WS-ERROR
 10640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10641        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10642
 10643     IF PB-I-INDV-GRP-OVRD = 'G'
 10644        MOVE ER-2666             TO WS-ERROR
 10645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10646        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10647
 10648     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10649        NEXT SENTENCE
 10650     ELSE
 10651        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10652
 10653     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10654        IF WS-ERROR = ER-2666
 10655           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10656           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10657
 10658     IF PB-COMPANY-ID = 'CID'
 10659        IF PB-STATE = 'UT' OR 'MO'
 10660           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10661                 OR '76' OR '77')
 10662                      OR
 10663               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10664                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10665                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10666                   OR '2K' OR '2L'))
 10667              AND PB-I-INDV-GRP-CD = 'I'
 10668              MOVE ER-2721             TO WS-ERROR
 10669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10670           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 195
* EL050.cbl
 10671        END-IF
 10672     END-IF
 10673
 10674     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10675     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10676        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10677     ELSE
 10678        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10679     END-IF
 10680
 10681*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10682*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10683     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10684                                    ACCOUNT-AH-CK-SW.
 10685
 10686     IF PB-REISSUED-CERT       OR
 10687        PB-REIN-ONLY-CERT      OR
 10688        PB-POLICY-IS-DECLINED  OR
 10689        PB-POLICY-IS-VOIDED
 10690*       OR PB-MONTHLY-CERT
 10691         GO TO 3000-CONTINUE-EDIT.
 10692
 10693     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10694        IF WS-EDIT-AGE           > +65
 10695           MOVE ER-2709          TO WS-ERROR
 10696           PERFORM 9900-ERROR-FORMAT
 10697                                 THRU 9900-EXIT
 10698        ELSE
 10699           IF WS-EDIT-AGE        > +55
 10700              MOVE ER-2718       TO WS-ERROR
 10701              PERFORM 9900-ERROR-FORMAT
 10702                                 THRU 9900-EXIT
 10703           END-IF
 10704        END-IF
 10705     IF PB-COMPANY-ID = 'DCC'
 10706        IF WS-EDIT-AGE           > +65
 10707           MOVE ER-2709          TO WS-ERROR
 10708           PERFORM 9900-ERROR-FORMAT
 10709                                 THRU 9900-EXIT
 10710        END-IF
 10711     END-IF
 10712     .
 10713
 10714 0565-LIFE-PLAN-LIMIT-EDITS.
 10715
 10716     IF NOT LF-PLAN-MASTER-FOUND
 10717        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10718                                    EC-AM-LF-MAX-TOT-BEN
 10719        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10720
 10721     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10722
 10723     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10724         IF PL-LM-AGE (1) = ZEROS
 10725             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10726
 10727     IF NO-LF-BENEFIT-MATCH          OR
 10728        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 196
* EL050.cbl
 10729        WS-LF-SPECIAL-CALC-CD = 'M'
 10730        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10731
 10732     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10733     MOVE +1                     TO SUB2.
 10734
 10735     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10736        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10737           MOVE +5   TO SUB2
 10738           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10739              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10740              (PL-LM-AGE (SUB2) EQUAL +0)
 10741              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10742              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10743
 10744     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10745
 10746     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10747                               + PB-I-LF-ALT-BENEFIT-AMT.
 10748
 10749 0568-CHECK-LIFE-ATT-AGE.
 10750
 10751     IF PL-ATT-AGE NUMERIC AND
 10752        PL-ATT-AGE > +0
 10753        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10754     END-IF
 10755*    IF PL-ATT-AGE NUMERIC AND
 10756*       PL-ATT-AGE > +0
 10757*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10758*       IF PB-I-BIRTHDAY > LOW-VALUES
 10759*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10760*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10761*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10762*          SET BIN-PLUS-ELAPSED  TO TRUE
 10763*          PERFORM 8500-DATE-CONVERT
 10764*                                THRU 8500-EXIT
 10765*          IF NO-CONVERSION-ERROR
 10766*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10767*             MOVE ER-2669       TO WS-ERROR
 10768*             PERFORM 9900-ERROR-FORMAT
 10769*                                THRU 9900-EXIT
 10770*          END-IF
 10771*       ELSE
 10772*          IF WS-ATT-AGE >= PL-ATT-AGE
 10773*             MOVE ER-2669       TO WS-ERROR
 10774*             PERFORM 9900-ERROR-FORMAT
 10775*                                THRU 9900-EXIT
 10776*          END-IF
 10777*       END-IF
 10778*    END-IF
 10779     .
 10780 0570-CHECK-LIFE-LIMITS.
 10781
 10782     IF PB-COMPANY-ID EQUAL 'CRI'
 10783        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10784           IF SUB2 GREATER THAN +4
 10785              MOVE ER-2637 TO WS-ERROR
 10786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 197
* EL050.cbl
 10787              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10788
 10789     IF PB-COMPANY-ID  =  'NCL'
 10790        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10791            SUB2 GREATER THAN +8
 10792             MOVE 'U'         TO PB-BATCH-ENTRY
 10793             MOVE ER-2637     TO WS-ERROR
 10794             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10795             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10796
 10797     IF SUB2 > +8
 10798        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10799           AND (PB-I-SIG-SW = 'Y')
 10800           CONTINUE
 10801        ELSE
 10802           MOVE ER-2637          TO WS-ERROR
 10803           PERFORM 9900-ERROR-FORMAT
 10804                                 THRU 9900-EXIT
 10805        END-IF
 10806        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10807     END-IF
 10808     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10809     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10810     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10811
 10812     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10813        ADD +1  TO SUB2
 10814        GO TO 0570-CHECK-LIFE-LIMITS.
 10815
 10816     IF PB-COMPANY-ID = 'NCL'
 10817         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10818
 10819     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10820        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10821        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10822           AND (PB-I-SIG-SW = 'Y')
 10823           CONTINUE
 10824        ELSE
 10825           MOVE ER-2637          TO WS-ERROR
 10826           PERFORM 9900-ERROR-FORMAT
 10827                                 THRU 9900-EXIT
 10828        END-IF
 10829     END-IF
 10830     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10831
 10832
 10833 0570-CHECK-NCL-LIFE-LIMITS.
 10834
 10835     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10836        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10837         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10838
 10839     IF APP-CERT-USED
 10840         IF SUB2  LESS THAN  +5
 10841             MOVE +5          TO SUB2
 10842             GO TO 0570-CHECK-LIFE-LIMITS.
 10843
 10844     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 198
* EL050.cbl
 10845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10846
 10847     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10848
 10849 0575-CHECK-NCL-SIG-SWITCH.
 10850
 10851     IF NOT APP-CERT-USED
 10852         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10853
 10854     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10855        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10856        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10857        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10858         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10859
 10860     IF SUB2 GREATER THAN +4
 10861         IF PL-LM-AGE (5) = ZEROS  AND
 10862            PL-LM-AGE (6) = ZEROS  AND
 10863            PL-LM-AGE (7) = ZEROS  AND
 10864            PL-LM-AGE (8) = ZEROS
 10865             MOVE  ER-1927        TO WS-ERROR
 10866             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10867             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10868         ELSE
 10869             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10870                 MOVE  ER-1920    TO WS-ERROR
 10871                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10872
 10873     IF PB-I-SIG-SW  = 'Y'
 10874       IF NOT PB-I-POLICY-ACCEPTED  AND
 10875          NOT PB-I-POLICY-DECLINED
 10876           MOVE 'U'               TO PB-BATCH-ENTRY
 10877           MOVE  ER-1926          TO WS-ERROR
 10878           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10879
 10880
 10881 0580-AH-PLAN-LIMIT-EDITS.
 10882
 10883     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10884        IF PB-I-AH-BENEFIT-AMT > +1250
 10885           MOVE ER-2702          TO WS-ERROR
 10886           PERFORM 9900-ERROR-FORMAT
 10887                                 THRU 9900-EXIT
 10888        END-IF
 10889     END-IF
 10890
 10891     IF (PB-COMPANY-ID = 'DCC')
 10892        AND (PB-MONTHLY-CERT)
 10893        IF PB-I-AH-BENEFIT-AMT > +3000
 10894           MOVE ER-2881          TO WS-ERROR
 10895           PERFORM 9900-ERROR-FORMAT
 10896                                 THRU 9900-EXIT
 10897        END-IF
 10898     END-IF
 10899     IF NOT AH-PLAN-MASTER-FOUND
 10900        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10901        GO TO 3000-CONTINUE-EDIT.
 10902
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 199
* EL050.cbl
 10903     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10904
 10905     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10906         IF PL-LM-AGE (1) = ZEROS
 10907             GO TO 3000-CONTINUE-EDIT.
 10908
 10909     IF NO-AH-BENEFIT-MATCH          OR
 10910        WS-AH-BENEFIT-CD = ZEROS     OR
 10911        WS-AH-SPECIAL-CALC-CD = 'M'
 10912        GO TO 3000-CONTINUE-EDIT.
 10913
 10914     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10915     MOVE +1                     TO SUB2.
 10916
 10917     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10918        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10919           MOVE +5 TO SUB2
 10920           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10921              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10922              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10923              (PL-LM-AGE (SUB2) EQUAL +0)
 10924              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10925              GO TO 3000-CONTINUE-EDIT.
 10926
 10927     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10928
 10929 0590-CHECK-AH-ATT-AGE.
 10930
 10931     IF PL-ATT-AGE NUMERIC AND
 10932        PL-ATT-AGE GREATER THAN +0
 10933        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10934     END-IF
 10935*       IF WS-ATT-AGE >= PL-ATT-AGE
 10936*          MOVE ER-3054          TO WS-ERROR
 10937*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10938     .
 10939 0597-CHECK-AH-LIMITS.
 10940
 10941     IF PB-COMPANY-ID EQUAL 'CRI'
 10942        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10943           IF SUB2 GREATER THAN +4
 10944              MOVE ER-2638       TO WS-ERROR
 10945              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10946              GO TO 3000-CONTINUE-EDIT.
 10947
 10948     IF PB-COMPANY-ID  =  'NCL'
 10949        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10950            SUB2 GREATER THAN +8
 10951             MOVE 'U'            TO PB-BATCH-ENTRY
 10952             MOVE ER-2638        TO WS-ERROR
 10953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10954             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10955
 10956     IF SUB2 > +8
 10957        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10958           AND (PB-I-SIG-SW = 'Y')
 10959           CONTINUE
 10960        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 200
* EL050.cbl
 10961           MOVE ER-2638          TO WS-ERROR
 10962           PERFORM 9900-ERROR-FORMAT
 10963                                 THRU 9900-EXIT
 10964        END-IF
 10965        GO TO 3000-CONTINUE-EDIT
 10966     END-IF
 10967
 10968     IF PB-COMPANY-ID = 'CRI'
 10969        IF WS-ERROR = ER-2638
 10970           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10971
 10972     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10973     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10974     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10975     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10976
 10977     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10978        ADD +1                   TO SUB2
 10979        GO TO 0597-CHECK-AH-LIMITS.
 10980
 10981     IF PB-COMPANY-ID = 'NCL'
 10982         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10983
 10984     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10985        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10986        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10987                                 > PL-LM-AMT (SUB2))
 10988        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10989           AND (PB-I-SIG-SW = 'Y')
 10990           CONTINUE
 10991        ELSE
 10992           MOVE ER-2638          TO WS-ERROR
 10993           PERFORM 9900-ERROR-FORMAT
 10994                                 THRU 9900-EXIT
 10995        END-IF
 10996     END-IF
 10997
 10998     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10999         IF  WS-ERROR    EQUAL    ER-2638
 11000             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11001                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11002                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11003                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11004                MOVE  ER-1910    TO  WS-ERROR
 11005                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11006
 11007     IF PB-COMPANY-ID = 'CRI'
 11008        IF WS-ERROR = ER-2638
 11009            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11010            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11011            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11012
 11013     GO TO 3000-CONTINUE-EDIT.
 11014
 11015 0597-CHECK-NCL-AH-LIMITS.
 11016
 11017     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11018        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 201
* EL050.cbl
 11019        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11020                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11021         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11022
 11023     IF APP-CERT-USED
 11024         IF SUB2  LESS THAN  +5
 11025             MOVE +5             TO SUB2
 11026             GO TO 0597-CHECK-AH-LIMITS.
 11027
 11028     MOVE ER-2638                TO WS-ERROR.
 11029     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11030
 11031     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11032
 11033 0599-CHECK-NCL-SIG-SWITCH.
 11034
 11035     IF NOT APP-CERT-USED
 11036         GO TO 3000-CONTINUE-EDIT.
 11037
 11038     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11039        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11040        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11041        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11042         GO TO 3000-CONTINUE-EDIT.
 11043
 11044     IF SUB2 GREATER THAN +4
 11045         IF PL-LM-AGE (5) = ZEROS  AND
 11046            PL-LM-AGE (6) = ZEROS  AND
 11047            PL-LM-AGE (7) = ZEROS  AND
 11048            PL-LM-AGE (8) = ZEROS
 11049             MOVE  ER-1927        TO WS-ERROR
 11050             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11051             GO TO 3000-CONTINUE-EDIT
 11052         ELSE
 11053             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11054                 MOVE  ER-1920    TO WS-ERROR
 11055                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11056
 11057     IF PB-I-SIG-SW  = 'Y'
 11058       IF NOT PB-I-POLICY-ACCEPTED  AND
 11059          NOT PB-I-POLICY-DECLINED
 11060           MOVE 'U'               TO PB-BATCH-ENTRY
 11061           MOVE  ER-1926          TO WS-ERROR
 11062           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11063
 11064******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 202
* EL050.cbl
 11066
 11067 3000-CONTINUE-EDIT.
 11068
 11069     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11070     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11071     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11072     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11073     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11074
 11075     IF BROWSE-STARTED
 11076        PERFORM 9990-RETURN THRU 9990-EXIT
 11077        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11078
 11079     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11080        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11081        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11082        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11083*       MOVE 1                   TO DC-OPTION-CODE
 11084        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11085        IF DATE-CONVERSION-ERROR
 11086           MOVE ER-2622          TO WS-ERROR
 11087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11088        ELSE
 11089           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11090              MOVE ER-2623       TO WS-ERROR
 11091              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11092           ELSE
 11093              MOVE ER-2622       TO WS-ERROR
 11094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11095
 11096     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11097     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11098     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11099*    MOVE 1                      TO DC-OPTION-CODE.
 11100     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11101     IF DATE-CONVERSION-ERROR
 11102        GO TO 3005-EDIT-CONTINUE
 11103     ELSE
 11104        IF DC-ELAPSED-DAYS GREATER +180
 11105           MOVE ER-2613          TO WS-ERROR
 11106           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11107        ELSE
 11108           IF DC-ELAPSED-DAYS GREATER +90
 11109              MOVE ER-2612       TO WS-ERROR
 11110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11111           ELSE
 11112             IF DC-ELAPSED-DAYS GREATER +60
 11113                MOVE ER-2614     TO WS-ERROR
 11114                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11115
 11116 3005-EDIT-CONTINUE.
 11117
 11118     IF PB-CANCELLATION
 11119         GO TO 3700-EDIT-CANCEL.
 11120
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 203
* EL050.cbl
 11122******************************************************************
 11123*                  E D I T   I S S U E                           *
 11124******************************************************************
 11125
 11126 3020-EDIT-ISSUE.
 11127
 11128      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11129      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11130      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11131      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11132      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11133
 11134     IF PB-ISSUE-FORCE
 11135        OR PB-ISSUE-DATE-FORCED
 11136        OR PB-FORCE-OFF
 11137        OR PB-OVERCHARGE-FORCE
 11138        CONTINUE
 11139     ELSE
 11140        MOVE ER-2670             TO WS-ERROR
 11141        PERFORM 9900-ERROR-FORMAT
 11142                                 THRU 9900-EXIT
 11143     END-IF
 11144     .
 11145 3022-SET-POLICY-STATUS.
 11146
 11147     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11148
 11149     IF (PB-REISSUED-CERT)
 11150             OR
 11151        ((PB-COMPANY-ID NOT = 'DCC')
 11152         AND (PB-MONTHLY-CERT))
 11153         MOVE '5'                TO PB-I-ENTRY-STATUS
 11154         MOVE 'E'                TO PB-BATCH-ENTRY
 11155     END-IF
 11156
 11157     IF PB-COMPANY-ID = 'DCC'
 11158        IF PB-MONTHLY-CERT
 11159           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11160        END-IF
 11161     END-IF
 11162     IF PB-POLICY-IS-DECLINED
 11163         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11164     IF PB-POLICY-IS-VOIDED
 11165         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11166     IF PB-NEEDS-UNDERWRITING
 11167         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11168     IF PB-REIN-ONLY-CERT
 11169         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11170     IF PB-PREM-ACCTNG-ONLY
 11171         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11172
 11173     MOVE SPACE                  TO PB-I-OB-FLAG.
 11174
 11175     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11176         MOVE ER-2665            TO WS-ERROR
 11177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11178         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11179
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 204
* EL050.cbl
 11180     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11181        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11182           MOVE 'Z'             TO PB-I-OB-FLAG.
 11183
 11184     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11185        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11186           MOVE 'Z'             TO PB-I-OB-FLAG.
 11187
 11188     IF ACCOUNT-MAST-FOUND
 11189         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11190         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11191         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11192         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11193         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11194         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11195         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11196     END-IF
 11197
 11198     IF ACCOUNT-MAST-FOUND
 11199        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11200         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11201
 11202     IF (ACCOUNT-MAST-FOUND)
 11203        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11204        IF PB-REISSUED-CERT
 11205           CONTINUE
 11206        ELSE
 11207           MOVE ER-2608          TO WS-ERROR
 11208           PERFORM 9900-ERROR-FORMAT
 11209                                 THRU 9900-EXIT
 11210         END-IF
 11211     END-IF
 11212
 11213     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11214        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11215        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11216
 11217**********   DMD CUSTOM CODE FOLLOWS  **********
 11218 3024-EDIT-DMD-FIELDS.
 11219     IF PB-COMPANY-ID NOT = 'DMD'
 11220        GO TO 3025-EDIT-REINSURANCE.
 11221
 11222*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11223*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11224*** ERROR IF THEY ARE NOT EQUAL.
 11225
 11226     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11227     SET BIN-TO-GREG               TO TRUE.
 11228     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11229     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11230**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11231
 11232     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11233     SET BIN-TO-GREG               TO TRUE.
 11234     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11235     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11236**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11237
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 205
* EL050.cbl
 11238     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11239        MOVE ER-8116               TO WS-ERROR
 11240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11241
 11242     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11243
 11244     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11245                                      WK-FULL-CERT-NO.
 11246     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11247
 11248     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11249
 11250     IF PB-VALID-LIFE
 11251        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11252     ELSE
 11253        IF PB-VALID-AH
 11254          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11255
 11256
 11257     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11258     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11259     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11260                                      DCUA-UNDRWRTR-CODE
 11261                                      DCUA-UNDRWRTR-GROUP-CODE
 11262                                      DCUA-RETURN-CODE.
 11263
 11264****************************************************************
 11265*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11266***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11267***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11268***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11269***   TO THIS RECORD.                                        ***
 11270****************************************************************
 11271     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11272     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11273     IF DCUA-SUCCESSFUL-PROCESS
 11274        GO TO 3024-EDIT-DL7-CONT.
 11275
 11276     IF DCUA-RETURN-CODE EQUAL '01'
 11277        MOVE ER-8110               TO WS-ERROR
 11278        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11280        GO TO 3024-EDIT-DL7-CONT.
 11281
 11282     IF DCUA-RETURN-CODE EQUAL '02'
 11283        MOVE ER-8111               TO WS-ERROR
 11284        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11286        GO TO 3024-EDIT-DL7-CONT.
 11287
 11288     IF DCUA-RETURN-CODE EQUAL '03'
 11289        MOVE ER-8074               TO WS-ERROR
 11290        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11292        GO TO 3024-EDIT-DL7-CONT.
 11293
 11294     IF DCUA-RETURN-CODE EQUAL '04'
 11295        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 206
* EL050.cbl
 11296        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11298        GO TO 3024-EDIT-DL7-CONT.
 11299
 11300     IF DCUA-RETURN-CODE EQUAL '05'
 11301        MOVE ER-8076               TO WS-ERROR
 11302        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11304        GO TO 3024-EDIT-DL7-CONT.
 11305
 11306     IF DCUA-RETURN-CODE EQUAL '06'
 11307        MOVE ER-8077               TO WS-ERROR
 11308        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310        GO TO 3024-EDIT-DL7-CONT.
 11311
 11312     IF DCUA-RETURN-CODE EQUAL '07'
 11313        MOVE ER-8078               TO WS-ERROR
 11314        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11316        GO TO 3024-EDIT-DL7-CONT.
 11317
 11318     IF DCUA-RETURN-CODE EQUAL 'E1'
 11319        MOVE ER-8079               TO WS-ERROR
 11320        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11322        GO TO 3024-EDIT-DL7-CONT.
 11323
 11324     IF DCUA-RETURN-CODE EQUAL 'E2'
 11325        MOVE ER-8080               TO WS-ERROR
 11326        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11328        GO TO 3024-EDIT-DL7-CONT.
 11329
 11330     IF DCUA-RETURN-CODE EQUAL 'E3'
 11331        MOVE ER-8098               TO WS-ERROR
 11332        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 3024-EDIT-DL7-CONT.
 11335
 11336     IF DCUA-RETURN-CODE EQUAL 'C1'
 11337        MOVE ER-8099               TO WS-ERROR
 11338        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11340        GO TO 3024-EDIT-DL7-CONT.
 11341
 11342     IF DCUA-RETURN-CODE EQUAL 'U1'
 11343        MOVE ER-8109               TO WS-ERROR
 11344        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11346        GO TO 3024-EDIT-DL7-CONT.
 11347
 11348     IF DCUA-RETURN-CODE EQUAL 'N1'
 11349        MOVE ER-8112               TO WS-ERROR
 11350        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 3024-EDIT-DL7-CONT.
 11353
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 207
* EL050.cbl
 11354     IF DCUA-RETURN-CODE EQUAL 'N2'
 11355        MOVE ER-8113               TO WS-ERROR
 11356        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL7-CONT.
 11359
 11360     IF DCUA-RETURN-CODE EQUAL 'N3'
 11361        MOVE ER-8114               TO WS-ERROR
 11362        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364        GO TO 3024-EDIT-DL7-CONT.
 11365
 11366     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11367     MOVE ER-8097                  TO WS-ERROR.
 11368     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11369     GO TO 3024-EDIT-DL7-CONT.
 11370
 11371 3024-EDIT-DL7-CONT.
 11372
 11373     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11374     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11375     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11376        NEXT SENTENCE
 11377     ELSE
 11378        MOVE ER-9263               TO WS-ERROR
 11379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11380
 11381******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11382******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11383     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11384        NEXT SENTENCE
 11385     ELSE
 11386        MOVE ER-8039               TO WS-ERROR
 11387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11388
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 208
* EL050.cbl
 11390****************************************************************
 11391*** VALIDATE STATE  : DLO022                                 ***
 11392****************************************************************
 11393     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11394     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11395
 11396     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11397     IF DVSC-SUCCESSFUL-EDIT
 11398        GO TO 3024-EDIT-DL22-CONT.
 11399
 11400     IF DVSC-RETURN-CODE EQUAL '01'
 11401        MOVE ER-8300               TO WS-ERROR
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403        GO TO 3024-EDIT-DL22-CONT.
 11404
 11405     IF DVSC-RETURN-CODE EQUAL '02'
 11406        MOVE ER-8301               TO WS-ERROR
 11407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11408        GO TO 3024-EDIT-DL22-CONT.
 11409
 11410     IF DVSC-RETURN-CODE EQUAL '03'
 11411        MOVE ER-8302               TO WS-ERROR
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11413        GO TO 3024-EDIT-DL22-CONT.
 11414
 11415     IF DVSC-RETURN-CODE EQUAL 'N1'
 11416        MOVE ER-8304               TO WS-ERROR
 11417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11418        GO TO 3024-EDIT-DL22-CONT.
 11419
 11420     MOVE ER-8303                  TO WS-ERROR
 11421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11422
 11423 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 209
* EL050.cbl
 11425****************************************************************
 11426*** VALIDATE LOAN OFFICER : DLO021                           ***
 11427****************************************************************
 11428
 11429     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11430     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11431     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11432     IF DVLO-SUCCESSFUL-EDIT
 11433        GO TO 3024-EDIT-DL21-CONT.
 11434
 11435     IF DVLO-RETURN-CODE EQUAL '01'
 11436        MOVE ER-8081               TO WS-ERROR
 11437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11438        GO TO 3024-EDIT-DL21-CONT.
 11439
 11440     IF DVLO-RETURN-CODE EQUAL '02'
 11441        MOVE ER-8082               TO WS-ERROR
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 3024-EDIT-DL21-CONT.
 11444
 11445     IF DVLO-RETURN-CODE EQUAL '03'
 11446        MOVE ER-8083               TO WS-ERROR
 11447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11448        GO TO 3024-EDIT-DL21-CONT.
 11449
 11450     IF DVLO-RETURN-CODE EQUAL '04'
 11451        MOVE ER-8084               TO WS-ERROR
 11452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11453        GO TO 3024-EDIT-DL21-CONT.
 11454
 11455     IF DVLO-RETURN-CODE EQUAL '05'
 11456        MOVE ER-8085               TO WS-ERROR
 11457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11458        GO TO 3024-EDIT-DL21-CONT.
 11459
 11460     MOVE ER-7825                  TO WS-ERROR
 11461     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11462     GO TO 3024-EDIT-DL21-CONT.
 11463
 11464 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 210
* EL050.cbl
 11466
 11467****************************************************************
 11468*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11469****************************************************************
 11470
 11471     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11472     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11473     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11474     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11475     IF DIPF-SUCCESSFUL-EDIT
 11476        GO TO 3024-EDIT-DL02-CONT.
 11477
 11478     IF DIPF-RETURN-CODE EQUAL '01'
 11479        MOVE ER-8086               TO WS-ERROR
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL02-CONT.
 11482
 11483     IF DIPF-RETURN-CODE EQUAL '02'
 11484        MOVE ER-8087               TO WS-ERROR
 11485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486        GO TO 3024-EDIT-DL02-CONT.
 11487
 11488     IF DIPF-RETURN-CODE EQUAL '03'
 11489        MOVE ER-8088               TO WS-ERROR
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491        GO TO 3024-EDIT-DL02-CONT.
 11492
 11493     MOVE ER-8095                  TO WS-ERROR
 11494     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11495     GO TO 3024-EDIT-DL02-CONT.
 11496
 11497 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 211
* EL050.cbl
 11499
 11500****************************************************************
 11501*** VALIDATE BANK ID : DLO003                                ***
 11502****************************************************************
 11503
 11504     MOVE WK-GREG-CENT           TO WCG-CENT.
 11505     MOVE WK-GREG-YYMM           TO WCG-REST.
 11506     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11507        MOVE ER-8040               TO WS-ERROR
 11508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11509
 11510     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11511     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11512     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11513     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11514     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11515     IF DVBI-SUCCESSFUL-EDIT
 11516        GO TO 3024-EDIT-DL03-CONT.
 11517
 11518     IF DVBI-RETURN-CODE EQUAL '01'
 11519        MOVE ER-8089               TO WS-ERROR
 11520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11521        GO TO 3024-EDIT-DL03-CONT.
 11522
 11523     IF DVBI-RETURN-CODE EQUAL '02'
 11524        MOVE ER-8090               TO WS-ERROR
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11526        GO TO 3024-EDIT-DL03-CONT.
 11527
 11528     IF DVBI-RETURN-CODE EQUAL '03'
 11529        MOVE ER-8091               TO WS-ERROR
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL03-CONT.
 11532
 11533     IF DVBI-RETURN-CODE EQUAL '04'
 11534        MOVE ER-8092               TO WS-ERROR
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL03-CONT.
 11537
 11538     IF DVBI-RETURN-CODE EQUAL '05'
 11539        MOVE ER-8093               TO WS-ERROR
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL03-CONT.
 11542
 11543     IF DVBI-RETURN-CODE EQUAL '06'
 11544        MOVE ER-8094               TO WS-ERROR
 11545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546        GO TO 3024-EDIT-DL03-CONT.
 11547
 11548     MOVE ER-8096                  TO WS-ERROR
 11549     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11550     GO TO 3024-EDIT-DL03-CONT.
 11551
 11552 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 212
* EL050.cbl
 11554
 11555     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11556        NEXT SENTENCE
 11557     ELSE
 11558        MOVE ER-8042               TO WS-ERROR
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11560
 11561     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11562     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11563     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11564
 11565     IF DMPF-RETURN-CODE = '01'
 11566        MOVE ER-8067               TO WS-ERROR
 11567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11568        GO TO 3024-EDIT-DL01-CONT.
 11569
 11570     IF DMPF-RETURN-CODE = '02'
 11571        MOVE ER-8068               TO WS-ERROR
 11572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573        GO TO 3024-EDIT-DL01-CONT.
 11574
 11575     IF DMPF-RETURN-CODE = '03'
 11576        MOVE ER-8069               TO WS-ERROR
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL01-CONT.
 11579
 11580     IF DMPF-RETURN-CODE = 'E1'
 11581        MOVE ER-8070               TO WS-ERROR
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583        GO TO 3024-EDIT-DL01-CONT.
 11584
 11585     IF DMPF-RETURN-CODE = 'N1'
 11586        MOVE ER-8071               TO WS-ERROR
 11587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11588        GO TO 3024-EDIT-DL01-CONT.
 11589
 11590     IF DMPF-RETURN-CODE NOT = 'OK'
 11591        MOVE ER-8072               TO WS-ERROR
 11592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11593
 11594 3024-EDIT-DL01-CONT.
 11595******************************************************************
 11596***  VALIDATES RATE CODES : DLO017                             ***
 11597******************************************************************
 11598
 11599      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11600      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11601      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11602      IF DVRC-SUCCESSFUL-EDIT
 11603        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11604        GO TO 3024-CHECK-VALID-RATE.
 11605
 11606      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11607
 11608      IF DVRC-RETURN-CODE EQUAL '01'
 11609         MOVE ER-7817                   TO WS-ERROR
 11610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11611         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 213
* EL050.cbl
 11612
 11613      IF DVRC-RETURN-CODE EQUAL '02'
 11614         MOVE ER-7818                   TO WS-ERROR
 11615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11616         GO TO 3025-EDIT-REINSURANCE.
 11617
 11618      IF DVRC-RETURN-CODE EQUAL '03'
 11619         MOVE ER-7819                   TO WS-ERROR
 11620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621         GO TO 3025-EDIT-REINSURANCE.
 11622
 11623       MOVE ER-7820                     TO WS-ERROR.
 11624       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11625       GO TO 3025-EDIT-REINSURANCE.
 11626
 11627******************************************************************
 11628***  GET PREMIUM RATES : DLO011                                ***
 11629******************************************************************
 11630
 11631 3024-CHECK-VALID-RATE.
 11632
 11633     IF VALID-RATE-CODE
 11634        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11635        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11636        MOVE SPACES                TO DPRB-RETURN-CODE
 11637        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11638     ELSE
 11639         GO TO 3025-EDIT-REINSURANCE.
 11640
 11641      IF DPRB-SUCCESSFUL-PROCESS
 11642         IF PB-VALID-LIFE
 11643             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11644             GO TO 3025-EDIT-REINSURANCE
 11645         ELSE
 11646             IF PB-VALID-AH
 11647                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11648                 GO TO 3025-EDIT-REINSURANCE.
 11649
 11650      IF DPRB-RETURN-CODE EQUAL '01'
 11651         MOVE ER-7812                   TO WS-ERROR
 11652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653         GO TO 3025-EDIT-REINSURANCE.
 11654
 11655      IF DPRB-RETURN-CODE EQUAL '02'
 11656         MOVE ER-7813                   TO WS-ERROR
 11657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658         GO TO 3025-EDIT-REINSURANCE.
 11659
 11660      IF DPRB-RETURN-CODE EQUAL '03'
 11661         MOVE ER-7814                   TO WS-ERROR
 11662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663         GO TO 3025-EDIT-REINSURANCE.
 11664
 11665      IF DPRB-RETURN-CODE EQUAL '04'
 11666         IF NOT DPRB-1ST-TIME
 11667            MOVE ER-7815                   TO WS-ERROR
 11668            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 214
* EL050.cbl
 11670          ELSE
 11671         IF PB-VALID-LIFE
 11672            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11673          ELSE
 11674            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11675         END-IF
 11676         MOVE SPACES                TO DOCC-RETURN-CODE
 11677         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11678         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11679         IF DOCC-RETURN-CODE = 'OK'
 11680             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11681             GO TO 3024-CHECK-VALID-RATE
 11682           ELSE
 11683             MOVE ER-7823               TO WS-ERROR
 11684             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11685             GO TO 3025-EDIT-REINSURANCE.
 11686
 11687       MOVE ER-7816                     TO WS-ERROR.
 11688       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11689       GO TO 3025-EDIT-REINSURANCE.
 11690
 11691**********   DMD CUSTOM CODE ABOVE    **********
 11692
 11693 3025-EDIT-REINSURANCE.
 11694     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11695         GO TO 3027-EDIT-CONTINUE.
 11696
 11697     MOVE LOW-VALUES               TO ERREIN-KEY.
 11698     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11699     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11700                                      REIN-CODE-2
 11701                                      REIN-CODE-3.
 11702     MOVE 'A'                      TO REIN-TYPE.
 11703
 11704     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11705
 11706     MOVE '3026' TO REIN-SW.
 11707     MOVE ' '                   TO WS-REIN-READ-SW.
 11708
 11709     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11710     IF REIN-TABLE-NOT-FOUND
 11711         GO TO 3026-NO-SPEC-TABLE.
 11712
 11713     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11714     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11715                                   WS-NSP-ST-CD-LF.
 11716     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11717                                   WS-NSP-ST-CD-AH.
 11718
 11719     GO TO 3040-EDIT-CONTINUE.
 11720
 11721 3026-NO-SPEC-TABLE.
 11722
 11723     MOVE ER-2664                TO WS-ERROR.
 11724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11725     GO TO 3040-EDIT-CONTINUE.
 11726
 11727 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 215
* EL050.cbl
 11728
 11729     IF PB-I-REIN-TABLE = SPACES
 11730       GO TO 3040-EDIT-CONTINUE.
 11731
 11732     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11733          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11734          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11735           GO TO 3040-EDIT-CONTINUE.
 11736
 11737     MOVE LOW-VALUES            TO ERREIN-KEY.
 11738     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11739     MOVE 'A'                   TO REIN-TYPE.
 11740     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11741
 11742     MOVE '3028'                TO REIN-SW.
 11743     MOVE ' '                   TO WS-REIN-READ-SW.
 11744
 11745     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11746     IF REIN-TABLE-NOT-FOUND
 11747         GO TO 3028-NO-REIN-TABLE.
 11748
 11749     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11750     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11751                                   WS-NSP-ST-CD-LF.
 11752     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11753                                   WS-NSP-ST-CD-AH.
 11754
 11755     GO TO 3040-EDIT-CONTINUE.
 11756
 11757 3028-NO-REIN-TABLE.
 11758
 11759     MOVE ER-2615                TO WS-ERROR.
 11760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11761     GO TO 3040-EDIT-CONTINUE.
 11762
 11763 3040-EDIT-CONTINUE.
 11764
 11765     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11766         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11767
 11768     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11769         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11770
 11771     IF (NOT PB-REISSUED-CERT)
 11772        AND (NOT PB-MONTHLY-CERT)
 11773        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11774            MOVE '001'           TO PB-I-LF-TERM
 11775            MOVE 'M'             TO PB-I-INSURED-SEX.
 11776
 11777     IF (NOT PB-REISSUED-CERT)
 11778        AND (NOT PB-MONTHLY-CERT)
 11779        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11780            MOVE '001'           TO PB-I-AH-TERM
 11781            MOVE 'M'             TO PB-I-INSURED-SEX.
 11782
 11783 3040-EDIT-1ST-PMT-DT.
 11784     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11785     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 216
* EL050.cbl
 11786         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11787
 11788******************************************************************
 11789*                                                                *
 11790*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11791*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11792*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11793*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11794*                                                                *
 11795******************************************************************
 11796
 11797     IF PB-EFF-DT-PROCESSING
 11798        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11799                                    PB-I-LF-EXPIRE-DT
 11800                                    PB-I-AH-EXPIRE-DT
 11801        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11802        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11803        MOVE ZERO                TO DC-ELAPSED-DAYS
 11804        MOVE +1                  TO DC-ELAPSED-MONTHS
 11805        SET BIN-PLUS-ELAPSED     TO TRUE
 11806*       MOVE 6                   TO DC-OPTION-CODE
 11807        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11808        IF NO-CONVERSION-ERROR
 11809           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11810
 11811******************************************************************
 11812*                                                                *
 11813*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11814*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11815*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11816*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11817*                                                                *
 11818******************************************************************
 11819
 11820     IF PB-EXT-DAYS-PROCESSING
 11821          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11822                                         PB-I-LF-EXPIRE-DT
 11823                                         PB-I-AH-EXPIRE-DT
 11824          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11825          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11826          MOVE +1                     TO DC-ELAPSED-MONTHS
 11827          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11828          SET BIN-PLUS-ELAPSED        TO TRUE
 11829*         MOVE 6                      TO DC-OPTION-CODE
 11830          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11831          IF NO-CONVERSION-ERROR
 11832             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11833
 11834******************************************************************
 11835*                                                                *
 11836*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11837*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11838*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11839*        (EXPIRE DATE - (TERM -1))  *  -1.
 11840*                                                                *
 11841******************************************************************
 11842
 11843     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 217
* EL050.cbl
 11844        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11845           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11846              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11847              MOVE PB-I-AH-TERM      TO WS-TERM
 11848           ELSE
 11849              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11850              MOVE PB-I-LF-TERM      TO WS-TERM
 11851        ELSE
 11852           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11853              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11854              MOVE PB-I-LF-TERM      TO WS-TERM
 11855           ELSE
 11856              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11857              MOVE PB-I-AH-TERM      TO WS-TERM.
 11858
 11859     IF PB-EXPIRE-DT-PROCESSING
 11860        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11861        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11862        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11863        MOVE ZERO                TO DC-ELAPSED-DAYS
 11864                                    DC-ODD-DAYS-OVER
 11865          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11866          SET BIN-PLUS-ELAPSED    TO TRUE
 11867*         MOVE 6                  TO DC-OPTION-CODE
 11868          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11869          IF NO-CONVERSION-ERROR
 11870             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11871
 11872******************************************************************
 11873*                                                                *
 11874*            1ST PAYMENT DATE PROCESSING                         *
 11875*                                                                *
 11876******************************************************************
 11877
 11878     IF PB-1ST-PMT-DT-PROCESSING
 11879        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11880                                    PB-I-AH-EXPIRE-DT
 11881        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11882
 11883     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11884         NEXT SENTENCE
 11885     ELSE
 11886         MOVE ER-2680                 TO WS-ERROR
 11887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11888         GO TO 3060-ORIG-TERM-CHECK.
 11889
 11890     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11891     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11892     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11893*    MOVE 1                      TO DC-OPTION-CODE.
 11894     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11895                                    DC-ELAPSED-DAYS
 11896                                    DC-ODD-DAYS-OVER.
 11897
 11898     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11899
 11900     IF DATE-CONVERSION-ERROR
 11901        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 218
* EL050.cbl
 11902
 11903     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11904     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11905        AND (WS-LF-COVERAGE-TYPE = 'L')
 11906        IF (DC-ELAPSED-MONTHS > 1)
 11907                      OR
 11908           ((DC-ELAPSED-MONTHS = 1)
 11909           AND (DC-ODD-DAYS-OVER > 0))
 11910           MOVE ER-2882          TO WS-ERROR
 11911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11912        END-IF
 11913     END-IF
 11914     IF PB-EXT-DAYS-PROCESSING
 11915        CONTINUE
 11916     ELSE
 11917        IF DC-ELAPSED-MONTHS = +0
 11918           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11919        ELSE
 11920           IF (WS-LF-EARNINGS-CALC = '4')
 11921              AND (DC-ELAPSED-MONTHS > ZERO)
 11922              AND (DC-ELAPSED-DAYS > ZERO)
 11923              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11924           ELSE
 11925              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11926                                 THRU 6499-EXIT
 11927              MOVE WS-ODD-DAYS-OVER
 11928                                 TO PB-I-EXTENTION-DAYS
 11929           END-IF
 11930        END-IF
 11931     END-IF
 11932******************************************************************
 11933*                                                                *
 11934*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11935*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11936*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11937*            AND ANY ODD DAYS.                                   *
 11938*                                                                *
 11939******************************************************************
 11940
 11941     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11942                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11943     IF WS-LF-EARNINGS-CALC NOT = '4'
 11944        IF DC-ELAPSED-DAYS > ZEROS
 11945           MOVE ER-2681          TO WS-ERROR
 11946           PERFORM 9900-ERROR-FORMAT
 11947                                 THRU 9900-EXIT
 11948        END-IF
 11949     END-IF
 11950
 11951     IF WS-LF-EARNINGS-CALC NOT = '4'
 11952        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11953           MOVE ER-2681          TO WS-ERROR
 11954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11955
 11956     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11957        (PB-I-LF-TERM NOT = ZERO) AND
 11958         NOT NO-LIFE-COVERAGE
 11959          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 219
* EL050.cbl
 11960          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11961          IF WS-LF-EARNINGS-CALC = '4'
 11962             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11963             PB-I-PAY-FREQUENCY
 11964          END-IF
 11965          MOVE ZERO              TO DC-ELAPSED-DAYS
 11966                                    DC-ODD-DAYS-OVER
 11967          MOVE 1                 TO DC-END-OF-MONTH
 11968          SET BIN-PLUS-ELAPSED        TO TRUE
 11969*         MOVE 6                 TO DC-OPTION-CODE
 11970          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11971          IF NO-CONVERSION-ERROR
 11972             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11973             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11974                (WS-LF-SPECIAL-CALC-CD = 'L')
 11975                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11976                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11977                  MOVE +1             TO DC-ELAPSED-MONTHS
 11978                  SET BIN-PLUS-ELAPSED  TO TRUE
 11979*                 MOVE 6              TO DC-OPTION-CODE
 11980                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11981                  IF NO-CONVERSION-ERROR
 11982                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11983
 11984* okay, i had to move the new att age edit down here because the
 11985* expiration date could get recalculated and i need the exp date
 11986     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11987        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11988        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11989        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11990           AND ZEROS
 11991           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11992           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11993           SET ELAPSED-BETWEEN-BIN TO TRUE
 11994           PERFORM 8500-DATE-CONVERT
 11995                                 THRU 8500-EXIT
 11996           IF NO-CONVERSION-ERROR
 11997              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11998                 MOVE ER-2669       TO WS-ERROR
 11999*                PERFORM 9900-ERROR-FORMAT
 12000*                                THRU 9900-EXIT
 12001              END-IF
 12002           END-IF
 12003        ELSE
 12004           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12005           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12006              MOVE ER-2669       TO WS-ERROR
 12007*             PERFORM 9900-ERROR-FORMAT
 12008*                                THRU 9900-EXIT
 12009           ELSE
 12010              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12011                 MOVE ER-1570    TO WS-ERROR
 12012                 PERFORM 9900-ERROR-FORMAT
 12013                                 THRU 9900-EXIT
 12014              END-IF
 12015           END-IF
 12016        END-IF
 12017        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 220
* EL050.cbl
 12018           AND ZEROS
 12019           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12020           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12021           SET ELAPSED-BETWEEN-BIN TO TRUE
 12022           PERFORM 8500-DATE-CONVERT
 12023                                 THRU 8500-EXIT
 12024           IF NO-CONVERSION-ERROR
 12025              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12026                 MOVE ER-2669       TO WS-ERROR
 12027*                PERFORM 9900-ERROR-FORMAT
 12028*                                THRU 9900-EXIT
 12029              END-IF
 12030           END-IF
 12031        ELSE
 12032           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12033             (PB-I-LF-TERM / 12)
 12034           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12035              MOVE ER-2669       TO WS-ERROR
 12036*             PERFORM 9900-ERROR-FORMAT
 12037*                                THRU 9900-EXIT
 12038           ELSE
 12039              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12040                 MOVE ER-1571    TO WS-ERROR
 12041                 PERFORM 9900-ERROR-FORMAT
 12042                                 THRU 9900-EXIT
 12043              END-IF
 12044           END-IF
 12045        END-IF
 12046        IF WS-ERROR = ER-2669
 12047           PERFORM 9900-ERROR-FORMAT
 12048                                 THRU 9900-EXIT
 12049        END-IF
 12050     END-IF
 12051     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12052        (PB-I-AH-TERM NOT = ZERO) AND
 12053         NOT NO-AH-COVERAGE
 12054          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12055             AND (PB-COMPANY-ID = 'DCC')
 12056             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12057             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12058          ELSE
 12059             IF WS-LF-EARNINGS-CALC = '4'
 12060                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12061                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12062                PB-I-PAY-FREQUENCY
 12063             ELSE
 12064                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12065                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12066             END-IF
 12067          END-IF
 12068          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12069                                         DC-ODD-DAYS-OVER
 12070          MOVE 1                      TO DC-END-OF-MONTH
 12071          SET BIN-PLUS-ELAPSED        TO TRUE
 12072*         MOVE 6                      TO DC-OPTION-CODE
 12073          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12074          IF NO-CONVERSION-ERROR
 12075             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 221
* EL050.cbl
 12076     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12077        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12078        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12079        IF PB-I-BIRTHDAY > LOW-VALUES
 12080           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12081           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12082           SET ELAPSED-BETWEEN-BIN TO TRUE
 12083           PERFORM 8500-DATE-CONVERT
 12084                                 THRU 8500-EXIT
 12085           IF NO-CONVERSION-ERROR
 12086              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12087                 MOVE ER-3054       TO WS-ERROR
 12088*                PERFORM 9900-ERROR-FORMAT
 12089*                                THRU 9900-EXIT
 12090              END-IF
 12091           END-IF
 12092        ELSE
 12093           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12094           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12095              MOVE ER-3054       TO WS-ERROR
 12096*             PERFORM 9900-ERROR-FORMAT
 12097*                                THRU 9900-EXIT
 12098           END-IF
 12099        END-IF
 12100        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12101           AND ZEROS
 12102           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12103           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12104           SET ELAPSED-BETWEEN-BIN TO TRUE
 12105           PERFORM 8500-DATE-CONVERT
 12106                                 THRU 8500-EXIT
 12107           IF NO-CONVERSION-ERROR
 12108              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12109                 MOVE ER-3054       TO WS-ERROR
 12110*                PERFORM 9900-ERROR-FORMAT
 12111*                                THRU 9900-EXIT
 12112              END-IF
 12113           END-IF
 12114        ELSE
 12115           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12116             (PB-I-AH-TERM / 12)
 12117           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12118              MOVE ER-3054       TO WS-ERROR
 12119*             PERFORM 9900-ERROR-FORMAT
 12120*                                THRU 9900-EXIT
 12121           END-IF
 12122        END-IF
 12123        IF WS-ERROR = ER-3054
 12124           PERFORM 9900-ERROR-FORMAT
 12125                                 THRU 9900-EXIT
 12126        END-IF
 12127     END-IF
 12128     MOVE SPACE                       TO DC-END-OF-MONTH.
 12129
 12130     IF PB-COMPANY-ID = 'NCB'
 12131        GO TO 3040-EDIT-EXTENSION-DAYS.
 12132
 12133     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 222
* EL050.cbl
 12134       AND
 12135        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12136        NEXT SENTENCE
 12137     ELSE
 12138        GO TO 3040-EDIT-EXTENSION-DAYS.
 12139
 12140     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12141        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12142        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12143     ELSE
 12144        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12145        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12146
 12147     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12148*    MOVE '1'      TO DC-OPTION-CODE
 12149     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12150     IF (NO-CONVERSION-ERROR)
 12151        AND (DC-ELAPSED-MONTHS > +1)
 12152        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12153        MOVE ER-2668   TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12155
 12156 3040-EDIT-EXTENSION-DAYS.
 12157
 12158     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12159        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12160         GO TO 3050-EDIT-TERM-IN-DAYS
 12161     ELSE
 12162         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12163
 12164     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12165         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12166     ELSE
 12167        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12168           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12169           MOVE ER-2681         TO WS-ERROR
 12170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12171
 12172     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12173        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12174        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12175         GO TO 3060-ORIG-TERM-CHECK.
 12176
 12177     GO TO 3060-ORIG-TERM-CHECK.
 12178
 12179 3050-EDIT-TERM-IN-DAYS.
 12180
 12181     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12182
 12183     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12184         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12185     ELSE
 12186         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12187            MOVE ER-2682         TO WS-ERROR
 12188            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12189
 12190     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12191                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 223
* EL050.cbl
 12192     IF WS-WORK-TERM GREATER THAN ZERO
 12193         ADD +1 TO PB-I-LF-TERM.
 12194
 12195     IF NOT NO-AH-COVERAGE
 12196         MOVE ER-2684            TO WS-ERROR
 12197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12198
 12199
 12200 3060-ORIG-TERM-CHECK.
 12201
 12202******************************************************************
 12203*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12204******************************************************************
 12205
 12206     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12207        NEXT SENTENCE
 12208     ELSE
 12209        IF NOT NO-LIFE-COVERAGE
 12210           IF PB-I-LF-TERM NUMERIC
 12211              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12212              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12213              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12214                  NEXT SENTENCE
 12215           ELSE
 12216              MOVE ER-2647       TO WS-ERROR
 12217              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12218
 12219     IF NOT NO-AH-COVERAGE
 12220         IF PB-I-AH-TERM NUMERIC
 12221            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12222            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12223            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12224             NEXT SENTENCE
 12225          ELSE
 12226              MOVE ER-2658       TO WS-ERROR
 12227              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12228
 12229     IF PB-COMPANY-ID = 'NCB'
 12230        GO TO 3070-LOAN-TERM-CHECK.
 12231
 12232     IF POLICY-HAS-AH
 12233       AND
 12234        POLICY-HAS-LIFE
 12235       AND
 12236        PB-I-LF-TERM NUMERIC
 12237       AND
 12238        PB-I-AH-TERM NUMERIC
 12239        NEXT SENTENCE
 12240     ELSE
 12241        GO TO 3070-LOAN-TERM-CHECK.
 12242
 12243     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12244     IF WS-TEX-FACT-2 LESS THAN +0
 12245        MULTIPLY +1 BY WS-TEX-FACT-2.
 12246
 12247     IF WS-TEX-FACT-2 GREATER THAN +1
 12248        MOVE ER-2668             TO WS-ERROR
 12249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 224
* EL050.cbl
 12250
 12251 3070-LOAN-TERM-CHECK.
 12252
 12253     IF (WS-LF-BENEFIT-CD = ZERO)
 12254         OR (NO-LF-BENEFIT-MATCH)
 12255            GO TO 3125-EDIT-PMT-FREQ.
 12256*    IF PB-COMPANY-ID NOT = 'DCC'
 12257*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12258*          AND 'V' AND 'W' AND 'X'
 12259*          GO TO 3125-EDIT-PMT-FREQ
 12260*       END-IF
 12261*    ELSE
 12262*       IF WS-AH-DCC-TRUNC = 'T'
 12263*          CONTINUE
 12264*       ELSE
 12265*          GO TO 3125-EDIT-PMT-FREQ
 12266*       END-IF
 12267*    END-IF
 12268     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12269                    OR
 12270        ((PB-COMPANY-ID = 'DCC')
 12271        AND (WS-AH-DCC-TRUNC = 'T'))
 12272        CONTINUE
 12273     ELSE
 12274        GO TO 3125-EDIT-PMT-FREQ
 12275     END-IF
 12276     IF PB-I-LOAN-TERM NOT NUMERIC
 12277         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12278
 12279     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12280        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12281        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12282        PB-I-LOAN-TERM NOT GREATER THAN +360
 12283         NEXT SENTENCE
 12284     ELSE
 12285         MOVE ER-2648            TO WS-ERROR
 12286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12287
 12288     IF WS-STATE-ABBREVIATION = 'NC'
 12289        IF PB-I-LOAN-TERM > +59
 12290           CONTINUE
 12291        ELSE
 12292           MOVE ER-2792          TO WS-ERROR
 12293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12294        END-IF
 12295     END-IF
 12296
 12297     .
 12298 3125-EDIT-PMT-FREQ.
 12299     IF (WS-LF-BENEFIT-CD = ZERO)
 12300         OR (NO-LF-BENEFIT-MATCH)
 12301            GO TO 3127-EDIT-LOAN-OFFICER.
 12302     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12303                    OR
 12304        ((PB-COMPANY-ID = 'DCC')
 12305        AND (WS-AH-DCC-TRUNC = 'T'))
 12306                    OR
 12307         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 225
* EL050.cbl
 12308        CONTINUE
 12309     ELSE
 12310        IF (PB-I-LOAN-TERM > ZEROS)
 12311           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12312           MOVE ER-1575          TO WS-ERROR
 12313           PERFORM 9900-ERROR-FORMAT
 12314                                 THRU 9900-EXIT
 12315        END-IF
 12316     END-IF
 12317     IF WS-LF-EARNINGS-CALC NOT = '4'
 12318         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12319            MOVE ER-2653         TO WS-ERROR
 12320            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321            GO TO 3127-EDIT-LOAN-OFFICER
 12322         ELSE
 12323            GO TO 3127-EDIT-LOAN-OFFICER.
 12324
 12325     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12326         MOVE ER-2655            TO WS-ERROR
 12327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12328         GO TO 3127-EDIT-LOAN-OFFICER.
 12329
 12330     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12331         MOVE ER-2654            TO WS-ERROR
 12332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12333         GO TO 3127-EDIT-LOAN-OFFICER.
 12334
 12335     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12336         GIVING WS-TEX-FACT-2
 12337             REMAINDER WS-TEX-FACT-3.
 12338
 12339*    IF WS-TEX-FACT-3 NOT = ZERO
 12340*       MOVE ER-2654             TO WS-ERROR
 12341*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12342
 12343
 12344 3127-EDIT-LOAN-OFFICER.
 12345
 12346     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12347        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12348           MOVE ER-2690          TO WS-ERROR
 12349           PERFORM 9900-ERROR-FORMAT
 12350                                 THRU 9900-EXIT
 12351        ELSE
 12352           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12353           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12354           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12355           MOVE PB-SV-STATE      TO LOFC-STATE
 12356           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12357           MOVE PB-I-LOAN-OFFICER
 12358                                 TO LOFC-CODE
 12359           PERFORM 8586-READ-LOAN-OFFICER
 12360                                 THRU 8586-EXIT
 12361           IF (NOT LOFC-MASTER-FOUND)
 12362              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12363              MOVE ER-3006       TO WS-ERROR
 12364              PERFORM 9900-ERROR-FORMAT
 12365                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 226
* EL050.cbl
 12366           END-IF
 12367        END-IF
 12368     END-IF
 12369     .
 12370 3129-EDIT-APR.
 12371
 12372     IF (WS-LF-BENEFIT-CD = ZERO)
 12373        OR (NO-LF-BENEFIT-MATCH)
 12374        IF PB-COMPANY-ID NOT = 'DCC'
 12375           GO TO 3130-EDIT-AGE
 12376*       ELSE
 12377*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12378*             GO TO 3130-EDIT-AGE
 12379*          END-IF
 12380        END-IF
 12381     END-IF
 12382
 12383     IF (WS-STATE-ABBREVIATION = 'OH')
 12384         AND (PB-I-RATE-CLASS NOT = 'L ')
 12385         AND (PB-I-LF-TERM GREATER THAN 60)
 12386         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12387         GO TO 3129-APR-CONT.
 12388
 12389     IF (WS-STATE-ABBREVIATION = 'RI')
 12390         AND (PB-I-LF-TERM GREATER THAN 60)
 12391         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12392         GO TO 3129-APR-CONT.
 12393
 12394     IF (WS-STATE-ABBREVIATION = 'UT')
 12395         AND (PB-I-LF-TERM GREATER THAN 62)
 12396         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12397         AND (PB-CERT-EFF-DT LESS WS-830901)
 12398         GO TO 3129-APR-CONT.
 12399
 12400     IF PB-COMPANY-ID = 'LAP'
 12401        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12402           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12403              MOVE ER-2656         TO WS-ERROR
 12404              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12405              GO TO 3130-EDIT-AGE.
 12406
 12407     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12408        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12409        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12410        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12411        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12412        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12413         GO TO 3130-EDIT-AGE.
 12414
 12415 3129-APR-CONT.
 12416     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12417         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12418         GO TO 3130-EDIT-AGE.
 12419
 12420     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12421         WS-AH-BENEFIT-CD (1:1) = 'S')
 12422        AND (PB-COMPANY-ID = 'DCC')
 12423        AND (PB-I-LOAN-APR = ZERO)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 227
* EL050.cbl
 12424        MOVE ER-2657             TO WS-ERROR
 12425        PERFORM 9900-ERROR-FORMAT
 12426                                 THRU 9900-EXIT
 12427        GO TO 3130-EDIT-AGE
 12428     END-IF
 12429     IF PB-I-LOAN-APR = ZERO
 12430        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12431     END-IF
 12432
 12433     IF PB-I-LOAN-APR = ZERO
 12434        MOVE ER-2656             TO WS-ERROR
 12435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12436        GO TO 3130-EDIT-AGE.
 12437
 12438*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12439     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12440        MOVE ER-2657             TO WS-ERROR
 12441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12442
 12443 3130-EDIT-AGE.
 12444
 12445******************************************************************
 12446*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12447******************************************************************
 12448
 12449     IF NOT NO-LIFE-COVERAGE
 12450        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12451           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12452               MOVE ER-2628             TO WS-ERROR
 12453               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12454
 12455     IF NOT NO-AH-COVERAGE
 12456        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12457           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12458               MOVE ER-2628         TO WS-ERROR
 12459               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12460
 12461 3133-SEX-CODE.
 12462     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12463         IF WS-DEFAULT-SEX = 'M'
 12464             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12465          ELSE
 12466             IF WS-DEFAULT-SEX = 'F'
 12467             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12468
 12469     IF PB-I-INSURED-SEX = '1'
 12470         MOVE 'M' TO PB-I-INSURED-SEX.
 12471
 12472     IF PB-I-INSURED-SEX = '2'
 12473         MOVE 'F' TO PB-I-INSURED-SEX.
 12474
 12475 3134-SIG-SW-EDIT.
 12476     IF PB-I-SIG-SW = SPACE
 12477         MOVE 'N'                TO  PB-I-SIG-SW.
 12478
 12479     IF PB-COMPANY-ID = 'NCL'
 12480         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12481             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 228
* EL050.cbl
 12482         ELSE
 12483             MOVE ER-1923        TO  WS-ERROR
 12484             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12485     ELSE
 12486     IF PB-COMPANY-ID = 'CRI'
 12487         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12488             NEXT SENTENCE
 12489         ELSE
 12490             MOVE ER-2606        TO  WS-ERROR
 12491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12492     ELSE
 12493     IF PB-COMPANY-ID = 'TMS'
 12494         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12495             NEXT SENTENCE
 12496         ELSE
 12497             MOVE ER-2689        TO  WS-ERROR
 12498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12499     ELSE
 12500         IF PB-I-SIG-SW = 'Y' OR 'N'
 12501             NEXT SENTENCE
 12502         ELSE
 12503             MOVE ER-2651        TO  WS-ERROR
 12504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12505
 12506     IF PB-COMPANY-ID = 'FLA'
 12507         IF (WS-EDIT-AGE GREATER 54  OR
 12508             WS-AH-EDIT-AGE GREATER 54)  AND
 12509            PB-I-SIG-SW = 'N'
 12510            MOVE ER-2651         TO  WS-ERROR
 12511            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12512
 12513 3135-NAME-EDIT.
 12514
 12515     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12516        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12517        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12518           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12519                                 TO PB-I-JOINT-FIRST-NAME
 12520        END-PERFORM
 12521     END-IF
 12522     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12523        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12524        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12525           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12526                                 TO PB-I-JOINT-LAST-NAME
 12527        END-PERFORM
 12528     END-IF
 12529     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12530        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12531        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12532           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12533                                 TO PB-I-INSURED-FIRST-NAME
 12534        END-PERFORM
 12535     END-IF
 12536     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12537        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12538        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12539           MOVE PB-I-INSURED-LAST-NAME (2:14)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 229
* EL050.cbl
 12540                                 TO PB-I-INSURED-LAST-NAME
 12541        END-PERFORM
 12542     END-IF
 12543     IF PB-I-INSURED-LAST-NAME = SPACES
 12544       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12545       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12546           MOVE ER-2660    TO WS-ERROR
 12547           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12548
 12549 3136-EDIT-SEX.
 12550
 12551******************************************************************
 12552*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12553******************************************************************
 12554
 12555     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12556        (WS-AH-SPECIAL-CALC-CD = 'O')
 12557        NEXT SENTENCE
 12558     ELSE
 12559        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12560           NEXT SENTENCE
 12561        ELSE
 12562           MOVE ER-2629            TO WS-ERROR
 12563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12564
 12565 3137-EDIT-EFF-DATE.
 12566
 12567     IF PB-REISSUED-CERT       OR
 12568        PB-POLICY-IS-DECLINED  OR
 12569        PB-POLICY-IS-VOIDED
 12570         GO TO 3139-EDIT-COVERAGE-CODES.
 12571
 12572     MOVE SPACE                  TO WS-2671-SW
 12573                                    WS-2672-SW.
 12574
 12575     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12576         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12577             MOVE ER-2703        TO WS-ERROR
 12578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12579             GO TO 3139-EDIT-COVERAGE-CODES.
 12580
 12581     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12582         GO TO 3139-EDIT-COVERAGE-CODES.
 12583
 12584     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12585     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12586*    MOVE '1'                    TO DC-OPTION-CODE.
 12587     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12588     MOVE +0                     TO DC-ELAPSED-MONTHS
 12589                                    DC-ELAPSED-DAYS.
 12590     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12591
 12592     IF DATE-CONVERSION-ERROR
 12593         GO TO 3139-EDIT-COVERAGE-CODES.
 12594
 12595     IF DC-ELAPSED-DAYS GREATER +180
 12596         MOVE ER-2672            TO WS-ERROR
 12597         MOVE 'Y'                TO WS-2672-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 230
* EL050.cbl
 12598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12599     END-IF
 12600
 12601     IF WS-ERROR = ER-2671  AND
 12602        PB-COMPANY-ID  = 'LBL'
 12603        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12604        MOVE SPACE               TO WS-2671-SW
 12605        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12606
 12607     IF PB-ISSUE-DATE-FORCED  AND
 12608      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12609         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12610         MOVE ER-2673            TO WS-ERROR
 12611         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12612         MOVE SPACE              TO WS-2671-SW
 12613                                    WS-2672-SW.
 12614
 12615     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12616         IF PB-ISSUE-DATE-FORCED
 12617             MOVE ER-2600          TO  WS-ERROR
 12618             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12619         ELSE
 12620             MOVE ER-2692          TO  WS-ERROR
 12621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12622
 12623
 12624 3139-EDIT-COVERAGE-CODES.
 12625
 12626     if pb-company-id not = 'AHL'
 12627        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12628           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12629           MOVE ER-2787          TO WS-ERROR
 12630           PERFORM 9900-ERROR-FORMAT
 12631                                 THRU 9900-EXIT
 12632        END-IF
 12633     end-if
 12634     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12635        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12636                                 > 250000.00
 12637           MOVE ER-2719          TO WS-ERROR
 12638           PERFORM 9900-ERROR-FORMAT
 12639                                 THRU 9900-EXIT
 12640        END-IF
 12641     END-IF
 12642
 12643     IF PB-POLICY-IS-DECLINED  OR
 12644        PB-POLICY-IS-VOIDED
 12645         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12646
 12647     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12648        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12649         MOVE ER-2630                TO WS-ERROR
 12650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12651
 12652     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12653        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12654        PB-I-LF-PREMIUM-AMT = ZERO
 12655         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 231
* EL050.cbl
 12656
 12657     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12658        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12659        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12660         GO TO 3140-CHECK-AH-FOR-ZERO.
 12661
 12662     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12663        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12664        MOVE ER-2631             TO WS-ERROR
 12665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666     END-IF
 12667
 12668
 12669******************************************************************
 12670*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12671******************************************************************
 12672
 12673     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12674        NEXT SENTENCE
 12675     ELSE
 12676        IF PB-I-LF-BENEFIT-AMT = ZERO
 12677           MOVE ER-2632             TO WS-ERROR
 12678           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12679
 12680
 12681******************************************************************
 12682*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12683******************************************************************
 12684
 12685     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12686        CONTINUE
 12687     ELSE
 12688        IF PB-I-LF-PREMIUM-AMT = ZERO
 12689           IF (NOT PB-COMP-LF-PREM)
 12690              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12691              MOVE ER-2633       TO WS-ERROR
 12692              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12693           END-IF
 12694        END-IF
 12695     END-IF
 12696     .
 12697 3140-CHECK-AH-FOR-ZERO.
 12698
 12699     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12700        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12701        PB-I-AH-PREMIUM-AMT = ZERO
 12702         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12703
 12704     IF PB-COMPANY-ID = 'CSL'  AND
 12705        PB-I-AH-BENEFIT-CD = ZERO  AND
 12706        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12707        PB-I-AH-PREMIUM-AMT = ZERO
 12708         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12709
 12710     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12711        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12712        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12713         GO TO 3140-EDIT-MAX-AMT-SIZES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 232
* EL050.cbl
 12714
 12715     IF PB-I-AH-BENEFIT-CD = ZERO
 12716         MOVE ER-2634            TO WS-ERROR
 12717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12718
 12719******************************************************************
 12720*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12721******************************************************************
 12722
 12723     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12724        NEXT SENTENCE
 12725     ELSE
 12726        IF PB-I-AH-BENEFIT-AMT = ZERO
 12727           MOVE ER-2635             TO WS-ERROR
 12728           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12729
 12730******************************************************************
 12731*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12732******************************************************************
 12733
 12734     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12735        NEXT SENTENCE
 12736     ELSE
 12737        IF PB-I-AH-PREMIUM-AMT = ZERO
 12738            IF NOT PB-COMP-AH-PREM
 12739                MOVE ER-2636    TO WS-ERROR
 12740                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12741
 12742
 12743 3140-EDIT-MAX-AMT-SIZES.
 12744* CUSTOM CODE FOR CLIENT    'DMD'
 12745     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12746                                     WS-RES-MUNI-TAX
 12747                                     PB-I-STATE-TAX
 12748                                     PB-I-MUNI-TAX.
 12749
 12750     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12751
 12752     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12753        GO TO 3150-RATE-OUTSTAND-BAL.
 12754
 12755     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12756        GO TO 3150-RATE-OUTSTAND-BAL.
 12757
 12758     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12759        GO TO 3150-RATE-OUTSTAND-BAL.
 12760
 12761     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12762                             OR 'RIC')
 12763        GO TO 3150-RATE-OUTSTAND-BAL.
 12764
 12765     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12766        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12767            GO TO 3150-RATE-OUTSTAND-BAL
 12768        ELSE
 12769           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12770               GO TO 3150-RATE-OUTSTAND-BAL.
 12771
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 233
* EL050.cbl
 12772     IF NOT PB-NO-MONTHS-SKIPPED
 12773        GO TO 3150-RATE-OUTSTAND-BAL.
 12774
 12775     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12776        GO TO 3150-RATE-OUTSTAND-BAL.
 12777
 12778     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12779        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12780           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12781             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12782           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12783           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12784              MOVE ER-2693     TO WS-ERROR
 12785              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12786              GO TO 3150-RATE-OUTSTAND-BAL
 12787           ELSE
 12788              GO TO 3150-RATE-OUTSTAND-BAL.
 12789
 12790 3150-RATE-OUTSTAND-BAL.
 12791
 12792* DMD RATING TEST
 12793     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12794         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12795         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12796         MOVE ER-2687                 TO WS-ERROR
 12797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12798         MOVE 'B'                     TO PB-I-OB-FLAG
 12799         GO TO 3260-EDIT-CONTINUE.
 12800
 12801     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12802         IF  WS-ERROR    EQUAL    ER-2693
 12803             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12804                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12805                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12806                 MOVE  +0            TO  WS-ERROR.
 12807
 12808     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12809         IF  WS-ERROR    EQUAL    ER-2693
 12810             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12811                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12812                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12813                 MOVE  +0            TO  WS-ERROR.
 12814
 12815     IF PLAN-MASTER-AH-SW = 'Y'
 12816        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12817            IF  WS-ERROR    EQUAL    ER-2693
 12818              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12819                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12820                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12821                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12822                 MOVE  ER-1910           TO  WS-ERROR
 12823                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12824
 12825     IF PLAN-MASTER-AH-SW = 'Y'
 12826        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12827            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12828               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12829               MOVE  ER-1910           TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 234
* EL050.cbl
 12830               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12831
 12832     IF PLAN-MASTER-AH-SW = 'Y'
 12833        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12834            IF  WS-ERROR    EQUAL    ER-2693
 12835                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12836                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12837                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12838                 MOVE  +0       TO  WS-ERROR.
 12839
 12840     IF WS-ERROR = ER-2693
 12841        IF PB-COMPANY-ID = 'JAL' AND
 12842           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12843           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12844           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12845
 12846     IF WS-ERROR = ER-2693
 12847        IF PB-COMPANY-ID = 'NCL'  AND
 12848           PB-I-AH-BENEFIT-CD = 'OA'
 12849           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12850           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12851
 12852     IF WS-ERROR = ER-2693
 12853        IF PB-COMPANY-ID = 'CNL' AND
 12854           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12855           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12856           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12857
 12858     IF WS-ERROR = ER-2693
 12859        IF PB-COMPANY-ID = 'HER'
 12860           IF WS-LEVEL
 12861              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12862              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12863
 12864     IF ((LF-BENEFIT-FOUND) AND
 12865         (NOT NO-LIFE-COVERAGE)  AND
 12866         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12867       OR   ((AH-BENEFIT-FOUND) AND
 12868             (NOT NO-AH-COVERAGE)    AND
 12869             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12870         NEXT SENTENCE
 12871     ELSE
 12872         GO TO 3215-EDIT-RATES.
 12873
 12874     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12875        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12876           MOVE ER-2674          TO WS-ERROR
 12877           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12878           GO TO 3215-EDIT-RATES.
 12879
 12880     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12881        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12882           MOVE ER-2674          TO WS-ERROR
 12883           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12884           GO TO 3215-EDIT-RATES.
 12885
 12886     MOVE 'B'                    TO PB-I-OB-FLAG.
 12887
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 235
* EL050.cbl
 12888     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12889         NEXT SENTENCE
 12890     ELSE
 12891         IF NOT NO-LIFE-COVERAGE
 12892             IF WS-ACCT-LF-OB-RT = ZERO
 12893                MOVE ER-2641    TO WS-ERROR
 12894                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12895
 12896     IF PB-COMPANY-ID = 'CRI'
 12897       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12898         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12899         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12900         IF WS-ERROR = ER-2675
 12901            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12902            MOVE ER-2687              TO WS-ERROR
 12903            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12904         ELSE
 12905            MOVE ER-2687              TO WS-ERROR
 12906            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12907
 12908
 12909     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12910         NEXT SENTENCE
 12911     ELSE
 12912       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12913            NEXT SENTENCE
 12914       ELSE
 12915         IF NOT NO-AH-COVERAGE
 12916             IF WS-ACCT-AH-OB-RT = ZERO
 12917                MOVE ER-2642    TO WS-ERROR
 12918                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12919
 12920     IF PB-COMPANY-ID = 'CRI'
 12921       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12922         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12923         IF WS-ERROR = ER-2676
 12924            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12925            MOVE ER-2687              TO WS-ERROR
 12926            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12927         ELSE
 12928            MOVE ER-2687              TO WS-ERROR
 12929            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12930
 12931     IF PB-COMPANY-ID NOT = 'GIC'
 12932         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12933            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12934     ELSE
 12935         IF PB-I-LF-PREM-CALC = ZEROS
 12936             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12937                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12938
 12939     IF PB-COMPANY-ID NOT = 'GIC'
 12940         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12941            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12942     ELSE
 12943         IF PB-I-AH-PREM-CALC = ZEROS
 12944             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12945                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 236
* EL050.cbl
 12946
 12947     MOVE ZEROS TO PB-I-MORT-CODE.
 12948
 12949     GO TO 3260-EDIT-CONTINUE.
 12950
 12951
 12952 3215-EDIT-RATES.
 12953     IF ACCOUNT-MAST-FOUND
 12954         NEXT SENTENCE
 12955     ELSE
 12956         GO TO 3999-END-EDIT.
 12957
 12958 3220-CHECK-LF-RATES.
 12959
 12960     IF PB-COMPANY-ID = 'DCC'
 12961        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12962        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12963        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12964           AND (NOT WS-LF-CASH))
 12965                           OR
 12966           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12967           AND (NOT WS-AH-CASH)))
 12968                       AND
 12969           (PB-I-ENTRY-STATUS NOT = '5')
 12970           MOVE 'M'              TO PB-BATCH-ENTRY
 12971                                    PB-I-ENTRY-STATUS
 12972        END-IF
 12973     END-IF
 12974     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12975                                    PB-I-AH-PREM-CALC
 12976                                    PB-I-LF-ALT-PREM-CALC
 12977                                    PB-I-LF-ALT-RATE
 12978                                    PB-I-LF-REI-RATE
 12979                                    PB-I-LF-ALT-REI-RATE
 12980                                    PB-I-AH-REI-RATE
 12981                                    PB-I-TOT-FEES-CALC.
 12982
 12983     IF PB-COMPANY-ID EQUAL 'DMD'
 12984        NEXT SENTENCE
 12985     ELSE
 12986        MOVE ZEROS               TO PB-I-LF-RATE
 12987                                    PB-I-AH-RATE.
 12988
 12989     IF PB-I-TOT-FEES NOT NUMERIC
 12990        MOVE ZEROS               TO PB-I-TOT-FEES
 12991     END-IF
 12992     IF PB-I-LIVES NOT NUMERIC
 12993         MOVE ZERO               TO PB-I-LIVES.
 12994
 12995     IF PB-I-NUM-BILLED NOT NUMERIC
 12996         MOVE ZERO               TO PB-I-NUM-BILLED.
 12997
 12998     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12999        MOVE +0                  TO PB-I-LF-PREM-TAX
 13000     END-IF
 13001
 13002     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13003        MOVE +0                  TO PB-I-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 237
* EL050.cbl
 13004     END-IF
 13005
 13006     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13007        PB-I-PAY-FREQUENCY = ZEROS
 13008            MOVE 12 TO CP-PAY-FREQUENCY
 13009     ELSE
 13010            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13011
 13012     IF PB-I-STATE-TAX NOT NUMERIC
 13013         MOVE ZEROS               TO PB-I-STATE-TAX.
 13014
 13015     IF PB-I-MUNI-TAX NOT NUMERIC
 13016         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13017
 13018     MOVE SPACES                 TO CP-BEN-CATEGORY
 13019     IF PB-COMPANY-ID  = 'CSL'  AND
 13020        PB-I-LF-TERM NOT = ZERO
 13021        COMPUTE WS-PAYMENT-AMT =
 13022             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13023        COMPUTE WS-CSL-AMT1 =
 13024             PB-I-LF-TERM * AM-MAX-MON-BEN
 13025        COMPUTE WS-CSL-AMT2 =
 13026             WS-PAYMENT-AMT * PB-I-LF-TERM
 13027        IF CP-PAY-FREQUENCY NOT = 12
 13028           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13029           MOVE '8' TO WS-CSL-CALC-CD
 13030        ELSE
 13031           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13032              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13033               AM-MAX-TOT-BEN
 13034               MOVE '6' TO WS-CSL-CALC-CD
 13035           ELSE
 13036              IF (WS-CSL-AMT1  GREATER THAN
 13037                 AM-MAX-TOT-BEN) AND
 13038                 (WS-CSL-AMT2  GREATER THAN
 13039                 AM-MAX-TOT-BEN)
 13040                 MOVE '7' TO WS-CSL-CALC-CD
 13041              ELSE
 13042                 MOVE '5' TO WS-CSL-CALC-CD.
 13043
 13044     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13045         NEXT SENTENCE
 13046     ELSE
 13047         GO TO 3300-CHECK-AH-RATES.
 13048
 13049*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13050
 13051     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13052        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13053              OR
 13054           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13055           MOVE ER-2618          TO WS-ERROR
 13056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13057           GO TO 3300-CHECK-AH-RATES.
 13058
 13059     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13060           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13061                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 238
* EL050.cbl
 13062
 13063     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13064         MOVE ER-2687             TO WS-ERROR
 13065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13066         MOVE 'Z000'              TO PB-I-MORT-CODE
 13067         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13068         GO TO 3300-CHECK-AH-RATES.
 13069
 13070     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13071        IF PB-I-LIVES = ZERO
 13072           MOVE ER-2688          TO WS-ERROR
 13073           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13074
 13075     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13076
 13077     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13078     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13079     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13080     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13081     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13082     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13083     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13084     MOVE '3'                    TO CP-PROCESS-TYPE.
 13085     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13086     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13087
 13088******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13089     IF PB-COMPANY-ID EQUAL 'CDL'
 13090         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13091            CP-EARN-AS-NET-PAY)
 13092             IF PB-CERT-EFF-DT GREATER  WS-931231
 13093                 MOVE '1'        TO CP-EARNING-METHOD.
 13094*******
 13095
 13096     MOVE PB-SV-STATE            TO CP-STATE.
 13097     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13098     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13099     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13100     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13101     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13102                                    CP-RATING-BENEFIT-AMT.
 13103     IF CP-STATE-STD-ABBRV = 'OR'
 13104         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13105                                         PB-I-LF-ALT-BENEFIT-AMT.
 13106     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13107     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13108     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13109     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13110     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13111     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13112     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13113     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13114     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13115                                    CP-REMAINING-TERM
 13116                                    CP-LOAN-TERM.
 13117
 13118     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13119         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 239
* EL050.cbl
 13120     ELSE
 13121         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13122             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13123                                           PB-I-LF-PREMIUM-AMT.
 13124
 13125     IF PB-COMPANY-ID EQUAL 'CSL'
 13126        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13127           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13128                                         PB-I-LF-PREMIUM-AMT.
 13129
 13130     IF PB-COMPANY-ID EQUAL 'NCB'
 13131         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13132            CP-EARN-AS-NET-PAY
 13133             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13134                 PB-I-LF-PREMIUM-AMT.
 13135
 13136     IF (CP-TRUNCATED-LIFE)
 13137        or ((pb-company-id = 'AHL')
 13138           and (pb-i-loan-term > pb-i-lf-term))
 13139        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13140
 13141     IF PB-COMPANY-ID EQUAL 'CRI'
 13142        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13143
 13144     IF CP-TERM-IS-DAYS
 13145         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13146     ELSE
 13147         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13148     IF PB-COMPANY-ID = 'DCC'
 13149        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13150        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13151        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13152        IF WS-LF-BEN-CATEGORY = 'D'
 13153           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13154           MOVE PB-I-LIFE-COMMISSION
 13155                                 TO CP-DCC-ACT-COMM
 13156           MOVE WS-LF-BEN-CATEGORY
 13157                                 TO CP-BEN-CATEGORY
 13158        END-IF
 13159        IF (CP-BENEFIT-CD (1:1) = 'P')
 13160           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13161           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13162        END-IF
 13163     END-IF
 13164     IF PB-COMPANY-ID = 'CSL'
 13165         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13166         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13167         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13168
 13169     IF PB-COMPANY-ID = 'CSL'
 13170        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13171
 13172     IF (CP-SPECIAL-CALC-CD = 'H')
 13173        OR (PB-COMPANY-ID = 'DCC')
 13174         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13175                                    TO CP-ALTERNATE-BENEFIT
 13176         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13177
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 240
* EL050.cbl
 13178     IF (PB-COMPANY-ID = 'CID')
 13179        AND (WS-LF-EARNINGS-CALC = 'B')
 13180        AND (CP-STATE-STD-ABBRV = 'MN')
 13181        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13182                                 TO CP-ALTERNATE-BENEFIT
 13183        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13184     END-IF
 13185     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13186     MOVE 'R'                   TO CP-RATE-FILE.
 13187     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13188
 13189     IF CP-ERROR-RATE-NOT-FOUND
 13190        MOVE ER-2641            TO WS-ERROR
 13191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13192        GO TO 3300-CHECK-AH-RATES.
 13193
 13194     IF PB-COMPANY-ID EQUAL 'CRI'
 13195        IF CP-ERROR-NO-LIMITS-CRI
 13196           IF NOT ACCOUNT-LIFE-CHECKED
 13197              MOVE ER-2607      TO WS-ERROR
 13198              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13199
 13200******************************************************************
 13201*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13202*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13203******************************************************************
 13204
 13205* CALC LIFE AGE AT EXPIRATION.
 13206
 13207     COMPUTE WS-AGE-AT-EXPIRE =
 13208          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13209
 13210*    IF PB-STATE = 'CO' OR 'UT'
 13211*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13212*        MOVE 'F'            TO PB-FATAL-FLAG
 13213*        MOVE ER-2709        TO WS-ERROR
 13214*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13216
 13217*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13218*        MOVE 'X'            TO PB-FATAL-FLAG
 13219*        MOVE ER-2718        TO WS-ERROR
 13220*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13221*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13222
 13223* CALC A & H AGE AT EXPIRATION.
 13224
 13225     COMPUTE WS-AGE-AT-EXPIRE =
 13226          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13227
 13228*    IF PB-STATE = 'CO' OR 'UT'
 13229*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13230*        MOVE 'F'            TO PB-FATAL-FLAG
 13231*        MOVE ER-2709        TO WS-ERROR
 13232*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13233*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13234
 13235*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 241
* EL050.cbl
 13236*        MOVE 'X'            TO PB-FATAL-FLAG
 13237*        MOVE ER-2718        TO WS-ERROR
 13238*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13239*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13240
 13241     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13242        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13243
 13244     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13245        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13246
 13247     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13248        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13249
 13250     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13251         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13252         MOVE ER-2639        TO WS-ERROR
 13253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13254
 13255
 13256******************************************************************
 13257*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13258******************************************************************
 13259
 13260 PREMIUM-EDITING-IS-BYPASSED.
 13261     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13262        AND (CP-R-MAX-ATT-AGE > +0)
 13263        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13264        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13265           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13266           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13267           MOVE '1'              TO DC-OPTION-CODE
 13268           PERFORM 8500-DATE-CONVERT
 13269                                 THRU 8500-EXIT
 13270           IF NO-CONVERSION-ERROR
 13271              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13272                 MOVE ER-2661       TO WS-ERROR
 13273*                PERFORM 9900-ERROR-FORMAT
 13274*                                THRU 9900-EXIT
 13275              END-IF
 13276           END-IF
 13277        ELSE
 13278           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13279           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13280              MOVE ER-2661       TO WS-ERROR
 13281*             PERFORM 9900-ERROR-FORMAT
 13282*                                THRU 9900-EXIT
 13283           ELSE
 13284              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13285                 MOVE ER-1570    TO WS-ERROR
 13286                 PERFORM 9900-ERROR-FORMAT
 13287                                 THRU 9900-EXIT
 13288              END-IF
 13289           END-IF
 13290        END-IF
 13291        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13292           MOVE PB-I-JOINT-BIRTHDAY
 13293                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 242
* EL050.cbl
 13294           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13295           MOVE '1'              TO DC-OPTION-CODE
 13296           PERFORM 8500-DATE-CONVERT
 13297                                 THRU 8500-EXIT
 13298           IF NO-CONVERSION-ERROR
 13299              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13300                 MOVE ER-2661       TO WS-ERROR
 13301*                PERFORM 9900-ERROR-FORMAT
 13302*                                THRU 9900-EXIT
 13303              END-IF
 13304           ELSE
 13305              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13306           END-IF
 13307        ELSE
 13308           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13309             (PB-I-LF-TERM / 12)
 13310           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13311              MOVE ER-2661       TO WS-ERROR
 13312*             PERFORM 9900-ERROR-FORMAT
 13313*                                THRU 9900-EXIT
 13314           ELSE
 13315              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13316                 MOVE ER-1571    TO WS-ERROR
 13317                 PERFORM 9900-ERROR-FORMAT
 13318                                 THRU 9900-EXIT
 13319              END-IF
 13320           END-IF
 13321        END-IF
 13322        IF WS-ERROR = ER-2661
 13323           PERFORM 9900-ERROR-FORMAT
 13324                                 THRU 9900-EXIT
 13325        END-IF
 13326     END-IF
 13327*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13328*       MOVE ER-2661             TO WS-ERROR
 13329*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13330
 13331     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13332        MOVE ER-2662             TO WS-ERROR
 13333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13334
 13335     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13336        MOVE ER-2677             TO WS-ERROR
 13337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13338
 13339     IF CP-ERROR-LOAN-TERM
 13340        MOVE ER-2648             TO WS-ERROR
 13341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13342
 13343 3221-CHECK-ERROR-RATE-OPEN.
 13344
 13345     IF CP-ERROR-RATE-FILE-NOTOPEN
 13346         GO TO 3990-FILES-NOT-OPEN.
 13347
 13348     IF PB-COMPANY-ID NOT = 'DMD'
 13349        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13350     END-IF
 13351     .
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 243
* EL050.cbl
 13352 3221-CONTINUE.
 13353     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13354                                    WS-DCC-AH-RATE
 13355     IF PB-COMPANY-ID = 'DCC'
 13356        IF WS-LF-BEN-CATEGORY = 'D'
 13357           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13358              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13359        END-IF
 13360     END-IF
 13361     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13362*   X'A4FF' = 12/31/2009
 13363     IF (PB-COMPANY-ID = 'CID')
 13364        AND (WS-LF-EARNINGS-CALC = 'B')
 13365        AND (CP-STATE-STD-ABBRV = 'MN')
 13366        AND (PB-CERT-EFF-DT > X'A4FF')
 13367        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13368     END-IF
 13369     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13370
 13371     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13372     IF (PB-COMPANY-ID = 'DCC')
 13373        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13374        AND (PB-I-POLICY-IS-MONTHLY)
 13375        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13376        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13377     END-IF
 13378     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13379     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13380     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13381     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13382     IF (PB-COMPANY-ID = 'DCC')
 13383        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13384        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13385        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13386        MOVE ER-2786             TO WS-ERROR
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13388     END-IF
 13389
 13390     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13391
 13392******************************************************************
 13393*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13394******************************************************************
 13395     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13396        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13397
 13398     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13399        GO TO 3225-CHECK-ALT-LIFE-RATE
 13400     ELSE
 13401       IF PB-I-LF-RATE = ZERO
 13402          MOVE ER-2641          TO WS-ERROR
 13403          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13404
 13405 3225-CHECK-ALT-LIFE-RATE.
 13406
 13407     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13408        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13409        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 244
* EL050.cbl
 13410         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13411
 13412     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13413         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13414             AND PB-COMPANY-ID NOT = 'DCC')
 13415                   OR
 13416              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13417              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13418              AND PB-COMPANY-ID NOT = 'DCC')
 13419             MOVE ER-2720        TO  WS-ERROR
 13420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13421             GO TO 3225-RATING-CONT
 13422         ELSE
 13423             GO TO 3225-RATING-CONT.
 13424     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13425        AND (AM-GPCD = 01 OR 06 OR 15)
 13426        MOVE ER-2798             TO WS-ERROR
 13427        PERFORM 9900-ERROR-FORMAT
 13428                                 THRU 9900-EXIT
 13429*       GO TO 3225-RATING-CONT
 13430     END-IF
 13431     IF (PB-COMPANY-ID = 'CID')
 13432        AND (WS-LF-EARNINGS-CALC = 'B')
 13433        AND (CP-STATE-STD-ABBRV = 'MN')
 13434        AND (PB-CERT-EFF-DT > X'A4FF')
 13435        GO TO 3225-RATING-CONT
 13436     END-IF
 13437     IF PB-COMPANY-ID = 'DCC'
 13438        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13439           AND (PB-I-POLICY-IS-MONTHLY)
 13440           GO TO 3225-RATING-CONT
 13441        END-IF
 13442     END-IF
 13443
 13444     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13445        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13446        CP-EARN-AS-REG-BALLOON
 13447        NEXT SENTENCE
 13448     ELSE
 13449        MOVE '2'                 TO CP-EARNING-METHOD.
 13450
 13451 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13452
 13453     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13454
 13455     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13456        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13457        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13458         NEXT SENTENCE
 13459     ELSE
 13460         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13461
 13462     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13463     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13464     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13465                                     CP-RATING-BENEFIT-AMT.
 13466     IF CP-STATE-STD-ABBRV = 'OR'
 13467         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 245
* EL050.cbl
 13468                                         PB-I-LF-ALT-BENEFIT-AMT.
 13469     IF PB-COMPANY-ID = 'DCC'
 13470        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13471     END-IF
 13472     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13473     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13474     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13475                                    CP-REMAINING-TERM
 13476                                    CP-LOAN-TERM.
 13477     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13478        ADD +1                   TO CP-ORIGINAL-TERM
 13479                                    CP-REMAINING-TERM
 13480                                    CP-LOAN-TERM.
 13481
 13482     MOVE 'R'                   TO CP-RATE-FILE.
 13483     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13484
 13485     IF CP-ERROR-RATE-NOT-FOUND
 13486         MOVE ER-2641            TO WS-ERROR
 13487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488         GO TO 3300-CHECK-AH-RATES.
 13489
 13490     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13491     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13492
 13493     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13494         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13495
 13496     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13497                               + PB-I-LF-ALT-BENEFIT-AMT.
 13498
 13499     IF ACCOUNT-LIFE-CHECKED  OR
 13500        PB-POLICY-IS-VOIDED   OR
 13501        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13502        GO TO 3225-CONTINUE.
 13503
 13504     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13505        GO TO 3225-CONTINUE.
 13506
 13507     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13508                             EC-RT-LF-MAX-TOT-BEN
 13509        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13510        MOVE ER-2639       TO WS-ERROR
 13511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13512
 13513 3225-CONTINUE.
 13514     IF PB-I-LF-ALT-RATE = ZERO
 13515         MOVE ER-2659            TO WS-ERROR
 13516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13517
 13518     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13519        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13520        MOVE ER-2698             TO WS-ERROR
 13521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13522
 13523 3225-RATING-CONT.
 13524
 13525     IF WS-LF-SPECIAL-CALC-CD = 'E'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 246
* EL050.cbl
 13526         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13527         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13528         IF (PB-COMPANY-ID = 'DCC')
 13529            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13530            CONTINUE
 13531         ELSE
 13532            MOVE ER-2687         TO WS-ERROR
 13533            PERFORM 9900-ERROR-FORMAT
 13534                                 THRU 9900-EXIT
 13535         END-IF
 13536         GO TO 3290-EDIT-LF-REIN-RATE
 13537     END-IF
 13538
 13539* DMD RATING TEST
 13540     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13541         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13542         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13543         MOVE ER-2687                 TO WS-ERROR
 13544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13545         GO TO 3290-EDIT-LF-REIN-RATE.
 13546
 13547 3230-CLIENT-MORT-CD-SPECIALS.
 13548
 13549     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13550     SET BIN-TO-GREG          TO TRUE.
 13551*    MOVE ' '                 TO DC-OPTION-CODE.
 13552     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13553     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13554
 13555 C-POS-3230-MORT-CD.
 13556     IF PB-COMPANY-ID = 'POS' AND
 13557        PB-SV-CARRIER = '2'
 13558         NEXT SENTENCE
 13559     ELSE
 13560         GO TO C-POS-3240-MORT-CD.
 13561
 13562     IF PB-SV-GROUPING = '030'
 13563        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13564         MOVE '2350' TO PB-I-MORT-CODE
 13565      ELSE
 13566         MOVE '3300' TO PB-I-MORT-CODE.
 13567
 13568
 13569 C-POS-3240-MORT-CD.
 13570     IF PB-COMPANY-ID = 'POS' AND
 13571        PB-SV-CARRIER = '1'
 13572         NEXT SENTENCE
 13573     ELSE
 13574         GO TO 3230-CONTINUE.
 13575
 13576     IF PB-SV-STATE = '45' OR '47'
 13577        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13578         MOVE '5200' TO PB-I-MORT-CODE
 13579     ELSE
 13580         MOVE '8300' TO PB-I-MORT-CODE.
 13581
 13582 3230-CONTINUE.
 13583
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 247
* EL050.cbl
 13584     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13585        GO TO 3240-CONTINUE
 13586     END-IF
 13587
 13588     IF PB-CERT-EFF-DT > WS-971231
 13589        GO TO 3240-CONTINUE
 13590     END-IF
 13591
 13592     IF LF-BENEFIT-FOUND AND
 13593        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13594         MOVE 'F250'       TO PB-I-MORT-CODE
 13595     ELSE
 13596         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13597             MOVE '7250'   TO PB-I-MORT-CODE
 13598         ELSE
 13599             MOVE '4251'   TO PB-I-MORT-CODE
 13600         END-IF
 13601     END-IF
 13602
 13603     .
 13604 3240-CONTINUE.
 13605
 13606     IF PB-COMPANY-ID NOT = 'GNL'
 13607         GO TO 3256-CONTINUE.
 13608
 13609     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13610         MOVE 'A300' TO PB-I-MORT-CODE
 13611     ELSE
 13612         MOVE '8350' TO PB-I-MORT-CODE.
 13613
 13614 3256-CONTINUE.
 13615     IF PB-COMPANY-ID NOT = 'ABL'
 13616         GO TO 3260-EDIT-CONTINUE.
 13617
 13618     IF PB-I-LF-TERM GREATER THAN 59
 13619         MOVE 'F550' TO PB-I-MORT-CODE
 13620     ELSE
 13621         MOVE 'E550' TO PB-I-MORT-CODE.
 13622
 13623 3260-EDIT-CONTINUE.
 13624     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13625
 13626 3290-EDIT-LF-REIN-RATE.
 13627     IF LF-REIN-NSP-NOT-USED
 13628         GO TO 3290-RATING-CONT.
 13629
 13630     IF PB-COMPANY-ID = 'DCC'
 13631        GO TO 3290-RATING-CONT.
 13632     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13633     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13634     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13635     MOVE '3'                   TO CP-PROCESS-TYPE.
 13636     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13637
 13638******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13639     IF PB-COMPANY-ID EQUAL 'CDL'
 13640         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13641            CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 248
* EL050.cbl
 13642             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13643*            MOVE SPACE          TO DC-OPTION-CODE
 13644             SET BIN-TO-GREG     TO TRUE
 13645             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13646***  Y2K PROJ 7744
 13647             IF DC-GREG-DATE-CYMD GREATER 19931231
 13648                 MOVE '1'        TO CP-EARNING-METHOD.
 13649***  Y2K PROJ 7744
 13650*******
 13651
 13652     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13653     MOVE PB-SV-STATE           TO CP-STATE.
 13654     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13655     MOVE ZERO                  TO CP-DEVIATION-CODE
 13656                                   CP-RATE-DEV-PCT.
 13657     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13658     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13659                                   CP-RATING-BENEFIT-AMT.
 13660
 13661************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13662     IF PB-COMPANY-ID EQUAL 'NCB'
 13663         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13664            CP-EARN-AS-NET-PAY
 13665             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13666                 PB-I-LF-PREMIUM-AMT.
 13667************
 13668
 13669     IF CP-STATE-STD-ABBRV = 'OR'
 13670         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13671                                         PB-I-LF-ALT-BENEFIT-AMT.
 13672     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13673     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13674     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13675     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13676     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13677     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13678     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13679     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13680                                   CP-REMAINING-TERM
 13681                                   CP-LOAN-TERM.
 13682     IF CP-TRUNCATED-LIFE
 13683        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13684
 13685     IF CP-TERM-IS-DAYS
 13686         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13687     ELSE
 13688         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13689
 13690     IF PB-COMPANY-ID = 'DCC'
 13691        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13692     END-IF
 13693     IF PB-COMPANY-ID NOT = 'TIC'
 13694          MOVE ZERO          TO CP-CLASS-CODE.
 13695
 13696     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13697
 13698     MOVE 'R'                   TO CP-RATE-FILE.
 13699     PERFORM 7000-GET-RATE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 249
* EL050.cbl
 13700
 13701     IF CP-ERROR-RATE-NOT-FOUND
 13702        IF PB-I-OB
 13703           MOVE ER-2625      TO WS-ERROR
 13704           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13705           GO TO 3299-EDIT-CONTINUE
 13706        ELSE
 13707           MOVE ER-2643      TO WS-ERROR
 13708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13709           GO TO 3299-EDIT-CONTINUE.
 13710
 13711     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13712
 13713     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13714     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13715
 13716     IF PB-I-LF-REI-RATE = ZERO
 13717         MOVE ER-2643        TO WS-ERROR
 13718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13719
 13720 3290-CHECK-ALT-REIN-RATE.
 13721
 13722     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13723        GO TO 3290-RATING-CONT.
 13724
 13725     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13726     MOVE '2'                    TO CP-EARNING-METHOD.
 13727     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13728     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13729     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13730     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13731                                     CP-RATING-BENEFIT-AMT.
 13732     IF CP-STATE-STD-ABBRV = 'OR'
 13733         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13734                                         PB-I-LF-ALT-BENEFIT-AMT.
 13735     IF PB-COMPANY-ID = 'DCC'
 13736        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13737     END-IF
 13738     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13739     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13740     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13741                                    CP-REMAINING-TERM
 13742                                    CP-LOAN-TERM.
 13743     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13744        ADD +1                   TO CP-ORIGINAL-TERM
 13745                                    CP-REMAINING-TERM
 13746                                    CP-LOAN-TERM.
 13747
 13748     MOVE 'R'                   TO CP-RATE-FILE.
 13749     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13750
 13751     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13752
 13753     IF PB-I-LF-ALT-REI-RATE = ZERO
 13754         MOVE ER-2643            TO WS-ERROR
 13755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13756
 13757 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 250
* EL050.cbl
 13758
 13759     IF PB-I-OB
 13760*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13761        GO TO 3300-CHECK-AH-RATES.
 13762
 13763 3299-EDIT-CONTINUE.
 13764
 13765     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13766         NEXT SENTENCE
 13767     ELSE
 13768         MOVE ER-2620           TO WS-ERROR
 13769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13770
 13771 3300-CHECK-AH-RATES.
 13772     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13773         NEXT SENTENCE
 13774     ELSE
 13775         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13776
 13777     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13778        ((CF-COMPANY-ID = 'DMD') AND
 13779                (NO-DMD-RATING))
 13780         IF (PB-COMPANY-ID = 'DCC')
 13781            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13782            CONTINUE
 13783         ELSE
 13784            MOVE ER-2687         TO WS-ERROR
 13785            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13786         END-IF
 13787         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13788         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13789     END-IF
 13790
 13791     IF PB-I-OB
 13792        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13793
 13794     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13795         MOVE ER-2687             TO WS-ERROR
 13796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13797         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13798         GO TO 3999-END-EDIT.
 13799
 13800*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13801
 13802     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13803        IF PB-I-AH-CRIT-PER = ZERO
 13804           IF PB-COMPANY-ID = 'DCC'
 13805              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13806              CONTINUE
 13807           ELSE
 13808              MOVE ER-2618       TO WS-ERROR
 13809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13810              GO TO 3999-END-EDIT
 13811           END-IF
 13812        END-IF
 13813     END-IF
 13814     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13815     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 251
* EL050.cbl
 13816     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13817     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13818     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13819     MOVE PB-SV-STATE            TO CP-STATE.
 13820     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13821     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13822     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13823*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13824     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13825     MOVE '3'                    TO CP-PROCESS-TYPE.
 13826     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13827     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13828                                    CP-RATING-BENEFIT-AMT.
 13829     IF PB-COMPANY-ID = 'CID'
 13830               OR
 13831        CP-STATE-STD-ABBRV = 'OR'
 13832         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13833                                         PB-I-AH-TERM.
 13834     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13835        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13836           AND (PB-I-POLICY-IS-MONTHLY)
 13837           MOVE PB-I-LF-BENEFIT-AMT
 13838                                 TO CP-NET-BENEFIT-AMT
 13839           move pb-i-ah-premium-amt to cp-original-premium
 13840        END-IF
 13841     END-IF
 13842     MOVE SPACES                 TO CP-BEN-CATEGORY
 13843     IF PB-COMPANY-ID = 'DCC'
 13844        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13845        EVALUATE TRUE
 13846           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13847              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13848              MOVE PB-I-LF-BENEFIT-AMT
 13849                                 TO CP-RATING-BENEFIT-AMT
 13850              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13851           WHEN WS-AH-BEN-CATEGORY = 'G'
 13852              MOVE PB-I-UNPAID-CASH-PRICE
 13853                                 TO CP-RATING-BENEFIT-AMT
 13854           WHEN WS-AH-BEN-CATEGORY = 'D'
 13855              MOVE WS-AH-PMF-COMM
 13856                                 TO CP-DCC-PMF-COMM
 13857              MOVE PB-I-AH-COMMISSION
 13858                                 TO CP-DCC-ACT-COMM
 13859        END-EVALUATE
 13860     END-IF
 13861     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13862     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13863     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13864     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13865     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13866     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13867     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13868                                    CP-REMAINING-TERM
 13869                                    WS-WORK-TERM.
 13870     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13871
 13872     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13873     SET BIN-TO-GREG             TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 252
* EL050.cbl
 13874*    MOVE ' '                    TO DC-OPTION-CODE.
 13875     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13876     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13877
 13878     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13879     IF NOT VALID-SKIP-CODE
 13880         MOVE ER-2683            TO WS-ERROR
 13881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13882         GO TO 3320-RATE-CONTINUE.
 13883
 13884     IF PB-NO-MONTHS-SKIPPED
 13885         GO TO 3320-RATE-CONTINUE.
 13886
 13887     MOVE SPACE TO NUMBER-OF-MONTHS.
 13888
 13889     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13890         MOVE 'S'                TO SK-MO (6).
 13891     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13892         MOVE 'S'                TO SK-MO (7).
 13893     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13894         MOVE 'S'                TO SK-MO (8).
 13895     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13896         MOVE 'S'                TO SK-MO (9).
 13897     IF PB-I-SKIP-CODE = 'A'
 13898         MOVE 'S'                TO SK-MO (10).
 13899
 13900     MOVE 1                      TO SUB2.
 13901     MOVE PB-I-AH-TERM           TO SUB3.
 13902     MOVE WS-MONTH               TO SUB1.
 13903     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13904     GO TO 3320-RATE-CONTINUE.
 13905
 13906 3310-GET-SKIP-MO.
 13907     IF SUB1 = 13
 13908         MOVE 1                  TO SUB1.
 13909
 13910     IF SK-MO (SUB1) = 'S'
 13911         SUBTRACT 1 FROM WS-WORK-TERM.
 13912
 13913     ADD 1 TO SUB2
 13914              SUB1.
 13915
 13916 3320-RATE-CONTINUE.
 13917
 13918     IF WS-WORK-TERM = ZERO
 13919         MOVE 1                  TO WS-WORK-TERM.
 13920
 13921     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13922                                    CP-LOAN-TERM.
 13923
 13924     IF PB-COMPANY-ID EQUAL 'DMD'
 13925         NEXT SENTENCE
 13926     ELSE
 13927         MOVE ZERO               TO PB-I-AH-RATE
 13928                                    PB-I-AH-REI-RATE.
 13929
 13930
 13931     IF PB-COMPANY-ID EQUAL 'CRI'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 253
* EL050.cbl
 13932        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13933
 13934     IF PB-COMPANY-ID = 'CSL'
 13935         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13936         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13937         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13938         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13939
 13940     IF PB-COMPANY-ID = 'DCC'
 13941        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13942           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13943              PB-I-RATE-DEV-PCT-LF
 13944        END-IF
 13945        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13946                                 TO CP-ALTERNATE-BENEFIT
 13947        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13948        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13949        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13950     END-IF
 13951     IF (PB-COMPANY-ID = 'CID')
 13952        AND (WS-LF-EARNINGS-CALC = 'B')
 13953        AND (CP-STATE-STD-ABBRV = 'MN')
 13954        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13955     ELSE
 13956        MOVE ' '                 TO CP-AH-BALLOON-SW
 13957     END-IF
 13958     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13959     MOVE 'R'                   TO CP-RATE-FILE.
 13960     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13961
 13962     IF CP-ERROR-RATE-NOT-FOUND
 13963        IF PB-I-OB
 13964           MOVE ER-2624          TO WS-ERROR
 13965           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13966           GO TO 3340-CALCULATE-PREMIUM-AMT
 13967        ELSE
 13968          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13969              NEXT SENTENCE
 13970          ELSE
 13971           MOVE ER-2642          TO WS-ERROR
 13972           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13973           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13974
 13975     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13976        CP-ERROR-DIV-BY-ZERO
 13977           MOVE ER-3782          TO WS-ERROR
 13978           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13979
 13980     IF PB-COMPANY-ID EQUAL 'CRI'
 13981        IF CP-ERROR-NO-LIMITS-CRI
 13982           IF NOT ACCOUNT-AH-CHECKED
 13983              MOVE ER-2607          TO WS-ERROR
 13984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13985
 13986     IF ACCOUNT-AH-CHECKED
 13987        NEXT SENTENCE
 13988     ELSE
 13989       IF CP-ERROR-AMT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 254
* EL050.cbl
 13990          MOVE ER-2640           TO WS-ERROR
 13991          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13992
 13993     IF PB-COMPANY-ID = 'CRI'
 13994         IF WS-ERROR = ER-2640
 13995             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13996     IF ACCOUNT-AH-CHECKED
 13997        CONTINUE
 13998     ELSE
 13999        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14000           AND (CP-R-MAX-ATT-AGE > +0)
 14001           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14002           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14003              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14004              MOVE PB-I-AH-EXPIRE-DT
 14005                                 TO DC-BIN-DATE-2
 14006              MOVE '1'           TO DC-OPTION-CODE
 14007              PERFORM 8500-DATE-CONVERT
 14008                                 THRU 8500-EXIT
 14009              IF NO-CONVERSION-ERROR
 14010                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14011                    MOVE ER-2661       TO WS-ERROR
 14012*                   PERFORM 9900-ERROR-FORMAT
 14013*                                THRU 9900-EXIT
 14014                 END-IF
 14015              END-IF
 14016           ELSE
 14017              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14018              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14019                 MOVE ER-2661    TO WS-ERROR
 14020*                PERFORM 9900-ERROR-FORMAT
 14021*                                THRU 9900-EXIT
 14022              ELSE
 14023                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14024                    MOVE ER-1570 TO WS-ERROR
 14025                    PERFORM 9900-ERROR-FORMAT
 14026                                 THRU 9900-EXIT
 14027                 END-IF
 14028              END-IF
 14029           END-IF
 14030           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14031              MOVE PB-I-JOINT-BIRTHDAY
 14032                                    TO DC-BIN-DATE-1
 14033              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14034              MOVE '1'              TO DC-OPTION-CODE
 14035              PERFORM 8500-DATE-CONVERT
 14036                                    THRU 8500-EXIT
 14037              IF NO-CONVERSION-ERROR
 14038                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14039                    MOVE ER-2661       TO WS-ERROR
 14040*                   PERFORM 9900-ERROR-FORMAT
 14041*                                   THRU 9900-EXIT
 14042                 END-IF
 14043              END-IF
 14044           ELSE
 14045              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14046                (PB-I-AH-TERM / 12)
 14047              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 255
* EL050.cbl
 14048                 MOVE ER-2661       TO WS-ERROR
 14049*                PERFORM 9900-ERROR-FORMAT
 14050*                                   THRU 9900-EXIT
 14051              ELSE
 14052                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14053                    MOVE ER-1571 TO WS-ERROR
 14054                    PERFORM 9900-ERROR-FORMAT
 14055                                 THRU 9900-EXIT
 14056                 END-IF
 14057              END-IF
 14058           END-IF
 14059           IF WS-ERROR = ER-2661
 14060              PERFORM 9900-ERROR-FORMAT
 14061                                    THRU 9900-EXIT
 14062           END-IF
 14063        END-IF
 14064     END-IF
 14065*    IF ACCOUNT-AH-CHECKED
 14066*       NEXT SENTENCE
 14067*    ELSE
 14068*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14069*          MOVE ER-2661          TO WS-ERROR
 14070*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14071
 14072     IF ACCOUNT-AH-CHECKED
 14073        NEXT SENTENCE
 14074     ELSE
 14075        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14076           MOVE ER-2663          TO WS-ERROR
 14077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14078
 14079     IF ACCOUNT-AH-CHECKED OR
 14080        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14081         PB-POLICY-IS-VOIDED
 14082        NEXT SENTENCE
 14083     ELSE
 14084        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14085           MOVE ER-2667            TO WS-ERROR
 14086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14087
 14088     IF PB-COMPANY-ID = 'CRI'
 14089         IF WS-ERROR = ER-2667
 14090             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14091
 14092     IF ACCOUNT-AH-CHECKED
 14093        NEXT SENTENCE
 14094     ELSE
 14095        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14096           MOVE ER-2678            TO WS-ERROR
 14097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14098
 14099     IF CP-ERROR-RATE-FILE-NOTOPEN
 14100         GO TO 3990-FILES-NOT-OPEN.
 14101
 14102 3321-CONTINUE.
 14103     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14104     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14105     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 256
* EL050.cbl
 14106        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14107        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14108                                    PB-I-LF-ALT-PREM-CALC
 14109        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14110        IF WS-AH-BEN-CATEGORY = 'G'
 14111           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14112           + PB-I-ADDL-CLP)
 14113           * (1 + WS-TOL-CLP-PCT)
 14114*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14115        ELSE
 14116           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14117           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14118*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14119        END-IF
 14120        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14121                                 TO PB-I-AH-PREM-CALC
 14122        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14123           MOVE ER-8152          TO WS-ERROR
 14124           PERFORM 9900-ERROR-FORMAT
 14125                                 THRU 9900-EXIT
 14126        ELSE
 14127           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14128                 PB-I-ADDL-CLP)
 14129              MOVE ER-8148       TO WS-ERROR
 14130              PERFORM 9900-ERROR-FORMAT
 14131                                 THRU 9900-EXIT
 14132           END-IF
 14133        END-IF
 14134     END-IF
 14135     IF (PB-COMPANY-ID = 'DCC')
 14136        AND (PB-I-POLICY-IS-MONTHLY)
 14137        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14138        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14139        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14140           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14141        END-IF
 14142     END-IF
 14143     IF (PB-COMPANY-ID = 'DCC')
 14144        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14145        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14146        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14147        MOVE ER-2786             TO WS-ERROR
 14148        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14149     END-IF
 14150     MOVE +0                     TO PB-I-AH-CLP
 14151     IF PB-COMPANY-ID = 'DCC'
 14152        IF WS-AH-BEN-CATEGORY = 'D'
 14153           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14154              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14155        ELSE
 14156           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14157              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14158           END-IF
 14159        END-IF
 14160     END-IF
 14161     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14162
 14163     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 257
* EL050.cbl
 14164         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14165
 14166     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14167         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14168
 14169     IF PB-COMPANY-ID = 'CRI'
 14170         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14171            PB-I-PAYMENT-AMOUNT = ZERO
 14172             NEXT SENTENCE
 14173         ELSE
 14174             COMPUTE PB-I-AH-PREM-CALC =
 14175                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14176                 (CP-PREMIUM-RATE / 100)
 14177             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14178                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14179                                             PB-I-RATE-DEV-PCT-AH.
 14180
 14181     IF PB-I-AH-RATE  = ZERO
 14182       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14183           NEXT SENTENCE
 14184       ELSE
 14185         MOVE ER-2642            TO WS-ERROR
 14186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14187
 14188     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14189     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14190     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14191     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14192     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14193     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14194
 14195     IF (PB-COMPANY-ID = 'DCC')
 14196        AND (WS-AH-BEN-CATEGORY = 'G')
 14197        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14198        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14199        IF CP-DEVIATION-CODE NOT = '000'
 14200           MOVE '000'            TO CP-DEVIATION-CODE
 14201           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14202           IF NO-CP-ERROR
 14203              COMPUTE PB-I-DDF-IU-RATE-UP =
 14204              PB-I-AH-CLP - CP-CALC-PREMIUM
 14205           ELSE
 14206              MOVE ER-3057        TO WS-ERROR
 14207              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14208           END-IF
 14209        END-IF
 14210     END-IF
 14211     .
 14212 3335-EDIT-AH-REIN-NSP-RATE.
 14213     IF AH-REIN-NSP-NOT-USED
 14214         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14215
 14216     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14217     IF PB-COMPANY-ID = 'DCC'
 14218         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14219     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14220     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14221     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 258
* EL050.cbl
 14222     MOVE PB-SV-STATE            TO CP-STATE.
 14223     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14224     MOVE ZERO                   TO CP-DEVIATION-CODE
 14225                                    CP-RATE-DEV-PCT.
 14226*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14227     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14228     MOVE '3'                    TO CP-PROCESS-TYPE.
 14229     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14230     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14231                                    CP-RATING-BENEFIT-AMT.
 14232     IF CP-STATE-STD-ABBRV = 'OR'
 14233         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14234                                         PB-I-AH-TERM.
 14235     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14236     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14237     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14238     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14239     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14240     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14241                                    CP-REMAINING-TERM
 14242                                    WS-WORK-TERM.
 14243     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14244     IF PB-COMPANY-ID = 'DCC'
 14245        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14246     END-IF
 14247     IF  PB-COMPANY-ID = 'TIC'
 14248         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14249            MOVE ZERO TO CP-CLASS-CODE.
 14250
 14251     IF PB-COMPANY-ID NOT = 'TIC'
 14252          MOVE ZERO          TO CP-CLASS-CODE.
 14253
 14254     MOVE ZERO               TO CP-DEVIATION-CODE.
 14255
 14256     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14257
 14258     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14259
 14260     MOVE 'R'                   TO CP-RATE-FILE.
 14261     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14262
 14263     IF CP-ERROR-RATE-NOT-FOUND
 14264         MOVE ER-2645        TO WS-ERROR
 14265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14267
 14268     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14269
 14270     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14271     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14272
 14273     IF PB-I-AH-REI-RATE = ZERO
 14274         MOVE ER-2645        TO WS-ERROR
 14275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14276
 14277
 14278 3340-CALCULATE-PREMIUM-AMT.
 14279
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 259
* EL050.cbl
 14280     IF PB-COMPANY-ID = 'NCL'
 14281         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14282             WS-AH-SPECIAL-CALC-CD = 'O')
 14283             GO TO 3999-END-EDIT.
 14284
 14285     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14286                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14287                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14288                         OR 'AHL'
 14289         NEXT SENTENCE
 14290     ELSE
 14291         IF WS-STATE-ABBREVIATION = 'CT'
 14292             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14293                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14294                 COMPUTE PB-I-LF-PREM-CALC =
 14295                                     PB-I-LF-PREM-CALC * .90
 14296                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14297                                     PB-I-LF-ALT-PREM-CALC * .90
 14298                 COMPUTE PB-I-AH-PREM-CALC =
 14299                                     PB-I-AH-PREM-CALC * .90.
 14300
 14301     IF PB-COMP-LF-PREM
 14302        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14303        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14304
 14305     IF PB-COMP-AH-PREM
 14306        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14307
 14308 3340-CHECK-DCC-TOT-FEES.
 14309     IF (PB-COMPANY-ID = 'DCC')
 14310        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14311        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14312        AND (PB-I-POLICY-IS-MONTHLY)
 14313        CONTINUE
 14314     ELSE
 14315        GO TO 3340-EDIT-LF-AH-TOL
 14316     END-IF
 14317     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14318     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14319     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14320        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14321           PB-I-RATE-DEV-PCT-LF
 14322     END-IF
 14323     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14324        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14325           PB-I-RATE-DEV-PCT-AH
 14326     END-IF
 14327     MOVE 'N'                    TO CP-BEN-CATEGORY
 14328     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14329
 14330     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14331     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14332     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14333     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14334     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14335     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14336     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14337     MOVE '3'                    TO CP-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 260
* EL050.cbl
 14338     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14339     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14340
 14341     MOVE PB-SV-STATE            TO CP-STATE.
 14342     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14343     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14344     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14345     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14346     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14347                                    CP-RATING-BENEFIT-AMT.
 14348     IF CP-STATE-STD-ABBRV = 'OR'
 14349         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14350                                         PB-I-LF-ALT-BENEFIT-AMT.
 14351     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14352     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14353     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14354     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14355     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14356     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14357     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14358     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14359     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14360                                    CP-REMAINING-TERM
 14361                                    CP-LOAN-TERM.
 14362
 14363     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14364         NEXT SENTENCE
 14365     ELSE
 14366         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14367             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14368                                           PB-I-LF-PREMIUM-AMT.
 14369
 14370     IF CP-TRUNCATED-LIFE
 14371        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14372
 14373     IF CP-TERM-IS-DAYS
 14374         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14375     ELSE
 14376         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14377
 14378     IF PB-COMPANY-ID = 'DCC'
 14379        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14380     END-IF
 14381     IF CP-SPECIAL-CALC-CD = 'H'
 14382         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14383                                    TO CP-ALTERNATE-BENEFIT
 14384         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14385     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14386     MOVE 'R'                    TO CP-RATE-FILE
 14387     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14388     IF NOT CP-ERROR-RATE-NOT-FOUND
 14389        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14390        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14391           AND (CP-BENEFIT-CD (1:1) = 'S')
 14392           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14393                                    PB-I-LF-PREMIUM-AMT
 14394        END-IF
 14395     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 261
* EL050.cbl
 14396        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14397     END-IF
 14398     .
 14399 3340-EDIT-LF-AH-TOL.
 14400
 14401***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14402***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14403***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14404***
 14405     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14406         PB-I-AH-PREMIUM-AMT
 14407          GIVING WS-CALC-WORK.
 14408
 14409     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14410        AND WS-CALC-WORK NOT = ZERO
 14411         MOVE ER-2649            TO WS-ERROR
 14412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14413
 14414     SUBTRACT PB-I-LF-PREM-CALC
 14415             FROM PB-I-LF-PREMIUM-AMT
 14416                 GIVING WS-UNSIGN-WRK1.
 14417
 14418     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14419             FROM PB-I-LF-ALT-PREMIUM-AMT
 14420                 GIVING WS-UNSIGN-WRK4.
 14421
 14422     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14423                                + WS-UNSIGN-WRK4.
 14424
 14425     SUBTRACT PB-I-AH-PREM-CALC
 14426             FROM PB-I-AH-PREMIUM-AMT
 14427                 GIVING WS-UNSIGN-WRK2.
 14428
 14429******************************************************************
 14430*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14431******************************************************************
 14432
 14433     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14434         MOVE ZERO TO WS-UNSIGN-WRK1.
 14435
 14436     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14437         MOVE ZERO TO WS-UNSIGN-WRK2.
 14438
 14439     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14440             GIVING WS-UNSIGN-WRK3.
 14441
 14442 3342-CONTINUE.
 14443
 14444     IF (PB-I-LF-RATE = ZERO  AND
 14445         PB-I-AH-RATE = ZERO)
 14446         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14447            WS-AH-SPECIAL-CALC-CD = 'O'
 14448              NEXT SENTENCE
 14449         ELSE
 14450             GO TO 3345-EDIT-CONTINUE.
 14451
 14452     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14453         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 262
* EL050.cbl
 14454     ELSE
 14455     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14456        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14457           IF (PB-REISSUED-CERT         OR
 14458               PB-POLICY-IS-DECLINED    OR
 14459               PB-POLICY-IS-VOIDED)
 14460              NEXT SENTENCE
 14461           ELSE
 14462              IF WS-PREM-REJECT-SW = SPACE
 14463                 MOVE ER-2652    TO WS-ERROR
 14464                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14465                 GO TO 3344-CHECK-AH
 14466              ELSE
 14467                 MOVE ER-2650    TO WS-ERROR
 14468                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14469                 GO TO 3344-CHECK-AH.
 14470
 14471***
 14472***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14473***
 14474
 14475     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14476         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14477            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14478             (1 + WS-TOL-LF-PREM-PCT)
 14479         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14480            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14481             (1 - WS-TOL-LF-PREM-PCT)
 14482     ELSE
 14483         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14484         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14485
 14486***
 14487***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14488***
 14489
 14490     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14491         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14492          WS-TOL-LF-PREM.
 14493
 14494     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14495         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14496          WS-TOL-LF-PREM.
 14497
 14498     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14499        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14500
 14501     IF (PB-REISSUED-CERT        OR
 14502         PB-POLICY-IS-DECLINED   OR
 14503         PB-POLICY-IS-VOIDED)
 14504        NEXT SENTENCE
 14505     ELSE
 14506     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14507           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14508       OR
 14509        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14510           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14511       AND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 263
* EL050.cbl
 14512        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14513           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14514         OR
 14515          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14516           LESS WS-TOL-LF-LOW-PREM-PCT))
 14517              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14518                  MOVE ER-2652   TO  WS-ERROR
 14519                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14520              ELSE
 14521                  MOVE ER-2650   TO  WS-ERROR
 14522                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14523
 14524*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14525*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14526*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14527*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14528
 14529     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14530        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14531                      OR
 14532           ((PB-COMPANY-ID = 'DCC')
 14533           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14534           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14535           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14536        END-IF
 14537     END-IF
 14538
 14539     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14540        IF WS-COMP-MAX-CAP GREATER THAN +0
 14541           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14542              IF (PB-REISSUED-CERT         OR
 14543                  PB-POLICY-IS-DECLINED    OR
 14544                  PB-POLICY-IS-VOIDED)
 14545                 NEXT SENTENCE
 14546              ELSE
 14547                  MOVE ER-2646   TO  WS-ERROR
 14548                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14549
 14550 3344-CVL-TOLERANCE-CHECK.
 14551
 14552      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14553          GO TO 3344-CHECK-AH.
 14554
 14555      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14556          GO TO 3344-CHECK-AH.
 14557
 14558      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14559                                     WS-UNSIGN-WRK6.
 14560
 14561      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14562          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14563                                 + PB-I-LF-PREMIUM-AMT
 14564                                 - PB-I-LF-PREM-CALC.
 14565
 14566      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14567          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14568                                 + PB-I-LF-ALT-PREMIUM-AMT
 14569                                 - PB-I-LF-ALT-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 264
* EL050.cbl
 14570
 14571      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14572          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14573              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14574                 MOVE ER-2652    TO  WS-ERROR
 14575                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14576              ELSE
 14577                 MOVE ER-2650    TO  WS-ERROR
 14578                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14579
 14580      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14581          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14582              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14583                 MOVE ER-2652    TO  WS-ERROR
 14584                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14585              ELSE
 14586                 MOVE ER-2650    TO  WS-ERROR
 14587                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14588
 14589 3344-CHECK-AH.
 14590
 14591****************************************************************
 14592***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14593***
 14594
 14595     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14596         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14597             (1 + WS-TOL-AH-PREM-PCT)
 14598         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14599             (1 - WS-TOL-AH-PREM-PCT)
 14600     ELSE
 14601         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14602         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14603
 14604***
 14605***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14606***
 14607
 14608     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14609         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14610
 14611     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14612         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14613
 14614     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14615        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14616
 14617     IF (PB-REISSUED-CERT)
 14618        OR (PB-POLICY-IS-DECLINED)
 14619        OR (PB-POLICY-IS-VOIDED)
 14620        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14621        CONTINUE
 14622     ELSE
 14623        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14624            OR
 14625           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14626           AND
 14627           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 265
* EL050.cbl
 14628           OR
 14629           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14630           IF WS-PREM-REJECT-SW = SPACE
 14631              MOVE ER-3052       TO WS-ERROR
 14632              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14633           ELSE
 14634              MOVE ER-3050       TO WS-ERROR
 14635              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14636           END-IF
 14637        END-IF
 14638     END-IF
 14639
 14640     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14641         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14642             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14643             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14644
 14645     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14646        IF WS-COMP-MAX-CAP GREATER THAN +0
 14647           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14648              IF (PB-REISSUED-CERT         OR
 14649                  PB-POLICY-IS-DECLINED    OR
 14650                  PB-POLICY-IS-VOIDED)
 14651                 NEXT SENTENCE
 14652              ELSE
 14653                  MOVE ER-2646   TO  WS-ERROR
 14654                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14655
 14656     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14657        (WS-COMP-MAX-CAP EQUAL +0)
 14658           GO TO 3345-EDIT-CONTINUE.
 14659
 14660     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14661        GREATER THAN WS-COMP-MAX-CAP
 14662           MOVE ER-2646          TO  WS-ERROR
 14663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14664
 14665 3345-EDIT-CONTINUE.
 14666
 14667*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14668*       IF PB-ENTRY-BATCH   NUMERIC
 14669*          IF PB-ISSUE
 14670*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14671*          ELSE
 14672*              IF PB-CANCELLATION
 14673*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14674
 14675*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14676*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14677*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14678*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14679*        ELSE
 14680*            MOVE  ER-1909            TO  WS-ERROR
 14681*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14682
 14683     IF PB-I-POLICY-ACCEPTED
 14684        IF PB-POLICY-IS-DECLINED  OR
 14685           PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 266
* EL050.cbl
 14686           PB-REIN-ONLY-CERT  OR
 14687           PB-POLICY-IS-VOIDED
 14688            MOVE  ER-1891         TO  WS-ERROR
 14689            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14690        ELSE
 14691            MOVE SPACE            TO  PB-BATCH-ENTRY
 14692            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14693
 14694     IF PB-I-POLICY-DECLINED
 14695        IF PB-REISSUED-CERT  OR
 14696           PB-REIN-ONLY-CERT  OR
 14697           PB-POLICY-IS-VOIDED
 14698            MOVE  ER-1906         TO  WS-ERROR
 14699            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14700        ELSE
 14701            MOVE  'D'             TO  PB-BATCH-ENTRY
 14702                                      PB-I-ENTRY-STATUS.
 14703
 14704     IF PB-I-NEEDS-UNDERWRITING
 14705        IF PB-POLICY-IS-DECLINED OR
 14706           PB-REISSUED-CERT  OR
 14707           PB-REIN-ONLY-CERT  OR
 14708           PB-POLICY-IS-VOIDED
 14709            MOVE  ER-1907         TO  WS-ERROR
 14710            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14711        ELSE
 14712            MOVE 'U'              TO  PB-BATCH-ENTRY
 14713                                      PB-I-ENTRY-STATUS.
 14714
 14715     IF PB-NEEDS-UNDERWRITING
 14716        MOVE  ER-1901             TO  WS-ERROR
 14717        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14718     IF PB-COMPANY-ID = 'DCC'
 14719        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14720        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14721        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14722           AND (NOT WS-LF-CASH))
 14723                           OR
 14724           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14725           AND (NOT WS-AH-CASH)))
 14726                       AND
 14727           (PB-I-ENTRY-STATUS NOT = '5')
 14728           MOVE 'M'              TO PB-BATCH-ENTRY
 14729                                    PB-I-ENTRY-STATUS
 14730        END-IF
 14731     END-IF
 14732     IF  PB-COMPANY-ID NOT = 'NCL'
 14733         GO TO 3999-END-EDIT.
 14734
 14735     IF PB-REISSUED-CERT  OR
 14736        PB-POLICY-IS-DECLINED  OR
 14737        PB-POLICY-IS-VOIDED  OR
 14738        PB-I-OB
 14739         GO TO 3999-END-EDIT.
 14740
 14741     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14742         MOVE  ER-2644            TO  WS-ERROR
 14743         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 267
* EL050.cbl
 14744         GO TO 3999-END-EDIT.
 14745
 14746     MOVE 'N'                     TO  FORM-MASTER-SW.
 14747     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14748
 14749     IF NOT FORM-MASTER-FOUND
 14750         GO TO 3999-END-EDIT.
 14751
 14752     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14753                                      FORM-MASTER-AH-SW.
 14754
 14755     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14756         MOVE  +1                 TO SUB6
 14757         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14758
 14759     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14760         MOVE  +1                 TO SUB6
 14761         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14762
 14763     IF LF-FORM-MASTER-FOUND  OR
 14764        AH-FORM-MASTER-FOUND
 14765         GO TO 3360-CHECK-FORM-LIMITS
 14766     ELSE
 14767         GO TO 3999-END-EDIT.
 14768
 14769******************************************************************
 14770*                  3350-GET-ERFORM                               *
 14771*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14772*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14773******************************************************************
 14774
 14775 3350-GET-ERFORM.
 14776
 14777     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14778         GO TO  3350-ERFORM-GETMAIN.
 14779
 14780     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14781     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14782     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14783     MOVE 'Y'                     TO FORM-MASTER-SW.
 14784
 14785     IF PB-CANCELLATION
 14786         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14787            PB-SV-STATE          EQUAL   FO-STATE       AND
 14788            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14789              GO TO 3350-EXIT
 14790         ELSE
 14791             NEXT SENTENCE
 14792     ELSE
 14793         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14794            PB-SV-STATE          EQUAL   FO-STATE       AND
 14795            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14796              GO TO 3350-EXIT.
 14797
 14798 3350-ERFORM-GETMAIN.
 14799
 14800     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14801     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 268
* EL050.cbl
 14802
 14803 3350-ERFORM-READ.
 14804
 14805     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14806     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14807     IF PB-CANCELLATION
 14808         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14809     ELSE
 14810         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14811     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14812
 14813     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14814
 14815     IF FORM-MASTER-FOUND
 14816       IF PB-CANCELLATION
 14817          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14818             PB-SV-STATE          EQUAL   FO-STATE       AND
 14819             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14820              GO  TO 3350-EXIT
 14821          ELSE
 14822              NEXT SENTENCE
 14823       ELSE
 14824          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14825             PB-SV-STATE          EQUAL   FO-STATE       AND
 14826             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14827              GO  TO 3350-EXIT.
 14828
 14829     MOVE  'N'                    TO  FORM-MASTER-SW.
 14830     MOVE  ER-1895                TO  WS-ERROR.
 14831     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14832
 14833 3350-EXIT.
 14834      EXIT.
 14835
 14836******************************************************************
 14837*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14838*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14839*   VALID FOR THE POLICY FORM USED.                              *
 14840******************************************************************
 14841
 14842 3355-EDIT-FORM-LF-BENEFITS.
 14843
 14844     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14845        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14846         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14847         GO TO   3355-EXIT.
 14848
 14849     IF  SUB6    LESS THAN   +40
 14850         ADD  +1      TO  SUB6
 14851         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14852
 14853     MOVE  ER-1896         TO  WS-ERROR.
 14854     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14855
 14856 3355-EXIT.
 14857      EXIT.
 14858
 14859******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 269
* EL050.cbl
 14860*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14861*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14862*   VALID FOR THE POLICY FORM USED.                              *
 14863******************************************************************
 14864
 14865 3356-EDIT-FORM-AH-BENEFITS.
 14866
 14867     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14868        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14869         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14870         GO TO  3356-EXIT.
 14871
 14872      IF  SUB6    LESS THAN     +40
 14873          ADD  +1      TO  SUB6
 14874          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14875
 14876     MOVE  ER-1897         TO  WS-ERROR.
 14877     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14878
 14879 3356-EXIT.
 14880      EXIT.
 14881
 14882******************************************************************
 14883*                  3357-BENEFIT-SEARCH                           *
 14884*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14885*   CANCELLATIONS ONLY.                                          *
 14886******************************************************************
 14887 3357-BENEFIT-SEARCH.
 14888     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14889         MOVE +1                          TO SUB6
 14890         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14891
 14892     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14893         MOVE +1                          TO SUB6
 14894         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14895
 14896 3357-EXIT.
 14897     EXIT.
 14898
 14899******************************************************************
 14900*                  3358-BENEFIT-LIFE-SEARCH                      *
 14901*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14902*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14903*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14904******************************************************************
 14905 3358-BENEFIT-LIFE-SEARCH.
 14906     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14907       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14908         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14909           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14910              IF FO-PLAN-REFUND-METHOD (SUB6)
 14911                     IS GREATER THAN SPACES
 14912                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14913                                          WS-LF-REFUND-CALC
 14914                 GO TO 3358-EXIT.
 14915
 14916     IF SUB6 LESS THAN +40
 14917         ADD +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 270
* EL050.cbl
 14918         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14919
 14920 3358-EXIT.
 14921     EXIT.
 14922******************************************************************
 14923*                  3359-BENEFIT-AH-SEARCH                        *
 14924*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14925*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14926*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14927******************************************************************
 14928 3359-BENEFIT-AH-SEARCH.
 14929     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14930       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14931         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14932           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14933              IF FO-PLAN-REFUND-METHOD (SUB6)
 14934                      IS GREATER THAN SPACES
 14935                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14936                                          WS-AH-REFUND-CALC
 14937                 GO TO 3359-EXIT.
 14938
 14939     IF SUB6 LESS THAN +40
 14940         ADD +1                 TO SUB6
 14941         GO TO 3359-BENEFIT-AH-SEARCH.
 14942
 14943 3359-EXIT.
 14944     EXIT.
 14945
 14946******************************************************************
 14947*                  3360-CHECK-FORM-LIMITS                        *
 14948*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14949*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14950******************************************************************
 14951
 14952 3360-CHECK-FORM-LIMITS.
 14953
 14954     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14955         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14956
 14957     IF NOT LF-FORM-MASTER-FOUND
 14958         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14959
 14960 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14961
 14962     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14963       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14964        WS-LF-JOINT-INDICATOR = 'J'  AND
 14965        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14966         IF PB-COMPANY-ID = 'NCL'
 14967            MOVE  ER-1911          TO  WS-ERROR
 14968            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14969         ELSE
 14970            MOVE  ER-1892          TO  WS-ERROR
 14971            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14972
 14973 3360-CHECK-FORM-LF-ATT-AGE.
 14974
 14975     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 271
* EL050.cbl
 14976
 14977     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14978         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14979         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14980            IF PB-COMPANY-ID = 'NCL'
 14981                MOVE  ER-1913      TO  WS-ERROR
 14982                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14983            ELSE
 14984                MOVE  ER-1894      TO  WS-ERROR
 14985                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14986
 14987 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14988
 14989     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14990         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14991         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14992            IF PB-COMPANY-ID = 'NCL'
 14993                MOVE  ER-1914      TO  WS-ERROR
 14994                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14995            ELSE
 14996                MOVE  ER-1899      TO  WS-ERROR
 14997                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14998
 14999 3360-CHECK-FORM-LF-TERM-BAMT.
 15000
 15001     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15002         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15003         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15004           IF  PB-COMPANY-ID = 'NCL'
 15005               MOVE  ER-1916       TO  WS-ERROR
 15006               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15007           ELSE
 15008               MOVE  ER-1902       TO  WS-ERROR
 15009               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15010
 15011     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15012                                    PB-I-LF-ALT-BENEFIT-AMT.
 15013
 15014     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15015         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15016         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15017             IF  PB-COMPANY-ID = 'NCL'
 15018                 MOVE  ER-1918     TO  WS-ERROR
 15019                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15020             ELSE
 15021                 MOVE  ER-1904     TO  WS-ERROR
 15022                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15023
 15024******************************************************************
 15025*                  3360-CHECK-FORM-AH-LIMITS                     *
 15026*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15027*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15028******************************************************************
 15029
 15030 3360-CHECK-FORM-AH-LIMITS.
 15031
 15032     IF NOT AH-FORM-MASTER-FOUND
 15033         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 272
* EL050.cbl
 15034
 15035 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15036
 15037     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15038       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15039        WS-AH-JOINT-INDICATOR = 'J'  AND
 15040        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15041         IF PB-COMPANY-ID = 'NCL'
 15042            MOVE  ER-1912          TO  WS-ERROR
 15043            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15044         ELSE
 15045            MOVE  ER-1893          TO  WS-ERROR
 15046            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15047
 15048 3360-CHECK-FORM-AH-ATT-AGE.
 15049
 15050     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15051
 15052     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15053         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15054         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15055            IF PB-COMPANY-ID = 'NCL'
 15056                MOVE  ER-1913      TO  WS-ERROR
 15057                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15058            ELSE
 15059                MOVE  ER-1894      TO  WS-ERROR
 15060                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15061
 15062 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15063
 15064     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15065         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15066         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15067            IF PB-COMPANY-ID = 'NCL'
 15068                MOVE  ER-1915      TO  WS-ERROR
 15069                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15070            ELSE
 15071                MOVE  ER-1900      TO  WS-ERROR
 15072                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15073
 15074 3360-CHECK-FORM-AH-TERM-BAMT.
 15075
 15076     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15077         FO-AH-MAX-TERM    GREATER THAN  +0
 15078         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15079             IF  PB-COMPANY-ID = 'NCL'
 15080                 MOVE  ER-1917     TO  WS-ERROR
 15081                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15082             ELSE
 15083                  MOVE  ER-1903    TO  WS-ERROR
 15084                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15085
 15086     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15087         FO-MAX-AH-AMT    GREATER THAN  +0
 15088         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15089             IF  PB-COMPANY-ID = 'NCL'
 15090                 MOVE  ER-1919     TO  WS-ERROR
 15091                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 273
* EL050.cbl
 15092             ELSE
 15093                 MOVE  ER-1905     TO  WS-ERROR
 15094                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15095
 15096     GO TO 3999-END-EDIT.
 15097
 15098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 274
* EL050.cbl
 15100******************************************************************
 15101*                  E D I T   C A N C E L                         *
 15102******************************************************************
 15103
 15104 3700-EDIT-CANCEL.
 15105     IF PB-COMPANY-ID = 'DMD'
 15106         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15107                                         WS-RES-MUNI-TAX
 15108                                         PB-CI-STATE-TAX
 15109                                         PB-CI-MUNI-TAX
 15110         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15111
 15112*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15113*       IF PB-ENTRY-BATCH  NUMERIC
 15114*          IF PB-CANCELLATION
 15115*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15116*          ELSE
 15117*             IF PB-ISSUE
 15118*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15119
 15120     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15121        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15122     END-IF
 15123*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15124*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15125
 15126     IF CM-ENTRY-STATUS = 'V'
 15127        MOVE ER-2780             TO WS-ERROR
 15128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15129        GO TO 3999-END-EDIT.
 15130
 15131     IF CM-ENTRY-STATUS = 'D'
 15132        MOVE ER-2781             TO WS-ERROR
 15133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15134        GO TO 3999-END-EDIT.
 15135
 15136     IF CM-ENTRY-STATUS = 'U'
 15137        MOVE ER-2782             TO WS-ERROR
 15138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15139
 15140***************************************************************
 15141*                                                             *
 15142*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15143*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15144*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15145*   OF ANOTHER COVERAGE.                                      *
 15146*                                                             *
 15147***************************************************************
 15148
 15149     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15150                                    PB-C-AH-CANCEL-VOID-SW.
 15151
 15152     IF PB-C-LF-CANCEL-AMT = ZERO
 15153        NEXT SENTENCE
 15154     ELSE
 15155        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15156           AND
 15157           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 275
* EL050.cbl
 15158               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15159               MOVE ER-2745           TO WS-ERROR
 15160               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15161
 15162     IF PB-C-AH-CANCEL-AMT = ZERO
 15163        NEXT SENTENCE
 15164     ELSE
 15165        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15166           AND
 15167           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15168               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15169               MOVE ER-2745           TO WS-ERROR
 15170               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15171
 15172     IF WS-LF-EARNINGS-CALC = '4'
 15173        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15174
 15175     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15176     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15177     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15178     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15179     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15180     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15181
 15182     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15183                                      PB-C-AH-REF-CALC.
 15184     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15185
 15186******************************************************************
 15187*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15188*             TO VALIDATE COVERAGE.                              *
 15189******************************************************************
 15190
 15191     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15192        PB-C-LF-CANCEL-AMT = ZEROS
 15193          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15194      ELSE
 15195          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15196
 15197     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15198        PB-C-AH-CANCEL-AMT = ZEROS
 15199          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15200      ELSE
 15201          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15202
 15203     EVALUATE TRUE
 15204         WHEN PB-CANCEL-FORCE             OR
 15205              PB-CANCEL-DATE-FORCED       OR
 15206              PB-FORCE-OFF
 15207                  IF PB-COMPANY-ID = 'ACE'
 15208                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15209                  END-IF
 15210         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15211               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15212              (PB-COMPANY-ID = 'ACE' )
 15213                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15214         WHEN OTHER
 15215              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 276
* EL050.cbl
 15216                 MOVE ER-2794              TO WS-ERROR
 15217              ELSE
 15218                 MOVE ER-2749              TO WS-ERROR
 15219              END-IF
 15220              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15221     END-EVALUATE.
 15222
 15223
 15224*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15225*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15226*            MOVE  ER-1909            TO  WS-ERROR
 15227*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15228*        ELSE
 15229*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15230
 15231     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15232     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15233        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15234     ELSE
 15235        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15236     END-IF
 15237     .
 15238 3705-EDIT-CANCEL-DT.
 15239
 15240     IF LF-COVERAGE-CANCELLED
 15241        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15242         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15243         MOVE WS-CURRENT-MONTH-END
 15244                                 TO DC-BIN-DATE-2
 15245         SET ELAPSED-BETWEEN-BIN TO TRUE
 15246*        MOVE 1                  TO DC-OPTION-CODE
 15247         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15248         IF DATE-CONVERSION-ERROR
 15249            NEXT SENTENCE
 15250          ELSE
 15251             IF DC-ELAPSED-DAYS GREATER +180
 15252                IF PB-CANCEL-DATE-FORCED  OR
 15253                   PB-CANCEL-DATE-FORCED-NO-FEE
 15254                      MOVE ER-2751  TO WS-ERROR
 15255                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15256                 ELSE
 15257                   MOVE ER-2752  TO WS-ERROR
 15258                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15259
 15260     IF AH-COVERAGE-CANCELLED
 15261        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15262         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15263         MOVE WS-CURRENT-MONTH-END
 15264                                 TO DC-BIN-DATE-2
 15265         SET ELAPSED-BETWEEN-BIN TO TRUE
 15266*        MOVE 1                  TO DC-OPTION-CODE
 15267         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15268         IF DATE-CONVERSION-ERROR
 15269            NEXT SENTENCE
 15270          ELSE
 15271             IF DC-ELAPSED-DAYS GREATER +180
 15272                IF PB-CANCEL-DATE-FORCED OR
 15273                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 277
* EL050.cbl
 15274                      MOVE ER-2751  TO WS-ERROR
 15275                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15276                 ELSE
 15277                   MOVE ER-2752  TO WS-ERROR
 15278                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15279
 15280     IF WS-ERROR = ER-2752
 15281        AND (PB-COMPANY-ID = 'ABL'
 15282         OR  PB-COMPANY-ID = 'FGL'
 15283         OR  PB-COMPANY-ID = 'IST'
 15284         OR  PB-COMPANY-ID = 'JHL'
 15285         OR  PB-COMPANY-ID = 'LAP'
 15286         OR  PB-COMPANY-ID = 'LBL'
 15287         OR  PB-COMPANY-ID = 'NCB'
 15288         OR  PB-COMPANY-ID = 'NLI'
 15289         OR  PB-COMPANY-ID = 'OFI'
 15290         OR  PB-COMPANY-ID = 'PLI'
 15291         OR  PB-COMPANY-ID = 'TAO'
 15292         OR  PB-COMPANY-ID = 'TIC'
 15293         OR  PB-COMPANY-ID = 'HER'
 15294         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15295         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15296            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15297            MOVE ER-2762     TO WS-ERROR
 15298            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15299
 15300     IF LF-COVERAGE-CANCELLED
 15301        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15302        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15303             MOVE ER-2733         TO WS-ERROR
 15304             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15305
 15306     IF AH-COVERAGE-CANCELLED
 15307        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15308        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15309              MOVE ER-2733        TO WS-ERROR
 15310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15311
 15312     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15313        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15314        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15315           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15316            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15317              IF PB-COMPANY-ID NOT = 'LAP'
 15318               MOVE ER-2704            TO WS-ERROR
 15319               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15320
 15321     IF CERT-WAS-NOT-FOUND
 15322         GO TO 3999-END-EDIT.
 15323
 15324     IF PB-COMPANY-ID EQUAL 'CDC'
 15325        IF LF-COVERAGE-CANCELLED
 15326           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15327            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15328            MOVE PB-C-LF-CANCEL-DT
 15329                                 TO DC-BIN-DATE-2
 15330            SET ELAPSED-BETWEEN-BIN TO TRUE
 15331*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 278
* EL050.cbl
 15332            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15333            IF DATE-CONVERSION-ERROR
 15334               NEXT SENTENCE
 15335             ELSE
 15336                IF DC-ELAPSED-DAYS GREATER +60
 15337                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15338
 15339     IF PB-COMPANY-ID EQUAL 'CDC'
 15340        IF AH-COVERAGE-CANCELLED
 15341           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15342            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15343            MOVE PB-C-AH-CANCEL-DT
 15344                                 TO DC-BIN-DATE-2
 15345            MOVE +0              TO DC-ELAPSED-DAYS
 15346                                    DC-ELAPSED-MONTHS
 15347            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15348*           MOVE 1               TO DC-OPTION-CODE
 15349            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15350            IF DATE-CONVERSION-ERROR
 15351               NEXT SENTENCE
 15352             ELSE
 15353                IF DC-ELAPSED-DAYS GREATER +60
 15354                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15355
 15356     MOVE +0                     TO DC-ELAPSED-DAYS
 15357                                    DC-ELAPSED-MONTHS.
 15358
 15359     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15360        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15361          MOVE 'Z'                TO PB-CI-OB-FLAG
 15362          MOVE ER-2767            TO WS-ERROR
 15363          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15364          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15365          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15366          GO TO 3775-OVER-REF-CHK
 15367        ELSE
 15368          MOVE ZEROS              TO PB-CI-LIVES
 15369                                     PB-C-LIVES
 15370          IF PB-CI-OB-FLAG NOT = 'B'
 15371             MOVE SPACE           TO PB-CI-OB-FLAG.
 15372
 15373     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15374         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15375     ELSE
 15376         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15377
 15378     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15379        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15380            MOVE ER-2760         TO WS-ERROR
 15381            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15382
 15383     IF LF-COVERAGE-CANCELLED
 15384        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15385         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15386            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15387               MOVE ER-2774       TO WS-ERROR
 15388               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15389
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 279
* EL050.cbl
 15390     IF AH-COVERAGE-CANCELLED
 15391        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15392         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15393            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15394               MOVE ER-2775       TO WS-ERROR
 15395               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15396
 15397     IF LF-COVERAGE-CANCELLED
 15398        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15399         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15400            MOVE ER-2776         TO WS-ERROR
 15401            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15402
 15403     IF AH-COVERAGE-CANCELLED
 15404        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15405         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15406            MOVE ER-2777         TO WS-ERROR
 15407            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15408
 15409     IF LF-COVERAGE-CANCELLED
 15410        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15411         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15412         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15413         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15414*        MOVE 6                    TO DC-OPTION-CODE
 15415         SET BIN-PLUS-ELAPSED      TO TRUE
 15416         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15417         IF DATE-CONVERSION-ERROR
 15418            NEXT SENTENCE
 15419          ELSE
 15420            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15421              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15422                             OR  'FIA'
 15423                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15424               ELSE
 15425                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15426                MOVE ER-2731       TO WS-ERROR
 15427                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15428
 15429 3705-EDIT-AH-CANCEL-DT.
 15430
 15431     IF AH-COVERAGE-CANCELLED
 15432        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15433         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15434         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15435         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15436*        MOVE 6                    TO DC-OPTION-CODE
 15437         SET BIN-PLUS-ELAPSED      TO TRUE
 15438         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15439         IF DATE-CONVERSION-ERROR
 15440            NEXT SENTENCE
 15441          ELSE
 15442            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15443              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15444                              OR 'FIA'
 15445                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15446              ELSE
 15447               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 280
* EL050.cbl
 15448               MOVE ER-2771       TO WS-ERROR
 15449               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15450
 15451 3705-EDIT-CONTINUED.
 15452
 15453*    IF LF-COVERAGE-CANCELLED
 15454*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15455*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15456*            MOVE ER-2727         TO WS-ERROR
 15457*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15458*
 15459*    IF AH-COVERAGE-CANCELLED
 15460*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15461*        IF PB-COMPANY-ID = 'ACE'
 15462*           MOVE ER-2727        TO WS-ERROR
 15463*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15464*        ELSE
 15465*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15466*              MOVE ER-2727     TO WS-ERROR
 15467*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15468
 15469     IF PB-COMPANY-ID = 'ACE'
 15470       IF AH-COVERAGE-CANCELLED
 15471         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15472           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15473              MOVE ER-2732      TO WS-ERROR
 15474              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15475
 15476     IF PB-COMPANY-ID      EQUAL   'HER'
 15477        IF WS-ERROR        EQUAL   ER-2727
 15478            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15479            MOVE  ER-2725          TO  WS-ERROR
 15480            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15481
 15482     IF PB-C-CLAIM-CREATED-CANCEL
 15483            MOVE ER-2748         TO WS-ERROR
 15484            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15485
 15486     IF PB-C-LAST-NAME NOT = SPACES
 15487         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15488            MOVE ER-2747         TO WS-ERROR
 15489            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15490
 15491 3710-EDIT-LUMP-SUM-PRIOR.
 15492
 15493     IF AH-COVERAGE-CANCELLED
 15494         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15495             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15496                MOVE ER-2735    TO WS-ERROR
 15497                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15498
 15499     IF LF-COVERAGE-CANCELLED
 15500         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15501             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15502                MOVE ER-2735    TO WS-ERROR
 15503                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15504
 15505 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 281
* EL050.cbl
 15506
 15507*    IF LF-COVERAGE-CANCELLED
 15508*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15509*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15510*           (NOT PB-CI-OB)
 15511*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15512*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15513*                   MOVE ER-2732  TO WS-ERROR
 15514*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15515*
 15516*    IF AH-COVERAGE-CANCELLED
 15517*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15518*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15519*           (NOT PB-CI-OB)
 15520*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15521*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15522*                   MOVE ER-2732  TO WS-ERROR
 15523*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15524
 15525     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15526         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15527            (NOT PB-COMP-LF-CANCEL)
 15528             NEXT SENTENCE
 15529         ELSE
 15530           IF PB-C-LF-CANCEL-VOIDED
 15531              NEXT SENTENCE
 15532           ELSE
 15533              MOVE ER-2753      TO WS-ERROR
 15534              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15535
 15536     IF CANCEL-FUTURE-DT
 15537         GO TO 3999-END-EDIT.
 15538
 15539 3715-GET-REMAIN-TERM-LF.
 15540
 15541     IF NO-LF-BENEFIT-MATCH  OR
 15542        WS-LF-BENEFIT-CD = ZEROS
 15543        GO TO 3730-GET-AH-REMAIN-TERM.
 15544
 15545     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15546     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15547     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15548     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15549     MOVE PB-SV-STATE            TO CP-STATE.
 15550     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15551     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15552     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15553     MOVE '2'                    TO CP-PROCESS-TYPE.
 15554     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15555     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15556     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15557     IF (PB-COMPANY-ID = 'CID')
 15558        AND (CP-STATE-STD-ABBRV = 'WI')
 15559        MOVE '7'                 TO CP-REM-TERM-METHOD
 15560        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15561     ELSE
 15562        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15563        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 282
* EL050.cbl
 15564                                 TO CP-REM-TRM-CALC-OPTION
 15565     END-IF
 15566**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15567     IF (PB-COMPANY-ID = 'CID')
 15568        AND (CP-STATE-STD-ABBRV = 'MO')
 15569        AND (PB-CERT-EFF-DT >= X'9B41')
 15570        AND (PB-CERT-EFF-DT <= X'A2FB')
 15571        MOVE '7'                 TO CP-REM-TERM-METHOD
 15572        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15573     END-IF
 15574     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15575                                    CP-LOAN-TERM.
 15576     IF CP-TRUNCATED-LIFE
 15577        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15578
 15579     IF CP-TERM-IS-DAYS
 15580         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15581     ELSE
 15582         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15583
 15584     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15585
 15586     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15587
 15588     IF LF-COVERAGE-CANCELLED
 15589        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15590        NEXT SENTENCE
 15591      ELSE
 15592          GO TO 3730-GET-AH-REMAIN-TERM.
 15593
 15594 3720-GET-LF-REFUND.
 15595
 15596     IF PB-C-LF-CANCEL-VOIDED OR
 15597        PB-C-AH-CANCEL-VOIDED
 15598        GO TO 3780-UPDATE-CANCEL-CERT.
 15599
 15600     IF PB-COMPANY-ID EQUAL 'BOA'
 15601         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15602         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15603         GO TO 3730-GET-AH-REMAIN-TERM.
 15604
 15605     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15606        (WS-AH-SPECIAL-CALC-CD = 'M')
 15607         MOVE ER-2767            TO WS-ERROR
 15608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15609         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15610         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15611         GO TO 3780-UPDATE-CANCEL-CERT.
 15612
 15613     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15614
 15615     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15616     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15617     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15618     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15619     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15620     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15621     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 283
* EL050.cbl
 15622        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15623        IF PDEF-MASTER-FOUND
 15624           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15625              (V1 > +8)
 15626              OR (PD-PROD-CODE (V1) = 'L')
 15627           END-PERFORM
 15628           IF V1 < +9
 15629              MOVE PD-MAX-AMT (V1)
 15630                           TO CP-R-MAX-TOT-BEN
 15631                              EC-AM-LF-MAX-TOT-BEN
 15632           END-IF
 15633        ELSE
 15634        MOVE ' '                 TO PDEF-MASTER-SW
 15635        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15636        MOVE PB-STATE            TO ERPDEF-STATE
 15637        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15638        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15639        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15640        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15641        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15642        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15643        IF PDEF-MASTER-FOUND
 15644           MOVE 'N'              TO PDEF-MASTER-SW
 15645           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15646           IF PDEF-MASTER-FOUND
 15647              IF (ERPDEF-KEY-SAVE (1:16) =
 15648                           PD-CONTROL-PRIMARY (1:16))
 15649                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15650                 CONTINUE
 15651              ELSE
 15652                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15653                 IF (ERPDEF-KEY-SAVE (1:16) =
 15654                           PD-CONTROL-PRIMARY (1:16))
 15655                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15656                    CONTINUE
 15657                 ELSE
 15658                    MOVE 'N'     TO PDEF-MASTER-SW
 15659                 END-IF
 15660              END-IF
 15661              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15662
 15663              IF PDEF-MASTER-FOUND
 15664                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15665                    (V1 > +8)
 15666                    OR (PD-PROD-CODE (V1) = 'L')
 15667                 END-PERFORM
 15668                 IF V1 < +9
 15669                    MOVE PD-MAX-AMT (V1)
 15670                                 TO CP-R-MAX-TOT-BEN
 15671                                    EC-AM-LF-MAX-TOT-BEN
 15672                 END-IF
 15673              END-IF
 15674           END-IF
 15675           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15676        END-IF
 15677        END-IF
 15678     END-IF
 15679     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 284
* EL050.cbl
 15680
 15681     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15682
 15683     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15684                                    PB-C-LF-REM-TERM.
 15685
 15686     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15687     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15688
 15689     IF PB-COMPANY-ID EQUAL 'FLC'
 15690        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15691           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15692           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15693                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15694                    - CM-LF-ITD-DEATH-AMT
 15695           IF PB-C-LF-REF-CALC LESS THAN +0
 15696              MOVE +0            TO PB-C-LF-REF-CALC
 15697              GO TO 3730-GET-AH-REMAIN-TERM
 15698           ELSE
 15699              GO TO 3730-GET-AH-REMAIN-TERM.
 15700
 15701     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15702                            OR '4' OR '5' OR '6' OR '8'
 15703                            OR '9' OR 'G'
 15704        MOVE PB-C-LF-REFUND-OVERRIDE
 15705                                 TO CP-EARNING-METHOD.
 15706
 15707     if pb-company-id = 'AHL'
 15708        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15709        if cp-class-code = spaces
 15710           move zeros            to cp-class-code
 15711        end-if
 15712     ELSE
 15713        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15714     END-IF
 15715*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15716     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15717     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15718                                    CP-RATING-BENEFIT-AMT.
 15719     IF CP-STATE-STD-ABBRV = 'OR'
 15720         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15721                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15722     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15723     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15724     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15725     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15726     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15727     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15728     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15729     IF WS-DEFAULT-APR NOT NUMERIC
 15730         MOVE ZEROS TO WS-DEFAULT-APR.
 15731****   N O T E   ****
 15732*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15733*      THE OH HARD CODING IN ELCRFNDP
 15734
 15735     IF PB-COMPANY-ID = 'CID'
 15736        IF CP-STATE-STD-ABBRV = 'OH'
 15737           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 285
* EL050.cbl
 15738                                 TO CP-EARNING-METHOD
 15739        END-IF
 15740     END-IF
 15741
 15742****   N O T E   ****
 15743
 15744     IF CP-EARN-AS-NET-PAY
 15745         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15746            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15747                MOVE WS-DEFAULT-APR
 15748                                 TO  CP-LOAN-APR
 15749                MOVE ER-3780     TO  WS-ERROR
 15750                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15751            ELSE
 15752                MOVE ER-3781     TO  WS-ERROR
 15753                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15754     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15755     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15756
 15757     IF CP-REFUND-TYPE-USED NOT = SPACE
 15758         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15759
 15760     IF CP-ERROR-RATE-IS-ZERO OR
 15761        CP-ERROR-RATE-NOT-FOUND
 15762        MOVE ER-2740             TO WS-ERROR
 15763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15764
 15765     IF CP-ERROR-RATE-FILE-NOTOPEN
 15766        MOVE ER-2617             TO WS-ERROR
 15767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15768
 15769     IF PB-COMPANY-ID = 'DCC'
 15770        AND PB-CI-ENTRY-STATUS = 'M'
 15771        MOVE +0                  TO PB-C-LF-REF-CALC
 15772     ELSE
 15773        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15774     END-IF
 15775
 15776     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15777         GO TO 3730-GET-AH-REMAIN-TERM.
 15778
 15779*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15780*       ADD +1                   TO PB-C-LF-REM-TERM
 15781*                                   CP-REMAINING-TERM
 15782*                                   CP-ORIGINAL-TERM.
 15783
 15784     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15785     MOVE '2'                    TO CP-EARNING-METHOD
 15786                                    CP-RATING-METHOD.
 15787     IF PB-COMPANY-ID = 'CID'
 15788        IF (CP-STATE-STD-ABBRV = 'MN')
 15789           AND (PB-CERT-EFF-DT > X'A4FF')
 15790           AND (WS-LF-EARNINGS-CALC = 'B')
 15791           MOVE '5'              TO CP-EARNING-METHOD
 15792           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15793        END-IF
 15794     END-IF
 15795     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 286
* EL050.cbl
 15796                                        CP-REMAINING-BENEFIT
 15797                                        CP-RATING-BENEFIT-AMT.
 15798     IF CP-STATE-STD-ABBRV = 'OR'
 15799         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15800                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15801     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15802     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15803
 15804     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15805
 15806     IF CP-ERROR-RATE-IS-ZERO OR
 15807        CP-ERROR-RATE-NOT-FOUND
 15808        MOVE ER-2740             TO WS-ERROR
 15809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15810
 15811     IF CP-ERROR-RATE-FILE-NOTOPEN
 15812        MOVE ER-2617             TO WS-ERROR
 15813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15814
 15815     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15816
 15817******************************************************************
 15818
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 287
* EL050.cbl
 15820 3730-GET-AH-REMAIN-TERM.
 15821     IF NO-AH-BENEFIT-MATCH  OR
 15822        WS-AH-BENEFIT-CD = ZEROS
 15823         GO TO 3770-CHECK-REFUNDS.
 15824
 15825     IF PB-CI-AH-LUMP-SUM-DISAB
 15826         IF  PB-C-AH-CANCEL-AMT = ZERO
 15827            IF NOT PB-COMP-AH-CANCEL
 15828             GO TO 3770-CHECK-REFUNDS.
 15829
 15830     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15831     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15832     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15833     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15834     MOVE PB-SV-STATE            TO CP-STATE.
 15835     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15836     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15837     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15838     MOVE '2'                    TO CP-PROCESS-TYPE.
 15839     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15840     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15841     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15842     IF (PB-COMPANY-ID = 'CID')
 15843        AND (CP-STATE-STD-ABBRV = 'WI')
 15844        MOVE '7'                 TO CP-REM-TERM-METHOD
 15845        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15846     ELSE
 15847        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15848        MOVE WS-REM-TRM-CALC-OPTION
 15849                                 TO CP-REM-TRM-CALC-OPTION
 15850     END-IF
 15851     IF (PB-COMPANY-ID = 'CID')
 15852        AND (CP-STATE-STD-ABBRV = 'MO')
 15853        AND (PB-CERT-EFF-DT >= X'9B41')
 15854        AND (PB-CERT-EFF-DT <= X'A2FB')
 15855        MOVE '7'                 TO CP-REM-TERM-METHOD
 15856        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15857     END-IF
 15858     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15859                                    CP-LOAN-TERM.
 15860     IF NOT CP-TERM-IS-DAYS
 15861         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15862
 15863     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15864
 15865     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15866
 15867     IF AH-COVERAGE-CANCELLED
 15868        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15869        NEXT SENTENCE
 15870      ELSE
 15871         GO TO 3770-CHECK-REFUNDS.
 15872
 15873 3740-GET-AH-REFUND.
 15874
 15875     IF PB-C-LF-CANCEL-VOIDED OR
 15876        PB-C-AH-CANCEL-VOIDED
 15877        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 288
* EL050.cbl
 15878
 15879     IF PB-COMPANY-ID = 'BOA'
 15880         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15881         GO TO 3770-CHECK-REFUNDS.
 15882
 15883     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15884*    MOVE ' '                    TO DC-OPTION-CODE
 15885     SET BIN-TO-GREG             TO TRUE
 15886     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15887     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15888                                    PB-C-AH-REM-TERM.
 15889     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15890     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15891
 15892     IF PB-COMPANY-ID EQUAL 'FLC'
 15893        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15894           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15895           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15896                    - CM-AH-ITD-AH-PMT)
 15897           IF PB-C-AH-REF-CALC LESS THAN +0
 15898              MOVE +0            TO PB-C-AH-REF-CALC
 15899              GO TO 3770-CHECK-REFUNDS
 15900           ELSE
 15901              GO TO 3770-CHECK-REFUNDS.
 15902
 15903     IF PB-COMPANY-ID = 'DCC'
 15904        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15905            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15906           MOVE 'S'              TO CP-EARNING-METHOD
 15907        END-IF
 15908     END-IF
 15909     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15910                            OR '4' OR '5' OR '6' OR '8'
 15911                            OR '9' OR 'G' OR 'S'
 15912        MOVE PB-C-AH-REFUND-OVERRIDE
 15913                                 TO CP-EARNING-METHOD.
 15914
 15915     if pb-company-id = 'AHL'
 15916        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 15917        if cp-class-code = spaces
 15918           move zeros            to cp-class-code
 15919        end-if
 15920     ELSE
 15921        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15922     END-IF
 15923*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15924     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15925     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15926                                    CP-RATING-BENEFIT-AMT.
 15927     IF CP-STATE-STD-ABBRV = 'OR'
 15928         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15929                                         PB-CI-AH-TERM.
 15930     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15931     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15932     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15933     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15934     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15935     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 289
* EL050.cbl
 15936
 15937     IF CP-STATE-STD-ABBRV = 'OH'
 15938        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15939                                AND 'CID' AND 'DCC' AND 'AHL')
 15940           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15941              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15942              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15943              MOVE '6' TO CP-EARNING-METHOD
 15944           END-IF
 15945        END-IF
 15946        IF PB-COMPANY-ID = 'CID'
 15947           IF NO-LIFE-COVERAGE
 15948              IF CP-CRITICAL-PERIOD
 15949                 MOVE '2'       TO CP-EARNING-METHOD
 15950              ELSE
 15951                 MOVE '6'       TO CP-EARNING-METHOD
 15952              END-IF
 15953           ELSE
 15954              IF WS-LF-COVERAGE-TYPE = 'L'
 15955                 MOVE '2'       TO CP-EARNING-METHOD
 15956              ELSE
 15957                 IF (PB-CI-LF-TERM > +60) OR
 15958                    (WS-LF-EARNINGS-CALC = '5')
 15959                    IF CP-CRITICAL-PERIOD
 15960                       MOVE '2'  TO CP-EARNING-METHOD
 15961                    ELSE
 15962                       MOVE '6'  TO CP-EARNING-METHOD
 15963                    END-IF
 15964                 ELSE
 15965                    MOVE '1'     TO CP-EARNING-METHOD
 15966                 END-IF
 15967              END-IF
 15968           END-IF
 15969        END-IF
 15970     END-IF
 15971
 15972*    IF CP-STATE-STD-ABBRV = 'VA'
 15973*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15974*          IF CP-ORIGINAL-TERM GREATER 61
 15975*             MOVE '6' TO CP-EARNING-METHOD
 15976*          ELSE
 15977*             MOVE '1' TO CP-EARNING-METHOD.
 15978
 15979     IF WS-DEFAULT-APR NOT NUMERIC
 15980         MOVE ZEROS TO WS-DEFAULT-APR.
 15981     IF CP-EARN-AS-NET-PAY
 15982         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15983            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15984                MOVE WS-DEFAULT-APR
 15985                                 TO  CP-LOAN-APR
 15986                MOVE ER-3780     TO  WS-ERROR
 15987                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15988            ELSE
 15989                MOVE ER-3781     TO  WS-ERROR
 15990                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15991     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15992     IF PB-COMPANY-ID = 'DCC'
 15993        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 290
* EL050.cbl
 15994        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15995        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15996     END-IF
 15997     IF PB-COMPANY-ID = 'DCC'
 15998        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15999        AND (CP-EARNING-METHOD = 'D')
 16000        AND (CP-CANCEL-REASON NOT = 'R')
 16001        CONTINUE
 16002     ELSE
 16003        GO TO 3750-CONTINUE
 16004     END-IF
 16005     MOVE ' '                    TO DD-IU-SW
 16006     IF NOT PDEF-MASTER-FOUND
 16007        MOVE ' '                 TO PDEF-MASTER-SW
 16008        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16009        MOVE PB-STATE            TO ERPDEF-STATE
 16010        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16011        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16012        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16013        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16014        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16015        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16016        IF PDEF-MASTER-FOUND
 16017           MOVE 'N'              TO PDEF-MASTER-SW
 16018           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16019           IF PDEF-MASTER-FOUND
 16020              IF (ERPDEF-KEY-SAVE (1:16) =
 16021                           PD-CONTROL-PRIMARY (1:16))
 16022                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16023                 CONTINUE
 16024              ELSE
 16025                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16026                 IF (ERPDEF-KEY-SAVE (1:16) =
 16027                           PD-CONTROL-PRIMARY (1:16))
 16028                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16029                    CONTINUE
 16030                 ELSE
 16031                    MOVE ER-2740 TO WS-ERROR
 16032                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16033                    GO TO 3770-CHECK-REFUNDS
 16034                 END-IF
 16035              END-IF
 16036           END-IF
 16037           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16038        END-IF
 16039     END-IF
 16040     IF PDEF-MASTER-FOUND
 16041        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16042           (V1 > +8)
 16043           OR (PD-PROD-CODE (V1) = 'I')
 16044        END-PERFORM
 16045        IF V1 < +9
 16046           SET DD-IU-PRESENT        TO TRUE
 16047        END-IF
 16048        IF WS-AH-DCC-TRUNC = 'T'
 16049           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16050        ELSE
 16051           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 291
* EL050.cbl
 16052        END-IF
 16053        EVALUATE TRUE
 16054           WHEN WS-TERM > +168
 16055              MOVE 15               TO V1
 16056           WHEN WS-TERM > +156
 16057              MOVE 14               TO V1
 16058           WHEN WS-TERM > +144
 16059              MOVE 13               TO V1
 16060           WHEN WS-TERM > +132
 16061              MOVE 12               TO V1
 16062           WHEN WS-TERM > +120
 16063              MOVE 11               TO V1
 16064           WHEN WS-TERM > +108
 16065              MOVE 10               TO V1
 16066           WHEN WS-TERM > +96
 16067              MOVE 9                TO V1
 16068           WHEN WS-TERM > +84
 16069              MOVE 8                TO V1
 16070           WHEN WS-TERM > +72
 16071              MOVE 7                TO V1
 16072           WHEN WS-TERM > +60
 16073              MOVE 6                TO V1
 16074           WHEN WS-TERM > +48
 16075              MOVE 5                TO V1
 16076           WHEN WS-TERM > +36
 16077              MOVE 4                TO V1
 16078           WHEN WS-TERM > +24
 16079              MOVE 3                TO V1
 16080           WHEN WS-TERM > +12
 16081              MOVE 2                TO V1
 16082           WHEN OTHER
 16083              MOVE 1                TO V1
 16084        END-EVALUATE
 16085
 16086        EVALUATE TRUE
 16087*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16088*             < +13)
 16089*             AND (DD-IU-PRESENT)
 16090*             MOVE 2                TO V2
 16091*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16092*             MOVE 1                TO V2
 16093           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16094              MOVE 2                TO V2
 16095           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16096              MOVE 3                TO V2
 16097           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16098              MOVE 4                TO V2
 16099           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16100              MOVE 5                TO V2
 16101           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16102              MOVE 6                TO V2
 16103           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16104              MOVE 7                TO V2
 16105           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16106              MOVE 8                TO V2
 16107           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16108              MOVE 9                TO V2
 16109           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 292
* EL050.cbl
 16110              MOVE 10               TO V2
 16111           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16112              MOVE 11               TO V2
 16113           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16114              MOVE 12               TO V2
 16115           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16116              MOVE 13               TO V2
 16117           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16118              MOVE 14               TO V2
 16119           WHEN OTHER
 16120              MOVE 15               TO V2
 16121        END-EVALUATE
 16122
 16123        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16124                                 TO CP-DDF-LO-FACT
 16125        MOVE PD-UEP-FACTOR (V1 V2)
 16126                                 TO CP-DDF-HI-FACT
 16127
 16128        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16129        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16130        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16131           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16132        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16133        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16134        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16135           + PD-1ST-YR-ADMIN-ALLOW
 16136
 16137        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16138*       IF PI-CLP-YN = 'Y'
 16139*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16140*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16141*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16142*       END-IF
 16143
 16144        IF DD-IU-PRESENT
 16145           MOVE 'I'              TO CP-EARNING-METHOD
 16146        END-IF
 16147        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16148                                     CP-CLP-RATE-UP
 16149        IF CP-IU-RATE-UP NOT = ZEROS
 16150           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16151              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16152           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16153              / (1 - WS-WORK-FACT)
 16154        END-IF
 16155     END-IF
 16156     .
 16157 3750-CONTINUE.
 16158     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16159
 16160     IF CP-REFUND-TYPE-USED NOT = SPACE
 16161         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16162
 16163     IF CP-ERROR-RATE-IS-ZERO OR
 16164        CP-ERROR-RATE-NOT-FOUND
 16165        MOVE ER-2740             TO WS-ERROR
 16166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16167
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 293
* EL050.cbl
 16168     IF CP-ERROR-RATE-FILE-NOTOPEN
 16169        MOVE ER-2617             TO WS-ERROR
 16170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16171     IF PB-COMPANY-ID = 'DCC'
 16172        AND PB-CI-ENTRY-STATUS = 'M'
 16173        MOVE +0                  TO PB-C-AH-REF-CALC
 16174     ELSE
 16175        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16176     END-IF
 16177     IF PB-COMPANY-ID = 'DCC'
 16178        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16179        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16180        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16181        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16182        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16183        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16184        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16185        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16186        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16187     END-IF
 16188     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 294
* EL050.cbl
 16190
 16191 3770-CHECK-REFUNDS.
 16192
 16193     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16194        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16195           MOVE ER-2766          TO WS-ERROR
 16196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16197           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16198           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16199              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16200
 16201     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16202        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16203           MOVE ER-2766          TO WS-ERROR
 16204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16205           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16206           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16207              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16208
 16209     IF PB-COMP-LF-CANCEL
 16210        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16211        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16212           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16213              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16214
 16215     IF PB-COMP-AH-CANCEL
 16216        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16217        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16218           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16219              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16220
 16221     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16222             GIVING WS-UNSIGN-WRK1
 16223     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16224             GIVING WS-UNSIGN-WRK2.
 16225
 16226     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16227         MOVE ZERO TO WS-UNSIGN-WRK1.
 16228
 16229     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16230         MOVE ZERO TO WS-UNSIGN-WRK2.
 16231
 16232     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16233
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 295
* EL050.cbl
 16235
 16236 3772-CONTINUE.
 16237
 16238**********************************
 16239*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16240*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16241*** DOUBLES THE TOLERANCE AMOUNT.
 16242***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16243**********************************
 16244     IF PB-COMPANY-ID = 'MON'
 16245     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16246         IF WS-REF-REJECT-SW = SPACE
 16247             MOVE ER-2754        TO WS-ERROR
 16248             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16249           ELSE
 16250             MOVE ER-2736        TO WS-ERROR
 16251             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16252**********************************
 16253
 16254 3773-CONTINUE.
 16255
 16256     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16257        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16258           MOVE ER-2723          TO WS-ERROR
 16259           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16260
 16261     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16262        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16263           MOVE ER-2724          TO WS-ERROR
 16264           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16265
 16266     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16267         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16268             (1 + WS-LF-REFUND-OVS-PCT)
 16269     ELSE
 16270         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16271
 16272     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16273         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16274             (1 - WS-TOL-LF-REFUND-PCT)
 16275     ELSE
 16276         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16277
 16278     IF (PB-COMPANY-ID = 'DCC')
 16279        AND (PB-CI-ENTRY-STATUS = 'M')
 16280        AND (PB-C-LF-CANCEL-AMT > +0)
 16281        MOVE ER-3843             TO WS-ERROR
 16282        PERFORM 9900-ERROR-FORMAT
 16283                                 THRU 9900-EXIT
 16284     END-IF
 16285     EVALUATE TRUE
 16286        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16287           CONTINUE
 16288        WHEN PB-C-LF-CANCEL-AMT = +0
 16289                 AND PB-C-LF-REF-CALC > +0
 16290           CONTINUE
 16291        WHEN WS-LF-REFUND-OVS-AMT = 0
 16292                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 296
* EL050.cbl
 16293           CONTINUE
 16294        WHEN OTHER
 16295           IF WS-TOL-LF-REFUND  = +0
 16296              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16297           END-IF
 16298           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16299                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16300                          (PB-C-LF-CANCEL-AMT))
 16301              CONTINUE
 16302           ELSE
 16303              IF WS-LF-REFUND-OVS-AMT = +0
 16304                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16305              END-IF
 16306              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16307                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16308                                       PB-C-LF-CANCEL-AMT)
 16309                 CONTINUE
 16310              ELSE
 16311                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16312                   MOVE ER-2754   TO  WS-ERROR
 16313                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16314                 ELSE
 16315                    MOVE ER-2736   TO  WS-ERROR
 16316                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16317                 END-IF
 16318              END-IF
 16319           END-IF
 16320     END-EVALUATE.
 16321
 16322     EVALUATE TRUE
 16323        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16324           CONTINUE
 16325        WHEN PB-C-LF-CANCEL-AMT = +0
 16326                 AND PB-C-LF-REF-CALC > +0
 16327           CONTINUE
 16328        WHEN OTHER
 16329           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16330               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16331              CONTINUE
 16332           ELSE
 16333              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16334               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16335                CONTINUE
 16336              ELSE
 16337                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16338                     MOVE ER-2754   TO  WS-ERROR
 16339                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16340                 ELSE
 16341                     MOVE ER-2736   TO  WS-ERROR
 16342                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16343                 END-IF
 16344              END-IF
 16345           END-IF
 16346     END-EVALUATE.
 16347
 16348     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16349         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16350             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 297
* EL050.cbl
 16351     ELSE
 16352         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16353
 16354     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16355         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16356             (1 - WS-TOL-AH-REFUND-PCT)
 16357     ELSE
 16358         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16359
 16360     IF (PB-COMPANY-ID = 'DCC')
 16361        AND (PB-CI-ENTRY-STATUS = 'M')
 16362        AND (PB-C-AH-CANCEL-AMT > +0)
 16363        MOVE ER-3843             TO WS-ERROR
 16364        PERFORM 9900-ERROR-FORMAT
 16365                                 THRU 9900-EXIT
 16366     END-IF
 16367     EVALUATE TRUE
 16368        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16369           CONTINUE
 16370*       WHEN PB-C-AH-REF-CALC = +0 AND
 16371*                  PB-C-AH-CANCEL-AMT > +0
 16372        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16373                   PB-C-AH-REF-CALC > +0
 16374           CONTINUE
 16375        WHEN WS-AH-REFUND-OVS-AMT = +0
 16376                AND WS-TOL-AH-REFUND = +0
 16377           CONTINUE
 16378        WHEN OTHER
 16379           IF WS-TOL-AH-REFUND = +0
 16380              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16381           END-IF
 16382           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16383               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16384                                         PB-C-AH-CANCEL-AMT)
 16385              CONTINUE
 16386           ELSE
 16387              IF WS-AH-REFUND-OVS-AMT = +0
 16388                 MOVE +9999999.99 TO
 16389                         WS-AH-REFUND-OVS-AMT
 16390              END-IF
 16391              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16392                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16393                                         PB-C-AH-CANCEL-AMT)
 16394                 CONTINUE
 16395              ELSE
 16396                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16397                    MOVE ER-2754   TO  WS-ERROR
 16398                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16399                 ELSE
 16400                    MOVE ER-2736   TO  WS-ERROR
 16401                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16402                 END-IF
 16403              END-IF
 16404           END-IF
 16405     END-EVALUATE.
 16406
 16407     EVALUATE TRUE
 16408        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 298
* EL050.cbl
 16409           CONTINUE
 16410*       WHEN PB-C-AH-REF-CALC > +0 AND
 16411*                  PB-C-AH-CANCEL-AMT = +0
 16412        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16413                   PB-C-AH-REF-CALC = +0
 16414           CONTINUE
 16415        WHEN OTHER
 16416           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16417               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16418              CONTINUE
 16419           ELSE
 16420              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16421                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16422                 CONTINUE
 16423              ELSE
 16424                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16425                     MOVE ER-2754   TO  WS-ERROR
 16426                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16427                 ELSE
 16428                     MOVE ER-2736   TO  WS-ERROR
 16429                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16430                 END-IF
 16431              END-IF
 16432           END-IF
 16433     END-EVALUATE.
 16434
 16435     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16436        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16437        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16438           AND  PB-C-LF-REF-CALC < +1.00
 16439           AND  PB-C-AH-REF-CALC < +1.00
 16440           CONTINUE
 16441        ELSE
 16442           IF (PB-COMPANY-ID = 'DCC')
 16443              AND (PB-CI-ENTRY-STATUS = 'M')
 16444              CONTINUE
 16445           ELSE
 16446              MOVE ER-2741       TO WS-ERROR
 16447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16448           END-IF
 16449        END-IF
 16450     END-IF
 16451
 16452     IF (PB-C-LF-CANCEL-AMT = ZERO
 16453        AND WS-LF-BENEFIT-CD NOT = ZERO
 16454        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16455        AND PB-C-LF-REF-CALC NOT = ZERO)
 16456        OR
 16457        (PB-C-LF-CANCEL-AMT = ZERO
 16458        AND WS-LF-BENEFIT-CD NOT = ZERO
 16459        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16460             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16461                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16462                NEXT SENTENCE
 16463             ELSE
 16464                MOVE ER-2739        TO WS-ERROR
 16465                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16466
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 299
* EL050.cbl
 16467     IF (PB-C-AH-CANCEL-AMT = ZERO
 16468        AND WS-AH-BENEFIT-CD NOT = ZERO
 16469        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16470        AND PB-C-AH-REF-CALC NOT = ZERO)
 16471        OR
 16472        (PB-C-AH-CANCEL-AMT = ZERO
 16473        AND WS-AH-BENEFIT-CD NOT = ZERO
 16474        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16475             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16476                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16477                NEXT SENTENCE
 16478             ELSE
 16479                MOVE ER-2738        TO WS-ERROR
 16480                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16481
 16482 3775-OVER-REF-CHK.
 16483
 16484     IF PB-CI-ENTRY-STATUS = '5'
 16485        GO TO 3780-UPDATE-CANCEL-CERT.
 16486
 16487     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16488                              PB-CI-LF-ALT-PREMIUM-AMT.
 16489
 16490     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16491        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16492                                 PB-C-LF-REF-CALC
 16493      ELSE
 16494        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16495                                 PB-C-LF-CANCEL-AMT.
 16496
 16497     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16498        MOVE ER-2755             TO WS-ERROR
 16499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16500
 16501     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16502
 16503     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16504        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16505                                 PB-C-AH-REF-CALC
 16506      ELSE
 16507        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16508                                 PB-C-AH-CANCEL-AMT.
 16509
 16510     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16511        MOVE ER-2778             TO WS-ERROR
 16512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF PB-CI-OB-FLAG NOT = 'Z'
 16515        NEXT SENTENCE
 16516       ELSE
 16517         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16518            MOVE ER-2757           TO WS-ERROR
 16519            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16520
 16521 3780-UPDATE-CANCEL-CERT.
 16522
 16523     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16524        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 300
* EL050.cbl
 16525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526
 16527     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16528         MOVE ER-2729              TO WS-ERROR
 16529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16530
 16531     IF PB-CI-LF-BENEFIT-CD = ZERO
 16532         GO TO 3780-UPDATE-CONT-1.
 16533
 16534     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16535         GO TO 3780-UPDATE-CONT-1.
 16536
 16537     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16538       AND
 16539        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16540       AND
 16541        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16542       AND
 16543        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16544            NEXT SENTENCE
 16545       ELSE
 16546        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16547          AND
 16548***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16549***       AND
 16550           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16551            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16552               MOVE ER-2730      TO WS-ERROR
 16553               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16554               GO TO 3999-END-EDIT
 16555            ELSE
 16556               GO TO 3999-END-EDIT
 16557        ELSE
 16558            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16559               MOVE ER-2765           TO WS-ERROR
 16560               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16561               GO TO 3785-CHECK-NH.
 16562*              GO TO 3999-END-EDIT.
 16563
 16564 3780-UPDATE-CONT-1.
 16565     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16566
 16567     IF PB-CI-AH-BENEFIT-CD = ZERO
 16568         GO TO 3780-UPDATE-CONT-2.
 16569
 16570     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16571         GO TO 3780-UPDATE-CONT-2.
 16572
 16573     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16574
 16575     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16576       AND
 16577        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16578       AND
 16579        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16580       AND
 16581        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16582            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 301
* EL050.cbl
 16583       ELSE
 16584        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16585          AND
 16586***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16587***       AND
 16588           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16589           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16590            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16591               MOVE ER-2773      TO WS-ERROR
 16592               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16593               GO TO 3999-END-EDIT
 16594            ELSE
 16595               GO TO 3999-END-EDIT
 16596            END-IF
 16597           ELSE
 16598             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16599                MOVE ER-2890 TO WS-ERROR
 16600                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16601                GO TO 3999-END-EDIT
 16602             ELSE
 16603                GO TO 3785-CHECK-NH
 16604             END-IF
 16605           END-IF
 16606          ELSE
 16607            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16608              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16609                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16610                   MOVE ER-2890 TO WS-ERROR
 16611                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16612                   GO TO 3999-END-EDIT
 16613                ELSE
 16614                   MOVE ER-2765 TO WS-ERROR
 16615                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16616                   GO TO 3785-CHECK-NH
 16617                END-IF
 16618              ELSE
 16619               MOVE ER-2765      TO WS-ERROR
 16620               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16621               GO TO 3785-CHECK-NH.
 16622*              GO TO 3999-END-EDIT.
 16623
 16624 3780-UPDATE-CONT-2.
 16625
 16626     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16627        AND WS-LF-BENEFIT-CD = ZERO
 16628           MOVE ER-2743           TO WS-ERROR
 16629           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16630
 16631     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16632        AND WS-AH-BENEFIT-CD = ZERO
 16633           MOVE ER-2744           TO WS-ERROR
 16634           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16635
 16636     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16637        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16638        AND
 16639        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16640         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 302
* EL050.cbl
 16641           MOVE ER-2746           TO WS-ERROR
 16642           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16643
 16644     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16645       AND
 16646        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16647             MOVE ER-2737        TO WS-ERROR
 16648             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16649
 16650     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16651       AND
 16652        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16653             MOVE ER-2737        TO WS-ERROR
 16654             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16655
 16656     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16657         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16658             OR 'CID' OR 'DCC' OR 'AHL'
 16659             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16660         ELSE
 16661             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16662                 MOVE ER-2768    TO WS-ERROR
 16663                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16664             ELSE
 16665                 MOVE ER-2756    TO WS-ERROR
 16666                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16667
 16668     IF CERT-PEND-ISSUE-RETURNED
 16669        MOVE ER-2772             TO WS-ERROR
 16670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16671 3785-CHECK-NH.
 16672     IF PB-STATE NOT = 'NH'
 16673        GO TO 3999-END-EDIT
 16674     END-IF
 16675
 16676     MOVE ER-2796                TO WS-ERROR
 16677     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16678     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16679        OR (CM-NH-INTERFACE-SW = 'Y')
 16680        MOVE ER-2793             TO WS-ERROR
 16681        PERFORM 9900-ERROR-FORMAT
 16682                                 THRU 9900-EXIT
 16683     END-IF
 16684     MOVE +0                     TO WS-PAYMENT-AMT
 16685     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16686        GO TO 3999-END-EDIT
 16687     END-IF
 16688     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16689        GO TO 3999-END-EDIT
 16690     END-IF
 16691     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16692     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16693     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16694        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16695     END-IF
 16696     MOVE '1'                    TO DC-OPTION-CODE
 16697     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16698     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 303
* EL050.cbl
 16699        IF DC-ELAPSED-DAYS < +16
 16700           GO TO 3999-END-EDIT
 16701        END-IF
 16702     END-IF
 16703     MOVE +0                     TO DC-ELAPSED-DAYS
 16704     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16705     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16706     MOVE '1'                    TO DC-OPTION-CODE
 16707     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16708     IF NO-CONVERSION-ERROR
 16709        IF DC-ELAPSED-DAYS > +30
 16710           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16711        ELSE
 16712           GO TO 3999-END-EDIT
 16713        END-IF
 16714     ELSE
 16715        GO TO 3999-END-EDIT
 16716     END-IF
 16717     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16718        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16719           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16720     IF WS-PAYMENT-AMT < 600.00
 16721        GO TO 3999-END-EDIT
 16722     END-IF
 16723     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16724
 16725     IF (ERMAIL-FOUND = ' ')
 16726         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16727         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16728        GO TO 3999-END-EDIT
 16729     END-IF
 16730     MOVE ER-2795                TO WS-ERROR
 16731     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16732
 16733     GO TO 3999-END-EDIT.
 16734******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 304
* EL050.cbl
 16736 3990-FILES-NOT-OPEN.
 16737
 16738     MOVE ER-2617                TO WS-ERROR.
 16739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16740     GO TO 9990-RETURN.
 16741
 16742 3999-END-EDIT.
 16743
 16744     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16745
 16746     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16747         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16748         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16749             PERFORM 9250-UNLOCK-RETURN
 16750             GO TO 9990-RETURN
 16751          ELSE
 16752             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16753             GO TO 9990-RETURN.
 16754
 16755     IF PB-CANCELLATION
 16756          GO TO 9990-RETURN.
 16757
 16758     IF CERT-WAS-NOT-FOUND
 16759        MOVE SPACES              TO CERTIFICATE-MASTER.
 16760
 16761     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16762
 16763     IF CERT-WAS-FOUND
 16764         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16765             PERFORM 9250-UNLOCK-RETURN
 16766          ELSE
 16767            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16768      ELSE
 16769         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16770
 16771     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16772        IF PB-COMPANY-ID = 'DCC' AND
 16773           (PB-CARRIER = '2' OR '4' OR '6')
 16774              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16775        END-IF
 16776     END-IF.
 16777
 16778     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16779     IF ((PB-COMPANY-ID = 'DCC')
 16780        AND (WS-NO-SECURE-PAY))
 16781                  OR
 16782        (WS-LF-SPECIAL-CALC-CD = 'O'
 16783        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16784        SET SKIP-ADDR-EDIT       TO TRUE
 16785     END-IF
 16786     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16787        AND (NOT SKIP-ADDR-EDIT)
 16788        MOVE ER-2963             TO WS-ERROR
 16789        PERFORM 9900-ERROR-FORMAT
 16790                                 THRU 9900-EXIT
 16791        GO TO 9990-RETURN
 16792     END-IF
 16793     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 305
* EL050.cbl
 16794     IF ERPNDM-FOUND NOT = 'X'
 16795        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16796           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16797           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16798           AND (NOT SKIP-ADDR-EDIT)
 16799           MOVE ER-2694          TO WS-ERROR
 16800           PERFORM 9900-ERROR-FORMAT
 16801                                 THRU 9900-EXIT
 16802        END-IF
 16803        MOVE ' '                 TO STATE-RECORD-ERROR
 16804        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16805        MOVE PM-STATE            TO CNTL-ACCESS
 16806        MOVE '3'                 TO CNTL-REC-TYPE
 16807        MOVE +0                  TO CNTL-SEQ-NO
 16808        MOVE '0'                 TO RC-SW-2
 16809        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16810        IF (NO-STATE-RECORD)
 16811           OR (CF-RECORD-TYPE NOT = '3')
 16812           OR (PM-STATE NOT = CF-STATE-CODE)
 16813           IF (PM-STATE = SPACES)
 16814              AND (SKIP-ADDR-EDIT)
 16815              CONTINUE
 16816           ELSE
 16817              MOVE ER-2963       TO WS-ERROR
 16818              PERFORM 9900-ERROR-FORMAT
 16819                                 THRU 9900-EXIT
 16820           END-IF
 16821        END-IF
 16822        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16823           MOVE ER-2883          TO WS-ERROR
 16824           PERFORM 9900-ERROR-FORMAT
 16825                                 THRU 9900-EXIT
 16826        END-IF
 16827        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16828           MOVE ' '                 TO STATE-RECORD-ERROR
 16829           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16830           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16831           MOVE '3'                 TO CNTL-REC-TYPE
 16832           MOVE +0                  TO CNTL-SEQ-NO
 16833           MOVE '0'                 TO RC-SW-2
 16834           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16835           IF NO-STATE-RECORD
 16836              OR (CF-RECORD-TYPE NOT = '3')
 16837              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16838              MOVE ER-2964          TO WS-ERROR
 16839              PERFORM 9900-ERROR-FORMAT
 16840                                    THRU 9900-EXIT
 16841           END-IF
 16842        END-IF
 16843     ELSE
 16844        IF NOT SKIP-ADDR-EDIT
 16845           MOVE ER-2393          TO WS-ERROR
 16846           PERFORM 9900-ERROR-FORMAT
 16847                                 THRU 9900-EXIT
 16848        END-IF
 16849     END-IF
 16850
 16851     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 306
* EL050.cbl
 16852
 16853     IF (ERMAIL-FOUND = ' ' AND
 16854        ERPNDM-FOUND = ' ')
 16855        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16856           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16857           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16858          OR
 16859           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16860          OR
 16861           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16862           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16863           GO TO 3999-UNLOCK-ERMAIL.
 16864
 16865     IF ERPNDM-FOUND = 'X'
 16866        GO TO 3999-UNLOCK-ERMAIL.
 16867
 16868     IF PM-INSURED-LAST-NAME      = SPACES
 16869        AND PM-INSURED-FIRST-NAME = SPACES
 16870        AND PM-ADDRESS-LINE-1     = SPACES
 16871        AND PM-ADDRESS-LINE-2     = SPACES
 16872        AND PM-CITY-STATE         = SPACES
 16873        AND PM-CRED-BENE-NAME     = SPACES
 16874        AND PM-CRED-BENE-ADDR     = SPACES
 16875        AND PM-CRED-BENE-CTYST    = SPACES
 16876        GO TO 3999-UNLOCK-ERMAIL
 16877     END-IF
 16878
 16879     MOVE SPACES                 TO MAILING-DATA.
 16880
 16881     MOVE 'MA'                   TO MA-RECORD-ID.
 16882     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16883     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16884     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16885     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16886     MOVE PB-SV-STATE            TO MA-STATE.
 16887     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16888     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16889
 16890     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16891     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16892
 16893     IF ERMAIL-FOUND = ' '
 16894        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16895     ELSE
 16896        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16897        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16898        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16899
 16900     GO TO 9990-RETURN.
 16901
 16902 3999-UNLOCK-ERMAIL.
 16903     IF ERMAIL-FOUND = ' '
 16904        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16905
 16906     GO TO 9990-RETURN.
 16907******************************************************************
 16908
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 307
* EL050.cbl
 16910 4000-UPDATE-CANCELLED-CERT.
 16911     IF CERT-WAS-NOT-FOUND
 16912        GO TO 4299-EXIT.
 16913
 16914*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16915     IF PB-C-NH-INT-ON-REFS > ZEROS
 16916        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16917     END-IF
 16918     IF PB-C-REF-INTERFACE-SW = 'Y'
 16919        MOVE PB-C-REF-INTERFACE-SW
 16920                                 TO CM-NH-INTERFACE-SW
 16921     END-IF
 16922     IF PB-C-POST-CARD-IND = 'Y'
 16923        MOVE +8                  TO SUB
 16924        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16925        IF ERMAIL-FOUND = ' '
 16926           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16927              (SUB > +7)
 16928              OR (MA-MAIL-STATUS (SUB) = '1')
 16929           END-PERFORM
 16930        END-IF
 16931        IF (SUB > +7)
 16932           OR (ERMAIL-FOUND = 'X')
 16933           MOVE ER-3789          TO WS-ERROR
 16934           PERFORM 9900-ERROR-FORMAT
 16935                                 THRU 9900-EXIT
 16936        END-IF
 16937     ELSE
 16938        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16939     END-IF
 16940     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16941
 16942     IF PB-CI-OB-FLAG = 'Z'
 16943        GO TO 4150-SUMMARY-CERT-CANCEL.
 16944
 16945     IF PB-C-LF-CANCEL-VOIDED
 16946         PERFORM 4200-REVERSE-LF-CANCEL.
 16947     IF PB-C-AH-CANCEL-VOIDED
 16948         PERFORM 4200-REVERSE-AH-CANCEL.
 16949
 16950 4100-APPLY-LF-CANCEL.
 16951
 16952     MOVE +0                     TO WS-SUB.
 16953
 16954 4100-CHECK-LF-ERRORS.
 16955
 16956     ADD +1                       TO WS-SUB.
 16957
 16958     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16959        IF LF-COVERAGE-CANCELLED
 16960           GO TO 4100-LF-CANCEL-CONT
 16961        ELSE
 16962           GO TO 4100-UPDATE-LF-COVERAGE.
 16963
 16964     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16965                                   ER-2729 OR
 16966                                   ER-2730 OR
 16967                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 308
* EL050.cbl
 16968                                   ER-2732 OR
 16969                                   ER-2737 OR
 16970                                   ER-2740 OR
 16971                                   ER-2743 OR
 16972                                   ER-2749 OR
 16973                                   ER-2750 OR
 16974                                   ER-2755 OR
 16975                                   ER-2757 OR
 16976                                   ER-2760 OR
 16977                                   ER-2772 OR
 16978                                   ER-2774 OR
 16979                                   ER-2776 OR
 16980                                   ER-2794
 16981        GO TO 4100-UPDATE-LF-COVERAGE.
 16982
 16983     GO TO 4100-CHECK-LF-ERRORS.
 16984
 16985 4100-UPDATE-LF-COVERAGE.
 16986
 16987     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16988     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16989     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16990        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16991     END-IF
 16992     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16993                                      TO CM-CREDIT-INTERFACE-SW-2.
 16994     IF CM-LF-CANCEL-DT = LOW-VALUE
 16995         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16996
 16997     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16998         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16999                                         CM-LF-STATUS-AT-CANCEL.
 17000
 17001     GO TO 4100-APPLY-AH-CANCEL.
 17002
 17003 4100-LF-CANCEL-CONT.
 17004     IF PB-C-LF-CANCEL-VOIDED
 17005         GO TO 4100-APPLY-AH-CANCEL.
 17006
 17007     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17008         GO TO 4100-APPLY-AH-CANCEL.
 17009
 17010     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17011        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17012           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17013        ELSE
 17014           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17015
 17016     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17017     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17018
 17019     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17020         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17021
 17022     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17023        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17024         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17025         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 309
* EL050.cbl
 17026
 17027     IF PB-RECORD-RETURNED
 17028        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17029      ELSE
 17030        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17031
 17032 4100-APPLY-AH-CANCEL.
 17033
 17034     MOVE +0                      TO WS-SUB.
 17035
 17036 4100-CHECK-AH-ERRORS.
 17037
 17038     ADD +1                       TO WS-SUB.
 17039
 17040     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17041        IF AH-COVERAGE-CANCELLED
 17042           GO TO 4100-AH-CANCEL-CONT
 17043        ELSE
 17044           GO TO 4100-UPDATE-AH-COVERAGE.
 17045
 17046     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17047                                   ER-2729 OR
 17048                                   ER-2732 OR
 17049                                   ER-2737 OR
 17050                                   ER-2740 OR
 17051                                   ER-2744 OR
 17052                                   ER-2749 OR
 17053                                   ER-2750 OR
 17054                                   ER-2755 OR
 17055                                   ER-2757 OR
 17056                                   ER-2760 OR
 17057                                   ER-2771 OR
 17058                                   ER-2772 OR
 17059                                   ER-2773 OR
 17060                                   ER-2775 OR
 17061                                   ER-2777 OR
 17062                                   ER-2794
 17063        GO TO 4100-UPDATE-AH-COVERAGE.
 17064
 17065     GO TO 4100-CHECK-AH-ERRORS.
 17066
 17067 4100-UPDATE-AH-COVERAGE.
 17068
 17069     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17070     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17071     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17072     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17073                                      TO CM-CREDIT-INTERFACE-SW-2.
 17074     IF CM-AH-CANCEL-DT = LOW-VALUE
 17075         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17076
 17077     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17078         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17079                                         CM-AH-STATUS-AT-CANCEL.
 17080
 17081     IF LF-COVERAGE-CANCELLED
 17082         IF PB-RECORD-RETURNED
 17083              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 310
* EL050.cbl
 17084          ELSE
 17085              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17086
 17087     GO TO 4299-EXIT.
 17088
 17089 4100-AH-CANCEL-CONT.
 17090     IF PB-C-AH-CANCEL-VOIDED
 17091         GO TO 4299-EXIT.
 17092
 17093     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17094         GO TO 4299-EXIT.
 17095
 17096     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17097        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17098           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17099        ELSE
 17100           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17101
 17102     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17103     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17104
 17105     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17106         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17107
 17108     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17109         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17110         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17111
 17112     IF PB-RECORD-RETURNED
 17113        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17114      ELSE
 17115        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17116
 17117     GO TO 4299-EXIT.
 17118
 17119 4150-SUMMARY-CERT-CANCEL.
 17120     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17121
 17122     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17123        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17124                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17125     ELSE
 17126        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17127                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17128
 17129     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17130        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17131                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17132     ELSE
 17133        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17134                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17135
 17136     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17137        NEXT SENTENCE
 17138     ELSE
 17139        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17140
 17141     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 311
* EL050.cbl
 17142
 17143 4200-REVERSE-LF-CANCEL.
 17144     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17145
 17146     IF CM-LF-CANCEL-APPLIED
 17147        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17148        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17149        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17150
 17151     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17152
 17153     IF PB-RECORD-RETURNED
 17154        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17155       ELSE
 17156        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17157
 17158 4200-REVERSE-LF-EXIT.
 17159       EXIT.
 17160
 17161 4200-REVERSE-AH-CANCEL.
 17162     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17163
 17164     IF CM-AH-CANCEL-APPLIED
 17165        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17166        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17167        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17168
 17169     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17170
 17171     IF PB-RECORD-RETURNED
 17172        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17173       ELSE
 17174        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17175
 17176 4200-REVERSE-AH-EXIT.
 17177       EXIT.
 17178
 17179 4299-EXIT.
 17180       EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 312
* EL050.cbl
 17182
 17183 4500-UPDATE-NEW-CERT.
 17184     IF CERT-WAS-FOUND
 17185         NEXT SENTENCE
 17186       ELSE
 17187         GO TO 4520-BUILD-NEW-KEY.
 17188
 17189     IF  CLASIC-CREATED-CERT
 17190         GO TO 4999-EXIT.
 17191
 17192     IF  CERT-WAS-CREATED-FOR-CLAIM
 17193         GO TO 4520-BUILD-NEW-KEY.
 17194
 17195     IF CERT-ADDED-BATCH
 17196        IF CM-RECORD-ID = 'CM'
 17197            GO TO 4999-EXIT.
 17198
 17199 4520-BUILD-NEW-KEY.
 17200* BUILD CONTROL PRIMARY
 17201
 17202     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17203                                       CM-COMPANY-CD-A1
 17204                                       CM-COMPANY-CD-A2
 17205                                       CM-COMPANY-CD-A4
 17206                                       CM-COMPANY-CD-A5.
 17207
 17208     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17209     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17210     MOVE PB-SV-STATE               TO CM-STATE.
 17211     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17212     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17213     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17214     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17215
 17216     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17217
 17218     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17219     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17220     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17221     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17222
 17223     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17224        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17225
 17226     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17227         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17228         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17229         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17230         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17231     ELSE
 17232         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17233
 17234     IF PB-COMPANY-ID   EQUAL  'CRI'
 17235         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17236         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17237         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17238         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17239         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 313
* EL050.cbl
 17240
 17241     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17242        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17243         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17244
 17245     IF PB-COMPANY-ID  = 'LBL'
 17246        IF PB-I-JOINT-COVERAGE
 17247            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17248                                           PB-I-MEMBER-NO
 17249            GO TO 4550-CONT-CERT-PROCESS.
 17250
 17251     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17252        NEXT SENTENCE
 17253     ELSE
 17254        GO TO 4540-BUILD-MEMBER-NO.
 17255
 17256******************************************************************
 17257*                                                                *
 17258*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17259*    FOR 'MON'.                                                  *
 17260*                                                                *
 17261******************************************************************
 17262
 17263     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17264     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17265     MOVE +1                     TO WS-SUB1
 17266                                    WS-SUB2.
 17267
 17268 4530-EDIT-MEMB-NAME.
 17269
 17270     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17271        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17272        ADD +1                       TO WS-SUB2.
 17273
 17274     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17275        ADD +1                       TO WS-SUB1
 17276        GO TO 4530-EDIT-MEMB-NAME.
 17277
 17278     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17279     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17280     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17281*    MOVE SPACE                      TO DC-OPTION-CODE.
 17282     SET  BIN-TO-GREG                TO TRUE.
 17283     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17284     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17285
 17286     GO TO 4550-CONT-CERT-PROCESS.
 17287
 17288******************************************************************
 17289*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17290******************************************************************
 17291
 17292 4540-BUILD-MEMBER-NO.
 17293
 17294     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17295         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17296         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17297         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 314
* EL050.cbl
 17298         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17299     ELSE
 17300         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17301
 17302     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17303        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17304         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17305
 17306 4550-CONT-CERT-PROCESS.
 17307
 17308*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17309*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17310*    ELSE
 17311*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17312
 17313     IF CERT-WAS-CREATED-FOR-CLAIM
 17314        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17315        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17316
 17317     IF CERT-AND-CLAIM-ONLINE
 17318        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17319        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17320
 17321     MOVE 'CM'                     TO CM-RECORD-ID.
 17322     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17323
 17324     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17325        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17326        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17327     ELSE
 17328        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17329        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17330
 17331     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17332     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17333     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17334     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17335     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17336     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17337     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17338                                      CM-LF-ITD-CANCEL-AMT
 17339                                      CM-LF-ITD-DEATH-AMT
 17340                                      CM-AH-ITD-AH-PMT
 17341                                      CM-AH-ITD-LUMP-PMT
 17342                                      CM-AH-ITD-CANCEL-AMT
 17343                                      CM-LF-NSP-PREMIUM-AMT
 17344                                      CM-AH-NSP-PREMIUM-AMT.
 17345*                                     CM-CLAIM-DEDUCT-WITHHELD
 17346*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17347     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17348     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17349     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17350     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17351     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17352     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17353     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17354     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17355     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 315
* EL050.cbl
 17356     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17357     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17358     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17359
 17360     IF PB-I-LIVES NOT NUMERIC
 17361         MOVE ZERO                 TO PB-I-LIVES.
 17362
 17363     IF PB-I-NUM-BILLED NOT NUMERIC
 17364         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17365
 17366     MOVE PB-I-LIVES               TO CM-LIVES.
 17367     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17368
 17369     IF PB-COMPANY-ID EQUAL  'DMD'
 17370         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17371         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17372
 17373     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17374     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17375     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17376     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17377     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17378     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17379
 17380     IF PB-I-LF-POLICY-FEE NUMERIC
 17381        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17382     ELSE
 17383        MOVE +0                    TO CM-LF-POLICY-FEE.
 17384
 17385     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17386        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17387        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17388     ELSE
 17389        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17390
 17391     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17392     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17393     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17394     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17395     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17396     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17397     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17398     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17399     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17400
 17401     IF PB-I-AH-POLICY-FEE NUMERIC
 17402        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17403     ELSE
 17404        MOVE +0                    TO CM-AH-POLICY-FEE.
 17405
 17406     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17407        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17408     ELSE
 17409        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17410
 17411     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17412     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17413
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 316
* EL050.cbl
 17414     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17415                                      CM-LF-DEATH-EXIT-DT
 17416                                      CM-AH-SETTLEMENT-EXIT-DT.
 17417
 17418*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17419*                       'TIH' OR 'OFL' OR 'FLA' OR
 17420*                       'TII' OR 'TMS' OR 'CRI' OR
 17421*                       'NCL'
 17422     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17423
 17424     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17425         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17426            MOVE '2'                TO CM-PREMIUM-TYPE.
 17427
 17428     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17429         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17430            MOVE '2'                TO CM-PREMIUM-TYPE.
 17431
 17432     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17433         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17434     ELSE
 17435         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17436         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17437
 17438     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17439     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17440     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17441     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17442     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17443     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17444     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17445     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17446
 17447     IF PB-NO-MONTHS-SKIPPED
 17448         MOVE SPACE                 TO CM-SKIP-CODE
 17449     ELSE
 17450         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17451
 17452     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17453     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17454                                       CM-LF-STATUS-AT-CANCEL.
 17455
 17456     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17457     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17458                                       CM-AH-STATUS-AT-CANCEL.
 17459
 17460     MOVE '1'                       TO CM-ENTRY-STATUS.
 17461
 17462     IF PB-REISSUED-CERT
 17463        MOVE '5'                    TO CM-ENTRY-STATUS.
 17464
 17465     IF PB-MONTHLY-CERT
 17466        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17467
 17468     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17469     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17470     IF PB-POLICY-IS-DECLINED
 17471        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 317
* EL050.cbl
 17472
 17473     IF PB-POLICY-IS-VOIDED
 17474        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17475
 17476     IF PB-NEEDS-UNDERWRITING
 17477        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17478
 17479     IF PB-REIN-ONLY-CERT
 17480        MOVE '9'                    TO CM-ENTRY-STATUS.
 17481
 17482     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17483         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17484     ELSE
 17485         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17486
 17487     IF PB-RECORD-RETURNED
 17488        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17489      ELSE
 17490        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17491
 17492     IF PB-I-MAIL-ADDRS-PRESENT
 17493        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17494
 17495     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17496                                       CM-ENTRY-DT.
 17497
 17498 4999-EXIT.
 17499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 318
* EL050.cbl
 17501
 17502 5000-PROCESS-REPS.
 17503     MOVE ' '                    TO AGTC-MASTER-SW
 17504     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17505     MOVE CO-TYPE                TO AGTC-TYPE
 17506     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17507     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17508     IF (AGTC-MASTER-SW NOT = 'N')
 17509        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17510        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17511        PERFORM 8583-READ-ERAGTC-NEXT
 17512                                 THRU 8583-EXIT
 17513     END-IF
 17514     IF AGTC-MASTER-SW = 'N'
 17515        CONTINUE
 17516     ELSE
 17517        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17518           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17519              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17520              MOVE 'Y'           TO AGTC-MASTER-SW
 17521           END-IF
 17522        END-IF
 17523     END-IF
 17524     .
 17525 5000-EXIT.
 17526     EXIT.
 17527 6370-EDIT-INPUT-LF-CODE.
 17528     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17529        MOVE +1                  TO SUB
 17530        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17531        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17532        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17533        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17534        GO TO 6370-SEARCH-LOOP.
 17535
 17536     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17537
 17538     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17539     MOVE SPACES                 TO CNTL-ACCESS.
 17540*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17541     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17542     MOVE +0                     TO CNTL-SEQ-NO.
 17543     MOVE '4' TO RC-SW-2.
 17544     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17545
 17546     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17547        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17548        GO TO 6370-NO-LF-FOUND.
 17549
 17550     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17551     MOVE +1                     TO SUB.
 17552
 17553 6370-SEARCH-LOOP.
 17554     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17555         GO TO 6370-NO-LF-FOUND.
 17556
 17557     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17558         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 319
* EL050.cbl
 17559         GO TO 6370-HER-NET-PAY-CHECK.
 17560
 17561     ADD 1   TO SUB.
 17562*    IF SUB GREATER 120
 17563     IF SUB GREATER 200
 17564         GO TO 6370-NO-LF-FOUND.
 17565
 17566     GO TO 6370-SEARCH-LOOP.
 17567
 17568 6370-NO-LF-FOUND.
 17569
 17570     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17571
 17572 6370-HER-NET-PAY-CHECK.
 17573
 17574     IF PB-COMPANY-ID = 'CID'
 17575        IF PB-SV-STATE = 'CA' OR 'MN'
 17576           IF PB-I-LF-BENEFIT-CD = '02'
 17577              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17578           ELSE
 17579              IF PB-I-LF-BENEFIT-CD = '04'
 17580                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17581              END-IF
 17582           END-IF
 17583        END-IF
 17584     END-IF
 17585
 17586     IF PB-COMPANY-ID NOT = 'HER'
 17587         GO TO 6370-EXIT.
 17588
 17589     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17590         GO TO 6370-EXIT.
 17591
 17592     IF PB-I-LF-TERM NOT NUMERIC
 17593         MOVE ZEROS              TO PB-I-LF-TERM.
 17594
 17595     IF PB-I-LOAN-TERM NOT NUMERIC
 17596         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17597
 17598     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17599         GO TO 6370-EXIT.
 17600
 17601     IF PB-I-LF-BENEFIT-CD = '33'
 17602         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17603
 17604     IF PB-I-LF-BENEFIT-CD = '34'
 17605         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17606
 17607 6370-EXIT.
 17608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 320
* EL050.cbl
 17610
 17611 6380-EDIT-INPUT-AH-CODE.
 17612     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17613        MOVE +1                  TO SUB
 17614        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17615        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17616        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17617        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17618        GO TO 6380-SEARCH-LOOP.
 17619
 17620     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17621
 17622     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17623     MOVE SPACES                 TO CNTL-ACCESS.
 17624     MOVE 'A'                    TO CNTL-REC-TYPE.
 17625*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17626     MOVE +0                     TO CNTL-SEQ-NO.
 17627     MOVE '5' TO RC-SW-2.
 17628     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17629
 17630     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17631        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17632        GO TO 6380-NO-AH-FOUND.
 17633
 17634     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17635     MOVE +1 TO SUB.
 17636
 17637 6380-SEARCH-LOOP.
 17638     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17639         GO TO 6380-NO-AH-FOUND.
 17640
 17641     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17642         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17643         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17644
 17645     ADD 1   TO SUB.
 17646     IF SUB GREATER THAN 96
 17647*    IF SUB GREATER THAN 300
 17648         GO TO 6380-NO-AH-FOUND.
 17649
 17650     GO TO 6380-SEARCH-LOOP.
 17651
 17652 6380-NO-AH-FOUND.
 17653
 17654     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17655
 17656     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17657         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17658     ELSE
 17659         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17660
 17661 6380-CSO-AH-ONLY-CHECKS.
 17662
 17663     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17664        NEXT SENTENCE
 17665      ELSE
 17666        GO TO 6380-EXIT.
 17667
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 321
* EL050.cbl
 17668     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17669         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17670
 17671
 17672     GO TO 6380-EXIT
 17673     .
 17674 6380-CSO-LIFE-WITH-AH-CHECKS.
 17675
 17676
 17677     .
 17678 6380-EXIT.
 17679     EXIT.
 17680
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 322
* EL050.cbl
 17682
 17683 6400-COMPUTE-EXTENSION-DAYS.
 17684
 17685******************************************************************
 17686*                                                                *
 17687*                   COMPUTE EXTENSION DAYS                       *
 17688*                                                                *
 17689*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17690*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17691*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17692*    THE EXTENSION DAYS.                                         *
 17693*                                                                *
 17694******************************************************************
 17695
 17696     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17697     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17698
 17699******************************************************************
 17700*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17701*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17702******************************************************************
 17703
 17704     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17705        COMPUTE WS-ODD-DAYS-OVER =
 17706               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17707     ELSE
 17708        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17709
 17710     IF WS-ODD-DAYS-OVER = ZEROS
 17711           GO TO 6499-EXIT
 17712     ELSE
 17713        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17714           IF WS-WDF-MONTH = 02
 17715              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17716              ADD 2       TO  WS-ODD-DAYS-OVER
 17717              GO TO 6499-EXIT
 17718           ELSE
 17719              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17720                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17721                 GO TO 6499-EXIT
 17722               ELSE
 17723                 GO TO 6499-EXIT
 17724        ELSE
 17725           GO TO 6499-EXIT.
 17726
 17727 6412-CHECK-TO-DAY.
 17728
 17729        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17730           IF WS-WDT-DAY = 28
 17731              ADD 2              TO WS-ODD-DAYS-OVER
 17732           ELSE
 17733              IF WS-WDT-DAY = 29
 17734                 ADD 1           TO WS-ODD-DAYS-OVER
 17735              ELSE
 17736                 NEXT SENTENCE
 17737        ELSE
 17738           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17739              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 323
* EL050.cbl
 17740
 17741     GO TO 6499-EXIT.
 17742
 17743
 17744 6415-CHECK-LEAP-YEAR.
 17745
 17746     IF DC-DAYS-IN-MONTH = 29
 17747        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17748
 17749 6415-EXIT.
 17750     EXIT.
 17751
 17752 6499-EXIT.
 17753      EXIT.
 17754
 17755 6500-END.
 17756     EXIT.
 17757
 17758
 17759******************************************************************
 17760************* PROCEDURE DIVISION FOR EL050 ***********************
 17761********************** ELC50PD END *******************************
 17762
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 324
* EL050.cbl
 17764
 17765**START***********************************************************
 17766*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17767*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17768******************************************************************
 17769*
 17770 6600-GET-STATE-MUNICIPAL-TAX.
 17771
 17772     IF PB-COMPANY-ID NOT = 'DMD'
 17773         GO TO 6640-EXIT.
 17774
 17775     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17776     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17777     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17778*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17779*
 17780***  Y2K PROJ 7744
 17781     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17782     SET BIN-TO-GREG          TO TRUE.
 17783     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17784
 17785     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17786
 17787     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17788     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17789
 17790
 17791* EXEC CICS HANDLE CONDITION
 17792*        INVREQ    (6610-START-BROWSE)
 17793*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17794*        NOTFND    (6630-END-OF-FILE)
 17795*    END-EXEC.
 17796*    MOVE '"$8JI                 ! # #00017778' TO DFHEIV0
 17797     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17799     MOVE X'2320233030303137373738' TO DFHEIV0(25:11)
 17800     CALL 'kxdfhei1' USING DFHEIV0
 17801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17802
 17803
 17804 6610-START-BROWSE.
 17805
 17806
 17807* EXEC CICS HANDLE CONDITION
 17808*        NOTFND    (6630-END-OF-FILE)
 17809*        DISABLED  (6630-ERRESS-PROBLEM)
 17810*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17811*        ENDFILE   (6630-END-OF-FILE)
 17812*    END-EXEC.
 17813*    MOVE '"$IcJ''                ! $ #00017786' TO DFHEIV0
 17814     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17816     MOVE X'2420233030303137373836' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0
 17818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17819
 17820
 17821
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 325
* EL050.cbl
 17822* EXEC CICS STARTBR
 17823*        DATASET (FILE-ID-ERRESS)
 17824*        RIDFLD  (WS-ERRESS-KEY)
 17825*        GTEQ
 17826*    END-EXEC.
 17827     MOVE 0
 17828       TO DFHEIV11
 17829*    MOVE '&,         G          &   #00017793' TO DFHEIV0
 17830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17832     MOVE X'2020233030303137373933' TO DFHEIV0(25:11)
 17833     CALL 'kxdfhei1' USING DFHEIV0,
 17834           FILE-ID-ERRESS,
 17835           WS-ERRESS-KEY,
 17836           DFHEIV99,
 17837           DFHEIV11,
 17838           DFHEIV99
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842 6620-READ-NEXT-ERRESS-MASTER.
 17843
 17844
 17845* EXEC CICS HANDLE CONDITION
 17846*        NOTFND    (6630-END-OF-FILE)
 17847*        ENDFILE   (6630-END-OF-FILE)
 17848*        DISABLED  (6630-ERRESS-PROBLEM)
 17849*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17850*    END-EXEC.
 17851*    MOVE '"$I''cJ                ! % #00017801' TO DFHEIV0
 17852     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17854     MOVE X'2520233030303137383031' TO DFHEIV0(25:11)
 17855     CALL 'kxdfhei1' USING DFHEIV0
 17856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17857
 17858
 17859
 17860* EXEC CICS READNEXT
 17861*        DATASET (FILE-ID-ERRESS)
 17862*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17863*        RIDFLD  (WS-ERRESS-KEY)
 17864*    END-EXEC.
 17865     MOVE LENGTH OF
 17866      RESIDENT-STATE-TAX-MASTER
 17867       TO DFHEIV12
 17868     MOVE 0
 17869       TO DFHEIV11
 17870*    MOVE '&.IL                  )   #00017808' TO DFHEIV0
 17871     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17873     MOVE X'2020233030303137383038' TO DFHEIV0(25:11)
 17874     CALL 'kxdfhei1' USING DFHEIV0,
 17875           FILE-ID-ERRESS,
 17876           RESIDENT-STATE-TAX-MASTER,
 17877           DFHEIV12,
 17878           WS-ERRESS-KEY,
 17879           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 326
* EL050.cbl
 17880           DFHEIV11,
 17881           DFHEIV99,
 17882           DFHEIV99
 17883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17884
 17885
 17886     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17887
 17888* EXEC CICS ENDBR
 17889*            DATASET (FILE-ID-ERRESS)
 17890*       END-EXEC
 17891     MOVE 0
 17892       TO DFHEIV11
 17893*    MOVE '&2                    $   #00017815' TO DFHEIV0
 17894     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17896     MOVE X'2020233030303137383135' TO DFHEIV0(25:11)
 17897     CALL 'kxdfhei1' USING DFHEIV0,
 17898           FILE-ID-ERRESS,
 17899           DFHEIV11,
 17900           DFHEIV99
 17901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17902        GO TO 6630-END-OF-FILE.
 17903
 17904     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17905        NEXT SENTENCE
 17906      ELSE
 17907        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17908
 17909*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17910*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17911*
 17912     MOVE +2                     TO WS-SUB1.
 17913
 17914     IF PB-ISSUE
 17915     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17916        MOVE +1                  TO WS-SUB1.
 17917
 17918     IF PB-CANCELLATION
 17919     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17920        MOVE +1                  TO WS-SUB1.
 17921*
 17922*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17923*
 17924***  Y2K PROJ 7744
 17925     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17926***  Y2K PROJ 7744
 17927
 17928*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17929* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17930* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17931
 17932     ADD 1                    TO WS-YEAR-YY.
 17933
 17934     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17935         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17936                              TO WS-RES-STATE-TAX
 17937         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 327
* EL050.cbl
 17938                              TO WS-RES-MUNI-TAX
 17939     ELSE
 17940         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17941                              TO WS-RES-STATE-TAX
 17942         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17943                              TO WS-RES-MUNI-TAX.
 17944
 17945*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17946
 17947     IF PB-CANCELLATION
 17948         GO TO 6640-CANCEL-TAX.
 17949
 17950     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17951         COMPUTE PB-I-STATE-TAX ROUNDED =
 17952                                   PB-I-LF-PREMIUM-AMT
 17953                                 * WS-RES-STATE-TAX
 17954         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17955                                   PB-I-LF-PREMIUM-AMT
 17956                                 * WS-RES-MUNI-TAX
 17957     ELSE
 17958     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17959         COMPUTE PB-I-STATE-TAX ROUNDED =
 17960                                   PB-I-AH-PREMIUM-AMT
 17961                                 * WS-RES-STATE-TAX
 17962         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17963                                   PB-I-AH-PREMIUM-AMT
 17964                                 * WS-RES-MUNI-TAX.
 17965
 17966
 17967* EXEC CICS ENDBR
 17968*         DATASET (FILE-ID-ERRESS)
 17969*    END-EXEC.
 17970     MOVE 0
 17971       TO DFHEIV11
 17972*    MOVE '&2                    $   #00017882' TO DFHEIV0
 17973     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17974     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17975     MOVE X'2020233030303137383832' TO DFHEIV0(25:11)
 17976     CALL 'kxdfhei1' USING DFHEIV0,
 17977           FILE-ID-ERRESS,
 17978           DFHEIV11,
 17979           DFHEIV99
 17980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17981
 17982
 17983     GO TO 6640-EXIT.
 17984
 17985 6640-CANCEL-TAX.
 17986     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17987
 17988     IF PB-C-LF-CANCEL-AMT > ZEROS
 17989         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17990                                   PB-C-LF-CANCEL-AMT
 17991                                 * WS-RES-STATE-TAX
 17992         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17993                                   PB-C-LF-CANCEL-AMT
 17994                                *  WS-RES-MUNI-TAX
 17995     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 328
* EL050.cbl
 17996     IF PB-C-AH-CANCEL-AMT > ZEROS
 17997         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17998                                   PB-C-AH-CANCEL-AMT
 17999                                 * WS-RES-STATE-TAX
 18000         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18001                                   PB-C-AH-CANCEL-AMT
 18002                                *  WS-RES-MUNI-TAX.
 18003
 18004
 18005* EXEC CICS ENDBR
 18006*         DATASET (FILE-ID-ERRESS)
 18007*    END-EXEC.
 18008     MOVE 0
 18009       TO DFHEIV11
 18010*    MOVE '&2                    $   #00017907' TO DFHEIV0
 18011     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18012     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18013     MOVE X'2020233030303137393037' TO DFHEIV0(25:11)
 18014     CALL 'kxdfhei1' USING DFHEIV0,
 18015           FILE-ID-ERRESS,
 18016           DFHEIV11,
 18017           DFHEIV99
 18018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18019
 18020
 18021     GO TO 6640-EXIT.
 18022
 18023 6630-END-OF-FILE.
 18024     MOVE ER-8002              TO WS-ERROR.
 18025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18026
 18027     GO TO 6640-EXIT.
 18028
 18029 6630-ERRESS-PROBLEM.
 18030     MOVE ER-8044              TO WS-ERROR.
 18031     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18032
 18033 6640-EXIT.
 18034     EXIT.
 18035
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 329
* EL050.cbl
 18037 6650-GET-RES-STATE-COMM.
 18038
 18039     IF PB-COMPANY-ID NOT = 'DMD'
 18040         GO TO 6700-COMM-EXIT.
 18041
 18042     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18043     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18044     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18045     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18046     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18047     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18048     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18049
 18050*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18051*
 18052***  Y2K PROJ 7744
 18053     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18054     SET BIN-TO-GREG          TO TRUE.
 18055     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18056
 18057     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18058***  Y2K PROJ 7744
 18059
 18060     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18061
 18062
 18063* EXEC CICS HANDLE CONDITION
 18064*        INVREQ    (6660-START-BROWSE)
 18065*        DISABLED  (6690-ERRESC-PROBLEM)
 18066*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18067*        NOTFND    (6690-END-OF-FILE)
 18068*    END-EXEC.
 18069*    MOVE '"$8cJI                ! & #00017952' TO DFHEIV0
 18070     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18071     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18072     MOVE X'2620233030303137393532' TO DFHEIV0(25:11)
 18073     CALL 'kxdfhei1' USING DFHEIV0
 18074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18075
 18076
 18077
 18078* EXEC CICS RESETBR
 18079*        DATASET (FILE-ID-ERRESC)
 18080*        RIDFLD  (WS-ERRESC-KEY)
 18081*    END-EXEC.
 18082     MOVE 0
 18083       TO DFHEIV11
 18084*    MOVE '&4         G          &   #00017959' TO DFHEIV0
 18085     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18086     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18087     MOVE X'2020233030303137393539' TO DFHEIV0(25:11)
 18088     CALL 'kxdfhei1' USING DFHEIV0,
 18089           FILE-ID-ERRESC,
 18090           WS-ERRESC-KEY,
 18091           DFHEIV99,
 18092           DFHEIV11,
 18093           DFHEIV99
 18094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 330
* EL050.cbl
 18095
 18096
 18097 6660-START-BROWSE.
 18098
 18099
 18100* EXEC CICS HANDLE CONDITION
 18101*        NOTFND    (6690-END-OF-FILE)
 18102*        DISABLED  (6690-ERRESC-PROBLEM)
 18103*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18104*        ENDFILE   (6690-END-OF-FILE)
 18105*    END-EXEC.
 18106*    MOVE '"$IcJ''                ! '' #00017966' TO DFHEIV0
 18107     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18109     MOVE X'2720233030303137393636' TO DFHEIV0(25:11)
 18110     CALL 'kxdfhei1' USING DFHEIV0
 18111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18112
 18113
 18114
 18115* EXEC CICS STARTBR
 18116*        DATASET (FILE-ID-ERRESC)
 18117*        RIDFLD  (WS-ERRESC-KEY)
 18118*        GTEQ
 18119*    END-EXEC.
 18120     MOVE 0
 18121       TO DFHEIV11
 18122*    MOVE '&,         G          &   #00017973' TO DFHEIV0
 18123     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18124     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18125     MOVE X'2020233030303137393733' TO DFHEIV0(25:11)
 18126     CALL 'kxdfhei1' USING DFHEIV0,
 18127           FILE-ID-ERRESC,
 18128           WS-ERRESC-KEY,
 18129           DFHEIV99,
 18130           DFHEIV11,
 18131           DFHEIV99
 18132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18133
 18134
 18135     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18136
 18137 6670-READ-NEXT-ERRESC-MASTER.
 18138
 18139
 18140* EXEC CICS HANDLE CONDITION
 18141*        NOTFND    (6690-END-OF-FILE)
 18142*        DISABLED  (6690-ERRESC-PROBLEM)
 18143*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18144*        ENDFILE   (6690-END-OF-FILE)
 18145*    END-EXEC.
 18146*    MOVE '"$IcJ''                ! ( #00017983' TO DFHEIV0
 18147     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18149     MOVE X'2820233030303137393833' TO DFHEIV0(25:11)
 18150     CALL 'kxdfhei1' USING DFHEIV0
 18151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18152
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 331
* EL050.cbl
 18153
 18154
 18155* EXEC CICS READNEXT
 18156*        DATASET (FILE-ID-ERRESC)
 18157*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18158*        RIDFLD  (ERRESC-RECORD-KEY)
 18159*    END-EXEC.
 18160     MOVE LENGTH OF
 18161      ACCOUNT-RESIDENT-ST-COMMISSION
 18162       TO DFHEIV12
 18163     MOVE 0
 18164       TO DFHEIV11
 18165*    MOVE '&.IL                  )   #00017990' TO DFHEIV0
 18166     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18167     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18168     MOVE X'2020233030303137393930' TO DFHEIV0(25:11)
 18169     CALL 'kxdfhei1' USING DFHEIV0,
 18170           FILE-ID-ERRESC,
 18171           ACCOUNT-RESIDENT-ST-COMMISSION,
 18172           DFHEIV12,
 18173           ERRESC-RECORD-KEY,
 18174           DFHEIV99,
 18175           DFHEIV11,
 18176           DFHEIV99,
 18177           DFHEIV99
 18178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18179
 18180
 18181     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18182        NEXT SENTENCE
 18183     ELSE
 18184
 18185* EXEC CICS ENDBR
 18186*            DATASET (FILE-ID-ERRESC)
 18187*       END-EXEC
 18188     MOVE 0
 18189       TO DFHEIV11
 18190*    MOVE '&2                    $   #00017999' TO DFHEIV0
 18191     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18193     MOVE X'2020233030303137393939' TO DFHEIV0(25:11)
 18194     CALL 'kxdfhei1' USING DFHEIV0,
 18195           FILE-ID-ERRESC,
 18196           DFHEIV11,
 18197           DFHEIV99
 18198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18199        GO TO 6690-END-OF-FILE.
 18200
 18201     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18202
 18203* EXEC CICS ENDBR
 18204*            DATASET (FILE-ID-ERRESC)
 18205*       END-EXEC
 18206     MOVE 0
 18207       TO DFHEIV11
 18208*    MOVE '&2                    $   #00018005' TO DFHEIV0
 18209     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 332
* EL050.cbl
 18211     MOVE X'2020233030303138303035' TO DFHEIV0(25:11)
 18212     CALL 'kxdfhei1' USING DFHEIV0,
 18213           FILE-ID-ERRESC,
 18214           DFHEIV11,
 18215           DFHEIV99
 18216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18217        GO TO 6690-END-OF-FILE.
 18218
 18219     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18220        NEXT SENTENCE
 18221      ELSE
 18222        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18223
 18224* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18225*
 18226     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18227
 18228     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18229
 18230     IF WS-SUB1 > ZERO
 18231         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18232             PERFORM 6680-SET-COMMISSION
 18233         ELSE
 18234             PERFORM 6680-SET-TABLE-CODE.
 18235
 18236
 18237* EXEC CICS ENDBR
 18238*         DATASET (FILE-ID-ERRESC)
 18239*    END-EXEC.
 18240     MOVE 0
 18241       TO DFHEIV11
 18242*    MOVE '&2                    $   #00018027' TO DFHEIV0
 18243     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18245     MOVE X'2020233030303138303237' TO DFHEIV0(25:11)
 18246     CALL 'kxdfhei1' USING DFHEIV0,
 18247           FILE-ID-ERRESC,
 18248           DFHEIV11,
 18249           DFHEIV99
 18250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18251
 18252
 18253     GO TO 6700-COMM-EXIT.
 18254
 18255 6680-SET-TABLE-CODE.
 18256     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18257        MOVE ZEROS             TO WS-SUB1
 18258     ELSE
 18259* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18260* TO COMPUTE AH COMMISSION.
 18261        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18262        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18263        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18264        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18265        PERFORM 6680-READ-CTBL-TABLE
 18266        IF WS-CTBL-READ-SW NOT = 'Y'
 18267           MOVE ZEROS          TO WS-SUB1.
 18268
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 333
* EL050.cbl
 18269 6680-READ-CTBL-TABLE.
 18270*
 18271* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18272* TO COMPUTE LIFE COMMISSION
 18273
 18274     IF CTBL-SW = '0540'
 18275        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18276        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18277        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18278
 18279     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18280
 18281     IF CTBL-TABLE-FOUND
 18282        IF CTBL-SW = '0530'
 18283             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18284                                    * PB-I-AH-TERM
 18285             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18286             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18287        ELSE
 18288             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18289             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18290             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18291     ELSE
 18292        IF FIRST-TIME-THROUGH
 18293            GO TO 6680-READ-CTBL-TABLE
 18294        ELSE
 18295            MOVE ZEROS         TO WS-SUB1.
 18296
 18297 6680-SET-COMMISSION.
 18298     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18299           MOVE ZEROS          TO WS-SUB1
 18300       ELSE
 18301           MOVE RESC-COMMISSION-PER (WS-SUB)
 18302                               TO WS-COMMISSION
 18303           IF CTBL-SW = '0530'
 18304               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18305           ELSE
 18306               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18307
 18308 6680-SEARCH-CATEGORY.
 18309     ADD +1                   TO WS-SUB.
 18310     IF WS-SUB > +12
 18311         GO TO 6680-EXIT.
 18312
 18313     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18314          MOVE WS-SUB         TO WS-SUB1
 18315          GO TO 6680-EXIT.
 18316
 18317     GO TO 6680-SEARCH-CATEGORY.
 18318
 18319 6680-EXIT.
 18320     EXIT.
 18321
 18322 6690-END-OF-FILE.
 18323     GO TO 6700-COMM-EXIT.
 18324
 18325 6690-ERRESC-PROBLEM.
 18326      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 334
* EL050.cbl
 18327      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18328
 18329      GO TO 6700-COMM-EXIT.
 18330
 18331 6700-COMM-EXIT.
 18332     EXIT.
 18333
 18334 7000-GET-RATE.
 18335
 18336* EXEC CICS LINK
 18337*        PROGRAM    ('ELRATE')
 18338*        COMMAREA   (CALCULATION-PASS-AREA)
 18339*        LENGTH     (CP-COMM-LENGTH)
 18340*    END-EXEC.
 18341     MOVE 'ELRATE' TO DFHEIV1
 18342*    MOVE '."C                   (   #00018113' TO DFHEIV0
 18343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18345     MOVE X'2020233030303138313133' TO DFHEIV0(25:11)
 18346     CALL 'kxdfhei1' USING DFHEIV0,
 18347           DFHEIV1,
 18348           CALCULATION-PASS-AREA,
 18349           CP-COMM-LENGTH,
 18350           DFHEIV99,
 18351           DFHEIV99,
 18352           DFHEIV99,
 18353           DFHEIV99
 18354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18355
 18356
 18357 7000-EXIT.
 18358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 335
* EL050.cbl
 18360 7100-FIND-BENEFIT-IN-STATE.
 18361     MOVE 'N'                    TO BEN-SEARCH-SW.
 18362
 18363     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18364         VARYING SUB3 FROM 1 BY 1 UNTIL
 18365            ((SUB3 GREATER 50) OR
 18366              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18367               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18368
 18369     IF SUB3 NOT = 51
 18370         MOVE 'Y'                TO BEN-SEARCH-SW.
 18371
 18372     GO TO 7199-EXIT.
 18373
 18374 7100-BENEFIT-DUMMY.
 18375
 18376 7100-DUMMY-EXIT.
 18377     EXIT.
 18378
 18379 7199-EXIT.
 18380     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 336
* EL050.cbl
 18382 7200-FIND-BENEFIT.
 18383     MOVE 'N'                    TO BEN-SEARCH-SW.
 18384
 18385     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18386         VARYING SUB3 FROM 1 BY 1 UNTIL
 18387            ((SUB3 GREATER 8) OR
 18388            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18389
 18390     IF SUB3 NOT = 9
 18391         MOVE 'Y'                TO BEN-SEARCH-SW.
 18392
 18393     GO TO 7200-EXIT.
 18394
 18395 7200-BENEFIT-DUMMY.
 18396
 18397 7200-DUMMY-EXIT.
 18398     EXIT.
 18399
 18400 7200-EXIT.
 18401     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 337
* EL050.cbl
 18403 7250-LOOK-FOR-RESCINDED-CLAIM.
 18404     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18405                                    W-CL-COMP-CD.
 18406     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18407                                    W-CL-CERT-NO.
 18408
 18409
 18410* EXEC CICS HANDLE CONDITION
 18411*        NOTFND  (7250-CONTINUE)
 18412*        ENDFILE (7250-CONTINUE)
 18413*    END-EXEC.
 18414*    MOVE '"$I''                  ! ) #00018171' TO DFHEIV0
 18415     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18417     MOVE X'2920233030303138313731' TO DFHEIV0(25:11)
 18418     CALL 'kxdfhei1' USING DFHEIV0
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18420
 18421
 18422
 18423* EXEC CICS IGNORE CONDITION
 18424*        DUPKEY
 18425*    END-EXEC.
 18426*    MOVE '"*$                   !   #00018176' TO DFHEIV0
 18427     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18429     MOVE X'2020233030303138313736' TO DFHEIV0(25:11)
 18430     CALL 'kxdfhei1' USING DFHEIV0
 18431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18432
 18433
 18434
 18435* EXEC CICS STARTBR
 18436*        DATASET   (CLMS-ID)
 18437*        RIDFLD    (ELMSTR-KEY)
 18438*        GENERIC   EQUAL
 18439*        KEYLENGTH (ELMSTR-LENGTH)
 18440*    END-EXEC.
 18441     MOVE 0
 18442       TO DFHEIV11
 18443*    MOVE '&,   KG    E          &   #00018180' TO DFHEIV0
 18444     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18446     MOVE X'2020233030303138313830' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0,
 18448           CLMS-ID,
 18449           ELMSTR-KEY,
 18450           ELMSTR-LENGTH,
 18451           DFHEIV11,
 18452           DFHEIV99
 18453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18454
 18455
 18456     MOVE 'Y'                    TO W-BROWSE-SW.
 18457
 18458 7250-NEXT-CLAIM.
 18459
 18460
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 338
* EL050.cbl
 18461* EXEC CICS READNEXT
 18462*        DATASET   (CLMS-ID)
 18463*        RIDFLD    (ELMSTR-KEY)
 18464*        SET       (ADDRESS OF CLAIM-MASTER)
 18465*    END-EXEC.
 18466     MOVE 0
 18467       TO DFHEIV11
 18468*    MOVE '&.S                   )   #00018191' TO DFHEIV0
 18469     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18470     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18471     MOVE X'2020233030303138313931' TO DFHEIV0(25:11)
 18472     CALL 'kxdfhei1' USING DFHEIV0,
 18473           CLMS-ID,
 18474           DFHEIV20,
 18475           DFHEIV99,
 18476           ELMSTR-KEY,
 18477           DFHEIV99,
 18478           DFHEIV11,
 18479           DFHEIV99,
 18480           DFHEIV99
 18481     SET ADDRESS OF CLAIM-MASTER TO
 18482         DFHEIV20
 18483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18484
 18485
 18486     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18487        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18488         GO TO 7250-CONTINUE
 18489     END-IF.
 18490
 18491     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18492        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18493        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18494        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18495        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18496         GO TO 7250-NEXT-CLAIM
 18497     END-IF.
 18498
 18499     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18500        OR (CL-CLAIM-TYPE = 'I')
 18501        OR (CL-CLAIM-TYPE = 'G')
 18502          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18503              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18504              GO TO 7250-CONTINUE
 18505          END-IF
 18506     END-IF.
 18507
 18508     GO TO 7250-NEXT-CLAIM.
 18509
 18510 7250-CONTINUE.
 18511
 18512     IF W-BROWSE-SW = 'Y'
 18513
 18514* EXEC CICS ENDBR
 18515*            DATASET   (CLMS-ID)
 18516*        END-EXEC
 18517     MOVE 0
 18518       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 339
* EL050.cbl
 18519*    MOVE '&2                    $   #00018224' TO DFHEIV0
 18520     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18521     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18522     MOVE X'2020233030303138323234' TO DFHEIV0(25:11)
 18523     CALL 'kxdfhei1' USING DFHEIV0,
 18524           CLMS-ID,
 18525           DFHEIV11,
 18526           DFHEIV99
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18528         MOVE 'N' TO W-BROWSE-SW
 18529     END-IF.
 18530
 18531 7250-EXIT.
 18532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 340
* EL050.cbl
 18534 7300-CHECK-FOR-OPEN-CLMS.
 18535
 18536*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18537*    MOVE SPACES                 TO CNTL-ACCESS.
 18538*    MOVE '1'                    TO CNTL-REC-TYPE.
 18539*    MOVE +0                     TO CNTL-SEQ-NO.
 18540
 18541*    MOVE '3'                    TO RC-SW-1.
 18542*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18543
 18544*    IF NOT CF-COMPANY-MASTER
 18545*         PERFORM 0099-COMPANY-NOT-FOUND
 18546*         GO TO 7300-EXIT.
 18547
 18548     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18549                                    W-CL-COMP-CD.
 18550     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18551                                    W-CL-CERT-NO.
 18552
 18553
 18554* EXEC CICS HANDLE CONDITION
 18555*        NOTFND  (7300-CONTINUE)
 18556*        ENDFILE (7300-CONTINUE)
 18557*    END-EXEC.
 18558*    MOVE '"$I''                  ! * #00018252' TO DFHEIV0
 18559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18561     MOVE X'2A20233030303138323532' TO DFHEIV0(25:11)
 18562     CALL 'kxdfhei1' USING DFHEIV0
 18563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18564
 18565
 18566
 18567* EXEC CICS IGNORE CONDITION
 18568*        DUPKEY
 18569*    END-EXEC.
 18570*    MOVE '"*$                   !   #00018257' TO DFHEIV0
 18571     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18573     MOVE X'2020233030303138323537' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578
 18579* EXEC CICS STARTBR
 18580*        DATASET   (CLMS-ID)
 18581*        RIDFLD    (ELMSTR-KEY)
 18582*        GENERIC   EQUAL
 18583*        KEYLENGTH (ELMSTR-LENGTH)
 18584*    END-EXEC.
 18585     MOVE 0
 18586       TO DFHEIV11
 18587*    MOVE '&,   KG    E          &   #00018261' TO DFHEIV0
 18588     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18589     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18590     MOVE X'2020233030303138323631' TO DFHEIV0(25:11)
 18591     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 341
* EL050.cbl
 18592           CLMS-ID,
 18593           ELMSTR-KEY,
 18594           ELMSTR-LENGTH,
 18595           DFHEIV11,
 18596           DFHEIV99
 18597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18598
 18599
 18600     MOVE 'Y'                    TO W-BROWSE-SW.
 18601
 18602 7300-NEXT-CLAIM.
 18603
 18604
 18605* EXEC CICS READNEXT
 18606*        DATASET   (CLMS-ID)
 18607*        RIDFLD    (ELMSTR-KEY)
 18608*        SET       (ADDRESS OF CLAIM-MASTER)
 18609*    END-EXEC.
 18610     MOVE 0
 18611       TO DFHEIV11
 18612*    MOVE '&.S                   )   #00018272' TO DFHEIV0
 18613     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18614     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18615     MOVE X'2020233030303138323732' TO DFHEIV0(25:11)
 18616     CALL 'kxdfhei1' USING DFHEIV0,
 18617           CLMS-ID,
 18618           DFHEIV20,
 18619           DFHEIV99,
 18620           ELMSTR-KEY,
 18621           DFHEIV99,
 18622           DFHEIV11,
 18623           DFHEIV99,
 18624           DFHEIV99
 18625     SET ADDRESS OF CLAIM-MASTER TO
 18626         DFHEIV20
 18627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18628
 18629
 18630     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18631        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18632         GO TO 7300-CONTINUE.
 18633
 18634     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18635        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18636        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18637        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18638        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18639         GO TO 7300-NEXT-CLAIM.
 18640
 18641*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18642     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18643        OR (CL-CLAIM-TYPE = 'I')
 18644        OR (CL-CLAIM-TYPE = 'G')
 18645        IF CLAIM-IS-OPEN
 18646           EVALUATE TRUE
 18647             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18648                 MOVE ER-2884      TO WS-ERROR
 18649             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 342
* EL050.cbl
 18650                 MOVE ER-2887      TO WS-ERROR
 18651             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18652                 MOVE ER-2886      TO WS-ERROR
 18653             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18654                 MOVE ER-2888      TO WS-ERROR
 18655             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18656                 MOVE ER-2885      TO WS-ERROR
 18657             WHEN OTHER
 18658                 MOVE ER-2768      TO WS-ERROR
 18659           END-EVALUATE
 18660           IF PB-C-AH-CANCEL-VOIDED OR
 18661              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18662                NOT AH-COVERAGE-CANCELLED)
 18663               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18664               MOVE ER-2768      TO WS-ERROR
 18665           END-IF
 18666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18667           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18668              PB-FORCE-CODE NOT EQUAL '8'
 18669               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18670           END-IF
 18671           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18672           GO TO 7300-CONTINUE
 18673        ELSE
 18674           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18675*****THIS IS A RESCISSION OR REFORMATION
 18676              IF (AH-COVERAGE-CANCELLED AND
 18677                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18678                    MOVE ER-2890 TO WS-ERROR
 18679                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18680                    GO TO 7300-CONTINUE
 18681              END-IF
 18682           ELSE
 18683              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18684               AND PB-C-AH-CANCEL-DT > SPACES
 18685                 MOVE ER-2756        TO WS-ERROR
 18686                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18687                 GO TO 7300-CONTINUE
 18688              END-IF
 18689           END-IF
 18690        END-IF
 18691     ELSE
 18692*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18693        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18694           IF CLAIM-IS-OPEN
 18695              MOVE ER-2889      TO WS-ERROR
 18696              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18697              GO TO 7300-CONTINUE
 18698           ELSE
 18699              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18700*****THIS IS A RESCISSION OR REFORMATION
 18701                 IF (LF-COVERAGE-CANCELLED AND
 18702                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18703                       MOVE ER-2890 TO WS-ERROR
 18704                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18705                       GO TO 7300-CONTINUE
 18706                 END-IF
 18707              ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 343
* EL050.cbl
 18708                 IF (AH-COVERAGE-CANCELLED AND
 18709                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18710                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18711                    (LF-COVERAGE-CANCELLED AND
 18712                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18713                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18714                       MOVE ER-2965 TO WS-ERROR
 18715                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18716                       GO TO 7300-CONTINUE
 18717                 END-IF
 18718                 IF LF-COVERAGE-CANCELLED
 18719                  IF CL-TOTAL-PAID-AMT > 0
 18720                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18721                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18722                        MOVE ER-2891 TO WS-ERROR
 18723                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18724                        GO TO 7300-CONTINUE
 18725                      END-IF
 18726                    ELSE
 18727                      MOVE ER-2892 TO WS-ERROR
 18728                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18729                      GO TO 7300-CONTINUE
 18730                    END-IF
 18731                  END-IF
 18732                 END-IF
 18733              END-IF
 18734           END-IF
 18735        END-IF
 18736     END-IF
 18737
 18738     GO TO 7300-NEXT-CLAIM.
 18739
 18740 7300-CONTINUE.
 18741
 18742     IF W-BROWSE-SW = 'Y'
 18743
 18744* EXEC CICS ENDBR
 18745*            DATASET   (CLMS-ID)
 18746*        END-EXEC.
 18747     MOVE 0
 18748       TO DFHEIV11
 18749*    MOVE '&2                    $   #00018391' TO DFHEIV0
 18750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18752     MOVE X'2020233030303138333931' TO DFHEIV0(25:11)
 18753     CALL 'kxdfhei1' USING DFHEIV0,
 18754           CLMS-ID,
 18755           DFHEIV11,
 18756           DFHEIV99
 18757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18758
 18759
 18760 7300-EXIT.
 18761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 344
* EL050.cbl
 18763
 18764 7400-GET-REMAIN-TERM.
 18765
 18766* EXEC CICS LINK
 18767*        PROGRAM    ('ELRTRM')
 18768*        COMMAREA   (CALCULATION-PASS-AREA)
 18769*        LENGTH     (CP-COMM-LENGTH)
 18770*    END-EXEC.
 18771     MOVE 'ELRTRM' TO DFHEIV1
 18772*    MOVE '."C                   (   #00018400' TO DFHEIV0
 18773     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18775     MOVE X'2020233030303138343030' TO DFHEIV0(25:11)
 18776     CALL 'kxdfhei1' USING DFHEIV0,
 18777           DFHEIV1,
 18778           CALCULATION-PASS-AREA,
 18779           CP-COMM-LENGTH,
 18780           DFHEIV99,
 18781           DFHEIV99,
 18782           DFHEIV99,
 18783           DFHEIV99
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787 7400-EXIT.
 18788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 345
* EL050.cbl
 18790
 18791 7500-GET-REMAIN-AMOUNT.
 18792
 18793* EXEC CICS LINK
 18794*        PROGRAM    ('ELRAMT')
 18795*        COMMAREA   (CALCULATION-PASS-AREA)
 18796*        LENGTH     (CP-COMM-LENGTH)
 18797*    END-EXEC.
 18798     MOVE 'ELRAMT' TO DFHEIV1
 18799*    MOVE '."C                   (   #00018411' TO DFHEIV0
 18800     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18802     MOVE X'2020233030303138343131' TO DFHEIV0(25:11)
 18803     CALL 'kxdfhei1' USING DFHEIV0,
 18804           DFHEIV1,
 18805           CALCULATION-PASS-AREA,
 18806           CP-COMM-LENGTH,
 18807           DFHEIV99,
 18808           DFHEIV99,
 18809           DFHEIV99,
 18810           DFHEIV99
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
 18814 7500-EXIT.
 18815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 346
* EL050.cbl
 18817
 18818 7600-GET-REFUND.
 18819
 18820* EXEC CICS LINK
 18821*        PROGRAM    ('ELRFND')
 18822*        COMMAREA   (CALCULATION-PASS-AREA)
 18823*        LENGTH     (CP-COMM-LENGTH)
 18824*    END-EXEC.
 18825     MOVE 'ELRFND' TO DFHEIV1
 18826*    MOVE '."C                   (   #00018422' TO DFHEIV0
 18827     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18829     MOVE X'2020233030303138343232' TO DFHEIV0(25:11)
 18830     CALL 'kxdfhei1' USING DFHEIV0,
 18831           DFHEIV1,
 18832           CALCULATION-PASS-AREA,
 18833           CP-COMM-LENGTH,
 18834           DFHEIV99,
 18835           DFHEIV99,
 18836           DFHEIV99,
 18837           DFHEIV99
 18838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18839
 18840
 18841 7600-EXIT.
 18842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 347
* EL050.cbl
 18844 7700-CALL-DL1.
 18845
 18846* EXEC CICS LINK
 18847*        PROGRAM    ('DLO001')
 18848*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18849*        LENGTH     (DLO001-COMM-LENGTH)
 18850*    END-EXEC.
 18851     MOVE 'DLO001' TO DFHEIV1
 18852*    MOVE '."C                   (   #00018432' TO DFHEIV0
 18853     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18855     MOVE X'2020233030303138343332' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0,
 18857           DFHEIV1,
 18858           WS-DLO-MASTER-POLICY-FORM,
 18859           DLO001-COMM-LENGTH,
 18860           DFHEIV99,
 18861           DFHEIV99,
 18862           DFHEIV99,
 18863           DFHEIV99
 18864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18865
 18866
 18867 7700-EXIT.
 18868     EXIT.
 18869
 18870 7710-CALL-DL2.
 18871
 18872* EXEC CICS LINK
 18873*        PROGRAM    ('DLO002')
 18874*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18875*        LENGTH     (DLO002-COMM-LENGTH)
 18876*    END-EXEC.
 18877     MOVE 'DLO002' TO DFHEIV1
 18878*    MOVE '."C                   (   #00018442' TO DFHEIV0
 18879     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18881     MOVE X'2020233030303138343432' TO DFHEIV0(25:11)
 18882     CALL 'kxdfhei1' USING DFHEIV0,
 18883           DFHEIV1,
 18884           WS-DLO-INTERNAL-POLICY-FORM,
 18885           DLO002-COMM-LENGTH,
 18886           DFHEIV99,
 18887           DFHEIV99,
 18888           DFHEIV99,
 18889           DFHEIV99
 18890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18891
 18892
 18893 7710-EXIT.
 18894     EXIT.
 18895
 18896 7720-CALL-DL3.
 18897
 18898* EXEC CICS LINK
 18899*        PROGRAM    ('DLO003')
 18900*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18901*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 348
* EL050.cbl
 18902*    END-EXEC.
 18903     MOVE 'DLO003' TO DFHEIV1
 18904*    MOVE '."C                   (   #00018452' TO DFHEIV0
 18905     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18907     MOVE X'2020233030303138343532' TO DFHEIV0(25:11)
 18908     CALL 'kxdfhei1' USING DFHEIV0,
 18909           DFHEIV1,
 18910           WS-DLO-VALID-BANK-ID,
 18911           DLO003-COMM-LENGTH,
 18912           DFHEIV99,
 18913           DFHEIV99,
 18914           DFHEIV99,
 18915           DFHEIV99
 18916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18917
 18918
 18919 7720-EXIT.
 18920     EXIT.
 18921
 18922 7730-CALL-DL7.
 18923
 18924* EXEC CICS LINK
 18925*        PROGRAM    ('DLO007')
 18926*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18927*        LENGTH     (DLO007-COMM-LENGTH)
 18928*    END-EXEC.
 18929     MOVE 'DLO007' TO DFHEIV1
 18930*    MOVE '."C                   (   #00018462' TO DFHEIV0
 18931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18933     MOVE X'2020233030303138343632' TO DFHEIV0(25:11)
 18934     CALL 'kxdfhei1' USING DFHEIV0,
 18935           DFHEIV1,
 18936           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18937           DLO007-COMM-LENGTH,
 18938           DFHEIV99,
 18939           DFHEIV99,
 18940           DFHEIV99,
 18941           DFHEIV99
 18942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18943
 18944
 18945 7730-EXIT.
 18946     EXIT.
 18947
 18948 7740-CALL-DL11.
 18949
 18950* EXEC CICS LINK
 18951*        PROGRAM    ('DLO011')
 18952*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18953*        LENGTH     (DLO011-COMM-LENGTH)
 18954*    END-EXEC.
 18955     MOVE 'DLO011' TO DFHEIV1
 18956*    MOVE '."C                   (   #00018472' TO DFHEIV0
 18957     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18959     MOVE X'2020233030303138343732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 349
* EL050.cbl
 18960     CALL 'kxdfhei1' USING DFHEIV0,
 18961           DFHEIV1,
 18962           WS-DLO-PREM-RATES-BEN-TYPE,
 18963           DLO011-COMM-LENGTH,
 18964           DFHEIV99,
 18965           DFHEIV99,
 18966           DFHEIV99,
 18967           DFHEIV99
 18968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18969
 18970
 18971 7740-EXIT.
 18972     EXIT.
 18973
 18974 7750-CALL-DL17.
 18975
 18976* EXEC CICS LINK
 18977*        PROGRAM    ('DLO017')
 18978*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18979*        LENGTH     (DLO017-COMM-LENGTH)
 18980*    END-EXEC.
 18981     MOVE 'DLO017' TO DFHEIV1
 18982*    MOVE '."C                   (   #00018482' TO DFHEIV0
 18983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18985     MOVE X'2020233030303138343832' TO DFHEIV0(25:11)
 18986     CALL 'kxdfhei1' USING DFHEIV0,
 18987           DFHEIV1,
 18988           WS-DLO-VALID-RATE-CODE,
 18989           DLO017-COMM-LENGTH,
 18990           DFHEIV99,
 18991           DFHEIV99,
 18992           DFHEIV99,
 18993           DFHEIV99
 18994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18995
 18996
 18997 7750-EXIT.
 18998     EXIT.
 18999
 19000 7755-CALL-DL19.
 19001
 19002* EXEC CICS LINK
 19003*        PROGRAM    ('DLO019')
 19004*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19005*        LENGTH     (DLO019-COMM-LENGTH)
 19006*    END-EXEC.
 19007     MOVE 'DLO019' TO DFHEIV1
 19008*    MOVE '."C                   (   #00018492' TO DFHEIV0
 19009     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19011     MOVE X'2020233030303138343932' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0,
 19013           DFHEIV1,
 19014           WS-DLO-ORIG-COV-CAT,
 19015           DLO019-COMM-LENGTH,
 19016           DFHEIV99,
 19017           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 350
* EL050.cbl
 19018           DFHEIV99,
 19019           DFHEIV99
 19020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19021
 19022
 19023 7755-EXIT.
 19024     EXIT.
 19025
 19026 7760-CALL-DL21.
 19027
 19028* EXEC CICS LINK
 19029*        PROGRAM    ('DLO021')
 19030*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19031*        LENGTH     (DLO021-COMM-LENGTH)
 19032*    END-EXEC.
 19033     MOVE 'DLO021' TO DFHEIV1
 19034*    MOVE '."C                   (   #00018502' TO DFHEIV0
 19035     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19037     MOVE X'2020233030303138353032' TO DFHEIV0(25:11)
 19038     CALL 'kxdfhei1' USING DFHEIV0,
 19039           DFHEIV1,
 19040           WS-DLO-VALID-LOAN-OFFICER,
 19041           DLO021-COMM-LENGTH,
 19042           DFHEIV99,
 19043           DFHEIV99,
 19044           DFHEIV99,
 19045           DFHEIV99
 19046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19047
 19048
 19049 7760-EXIT.
 19050     EXIT.
 19051
 19052 7770-CALL-DL22.
 19053
 19054* EXEC CICS LINK
 19055*        PROGRAM    ('DLO022')
 19056*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19057*        LENGTH     (DLO022-COMM-LENGTH)
 19058*    END-EXEC.
 19059     MOVE 'DLO022' TO DFHEIV1
 19060*    MOVE '."C                   (   #00018512' TO DFHEIV0
 19061     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19063     MOVE X'2020233030303138353132' TO DFHEIV0(25:11)
 19064     CALL 'kxdfhei1' USING DFHEIV0,
 19065           DFHEIV1,
 19066           WS-DLO-VALID-STATE-CODE,
 19067           DLO022-COMM-LENGTH,
 19068           DFHEIV99,
 19069           DFHEIV99,
 19070           DFHEIV99,
 19071           DFHEIV99
 19072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19073
 19074
 19075 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 351
* EL050.cbl
 19076     EXIT.
 19077
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 352
* EL050.cbl
 19079
 19080 7800-REWRITE-CERT.
 19081******************************************************************
 19082*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19083*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19084******************************************************************
 19085
 19086     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19087        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19088        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19089        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19090
 19091* EXEC CICS REWRITE
 19092*                  DATASET (CERT-ID)
 19093*                  FROM    (CERTIFICATE-MASTER)
 19094*              END-EXEC
 19095     MOVE LENGTH OF
 19096      CERTIFICATE-MASTER
 19097       TO DFHEIV11
 19098*    MOVE '&& L                  %   #00018533' TO DFHEIV0
 19099     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19100     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19101     MOVE X'2020233030303138353333' TO DFHEIV0(25:11)
 19102     CALL 'kxdfhei1' USING DFHEIV0,
 19103           CERT-ID,
 19104           CERTIFICATE-MASTER,
 19105           DFHEIV11,
 19106           DFHEIV99
 19107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19108        GO TO 7800-EXIT.
 19109
 19110       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19111       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19112
 19113 7800-EXIT.
 19114      EXIT.
 19115
 19116 7900-DELETE-CERT.
 19117
 19118* EXEC CICS DELETE
 19119*        DATASET (CERT-ID)
 19120*    END-EXEC.
 19121*    MOVE '&(                    &   #00018546' TO DFHEIV0
 19122     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19123     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19124     MOVE X'2020233030303138353436' TO DFHEIV0(25:11)
 19125     CALL 'kxdfhei1' USING DFHEIV0,
 19126           CERT-ID,
 19127           DFHEIV99,
 19128           DFHEIV99,
 19129           DFHEIV99,
 19130           DFHEIV99
 19131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19132
 19133
 19134 7900-EXIT.
 19135     EXIT.
 19136
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 353
* EL050.cbl
 19137 8000-WRITE-CERT.
 19138
 19139* EXEC CICS HANDLE CONDITION
 19140*        DUPKEY    (8000-FREE-MAIN)
 19141*    END-EXEC.
 19142*    MOVE '"$$                   ! + #00018554' TO DFHEIV0
 19143     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19145     MOVE X'2B20233030303138353534' TO DFHEIV0(25:11)
 19146     CALL 'kxdfhei1' USING DFHEIV0
 19147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19148
 19149
 19150
 19151* EXEC CICS WRITE
 19152*        DATASET     (CERT-ID)
 19153*        FROM        (CERTIFICATE-MASTER)
 19154*        RIDFLD      (ELCERT-KEY)
 19155*    END-EXEC.
 19156     MOVE LENGTH OF
 19157      CERTIFICATE-MASTER
 19158       TO DFHEIV11
 19159*    MOVE '&$ L                  ''   #00018558' TO DFHEIV0
 19160     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19162     MOVE X'2020233030303138353538' TO DFHEIV0(25:11)
 19163     CALL 'kxdfhei1' USING DFHEIV0,
 19164           CERT-ID,
 19165           CERTIFICATE-MASTER,
 19166           DFHEIV11,
 19167           ELCERT-KEY,
 19168           DFHEIV99,
 19169           DFHEIV99
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173 8000-FREE-MAIN.
 19174
 19175 8000-EXIT.
 19176      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 354
* EL050.cbl
 19178
 19179 8100-READ-ERPNDM.
 19180
 19181* EXEC CICS HANDLE CONDITION
 19182*         NOTFND     (8100-NOTFND)
 19183*         ENDFILE    (8100-NOTFND)
 19184*    END-EXEC.
 19185*    MOVE '"$I''                  ! , #00018571' TO DFHEIV0
 19186     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19188     MOVE X'2C20233030303138353731' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     MOVE SPACES                 TO ERPNDM-FOUND.
 19194     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19195
 19196
 19197* EXEC CICS READ
 19198*         DATASET   (FILE-ERPNDM)
 19199*         RIDFLD    (PM-CONTROL-PRIMARY)
 19200*         INTO      (PENDING-MAILING-DATA)
 19201*    END-EXEC.
 19202     MOVE LENGTH OF
 19203      PENDING-MAILING-DATA
 19204       TO DFHEIV11
 19205*    MOVE '&"IL       E          (   #00018579' TO DFHEIV0
 19206     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19207     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19208     MOVE X'2020233030303138353739' TO DFHEIV0(25:11)
 19209     CALL 'kxdfhei1' USING DFHEIV0,
 19210           FILE-ERPNDM,
 19211           PENDING-MAILING-DATA,
 19212           DFHEIV11,
 19213           PM-CONTROL-PRIMARY,
 19214           DFHEIV99,
 19215           DFHEIV99,
 19216           DFHEIV99
 19217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19218
 19219
 19220     GO TO 8100-EXIT.
 19221
 19222 8100-NOTFND.
 19223
 19224     MOVE 'X'                    TO ERPNDM-FOUND.
 19225     MOVE ER-2694                TO WS-ERROR.
 19226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19227     MOVE ER-2883                TO WS-ERROR
 19228     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19229     .
 19230 8100-EXIT.
 19231     EXIT.
 19232
 19233 8110-READ-ERMAIL.
 19234
 19235* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 355
* EL050.cbl
 19236*         NOTFND     (8110-NOTFND)
 19237*         ENDFILE    (8110-NOTFND)
 19238*    END-EXEC.
 19239*    MOVE '"$I''                  ! - #00018599' TO DFHEIV0
 19240     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19242     MOVE X'2D20233030303138353939' TO DFHEIV0(25:11)
 19243     CALL 'kxdfhei1' USING DFHEIV0
 19244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19245
 19246
 19247     MOVE SPACES                 TO ERMAIL-FOUND.
 19248     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19249     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19250     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19251     MOVE PB-SV-STATE            TO MA-STATE.
 19252
 19253
 19254* EXEC CICS READ
 19255*         UPDATE
 19256*         DATASET   (FILE-ERMAIL)
 19257*         RIDFLD    (MA-CONTROL-PRIMARY)
 19258*         INTO      (MAILING-DATA)
 19259*    END-EXEC.
 19260     MOVE LENGTH OF
 19261      MAILING-DATA
 19262       TO DFHEIV11
 19263*    MOVE '&"IL       EU         (   #00018610' TO DFHEIV0
 19264     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19266     MOVE X'2020233030303138363130' TO DFHEIV0(25:11)
 19267     CALL 'kxdfhei1' USING DFHEIV0,
 19268           FILE-ERMAIL,
 19269           MAILING-DATA,
 19270           DFHEIV11,
 19271           MA-CONTROL-PRIMARY,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV99
 19275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19276
 19277
 19278     GO TO 8110-EXIT.
 19279
 19280 8110-NOTFND.
 19281     MOVE 'X'                    TO ERMAIL-FOUND.
 19282
 19283 8110-EXIT.
 19284     EXIT.
 19285
 19286 8120-REWRITE-ERMAIL.
 19287
 19288* EXEC CICS REWRITE
 19289*         DATASET    (FILE-ERMAIL)
 19290*         FROM       (MAILING-DATA)
 19291*    END-EXEC.
 19292     MOVE LENGTH OF
 19293      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 356
* EL050.cbl
 19294       TO DFHEIV11
 19295*    MOVE '&& L                  %   #00018626' TO DFHEIV0
 19296     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19297     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19298     MOVE X'2020233030303138363236' TO DFHEIV0(25:11)
 19299     CALL 'kxdfhei1' USING DFHEIV0,
 19300           FILE-ERMAIL,
 19301           MAILING-DATA,
 19302           DFHEIV11,
 19303           DFHEIV99
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307 8120-EXIT.
 19308     EXIT.
 19309
 19310 8130-WRITE-ERMAIL.
 19311
 19312* EXEC CICS HANDLE CONDITION
 19313*         DUPKEY   (8130-EXIT)
 19314*    END-EXEC.
 19315*    MOVE '"$$                   ! . #00018635' TO DFHEIV0
 19316     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19318     MOVE X'2E20233030303138363335' TO DFHEIV0(25:11)
 19319     CALL 'kxdfhei1' USING DFHEIV0
 19320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19321
 19322
 19323
 19324* EXEC CICS WRITE
 19325*         DATASET     (FILE-ERMAIL)
 19326*         RIDFLD      (MA-CONTROL-PRIMARY)
 19327*         FROM        (MAILING-DATA)
 19328*    END-EXEC.
 19329     MOVE LENGTH OF
 19330      MAILING-DATA
 19331       TO DFHEIV11
 19332*    MOVE '&$ L                  ''   #00018639' TO DFHEIV0
 19333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19335     MOVE X'2020233030303138363339' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0,
 19337           FILE-ERMAIL,
 19338           MAILING-DATA,
 19339           DFHEIV11,
 19340           MA-CONTROL-PRIMARY,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346 8130-EXIT.
 19347     EXIT.
 19348
 19349 8140-UNLOCK-ERMAIL.
 19350
 19351* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 357
* EL050.cbl
 19352*         DATASET   (FILE-ERMAIL)
 19353*    END-EXEC.
 19354*    MOVE '&*                    #   #00018649' TO DFHEIV0
 19355     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19357     MOVE X'2020233030303138363439' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0,
 19359           FILE-ERMAIL,
 19360           DFHEIV99
 19361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19362
 19363
 19364 8140-EXIT.
 19365     EXIT.
 19366
 19367 8180-UPDATE-VIN-NUMBER.
 19368
 19369* EXEC CICS HANDLE CONDITION
 19370*        NOTFND   (8180-NOTFND)
 19371*    END-EXEC.
 19372*    MOVE '"$I                   ! / #00018657' TO DFHEIV0
 19373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19375     MOVE X'2F20233030303138363537' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19378
 19379
 19380     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19381     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19382
 19383
 19384* EXEC CICS READ
 19385*        UPDATE
 19386*        DATASET  (CRTT-ID)
 19387*        RIDFLD   (WS-ELCRTT-KEY)
 19388*        INTO     (CERTIFICATE-TRAILERS)
 19389*    END-EXEC.
 19390     MOVE LENGTH OF
 19391      CERTIFICATE-TRAILERS
 19392       TO DFHEIV11
 19393*    MOVE '&"IL       EU         (   #00018664' TO DFHEIV0
 19394     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19395     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19396     MOVE X'2020233030303138363634' TO DFHEIV0(25:11)
 19397     CALL 'kxdfhei1' USING DFHEIV0,
 19398           CRTT-ID,
 19399           CERTIFICATE-TRAILERS,
 19400           DFHEIV11,
 19401           WS-ELCRTT-KEY,
 19402           DFHEIV99,
 19403           DFHEIV99,
 19404           DFHEIV99
 19405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19406
 19407
 19408     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19409         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 358
* EL050.cbl
 19410
 19411* EXEC CICS REWRITE
 19412*           DATASET  (CRTT-ID)
 19413*           FROM     (CERTIFICATE-TRAILERS)
 19414*        END-EXEC
 19415     MOVE LENGTH OF
 19416      CERTIFICATE-TRAILERS
 19417       TO DFHEIV11
 19418*    MOVE '&& L                  %   #00018673' TO DFHEIV0
 19419     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303138363733' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           CRTT-ID,
 19424           CERTIFICATE-TRAILERS,
 19425           DFHEIV11,
 19426           DFHEIV99
 19427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19428     ELSE
 19429
 19430* EXEC CICS UNLOCK
 19431*          DATASET  (CRTT-ID)
 19432*       END-EXEC
 19433*    MOVE '&*                    #   #00018678' TO DFHEIV0
 19434     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19435     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19436     MOVE X'2020233030303138363738' TO DFHEIV0(25:11)
 19437     CALL 'kxdfhei1' USING DFHEIV0,
 19438           CRTT-ID,
 19439           DFHEIV99
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19441     END-IF.
 19442
 19443     GO TO 8180-EXIT.
 19444
 19445 8180-NOTFND.
 19446
 19447     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19448     MOVE 'CS'         TO CS-RECORD-ID.
 19449     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19450     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19451     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19452     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19453
 19454* EXEC CICS WRITE
 19455*       DATASET  (CRTT-ID)
 19456*       RIDFLD   (WS-ELCRTT-KEY)
 19457*       FROM     (CERTIFICATE-TRAILERS)
 19458*    END-EXEC.
 19459     MOVE LENGTH OF
 19460      CERTIFICATE-TRAILERS
 19461       TO DFHEIV11
 19462*    MOVE '&$ L                  ''   #00018693' TO DFHEIV0
 19463     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19465     MOVE X'2020233030303138363933' TO DFHEIV0(25:11)
 19466     CALL 'kxdfhei1' USING DFHEIV0,
 19467           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 359
* EL050.cbl
 19468           CERTIFICATE-TRAILERS,
 19469           DFHEIV11,
 19470           WS-ELCRTT-KEY,
 19471           DFHEIV99,
 19472           DFHEIV99
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476 8180-EXIT.
 19477     EXIT.
 19478
 19479 8190-UPDATE-REFUND-CLAIM-FLAG.
 19480
 19481* EXEC CICS HANDLE CONDITION
 19482*        NOTFND   (8190-NOTFND)
 19483*    END-EXEC.
 19484*    MOVE '"$I                   ! 0 #00018703' TO DFHEIV0
 19485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19487     MOVE X'3020233030303138373033' TO DFHEIV0(25:11)
 19488     CALL 'kxdfhei1' USING DFHEIV0
 19489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19490
 19491
 19492     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19493     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19494
 19495
 19496* EXEC CICS READ
 19497*        UPDATE
 19498*        DATASET  (CRTT-ID)
 19499*        RIDFLD   (WS-ELCRTT-KEY)
 19500*        INTO     (CERTIFICATE-TRAILERS)
 19501*    END-EXEC.
 19502     MOVE LENGTH OF
 19503      CERTIFICATE-TRAILERS
 19504       TO DFHEIV11
 19505*    MOVE '&"IL       EU         (   #00018710' TO DFHEIV0
 19506     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19507     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19508     MOVE X'2020233030303138373130' TO DFHEIV0(25:11)
 19509     CALL 'kxdfhei1' USING DFHEIV0,
 19510           CRTT-ID,
 19511           CERTIFICATE-TRAILERS,
 19512           DFHEIV11,
 19513           WS-ELCRTT-KEY,
 19514           DFHEIV99,
 19515           DFHEIV99,
 19516           DFHEIV99
 19517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19518
 19519
 19520     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19521
 19522* EXEC CICS REWRITE
 19523*       DATASET  (CRTT-ID)
 19524*       FROM     (CERTIFICATE-TRAILERS)
 19525*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 360
* EL050.cbl
 19526     MOVE LENGTH OF
 19527      CERTIFICATE-TRAILERS
 19528       TO DFHEIV11
 19529*    MOVE '&& L                  %   #00018718' TO DFHEIV0
 19530     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19531     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19532     MOVE X'2020233030303138373138' TO DFHEIV0(25:11)
 19533     CALL 'kxdfhei1' USING DFHEIV0,
 19534           CRTT-ID,
 19535           CERTIFICATE-TRAILERS,
 19536           DFHEIV11,
 19537           DFHEIV99
 19538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19539
 19540
 19541     GO TO 8190-EXIT.
 19542
 19543 8190-NOTFND.
 19544
 19545     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19546     MOVE 'CS'         TO CS-RECORD-ID.
 19547     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19548     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19549     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19550     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19551
 19552* EXEC CICS WRITE
 19553*       DATASET  (CRTT-ID)
 19554*       RIDFLD   (WS-ELCRTT-KEY)
 19555*       FROM     (CERTIFICATE-TRAILERS)
 19556*    END-EXEC.
 19557     MOVE LENGTH OF
 19558      CERTIFICATE-TRAILERS
 19559       TO DFHEIV11
 19560*    MOVE '&$ L                  ''   #00018733' TO DFHEIV0
 19561     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19563     MOVE X'2020233030303138373333' TO DFHEIV0(25:11)
 19564     CALL 'kxdfhei1' USING DFHEIV0,
 19565           CRTT-ID,
 19566           CERTIFICATE-TRAILERS,
 19567           DFHEIV11,
 19568           WS-ELCRTT-KEY,
 19569           DFHEIV99,
 19570           DFHEIV99
 19571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19572
 19573
 19574 8190-EXIT.
 19575     EXIT.
 19576
 19577 8200-READ-REIN-TABLE.
 19578
 19579* EXEC CICS HANDLE CONDITION
 19580*         NOTFND   (8200-NOTFND)
 19581*    END-EXEC.
 19582*    MOVE '"$I                   ! 1 #00018743' TO DFHEIV0
 19583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 361
* EL050.cbl
 19584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19585     MOVE X'3120233030303138373433' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590
 19591* EXEC CICS READ
 19592*        DATASET     (REIN-ID)
 19593*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19594*        RIDFLD      (ERREIN-KEY)
 19595*    END-EXEC.
 19596*    MOVE '&"S        E          (   #00018747' TO DFHEIV0
 19597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19599     MOVE X'2020233030303138373437' TO DFHEIV0(25:11)
 19600     CALL 'kxdfhei1' USING DFHEIV0,
 19601           REIN-ID,
 19602           DFHEIV20,
 19603           DFHEIV99,
 19604           ERREIN-KEY,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99
 19608     SET ADDRESS OF REINSURANCE-RECORD TO
 19609         DFHEIV20
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19611
 19612
 19613     GO TO 8200-EXIT.
 19614
 19615 8200-NOTFND.
 19616     MOVE 'N'             TO WS-REIN-READ-SW.
 19617
 19618 8200-EXIT.
 19619      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 362
* EL050.cbl
 19621
 19622 8300-READ-CTBL-TABLE.
 19623
 19624* EXEC CICS HANDLE CONDITION
 19625*        NOTFND    (8300-NOTFND)
 19626*        DISABLED  (8300-ERRESS-PROBLEM)
 19627*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19628*        ENDFILE   (8300-NOTFND)
 19629*    END-EXEC.
 19630*    MOVE '"$IcJ''                ! 2 #00018763' TO DFHEIV0
 19631     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19633     MOVE X'3220233030303138373633' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638
 19639* EXEC CICS READ
 19640*        DATASET     (CTBL-ID)
 19641*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19642*        RIDFLD      (ERCTBL-KEY)
 19643*    END-EXEC.
 19644*    MOVE '&"S        E          (   #00018770' TO DFHEIV0
 19645     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19647     MOVE X'2020233030303138373730' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           CTBL-ID,
 19650           DFHEIV20,
 19651           DFHEIV99,
 19652           ERCTBL-KEY,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99
 19656     SET ADDRESS OF COMM-TABLE-RECORD TO
 19657         DFHEIV20
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19662
 19663     GO TO 8300-EXIT.
 19664
 19665 8300-NOTFND.
 19666
 19667     IF CTBL-SW = '0530'
 19668         MOVE 'AA'                     TO WS-AH-COMP-CD
 19669         MOVE '0550'                   TO CTBL-SW
 19670         MOVE '1'                      TO WS-CTBL-READ-SW
 19671         GO TO 8300-EXIT.
 19672
 19673     IF CTBL-SW = '0540'
 19674         MOVE 'AA'                     TO WS-LF-COMP-CD
 19675         MOVE '0550'                   TO CTBL-SW
 19676         MOVE '1'                      TO WS-CTBL-READ-SW
 19677         GO TO 8300-EXIT.
 19678
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 363
* EL050.cbl
 19679     IF CTBL-SW = '0550'
 19680         MOVE '2'                      TO WS-CTBL-READ-SW
 19681         GO TO 8300-EXIT.
 19682
 19683     GO TO 8300-EXIT.
 19684
 19685 8300-ERRESS-PROBLEM.
 19686
 19687      MOVE ER-8050              TO WS-ERROR.
 19688      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19689
 19690     GO TO 8300-EXIT.
 19691
 19692 8300-EXIT.
 19693      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 364
* EL050.cbl
 19695
 19696
 19697 8400-GETMAIN-ERFORM.
 19698
 19699
 19700* EXEC CICS   GETMAIN
 19701*        LENGTH  (500)
 19702*        SET     (ADDRESS OF FORM-MASTER)
 19703*    END-EXEC.
 19704     MOVE 500
 19705       TO DFHEIV11
 19706*    MOVE '," L                  $   #00018814' TO DFHEIV0
 19707     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19708     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19709     MOVE X'2020233030303138383134' TO DFHEIV0(25:11)
 19710     CALL 'kxdfhei1' USING DFHEIV0,
 19711           DFHEIV20,
 19712           DFHEIV11,
 19713           DFHEIV99
 19714     SET ADDRESS OF FORM-MASTER TO
 19715         DFHEIV20
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19720
 19721 8400-EXIT.
 19722      EXIT.
 19723
 19724 8450-READ-FORM-MASTER.
 19725
 19726
 19727* EXEC CICS  HANDLE CONDITION
 19728*        NOTFND   (8450-FORM-NOT-FOUND)
 19729*        ENDFILE  (8450-FORM-NOT-FOUND)
 19730*    END-EXEC.
 19731*    MOVE '"$I''                  ! 3 #00018826' TO DFHEIV0
 19732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19734     MOVE X'3320233030303138383236' TO DFHEIV0(25:11)
 19735     CALL 'kxdfhei1' USING DFHEIV0
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19737
 19738
 19739
 19740* EXEC CICS   READ
 19741*        DATASET   (FORM-ID)
 19742*        RIDFLD    (ERFORM-KEY)
 19743*        INTO      (FORM-MASTER)
 19744*        GTEQ
 19745*    END-EXEC.
 19746     MOVE LENGTH OF
 19747      FORM-MASTER
 19748       TO DFHEIV11
 19749*    MOVE '&"IL       G          (   #00018831' TO DFHEIV0
 19750     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19752     MOVE X'2020233030303138383331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 365
* EL050.cbl
 19753     CALL 'kxdfhei1' USING DFHEIV0,
 19754           FORM-ID,
 19755           FORM-MASTER,
 19756           DFHEIV11,
 19757           ERFORM-KEY,
 19758           DFHEIV99,
 19759           DFHEIV99,
 19760           DFHEIV99
 19761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19762
 19763
 19764     MOVE  'Y'           TO  FORM-MASTER-SW.
 19765
 19766     GO TO  8450-EXIT.
 19767
 19768 8450-FORM-NOT-FOUND.
 19769
 19770     MOVE  'N'           TO  FORM-MASTER-SW.
 19771
 19772 8450-EXIT.
 19773      EXIT.
 19774
 19775 8500-DATE-CONVERT.
 19776
 19777* EXEC CICS LINK
 19778*        PROGRAM    ('ELDATCV')
 19779*        COMMAREA   (DATE-CONVERSION-DATA)
 19780*        LENGTH     (DC-COMM-LENGTH)
 19781*    END-EXEC.
 19782     MOVE 'ELDATCV' TO DFHEIV1
 19783*    MOVE '."C                   (   #00018850' TO DFHEIV0
 19784     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19786     MOVE X'2020233030303138383530' TO DFHEIV0(25:11)
 19787     CALL 'kxdfhei1' USING DFHEIV0,
 19788           DFHEIV1,
 19789           DATE-CONVERSION-DATA,
 19790           DC-COMM-LENGTH,
 19791           DFHEIV99,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99
 19795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19796
 19797
 19798 8500-EXIT.
 19799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 366
* EL050.cbl
 19801
 19802 8555-RELOAD-CONTROL-FILE.
 19803     CONTINUE.
 19804
 19805 8555-EXIT.
 19806     EXIT.
 19807
 19808 8557-GETMAIN-ERPLAN.
 19809
 19810
 19811* EXEC CICS GETMAIN
 19812*        LENGTH    (840)
 19813*        SET       (ADDRESS OF PLAN-RECORDS)
 19814*    END-EXEC.
 19815     MOVE 840
 19816       TO DFHEIV11
 19817*    MOVE '," L                  $   #00018868' TO DFHEIV0
 19818     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19819     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19820     MOVE X'2020233030303138383638' TO DFHEIV0(25:11)
 19821     CALL 'kxdfhei1' USING DFHEIV0,
 19822           DFHEIV20,
 19823           DFHEIV11,
 19824           DFHEIV99
 19825     SET ADDRESS OF PLAN-RECORDS TO
 19826         DFHEIV20
 19827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19828
 19829
 19830     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19831
 19832 8557-EXIT.
 19833     EXIT.
 19834
 19835 8560-GETMAIN.
 19836
 19837* EXEC CICS GETMAIN
 19838*        LENGTH    (2000)
 19839*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19840*    END-EXEC.
 19841     MOVE 2000
 19842       TO DFHEIV11
 19843*    MOVE '," L                  $   #00018879' TO DFHEIV0
 19844     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19846     MOVE X'2020233030303138383739' TO DFHEIV0(25:11)
 19847     CALL 'kxdfhei1' USING DFHEIV0,
 19848           DFHEIV20,
 19849           DFHEIV11,
 19850           DFHEIV99
 19851     SET ADDRESS OF ACCOUNT-MASTER TO
 19852         DFHEIV20
 19853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19854
 19855
 19856     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19857
 19858 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 367
* EL050.cbl
 19859     EXIT.
 19860
 19861 8570-START-ACCOUNT-MASTER.
 19862
 19863* EXEC CICS HANDLE CONDITION
 19864*        NOTFND    (0199-ACCT-NOT-FOUND)
 19865*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19866*    END-EXEC.
 19867*    MOVE '"$I''                  ! 4 #00018890' TO DFHEIV0
 19868     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19870     MOVE X'3420233030303138383930' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0
 19872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19873
 19874
 19875
 19876* EXEC CICS STARTBR
 19877*        DATASET    (ACCT-ID)
 19878*        RIDFLD     (ERACCT-KEY)
 19879*        GTEQ
 19880*    END-EXEC.
 19881     MOVE 0
 19882       TO DFHEIV11
 19883*    MOVE '&,         G          &   #00018895' TO DFHEIV0
 19884     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19886     MOVE X'2020233030303138383935' TO DFHEIV0(25:11)
 19887     CALL 'kxdfhei1' USING DFHEIV0,
 19888           ACCT-ID,
 19889           ERACCT-KEY,
 19890           DFHEIV99,
 19891           DFHEIV11,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896 8570-EXIT.
 19897     EXIT.
 19898
 19899 8580-READ-ACCOUNT-MASTER.
 19900
 19901* EXEC CICS HANDLE CONDITION
 19902*        NOTFND    (0199-ACCT-NOT-FOUND)
 19903*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19904*    END-EXEC.
 19905*    MOVE '"$I''                  ! 5 #00018905' TO DFHEIV0
 19906     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19908     MOVE X'3520233030303138393035' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19911
 19912
 19913
 19914* EXEC CICS READNEXT
 19915*        DATASET     (ACCT-ID)
 19916*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 368
* EL050.cbl
 19917*        RIDFLD      (ERACCT-KEY)
 19918*    END-EXEC.
 19919     MOVE LENGTH OF
 19920      ACCOUNT-MASTER
 19921       TO DFHEIV12
 19922     MOVE 0
 19923       TO DFHEIV11
 19924*    MOVE '&.IL                  )   #00018910' TO DFHEIV0
 19925     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303138393130' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           ACCT-ID,
 19930           ACCOUNT-MASTER,
 19931           DFHEIV12,
 19932           ERACCT-KEY,
 19933           DFHEIV99,
 19934           DFHEIV11,
 19935           DFHEIV99,
 19936           DFHEIV99
 19937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19938
 19939
 19940 8580-EXIT.
 19941     EXIT.
 19942
 19943 8582-READ-COMPENSATION-MASTER.
 19944
 19945* EXEC CICS HANDLE CONDITION
 19946*        NOTFND    (8582-COMP-NOT-FOUND)
 19947*        ENDFILE   (8582-COMP-NOT-FOUND)
 19948*    END-EXEC.
 19949*    MOVE '"$I''                  ! 6 #00018920' TO DFHEIV0
 19950     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19952     MOVE X'3620233030303138393230' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0
 19954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19955
 19956
 19957
 19958* EXEC CICS READ
 19959*        DATASET     (COMP-ID)
 19960*        INTO        (COMPENSATION-MASTER)
 19961*        RIDFLD      (ERCOMP-KEY)
 19962*    END-EXEC.
 19963     MOVE LENGTH OF
 19964      COMPENSATION-MASTER
 19965       TO DFHEIV11
 19966*    MOVE '&"IL       E          (   #00018925' TO DFHEIV0
 19967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19969     MOVE X'2020233030303138393235' TO DFHEIV0(25:11)
 19970     CALL 'kxdfhei1' USING DFHEIV0,
 19971           COMP-ID,
 19972           COMPENSATION-MASTER,
 19973           DFHEIV11,
 19974           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 369
* EL050.cbl
 19975           DFHEIV99,
 19976           DFHEIV99,
 19977           DFHEIV99
 19978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19979
 19980
 19981     MOVE 'Y'                    TO COMP-MASTER-SW
 19982
 19983     GO TO 8582-EXIT
 19984     .
 19985 8582-COMP-NOT-FOUND.
 19986
 19987     MOVE 'N'                    TO COMP-MASTER-SW.
 19988
 19989 8582-EXIT.
 19990     EXIT.
 19991
 19992 8583-READ-ERAGTC.
 19993
 19994* EXEC CICS HANDLE CONDITION
 19995*        NOTFND    (8583-AGTC-NOT-FOUND)
 19996*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19997*    END-EXEC.
 19998*    MOVE '"$I''                  ! 7 #00018943' TO DFHEIV0
 19999     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20001     MOVE X'3720233030303138393433' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006
 20007* EXEC CICS STARTBR
 20008*        DATASET    (AGTC-ID)
 20009*        RIDFLD     (ERAGTC-KEY)
 20010*        GTEQ
 20011*    END-EXEC.
 20012     MOVE 0
 20013       TO DFHEIV11
 20014*    MOVE '&,         G          &   #00018948' TO DFHEIV0
 20015     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20017     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 20018     CALL 'kxdfhei1' USING DFHEIV0,
 20019           AGTC-ID,
 20020           ERAGTC-KEY,
 20021           DFHEIV99,
 20022           DFHEIV11,
 20023           DFHEIV99
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20025
 20026
 20027 8583-READ-ERAGTC-NEXT.
 20028
 20029* EXEC CICS READNEXT
 20030*        DATASET     (AGTC-ID)
 20031*        INTO        (AGENT-COMMISSIONS)
 20032*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 370
* EL050.cbl
 20033*    END-EXEC.
 20034     MOVE LENGTH OF
 20035      AGENT-COMMISSIONS
 20036       TO DFHEIV12
 20037     MOVE 0
 20038       TO DFHEIV11
 20039*    MOVE '&.IL                  )   #00018955' TO DFHEIV0
 20040     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20041     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20042     MOVE X'2020233030303138393535' TO DFHEIV0(25:11)
 20043     CALL 'kxdfhei1' USING DFHEIV0,
 20044           AGTC-ID,
 20045           AGENT-COMMISSIONS,
 20046           DFHEIV12,
 20047           ERAGTC-KEY,
 20048           DFHEIV99,
 20049           DFHEIV11,
 20050           DFHEIV99,
 20051           DFHEIV99
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20056
 20057     GO TO 8583-EXIT
 20058     .
 20059 8583-AGTC-NOT-FOUND.
 20060
 20061     MOVE 'N'                    TO AGTC-MASTER-SW.
 20062
 20063 8583-EXIT.
 20064     EXIT.
 20065
 20066 8584-READ-BANK-CROSS-REF.
 20067
 20068* EXEC CICS HANDLE CONDITION
 20069*        NOTFND    (8584-BXRF-NOT-FOUND)
 20070*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20071*    END-EXEC.
 20072*    MOVE '"$I''                  ! 8 #00018973' TO DFHEIV0
 20073     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20075     MOVE X'3820233030303138393733' TO DFHEIV0(25:11)
 20076     CALL 'kxdfhei1' USING DFHEIV0
 20077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20078
 20079
 20080
 20081* EXEC CICS READ
 20082*        DATASET     (BXRF-ID)
 20083*        INTO        (BANK-CROSS-REFERENCE)
 20084*        RIDFLD      (ERBXRF-KEY)
 20085*        LENGTH      (BXRF-REC-LENGTH)
 20086*    END-EXEC.
 20087*    MOVE '&"IL       E          (   #00018978' TO DFHEIV0
 20088     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20090     MOVE X'2020233030303138393738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 371
* EL050.cbl
 20091     CALL 'kxdfhei1' USING DFHEIV0,
 20092           BXRF-ID,
 20093           BANK-CROSS-REFERENCE,
 20094           BXRF-REC-LENGTH,
 20095           ERBXRF-KEY,
 20096           DFHEIV99,
 20097           DFHEIV99,
 20098           DFHEIV99
 20099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20100
 20101
 20102     MOVE 'Y'                    TO BXRF-MASTER-SW
 20103
 20104     GO TO 8584-EXIT
 20105     .
 20106 8584-BXRF-NOT-FOUND.
 20107
 20108     MOVE 'N'                    TO BXRF-MASTER-SW.
 20109
 20110 8584-EXIT.
 20111     EXIT.
 20112
 20113 8585-READ-PLAN-MASTER.
 20114
 20115
 20116* EXEC CICS HANDLE CONDITION
 20117*        NOTFND    (8585-PLAN-NOT-FOUND)
 20118*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20119*    END-EXEC.
 20120*    MOVE '"$I''                  ! 9 #00018998' TO DFHEIV0
 20121     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20123     MOVE X'3920233030303138393938' TO DFHEIV0(25:11)
 20124     CALL 'kxdfhei1' USING DFHEIV0
 20125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20126
 20127
 20128
 20129* EXEC CICS READ
 20130*        DATASET     (PLAN-ID)
 20131*        INTO        (PLAN-MASTER)
 20132*        RIDFLD      (ERPLAN-KEY)
 20133*    END-EXEC.
 20134     MOVE LENGTH OF
 20135      PLAN-MASTER
 20136       TO DFHEIV11
 20137*    MOVE '&"IL       E          (   #00019003' TO DFHEIV0
 20138     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20140     MOVE X'2020233030303139303033' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0,
 20142           PLAN-ID,
 20143           PLAN-MASTER,
 20144           DFHEIV11,
 20145           ERPLAN-KEY,
 20146           DFHEIV99,
 20147           DFHEIV99,
 20148           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 372
* EL050.cbl
 20149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20150
 20151
 20152     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20153
 20154     GO TO 8585-EXIT.
 20155
 20156 8585-PLAN-NOT-FOUND.
 20157
 20158     MOVE 'N'                    TO PLAN-MASTER-SW.
 20159
 20160 8585-EXIT.
 20161     EXIT.
 20162
 20163 8586-READ-LOAN-OFFICER.
 20164
 20165* EXEC CICS READ
 20166*        DATASET     (LOFC-ID)
 20167*        INTO        (LOAN-OFFICER-MASTER)
 20168*        RIDFLD      (ERLOFC-KEY)
 20169*        RESP        (WS-RESPONSE)
 20170*    END-EXEC
 20171     MOVE LENGTH OF
 20172      LOAN-OFFICER-MASTER
 20173       TO DFHEIV11
 20174*    MOVE '&"IL       E          (  N#00019021' TO DFHEIV0
 20175     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20177     MOVE X'204E233030303139303231' TO DFHEIV0(25:11)
 20178     CALL 'kxdfhei1' USING DFHEIV0,
 20179           LOFC-ID,
 20180           LOAN-OFFICER-MASTER,
 20181           DFHEIV11,
 20182           ERLOFC-KEY,
 20183           DFHEIV99,
 20184           DFHEIV99,
 20185           DFHEIV99
 20186     MOVE EIBRESP  TO WS-RESPONSE
 20187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20188
 20189     IF WS-RESP-NORMAL
 20190        MOVE 'Y'                 TO LOFC-MASTER-SW
 20191     ELSE
 20192        MOVE 'N'                 TO LOFC-MASTER-SW
 20193     END-IF
 20194     .
 20195 8586-EXIT.
 20196     EXIT.
 20197 8587-START-ERPDEF.
 20198
 20199* EXEC CICS STARTBR
 20200*       DATASET   (PDEF-ID)
 20201*       RIDFLD    (ERPDEF-KEY)
 20202*       GTEQ
 20203*       RESP      (WS-RESPONSE)
 20204*    END-EXEC
 20205     MOVE 0
 20206       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 373
* EL050.cbl
 20207*    MOVE '&,         G          &  N#00019037' TO DFHEIV0
 20208     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20210     MOVE X'204E233030303139303337' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0,
 20212           PDEF-ID,
 20213           ERPDEF-KEY,
 20214           DFHEIV99,
 20215           DFHEIV11,
 20216           DFHEIV99
 20217     MOVE EIBRESP  TO WS-RESPONSE
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20219     IF WS-RESP-NORMAL
 20220        MOVE 'Y'                 TO PDEF-MASTER-SW
 20221     ELSE
 20222        MOVE 'N'                 TO PDEF-MASTER-SW
 20223     END-IF
 20224     .
 20225 8587-EXIT.
 20226     EXIT.
 20227 8588-READ-ERPDEF.
 20228
 20229* EXEC CICS READNEXT
 20230*       DATASET   (PDEF-ID)
 20231*       RIDFLD    (ERPDEF-KEY)
 20232*       INTO      (PRODUCT-MASTER)
 20233*       RESP      (WS-RESPONSE)
 20234*    END-EXEC
 20235     MOVE LENGTH OF
 20236      PRODUCT-MASTER
 20237       TO DFHEIV12
 20238     MOVE 0
 20239       TO DFHEIV11
 20240*    MOVE '&.IL                  )  N#00019052' TO DFHEIV0
 20241     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20243     MOVE X'204E233030303139303532' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           PDEF-ID,
 20246           PRODUCT-MASTER,
 20247           DFHEIV12,
 20248           ERPDEF-KEY,
 20249           DFHEIV99,
 20250           DFHEIV11,
 20251           DFHEIV99,
 20252           DFHEIV99
 20253     MOVE EIBRESP  TO WS-RESPONSE
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20255     IF WS-RESP-NORMAL
 20256        MOVE 'Y'                 TO PDEF-MASTER-SW
 20257     ELSE
 20258        MOVE 'N'                 TO PDEF-MASTER-SW
 20259     END-IF
 20260     .
 20261 8588-EXIT.
 20262     EXIT.
 20263 8589-ENDBR-ERPDEF.
 20264
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 374
* EL050.cbl
 20265* EXEC CICS ENDBR
 20266*       DATASET   (PDEF-ID)
 20267*    END-EXEC
 20268     MOVE 0
 20269       TO DFHEIV11
 20270*    MOVE '&2                    $   #00019067' TO DFHEIV0
 20271     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20273     MOVE X'2020233030303139303637' TO DFHEIV0(25:11)
 20274     CALL 'kxdfhei1' USING DFHEIV0,
 20275           PDEF-ID,
 20276           DFHEIV11,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20279     .
 20280 8589-EXIT.
 20281     EXIT.
 20282 8590-READ-CERT-MASTER.
 20283     IF PB-COMPANY-ID = 'UCL'
 20284         GO TO 8690-READ-CERT-MASTER-UCL.
 20285
 20286
 20287* EXEC CICS HANDLE CONDITION
 20288*         NOTFND    (0299-CERT-NOT-FOUND)
 20289*    END-EXEC.
 20290*    MOVE '"$I                   ! : #00019077' TO DFHEIV0
 20291     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20293     MOVE X'3A20233030303139303737' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0
 20295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20296
 20297
 20298
 20299* EXEC CICS READ
 20300*        DATASET     (CERT-ID)
 20301*        INTO        (CERTIFICATE-MASTER)
 20302*        RIDFLD      (ELCERT-KEY)
 20303*        UPDATE
 20304*    END-EXEC.
 20305     MOVE LENGTH OF
 20306      CERTIFICATE-MASTER
 20307       TO DFHEIV11
 20308*    MOVE '&"IL       EU         (   #00019081' TO DFHEIV0
 20309     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20310     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20311     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
 20312     CALL 'kxdfhei1' USING DFHEIV0,
 20313           CERT-ID,
 20314           CERTIFICATE-MASTER,
 20315           DFHEIV11,
 20316           ELCERT-KEY,
 20317           DFHEIV99,
 20318           DFHEIV99,
 20319           DFHEIV99
 20320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20321
 20322
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 375
* EL050.cbl
 20323 8590-EXIT.
 20324     EXIT.
 20325
 20326 8690-READ-CERT-MASTER-UCL.
 20327
 20328* EXEC CICS HANDLE CONDITION
 20329*         NOTFND    (8700-READ-CERT-MASTER)
 20330*    END-EXEC.
 20331*    MOVE '"$I                   ! ; #00019092' TO DFHEIV0
 20332     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20334     MOVE X'3B20233030303139303932' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0
 20336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20337
 20338
 20339 8690-READ-CERT-CONT.
 20340
 20341* EXEC CICS READ
 20342*        DATASET     (CERT-ID)
 20343*        INTO        (CERTIFICATE-MASTER)
 20344*        RIDFLD      (ELCERT-KEY)
 20345*        UPDATE
 20346*    END-EXEC.
 20347     MOVE LENGTH OF
 20348      CERTIFICATE-MASTER
 20349       TO DFHEIV11
 20350*    MOVE '&"IL       EU         (   #00019097' TO DFHEIV0
 20351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20353     MOVE X'2020233030303139303937' TO DFHEIV0(25:11)
 20354     CALL 'kxdfhei1' USING DFHEIV0,
 20355           CERT-ID,
 20356           CERTIFICATE-MASTER,
 20357           DFHEIV11,
 20358           ELCERT-KEY,
 20359           DFHEIV99,
 20360           DFHEIV99,
 20361           DFHEIV99
 20362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20363
 20364
 20365     GO TO 8590-EXIT.
 20366
 20367 8700-READ-CERT-MASTER.
 20368     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20369     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20370
 20371* EXEC CICS HANDLE CONDITION
 20372*         DUPKEY    (8720-COMP-ACCOUNTS)
 20373*         ENDFILE   (8730-END-BROWSE)
 20374*         NOTFND    (8740-NOT-FOUND)
 20375*    END-EXEC.
 20376*    MOVE '"$$''I                 ! < #00019109' TO DFHEIV0
 20377     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20379     MOVE X'3C20233030303139313039' TO DFHEIV0(25:11)
 20380     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 376
* EL050.cbl
 20381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20382
 20383
 20384
 20385* EXEC CICS STARTBR
 20386*        DATASET     ('ELCERT5')
 20387*        RIDFLD      (ELCERT2-KEY)
 20388*        EQUAL
 20389*    END-EXEC.
 20390     MOVE 'ELCERT5' TO DFHEIV1
 20391     MOVE 0
 20392       TO DFHEIV11
 20393*    MOVE '&,         E          &   #00019115' TO DFHEIV0
 20394     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20396     MOVE X'2020233030303139313135' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           DFHEIV1,
 20399           ELCERT2-KEY,
 20400           DFHEIV99,
 20401           DFHEIV11,
 20402           DFHEIV99
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406 8710-READ-NEXT.
 20407
 20408* EXEC CICS READNEXT
 20409*        DATASET     ('ELCERT5')
 20410*        INTO        (CERTIFICATE-MASTER)
 20411*        RIDFLD      (ELCERT2-KEY)
 20412*    END-EXEC.
 20413     MOVE LENGTH OF
 20414      CERTIFICATE-MASTER
 20415       TO DFHEIV12
 20416     MOVE 'ELCERT5' TO DFHEIV1
 20417     MOVE 0
 20418       TO DFHEIV11
 20419*    MOVE '&.IL                  )   #00019122' TO DFHEIV0
 20420     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20421     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20422     MOVE X'2020233030303139313232' TO DFHEIV0(25:11)
 20423     CALL 'kxdfhei1' USING DFHEIV0,
 20424           DFHEIV1,
 20425           CERTIFICATE-MASTER,
 20426           DFHEIV12,
 20427           ELCERT2-KEY,
 20428           DFHEIV99,
 20429           DFHEIV11,
 20430           DFHEIV99,
 20431           DFHEIV99
 20432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20433
 20434
 20435 8720-COMP-ACCOUNTS.
 20436
 20437* EXEC CICS ENTER
 20438*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 377
* EL050.cbl
 20439*         FROM (PB-C-LAST-NAME)
 20440*    END-EXEC.
 20441     MOVE 001
 20442       TO DFHEIV11
 20443*    MOVE ':$F                   %   #00019129' TO DFHEIV0
 20444     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303139313239' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           DFHEIV11,
 20449           PB-C-LAST-NAME,
 20450           DFHEIV99,
 20451           DFHEIV99
 20452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20453
 20454
 20455
 20456* EXEC CICS ENTER
 20457*         TRACEID (002)
 20458*         FROM (CM-INSURED-LAST-NAME)
 20459*    END-EXEC.
 20460     MOVE 002
 20461       TO DFHEIV11
 20462*    MOVE ':$F                   %   #00019134' TO DFHEIV0
 20463     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20464     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20465     MOVE X'2020233030303139313334' TO DFHEIV0(25:11)
 20466     CALL 'kxdfhei1' USING DFHEIV0,
 20467           DFHEIV11,
 20468           CM-INSURED-LAST-NAME,
 20469           DFHEIV99,
 20470           DFHEIV99
 20471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20472
 20473
 20474     IF PB-CERT-NO NOT = CM-CERT-NO
 20475         GO TO 8730-END-BROWSE.
 20476
 20477     IF PB-ACCOUNT = CM-ACCOUNT
 20478         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20479             MOVE ER-2799        TO WS-ERROR
 20480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20481             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20482             GO TO 8730-END-BROWSE.
 20483
 20484     GO TO 8710-READ-NEXT.
 20485
 20486 8730-END-BROWSE.
 20487
 20488* EXEC CICS ENDBR
 20489*         DATASET    ('ELCERT5')
 20490*    END-EXEC.
 20491     MOVE 'ELCERT5' TO DFHEIV1
 20492     MOVE 0
 20493       TO DFHEIV11
 20494*    MOVE '&2                    $   #00019152' TO DFHEIV0
 20495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 378
* EL050.cbl
 20497     MOVE X'2020233030303139313532' TO DFHEIV0(25:11)
 20498     CALL 'kxdfhei1' USING DFHEIV0,
 20499           DFHEIV1,
 20500           DFHEIV11,
 20501           DFHEIV99
 20502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20503
 20504
 20505 8740-NOT-FOUND.
 20506     GO TO 0299-CERT-NOT-FOUND.
 20507
 20508 8750-START-ELSTAT.
 20509
 20510* EXEC CICS STARTBR
 20511*       DATASET   (STAT-ID)
 20512*       RIDFLD    (ELSTAT-KEY)
 20513*       GTEQ
 20514*       RESP      (WS-RESPONSE)
 20515*    END-EXEC
 20516     MOVE 0
 20517       TO DFHEIV11
 20518*    MOVE '&,         G          &  N#00019160' TO DFHEIV0
 20519     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20520     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20521     MOVE X'204E233030303139313630' TO DFHEIV0(25:11)
 20522     CALL 'kxdfhei1' USING DFHEIV0,
 20523           STAT-ID,
 20524           ELSTAT-KEY,
 20525           DFHEIV99,
 20526           DFHEIV11,
 20527           DFHEIV99
 20528     MOVE EIBRESP  TO WS-RESPONSE
 20529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20530     IF WS-RESP-NORMAL
 20531        MOVE 'Y'                 TO STAT-MASTER-SW
 20532     ELSE
 20533        MOVE 'N'                 TO STAT-MASTER-SW
 20534     END-IF
 20535     .
 20536 8750-EXIT.
 20537     EXIT.
 20538 8752-READ-ELSTAT.
 20539
 20540* EXEC CICS READNEXT
 20541*       DATASET   (STAT-ID)
 20542*       RIDFLD    (ELSTAT-KEY)
 20543*       INTO      (STATE-FILE)
 20544*       RESP      (WS-RESPONSE)
 20545*    END-EXEC
 20546     MOVE LENGTH OF
 20547      STATE-FILE
 20548       TO DFHEIV12
 20549     MOVE 0
 20550       TO DFHEIV11
 20551*    MOVE '&.IL                  )  N#00019175' TO DFHEIV0
 20552     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20554     MOVE X'204E233030303139313735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 379
* EL050.cbl
 20555     CALL 'kxdfhei1' USING DFHEIV0,
 20556           STAT-ID,
 20557           STATE-FILE,
 20558           DFHEIV12,
 20559           ELSTAT-KEY,
 20560           DFHEIV99,
 20561           DFHEIV11,
 20562           DFHEIV99,
 20563           DFHEIV99
 20564     MOVE EIBRESP  TO WS-RESPONSE
 20565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20566     IF WS-RESP-NORMAL
 20567        MOVE 'Y'                 TO STAT-MASTER-SW
 20568     ELSE
 20569        MOVE 'N'                 TO STAT-MASTER-SW
 20570     END-IF
 20571     .
 20572 8752-EXIT.
 20573     EXIT.
 20574 8800-GET-COMP-RATE.
 20575     MOVE +1 TO IB.
 20576     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20577         ADD +9 TO IB
 20578         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20579             ADD +9 TO IB
 20580             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20581                MOVE ZEROS       TO WS-WK-RATE
 20582                GO TO 8800-EXIT.
 20583
 20584     IF PB-I-AGE GREATER CT-AGE (1)
 20585         ADD +3 TO IB
 20586         IF PB-I-AGE GREATER CT-AGE (2)
 20587             ADD +3 TO IB
 20588             IF PB-I-AGE GREATER CT-AGE (3)
 20589                MOVE ZEROS       TO WS-WK-RATE
 20590                GO TO 8800-EXIT.
 20591
 20592     IF WS-WORK-TERM GREATER CT-TRM (1)
 20593         ADD +1 TO IB
 20594         IF WS-WORK-TERM GREATER CT-TRM (2)
 20595             ADD +1 TO IB
 20596             IF WS-WORK-TERM GREATER CT-TRM (3)
 20597                MOVE ZEROS       TO WS-WK-RATE
 20598                GO TO 8800-EXIT.
 20599
 20600     IF CT-RT (IB) NOT NUMERIC
 20601         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20602         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20603         GO TO 8800-GET-COMP-RATE.
 20604
 20605     MOVE CT-RT (IB) TO WS-WK-RATE.
 20606
 20607 8800-EXIT.
 20608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 380
* EL050.cbl
 20610 8900-ADDRESS-FILE.
 20611     IF ERACCT-FILE-ADDRESSED
 20612         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20613         GO TO 8900-ADDRESS-EXIT.
 20614
 20615     IF ELCNTL-FILE-ADDRESSED
 20616         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20617         GO TO 8900-ADDRESS-EXIT.
 20618
 20619     IF ERPLAN-FILE-ADDRESSED
 20620         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20621         GO TO 8900-ADDRESS-EXIT.
 20622
 20623     IF ERFORM-FILE-ADDRESSED
 20624         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20625         GO TO 8900-ADDRESS-EXIT.
 20626
 20627 8900-ADDRESS-EXIT.
 20628     EXIT.
 20629
 20630 9000-READ-CONTROL.
 20631
 20632* EXEC CICS HANDLE CONDITION
 20633*        NOTFND    (9000-NOTFND)
 20634*    END-EXEC.
 20635*    MOVE '"$I                   ! = #00019246' TO DFHEIV0
 20636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20638     MOVE X'3D20233030303139323436' TO DFHEIV0(25:11)
 20639     CALL 'kxdfhei1' USING DFHEIV0
 20640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20641
 20642
 20643
 20644* EXEC CICS READ
 20645*        DATASET     (CNTL-ID)
 20646*        SET         (ADDRESS OF CONTROL-FILE)
 20647*        RIDFLD      (ELCNTL-KEY)
 20648*        GTEQ
 20649*    END-EXEC.
 20650*    MOVE '&"S        G          (   #00019250' TO DFHEIV0
 20651     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20653     MOVE X'2020233030303139323530' TO DFHEIV0(25:11)
 20654     CALL 'kxdfhei1' USING DFHEIV0,
 20655           CNTL-ID,
 20656           DFHEIV20,
 20657           DFHEIV99,
 20658           ELCNTL-KEY,
 20659           DFHEIV99,
 20660           DFHEIV99,
 20661           DFHEIV99
 20662     SET ADDRESS OF CONTROL-FILE TO
 20663         DFHEIV20
 20664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20665
 20666
 20667     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 381
* EL050.cbl
 20668
 20669 9000-NOTFND.
 20670     IF RC-SW-1 = '1'
 20671        MOVE ER-2616              TO WS-ERROR
 20672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20673        GO TO 9000-EXIT.
 20674
 20675     IF RC-SW-1 = '2'
 20676        MOVE ER-2602              TO WS-ERROR
 20677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20678
 20679 9000-EXIT.
 20680      EXIT.
 20681
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 382
* EL050.cbl
 20683 9100-READ-CONTROL.
 20684
 20685* EXEC CICS HANDLE CONDITION
 20686*        NOTFND  (9100-NOTFND)
 20687*        ENDFILE (9100-NOTFND)
 20688*    END-EXEC.
 20689*    MOVE '"$I''                  ! > #00019274' TO DFHEIV0
 20690     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20692     MOVE X'3E20233030303139323734' TO DFHEIV0(25:11)
 20693     CALL 'kxdfhei1' USING DFHEIV0
 20694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20695
 20696
 20697
 20698* EXEC CICS READ
 20699*        DATASET     (CNTL-ID)
 20700*        INTO        (CONTROL-FILE)
 20701*        RIDFLD      (ELCNTL-KEY)
 20702*        GTEQ
 20703*    END-EXEC.
 20704     MOVE LENGTH OF
 20705      CONTROL-FILE
 20706       TO DFHEIV11
 20707*    MOVE '&"IL       G          (   #00019279' TO DFHEIV0
 20708     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20710     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 20711     CALL 'kxdfhei1' USING DFHEIV0,
 20712           CNTL-ID,
 20713           CONTROL-FILE,
 20714           DFHEIV11,
 20715           ELCNTL-KEY,
 20716           DFHEIV99,
 20717           DFHEIV99,
 20718           DFHEIV99
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722     GO TO 9100-EXIT.
 20723
 20724 9100-NOTFND.
 20725     IF RC-SW-2 = '0'
 20726        MOVE '1'                  TO STATE-RECORD-ERROR
 20727        GO TO 9100-EXIT
 20728     END-IF
 20729     IF RC-SW-2 = '1'
 20730        MOVE '1'                  TO LF-BENEFIT-ERROR
 20731        MOVE ER-2604              TO WS-ERROR
 20732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20733        GO TO 9100-EXIT.
 20734
 20735     IF RC-SW-2 = '2'
 20736        MOVE '1'                  TO AH-BENEFIT-ERROR
 20737        MOVE ER-2605              TO WS-ERROR
 20738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20739        GO TO 9100-EXIT.
 20740
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 383
* EL050.cbl
 20741     IF RC-SW-2 = '3'
 20742         MOVE ER-2603           TO WS-ERROR
 20743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20744         GO TO 9100-EXIT.
 20745
 20746     IF RC-SW-2 = '4'
 20747         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20748         GO TO 9100-EXIT.
 20749
 20750     IF RC-SW-2 = '5'
 20751         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20752         IF WS-AH-INPUT-CD-1 = SPACE
 20753             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20754         ELSE
 20755             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20756
 20757 9100-EXIT.
 20758      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 384
* EL050.cbl
 20760 9200-CONTROL-GETMAIN.
 20761
 20762* EXEC CICS GETMAIN
 20763*         LENGTH   (750)
 20764*         SET      (ADDRESS OF CONTROL-FILE)
 20765*    END-EXEC.
 20766     MOVE 750
 20767       TO DFHEIV11
 20768*    MOVE '," L                  $   #00019325' TO DFHEIV0
 20769     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20771     MOVE X'2020233030303139333235' TO DFHEIV0(25:11)
 20772     CALL 'kxdfhei1' USING DFHEIV0,
 20773           DFHEIV20,
 20774           DFHEIV11,
 20775           DFHEIV99
 20776     SET ADDRESS OF CONTROL-FILE TO
 20777         DFHEIV20
 20778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20779
 20780
 20781     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20782
 20783 9200-EXIT.
 20784     EXIT.
 20785
 20786 9250-UNLOCK-RETURN.
 20787
 20788* EXEC CICS UNLOCK
 20789*        DATASET   (CERT-ID)
 20790*    END-EXEC.
 20791*    MOVE '&*                    #   #00019336' TO DFHEIV0
 20792     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20794     MOVE X'2020233030303139333336' TO DFHEIV0(25:11)
 20795     CALL 'kxdfhei1' USING DFHEIV0,
 20796           CERT-ID,
 20797           DFHEIV99
 20798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20799
 20800
 20801 9300-ABEND.
 20802     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20803
 20804
 20805* EXEC CICS LINK
 20806*        PROGRAM   ('EL004')
 20807*        COMMAREA  (WS-ERROR-LINE)
 20808*        LENGTH    (72)
 20809*    END-EXEC.
 20810     MOVE 'EL004' TO DFHEIV1
 20811     MOVE 72
 20812       TO DFHEIV11
 20813*    MOVE '."C                   (   #00019343' TO DFHEIV0
 20814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20816     MOVE X'2020233030303139333433' TO DFHEIV0(25:11)
 20817     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 385
* EL050.cbl
 20818           DFHEIV1,
 20819           WS-ERROR-LINE,
 20820           DFHEIV11,
 20821           DFHEIV99,
 20822           DFHEIV99,
 20823           DFHEIV99,
 20824           DFHEIV99
 20825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20826
 20827
 20828     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20829
 20830
 20831* EXEC CICS ABEND
 20832*        ABCODE ('EL50')
 20833*    END-EXEC.
 20834     MOVE 'EL50' TO DFHEIV5
 20835*    MOVE '.,A                   "   #00019351' TO DFHEIV0
 20836     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20837     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20838     MOVE X'2020233030303139333531' TO DFHEIV0(25:11)
 20839     CALL 'kxdfhei1' USING DFHEIV0,
 20840           DFHEIV5
 20841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20842
 20843
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 386
* EL050.cbl
 20845
 20846******************************************************************
 20847*                                                                *
 20848*            E R R O R   F O R M A T   R O U T I N E             *
 20849*                                                                *
 20850******************************************************************
 20851
 20852 9900-ERROR-FORMAT.
 20853
 20854     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20855                    PB-COMMON-ERROR (2) OR
 20856                    PB-COMMON-ERROR (3) OR
 20857                    PB-COMMON-ERROR (4) OR
 20858                    PB-COMMON-ERROR (5) OR
 20859                    PB-COMMON-ERROR (6) OR
 20860                    PB-COMMON-ERROR (7) OR
 20861                    PB-COMMON-ERROR (8) OR
 20862                    PB-COMMON-ERROR (9) OR
 20863                    PB-COMMON-ERROR (10)
 20864        GO TO 9900-EXIT.
 20865
 20866     IF PB-NO-OF-ERRORS = +10
 20867        GO TO 9900-EXIT.
 20868
 20869     ADD +1  TO PB-NO-OF-ERRORS.
 20870     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20871                                       (PB-NO-OF-ERRORS).
 20872 9900-EXIT.
 20873     EXIT.
 20874
 20875 9990-RETURN.
 20876     IF BROWSE-STARTED
 20877
 20878* EXEC CICS ENDBR
 20879*            DATASET  (ACCT-ID)
 20880*       END-EXEC.
 20881     MOVE 0
 20882       TO DFHEIV11
 20883*    MOVE '&2                    $   #00019388' TO DFHEIV0
 20884     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20885     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20886     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 20887     CALL 'kxdfhei1' USING DFHEIV0,
 20888           ACCT-ID,
 20889           DFHEIV11,
 20890           DFHEIV99
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894 9990-EXIT.
 20895     EXIT.
 20896
 20897
 20898****Check for CRTO record, add one if not found.
 20899 9991-CHECK-FOR-ELCRTO.
 20900
 20901* EXEC CICS HANDLE CONDITION
 20902*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 387
* EL050.cbl
 20903*         ENDFILE (9991-CRTO-NOT-FOUND)
 20904*     END-EXEC.
 20905*    MOVE '"$I''                  ! ? #00019398' TO DFHEIV0
 20906     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20908     MOVE X'3F20233030303139333938' TO DFHEIV0(25:11)
 20909     CALL 'kxdfhei1' USING DFHEIV0
 20910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20911
 20912     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 20913     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 20914     MOVE +0                     TO ELCRTO-SEQ-NO
 20915
 20916
 20917* EXEC CICS READ
 20918*       DATASET   ('ELCRTO')
 20919*       INTO      (ORIGINAL-CERTIFICATE)
 20920*       RIDFLD    (ELCRTO-KEY)
 20921*       GTEQ
 20922*       RESP      (WS-RESPONSE)
 20923*    END-EXEC
 20924     MOVE LENGTH OF
 20925      ORIGINAL-CERTIFICATE
 20926       TO DFHEIV11
 20927     MOVE 'ELCRTO' TO DFHEIV1
 20928*    MOVE '&"IL       G          (  N#00019406' TO DFHEIV0
 20929     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20931     MOVE X'204E233030303139343036' TO DFHEIV0(25:11)
 20932     CALL 'kxdfhei1' USING DFHEIV0,
 20933           DFHEIV1,
 20934           ORIGINAL-CERTIFICATE,
 20935           DFHEIV11,
 20936           ELCRTO-KEY,
 20937           DFHEIV99,
 20938           DFHEIV99,
 20939           DFHEIV99
 20940     MOVE EIBRESP  TO WS-RESPONSE
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20942
 20943     IF WS-RESP-NORMAL
 20944        AND (OC-CONTROL-PRIMARY (1:33) =
 20945                 PB-CONTROL-BY-ACCOUNT (1:33))
 20946        AND (OC-RECORD-TYPE =  'I')
 20947           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 20948               GO TO 9991-EXIT
 20949           ELSE
 20950               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 20951               GO TO 9991-CRTO-ADD-REC
 20952           END-IF
 20953     END-IF.
 20954
 20955 9991-CRTO-NOT-FOUND.
 20956
 20957     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 20958     MOVE 'OC'                TO OC-RECORD-ID
 20959     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 20960                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 388
* EL050.cbl
 20961     MOVE +4096               TO OC-KEY-SEQ-NO.
 20962
 20963 9991-CRTO-ADD-REC.
 20964
 20965     MOVE 'E050'              TO OC-LAST-MAINT-BY
 20966     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 20967     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 20968     MOVE 'I'                 TO OC-RECORD-TYPE
 20969     IF PB-ISSUE
 20970         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 20971         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 20972         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 20973         MOVE PB-I-AGE               TO OC-INS-AGE
 20974         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 20975         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 20976         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 20977         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 20978         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 20979         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 20980         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 20981         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 20982         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 20983         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 20984         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 20985         IF PB-I-JOINT-COMMISSION > +0
 20986             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 20987         ELSE
 20988             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 20989         END-IF
 20990         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 20991         MOVE +0                     TO OC-LF-CANCEL-AMT
 20992                                        OC-LF-ITD-CANCEL-AMT
 20993         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 20994         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 20995         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 20996         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 20997         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 20998         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 20999         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21000         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21001         MOVE +0                     TO OC-AH-CANCEL-AMT
 21002                                        OC-AH-ITD-CANCEL-AMT
 21003         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21004     ELSE
 21005         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21006         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21007         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21008         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21009         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21010         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21011         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21012         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21013         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21014          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21015             MOVE SPACES             TO OC-LF-BENCD
 21016             MOVE ZEROS              TO OC-LF-TERM
 21017                                        OC-LF-BEN-AMT
 21018                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 389
* EL050.cbl
 21019                                        OC-LF-ALT-BEN-AMT
 21020                                        OC-LF-ALT-PRM-AMT
 21021                                        OC-LF-COMM-PCT
 21022                                        OC-LF-CANCEL-AMT
 21023             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21024             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21025         ELSE
 21026             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21027             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21028             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21029             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21030             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21031             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21032             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21033             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21034             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21035             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21036         END-IF
 21037         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21038         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21039          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21040             MOVE SPACES             TO OC-AH-BENCD
 21041             MOVE ZEROS              TO OC-AH-TERM
 21042                                        OC-AH-BEN-AMT
 21043                                        OC-AH-PRM-AMT
 21044                                        OC-AH-COMM-PCT
 21045                                        OC-AH-CANCEL-AMT
 21046                                        OC-AH-CP
 21047             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21048             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21049         ELSE
 21050             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21051             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21052             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21053             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21054             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21055             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21056             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21057             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21058             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21059         END-IF
 21060         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21061         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21062     END-IF
 21063     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21064
 21065     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21066
 21067
 21068* EXEC CICS READ
 21069*         DATASET   (FILE-ERMAIL)
 21070*         RIDFLD    (MA-CONTROL-PRIMARY)
 21071*         INTO      (MAILING-DATA)
 21072*         RESP      (WS-RESPONSE)
 21073*    END-EXEC
 21074     MOVE LENGTH OF
 21075      MAILING-DATA
 21076       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 390
* EL050.cbl
 21077*    MOVE '&"IL       E          (  N#00019538' TO DFHEIV0
 21078     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21080     MOVE X'204E233030303139353338' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0,
 21082           FILE-ERMAIL,
 21083           MAILING-DATA,
 21084           DFHEIV11,
 21085           MA-CONTROL-PRIMARY,
 21086           DFHEIV99,
 21087           DFHEIV99,
 21088           DFHEIV99
 21089     MOVE EIBRESP  TO WS-RESPONSE
 21090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21091
 21092     IF WS-RESP-NORMAL
 21093         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21094     END-IF.
 21095
 21096
 21097* EXEC CICS WRITE
 21098*       DATASET   ('ELCRTO')
 21099*       FROM      (ORIGINAL-CERTIFICATE)
 21100*       RIDFLD    (OC-CONTROL-PRIMARY)
 21101*       RESP      (WS-RESPONSE)
 21102*    END-EXEC.
 21103     MOVE LENGTH OF
 21104      ORIGINAL-CERTIFICATE
 21105       TO DFHEIV11
 21106     MOVE 'ELCRTO' TO DFHEIV1
 21107*    MOVE '&$ L                  ''  N#00019549' TO DFHEIV0
 21108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21110     MOVE X'204E233030303139353439' TO DFHEIV0(25:11)
 21111     CALL 'kxdfhei1' USING DFHEIV0,
 21112           DFHEIV1,
 21113           ORIGINAL-CERTIFICATE,
 21114           DFHEIV11,
 21115           OC-CONTROL-PRIMARY,
 21116           DFHEIV99,
 21117           DFHEIV99
 21118     MOVE EIBRESP  TO WS-RESPONSE
 21119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21120
 21121
 21122 9991-EXIT.
 21123     EXIT.
 21124
 21125
 21126 9999-RETURN.
 21127     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21128
 21129
 21130* EXEC CICS RETURN
 21131*    END-EXEC.
 21132*    MOVE '.(                    ''   #00019563' TO DFHEIV0
 21133     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 391
* EL050.cbl
 21135     MOVE X'2020233030303139353633' TO DFHEIV0(25:11)
 21136     CALL 'kxdfhei1' USING DFHEIV0,
 21137           DFHEIV99,
 21138           DFHEIV99,
 21139           DFHEIV99,
 21140           DFHEIV99,
 21141           DFHEIV99,
 21142           DFHEIV99
 21143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21144
 21145
 21146
 21147* GOBACK.
 21148     MOVE '9%                    "   ' TO DFHEIV0
 21149     MOVE 'EL050' TO DFHEIV1
 21150     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21151     GOBACK.
 21152
 21153 9999-DFHBACK SECTION.
 21154     MOVE '9%                    "   ' TO DFHEIV0
 21155     MOVE 'EL050' TO DFHEIV1
 21156     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21157     GOBACK.
 21158 9999-DFHEXIT.
 21159     IF DFHEIGDJ EQUAL 0001
 21160         NEXT SENTENCE
 21161     ELSE IF DFHEIGDJ EQUAL 2
 21162         GO TO 9300-ABEND,
 21163               3990-FILES-NOT-OPEN
 21164         DEPENDING ON DFHEIGDI
 21165     ELSE IF DFHEIGDJ EQUAL 3
 21166         GO TO 6610-START-BROWSE,
 21167               6630-ERRESS-PROBLEM,
 21168               6630-END-OF-FILE
 21169         DEPENDING ON DFHEIGDI
 21170     ELSE IF DFHEIGDJ EQUAL 4
 21171         GO TO 6630-END-OF-FILE,
 21172               6630-ERRESS-PROBLEM,
 21173               6630-ERRESS-PROBLEM,
 21174               6630-END-OF-FILE
 21175         DEPENDING ON DFHEIGDI
 21176     ELSE IF DFHEIGDJ EQUAL 5
 21177         GO TO 6630-END-OF-FILE,
 21178               6630-END-OF-FILE,
 21179               6630-ERRESS-PROBLEM,
 21180               6630-ERRESS-PROBLEM
 21181         DEPENDING ON DFHEIGDI
 21182     ELSE IF DFHEIGDJ EQUAL 6
 21183         GO TO 6660-START-BROWSE,
 21184               6690-ERRESC-PROBLEM,
 21185               6690-ERRESC-PROBLEM,
 21186               6690-END-OF-FILE
 21187         DEPENDING ON DFHEIGDI
 21188     ELSE IF DFHEIGDJ EQUAL 7
 21189         GO TO 6690-END-OF-FILE,
 21190               6690-ERRESC-PROBLEM,
 21191               6690-ERRESC-PROBLEM,
 21192               6690-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 392
* EL050.cbl
 21193         DEPENDING ON DFHEIGDI
 21194     ELSE IF DFHEIGDJ EQUAL 8
 21195         GO TO 6690-END-OF-FILE,
 21196               6690-ERRESC-PROBLEM,
 21197               6690-ERRESC-PROBLEM,
 21198               6690-END-OF-FILE
 21199         DEPENDING ON DFHEIGDI
 21200     ELSE IF DFHEIGDJ EQUAL 9
 21201         GO TO 7250-CONTINUE,
 21202               7250-CONTINUE
 21203         DEPENDING ON DFHEIGDI
 21204     ELSE IF DFHEIGDJ EQUAL 10
 21205         GO TO 7300-CONTINUE,
 21206               7300-CONTINUE
 21207         DEPENDING ON DFHEIGDI
 21208     ELSE IF DFHEIGDJ EQUAL 11
 21209         GO TO 8000-FREE-MAIN
 21210         DEPENDING ON DFHEIGDI
 21211     ELSE IF DFHEIGDJ EQUAL 12
 21212         GO TO 8100-NOTFND,
 21213               8100-NOTFND
 21214         DEPENDING ON DFHEIGDI
 21215     ELSE IF DFHEIGDJ EQUAL 13
 21216         GO TO 8110-NOTFND,
 21217               8110-NOTFND
 21218         DEPENDING ON DFHEIGDI
 21219     ELSE IF DFHEIGDJ EQUAL 14
 21220         GO TO 8130-EXIT
 21221         DEPENDING ON DFHEIGDI
 21222     ELSE IF DFHEIGDJ EQUAL 15
 21223         GO TO 8180-NOTFND
 21224         DEPENDING ON DFHEIGDI
 21225     ELSE IF DFHEIGDJ EQUAL 16
 21226         GO TO 8190-NOTFND
 21227         DEPENDING ON DFHEIGDI
 21228     ELSE IF DFHEIGDJ EQUAL 17
 21229         GO TO 8200-NOTFND
 21230         DEPENDING ON DFHEIGDI
 21231     ELSE IF DFHEIGDJ EQUAL 18
 21232         GO TO 8300-NOTFND,
 21233               8300-ERRESS-PROBLEM,
 21234               8300-ERRESS-PROBLEM,
 21235               8300-NOTFND
 21236         DEPENDING ON DFHEIGDI
 21237     ELSE IF DFHEIGDJ EQUAL 19
 21238         GO TO 8450-FORM-NOT-FOUND,
 21239               8450-FORM-NOT-FOUND
 21240         DEPENDING ON DFHEIGDI
 21241     ELSE IF DFHEIGDJ EQUAL 20
 21242         GO TO 0199-ACCT-NOT-FOUND,
 21243               0199-ACCT-NOT-FOUND
 21244         DEPENDING ON DFHEIGDI
 21245     ELSE IF DFHEIGDJ EQUAL 21
 21246         GO TO 0199-ACCT-NOT-FOUND,
 21247               0199-ACCT-NOT-FOUND
 21248         DEPENDING ON DFHEIGDI
 21249     ELSE IF DFHEIGDJ EQUAL 22
 21250         GO TO 8582-COMP-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-13 13:37 Page 393
* EL050.cbl
 21251               8582-COMP-NOT-FOUND
 21252         DEPENDING ON DFHEIGDI
 21253     ELSE IF DFHEIGDJ EQUAL 23
 21254         GO TO 8583-AGTC-NOT-FOUND,
 21255               8583-AGTC-NOT-FOUND
 21256         DEPENDING ON DFHEIGDI
 21257     ELSE IF DFHEIGDJ EQUAL 24
 21258         GO TO 8584-BXRF-NOT-FOUND,
 21259               8584-BXRF-NOT-FOUND
 21260         DEPENDING ON DFHEIGDI
 21261     ELSE IF DFHEIGDJ EQUAL 25
 21262         GO TO 8585-PLAN-NOT-FOUND,
 21263               8585-PLAN-NOT-FOUND
 21264         DEPENDING ON DFHEIGDI
 21265     ELSE IF DFHEIGDJ EQUAL 26
 21266         GO TO 0299-CERT-NOT-FOUND
 21267         DEPENDING ON DFHEIGDI
 21268     ELSE IF DFHEIGDJ EQUAL 27
 21269         GO TO 8700-READ-CERT-MASTER
 21270         DEPENDING ON DFHEIGDI
 21271     ELSE IF DFHEIGDJ EQUAL 28
 21272         GO TO 8720-COMP-ACCOUNTS,
 21273               8730-END-BROWSE,
 21274               8740-NOT-FOUND
 21275         DEPENDING ON DFHEIGDI
 21276     ELSE IF DFHEIGDJ EQUAL 29
 21277         GO TO 9000-NOTFND
 21278         DEPENDING ON DFHEIGDI
 21279     ELSE IF DFHEIGDJ EQUAL 30
 21280         GO TO 9100-NOTFND,
 21281               9100-NOTFND
 21282         DEPENDING ON DFHEIGDI
 21283     ELSE IF DFHEIGDJ EQUAL 31
 21284         GO TO 9991-CRTO-NOT-FOUND,
 21285               9991-CRTO-NOT-FOUND
 21286         DEPENDING ON DFHEIGDI.
 21287     MOVE '9%                    "   ' TO DFHEIV0
 21288     MOVE 'EL050' TO DFHEIV1
 21289     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21290     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39984     Code:       85503
