* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    61******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   3
* EL1278.cbl
    63 ENVIRONMENT DIVISION.
    64 DATA DIVISION.
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  FILLER  PIC  X(32) VALUE '********************************'.
    68 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    69 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    70 77  S1                          PIC S999 COMP-3 VALUE +0.
    71 77  P1                          PIC S999 COMP-3 VALUE +0.
    72 77  P2                          PIC S999 COMP-3 VALUE +0.
    73 77  C0                          PIC S999 COMP-3 VALUE +0.
    74 77  C1                          PIC S999 COMP-3 VALUE +0.
    75 77  C2                          PIC S999 COMP-3 VALUE +0.
    76 77  C3                          PIC S999 COMP-3 VALUE +0.
    77 77  WS-STOP-SW                  PIC X  VALUE ' '.
    78     88  I-SAY-TO-STOP      VALUE 'Y'.
    79 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    80     88  OPEN-LF-CLAIM              VALUE 'Y'.
    81 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    82     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    83 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    84     88  OPEN-AH-CLAIM              VALUE 'Y'.
    85 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    86     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    87 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    88     88  FOUND-A-CLAIM              VALUE 'Y'.
    89 77  WS-ST-REF-IND               PIC X.
    90 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    91 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    92 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    93 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    94 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    95 77  DD-IU-SW                    PIC X   VALUE ' '.
    96     88  DD-IU-PRESENT                 VALUE 'Y'.
    97 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   100 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   101 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   102 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   103 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   104 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   105 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   106     88  NO-CERT-RW                 VALUE 'N'.
   107     88  CERT-RW                    VALUE 'Y'.
   108 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   109     88  ERMAIL-FOUND                 VALUE 'Y'.
   110 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   111
   112*                            COPY ELCSCTM.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCTM                             *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   120*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   4
* EL1278.cbl
   121******************************************************************
   122 01  SECURITY-MESSAGE.
   123     12  FILLER                          PIC X(30)
   124            VALUE '** LOGIC SECURITY VIOLATION -'.
   125     12  SM-READ                         PIC X(6).
   126     12  FILLER                          PIC X(5)
   127            VALUE ' PGM='.
   128     12  SM-PGM                          PIC X(6).
   129     12  FILLER                          PIC X(5)
   130            VALUE ' OPR='.
   131     12  SM-PROCESSOR-ID                 PIC X(4).
   132     12  FILLER                          PIC X(6)
   133            VALUE ' TERM='.
   134     12  SM-TERMID                       PIC X(4).
   135     12  FILLER                          PIC XX   VALUE SPACE.
   136     12  SM-JUL-DATE                     PIC 9(5).
   137     12  FILLER                          PIC X    VALUE SPACE.
   138     12  SM-TIME                         PIC 99.99.
   139
   140
   141*                            COPY ELCSCRTY.
   142******************************************************************
   143*                                                                *
   144*                                                                *
   145*                            ELCSCRTY                            *
   146*                            VMOD=2.001                          *
   147*                                                                *
   148*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   149*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   150*        SAVED IN PI-SECURITY-ADDRESS.                           *
   151*                                                                *
   152******************************************************************
   153 01  SECURITY-CONTROL.
   154     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   155     12  FILLER                       PIC XX    VALUE 'SC'.
   156     12  SC-CREDIT-CODES.
   157         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   158             20  SC-CREDIT-DISPLAY    PIC X.
   159             20  SC-CREDIT-UPDATE     PIC X.
   160     12  SC-CLAIMS-CODES.
   161         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   162             20  SC-CLAIMS-DISPLAY    PIC X.
   163             20  SC-CLAIMS-UPDATE     PIC X.
   164
   165 01  FILLER          COMP-3.
   166     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   167     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   168     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   169     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   170     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   171     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   172     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   173     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   174     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   175
   176 01  WS-DATE-AREA.
   177     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   178     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   5
* EL1278.cbl
   179     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   180     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   181     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   182     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   183
   184 01  ERPDEF-KEY-SAVE             PIC X(18).
   185 01  ERPDEF-KEY.
   186     12  ERPDEF-COMPANY-CD       PIC X.
   187     12  ERPDEF-STATE            PIC XX.
   188     12  ERPDEF-PROD-CD          PIC XXX.
   189     12  F                       PIC X(7).
   190     12  ERPDEF-BEN-TYPE         PIC X.
   191     12  ERPDEF-BEN-CODE         PIC XX.
   192     12  ERPDEF-EXP-DT           PIC XX.
   193 01  ELMSTR-KEY.
   194     12  ELMSTR-COMP-CD          PIC X.
   195     12  ELMSTR-CERT-NO          PIC X(11).
   196 01  ELCRTT-KEY.
   197     12  ELCRTT-PRIMARY          PIC X(33).
   198     12  ELCRTT-REC-TYPE         PIC X(1).
   199
   200 01  ELCRTO-KEY.
   201     05  ELCRTO-COMPANY-CD       PIC X.
   202     05  ELCRTO-CARRIER          PIC X.
   203     05  ELCRTO-GROUPING         PIC X(6).
   204     05  ELCRTO-STATE            PIC XX.
   205     05  ELCRTO-ACCOUNT          PIC X(10).
   206     05  ELCRTO-CERT-EFF-DT      PIC XX.
   207     05  ELCRTO-CERT-NO.
   208         10  ELCRTO-CERT-PRIME   PIC X(10).
   209         10  ELCRTO-CERT-SFX     PIC X.
   210     05  ELCRTO-RECORD-TYPE      PIC X.
   211     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   212
   213 01  STANDARD-AREAS.
   214     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   215     12  SUB3                    PIC S9(04) COMP VALUE +0.
   216     12  SUB4                    PIC S9(04) COMP VALUE +0.
   217     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   218     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   219     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   220     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   221     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   222     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   223     12  PGM-NAME                PIC  X(08).
   224     12  TIME-IN                 PIC S9(07).
   225     12  TIME-OUT-R  REDEFINES  TIME-IN.
   226         16  FILLER              PIC  X(01).
   227         16  TIME-OUT            PIC  9(02)V99.
   228         16  FILLER              PIC  X(02).
   229     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   230     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   231     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   232     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   233     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   234     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   235     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   236     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   6
* EL1278.cbl
   237     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   238     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   239     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   240     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   241     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   242     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   243     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   244     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   245     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   246     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   247         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   248     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   249         88  BROWSE-STARTED                      VALUE 'Y'.
   250     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   251         88  FORM-FOUND                          VALUE 'Y'.
   252     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   253         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   254     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   255         88  WS-REDUCING                         VALUE 'R'.
   256         88  WS-LEVEL                            VALUE 'L'  'P'.
   257     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   258         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   259     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   260         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   261     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   262     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   263         'CLAIM PMTS'.
   264     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   265         'ITD REFUND'.
   266     12  WS-ACCESS.
   267         16  FILLER              PIC  X(02).
   268         16  WS-BEN-CD           PIC  X(02).
   269     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   270     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   271     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   272     12  WS-LOOKUP-TYPE          PIC  X(01).
   273     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   274     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   275     12  WS-CALC-CD              PIC  X(01).
   276     12  DEEDIT-FIELD            PIC  X(15).
   277     12  DEEDIT-FIELD-V0  REDEFINES
   278         DEEDIT-FIELD            PIC S9(15).
   279     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   280     12  RETURN-FROM             PIC  X(08).
   281     12  QID.
   282         16  QID-TERM            PIC  X(04).
   283         16  FILLER              PIC  X(04)      VALUE '127H'.
   284     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   285         88  FIRST-ENTRY                         VALUE 'Y'.
   286     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   287         88  PDEF-FOUND                          VALUE 'Y'.
   288     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   289         88  CERT-FOUND                          VALUE 'Y'.
   290         88  CERT-NOT-FOUND                      VALUE 'N'.
   291     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   292         88  CNTL-FOUND                          VALUE 'Y'.
   293         88  CNTL-NOT-FOUND                      VALUE 'N'.
   294     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   7
* EL1278.cbl
   295         88  BEN-FOUND                           VALUE 'Y'.
   296     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   297         88  STATE-FOUND                         VALUE 'Y'.
   298     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   299         88  ST-BEN-FOUND                        VALUE 'Y'.
   300     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   301         88  ACCT-FOUND                          VALUE 'Y'.
   302     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   303         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   304     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   305                                                 VALUE ZERO.
   306         88  BENEFIT-FOUND                       VALUE +1.
   307     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   308                                                 VALUE ZERO.
   309     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   310                                                 VALUE ZERO.
   311     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   312     12  WS-SUB1                 PIC S99    COMP.
   313     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   314     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   315     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   316     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   317     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   318     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   319     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   320     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   321     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   322     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   323     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   324     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   325     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   326     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   327     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   328     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   329     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   330     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   331     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   332     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   333     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   334     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   335     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   336     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   337     12  ERROR-MESSAGES.
   338         16  ER-0000             PIC  X(04)      VALUE '0000'.
   339         16  ER-0004             PIC  X(04)      VALUE '0004'.
   340         16  ER-0008             PIC  X(04)      VALUE '0008'.
   341         16  ER-0028             PIC  X(04)      VALUE '0028'.
   342         16  ER-0029             PIC  X(04)      VALUE '0029'.
   343         16  ER-0070             PIC  X(04)      VALUE '0070'.
   344         16  ER-0142             PIC  X(04)      VALUE '0142'.
   345         16  ER-0214             PIC  X(04)      VALUE '0214'.
   346         16  ER-0681             PIC  X(04)      VALUE '0681'.
   347         16  ER-0682             PIC  X(04)      VALUE '0682'.
   348         16  ER-0683             PIC  X(04)      VALUE '0683'.
   349         16  ER-0684             PIC  X(04)      VALUE '0684'.
   350         16  ER-2227             PIC  X(04)      VALUE '2227'.
   351         16  ER-2601             PIC  X(04)      VALUE '2601'.
   352         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   8
* EL1278.cbl
   353         16  ER-2617             PIC  X(04)      VALUE '2617'.
   354         16  ER-2619             PIC  X(04)      VALUE '2619'.
   355         16  ER-2740             PIC  X(04)      VALUE '2740'.
   356         16  ER-2756             PIC  X(04)      VALUE '2756'.
   357         16  ER-2768             PIC  X(04)      VALUE '2768'.
   358         16  ER-2774             PIC  X(04)      VALUE '2774'.
   359         16  ER-2775             PIC  X(04)      VALUE '2775'.
   360         16  ER-2965             PIC  X(04)      VALUE '2965'.
   361         16  ER-2966             PIC  X(04)      VALUE '2966'.
   362         16  ER-2967             PIC  X(04)      VALUE '2967'.
   363         16  ER-2968             PIC  X(04)      VALUE '2968'.
   364         16  ER-2969             PIC  X(04)      VALUE '2969'.
   365         16  ER-3037             PIC  X(04)      VALUE '3037'.
   366         16  ER-3038             PIC  X(04)      VALUE '3038'.
   367         16  ER-3039             PIC  X(04)      VALUE '3039'.
   368         16  ER-3780             PIC  X(04)      VALUE '3780'.
   369         16  ER-3781             PIC  X(04)      VALUE '3781'.
   370         16  ER-3830             PIC  X(04)      VALUE '3830'.
   371         16  ER-8160             PIC  X(04)      VALUE '8160'.
   372         16  ER-8161             PIC  X(04)      VALUE '8161'.
   373         16  ER-9999             PIC  X(04)      VALUE '9999'.
   374     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   375     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   376     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   377     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   378
   379     12  WS-RESPONSE             PIC S9(8)       COMP.
   380         88  WS-RESP-NORMAL                      VALUE +00.
   381         88  WS-RESP-NOTFND                      VALUE +13.
   382         88  WS-RESP-DUPREC                      VALUE +14.
   383         88  WS-RESP-DUPKEY                      VALUE +15.
   384         88  WS-RESP-NOTOPEN                     VALUE +19.
   385         88  WS-RESP-ENDFILE                     VALUE +20.
   386
   387     12  WS-01-CANCEL-ERR        PIC X(25)
   388         VALUE 'CANCEL DATE ERROR'.
   389     12  WS-02-CANCEL-ERR        PIC X(25)
   390         VALUE 'CERT NOT FOUND'.
   391     12  WS-04-CANCEL-ERR        PIC X(25)
   392         VALUE 'CANCEL AMOUNT ERROR'.
   393     12  WS-05-CANCEL-ERR        PIC X(25)
   394         VALUE 'CANCEL OPTION ERROR'.
   395     12  WS-06-CANCEL-ERR        PIC X(25)
   396         VALUE 'PREVIOUSLY CANCELLED'.
   397     12  WS-07-CANCEL-ERR        PIC X(25)
   398         VALUE 'INVALID DATA'.
   399     12  WS-08-CANCEL-ERR        PIC X(25)
   400         VALUE 'NO ACCOUNT MASTER'.
   401     12  WS-09-CANCEL-ERR        PIC X(25)
   402         VALUE 'SUFFIX ALREADY EXISTS'.
   403     12  WS-99-CANCEL-ERR        PIC X(25)
   404         VALUE 'MISC CANCEL ERROR'.
   405
   406 01  WS-SAVE-ALLOWABLE-BENEFIT.
   407     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   408     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   409     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   410     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   9
* EL1278.cbl
   411     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   412     16  FILLER                    PIC XX.
   413 01  CTBL-KEY-SAVE               PIC X(5).
   414 01  CTBL-KEY.
   415     05  CTBL-COMPANY-CD         PIC X.
   416     05  CTBL-TABLE              PIC XXX.
   417     05  CTBL-BEN-TYPE           PIC X.
   418     05  CTBL-BEN-CODE           PIC XX.
   419 01  CANCEL-GEN-PASS-AREA.
   420     05  CG-OPTION-CODE          PIC X.
   421         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   422         88  CG-FLAT-CANCEL        VALUE '1'.
   423         88  CG-CANCEL             VALUE '2'.
   424         88  CG-CANCEL-REISSUE     VALUE '3'.
   425     05  CG-ERROR-CODE           PIC 99.
   426         88  CG-SUCCESS            VALUE 00.
   427         88  CG-DATE-ERROR         VALUE 01.
   428         88  CG-CERT-NOT-FOUND     VALUE 02.
   429         88  CG-AMOUNT-ERROR       VALUE 04.
   430         88  CG-OPTION-ERROR       VALUE 05.
   431         88  CG-PREV-CAN           VALUE 06.
   432         88  CG-INVALID-DATA       VALUE 07.
   433         88  CG-NO-ACCT-MSTR       VALUE 08.
   434         88  CG-SFX-A-EXIST        VALUE 09.
   435         88  CG-MISC-ERROR         VALUE 99.
   436     05  CG-COMPANY-ID           PIC XXX.
   437     05  CG-PROC-ID              PIC XXXX.
   438     05  CG-CURRENT-DT           PIC XX.
   439     05  CG-MONTH-END-DT         PIC XX.
   440     05  CG-CERT-KEY.
   441         10  CG-CERT-COMPANY-CD  PIC X.
   442         10  CG-CERT-CARRIER     PIC X.
   443         10  CG-CERT-GROUP       PIC X(6).
   444         10  CG-CERT-STATE       PIC XX.
   445         10  CG-CERT-ACCOUNT     PIC X(10).
   446         10  CG-CERT-EFF-DT      PIC XX.
   447         10  CG-CERT-CERT-NO     PIC X(11).
   448     05  CG-LF-CAN-DATA.
   449         10  CG-LF-CAN-DT        PIC XX.
   450         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   451     05  CG-AH-CAN-DATA.
   452         10  CG-AH-CAN-DT        PIC XX.
   453         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   454     05  CG-CERT-PROFILE-DATA.
   455         10  CG-INS-LNAME        PIC X(15).
   456         10  CG-INS-FNAME        PIC X(10).
   457         10  CG-INS-MID-INIT     PIC X.
   458         10  CG-INS-AGE          PIC 99.
   459         10  CG-JNT-LNAME        PIC X(15).
   460         10  CG-JNT-FNAME        PIC X(10).
   461         10  CG-JNT-MID-INIT     PIC X.
   462         10  CG-JNT-AGE          PIC 99.
   463     05  CG-LF-ISS-DATA.
   464         10  CG-LF-BENCD         PIC XX.
   465         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   466         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   467     05  CG-AH-ISS-DATA.
   468         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  10
* EL1278.cbl
   469         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   470     05  CG-BATCH-NO             PIC X(6).
   471     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   472     05  FILLER                  PIC X(306).
   473 01  WS-CAN-QUOTE-NOTE.
   474     12  WS-CN-CANCEL-DT         PIC  X(09).
   475     12  FILLER                  PIC  X(10)      VALUE
   476         'RF QUOTE: '.
   477     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   478     12  FILLER                  PIC  X(4)       VALUE
   479         ' LF '.
   480     12  WS-CN-LF-REF-METH       PIC  X.
   481     12  FILLER                  PIC  X          VALUE ','.
   482     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   483     12  FILLER                  PIC  X(5)       VALUE
   484         ' AH '.
   485     12  WS-CN-AH-REF-METH       PIC  X.
   486     12  FILLER                  PIC  XX         VALUE ','.
   487     12  FILLER                  PIC  X(6)       VALUE
   488         'TOTAL '.
   489     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   490     12  FILLER                  PIC  X(01)      VALUE ' '.
   491     12  WS-CN-DT-QUOTED         PIC  X(08).
   492     12  FILLER                  PIC  X(01)      VALUE ';'.
   493     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   494
   495 01  WS-CM-CONTROL-PRIMARY.
   496     12  WS-CM-COMPANY-CD        PIC  X(01).
   497     12  WS-CM-CARRIER           PIC  X(01).
   498     12  WS-CM-GROUPING          PIC  X(06).
   499     12  WS-CM-STATE             PIC  X(02).
   500     12  WS-CM-ACCOUNT           PIC  X(10).
   501     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   502     12  WS-CM-CERT-NO.
   503         16  WS-CM-CERT-PRIME    PIC  X(10).
   504         16  WS-CM-CERT-SFX      PIC  X(01).
   505
   506 01  WS-MA-CONTROL-PRIMARY.
   507     12  WS-MA-COMPANY-CD        PIC  X(01).
   508     12  WS-MA-CARRIER           PIC  X(01).
   509     12  WS-MA-GROUPING          PIC  X(06).
   510     12  WS-MA-STATE             PIC  X(02).
   511     12  WS-MA-ACCOUNT           PIC  X(10).
   512     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   513     12  WS-MA-CERT-NO.
   514         16  WS-MA-CERT-PRIME    PIC  X(10).
   515         16  WS-MA-CERT-SFX      PIC  X(01).
   516 01  WS-CF-CONTROL-PRIMARY.
   517     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   518     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   519*        88  COMPANY-MASTER                      VALUE '1'.
   520*        88  STATE-MASTER                        VALUE '3'.
   521*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   522*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   523     12  WS-CF-ACCESS.
   524         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   525         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   526             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  11
* EL1278.cbl
   527             20  WS-CF-CARRIER   PIC  X(01).
   528     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   529
   530 01  WS-AM-CONTROL-PRIMARY.
   531     12  WS-AM-COMPANY-CD        PIC  X(01).
   532     12  WS-AM-CARRIER           PIC  X(01).
   533     12  WS-AM-GROUPING          PIC  X(06).
   534     12  WS-AM-STATE             PIC  X(02).
   535     12  WS-AM-ACCOUNT           PIC  X(10).
   536     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   537     12  WS-AM-FILLER            PIC  X(04).
   538
   539 01  WS-CN-CONTROL-PRIMARY.
   540     12  WS-CN-COMPANY-CD        PIC  X(01).
   541     12  WS-CN-CARRIER           PIC  X(01).
   542     12  WS-CN-GROUPING          PIC  X(06).
   543     12  WS-CN-STATE             PIC  X(02).
   544     12  WS-CN-ACCOUNT           PIC  X(10).
   545     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   546     12  WS-CN-CERT-NO.
   547         16  WS-CN-CERT-PRIME    PIC  X(10).
   548         16  WS-CN-CERT-SFX      PIC  X.
   549     12  WS-CN-REC-TYPE          PIC X.
   550     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   551
   552 01  WS-FO-CONTROL-PRIMARY.
   553     12  WS-FO-COMPANY-CD        PIC  X(01).
   554     12  WS-FO-STATE             PIC  X(02).
   555     12  WS-FO-FORM-ID           PIC  X(12).
   556     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  12
* EL1278.cbl
   558*                            COPY ERCCNOT.
   559******************************************************************
   560*                                                                *
   561*                            ERCCNOT                             *
   562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   563*                            VMOD=2.003                          *
   564*                                                                *
   565*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   566*                                                                *
   567*        FILE TYPE= VSAM,KSDS                                    *
   568*        RECORD SIZE = 150    RECFORM = FIXED                    *
   569*                                                                *
   570*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   571*                                                                *
   572*        LOG = YES                                               *
   573*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   574*                                                                *
   575******************************************************************
   576*                   C H A N G E   L O G
   577*
   578* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   579*-----------------------------------------------------------------
   580*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   581* EFFECTIVE    NUMBER
   582*-----------------------------------------------------------------
   583* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   584******************************************************************
   585
   586 01  CERT-NOTE-FILE.
   587     12  CZ-RECORD-ID                PIC  XX.
   588         88  VALID-CZ-ID                  VALUE 'CZ'.
   589
   590     12  CZ-CONTROL-PRIMARY.
   591         16  CZ-COMPANY-CD           PIC X.
   592         16  CZ-CARRIER              PIC X.
   593         16  CZ-GROUPING.
   594             20 CZ-GROUPING-PREFIX   PIC XXX.
   595             20 CZ-GROUPING-PRIME    PIC XXX.
   596         16  CZ-STATE                PIC XX.
   597         16  CZ-ACCOUNT.
   598             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   599             20 CZ-ACCOUNT-PRIME     PIC X(6).
   600         16  CZ-CERT-EFF-DT          PIC XX.
   601         16  CZ-CERT-NO.
   602             20  CZ-CERT-PRIME       PIC X(10).
   603             20  CZ-CERT-SFX         PIC X.
   604         16  CZ-RECORD-TYPE          PIC X.
   605             88  CERT-NOTE           VALUE '1'.
   606             88  CLAIM-CERT-NOTE     VALUE '2'.
   607         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   608
   609     12  CZ-LAST-MAINT-DT            PIC XX.
   610     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   611     12  CZ-LAST-MAINT-USER          PIC X(4).
   612
   613     12  CZ-NOTE-INFORMATION.
   614         16  CZ-NOTE                 PIC X(63).
   615         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  13
* EL1278.cbl
   616******************************************************************
   617*                            COPY ELCDATE.
   618******************************************************************
   619*                                                                *
   620*                                                                *
   621*                            ELCDATE.                            *
   622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   623*                            VMOD=2.003
   624*                                                                *
   625*                                                                *
   626*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   627*                 LENGTH = 200                                   *
   628******************************************************************
   629
   630 01  DATE-CONVERSION-DATA.
   631     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   632     12  DC-OPTION-CODE                PIC X.
   633         88  BIN-TO-GREG                VALUE ' '.
   634         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   635         88  EDIT-GREG-TO-BIN           VALUE '2'.
   636         88  YMD-GREG-TO-BIN            VALUE '3'.
   637         88  MDY-GREG-TO-BIN            VALUE '4'.
   638         88  JULIAN-TO-BIN              VALUE '5'.
   639         88  BIN-PLUS-ELAPSED           VALUE '6'.
   640         88  FIND-CENTURY               VALUE '7'.
   641         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   642         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   643         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   644         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   645         88  JULIAN-TO-BIN-3            VALUE 'C'.
   646         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   647         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   648         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   649         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   650         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   651         88  CHECK-LEAP-YEAR            VALUE 'H'.
   652         88  BIN-3-TO-GREG              VALUE 'I'.
   653         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   654         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   655         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   656         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   657         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   658         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   659         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   660         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   661         88  THREE-CHARACTER-BIN
   662                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   663         88  GREGORIAN-TO-BIN
   664                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   665         88  BIN-TO-GREGORIAN
   666                  VALUES ' ' '1' 'I' '8' 'G'.
   667         88  JULIAN-TO-BINARY
   668                  VALUES '5' 'C' 'E' 'F'.
   669     12  DC-ERROR-CODE                 PIC X.
   670         88  NO-CONVERSION-ERROR        VALUE ' '.
   671         88  DATE-CONVERSION-ERROR
   672                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   673         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  14
* EL1278.cbl
   674         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   675         88  DATE-IS-INVALID            VALUE '3'.
   676         88  DATE1-GREATER-DATE2        VALUE '4'.
   677         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   678         88  DATE-INVALID-OPTION        VALUE '9'.
   679         88  INVALID-CENTURY            VALUE 'A'.
   680         88  ONLY-CENTURY               VALUE 'B'.
   681         88  ONLY-LEAP-YEAR             VALUE 'C'.
   682         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   683     12  DC-END-OF-MONTH               PIC X.
   684         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   685     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   686         88  USE-NORMAL-PROCESS         VALUE ' '.
   687         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   688         88  ADJUST-UP-100-YRS          VALUE '2'.
   689     12  FILLER                        PIC X.
   690     12  DC-CONVERSION-DATES.
   691         16  DC-BIN-DATE-1             PIC XX.
   692         16  DC-BIN-DATE-2             PIC XX.
   693         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   694         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   695                       DC-GREG-DATE-1-EDIT.
   696             20  DC-EDIT1-MONTH        PIC 99.
   697             20  SLASH1-1              PIC X.
   698             20  DC-EDIT1-DAY          PIC 99.
   699             20  SLASH1-2              PIC X.
   700             20  DC-EDIT1-YEAR         PIC 99.
   701         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   702         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   703                     DC-GREG-DATE-2-EDIT.
   704             20  DC-EDIT2-MONTH        PIC 99.
   705             20  SLASH2-1              PIC X.
   706             20  DC-EDIT2-DAY          PIC 99.
   707             20  SLASH2-2              PIC X.
   708             20  DC-EDIT2-YEAR         PIC 99.
   709         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   710         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   711                     DC-GREG-DATE-1-YMD.
   712             20  DC-YMD-YEAR           PIC 99.
   713             20  DC-YMD-MONTH          PIC 99.
   714             20  DC-YMD-DAY            PIC 99.
   715         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   716         16  DC-GREG-DATE-1-MDY-R REDEFINES
   717                      DC-GREG-DATE-1-MDY.
   718             20  DC-MDY-MONTH          PIC 99.
   719             20  DC-MDY-DAY            PIC 99.
   720             20  DC-MDY-YEAR           PIC 99.
   721         16  DC-GREG-DATE-1-ALPHA.
   722             20  DC-ALPHA-MONTH        PIC X(10).
   723             20  DC-ALPHA-DAY          PIC 99.
   724             20  FILLER                PIC XX.
   725             20  DC-ALPHA-CENTURY.
   726                 24 DC-ALPHA-CEN-N     PIC 99.
   727             20  DC-ALPHA-YEAR         PIC 99.
   728         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   729         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   730         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   731         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  15
* EL1278.cbl
   732         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   733                                       PIC 9(05).
   734         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   735             20  DC-JULIAN-YEAR        PIC 99.
   736             20  DC-JULIAN-DAYS        PIC 999.
   737         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   738         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   739         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   740     12  DATE-CONVERSION-VARIBLES.
   741         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   742         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   743             20  FILLER                PIC 9(3).
   744             20  HOLD-CEN-1-CCYY.
   745                 24  HOLD-CEN-1-CC     PIC 99.
   746                 24  HOLD-CEN-1-YY     PIC 99.
   747             20  HOLD-CEN-1-MO         PIC 99.
   748             20  HOLD-CEN-1-DA         PIC 99.
   749         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   750             20  HOLD-CEN-1-R-MO       PIC 99.
   751             20  HOLD-CEN-1-R-DA       PIC 99.
   752             20  HOLD-CEN-1-R-CCYY.
   753                 24  HOLD-CEN-1-R-CC   PIC 99.
   754                 24  HOLD-CEN-1-R-YY   PIC 99.
   755             20  FILLER                PIC 9(3).
   756         16  HOLD-CENTURY-1-X.
   757             20  FILLER                PIC X(3)  VALUE SPACES.
   758             20  HOLD-CEN-1-X-CCYY.
   759                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   760                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   761             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   762             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   763         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   764             20  HOLD-CEN-1-R-X-MO     PIC XX.
   765             20  HOLD-CEN-1-R-X-DA     PIC XX.
   766             20  HOLD-CEN-1-R-X-CCYY.
   767                 24  HOLD-CEN-1-R-X-CC PIC XX.
   768                 24  HOLD-CEN-1-R-X-YY PIC XX.
   769             20  FILLER                PIC XXX.
   770         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   771         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   772         16  DC-JULIAN-DATE-1          PIC 9(07).
   773         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   774             20  DC-JULIAN-1-CCYY.
   775                 24  DC-JULIAN-1-CC    PIC 99.
   776                 24  DC-JULIAN-1-YR    PIC 99.
   777             20  DC-JULIAN-DA-1        PIC 999.
   778         16  DC-JULIAN-DATE-2          PIC 9(07).
   779         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   780             20  DC-JULIAN-2-CCYY.
   781                 24  DC-JULIAN-2-CC    PIC 99.
   782                 24  DC-JULIAN-2-YR    PIC 99.
   783             20  DC-JULIAN-DA-2        PIC 999.
   784         16  DC-GREG-DATE-A-EDIT.
   785             20  DC-EDITA-MONTH        PIC 99.
   786             20  SLASHA-1              PIC X VALUE '/'.
   787             20  DC-EDITA-DAY          PIC 99.
   788             20  SLASHA-2              PIC X VALUE '/'.
   789             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  16
* EL1278.cbl
   790                 24  DC-EDITA-CENT     PIC 99.
   791                 24  DC-EDITA-YEAR     PIC 99.
   792         16  DC-GREG-DATE-B-EDIT.
   793             20  DC-EDITB-MONTH        PIC 99.
   794             20  SLASHB-1              PIC X VALUE '/'.
   795             20  DC-EDITB-DAY          PIC 99.
   796             20  SLASHB-2              PIC X VALUE '/'.
   797             20  DC-EDITB-CCYY.
   798                 24  DC-EDITB-CENT     PIC 99.
   799                 24  DC-EDITB-YEAR     PIC 99.
   800         16  DC-GREG-DATE-CYMD         PIC 9(08).
   801         16  DC-GREG-DATE-CYMD-R REDEFINES
   802                              DC-GREG-DATE-CYMD.
   803             20  DC-CYMD-CEN           PIC 99.
   804             20  DC-CYMD-YEAR          PIC 99.
   805             20  DC-CYMD-MONTH         PIC 99.
   806             20  DC-CYMD-DAY           PIC 99.
   807         16  DC-GREG-DATE-MDCY         PIC 9(08).
   808         16  DC-GREG-DATE-MDCY-R REDEFINES
   809                              DC-GREG-DATE-MDCY.
   810             20  DC-MDCY-MONTH         PIC 99.
   811             20  DC-MDCY-DAY           PIC 99.
   812             20  DC-MDCY-CEN           PIC 99.
   813             20  DC-MDCY-YEAR          PIC 99.
   814    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   815        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   816    12  DC-EL310-DATE                  PIC X(21).
   817    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  17
* EL1278.cbl
   819*                            COPY ELCLOGOF.
   820******************************************************************
   821*                                                                *
   822*                                                                *
   823*                            ELCLOGOF.                           *
   824*                            VMOD=2.001                          *
   825*                                                                *
   826*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   827*                                                                *
   828******************************************************************
   829 01  CLASIC-LOGOFF.
   830     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   831     12  LOGOFF-TEXT.
   832         16  FILLER          PIC X(5)    VALUE SPACES.
   833         16  LOGOFF-MSG.
   834             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   835             20  FILLER      PIC X       VALUE SPACES.
   836             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   837         16  FILLER          PIC X(80)
   838           VALUE '* YOU ARE NOW LOGGED OFF'.
   839         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   840         16  FILLER          PIC X       VALUE QUOTE.
   841         16  LOGOFF-SYS-MSG  PIC X(17)
   842           VALUE 'S CLAS-IC SYSTEM '.
   843     12  TEXT-MESSAGES.
   844         16  UNACCESS-MSG    PIC X(29)
   845             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   846         16  PGMIDERR-MSG    PIC X(17)
   847             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  18
* EL1278.cbl
   849*                            COPY ELCATTR.
   850******************************************************************
   851*                                                                *
   852*                            ELCATTR.                            *
   853*                            VMOD=2.001                          *
   854*                                                                *
   855*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   856*                                                                *
   857*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   858*                                                                *
   859*                   POS 1   P=PROTECTED                          *
   860*                           U=UNPROTECTED                        *
   861*                           S=ASKIP                              *
   862*                   POS 2   A=ALPHA/NUMERIC                      *
   863*                           N=NUMERIC                            *
   864*                   POS 3   N=NORMAL                             *
   865*                           B=BRIGHT                             *
   866*                           D=DARK                               *
   867*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   868*                           OF=MODIFIED DATA TAG OFF             *
   869*                                                                *
   870*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   871******************************************************************
   872 01  ATTRIBUTE-LIST.
   873     12  AL-PABOF            PIC X       VALUE 'Y'.
   874     12  AL-PABON            PIC X       VALUE 'Z'.
   875     12  AL-PADOF            PIC X       VALUE '%'.
   876     12  AL-PADON            PIC X       VALUE '_'.
   877     12  AL-PANOF            PIC X       VALUE '-'.
   878     12  AL-PANON            PIC X       VALUE '/'.
   879     12  AL-SABOF            PIC X       VALUE '8'.
   880     12  AL-SABON            PIC X       VALUE '9'.
   881     12  AL-SADOF            PIC X       VALUE '@'.
   882     12  AL-SADON            PIC X       VALUE QUOTE.
   883     12  AL-SANOF            PIC X       VALUE '0'.
   884     12  AL-SANON            PIC X       VALUE '1'.
   885     12  AL-UABOF            PIC X       VALUE 'H'.
   886     12  AL-UABON            PIC X       VALUE 'I'.
   887     12  AL-UADOF            PIC X       VALUE '<'.
   888     12  AL-UADON            PIC X       VALUE '('.
   889     12  AL-UANOF            PIC X       VALUE ' '.
   890     12  AL-UANON            PIC X       VALUE 'A'.
   891     12  AL-UNBOF            PIC X       VALUE 'Q'.
   892     12  AL-UNBON            PIC X       VALUE 'R'.
   893     12  AL-UNDOF            PIC X       VALUE '*'.
   894     12  AL-UNDON            PIC X       VALUE ')'.
   895     12  AL-UNNOF            PIC X       VALUE '&'.
   896     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  19
* EL1278.cbl
   898*                            COPY ELCEMIB.
   899******************************************************************
   900*                                                                *
   901*                                                                *
   902*                            ELCEMIB.                            *
   903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   904*                            VMOD=2.005                          *
   905*                                                                *
   906*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   907*                                                                *
   908******************************************************************
   909 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   910     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   911     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   912     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   913     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   914     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   915     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   916     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   917     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   918     12  EMI-SWITCH1             PIC X        VALUE '1'.
   919         88  EMI-NO-ERRORS                    VALUE '1'.
   920         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   921         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   922     12  EMI-SWITCH2             PIC X        VALUE '1'.
   923         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   924     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   925         88  EMI-AREA1-EMPTY                  VALUE '1'.
   926         88  EMI-AREA1-FULL                   VALUE '2'.
   927     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   928         88  EMI-AREA2-EMPTY                  VALUE '1'.
   929         88  EMI-AREA2-FULL                   VALUE '2'.
   930     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   931         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   932         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   933         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   934         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   935         88  EMI-BYPASS-FATALS                VALUE 'X'.
   936     12  EMI-ERROR-LINES.
   937         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   938         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   939         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   940         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   941             20  EMI-ERR-CODES OCCURS 10 TIMES.
   942                 24  EMI-ERR-NUM         PIC X(4).
   943                 24  EMI-FILLER          PIC X.
   944                 24  EMI-SEV             PIC X.
   945                 24  FILLER              PIC X.
   946             20  FILLER                  PIC X(02).
   947     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   948         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   949             20  EMI-ERROR-NUMBER    PIC X(4).
   950             20  EMI-FILL            PIC X.
   951             20  EMI-SEVERITY        PIC X.
   952             20  FILLER              PIC X.
   953             20  EMI-ERROR-TEXT.
   954                 24  EMI-TEXT-VARIABLE   PIC X(10).
   955                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  20
* EL1278.cbl
   956     12  EMI-SEVERITY-SAVE           PIC X.
   957         88  EMI-NOTE                    VALUE 'N'.
   958         88  EMI-WARNING                 VALUE 'W'.
   959         88  EMI-FORCABLE                VALUE 'F'.
   960         88  EMI-FATAL                   VALUE 'X'.
   961     12  EMI-MESSAGE-FLAG            PIC X.
   962         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   963         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   964     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   965     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   966         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   967         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   968         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   969     12  emi-claim-no                pic x(7).
   970     12  emi-claim-type              pic x(6).
   971     12  FILLER                      PIC X(124)  VALUE SPACES.
   972     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   973     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   974     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   975     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  21
* EL1278.cbl
   977 01  WS-PASS-631.
   978     12  WS-PASS-WORK-AREA         PIC X(384).
   979     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   980     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   981*        COPY ELC631PI.
   982******************************************************************
   983*                                                                *
   984*                                                                *
   985*                            ELC631PI                            *
   986*                            VMOD=2.012                          *
   987*                                                                *
   988*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   989*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   990*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   991*                                                                *
   992*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   993*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   994*    BETWEEN PROGRAMS.                                           *
   995*                                                                *
   996*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   997*                                                                *
   998*               EL631 - EL6311 - EL6312 - EL6313                 *
   999*                                                                *
  1000******************************************************************
  1001*                   C H A N G E   L O G
  1002*
  1003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1004*-----------------------------------------------------------------
  1005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1006* EFFECTIVE    NUMBER
  1007*-----------------------------------------------------------------
  1008* 021414    2003053000001  PEMA  changes for auto chk request
  1009******************************************************************
  1010
  1011         16  PI-631-DATA.
  1012             20  PI-ERPNDB-KEY.
  1013                 24  PI-PB-COMPANY-CD     PIC X.
  1014                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1015                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1016                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1017
  1018             20  PI-ERPNDB-ALT-KEY.
  1019                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1020                 24  PI-PB-CARRIER        PIC X.
  1021                 24  PI-PB-GROUPING       PIC X(6).
  1022                 24  PI-PB-STATE          PIC XX.
  1023                 24  PI-PB-ACCOUNT        PIC X(10).
  1024                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1025                 24  PI-PB-CERT-NO.
  1026                     28  PI-PB-CERT-PRIME PIC X(10).
  1027                     28  PI-PB-CERT-SFX   PIC X.
  1028                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1029                 24  PI-PB-RECORD-TYPE    PIC X.
  1030
  1031             20  PI-ERPNDB-CSR-KEY.
  1032                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1033                 24  PI-PB-CSR-ID             PIC X(4).
  1034                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  22
* EL1278.cbl
  1035                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1036                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1037
  1038             20  PI-BROWSE-TYPE               PIC X.
  1039                 88  PI-FILE-BROWSE             VALUE ' '.
  1040                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1041                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1042                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1043                 88  PI-CSR-BROWSE              VALUE '4'.
  1044
  1045             20  PI-MAINT-FUNCTION            PIC X.
  1046                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1047                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1048                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1049                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1050                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1051                 88  PI-PF5-FUNCTION            VALUE '5'.
  1052                 88  PI-PF6-FUNCTION            VALUE '6'.
  1053
  1054             20  PI-FILE-SWITCHES.
  1055                 24  PI-ALL-ISSUES-SW         PIC X.
  1056                     88  ALL-ISSUES             VALUE 'Y'.
  1057                 24  PI-ALL-CANCELS-SW        PIC X.
  1058                     88  ALL-CANCELS            VALUE 'Y'.
  1059                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1060                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1061                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1062                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1063                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1064                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1065                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1066                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1067                 24  PI-HOLD-REC-SW           PIC X.
  1068                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1069                 24  PI-CHANGE-REC-SW         PIC X.
  1070                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1071                 24  PI-CHK-REQ-REC-SW        PIC X.
  1072                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1073                 24  PI-ISSUE-WARNING-SW      PIC X.
  1074                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1075                 24  PI-CANCEL-WARNING-SW     PIC X.
  1076                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1077             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1078                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1079             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1080                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1081
  1082             20  PI-MAP-NAME                  PIC X(8).
  1083
  1084             20  PI-CURSOR                    PIC S9(4) COMP.
  1085
  1086             20  PI-PREV-ALT-KEY              PIC X(36).
  1087             20  PI-PREV-CSR-KEY              PIC X(15).
  1088             20  PI-PREV-KEY.
  1089                 24  PI-PREV-COMPANY-CD       PIC X.
  1090                 24  PI-PREV-BATCH            PIC X(6).
  1091                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1092                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  23
* EL1278.cbl
  1093             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1094             20  PI-BROWSE-SW                 PIC X.
  1095                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1096                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1097             20  PI-SV-CARRIER                PIC X.
  1098             20  PI-SV-GROUPING               PIC X(6).
  1099             20  PI-SV-STATE                  PIC XX.
  1100             20  PI-EDIT-SW                   PIC X.
  1101             20  PI-DISPLAY-SW                PIC XX.
  1102                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1103                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1104             20  PI-CRITERIA-DATA             PIC X(350).
  1105             20  PI-BMODE                     PIC X.
  1106             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1107             20  PI-BPMTS                     PIC S999     COMP-3.
  1108             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1109             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1110             20  PI-CSR-SESSION-SW            PIC X.
  1111                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1112             20  PI-ERRORS-SW                 PIC X.
  1113                 88  FATAL-ERRORS               VALUE 'X'.
  1114*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1115             20  pi-unforced-sw               pic x.
  1116                 88  unforced-errors            value 'X'.
  1117             20  FILLER                       PIC X(4).
  1118
  1119         16  FILLER                PIC X(94).
  1120
  1121
  1122*                            COPY ELCINTF.
  1123******************************************************************
  1124*                                                                *
  1125*                                                                *
  1126*                            ELCINTF.                            *
  1127*                            VMOD=2.017                          *
  1128*                                                                *
  1129*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1130*                                                                *
  1131*       LENGTH = 1024                                            *
  1132*                                                                *
  1133******************************************************************
  1134*                   C H A N G E   L O G
  1135*
  1136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1137*-----------------------------------------------------------------
  1138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1139* EFFECTIVE    NUMBER
  1140*-----------------------------------------------------------------
  1141* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1142******************************************************************
  1143 01  PROGRAM-INTERFACE-BLOCK.
  1144     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1145     12  PI-CALLING-PROGRAM              PIC X(8).
  1146     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1147     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1148     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1149     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1150     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  24
* EL1278.cbl
  1151     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1152     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1153     12  PI-COMPANY-ID                   PIC XXX.
  1154     12  PI-COMPANY-CD                   PIC X.
  1155
  1156     12  PI-COMPANY-PASSWORD             PIC X(8).
  1157
  1158     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1159
  1160     12  PI-CONTROL-IN-PROGRESS.
  1161         16  PI-CARRIER                  PIC X.
  1162         16  PI-GROUPING                 PIC X(6).
  1163         16  PI-STATE                    PIC XX.
  1164         16  PI-ACCOUNT                  PIC X(10).
  1165         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1166                                         PIC X(10).
  1167         16  PI-CLAIM-CERT-GRP.
  1168             20  PI-CLAIM-NO             PIC X(7).
  1169             20  PI-CERT-NO.
  1170                 25  PI-CERT-PRIME       PIC X(10).
  1171                 25  PI-CERT-SFX         PIC X.
  1172             20  PI-CERT-EFF-DT          PIC XX.
  1173         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1174             20  PI-PLAN-CODE            PIC X(2).
  1175             20  PI-REVISION-NUMBER      PIC X(3).
  1176             20  PI-PLAN-EFF-DT          PIC X(2).
  1177             20  PI-PLAN-EXP-DT          PIC X(2).
  1178             20  FILLER                  PIC X(11).
  1179         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1180             20  PI-OE-REFERENCE-1.
  1181                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1182                 25  PI-OE-REF-1-SUFF    PIC XX.
  1183
  1184     12  PI-SESSION-IN-PROGRESS          PIC X.
  1185         88  CLAIM-SESSION                   VALUE '1'.
  1186         88  CREDIT-SESSION                  VALUE '2'.
  1187         88  WARRANTY-SESSION                VALUE '3'.
  1188         88  MORTGAGE-SESSION                VALUE '4'.
  1189         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1190
  1191
  1192*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1193
  1194     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1195     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1196
  1197     12  PI-CREDIT-USER                  PIC X.
  1198         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1199         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1200
  1201     12  PI-CLAIM-USER                   PIC X.
  1202         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1203         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1204
  1205     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1206         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1207         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1208         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  25
* EL1278.cbl
  1209         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1210         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1211
  1212     12  PI-PROCESSOR-ID                 PIC X(4).
  1213
  1214     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1215
  1216     12  PI-MEMBER-CAPTION               PIC X(10).
  1217
  1218     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1219         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1220
  1221     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1222     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1223     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1224     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1225
  1226     12  PI-AH-OVERRIDE-L1               PIC X.
  1227     12  PI-AH-OVERRIDE-L2               PIC XX.
  1228     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1229     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1230
  1231     12  PI-NEW-SYSTEM                   PIC X(2).
  1232
  1233     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1234     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1235         88  PI-USES-PAID-TO                 VALUE '1'.
  1236     12  PI-CRDTCRD-SYSTEM.
  1237         16  PI-CRDTCRD-USER             PIC X.
  1238             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1239             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1240         16  PI-CC-MONTH-END-DT          PIC XX.
  1241     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1242
  1243     12  PI-OE-REFERENCE-2.
  1244         16  PI-OE-REF-2-PRIME           PIC X(10).
  1245         16  PI-OE-REF-2-SUFF            PIC X.
  1246
  1247     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1248
  1249     12  PI-LANGUAGE-TYPE                PIC X.
  1250             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1251             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1252             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1253
  1254     12  PI-POLICY-LINKAGE-IND           PIC X.
  1255         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1256         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1257                                                   LOW-VALUES.
  1258
  1259     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1260     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1261         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1262         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1263
  1264     12  PI-PROCESSOR-CSR-IND            PIC X.
  1265         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1266         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  26
* EL1278.cbl
  1267
  1268     12  FILLER                          PIC X(3).
  1269
  1270     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1271
  1272     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1273         PI-SYSTEM-LEVEL.
  1274
  1275         16  PI-ENTRY-CODES.
  1276             20  PI-ENTRY-CD-1           PIC X.
  1277             20  PI-ENTRY-CD-2           PIC X.
  1278
  1279         16  PI-RETURN-CODES.
  1280             20  PI-RETURN-CD-1          PIC X.
  1281             20  PI-RETURN-CD-2          PIC X.
  1282
  1283         16  PI-UPDATE-STATUS-SAVE.
  1284             20  PI-UPDATE-BY            PIC X(4).
  1285             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1286
  1287         16  PI-LOWER-CASE-LETTERS       PIC X.
  1288             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1289
  1290*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1291*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1292*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1293
  1294         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1295             88  ST-ACCNT-CNTL               VALUE ' '.
  1296             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1297             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1298             88  ACCNT-CNTL                  VALUE '3'.
  1299             88  CARR-ACCNT-CNTL             VALUE '4'.
  1300
  1301         16  PI-PROCESSOR-CAP-LIST.
  1302             20  PI-SYSTEM-CONTROLS.
  1303                24 PI-SYSTEM-DISPLAY     PIC X.
  1304                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1305                24 PI-SYSTEM-MODIFY      PIC X.
  1306                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1307             20  FILLER                  PIC XX.
  1308             20  PI-DISPLAY-CAP          PIC X.
  1309                 88  DISPLAY-CAP             VALUE 'Y'.
  1310             20  PI-MODIFY-CAP           PIC X.
  1311                 88  MODIFY-CAP              VALUE 'Y'.
  1312             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1313                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1314             20  PI-FORCE-CAP            PIC X.
  1315                 88  FORCE-CAP               VALUE 'Y'.
  1316
  1317         16  PI-PROGRAM-CONTROLS.
  1318             20  PI-PGM-PRINT-OPT        PIC X.
  1319             20  PI-PGM-FORMAT-OPT       PIC X.
  1320             20  PI-PGM-PROCESS-OPT      PIC X.
  1321             20  PI-PGM-TOTALS-OPT       PIC X.
  1322
  1323         16  PI-HELP-INTERFACE.
  1324             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  27
* EL1278.cbl
  1325             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1326
  1327         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1328             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1329
  1330         16  PI-CR-CONTROL-IN-PROGRESS.
  1331             20  PI-CR-CARRIER           PIC X.
  1332             20  PI-CR-GROUPING          PIC X(6).
  1333             20  PI-CR-STATE             PIC XX.
  1334             20  PI-CR-ACCOUNT           PIC X(10).
  1335             20  PI-CR-FIN-RESP          PIC X(10).
  1336             20  PI-CR-TYPE              PIC X.
  1337
  1338         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1339
  1340         16  PI-CR-MONTH-END-DT          PIC XX.
  1341
  1342         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1343             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1344             88  PI-ZERO-CARRIER             VALUE '1'.
  1345             88  PI-ZERO-GROUPING            VALUE '2'.
  1346             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1347
  1348         16  PI-CARRIER-SECURITY         PIC X.
  1349             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1350
  1351         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1352             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1353             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1354
  1355         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1356             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1357                                         INDEXED BY PI-ACCESS-NDX
  1358                                         PIC X.
  1359
  1360         16  PI-GA-BILLING-CONTROL       PIC X.
  1361             88  PI-GA-BILLING               VALUE '1'.
  1362
  1363         16  PI-MAIL-PROCESSING          PIC X.
  1364             88  PI-MAIL-YES                 VALUE 'Y'.
  1365
  1366         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1367
  1368         16  PI-AR-SYSTEM.
  1369             20  PI-AR-PROCESSING-CNTL   PIC X.
  1370                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1371             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1372             20  PI-AR-MONTH-END-DT      PIC XX.
  1373
  1374         16  PI-MP-SYSTEM.
  1375             20  PI-MORTGAGE-USER            PIC X.
  1376                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1377                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1378             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1379                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1380                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1381                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1382                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  28
* EL1278.cbl
  1383                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1384             20  PI-MP-MONTH-END-DT          PIC XX.
  1385             20  PI-MP-REFERENCE-NO.
  1386                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1387                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1388
  1389         16  PI-LABEL-CONTROL            PIC X(01).
  1390             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1391             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1392
  1393         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1394             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1395
  1396         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1397             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1398             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1399
  1400         16  FILLER                      PIC X(14).
  1401
  1402     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1403******************************************************************
  1404     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1405         16  FILLER                PIC  X(500).
  1406         16  PI-PEND-SW            PIC  X(01).
  1407         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1408         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1409         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1410         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1411         16  PI-EARNING-METHOD-LF  PIC  X.
  1412         16  PI-EARNING-METHOD-AH  PIC  X.
  1413         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1414         16  PI-LF-REFUND-METH     PIC  X.
  1415         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1416         16  PI-AH-REFUND-METH     PIC  X.
  1417         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1418         16  PI-MODIFY-CERT-CAP    PIC  X.
  1419             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1420         16  PI-CLP-YN             PIC X.
  1421         16  PI-CANCEL-REASON      PIC X.
  1422         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  29
* EL1278.cbl
  1424*                            COPY ELCAID.
  1425******************************************************************
  1426*                                                                *
  1427*                            ELCAID.                             *
  1428*                            VMOD=2.001                          *
  1429*                                                                *
  1430*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1431*                                                                *
  1432*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1433*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1434******************************************************************
  1435
  1436 01  DFHAID.
  1437   02  DFHNULL   PIC  X  VALUE  ' '.
  1438   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1439   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1440   02  DFHPEN    PIC  X  VALUE  '='.
  1441   02  DFHOPID   PIC  X  VALUE  'W'.
  1442   02  DFHPA1    PIC  X  VALUE  '%'.
  1443   02  DFHPA2    PIC  X  VALUE  '>'.
  1444   02  DFHPA3    PIC  X  VALUE  ','.
  1445   02  DFHPF1    PIC  X  VALUE  '1'.
  1446   02  DFHPF2    PIC  X  VALUE  '2'.
  1447   02  DFHPF3    PIC  X  VALUE  '3'.
  1448   02  DFHPF4    PIC  X  VALUE  '4'.
  1449   02  DFHPF5    PIC  X  VALUE  '5'.
  1450   02  DFHPF6    PIC  X  VALUE  '6'.
  1451   02  DFHPF7    PIC  X  VALUE  '7'.
  1452   02  DFHPF8    PIC  X  VALUE  '8'.
  1453   02  DFHPF9    PIC  X  VALUE  '9'.
  1454   02  DFHPF10   PIC  X  VALUE  ':'.
  1455   02  DFHPF11   PIC  X  VALUE  '#'.
  1456   02  DFHPF12   PIC  X  VALUE  '@'.
  1457   02  DFHPF13   PIC  X  VALUE  'A'.
  1458   02  DFHPF14   PIC  X  VALUE  'B'.
  1459   02  DFHPF15   PIC  X  VALUE  'C'.
  1460   02  DFHPF16   PIC  X  VALUE  'D'.
  1461   02  DFHPF17   PIC  X  VALUE  'E'.
  1462   02  DFHPF18   PIC  X  VALUE  'F'.
  1463   02  DFHPF19   PIC  X  VALUE  'G'.
  1464   02  DFHPF20   PIC  X  VALUE  'H'.
  1465   02  DFHPF21   PIC  X  VALUE  'I'.
  1466*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1467   02  DFHPF22   PIC  X  VALUE  '['.
  1468   02  DFHPF23   PIC  X  VALUE  '.'.
  1469   02  DFHPF24   PIC  X  VALUE  '<'.
  1470   02  DFHMSRE   PIC  X  VALUE  'X'.
  1471   02  DFHSTRF   PIC  X  VALUE  'h'.
  1472   02  DFHTRIG   PIC  X  VALUE  '"'.
  1473
  1474 01  FILLER  REDEFINES  DFHAID.
  1475     12  FILLER                  PIC  X(08).
  1476     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  30
* EL1278.cbl
  1478*                            COPY EL1278S.
  1479 01  EL127HI.
  1480     05  FILLER            PIC  X(0012).
  1481*    -------------------------------
  1482     05  HDATEL PIC S9(0004) COMP.
  1483     05  HDATEF PIC  X(0001).
  1484     05  FILLER REDEFINES HDATEF.
  1485         10  HDATEA PIC  X(0001).
  1486     05  HDATEI PIC  X(0008).
  1487*    -------------------------------
  1488     05  HTIMEL PIC S9(0004) COMP.
  1489     05  HTIMEF PIC  X(0001).
  1490     05  FILLER REDEFINES HTIMEF.
  1491         10  HTIMEA PIC  X(0001).
  1492     05  HTIMEI PIC  999V99.
  1493*    -------------------------------
  1494     05  CMPNYIDL PIC S9(0004) COMP.
  1495     05  CMPNYIDF PIC  X(0001).
  1496     05  FILLER REDEFINES CMPNYIDF.
  1497         10  CMPNYIDA PIC  X(0001).
  1498     05  CMPNYIDI PIC  X(0003).
  1499*    -------------------------------
  1500     05  USERIDL PIC S9(0004) COMP.
  1501     05  USERIDF PIC  X(0001).
  1502     05  FILLER REDEFINES USERIDF.
  1503         10  USERIDA PIC  X(0001).
  1504     05  USERIDI PIC  X(0004).
  1505*    -------------------------------
  1506     05  HCARIERL PIC S9(0004) COMP.
  1507     05  HCARIERF PIC  X(0001).
  1508     05  FILLER REDEFINES HCARIERF.
  1509         10  HCARIERA PIC  X(0001).
  1510     05  HCARIERI PIC  X(0001).
  1511*    -------------------------------
  1512     05  HGROUPL PIC S9(0004) COMP.
  1513     05  HGROUPF PIC  X(0001).
  1514     05  FILLER REDEFINES HGROUPF.
  1515         10  HGROUPA PIC  X(0001).
  1516     05  HGROUPI PIC  X(0006).
  1517*    -------------------------------
  1518     05  HSTATEL PIC S9(0004) COMP.
  1519     05  HSTATEF PIC  X(0001).
  1520     05  FILLER REDEFINES HSTATEF.
  1521         10  HSTATEA PIC  X(0001).
  1522     05  HSTATEI PIC  X(0002).
  1523*    -------------------------------
  1524     05  HACCTNOL PIC S9(0004) COMP.
  1525     05  HACCTNOF PIC  X(0001).
  1526     05  FILLER REDEFINES HACCTNOF.
  1527         10  HACCTNOA PIC  X(0001).
  1528     05  HACCTNOI PIC  X(0010).
  1529*    -------------------------------
  1530     05  HEFFDTL PIC S9(0004) COMP.
  1531     05  HEFFDTF PIC  X(0001).
  1532     05  FILLER REDEFINES HEFFDTF.
  1533         10  HEFFDTA PIC  X(0001).
  1534     05  HEFFDTI PIC  X(0008).
  1535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  31
* EL1278.cbl
  1536     05  HCERTNOL PIC S9(0004) COMP.
  1537     05  HCERTNOF PIC  X(0001).
  1538     05  FILLER REDEFINES HCERTNOF.
  1539         10  HCERTNOA PIC  X(0001).
  1540     05  HCERTNOI PIC  X(0010).
  1541*    -------------------------------
  1542     05  HCRTSFXL PIC S9(0004) COMP.
  1543     05  HCRTSFXF PIC  X(0001).
  1544     05  FILLER REDEFINES HCRTSFXF.
  1545         10  HCRTSFXA PIC  X(0001).
  1546     05  HCRTSFXI PIC  X(0001).
  1547*    -------------------------------
  1548     05  HLNAMEL PIC S9(0004) COMP.
  1549     05  HLNAMEF PIC  X(0001).
  1550     05  FILLER REDEFINES HLNAMEF.
  1551         10  HLNAMEA PIC  X(0001).
  1552     05  HLNAMEI PIC  X(0015).
  1553*    -------------------------------
  1554     05  HFNAMEL PIC S9(0004) COMP.
  1555     05  HFNAMEF PIC  X(0001).
  1556     05  FILLER REDEFINES HFNAMEF.
  1557         10  HFNAMEA PIC  X(0001).
  1558     05  HFNAMEI PIC  X(0010).
  1559*    -------------------------------
  1560     05  HINITL PIC S9(0004) COMP.
  1561     05  HINITF PIC  X(0001).
  1562     05  FILLER REDEFINES HINITF.
  1563         10  HINITA PIC  X(0001).
  1564     05  HINITI PIC  X(0001).
  1565*    -------------------------------
  1566     05  LCLMDTHL PIC S9(0004) COMP.
  1567     05  LCLMDTHF PIC  X(0001).
  1568     05  FILLER REDEFINES LCLMDTHF.
  1569         10  LCLMDTHA PIC  X(0001).
  1570     05  LCLMDTHI PIC  X(0022).
  1571*    -------------------------------
  1572     05  LCLMDTL PIC S9(0004) COMP.
  1573     05  LCLMDTF PIC  X(0001).
  1574     05  FILLER REDEFINES LCLMDTF.
  1575         10  LCLMDTA PIC  X(0001).
  1576     05  LCLMDTI PIC  X(0008).
  1577*    -------------------------------
  1578     05  HPCYNL PIC S9(0004) COMP.
  1579     05  HPCYNF PIC  X(0001).
  1580     05  FILLER REDEFINES HPCYNF.
  1581         10  HPCYNA PIC  X(0001).
  1582     05  HPCYNI PIC  X(0001).
  1583*    -------------------------------
  1584     05  ACLMDTHL PIC S9(0004) COMP.
  1585     05  ACLMDTHF PIC  X(0001).
  1586     05  FILLER REDEFINES ACLMDTHF.
  1587         10  ACLMDTHA PIC  X(0001).
  1588     05  ACLMDTHI PIC  X(0023).
  1589*    -------------------------------
  1590     05  ACLMDTL PIC S9(0004) COMP.
  1591     05  ACLMDTF PIC  X(0001).
  1592     05  FILLER REDEFINES ACLMDTF.
  1593         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  32
* EL1278.cbl
  1594     05  ACLMDTI PIC  X(0008).
  1595*    -------------------------------
  1596     05  PMTHDL PIC S9(0004) COMP.
  1597     05  PMTHDF PIC  X(0001).
  1598     05  FILLER REDEFINES PMTHDF.
  1599         10  PMTHDA PIC  X(0001).
  1600     05  PMTHDI PIC  X(0010).
  1601*    -------------------------------
  1602     05  CNCDTHDL PIC S9(0004) COMP.
  1603     05  CNCDTHDF PIC  X(0001).
  1604     05  FILLER REDEFINES CNCDTHDF.
  1605         10  CNCDTHDA PIC  X(0001).
  1606     05  CNCDTHDI PIC  X(0007).
  1607*    -------------------------------
  1608     05  HLKINDL PIC S9(0004) COMP.
  1609     05  HLKINDF PIC  X(0001).
  1610     05  FILLER REDEFINES HLKINDF.
  1611         10  HLKINDA PIC  X(0001).
  1612     05  HLKINDI PIC  X(0002).
  1613*    -------------------------------
  1614     05  HLCDL PIC S9(0004) COMP.
  1615     05  HLCDF PIC  X(0001).
  1616     05  FILLER REDEFINES HLCDF.
  1617         10  HLCDA PIC  X(0001).
  1618     05  HLCDI PIC  X(0002).
  1619*    -------------------------------
  1620     05  HLEDESCL PIC S9(0004) COMP.
  1621     05  HLEDESCF PIC  X(0001).
  1622     05  FILLER REDEFINES HLEDESCF.
  1623         10  HLEDESCA PIC  X(0001).
  1624     05  HLEDESCI PIC  X(0003).
  1625*    -------------------------------
  1626     05  HLTERML PIC S9(0004) COMP.
  1627     05  HLTERMF PIC  X(0001).
  1628     05  FILLER REDEFINES HLTERMF.
  1629         10  HLTERMA PIC  X(0001).
  1630     05  HLTERMI PIC  9(3).
  1631*    -------------------------------
  1632     05  HLREML PIC S9(0004) COMP.
  1633     05  HLREMF PIC  X(0001).
  1634     05  FILLER REDEFINES HLREMF.
  1635         10  HLREMA PIC  X(0001).
  1636     05  HLREMI PIC  X(0003).
  1637*    -------------------------------
  1638     05  HLPREML PIC S9(0004) COMP.
  1639     05  HLPREMF PIC  X(0001).
  1640     05  FILLER REDEFINES HLPREMF.
  1641         10  HLPREMA PIC  X(0001).
  1642     05  HLPREMI PIC  X(0011).
  1643*    -------------------------------
  1644     05  HLITDRL PIC S9(0004) COMP.
  1645     05  HLITDRF PIC  X(0001).
  1646     05  FILLER REDEFINES HLITDRF.
  1647         10  HLITDRA PIC  X(0001).
  1648     05  HLITDRI PIC  X(0011).
  1649*    -------------------------------
  1650     05  HLREFNDL PIC S9(0004) COMP.
  1651     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  33
* EL1278.cbl
  1652     05  FILLER REDEFINES HLREFNDF.
  1653         10  HLREFNDA PIC  X(0001).
  1654     05  HLREFNDI PIC  X(0011).
  1655*    -------------------------------
  1656     05  HLCANCL PIC S9(0004) COMP.
  1657     05  HLCANCF PIC  X(0001).
  1658     05  FILLER REDEFINES HLCANCF.
  1659         10  HLCANCA PIC  X(0001).
  1660     05  HLCANCI PIC  X(0008).
  1661*    -------------------------------
  1662     05  HLCAL1L PIC S9(0004) COMP.
  1663     05  HLCAL1F PIC  X(0001).
  1664     05  FILLER REDEFINES HLCAL1F.
  1665         10  HLCAL1A PIC  X(0001).
  1666     05  HLCAL1I PIC  X(0001).
  1667*    -------------------------------
  1668     05  HLCALCL PIC S9(0004) COMP.
  1669     05  HLCALCF PIC  X(0001).
  1670     05  FILLER REDEFINES HLCALCF.
  1671         10  HLCALCA PIC  X(0001).
  1672     05  HLCALCI PIC  X(0012).
  1673*    -------------------------------
  1674     05  HAKINDL PIC S9(0004) COMP.
  1675     05  HAKINDF PIC  X(0001).
  1676     05  FILLER REDEFINES HAKINDF.
  1677         10  HAKINDA PIC  X(0001).
  1678     05  HAKINDI PIC  X(0002).
  1679*    -------------------------------
  1680     05  HACDL PIC S9(0004) COMP.
  1681     05  HACDF PIC  X(0001).
  1682     05  FILLER REDEFINES HACDF.
  1683         10  HACDA PIC  X(0001).
  1684     05  HACDI PIC  X(0002).
  1685*    -------------------------------
  1686     05  HAEDESCL PIC S9(0004) COMP.
  1687     05  HAEDESCF PIC  X(0001).
  1688     05  FILLER REDEFINES HAEDESCF.
  1689         10  HAEDESCA PIC  X(0001).
  1690     05  HAEDESCI PIC  X(0003).
  1691*    -------------------------------
  1692     05  HATERML PIC S9(0004) COMP.
  1693     05  HATERMF PIC  X(0001).
  1694     05  FILLER REDEFINES HATERMF.
  1695         10  HATERMA PIC  X(0001).
  1696     05  HATERMI PIC  9(3).
  1697*    -------------------------------
  1698     05  HAREML PIC S9(0004) COMP.
  1699     05  HAREMF PIC  X(0001).
  1700     05  FILLER REDEFINES HAREMF.
  1701         10  HAREMA PIC  X(0001).
  1702     05  HAREMI PIC  X(0003).
  1703*    -------------------------------
  1704     05  HAPREML PIC S9(0004) COMP.
  1705     05  HAPREMF PIC  X(0001).
  1706     05  FILLER REDEFINES HAPREMF.
  1707         10  HAPREMA PIC  X(0001).
  1708     05  HAPREMI PIC  X(0011).
  1709*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  34
* EL1278.cbl
  1710     05  HAITDRL PIC S9(0004) COMP.
  1711     05  HAITDRF PIC  X(0001).
  1712     05  FILLER REDEFINES HAITDRF.
  1713         10  HAITDRA PIC  X(0001).
  1714     05  HAITDRI PIC  X(0011).
  1715*    -------------------------------
  1716     05  HAREFNDL PIC S9(0004) COMP.
  1717     05  HAREFNDF PIC  X(0001).
  1718     05  FILLER REDEFINES HAREFNDF.
  1719         10  HAREFNDA PIC  X(0001).
  1720     05  HAREFNDI PIC  X(0011).
  1721*    -------------------------------
  1722     05  HACANCL PIC S9(0004) COMP.
  1723     05  HACANCF PIC  X(0001).
  1724     05  FILLER REDEFINES HACANCF.
  1725         10  HACANCA PIC  X(0001).
  1726     05  HACANCI PIC  X(0008).
  1727*    -------------------------------
  1728     05  HACAL1L PIC S9(0004) COMP.
  1729     05  HACAL1F PIC  X(0001).
  1730     05  FILLER REDEFINES HACAL1F.
  1731         10  HACAL1A PIC  X(0001).
  1732     05  HACAL1I PIC  X(0001).
  1733*    -------------------------------
  1734     05  HACALCL PIC S9(0004) COMP.
  1735     05  HACALCF PIC  X(0001).
  1736     05  FILLER REDEFINES HACALCF.
  1737         10  HACALCA PIC  X(0001).
  1738     05  HACALCI PIC  X(0012).
  1739*    -------------------------------
  1740     05  TOPREML PIC S9(0004) COMP.
  1741     05  TOPREMF PIC  X(0001).
  1742     05  FILLER REDEFINES TOPREMF.
  1743         10  TOPREMA PIC  X(0001).
  1744     05  TOPREMI PIC  X(0011).
  1745*    -------------------------------
  1746     05  TOITDRL PIC S9(0004) COMP.
  1747     05  TOITDRF PIC  X(0001).
  1748     05  FILLER REDEFINES TOITDRF.
  1749         10  TOITDRA PIC  X(0001).
  1750     05  TOITDRI PIC  X(0011).
  1751*    -------------------------------
  1752     05  TORFNDL PIC S9(0004) COMP.
  1753     05  TORFNDF PIC  X(0001).
  1754     05  FILLER REDEFINES TORFNDF.
  1755         10  TORFNDA PIC  X(0001).
  1756     05  TORFNDI PIC  X(0011).
  1757*    -------------------------------
  1758     05  CANREAHL PIC S9(0004) COMP.
  1759     05  CANREAHF PIC  X(0001).
  1760     05  FILLER REDEFINES CANREAHF.
  1761         10  CANREAHA PIC  X(0001).
  1762     05  CANREAHI PIC  X(0015).
  1763*    -------------------------------
  1764     05  CANREAL PIC S9(0004) COMP.
  1765     05  CANREAF PIC  X(0001).
  1766     05  FILLER REDEFINES CANREAF.
  1767         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  35
* EL1278.cbl
  1768     05  CANREAI PIC  X(0001).
  1769*    -------------------------------
  1770     05  CLPYNHL PIC S9(0004) COMP.
  1771     05  CLPYNHF PIC  X(0001).
  1772     05  FILLER REDEFINES CLPYNHF.
  1773         10  CLPYNHA PIC  X(0001).
  1774     05  CLPYNHI PIC  X(0005).
  1775*    -------------------------------
  1776     05  CLPYNL PIC S9(0004) COMP.
  1777     05  CLPYNF PIC  X(0001).
  1778     05  FILLER REDEFINES CLPYNF.
  1779         10  CLPYNA PIC  X(0001).
  1780     05  CLPYNI PIC  X(0001).
  1781*    -------------------------------
  1782     05  HLREDL PIC S9(0004) COMP.
  1783     05  HLREDF PIC  X(0001).
  1784     05  FILLER REDEFINES HLREDF.
  1785         10  HLREDA PIC  X(0001).
  1786     05  HLREDI PIC  X(0014).
  1787*    -------------------------------
  1788     05  FREMTRML PIC S9(0004) COMP.
  1789     05  FREMTRMF PIC  X(0001).
  1790     05  FILLER REDEFINES FREMTRMF.
  1791         10  FREMTRMA PIC  X(0001).
  1792     05  FREMTRMI PIC  X(0003).
  1793*    -------------------------------
  1794     05  HERMSG1L PIC S9(0004) COMP.
  1795     05  HERMSG1F PIC  X(0001).
  1796     05  FILLER REDEFINES HERMSG1F.
  1797         10  HERMSG1A PIC  X(0001).
  1798     05  HERMSG1I PIC  X(0079).
  1799*    -------------------------------
  1800     05  HERMSG2L PIC S9(0004) COMP.
  1801     05  HERMSG2F PIC  X(0001).
  1802     05  FILLER REDEFINES HERMSG2F.
  1803         10  HERMSG2A PIC  X(0001).
  1804     05  HERMSG2I PIC  X(0079).
  1805*    -------------------------------
  1806     05  HPFKEYL PIC S9(0004) COMP.
  1807     05  HPFKEYF PIC  X(0001).
  1808     05  FILLER REDEFINES HPFKEYF.
  1809         10  HPFKEYA PIC  X(0001).
  1810     05  HPFKEYI PIC  99.
  1811*    -------------------------------
  1812     05  PFKEY11L PIC S9(0004) COMP.
  1813     05  PFKEY11F PIC  X(0001).
  1814     05  FILLER REDEFINES PFKEY11F.
  1815         10  PFKEY11A PIC  X(0001).
  1816     05  PFKEY11I PIC  X(0014).
  1817 01  EL127HO REDEFINES EL127HI.
  1818     05  FILLER            PIC  X(0012).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  HDATEO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  HTIMEO PIC  99.99.
  1825*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  36
* EL1278.cbl
  1826     05  FILLER            PIC  X(0003).
  1827     05  CMPNYIDO PIC  X(0003).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  USERIDO PIC  X(0004).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  HCARIERO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  HGROUPO PIC  X(0006).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  HSTATEO PIC  X(0002).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  HACCTNOO PIC  X(0010).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  HEFFDTO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  HCERTNOO PIC  X(0010).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  HCRTSFXO PIC  X(0001).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  HLNAMEO PIC  X(0015).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  HFNAMEO PIC  X(0010).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  HINITO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  LCLMDTHO PIC  X(0022).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  LCLMDTO PIC  X(0008).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  HPCYNO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ACLMDTHO PIC  X(0023).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ACLMDTO PIC  X(0008).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  PMTHDO PIC  X(0010).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  CNCDTHDO PIC  X(0007).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  37
* EL1278.cbl
  1884     05  HLKINDO PIC  X(0002).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  HLCDO PIC  X(0002).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  HLEDESCO PIC  X(0003).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  HLTERMO PIC  ZZ9.
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  HLREMO PIC  ZZ9.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  HLCANCO PIC  X(0008).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  HLCAL1O PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  HLCALCO PIC  X(0012).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  HAKINDO PIC  X(0002).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  HACDO PIC  X(0002).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  HAEDESCO PIC  X(0003).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  HATERMO PIC  ZZ9.
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  HAREMO PIC  ZZ9.
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  38
* EL1278.cbl
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  HACAL1O PIC  X(0001).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  HACALCO PIC  X(0012).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  CANREAHO PIC  X(0015).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  CANREAO PIC  X(0001).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  CLPYNHO PIC  X(0005).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  CLPYNO PIC  X(0001).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  FREMTRMO PIC  ZZ9.
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  HERMSG1O PIC  X(0079).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  HERMSG2O PIC  X(0079).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  HPFKEYO PIC  99.
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  PFKEY11O PIC  X(0014).
  1987*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  39
* EL1278.cbl
  1989*                            COPY ELCCALC.
  1990******************************************************************
  1991*                                                                *
  1992*                           ELCCALC.                            *
  1993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1994*                            VMOD=2.025                          *
  1995*                                                                *
  1996*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1997*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1998*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1999*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2000*                                                                *
  2001*  PASSED TO ELRTRM                                              *
  2002*  -----------------                                             *
  2003*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2004*  ORIGINAL TERM                                                 *
  2005*  BEGINNING DATE                                                *
  2006*  ENDING DATE                                                   *
  2007*  COMPANY I.D.                                                  *
  2008*  ACCOUNT MASTER USER FIELD                                     *
  2009*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2010*  FREE LOOK DAYS                                                *
  2011*                                                                *
  2012*  RETURNED FROM ELRTRM                                          *
  2013*  ---------------------                                         *
  2014*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2015*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2016*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2017*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2018*----------------------------------------------------------------*
  2019*  PASSED TO ELRAMT                                              *
  2020*  ----------------                                              *
  2021*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2022*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2023*  ORIGINAL AMOUNT                                               *
  2024*  ALTERNATE BENEFIT (BALLON)                                    *
  2025*  A.P.R. - NET PAY ONLY                                         *
  2026*  METHOD
  2027*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2028*  COMPANY I.D.                                                  *
  2029*  BENEFIT TYPE                                                  *
  2030*                                                                *
  2031*  RETURNED FROM ELRAMT                                          *
  2032*  --------------------                                          *
  2033*  REMAINING AMOUNT 1 - CURRENT                                  *
  2034*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2035*  REMAINING AMOUNT FACTOR
  2036*----------------------------------------------------------------*
  2037*  PASSED TO ELRESV                                              *
  2038*  -----------------                                             *
  2039*  CERTIFICATE EFFECTIVE DATE                                    *
  2040*  VALUATION DATE                                                *
  2041*  PAID THRU DATE                                                *
  2042*  BENEFIT                                                       *
  2043*  INCURRED DATE                                                 *
  2044*  REPORTED DATE                                                 *
  2045*  ISSUE AGE                                                     *
  2046*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  40
* EL1278.cbl
  2047*  CDT PERCENT                                                   *
  2048*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2049* *CLAIM TYPE (LIFE, A/H)                                        *
  2050* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2051* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2052*                                                                *
  2053*  RETURNED FROM ELRESV                                          *
  2054*  --------------------                                          *
  2055*  CDT TABLE USED                                                *
  2056*  CDT FACTOR USED                                               *
  2057*  PAY TO CURRENT RESERVE                                        *
  2058*  I.B.N.R. - A/H ONLY                                           *
  2059*  FUTURE (ACCRUED) AH ONLY                                      *
  2060*----------------------------------------------------------------*
  2061*  PASSED TO ELRATE                                              *
  2062*  ----------------                                              *
  2063*  CERT ISSUE DATE                                               *
  2064*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2065*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2066*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2067*  STATE CODE (CLIENT DEFINED)                                   *
  2068*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2069*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2070*  DEVIATION CODE                                                *
  2071*  ISSUE AGE                                                     *
  2072*  ORIGINAL BENEFIT AMOUNT                                       *
  2073*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2074*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2075*  BENEFIT KIND (LIFE OR A/H)                                    *
  2076*  A.P.R.                                                        *
  2077*  METHOD
  2078*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2079*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2080*  COMPANY I.D. (3 CHARACTER)                                    *
  2081*  BENEFIT CODE                                                  *
  2082*  BENEFIT OVERRIDE CODE                                         *
  2083*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2084*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2085*  JOINT INDICATOR (CSL ONLY)                                    *
  2086*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2087*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2088*                                                                *
  2089*  RETURNED FROM ELRATE                                          *
  2090*  --------------------                                          *
  2091*  CALCULATED PREMIUM                                            *
  2092*  PREMIUM RATE                                                  *
  2093*  MORTALITY CODE                                                *
  2094*  MAX ATTAINED AGE                                              *
  2095*  MAX AGE                                                       *
  2096*  MAX TERM                                                      *
  2097*  MAX MONTHLY BENEFIT                                           *
  2098*  MAX TOTAL BENIFIT                                             *
  2099*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2100*----------------------------------------------------------------*
  2101*  PASSED TO ELRFND                                              *
  2102*  ----------------                                              *
  2103*  CERT ISSUE DATE                                               *
  2104*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  41
* EL1278.cbl
  2105*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2106*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2107*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2108*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2109*  STATE CODE (CLIENT DEFINED)                                   *
  2110*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2111*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2112*  DEVIATION CODE                                                *
  2113*  ISSUE AGE                                                     *
  2114*  ORIGINAL BENEFIT AMOUNT                                       *
  2115*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2116*  PROCESS TYPE (CANCEL)                                         *
  2117*  BENEFIT KIND (LIFE OR A/H)                                    *
  2118*  A.P.R.                                                        *
  2119*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2120*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2121*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2122*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2123*  COMPANY I.D. (3 CHARACTER)                                    *
  2124*  BENEFIT CODE                                                  *
  2125*  BENEFIT OVERRIDE CODE                                         *
  2126*                                                                *
  2127*  RETURNED FROM ELRFND                                          *
  2128*  --------------------                                          *
  2129*  CALCULATED REFUND                                             *
  2130*----------------------------------------------------------------*
  2131*  PASSED TO ELEARN                                              *
  2132*  ----------------                                              *
  2133*  CERT ISSUE DATE                                               *
  2134*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2135*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2136*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2137*  STATE CODE (CLIENT DEFINED)                                   *
  2138*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2139*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2140*  DEVIATION CODE                                                *
  2141*  ISSUE AGE                                                     *
  2142*  ORIGINAL BENEFIT AMOUNT                                       *
  2143*  BENEFIT KIND (LIFE OR A/H)                                    *
  2144*  A.P.R.                                                        *
  2145*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2146*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2147*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2148*  COMPANY I.D. (3 CHARACTER)                                    *
  2149*  BENEFIT CODE                                                  *
  2150*  BENEFIT OVERRIDE CODE                                         *
  2151*                                                                *
  2152*  RETURNED FROM ELEARN                                          *
  2153*  --------------------                                          *
  2154*  INDICATED  EARNINGS                                           *
  2155*----------------------------------------------------------------*
  2156*                 LENGTH = 450                                   *
  2157*                                                                *
  2158******************************************************************
  2159******************************************************************
  2160*                   C H A N G E   L O G
  2161*
  2162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  42
* EL1278.cbl
  2163*-----------------------------------------------------------------
  2164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2165* EFFECTIVE    NUMBER
  2166*-----------------------------------------------------------------
  2167* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2168* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2169* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2170* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2171* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2172* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2173* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2174* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2175* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2176* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2177******************************************************************
  2178
  2179 01  CALCULATION-PASS-AREA.
  2180     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2181                                     COMP.
  2182
  2183     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2184       88  NO-CP-ERROR                             VALUE ZERO.
  2185       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2186                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2187       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2188       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2189       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2190       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2191       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2192       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2193       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2194       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2195       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2196       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2197       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2198       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2199       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2200       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2201       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2202       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2203       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2204
  2205     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2206       88  NO-CP-ERROR-2                           VALUE ZERO.
  2207***********************  INPUT AREAS ****************************
  2208
  2209     12  CP-CALCULATION-AREA.
  2210         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2211         16  CP-CERT-EFF-DT        PIC XX.
  2212         16  CP-VALUATION-DT       PIC XX.
  2213         16  CP-PAID-THRU-DT       PIC XX.
  2214         16  CP-BENEFIT-TYPE       PIC X.
  2215           88  CP-AH                               VALUE 'A' 'D'
  2216                                                   'I' 'U'.
  2217           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2218           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2219         16  CP-INCURRED-DT        PIC XX.
  2220         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  43
* EL1278.cbl
  2221         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2222         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2223         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2224                                     COMP-3.
  2225         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2226                                     COMP-3.
  2227         16  CP-CDT-METHOD         PIC X.
  2228           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2229           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2230           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2231         16  CP-CLAIM-TYPE         PIC X.
  2232           88  CP-AH-CLAIM                         VALUE 'A'.
  2233           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2234         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2235                                     COMP-3.
  2236         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2237                                     COMP-3.
  2238         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2239                                     COMP-3.
  2240         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2241                                     COMP-3.
  2242         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2243                                     COMP-3.
  2244         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2245                                     COMP-3.
  2246         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2247                                     COMP-3.
  2248         16  CP-REM-TERM-METHOD    PIC X.
  2249           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2250           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2251           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2252           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2253           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2254           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2255           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2256         16  CP-EARNING-METHOD     PIC X.
  2257           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2258           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2259           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2260           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2261           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2262           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2263           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2264           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2265           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2266           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2267           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2268           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2269           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2270           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2271         16  CP-PROCESS-TYPE       PIC X.
  2272           88  CP-CLAIM                            VALUE '1'.
  2273           88  CP-CANCEL                           VALUE '2'.
  2274           88  CP-ISSUE                            VALUE '3'.
  2275         16  CP-SPECIAL-CALC-CD    PIC X.
  2276           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2277           88  CP-1-MTH-INTEREST               VALUE ' '.
  2278           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  44
* EL1278.cbl
  2279           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2280           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2281           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2282           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2283           88  CP-FARM-PLAN                    VALUE 'F'.
  2284           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2285           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2286           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2287           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2288           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2289           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2290           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2291           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2292           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2293           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2294                                                     'W' 'X'.
  2295           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2296           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2297           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2298           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2299           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2300           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2301           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2302           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2303           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2304           88  CP-CSL-METH-1                   VALUE '5'.
  2305           88  CP-CSL-METH-2                   VALUE '6'.
  2306           88  CP-CSL-METH-3                   VALUE '7'.
  2307           88  CP-CSL-METH-4                   VALUE '8'.
  2308
  2309         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2310                                     COMP-3.
  2311         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2312         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2313         16  CP-STATE              PIC XX          VALUE SPACE.
  2314         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2315         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2316           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2317               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2318         16  CP-R78-OPTION         PIC X.
  2319           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2320           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2321
  2322         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2323         16  CP-IBNR-RESERVE-SW    PIC X.
  2324         16  CP-CLAIM-STATUS       PIC X.
  2325         16  CP-RATE-FILE          PIC X.
  2326         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2327                                     COMP-3.
  2328
  2329         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2330         16  CP-AH-OVERRIDE-CODE   PIC X.
  2331
  2332         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2333                                     COMP-3.
  2334         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2335                                   PIC S9(5)V99 COMP-3.
  2336         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  45
* EL1278.cbl
  2337                                     COMP-3.
  2338         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2339                                     COMP-3.
  2340         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2341                                     COMP-3.
  2342         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2343                                  PIC S9(7)V99 COMP-3.
  2344
  2345         16  CP-PAID-FROM-DATE     PIC X(02).
  2346         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2347         16  CP-EXT-DAYS-CALC      PIC X.
  2348           88  CP-EXT-NO-CHG                   VALUE ' '.
  2349           88  CP-EXT-CHG-LF                   VALUE '1'.
  2350           88  CP-EXT-CHG-AH                   VALUE '2'.
  2351           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2352         16  CP-DOMICILE-STATE     PIC XX.
  2353         16  CP-CARRIER            PIC X.
  2354         16  CP-REIN-FLAG          PIC X.
  2355         16  CP-REM-TRM-CALC-OPTION PIC X.
  2356           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2357                      '2' '3' '4' '5'.
  2358           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2359           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2360           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2361           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2362           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2363           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2364           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2365           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2366         16  CP-SIG-SWITCH         PIC X.
  2367         16  CP-RATING-METHOD      PIC X.
  2368           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2369           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2370           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2371           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2372           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2373           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2374           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2375           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2376           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2377         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2378                                     COMP-3.
  2379         16  CP-BEN-CATEGORY       PIC X.
  2380         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2381         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2382                                   PIC S99V9(5) COMP-3.
  2383         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2384         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2385                                   PIC S99V9(5) COMP-3.
  2386         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2387         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2388         16  CP-EXPIRE-DT          PIC XX.
  2389         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2390         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2391         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2392         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2393         16  CP-DDF-SPEC-CALC      PIC X.
  2394             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  46
* EL1278.cbl
  2395             88  CP-CALC-CLP              VALUE 'C'.
  2396         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2397         16  CP-CANCEL-REASON      PIC X.
  2398         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2399         16  CP-PMT-MODE           PIC X.
  2400         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2401         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2402         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2403         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2404         16  FILLER                PIC X.
  2405
  2406***************    OUTPUT FROM ELRESV   ************************
  2407
  2408         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2409
  2410         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2411                                     COMP-3.
  2412         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2413                                     COMP-3.
  2414         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2415                                     COMP-3.
  2416         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2417                                     COMP-3.
  2418         16  FILLER                PIC X(09).
  2419***************    OUTPUT FROM ELRTRM   *************************
  2420
  2421         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2422                                     COMP-3.
  2423         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2424                                     COMP-3.
  2425         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2426                                     COMP-3.
  2427         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2428                                     COMP-3.
  2429         16  FILLER                PIC X(12).
  2430
  2431***************    OUTPUT FROM ELRAMT   *************************
  2432
  2433         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2434                                     COMP-3.
  2435         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2436                                     COMP-3.
  2437         16  FILLER                PIC X(12).
  2438
  2439***************    OUTPUT FROM ELRATE   *************************
  2440
  2441         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2442                                     COMP-3.
  2443         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2444                                     COMP-3.
  2445         16  CP-MORTALITY-CODE     PIC X(4).
  2446         16  CP-RATE-EDIT-FLAG     PIC X.
  2447             88  CP-RATES-NEED-APR                  VALUE '1'.
  2448         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2449                                     COMP-3.
  2450         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2451         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2452         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  47
* EL1278.cbl
  2453                                   PIC S9(7)V99 COMP-3.
  2454         16  FILLER                PIC X(07).
  2455
  2456***************    OUTPUT FROM ELRFND   *************************
  2457
  2458         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2459                                     COMP-3.
  2460         16  CP-REFUND-TYPE-USED   PIC X.
  2461           88  CP-R-AS-R78                         VALUE '1'.
  2462           88  CP-R-AS-PRORATA                     VALUE '2'.
  2463           88  CP-R-AS-CALIF                       VALUE '3'.
  2464           88  CP-R-AS-TEXAS                       VALUE '4'.
  2465           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2466           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2467           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2468           88  CP-R-AS-MEAN                        VALUE '8'.
  2469           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2470           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2471           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2472           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2473           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2474           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2475         16  FILLER                PIC X(12).
  2476
  2477***************    OUTPUT FROM ELEARN   *************************
  2478
  2479         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2484                                     COMP-3.
  2485         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2490                                     COMP-3.
  2491         16  CP-EARNING-TYPE-USED  PIC X.
  2492           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2493           88  CP-E-AS-R78                         VALUE '1'.
  2494           88  CP-E-AS-PRORATA                     VALUE '2'.
  2495           88  CP-E-AS-TEXAS                       VALUE '4'.
  2496           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2497           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2498           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2499           88  CP-E-AS-MEAN                        VALUE '8'.
  2500           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2501         16  FILLER                PIC X(12).
  2502
  2503***************    OUTPUT FROM ELPMNT   *************************
  2504
  2505         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2506                                     COMP-3.
  2507         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2508                                     COMP-3.
  2509         16  FILLER                PIC X(12).
  2510
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  48
* EL1278.cbl
  2511***************   MISC WORK AREAS    *****************************
  2512         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2513                                     COMP-3.
  2514         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2515                                     COMP-3.
  2516         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2517                                     COMP-3.
  2518         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2519                                     COMP-3.
  2520         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2521                                     COMP-3.
  2522         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2523                                     COMP-3.
  2524         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2525             88  OPEN-RATE-FILE                   VALUE 'O'.
  2526             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2527             88  IO-ERROR                         VALUE 'E'.
  2528
  2529         16  CP-FIRST-PAY-DATE     PIC XX.
  2530
  2531         16  CP-JOINT-INDICATOR    PIC X.
  2532
  2533         16  CP-RESERVE-REMAINING-TERM
  2534                                   PIC S9(4)V9    VALUE ZERO
  2535                                     COMP-3.
  2536
  2537         16  CP-INSURED-BIRTH-DT   PIC XX.
  2538
  2539         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2540                                     COMP-3.
  2541
  2542         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2543                                     COMP-3.
  2544
  2545         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2546                                     COMP-3.
  2547
  2548         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2549                                     COMP-3.
  2550
  2551         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2552                                     COMP-3.
  2553
  2554         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2555                                     COMP-3.
  2556
  2557         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2558                                     COMP-3.
  2559
  2560         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2561             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2562
  2563         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2568         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  49
* EL1278.cbl
  2569         16  cp-net-only-state     pic x value spaces.
  2570         16  FILLER                PIC X(13).
  2571******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  50
* EL1278.cbl
  2573*                            COPY ERCNOTE.
  2574******************************************************************
  2575*                                                                *
  2576*                                                                *
  2577*                            ERCNOTE                             *
  2578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2579*                            VMOD=2.003                          *
  2580*                                                                *
  2581*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2582*                                                                *
  2583*        FILE TYPE= VSAM,KSDS                                    *
  2584*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2585*                                                                *
  2586*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2587*                                                                *
  2588*        LOG = YES                                               *
  2589*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2590*                                                                *
  2591******************************************************************
  2592*                   C H A N G E   L O G
  2593*
  2594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2595*-----------------------------------------------------------------
  2596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2597* EFFECTIVE    NUMBER
  2598*-----------------------------------------------------------------
  2599* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2600*                                FILE WILL CONTAIN BILLING NOTES O
  2601******************************************************************
  2602
  2603 01  CERTIFICATE-NOTE.
  2604     12  CN-RECORD-ID                PIC  XX.
  2605         88  VALID-CN-ID                  VALUE 'CN'.
  2606
  2607     12  CN-CONTROL-PRIMARY.
  2608         16  CN-COMPANY-CD           PIC X.
  2609         16  CN-CARRIER              PIC X.
  2610         16  CN-GROUPING.
  2611             20 CN-GROUPING-PREFIX   PIC XXX.
  2612             20 CN-GROUPING-PRIME    PIC XXX.
  2613         16  CN-STATE                PIC XX.
  2614         16  CN-ACCOUNT.
  2615             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2616             20 CN-ACCOUNT-PRIME     PIC X(6).
  2617         16  CN-CERT-EFF-DT          PIC XX.
  2618         16  CN-CERT-NO.
  2619             20  CN-CERT-PRIME       PIC X(10).
  2620             20  CN-CERT-SFX         PIC X.
  2621
  2622     12  CN-BILLING-START-LINE-NO    PIC 99.
  2623     12  CN-BILLING-END-LINE-NO      PIC 99.
  2624
  2625     12  CN-LINES.
  2626         16  CN-LINE OCCURS 10       PIC X(77).
  2627
  2628     12  CN-LAST-MAINT-DT            PIC XX.
  2629     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2630     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  51
* EL1278.cbl
  2631     12  FILLER                      PIC X(6).
  2632******************************************************************
  2633*                            COPY ERCCTBL.
  2634******************************************************************
  2635*                                                                *
  2636*                                                                *
  2637*                            ERCCTBL                             *
  2638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2639*                            VMOD=2.003
  2640*                                                                *
  2641*   ONLINE CREDIT SYSTEM                                         *
  2642*                                                                *
  2643*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2649*       ALTERNATE PATH = NONE                                    *
  2650*                                                                *
  2651*   LOG = NO                                                     *
  2652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2653*                                                                *
  2654*                                                                *
  2655******************************************************************
  2656
  2657 01  COMM-TABLE-RECORD.
  2658     12  CT-RECORD-ID                      PIC XX.
  2659         88  VALID-CT-ID                      VALUE 'CT'.
  2660
  2661     12  CT-CONTROL-PRIMARY.
  2662         16  CT-COMPANY-CD                 PIC X.
  2663         16  CT-TABLE                      PIC XXX.
  2664         16  CT-CNTRL-2.
  2665             20  CT-BEN-TYPE               PIC X.
  2666             20  CT-BEN-CODE               PIC XX.
  2667
  2668     12  CT-MAINT-INFORMATION.
  2669         16  CT-LAST-MAINT-DT              PIC XX.
  2670         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2671         16  CT-LAST-MAINT-USER            PIC X(4).
  2672         16  FILLER                        PIC X(31).
  2673
  2674     12  CT-LIMITS.
  2675         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2676
  2677         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2678
  2679         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2680
  2681     12  CT-RATES.
  2682         16  CT-RTX          OCCURS 27 TIMES.
  2683             20  CT-RT                     PIC SV9(5)     COMP-3.
  2684             20  CT-RT-R   REDEFINES
  2685                 CT-RT                     PIC XXX.
  2686
  2687     12  FILLER                            PIC  X(42).
  2688
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  52
* EL1278.cbl
  2689******************************************************************
  2690
  2691****************************************************************
  2692*
  2693* Copyright (c) 2007 by Clerity Solutions, Inc.
  2694* All rights reserved.
  2695*
  2696****************************************************************
  2697 01  DFHEIV.
  2698   02  DFHEIV0               PIC X(35).
  2699   02  DFHEIV1               PIC X(08).
  2700   02  DFHEIV2               PIC X(08).
  2701   02  DFHEIV3               PIC X(08).
  2702   02  DFHEIV4               PIC X(06).
  2703   02  DFHEIV5               PIC X(04).
  2704   02  DFHEIV6               PIC X(04).
  2705   02  DFHEIV7               PIC X(02).
  2706   02  DFHEIV8               PIC X(02).
  2707   02  DFHEIV9               PIC X(01).
  2708   02  DFHEIV10              PIC S9(7) COMP-3.
  2709   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2710   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2711   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2712   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2713   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2714   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2715   02  DFHEIV17              PIC X(04).
  2716   02  DFHEIV18              PIC X(04).
  2717   02  DFHEIV19              PIC X(04).
  2718   02  DFHEIV20              USAGE IS POINTER.
  2719   02  DFHEIV21              USAGE IS POINTER.
  2720   02  DFHEIV22              USAGE IS POINTER.
  2721   02  DFHEIV23              USAGE IS POINTER.
  2722   02  DFHEIV24              USAGE IS POINTER.
  2723   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2724   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2725   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2726   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2727   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2728   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2729   02  FILLER                PIC X(02).
  2730   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2731   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2732   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2733   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2734   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2735 LINKAGE  SECTION.
  2736*****************************************************************
  2737*                                                               *
  2738* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2739* All rights reserved.                                          *
  2740*                                                               *
  2741*****************************************************************
  2742 01  dfheiblk.
  2743     02  eibtime          pic s9(7) comp-3.
  2744     02  eibdate          pic s9(7) comp-3.
  2745     02  eibtrnid         pic x(4).
  2746     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  53
* EL1278.cbl
  2747     02  eibtrmid         pic x(4).
  2748     02  dfheigdi         pic s9(4) comp.
  2749     02  eibcposn         pic s9(4) comp.
  2750     02  eibcalen         pic s9(4) comp.
  2751     02  eibaid           pic x(1).
  2752     02  eibfiller1       pic x(1).
  2753     02  eibfn            pic x(2).
  2754     02  eibfiller2       pic x(2).
  2755     02  eibrcode         pic x(6).
  2756     02  eibfiller3       pic x(2).
  2757     02  eibds            pic x(8).
  2758     02  eibreqid         pic x(8).
  2759     02  eibrsrce         pic x(8).
  2760     02  eibsync          pic x(1).
  2761     02  eibfree          pic x(1).
  2762     02  eibrecv          pic x(1).
  2763     02  eibsend          pic x(1).
  2764     02  eibatt           pic x(1).
  2765     02  eibeoc           pic x(1).
  2766     02  eibfmh           pic x(1).
  2767     02  eibcompl         pic x(1).
  2768     02  eibsig           pic x(1).
  2769     02  eibconf          pic x(1).
  2770     02  eiberr           pic x(1).
  2771     02  eibrldbk         pic x(1).
  2772     02  eiberrcd         pic x(4).
  2773     02  eibsynrb         pic x(1).
  2774     02  eibnodat         pic x(1).
  2775     02  eibfiller5       pic x(2).
  2776     02  eibresp          pic 9(09) comp.
  2777     02  eibresp2         pic 9(09) comp.
  2778     02  dfheigdj         pic s9(4) comp.
  2779     02  dfheigdk         pic s9(4) comp.
  2780
  2781 01  DFHCOMMAREA                 PIC  X(1024).
  2782
  2783*01 PARMLIST .
  2784*    12  FILLER                  PIC S9(08)      COMP.
  2785*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2786*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2787*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2788*                            COPY ELCCNTL.
  2789******************************************************************
  2790*                                                                *
  2791*                                                                *
  2792*                            ELCCNTL.                            *
  2793*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2794*                            VMOD=2.059                          *
  2795*                                                                *
  2796*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2797*                                                                *
  2798*   FILE TYPE = VSAM,KSDS                                        *
  2799*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2800*                                                                *
  2801*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2802*       ALTERNATE INDEX = NONE                                   *
  2803*                                                                *
  2804*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  54
* EL1278.cbl
  2805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2806******************************************************************
  2807*                   C H A N G E   L O G
  2808*
  2809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2810*-----------------------------------------------------------------
  2811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2812* EFFECTIVE    NUMBER
  2813*-----------------------------------------------------------------
  2814* 082503                   PEMA  ADD BENEFIT GROUP
  2815* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2816* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2817* 092705    2005050300006  PEMA  ADD SPP LEASES
  2818* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2819* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2820* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2821* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2822* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2823* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2824* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2825* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2826* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2827* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2828******************************************************************
  2829*
  2830 01  CONTROL-FILE.
  2831     12  CF-RECORD-ID                       PIC XX.
  2832         88  VALID-CF-ID                        VALUE 'CF'.
  2833
  2834     12  CF-CONTROL-PRIMARY.
  2835         16  CF-COMPANY-ID                  PIC XXX.
  2836         16  CF-RECORD-TYPE                 PIC X.
  2837             88  CF-COMPANY-MASTER              VALUE '1'.
  2838             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2839             88  CF-STATE-MASTER                VALUE '3'.
  2840             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2841             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2842             88  CF-CARRIER-MASTER              VALUE '6'.
  2843             88  CF-MORTALITY-MASTER            VALUE '7'.
  2844             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2845             88  CF-TERMINAL-MASTER             VALUE '9'.
  2846             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2847             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2848             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2849             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2850             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2851             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2852             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2853             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2854             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2855         16  CF-ACCESS-CD-GENL              PIC X(4).
  2856         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2857             20  CF-PROCESSOR               PIC X(4).
  2858         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2859             20  CF-STATE-CODE              PIC XX.
  2860             20  FILLER                     PIC XX.
  2861         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2862             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  55
* EL1278.cbl
  2863             20  CF-HI-BEN-IN-REC           PIC XX.
  2864         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2865             20  FILLER                     PIC XXX.
  2866             20  CF-CARRIER-CNTL            PIC X.
  2867         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2868             20  FILLER                     PIC XX.
  2869             20  CF-HI-TYPE-IN-REC          PIC 99.
  2870         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2871             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2872                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2873             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2874             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2875         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2876             20  FILLER                     PIC X.
  2877             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2878         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2879             20  FILLER                     PIC XX.
  2880             20  CF-MORTGAGE-PLAN           PIC XX.
  2881         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2882
  2883     12  CF-LAST-MAINT-DT                   PIC XX.
  2884     12  CF-LAST-MAINT-BY                   PIC X(4).
  2885     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2886
  2887     12  CF-RECORD-BODY                     PIC X(728).
  2888
  2889
  2890****************************************************************
  2891*             COMPANY MASTER RECORD                            *
  2892****************************************************************
  2893
  2894     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2895         16  CF-COMPANY-ADDRESS.
  2896             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2897             20  CF-CL-IN-CARE-OF           PIC X(30).
  2898             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2899             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2900             20  CF-CL-CITY-STATE           PIC X(30).
  2901             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2902             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2903         16  CF-COMPANY-CD                  PIC X.
  2904         16  CF-COMPANY-PASSWORD            PIC X(8).
  2905         16  CF-SECURITY-OPTION             PIC X.
  2906             88  ALL-SECURITY                   VALUE '1'.
  2907             88  COMPANY-VERIFY                 VALUE '2'.
  2908             88  PROCESSOR-VERIFY               VALUE '3'.
  2909             88  NO-SECURITY                    VALUE '4'.
  2910             88  ALL-BUT-TERM                   VALUE '5'.
  2911         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2912             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2913         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2914             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2915         16  CF-INFORCE-LOCATION            PIC X.
  2916             88  CERTS-ARE-ONLINE               VALUE '1'.
  2917             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2918             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2919         16  CF-LOWER-CASE-LETTERS          PIC X.
  2920         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  56
* EL1278.cbl
  2921             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2922             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2923             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2924             88  CF-ACCNT-CNTL                  VALUE '3'.
  2925             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2926
  2927         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2928         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2929
  2930         16  CF-LGX-CREDIT-USER             PIC X.
  2931             88  CO-IS-NOT-USER                 VALUE 'N'.
  2932             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2933
  2934         16 CF-CREDIT-CALC-CODES.
  2935             20  CF-CR-REM-TERM-CALC PIC X.
  2936               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2937               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2938               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2939               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2940               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2941               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2942               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2943             20  CF-CR-R78-METHOD           PIC X.
  2944               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2945               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2946
  2947         16  CF-CLAIM-CONTROL-COUNTS.
  2948             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2949                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2950
  2951             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2952                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2953
  2954             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2955                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2956
  2957             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2958                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2959
  2960         16  CF-CURRENT-MONTH-END           PIC XX.
  2961
  2962         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2963             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2964             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2965             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2966             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2967                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2968                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2969             20  CF-CO-PREM-REJECT-SW       PIC X.
  2970                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2971                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2972             20  CF-CO-REF-REJECT-SW        PIC X.
  2973                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2974                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2975
  2976         16  CF-CO-REPORTING-DT             PIC XX.
  2977         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2978         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  57
* EL1278.cbl
  2979           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2980           88  CF-CO-MONTH-END                  VALUE '1'.
  2981
  2982         16  CF-LGX-CLAIM-USER              PIC X.
  2983             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2984             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2985
  2986         16  CF-CREDIT-EDIT-CONTROLS.
  2987             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2988             20  CF-MIN-AGE                 PIC 99.
  2989             20  CF-DEFAULT-AGE             PIC 99.
  2990             20  CF-MIN-TERM                PIC S999      COMP-3.
  2991             20  CF-MAX-TERM                PIC S999      COMP-3.
  2992             20  CF-DEFAULT-SEX             PIC X.
  2993             20  CF-JOINT-AGE-INPUT         PIC X.
  2994                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2995             20  CF-BIRTH-DATE-INPUT        PIC X.
  2996                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2997             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2998                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2999                 88  CF-ZERO-CARRIER            VALUE '1'.
  3000                 88  CF-ZERO-GROUPING           VALUE '2'.
  3001                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3002             20  CF-EDIT-SW                 PIC X.
  3003                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3004             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3005             20  CF-CR-PR-METHOD            PIC X.
  3006               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3007               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3008             20  FILLER                     PIC X.
  3009
  3010         16  CF-CREDIT-MISC-CONTROLS.
  3011             20  CF-REIN-TABLE-SW           PIC X.
  3012                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3013             20  CF-COMP-TABLE-SW           PIC X.
  3014                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3015             20  CF-EXPERIENCE-RETENTION-AGE
  3016                                            PIC S9        COMP-3.
  3017             20  CF-CONVERSION-DT           PIC XX.
  3018             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3019             20  CF-RUN-FREQUENCY-SW        PIC X.
  3020                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3021                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3022
  3023             20  CF-CR-CHECK-NO-CONTROL.
  3024                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3025                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3026                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3027                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3028                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3029                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3030
  3031                 24  CF-CR-CHECK-COUNT       REDEFINES
  3032                     CF-CR-CHECK-COUNTER      PIC X(4).
  3033
  3034                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3035                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3036
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  58
* EL1278.cbl
  3037                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3038                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3039                 24  CF-MAIL-PROCESSING       PIC X.
  3040                     88  MAIL-PROCESSING          VALUE 'Y'.
  3041
  3042         16  CF-MISC-SYSTEM-CONTROL.
  3043             20  CF-SYSTEM-C                 PIC X.
  3044                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3045             20  CF-SYSTEM-D                 PIC X.
  3046                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3047             20  CF-SOC-SEC-NO-SW            PIC X.
  3048                 88  SOC-SEC-NO-USED             VALUE '1'.
  3049             20  CF-MEMBER-NO-SW             PIC X.
  3050                 88  MEMBER-NO-USED              VALUE '1'.
  3051             20  CF-TAX-ID-NUMBER            PIC X(11).
  3052             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3053             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3054                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3055                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3056                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3057                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3058             20  CF-SYSTEM-E                 PIC X.
  3059                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3060
  3061         16  CF-LGX-LIFE-USER               PIC X.
  3062             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3063             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3064
  3065         16  CF-CR-MONTH-END-DT             PIC XX.
  3066
  3067         16  CF-FILE-MAINT-DATES.
  3068             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3069                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3070             20  CF-LAST-BATCH       REDEFINES
  3071                 CF-LAST-BATCH-NO               PIC X(4).
  3072             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3073             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3074             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3075             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3076             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3077             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3078             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3079             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3080             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3081             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3082
  3083         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3084         16  FILLER                         PIC X.
  3085
  3086         16  CF-ALT-MORT-CODE               PIC X(4).
  3087         16  CF-MEMBER-CAPTION              PIC X(10).
  3088
  3089         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3090             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3091             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3092             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3093             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3094             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  59
* EL1278.cbl
  3095
  3096         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3097
  3098         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3099         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3100         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3101         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3102
  3103         16  CF-AH-OVERRIDE-L1              PIC X.
  3104         16  CF-AH-OVERRIDE-L2              PIC XX.
  3105         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3106         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3107
  3108         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3109         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3110
  3111         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3112         16  CF-AR-LAST-EL860-DT            PIC XX.
  3113         16  CF-MP-MONTH-END-DT             PIC XX.
  3114
  3115         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3116         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3117             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3118
  3119         16  CF-AR-MONTH-END-DT             PIC XX.
  3120
  3121         16  CF-CRDTCRD-USER                PIC X.
  3122             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3123             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3124
  3125         16  CF-CC-MONTH-END-DT             PIC XX.
  3126
  3127         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3128
  3129         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3130             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3131             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3132             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3133         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3134         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3135         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3136         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3137             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3138             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3139         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3140         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3141         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3142             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3143         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3144
  3145         16  CF-CL-ZIP-CODE.
  3146             20  CF-CL-ZIP-PRIME.
  3147                 24  CF-CL-ZIP-1ST          PIC X.
  3148                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3149                 24  FILLER                 PIC X(4).
  3150             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3151         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3152             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  60
* EL1278.cbl
  3153             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3154             20  FILLER                     PIC XXX.
  3155
  3156         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3157         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3158         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3159         16  CF-CO-OPTION-START-DATE        PIC XX.
  3160         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3161           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3162                                                      '3' '4'.
  3163           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3164           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3165           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3166           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3167           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3168           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3169
  3170         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3171
  3172         16  CF-PAYMENT-APPROVAL-LEVELS.
  3173             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3174             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3175             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3176             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3177             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3178             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3179
  3180         16  CF-END-USER-REPORTING-USER     PIC X.
  3181             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3182             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3183
  3184         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3185             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3186             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3187
  3188         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3189
  3190         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3191         16  FILLER                         PIC X.
  3192
  3193         16  CF-CREDIT-ARCHIVE-CNTL.
  3194             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3195             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3196             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3197
  3198         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3199
  3200         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3201             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3202             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3203
  3204         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3205             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3206             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3207
  3208         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3209
  3210         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  61
* EL1278.cbl
  3211             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3212             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3213             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3214         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3215         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3216         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3217         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3218         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3219         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3220         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3221         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3222         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3223                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3224         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3225                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3226
  3227         16  CF-CO-OVER-SHORT.
  3228             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3229             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3230
  3231*         16  FILLER                         PIC X(102).
  3232         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3233             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3234             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3235
  3236         16  CF-AH-APPROVAL-DAYS.
  3237             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3238             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3239             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3240             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3241
  3242         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3243
  3244         16  CF-APPROV-LEV-5.
  3245             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3246             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3247             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3248
  3249         16  FILLER                         PIC X(68).
  3250****************************************************************
  3251*             PROCESSOR/USER RECORD                            *
  3252****************************************************************
  3253
  3254     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3255         16  CF-PROCESSOR-NAME              PIC X(30).
  3256         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3257         16  CF-PROCESSOR-TITLE             PIC X(26).
  3258         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3259                 88  MESSAGE-YES                VALUE 'Y'.
  3260                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3261
  3262*****************************************************
  3263****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3264****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3265****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3266****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3267*****************************************************
  3268
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  62
* EL1278.cbl
  3269         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3270             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3271             20  CF-APPLICATION-FORCE       PIC X.
  3272             20  CF-INDIVIDUAL-APP.
  3273                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3274                     28  CF-BROWSE-APP      PIC X.
  3275                     28  CF-UPDATE-APP      PIC X.
  3276
  3277         16  CF-CURRENT-TERM-ON             PIC X(4).
  3278         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3279             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3280             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3281             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3282             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3283             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3284             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3285             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3286         16  CF-PROCESSOR-CARRIER           PIC X.
  3287             88  NO-CARRIER-SECURITY            VALUE ' '.
  3288         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3289             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3290         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3291             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3292         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3293             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3294
  3295         16  CF-PROC-SYS-ACCESS-SW.
  3296             20  CF-PROC-CREDIT-CLAIMS-SW.
  3297                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3298                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3299                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3300                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3301             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3302                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3303                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3304             20  CF-PROC-LIFE-GNRLDGR-SW.
  3305                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3306                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3307                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3308                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3309             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3310                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3311                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3312         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3313             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3314             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3315         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3316
  3317         16  CF-APPROVAL-LEVEL                  PIC X.
  3318             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3319             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3320             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3321             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3322             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3323
  3324         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3325
  3326         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  63
* EL1278.cbl
  3327             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3328             88  CF-LANG-IS-FR                      VALUE 'F'.
  3329
  3330         16  CF-CSR-IND                         PIC X.
  3331         16  FILLER                             PIC X(239).
  3332
  3333****************************************************************
  3334*             PROCESSOR/REMINDERS RECORD                       *
  3335****************************************************************
  3336
  3337     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3338         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3339             20  CF-START-REMIND-DT         PIC XX.
  3340             20  CF-END-REMIND-DT           PIC XX.
  3341             20  CF-REMINDER-TEXT           PIC X(50).
  3342         16  FILLER                         PIC X(296).
  3343
  3344
  3345****************************************************************
  3346*             STATE MASTER RECORD                              *
  3347****************************************************************
  3348
  3349     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3350         16  CF-STATE-ABBREVIATION          PIC XX.
  3351         16  CF-STATE-NAME                  PIC X(25).
  3352         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3353         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3354             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3355             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3356             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3357             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3358                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3359                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3360             20  CF-ST-PREM-REJECT-SW       PIC X.
  3361                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3362                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3363             20  CF-ST-REF-REJECT-SW        PIC X.
  3364                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3365                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3366         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3367         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3368         16  CF-ST-REFUND-RULES.
  3369             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3370             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3371             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3372         16  CF-ST-FST-PMT-EXTENSION.
  3373             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3374             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3375                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3376                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3377                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3378                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3379         16  CF-ST-STATE-CALL.
  3380             20  CF-ST-CALL-UNEARNED        PIC X.
  3381             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3382             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3383         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3384             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  64
* EL1278.cbl
  3385             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3386         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3387         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3388         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3389         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3390         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3391         16  FILLER                         PIC X.
  3392         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3393             20  CF-ST-BENEFIT-CD           PIC XX.
  3394             20  CF-ST-BENEFIT-KIND         PIC X.
  3395                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3396                 88  CF-ST-AH-KIND              VALUE 'A'.
  3397             20  CF-ST-REM-TERM-CALC        PIC X.
  3398                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3399                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3400                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3401                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3402                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3403                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3404                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3405                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3406
  3407             20  CF-ST-REFUND-CALC          PIC X.
  3408                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3409                 88  ST-REFD-BY-R78             VALUE '1'.
  3410                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3411                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3412                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3413                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3414                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3415                 88  ST-REFD-UTAH               VALUE '7'.
  3416                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3417                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3418                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3419
  3420             20  CF-ST-EARNING-CALC         PIC X.
  3421                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3422                 88  ST-EARN-BY-R78             VALUE '1'.
  3423                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3424                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3425                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3426                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3427                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3428                 88  ST-EARN-MEAN               VALUE '8'.
  3429                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3430
  3431             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3432                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3433                 88  ST-OVRD-BY-R78             VALUE '1'.
  3434                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3435                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3436                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3437                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3438                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3439                 88  ST-OVRD-MEAN               VALUE '8'.
  3440                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3441             20  cf-st-extra-periods        pic 9.
  3442*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  65
* EL1278.cbl
  3443
  3444         16  CF-ST-COMMISSION-CAPS.
  3445             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3446             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3447             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3448             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3449         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3450                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3451
  3452         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3453
  3454         16  CF-ST-STATUTORY-INTEREST.
  3455             20  CF-ST-STAT-DATE-FROM       PIC X.
  3456                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3457                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3458             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3459             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3460             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3461             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3462             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3463
  3464         16  CF-ST-OVER-SHORT.
  3465             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3466             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3467
  3468         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3469
  3470         16  CF-ST-RT-CALC                  PIC X.
  3471
  3472         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3473         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3474         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3475         16  CF-ST-RF-LR-CALC               PIC X.
  3476         16  CF-ST-RF-LL-CALC               PIC X.
  3477         16  CF-ST-RF-LN-CALC               PIC X.
  3478         16  CF-ST-RF-AH-CALC               PIC X.
  3479         16  CF-ST-RF-CP-CALC               PIC X.
  3480*        16  FILLER                         PIC X(206).
  3481*CIDMOD         16  FILLER                         PIC X(192).
  3482         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3483             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3484         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3485         16  CF-ST-VFY-2ND-BENE             PIC X.
  3486         16  CF-ST-CAUSAL-STATE             PIC X.
  3487         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3488         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3489         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3490             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3491         16  CF-ST-NET-ONLY-STATE           PIC X.
  3492             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3493         16  FILLER                         PIC X(181).
  3494
  3495****************************************************************
  3496*             BENEFIT MASTER RECORD                            *
  3497****************************************************************
  3498
  3499     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3500         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  66
* EL1278.cbl
  3501             20  CF-BENEFIT-CODE            PIC XX.
  3502             20  CF-BENEFIT-NUMERIC  REDEFINES
  3503                 CF-BENEFIT-CODE            PIC XX.
  3504             20  CF-BENEFIT-ALPHA           PIC XXX.
  3505             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3506             20  CF-BENEFIT-COMMENT         PIC X(10).
  3507
  3508             20  CF-LF-COVERAGE-TYPE        PIC X.
  3509                 88  CF-REDUCING                VALUE 'R'.
  3510                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3511
  3512             20  CF-SPECIAL-CALC-CD         PIC X.
  3513                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3514                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3515                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3516                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3517                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3518                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3519                 88  CF-FARM-PLAN               VALUE 'F'.
  3520                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3521                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3522                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3523                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3524                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3525                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3526                 88  CF-PRUDENTIAL              VALUE 'P'.
  3527                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3528                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3529                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3530                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3531                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3532                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3533
  3534             20  CF-JOINT-INDICATOR         PIC X.
  3535                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3536
  3537*            20  FILLER                     PIC X(12).
  3538             20  cf-maximum-benefits        pic s999 comp-3.
  3539             20  FILLER                     PIC X(09).
  3540             20  CF-BENEFIT-CATEGORY        PIC X.
  3541             20  CF-LOAN-TYPE               PIC X(8).
  3542
  3543             20  CF-CO-REM-TERM-CALC        PIC X.
  3544                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3545                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3546                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3547                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3548                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3549
  3550             20  CF-CO-EARNINGS-CALC        PIC X.
  3551                 88  CO-EARN-BY-R78             VALUE '1'.
  3552                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3553                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3554                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3555                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3556                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3557                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3558                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  67
* EL1278.cbl
  3559
  3560             20  CF-CO-REFUND-CALC          PIC X.
  3561                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3562                 88  CO-REFD-BY-R78             VALUE '1'.
  3563                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3564                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3565                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3566                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3567                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3568                 88  CO-REFD-MEAN               VALUE '8'.
  3569                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3570                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3571                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3572
  3573             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3574                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3575                 88  CO-OVRD-BY-R78             VALUE '1'.
  3576                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3577                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3578                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3579                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3580                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3581                 88  CO-OVRD-MEAN               VALUE '8'.
  3582                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3583
  3584             20  CF-CO-BEN-I-G-CD           PIC X.
  3585                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3586                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3587                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3588
  3589         16  FILLER                         PIC X(304).
  3590
  3591
  3592****************************************************************
  3593*             CARRIER MASTER RECORD                            *
  3594****************************************************************
  3595
  3596     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3597         16  CF-ADDRESS-DATA.
  3598             20  CF-MAIL-TO-NAME            PIC X(30).
  3599             20  CF-IN-CARE-OF              PIC X(30).
  3600             20  CF-ADDRESS-LINE-1          PIC X(30).
  3601             20  CF-ADDRESS-LINE-2          PIC X(30).
  3602             20  CF-CITY-STATE              PIC X(30).
  3603             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3604             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3605
  3606         16  CF-CLAIM-NO-CONTROL.
  3607             20  CF-CLAIM-NO-METHOD         PIC X.
  3608                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3609                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3610                 88  CLAIM-NO-SEQ               VALUE '3'.
  3611                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3612             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3613                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3614                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3615                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3616
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  68
* EL1278.cbl
  3617         16  CF-CHECK-NO-CONTROL.
  3618             20  CF-CHECK-NO-METHOD         PIC X.
  3619                 88  CHECK-NO-MANUAL            VALUE '1'.
  3620                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3621                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3622                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3623             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3624                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3625
  3626         16  CF-DOMICILE-STATE              PIC XX.
  3627
  3628         16  CF-EXPENSE-CONTROLS.
  3629             20  CF-EXPENSE-METHOD          PIC X.
  3630                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3631                 88  DOLLARS-PER-PMT            VALUE '2'.
  3632                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3633                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3634             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3635             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3636
  3637         16  CF-CORRESPONDENCE-CONTROL.
  3638             20  CF-LETTER-RESEND-OPT       PIC X.
  3639                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3640                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3641             20  FILLER                     PIC X(4).
  3642
  3643         16  CF-RESERVE-CONTROLS.
  3644             20  CF-MANUAL-SW               PIC X.
  3645                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3646             20  CF-FUTURE-SW               PIC X.
  3647                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3648             20  CF-PTC-SW                  PIC X.
  3649                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3650             20  CF-IBNR-SW                 PIC X.
  3651                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3652             20  CF-PTC-LF-SW               PIC X.
  3653                 88  CF-LF-PTC-USED             VALUE '1'.
  3654             20  CF-CDT-ACCESS-METHOD       PIC X.
  3655                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3656                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3657                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3658             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3659
  3660         16  CF-CLAIM-CALC-METHOD           PIC X.
  3661             88  360-PLUS-MONTHS                VALUE '1'.
  3662             88  365-PLUS-MONTHS                VALUE '2'.
  3663             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3664             88  360-DAILY                      VALUE '4'.
  3665             88  365-DAILY                      VALUE '5'.
  3666
  3667         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3668         16  FILLER                         PIC X(11).
  3669
  3670         16  CF-LIMIT-AMOUNTS.
  3671             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3672             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3673             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3674             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  69
* EL1278.cbl
  3675             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3676             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3677             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3678             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3679             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3680             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3681
  3682         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3683         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3684         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3685
  3686         16  CF-ZIP-CODE.
  3687             20  CF-ZIP-PRIME.
  3688                 24  CF-ZIP-1ST             PIC X.
  3689                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3690                 24  FILLER                 PIC X(4).
  3691             20  CF-ZIP-PLUS4               PIC X(4).
  3692         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3693             20  CF-CAN-POSTAL-1            PIC XXX.
  3694             20  CF-CAN-POSTAL-2            PIC XXX.
  3695             20  FILLER                     PIC XXX.
  3696
  3697         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3698         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3699         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3700
  3701         16  CF-RATING-SWITCH               PIC X.
  3702             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3703             88  CF-NO-RATING                   VALUE 'N'.
  3704
  3705         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3706
  3707         16  CF-CARRIER-OVER-SHORT.
  3708             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3709             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3710
  3711         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3712         16  CF-SECPAY-SWITCH               PIC X.
  3713             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3714             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3715         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3716         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3717         16  FILLER                         PIC X(444).
  3718*        16  FILLER                         PIC X(452).
  3719
  3720
  3721****************************************************************
  3722*             MORTALITY MASTER RECORD                          *
  3723****************************************************************
  3724
  3725     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3726         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3727                                INDEXED BY CF-MORT-NDX.
  3728             20  CF-MORT-TABLE              PIC X(5).
  3729             20  CF-MORT-TABLE-TYPE         PIC X.
  3730                 88  CF-MORT-JOINT              VALUE 'J'.
  3731                 88  CF-MORT-SINGLE             VALUE 'S'.
  3732                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  70
* EL1278.cbl
  3733                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3734                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3735             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3736             20  CF-MORT-AGE-METHOD         PIC XX.
  3737                 88  CF-AGE-LAST                VALUE 'AL'.
  3738                 88  CF-AGE-NEAR                VALUE 'AN'.
  3739             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3740             20  CF-MORT-ADJUSTMENT-DIRECTION
  3741                                            PIC X.
  3742                 88  CF-MINUS                   VALUE '-'.
  3743                 88  CF-PLUS                    VALUE '+'.
  3744             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3745             20  CF-MORT-JOINT-CODE         PIC X.
  3746                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3747             20  CF-MORT-PC-Q               PIC X.
  3748                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3749             20  CF-MORT-TABLE-CODE         PIC X(4).
  3750             20  CF-MORT-COMMENTS           PIC X(15).
  3751             20  FILLER                     PIC X(14).
  3752
  3753         16  FILLER                         PIC X(251).
  3754
  3755
  3756****************************************************************
  3757*             BUSSINESS TYPE MASTER RECORD                     *
  3758****************************************************************
  3759
  3760     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3761* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3762* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3763* AND RECORD 05 IS TYPES 81-99
  3764         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3765             20  CF-BUSINESS-TITLE          PIC  X(19).
  3766             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3767                                            PIC S9V9(4) COMP-3.
  3768             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3769             20  FILLER                     PIC  X.
  3770         16  FILLER                         PIC  X(248).
  3771
  3772
  3773****************************************************************
  3774*             TERMINAL MASTER RECORD                           *
  3775****************************************************************
  3776
  3777     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3778
  3779         16  CF-COMPANY-TERMINALS.
  3780             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3781                                  PIC X(4).
  3782         16  FILLER               PIC X(248).
  3783
  3784
  3785****************************************************************
  3786*             LIFE EDIT MASTER RECORD                          *
  3787****************************************************************
  3788
  3789     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3790         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  71
* EL1278.cbl
  3791             20  CF-LIFE-CODE-IN            PIC XX.
  3792             20  CF-LIFE-CODE-OUT           PIC XX.
  3793         16  FILLER                         PIC X(248).
  3794
  3795
  3796****************************************************************
  3797*             AH EDIT MASTER RECORD                            *
  3798****************************************************************
  3799
  3800     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3801         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3802             20  CF-AH-CODE-IN              PIC XXX.
  3803             20  CF-AH-CODE-OUT             PIC XX.
  3804         16  FILLER                         PIC X(248).
  3805
  3806
  3807****************************************************************
  3808*             CREDIBILITY TABLES                               *
  3809****************************************************************
  3810
  3811     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3812         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3813                             INDEXED BY CF-CRDB-NDX.
  3814             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3815             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3816             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3817         16  FILLER                         PIC  X(332).
  3818
  3819
  3820****************************************************************
  3821*             REPORT CUSTOMIZATION RECORD                      *
  3822****************************************************************
  3823
  3824     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3825         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3826             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3827             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3828             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3829**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3830****       A T-TRANSFER.                                   ****
  3831             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3832
  3833         16  FILLER                         PIC XX.
  3834
  3835         16  CF-CARRIER-CNTL-OPT.
  3836             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3837                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3838                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3839             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3840                                            PIC X.
  3841         16  CF-GROUP-CNTL-OPT.
  3842             20  CF-GROUP-OPT-SEQ           PIC 9.
  3843                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3844                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3845             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3846                                            PIC X(6).
  3847         16  CF-STATE-CNTL-OPT.
  3848             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  72
* EL1278.cbl
  3849                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3850                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3851             20  CF-STATE-SELECT OCCURS 3 TIMES
  3852                                            PIC XX.
  3853         16  CF-ACCOUNT-CNTL-OPT.
  3854             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3855                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3856                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3857             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3858                                            PIC X(10).
  3859         16  CF-BUS-TYP-CNTL-OPT.
  3860             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3861                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3862                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3863             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3864                                            PIC XX.
  3865         16  CF-LF-TYP-CNTL-OPT.
  3866             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3867                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3868                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3869             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3870                                            PIC XX.
  3871         16  CF-AH-TYP-CNTL-OPT.
  3872             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3873                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3874                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3875             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3876                                            PIC XX.
  3877         16  CF-REPTCD1-CNTL-OPT.
  3878             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3879                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3880                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3881             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3882                                            PIC X(10).
  3883         16  CF-REPTCD2-CNTL-OPT.
  3884             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3885                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3886                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3887             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3888                                            PIC X(10).
  3889         16  CF-USER1-CNTL-OPT.
  3890             20  CF-USER1-OPT-SEQ           PIC 9.
  3891                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3892                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3893             20  CF-USER1-SELECT OCCURS 3 TIMES
  3894                                            PIC X(10).
  3895         16  CF-USER2-CNTL-OPT.
  3896             20  CF-USER2-OPT-SEQ           PIC 9.
  3897                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3898                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3899             20  CF-USER2-SELECT OCCURS 3 TIMES
  3900                                            PIC X(10).
  3901         16  CF-USER3-CNTL-OPT.
  3902             20  CF-USER3-OPT-SEQ           PIC 9.
  3903                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3904                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3905             20  CF-USER3-SELECT OCCURS 3 TIMES
  3906                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  73
* EL1278.cbl
  3907         16  CF-USER4-CNTL-OPT.
  3908             20  CF-USER4-OPT-SEQ           PIC 9.
  3909                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3910                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3911             20  CF-USER4-SELECT OCCURS 3 TIMES
  3912                                            PIC X(10).
  3913         16  CF-USER5-CNTL-OPT.
  3914             20  CF-USER5-OPT-SEQ           PIC 9.
  3915                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3916                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3917             20  CF-USER5-SELECT OCCURS 3 TIMES
  3918                                            PIC X(10).
  3919         16  CF-REINS-CNTL-OPT.
  3920             20  CF-REINS-OPT-SEQ           PIC 9.
  3921                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3922                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3923             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3924                 24  CF-REINS-PRIME         PIC XXX.
  3925                 24  CF-REINS-SUB           PIC XXX.
  3926
  3927         16  CF-AGENT-CNTL-OPT.
  3928             20  CF-AGENT-OPT-SEQ           PIC 9.
  3929                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3930                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3931             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3932                                            PIC X(10).
  3933
  3934         16  FILLER                         PIC X(43).
  3935
  3936         16  CF-LOSS-RATIO-SELECT.
  3937             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3938             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3939         16  CF-ENTRY-DATE-SELECT.
  3940             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3941             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3942         16  CF-EFFECTIVE-DATE-SELECT.
  3943             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3944             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3945
  3946         16  CF-EXCEPTION-LIST-IND          PIC X.
  3947             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3948
  3949         16  FILLER                         PIC X(318).
  3950
  3951****************************************************************
  3952*                  EXCEPTION REPORTING RECORD                  *
  3953****************************************************************
  3954
  3955     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3956         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3957             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3958
  3959         16  CF-COMBINED-LIFE-AH-OPT.
  3960             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3961             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3962             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3963             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3964
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  74
* EL1278.cbl
  3965         16  CF-LIFE-OPT.
  3966             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3967             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3968             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3969             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3970             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3971             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3972             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3973             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3974             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3975             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3976
  3977         16  CF-AH-OPT.
  3978             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3979             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3980             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3981             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3982             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3983             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3984             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3985             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3986             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3987             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3988
  3989         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3990             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3991             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3992             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3993
  3994         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3995
  3996         16  FILLER                         PIC X(673).
  3997
  3998
  3999****************************************************************
  4000*             MORTGAGE SYSTEM PLAN RECORD                      *
  4001****************************************************************
  4002
  4003     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4004         16  CF-PLAN-TYPE                   PIC X.
  4005             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4006             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4007             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4008         16  CF-PLAN-ABBREV                 PIC XXX.
  4009         16  CF-PLAN-DESCRIPT               PIC X(10).
  4010         16  CF-PLAN-NOTES                  PIC X(20).
  4011         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4012         16  CF-PLAN-UNDERWRITING.
  4013             20  CF-PLAN-TERM-DATA.
  4014                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4015                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4016             20  CF-PLAN-AGE-DATA.
  4017                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4018                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4019                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4020             20  CF-PLAN-BENEFIT-DATA.
  4021                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4022                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  75
* EL1278.cbl
  4023                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4024                                            PIC S9(7)V99  COMP-3.
  4025         16  CF-PLAN-POLICY-FORMS.
  4026             20  CF-POLICY-FORM             PIC X(12).
  4027             20  CF-MASTER-APPLICATION      PIC X(12).
  4028             20  CF-MASTER-POLICY           PIC X(12).
  4029         16  CF-PLAN-RATING.
  4030             20  CF-RATE-CODE               PIC X(5).
  4031             20  CF-SEX-RATING              PIC X.
  4032                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4033                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4034             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4035             20  CF-SUB-STD-TYPE            PIC X.
  4036                 88  CF-PCT-OF-PREM            VALUE '1'.
  4037                 88  CF-PCT-OF-BENE            VALUE '2'.
  4038         16  CF-PLAN-PREM-TOLERANCES.
  4039             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4040             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4041         16  CF-PLAN-PYMT-TOLERANCES.
  4042             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4043             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4044         16  CF-PLAN-MISC-DATA.
  4045             20  FILLER                     PIC X.
  4046             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4047             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4048         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4049         16  CF-PLAN-IND-GRP                PIC X.
  4050             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4051                                                     '1'.
  4052             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4053                                                     '2'.
  4054         16  CF-MIB-SEARCH-SW               PIC X.
  4055             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4056             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4057             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4058             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4059         16  CF-ALPHA-SEARCH-SW             PIC X.
  4060             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4061             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4062             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4063             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4064             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4065             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4066             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4067             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4068             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4069             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4070                                                     'A' 'B' 'C'
  4071                                                     'X' 'Y' 'Z'.
  4072         16  CF-EFF-DT-RULE-SW              PIC X.
  4073             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4074             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4075             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4076             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4077             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4078         16  FILLER                         PIC X(4).
  4079         16  CF-HEALTH-QUESTIONS            PIC X.
  4080             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  76
* EL1278.cbl
  4081         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4082         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4083         16  CF-PLAN-SNGL-JNT               PIC X.
  4084             88  CF-COMBINED-PLAN              VALUE 'C'.
  4085             88  CF-JNT-PLAN                   VALUE 'J'.
  4086             88  CF-SNGL-PLAN                  VALUE 'S'.
  4087         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4088         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4089         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4090         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4091         16  CF-RERATE-CNTL                 PIC  X.
  4092             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4093             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4094             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4095             88  CF-AUTO-RECALC                 VALUE '4'.
  4096         16  CF-BENEFIT-TYPE                PIC  X.
  4097             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4098             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4099         16  CF-POLICY-FEE                  PIC S999V99
  4100                                                    COMP-3.
  4101         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4102         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4103         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4104         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4105         16  FILLER                         PIC  X(32).
  4106         16  CF-TERMINATION-FORM            PIC  X(04).
  4107         16  FILLER                         PIC  X(08).
  4108         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4109                                                       COMP-3.
  4110         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4111         16  CF-ISSUE-LETTER                PIC  X(4).
  4112         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4113         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4114             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4115             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4116         16  CF-MP-REFUND-CALC              PIC X.
  4117             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4118             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4119             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4120             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4121             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4122             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4123             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4124             88  CF-MP-REFD-MEAN                VALUE '8'.
  4125         16  CF-ALT-RATE-CODE               PIC  X(5).
  4126
  4127
  4128         16  FILLER                         PIC X(498).
  4129****************************************************************
  4130*             MORTGAGE COMPANY MASTER RECORD                   *
  4131****************************************************************
  4132
  4133     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4134         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4135         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4136             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4137             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4138             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  77
* EL1278.cbl
  4139             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4140             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4141
  4142         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4143         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4144         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4145         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4146         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4147
  4148         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4149             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4150         16  CF-MP-RECON-USE-IND            PIC X(1).
  4151             88  CF-MP-USE-RECON             VALUE 'Y'.
  4152         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4153             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4154         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4155             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4156             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4157         16  FILLER                         PIC X(1).
  4158         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4159             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4160         16  CF-MORTG-MIB-VERSION           PIC X.
  4161             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4162             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4163             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4164         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4165             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4166                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4167             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4168                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4169             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4170                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4171             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4172                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4173             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4174                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4175             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4176                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4177         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4178         16  FILLER                         PIC X(7).
  4179         16  CF-MORTG-DESTINATION-SYMBOL.
  4180             20  CF-MORTG-MIB-COMM          PIC X(5).
  4181             20  CF-MORTG-MIB-TERM          PIC X(5).
  4182         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4183             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4184         16  FILLER                         PIC X(03).
  4185         16  CF-MP-CHECK-NO-CONTROL.
  4186             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4187                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4188                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4189                                                ' ' LOW-VALUES.
  4190                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4191                                               VALUE '3'.
  4192         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4193         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4194         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4195             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4196                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  78
* EL1278.cbl
  4197             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4198                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4199             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4200                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4201             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4202                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4203             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4204                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4205             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4206                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4207         16  CF-MORTG-BILLING-AREA.
  4208             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4209                                            PIC X.
  4210         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4211         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4212         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4213         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4214             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4215             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4216         16  FILLER                         PIC X.
  4217         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4218             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4219             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4220         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4221         16  FILLER                         PIC X(8).
  4222         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4223         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4224         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4225         16  CF-ACH-COMPANY-ID.
  4226             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4227                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4228                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4229                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4230             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4231         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4232             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4233         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4234             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4235             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4236         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4237         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4238         16  FILLER                         PIC X(536).
  4239
  4240****************************************************************
  4241*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4242****************************************************************
  4243
  4244     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4245         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4246             20  CF-FEMALE-HEIGHT.
  4247                 24  CF-FEMALE-FT           PIC 99.
  4248                 24  CF-FEMALE-IN           PIC 99.
  4249             20  CF-FEMALE-MIN-WT           PIC 999.
  4250             20  CF-FEMALE-MAX-WT           PIC 999.
  4251         16  FILLER                         PIC X(428).
  4252
  4253     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4254         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  79
* EL1278.cbl
  4255             20  CF-MALE-HEIGHT.
  4256                 24  CF-MALE-FT             PIC 99.
  4257                 24  CF-MALE-IN             PIC 99.
  4258             20  CF-MALE-MIN-WT             PIC 999.
  4259             20  CF-MALE-MAX-WT             PIC 999.
  4260         16  FILLER                         PIC X(428).
  4261******************************************************************
  4262*             AUTOMATIC ACTIVITY RECORD                          *
  4263******************************************************************
  4264     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4265         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4266             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4267             20  CF-SYS-LETTER-ID           PIC X(04).
  4268             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4269             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4270             20  CF-SYS-RESET-SW            PIC X(01).
  4271             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4272             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4273
  4274         16  FILLER                         PIC X(50).
  4275
  4276         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4277             20  CF-USER-ACTIVE-SW          PIC X(01).
  4278             20  CF-USER-LETTER-ID          PIC X(04).
  4279             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4280             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4281             20  CF-USER-RESET-SW           PIC X(01).
  4282             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4283             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4284             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4285
  4286         16  FILLER                         PIC X(246).
  4287*                            COPY ERCACCT.
  4288******************************************************************
  4289*                                                                *
  4290*                                                                *
  4291*                            ERCACCT                             *
  4292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4293*                            VMOD=2.031                          *
  4294*                                                                *
  4295*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4296*                                                                *
  4297*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4298*   VSAM ACCOUNT MASTER FILES.                                   *
  4299*                                                                *
  4300*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4301*                                                                *
  4302*   FILE TYPE = VSAM,KSDS                                        *
  4303*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4304*                                                                *
  4305*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4306*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4307*                                                                *
  4308*   LOG = NO                                                     *
  4309*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4310*                                                                *
  4311*                                                                *
  4312******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  80
* EL1278.cbl
  4313*                   C H A N G E   L O G
  4314*
  4315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4316*-----------------------------------------------------------------
  4317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4318* EFFECTIVE    NUMBER
  4319*-----------------------------------------------------------------
  4320* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4321* 092705    2005050300006  PEMA  ADD SPP LEASES
  4322* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4323* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4324* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4325* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4326* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4327******************************************************************
  4328
  4329 01  ACCOUNT-MASTER.
  4330     12  AM-RECORD-ID                      PIC XX.
  4331         88  VALID-AM-ID                      VALUE 'AM'.
  4332
  4333     12  AM-CONTROL-PRIMARY.
  4334         16  AM-COMPANY-CD                 PIC X.
  4335         16  AM-MSTR-CNTRL.
  4336             20  AM-CONTROL-A.
  4337                 24  AM-CARRIER            PIC X.
  4338                 24  AM-GROUPING.
  4339                     28 AM-GROUPING-PREFIX PIC XXX.
  4340                     28 AM-GROUPING-PRIME  PIC XXX.
  4341                 24  AM-STATE              PIC XX.
  4342                 24  AM-ACCOUNT.
  4343                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4344                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4345             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4346                                           PIC X(19).
  4347             20  AM-CNTRL-B.
  4348                 24  AM-EXPIRATION-DT      PIC XX.
  4349                 24  FILLER                PIC X(4).
  4350             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4351                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4352
  4353     12  AM-CONTROL-BY-VAR-GRP.
  4354         16  AM-COMPANY-CD-A1              PIC X.
  4355         16  AM-VG-CARRIER                 PIC X.
  4356         16  AM-VG-GROUPING                PIC X(6).
  4357         16  AM-VG-STATE                   PIC XX.
  4358         16  AM-VG-ACCOUNT                 PIC X(10).
  4359         16  AM-VG-DATE.
  4360             20  AM-VG-EXPIRATION-DT       PIC XX.
  4361             20  FILLER                    PIC X(4).
  4362         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4363                                           PIC 9(11)      COMP-3.
  4364     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4365         16  FILLER                        PIC X(10).
  4366         16  AM-VG-KEY3.
  4367             20  AM-VG3-ACCOUNT            PIC X(10).
  4368             20  AM-VG3-EXP-DT             PIC XX.
  4369         16  FILLER                        PIC X(4).
  4370     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  81
* EL1278.cbl
  4371         16  AM-LAST-MAINT-DT              PIC XX.
  4372         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4373         16  AM-LAST-MAINT-USER            PIC X(4).
  4374         16  FILLER                        PIC XX.
  4375
  4376     12  AM-EFFECTIVE-DT                   PIC XX.
  4377     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4378
  4379     12  AM-PREV-DATES  COMP-3.
  4380         16  AM-PREV-EXP-DT                PIC 9(11).
  4381         16  AM-PREV-EFF-DT                PIC 9(11).
  4382
  4383     12  AM-REPORT-CODE-1                  PIC X(10).
  4384     12  AM-REPORT-CODE-2                  PIC X(10).
  4385
  4386     12  AM-CITY-CODE                      PIC X(4).
  4387     12  AM-COUNTY-PARISH                  PIC X(6).
  4388
  4389     12  AM-NAME                           PIC X(30).
  4390     12  AM-PERSON                         PIC X(30).
  4391     12  AM-ADDRS                          PIC X(30).
  4392     12  AM-CITY.
  4393         16  AM-ADDR-CITY                  PIC X(28).
  4394         16  AM-ADDR-STATE                 PIC XX.
  4395     12  AM-ZIP.
  4396         16  AM-ZIP-PRIME.
  4397             20  AM-ZIP-PRI-1ST            PIC X.
  4398                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4399             20  FILLER                    PIC X(4).
  4400         16  AM-ZIP-PLUS4                  PIC X(4).
  4401     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4402         16  AM-CAN-POSTAL-1               PIC XXX.
  4403         16  AM-CAN-POSTAL-2               PIC XXX.
  4404         16  FILLER                        PIC XXX.
  4405     12  AM-TEL-NO.
  4406         16  AM-AREA-CODE                  PIC 999.
  4407         16  AM-TEL-PRE                    PIC 999.
  4408         16  AM-TEL-NBR                    PIC 9(4).
  4409     12  AM-TEL-LOC                        PIC X.
  4410         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4411         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4412
  4413     12  AM-COMM-STRUCTURE.
  4414         16  AM-DEFN-1.
  4415             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4416                 24  AM-AGT.
  4417                     28  AM-AGT-PREFIX     PIC X(4).
  4418                     28  AM-AGT-PRIME      PIC X(6).
  4419                 24  AM-COM-TYP            PIC X.
  4420                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4421                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4422                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4423                 24  AM-RECALC-LV-INDIC    PIC X.
  4424                 24  AM-RETRO-LV-INDIC     PIC X.
  4425                 24  AM-GL-CODES           PIC X.
  4426                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4427                 24  FILLER                PIC X(01).
  4428         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  82
* EL1278.cbl
  4429             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4430                 24  FILLER                PIC X(11).
  4431                 24  AM-L-COMA             PIC XXX.
  4432                 24  AM-J-COMA             PIC XXX.
  4433                 24  AM-A-COMA             PIC XXX.
  4434                 24  FILLER                PIC X(6).
  4435
  4436     12  AM-COMM-CHANGE-STATUS             PIC X.
  4437         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4438
  4439     12  AM-CSR-CODE                       PIC X(4).
  4440
  4441     12  AM-BILLING-STATUS                 PIC X.
  4442         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4443         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4444     12  AM-AUTO-REFUND-SW                 PIC X.
  4445         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4446         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4447     12  AM-GPCD                           PIC 99.
  4448     12  AM-IG                             PIC X.
  4449         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4450         88  AM-HAS-GROUP                     VALUE '2'.
  4451     12  AM-STATUS                         PIC X.
  4452         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4453         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4454         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4455         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4456         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4457         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4458     12  AM-REMIT-TO                       PIC 99.
  4459     12  AM-ID-NO                          PIC X(11).
  4460
  4461     12  AM-CAL-TABLE                      PIC XX.
  4462     12  AM-LF-DEVIATION                   PIC XXX.
  4463     12  AM-AH-DEVIATION                   PIC XXX.
  4464     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4465     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4466     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4467     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4468     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4469     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4470
  4471     12  AM-USER-FIELDS.
  4472         16  AM-FLD-1                      PIC XX.
  4473         16  AM-FLD-2                      PIC XX.
  4474         16  AM-FLD-3                      PIC XX.
  4475         16  AM-FLD-4                      PIC XX.
  4476         16  AM-FLD-5                      PIC XX.
  4477
  4478     12  AM-1ST-PROD-DATE.
  4479         16  AM-1ST-PROD-YR                PIC XX.
  4480         16  AM-1ST-PROD-MO                PIC XX.
  4481         16  AM-1ST-PROD-DA                PIC XX.
  4482     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4483     12  AM-CERTS-PURGED-DATE.
  4484         16  AM-PUR-YR                     PIC XX.
  4485         16  AM-PUR-MO                     PIC XX.
  4486         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  83
* EL1278.cbl
  4487     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4488     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4489     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4490     12  AM-INACTIVE-DATE.
  4491         16  AM-INA-MO                     PIC 99.
  4492         16  AM-INA-DA                     PIC 99.
  4493         16  AM-INA-YR                     PIC 99.
  4494     12  AM-AR-HI-CERT-DATE                PIC XX.
  4495
  4496     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4497     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4498
  4499     12  AM-OB-PAYMENT-MODE                PIC X.
  4500         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4501         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4502         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4503         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4504
  4505     12  AM-AH-ONLY-INDICATOR              PIC X.
  4506         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4507         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4508
  4509     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4510
  4511     12  AM-OVER-SHORT.
  4512         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4513         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4514
  4515     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4516     12  AM-DCC-CLP-STATE                  PIC XX.
  4517
  4518     12  AM-RECALC-COMM                    PIC X.
  4519     12  AM-RECALC-REIN                    PIC X.
  4520
  4521     12  AM-REI-TABLE                      PIC XXX.
  4522     12  AM-REI-ET-LF                      PIC X.
  4523     12  AM-REI-ET-AH                      PIC X.
  4524     12  AM-REI-PE-LF                      PIC X.
  4525     12  AM-REI-PE-AH                      PIC X.
  4526     12  AM-REI-PRT-ST                     PIC X.
  4527     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4528     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4529     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4530     12  AM-REI-GROUP-A                    PIC X(6).
  4531     12  AM-REI-MORT                       PIC X(4).
  4532     12  AM-REI-PRT-OW                     PIC X.
  4533     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4534     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4535     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4536     12  AM-REI-GROUP-B                    PIC X(6).
  4537
  4538     12  AM-TRUST-TYPE                     PIC X(2).
  4539
  4540     12  AM-EMPLOYER-STMT-USED             PIC X.
  4541     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4542
  4543     12  AM-STD-AH-TYPE                    PIC XX.
  4544     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  84
* EL1278.cbl
  4545         16  AM-EARN-METHOD-R              PIC X.
  4546             88 AM-REF-RL-R78                 VALUE 'R'.
  4547             88 AM-REF-RL-PR                  VALUE 'P'.
  4548             88 AM-REF-RL-MEAN                VALUE 'M'.
  4549             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4550         16  AM-EARN-METHOD-L              PIC X.
  4551             88 AM-REF-LL-R78                 VALUE 'R'.
  4552             88 AM-REF-LL-PR                  VALUE 'P'.
  4553             88 AM-REF-LL-MEAN                VALUE 'M'.
  4554             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4555         16  AM-EARN-METHOD-A              PIC X.
  4556             88 AM-REF-AH-R78                 VALUE 'R'.
  4557             88 AM-REF-AH-PR                  VALUE 'P'.
  4558             88 AM-REF-AH-MEAN                VALUE 'M'.
  4559             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4560             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4561             88 AM-REF-AH-NET                 VALUE 'N'.
  4562
  4563     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4564     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4565     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4566
  4567     12  AM-RET-Y-N                        PIC X.
  4568     12  AM-RET-P-E                        PIC X.
  4569     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4570     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4571     12  AM-RET-GRP                        PIC X(6).
  4572     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4573         16  AM-POOL-PRIME                 PIC XXX.
  4574         16  AM-POOL-SUB                   PIC XXX.
  4575     12  AM-RETRO-EARNINGS.
  4576         16  AM-RET-EARN-R                 PIC X.
  4577         16  AM-RET-EARN-L                 PIC X.
  4578         16  AM-RET-EARN-A                 PIC X.
  4579     12  AM-RET-ST-TAX-USE                 PIC X.
  4580         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4581         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4582     12  AM-RETRO-BEG-EARNINGS.
  4583         16  AM-RET-BEG-EARN-R             PIC X.
  4584         16  AM-RET-BEG-EARN-L             PIC X.
  4585         16  AM-RET-BEG-EARN-A             PIC X.
  4586     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4587     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4588
  4589     12  AM-USER-SELECT-OPTIONS.
  4590         16  AM-USER-SELECT-1              PIC X(10).
  4591         16  AM-USER-SELECT-2              PIC X(10).
  4592         16  AM-USER-SELECT-3              PIC X(10).
  4593         16  AM-USER-SELECT-4              PIC X(10).
  4594         16  AM-USER-SELECT-5              PIC X(10).
  4595
  4596     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4597
  4598     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4599
  4600     12  AM-RPT045A-SWITCH                 PIC X.
  4601         88  RPT045A-OFF                   VALUE 'N'.
  4602
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  85
* EL1278.cbl
  4603     12  AM-INSURANCE-LIMITS.
  4604         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4605         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4606
  4607     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4608         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4609
  4610     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4611         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4612         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4613
  4614     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4615
  4616     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4617     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4618     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4619     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4620     12  AM-DCC-UEF-STATE                  PIC XX.
  4621     12  FILLER                            PIC XXX.
  4622     12  AM-REPORT-CODE-3                  PIC X(10).
  4623*    12  FILLER                            PIC X(22).
  4624
  4625     12  AM-RESERVE-DATE.
  4626         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4627         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4628         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4629
  4630     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4631     12  AM-NOTIFICATION-TYPES.
  4632         16  AM-NOTIF-OF-LETTERS           PIC X.
  4633         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4634         16  AM-NOTIF-OF-REPORTS           PIC X.
  4635         16  AM-NOTIF-OF-STATUS            PIC X.
  4636
  4637     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4638         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4639         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4640         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4641         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4642
  4643     12  AM-BENEFIT-CONTROLS.
  4644         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4645             20  AM-BENEFIT-CODE           PIC XX.
  4646             20  AM-BENEFIT-TYPE           PIC X.
  4647             20  AM-BENEFIT-REVISION       PIC XXX.
  4648             20  AM-BENEFIT-REM-TERM       PIC X.
  4649             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4650             20  FILLER                    PIC XX.
  4651         16  FILLER                        PIC X(80).
  4652
  4653     12  AM-TRANSFER-DATA.
  4654         16  AM-TRANSFERRED-FROM.
  4655             20  AM-TRNFROM-CARRIER        PIC X.
  4656             20  AM-TRNFROM-GROUPING.
  4657                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4658                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4659             20  AM-TRNFROM-STATE          PIC XX.
  4660             20  AM-TRNFROM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  86
* EL1278.cbl
  4661                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4662                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4663             20  AM-TRNFROM-DTE            PIC XX.
  4664         16  AM-TRANSFERRED-TO.
  4665             20  AM-TRNTO-CARRIER          PIC X.
  4666             20  AM-TRNTO-GROUPING.
  4667                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4668                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4669             20  AM-TRNTO-STATE            PIC XX.
  4670             20  AM-TRNTO-ACCOUNT.
  4671                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4672                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4673             20  AM-TRNTO-DTE              PIC XX.
  4674         16  FILLER                        PIC X(10).
  4675
  4676     12  AM-SAVED-REMIT-TO                 PIC 99.
  4677
  4678     12  AM-COMM-STRUCTURE-SAVED.
  4679         16  AM-DEFN-1-SAVED.
  4680             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4681                 24  AM-AGT-SV             PIC X(10).
  4682                 24  AM-COM-TYP-SV         PIC X.
  4683                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4684                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4685                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4686                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4687                 24  FILLER                PIC X.
  4688                 24  AM-GL-CODES-SV        PIC X.
  4689                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4690                 24  FILLER                PIC X.
  4691         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4692             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4693                 24  FILLER                PIC X(11).
  4694                 24  AM-L-COMA-SV          PIC XXX.
  4695                 24  AM-J-COMA-SV          PIC XXX.
  4696                 24  AM-A-COMA-SV          PIC XXX.
  4697                 24  FILLER                PIC X(6).
  4698
  4699     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4700         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4701            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4702            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4703            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4704
  4705     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4706     12  FILLER                            PIC X(120).
  4707
  4708     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4709         16  AM-CONTROL-NAME               PIC X(30).
  4710         16  AM-EXECUTIVE-ONE.
  4711             20  AM-EXEC1-NAME             PIC X(15).
  4712             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4713                                                          COMP-3.
  4714             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4715                                                          COMP-3.
  4716         16  AM-EXECUTIVE-TWO.
  4717             20  AM-EXEC2-NAME             PIC X(15).
  4718             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  87
* EL1278.cbl
  4719                                                          COMP-3.
  4720             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4721                                                          COMP-3.
  4722
  4723     12  AM-RETRO-ADDITIONAL-DATA.
  4724         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4725         16  AM-RETRO-PREM-P-E             PIC X.
  4726         16  AM-RETRO-CLMS-P-I             PIC X.
  4727         16  AM-RETRO-RET-BRACKET-LF.
  4728             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4729                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4730                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4731             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4732                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4733                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4734             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4735                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4736                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4737         16  AM-RETRO-RET-BRACKET-AH.
  4738             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4739                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4740                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4741                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4742             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4743                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4744                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4745             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4746                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4747                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4748
  4749     12  AM-COMMENTS.
  4750         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4751
  4752     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4753         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4754         16  AM-FLI-BILLING-CODE           PIC X.
  4755         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4756         16  AM-FLI-UNITED-IDENT           PIC X.
  4757         16  AM-FLI-INTEREST-LOST-DATA.
  4758             20  AM-FLI-BANK-NO            PIC X(5).
  4759             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4760             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4761             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4762         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4763             20  AM-FLI-AGT                PIC X(9).
  4764             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4765             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4766         16  FILLER                        PIC X(102).
  4767
  4768     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4769         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4770             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4771             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4772             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4773             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4774             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4775         16  FILLER                          PIC X(10).
  4776******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  88
* EL1278.cbl
  4777*                            COPY ELCCERT.
  4778******************************************************************
  4779*                                                                *
  4780*                            ELCCERT.                            *
  4781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4782*                            VMOD=2.013                          *
  4783*                                                                *
  4784*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4785*                                                                *
  4786*   FILE TYPE = VSAM,KSDS                                        *
  4787*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4788*                                                                *
  4789*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4790*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4791*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4792*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4793*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4794*                                                                *
  4795*   LOG = YES                                                    *
  4796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4797******************************************************************
  4798*                   C H A N G E   L O G
  4799*
  4800* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4801*-----------------------------------------------------------------
  4802*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4803* EFFECTIVE    NUMBER
  4804*-----------------------------------------------------------------
  4805* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4806* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4807* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4808* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4809* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4810* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4811* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4812* 032612  CR2011110200001  PEMA  AHL CHANGES
  4813* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4814******************************************************************
  4815
  4816 01  CERTIFICATE-MASTER.
  4817     12  CM-RECORD-ID                      PIC XX.
  4818         88  VALID-CM-ID                      VALUE 'CM'.
  4819
  4820     12  CM-CONTROL-PRIMARY.
  4821         16  CM-COMPANY-CD                 PIC X.
  4822         16  CM-CARRIER                    PIC X.
  4823         16  CM-GROUPING.
  4824             20  CM-GROUPING-PREFIX        PIC X(3).
  4825             20  CM-GROUPING-PRIME         PIC X(3).
  4826         16  CM-STATE                      PIC XX.
  4827         16  CM-ACCOUNT.
  4828             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4829             20  CM-ACCOUNT-PRIME          PIC X(6).
  4830         16  CM-CERT-EFF-DT                PIC XX.
  4831         16  CM-CERT-NO.
  4832             20  CM-CERT-PRIME             PIC X(10).
  4833             20  CM-CERT-SFX               PIC X.
  4834
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  89
* EL1278.cbl
  4835     12  CM-CONTROL-BY-NAME.
  4836         16  CM-COMPANY-CD-A1              PIC X.
  4837         16  CM-INSURED-LAST-NAME          PIC X(15).
  4838         16  CM-INSURED-INITIALS.
  4839             20  CM-INSURED-INITIAL1       PIC X.
  4840             20  CM-INSURED-INITIAL2       PIC X.
  4841
  4842     12  CM-CONTROL-BY-SSN.
  4843         16  CM-COMPANY-CD-A2              PIC X.
  4844         16  CM-SOC-SEC-NO.
  4845             20  CM-SSN-STATE              PIC XX.
  4846             20  CM-SSN-ACCOUNT            PIC X(6).
  4847             20  CM-SSN-LN3.
  4848                 25  CM-INSURED-INITIALS-A2.
  4849                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4850                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4851                 25 CM-PART-LAST-NAME-A2         PIC X.
  4852
  4853     12  CM-CONTROL-BY-CERT-NO.
  4854         16  CM-COMPANY-CD-A4              PIC X.
  4855         16  CM-CERT-NO-A4                 PIC X(11).
  4856
  4857     12  CM-CONTROL-BY-MEMB.
  4858         16  CM-COMPANY-CD-A5              PIC X.
  4859         16  CM-MEMBER-NO.
  4860             20  CM-MEMB-STATE             PIC XX.
  4861             20  CM-MEMB-ACCOUNT           PIC X(6).
  4862             20  CM-MEMB-LN4.
  4863                 25  CM-INSURED-INITIALS-A5.
  4864                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4865                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4866                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4867
  4868     12  CM-INSURED-PROFILE-DATA.
  4869         16  CM-INSURED-FIRST-NAME.
  4870             20  CM-INSURED-1ST-INIT       PIC X.
  4871             20  FILLER                    PIC X(9).
  4872         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4873         16  CM-INSURED-SEX                PIC X.
  4874             88  CM-SEX-MALE                  VALUE 'M'.
  4875             88  CM-SEX-FEMAL                 VALUE 'F'.
  4876         16  CM-INSURED-JOINT-AGE          PIC 99.
  4877         16  CM-JOINT-INSURED-NAME.
  4878             20  CM-JT-LAST-NAME           PIC X(15).
  4879             20  CM-JT-FIRST-NAME.
  4880                 24  CM-JT-1ST-INIT        PIC X.
  4881                 24  FILLER                PIC X(9).
  4882             20  CM-JT-INITIAL             PIC X.
  4883
  4884     12  CM-LIFE-DATA.
  4885         16  CM-LF-BENEFIT-CD              PIC XX.
  4886         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4887         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4888         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4889         16  CM-LF-DEV-CODE                PIC XXX.
  4890         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4891         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4892         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  90
* EL1278.cbl
  4893         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4894         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4895         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4896         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4897         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4898         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4899         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4900         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4901         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4902         16  cm-temp-epiq                  pic xx.
  4903             88  EPIQ-CLASS                  value 'EQ'.
  4904*        16  FILLER                        PIC XX.
  4905
  4906     12  CM-AH-DATA.
  4907         16  CM-AH-BENEFIT-CD              PIC XX.
  4908         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4909         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4910         16  CM-AH-DEV-CODE                PIC XXX.
  4911         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4912         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4913         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4914         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4915         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4916         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4917         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4918         16  CM-AH-PAID-THRU-DT            PIC XX.
  4919             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4920         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4921         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4922         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4923         16  FILLER                        PIC X.
  4924
  4925     12  CM-LOAN-INFORMATION.
  4926         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4927         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4928                                           PIC S9(5)V99  COMP-3.
  4929         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4930         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4931         16  CM-PAY-FREQUENCY              PIC S99.
  4932         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4933         16  CM-RATE-CLASS                 PIC XX.
  4934         16  CM-BENEFICIARY                PIC X(25).
  4935         16  CM-POLICY-FORM-NO             PIC X(12).
  4936         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4937         16  CM-LAST-ADD-ON-DT             PIC XX.
  4938         16  CM-DEDUCTIBLE-AMOUNTS.
  4939             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4940             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4941         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4942             20  CM-RESIDENT-STATE         PIC XX.
  4943             20  CM-RATE-CODE              PIC X(4).
  4944             20  FILLER                    PIC XX.
  4945         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4946             20  CM-LOAN-OFFICER           PIC X(5).
  4947             20  FILLER                    PIC XXX.
  4948         16  CM-CSR-CODE                   PIC XXX.
  4949         16  CM-UNDERWRITING-CODE          PIC X.
  4950             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  91
* EL1278.cbl
  4951         16  CM-POST-CARD-IND              PIC X.
  4952         16  CM-NH-INTERFACE-SW            PIC X.
  4953         16  CM-PREMIUM-TYPE               PIC X.
  4954             88  CM-SING-PRM                  VALUE '1'.
  4955             88  CM-O-B-COVERAGE              VALUE '2'.
  4956             88  CM-OPEN-END                  VALUE '3'.
  4957         16  CM-IND-GRP-TYPE               PIC X.
  4958             88  CM-INDIVIDUAL                VALUE 'I'.
  4959             88  CM-GROUP                     VALUE 'G'.
  4960         16  CM-SKIP-CODE                  PIC X.
  4961             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4962             88  SKIP-JULY                    VALUE '1'.
  4963             88  SKIP-AUGUST                  VALUE '2'.
  4964             88  SKIP-SEPTEMBER               VALUE '3'.
  4965             88  SKIP-JULY-AUG                VALUE '4'.
  4966             88  SKIP-AUG-SEPT                VALUE '5'.
  4967             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4968             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4969             88  SKIP-JUNE                    VALUE '8'.
  4970             88  SKIP-JUNE-JULY               VALUE '9'.
  4971             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4972             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4973         16  CM-PAYMENT-MODE               PIC X.
  4974             88  PAY-MONTHLY                  VALUE SPACE.
  4975             88  PAY-WEEKLY                   VALUE '1'.
  4976             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4977             88  PAY-BI-WEEKLY                VALUE '3'.
  4978             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4979         16  CM-LOAN-NUMBER                PIC X(8).
  4980         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4981         16  CM-OLD-LOF                    PIC XXX.
  4982*        16  CM-LOAN-OFFICER               PIC XXX.
  4983         16  CM-REIN-TABLE                 PIC XXX.
  4984         16  CM-SPECIAL-REIN-CODE          PIC X.
  4985         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4986         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4987         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4988
  4989     12  CM-STATUS-DATA.
  4990         16  CM-ENTRY-STATUS               PIC X.
  4991         16  CM-ENTRY-DT                   PIC XX.
  4992
  4993         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4994         16  CM-LF-CANCEL-DT               PIC XX.
  4995         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4996
  4997         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4998         16  CM-LF-DEATH-DT                PIC XX.
  4999         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5000
  5001         16  CM-LF-CURRENT-STATUS          PIC X.
  5002             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5003                                                'M' '4' '5' '9'.
  5004             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5005             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5006             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5007             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5008             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  92
* EL1278.cbl
  5009             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5010             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5011             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5012             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5013             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5014             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5015             88  CM-LF-DECLINED               VALUE 'D'.
  5016             88  CM-LF-VOIDED                 VALUE 'V'.
  5017
  5018         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5019         16  CM-AH-CANCEL-DT               PIC XX.
  5020         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5021
  5022         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5023         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5024         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5025
  5026         16  CM-AH-CURRENT-STATUS          PIC X.
  5027             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5028                                                'M' '4' '5' '9'.
  5029             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5030             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5031             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5032             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5033             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5034             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5035             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5036             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5037             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5038             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5039             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5040             88  CM-AH-DECLINED               VALUE 'D'.
  5041             88  CM-AH-VOIDED                 VALUE 'V'.
  5042
  5043         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5044             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5045             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5046             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5047         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5048
  5049         16  CM-ENTRY-BATCH                PIC X(6).
  5050         16  CM-LF-EXIT-BATCH              PIC X(6).
  5051         16  CM-AH-EXIT-BATCH              PIC X(6).
  5052         16  CM-LAST-MONTH-END             PIC XX.
  5053
  5054     12  CM-NOTE-SW                        PIC X.
  5055         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5056         88  CERT-NOTES-PRESENT               VALUE '1'.
  5057         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5058         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5059         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5060         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5061         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5062         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5063     12  CM-COMP-EXCP-SW                   PIC X.
  5064         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5065         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5066     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  93
* EL1278.cbl
  5067         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5068         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5069
  5070*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5071     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5072     12  FILLER                            PIC X.
  5073
  5074*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5075     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5076     12  FILLER                            PIC X.
  5077*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5078     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5079
  5080     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5081         88  CERT-ADDED-BATCH                 VALUE ' '.
  5082         88  CERT-ADDED-ONLINE                VALUE '1'.
  5083         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5084         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5085         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5086     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5087         88  CERT-AS-LOADED                   VALUE ' '.
  5088         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5089         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5090         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5091         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5092         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5093         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5094         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5095
  5096     12  CM-ACCOUNT-COMM-PCTS.
  5097         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5098         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5099
  5100     12  CM-USER-FIELD                     PIC X.
  5101     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5102     12  CM-CLP-STATE                      PIC XX.
  5103     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5104     12  CM-USER-RESERVED                  PIC XXX.
  5105     12  FILLER REDEFINES CM-USER-RESERVED.
  5106         16  CM-AH-CLASS-CD                PIC XX.
  5107         16  F                             PIC X.
  5108******************************************************************
  5109*                            COPY ERCMAIL.
  5110******************************************************************
  5111*                                                                *
  5112*                                                                *
  5113*                            ERCMAIL                             *
  5114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5115*                            VMOD=2.003                          *
  5116*                                                                *
  5117*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5118*                                                                *
  5119*   FILE TYPE = VSAM,KSDS                                        *
  5120*   RECORD SIZE = 374   RECFORM = FIX                            *
  5121*                                                                *
  5122*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5123*   ALTERNATE PATH    = NOT USED                                 *
  5124*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  94
* EL1278.cbl
  5125*   LOG = YES                                                    *
  5126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5127******************************************************************
  5128*                   C H A N G E   L O G
  5129*
  5130* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5131*-----------------------------------------------------------------
  5132*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5133* EFFECTIVE    NUMBER
  5134*-----------------------------------------------------------------
  5135* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5136* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5137* 111108                   PEMA  ADD CRED BENE ADDR2
  5138******************************************************************
  5139
  5140 01  MAILING-DATA.
  5141     12  MA-RECORD-ID                      PIC XX.
  5142         88  VALID-MA-ID                       VALUE 'MA'.
  5143
  5144     12  MA-CONTROL-PRIMARY.
  5145         16  MA-COMPANY-CD                 PIC X.
  5146         16  MA-CARRIER                    PIC X.
  5147         16  MA-GROUPING.
  5148             20  MA-GROUPING-PREFIX        PIC XXX.
  5149             20  MA-GROUPING-PRIME         PIC XXX.
  5150         16  MA-STATE                      PIC XX.
  5151         16  MA-ACCOUNT.
  5152             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5153             20  MA-ACCOUNT-PRIME          PIC X(6).
  5154         16  MA-CERT-EFF-DT                PIC XX.
  5155         16  MA-CERT-NO.
  5156             20  MA-CERT-PRIME             PIC X(10).
  5157             20  MA-CERT-SFX               PIC X.
  5158
  5159     12  FILLER                            PIC XX.
  5160
  5161     12  MA-ACCESS-CONTROL.
  5162         16  MA-SOURCE-SYSTEM              PIC XX.
  5163             88  MA-FROM-CREDIT                VALUE 'CR'.
  5164             88  MA-FROM-VSI                   VALUE 'VS'.
  5165             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5166             88  MA-FROM-OTHER                 VALUE 'OT'.
  5167         16  MA-RECORD-ADD-DT              PIC XX.
  5168         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5169         16  MA-LAST-MAINT-DT              PIC XX.
  5170         16  MA-LAST-MAINT-BY              PIC XXXX.
  5171         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5172
  5173     12  MA-PROFILE-INFO.
  5174         16  MA-QUALIFY-CODE-1             PIC XX.
  5175         16  MA-QUALIFY-CODE-2             PIC XX.
  5176         16  MA-QUALIFY-CODE-3             PIC XX.
  5177         16  MA-QUALIFY-CODE-4             PIC XX.
  5178         16  MA-QUALIFY-CODE-5             PIC XX.
  5179
  5180         16  MA-INSURED-LAST-NAME          PIC X(15).
  5181         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5182         16  MA-INSURED-MIDDLE-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  95
* EL1278.cbl
  5183         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5184         16  MA-INSURED-BIRTH-DT           PIC XX.
  5185         16  MA-INSURED-SEX                PIC X.
  5186             88  MA-SEX-MALE                   VALUE 'M'.
  5187             88  MA-SEX-FEMALE                 VALUE 'F'.
  5188         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5189
  5190         16  MA-ADDRESS-CORRECTED          PIC X.
  5191         16  MA-JOINT-BIRTH-DT             PIC XX.
  5192*        16  FILLER                        PIC X(12).
  5193
  5194         16  MA-ADDRESS-LINE-1             PIC X(30).
  5195         16  MA-ADDRESS-LINE-2             PIC X(30).
  5196         16  MA-CITY-STATE.
  5197             20  MA-CITY                   PIC X(28).
  5198             20  MA-ADDR-STATE             PIC XX.
  5199         16  MA-ZIP.
  5200             20  MA-ZIP-CODE.
  5201                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5202                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5203                 24  FILLER                PIC X(4).
  5204             20  MA-ZIP-PLUS4              PIC X(4).
  5205         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5206             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5207             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5208             20  FILLER                    PIC X(3).
  5209
  5210         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5211
  5212         16  FILLER                        PIC XXX.
  5213*        16  FILLER                        PIC X(10).
  5214
  5215     12  MA-CRED-BENE-INFO.
  5216         16  MA-CRED-BENE-NAME                 PIC X(25).
  5217         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5218         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5219         16  MA-CRED-BENE-CTYST.
  5220             20  MA-CRED-BENE-CITY             PIC X(28).
  5221             20  MA-CRED-BENE-STATE            PIC XX.
  5222         16  MA-CRED-BENE-ZIP.
  5223             20  MA-CB-ZIP-CODE.
  5224                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5225                     88  MA-CB-CANADIAN-POST-CODE
  5226                                           VALUE 'A' THRU 'Z'.
  5227                 24  FILLER                    PIC X(4).
  5228             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5229         16  MA-CB-CANADIAN-POSTAL-CODE
  5230                            REDEFINES MA-CRED-BENE-ZIP.
  5231             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5232             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5233             20  FILLER                        PIC X(3).
  5234     12  MA-POST-CARD-MAIL-DATA.
  5235         16  MA-MAIL-DATA OCCURS 7.
  5236             20  MA-MAIL-TYPE              PIC X.
  5237                 88  MA-12MO-MAILING           VALUE '1'.
  5238                 88  MA-EXP-MAILING            VALUE '2'.
  5239             20  MA-MAIL-STATUS            PIC X.
  5240                 88  MA-MAIL-ST-MAILED         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  96
* EL1278.cbl
  5241                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5242                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5243             20  MA-MAIL-DATE              PIC XX.
  5244     12  FILLER                            PIC XX.
  5245     12  FILLER                            PIC XX.
  5246*    12  FILLER                            PIC X(30).
  5247******************************************************************
  5248*                            COPY ELCCRTO.
  5249******************************************************************
  5250*                                                                *
  5251*                            ELCCRTO.                            *
  5252*                                                                *
  5253*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5254*                                                                *
  5255*   FILE TYPE = VSAM,KSDS                                        *
  5256*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5257*                                                                *
  5258*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5259*                                                                *
  5260*   LOG = YES                                                    *
  5261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5262******************************************************************
  5263*                   C H A N G E   L O G
  5264*
  5265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5266*-----------------------------------------------------------------
  5267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5268* EFFECTIVE    NUMBER
  5269*-----------------------------------------------------------------
  5270* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5271* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5272* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5273* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5274* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5275******************************************************************
  5276 01  ORIGINAL-CERTIFICATE.
  5277     12  OC-RECORD-ID                      PIC XX.
  5278         88  VALID-OC-ID                      VALUE 'OC'.
  5279     12  OC-CONTROL-PRIMARY.
  5280         16  OC-COMPANY-CD                 PIC X.
  5281         16  OC-CARRIER                    PIC X.
  5282         16  OC-GROUPING                   PIC X(6).
  5283         16  OC-STATE                      PIC XX.
  5284         16  OC-ACCOUNT                    PIC X(10).
  5285         16  OC-CERT-EFF-DT                PIC XX.
  5286         16  OC-CERT-NO.
  5287             20  OC-CERT-PRIME             PIC X(10).
  5288             20  OC-CERT-SFX               PIC X.
  5289         16  OC-RECORD-TYPE                PIC X.
  5290         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5291     12  OC-LAST-MAINT-DT                  PIC XX.
  5292     12  OC-LAST-MAINT-BY                  PIC X(4).
  5293     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5294     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5295     12  FILLER                            PIC X(49).
  5296     12  OC-ORIG-REC.
  5297         16  OC-INS-LAST-NAME              PIC X(15).
  5298         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  97
* EL1278.cbl
  5299         16  OC-INS-MIDDLE-INIT            PIC X.
  5300         16  OC-INS-AGE                    PIC S999     COMP-3.
  5301         16  OC-JNT-LAST-NAME              PIC X(15).
  5302         16  OC-JNT-FIRST-NAME             PIC X(10).
  5303         16  OC-JNT-MIDDLE-INIT            PIC X.
  5304         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5305         16  OC-LF-BENCD                   PIC XX.
  5306         16  OC-LF-TERM                    PIC S999      COMP-3.
  5307         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5308         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5309         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5310         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5311         16  OC-LF-EXP-DT                  PIC XX.
  5312         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5313         16  OC-LF-CANCEL-DT               PIC XX.
  5314         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5315         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5316         16  OC-AH-BENCD                   PIC XX.
  5317         16  OC-AH-TERM                    PIC S999      COMP-3.
  5318         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5319         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5320         16  OC-AH-EXP-DT                  PIC XX.
  5321         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5322         16  OC-AH-CP                      PIC 99.
  5323         16  OC-AH-CANCEL-DT               PIC XX.
  5324         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5325         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5326         16  OC-CRED-BENE-NAME             PIC X(25).
  5327         16  OC-1ST-PMT-DT                 PIC XX.
  5328         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5329         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5330         16  OC-ISSUE-TRAN-IND             PIC X.
  5331         16  OC-CANCEL-TRAN-IND            PIC X.
  5332         16  FILLER                        PIC X(211).
  5333
  5334     12  FILLER                            PIC X(50).
  5335******************************************************************
  5336*                            COPY ERCFORM.
  5337******************************************************************
  5338*                                                                *
  5339*                                                                *
  5340*                            ERCFORM.                            *
  5341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5342*                            VMOD=2.003                          *
  5343*                                                                *
  5344*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5345*                                                                *
  5346*    FILE TYPE = VSAM,KSDS                                       *
  5347*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5348*                                                                *
  5349*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5350*                                                                *
  5351*    LOG = YES                                                   *
  5352*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5353******************************************************************
  5354 01  FORM-MASTER.
  5355    12  FO-RECORD-ID                 PIC X(02).
  5356        88  VALID-FO-ID                  VALUE 'FO'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  98
* EL1278.cbl
  5357
  5358    12  FO-CONTROL-PRIMARY.
  5359        16  FO-COMPANY-CD            PIC X(01).
  5360        16  FO-STATE                 PIC X(02).
  5361        16  FO-FORM-ID               PIC X(12).
  5362        16  FO-FORM-EXP-DT           PIC X(02).
  5363
  5364    12  FO-POLICY-FORM-DATA.
  5365        16  FO-IND-GRP-CD            PIC X(01).
  5366        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5367        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5368        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5369        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5370        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5371        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5372        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5373        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5374        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5375        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5376        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5377        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5378        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5379        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5380        16  FO-APP-CERT-USE-CD       PIC X(01).
  5381
  5382    12  FILLER                       PIC X(29).
  5383
  5384    12  FO-FORM-PLAN-TABLE.
  5385        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5386            20  FO-PLAN-TYPE         PIC X(01).
  5387            20  FO-PLAN-ID           PIC X(02).
  5388            20  FO-PLAN-TERM         PIC 9(03).
  5389            20  FO-PLAN-REFUND-METHOD
  5390                                     PIC X.
  5391
  5392    12  FILLER                       PIC X(30).
  5393
  5394    12  FO-COMMENTS-AREA.
  5395        16  FO-COMMENT-LINE-1        PIC X(78).
  5396
  5397    12  FILLER                       PIC X(20).
  5398
  5399    12  FO-MAINT-INFORMATION.
  5400        16  FO-LAST-MAINT-DT         PIC X(02).
  5401        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5402        16  FO-LAST-MAINT-BY         PIC X(04).
  5403*                            COPY ELCMSTR.
  5404******************************************************************
  5405*                                                                *
  5406*                            ELCMSTR.                            *
  5407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5408*                            VMOD=2.012                          *
  5409*                                                                *
  5410*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5411*                                                                *
  5412*   FILE TYPE = VSAM,KSDS                                        *
  5413*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5414*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  99
* EL1278.cbl
  5415*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5416*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5417*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5418*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5419*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5420*                                                 RKP=75,LEN=21  *
  5421*                                                                *
  5422*   **** NOTE ****                                               *
  5423*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5424*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5425*                                                                *
  5426*   LOG = YES                                                    *
  5427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5428******************************************************************
  5429*                   C H A N G E   L O G
  5430*
  5431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5432*-----------------------------------------------------------------
  5433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5434* EFFECTIVE    NUMBER
  5435*-----------------------------------------------------------------
  5436* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5437* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5438* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5439* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5440* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5441******************************************************************
  5442 01  CLAIM-MASTER.
  5443     12  CL-RECORD-ID                PIC XX.
  5444         88  VALID-CL-ID         VALUE 'CL'.
  5445
  5446     12  CL-CONTROL-PRIMARY.
  5447         16  CL-COMPANY-CD           PIC X.
  5448         16  CL-CARRIER              PIC X.
  5449         16  CL-CLAIM-NO             PIC X(7).
  5450         16  CL-CERT-NO.
  5451             20  CL-CERT-PRIME       PIC X(10).
  5452             20  CL-CERT-SFX         PIC X.
  5453
  5454     12  CL-CONTROL-BY-NAME.
  5455         16  CL-COMPANY-CD-A1        PIC X.
  5456         16  CL-INSURED-LAST-NAME    PIC X(15).
  5457         16  CL-INSURED-NAME.
  5458             20  CL-INSURED-1ST-NAME PIC X(12).
  5459             20  CL-INSURED-MID-INIT PIC X.
  5460
  5461     12  CL-CONTROL-BY-SSN.
  5462         16  CL-COMPANY-CD-A2        PIC X.
  5463         16  CL-SOC-SEC-NO.
  5464             20  CL-SSN-STATE        PIC XX.
  5465             20  CL-SSN-ACCOUNT      PIC X(6).
  5466             20  CL-SSN-LN3          PIC X(3).
  5467
  5468     12  CL-CONTROL-BY-CERT-NO.
  5469         16  CL-COMPANY-CD-A4        PIC X.
  5470         16  CL-CERT-NO-A4.
  5471             20  CL-CERT-A4-PRIME    PIC X(10).
  5472             20  CL-CERT-A4-SFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 100
* EL1278.cbl
  5473
  5474     12  CL-CONTROL-BY-CCN.
  5475         16  CL-COMPANY-CD-A5        PIC X.
  5476         16  CL-CCN-A5.
  5477             20  CL-CCN.
  5478                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5479                 24  CL-CCN-PRIME-A5 PIC X(12).
  5480             20  CL-CCN-FILLER-A5    PIC X(4).
  5481
  5482     12  CL-INSURED-PROFILE-DATA.
  5483         16  CL-INSURED-BIRTH-DT     PIC XX.
  5484         16  CL-INSURED-SEX-CD       PIC X.
  5485             88  INSURED-IS-MALE        VALUE 'M'.
  5486             88  INSURED-IS-FEMALE      VALUE 'F'.
  5487             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5488         16  CL-INSURED-OCC-CD       PIC X(6).
  5489         16  FILLER                  PIC X(5).
  5490
  5491     12  CL-PROCESSING-INFO.
  5492         16  CL-PROCESSOR-ID         PIC X(4).
  5493         16  CL-CLAIM-STATUS         PIC X.
  5494             88  CLAIM-IS-OPEN          VALUE 'O'.
  5495             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5496         16  CL-CLAIM-TYPE           PIC X.
  5497*            88  AH-CLAIM               VALUE 'A'.
  5498*            88  LIFE-CLAIM             VALUE 'L'.
  5499*            88  PROPERTY-CLAIM         VALUE 'P'.
  5500*            88  IUI-CLAIM              VALUE 'I'.
  5501*            88  GAP-CLAIM              VALUE 'G'.
  5502*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  5503         16  CL-CLAIM-PREM-TYPE      PIC X.
  5504             88  SINGLE-PREMIUM         VALUE '1'.
  5505             88  O-B-COVERAGE           VALUE '2'.
  5506             88  OPEN-END-COVERAGE      VALUE '3'.
  5507         16  CL-INCURRED-DT          PIC XX.
  5508         16  CL-REPORTED-DT          PIC XX.
  5509         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5510         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5511         16  CL-LAST-PMT-DT          PIC XX.
  5512         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5513         16  CL-PAID-THRU-DT         PIC XX.
  5514         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5515         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5516         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5517         16  CL-PMT-CALC-METHOD      PIC X.
  5518             88  CL-360-DAY-YR          VALUE '1'.
  5519             88  CL-365-DAY-YR          VALUE '2'.
  5520             88  CL-FULL-MONTHS         VALUE '3'.
  5521         16  CL-CAUSE-CD             PIC X(6).
  5522
  5523         16  CL-PRIME-CERT-NO.
  5524             20  CL-PRIME-CERT-PRIME PIC X(10).
  5525             20  CL-PRIME-CERT-SFX   PIC X.
  5526
  5527         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5528             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5529             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5530
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 101
* EL1278.cbl
  5531         16  CL-MICROFILM-NO         PIC X(10).
  5532         16  FILLER REDEFINES CL-MICROFILM-NO.
  5533             20  CL-BENEFIT-PERIOD   PIC 99.
  5534             20  FILLER              PIC X(8).
  5535         16  CL-PROG-FORM-TYPE       PIC X.
  5536         16  CL-LAST-ADD-ON-DT       PIC XX.
  5537
  5538         16  CL-LAST-REOPEN-DT       PIC XX.
  5539         16  CL-LAST-CLOSE-DT        PIC XX.
  5540         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5541             88  FINAL-PAID             VALUE '1'.
  5542             88  CLAIM-DENIED           VALUE '2'.
  5543             88  AUTO-CLOSE             VALUE '3'.
  5544             88  MANUAL-CLOSE           VALUE '4'.
  5545             88  BENEFITS-CHANGED       VALUE 'C'.
  5546             88  SETUP-ERRORS           VALUE 'E'.
  5547         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5548         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5549         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5550             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5551         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5552         16  FILLER                  PIC X.
  5553
  5554     12  CL-CERTIFICATE-DATA.
  5555         16  CL-CERT-ORIGIN          PIC X.
  5556             88  CERT-WAS-ONLINE        VALUE '1'.
  5557             88  CERT-WAS-CREATED       VALUE '2'.
  5558             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5559         16  CL-CERT-KEY-DATA.
  5560             20  CL-CERT-CARRIER     PIC X.
  5561             20  CL-CERT-GROUPING    PIC X(6).
  5562             20  CL-CERT-STATE       PIC XX.
  5563             20  CL-CERT-ACCOUNT.
  5564                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5565                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5566             20  CL-CERT-EFF-DT      PIC XX.
  5567
  5568     12  CL-STATUS-CONTROLS.
  5569         16  CL-PRIORITY-CD          PIC X.
  5570             88  CONFIDENTIAL-DATA      VALUE '8'.
  5571             88  HIGHEST-PRIORITY       VALUE '9'.
  5572         16  CL-SUPV-ATTN-CD         PIC X.
  5573             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5574             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5575         16  CL-PURGED-DT            PIC XX.
  5576         16  CL-RESTORED-DT          PIC XX.
  5577         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5578         16  CL-NEXT-RESEND-DT       PIC XX.
  5579         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5580         16  CL-CRITICAL-PERIOD      PIC 99.
  5581*        16  FILLER                  PIC XX.
  5582         16  CL-LAST-MAINT-DT        PIC XX.
  5583         16  CL-LAST-MAINT-USER      PIC X(4).
  5584         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5585         16  CL-LAST-MAINT-TYPE      PIC X.
  5586             88  CLAIM-SET-UP           VALUE ' '.
  5587             88  PAYMENT-MADE           VALUE '1'.
  5588             88  LETTER-SENT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 102
* EL1278.cbl
  5589             88  MASTER-WAS-ALTERED     VALUE '3'.
  5590             88  MASTER-WAS-RESTORED    VALUE '4'.
  5591             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5592             88  FILE-CONVERTED         VALUE '6'.
  5593             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5594             88  ERROR-CORRECTION       VALUE 'E'.
  5595         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5596         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5597         16  CL-BENEFICIARY          PIC X(10).
  5598         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5599         16  CL-DENIAL-TYPE          PIC X.
  5600             88  CL-TYPE-DENIAL          VALUE '1'.
  5601             88  CL-TYPE-RESCISSION      VALUE '2'.
  5602             88  CL-TYPE-REFORMATION     VALUE '3'.
  5603             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5604             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5605         16  filler                  pic x(5).
  5606*        16  CL-CRIT-PER-RECURRENT   PIC X.
  5607*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5608*        16  CL-RTW-DT               PIC XX.
  5609
  5610     12  CL-TRAILER-CONTROLS.
  5611         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5612             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5613             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5614             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5615         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5616         16  FILLER                  PIC XX.
  5617         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5618         16  CL-ADDRESS-TRAILER-CNT.
  5619             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5620                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5621             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5622                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5623             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5624                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5625             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5626                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5627             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5628                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5629             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5630                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5631             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5632                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5633
  5634     12  CL-CV-REFERENCE-NO.
  5635         16  CL-CV-REFNO-PRIME       PIC X(18).
  5636         16  CL-CV-REFNO-SFX         PIC XX.
  5637
  5638     12  CL-FILE-LOCATION            PIC X(4).
  5639
  5640     12  CL-PROCESS-ERRORS.
  5641         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5642             88  NO-FATAL-ERRORS        VALUE ZERO.
  5643         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5644             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5645
  5646     12  CL-PRODUCT-CD               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 103
* EL1278.cbl
  5647
  5648     12  CL-CURRENT-KEY-DATA.
  5649         16  CL-CURRENT-CARRIER      PIC X.
  5650         16  CL-CURRENT-GROUPING     PIC X(6).
  5651         16  CL-CURRENT-STATE        PIC XX.
  5652         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5653
  5654     12  CL-ASSOCIATES               PIC X.
  5655         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5656         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5657         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5658         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5659
  5660     12  CL-ACTIVITY-CODE            PIC 99.
  5661     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5662     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5663
  5664     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5665     12  CL-LAG-REPORT-CODE          PIC 9.
  5666     12  CL-LOAN-TYPE                PIC XX.
  5667     12  CL-LEGAL-STATE              PIC XX.
  5668
  5669     12  CL-YESNOSW                  PIC X.
  5670     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5671         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5672         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5673         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5674     12  cl-insured-type             pic x.
  5675         88  cl-claim-on-primary         value 'P'.
  5676         88  cl-claim-on-co-borrower     value 'C'.
  5677     12  cl-benefit-expiration-dt    PIC XX.
  5678*                            COPY ERCPDEF.
  5679******************************************************************
  5680*                                                                *
  5681*                                                                *
  5682*                            ERCPDEF.                            *
  5683*                                                                *
  5684*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5685*                                                                *
  5686*    FILE TYPE = VSAM,KSDS                                       *
  5687*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5688*                                                                *
  5689*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5690*                                                                *
  5691*    LOG = YES                                                   *
  5692*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5693******************************************************************
  5694*                   C H A N G E   L O G
  5695*
  5696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5697*-----------------------------------------------------------------
  5698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5699* EFFECTIVE    NUMBER
  5700*-----------------------------------------------------------------
  5701* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5702* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5703* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5704******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 104
* EL1278.cbl
  5705 01  PRODUCT-MASTER.
  5706    12  PD-RECORD-ID                 PIC X(02).
  5707        88  VALID-PD-ID                  VALUE 'PD'.
  5708    12  PD-CONTROL-PRIMARY.
  5709        16  PD-COMPANY-CD            PIC X.
  5710        16  PD-STATE                 PIC XX.
  5711        16  PD-PRODUCT-CD            PIC XXX.
  5712        16  PD-FILLER                PIC X(7).
  5713        16  PD-BEN-TYPE              PIC X.
  5714        16  PD-BEN-CODE              PIC XX.
  5715        16  PD-PROD-EXP-DT           PIC XX.
  5716    12  FILLER                       PIC X(50).
  5717    12  PD-PRODUCT-DATA OCCURS 8.
  5718        16  PD-PROD-CODE             PIC X.
  5719            88  PD-PROD-LIFE           VALUE 'L'.
  5720            88  PD-PROD-PROP           VALUE 'P'.
  5721            88  PD-PROD-AH             VALUE 'A'.
  5722            88  PD-PROD-IU             VALUE 'I'.
  5723            88  PD-PROD-GAP            VALUE 'G'.
  5724            88  PD-PROD-FAML           VALUE 'F'.
  5725        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5726        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5727        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5728        16  PD-MAX-TERM              PIC S999        COMP-3.
  5729        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5730        16  FILLER                   PIC X.
  5731        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5732        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5733        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5734        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5735        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5736        16  PD-REC-CRIT-PERIOD       PIC 99.
  5737        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5738            20  PD-RECURRING-YN      PIC X.
  5739            20  FILLER               PIC X.
  5740        16  PD-RTW-MOS               PIC 99.
  5741        16  PD-MAX-EXTENSION         PIC 99.
  5742        16  pd-ben-pct               pic sv999 comp-3.
  5743*       16  FILLER                   PIC XX.
  5744    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5745    12  PD-TERM-LIMITS OCCURS 15.
  5746        16  PD-LOW-TERM              PIC S999        COMP-3.
  5747        16  PD-HI-TERM               PIC S999        COMP-3.
  5748*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5749    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5750        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5751        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5752    12  PD-EARN-FACTORS.
  5753        16  FILLER OCCURS 15.
  5754            20  FILLER OCCURS 15.
  5755                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5756    12  PD-PRODUCT-DESC              PIC X(80).
  5757    12  PD-TRUNCATED                 PIC X.
  5758    12  FILLER                       PIC X(59).
  5759    12  PD-MAINT-INFORMATION.
  5760        16  PD-LAST-MAINT-DT         PIC X(02).
  5761        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5762        16  PD-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 105
* EL1278.cbl
  5763*                            COPY ELCCRTT.
  5764******************************************************************
  5765*                                                                *
  5766*                            ELCCRTT.                            *
  5767*                                                                *
  5768*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5769*                                                                *
  5770*   FILE TYPE = VSAM,KSDS                                        *
  5771*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5772*                                                                *
  5773*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5774*                                                                *
  5775*   LOG = YES                                                    *
  5776*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5777******************************************************************
  5778*                   C H A N G E   L O G
  5779*
  5780* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5781*-----------------------------------------------------------------
  5782*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5783* EFFECTIVE    NUMBER
  5784*-----------------------------------------------------------------
  5785* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5786* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5787* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5788* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5789* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5790* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5791* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5792* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5793******************************************************************
  5794
  5795 01  CERTIFICATE-TRAILERS.
  5796     12  CS-RECORD-ID                      PIC XX.
  5797         88  VALID-CS-ID                      VALUE 'CS'.
  5798
  5799     12  CS-CONTROL-PRIMARY.
  5800         16  CS-COMPANY-CD                 PIC X.
  5801         16  CS-CARRIER                    PIC X.
  5802         16  CS-GROUPING                   PIC X(6).
  5803         16  CS-STATE                      PIC XX.
  5804         16  CS-ACCOUNT                    PIC X(10).
  5805         16  CS-CERT-EFF-DT                PIC XX.
  5806         16  CS-CERT-NO.
  5807             20  CS-CERT-PRIME             PIC X(10).
  5808             20  CS-CERT-SFX               PIC X.
  5809         16  CS-TRAILER-TYPE               PIC X.
  5810             88  COMM-TRLR           VALUE 'A'.
  5811             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5812             88  CERT-DATA-TRLR      VALUE 'C'.
  5813
  5814     12  CS-DATA-AREA                      PIC X(516).
  5815
  5816     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5817         16  CS-BANK-COMMISSION-AREA.
  5818             20  CS-BANK-COMMS       OCCURS 10.
  5819                 24  CS-AGT                PIC X(10).
  5820                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 106
* EL1278.cbl
  5821                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5822                 24  CS-RECALC-LV-INDIC    PIC X.
  5823                 24  FILLER                PIC X(10).
  5824         16  FILLER                        PIC X(256).
  5825
  5826     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5827****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5828         16  CS-MB-CLAIM-DATA OCCURS 24.
  5829             20  CS-CLAIM-NO               PIC X(7).
  5830             20  CS-CLAIM-TYPE             PIC X.
  5831                 88  CS-AH-CLM               VALUE 'A'.
  5832                 88  CS-IU-CLM               VALUE 'I'.
  5833                 88  CS-GP-CLM               VALUE 'G'.
  5834                 88  CS-LF-CLM               VALUE 'L'.
  5835                 88  CS-PR-CLM               VALUE 'P'.
  5836                 88  CS-FL-CLM               VALUE 'F'.
  5837             20  CS-INSURED-TYPE           PIC X.
  5838                 88  CS-PRIM-INSURED          VALUE 'P'.
  5839                 88  CS-CO-BORROWER           VALUE 'C'.
  5840             20  CS-BENEFIT-PERIOD         PIC 99.
  5841             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5842             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5843             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5844         16  FILLER                        PIC X(12).
  5845     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5846         16  CS-VIN-NUMBER                 PIC X(17).
  5847         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5848         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5849         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5850         16  cs-agent-name.
  5851             20  cs-agent-fname            pic x(20).
  5852             20  cs-agent-mi               pic x.
  5853             20  cs-agent-lname            pic x(25).
  5854         16  cs-license-no                 pic x(15).
  5855         16  cs-npn-number                 pic x(10).
  5856         16  cs-agent-edit-status          pic x.
  5857             88  cs-ae-refer-to-manager      value 'M'.
  5858             88  cs-ae-cover-sheet           value 'C'.
  5859             88  cs-ae-sig-form              value 'S'.
  5860             88  cs-ae-verified              value 'V'.
  5861             88  cs-unidentified-signature   value 'U'.
  5862             88  cs-cert-returned            value 'R'.
  5863             88  cs-accept-no-commission     value 'N'.
  5864         16  FILLER                        PIC X(424).
  5865*        16  FILLER                        PIC X(496).
  5866 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5867                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5868                          MAILING-DATA ORIGINAL-CERTIFICATE
  5869                          FORM-MASTER CLAIM-MASTER
  5870                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5871 0000-DFHEXIT SECTION.
  5872     MOVE '9#                    $   ' TO DFHEIV0.
  5873     MOVE 'EL1278' TO DFHEIV1.
  5874     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5875*    SERVICE RELOAD PARMLIST.
  5876
  5877     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5878     MOVE '5'                    TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 107
* EL1278.cbl
  5879
  5880     PERFORM 9600-DATE-LINK.
  5881
  5882     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5883     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5884     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5885     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5886     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5887     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5888     MOVE EIBTRMID               TO  QID-TERM.
  5889
  5890     IF EIBCALEN  IS EQUAL TO  ZERO
  5891         GO TO 8700-UNAUTHORIZED-ACCESS.
  5892
  5893     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5894         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5895             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5896             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5897             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5898             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5899             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5900             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5901             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5902             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5903         ELSE
  5904             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5905             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5906             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5907             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5908             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5909             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5910             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5911             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5912             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5913
  5914     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5915         GO TO 9300-CLEAR.
  5916
  5917     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5918         NEXT SENTENCE
  5919     ELSE
  5920
  5921* EXEC CICS READQ TS
  5922*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5923*            INTO    (SECURITY-CONTROL)
  5924*            LENGTH  (SC-COMM-LENGTH)
  5925*            ITEM    (SC-ITEM)
  5926*        END-EXEC
  5927*    MOVE '*$II   L              ''   #00005916' TO DFHEIV0
  5928     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5930     MOVE X'2020233030303035393136' TO DFHEIV0(25:11)
  5931     CALL 'kxdfhei1' USING DFHEIV0,
  5932           PI-SECURITY-TEMP-STORE-ID,
  5933           SECURITY-CONTROL,
  5934           SC-COMM-LENGTH,
  5935           SC-ITEM,
  5936           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 108
* EL1278.cbl
  5937           DFHEIV99
  5938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5939         MOVE SC-CREDIT-DISPLAY (33)
  5940                                 TO  PI-DISPLAY-CAP
  5941         MOVE SC-CREDIT-UPDATE  (33)
  5942                                 TO  PI-MODIFY-CAP
  5943         MOVE SC-CREDIT-UPDATE  (32)
  5944                                 TO  PI-MODIFY-CERT-CAP
  5945         IF NOT  DISPLAY-CAP
  5946             MOVE 'READ'         TO  SM-READ
  5947             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5948             MOVE ER-0070        TO  EMI-ERROR
  5949             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5950             GO TO 8100-SEND-INITIAL-MAP.
  5951
  5952     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5953         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5954         MOVE LOW-VALUES         TO  EL127HI
  5955         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5956                                     PI-LF-CANCEL-DATE
  5957                                     WS-AH-CANCEL-DATE
  5958                                     PI-AH-CANCEL-DATE
  5959         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5960                                     PI-LF-CANCEL-DATE-ED
  5961                                     WS-AH-CANCEL-DATE-ED
  5962                                     PI-AH-CANCEL-DATE-ED
  5963         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5964                                     PI-EARNING-METHOD-AH
  5965         PERFORM 0500-FORMAT-SCREEN
  5966         GO TO 8100-SEND-INITIAL-MAP.
  5967
  5968     IF NOT  MODIFY-CAP
  5969         MOVE 'UPDATE'           TO  SM-READ
  5970         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5971         MOVE ER-0070            TO  EMI-ERROR
  5972         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5973         GO TO 8100-SEND-INITIAL-MAP.
  5974
  5975
  5976* EXEC CICS HANDLE CONDITION
  5977*        PGMIDERR  (9500-PGMID-ERROR)
  5978*        ERROR     (9900-ABEND)
  5979*    END-EXEC.
  5980*    MOVE '"$L.                  ! " #00005958' TO DFHEIV0
  5981     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5983     MOVE X'2220233030303035393538' TO DFHEIV0(25:11)
  5984     CALL 'kxdfhei1' USING DFHEIV0
  5985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5986
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 109
* EL1278.cbl
  5988 0200-RECEIVE.
  5989     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5990         MOVE ER-0008            TO  EMI-ERROR
  5991         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5992         MOVE -1                 TO  HLCANCL
  5993         GO TO 8200-SEND-DATAONLY.
  5994
  5995
  5996* EXEC CICS RECEIVE
  5997*        MAP     (MAP-NAME)
  5998*        MAPSET  (MAPSET-NAME)
  5999*        INTO    (EL127HI)
  6000*    END-EXEC.
  6001     MOVE LENGTH OF
  6002      EL127HI
  6003       TO DFHEIV11
  6004*    MOVE '8"T I  L              ''   #00005970' TO DFHEIV0
  6005     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6006     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6007     MOVE X'2020233030303035393730' TO DFHEIV0(25:11)
  6008     CALL 'kxdfhei1' USING DFHEIV0,
  6009           MAP-NAME,
  6010           EL127HI,
  6011           DFHEIV11,
  6012           MAPSET-NAME,
  6013           DFHEIV99,
  6014           DFHEIV99
  6015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6016
  6017
  6018     IF HPFKEYL  IS EQUAL TO  ZERO
  6019         GO TO 0300-CHECK-PFKEYS.
  6020
  6021     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  6022         MOVE ER-0004            TO  EMI-ERROR
  6023         GO TO 0320-INPUT-ERROR.
  6024
  6025     IF HPFKEYI NUMERIC
  6026         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  6027             MOVE PF-VALUES (HPFKEYI)
  6028                                 TO  EIBAID
  6029         ELSE
  6030             MOVE ER-0029        TO  EMI-ERROR
  6031             GO TO 0320-INPUT-ERROR.
  6032
  6033 0300-CHECK-PFKEYS.
  6034     IF EIBAID  IS EQUAL TO  DFHPF23
  6035         GO TO 8800-PF23.
  6036
  6037     IF EIBAID  IS EQUAL TO  DFHPF24
  6038         GO TO 9100-RETURN-MAIN-MENU.
  6039
  6040     IF EIBAID = DFHPF11
  6041        GO TO 1700-WRITE-CERT-NOTE
  6042     END-IF
  6043
  6044     IF EIBAID  IS EQUAL TO  DFHPF12
  6045         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 110
* EL1278.cbl
  6046
  6047     IF EIBAID = DFHENTER OR DFHPF10
  6048        GO TO 0400-EDIT-INPUT-DATA
  6049     END-IF
  6050
  6051     MOVE ER-0029                TO  EMI-ERROR.
  6052
  6053 0320-INPUT-ERROR.
  6054     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6055
  6056     MOVE AL-UNBON               TO  HPFKEYA.
  6057
  6058     IF HPFKEYL  IS EQUAL TO  ZERO
  6059         MOVE -1                 TO  HLCANCL
  6060     ELSE
  6061         MOVE -1                 TO  HPFKEYL.
  6062
  6063     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 111
* EL1278.cbl
  6065 0400-EDIT-INPUT-DATA.
  6066     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6067                                     WS-NEW-LF-CANCEL-SW.
  6068
  6069     IF (HPCYNL > 0)
  6070        AND (HPCYNI = 'Y' OR 'N')
  6071        PERFORM 1800-READ-ELCERT-UPDATE
  6072                                 THRU 1800-EXIT
  6073        IF WS-RESP-NORMAL
  6074           MOVE HPCYNI           TO CM-POST-CARD-IND
  6075           PERFORM 1810-REWRITE-ELCERT
  6076                                 THRU 1810-EXIT
  6077        END-IF
  6078     END-IF
  6079     IF HLCAL1L GREATER ZERO
  6080         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6081     IF CLPYNI = 'Y'
  6082        MOVE 'Y'                   TO PI-CLP-YN
  6083        MOVE AL-UANON              TO CLPYNA
  6084     ELSE
  6085        MOVE ' '                   TO PI-CLP-YN
  6086        MOVE AL-UANON              TO CLPYNA
  6087     END-IF
  6088     IF CANREAI = 'R'
  6089        MOVE 'R'                 TO PI-CANCEL-REASON
  6090        MOVE AL-UANON            TO CANREAA
  6091     ELSE
  6092        MOVE ' '                 TO PI-CANCEL-REASON
  6093        MOVE AL-UANON            TO CANREAA
  6094     END-IF
  6095
  6096     IF HLCANCL  IS EQUAL TO  ZERO
  6097       AND HACANCL  IS EQUAL TO  ZERO
  6098         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6099         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6100         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6101         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6102         GO TO 0420-CHECK-ERRORS.
  6103
  6104     IF HLCANCL  IS EQUAL TO  ZERO
  6105         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6106         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6107         GO TO 0410-CHECK-AH-DATE.
  6108
  6109     IF HLCANCI = SPACES
  6110        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6111                                      WS-LF-CANCEL-DATE
  6112        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6113                                      WS-LF-CANCEL-DATE-ED
  6114                                      PI-LF-REFUND-METH
  6115        MOVE +0                    TO PI-LF-REFUND-AMT
  6116        GO TO 0410-CHECK-AH-DATE
  6117     END-IF
  6118
  6119     MOVE AL-UNNON               TO  HLCANCA.
  6120     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6121     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6122
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 112
* EL1278.cbl
  6123     PERFORM 8600-DEEDIT.
  6124
  6125     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6126     MOVE '4'                    TO  DC-OPTION-CODE.
  6127
  6128     PERFORM 9600-DATE-LINK.
  6129
  6130     IF DATE-CONVERSION-ERROR
  6131         MOVE -1                 TO  HLCANCL
  6132         MOVE AL-UABON           TO  HLCANCA
  6133         MOVE ER-2227            TO  EMI-ERROR
  6134         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6135     ELSE
  6136        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6137           MOVE -1               TO  HACANCL
  6138           MOVE AL-UABON         TO  HACANCA
  6139           MOVE ER-2774          TO  EMI-ERROR
  6140           PERFORM 9700-ERROR-FORMAT
  6141                                 THRU  9799-EXIT
  6142        ELSE
  6143           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6144                                    PI-LF-CANCEL-DATE
  6145           MOVE DC-GREG-DATE-1-EDIT
  6146                                 TO HLCANCO
  6147                                    WS-LF-CANCEL-DATE-ED
  6148                                    PI-LF-CANCEL-DATE-ED
  6149        END-IF
  6150     END-IF
  6151     .
  6152 0410-CHECK-AH-DATE.
  6153     IF HACAL1L GREATER ZERO
  6154         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6155
  6156     IF HACANCL  IS EQUAL TO  ZERO
  6157         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6158         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6159         GO TO 0420-CHECK-ERRORS.
  6160     IF HACANCI = SPACES
  6161        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6162                                      WS-AH-CANCEL-DATE
  6163        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6164                                      WS-AH-CANCEL-DATE-ED
  6165                                      PI-AH-REFUND-METH
  6166        MOVE +0                    TO PI-AH-REFUND-AMT
  6167        GO TO 0420-CHECK-ERRORS
  6168     END-IF
  6169
  6170     MOVE AL-UNNON               TO  HACANCA.
  6171     MOVE HACANCI                TO  DEEDIT-FIELD.
  6172     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6173
  6174     PERFORM 8600-DEEDIT.
  6175
  6176     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6177     MOVE '4'                    TO  DC-OPTION-CODE.
  6178
  6179     PERFORM 9600-DATE-LINK.
  6180
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 113
* EL1278.cbl
  6181     IF DATE-CONVERSION-ERROR
  6182         MOVE -1                 TO  HACANCL
  6183         MOVE AL-UABON           TO  HACANCA
  6184         MOVE ER-2227            TO  EMI-ERROR
  6185         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6186     ELSE
  6187        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6188           MOVE -1               TO  HACANCL
  6189           MOVE AL-UABON         TO  HACANCA
  6190           MOVE ER-2775          TO  EMI-ERROR
  6191           PERFORM 9700-ERROR-FORMAT
  6192                                 THRU  9799-EXIT
  6193        ELSE
  6194           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6195                                    PI-AH-CANCEL-DATE
  6196           MOVE DC-GREG-DATE-1-EDIT
  6197                                 TO HACANCO
  6198                                    WS-AH-CANCEL-DATE-ED
  6199                                    PI-AH-CANCEL-DATE-ED
  6200        END-IF
  6201     END-IF
  6202     .
  6203 0420-CHECK-ERRORS.
  6204     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6205         NEXT SENTENCE
  6206     ELSE
  6207         GO TO 8200-SEND-DATAONLY.
  6208
  6209     PERFORM 0500-FORMAT-SCREEN.
  6210     IF EIBAID = DFHPF10
  6211        perform 4000-GEN-CANCEL-TRANS
  6212                                 thru 4000-exit
  6213        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6214        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6215        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6216        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6217        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6218        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6219                               PI-ALL-CANCELS-SW
  6220        IF PI-PROCESSOR-IS-CSR
  6221            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6222        ELSE
  6223            MOVE ' '        TO PI-CSR-SESSION-SW
  6224        END-IF
  6225        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6226                               PI-CANCELS-IN-ERROR-SW
  6227                               PI-ONLY-BATCH-HEADERS-SW
  6228                               PI-ALL-OUT-OF-BAL-SW
  6229                               PI-HOLD-REC-SW
  6230                               PI-CHANGE-REC-SW
  6231                               PI-CHK-REQ-REC-SW
  6232                               PI-ISSUE-WARNING-SW
  6233                               PI-CANCEL-WARNING-SW
  6234        MOVE '1'            TO PI-BROWSE-TYPE
  6235        MOVE DFHENTER       TO  EIBAID
  6236
  6237
  6238* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 114
* EL1278.cbl
  6239*           PROGRAM    ('EL6311')
  6240*           COMMAREA   (WS-PASS-631)
  6241*           LENGTH     (1300)
  6242*       END-EXEC
  6243     MOVE 'EL6311' TO DFHEIV1
  6244     MOVE 1300
  6245       TO DFHEIV11
  6246*    MOVE '.$C                   %   #00006195' TO DFHEIV0
  6247     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6248     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6249     MOVE X'2020233030303036313935' TO DFHEIV0(25:11)
  6250     CALL 'kxdfhei1' USING DFHEIV0,
  6251           DFHEIV1,
  6252           WS-PASS-631,
  6253           DFHEIV11,
  6254           DFHEIV99
  6255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6256
  6257*        PERFORM 0500-FORMAT-SCREEN
  6258     END-IF
  6259     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 115
* EL1278.cbl
  6261 0500-FORMAT-SCREEN  SECTION.
  6262     MOVE LOW-VALUES             TO  EL127HO.
  6263     MOVE PI-CARRIER             TO  HCARIERO.
  6264     MOVE PI-GROUPING            TO  HGROUPO.
  6265     MOVE PI-STATE               TO  HSTATEO.
  6266     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6267     MOVE ' '                    TO  DC-OPTION-CODE.
  6268     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6269
  6270     PERFORM 9600-DATE-LINK.
  6271
  6272     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6273     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6274     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6275     MOVE PI-CLP-YN              TO  CLPYNO
  6276     MOVE PI-CANCEL-REASON       TO  CANREAO
  6277     .
  6278 0510-GET-CERT.
  6279     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6280     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6281     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6282     MOVE PI-STATE               TO  WS-CM-STATE.
  6283     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6284     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6285     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6286     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6287
  6288     PERFORM 0900-READ-CERT-FILE.
  6289
  6290     IF CERT-NOT-FOUND
  6291         MOVE -1                 TO  HLCANCL
  6292         MOVE AL-SANON           TO  HLCANCA
  6293         MOVE ER-0214            TO  EMI-ERROR
  6294         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6295         GO TO 8100-SEND-INITIAL-MAP.
  6296
  6297     IF CM-CLAIM-ATTACHED-COUNT = +0
  6298        GO TO 0510-SKIP-CLAIM-CHECK
  6299     END-IF
  6300*    DISPLAY ' STARTING CLAIM TEST '
  6301     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6302     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6303
  6304* EXEC CICS STARTBR
  6305*       DATASET     ('ELMSTR5')
  6306*       RIDFLD      (ELMSTR-KEY)
  6307*       RESP        (WS-RESPONSE)
  6308*    END-EXEC
  6309     MOVE 'ELMSTR5' TO DFHEIV1
  6310     MOVE 0
  6311       TO DFHEIV11
  6312*    MOVE '&,         G          &  N#00006247' TO DFHEIV0
  6313     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6314     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6315     MOVE X'204E233030303036323437' TO DFHEIV0(25:11)
  6316     CALL 'kxdfhei1' USING DFHEIV0,
  6317           DFHEIV1,
  6318           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 116
* EL1278.cbl
  6319           DFHEIV99,
  6320           DFHEIV11,
  6321           DFHEIV99
  6322     MOVE EIBRESP  TO WS-RESPONSE
  6323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6324     IF WS-RESP-NORMAL
  6325     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6326
  6327* EXEC CICS READNEXT
  6328*          DATASET   ('ELMSTR5')
  6329*          RIDFLD    (ELMSTR-KEY)
  6330*          SET       (ADDRESS OF CLAIM-MASTER)
  6331*          RESP      (WS-RESPONSE)
  6332*       END-EXEC
  6333     MOVE 'ELMSTR5' TO DFHEIV1
  6334     MOVE 0
  6335       TO DFHEIV11
  6336*    MOVE '&.S                   )  N#00006254' TO DFHEIV0
  6337     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6338     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6339     MOVE X'204E233030303036323534' TO DFHEIV0(25:11)
  6340     CALL 'kxdfhei1' USING DFHEIV0,
  6341           DFHEIV1,
  6342           DFHEIV20,
  6343           DFHEIV99,
  6344           ELMSTR-KEY,
  6345           DFHEIV99,
  6346           DFHEIV11,
  6347           DFHEIV99,
  6348           DFHEIV99
  6349     SET ADDRESS OF CLAIM-MASTER TO
  6350         DFHEIV20
  6351     MOVE EIBRESP  TO WS-RESPONSE
  6352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6353        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6354           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6355           AND (CM-CERT-NO = CL-CERT-NO)
  6356           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6357              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6358              SET FOUND-A-CLAIM  TO TRUE
  6359              IF CL-CLAIM-TYPE = 'L'
  6360                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6361                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6362                 END-IF
  6363                 IF CLAIM-IS-OPEN
  6364                    SET OPEN-LF-CLAIM TO TRUE
  6365                 ELSE
  6366                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6367                       MOVE CL-LAST-CLOSE-DT
  6368                                 TO WS-LF-LAST-CLOSE-DT
  6369                    END-IF
  6370                    SET CLOSED-LF-CLAIM TO TRUE
  6371                 END-IF
  6372              ELSE
  6373                 IF CLAIM-IS-OPEN
  6374                    MOVE CL-PAID-THRU-DT
  6375                                 TO WS-AH-PAID-THRU-DT
  6376                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 117
* EL1278.cbl
  6377                 ELSE
  6378                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6379                       MOVE CL-PAID-THRU-DT
  6380                                 TO WS-AH-PAID-THRU-DT
  6381                    END-IF
  6382                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6383                       MOVE CL-LAST-CLOSE-DT
  6384                                 TO WS-AH-LAST-CLOSE-DT
  6385                    END-IF
  6386                    SET CLOSED-AH-CLAIM TO TRUE
  6387                 END-IF
  6388              END-IF
  6389           END-IF
  6390        ELSE
  6391           SET I-SAY-TO-STOP TO TRUE
  6392        END-IF
  6393     END-PERFORM
  6394     END-IF
  6395     IF FOUND-A-CLAIM
  6396        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6397           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6398           MOVE ' '              TO DC-OPTION-CODE
  6399           PERFORM 9600-DATE-LINK
  6400           IF NO-CONVERSION-ERROR
  6401              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6402              MOVE AL-SANOF      TO LCLMDTHA
  6403           END-IF
  6404        END-IF
  6405        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6406           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6407           MOVE ' '              TO DC-OPTION-CODE
  6408           PERFORM 9600-DATE-LINK
  6409           IF NO-CONVERSION-ERROR
  6410              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6411              MOVE AL-SANOF      TO ACLMDTHA
  6412           END-IF
  6413        END-IF
  6414        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6415        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6416        MOVE CM-STATE            TO WS-CF-ACCESS
  6417        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6418
  6419* EXEC CICS READ
  6420*          DATASET  (ELCNTL-ID)
  6421*          SET      (ADDRESS OF CONTROL-FILE)
  6422*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6423*          RESP     (WS-RESPONSE)
  6424*       END-EXEC
  6425*    MOVE '&"S        E          (  N#00006325' TO DFHEIV0
  6426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6428     MOVE X'204E233030303036333235' TO DFHEIV0(25:11)
  6429     CALL 'kxdfhei1' USING DFHEIV0,
  6430           ELCNTL-ID,
  6431           DFHEIV20,
  6432           DFHEIV99,
  6433           WS-CF-CONTROL-PRIMARY,
  6434           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 118
* EL1278.cbl
  6435           DFHEIV99,
  6436           DFHEIV99
  6437     SET ADDRESS OF CONTROL-FILE TO
  6438         DFHEIV20
  6439     MOVE EIBRESP  TO WS-RESPONSE
  6440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6441        IF WS-RESP-NORMAL
  6442           MOVE CF-ST-REF-AH-DEATH-IND
  6443                                 TO WS-ST-REF-IND
  6444        END-IF
  6445     END-IF
  6446     .
  6447 0510-SKIP-CLAIM-CHECK.
  6448     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6449     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6450     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6451     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6452
  6453* EXEC CICS READ
  6454*        DATASET  (ERMAIL-ID)
  6455*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6456*        SET      (ADDRESS OF MAILING-DATA)
  6457*        RESP     (WS-RESPONSE)
  6458*    END-EXEC.
  6459*    MOVE '&"S        E          (  N#00006342' TO DFHEIV0
  6460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6462     MOVE X'204E233030303036333432' TO DFHEIV0(25:11)
  6463     CALL 'kxdfhei1' USING DFHEIV0,
  6464           ERMAIL-ID,
  6465           DFHEIV20,
  6466           DFHEIV99,
  6467           WS-MA-CONTROL-PRIMARY,
  6468           DFHEIV99,
  6469           DFHEIV99,
  6470           DFHEIV99
  6471     SET ADDRESS OF MAILING-DATA TO
  6472         DFHEIV20
  6473     MOVE EIBRESP  TO WS-RESPONSE
  6474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6475
  6476     IF WS-RESP-NORMAL
  6477        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6478           (S1 > +7)
  6479           OR (MA-MAIL-STATUS (S1) = '1')
  6480        END-PERFORM
  6481        IF S1 > +7
  6482           MOVE AL-SANOF         TO HPCYNA
  6483        END-IF
  6484     END-IF
  6485     IF CM-POST-CARD-IND = 'Y'
  6486        MOVE 'Y'                 TO HPCYNO
  6487     ELSE
  6488        MOVE 'N'                 TO HPCYNO
  6489     END-IF
  6490     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6491        OR (NOT CERT-AS-LOADED)
  6492        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 119
* EL1278.cbl
  6493     END-IF
  6494*    IF (CERT-ADDED-BATCH)
  6495*       CONTINUE
  6496*    ELSE
  6497*       MOVE AL-SANOF            TO HPCYNA
  6498*    END-IF
  6499     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6500     MOVE '5'                    TO  DC-OPTION-CODE.
  6501
  6502     PERFORM 9600-DATE-LINK.
  6503
  6504     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6505     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6506     MOVE '1'                    TO  DC-OPTION-CODE.
  6507
  6508     PERFORM 9600-DATE-LINK.
  6509
  6510     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6511
  6512     MOVE ZEROS TO WS-TOT-ITDR.
  6513     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6514
  6515 0510-CHECK-LF-STATUS.
  6516
  6517     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6518         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6519                                    PI-LF-CANCEL-DATE
  6520         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6521                                    PI-LF-CANCEL-DATE-ED
  6522                                    PI-LF-REFUND-METH
  6523         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6524         GO TO 0510-CHECK-AH-STATUS.
  6525
  6526     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6527        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6528          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6529          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6530          IF FIRST-ENTRY
  6531              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6532              MOVE SPACES               TO DC-OPTION-CODE
  6533              PERFORM 9600-DATE-LINK
  6534              IF NOT DATE-CONVERSION-ERROR
  6535                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6536                                            PI-LF-CANCEL-DATE-ED
  6537                                            WS-LF-CANCEL-DATE-ED
  6538                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6539                                            WS-LF-CANCEL-DATE.
  6540
  6541     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6542        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6543          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6544          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6545          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6546        IF FIRST-ENTRY
  6547            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6548            MOVE SPACES               TO DC-OPTION-CODE
  6549            PERFORM 9600-DATE-LINK
  6550            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 120
* EL1278.cbl
  6551                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6552                                          PI-LF-CANCEL-DATE-ED
  6553                                          WS-LF-CANCEL-DATE-ED
  6554                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6555                                          WS-LF-CANCEL-DATE.
  6556
  6557 0510-CHECK-AH-STATUS.
  6558
  6559     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6560         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6561                                    PI-AH-CANCEL-DATE
  6562         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6563                                    PI-AH-CANCEL-DATE-ED
  6564                                    PI-AH-REFUND-METH
  6565         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6566         GO TO 0510-CONT.
  6567
  6568     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6569        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6570          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6571          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6572        IF FIRST-ENTRY
  6573            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6574            MOVE SPACES               TO DC-OPTION-CODE
  6575            PERFORM 9600-DATE-LINK
  6576            IF NOT DATE-CONVERSION-ERROR
  6577                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6578                                            PI-AH-CANCEL-DATE-ED
  6579                                            WS-AH-CANCEL-DATE-ED
  6580                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6581                                            WS-AH-CANCEL-DATE.
  6582
  6583     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6584        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6585          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6586          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6587          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6588         IF FIRST-ENTRY
  6589             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6590             MOVE SPACES               TO DC-OPTION-CODE
  6591             PERFORM 9600-DATE-LINK
  6592             IF NOT DATE-CONVERSION-ERROR
  6593                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6594                                            PI-AH-CANCEL-DATE-ED
  6595                                            WS-AH-CANCEL-DATE-ED
  6596                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6597                                            WS-AH-CANCEL-DATE.
  6598
  6599     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6600         MOVE 'CANC DT'              TO  CNCDTHDO
  6601         GO TO 0510-CONT.
  6602
  6603     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6604         MOVE 'DTH DT '              TO  CNCDTHDO
  6605         IF FIRST-ENTRY
  6606             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6607             MOVE ' '                TO  DC-OPTION-CODE
  6608             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 121
* EL1278.cbl
  6609             IF NOT DATE-CONVERSION-ERROR
  6610                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6611                                             PI-AH-CANCEL-DATE-ED
  6612                                             WS-AH-CANCEL-DATE-ED
  6613                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6614                                             WS-AH-CANCEL-DATE.
  6615
  6616 0510-CONT.
  6617
  6618     IF WS-TOT-ITDR GREATER THAN ZEROS
  6619         MOVE WS-TOT-ITDR TO TOITDRO.
  6620
  6621 0520-GET-COMPANY-RECORD.
  6622     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6623     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6624     MOVE SPACES                 TO  WS-CF-ACCESS.
  6625     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6626
  6627     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6628
  6629     IF CNTL-NOT-FOUND
  6630         MOVE -1                 TO  HLCANCL
  6631         MOVE AL-SANON           TO  HLCANCA
  6632         MOVE ER-2616            TO  EMI-ERROR
  6633         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6634         GO TO 8100-SEND-INITIAL-MAP.
  6635
  6636     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6637       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6638         MOVE CF-LIFE-OVERRIDE-L1
  6639                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6640         MOVE CF-LIFE-OVERRIDE-L2
  6641                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6642         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6643         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6644         MOVE CF-CR-REM-TERM-CALC
  6645                                 TO  WS-CF-CR-REM-TERM-CALC
  6646         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6647         IF CF-DEFAULT-APR NUMERIC
  6648             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6649             GO TO 0525-GET-LF-BENEFIT
  6650         ELSE
  6651             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6652             GO TO 0525-GET-LF-BENEFIT.
  6653
  6654     MOVE -1                     TO  HLCANCL.
  6655     MOVE AL-SANON               TO  HLCANCA.
  6656     MOVE ER-2616                TO  EMI-ERROR.
  6657
  6658     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6659
  6660     GO TO 8100-SEND-INITIAL-MAP.
  6661
  6662 0525-GET-LF-BENEFIT.
  6663
  6664     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6665        GO TO 0527-GET-AH-BENEFIT
  6666     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 122
* EL1278.cbl
  6667
  6668     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6669     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6670                                     HLCDO.
  6671     MOVE WS-CF-LIFE-OVERRIDE-L2
  6672                                 TO  HLKINDO.
  6673
  6674     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6675
  6676     IF BENEFIT-FOUND
  6677         NEXT SENTENCE
  6678     ELSE
  6679         MOVE -1                 TO  HLCDL
  6680         MOVE AL-SANON           TO  HLCDA
  6681         MOVE ER-0028            TO  EMI-ERROR
  6682         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6683         GO TO 8100-SEND-INITIAL-MAP.
  6684
  6685     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6686         MOVE AL-UNNOF           TO  HLTERMA.
  6687
  6688*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6689     MOVE WS-KIND                TO WS-LF-KIND
  6690     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6691                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6692
  6693     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6694         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6695                                 TO  WS-LF-CO-REM-TERM-CALC.
  6696
  6697     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6698         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6699                                 TO  WS-LF-CO-EARNINGS-CALC
  6700                                     WS-LF-CO-REFUND-CALC.
  6701
  6702     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6703         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6704                                 TO  WS-LF-SPECIAL-CALC-CD.
  6705
  6706     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6707         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6708                                 TO  WS-LF-CO-REFUND-CALC.
  6709
  6710 0527-GET-AH-BENEFIT.
  6711
  6712     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6713        GO TO 0530-GET-STATE-RECORD
  6714     END-IF
  6715
  6716     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6717     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6718                                     HACDO.
  6719     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6720
  6721     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6722
  6723     IF BENEFIT-FOUND
  6724         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 123
* EL1278.cbl
  6725     ELSE
  6726         MOVE -1                 TO  HACDL
  6727         MOVE AL-SANON           TO  HACDA
  6728         MOVE ER-0028            TO  EMI-ERROR
  6729         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6730         GO TO 8100-SEND-INITIAL-MAP.
  6731
  6732     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6733         MOVE AL-UNNOF           TO  HATERMA.
  6734
  6735*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6736     MOVE WS-KIND                TO  WS-AH-KIND
  6737
  6738     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6739         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6740                                 TO  WS-AH-CO-REM-TERM-CALC.
  6741
  6742     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6743         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6744                                 TO  WS-AH-CO-EARNINGS-CALC
  6745                                     WS-AH-CO-REFUND-CALC.
  6746
  6747     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6748         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6749                                 TO  WS-AH-SPECIAL-CALC-CD.
  6750
  6751     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6752         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6753                                 TO  WS-AH-CO-REFUND-CALC.
  6754     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6755        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6756                                 TO WS-AH-BEN-CATEGORY
  6757     END-IF
  6758     .
  6759 0530-GET-STATE-RECORD.
  6760     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6761     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6762     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6763     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6764
  6765     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6766
  6767     IF CNTL-NOT-FOUND
  6768         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6769                                     WS-LF-ST-REM-TERM-CALC
  6770         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6771         GO TO 0560-FIND-ACCOUNT.
  6772
  6773     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6774       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6775       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6776         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6777     ELSE
  6778         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6779                                     WS-LF-ST-REM-TERM-CALC
  6780         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6781         GO TO 0560-FIND-ACCOUNT.
  6782
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 124
* EL1278.cbl
  6783     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6784     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6785
  6786     IF CM-LF-BENEFIT-CD  = '00'
  6787         GO TO 0550-GET-AH-BEN-IN-STATE.
  6788
  6789 0540-GET-LF-BEN-IN-STATE.
  6790     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6791     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6792
  6793     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6794     IF CF-ST-RT-CALC NOT = SPACES
  6795        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6796     END-IF
  6797
  6798     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6799        IF CF-ST-RF-LR-CALC > '0'
  6800           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6801        END-IF
  6802        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6803           IF CF-ST-RF-LN-CALC > '0'
  6804              MOVE CF-ST-RF-LN-CALC
  6805                                 TO WS-LF-ST-REFUND-CALC
  6806           END-IF
  6807        END-IF
  6808     ELSE
  6809        IF CF-ST-RF-LL-CALC > '0'
  6810           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6811        END-IF
  6812     END-IF
  6813
  6814     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6815
  6816     IF NO-BENEFIT-FOUND
  6817*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6818         GO TO 0550-GET-AH-BEN-IN-STATE.
  6819
  6820     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6821         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6822                                 TO  WS-LF-ST-REM-TERM-CALC.
  6823
  6824     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6825         MOVE CF-ST-REFUND-CALC (SUB3)
  6826                                 TO  WS-LF-ST-REFUND-CALC.
  6827
  6828 0550-GET-AH-BEN-IN-STATE.
  6829     IF CM-AH-BENEFIT-CD  = '00'
  6830         GO TO 0560-FIND-ACCOUNT.
  6831
  6832     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6833     IF CF-ST-RT-CALC NOT = SPACES
  6834        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6835     END-IF
  6836
  6837     IF CF-ST-RF-AH-CALC > '0'
  6838        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6839     END-IF
  6840     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 125
* EL1278.cbl
  6841        IF CF-ST-RF-CP-CALC > '0'
  6842           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6843        END-IF
  6844     END-IF
  6845
  6846     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6847     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6848
  6849     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6850
  6851     IF NO-BENEFIT-FOUND
  6852*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6853         GO TO 0560-FIND-ACCOUNT.
  6854
  6855     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6856         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6857                                 TO  WS-AH-ST-REM-TERM-CALC.
  6858
  6859     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6860         MOVE CF-ST-REFUND-CALC (SUB3)
  6861                                 TO  WS-AH-ST-REFUND-CALC.
  6862
  6863 0560-FIND-ACCOUNT.
  6864     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6865     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6866     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6867     MOVE CM-STATE               TO  WS-AM-STATE.
  6868     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6869     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6870     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6871
  6872     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6873
  6874     IF ACCT-FOUND
  6875         NEXT SENTENCE
  6876     ELSE
  6877         GO TO 0585-NO-ACCT.
  6878
  6879 0570-READ-NEXT-RANGE.
  6880     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6881
  6882     IF ACCT-FOUND
  6883         NEXT SENTENCE
  6884     ELSE
  6885         GO TO 0580-ACCT-NOT-FOUND.
  6886
  6887     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6888       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6889       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6890       AND CM-STATE  IS EQUAL TO  AM-STATE
  6891       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6892         NEXT SENTENCE
  6893     ELSE
  6894         GO TO 0580-ACCT-NOT-FOUND.
  6895
  6896     MOVE 'X'                    TO  DATE-RANGE-SW.
  6897
  6898     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 126
* EL1278.cbl
  6899         MOVE 'X'                TO  DATE-RANGE-SW
  6900         GO TO 0580-ACCT-NOT-FOUND.
  6901
  6902     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6903         GO TO 0570-READ-NEXT-RANGE.
  6904
  6905     IF WS-BROWSE-STARTED-SW = 'Y'
  6906
  6907* EXEC CICS ENDBR
  6908*          DATASET    ('ERACCT')
  6909*       END-EXEC
  6910     MOVE 'ERACCT' TO DFHEIV1
  6911     MOVE 0
  6912       TO DFHEIV11
  6913*    MOVE '&2                    $   #00006778' TO DFHEIV0
  6914     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6915     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6916     MOVE X'2020233030303036373738' TO DFHEIV0(25:11)
  6917     CALL 'kxdfhei1' USING DFHEIV0,
  6918           DFHEIV1,
  6919           DFHEIV11,
  6920           DFHEIV99
  6921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6922        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6923     END-IF
  6924     MOVE ' '                    TO  DATE-RANGE-SW.
  6925     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6926
  6927     GO TO 0590-SET-ACCOUNT.
  6928
  6929 0580-ACCT-NOT-FOUND.
  6930     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6931         MOVE ER-2601            TO  EMI-ERROR
  6932     ELSE
  6933         MOVE ER-2619            TO  EMI-ERROR.
  6934
  6935     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6936
  6937     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6938
  6939 0585-NO-ACCT.
  6940     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6941     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6942                                     WS-AM-EARN-METHOD-R
  6943                                     WS-AM-EARN-METHOD-A
  6944                                     WS-LF-AM-REM-TERM-CALC
  6945                                     WS-AH-AM-REM-TERM-CALC.
  6946
  6947     GO TO 0600-CHECK-FOR-LIFE.
  6948
  6949 0590-SET-ACCOUNT.
  6950******************************************************************
  6951******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6952******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6953******* METHODS.
  6954******************************************************************
  6955     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6956     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 127
* EL1278.cbl
  6957     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6958          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6959                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6960                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6961                  IF FORM-FOUND
  6962                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6963******************************************************************
  6964
  6965     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6966     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6967                                     WS-AM-EARN-METHOD-R
  6968                                     WS-AM-EARN-METHOD-A.
  6969
  6970*    EVALUATE AM-EARN-METHOD-R
  6971*       WHEN 'R'
  6972*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6973*       WHEN 'P'
  6974*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6975*       WHEN 'C'
  6976*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6977*       WHEN 'A'
  6978*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6979*       WHEN 'M'
  6980*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6981*       WHEN 'S'
  6982*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6983*    END-EVALUATE.
  6984
  6985*    EVALUATE AM-EARN-METHOD-L
  6986*       WHEN 'R'
  6987*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6988*       WHEN 'P'
  6989*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6990*       WHEN 'C'
  6991*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6992*       WHEN 'A'
  6993*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6994*       WHEN 'M'
  6995*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6996*       WHEN 'S'
  6997*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6998*    END-EVALUATE.
  6999
  7000*    EVALUATE AM-EARN-METHOD-A
  7001*       WHEN 'R'
  7002*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  7003*       WHEN 'P'
  7004*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  7005*       WHEN 'C'
  7006*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  7007*       WHEN 'A'
  7008*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  7009*       WHEN 'M'
  7010*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  7011*       WHEN 'N'
  7012*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  7013*       WHEN 'S'
  7014*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 128
* EL1278.cbl
  7015*    END-EVALUATE.
  7016
  7017     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  7018                                     WS-TOT-LF-PREM
  7019                                     WS-TOT-AH-RFND
  7020                                     WS-TOT-LF-RFND.
  7021
  7022 0600-CHECK-FOR-LIFE.
  7023     IF CM-LF-BENEFIT-CD  = '00'
  7024         GO TO 0640-AH-BENEFIT.
  7025
  7026 0610-GET-LIFE-BENEFIT.
  7027
  7028     IF ACCT-FOUND
  7029         MOVE +1                 TO SUB3
  7030         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  7031     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7032     MOVE WS-LF-KIND             TO  HLEDESCO.
  7033     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7034     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7035        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7036                             + CM-LF-ALT-PREMIUM-AMT
  7037     ELSE
  7038        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7039     END-IF
  7040
  7041     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7042     EVALUATE TRUE
  7043        WHEN ((OPEN-LF-CLAIM)
  7044           OR (CLOSED-LF-CLAIM))
  7045           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7046           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  7047                                    WS-TOT-LF-RFND
  7048                                    PI-LF-REFUND-AMT
  7049           IF CM-AH-BENEFIT-CD NOT = '00'
  7050              MOVE ZEROS         TO HAREFNDO
  7051                                    WS-TOT-AH-RFND
  7052                                    PI-AH-REFUND-AMT
  7053              MOVE SPACES        TO PI-AH-REFUND-METH
  7054           END-IF
  7055           MOVE ER-2965          TO EMI-ERROR
  7056           PERFORM 9700-ERROR-FORMAT
  7057                                 THRU  9799-EXIT
  7058           GO TO 0640-AH-BENEFIT
  7059        WHEN OPEN-LF-CLAIM
  7060           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7061           AND WS-ST-REF-IND = '4'
  7062           MOVE ER-2966          TO EMI-ERROR
  7063           PERFORM 9700-ERROR-FORMAT
  7064                                 THRU  9799-EXIT
  7065        WHEN OPEN-LF-CLAIM
  7066           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7067           AND WS-ST-REF-IND NOT = '4'
  7068           MOVE ER-2967          TO EMI-ERROR
  7069           PERFORM 9700-ERROR-FORMAT
  7070                                 THRU  9799-EXIT
  7071           GO TO 0640-AH-BENEFIT
  7072        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 129
* EL1278.cbl
  7073           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7074           AND WS-ST-REF-IND = '4'
  7075           MOVE ER-2968          TO EMI-ERROR
  7076           PERFORM 9700-ERROR-FORMAT
  7077                                 THRU  9799-EXIT
  7078        WHEN CLOSED-LF-CLAIM
  7079           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7080           AND WS-ST-REF-IND NOT = '4'
  7081           MOVE ER-2969          TO EMI-ERROR
  7082           PERFORM 9700-ERROR-FORMAT
  7083                                 THRU  9799-EXIT
  7084           GO TO 0640-AH-BENEFIT
  7085        WHEN OTHER
  7086           CONTINUE
  7087     END-EVALUATE
  7088     .
  7089 0620-GET-REM-TERM.
  7090     MOVE WS-CF-LIFE-OVERRIDE-L1
  7091                                 TO  CP-LIFE-OVERRIDE-CODE.
  7092     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7093     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7094     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7095     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7096     MOVE CM-STATE               TO  CP-STATE.
  7097     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7098     MOVE WS-CF-LF-COVERAGE-TYPE
  7099                                 TO  CP-BENEFIT-TYPE.
  7100     MOVE WS-LF-KIND             TO  HLEDESCO.
  7101     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7102     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7103     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7104     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7105     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7106     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7107     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7108     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7109     MOVE WS-CF-CR-REM-TERM-CALC
  7110                                 TO  CP-REM-TERM-METHOD.
  7111
  7112     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7113         MOVE WS-LF-CO-REM-TERM-CALC
  7114                                 TO  CP-REM-TERM-METHOD.
  7115
  7116     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7117         MOVE WS-LF-ST-REM-TERM-CALC
  7118                                 TO  CP-REM-TERM-METHOD.
  7119
  7120     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7121         MOVE WS-LF-AM-REM-TERM-CALC
  7122                                 TO  CP-REM-TERM-METHOD.
  7123
  7124     IF (PI-COMPANY-ID = 'CID')
  7125        AND (CP-STATE-STD-ABBRV = 'WI')
  7126        MOVE '7'                 TO CP-REM-TERM-METHOD
  7127        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7128     END-IF
  7129     IF (PI-COMPANY-ID = 'CID')
  7130        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 130
* EL1278.cbl
  7131        AND (CM-CERT-EFF-DT >= X'9B41')
  7132        AND (CM-CERT-EFF-DT <= X'A2FB')
  7133        MOVE '7'                 TO CP-REM-TERM-METHOD
  7134        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7135     END-IF
  7136     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7137                                     CP-ORIGINAL-TERM
  7138                                     CP-LOAN-TERM.
  7139
  7140     IF CP-TRUNCATED-LIFE
  7141         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7142
  7143     IF CP-TERM-IS-DAYS
  7144         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7145             MOVE CM-LF-TERM-IN-DAYS
  7146                                 TO  CP-TERM-OR-EXT-DAYS
  7147         ELSE
  7148             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7149     ELSE
  7150         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7151             MOVE CM-PMT-EXTENSION-DAYS
  7152                                 TO  CP-TERM-OR-EXT-DAYS
  7153         ELSE
  7154             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7155
  7156*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7157     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7158     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7159     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7160     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7161
  7162
  7163* EXEC CICS READ
  7164*        DATASET  (ELCNTL-ID)
  7165*        SET      (ADDRESS OF CONTROL-FILE)
  7166*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7167*        RESP     (WS-RESPONSE)
  7168*    END-EXEC.
  7169*    MOVE '&"S        E          (  N#00007021' TO DFHEIV0
  7170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7172     MOVE X'204E233030303037303231' TO DFHEIV0(25:11)
  7173     CALL 'kxdfhei1' USING DFHEIV0,
  7174           ELCNTL-ID,
  7175           DFHEIV20,
  7176           DFHEIV99,
  7177           WS-CF-CONTROL-PRIMARY,
  7178           DFHEIV99,
  7179           DFHEIV99,
  7180           DFHEIV99
  7181     SET ADDRESS OF CONTROL-FILE TO
  7182         DFHEIV20
  7183     MOVE EIBRESP  TO WS-RESPONSE
  7184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7185
  7186
  7187     IF WS-RESP-NOTOPEN
  7188         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 131
* EL1278.cbl
  7189         GO TO 0320-INPUT-ERROR.
  7190
  7191     IF WS-RESP-NOTFND
  7192         MOVE ZERO               TO  CP-FREE-LOOK
  7193     ELSE
  7194         MOVE CF-ST-FREE-LOOK-PERIOD
  7195                                 TO CP-FREE-LOOK.
  7196
  7197     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7198        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7199        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7200     END-IF
  7201
  7202     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7203
  7204     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7205        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7206        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7207        COMPUTE CP-REMAINING-TERM-1 =
  7208                CP-REMAINING-TERM-1 - +1
  7209        COMPUTE CP-REMAINING-TERM-2 =
  7210                CP-REMAINING-TERM-2 - +1
  7211     END-IF
  7212
  7213     IF CP-REMAINING-TERM-1 NEGATIVE
  7214        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7215     END-IF
  7216     IF CP-REMAINING-TERM-2 NEGATIVE
  7217        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7218     END-IF
  7219     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7220
  7221     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7222         GO TO 0640-AH-BENEFIT.
  7223*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7224*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7225
  7226     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7227         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7228             MOVE ER-0681        TO  EMI-ERROR
  7229             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7230
  7231     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7232         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7233             MOVE ER-0682        TO  EMI-ERROR
  7234             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7235
  7236 0630-CONTINUE-LIFE.
  7237
  7238     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7239        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7240        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7241                                    FREMTRMO
  7242     ELSE
  7243        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7244                                     FREMTRMO
  7245     END-IF
  7246     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 132
* EL1278.cbl
  7247     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7248     if pi-company-id = 'AHL'
  7249        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7250        if cp-class-code = spaces
  7251           move zeros            to cp-class-code
  7252        end-if
  7253     ELSE
  7254        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7255     END-IF
  7256     IF (PI-COMPANY-ID = 'DCC')
  7257        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7258        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7259        PERFORM 0730-GET-DDF-FACTORS
  7260                                 THRU 0730-EXIT
  7261        IF PDEF-FOUND
  7262           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7263              (P1 > +8)
  7264              OR (PD-PROD-CODE (P1) = 'L')
  7265           END-PERFORM
  7266           IF P1 < +9
  7267              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7268           END-IF
  7269        END-IF
  7270     END-IF
  7271     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7272
  7273     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7274
  7275     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7276        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7277                             + CM-LF-ALT-PREMIUM-AMT
  7278     ELSE
  7279        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7280     END-IF
  7281
  7282     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7283                                     WS-TOT-LF-PREM.
  7284
  7285     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7286        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7287        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7288     ELSE
  7289        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7290     END-IF
  7291
  7292     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7293     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7294
  7295     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7296         MOVE WS-LF-ST-REFUND-CALC
  7297                                 TO  CP-EARNING-METHOD.
  7298
  7299     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7300         MOVE WS-LF-FO-REFUND-CALC
  7301                                 TO  CP-EARNING-METHOD.
  7302
  7303     if (pi-company-id = 'CID')
  7304        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 133
* EL1278.cbl
  7305        continue
  7306     else
  7307        IF CP-RATING-METHOD = '4'
  7308           MOVE '4'              TO CP-EARNING-METHOD
  7309        END-IF
  7310     end-if
  7311*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7312*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7313*            MOVE WS-AM-EARN-METHOD-R
  7314*                                TO  CP-EARNING-METHOD
  7315*        END-IF
  7316*    ELSE
  7317*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7318*            MOVE WS-AM-EARN-METHOD-L
  7319*                                TO  CP-EARNING-METHOD.
  7320
  7321     if pi-company-id = 'AHL'
  7322        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7323        if cp-class-code = spaces
  7324           move zeros            to cp-class-code
  7325        end-if
  7326     ELSE
  7327        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7328     END-IF
  7329     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7330     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7331                                     CP-RATING-BENEFIT-AMT.
  7332     IF CP-STATE-STD-ABBRV = 'OR'
  7333         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7334                                         CM-LF-ALT-BENEFIT-AMT.
  7335****   N O T E   ****
  7336*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7337*      THE OH HARD CODING IN ELCRFNDP
  7338
  7339     IF PI-COMPANY-ID = 'CID'
  7340        IF CP-STATE-STD-ABBRV = 'OH'
  7341           MOVE WS-LF-CO-EARNINGS-CALC
  7342                                 TO CP-EARNING-METHOD
  7343        END-IF
  7344     END-IF
  7345
  7346****   N O T E   ****
  7347
  7348****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7349****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7350****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7351****     THE APPROPRIATE OPTIONS HERE
  7352*    IF PI-COMPANY-ID = 'CID'
  7353*       IF (CP-STATE-STD-ABBRV = 'MN')
  7354*          AND (CM-CERT-EFF-DT > X'A4FF')
  7355*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7356*          MOVE '5'              TO CP-EARNING-METHOD
  7357*       END-IF
  7358*    END-IF
  7359     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7360     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7361     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7362     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 134
* EL1278.cbl
  7363     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7364     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7365
  7366*    IF CP-EARN-AS-NET-PAY
  7367*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7368*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7369*               MOVE WS-CF-DEFAULT-APR
  7370*                                TO  CP-LOAN-APR
  7371*               MOVE ER-3780     TO  EMI-ERROR
  7372*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7373*           ELSE
  7374*               MOVE ER-3781     TO  EMI-ERROR
  7375*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7376
  7377*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7378*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7379*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7380*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7381*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7382*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7383*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7384*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7385*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7386*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7387*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7388*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7389*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7390*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7391*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7392*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7393*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7394*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7395     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7396
  7397     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7398
  7399     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7400
  7401     IF CP-ERROR-RATE-IS-ZERO
  7402       OR CP-ERROR-RATE-NOT-FOUND
  7403         MOVE ER-2740            TO  EMI-ERROR
  7404         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7405
  7406     IF CP-ERROR-RATE-FILE-NOTOPEN
  7407         MOVE ER-2617            TO  EMI-ERROR
  7408         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7409
  7410     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7411     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7412                                     WS-TOT-LF-RFND
  7413                                     PI-LF-REFUND-AMT.
  7414     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7415
  7416     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7417
  7418     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7419         GO TO 0640-AH-BENEFIT.
  7420
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 135
* EL1278.cbl
  7421*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7422*        ADD +1                  TO  CP-REMAINING-TERM
  7423*                                    CP-ORIGINAL-TERM.
  7424
  7425     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7426     MOVE '2'                    TO  CP-EARNING-METHOD
  7427                                     CP-RATING-METHOD.
  7428     IF PI-COMPANY-ID = 'CID'
  7429        IF (CP-STATE-STD-ABBRV = 'MN')
  7430           AND (CM-CERT-EFF-DT > X'A4FF')
  7431           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7432           MOVE '5'              TO CP-EARNING-METHOD
  7433           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7434        END-IF
  7435     END-IF
  7436     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7437                                     CP-REMAINING-BENEFIT
  7438                                     CP-RATING-BENEFIT-AMT.
  7439     IF CP-STATE-STD-ABBRV = 'OR'
  7440         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7441                                         CM-LF-ALT-BENEFIT-AMT.
  7442     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7443     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7444
  7445     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7446
  7447     IF CP-ERROR-RATE-IS-ZERO
  7448       OR CP-ERROR-RATE-NOT-FOUND
  7449         MOVE ER-2740            TO  EMI-ERROR
  7450         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7451
  7452     IF CP-ERROR-RATE-FILE-NOTOPEN
  7453         MOVE ER-2617            TO  EMI-ERROR
  7454         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7455
  7456     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7457
  7458     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7459                                     WS-TOT-LF-RFND
  7460                                     PI-LF-REFUND-AMT.
  7461
  7462     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7463
  7464 0640-AH-BENEFIT.
  7465     IF CM-AH-BENEFIT-CD = '00'
  7466         GO TO 0680-CONTINUE.
  7467
  7468 0650-GET-AH-BENEFIT.
  7469     IF ACCT-FOUND
  7470         MOVE +1                 TO SUB3
  7471         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7472     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7473     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7474     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7475     MOVE WS-AH-KIND             TO  HAEDESCO.
  7476     EVALUATE TRUE
  7477        WHEN ((OPEN-LF-CLAIM)
  7478           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 136
* EL1278.cbl
  7479           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7480           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7481                                    WS-TOT-AH-RFND
  7482                                    PI-AH-REFUND-AMT
  7483           MOVE SPACES           TO PI-AH-REFUND-METH
  7484           MOVE ER-2965          TO EMI-ERROR
  7485           PERFORM 9700-ERROR-FORMAT
  7486                                 THRU  9799-EXIT
  7487           GO TO 0680-CONTINUE
  7488        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7489           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7490           AND (EMI-ERROR = ER-2965)
  7491           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7492           MOVE ZEROS            TO HAREFNDO
  7493                                    WS-TOT-AH-RFND
  7494                                    PI-AH-REFUND-AMT
  7495           MOVE SPACES           TO PI-AH-REFUND-METH
  7496           GO TO 0680-CONTINUE
  7497        WHEN (OPEN-AH-CLAIM)
  7498           AND (WS-ST-REF-IND = '1')
  7499           MOVE ZEROS            TO HAREFNDO
  7500                                    WS-TOT-AH-RFND
  7501                                    PI-AH-REFUND-AMT
  7502           MOVE ER-3039          TO EMI-ERROR
  7503           PERFORM 9700-ERROR-FORMAT
  7504                                 THRU  9799-EXIT
  7505           GO TO 0680-CONTINUE
  7506        WHEN (OPEN-AH-CLAIM)
  7507           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7508           MOVE ER-3037          TO EMI-ERROR
  7509           PERFORM 9700-ERROR-FORMAT
  7510                                 THRU  9799-EXIT
  7511*          CONTINUE
  7512        WHEN (OPEN-AH-CLAIM)
  7513           AND (WS-ST-REF-IND = '5')
  7514           MOVE ER-3038          TO EMI-ERROR
  7515           PERFORM 9700-ERROR-FORMAT
  7516                                 THRU  9799-EXIT
  7517*          CONTINUE
  7518        WHEN (OPEN-AH-CLAIM)
  7519           AND (WS-ST-REF-IND = ' ')
  7520           MOVE ER-2768          TO EMI-ERROR
  7521           PERFORM 9700-ERROR-FORMAT
  7522                                 THRU  9799-EXIT
  7523        WHEN (CLOSED-AH-CLAIM)
  7524           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7525           MOVE ZEROS            TO HAREFNDO
  7526                                    WS-TOT-AH-RFND
  7527                                    PI-AH-REFUND-AMT
  7528           MOVE ER-2756          TO EMI-ERROR
  7529           PERFORM 9700-ERROR-FORMAT
  7530                                 THRU  9799-EXIT
  7531           IF WS-TOT-LF-RFND > 0
  7532              MOVE ZEROS         TO HLREFNDO
  7533                                    WS-TOT-LF-RFND
  7534                                    PI-LF-REFUND-AMT
  7535              MOVE SPACES        TO PI-LF-REFUND-METH
  7536           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 137
* EL1278.cbl
  7537           GO TO 0680-CONTINUE
  7538*       WHEN OTHER
  7539*          CONTINUE
  7540     END-EVALUATE
  7541     .
  7542 0660-GET-REM-TERM.
  7543     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7544     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7545     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7546     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7547     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7548*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7549     MOVE WS-AH-KIND             TO  HAEDESCO.
  7550     MOVE CM-STATE               TO  CP-STATE.
  7551     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7552     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7553     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7554     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7555     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7556     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7557     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7558     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7559     MOVE WS-CF-CR-REM-TERM-CALC
  7560                                 TO  CP-REM-TERM-METHOD.
  7561
  7562     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7563         MOVE WS-AH-CO-REM-TERM-CALC
  7564                                 TO  CP-REM-TERM-METHOD.
  7565
  7566     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7567         MOVE WS-AH-ST-REM-TERM-CALC
  7568                                 TO  CP-REM-TERM-METHOD.
  7569
  7570     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7571         MOVE WS-AH-AM-REM-TERM-CALC
  7572                                 TO  CP-REM-TERM-METHOD.
  7573     IF (PI-COMPANY-ID = 'CID')
  7574        AND (CP-STATE-STD-ABBRV = 'WI')
  7575        MOVE '7'                 TO CP-REM-TERM-METHOD
  7576        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7577     END-IF
  7578     IF (PI-COMPANY-ID = 'CID')
  7579        AND (CP-STATE-STD-ABBRV = 'MO')
  7580        AND (CM-CERT-EFF-DT >= X'9B41')
  7581        AND (CM-CERT-EFF-DT <= X'A2FB')
  7582        MOVE '7'                 TO CP-REM-TERM-METHOD
  7583        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7584     END-IF
  7585
  7586     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7587                                     CP-ORIGINAL-TERM
  7588                                     CP-LOAN-TERM.
  7589
  7590     IF  NOT  CP-TERM-IS-DAYS
  7591         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7592             MOVE CM-PMT-EXTENSION-DAYS
  7593                                 TO  CP-TERM-OR-EXT-DAYS
  7594         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 138
* EL1278.cbl
  7595             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7596
  7597*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7598     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7599     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7600     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7601     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7602
  7603
  7604* EXEC CICS READ
  7605*        DATASET  (ELCNTL-ID)
  7606*        SET      (ADDRESS OF CONTROL-FILE)
  7607*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7608*        RESP     (WS-RESPONSE)
  7609*    END-EXEC.
  7610*    MOVE '&"S        E          (  N#00007444' TO DFHEIV0
  7611     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7612     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7613     MOVE X'204E233030303037343434' TO DFHEIV0(25:11)
  7614     CALL 'kxdfhei1' USING DFHEIV0,
  7615           ELCNTL-ID,
  7616           DFHEIV20,
  7617           DFHEIV99,
  7618           WS-CF-CONTROL-PRIMARY,
  7619           DFHEIV99,
  7620           DFHEIV99,
  7621           DFHEIV99
  7622     SET ADDRESS OF CONTROL-FILE TO
  7623         DFHEIV20
  7624     MOVE EIBRESP  TO WS-RESPONSE
  7625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7626
  7627
  7628     IF WS-RESP-NOTOPEN
  7629         MOVE ER-2617            TO  EMI-ERROR
  7630         GO TO 0320-INPUT-ERROR.
  7631
  7632     IF WS-RESP-NOTFND
  7633         MOVE ZERO               TO CP-FREE-LOOK
  7634     ELSE
  7635         MOVE CF-ST-FREE-LOOK-PERIOD
  7636                                 TO CP-FREE-LOOK.
  7637
  7638     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7639
  7640     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7641
  7642     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7643         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7644             MOVE ER-0683        TO  EMI-ERROR
  7645             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7646
  7647     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7648         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7649             MOVE ER-0684        TO  EMI-ERROR
  7650             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7651
  7652 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 139
* EL1278.cbl
  7653     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7654                                     WS-TOT-AH-PREM.
  7655     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7656
  7657     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7658         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7659
  7660     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7661        GO TO 0680-CONTINUE.
  7662     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7663     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7664     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7665
  7666     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7667         MOVE WS-AH-ST-REFUND-CALC
  7668                                 TO  CP-EARNING-METHOD.
  7669
  7670     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7671         MOVE WS-AH-FO-REFUND-CALC
  7672                                 TO  CP-EARNING-METHOD.
  7673
  7674*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7675*        MOVE WS-AM-EARN-METHOD-A
  7676*                                TO  CP-EARNING-METHOD.
  7677
  7678     if pi-company-id = 'AHL'
  7679        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7680        if cp-class-code = spaces
  7681           move zeros            to cp-class-code
  7682        end-if
  7683     ELSE
  7684        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7685     END-IF
  7686     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7687     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7688                                     CP-RATING-BENEFIT-AMT.
  7689     IF CP-STATE-STD-ABBRV = 'OR'
  7690         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7691                                         CM-AH-ORIG-TERM.
  7692     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7693     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7694     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7695     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7696     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7697     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7698
  7699     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7700     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7701     MOVE ' '                    TO  DC-OPTION-CODE.
  7702
  7703     PERFORM 9600-DATE-LINK.
  7704
  7705     IF CP-STATE-STD-ABBRV = 'OH'
  7706        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7707         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7708           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7709           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7710             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 140
* EL1278.cbl
  7711         END-IF
  7712        END-IF
  7713        IF PI-COMPANY-ID = 'CID'
  7714           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7715                           LOW-VALUES)
  7716              IF CP-CRITICAL-PERIOD
  7717                 MOVE '2'       TO CP-EARNING-METHOD
  7718              ELSE
  7719                 MOVE '6'       TO CP-EARNING-METHOD
  7720              END-IF
  7721           ELSE
  7722              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7723                 MOVE '2'       TO CP-EARNING-METHOD
  7724              ELSE
  7725                 IF ((CM-LF-ORIG-TERM > 60) AND
  7726                    (CM-RATE-CLASS NOT = 'L '))
  7727                               OR
  7728                    (WS-LF-CO-EARNINGS-CALC = '5')
  7729                    IF CP-CRITICAL-PERIOD
  7730                       MOVE '2'  TO CP-EARNING-METHOD
  7731                    ELSE
  7732                       MOVE '6'  TO CP-EARNING-METHOD
  7733                    END-IF
  7734                 ELSE
  7735                    MOVE '1'     TO CP-EARNING-METHOD
  7736                 END-IF
  7737              END-IF
  7738           END-IF
  7739        END-IF
  7740     END-IF
  7741
  7742     IF CP-STATE-STD-ABBRV = 'VA'
  7743       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7744         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7745            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7746                MOVE '6'            TO  CP-EARNING-METHOD
  7747            ELSE
  7748                MOVE '1'            TO  CP-EARNING-METHOD.
  7749
  7750     IF CP-EARN-AS-NET-PAY
  7751         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7752            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7753                MOVE WS-CF-DEFAULT-APR
  7754                                 TO  CP-LOAN-APR
  7755                MOVE ER-3780     TO  EMI-ERROR
  7756                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7757            ELSE
  7758                MOVE ER-3781     TO  EMI-ERROR
  7759                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7760     IF PI-COMPANY-ID = 'DCC'
  7761        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7762           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7763           MOVE 'S'              TO CP-EARNING-METHOD
  7764        END-IF
  7765     END-IF
  7766     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7767     IF (PI-COMPANY-ID = 'DCC')
  7768        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 141
* EL1278.cbl
  7769        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7770                                    WS-DDF-CSO-ADMIN-FEE
  7771                                    WS-DDF-1ST-YR-TOT-EXP
  7772                                    WS-DDF-COMM-AND-MFEE
  7773        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7774           S1 > +10
  7775           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7776              IF (AM-A-COM (S1) NUMERIC)
  7777                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7778                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7779              ELSE
  7780                 MOVE +0         TO WS-COMM-PCT C0
  7781                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7782                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7783              END-IF
  7784              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7785                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7786                    + WS-COMM-PCT
  7787              END-IF
  7788              IF AM-COM-TYP (S1) = 'N'
  7789                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7790                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7791              END-IF
  7792              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7793                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7794                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7795              END-IF
  7796              IF AM-COM-TYP (S1) = 'I'
  7797                 COMPUTE WS-DDF-COMM-AND-MFEE
  7798                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7799              END-IF
  7800           END-IF
  7801        END-PERFORM
  7802        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7803        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7804        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7805           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7806     END-IF
  7807     IF (PI-COMPANY-ID = 'DCC')
  7808        AND (CP-EARNING-METHOD = 'D')
  7809        AND (PI-CANCEL-REASON NOT = 'R')
  7810        PERFORM 0730-GET-DDF-FACTORS
  7811                                 THRU 0730-EXIT
  7812        IF NOT PDEF-FOUND
  7813           MOVE ER-9999          TO EMI-ERROR
  7814           PERFORM 9700-ERROR-FORMAT
  7815                                 THRU 9799-EXIT
  7816           GO TO 8200-SEND-DATAONLY
  7817        END-IF
  7818        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7819                                 TO CP-DDF-LO-FACT
  7820        MOVE PD-UEP-FACTOR (P1 P2)
  7821                                 TO CP-DDF-HI-FACT
  7822        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7823        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7824        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7825        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7826           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 142
* EL1278.cbl
  7827        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7828        IF PI-CLP-YN = 'Y'
  7829           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7830           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7831                                    CP-DDF-CLP
  7832           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7833        END-IF
  7834        IF DD-IU-PRESENT
  7835           MOVE 'I'              TO CP-EARNING-METHOD
  7836        END-IF
  7837        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7838                                    CP-CLP-RATE-UP
  7839        IF (CP-CALC-GROSS-FEE)
  7840           AND (CP-IU-RATE-UP NOT = ZEROS)
  7841           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7842              / CP-ORIGINAL-PREMIUM)
  7843           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7844              / (1 - TEX-FACT-8)
  7845        END-IF
  7846     END-IF
  7847     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7848
  7849     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7850
  7851     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7852
  7853     IF CP-ERROR-RATE-IS-ZERO
  7854       OR CP-ERROR-RATE-NOT-FOUND
  7855         MOVE ER-2740            TO  EMI-ERROR
  7856         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7857
  7858     IF CP-ERROR-RATE-FILE-NOTOPEN
  7859         MOVE ER-2617            TO  EMI-ERROR
  7860         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7861
  7862     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7863     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7864                                     WS-TOT-AH-RFND
  7865                                     PI-AH-REFUND-AMT.
  7866
  7867     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7868
  7869     MOVE AL-UANON               TO  HACANCA.
  7870
  7871 0680-CONTINUE.
  7872     IF BROWSE-STARTED
  7873         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7874         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7875
  7876     IF CM-LF-BENEFIT-CD = '00'
  7877         MOVE -1                 TO  HACANCL
  7878     ELSE
  7879         MOVE -1                 TO  HLCANCL.
  7880
  7881     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7882                           WS-TOT-PREM.
  7883     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7884                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 143
* EL1278.cbl
  7885
  7886     MOVE WS-TOT-PREM            TO  TOPREMO.
  7887     MOVE WS-TOT-RFND            TO  TORFNDO.
  7888
  7889 0680-EXIT.
  7890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 144
* EL1278.cbl
  7892 0700-LINK-REM-TERM SECTION.
  7893
  7894* EXEC CICS LINK
  7895*        PROGRAM   (ELRTRM-ID)
  7896*        COMMAREA  (CALCULATION-PASS-AREA)
  7897*        LENGTH    (CP-COMM-LENGTH)
  7898*    END-EXEC.
  7899*    MOVE '."C                   (   #00007716' TO DFHEIV0
  7900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7902     MOVE X'2020233030303037373136' TO DFHEIV0(25:11)
  7903     CALL 'kxdfhei1' USING DFHEIV0,
  7904           ELRTRM-ID,
  7905           CALCULATION-PASS-AREA,
  7906           CP-COMM-LENGTH,
  7907           DFHEIV99,
  7908           DFHEIV99,
  7909           DFHEIV99,
  7910           DFHEIV99
  7911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7912
  7913
  7914 0700-EXIT.
  7915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 145
* EL1278.cbl
  7917 0710-LINK-REM-AMOUNT SECTION.
  7918
  7919* EXEC CICS LINK
  7920*        PROGRAM   (ELRAMT-ID)
  7921*        COMMAREA  (CALCULATION-PASS-AREA)
  7922*        LENGTH    (CP-COMM-LENGTH)
  7923*    END-EXEC.
  7924*    MOVE '."C                   (   #00007726' TO DFHEIV0
  7925     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7927     MOVE X'2020233030303037373236' TO DFHEIV0(25:11)
  7928     CALL 'kxdfhei1' USING DFHEIV0,
  7929           ELRAMT-ID,
  7930           CALCULATION-PASS-AREA,
  7931           CP-COMM-LENGTH,
  7932           DFHEIV99,
  7933           DFHEIV99,
  7934           DFHEIV99,
  7935           DFHEIV99
  7936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7937
  7938
  7939 0710-EXIT.
  7940     EXIT.
  7941 0730-GET-DDF-FACTORS.
  7942     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7943     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7944     MOVE CM-STATE               TO ERPDEF-STATE
  7945     if cm-clp-state <> cm-state and spaces
  7946                  and low-values and zeros
  7947        move cm-clp-state        to erpdef-state
  7948     end-if
  7949     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7950     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7951     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7952     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7953     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7954
  7955* EXEC CICS STARTBR
  7956*        DATASET  ('ERPDEF')
  7957*        RIDFLD   (ERPDEF-KEY)
  7958*        GTEQ
  7959*        RESP     (WS-RESPONSE)
  7960*    END-EXEC
  7961     MOVE 'ERPDEF' TO DFHEIV1
  7962     MOVE 0
  7963       TO DFHEIV11
  7964*    MOVE '&,         G          &  N#00007747' TO DFHEIV0
  7965     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7967     MOVE X'204E233030303037373437' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0,
  7969           DFHEIV1,
  7970           ERPDEF-KEY,
  7971           DFHEIV99,
  7972           DFHEIV11,
  7973           DFHEIV99
  7974     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 146
* EL1278.cbl
  7975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7976     IF NOT WS-RESP-NORMAL
  7977        GO TO 0730-EXIT
  7978     END-IF
  7979     .
  7980 0730-READNEXT.
  7981
  7982* EXEC CICS READNEXT
  7983*       DATASET  ('ERPDEF')
  7984*       SET      (ADDRESS OF PRODUCT-MASTER)
  7985*       RIDFLD   (ERPDEF-KEY)
  7986*       RESP     (WS-RESPONSE)
  7987*    END-EXEC
  7988     MOVE 'ERPDEF' TO DFHEIV1
  7989     MOVE 0
  7990       TO DFHEIV11
  7991*    MOVE '&.S                   )  N#00007758' TO DFHEIV0
  7992     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7993     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7994     MOVE X'204E233030303037373538' TO DFHEIV0(25:11)
  7995     CALL 'kxdfhei1' USING DFHEIV0,
  7996           DFHEIV1,
  7997           DFHEIV20,
  7998           DFHEIV99,
  7999           ERPDEF-KEY,
  8000           DFHEIV99,
  8001           DFHEIV11,
  8002           DFHEIV99,
  8003           DFHEIV99
  8004     SET ADDRESS OF PRODUCT-MASTER TO
  8005         DFHEIV20
  8006     MOVE EIBRESP  TO WS-RESPONSE
  8007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8008     IF NOT WS-RESP-NORMAL
  8009        GO TO 0730-ENDBR
  8010     END-IF
  8011     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8012        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8013           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8014        ELSE
  8015           GO TO 0730-READNEXT
  8016        END-IF
  8017     ELSE
  8018        GO TO 0730-ENDBR
  8019     END-IF
  8020     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8021        (P1 > +8)
  8022        OR (PD-PROD-CODE (P1) = 'I')
  8023     END-PERFORM
  8024     IF P1 < +9
  8025        SET DD-IU-PRESENT        TO TRUE
  8026     END-IF
  8027     IF CM-LOAN-TERM = ZEROS
  8028        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  8029     END-IF
  8030     IF PD-TRUNCATED = 'Y'
  8031        MOVE CM-LOAN-TERM        TO WS-TERM
  8032     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 147
* EL1278.cbl
  8033        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  8034     END-IF
  8035     EVALUATE TRUE
  8036        WHEN WS-TERM > +168
  8037           MOVE 15               TO P1
  8038        WHEN WS-TERM > +156
  8039           MOVE 14               TO P1
  8040        WHEN WS-TERM > +144
  8041           MOVE 13               TO P1
  8042        WHEN WS-TERM > +132
  8043           MOVE 12               TO P1
  8044        WHEN WS-TERM > +120
  8045           MOVE 11               TO P1
  8046        WHEN WS-TERM > +108
  8047           MOVE 10               TO P1
  8048        WHEN WS-TERM > +96
  8049           MOVE 9                TO P1
  8050        WHEN WS-TERM > +84
  8051           MOVE 8                TO P1
  8052        WHEN WS-TERM > +72
  8053           MOVE 7                TO P1
  8054        WHEN WS-TERM > +60
  8055           MOVE 6                TO P1
  8056        WHEN WS-TERM > +48
  8057           MOVE 5                TO P1
  8058        WHEN WS-TERM > +36
  8059           MOVE 4                TO P1
  8060        WHEN WS-TERM > +24
  8061           MOVE 3                TO P1
  8062        WHEN WS-TERM > +12
  8063           MOVE 2                TO P1
  8064        WHEN OTHER
  8065           MOVE 1                TO P1
  8066     END-EVALUATE
  8067     EVALUATE TRUE
  8068*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8069*          AND (DD-IU-PRESENT)
  8070*          MOVE 2                TO P2
  8071*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8072*          MOVE 1                TO P2
  8073        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8074           MOVE 2                TO P2
  8075        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8076           MOVE 3                TO P2
  8077        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8078           MOVE 4                TO P2
  8079        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8080           MOVE 5                TO P2
  8081        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8082           MOVE 6                TO P2
  8083        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8084           MOVE 7                TO P2
  8085        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8086           MOVE 8                TO P2
  8087        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8088           MOVE 9                TO P2
  8089        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8090           MOVE 10               TO P2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 148
* EL1278.cbl
  8091        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8092           MOVE 11               TO P2
  8093        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8094           MOVE 12               TO P2
  8095        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8096           MOVE 13               TO P2
  8097        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8098           MOVE 14               TO P2
  8099        WHEN OTHER
  8100           MOVE 15               TO P2
  8101     END-EVALUATE
  8102     .
  8103 0730-ENDBR.
  8104
  8105* EXEC CICS ENDBR
  8106*       DATASET  ('ERPDEF')
  8107*    END-EXEC
  8108     MOVE 'ERPDEF' TO DFHEIV1
  8109     MOVE 0
  8110       TO DFHEIV11
  8111*    MOVE '&2                    $   #00007860' TO DFHEIV0
  8112     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8114     MOVE X'2020233030303037383630' TO DFHEIV0(25:11)
  8115     CALL 'kxdfhei1' USING DFHEIV0,
  8116           DFHEIV1,
  8117           DFHEIV11,
  8118           DFHEIV99
  8119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8120     .
  8121 0730-EXIT.
  8122     EXIT.
  8123 0740-GET-ERCTBL.
  8124     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8125     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8126     MOVE 'A'                    TO CTBL-BEN-TYPE
  8127     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8128     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8129     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8130     IF WS-RESP-NORMAL
  8131        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8132     ELSE
  8133        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8134        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8135        MOVE 'A'                    TO CTBL-BEN-TYPE
  8136        MOVE 'AA'                   TO CTBL-BEN-CODE
  8137        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8138        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8139        IF WS-RESP-NORMAL
  8140           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8141        END-IF
  8142     END-IF
  8143     .
  8144 0740-EXIT.
  8145     EXIT.
  8146 0750-READ-ERCTBL.
  8147
  8148* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 149
* EL1278.cbl
  8149*         INTO    (COMM-TABLE-RECORD)
  8150*         DATASET ('ERCTBL')
  8151*         RIDFLD  (CTBL-KEY)
  8152*         RESP    (WS-RESPONSE)
  8153*    END-EXEC
  8154     MOVE LENGTH OF
  8155      COMM-TABLE-RECORD
  8156       TO DFHEIV11
  8157     MOVE 'ERCTBL' TO DFHEIV1
  8158*    MOVE '&"IL       E          (  N#00007890' TO DFHEIV0
  8159     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8161     MOVE X'204E233030303037383930' TO DFHEIV0(25:11)
  8162     CALL 'kxdfhei1' USING DFHEIV0,
  8163           DFHEIV1,
  8164           COMM-TABLE-RECORD,
  8165           DFHEIV11,
  8166           CTBL-KEY,
  8167           DFHEIV99,
  8168           DFHEIV99,
  8169           DFHEIV99
  8170     MOVE EIBRESP  TO WS-RESPONSE
  8171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8172     .
  8173 0750-EXIT.
  8174     EXIT.
  8175 0760-FIND-COMM.
  8176     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8177        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8178        OR (C1 > +3)
  8179     END-PERFORM
  8180     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8181        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8182        OR (C2 > +3)
  8183     END-PERFORM
  8184     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8185        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8186        OR (C3 > +3)
  8187     END-PERFORM
  8188     IF C1 > +3
  8189        MOVE +1                  TO C1
  8190     END-IF
  8191     IF C2 > +3
  8192        MOVE +1                  TO C2
  8193     END-IF
  8194     IF C3 > +3
  8195        MOVE +1                  TO C3
  8196     END-IF
  8197     IF C1 = +3
  8198        MOVE +18                 TO C0
  8199     ELSE
  8200        IF C1 = +2
  8201           MOVE +9               TO C0
  8202        END-IF
  8203     END-IF
  8204     IF C2 = +3
  8205        ADD +6                   TO C0
  8206     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 150
* EL1278.cbl
  8207        IF C2 = +2
  8208           ADD +3                TO C0
  8209        END-IF
  8210     END-IF
  8211     ADD C3                      TO C0
  8212     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8213     .
  8214 0760-EXIT.
  8215     EXIT.
  8216 0800-LINK-REFUND SECTION.
  8217     IF CP-AH
  8218       IF PI-EARNING-METHOD-AH NOT = SPACES
  8219         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8220        ELSE
  8221         NEXT SENTENCE
  8222      ELSE
  8223       IF PI-EARNING-METHOD-LF NOT = SPACES
  8224         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8225
  8226
  8227* EXEC CICS LINK
  8228*        PROGRAM   (ELRFND-ID)
  8229*        COMMAREA  (CALCULATION-PASS-AREA)
  8230*        LENGTH    (CP-COMM-LENGTH)
  8231*    END-EXEC.
  8232*    MOVE '."C                   (   #00007950' TO DFHEIV0
  8233     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8235     MOVE X'2020233030303037393530' TO DFHEIV0(25:11)
  8236     CALL 'kxdfhei1' USING DFHEIV0,
  8237           ELRFND-ID,
  8238           CALCULATION-PASS-AREA,
  8239           CP-COMM-LENGTH,
  8240           DFHEIV99,
  8241           DFHEIV99,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246
  8247 0899-EXIT.
  8248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 151
* EL1278.cbl
  8250 0900-READ-CERT-FILE  SECTION.
  8251
  8252* EXEC CICS HANDLE CONDITION
  8253*        NOTFND  (0910-NOT-FOUND)
  8254*    END-EXEC.
  8255*    MOVE '"$I                   ! # #00007960' TO DFHEIV0
  8256     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8258     MOVE X'2320233030303037393630' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262
  8263
  8264* EXEC CICS READ
  8265*        DATASET  (ELCERT-ID)
  8266*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8267*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8268*    END-EXEC.
  8269*    MOVE '&"S        E          (   #00007964' TO DFHEIV0
  8270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8272     MOVE X'2020233030303037393634' TO DFHEIV0(25:11)
  8273     CALL 'kxdfhei1' USING DFHEIV0,
  8274           ELCERT-ID,
  8275           DFHEIV20,
  8276           DFHEIV99,
  8277           WS-CM-CONTROL-PRIMARY,
  8278           DFHEIV99,
  8279           DFHEIV99,
  8280           DFHEIV99
  8281     SET ADDRESS OF CERTIFICATE-MASTER TO
  8282         DFHEIV20
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8284
  8285
  8286*    SERVICE RELOAD CERTIFICATE-MASTER.
  8287
  8288     GO TO 0999-EXIT.
  8289
  8290 0910-NOT-FOUND.
  8291     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8292
  8293 0999-EXIT.
  8294     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 152
* EL1278.cbl
  8296 1000-READ-CONTROL  SECTION.
  8297
  8298* EXEC CICS HANDLE CONDITION
  8299*        NOTFND   (1010-NOTFND)
  8300*        NOTOPEN  (1020-NOTOPEN)
  8301*    END-EXEC.
  8302*    MOVE '"$IJ                  ! $ #00007981' TO DFHEIV0
  8303     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8305     MOVE X'2420233030303037393831' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8308
  8309
  8310
  8311* EXEC CICS READ
  8312*        DATASET  (ELCNTL-ID)
  8313*        SET      (ADDRESS OF CONTROL-FILE)
  8314*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8315*        GTEQ
  8316*    END-EXEC.
  8317*    MOVE '&"S        G          (   #00007986' TO DFHEIV0
  8318     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8320     MOVE X'2020233030303037393836' TO DFHEIV0(25:11)
  8321     CALL 'kxdfhei1' USING DFHEIV0,
  8322           ELCNTL-ID,
  8323           DFHEIV20,
  8324           DFHEIV99,
  8325           WS-CF-CONTROL-PRIMARY,
  8326           DFHEIV99,
  8327           DFHEIV99,
  8328           DFHEIV99
  8329     SET ADDRESS OF CONTROL-FILE TO
  8330         DFHEIV20
  8331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8332
  8333
  8334*    SERVICE RELOAD CONTROL-FILE.
  8335
  8336     GO TO 1099-EXIT.
  8337
  8338 1010-NOTFND.
  8339     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8340
  8341     GO TO 1099-EXIT.
  8342
  8343 1020-NOTOPEN.
  8344     MOVE ER-2617                TO  EMI-ERROR.
  8345
  8346     GO TO 0320-INPUT-ERROR.
  8347
  8348 1099-EXIT.
  8349     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 153
* EL1278.cbl
  8351 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8352     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8353
  8354     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8355         VARYING  SUB3  FROM  1  BY  1
  8356             UNTIL  ((SUB3  IS GREATER THAN  50)
  8357               OR ((CF-ST-BENEFIT-CD (SUB3)
  8358                      IS EQUAL TO  WS-BEN-CD)
  8359               AND (WS-LOOKUP-TYPE
  8360                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8361
  8362     IF SUB3  IS NOT EQUAL TO  51
  8363         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8364
  8365     GO TO 1199-EXIT.
  8366
  8367 1110-BENEFIT-DUMMY.
  8368
  8369 1119-EXIT.
  8370     EXIT.
  8371
  8372 1199-EXIT.
  8373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 154
* EL1278.cbl
  8375 1200-START-ACCOUNT-MASTER  SECTION.
  8376
  8377* EXEC CICS HANDLE CONDITION
  8378*        NOTFND   (1290-ACCT-NOT-FOUND)
  8379*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8380*    END-EXEC.
  8381*    MOVE '"$I''                  ! % #00008035' TO DFHEIV0
  8382     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8384     MOVE X'2520233030303038303335' TO DFHEIV0(25:11)
  8385     CALL 'kxdfhei1' USING DFHEIV0
  8386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8387
  8388
  8389     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8390
  8391
  8392* EXEC CICS STARTBR
  8393*        DATASET  (ERACCT-ID)
  8394*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8395*        GTEQ
  8396*    END-EXEC.
  8397     MOVE 0
  8398       TO DFHEIV11
  8399*    MOVE '&,         G          &   #00008042' TO DFHEIV0
  8400     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8401     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8402     MOVE X'2020233030303038303432' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0,
  8404           ERACCT-ID,
  8405           WS-AM-CONTROL-PRIMARY,
  8406           DFHEIV99,
  8407           DFHEIV11,
  8408           DFHEIV99
  8409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8410
  8411
  8412     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8413     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8414
  8415     GO TO 1299-EXIT.
  8416
  8417 1290-ACCT-NOT-FOUND.
  8418     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8419
  8420 1299-EXIT.
  8421     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 155
* EL1278.cbl
  8423 1300-READ-ACCOUNT-MASTER  SECTION.
  8424
  8425* EXEC CICS HANDLE CONDITION
  8426*        NOTFND   (0580-ACCT-NOT-FOUND)
  8427*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8428*    END-EXEC.
  8429*    MOVE '"$I''                  ! & #00008060' TO DFHEIV0
  8430     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8432     MOVE X'2620233030303038303630' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0
  8434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8435
  8436
  8437
  8438* EXEC CICS READNEXT
  8439*        DATASET  (ERACCT-ID)
  8440*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8441*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8442*    END-EXEC.
  8443     MOVE 0
  8444       TO DFHEIV11
  8445*    MOVE '&.S                   )   #00008065' TO DFHEIV0
  8446     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8447     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8448     MOVE X'2020233030303038303635' TO DFHEIV0(25:11)
  8449     CALL 'kxdfhei1' USING DFHEIV0,
  8450           ERACCT-ID,
  8451           DFHEIV20,
  8452           DFHEIV99,
  8453           WS-AM-CONTROL-PRIMARY,
  8454           DFHEIV99,
  8455           DFHEIV11,
  8456           DFHEIV99,
  8457           DFHEIV99
  8458     SET ADDRESS OF ACCOUNT-MASTER TO
  8459         DFHEIV20
  8460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8461
  8462
  8463*    SERVICE RELOAD ACCOUNT-MASTER.
  8464
  8465 1399-EXIT.
  8466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 156
* EL1278.cbl
  8468 1400-GET-REFUND-TYPE  SECTION.
  8469     IF LIFE-REFUND-SEARCH
  8470         NEXT SENTENCE
  8471     ELSE
  8472         GO TO 1410-AH-REFUND-TYPE.
  8473
  8474     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8475         MOVE SPACES             TO  HLCALCO
  8476                                     HLCAL1O
  8477         GO TO 1499-EXIT.
  8478
  8479     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8480
  8481     EVALUATE TRUE
  8482        WHEN CP-R-AS-REPOSSESSION
  8483           MOVE 'REPOSSESSION'     TO  HLCALCO
  8484        WHEN CP-R-AS-R78
  8485           MOVE 'RULE 78'          TO  HLCALCO
  8486        WHEN  CP-R-AS-PRORATA
  8487           MOVE 'PRO RATA'         TO  HLCALCO
  8488        WHEN CP-R-AS-CALIF
  8489           MOVE 'CALIF'            TO  HLCALCO
  8490        WHEN CP-R-AS-TEXAS
  8491           MOVE 'IRREG'            TO  HLCALCO
  8492        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8493           MOVE 'UTAH'             TO  HLCALCO
  8494        WHEN CP-R-AS-FARM-PLAN
  8495           MOVE 'FARM PLAN'        TO  HLCALCO
  8496        WHEN CP-R-AS-NET-PAY
  8497           MOVE 'NET PAY'          TO  HLCALCO
  8498        WHEN CP-R-AS-ANTICIPATION
  8499           MOVE 'ANTICIPATION'     TO  HLCALCO
  8500        WHEN CP-R-AS-MEAN
  8501           MOVE 'MEAN'             TO  HLCALCO
  8502        WHEN CP-R-AS-SUM-OF-DIGITS
  8503           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8504        WHEN OTHER
  8505           MOVE 'UNDEFINED'        TO  HLCALCO
  8506     END-EVALUATE.
  8507
  8508     GO TO 1499-EXIT.
  8509
  8510 1410-AH-REFUND-TYPE.
  8511     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8512         MOVE SPACES             TO  HACALCO
  8513                                     HACAL1O
  8514         GO TO 1499-EXIT.
  8515
  8516     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8517
  8518     EVALUATE TRUE
  8519        WHEN CP-R-AS-REPOSSESSION
  8520           MOVE 'REPOSSESSION'     TO HACALCO
  8521        WHEN CP-R-AS-R78
  8522           MOVE 'RULE 78'          TO HACALCO
  8523        WHEN CP-R-AS-PRORATA
  8524           MOVE 'PRO RATA'         TO HACALCO
  8525        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 157
* EL1278.cbl
  8526           MOVE 'CALIF'            TO HACALCO
  8527        WHEN CP-R-AS-TEXAS
  8528           MOVE 'IRREG'            TO HACALCO
  8529        WHEN CP-R-AS-FARM-PLAN
  8530           MOVE 'FARM PLAN'        TO HACALCO
  8531        WHEN CP-R-AS-NET-PAY
  8532           MOVE 'NET PAY'          TO HACALCO
  8533        WHEN CP-R-AS-ANTICIPATION
  8534           MOVE 'ANTICIPATION'     TO HACALCO
  8535        WHEN CP-R-AS-MEAN
  8536           MOVE 'MEAN'             TO HACALCO
  8537        WHEN CP-R-AS-SUM-OF-DIGITS
  8538           MOVE 'SUM OF DIGIT'     TO HACALCO
  8539        WHEN CP-GAP-ACTUARIAL
  8540           MOVE 'SP ACTUARIAL'     TO HACALCO
  8541        WHEN CP-R-AS-SPP-DDF
  8542           MOVE 'SPEC DDF'         TO HACALCO
  8543        WHEN CP-R-AS-SPP-DDF-IU
  8544           MOVE 'SPEC DDF IU'      TO HACALCO
  8545        WHEN OTHER
  8546           MOVE 'UNKNOWN'          TO HLCALCO
  8547     END-EVALUATE
  8548     .
  8549 1499-EXIT.
  8550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 158
* EL1278.cbl
  8552 1500-END-BROWSE  SECTION.
  8553     IF BROWSE-STARTED
  8554
  8555* EXEC CICS ENDBR
  8556*            DATASET  (ERACCT-ID)
  8557*        END-EXEC.
  8558     MOVE 0
  8559       TO DFHEIV11
  8560*    MOVE '&2                    $   #00008162' TO DFHEIV0
  8561     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8562     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8563     MOVE X'2020233030303038313632' TO DFHEIV0(25:11)
  8564     CALL 'kxdfhei1' USING DFHEIV0,
  8565           ERACCT-ID,
  8566           DFHEIV11,
  8567           DFHEIV99
  8568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8569
  8570
  8571 1599-EXIT.
  8572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 159
* EL1278.cbl
  8574 1600-LOCATE-BENEFIT  SECTION.
  8575
  8576* EXEC CICS HANDLE CONDITION
  8577*        NOTFND  (1699-EXIT)
  8578*    END-EXEC.
  8579*    MOVE '"$I                   ! '' #00008170' TO DFHEIV0
  8580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8582     MOVE X'2720233030303038313730' TO DFHEIV0(25:11)
  8583     CALL 'kxdfhei1' USING DFHEIV0
  8584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8585
  8586
  8587     MOVE SPACES                 TO  WS-KIND.
  8588     MOVE ZERO                   TO  WS-NOT-FOUND.
  8589     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8590     MOVE SPACES                 TO  WS-CF-STATE.
  8591     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8592
  8593
  8594* EXEC CICS READ
  8595*        DATASET  (ELCNTL-ID)
  8596*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8597*        SET      (ADDRESS OF CONTROL-FILE)
  8598*        GTEQ
  8599*    END-EXEC.
  8600*    MOVE '&"S        G          (   #00008180' TO DFHEIV0
  8601     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8603     MOVE X'2020233030303038313830' TO DFHEIV0(25:11)
  8604     CALL 'kxdfhei1' USING DFHEIV0,
  8605           ELCNTL-ID,
  8606           DFHEIV20,
  8607           DFHEIV99,
  8608           WS-CF-CONTROL-PRIMARY,
  8609           DFHEIV99,
  8610           DFHEIV99,
  8611           DFHEIV99
  8612     SET ADDRESS OF CONTROL-FILE TO
  8613         DFHEIV20
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8615
  8616
  8617*    SERVICE RELOAD CONTROL-FILE.
  8618
  8619     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8620       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8621         GO TO 1699-EXIT.
  8622
  8623     MOVE +1                     TO  WS-INDEX.
  8624
  8625 1610-LOOKUP-BENEFIT.
  8626     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8627         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8628                                 TO  WS-KIND
  8629         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8630                                 TO  WS-CALC-CD
  8631         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 160
* EL1278.cbl
  8632                                 TO  WS-BENEFIT-DESCRIP
  8633         MOVE +1                 TO  WS-NOT-FOUND
  8634         GO TO 1699-EXIT.
  8635
  8636     IF CF-BENEFIT-CODE (WS-INDEX)
  8637             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8638         GO TO 1699-EXIT.
  8639
  8640     IF WS-INDEX  IS LESS THAN  +8
  8641         ADD +1                  TO  WS-INDEX
  8642         GO TO 1610-LOOKUP-BENEFIT.
  8643
  8644 1699-EXIT.
  8645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 161
* EL1278.cbl
  8647 1700-WRITE-CERT-NOTE      SECTION.
  8648     IF NOT MODIFY-CERT-CAP
  8649         MOVE 'UPDATE'           TO  SM-READ
  8650         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8651         MOVE ER-0070            TO  EMI-ERROR
  8652         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8653         GO TO 8200-SEND-DATAONLY.
  8654
  8655**MOVE CANCEL QUOTE NOTE INFO
  8656     IF PI-LF-REFUND-AMT NUMERIC
  8657        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8658        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8659     ELSE
  8660        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8661                                    PI-LF-REFUND-AMT
  8662        MOVE SPACE               TO WS-CN-LF-REF-METH
  8663                                    PI-LF-REFUND-METH.
  8664
  8665     IF PI-AH-REFUND-AMT NUMERIC
  8666        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8667        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8668     ELSE
  8669        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8670                                    PI-AH-REFUND-AMT
  8671        MOVE SPACE               TO WS-CN-AH-REF-METH
  8672                                    PI-AH-REFUND-METH.
  8673
  8674     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8675                                   PI-AH-REFUND-AMT.
  8676
  8677     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8678
  8679     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8680     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8681     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8682        MOVE PI-LF-CANCEL-DATE-ED
  8683                                 TO WS-CN-CANCEL-DT
  8684     ELSE
  8685        MOVE PI-AH-CANCEL-DATE-ED
  8686                                 TO WS-CN-CANCEL-DT
  8687     END-IF
  8688     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8689     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8690     MOVE PI-CARRIER             TO CZ-CARRIER
  8691     MOVE PI-GROUPING            TO CZ-GROUPING
  8692     MOVE PI-STATE               TO CZ-STATE
  8693     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8694     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8695     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8696     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8697     MOVE '1'                    TO CZ-RECORD-TYPE
  8698     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8699     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8700     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8701     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8702     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8703     MOVE ' '                    TO WS-STOP-SW
  8704     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 162
* EL1278.cbl
  8705
  8706* EXEC CICS WRITE
  8707*           FROM      (CERT-NOTE-FILE)
  8708*           DATASET   (ERNOTE-ID)
  8709*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8710*           RESP      (WS-RESPONSE)
  8711*       END-EXEC
  8712     MOVE LENGTH OF
  8713      CERT-NOTE-FILE
  8714       TO DFHEIV11
  8715*    MOVE '&$ L                  ''  N#00008275' TO DFHEIV0
  8716     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8718     MOVE X'204E233030303038323735' TO DFHEIV0(25:11)
  8719     CALL 'kxdfhei1' USING DFHEIV0,
  8720           ERNOTE-ID,
  8721           CERT-NOTE-FILE,
  8722           DFHEIV11,
  8723           CZ-CONTROL-PRIMARY,
  8724           DFHEIV99,
  8725           DFHEIV99
  8726     MOVE EIBRESP  TO WS-RESPONSE
  8727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8728        IF WS-RESP-DUPREC
  8729           ADD +1                TO CZ-NOTE-SEQUENCE
  8730        ELSE
  8731           SET I-SAY-TO-STOP     TO TRUE
  8732        END-IF
  8733     END-PERFORM
  8734     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8735     IF WS-RESP-NORMAL
  8736        EVALUATE CM-NOTE-SW
  8737           WHEN '1'
  8738           WHEN '3'
  8739           WHEN '5'
  8740           WHEN '7'
  8741              SET NO-CERT-RW     TO TRUE
  8742           WHEN ' '
  8743              MOVE '1'           TO CM-NOTE-SW
  8744           WHEN '2'
  8745              MOVE '3'           TO CM-NOTE-SW
  8746           WHEN '4'
  8747              MOVE '5'           TO CM-NOTE-SW
  8748           WHEN '6'
  8749              MOVE '7'           TO CM-NOTE-SW
  8750        END-EVALUATE
  8751     END-IF
  8752     IF NOT NO-CERT-RW
  8753        PERFORM 1810-REWRITE-ELCERT
  8754                                 THRU 1810-EXIT
  8755     ELSE
  8756
  8757* EXEC CICS UNLOCK
  8758*          DATASET    (ELCERT-ID)
  8759*       END-EXEC
  8760*    MOVE '&*                    #   #00008309' TO DFHEIV0
  8761     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 163
* EL1278.cbl
  8763     MOVE X'2020233030303038333039' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           ELCERT-ID,
  8766           DFHEIV99
  8767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8768     END-IF
  8769     MOVE ER-8160                TO EMI-ERROR.
  8770     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8771     GO TO 8200-SEND-DATAONLY.
  8772
  8773 1799-EXIT.
  8774     EXIT.
  8775 1800-READ-ELCERT-UPDATE.
  8776     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8777     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8778     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8779     MOVE PI-STATE               TO  WS-CM-STATE.
  8780     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8781     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8782     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8783     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8784
  8785* EXEC CICS READ
  8786*        UPDATE
  8787*        DATASET  (ELCERT-ID)
  8788*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8789*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8790*        RESP     (WS-RESPONSE)
  8791*    END-EXEC
  8792*    MOVE '&"S        EU         (  N#00008328' TO DFHEIV0
  8793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8795     MOVE X'204E233030303038333238' TO DFHEIV0(25:11)
  8796     CALL 'kxdfhei1' USING DFHEIV0,
  8797           ELCERT-ID,
  8798           DFHEIV20,
  8799           DFHEIV99,
  8800           WS-CM-CONTROL-PRIMARY,
  8801           DFHEIV99,
  8802           DFHEIV99,
  8803           DFHEIV99
  8804     SET ADDRESS OF CERTIFICATE-MASTER TO
  8805         DFHEIV20
  8806     MOVE EIBRESP  TO WS-RESPONSE
  8807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8808     .
  8809 1800-EXIT.
  8810     EXIT.
  8811 1810-REWRITE-ELCERT.
  8812
  8813* EXEC CICS REWRITE
  8814*        FROM      (CERTIFICATE-MASTER)
  8815*        DATASET   (ELCERT-ID)
  8816*        RESP     (WS-RESPONSE)
  8817*    END-EXEC.
  8818     MOVE LENGTH OF
  8819      CERTIFICATE-MASTER
  8820       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 164
* EL1278.cbl
  8821*    MOVE '&& L                  %  N#00008339' TO DFHEIV0
  8822     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8824     MOVE X'204E233030303038333339' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           ELCERT-ID,
  8827           CERTIFICATE-MASTER,
  8828           DFHEIV11,
  8829           DFHEIV99
  8830     MOVE EIBRESP  TO WS-RESPONSE
  8831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8832
  8833     .
  8834 1810-EXIT.
  8835     EXIT.
  8836 4000-GEN-CANCEL-TRANS.
  8837     IF PI-LF-REFUND-AMT NOT NUMERIC
  8838         MOVE +0 TO PI-LF-REFUND-AMT
  8839     END-IF
  8840     IF PI-AH-REFUND-AMT NOT NUMERIC
  8841         MOVE +0 TO PI-AH-REFUND-AMT
  8842     END-IF
  8843
  8844     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8845
  8846     MOVE '2'                    TO CG-OPTION-CODE
  8847     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8848     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8849     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8850     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8851     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8852     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8853     MOVE PI-STATE               TO CG-CERT-STATE
  8854     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8855     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8856     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8857     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8858     MOVE ZEROS                  TO CG-LF-BENCD
  8859                                    CG-AH-BENCD
  8860                                    CG-LF-CAN-AMT
  8861                                    CG-AH-CAN-AMT
  8862     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8863                                    CG-AH-CAN-DT
  8864     MOVE SPACES                 TO CG-BATCH-NO
  8865     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8866       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8867        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8868           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8869           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8870           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8871        END-IF
  8872     END-IF
  8873     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8874       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8875        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8876           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8877           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8878           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 165
* EL1278.cbl
  8879        END-IF
  8880     END-IF
  8881
  8882* EXEC CICS LINK
  8883*        PROGRAM  ('ELCANC')
  8884*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8885*    END-EXEC
  8886     MOVE LENGTH OF
  8887      CANCEL-GEN-PASS-AREA
  8888       TO DFHEIV11
  8889     MOVE 'ELCANC' TO DFHEIV1
  8890*    MOVE '."C                   (   #00008392' TO DFHEIV0
  8891     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8893     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0,
  8895           DFHEIV1,
  8896           CANCEL-GEN-PASS-AREA,
  8897           DFHEIV11,
  8898           DFHEIV99,
  8899           DFHEIV99,
  8900           DFHEIV99,
  8901           DFHEIV99
  8902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8903     IF CG-SUCCESS
  8904        CONTINUE
  8905     ELSE
  8906        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8907        move '3'                 to emi-switch1
  8908        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8909        EVALUATE TRUE
  8910           WHEN CG-DATE-ERROR
  8911             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8912           WHEN CG-CERT-NOT-FOUND
  8913             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8914           WHEN CG-AMOUNT-ERROR
  8915             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8916           WHEN CG-OPTION-ERROR
  8917             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8918           WHEN CG-PREV-CAN
  8919             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8920           WHEN CG-INVALID-DATA
  8921             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8922           WHEN CG-NO-ACCT-MSTR
  8923             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8924           WHEN CG-SFX-A-EXIST
  8925             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8926           WHEN CG-MISC-ERROR
  8927             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8928           WHEN OTHER
  8929             move ' error - elcanc - return '
  8930                                 to emi-error-text (1) (12:25)
  8931        END-EVALUATE
  8932        go to 8200-send-dataonly
  8933     end-if
  8934     .
  8935 4000-exit.
  8936     exit.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 166
* EL1278.cbl
  8937
  8938 4400-ADD-ORIG-REC.
  8939
  8940     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8941     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8942     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8943     MOVE PI-STATE               TO  WS-CM-STATE.
  8944     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8945     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8946     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8947     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8948
  8949
  8950* EXEC CICS READ
  8951*        DATASET  (ELCERT-ID)
  8952*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8953*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8954*        RESP     (WS-RESPONSE)
  8955*    END-EXEC
  8956*    MOVE '&"S        E          (  N#00008442' TO DFHEIV0
  8957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8959     MOVE X'204E233030303038343432' TO DFHEIV0(25:11)
  8960     CALL 'kxdfhei1' USING DFHEIV0,
  8961           ELCERT-ID,
  8962           DFHEIV20,
  8963           DFHEIV99,
  8964           WS-CM-CONTROL-PRIMARY,
  8965           DFHEIV99,
  8966           DFHEIV99,
  8967           DFHEIV99
  8968     SET ADDRESS OF CERTIFICATE-MASTER TO
  8969         DFHEIV20
  8970     MOVE EIBRESP  TO WS-RESPONSE
  8971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8972     IF WS-RESP-NORMAL
  8973         CONTINUE
  8974     ELSE
  8975        MOVE ER-0142                TO EMI-ERROR
  8976        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8977        GO TO 8100-SEND-INITIAL-MAP
  8978     END-IF
  8979
  8980******************************************************************
  8981*            A D D   O R I G   C E R T   I N F O                 *
  8982******************************************************************
  8983
  8984     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8985
  8986     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8987     MOVE ' '                    TO WS-ERMAIL-SW
  8988
  8989
  8990* EXEC CICS READ
  8991*       DATASET   ('ERMAIL')
  8992*       SET       (ADDRESS OF MAILING-DATA)
  8993*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8994*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 167
* EL1278.cbl
  8995*    END-EXEC
  8996     MOVE 'ERMAIL' TO DFHEIV1
  8997*    MOVE '&"S        E          (  N#00008465' TO DFHEIV0
  8998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9000     MOVE X'204E233030303038343635' TO DFHEIV0(25:11)
  9001     CALL 'kxdfhei1' USING DFHEIV0,
  9002           DFHEIV1,
  9003           DFHEIV20,
  9004           DFHEIV99,
  9005           WS-MA-CONTROL-PRIMARY,
  9006           DFHEIV99,
  9007           DFHEIV99,
  9008           DFHEIV99
  9009     SET ADDRESS OF MAILING-DATA TO
  9010         DFHEIV20
  9011     MOVE EIBRESP  TO WS-RESPONSE
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9013
  9014     IF WS-RESP-NORMAL
  9015        SET ERMAIL-FOUND TO TRUE
  9016     END-IF
  9017
  9018     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  9019     MOVE 'C'                   TO ELCRTT-REC-TYPE
  9020     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  9021
  9022
  9023* EXEC CICS READ
  9024*         DATASET  (ELCRTT-ID)
  9025*         RIDFLD   (ELCRTT-KEY)
  9026*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  9027*         RESP     (WS-RESPONSE)
  9028*    END-EXEC
  9029*    MOVE '&"S        E          (  N#00008480' TO DFHEIV0
  9030     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9032     MOVE X'204E233030303038343830' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           ELCRTT-ID,
  9035           DFHEIV20,
  9036           DFHEIV99,
  9037           ELCRTT-KEY,
  9038           DFHEIV99,
  9039           DFHEIV99,
  9040           DFHEIV99
  9041     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  9042         DFHEIV20
  9043     MOVE EIBRESP  TO WS-RESPONSE
  9044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9045
  9046     IF NOT WS-RESP-NORMAL
  9047        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  9048     END-IF
  9049
  9050     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  9051     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  9052     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 168
* EL1278.cbl
  9053
  9054
  9055* EXEC CICS READ
  9056*       DATASET   ('ELCRTO')
  9057*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9058*       RIDFLD    (ELCRTO-KEY)
  9059*       GTEQ
  9060*       RESP      (WS-RESPONSE)
  9061*    END-EXEC
  9062     MOVE 'ELCRTO' TO DFHEIV1
  9063*    MOVE '&"S        G          (  N#00008495' TO DFHEIV0
  9064     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9066     MOVE X'204E233030303038343935' TO DFHEIV0(25:11)
  9067     CALL 'kxdfhei1' USING DFHEIV0,
  9068           DFHEIV1,
  9069           DFHEIV20,
  9070           DFHEIV99,
  9071           ELCRTO-KEY,
  9072           DFHEIV99,
  9073           DFHEIV99,
  9074           DFHEIV99
  9075     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9076         DFHEIV20
  9077     MOVE EIBRESP  TO WS-RESPONSE
  9078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9079
  9080     IF WS-RESP-NORMAL
  9081        AND (OC-CONTROL-PRIMARY (1:33) =
  9082                 WS-CM-CONTROL-PRIMARY)
  9083        AND (OC-RECORD-TYPE = 'I')
  9084        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9085
  9086* EXEC CICS READ
  9087*             DATASET   ('ELCRTO')
  9088*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9089*             RIDFLD    (OC-CONTROL-PRIMARY)
  9090*             UPDATE
  9091*             RESP      (WS-RESPONSE)
  9092*          END-EXEC
  9093     MOVE 'ELCRTO' TO DFHEIV1
  9094*    MOVE '&"S        EU         (  N#00008508' TO DFHEIV0
  9095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9097     MOVE X'204E233030303038353038' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           DFHEIV1,
  9100           DFHEIV20,
  9101           DFHEIV99,
  9102           OC-CONTROL-PRIMARY,
  9103           DFHEIV99,
  9104           DFHEIV99,
  9105           DFHEIV99
  9106     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9107         DFHEIV20
  9108     MOVE EIBRESP  TO WS-RESPONSE
  9109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9110           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 169
* EL1278.cbl
  9111           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9112           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9113           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9114           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9115           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9116           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9117           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9118           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9119            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9120               MOVE SPACES             TO OC-LF-BENCD
  9121               MOVE ZEROS              TO OC-LF-TERM
  9122                                          OC-LF-BEN-AMT
  9123                                          OC-LF-PRM-AMT
  9124                                          OC-LF-ALT-BEN-AMT
  9125                                          OC-LF-ALT-PRM-AMT
  9126                                          OC-LF-COMM-PCT
  9127                                          OC-LF-CANCEL-AMT
  9128               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9129               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9130           ELSE
  9131               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9132               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9133               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9134               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9135               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9136               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9137               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9138               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9139               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9140               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9141           END-IF
  9142           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9143           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9144            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9145               MOVE SPACES             TO OC-AH-BENCD
  9146               MOVE ZEROS              TO OC-AH-TERM
  9147                                          OC-AH-BEN-AMT
  9148                                          OC-AH-PRM-AMT
  9149                                          OC-AH-COMM-PCT
  9150                                          OC-AH-CANCEL-AMT
  9151                                          OC-AH-CP
  9152               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9153               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9154           ELSE
  9155               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9156               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9157               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9158               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9159               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9160               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9161               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9162               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9163               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9164           END-IF
  9165           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9166           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9167           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9168           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 170
* EL1278.cbl
  9169           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9170           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9171           MOVE '5'                    TO DC-OPTION-CODE
  9172           PERFORM 9600-DATE-LINK
  9173           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9174           IF ERMAIL-FOUND
  9175               MOVE MA-CRED-BENE-NAME
  9176                           TO OC-CRED-BENE-NAME
  9177           END-IF
  9178           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9179               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9180                                  OC-INS-AGE-DEFAULT-FLAG
  9181               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9182                                  OC-JNT-AGE-DEFAULT-FLAG
  9183           END-IF
  9184
  9185
  9186* EXEC CICS REWRITE
  9187*             DATASET   ('ELCRTO')
  9188*             FROM      (ORIGINAL-CERTIFICATE)
  9189*             RESP      (WS-RESPONSE)
  9190*          END-EXEC
  9191     MOVE LENGTH OF
  9192      ORIGINAL-CERTIFICATE
  9193       TO DFHEIV11
  9194     MOVE 'ELCRTO' TO DFHEIV1
  9195*    MOVE '&& L                  %  N#00008590' TO DFHEIV0
  9196     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9197     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9198     MOVE X'204E233030303038353930' TO DFHEIV0(25:11)
  9199     CALL 'kxdfhei1' USING DFHEIV0,
  9200           DFHEIV1,
  9201           ORIGINAL-CERTIFICATE,
  9202           DFHEIV11,
  9203           DFHEIV99
  9204     MOVE EIBRESP  TO WS-RESPONSE
  9205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9206           IF NOT WS-RESP-NORMAL
  9207              MOVE ER-3830          TO EMI-ERROR
  9208              PERFORM 9700-ERROR-FORMAT
  9209                                 THRU 9799-EXIT
  9210              GO TO 8200-SEND-DATAONLY
  9211           END-IF
  9212
  9213           GO TO 4400-EXIT
  9214
  9215        ELSE
  9216           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9217        END-IF
  9218     ELSE
  9219        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9220        MOVE 'OC'                TO OC-RECORD-ID
  9221        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9222        MOVE 'I'                 TO OC-RECORD-TYPE
  9223        MOVE +4096               TO OC-KEY-SEQ-NO
  9224     END-IF
  9225
  9226     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 171
* EL1278.cbl
  9227     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9228     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9229     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9230     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9231     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9232     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9233     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9234     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9235      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9236         MOVE SPACES             TO OC-LF-BENCD
  9237         MOVE ZEROS              TO OC-LF-TERM
  9238                                    OC-LF-BEN-AMT
  9239                                    OC-LF-PRM-AMT
  9240                                    OC-LF-ALT-BEN-AMT
  9241                                    OC-LF-ALT-PRM-AMT
  9242                                    OC-LF-COMM-PCT
  9243                                    OC-LF-CANCEL-AMT
  9244         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9245         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9246     ELSE
  9247         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9248         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9249         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9250         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9251         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9252         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9253         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9254         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9255         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9256         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9257     END-IF
  9258     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9259     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9260      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9261         MOVE SPACES             TO OC-AH-BENCD
  9262         MOVE ZEROS              TO OC-AH-TERM
  9263                                    OC-AH-BEN-AMT
  9264                                    OC-AH-PRM-AMT
  9265                                    OC-AH-COMM-PCT
  9266                                    OC-AH-CANCEL-AMT
  9267                                    OC-AH-CP
  9268         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9269         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9270     ELSE
  9271         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9272         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9273         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9274         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9275         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9276         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9277         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9278         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9279         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9280         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9281     END-IF
  9282     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9283     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9284     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 172
* EL1278.cbl
  9285     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9286     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9287     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9288     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9289     MOVE '5'                    TO DC-OPTION-CODE
  9290     PERFORM 9600-DATE-LINK
  9291     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9292     IF ERMAIL-FOUND
  9293         MOVE MA-CRED-BENE-NAME
  9294                     TO OC-CRED-BENE-NAME
  9295     END-IF
  9296     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9297         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9298                            OC-INS-AGE-DEFAULT-FLAG
  9299         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9300                            OC-JNT-AGE-DEFAULT-FLAG
  9301     END-IF
  9302
  9303     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9304     .
  9305 4400-WRITE-ELCRTO.
  9306
  9307
  9308* EXEC CICS WRITE
  9309*       DATASET   ('ELCRTO')
  9310*       FROM      (ORIGINAL-CERTIFICATE)
  9311*       RIDFLD    (OC-CONTROL-PRIMARY)
  9312*       RESP      (WS-RESPONSE)
  9313*    END-EXEC
  9314     MOVE LENGTH OF
  9315      ORIGINAL-CERTIFICATE
  9316       TO DFHEIV11
  9317     MOVE 'ELCRTO' TO DFHEIV1
  9318*    MOVE '&$ L                  ''  N#00008696' TO DFHEIV0
  9319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9321     MOVE X'204E233030303038363936' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0,
  9323           DFHEIV1,
  9324           ORIGINAL-CERTIFICATE,
  9325           DFHEIV11,
  9326           OC-CONTROL-PRIMARY,
  9327           DFHEIV99,
  9328           DFHEIV99
  9329     MOVE EIBRESP  TO WS-RESPONSE
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9331
  9332    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9333        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9334        GO TO 4400-WRITE-ELCRTO
  9335    ELSE
  9336        IF NOT WS-RESP-NORMAL
  9337           MOVE ER-3830          TO EMI-ERROR
  9338           PERFORM 9700-ERROR-FORMAT
  9339                                 THRU 9799-EXIT
  9340           GO TO 8200-SEND-DATAONLY
  9341        END-IF
  9342    END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 173
* EL1278.cbl
  9343
  9344     .
  9345 4400-EXIT.
  9346    EXIT.
  9347
  9348
  9349 5000-GET-LF-AM-REM-TERM.
  9350     MOVE +1                     TO SUB3.
  9351
  9352 5100-GET-LF-AM-REM-TERM.
  9353     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9354        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9355           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9356                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9357           GO TO 5300-MOVE-LF-REM-TERM.
  9358
  9359     IF SUB3 LESS THAN +20
  9360        ADD +1                   TO SUB3
  9361        GO TO 5100-GET-LF-AM-REM-TERM.
  9362
  9363     MOVE +1                     TO SUB3.
  9364
  9365     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9366         GO TO 5200-EDIT-FOR-NINETY-LF.
  9367
  9368 5100-GET-LF-DMD-AM-REM-TERM.
  9369
  9370     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9371        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9372           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9373                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9374           GO TO 5300-MOVE-LF-REM-TERM.
  9375
  9376     IF SUB3 LESS THAN +30
  9377        ADD +1                   TO SUB3
  9378        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9379
  9380     MOVE +1                     TO SUB3.
  9381
  9382 5200-EDIT-FOR-NINETY-LF.
  9383
  9384***************************************************************
  9385*                                                             *
  9386*    NINETY BENEFIT PLAN TYPES:                               *
  9387*                                                             *
  9388*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9389*      92 = ALL GROUP REDUCING BENEFITS                       *
  9390*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9391*      94 = ALL GROUP LEVEL BENEFITS                          *
  9392*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9393*           BENEFIT CONTROLS.                                 *
  9394*      99 = ALL BENEFITS                                      *
  9395*                                                             *
  9396***************************************************************
  9397
  9398     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9399                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9400
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 174
* EL1278.cbl
  9401     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9402       AND
  9403        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9404           GO TO 5300-MOVE-LF-REM-TERM.
  9405
  9406     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9407       AND
  9408        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9409        IF CF-REDUCING (WS-INDEX)
  9410           IF CM-INDIVIDUAL
  9411               GO TO 5300-MOVE-LF-REM-TERM.
  9412
  9413     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9414       AND
  9415        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9416        IF CF-REDUCING (WS-INDEX)
  9417           IF CM-GROUP
  9418               GO TO 5300-MOVE-LF-REM-TERM.
  9419
  9420     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9421       AND
  9422        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9423        IF CF-LEVEL (WS-INDEX)
  9424           IF CM-INDIVIDUAL
  9425               GO TO 5300-MOVE-LF-REM-TERM.
  9426
  9427     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9428       AND
  9429        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9430        IF CF-LEVEL (WS-INDEX)
  9431           IF CM-GROUP
  9432               GO TO 5300-MOVE-LF-REM-TERM.
  9433
  9434     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9435       AND
  9436        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9437            GO TO 5300-MOVE-LF-REM-TERM.
  9438
  9439     IF SUB3 LESS THAN +20
  9440        ADD +1           TO SUB3
  9441          GO TO 5200-EDIT-FOR-NINETY-LF.
  9442
  9443     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9444
  9445     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9446         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9447         GO TO 5900-EXIT.
  9448
  9449     MOVE 1                       TO SUB3.
  9450
  9451 5200-EDIT-FOR-DMD-NINETY-LF.
  9452
  9453     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9454                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9455
  9456     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9457       AND
  9458        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 175
* EL1278.cbl
  9459           GO TO 5300-MOVE-LF-REM-TERM.
  9460
  9461     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9462       AND
  9463        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9464        IF CF-REDUCING (WS-INDEX)
  9465           IF CM-INDIVIDUAL
  9466               GO TO 5300-MOVE-LF-REM-TERM.
  9467
  9468     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9469       AND
  9470        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9471        IF CF-REDUCING (WS-INDEX)
  9472           IF CM-GROUP
  9473               GO TO 5300-MOVE-LF-REM-TERM.
  9474
  9475     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9476       AND
  9477        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9478        IF CF-LEVEL (WS-INDEX)
  9479           IF CM-INDIVIDUAL
  9480               GO TO 5300-MOVE-LF-REM-TERM.
  9481
  9482     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9483       AND
  9484        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9485        IF CF-LEVEL (WS-INDEX)
  9486           IF CM-GROUP
  9487               GO TO 5300-MOVE-LF-REM-TERM.
  9488
  9489     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9490       AND
  9491        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9492            GO TO 5300-MOVE-LF-REM-TERM.
  9493
  9494     IF SUB3 LESS THAN +30
  9495        ADD +1                   TO SUB3
  9496          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9497
  9498     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9499
  9500     GO TO 5900-EXIT.
  9501
  9502 5300-MOVE-LF-REM-TERM.
  9503     MOVE WS-SAVE-BENEFIT-REM-TERM
  9504                                 TO WS-LF-AM-REM-TERM-CALC.
  9505
  9506 5900-EXIT.
  9507      EXIT.
  9508
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 176
* EL1278.cbl
  9510
  9511 6000-GET-AH-AM-REM-TERM.
  9512     MOVE +1                     TO SUB3.
  9513
  9514 6100-GET-AH-AM-REM-TERM.
  9515
  9516     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9517        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9518           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9519                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9520           GO TO 6300-MOVE-AH-REM-TERM.
  9521
  9522     IF SUB3 LESS THAN +20
  9523        ADD +1                   TO SUB3
  9524        GO TO 6100-GET-AH-AM-REM-TERM.
  9525
  9526     MOVE +1                     TO SUB3.
  9527
  9528     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9529         GO TO 6200-EDIT-FOR-NINETY-AH.
  9530
  9531 6100-GET-AH-AM-DMD-REM-TERM.
  9532     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9533        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9534           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9535                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9536           GO TO 6300-MOVE-AH-REM-TERM.
  9537
  9538     IF SUB3 LESS THAN +30
  9539        ADD +1                   TO SUB3
  9540        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9541
  9542     MOVE +1                     TO SUB3.
  9543
  9544 6200-EDIT-FOR-NINETY-AH.
  9545
  9546***************************************************************
  9547*                                                             *
  9548*    NINETY BENEFIT PLAN TYPES:                               *
  9549*                                                             *
  9550*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9551*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9552*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9553*           BENEFIT CONTROLS.                                 *
  9554*      99 = ALL BENEFITS.                                     *
  9555*                                                             *
  9556***************************************************************
  9557
  9558     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9559                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9560
  9561     IF AM-BENEFIT-CODE (SUB3) = '99'
  9562       AND
  9563        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9564           GO TO 6300-MOVE-AH-REM-TERM.
  9565
  9566     IF AM-BENEFIT-CODE (SUB3) = '91'
  9567       AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 177
* EL1278.cbl
  9568        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9569           IF CM-INDIVIDUAL
  9570               GO TO 6300-MOVE-AH-REM-TERM.
  9571
  9572     IF AM-BENEFIT-CODE (SUB3) = '92'
  9573       AND
  9574        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9575           IF CM-GROUP
  9576               GO TO 6300-MOVE-AH-REM-TERM.
  9577
  9578     IF AM-BENEFIT-CODE (SUB3) = '98'
  9579       AND
  9580        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9581           GO TO 6300-MOVE-AH-REM-TERM.
  9582
  9583     IF SUB3 LESS THAN +20
  9584        ADD +1                    TO SUB3
  9585        GO TO 6200-EDIT-FOR-NINETY-AH.
  9586
  9587     MOVE +1                      TO SUB3.
  9588
  9589     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9590         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9591         GO TO 6900-EXIT.
  9592
  9593 6200-EDIT-FOR-DMD-NINETY-AH.
  9594
  9595     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9596                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9597
  9598     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9599       AND
  9600        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9601           GO TO 6300-MOVE-AH-REM-TERM.
  9602
  9603     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9604       AND
  9605        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9606           IF CM-INDIVIDUAL
  9607               GO TO 6300-MOVE-AH-REM-TERM.
  9608
  9609     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9610       AND
  9611        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9612           IF CM-GROUP
  9613               GO TO 6300-MOVE-AH-REM-TERM.
  9614
  9615     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9616       AND
  9617        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9618           GO TO 6300-MOVE-AH-REM-TERM.
  9619
  9620     IF SUB3 LESS THAN +30
  9621        ADD +1                   TO SUB3
  9622        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9623
  9624     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9625
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 178
* EL1278.cbl
  9626     GO TO 6900-EXIT.
  9627
  9628 6300-MOVE-AH-REM-TERM.
  9629
  9630     MOVE WS-SAVE-BENEFIT-REM-TERM
  9631                                 TO WS-AH-AM-REM-TERM-CALC.
  9632
  9633 6900-EXIT.
  9634      EXIT.
  9635
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 179
* EL1278.cbl
  9637 7000-GET-ERFORM     SECTION.
  9638
  9639* EXEC CICS HANDLE CONDITION
  9640*        NOTFND  (7000-EXIT)
  9641*    END-EXEC.
  9642*    MOVE '"$I                   ! ( #00009009' TO DFHEIV0
  9643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9645     MOVE X'2820233030303039303039' TO DFHEIV0(25:11)
  9646     CALL 'kxdfhei1' USING DFHEIV0
  9647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9648
  9649
  9650     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9651     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9652     MOVE PI-STATE               TO  WS-FO-STATE.
  9653     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9654     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9655
  9656
  9657* EXEC CICS READ
  9658*        DATASET  (ERFORM-ID)
  9659*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9660*        SET      (ADDRESS OF FORM-MASTER)
  9661*        GTEQ
  9662*    END-EXEC.
  9663*    MOVE '&"S        G          (   #00009019' TO DFHEIV0
  9664     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9666     MOVE X'2020233030303039303139' TO DFHEIV0(25:11)
  9667     CALL 'kxdfhei1' USING DFHEIV0,
  9668           ERFORM-ID,
  9669           DFHEIV20,
  9670           DFHEIV99,
  9671           WS-FO-CONTROL-PRIMARY,
  9672           DFHEIV99,
  9673           DFHEIV99,
  9674           DFHEIV99
  9675     SET ADDRESS OF FORM-MASTER TO
  9676         DFHEIV20
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679
  9680     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9681        PI-STATE          EQUAL FO-STATE      AND
  9682        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9683         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9684         GO TO 7000-EXIT.
  9685 7000-EXIT.
  9686     EXIT.
  9687 7100-BENEFIT-SEARCH SECTION.
  9688
  9689     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9690        MOVE +1                  TO  SUB4
  9691        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9692
  9693     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9694        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 180
* EL1278.cbl
  9695        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9696 7100-EXIT.
  9697     EXIT.
  9698 7150-BENEFIT-LIFE-SEARCH.
  9699     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9700       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9701         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9702          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9703            IF FO-PLAN-REFUND-METHOD (SUB4)
  9704                    IS GREATER THAN SPACES
  9705               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9706                                    WS-LF-FO-REFUND-CALC
  9707               GO TO 7150-EXIT.
  9708
  9709     IF SUB4 LESS THAN +40
  9710         ADD +1              TO SUB4
  9711         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9712
  9713 7150-EXIT.
  9714     EXIT.
  9715 7250-BENEFIT-AH-SEARCH.
  9716     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9717       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9718         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9719          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9720            IF FO-PLAN-REFUND-METHOD (SUB4)
  9721                    IS GREATER THAN SPACES
  9722               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9723                                    WS-AH-FO-REFUND-CALC
  9724               GO TO 7250-EXIT.
  9725
  9726     IF SUB4 LESS THAN +40
  9727         ADD +1              TO SUB4
  9728         GO TO 7250-BENEFIT-AH-SEARCH.
  9729
  9730 7250-EXIT.
  9731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 181
* EL1278.cbl
  9733
  9734 8100-SEND-INITIAL-MAP  SECTION.
  9735     MOVE SAVE-DATE              TO  HDATEO.
  9736     MOVE EIBTIME                TO  TIME-IN.
  9737     MOVE TIME-OUT               TO  HTIMEO.
  9738     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9739     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9740     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9741     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9742
  9743     IF CM-LF-BENEFIT-CD = '00'
  9744         MOVE -1                 TO  HACANCL
  9745     ELSE
  9746         MOVE -1                 TO  HLCANCL.
  9747
  9748     IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
  9749        MOVE AL-SADOF            TO CANREAHA
  9750                                    CLPYNHA
  9751                                    CANREAA
  9752                                    CLPYNA
  9753     END-IF
  9754
  9755
  9756* EXEC CICS SEND
  9757*        FROM    (EL127HO)
  9758*        MAPSET  (MAPSET-NAME)
  9759*        MAP     (MAP-NAME)
  9760*        CURSOR
  9761*        ERASE
  9762*    END-EXEC.
  9763     MOVE LENGTH OF
  9764      EL127HO
  9765       TO DFHEIV12
  9766     MOVE -1
  9767       TO DFHEIV11
  9768*    MOVE '8$     CT  E    H L F ,   #00009101' TO DFHEIV0
  9769     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9770     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9771     MOVE X'2020233030303039313031' TO DFHEIV0(25:11)
  9772     CALL 'kxdfhei1' USING DFHEIV0,
  9773           MAP-NAME,
  9774           EL127HO,
  9775           DFHEIV12,
  9776           MAPSET-NAME,
  9777           DFHEIV99,
  9778           DFHEIV99,
  9779           DFHEIV99,
  9780           DFHEIV11,
  9781           DFHEIV99,
  9782           DFHEIV99,
  9783           DFHEIV99
  9784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9785
  9786
  9787     GO TO 9000-RETURN-TRAN.
  9788
  9789 8200-SEND-DATAONLY  SECTION.
  9790     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 182
* EL1278.cbl
  9791         GO TO 8100-SEND-INITIAL-MAP.
  9792
  9793     MOVE SAVE-DATE              TO  HDATEO.
  9794     MOVE EIBTIME                TO  TIME-IN.
  9795     MOVE TIME-OUT               TO  HTIMEO.
  9796     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9797     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9798     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9799     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9800     MOVE -1                     TO  HLCANCL.
  9801
  9802
  9803* EXEC CICS SEND DATAONLY
  9804*        FROM    (EL127HO)
  9805*        MAPSET  (MAPSET-NAME)
  9806*        MAP     (MAP-NAME)
  9807*        CURSOR
  9808*    END-EXEC.
  9809     MOVE LENGTH OF
  9810      EL127HO
  9811       TO DFHEIV12
  9812     MOVE -1
  9813       TO DFHEIV11
  9814*    MOVE '8$D    CT       H L F ,   #00009124' TO DFHEIV0
  9815     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9816     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9817     MOVE X'2020233030303039313234' TO DFHEIV0(25:11)
  9818     CALL 'kxdfhei1' USING DFHEIV0,
  9819           MAP-NAME,
  9820           EL127HO,
  9821           DFHEIV12,
  9822           MAPSET-NAME,
  9823           DFHEIV99,
  9824           DFHEIV99,
  9825           DFHEIV99,
  9826           DFHEIV11,
  9827           DFHEIV99,
  9828           DFHEIV99,
  9829           DFHEIV99
  9830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9831
  9832
  9833     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 183
* EL1278.cbl
  9835 8300-SEND-TEXT  SECTION.
  9836
  9837* EXEC CICS SEND TEXT
  9838*        FROM    (LOGOFF-TEXT)
  9839*        LENGTH  (LOGOFF-LENGTH)
  9840*        ERASE
  9841*        FREEKB
  9842*    END-EXEC.
  9843*    MOVE '8&      T  E F  H   F -   #00009134' TO DFHEIV0
  9844     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9845     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9846     MOVE X'2020233030303039313334' TO DFHEIV0(25:11)
  9847     CALL 'kxdfhei1' USING DFHEIV0,
  9848           LOGOFF-TEXT,
  9849           LOGOFF-LENGTH,
  9850           DFHEIV99,
  9851           DFHEIV99,
  9852           DFHEIV99,
  9853           DFHEIV99,
  9854           DFHEIV99,
  9855           DFHEIV99,
  9856           DFHEIV99,
  9857           DFHEIV99,
  9858           DFHEIV99,
  9859           DFHEIV99
  9860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9861
  9862
  9863
  9864* EXEC CICS RETURN
  9865*    END-EXEC.
  9866*    MOVE '.(                    ''   #00009141' TO DFHEIV0
  9867     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9868     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9869     MOVE X'2020233030303039313431' TO DFHEIV0(25:11)
  9870     CALL 'kxdfhei1' USING DFHEIV0,
  9871           DFHEIV99,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99,
  9875           DFHEIV99,
  9876           DFHEIV99
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9878
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 184
* EL1278.cbl
  9880 8600-DEEDIT  SECTION.
  9881
  9882* EXEC CICS BIF DEEDIT
  9883*        FIELD   (DEEDIT-FIELD)
  9884*        LENGTH  (15)
  9885*    END-EXEC.
  9886     MOVE 15
  9887       TO DFHEIV11
  9888*    MOVE '@"L                   #   #00009145' TO DFHEIV0
  9889     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9890     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9891     MOVE X'2020233030303039313435' TO DFHEIV0(25:11)
  9892     CALL 'kxdfhei1' USING DFHEIV0,
  9893           DEEDIT-FIELD,
  9894           DFHEIV11
  9895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9896
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 185
* EL1278.cbl
  9898 8700-UNAUTHORIZED-ACCESS  SECTION.
  9899     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9900
  9901     GO TO 8300-SEND-TEXT.
  9902
  9903 8800-PF23  SECTION.
  9904     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9905     MOVE XCTL-005               TO  PGM-NAME.
  9906
  9907     GO TO 9200-XCTL.
  9908
  9909 8900-RETURN-CICS  SECTION.
  9910
  9911* EXEC CICS RETURN
  9912*    END-EXEC.
  9913*    MOVE '.(                    ''   #00009162' TO DFHEIV0
  9914     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9916     MOVE X'2020233030303039313632' TO DFHEIV0(25:11)
  9917     CALL 'kxdfhei1' USING DFHEIV0,
  9918           DFHEIV99,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99,
  9922           DFHEIV99,
  9923           DFHEIV99
  9924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9925
  9926
  9927 9000-RETURN-TRAN  SECTION.
  9928     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9929     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9930
  9931
  9932* EXEC CICS RETURN
  9933*        TRANSID   (TRANS-ID)
  9934*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9935*        LENGTH    (PI-COMM-LENGTH)
  9936*    END-EXEC.
  9937*    MOVE '.(CT                  ''   #00009169' TO DFHEIV0
  9938     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9940     MOVE X'2020233030303039313639' TO DFHEIV0(25:11)
  9941     CALL 'kxdfhei1' USING DFHEIV0,
  9942           TRANS-ID,
  9943           PROGRAM-INTERFACE-BLOCK,
  9944           PI-COMM-LENGTH,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99
  9948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9949
  9950
  9951 9100-RETURN-MAIN-MENU  SECTION.
  9952     MOVE XCTL-126               TO  PGM-NAME.
  9953
  9954     GO TO 9200-XCTL.
  9955
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 186
* EL1278.cbl
  9956 9200-XCTL  SECTION.
  9957
  9958* EXEC CICS XCTL
  9959*        PROGRAM   (PGM-NAME)
  9960*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9961*        LENGTH    (PI-COMM-LENGTH)
  9962*    END-EXEC.
  9963*    MOVE '.$C                   %   #00009181' TO DFHEIV0
  9964     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9965     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9966     MOVE X'2020233030303039313831' TO DFHEIV0(25:11)
  9967     CALL 'kxdfhei1' USING DFHEIV0,
  9968           PGM-NAME,
  9969           PROGRAM-INTERFACE-BLOCK,
  9970           PI-COMM-LENGTH,
  9971           DFHEIV99
  9972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9973
  9974
  9975 9300-CLEAR  SECTION.
  9976     MOVE ' '                    TO  PI-PEND-SW.
  9977     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9978
  9979     GO TO 9200-XCTL.
  9980
  9981 9400-PF12  SECTION.
  9982     MOVE XCTL-010               TO  PGM-NAME.
  9983
  9984     GO TO 9200-XCTL.
  9985
  9986 9500-PGMID-ERROR  SECTION.
  9987
  9988* EXEC CICS HANDLE CONDITION
  9989*        PGMIDERR  (8300-SEND-TEXT)
  9990*    END-EXEC.
  9991*    MOVE '"$L                   ! ) #00009199' TO DFHEIV0
  9992     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9994     MOVE X'2920233030303039313939' TO DFHEIV0(25:11)
  9995     CALL 'kxdfhei1' USING DFHEIV0
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10000     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10001     MOVE XCTL-005               TO  PGM-NAME.
 10002     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10003     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10004
 10005     GO TO 9200-XCTL.
 10006
 10007 9600-DATE-LINK  SECTION.
 10008     MOVE LINK-ELDATCV           TO  PGM-NAME
 10009
 10010
 10011* EXEC CICS LINK
 10012*        PROGRAM   (PGM-NAME)
 10013*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 187
* EL1278.cbl
 10014*        LENGTH    (DC-COMM-LENGTH)
 10015*    END-EXEC.
 10016*    MOVE '."C                   (   #00009214' TO DFHEIV0
 10017     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10019     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0,
 10021           PGM-NAME,
 10022           DATE-CONVERSION-DATA,
 10023           DC-COMM-LENGTH,
 10024           DFHEIV99,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10029
 10030
 10031
 10032 9700-ERROR-FORMAT  SECTION.
 10033     IF NOT EMI-ERRORS-COMPLETE
 10034         MOVE LINK-001               TO  PGM-NAME
 10035
 10036* EXEC CICS LINK
 10037*            PROGRAM   (PGM-NAME)
 10038*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10039*            LENGTH    (EMI-COMM-LENGTH)
 10040*        END-EXEC.
 10041*    MOVE '."C                   (   #00009224' TO DFHEIV0
 10042     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10043     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10044     MOVE X'2020233030303039323234' TO DFHEIV0(25:11)
 10045     CALL 'kxdfhei1' USING DFHEIV0,
 10046           PGM-NAME,
 10047           ERROR-MESSAGE-INTERFACE-BLOCK,
 10048           EMI-COMM-LENGTH,
 10049           DFHEIV99,
 10050           DFHEIV99,
 10051           DFHEIV99,
 10052           DFHEIV99
 10053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10054
 10055
 10056 9799-EXIT.
 10057     EXIT.
 10058
 10059 9800-SECURITY-VIOLATION  SECTION.
 10060*                            COPY ELCSCTP.
 10061******************************************************************
 10062*                                                                *
 10063*                            ELCSCTP                             *
 10064*                            VMOD=2.001                          *
 10065*                                                                *
 10066*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10067******************************************************************
 10068
 10069
 10070     MOVE EIBDATE          TO SM-JUL-DATE.
 10071     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 188
* EL1278.cbl
 10072     MOVE THIS-PGM         TO SM-PGM.
 10073     MOVE EIBTIME          TO TIME-IN.
 10074     MOVE TIME-OUT         TO SM-TIME.
 10075     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10076
 10077
 10078* EXEC CICS LINK
 10079*         PROGRAM  ('EL003')
 10080*         COMMAREA (SECURITY-MESSAGE)
 10081*         LENGTH   (80)
 10082*    END-EXEC.
 10083     MOVE 'EL003' TO DFHEIV1
 10084     MOVE 80
 10085       TO DFHEIV11
 10086*    MOVE '."C                   (   #00009251' TO DFHEIV0
 10087     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10089     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
 10090     CALL 'kxdfhei1' USING DFHEIV0,
 10091           DFHEIV1,
 10092           SECURITY-MESSAGE,
 10093           DFHEIV11,
 10094           DFHEIV99,
 10095           DFHEIV99,
 10096           DFHEIV99,
 10097           DFHEIV99
 10098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10099
 10100
 10101******************************************************************
 10102
 10103
 10104 9899-EXIT.
 10105     EXIT.
 10106
 10107 9900-ABEND  SECTION.
 10108     MOVE LINK-004               TO  PGM-NAME.
 10109     MOVE DFHEIBLK               TO  EMI-LINE1.
 10110
 10111
 10112* EXEC CICS LINK
 10113*        PROGRAM   (PGM-NAME)
 10114*        COMMAREA  (EMI-LINE1)
 10115*        LENGTH    (72)
 10116*    END-EXEC.
 10117     MOVE 72
 10118       TO DFHEIV11
 10119*    MOVE '."C                   (   #00009267' TO DFHEIV0
 10120     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10122     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
 10123     CALL 'kxdfhei1' USING DFHEIV0,
 10124           PGM-NAME,
 10125           EMI-LINE1,
 10126           DFHEIV11,
 10127           DFHEIV99,
 10128           DFHEIV99,
 10129           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 189
* EL1278.cbl
 10130           DFHEIV99
 10131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10132
 10133
 10134     MOVE -1                     TO  HLCANCL.
 10135
 10136     GO TO 8200-SEND-DATAONLY.
 10137
 10138 9999-LAST-PARAGRAPH.
 10139
 10140* GOBACK.
 10141     MOVE '9%                    "   ' TO DFHEIV0
 10142     MOVE 'EL1278' TO DFHEIV1
 10143     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10144     GOBACK.
 10145
 10146 9999-DFHBACK SECTION.
 10147     MOVE '9%                    "   ' TO DFHEIV0
 10148     MOVE 'EL1278' TO DFHEIV1
 10149     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10150     GOBACK.
 10151 9999-DFHEXIT.
 10152     IF DFHEIGDJ EQUAL 0001
 10153         NEXT SENTENCE
 10154     ELSE IF DFHEIGDJ EQUAL 2
 10155         GO TO 9500-PGMID-ERROR,
 10156               9900-ABEND
 10157         DEPENDING ON DFHEIGDI
 10158     ELSE IF DFHEIGDJ EQUAL 3
 10159         GO TO 0910-NOT-FOUND
 10160         DEPENDING ON DFHEIGDI
 10161     ELSE IF DFHEIGDJ EQUAL 4
 10162         GO TO 1010-NOTFND,
 10163               1020-NOTOPEN
 10164         DEPENDING ON DFHEIGDI
 10165     ELSE IF DFHEIGDJ EQUAL 5
 10166         GO TO 1290-ACCT-NOT-FOUND,
 10167               1290-ACCT-NOT-FOUND
 10168         DEPENDING ON DFHEIGDI
 10169     ELSE IF DFHEIGDJ EQUAL 6
 10170         GO TO 0580-ACCT-NOT-FOUND,
 10171               0580-ACCT-NOT-FOUND
 10172         DEPENDING ON DFHEIGDI
 10173     ELSE IF DFHEIGDJ EQUAL 7
 10174         GO TO 1699-EXIT
 10175         DEPENDING ON DFHEIGDI
 10176     ELSE IF DFHEIGDJ EQUAL 8
 10177         GO TO 7000-EXIT
 10178         DEPENDING ON DFHEIGDI
 10179     ELSE IF DFHEIGDJ EQUAL 9
 10180         GO TO 8300-SEND-TEXT
 10181         DEPENDING ON DFHEIGDI.
 10182     MOVE '9%                    "   ' TO DFHEIV0
 10183     MOVE 'EL1278' TO DFHEIV1
 10184     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10185     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 190
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8592     Code:       26356
