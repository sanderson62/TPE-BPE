* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    90* 052020  CR2019111300001  PEMA  Include all files in "K" trans
    91* 072120  CR2020072100002  PEMA  Allow deletion of dup pend iss re
    92* 102020 IR2020101300001   PEMA  Correct billing notes
    93* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    94******************************************************************
    95
    96 ENVIRONMENT DIVISION.
    97
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   4
* EL6311.cbl
    99 DATA DIVISION.
   100 WORKING-STORAGE SECTION.
   101 01  DFH-START PIC X(04).
   102 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
   103 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
   104 77  FILLER  PIC X(32)  VALUE '********************************'.
   105 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   106 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   107 77  A1                          PIC S999 COMP-3 VALUE +0.
   108 77  N1                          PIC S999 COMP-3 VALUE +0.
   109 77  N2                          PIC S999 COMP-3 VALUE +0.
   110 77  N3                          PIC S999 COMP-3 VALUE +0.
   111 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   112 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   113 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   114     88  REVERSAL                    VALUE 'Y'.
   115 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   116 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   117 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   118 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   119 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   120     88  ERMAIL-FOUND                 VALUE 'Y'.
   121 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   122 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   123 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   124 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   125     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   126 77  ws-stop-sw                  pic x value ' '.
   127     88  i-say-stop                 value 'Y'.
   128 77  ws-check-sw                 pic x value ' '.
   129     88  i-have-checks              value 'Y'.
   130 77  ws-proc-check-sw            pic x value ' '.
   131     88  i-have-processed-checks    value 'Y'.
   132 77  ws-any-check-sw             pic x value ' '.
   133     88  i-have-a-check-period      value 'Y'.
   134 77  ws-chek-browse-sw           pic x value ' '.
   135 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   136 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   137 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   138 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   139 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   140 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   141 77  ws-elcrtt-update-sw         pic x value ' '.
   142     88  update-elcrtt              value 'Y'.
   143 01  P pointer.
   144 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   145 01  var-ptr pointer.
   146 01  env-var-len                 pic 9(4)  binary.
   147 01  rc                          pic 9(9)  binary.
   148 01  WS-KIXSYS.
   149     05  WS-KIX-FIL1             PIC X(10).
   150     05  WS-KIX-APPS             PIC X(10).
   151     05  WS-KIX-ENV              PIC X(10).
   152     05  WS-KIX-MYENV            PIC X(10).
   153     05  WS-KIX-SYS              PIC X(10).
   154*    COPY ELCSCTM.
   155******************************************************************
   156*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   5
* EL6311.cbl
   157*                                                                *
   158*                            ELCSCTM                             *
   159*                            VMOD=2.001                          *
   160*                                                                *
   161*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   162*                                                                *
   163******************************************************************
   164 01  SECURITY-MESSAGE.
   165     12  FILLER                          PIC X(30)
   166            VALUE '** LOGIC SECURITY VIOLATION -'.
   167     12  SM-READ                         PIC X(6).
   168     12  FILLER                          PIC X(5)
   169            VALUE ' PGM='.
   170     12  SM-PGM                          PIC X(6).
   171     12  FILLER                          PIC X(5)
   172            VALUE ' OPR='.
   173     12  SM-PROCESSOR-ID                 PIC X(4).
   174     12  FILLER                          PIC X(6)
   175            VALUE ' TERM='.
   176     12  SM-TERMID                       PIC X(4).
   177     12  FILLER                          PIC XX   VALUE SPACE.
   178     12  SM-JUL-DATE                     PIC 9(5).
   179     12  FILLER                          PIC X    VALUE SPACE.
   180     12  SM-TIME                         PIC 99.99.
   181
   182
   183*    COPY ELCSCRTY.
   184******************************************************************
   185*                                                                *
   186*                                                                *
   187*                            ELCSCRTY                            *
   188*                            VMOD=2.001                          *
   189*                                                                *
   190*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   191*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   192*        SAVED IN PI-SECURITY-ADDRESS.                           *
   193*                                                                *
   194******************************************************************
   195 01  SECURITY-CONTROL.
   196     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   197     12  FILLER                       PIC XX    VALUE 'SC'.
   198     12  SC-CREDIT-CODES.
   199         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   200             20  SC-CREDIT-DISPLAY    PIC X.
   201             20  SC-CREDIT-UPDATE     PIC X.
   202     12  SC-CLAIMS-CODES.
   203         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   204             20  SC-CLAIMS-DISPLAY    PIC X.
   205             20  SC-CLAIMS-UPDATE     PIC X.
   206
   207 01  WS-VA-NO-COMM-MESS.
   208     12  FILLER                  PIC X(41) VALUE
   209        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   210 01  WS-OC-MESSAGE.
   211     12  FILLER                  PIC X(43) VALUE
   212        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   213     12  WS-OC-DIS-AMT           PIC -----9.99.
   214     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   6
* EL6311.cbl
   215     12  WS-OC-DATE              PIC X(10).
   216 01  WS-DATE-AREA.
   217     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   218     12  WS-CURRENT-DT.
   219         16  FILLER              PIC X(6)    VALUE SPACES.
   220         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   221     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   222     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   223     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   224
   225 01  STANDARD-AREAS.
   226     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   227     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   228     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   229     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   230     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   231     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   232     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   233     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   234     12  PGM-NAME                PIC X(8).
   235     12  TIME-IN                 PIC S9(7).
   236     12  TIME-OUT-R  REDEFINES TIME-IN.
   237         16  FILLER              PIC X.
   238         16  TIME-OUT            PIC 99V99.
   239         16  FILLER              PIC XX.
   240     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   241     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   242     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   243     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   244     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   245     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   246     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   247     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   248     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   249     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   250     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   251     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   252     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   253     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   254     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   255     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   256     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   257     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   258     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   259     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   260     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   261     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   262     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   263     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   264     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   265     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   266     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   267     12  FILE-ID                 PIC X(8).
   268     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   269     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   270     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   271     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   272     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   7
* EL6311.cbl
   273     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   274     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   275     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   276     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   277     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   278     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   279     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   280     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   281     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   282     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   283
   284 01  WS-PASS-AREA.
   285     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   286     05  WS-PASS-VADS-REC    PIC X(350).
   287*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   288*                                COPY ELCZREC.
   289******************************************************************
   290*                                                                *
   291*                                                                *
   292*                            ELCZREC.                            *
   293*                                                                *
   294*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   295*                                                                *
   296******************************************************************
   297*-----------------------------------------------------------------
   298*                   C H A N G E   L O G
   299*
   300* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   301*-----------------------------------------------------------------
   302*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   303* EFFECTIVE    NUMBER
   304*-----------------------------------------------------------------
   305* 122011    2011022800001  AJRA  NEW FILE
   306* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   307* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   308* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   309* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   310*-----------------------------------------------------------------
   311 01  W-Z-CONTROL-DATA.
   312     05  W-NUMBER-OF-COPIES      PIC  9.
   313     05  FILLER                  PIC  X.
   314     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   315     05  FILLER                  PIC  X.
   316     05  W-DAYS-TO-RESEND        PIC  999.
   317     05  FILLER                  PIC  X.
   318     05  W-FORM-TO-RESEND        PIC  X(4).
   319     05  W-ADD-BAR-CODE          PIC  X.
   320     05  W-PROMPT-LETTER         PIC  X.
   321     05  W-HAS-RETURN-ENV        PIC  X.
   322     05  W-ENCLOSURE-CD          PIC  XXX.
   323     05  W-SIG-FLAG-DEFAULT      PIC  X.
   324     05  W-AUTO-CLOSE-IND        PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-LETTER-TO-BENE        PIC  X.
   327     05  FILLER                  PIC  X.
   328     05  W-LETTER-TO-ACCT        PIC  X.
   329     05  FILLER                  PIC  X.
   330     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   8
* EL6311.cbl
   331     05  FILLER                  PIC  X.
   332     05  W-PRINT-CERTIFICATE     PIC  X.
   333     05  FILLER                  PIC  X.
   334     05  W-REFUND-REQUIRED       PIC  X.
   335     05  FILLER                  PIC  X.
   336     05  W-ONBASE-CODE           PIC  XX.
   337     05  FILLER                  PIC  X.
   338     05  W-ACCT-SUMM             PIC  X.
   339     05  FILLER                  PIC  X.
   340     05  W-CSO-SUMM              PIC  X.
   341     05  FILLER                  PIC  X.
   342     05  W-REASONS-REQUIRED      PIC  X.
   343     05  FILLER                  PIC  X(29).
   344******************************************************************
   345*                                                                *
   346*              A C C E S S   K E Y S                             *
   347*                                                                *
   348******************************************************************
   349
   350 01  ACCESS-KEYS.
   351     12  ERPYAJ-KEY.
   352         16  ERPYAJ-COMPANY-CD       PIC X.
   353         16  ERPYAJ-CARRIER          PIC X.
   354         16  ERPYAJ-GROUPING         PIC X(6).
   355         16  ERPYAJ-FIN-RESP         PIC X(10).
   356         16  ERPYAJ-ACCOUNT          PIC X(10).
   357         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   358         16  ERPYAJ-TYPE             PIC X.
   359     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   360     12  ELCERT-KEY.
   361         16  ELCERT-COMPANY-CD       PIC X.
   362         16  ELCERT-CARRIER          PIC X.
   363         16  ELCERT-GROUPING         PIC X(6).
   364         16  ELCERT-STATE            PIC XX.
   365         16  ELCERT-ACCOUNT          PIC X(10).
   366         16  ELCERT-CERT-EFF-DT      PIC XX.
   367         16  ELCERT-CERT-NO.
   368             20  ELCERT-CERT-PRIME   PIC X(10).
   369             20  ELCERT-CERT-SFX     PIC X.
   370
   371     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   372     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   373     12  ELCRTO-KEY.
   374         16  ELCRTO-COMPANY-CD       PIC X.
   375         16  ELCRTO-CARRIER          PIC X.
   376         16  ELCRTO-GROUPING         PIC X(6).
   377         16  ELCRTO-STATE            PIC XX.
   378         16  ELCRTO-ACCOUNT          PIC X(10).
   379         16  ELCRTO-CERT-EFF-DT      PIC XX.
   380         16  ELCRTO-CERT-NO.
   381             20  ELCRTO-CERT-PRIME   PIC X(10).
   382             20  ELCRTO-CERT-SFX     PIC X.
   383         16  ELCRTO-RECORD-TYPE      PIC X.
   384         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   385
   386     12  ELCRTT-KEY.
   387         16  ELCRTT-PRIMARY          PIC X(33).
   388         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page   9
* EL6311.cbl
   389     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   390     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   391
   392     12  ERPNDB-KEY.
   393         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   394         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   395         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   396         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   397             ERPNDB-BATCH-SEQ-NO     PIC XX.
   398         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   399
   400     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   401     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   402     12  ERCHEK-KEY.
   403         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   404         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   405         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   406         16  CHEK-STATE              PIC XX      VALUE SPACES.
   407         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   408         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   409         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   410         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   411         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   412     12  ELLETR-KEY.
   413         16  LETR-COMPANY-CD     PIC X.
   414         16  LETR-LETTER-ID      PIC X(4).
   415         16  LETR-FILLER         PIC X(8).
   416         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   417     12  ERPNDM-KEY.
   418         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   419         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   420         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   421         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   422
   423*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   424     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   425*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   426     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   427
   428     12  ERPNDB-ALT-KEY.
   429         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   430         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   431         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   432         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   433         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   434         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   435         16  ERPNDB-CERT-NO.
   436             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   437             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   438         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   439         16  ERPNDB-RECORD-TYPE      PIC X.
   440
   441      12  ERPNDB-CSR-KEY.
   442          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   443          20  ERPNDB-CSR-ID                PIC X(4).
   444          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   445          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   446          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  10
* EL6311.cbl
   447
   448     12  ERNOTE-KEY.
   449         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   450         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   451         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   452         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   453         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   454         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   455         16  ERNOTE-CERT-NO.
   456             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   457             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   458         16  ernote-record-type      pic x        value spaces.
   459
   460     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   461     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   462
   463     12  ERCNOT-KEY.
   464         16  ERCNOT-PART-KEY.
   465             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   466             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   467             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   468             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   469             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   470             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   471             20  ERCNOT-CERT-NO.
   472                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   473                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   474         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   475         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   476
   477     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   478     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   479
   480     12  ERMAIL-KEY.
   481         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   482         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   483         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   484         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   485         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   486         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   487         16  ERMAIL-CERT-NO.
   488             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   489             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   490
   491     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   492     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   493
   494     12  ERRQST-KEY.
   495         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   496         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   497
   498     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   499     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   500
   501     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   502
   503     12  ERLOFC-KEY.
   504         16  ERLOFC-COMPANY-CD          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  11
* EL6311.cbl
   505         16  ERLOFC-CARRIER             PIC  X.
   506         16  ERLOFC-GROUPING            PIC  X(6).
   507         16  ERLOFC-STATE               PIC  XX.
   508         16  ERLOFC-ACCOUNT             PIC  X(10).
   509         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   510*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   511
   512     12  ERACCT-KEY.
   513         16  ERACCT-COMPANY-CD          PIC  X.
   514         16  ERACCT-CARRIER             PIC  X.
   515         16  ERACCT-GROUPING            PIC  X(6).
   516         16  ERACCT-STATE               PIC  XX.
   517         16  ERACCT-ACCOUNT             PIC  X(10).
   518         16  ERACCT-EXP-DT.
   519             20  ERACCT-DT              PIC  XX.
   520             20  ERACCT-FILL            PIC  X(4).
   521     12  ERACNT-KEY.
   522         16  ERACNT-COMPANY-CD          PIC  X.
   523         16  ERACNT-CARRIER             PIC  X.
   524         16  ERACNT-GROUPING            PIC  X(6).
   525         16  ERACNT-STATE               PIC  XX.
   526         16  ERACNT-ACCOUNT             PIC  X(10).
   527         16  ERACNT-REC-TYPE            PIC  X.
   528         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   529     12  ERENDT-KEY.
   530         16  ENDT-COMPANY-CD       PIC X.
   531         16  ENDT-CARRIER          PIC X.
   532         16  ENDT-GROUPING         PIC X(6).
   533         16  ENDT-STATE            PIC XX.
   534         16  ENDT-ACCOUNT          PIC X(10).
   535         16  ENDT-CERT-EFF-DT      PIC XX.
   536         16  ENDT-CERT-PRIME       PIC X(10).
   537         16  ENDT-CERT-SFX         PIC X.
   538         16  ENDT-RECORD-TYPE      PIC X.
   539         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   540
   541 01  WS-ELMSTR-WORK.
   542     12  ELMSTR-KEY.
   543         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   544         16  MSTR-CERT-NO.
   545             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   546             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   547     12  W-CLAIM-KEY.
   548         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   549         16  W-CL-CERT-NO.
   550             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   551             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   552      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   553 01  EL055-PASS-AREA.
   554     05  PA-CURRENT-KEY          PIC X(11).
   555     05  PA-NEW-ALT-KEY          PIC X(36).
   556     05  PA-RETURN-AREA.
   557         10  ra-status-code      pic 9(4).
   558         10  ra-message          pic x(205).
   559 01  CANCEL-GEN-PASS-AREA.
   560     05  CG-OPTION-CODE          PIC X.
   561         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   562         88  CG-FLAT-CANCEL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  12
* EL6311.cbl
   563         88  CG-CANCEL             VALUE '2'.
   564         88  CG-CANCEL-REISSUE     VALUE '3'.
   565     05  CG-ERROR-CODE           PIC 99.
   566         88  CG-SUCCESS            VALUE 00.
   567         88  CG-DATE-ERROR         VALUE 01.
   568         88  CG-CERT-NOT-FOUND     VALUE 02.
   569         88  CG-AMOUNT-ERROR       VALUE 04.
   570         88  CG-OPTION-ERROR       VALUE 05.
   571         88  CG-PREV-CAN           VALUE 06.
   572         88  CG-INVALID-DATA       VALUE 07.
   573         88  CG-NO-ACCT-MSTR       VALUE 08.
   574         88  CG-SFX-A-EXIST        VALUE 09.
   575         88  CG-MISC-ERROR         VALUE 99.
   576     05  CG-COMPANY-ID           PIC XXX.
   577     05  CG-PROC-ID              PIC XXXX.
   578     05  CG-CURRENT-DT           PIC XX.
   579     05  CG-MONTH-END-DT         PIC XX.
   580     05  CG-CERT-KEY.
   581         10  CG-CERT-COMPANY-CD  PIC X.
   582         10  CG-CERT-CARRIER     PIC X.
   583         10  CG-CERT-GROUP       PIC X(6).
   584         10  CG-CERT-STATE       PIC XX.
   585         10  CG-CERT-ACCOUNT     PIC X(10).
   586         10  CG-CERT-EFF-DT      PIC XX.
   587         10  CG-CERT-CERT-NO     PIC X(11).
   588     05  CG-LF-CAN-DATA.
   589         10  CG-LF-CAN-DT        PIC XX.
   590         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   591     05  CG-AH-CAN-DATA.
   592         10  CG-AH-CAN-DT        PIC XX.
   593         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   594     05  CG-CERT-PROFILE-DATA.
   595         10  CG-INS-LNAME        PIC X(15).
   596         10  CG-INS-FNAME        PIC X(10).
   597         10  CG-INS-MID-INIT     PIC X.
   598         10  CG-INS-AGE          PIC 99.
   599         10  CG-JNT-LNAME        PIC X(15).
   600         10  CG-JNT-FNAME        PIC X(10).
   601         10  CG-JNT-MID-INIT     PIC X.
   602         10  CG-JNT-AGE          PIC 99.
   603     05  CG-LF-ISS-DATA.
   604         10  CG-LF-BENCD         PIC XX.
   605         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   606         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   607     05  CG-AH-ISS-DATA.
   608         10  CG-AH-BENCD         PIC XX.
   609         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   610     05  CG-BATCH-NO             PIC X(6).
   611     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   612     05  FILLER                  PIC X(306).
   613******************************************************************
   614*                                                                *
   615*            G E N E R A L   W O R K   A R E A                   *
   616*                                                                *
   617******************************************************************
   618
   619 01  WORK-AREA.
   620     12  WS-RESPONSE             PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  13
* EL6311.cbl
   621         88  RESP-NORMAL           VALUE +0.
   622         88  resp-file-notfnd      value +12.
   623         88  RESP-NOTFND           VALUE +13.
   624         88  resp-duprec           value +14.
   625         88  resp-dupkey           value +15.
   626         88  resp-invreq           value +16.
   627         88  RESP-NOTOPEN          VALUE +19.
   628         88  RESP-ENDFILE          VALUE +20.
   629         88  resp-lengtherr        value +22.
   630     12  DEEDIT-FIELD            PIC X(15).
   631     12  FILLER          REDEFINES DEEDIT-FIELD.
   632         16  FILLER              PIC X(4).
   633         16  DEEDIT-FIELD-X11    PIC X(11).
   634     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   635                                 PIC S9(15).
   636     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   637                                 PIC S9(13)V99.
   638     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   639                                 PIC S9(11)V9999.
   640     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   641     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   642     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   643         16  WS-CALC-TERM-WHOLE  PIC S999.
   644         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   645
   646     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   647     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   648         16  WS-HR-MINS          PIC 99V99.
   649         16  FILLER              PIC XX.
   650
   651     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   652     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   653
   654     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   655     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   656
   657     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   658     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   659     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   660     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   661     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   662     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   663     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   664
   665     12  QID.
   666         16  QID-TERM            PIC X(4).
   667         16  FILLER              PIC X(4)    VALUE '607B'.
   668
   669     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   670         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   671
   672     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   673         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   674
   675     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   676         88 WS-MODE-CODE-VALID     VALUE ' '
   677                                         'W'     *> Weekly
   678                                         'B'     *> Bi-weekly
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  14
* EL6311.cbl
   679                                         'S'     *> Semi-monthly
   680                                         'M'     *> Monthly (Def)
   681                                         'Q'     *> Quarterly
   682                                         'N'     *> Bi-Monthly??
   683                                         'T'     *> Semi-annual
   684                                         'A'.    *> Annual Pay
   685
   686     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   687
   688     12  WS-NUMERIC-SW           PIC X.
   689        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   690
   691     12  WS-EDIT-CSO-FIELD.
   692         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   693                                 PIC X.
   694     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   695     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   696        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   697        88  CALLED-FROM-6315          VALUE '5'.
   698
   699     12  WS-SAVE-INPUT-FIELDS.
   700         16  WS-BAGE             PIC 99       VALUE ZERO.
   701*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   702         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   703         16  FILLER REDEFINES WS-BAPR.
   704             20  WS-APR-WHOLE-NUM    PIC 99.
   705             20  WS-APR-DEC          PIC 9999.
   706         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   707         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   708
   709         16  WS-B-COVERAGE OCCURS 2 TIMES.
   710             20  WS-TERM-IN-DAYS-SW  PIC X.
   711                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   712             20  WS-BTERM        PIC 999       COMP-3.
   713             20  WS-BALT-TERM    PIC 999       COMP-3.
   714             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   715             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   716             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   717             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   718             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   719             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   720
   721         16  WS-C-FIELDS COMP-3.
   722             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   723             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   724             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   725
   726         16  WS-D-FIELDS COMP-3.
   727             20  WS-DRISS        PIC S9(5)    VALUE +0.
   728             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   729             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   730             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   731             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   732             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   733
   734     12  WS-SAVE-BIRTH-DATE.
   735         16  FILLER              PIC X(4)   VALUE SPACES.
   736         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  15
* EL6311.cbl
   737
   738     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   739     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   740     12  FILLER REDEFINES WS-WORK-BIN-RED.
   741         16  FILLER              PIC X(02).
   742         16  WS-WORK-BIN-DT      PIC X(02).
   743     12  WS-SW-1                 PIC X     VALUE SPACE.
   744     12  WS-SW-2                 PIC X     VALUE SPACE.
   745     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   746         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   747     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   748         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   749
   750     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   751     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   752     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   753     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   754     12  WS-CONVERTED-CANCEL-DATES.
   755         16  WS-CONVERTED-CANDT1                  PIC XX.
   756         16  WS-CONVERTED-CANDT2                  PIC XX.
   757
   758     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   759
   760     12  WS-REC-FOUND-SW         PIC X.
   761         88  RECORD-NOT-FOUND    VALUE 'N'.
   762
   763     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   764         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   765         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   766
   767     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   768         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   769         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   770
   771     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   772         88  BROWSE-STARTED      VALUE 'Y'.
   773
   774     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   775         88  FIRST-TIME          VALUE 'Y'.
   776
   777     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   778         88  FIRST-ENTRY         VALUE 'Y'.
   779
   780     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   781         88  REC-BILLED          VALUE 'Y'.
   782
   783     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   784         88  NO-CURSOR-SET       VALUE +0.
   785         88  CURSOR-SET          VALUE +1.
   786
   787     12  WS-ERR-SW               PIC X.
   788         88  STD-ERRORS          VALUE 'S'.
   789         88  TRN-ERRORS          VALUE 'T'.
   790
   791     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   792         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   793
   794     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  16
* EL6311.cbl
   795         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   796
   797     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   798         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   799
   800     12  WS-ERR-CODE.
   801         16  FILLER              PIC 99.
   802         16  WS-ERROR-SUB        PIC 99.
   803
   804     12  WS-DATE-WORK.
   805         16  WS-WORK-MM          PIC XX.
   806         16  WS-WORK-DD          PIC XX.
   807         16  WS-WORK-YY          PIC XX.
   808
   809     12  WS-MM-YY.
   810         16  WS-MM               PIC XX.
   811         16  FILLER              PIC X     VALUE '/'.
   812         16  WS-YY               PIC XX.
   813
   814     12  WS-CERT-EFF-DT          PIC XX.
   815
   816     12  WS-MEMBER-NO            PIC X(12).
   817     12  FILLER  REDEFINES  WS-MEMBER-NO.
   818         16  WS-MEMBER-NO-1-8    PIC 9(8).
   819         16  FILLER              PIC X(4).
   820
   821     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   822
   823     12  WS-ERPNDB-ALT-KEY.
   824         16  WS-PB-COMPANY-CD-A1         PIC X.
   825         16  WS-PB-CARRIER               PIC X.
   826         16  WS-PB-GROUPING              PIC X(6).
   827         16  WS-PB-STATE                 PIC XX.
   828         16  WS-PB-ACCOUNT               PIC X(10).
   829         16  WS-PB-CERT-EFF-DT           PIC XX.
   830         16  WS-PB-CERT-NO.
   831             20  WS-PB-CERT-PRIME        PIC X(10).
   832             20  WS-PB-CERT-SFX          PIC X.
   833         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   834         16  WS-PB-RECORD-TYPE           PIC X.
   835
   836     12  WS-SHOW-SAVE-AREAS.
   837         16  WS-NEW-CERT-NO.
   838             20  WS-NEW-PRIME    PIC X(10).
   839             20  WS-NEW-SUFFIX   PIC X.
   840         16  WS-NEW-CERT-EFF-DT  PIC XX.
   841         16  WS-NEW-RECORD-TYPE  PIC X.
   842         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   843             88   SHOW-RECORD            VALUE 'Y'.
   844
   845     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   846
   847     12  WS-BATCH-NO.
   848         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   849         16  FILLER              PIC X(5) VALUE SPACES.
   850
   851     12  WS-FIRST-NAME.
   852         16  WS-1ST-INIT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  17
* EL6311.cbl
   853         16  FILLER              PIC X(9).
   854
   855     12  WS-INITIALS.
   856         16  WS-INITIAL-1        PIC X.
   857         16  WS-INITIAL-2        PIC X.
   858
   859     12  WS-C-HDG.
   860         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   861         16  FILLER              PIC X(4) VALUE '-REF'.
   862
   863     12  WS-D-PREM-HDG.
   864         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   865         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   866
   867     12  WS-D-REFUND-HDG.
   868         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   869         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   870
   871     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   872
   873     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   874     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   875     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   876     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   877     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   878     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   879     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   880
   881     12  WS-01-CANCEL-ERR        PIC X(25)
   882         VALUE 'CANCEL DATE ERROR'.
   883     12  WS-02-CANCEL-ERR        PIC X(25)
   884         VALUE 'CERT NOT FOUND'.
   885     12  WS-04-CANCEL-ERR        PIC X(25)
   886         VALUE 'CANCEL AMOUNT ERROR'.
   887     12  WS-05-CANCEL-ERR        PIC X(25)
   888         VALUE 'CANCEL OPTION ERROR'.
   889     12  WS-06-CANCEL-ERR        PIC X(25)
   890         VALUE 'PREVIOUSLY CANCELLED'.
   891     12  WS-07-CANCEL-ERR        PIC X(25)
   892         VALUE 'INVALID DATA'.
   893     12  WS-08-CANCEL-ERR        PIC X(25)
   894         VALUE 'NO ACCOUNT MASTER'.
   895     12  WS-09-CANCEL-ERR        PIC X(25)
   896         VALUE 'SUFFIX ALREADY EXISTS'.
   897     12  WS-99-CANCEL-ERR        PIC X(25)
   898         VALUE 'MISC CANCEL ERROR'.
   899
   900     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   901     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   902
   903     12  WS-AGE-FIELDS.
   904         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   905         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   906         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   907         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   908
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  18
* EL6311.cbl
   910
   911******************************************************************
   912*                                                                *
   913*                 B A T C H   T O T A L S                        *
   914*                                                                *
   915******************************************************************
   916
   917     12  WS-BATCH-RECORD.
   918         16  FILLER                       PIC X(10).
   919         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   920         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   921         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   922         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   923         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   924         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   925         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   926         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   927         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   928         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   929         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   930         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   931         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   932         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   933         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   934         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   935         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   936         16  WS-ACCOUNT-NAME              PIC X(30).
   937         16  FILLER                       PIC X.
   938         16  WS-REFERENCE                 PIC X(12).
   939         16  FILLER                       PIC X(197).
   940
   941     12  WS-BATCH-TOTALS.
   942         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   946         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   947         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   948         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   949         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   950         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   951         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   952         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   953         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   954         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   955         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   956         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   957         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   958         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   959         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   960         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   961
   962     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   963
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  19
* EL6311.cbl
   965
   966******************************************************************
   967*                                                                *
   968*                E R R O R   M E S S A G E S                     *
   969*                                                                *
   970******************************************************************
   971
   972 01  ERROR-MESSAGES.
   973     12  ER-0004                 PIC  9(4) VALUE 0004.
   974     12  ER-0008                 PIC  9(4) VALUE 0008.
   975     12  ER-0023                 PIC  9(4) VALUE 0023.
   976     12  ER-0029                 PIC  9(4) VALUE 0029.
   977     12  ER-0033                 PIC  9(4) VALUE 0033.
   978     12  ER-0070                 PIC  9(4) VALUE 0070.
   979     12  ER-0220                 PIC  9(4) VALUE 0220.
   980     12  er-0229                 pic  9(4) value 0229.
   981     12  ER-0248                 PIC  9(4) VALUE 0248.
   982     12  ER-0280                 PIC  9(4) VALUE 0280.
   983     12  ER-0348                 PIC  9(4) VALUE 0348.
   984     12  ER-0582                 PIC  9(4) VALUE 0582.
   985     12  ER-0877                 PIC  9(4) VALUE 0877.
   986     12  ER-1236                 PIC  9(4) VALUE 1236.
   987     12  ER-1570                 PIC  9(4) VALUE 1570.
   988     12  ER-1575                 PIC  9(4) VALUE 1575.
   989     12  ER-1577                 PIC  9(4) VALUE 1577.
   990     12  ER-1584                 PIC  9(4) VALUE 1584.
   991     12  ER-1585                 PIC  9(4) VALUE 1585.
   992     12  ER-1609                 PIC  9(4) VALUE 1609.
   993     12  er-1762                 pic  9(4) value 1762.
   994     12  ER-1819                 PIC  9(4) VALUE 1819.
   995     12  ER-2077                 PIC  9(4) VALUE 2077.
   996     12  ER-2129                 PIC  9(4) VALUE 2129.
   997     12  ER-2188                 PIC  9(4) VALUE 2188.
   998     12  ER-2192                 PIC  9(4) VALUE 2192.
   999     12  ER-2196                 PIC  9(4) VALUE 2196.
  1000     12  ER-2197                 PIC  9(4) VALUE 2197.
  1001     12  ER-2198                 PIC  9(4) VALUE 2198.
  1002     12  ER-2200                 PIC  9(4) VALUE 2200.
  1003     12  ER-2212                 PIC  9(4) VALUE 2212.
  1004     12  ER-2218                 PIC  9(4) VALUE 2218.
  1005     12  ER-2220                 PIC  9(4) VALUE 2220.
  1006     12  ER-2222                 PIC  9(4) VALUE 2222.
  1007     12  ER-2223                 PIC  9(4) VALUE 2223.
  1008     12  ER-2224                 PIC  9(4) VALUE 2224.
  1009     12  ER-2225                 PIC  9(4) VALUE 2225.
  1010     12  ER-2226                 PIC  9(4) VALUE 2226.
  1011     12  ER-2227                 PIC  9(4) VALUE 2227.
  1012     12  ER-2228                 PIC  9(4) VALUE 2228.
  1013     12  ER-2240                 PIC  9(4) VALUE 2240.
  1014     12  ER-2241                 PIC  9(4) VALUE 2241.
  1015     12  ER-2242                 PIC  9(4) VALUE 2242.
  1016     12  ER-2243                 PIC  9(4) VALUE 2243.
  1017     12  ER-2244                 PIC  9(4) VALUE 2244.
  1018     12  ER-2245                 PIC  9(4) VALUE 2245.
  1019     12  ER-2246                 PIC  9(4) VALUE 2246.
  1020     12  ER-2247                 PIC  9(4) VALUE 2247.
  1021     12  ER-2251                 PIC  9(4) VALUE 2251.
  1022     12  ER-2252                 PIC  9(4) VALUE 2252.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  20
* EL6311.cbl
  1023     12  ER-2253                 PIC  9(4) VALUE 2253.
  1024     12  ER-2254                 PIC  9(4) VALUE 2254.
  1025     12  ER-2255                 PIC  9(4) VALUE 2255.
  1026     12  ER-2256                 PIC  9(4) VALUE 2256.
  1027     12  ER-2257                 PIC  9(4) VALUE 2257.
  1028     12  ER-2258                 PIC  9(4) VALUE 2258.
  1029     12  ER-2259                 PIC  9(4) VALUE 2259.
  1030     12  ER-2260                 PIC  9(4) VALUE 2260.
  1031     12  ER-2261                 PIC  9(4) VALUE 2261.
  1032     12  ER-2287                 PIC  9(4) VALUE 2287.
  1033     12  ER-2336                 PIC  9(4) VALUE 2336.
  1034     12  ER-2337                 PIC  9(4) VALUE 2337.
  1035     12  ER-2437                 PIC  9(4) VALUE 2437.
  1036     12  ER-2471                 PIC  9(4) VALUE 2471.
  1037     12  ER-2530                 PIC  9(4) VALUE 2530.
  1038     12  ER-2531                 PIC  9(4) VALUE 2531.
  1039     12  ER-2532                 PIC  9(4) VALUE 2532.
  1040     12  ER-2533                 PIC  9(4) VALUE 2533.
  1041     12  ER-2547                 PIC  9(4) VALUE 2547.
  1042     12  ER-2591                 PIC  9(4) VALUE 2591.
  1043     12  ER-2592                 PIC  9(4) VALUE 2592.
  1044     12  ER-2593                 PIC  9(4) VALUE 2593.
  1045     12  ER-2600                 PIC  9(4) VALUE 2600.
  1046     12  ER-2601                 PIC  9(4) VALUE 2601.
  1047     12  ER-2604                 PIC  9(4) VALUE 2604.
  1048     12  ER-2605                 PIC  9(4) VALUE 2605.
  1049     12  ER-2606                 PIC  9(4) VALUE 2606.
  1050     12  ER-2607                 PIC  9(4) VALUE 2607.
  1051     12  ER-2622                 PIC  9(4) VALUE 2622.
  1052     12  ER-2625                 PIC  9(4) VALUE 2625.
  1053     12  ER-2626                 PIC  9(4) VALUE 2626.
  1054     12  ER-2627                 PIC  9(4) VALUE 2627.
  1055     12  ER-2628                 PIC  9(4) VALUE 2628.
  1056     12  ER-2629                 PIC  9(4) VALUE 2629.
  1057     12  ER-2630                 PIC  9(4) VALUE 2630.
  1058     12  ER-2631                 PIC  9(4) VALUE 2631.
  1059     12  ER-2632                 PIC  9(4) VALUE 2632.
  1060     12  ER-2633                 PIC  9(4) VALUE 2633.
  1061     12  ER-2634                 PIC  9(4) VALUE 2634.
  1062     12  ER-2635                 PIC  9(4) VALUE 2635.
  1063     12  ER-2636                 PIC  9(4) VALUE 2636.
  1064     12  ER-2639                 PIC  9(4) VALUE 2639.
  1065     12  ER-2640                 PIC  9(4) VALUE 2640.
  1066     12  ER-2647                 PIC  9(4) VALUE 2647.
  1067     12  ER-2648                 PIC  9(4) VALUE 2648.
  1068     12  ER-2649                 PIC  9(4) VALUE 2649.
  1069     12  ER-2650                 PIC  9(4) VALUE 2650.
  1070     12  ER-2651                 PIC  9(4) VALUE 2651.
  1071     12  ER-2653                 PIC  9(4) VALUE 2653.
  1072     12  ER-2654                 PIC  9(4) VALUE 2654.
  1073     12  ER-2655                 PIC  9(4) VALUE 2655.
  1074     12  ER-2656                 PIC  9(4) VALUE 2656.
  1075     12  ER-2657                 PIC  9(4) VALUE 2657.
  1076     12  ER-2660                 PIC  9(4) VALUE 2660.
  1077     12  ER-2661                 PIC  9(4) VALUE 2661.
  1078     12  ER-2662                 PIC  9(4) VALUE 2662.
  1079     12  ER-2663                 PIC  9(4) VALUE 2663.
  1080     12  ER-2664                 PIC  9(4) VALUE 2664.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  21
* EL6311.cbl
  1081     12  ER-2667                 PIC  9(4) VALUE 2667.
  1082     12  ER-2668                 PIC  9(4) VALUE 2668.
  1083     12  ER-2669                 PIC  9(4) VALUE 2669.
  1084     12  ER-2670                 PIC  9(4) VALUE 2670.
  1085     12  ER-2671                 PIC  9(4) VALUE 2671.
  1086     12  ER-2672                 PIC  9(4) VALUE 2672.
  1087     12  ER-2673                 PIC  9(4) VALUE 2673.
  1088     12  ER-2677                 PIC  9(4) VALUE 2677.
  1089     12  ER-2678                 PIC  9(4) VALUE 2678.
  1090     12  ER-2679                 PIC  9(4) VALUE 2679.
  1091     12  ER-2680                 PIC  9(4) VALUE 2680.
  1092     12  ER-2681                 PIC  9(4) VALUE 2681.
  1093     12  ER-2682                 PIC  9(4) VALUE 2682.
  1094     12  ER-2683                 PIC  9(4) VALUE 2683.
  1095     12  ER-2684                 PIC  9(4) VALUE 2684.
  1096     12  ER-2686                 PIC  9(4) VALUE 2686.
  1097     12  ER-2689                 PIC  9(4) VALUE 2689.
  1098     12  ER-2690                 PIC  9(4) VALUE 2690.
  1099     12  ER-2693                 PIC  9(4) VALUE 2693.
  1100     12  ER-2695                 PIC  9(4) VALUE 2695.
  1101     12  ER-2701                 PIC  9(4) VALUE 2701.
  1102     12  ER-2720                 PIC  9(4) VALUE 2720.
  1103     12  ER-2709                 PIC  9(4) VALUE 2709.
  1104     12  ER-2704                 PIC  9(4) VALUE 2704.
  1105     12  ER-2725                 PIC  9(4) VALUE 2725.
  1106     12  ER-2726                 PIC  9(4) VALUE 2726.
  1107     12  ER-2728                 PIC  9(4) VALUE 2728.
  1108     12  ER-2729                 PIC  9(4) VALUE 2729.
  1109     12  ER-2731                 PIC  9(4) VALUE 2731.
  1110     12  ER-2732                 PIC  9(4) VALUE 2732.
  1111     12  ER-2733                 PIC  9(4) VALUE 2733.
  1112     12  ER-2735                 PIC  9(4) VALUE 2735.
  1113     12  ER-2738                 PIC  9(4) VALUE 2738.
  1114     12  ER-2742                 PIC  9(4) VALUE 2742.
  1115     12  ER-2743                 PIC  9(4) VALUE 2743.
  1116     12  ER-2744                 PIC  9(4) VALUE 2744.
  1117     12  ER-2747                 PIC  9(4) VALUE 2747.
  1118     12  ER-2749                 PIC  9(4) VALUE 2749.
  1119     12  ER-2753                 PIC  9(4) VALUE 2753.
  1120     12  ER-2755                 PIC  9(4) VALUE 2755.
  1121     12  ER-2757                 PIC  9(4) VALUE 2757.
  1122     12  ER-2771                 PIC  9(4) VALUE 2771.
  1123     12  ER-2774                 PIC  9(4) VALUE 2774.
  1124     12  ER-2775                 PIC  9(4) VALUE 2775.
  1125     12  ER-2776                 PIC  9(4) VALUE 2776.
  1126     12  ER-2777                 PIC  9(4) VALUE 2777.
  1127     12  ER-2794                 PIC  9(4) VALUE 2794.
  1128     12  ER-2799                 PIC  9(4) VALUE 2799.
  1129     12  er-2878                 pic  9(4) value 2878.
  1130     12  ER-2900                 PIC  9(4) VALUE 2900.
  1131     12  ER-2902                 PIC  9(4) VALUE 2902.
  1132     12  ER-2945                 PIC  9(4) VALUE 2945.
  1133     12  ER-3000                 PIC  9(4) VALUE 3000.
  1134     12  ER-3006                 PIC  9(4) VALUE 3006.
  1135     12  ER-3054                 PIC  9(4) VALUE 3054.
  1136     12  er-3070                 pic  9(4) value 3070.
  1137     12  ER-3224                 PIC  9(4) VALUE 3224.
  1138     12  ER-3269                 PIC  9(4) VALUE 3269.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  22
* EL6311.cbl
  1139     12  er-3444                 pic  9(4) value 3444.
  1140     12  er-3446                 pic  9(4) value 3446.
  1141     12  er-3447                 pic  9(4) value 3447.
  1142     12  er-3448                 pic  9(4) value 3448.
  1143     12  er-3449                 pic  9(4) value 3449.
  1144     12  ER-3456                 PIC  9(4) VALUE 3456.
  1145     12  ER-3457                 PIC  9(4) VALUE 3457.
  1146     12  ER-3458                 PIC  9(4) VALUE 3458.
  1147     12  ER-3504                 PIC  9(4) VALUE 3504.
  1148     12  ER-3513                 PIC  9(4) VALUE 3513.
  1149     12  ER-3831                 PIC  9(4) VALUE 3831.
  1150     12  ER-3834                 PIC  9(4) VALUE 3834.
  1151     12  ER-3835                 PIC  9(4) VALUE 3835.
  1152     12  ER-4005                 PIC  9(4) VALUE 4005.
  1153     12  ER-7144                 PIC  9(4) VALUE 7144.
  1154     12  ER-7401                 PIC  9(4) VALUE 7401.
  1155     12  ER-7402                 PIC  9(4) VALUE 7402.
  1156     12  ER-7403                 PIC  9(4) VALUE 7403.
  1157     12  ER-7404                 PIC  9(4) VALUE 7404.
  1158     12  ER-7423                 PIC  9(4) VALUE 7423.
  1159     12  ER-7424                 PIC  9(4) VALUE 7424.
  1160     12  ER-7433                 PIC  9(4) VALUE 7433.
  1161     12  ER-7450                 PIC  9(4) VALUE 7450.
  1162     12  ER-7451                 PIC  9(4) VALUE 7451.
  1163     12  ER-7530                 PIC  9(4) VALUE 7530.
  1164     12  ER-7573                 PIC  9(4) VALUE 7573.
  1165     12  ER-7631                 PIC  9(4) VALUE 7631.
  1166     12  ER-7632                 PIC  9(4) VALUE 7632.
  1167     12  ER-7633                 PIC  9(4) VALUE 7633.
  1168     12  ER-7537                 PIC  9(4) VALUE 7537.
  1169     12  ER-7538                 PIC  9(4) VALUE 7538.
  1170     12  ER-7574                 PIC  9(4) VALUE 7574.
  1171     12  ER-7997                 PIC  9(4) VALUE 7997.
  1172     12  ER-7998                 PIC  9(4) VALUE 7998.
  1173     12  ER-8148                 PIC  9(4) VALUE 8148.
  1174     12  ER-9063                 PIC  9(4) VALUE 9063.
  1175     12  ER-9076                 PIC  9(4) VALUE 9076.
  1176     12  ER-9618                 PIC  9(4) VALUE 9618.
  1177     12  ER-9841                 PIC  9(4) VALUE 9841.
  1178     12  er-9853                 pic  9(4) value 9853.
  1179
  1180*                                COPY ELCTEXT.
  1181******************************************************************
  1182*                                                                *
  1183*                                                                *
  1184*                            ELCTEXT.                            *
  1185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1186*                            VMOD=2.008                          *
  1187*                                                                *
  1188*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1189*                                     FORM LETTERS,              *
  1190*                                     CERT FORM DISPLAY.
  1191*                                                                *
  1192*   FILE TYPE = VSAM,KSDS                                        *
  1193*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1194*                                                                *
  1195*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1196*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  23
* EL6311.cbl
  1197*                                                                *
  1198*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1199*       ALTERNATE INDEX = NONE                                   *
  1200*                                                                *
  1201*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1202*       ALTERNATE INDEX = NONE                                   *
  1203*                                                                *
  1204*   LOG = NO                                                     *
  1205*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1206******************************************************************
  1207 01  TEXT-FILES.
  1208     12  TEXT-FILE-ID                PIC XX.
  1209         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1210         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1211         88  HELP-FILE-TEXT             VALUE 'TH'.
  1212
  1213     12  TX-CONTROL-PRIMARY.
  1214         16  TX-COMPANY-CD           PIC X.
  1215             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1216         16  TX-ACCESS-CD-GENL       PIC X(12).
  1217
  1218         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1219             20  TX-LETTER-NO        PIC X(4).
  1220             20  FILLER              PIC X(8).
  1221
  1222         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1223             20  TX-FORM-NO          PIC X(12).
  1224
  1225         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1226             20  TX-HELP-TYPE        PIC X.
  1227                 88  HELP-FOR-GENERAL   VALUE ' '.
  1228                 88  HELP-BY-SCREEN     VALUE 'S'.
  1229                 88  HELP-BY-ERROR      VALUE 'E'.
  1230             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1231                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1232             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1233                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1234             20  FILLER              PIC X(4).
  1235
  1236         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1237
  1238     12  TX-PROCESS-CONTROL          PIC XX.
  1239         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1240
  1241     12  TX-TEXT-LINE                PIC X(70).
  1242
  1243     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1244         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1245         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1246         88  TX-VALID-FORM-SQUEEZE-VALUE
  1247                                        VALUE 'Y' ' '.
  1248
  1249     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1250         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1251         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1252         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1253         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1254         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  24
* EL6311.cbl
  1255         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1256         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1257                                              'K' 'N' ' '
  1258                                              'Z'.
  1259
  1260     12  TX-ARCHIVE-SW               PIC X.
  1261         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1262         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1263         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1264
  1265     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1266     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1267
  1268     12  TX-BSR-CODE                 PIC X.
  1269         88  TX-BSR-LETTER              VALUE 'B'.
  1270         88  TX-NON-BSR-LETTER          VALUE ' '.
  1271
  1272     12  FILLER                      PIC X.
  1273*****************************************************************
  1274*                                COPY ELCCRTO.
  1275******************************************************************
  1276*                                                                *
  1277*                            ELCCRTO.                            *
  1278*                                                                *
  1279*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1280*                                                                *
  1281*   FILE TYPE = VSAM,KSDS                                        *
  1282*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1283*                                                                *
  1284*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1285*                                                                *
  1286*   LOG = YES                                                    *
  1287*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1288******************************************************************
  1289*                   C H A N G E   L O G
  1290*
  1291* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1292*-----------------------------------------------------------------
  1293*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1294* EFFECTIVE    NUMBER
  1295*-----------------------------------------------------------------
  1296* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1297* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1298* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1299* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1300* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1301******************************************************************
  1302 01  ORIGINAL-CERTIFICATE.
  1303     12  OC-RECORD-ID                      PIC XX.
  1304         88  VALID-OC-ID                      VALUE 'OC'.
  1305     12  OC-CONTROL-PRIMARY.
  1306         16  OC-COMPANY-CD                 PIC X.
  1307         16  OC-CARRIER                    PIC X.
  1308         16  OC-GROUPING                   PIC X(6).
  1309         16  OC-STATE                      PIC XX.
  1310         16  OC-ACCOUNT                    PIC X(10).
  1311         16  OC-CERT-EFF-DT                PIC XX.
  1312         16  OC-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  25
* EL6311.cbl
  1313             20  OC-CERT-PRIME             PIC X(10).
  1314             20  OC-CERT-SFX               PIC X.
  1315         16  OC-RECORD-TYPE                PIC X.
  1316         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1317     12  OC-LAST-MAINT-DT                  PIC XX.
  1318     12  OC-LAST-MAINT-BY                  PIC X(4).
  1319     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1320     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1321     12  FILLER                            PIC X(49).
  1322     12  OC-ORIG-REC.
  1323         16  OC-INS-LAST-NAME              PIC X(15).
  1324         16  OC-INS-FIRST-NAME             PIC X(10).
  1325         16  OC-INS-MIDDLE-INIT            PIC X.
  1326         16  OC-INS-AGE                    PIC S999     COMP-3.
  1327         16  OC-JNT-LAST-NAME              PIC X(15).
  1328         16  OC-JNT-FIRST-NAME             PIC X(10).
  1329         16  OC-JNT-MIDDLE-INIT            PIC X.
  1330         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1331         16  OC-LF-BENCD                   PIC XX.
  1332         16  OC-LF-TERM                    PIC S999      COMP-3.
  1333         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1334         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1335         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1336         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1337         16  OC-LF-EXP-DT                  PIC XX.
  1338         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1339         16  OC-LF-CANCEL-DT               PIC XX.
  1340         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1341         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1342         16  OC-AH-BENCD                   PIC XX.
  1343         16  OC-AH-TERM                    PIC S999      COMP-3.
  1344         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1345         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1346         16  OC-AH-EXP-DT                  PIC XX.
  1347         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1348         16  OC-AH-CP                      PIC 99.
  1349         16  OC-AH-CANCEL-DT               PIC XX.
  1350         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1351         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1352         16  OC-CRED-BENE-NAME             PIC X(25).
  1353         16  OC-1ST-PMT-DT                 PIC XX.
  1354         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1355         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1356         16  OC-ISSUE-TRAN-IND             PIC X.
  1357         16  OC-CANCEL-TRAN-IND            PIC X.
  1358         16  FILLER                        PIC X(211).
  1359
  1360     12  FILLER                            PIC X(50).
  1361******************************************************************
  1362*                                COPY ERCACCT.
  1363******************************************************************
  1364*                                                                *
  1365*                                                                *
  1366*                            ERCACCT                             *
  1367*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1368*                            VMOD=2.031                          *
  1369*                                                                *
  1370*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  26
* EL6311.cbl
  1371*                                                                *
  1372*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1373*   VSAM ACCOUNT MASTER FILES.                                   *
  1374*                                                                *
  1375*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1376*                                                                *
  1377*   FILE TYPE = VSAM,KSDS                                        *
  1378*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1379*                                                                *
  1380*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1381*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1382*                                                                *
  1383*   LOG = NO                                                     *
  1384*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1385*                                                                *
  1386*                                                                *
  1387******************************************************************
  1388*                   C H A N G E   L O G
  1389*
  1390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1391*-----------------------------------------------------------------
  1392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1393* EFFECTIVE    NUMBER
  1394*-----------------------------------------------------------------
  1395* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1396* 092705    2005050300006  PEMA  ADD SPP LEASES
  1397* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1398* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1399* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1400* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1401* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1402* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1403******************************************************************
  1404
  1405 01  ACCOUNT-MASTER.
  1406     12  AM-RECORD-ID                      PIC XX.
  1407         88  VALID-AM-ID                      VALUE 'AM'.
  1408
  1409     12  AM-CONTROL-PRIMARY.
  1410         16  AM-COMPANY-CD                 PIC X.
  1411         16  AM-MSTR-CNTRL.
  1412             20  AM-CONTROL-A.
  1413                 24  AM-CARRIER            PIC X.
  1414                 24  AM-GROUPING.
  1415                     28 AM-GROUPING-PREFIX PIC XXX.
  1416                     28 AM-GROUPING-PRIME  PIC XXX.
  1417                 24  AM-STATE              PIC XX.
  1418                 24  AM-ACCOUNT.
  1419                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1420                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1421             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1422                                           PIC X(19).
  1423             20  AM-CNTRL-B.
  1424                 24  AM-EXPIRATION-DT      PIC XX.
  1425                 24  FILLER                PIC X(4).
  1426             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1427                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1428
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  27
* EL6311.cbl
  1429     12  AM-CONTROL-BY-VAR-GRP.
  1430         16  AM-COMPANY-CD-A1              PIC X.
  1431         16  AM-VG-CARRIER                 PIC X.
  1432         16  AM-VG-GROUPING                PIC X(6).
  1433         16  AM-VG-STATE                   PIC XX.
  1434         16  AM-VG-ACCOUNT                 PIC X(10).
  1435         16  AM-VG-DATE.
  1436             20  AM-VG-EXPIRATION-DT       PIC XX.
  1437             20  FILLER                    PIC X(4).
  1438         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1439                                           PIC 9(11)      COMP-3.
  1440     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1441         16  FILLER                        PIC X(10).
  1442         16  AM-VG-KEY3.
  1443             20  AM-VG3-ACCOUNT            PIC X(10).
  1444             20  AM-VG3-EXP-DT             PIC XX.
  1445         16  FILLER                        PIC X(4).
  1446     12  AM-MAINT-INFORMATION.
  1447         16  AM-LAST-MAINT-DT              PIC XX.
  1448         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1449         16  AM-LAST-MAINT-USER            PIC X(4).
  1450         16  FILLER                        PIC XX.
  1451
  1452     12  AM-EFFECTIVE-DT                   PIC XX.
  1453     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1454
  1455     12  AM-PREV-DATES  COMP-3.
  1456         16  AM-PREV-EXP-DT                PIC 9(11).
  1457         16  AM-PREV-EFF-DT                PIC 9(11).
  1458
  1459     12  AM-REPORT-CODE-1                  PIC X(10).
  1460     12  AM-REPORT-CODE-2                  PIC X(10).
  1461
  1462     12  AM-CITY-CODE                      PIC X(4).
  1463     12  AM-COUNTY-PARISH                  PIC X(6).
  1464
  1465     12  AM-NAME                           PIC X(30).
  1466     12  AM-PERSON                         PIC X(30).
  1467     12  AM-ADDRS                          PIC X(30).
  1468     12  AM-CITY.
  1469         16  AM-ADDR-CITY                  PIC X(28).
  1470         16  AM-ADDR-STATE                 PIC XX.
  1471     12  AM-ZIP.
  1472         16  AM-ZIP-PRIME.
  1473             20  AM-ZIP-PRI-1ST            PIC X.
  1474                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1475             20  FILLER                    PIC X(4).
  1476         16  AM-ZIP-PLUS4                  PIC X(4).
  1477     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1478         16  AM-CAN-POSTAL-1               PIC XXX.
  1479         16  AM-CAN-POSTAL-2               PIC XXX.
  1480         16  FILLER                        PIC XXX.
  1481     12  AM-TEL-NO.
  1482         16  AM-AREA-CODE                  PIC 999.
  1483         16  AM-TEL-PRE                    PIC 999.
  1484         16  AM-TEL-NBR                    PIC 9(4).
  1485     12  AM-TEL-LOC                        PIC X.
  1486         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  28
* EL6311.cbl
  1487         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1488
  1489     12  AM-COMM-STRUCTURE.
  1490         16  AM-DEFN-1.
  1491             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1492                 24  AM-AGT.
  1493                     28  AM-AGT-PREFIX     PIC X(4).
  1494                     28  AM-AGT-PRIME      PIC X(6).
  1495                 24  AM-COM-TYP            PIC X.
  1496                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1497                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1498                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1499                 24  AM-RECALC-LV-INDIC    PIC X.
  1500                 24  AM-RETRO-LV-INDIC     PIC X.
  1501                 24  AM-GL-CODES           PIC X.
  1502                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1503                 24  FILLER                PIC X(01).
  1504         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1505             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1506                 24  FILLER                PIC X(11).
  1507                 24  AM-L-COMA             PIC XXX.
  1508                 24  AM-J-COMA             PIC XXX.
  1509                 24  AM-A-COMA             PIC XXX.
  1510                 24  FILLER                PIC X(6).
  1511
  1512     12  AM-COMM-CHANGE-STATUS             PIC X.
  1513         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1514
  1515     12  AM-CSR-CODE                       PIC X(4).
  1516
  1517     12  AM-BILLING-STATUS                 PIC X.
  1518         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1519         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1520     12  AM-AUTO-REFUND-SW                 PIC X.
  1521         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1522         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1523     12  AM-GPCD                           PIC 99.
  1524     12  AM-IG                             PIC X.
  1525         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1526         88  AM-HAS-GROUP                     VALUE '2'.
  1527     12  AM-STATUS                         PIC X.
  1528         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1529         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1530         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1531         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1532         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1533         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1534         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1535         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1536         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1537         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1538     12  AM-REMIT-TO                       PIC 99.
  1539     12  AM-ID-NO                          PIC X(11).
  1540
  1541     12  AM-CAL-TABLE                      PIC XX.
  1542     12  AM-LF-DEVIATION                   PIC XXX.
  1543     12  AM-AH-DEVIATION                   PIC XXX.
  1544     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  29
* EL6311.cbl
  1545     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1546     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1547     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1548     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1549     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1550
  1551     12  AM-USER-FIELDS.
  1552         16  AM-FLD-1                      PIC XX.
  1553         16  AM-FLD-2                      PIC XX.
  1554         16  AM-FLD-3                      PIC XX.
  1555         16  AM-FLD-4                      PIC XX.
  1556         16  AM-FLD-5                      PIC XX.
  1557
  1558     12  AM-1ST-PROD-DATE.
  1559         16  AM-1ST-PROD-YR                PIC XX.
  1560         16  AM-1ST-PROD-MO                PIC XX.
  1561         16  AM-1ST-PROD-DA                PIC XX.
  1562     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1563     12  AM-CERTS-PURGED-DATE.
  1564         16  AM-PUR-YR                     PIC XX.
  1565         16  AM-PUR-MO                     PIC XX.
  1566         16  AM-PUR-DA                     PIC XX.
  1567     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1568     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1569     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1570     12  AM-INACTIVE-DATE.
  1571         16  AM-INA-MO                     PIC 99.
  1572         16  AM-INA-DA                     PIC 99.
  1573         16  AM-INA-YR                     PIC 99.
  1574     12  AM-AR-HI-CERT-DATE                PIC XX.
  1575
  1576     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1577     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1578
  1579     12  AM-OB-PAYMENT-MODE                PIC X.
  1580         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1581         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1582         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1583         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1584
  1585     12  AM-AH-ONLY-INDICATOR              PIC X.
  1586         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1587         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1588
  1589     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1590
  1591     12  AM-OVER-SHORT.
  1592         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1593         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1594
  1595     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1596     12  AM-DCC-CLP-STATE                  PIC XX.
  1597
  1598     12  AM-RECALC-COMM                    PIC X.
  1599     12  AM-RECALC-REIN                    PIC X.
  1600
  1601     12  AM-REI-TABLE                      PIC XXX.
  1602     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  30
* EL6311.cbl
  1603     12  AM-REI-ET-AH                      PIC X.
  1604     12  AM-REI-PE-LF                      PIC X.
  1605     12  AM-REI-PE-AH                      PIC X.
  1606     12  AM-REI-PRT-ST                     PIC X.
  1607     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1608     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1609     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1610     12  AM-REI-GROUP-A                    PIC X(6).
  1611     12  AM-REI-MORT                       PIC X(4).
  1612     12  AM-REI-PRT-OW                     PIC X.
  1613     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1614     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1615     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1616     12  AM-REI-GROUP-B                    PIC X(6).
  1617
  1618     12  AM-TRUST-TYPE                     PIC X(2).
  1619
  1620     12  AM-EMPLOYER-STMT-USED             PIC X.
  1621     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1622
  1623     12  AM-STD-AH-TYPE                    PIC XX.
  1624     12  AM-EARN-METHODS.
  1625         16  AM-EARN-METHOD-R              PIC X.
  1626             88 AM-REF-RL-R78                 VALUE 'R'.
  1627             88 AM-REF-RL-PR                  VALUE 'P'.
  1628             88 AM-REF-RL-MEAN                VALUE 'M'.
  1629             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1630         16  AM-EARN-METHOD-L              PIC X.
  1631             88 AM-REF-LL-R78                 VALUE 'R'.
  1632             88 AM-REF-LL-PR                  VALUE 'P'.
  1633             88 AM-REF-LL-MEAN                VALUE 'M'.
  1634             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1635         16  AM-EARN-METHOD-A              PIC X.
  1636             88 AM-REF-AH-R78                 VALUE 'R'.
  1637             88 AM-REF-AH-PR                  VALUE 'P'.
  1638             88 AM-REF-AH-MEAN                VALUE 'M'.
  1639             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1640             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1641             88 AM-REF-AH-NET                 VALUE 'N'.
  1642
  1643     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1644     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1645     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1646
  1647     12  AM-RET-Y-N                        PIC X.
  1648     12  AM-RET-P-E                        PIC X.
  1649     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1650     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1651     12  AM-RET-GRP                        PIC X(6).
  1652     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1653         16  AM-POOL-PRIME                 PIC XXX.
  1654         16  AM-POOL-SUB                   PIC XXX.
  1655     12  AM-RETRO-EARNINGS.
  1656         16  AM-RET-EARN-R                 PIC X.
  1657         16  AM-RET-EARN-L                 PIC X.
  1658         16  AM-RET-EARN-A                 PIC X.
  1659     12  AM-RET-ST-TAX-USE                 PIC X.
  1660         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  31
* EL6311.cbl
  1661         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1662     12  AM-RETRO-BEG-EARNINGS.
  1663         16  AM-RET-BEG-EARN-R             PIC X.
  1664         16  AM-RET-BEG-EARN-L             PIC X.
  1665         16  AM-RET-BEG-EARN-A             PIC X.
  1666     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1667     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1668
  1669     12  AM-USER-SELECT-OPTIONS.
  1670         16  AM-USER-SELECT-1              PIC X(10).
  1671         16  AM-USER-SELECT-2              PIC X(10).
  1672         16  AM-USER-SELECT-3              PIC X(10).
  1673         16  AM-USER-SELECT-4              PIC X(10).
  1674         16  AM-USER-SELECT-5              PIC X(10).
  1675
  1676     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1677
  1678     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1679
  1680     12  AM-RPT045A-SWITCH                 PIC X.
  1681         88  RPT045A-OFF                   VALUE 'N'.
  1682
  1683     12  AM-INSURANCE-LIMITS.
  1684         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1685         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1686
  1687     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1688         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1689
  1690     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1691         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1692         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1693
  1694     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1695
  1696     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1697     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1698     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1699     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1700     12  AM-DCC-UEF-STATE                  PIC XX.
  1701     12  FILLER                            PIC XXX.
  1702     12  AM-REPORT-CODE-3                  PIC X(10).
  1703*    12  FILLER                            PIC X(22).
  1704
  1705     12  AM-RESERVE-DATE.
  1706         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1707         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1708         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1709
  1710     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1711     12  AM-NOTIFICATION-TYPES.
  1712         16  AM-NOTIF-OF-LETTERS           PIC X.
  1713         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1714         16  AM-NOTIF-OF-REPORTS           PIC X.
  1715         16  AM-NOTIF-OF-STATUS            PIC X.
  1716
  1717     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1718         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  32
* EL6311.cbl
  1719         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1720         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1721         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1722
  1723     12  AM-BENEFIT-CONTROLS.
  1724         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1725             20  AM-BENEFIT-CODE           PIC XX.
  1726             20  AM-BENEFIT-TYPE           PIC X.
  1727             20  AM-BENEFIT-REVISION       PIC XXX.
  1728             20  AM-BENEFIT-REM-TERM       PIC X.
  1729             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1730             20  FILLER                    PIC XX.
  1731         16  FILLER                        PIC X(80).
  1732
  1733     12  AM-TRANSFER-DATA.
  1734         16  AM-TRANSFERRED-FROM.
  1735             20  AM-TRNFROM-CARRIER        PIC X.
  1736             20  AM-TRNFROM-GROUPING.
  1737                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1738                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1739             20  AM-TRNFROM-STATE          PIC XX.
  1740             20  AM-TRNFROM-ACCOUNT.
  1741                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1742                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1743             20  AM-TRNFROM-DTE            PIC XX.
  1744         16  AM-TRANSFERRED-TO.
  1745             20  AM-TRNTO-CARRIER          PIC X.
  1746             20  AM-TRNTO-GROUPING.
  1747                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1748                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1749             20  AM-TRNTO-STATE            PIC XX.
  1750             20  AM-TRNTO-ACCOUNT.
  1751                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1752                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1753             20  AM-TRNTO-DTE              PIC XX.
  1754         16  FILLER                        PIC X(10).
  1755
  1756     12  AM-SAVED-REMIT-TO                 PIC 99.
  1757
  1758     12  AM-COMM-STRUCTURE-SAVED.
  1759         16  AM-DEFN-1-SAVED.
  1760             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1761                 24  AM-AGT-SV             PIC X(10).
  1762                 24  AM-COM-TYP-SV         PIC X.
  1763                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1764                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1765                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1766                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1767                 24  FILLER                PIC X.
  1768                 24  AM-GL-CODES-SV        PIC X.
  1769                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1770                 24  FILLER                PIC X.
  1771         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1772             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1773                 24  FILLER                PIC X(11).
  1774                 24  AM-L-COMA-SV          PIC XXX.
  1775                 24  AM-J-COMA-SV          PIC XXX.
  1776                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  33
* EL6311.cbl
  1777                 24  FILLER                PIC X(6).
  1778
  1779     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1780         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1781            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1782            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1783            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1784
  1785     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1786     12  FILLER                            PIC X(120).
  1787
  1788     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1789         16  AM-CONTROL-NAME               PIC X(30).
  1790         16  AM-EXECUTIVE-ONE.
  1791             20  AM-EXEC1-NAME             PIC X(15).
  1792             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1793                                                          COMP-3.
  1794             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1795                                                          COMP-3.
  1796         16  AM-EXECUTIVE-TWO.
  1797             20  AM-EXEC2-NAME             PIC X(15).
  1798             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1799                                                          COMP-3.
  1800             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1801                                                          COMP-3.
  1802
  1803     12  AM-RETRO-ADDITIONAL-DATA.
  1804         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1805         16  AM-RETRO-PREM-P-E             PIC X.
  1806         16  AM-RETRO-CLMS-P-I             PIC X.
  1807         16  AM-RETRO-RET-BRACKET-LF.
  1808             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1809                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1810                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1811             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1812                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1813                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1814             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1815                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1816                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1817         16  AM-RETRO-RET-BRACKET-AH.
  1818             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1819                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1820                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1821                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1822             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1823                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1824                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1825             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1826                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1827                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1828
  1829     12  AM-COMMENTS.
  1830         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1831
  1832     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1833         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1834         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  34
* EL6311.cbl
  1835         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1836         16  AM-FLI-UNITED-IDENT           PIC X.
  1837         16  AM-FLI-INTEREST-LOST-DATA.
  1838             20  AM-FLI-BANK-NO            PIC X(5).
  1839             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1840             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1841             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1842         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1843             20  AM-FLI-AGT                PIC X(9).
  1844             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1845             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1846         16  FILLER                        PIC X(102).
  1847
  1848     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1849         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1850             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1851             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1852             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1853             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1854             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1855         16  FILLER                          PIC X(10).
  1856******************************************************************
  1857*                                copy ERCACNT.
  1858******************************************************************
  1859*                                                                *
  1860*                                                                *
  1861*                            ERCACNT.                            *
  1862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1863*                            VMOD=2.002                          *
  1864*                                                                *
  1865*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1869*                                                                *
  1870*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1871*       ALTERNATE INDEX = NONE                                   *
  1872*                                                                *
  1873*                                                                *
  1874*   LOG = YES                                                    *
  1875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1876******************************************************************
  1877*                   C H A N G E   L O G
  1878*
  1879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1880*-----------------------------------------------------------------
  1881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1882* EFFECTIVE    NUMBER
  1883*-----------------------------------------------------------------
  1884* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1885*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1886******************************************************************
  1887 01  NOTE-FILE.
  1888     12  NT-FILE-ID                  PIC XX.
  1889         88  VALID-NOTE-ID              VALUE 'NT'.
  1890
  1891     12  NT-CONTROL-PRIMARY.
  1892         16  NT-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  35
* EL6311.cbl
  1893         16  NT-ACCT-NOTE-KEY.
  1894             18  NT-CARRIER              PIC X.
  1895             18  NT-GROUPING             PIC X(06).
  1896             18  NT-STATE                PIC XX.
  1897             18  NT-ACCOUNT              PIC X(10).
  1898         16  NT-RECORD-TYPE          PIC X.
  1899              88  ACCT-NOTE          VALUE '1'.
  1900              88  ACCT-BRANCH-LOC    VALUE '2'.
  1901              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1902         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1903
  1904     12  NT-LAST-MAINT-DT            PIC XX.
  1905     12  NT-LAST-MAINT-BY            PIC X(4).
  1906     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1907
  1908*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1909*     SEQUENCE NUMBERS
  1910     12  NT-NOTE-INFORMATION.
  1911         16  NT-NOTE-LINE            PIC X(60).
  1912         16  FILLER                  PIC X(25).
  1913*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1914     12  NT-LOCATION-INFORMATION REDEFINES
  1915                         NT-NOTE-INFORMATION.
  1916         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1917         16  FILLER                  PIC X(25).
  1918* Account special indicator is record type '2', sequence 3
  1919     12  filler REDEFINES NT-NOTE-INFORMATION.
  1920         16  nt-account-special      PIC X.
  1921         16  FILLER                  PIC X(84).
  1922*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1923*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1924*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1925*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1926*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1927*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1928*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1929     12  NT-SHIPPING-INFORMATION REDEFINES
  1930                         NT-NOTE-INFORMATION.
  1931         16  NT-SHIPPING-LINE        PIC X(60).
  1932         16  NT-SHIP-STATE           PIC XX.
  1933         16  NT-SHIP-ZIP             PIC X(10).
  1934         16  FILLER                  PIC X(13).
  1935*****************************************************************
  1936*                                COPY ELCVADS.
  1937******************************************************************
  1938*                                                                *
  1939*                                                                *
  1940*                            ELCVADS.                            *
  1941*                                                                *
  1942*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1943*   ELVADS                  LENGTH = 350                         *
  1944******************************************************************
  1945******************************************************************
  1946*                   C H A N G E   L O G
  1947*
  1948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1949*-----------------------------------------------------------------
  1950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  36
* EL6311.cbl
  1951* EFFECTIVE    NUMBER
  1952*-----------------------------------------------------------------
  1953* 100111    2011022800001  AJRA  NAPERSOFT
  1954******************************************************************
  1955
  1956 01  VIRGINIA-DISCLOSURE.
  1957     12  VD-COMPANY-CD              PIC X.
  1958     12  VD-CARRIER                 PIC X.
  1959     12  VD-GROUPING.
  1960         20  VD-GROUPING-PREFIX     PIC XXX.
  1961         20  VD-GROUPING-PRIME      PIC XXX.
  1962     12  VD-STATE                   PIC XX.
  1963     12  VD-ACCOUNT.
  1964         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1965         20  VD-ACCOUNT-PRIME       PIC X(6).
  1966     12  VD-CERT-EFF-DT             PIC XX.
  1967     12  VD-CERT-NO.
  1968         20  VD-CERT-PRIME          PIC X(10).
  1969         20  VD-CERT-SFX            PIC X.
  1970     12  VD-ENTRY-BATCH             PIC X(6).
  1971     12  VD-CSR-ID                  PIC X(4).
  1972     12  VD-NAME.
  1973         20  VD-INSURED-LAST-NAME   PIC X(15).
  1974         20  VD-INSURED-FIRST-NAME.
  1975             24  VD-INSURED-1ST-INIT PIC X.
  1976             24  FILLER             PIC X(9).
  1977         20  VD-INSURED-MIDDLE-INIT PIC X.
  1978     12  VD-JOINT-INSURED.
  1979         20 VD-JOINT-LAST-NAME      PIC X(15).
  1980         20 VD-JOINT-FIRST-NAME.
  1981            24  VD-JOINT-FIRST-INIT PIC X.
  1982            24  FILLER              PIC X(9).
  1983         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1984     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1985     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1986     12  VD-INSURED-CITY-STATE.
  1987         20  VD-INSURED-CITY        PIC X(28).
  1988         20  VD-INSURED-STATE       PIC XX.
  1989     12  VD-INSURED-ZIP-CODE.
  1990         20  VD-INSURED-ZIP-PRIME.
  1991             24  VD-INSURED-ZIP-1   PIC X.
  1992                 88  VD-CANADIAN-POST-CODE
  1993                                       VALUE 'A' THRU 'Z'.
  1994             24  FILLER             PIC X(4).
  1995         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1996     12  VD-BENEFICIARY-NAME        PIC X(30).
  1997     12  VD-ACCOUNT-NAME            PIC X(30).
  1998     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1999     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2000     12  VD-1ST-PMT-DT              PIC XX.
  2001     12  VD-LIFE-BENEFIT-CD         PIC XX.
  2002         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  2003         88  VD-INVALID-LIFE           VALUE '  ' '00'
  2004                                             '90' THRU '99'.
  2005     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  2006                                    PIC XX.
  2007     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2008     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  37
* EL6311.cbl
  2009     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  2010     12  VD-LF-TERM                 PIC S999   COMP-3.
  2011     12  VD-AH-BENEFIT-CD           PIC XX.
  2012         88  VD-VALID-AH               VALUE '01' THRU '89'.
  2013         88  VD-INVALID-AH             VALUE '  ' '00'
  2014                                             '90' THRU '99'.
  2015     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2016     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2017     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2018     12  VD-AH-TERM                 PIC S999   COMP-3.
  2019     12  VD-LETTER-ID               PIC X(4).
  2020     12  VD-PROC-ID                 PIC X(4).
  2021     12  VD-COMP-ID                 PIC X(3).
  2022     12  VD-CURRENT-DATE            PIC XX.
  2023     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2024     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2025     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  38
* EL6311.cbl
  2027*    COPY ELCDATE.
  2028******************************************************************
  2029*                                                                *
  2030*                                                                *
  2031*                            ELCDATE.                            *
  2032*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2033*                            VMOD=2.003
  2034*                                                                *
  2035*                                                                *
  2036*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2037*                 LENGTH = 200                                   *
  2038******************************************************************
  2039
  2040 01  DATE-CONVERSION-DATA.
  2041     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2042     12  DC-OPTION-CODE                PIC X.
  2043         88  BIN-TO-GREG                VALUE ' '.
  2044         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2045         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2046         88  YMD-GREG-TO-BIN            VALUE '3'.
  2047         88  MDY-GREG-TO-BIN            VALUE '4'.
  2048         88  JULIAN-TO-BIN              VALUE '5'.
  2049         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2050         88  FIND-CENTURY               VALUE '7'.
  2051         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2052         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2053         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2054         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2055         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2056         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2057         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2058         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2059         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2060         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2061         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2062         88  BIN-3-TO-GREG              VALUE 'I'.
  2063         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2064         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2065         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2066         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2067         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2068         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2069         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2070         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2071         88  THREE-CHARACTER-BIN
  2072                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2073         88  GREGORIAN-TO-BIN
  2074                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2075         88  BIN-TO-GREGORIAN
  2076                  VALUES ' ' '1' 'I' '8' 'G'.
  2077         88  JULIAN-TO-BINARY
  2078                  VALUES '5' 'C' 'E' 'F'.
  2079     12  DC-ERROR-CODE                 PIC X.
  2080         88  NO-CONVERSION-ERROR        VALUE ' '.
  2081         88  DATE-CONVERSION-ERROR
  2082                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2083         88  DATE-IS-ZERO               VALUE '1'.
  2084         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  39
* EL6311.cbl
  2085         88  DATE-IS-INVALID            VALUE '3'.
  2086         88  DATE1-GREATER-DATE2        VALUE '4'.
  2087         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2088         88  DATE-INVALID-OPTION        VALUE '9'.
  2089         88  INVALID-CENTURY            VALUE 'A'.
  2090         88  ONLY-CENTURY               VALUE 'B'.
  2091         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2092         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2093     12  DC-END-OF-MONTH               PIC X.
  2094         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2095     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2096         88  USE-NORMAL-PROCESS         VALUE ' '.
  2097         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2098         88  ADJUST-UP-100-YRS          VALUE '2'.
  2099     12  FILLER                        PIC X.
  2100     12  DC-CONVERSION-DATES.
  2101         16  DC-BIN-DATE-1             PIC XX.
  2102         16  DC-BIN-DATE-2             PIC XX.
  2103         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2104         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2105                       DC-GREG-DATE-1-EDIT.
  2106             20  DC-EDIT1-MONTH        PIC 99.
  2107             20  SLASH1-1              PIC X.
  2108             20  DC-EDIT1-DAY          PIC 99.
  2109             20  SLASH1-2              PIC X.
  2110             20  DC-EDIT1-YEAR         PIC 99.
  2111         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2112         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2113                     DC-GREG-DATE-2-EDIT.
  2114             20  DC-EDIT2-MONTH        PIC 99.
  2115             20  SLASH2-1              PIC X.
  2116             20  DC-EDIT2-DAY          PIC 99.
  2117             20  SLASH2-2              PIC X.
  2118             20  DC-EDIT2-YEAR         PIC 99.
  2119         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2120         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2121                     DC-GREG-DATE-1-YMD.
  2122             20  DC-YMD-YEAR           PIC 99.
  2123             20  DC-YMD-MONTH          PIC 99.
  2124             20  DC-YMD-DAY            PIC 99.
  2125         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2126         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2127                      DC-GREG-DATE-1-MDY.
  2128             20  DC-MDY-MONTH          PIC 99.
  2129             20  DC-MDY-DAY            PIC 99.
  2130             20  DC-MDY-YEAR           PIC 99.
  2131         16  DC-GREG-DATE-1-ALPHA.
  2132             20  DC-ALPHA-MONTH        PIC X(10).
  2133             20  DC-ALPHA-DAY          PIC 99.
  2134             20  FILLER                PIC XX.
  2135             20  DC-ALPHA-CENTURY.
  2136                 24 DC-ALPHA-CEN-N     PIC 99.
  2137             20  DC-ALPHA-YEAR         PIC 99.
  2138         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2139         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2140         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2141         16  DC-JULIAN-DATE            PIC 9(05).
  2142         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  40
* EL6311.cbl
  2143                                       PIC 9(05).
  2144         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2145             20  DC-JULIAN-YEAR        PIC 99.
  2146             20  DC-JULIAN-DAYS        PIC 999.
  2147         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2148         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2149         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2150     12  DATE-CONVERSION-VARIBLES.
  2151         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2152         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2153             20  FILLER                PIC 9(3).
  2154             20  HOLD-CEN-1-CCYY.
  2155                 24  HOLD-CEN-1-CC     PIC 99.
  2156                 24  HOLD-CEN-1-YY     PIC 99.
  2157             20  HOLD-CEN-1-MO         PIC 99.
  2158             20  HOLD-CEN-1-DA         PIC 99.
  2159         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2160             20  HOLD-CEN-1-R-MO       PIC 99.
  2161             20  HOLD-CEN-1-R-DA       PIC 99.
  2162             20  HOLD-CEN-1-R-CCYY.
  2163                 24  HOLD-CEN-1-R-CC   PIC 99.
  2164                 24  HOLD-CEN-1-R-YY   PIC 99.
  2165             20  FILLER                PIC 9(3).
  2166         16  HOLD-CENTURY-1-X.
  2167             20  FILLER                PIC X(3)  VALUE SPACES.
  2168             20  HOLD-CEN-1-X-CCYY.
  2169                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2170                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2171             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2172             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2173         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2174             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2175             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2176             20  HOLD-CEN-1-R-X-CCYY.
  2177                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2178                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2179             20  FILLER                PIC XXX.
  2180         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2181         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2182         16  DC-JULIAN-DATE-1          PIC 9(07).
  2183         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2184             20  DC-JULIAN-1-CCYY.
  2185                 24  DC-JULIAN-1-CC    PIC 99.
  2186                 24  DC-JULIAN-1-YR    PIC 99.
  2187             20  DC-JULIAN-DA-1        PIC 999.
  2188         16  DC-JULIAN-DATE-2          PIC 9(07).
  2189         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2190             20  DC-JULIAN-2-CCYY.
  2191                 24  DC-JULIAN-2-CC    PIC 99.
  2192                 24  DC-JULIAN-2-YR    PIC 99.
  2193             20  DC-JULIAN-DA-2        PIC 999.
  2194         16  DC-GREG-DATE-A-EDIT.
  2195             20  DC-EDITA-MONTH        PIC 99.
  2196             20  SLASHA-1              PIC X VALUE '/'.
  2197             20  DC-EDITA-DAY          PIC 99.
  2198             20  SLASHA-2              PIC X VALUE '/'.
  2199             20  DC-EDITA-CCYY.
  2200                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  41
* EL6311.cbl
  2201                 24  DC-EDITA-YEAR     PIC 99.
  2202         16  DC-GREG-DATE-B-EDIT.
  2203             20  DC-EDITB-MONTH        PIC 99.
  2204             20  SLASHB-1              PIC X VALUE '/'.
  2205             20  DC-EDITB-DAY          PIC 99.
  2206             20  SLASHB-2              PIC X VALUE '/'.
  2207             20  DC-EDITB-CCYY.
  2208                 24  DC-EDITB-CENT     PIC 99.
  2209                 24  DC-EDITB-YEAR     PIC 99.
  2210         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2211         16  DC-GREG-DATE-CYMD-R REDEFINES
  2212                              DC-GREG-DATE-CYMD.
  2213             20  DC-CYMD-CEN           PIC 99.
  2214             20  DC-CYMD-YEAR          PIC 99.
  2215             20  DC-CYMD-MONTH         PIC 99.
  2216             20  DC-CYMD-DAY           PIC 99.
  2217         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2218         16  DC-GREG-DATE-MDCY-R REDEFINES
  2219                              DC-GREG-DATE-MDCY.
  2220             20  DC-MDCY-MONTH         PIC 99.
  2221             20  DC-MDCY-DAY           PIC 99.
  2222             20  DC-MDCY-CEN           PIC 99.
  2223             20  DC-MDCY-YEAR          PIC 99.
  2224    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2225        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2226    12  DC-EL310-DATE                  PIC X(21).
  2227    12  FILLER                         PIC X(28).
  2228
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  42
* EL6311.cbl
  2230*    COPY ELCLOGOF.
  2231******************************************************************
  2232*                                                                *
  2233*                                                                *
  2234*                            ELCLOGOF.                           *
  2235*                            VMOD=2.001                          *
  2236*                                                                *
  2237*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2238*                                                                *
  2239******************************************************************
  2240 01  CLASIC-LOGOFF.
  2241     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2242     12  LOGOFF-TEXT.
  2243         16  FILLER          PIC X(5)    VALUE SPACES.
  2244         16  LOGOFF-MSG.
  2245             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2246             20  FILLER      PIC X       VALUE SPACES.
  2247             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2248         16  FILLER          PIC X(80)
  2249           VALUE '* YOU ARE NOW LOGGED OFF'.
  2250         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2251         16  FILLER          PIC X       VALUE QUOTE.
  2252         16  LOGOFF-SYS-MSG  PIC X(17)
  2253           VALUE 'S CLAS-IC SYSTEM '.
  2254     12  TEXT-MESSAGES.
  2255         16  UNACCESS-MSG    PIC X(29)
  2256             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2257         16  PGMIDERR-MSG    PIC X(17)
  2258             VALUE 'PROGRAM NOT FOUND'.
  2259
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  43
* EL6311.cbl
  2261*    COPY ELCATTR.
  2262******************************************************************
  2263*                                                                *
  2264*                            ELCATTR.                            *
  2265*                            VMOD=2.001                          *
  2266*                                                                *
  2267*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2268*                                                                *
  2269*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2270*                                                                *
  2271*                   POS 1   P=PROTECTED                          *
  2272*                           U=UNPROTECTED                        *
  2273*                           S=ASKIP                              *
  2274*                   POS 2   A=ALPHA/NUMERIC                      *
  2275*                           N=NUMERIC                            *
  2276*                   POS 3   N=NORMAL                             *
  2277*                           B=BRIGHT                             *
  2278*                           D=DARK                               *
  2279*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2280*                           OF=MODIFIED DATA TAG OFF             *
  2281*                                                                *
  2282*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2283******************************************************************
  2284 01  ATTRIBUTE-LIST.
  2285     12  AL-PABOF            PIC X       VALUE 'Y'.
  2286     12  AL-PABON            PIC X       VALUE 'Z'.
  2287     12  AL-PADOF            PIC X       VALUE '%'.
  2288     12  AL-PADON            PIC X       VALUE '_'.
  2289     12  AL-PANOF            PIC X       VALUE '-'.
  2290     12  AL-PANON            PIC X       VALUE '/'.
  2291     12  AL-SABOF            PIC X       VALUE '8'.
  2292     12  AL-SABON            PIC X       VALUE '9'.
  2293     12  AL-SADOF            PIC X       VALUE '@'.
  2294     12  AL-SADON            PIC X       VALUE QUOTE.
  2295     12  AL-SANOF            PIC X       VALUE '0'.
  2296     12  AL-SANON            PIC X       VALUE '1'.
  2297     12  AL-UABOF            PIC X       VALUE 'H'.
  2298     12  AL-UABON            PIC X       VALUE 'I'.
  2299     12  AL-UADOF            PIC X       VALUE '<'.
  2300     12  AL-UADON            PIC X       VALUE '('.
  2301     12  AL-UANOF            PIC X       VALUE ' '.
  2302     12  AL-UANON            PIC X       VALUE 'A'.
  2303     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2304     12  AL-UNBON            PIC X       VALUE 'R'.
  2305     12  AL-UNDOF            PIC X       VALUE '*'.
  2306     12  AL-UNDON            PIC X       VALUE ')'.
  2307     12  AL-UNNOF            PIC X       VALUE '&'.
  2308     12  AL-UNNON            PIC X       VALUE 'J'.
  2309
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  44
* EL6311.cbl
  2311*    COPY ELCEMIB.
  2312******************************************************************
  2313*                                                                *
  2314*                                                                *
  2315*                            ELCEMIB.                            *
  2316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2317*                            VMOD=2.005                          *
  2318*                                                                *
  2319*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2320*                                                                *
  2321******************************************************************
  2322 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2323     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2324     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2325     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2326     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2327     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2328     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2329     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2330     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2331     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2332         88  EMI-NO-ERRORS                    VALUE '1'.
  2333         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2334         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2335     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2336         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2337     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2338         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2339         88  EMI-AREA1-FULL                   VALUE '2'.
  2340     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2341         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2342         88  EMI-AREA2-FULL                   VALUE '2'.
  2343     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2344         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2345         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2346         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2347         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2348         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2349     12  EMI-ERROR-LINES.
  2350         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2351         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2352         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2353         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2354             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2355                 24  EMI-ERR-NUM         PIC X(4).
  2356                 24  EMI-FILLER          PIC X.
  2357                 24  EMI-SEV             PIC X.
  2358                 24  FILLER              PIC X.
  2359             20  FILLER                  PIC X(02).
  2360     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2361         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2362             20  EMI-ERROR-NUMBER    PIC X(4).
  2363             20  EMI-FILL            PIC X.
  2364             20  EMI-SEVERITY        PIC X.
  2365             20  FILLER              PIC X.
  2366             20  EMI-ERROR-TEXT.
  2367                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2368                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  45
* EL6311.cbl
  2369     12  EMI-SEVERITY-SAVE           PIC X.
  2370         88  EMI-NOTE                    VALUE 'N'.
  2371         88  EMI-WARNING                 VALUE 'W'.
  2372         88  EMI-FORCABLE                VALUE 'F'.
  2373         88  EMI-FATAL                   VALUE 'X'.
  2374     12  EMI-MESSAGE-FLAG            PIC X.
  2375         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2376         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2377     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2378     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2379         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2380         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2381         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2382     12  emi-claim-no                pic x(7).
  2383     12  emi-claim-type              pic x(6).
  2384     12  FILLER                      PIC X(124)  VALUE SPACES.
  2385     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2386     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2387     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2388     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2389
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  46
* EL6311.cbl
  2391*    COPY ELCINTF.
  2392******************************************************************
  2393*                                                                *
  2394*                                                                *
  2395*                            ELCINTF.                            *
  2396*                            VMOD=2.017                          *
  2397*                                                                *
  2398*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2399*                                                                *
  2400*       LENGTH = 1024                                            *
  2401*                                                                *
  2402******************************************************************
  2403*                   C H A N G E   L O G
  2404*
  2405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2406*-----------------------------------------------------------------
  2407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2408* EFFECTIVE    NUMBER
  2409*-----------------------------------------------------------------
  2410* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2411******************************************************************
  2412 01  PROGRAM-INTERFACE-BLOCK.
  2413     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2414     12  PI-CALLING-PROGRAM              PIC X(8).
  2415     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2416     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2417     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2418     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2419     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2420     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2421     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2422     12  PI-COMPANY-ID                   PIC XXX.
  2423     12  PI-COMPANY-CD                   PIC X.
  2424
  2425     12  PI-COMPANY-PASSWORD             PIC X(8).
  2426
  2427     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2428
  2429     12  PI-CONTROL-IN-PROGRESS.
  2430         16  PI-CARRIER                  PIC X.
  2431         16  PI-GROUPING                 PIC X(6).
  2432         16  PI-STATE                    PIC XX.
  2433         16  PI-ACCOUNT                  PIC X(10).
  2434         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2435                                         PIC X(10).
  2436         16  PI-CLAIM-CERT-GRP.
  2437             20  PI-CLAIM-NO             PIC X(7).
  2438             20  PI-CERT-NO.
  2439                 25  PI-CERT-PRIME       PIC X(10).
  2440                 25  PI-CERT-SFX         PIC X.
  2441             20  PI-CERT-EFF-DT          PIC XX.
  2442         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2443             20  PI-PLAN-CODE            PIC X(2).
  2444             20  PI-REVISION-NUMBER      PIC X(3).
  2445             20  PI-PLAN-EFF-DT          PIC X(2).
  2446             20  PI-PLAN-EXP-DT          PIC X(2).
  2447             20  FILLER                  PIC X(11).
  2448         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  47
* EL6311.cbl
  2449             20  PI-OE-REFERENCE-1.
  2450                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2451                 25  PI-OE-REF-1-SUFF    PIC XX.
  2452
  2453     12  PI-SESSION-IN-PROGRESS          PIC X.
  2454         88  CLAIM-SESSION                   VALUE '1'.
  2455         88  CREDIT-SESSION                  VALUE '2'.
  2456         88  WARRANTY-SESSION                VALUE '3'.
  2457         88  MORTGAGE-SESSION                VALUE '4'.
  2458         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2459
  2460
  2461*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2462
  2463     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2464     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2465
  2466     12  PI-CREDIT-USER                  PIC X.
  2467         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2468         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2469
  2470     12  PI-CLAIM-USER                   PIC X.
  2471         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2472         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2473
  2474     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2475         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2476         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2477         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2478         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2479         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2480
  2481     12  PI-PROCESSOR-ID                 PIC X(4).
  2482
  2483     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2484
  2485     12  PI-MEMBER-CAPTION               PIC X(10).
  2486
  2487     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2488         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2489
  2490     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2491     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2492     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2493     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2494
  2495     12  PI-AH-OVERRIDE-L1               PIC X.
  2496     12  PI-AH-OVERRIDE-L2               PIC XX.
  2497     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2498     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2499
  2500     12  PI-NEW-SYSTEM                   PIC X(2).
  2501
  2502     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2503     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2504         88  PI-USES-PAID-TO                 VALUE '1'.
  2505     12  PI-CRDTCRD-SYSTEM.
  2506         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  48
* EL6311.cbl
  2507             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2508             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2509         16  PI-CC-MONTH-END-DT          PIC XX.
  2510     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2511
  2512     12  PI-OE-REFERENCE-2.
  2513         16  PI-OE-REF-2-PRIME           PIC X(10).
  2514         16  PI-OE-REF-2-SUFF            PIC X.
  2515
  2516     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2517
  2518     12  PI-LANGUAGE-TYPE                PIC X.
  2519             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2520             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2521             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2522
  2523     12  PI-POLICY-LINKAGE-IND           PIC X.
  2524         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2525         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2526                                                   LOW-VALUES.
  2527
  2528     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2529     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2530         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2531         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2532
  2533     12  PI-PROCESSOR-CSR-IND            PIC X.
  2534         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2535         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2536
  2537     12  FILLER                          PIC X(3).
  2538
  2539     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2540
  2541     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2542         PI-SYSTEM-LEVEL.
  2543
  2544         16  PI-ENTRY-CODES.
  2545             20  PI-ENTRY-CD-1           PIC X.
  2546             20  PI-ENTRY-CD-2           PIC X.
  2547
  2548         16  PI-RETURN-CODES.
  2549             20  PI-RETURN-CD-1          PIC X.
  2550             20  PI-RETURN-CD-2          PIC X.
  2551
  2552         16  PI-UPDATE-STATUS-SAVE.
  2553             20  PI-UPDATE-BY            PIC X(4).
  2554             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2555
  2556         16  PI-LOWER-CASE-LETTERS       PIC X.
  2557             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2558
  2559*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2560*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2561*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2562
  2563         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2564             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  49
* EL6311.cbl
  2565             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2566             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2567             88  ACCNT-CNTL                  VALUE '3'.
  2568             88  CARR-ACCNT-CNTL             VALUE '4'.
  2569
  2570         16  PI-PROCESSOR-CAP-LIST.
  2571             20  PI-SYSTEM-CONTROLS.
  2572                24 PI-SYSTEM-DISPLAY     PIC X.
  2573                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2574                24 PI-SYSTEM-MODIFY      PIC X.
  2575                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2576             20  FILLER                  PIC XX.
  2577             20  PI-DISPLAY-CAP          PIC X.
  2578                 88  DISPLAY-CAP             VALUE 'Y'.
  2579             20  PI-MODIFY-CAP           PIC X.
  2580                 88  MODIFY-CAP              VALUE 'Y'.
  2581             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2582                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2583             20  PI-FORCE-CAP            PIC X.
  2584                 88  FORCE-CAP               VALUE 'Y'.
  2585
  2586         16  PI-PROGRAM-CONTROLS.
  2587             20  PI-PGM-PRINT-OPT        PIC X.
  2588             20  PI-PGM-FORMAT-OPT       PIC X.
  2589             20  PI-PGM-PROCESS-OPT      PIC X.
  2590             20  PI-PGM-TOTALS-OPT       PIC X.
  2591
  2592         16  PI-HELP-INTERFACE.
  2593             20  PI-LAST-ERROR-NO        PIC X(4).
  2594             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2595
  2596         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2597             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2598
  2599         16  PI-CR-CONTROL-IN-PROGRESS.
  2600             20  PI-CR-CARRIER           PIC X.
  2601             20  PI-CR-GROUPING          PIC X(6).
  2602             20  PI-CR-STATE             PIC XX.
  2603             20  PI-CR-ACCOUNT           PIC X(10).
  2604             20  PI-CR-FIN-RESP          PIC X(10).
  2605             20  PI-CR-TYPE              PIC X.
  2606
  2607         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2608
  2609         16  PI-CR-MONTH-END-DT          PIC XX.
  2610
  2611         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2612             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2613             88  PI-ZERO-CARRIER             VALUE '1'.
  2614             88  PI-ZERO-GROUPING            VALUE '2'.
  2615             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2616
  2617         16  PI-CARRIER-SECURITY         PIC X.
  2618             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2619
  2620         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2621             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2622             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  50
* EL6311.cbl
  2623
  2624         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2625             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2626                                         INDEXED BY PI-ACCESS-NDX
  2627                                         PIC X.
  2628
  2629         16  PI-GA-BILLING-CONTROL       PIC X.
  2630             88  PI-GA-BILLING               VALUE '1'.
  2631
  2632         16  PI-MAIL-PROCESSING          PIC X.
  2633             88  PI-MAIL-YES                 VALUE 'Y'.
  2634
  2635         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2636
  2637         16  PI-AR-SYSTEM.
  2638             20  PI-AR-PROCESSING-CNTL   PIC X.
  2639                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2640             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2641             20  PI-AR-MONTH-END-DT      PIC XX.
  2642
  2643         16  PI-MP-SYSTEM.
  2644             20  PI-MORTGAGE-USER            PIC X.
  2645                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2646                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2647             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2648                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2649                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2650                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2651                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2652                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2653             20  PI-MP-MONTH-END-DT          PIC XX.
  2654             20  PI-MP-REFERENCE-NO.
  2655                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2656                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2657
  2658         16  PI-LABEL-CONTROL            PIC X(01).
  2659             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2660             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2661
  2662         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2663             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2664
  2665         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2666             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2667             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2668
  2669         16  FILLER                      PIC X(14).
  2670
  2671     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2672******************************************************************
  2673
  2674     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2675*    COPY ELC631PI.
  2676******************************************************************
  2677*                                                                *
  2678*                                                                *
  2679*                            ELC631PI                            *
  2680*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  51
* EL6311.cbl
  2681*                                                                *
  2682*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2683*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2684*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2685*                                                                *
  2686*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2687*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2688*    BETWEEN PROGRAMS.                                           *
  2689*                                                                *
  2690*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2691*                                                                *
  2692*               EL631 - EL6311 - EL6312 - EL6313                 *
  2693*                                                                *
  2694******************************************************************
  2695*                   C H A N G E   L O G
  2696*
  2697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2698*-----------------------------------------------------------------
  2699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2700* EFFECTIVE    NUMBER
  2701*-----------------------------------------------------------------
  2702* 021414    2003053000001  PEMA  changes for auto chk request
  2703******************************************************************
  2704
  2705         16  PI-631-DATA.
  2706             20  PI-ERPNDB-KEY.
  2707                 24  PI-PB-COMPANY-CD     PIC X.
  2708                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2709                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2710                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2711
  2712             20  PI-ERPNDB-ALT-KEY.
  2713                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2714                 24  PI-PB-CARRIER        PIC X.
  2715                 24  PI-PB-GROUPING       PIC X(6).
  2716                 24  PI-PB-STATE          PIC XX.
  2717                 24  PI-PB-ACCOUNT        PIC X(10).
  2718                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2719                 24  PI-PB-CERT-NO.
  2720                     28  PI-PB-CERT-PRIME PIC X(10).
  2721                     28  PI-PB-CERT-SFX   PIC X.
  2722                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2723                 24  PI-PB-RECORD-TYPE    PIC X.
  2724
  2725             20  PI-ERPNDB-CSR-KEY.
  2726                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2727                 24  PI-PB-CSR-ID             PIC X(4).
  2728                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2729                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2730                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2731
  2732             20  PI-BROWSE-TYPE               PIC X.
  2733                 88  PI-FILE-BROWSE             VALUE ' '.
  2734                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2735                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2736                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2737                 88  PI-CSR-BROWSE              VALUE '4'.
  2738
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  52
* EL6311.cbl
  2739             20  PI-MAINT-FUNCTION            PIC X.
  2740                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2741                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2742                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2743                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2744                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2745                 88  PI-PF5-FUNCTION            VALUE '5'.
  2746                 88  PI-PF6-FUNCTION            VALUE '6'.
  2747
  2748             20  PI-FILE-SWITCHES.
  2749                 24  PI-ALL-ISSUES-SW         PIC X.
  2750                     88  ALL-ISSUES             VALUE 'Y'.
  2751                 24  PI-ALL-CANCELS-SW        PIC X.
  2752                     88  ALL-CANCELS            VALUE 'Y'.
  2753                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2754                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2755                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2756                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2757                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2758                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2759                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2760                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2761                 24  PI-HOLD-REC-SW           PIC X.
  2762                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2763                 24  PI-CHANGE-REC-SW         PIC X.
  2764                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2765                 24  PI-CHK-REQ-REC-SW        PIC X.
  2766                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2767                 24  PI-ISSUE-WARNING-SW      PIC X.
  2768                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2769                 24  PI-CANCEL-WARNING-SW     PIC X.
  2770                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2771             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2772                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2773             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2774                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2775
  2776             20  PI-MAP-NAME                  PIC X(8).
  2777
  2778             20  PI-CURSOR                    PIC S9(4) COMP.
  2779
  2780             20  PI-PREV-ALT-KEY              PIC X(36).
  2781             20  PI-PREV-CSR-KEY              PIC X(15).
  2782             20  PI-PREV-KEY.
  2783                 24  PI-PREV-COMPANY-CD       PIC X.
  2784                 24  PI-PREV-BATCH            PIC X(6).
  2785                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2786                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2787             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2788             20  PI-BROWSE-SW                 PIC X.
  2789                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2790                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2791             20  PI-SV-CARRIER                PIC X.
  2792             20  PI-SV-GROUPING               PIC X(6).
  2793             20  PI-SV-STATE                  PIC XX.
  2794             20  PI-EDIT-SW                   PIC X.
  2795             20  PI-DISPLAY-SW                PIC XX.
  2796                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  53
* EL6311.cbl
  2797                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2798             20  PI-CRITERIA-DATA             PIC X(350).
  2799             20  PI-BMODE                     PIC X.
  2800             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2801             20  PI-BPMTS                     PIC S999     COMP-3.
  2802             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2803             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2804             20  PI-CSR-SESSION-SW            PIC X.
  2805                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2806             20  PI-ERRORS-SW                 PIC X.
  2807                 88  FATAL-ERRORS               VALUE 'X'.
  2808*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2809             20  pi-unforced-sw               pic x.
  2810                 88  unforced-errors            value 'X'.
  2811             20  FILLER                       PIC X(4).
  2812
  2813        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2814        16  FILLER             PIC X(92).
  2815
  2816 01  W-LETTER-COMMUNICATION-AREAS.
  2817*    COPY ELC1042.
  2818******************************************************************
  2819*                                                                *
  2820*                                                                *
  2821*                           ELC1042                              *
  2822*                            VMOD=2.002                          *
  2823*                                                                *
  2824*    NOTE                                                        *
  2825*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2826*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2827*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2828*        TO THESE PROGRAMS.                                      *
  2829*                                                                *
  2830*    NOTE                                                        *
  2831*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2832*        USE ONLY!                                               *
  2833*                                                                *
  2834******************************************************************
  2835
  2836         16  PI-1042-WA.
  2837             20  PI-ACTION       PIC  X(01).
  2838                 88 PI-SHOW-MODE           VALUE '1'.
  2839                 88 PI-CLEAR-MODE          VALUE '2'.
  2840                 88 PI-CREATE-MODE         VALUE '3'.
  2841             20  PI-COMM-CONTROL PIC  X(12).
  2842             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2843             20  PI-EOF-SW       PIC  X(01).
  2844                 88  PI-FILE-EOF           VALUE 'Y'.
  2845             20  PI-FILETYP      PIC  X(01).
  2846             20  PI-FORM-SQUEEZE-CONTROL
  2847                                 PIC  X(01).
  2848                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2849                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2850             20  PI-LAST-CONTROL PIC  X(12).
  2851             20  PI-TEMP-STOR-ITEMS
  2852                                 PIC S9(04) COMP.
  2853             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2854             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  54
* EL6311.cbl
  2855                 88 ANY-UPDATES            VALUE 1.
  2856             20  PI-104-SCREEN-SENT-IND
  2857                                 PIC  X(01).
  2858                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2859                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2860             20  PI-1042-SCREEN-SENT-IND
  2861                                 PIC  X(01).
  2862                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2863                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2864             20  PI-1042-ARCHIVE-IND
  2865                                 PIC  X(01).
  2866                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2867             20  FILLER          PIC  X(29).
  2868*    COPY ELC689PI.
  2869******************************************************************
  2870*                                                                *
  2871*                            ELC689PI                            *
  2872*                            VMOD=2.003                          *
  2873*                                                                *
  2874*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2875*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2876*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2877*                                                                *
  2878*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2879*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2880*    BETWEEN PROGRAMS.                                           *
  2881*                                                                *
  2882*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2883*                                                                *
  2884*               EL631 - EL689  - EL6891 - EL6892                 *
  2885*                                                                *
  2886******************************************************************
  2887*                   C H A N G E   L O G
  2888*
  2889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2890*-----------------------------------------------------------------
  2891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2892* EFFECTIVE    NUMBER
  2893*-----------------------------------------------------------------
  2894* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2895* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2896* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2897******************************************************************
  2898
  2899
  2900         16  PI-689-WORK-AREA.
  2901             20  PI-689-ALT-PRINTER-ID
  2902                                 PIC  X(04).
  2903             20  PI-689-ARCHIVE-NUMBER
  2904                                 PIC  9(08).
  2905             20  PI-689-ARCHIVE-SW
  2906                                 PIC  X(01).
  2907                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2908             20  PI-689-DATA-SOURCE
  2909                                 PIC  X(01).
  2910                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2911                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2912                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  55
* EL6311.cbl
  2913                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2914                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2915             20  PI-689-ERROR-IND
  2916                                 PIC  X(01).
  2917                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2918             20  PI-689-ERROR    PIC  9(04).
  2919                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2920                 88  PI-689-FATAL-ERROR
  2921                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2922                            0042 0047 0051 0066 0067 0070
  2923                            0168 0169 0174 0175 0176 0177 0179
  2924                            0180 0181 0182 0184 0185 0189 0190
  2925                            0191
  2926                            0215 0279 0280
  2927                            0412 0413 0454
  2928                            0533 0537
  2929                            2055 2114 2208 2209 2216 2232 2369
  2930                            2398 2433 2908 2999
  2931                            3000 3770 3771 3775
  2932                            7250 7365 7367 7368 7369 7370 7371
  2933                            7272 7373 7374 7376 7377 7378 7379
  2934                            7381 7388 7390 7393 7395 7396 7398
  2935                            9095 9096 9281 9298 9299 9320 9327
  2936                            9426 9427.
  2937                 88  PI-689-STOP-ERROR
  2938                     VALUES 0004 0008 0013 0023 0029 0033
  2939                            0042 0047 0066 0067 0070
  2940                            0168 0169 0174 0175 0176 0177
  2941                            0181 0182 0184 0185 0189 0190
  2942                            0279 0280
  2943                            0412 0413 0454
  2944                            2055 2208 2209 2216 2232
  2945                            2398 2999
  2946                            3000 3770 3771 3775
  2947                            7250 7365 7369 7370 7371
  2948                            7272 7373 7374 7376 7377 7378 7379
  2949                            7381 7388 7390 7393 7396 7398
  2950                            9095 9096 9299 9320 9426.
  2951             20  PI-689-FOLLOW-UP-DATE
  2952                                 PIC  X(02).
  2953             20  PI-689-FORM-NUMBER
  2954                                 PIC  X(04).
  2955             20  PI-689-LABEL-SOURCE
  2956                                 PIC X(01).
  2957                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2958                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2959                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2960                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2961                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2962                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2963                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2964             20  PI-689-NUMBER-COPIES
  2965                                 PIC  9(01).
  2966             20  PI-689-NUMBER-LABEL-LINES
  2967                                 PIC  9(01).
  2968             20  PI-689-NUMBER-TEXT-RECORDS
  2969                                 PIC  9(03).
  2970             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  56
* EL6311.cbl
  2971                                 PIC  X(01).
  2972                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2973                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2974                 88  PI-689-PRINT-LATER     VALUE '3'.
  2975                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2976             20  PI-689-PRINT-RESTRICTION
  2977                                 PIC  X(01).
  2978                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2979                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2980                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2981             20  PI-689-PRINT-SW PIC  X(01).
  2982                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2983             20  PI-689-RESEND-DATE-1
  2984                                 PIC  X(02).
  2985             20  PI-689-RESEND-LETR-1
  2986                                 PIC X(4).
  2987             20  PI-689-TEMP-STOR-ID
  2988                                 PIC  X(08).
  2989             20  PI-689-USE-SCREEN-IND
  2990                                 PIC  X(01).
  2991                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2992             20  PI-689-ARCH-POINTER
  2993                                 PIC S9(08) COMP.
  2994                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2995             20  PI-689-ARCT-POINTER
  2996                                 PIC S9(08) COMP.
  2997                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2998             20  PI-689-VARIABLE-DATA-GRP.
  2999                 24  PI-689-VARIABLE-DATA-1
  3000                                 PIC  X(30).
  3001                 24  PI-689-VARIABLE-DATA-2
  3002                                 PIC  X(30).
  3003                 24  PI-689-VARIABLE-DATA-3
  3004                                 PIC  X(30).
  3005                 24  PI-689-VARIABLE-DATA-4
  3006                                 PIC  X(30).
  3007
  3008         16  PI-689-KEY-DATA-FIELDS.
  3009             20  PI-689-ACCOUNT  PIC  X(10).
  3010             20  PI-689-CARRIER  PIC  X(01).
  3011             20  PI-689-CERT-NO.
  3012                 24  PI-689-CERT-PRIME
  3013                                 PIC  X(10).
  3014                 24  PI-689-CERT-SFX
  3015                                 PIC  X(01).
  3016             20  PI-689-CHG-SEQ-NO
  3017                                 PIC S9(04)    COMP.
  3018             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3019                                 PIC  X(02).
  3020             20  PI-689-ENTRY-BATCH
  3021                                 PIC  X(06).
  3022             20  PI-689-EFF-DATE PIC  X(02).
  3023             20  PI-689-EXP-DATE PIC  X(02).
  3024             20  PI-689-GROUPING PIC  X(06).
  3025             20  PI-689-RESP-PERSON
  3026                                 PIC  X(10).
  3027             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3028             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  57
* EL6311.cbl
  3029                                 PIC  X(04).
  3030             20  PI-689-STATE    PIC  X(02).
  3031             20  PI-689-TYPE     PIC  X(01).
  3032             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3033             20  PI-689-ALT-SEQ-NO
  3034                                 PIC S9(04)    COMP.
  3035         16  PI-689-DATE-EDIT    PIC  X(08).
  3036         16  PI-689-FOLLOW-UP-EDIT
  3037                                 PIC  X(08).
  3038         16  PI-689-RESEND1-EDIT PIC  X(08).
  3039         16  PI-689-SEQ-EDIT     PIC  X(08).
  3040         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3041         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3042             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3043         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3044         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  58
* EL6311.cbl
  3046
  3047 01  WS-EL6315-PASS-AREA.
  3048        16  PI-6315-ISS-CAN-SW      PIC X.
  3049        16  FILLER                  PIC X(120).
  3050        16  PI-RES-REF-CLM-TYPE     PIC X.
  3051        16  FILLER                  PIC X.
  3052        16  PI-6315-PASS-AREA.
  3053            20 FILLER               PIC X(236).
  3054            20 PI-6315-FINALIZED    PIC X.
  3055            20 FILLER               PIC X(280).
  3056
  3057 01  WS-EL6316-PASS-AREA.
  3058        16  PI-ISS-CAN-SW           PIC X.
  3059        16  FILLER                  PIC X(121).
  3060        16  PI-CLM-RESC-IND         PIC X.
  3061        16  PI-6316-PASS-AREA.
  3062            20 FILLER               PIC X(236).
  3063            20 PI-6316-FINALIZED    PIC X.
  3064            20 FILLER               PIC X(280).
  3065
  3066******************************************************************
  3067*                                                                *
  3068*         P A S S   A R E A   F O R   E D I T                    *
  3069*                                                                *
  3070******************************************************************
  3071
  3072 01  PASSED-RECORD.
  3073     12  RECORD-SAVE                  PIC X(585).
  3074* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3075*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3076*                    BY  WK-CURRENT-DATE.
  3077******************************************************************
  3078*                                                                *
  3079*                                                                *
  3080*                             ELC50W1                            *
  3081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3082*                            VMOD=2.004                          *
  3083*                                                                *
  3084*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3085*                                                                *
  3086*                                                                *
  3087******************************************************************
  3088
  3089     12  WK-WORK-AREA.
  3090         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3091         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3092         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3093         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3094         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3095         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3096         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3097         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3098         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3099         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3100         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3101         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3102         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3103         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  59
* EL6311.cbl
  3104         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3105         16  WK-CREDIT-EDIT-CONTROLS.
  3106             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3107             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3108             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3109             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3110             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3111             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3112         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3113         16  WK-SAVE-REIN-DATA.
  3114             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3115             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3116             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3117         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3118             88  ENTRY-FROM-EL6311       VALUE '6'.
  3119         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3120         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3121     12  WK-RECORD-ADDRESSES.
  3122         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3123         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3124         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3125         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3126         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3127         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3128         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3129         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3130     12  WK-OVER-SHORT-AREA.
  3131         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3132         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3133         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3134             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3135         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  60
* EL6311.cbl
  3137
  3138*    COPY ELCEDITC.
  3139******************************************************************
  3140*                                                                *
  3141*                                                                *
  3142*                            ELCEDITC                            *
  3143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3144*                            VMOD=2.012                          *
  3145*                                                                *
  3146*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3147*                     EL6313, EL050 AND EL517.                   *
  3148*                                                                *
  3149******************************************************************
  3150******************************************************************
  3151*                   C H A N G E   L O G
  3152*
  3153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3154*-----------------------------------------------------------------
  3155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3156* EFFECTIVE    NUMBER
  3157*-----------------------------------------------------------------
  3158* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3159******************************************************************
  3160
  3161     12  EDIT-CRITERIA-DATA.
  3162         16  EC-CO-MONTH-END-DT       PIC XX.
  3163         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3164         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3165         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3166         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3167         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3168         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3169         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3170         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3171         16  EC-CO-REM-TERM-CALC      PIC X.
  3172               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3173               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3174               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3175               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3176
  3177         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3178               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3179               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3180               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3181               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3182               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3183               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3184               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3185               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3186               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3187               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3188
  3189         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3190               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3191               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3192               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3193               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3194               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  61
* EL6311.cbl
  3195               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3196               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3197               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3198
  3199         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3200                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3201                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3202
  3203         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3204                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3205                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3206                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3207                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3208                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3209                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3210                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3211                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3212
  3213         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3214               88  EC-BR-REDUCING                   VALUE 'R'.
  3215               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3216
  3217         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3218         16  EC-BR-LF-DESC             PIC X(10).
  3219         16  EC-BR-AH-DESC             PIC X(10).
  3220         16  EC-BR-LF-COMMENT          PIC X(10).
  3221         16  EC-BR-AH-COMMENT          PIC X(10).
  3222
  3223         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3224               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3225               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3226               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3227               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3228
  3229         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3230               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3231               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3232               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3233               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3234
  3235         16  EC-BR-LF-REFUND-CALC      PIC X.
  3236                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3237                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3238                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3239                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3240                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3241                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3242                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3243
  3244         16  EC-BR-AH-REFUND-CALC      PIC X.
  3245                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3246                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3247                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3248                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3249                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3250                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3251                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3252                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  62
* EL6311.cbl
  3253
  3254         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3255                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3256                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3257                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3258
  3259         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3260                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3261                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3262                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3263
  3264         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3265         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3266         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3267         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3268
  3269         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3270         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3271                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3272                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3273                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3274                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3275
  3276         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3277               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3278               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3279               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3280               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3281               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3282
  3283         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3284               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3285               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3286               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3287               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3288               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3289
  3290         16  EC-ST-LF-REFUND-CALC      PIC X.
  3291                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3292                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3293                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3294                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3295                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3296                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3297                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3298                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3299
  3300         16  EC-ST-AH-REFUND-CALC      PIC X.
  3301                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3302                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3303                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3304                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3305                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3306                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3307                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3308                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3309
  3310         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  63
* EL6311.cbl
  3311         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3312         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3313         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3314         16  EC-AM-EXPIRATION-DT       PIC XX.
  3315         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3316         16  EC-AM-CLASS-CD            PIC XX.
  3317         16  EC-AM-LF-DEVIATION        PIC XXX.
  3318         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3319         16  EC-AM-AH-DEVIATION        PIC XXX.
  3320         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3321         16  EC-AM-PHONE-NO            PIC X(10).
  3322
  3323         16  EC-AM-LF-REFUND-CALC      PIC X.
  3324                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3325                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3326                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3327                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3328                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3329                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3330                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3331
  3332         16  EC-AM-AH-REFUND-CALC      PIC X.
  3333                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3334                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3335                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3336                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3337                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3338                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3339                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3340
  3341         16  EC-AM-BEN-I-G-CD          PIC X.
  3342                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3343                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3344                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3345
  3346         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3347         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3348         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3349         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3350         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3351         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3352         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3353         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3354         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3355
  3356         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3357         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3358         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3359         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3360         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3361         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3362         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3363         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3364         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3365         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3366         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3367         16  EC-RT-LF-NSP-ST           PIC XX.
  3368         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  64
* EL6311.cbl
  3369         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3370         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3371
  3372         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3373             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3374                                             'M' '5' '9' '2'.
  3375             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3376             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3377             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3378             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3379             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3380             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3381             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3382             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3383             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3384             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3385
  3386         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3387             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3388                                             'M' '5' '9' '2'.
  3389             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3390             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3391             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3392             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3393             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3394             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3395             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3396             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3397             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3398             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3399
  3400         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3401         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3402         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3403         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3404         16  EC-CM-DEATH-DT            PIC XX.
  3405
  3406*DMD CUSTOM CODING FIELDS BELOW
  3407*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3408         16  EC-BR-DMD-RATING-SW       PIC X.
  3409                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3410                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3411                 88  NO-DMD-RATING               VALUE 'N'.
  3412
  3413         16  EC-NEW-CERT               PIC X(11).
  3414         16  EC-NEW-STATE              PIC XX.
  3415         16  FILLER                    PIC X.
  3416*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3417         16  OVER-SHORT-EDIT-FIELDS.
  3418             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3419             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3420             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3421             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3422             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3423             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3424             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3425             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3426             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  65
* EL6311.cbl
  3427         16  FILLER                    PIC X(71).
  3428
  3429******************************************************************
  3430
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  66
* EL6311.cbl
  3432
  3433*    COPY ELCJPFX.
  3434******************************************************************
  3435*                                                                *
  3436*                                                                *
  3437*                            ELCJPFX.                            *
  3438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3439*                            VMOD=2.002                          *
  3440*                                                                *
  3441*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3442*                                                                *
  3443*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3444*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3445*        ELCNTL - CONTROL FILE                                   *
  3446*        ELMSTR - CLAIM MASTERS                                  *
  3447*        ELTRLR - ACTIVITY TRAILERS                              *
  3448*        ELCHKQ - CHECK QUE                                      *
  3449******************************************************************
  3450 01  JOURNAL-RECORD.
  3451     12  jp-date                     pic s9(5) comp-3.
  3452     12  jp-time                     pic s9(7) comp-3.
  3453     12  JP-USER-ID                  PIC X(4).
  3454     12  JP-FILE-ID                  PIC X(8).
  3455     12  JP-PROGRAM-ID               PIC X(8).
  3456     12  JP-RECORD-TYPE              PIC X.
  3457         88 JP-ADD              VALUE 'A'.
  3458         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3459         88 JP-AFTER-CHANGE     VALUE 'C'.
  3460         88 JP-DELETE           VALUE 'D'.
  3461         88 JP-GENERIC-DELETE   VALUE 'G'.
  3462         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3463         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3464     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3465     12  JP-RECORD-AREA
  3466
  3467
  3468                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  67
* EL6311.cbl
  3470*    COPY ELCAID.
  3471******************************************************************
  3472*                                                                *
  3473*                            ELCAID.                             *
  3474*                            VMOD=2.001                          *
  3475*                                                                *
  3476*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3477*                                                                *
  3478*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3479*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3480******************************************************************
  3481
  3482 01  DFHAID.
  3483   02  DFHNULL   PIC  X  VALUE  ' '.
  3484   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3485   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3486   02  DFHPEN    PIC  X  VALUE  '='.
  3487   02  DFHOPID   PIC  X  VALUE  'W'.
  3488   02  DFHPA1    PIC  X  VALUE  '%'.
  3489   02  DFHPA2    PIC  X  VALUE  '>'.
  3490   02  DFHPA3    PIC  X  VALUE  ','.
  3491   02  DFHPF1    PIC  X  VALUE  '1'.
  3492   02  DFHPF2    PIC  X  VALUE  '2'.
  3493   02  DFHPF3    PIC  X  VALUE  '3'.
  3494   02  DFHPF4    PIC  X  VALUE  '4'.
  3495   02  DFHPF5    PIC  X  VALUE  '5'.
  3496   02  DFHPF6    PIC  X  VALUE  '6'.
  3497   02  DFHPF7    PIC  X  VALUE  '7'.
  3498   02  DFHPF8    PIC  X  VALUE  '8'.
  3499   02  DFHPF9    PIC  X  VALUE  '9'.
  3500   02  DFHPF10   PIC  X  VALUE  ':'.
  3501   02  DFHPF11   PIC  X  VALUE  '#'.
  3502   02  DFHPF12   PIC  X  VALUE  '@'.
  3503   02  DFHPF13   PIC  X  VALUE  'A'.
  3504   02  DFHPF14   PIC  X  VALUE  'B'.
  3505   02  DFHPF15   PIC  X  VALUE  'C'.
  3506   02  DFHPF16   PIC  X  VALUE  'D'.
  3507   02  DFHPF17   PIC  X  VALUE  'E'.
  3508   02  DFHPF18   PIC  X  VALUE  'F'.
  3509   02  DFHPF19   PIC  X  VALUE  'G'.
  3510   02  DFHPF20   PIC  X  VALUE  'H'.
  3511   02  DFHPF21   PIC  X  VALUE  'I'.
  3512*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3513   02  DFHPF22   PIC  X  VALUE  '['.
  3514   02  DFHPF23   PIC  X  VALUE  '.'.
  3515   02  DFHPF24   PIC  X  VALUE  '<'.
  3516   02  DFHMSRE   PIC  X  VALUE  'X'.
  3517   02  DFHSTRF   PIC  X  VALUE  'h'.
  3518   02  DFHTRIG   PIC  X  VALUE  '"'.
  3519
  3520 01  FILLER    REDEFINES DFHAID.
  3521     12  FILLER              PIC X(8).
  3522     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3523
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  68
* EL6311.cbl
  3525*    COPY EL6311S.
  3526 01  EL631BI.
  3527     05  FILLER            PIC  X(0012).
  3528*    -------------------------------
  3529     05  BDATEL PIC S9(0004) COMP.
  3530     05  BDATEF PIC  X(0001).
  3531     05  FILLER REDEFINES BDATEF.
  3532         10  BDATEA PIC  X(0001).
  3533     05  BDATEI PIC  X(0008).
  3534*    -------------------------------
  3535     05  BTIMEL PIC S9(0004) COMP.
  3536     05  BTIMEF PIC  X(0001).
  3537     05  FILLER REDEFINES BTIMEF.
  3538         10  BTIMEA PIC  X(0001).
  3539     05  BTIMEI PIC  X(0005).
  3540*    -------------------------------
  3541     05  BHEADL PIC S9(0004) COMP.
  3542     05  BHEADF PIC  X(0001).
  3543     05  FILLER REDEFINES BHEADF.
  3544         10  BHEADA PIC  X(0001).
  3545     05  BHEADI PIC  X(0038).
  3546*    -------------------------------
  3547     05  BNCERTLL PIC S9(0004) COMP.
  3548     05  BNCERTLF PIC  X(0001).
  3549     05  FILLER REDEFINES BNCERTLF.
  3550         10  BNCERTLA PIC  X(0001).
  3551     05  BNCERTLI PIC  X(0008).
  3552*    -------------------------------
  3553     05  BNCERTL PIC S9(0004) COMP.
  3554     05  BNCERTF PIC  X(0001).
  3555     05  FILLER REDEFINES BNCERTF.
  3556         10  BNCERTA PIC  X(0001).
  3557     05  BNCERTI PIC  X(0011).
  3558*    -------------------------------
  3559     05  BNSTATLL PIC S9(0004) COMP.
  3560     05  BNSTATLF PIC  X(0001).
  3561     05  FILLER REDEFINES BNSTATLF.
  3562         10  BNSTATLA PIC  X(0001).
  3563     05  BNSTATLI PIC  X(0009).
  3564*    -------------------------------
  3565     05  BNSTATL PIC S9(0004) COMP.
  3566     05  BNSTATF PIC  X(0001).
  3567     05  FILLER REDEFINES BNSTATF.
  3568         10  BNSTATA PIC  X(0001).
  3569     05  BNSTATI PIC  X(0002).
  3570*    -------------------------------
  3571     05  BCHGTL PIC S9(0004) COMP.
  3572     05  BCHGTF PIC  X(0001).
  3573     05  FILLER REDEFINES BCHGTF.
  3574         10  BCHGTA PIC  X(0001).
  3575     05  BCHGTI PIC  X(0004).
  3576*    -------------------------------
  3577     05  BCHGL PIC S9(0004) COMP.
  3578     05  BCHGF PIC  X(0001).
  3579     05  FILLER REDEFINES BCHGF.
  3580         10  BCHGA PIC  X(0001).
  3581     05  BCHGI PIC  X(0004).
  3582*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  69
* EL6311.cbl
  3583     05  BCOMPIDL PIC S9(0004) COMP.
  3584     05  BCOMPIDF PIC  X(0001).
  3585     05  FILLER REDEFINES BCOMPIDF.
  3586         10  BCOMPIDA PIC  X(0001).
  3587     05  BCOMPIDI PIC  X(0003).
  3588*    -------------------------------
  3589     05  BREGIONL PIC S9(0004) COMP.
  3590     05  BREGIONF PIC  X(0001).
  3591     05  FILLER REDEFINES BREGIONF.
  3592         10  BREGIONA PIC  X(0001).
  3593     05  BREGIONI PIC  X(0006).
  3594*    -------------------------------
  3595     05  BUSERL PIC S9(0004) COMP.
  3596     05  BUSERF PIC  X(0001).
  3597     05  FILLER REDEFINES BUSERF.
  3598         10  BUSERA PIC  X(0001).
  3599     05  BUSERI PIC  X(0004).
  3600*    -------------------------------
  3601     05  BMAINTL PIC S9(0004) COMP.
  3602     05  BMAINTF PIC  X(0001).
  3603     05  FILLER REDEFINES BMAINTF.
  3604         10  BMAINTA PIC  X(0001).
  3605     05  BMAINTI PIC  X(0001).
  3606*    -------------------------------
  3607     05  BMANTBYL PIC S9(0004) COMP.
  3608     05  BMANTBYF PIC  X(0001).
  3609     05  FILLER REDEFINES BMANTBYF.
  3610         10  BMANTBYA PIC  X(0001).
  3611     05  BMANTBYI PIC  X(0004).
  3612*    -------------------------------
  3613     05  BCHGHDGL PIC S9(0004) COMP.
  3614     05  BCHGHDGF PIC  X(0001).
  3615     05  FILLER REDEFINES BCHGHDGF.
  3616         10  BCHGHDGA PIC  X(0001).
  3617     05  BCHGHDGI PIC  X(0003).
  3618*    -------------------------------
  3619     05  BMANTDTL PIC S9(0004) COMP.
  3620     05  BMANTDTF PIC  X(0001).
  3621     05  FILLER REDEFINES BMANTDTF.
  3622         10  BMANTDTA PIC  X(0001).
  3623     05  BMANTDTI PIC  X(0008).
  3624*    -------------------------------
  3625     05  BMANTATL PIC S9(0004) COMP.
  3626     05  BMANTATF PIC  X(0001).
  3627     05  FILLER REDEFINES BMANTATF.
  3628         10  BMANTATA PIC  X(0001).
  3629     05  BMANTATI PIC  X(0005).
  3630*    -------------------------------
  3631     05  BCSRL PIC S9(0004) COMP.
  3632     05  BCSRF PIC  X(0001).
  3633     05  FILLER REDEFINES BCSRF.
  3634         10  BCSRA PIC  X(0001).
  3635     05  BCSRI PIC  X(0004).
  3636*    -------------------------------
  3637     05  BBATCHL PIC S9(0004) COMP.
  3638     05  BBATCHF PIC  X(0001).
  3639     05  FILLER REDEFINES BBATCHF.
  3640         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  70
* EL6311.cbl
  3641     05  BBATCHI PIC  X(0006).
  3642*    -------------------------------
  3643     05  BSEQL PIC S9(0004) COMP.
  3644     05  BSEQF PIC  X(0001).
  3645     05  FILLER REDEFINES BSEQF.
  3646         10  BSEQA PIC  X(0001).
  3647     05  BSEQI PIC  X(0004).
  3648*    -------------------------------
  3649     05  BMOENDTL PIC S9(0004) COMP.
  3650     05  BMOENDTF PIC  X(0001).
  3651     05  FILLER REDEFINES BMOENDTF.
  3652         10  BMOENDTA PIC  X(0001).
  3653     05  BMOENDTI PIC  X(0008).
  3654*    -------------------------------
  3655     05  BCARRL PIC S9(0004) COMP.
  3656     05  BCARRF PIC  X(0001).
  3657     05  FILLER REDEFINES BCARRF.
  3658         10  BCARRA PIC  X(0001).
  3659     05  BCARRI PIC  X(0001).
  3660*    -------------------------------
  3661     05  BGROUPL PIC S9(0004) COMP.
  3662     05  BGROUPF PIC  X(0001).
  3663     05  FILLER REDEFINES BGROUPF.
  3664         10  BGROUPA PIC  X(0001).
  3665     05  BGROUPI PIC  X(0006).
  3666*    -------------------------------
  3667     05  BSTATEL PIC S9(0004) COMP.
  3668     05  BSTATEF PIC  X(0001).
  3669     05  FILLER REDEFINES BSTATEF.
  3670         10  BSTATEA PIC  X(0001).
  3671     05  BSTATEI PIC  X(0002).
  3672*    -------------------------------
  3673     05  BACCTL PIC S9(0004) COMP.
  3674     05  BACCTF PIC  X(0001).
  3675     05  FILLER REDEFINES BACCTF.
  3676         10  BACCTA PIC  X(0001).
  3677     05  BACCTI PIC  X(0010).
  3678*    -------------------------------
  3679     05  BVINHL PIC S9(0004) COMP.
  3680     05  BVINHF PIC  X(0001).
  3681     05  FILLER REDEFINES BVINHF.
  3682         10  BVINHA PIC  X(0001).
  3683     05  BVINHI PIC  X(0004).
  3684*    -------------------------------
  3685     05  BVINL PIC S9(0004) COMP.
  3686     05  BVINF PIC  X(0001).
  3687     05  FILLER REDEFINES BVINF.
  3688         10  BVINA PIC  X(0001).
  3689     05  BVINI PIC  X(0017).
  3690*    -------------------------------
  3691     05  BREFHDGL PIC S9(0004) COMP.
  3692     05  BREFHDGF PIC  X(0001).
  3693     05  FILLER REDEFINES BREFHDGF.
  3694         10  BREFHDGA PIC  X(0001).
  3695     05  BREFHDGI PIC  X(0004).
  3696*    -------------------------------
  3697     05  BREFL PIC S9(0004) COMP.
  3698     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  71
* EL6311.cbl
  3699     05  FILLER REDEFINES BREFF.
  3700         10  BREFA PIC  X(0001).
  3701     05  BREFI PIC  X(0012).
  3702*    -------------------------------
  3703     05  LETRREQL PIC S9(0004) COMP.
  3704     05  LETRREQF PIC  X(0001).
  3705     05  FILLER REDEFINES LETRREQF.
  3706         10  LETRREQA PIC  X(0001).
  3707     05  LETRREQI PIC  X(0001).
  3708*    -------------------------------
  3709     05  BAGEDEFL PIC S9(0004) COMP.
  3710     05  BAGEDEFF PIC  X(0001).
  3711     05  FILLER REDEFINES BAGEDEFF.
  3712         10  BAGEDEFA PIC  X(0001).
  3713     05  BAGEDEFI PIC  X(0004).
  3714*    -------------------------------
  3715     05  BCERTNOL PIC S9(0004) COMP.
  3716     05  BCERTNOF PIC  X(0001).
  3717     05  FILLER REDEFINES BCERTNOF.
  3718         10  BCERTNOA PIC  X(0001).
  3719     05  BCERTNOI PIC  X(0010).
  3720*    -------------------------------
  3721     05  BSUFIXL PIC S9(0004) COMP.
  3722     05  BSUFIXF PIC  X(0001).
  3723     05  FILLER REDEFINES BSUFIXF.
  3724         10  BSUFIXA PIC  X(0001).
  3725     05  BSUFIXI PIC  X(0001).
  3726*    -------------------------------
  3727     05  BEFFDTL PIC S9(0004) COMP.
  3728     05  BEFFDTF PIC  X(0001).
  3729     05  FILLER REDEFINES BEFFDTF.
  3730         10  BEFFDTA PIC  X(0001).
  3731     05  BEFFDTI PIC  X(0008).
  3732*    -------------------------------
  3733     05  BLSTNML PIC S9(0004) COMP.
  3734     05  BLSTNMF PIC  X(0001).
  3735     05  FILLER REDEFINES BLSTNMF.
  3736         10  BLSTNMA PIC  X(0001).
  3737     05  BLSTNMI PIC  X(0015).
  3738*    -------------------------------
  3739     05  B1STNML PIC S9(0004) COMP.
  3740     05  B1STNMF PIC  X(0001).
  3741     05  FILLER REDEFINES B1STNMF.
  3742         10  B1STNMA PIC  X(0001).
  3743     05  B1STNMI PIC  X(0010).
  3744*    -------------------------------
  3745     05  BINITL PIC S9(0004) COMP.
  3746     05  BINITF PIC  X(0001).
  3747     05  FILLER REDEFINES BINITF.
  3748         10  BINITA PIC  X(0001).
  3749     05  BINITI PIC  X(0001).
  3750*    -------------------------------
  3751     05  BSEXL PIC S9(0004) COMP.
  3752     05  BSEXF PIC  X(0001).
  3753     05  FILLER REDEFINES BSEXF.
  3754         10  BSEXA PIC  X(0001).
  3755     05  BSEXI PIC  X(0001).
  3756*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  72
* EL6311.cbl
  3757     05  BAGEL PIC S9(0004) COMP.
  3758     05  BAGEF PIC  X(0001).
  3759     05  FILLER REDEFINES BAGEF.
  3760         10  BAGEA PIC  X(0001).
  3761     05  BAGEI PIC  X(0002).
  3762*    -------------------------------
  3763     05  BBIRTHL PIC S9(0004) COMP.
  3764     05  BBIRTHF PIC  X(0001).
  3765     05  FILLER REDEFINES BBIRTHF.
  3766         10  BBIRTHA PIC  X(0001).
  3767     05  BBIRTHI PIC  X(0008).
  3768*    -------------------------------
  3769     05  B1STPMTL PIC S9(0004) COMP.
  3770     05  B1STPMTF PIC  X(0001).
  3771     05  FILLER REDEFINES B1STPMTF.
  3772         10  B1STPMTA PIC  X(0001).
  3773     05  B1STPMTI PIC  X(0008).
  3774*    -------------------------------
  3775     05  BDAYSL PIC S9(0004) COMP.
  3776     05  BDAYSF PIC  X(0001).
  3777     05  FILLER REDEFINES BDAYSF.
  3778         10  BDAYSA PIC  X(0001).
  3779     05  BDAYSI PIC  X(0003).
  3780*    -------------------------------
  3781     05  BLNTRML PIC S9(0004) COMP.
  3782     05  BLNTRMF PIC  X(0001).
  3783     05  FILLER REDEFINES BLNTRMF.
  3784         10  BLNTRMA PIC  X(0001).
  3785     05  BLNTRMI PIC  X(0003).
  3786*    -------------------------------
  3787     05  BLNOFCRL PIC S9(0004) COMP.
  3788     05  BLNOFCRF PIC  X(0001).
  3789     05  FILLER REDEFINES BLNOFCRF.
  3790         10  BLNOFCRA PIC  X(0001).
  3791     05  BLNOFCRI PIC  X(0005).
  3792*    -------------------------------
  3793     05  BMODEL PIC S9(0004) COMP.
  3794     05  BMODEF PIC  X(0001).
  3795     05  FILLER REDEFINES BMODEF.
  3796         10  BMODEA PIC  X(0001).
  3797     05  BMODEI PIC  X(0001).
  3798*    -------------------------------
  3799     05  BFREQL PIC S9(0004) COMP.
  3800     05  BFREQF PIC  X(0001).
  3801     05  FILLER REDEFINES BFREQF.
  3802         10  BFREQA PIC  X(0001).
  3803     05  BFREQI PIC  X(0002).
  3804*    -------------------------------
  3805     05  BPMTSL PIC S9(0004) COMP.
  3806     05  BPMTSF PIC  X(0001).
  3807     05  FILLER REDEFINES BPMTSF.
  3808         10  BPMTSA PIC  X(0001).
  3809     05  BPMTSI PIC  999.
  3810*    -------------------------------
  3811     05  BPMTAMTL PIC S9(0004) COMP.
  3812     05  BPMTAMTF PIC  X(0001).
  3813     05  FILLER REDEFINES BPMTAMTF.
  3814         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  73
* EL6311.cbl
  3815     05  BPMTAMTI PIC  9(7)V99.
  3816*    -------------------------------
  3817     05  BAPRL PIC S9(0004) COMP.
  3818     05  BAPRF PIC  X(0001).
  3819     05  FILLER REDEFINES BAPRF.
  3820         10  BAPRA PIC  X(0001).
  3821     05  BAPRI PIC  X(7).
  3822*    -------------------------------
  3823     05  BLIVESL PIC S9(0004) COMP.
  3824     05  BLIVESF PIC  X(0001).
  3825     05  FILLER REDEFINES BLIVESF.
  3826         10  BLIVESA PIC  X(0001).
  3827     05  BLIVESI PIC  X(0009).
  3828*    -------------------------------
  3829     05  BMEMCAPL PIC S9(0004) COMP.
  3830     05  BMEMCAPF PIC  X(0001).
  3831     05  FILLER REDEFINES BMEMCAPF.
  3832         10  BMEMCAPA PIC  X(0001).
  3833     05  BMEMCAPI PIC  X(0011).
  3834*    -------------------------------
  3835     05  BORIGHDL PIC S9(0004) COMP.
  3836     05  BORIGHDF PIC  X(0001).
  3837     05  FILLER REDEFINES BORIGHDF.
  3838         10  BORIGHDA PIC  X(0001).
  3839     05  BORIGHDI PIC  X(0009).
  3840*    -------------------------------
  3841     05  DMDBILL PIC S9(0004) COMP.
  3842     05  DMDBILF PIC  X(0001).
  3843     05  FILLER REDEFINES DMDBILF.
  3844         10  DMDBILA PIC  X(0001).
  3845     05  DMDBILI PIC  X(0006).
  3846*    -------------------------------
  3847     05  BFORCEL PIC S9(0004) COMP.
  3848     05  BFORCEF PIC  X(0001).
  3849     05  FILLER REDEFINES BFORCEF.
  3850         10  BFORCEA PIC  X(0001).
  3851     05  BFORCEI PIC  X(0001).
  3852*    -------------------------------
  3853     05  BENTRYL PIC S9(0004) COMP.
  3854     05  BENTRYF PIC  X(0001).
  3855     05  FILLER REDEFINES BENTRYF.
  3856         10  BENTRYA PIC  X(0001).
  3857     05  BENTRYI PIC  X(0001).
  3858*    -------------------------------
  3859     05  BREINL PIC S9(0004) COMP.
  3860     05  BREINF PIC  X(0001).
  3861     05  FILLER REDEFINES BREINF.
  3862         10  BREINA PIC  X(0001).
  3863     05  BREINI PIC  X(0001).
  3864*    -------------------------------
  3865     05  BBILCDL PIC S9(0004) COMP.
  3866     05  BBILCDF PIC  X(0001).
  3867     05  FILLER REDEFINES BBILCDF.
  3868         10  BBILCDA PIC  X(0001).
  3869     05  BBILCDI PIC  X(0001).
  3870*    -------------------------------
  3871     05  BUNWRITL PIC S9(0004) COMP.
  3872     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  74
* EL6311.cbl
  3873     05  FILLER REDEFINES BUNWRITF.
  3874         10  BUNWRITA PIC  X(0001).
  3875     05  BUNWRITI PIC  X(0001).
  3876*    -------------------------------
  3877     05  BSKPCDL PIC S9(0004) COMP.
  3878     05  BSKPCDF PIC  X(0001).
  3879     05  FILLER REDEFINES BSKPCDF.
  3880         10  BSKPCDA PIC  X(0001).
  3881     05  BSKPCDI PIC  X(0001).
  3882*    -------------------------------
  3883     05  BINDGRPL PIC S9(0004) COMP.
  3884     05  BINDGRPF PIC  X(0001).
  3885     05  FILLER REDEFINES BINDGRPF.
  3886         10  BINDGRPA PIC  X(0001).
  3887     05  BINDGRPI PIC  X(0001).
  3888*    -------------------------------
  3889     05  BSIGL PIC S9(0004) COMP.
  3890     05  BSIGF PIC  X(0001).
  3891     05  FILLER REDEFINES BSIGF.
  3892         10  BSIGA PIC  X(0001).
  3893     05  BSIGI PIC  X(0001).
  3894*    -------------------------------
  3895     05  BRTCLSL PIC S9(0004) COMP.
  3896     05  BRTCLSF PIC  X(0001).
  3897     05  FILLER REDEFINES BRTCLSF.
  3898         10  BRTCLSA PIC  X(0001).
  3899     05  BRTCLSI PIC  X(0002).
  3900*    -------------------------------
  3901     05  BCHGCNTL PIC S9(0004) COMP.
  3902     05  BCHGCNTF PIC  X(0001).
  3903     05  FILLER REDEFINES BCHGCNTF.
  3904         10  BCHGCNTA PIC  X(0001).
  3905     05  BCHGCNTI PIC  X(0003).
  3906*    -------------------------------
  3907     05  BMEMBERL PIC S9(0004) COMP.
  3908     05  BMEMBERF PIC  X(0001).
  3909     05  FILLER REDEFINES BMEMBERF.
  3910         10  BMEMBERA PIC  X(0001).
  3911     05  BMEMBERI PIC  X(0012).
  3912*    -------------------------------
  3913     05  BORGNOL PIC S9(0004) COMP.
  3914     05  BORGNOF PIC  X(0001).
  3915     05  FILLER REDEFINES BORGNOF.
  3916         10  BORGNOA PIC  X(0001).
  3917     05  BORGNOI PIC  X(0006).
  3918*    -------------------------------
  3919     05  BORGSEQL PIC S9(0004) COMP.
  3920     05  BORGSEQF PIC  X(0001).
  3921     05  FILLER REDEFINES BORGSEQF.
  3922         10  BORGSEQA PIC  X(0001).
  3923     05  BORGSEQI PIC  X(0004).
  3924*    -------------------------------
  3925     05  BBILLEDL PIC S9(0004) COMP.
  3926     05  BBILLEDF PIC  X(0001).
  3927     05  FILLER REDEFINES BBILLEDF.
  3928         10  BBILLEDA PIC  X(0001).
  3929     05  BBILLEDI PIC  9(9).
  3930*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  75
* EL6311.cbl
  3931     05  BKIND1L PIC S9(0004) COMP.
  3932     05  BKIND1F PIC  X(0001).
  3933     05  FILLER REDEFINES BKIND1F.
  3934         10  BKIND1A PIC  X(0001).
  3935     05  BKIND1I PIC  X(0002).
  3936*    -------------------------------
  3937     05  BTYPE1L PIC S9(0004) COMP.
  3938     05  BTYPE1F PIC  X(0001).
  3939     05  FILLER REDEFINES BTYPE1F.
  3940         10  BTYPE1A PIC  X(0001).
  3941     05  BTYPE1I PIC  X(0003).
  3942*    -------------------------------
  3943     05  BTERM1L PIC S9(0004) COMP.
  3944     05  BTERM1F PIC  X(0001).
  3945     05  FILLER REDEFINES BTERM1F.
  3946         10  BTERM1A PIC  X(0001).
  3947     05  BTERM1I PIC  X(0003).
  3948*    -------------------------------
  3949     05  BBEN1L PIC S9(0004) COMP.
  3950     05  BBEN1F PIC  X(0001).
  3951     05  FILLER REDEFINES BBEN1F.
  3952         10  BBEN1A PIC  X(0001).
  3953     05  BBEN1I PIC  X(0012).
  3954*    -------------------------------
  3955     05  BPREM1L PIC S9(0004) COMP.
  3956     05  BPREM1F PIC  X(0001).
  3957     05  FILLER REDEFINES BPREM1F.
  3958         10  BPREM1A PIC  X(0001).
  3959     05  BPREM1I PIC  X(0011).
  3960*    -------------------------------
  3961     05  BEXPIR1L PIC S9(0004) COMP.
  3962     05  BEXPIR1F PIC  X(0001).
  3963     05  FILLER REDEFINES BEXPIR1F.
  3964         10  BEXPIR1A PIC  X(0001).
  3965     05  BEXPIR1I PIC  X(0008).
  3966*    -------------------------------
  3967     05  BCP1L PIC S9(0004) COMP.
  3968     05  BCP1F PIC  X(0001).
  3969     05  FILLER REDEFINES BCP1F.
  3970         10  BCP1A PIC  X(0001).
  3971     05  BCP1I PIC  X(0002).
  3972*    -------------------------------
  3973     05  BALTBN1L PIC S9(0004) COMP.
  3974     05  BALTBN1F PIC  X(0001).
  3975     05  FILLER REDEFINES BALTBN1F.
  3976         10  BALTBN1A PIC  X(0001).
  3977     05  BALTBN1I PIC  X(0012).
  3978*    -------------------------------
  3979     05  BALTPR1L PIC S9(0004) COMP.
  3980     05  BALTPR1F PIC  X(0001).
  3981     05  FILLER REDEFINES BALTPR1F.
  3982         10  BALTPR1A PIC  X(0001).
  3983     05  BALTPR1I PIC  X(0011).
  3984*    -------------------------------
  3985     05  BBNCD1L PIC S9(0004) COMP.
  3986     05  BBNCD1F PIC  X(0001).
  3987     05  FILLER REDEFINES BBNCD1F.
  3988         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  76
* EL6311.cbl
  3989     05  BBNCD1I PIC  X(0003).
  3990*    -------------------------------
  3991     05  BCPRM1L PIC S9(0004) COMP.
  3992     05  BCPRM1F PIC  X(0001).
  3993     05  FILLER REDEFINES BCPRM1F.
  3994         10  BCPRM1A PIC  X(0001).
  3995     05  BCPRM1I PIC  X(0011).
  3996*    -------------------------------
  3997     05  BCAPRM1L PIC S9(0004) COMP.
  3998     05  BCAPRM1F PIC  X(0001).
  3999     05  FILLER REDEFINES BCAPRM1F.
  4000         10  BCAPRM1A PIC  X(0001).
  4001     05  BCAPRM1I PIC  X(0011).
  4002*    -------------------------------
  4003     05  BENABR1L PIC S9(0004) COMP.
  4004     05  BENABR1F PIC  X(0001).
  4005     05  FILLER REDEFINES BENABR1F.
  4006         10  BENABR1A PIC  X(0001).
  4007     05  BENABR1I PIC  X(0005).
  4008*    -------------------------------
  4009     05  BDIFF1L PIC S9(0004) COMP.
  4010     05  BDIFF1F PIC  X(0001).
  4011     05  FILLER REDEFINES BDIFF1F.
  4012         10  BDIFF1A PIC  X(0001).
  4013     05  BDIFF1I PIC  X(0011).
  4014*    -------------------------------
  4015     05  BBILIT1L PIC S9(0004) COMP.
  4016     05  BBILIT1F PIC  X(0001).
  4017     05  FILLER REDEFINES BBILIT1F.
  4018         10  BBILIT1A PIC  X(0001).
  4019     05  BBILIT1I PIC  X(0008).
  4020*    -------------------------------
  4021     05  BADIFF1L PIC S9(0004) COMP.
  4022     05  BADIFF1F PIC  X(0001).
  4023     05  FILLER REDEFINES BADIFF1F.
  4024         10  BADIFF1A PIC  X(0001).
  4025     05  BADIFF1I PIC  X(0011).
  4026*    -------------------------------
  4027     05  BKIND2L PIC S9(0004) COMP.
  4028     05  BKIND2F PIC  X(0001).
  4029     05  FILLER REDEFINES BKIND2F.
  4030         10  BKIND2A PIC  X(0001).
  4031     05  BKIND2I PIC  X(0002).
  4032*    -------------------------------
  4033     05  BTYPE2L PIC S9(0004) COMP.
  4034     05  BTYPE2F PIC  X(0001).
  4035     05  FILLER REDEFINES BTYPE2F.
  4036         10  BTYPE2A PIC  X(0001).
  4037     05  BTYPE2I PIC  X(0003).
  4038*    -------------------------------
  4039     05  BTERM2L PIC S9(0004) COMP.
  4040     05  BTERM2F PIC  X(0001).
  4041     05  FILLER REDEFINES BTERM2F.
  4042         10  BTERM2A PIC  X(0001).
  4043     05  BTERM2I PIC  X(0003).
  4044*    -------------------------------
  4045     05  BBEN2L PIC S9(0004) COMP.
  4046     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  77
* EL6311.cbl
  4047     05  FILLER REDEFINES BBEN2F.
  4048         10  BBEN2A PIC  X(0001).
  4049     05  BBEN2I PIC  X(0012).
  4050*    -------------------------------
  4051     05  BPREM2L PIC S9(0004) COMP.
  4052     05  BPREM2F PIC  X(0001).
  4053     05  FILLER REDEFINES BPREM2F.
  4054         10  BPREM2A PIC  X(0001).
  4055     05  BPREM2I PIC  X(0011).
  4056*    -------------------------------
  4057     05  BEXPIR2L PIC S9(0004) COMP.
  4058     05  BEXPIR2F PIC  X(0001).
  4059     05  FILLER REDEFINES BEXPIR2F.
  4060         10  BEXPIR2A PIC  X(0001).
  4061     05  BEXPIR2I PIC  X(0008).
  4062*    -------------------------------
  4063     05  BCP2L PIC S9(0004) COMP.
  4064     05  BCP2F PIC  X(0001).
  4065     05  FILLER REDEFINES BCP2F.
  4066         10  BCP2A PIC  X(0001).
  4067     05  BCP2I PIC  X(0002).
  4068*    -------------------------------
  4069     05  BALTBN2L PIC S9(0004) COMP.
  4070     05  BALTBN2F PIC  X(0001).
  4071     05  FILLER REDEFINES BALTBN2F.
  4072         10  BALTBN2A PIC  X(0001).
  4073     05  BALTBN2I PIC  X(0012).
  4074*    -------------------------------
  4075     05  BALTPR2L PIC S9(0004) COMP.
  4076     05  BALTPR2F PIC  X(0001).
  4077     05  FILLER REDEFINES BALTPR2F.
  4078         10  BALTPR2A PIC  X(0001).
  4079     05  BALTPR2I PIC  X(0011).
  4080*    -------------------------------
  4081     05  BBNCD2L PIC S9(0004) COMP.
  4082     05  BBNCD2F PIC  X(0001).
  4083     05  FILLER REDEFINES BBNCD2F.
  4084         10  BBNCD2A PIC  X(0001).
  4085     05  BBNCD2I PIC  X(0003).
  4086*    -------------------------------
  4087     05  BCPRM2L PIC S9(0004) COMP.
  4088     05  BCPRM2F PIC  X(0001).
  4089     05  FILLER REDEFINES BCPRM2F.
  4090         10  BCPRM2A PIC  X(0001).
  4091     05  BCPRM2I PIC  X(0011).
  4092*    -------------------------------
  4093     05  BCAPRM2L PIC S9(0004) COMP.
  4094     05  BCAPRM2F PIC  X(0001).
  4095     05  FILLER REDEFINES BCAPRM2F.
  4096         10  BCAPRM2A PIC  X(0001).
  4097     05  BCAPRM2I PIC  X(0011).
  4098*    -------------------------------
  4099     05  BENABR2L PIC S9(0004) COMP.
  4100     05  BENABR2F PIC  X(0001).
  4101     05  FILLER REDEFINES BENABR2F.
  4102         10  BENABR2A PIC  X(0001).
  4103     05  BENABR2I PIC  X(0005).
  4104*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  78
* EL6311.cbl
  4105     05  BDIFF2L PIC S9(0004) COMP.
  4106     05  BDIFF2F PIC  X(0001).
  4107     05  FILLER REDEFINES BDIFF2F.
  4108         10  BDIFF2A PIC  X(0001).
  4109     05  BDIFF2I PIC  X(0011).
  4110*    -------------------------------
  4111     05  BBILIT2L PIC S9(0004) COMP.
  4112     05  BBILIT2F PIC  X(0001).
  4113     05  FILLER REDEFINES BBILIT2F.
  4114         10  BBILIT2A PIC  X(0001).
  4115     05  BBILIT2I PIC  X(0008).
  4116*    -------------------------------
  4117     05  BADIFF2L PIC S9(0004) COMP.
  4118     05  BADIFF2F PIC  X(0001).
  4119     05  FILLER REDEFINES BADIFF2F.
  4120         10  BADIFF2A PIC  X(0001).
  4121     05  BADIFF2I PIC  X(0011).
  4122*    -------------------------------
  4123     05  BERMSG1L PIC S9(0004) COMP.
  4124     05  BERMSG1F PIC  X(0001).
  4125     05  FILLER REDEFINES BERMSG1F.
  4126         10  BERMSG1A PIC  X(0001).
  4127     05  BERMSG1I PIC  X(0078).
  4128*    -------------------------------
  4129     05  BERMSG2L PIC S9(0004) COMP.
  4130     05  BERMSG2F PIC  X(0001).
  4131     05  FILLER REDEFINES BERMSG2F.
  4132         10  BERMSG2A PIC  X(0001).
  4133     05  BERMSG2I PIC  X(0078).
  4134*    -------------------------------
  4135     05  BERMSG3L PIC S9(0004) COMP.
  4136     05  BERMSG3F PIC  X(0001).
  4137     05  FILLER REDEFINES BERMSG3F.
  4138         10  BERMSG3A PIC  X(0001).
  4139     05  BERMSG3I PIC  X(0078).
  4140*    -------------------------------
  4141     05  BPFENTRL PIC S9(0004) COMP.
  4142     05  BPFENTRF PIC  X(0001).
  4143     05  FILLER REDEFINES BPFENTRF.
  4144         10  BPFENTRA PIC  X(0001).
  4145     05  BPFENTRI PIC  9(2).
  4146*    -------------------------------
  4147     05  BPF5HDRL PIC S9(0004) COMP.
  4148     05  BPF5HDRF PIC  X(0001).
  4149     05  FILLER REDEFINES BPF5HDRF.
  4150         10  BPF5HDRA PIC  X(0001).
  4151     05  BPF5HDRI PIC  X(0005).
  4152*    -------------------------------
  4153     05  BPF4HDRL PIC S9(0004) COMP.
  4154     05  BPF4HDRF PIC  X(0001).
  4155     05  FILLER REDEFINES BPF4HDRF.
  4156         10  BPF4HDRA PIC  X(0001).
  4157     05  BPF4HDRI PIC  X(0013).
  4158*    -------------------------------
  4159     05  BF15HDRL PIC S9(0004) COMP.
  4160     05  BF15HDRF PIC  X(0001).
  4161     05  FILLER REDEFINES BF15HDRF.
  4162         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  79
* EL6311.cbl
  4163     05  BF15HDRI PIC  X(0010).
  4164 01  EL631BO REDEFINES EL631BI.
  4165     05  FILLER            PIC  X(0012).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BDATEO PIC  X(0008).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BTIMEO PIC  99.99.
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BHEADO PIC  X(0038).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BNCERTLO PIC  X(0008).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BNCERTO PIC  X(0011).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BNSTATLO PIC  X(0009).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BNSTATO PIC  X(0002).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BCHGTO PIC  X(0004).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BCHGO PIC  ZZZ9.
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BCOMPIDO PIC  X(0003).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BREGIONO PIC  X(0006).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BUSERO PIC  X(0004).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BMAINTO PIC  X(0001).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BMANTBYO PIC  X(0004).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BCHGHDGO PIC  X(0003).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BMANTDTO PIC  X(0008).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BMANTATO PIC  99.99.
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BCSRO PIC  X(0004).
  4220*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  80
* EL6311.cbl
  4221     05  FILLER            PIC  X(0003).
  4222     05  BBATCHO PIC  X(0006).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BSEQO PIC  X(0004).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BMOENDTO PIC  X(0008).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BCARRO PIC  X(0001).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BGROUPO PIC  X(0006).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BSTATEO PIC  X(0002).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BACCTO PIC  X(0010).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BVINHO PIC  X(0004).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BVINO PIC  X(0017).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BREFHDGO PIC  X(0004).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BREFO PIC  X(0012).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  LETRREQO PIC  X(0001).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BAGEDEFO PIC  X(0004).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BCERTNOO PIC  X(0010).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BSUFIXO PIC  X(0001).
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
  4267     05  BEFFDTO PIC  X(0008).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BLSTNMO PIC  X(0015).
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  B1STNMO PIC  X(0010).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BINITO PIC  X(0001).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  81
* EL6311.cbl
  4279     05  BSEXO PIC  X(0001).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BAGEO PIC  X(0002).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BBIRTHO PIC  X(0008).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  B1STPMTO PIC  X(0008).
  4289*    -------------------------------
  4290     05  FILLER            PIC  X(0003).
  4291     05  BDAYSO PIC  X(0003).
  4292*    -------------------------------
  4293     05  FILLER            PIC  X(0003).
  4294     05  BLNTRMO PIC  X(0003).
  4295*    -------------------------------
  4296     05  FILLER            PIC  X(0003).
  4297     05  BLNOFCRO PIC  X(0005).
  4298*    -------------------------------
  4299     05  FILLER            PIC  X(0003).
  4300     05  BMODEO PIC  X(0001).
  4301*    -------------------------------
  4302     05  FILLER            PIC  X(0003).
  4303     05  BFREQO PIC  X(0002).
  4304*    -------------------------------
  4305     05  FILLER            PIC  X(0003).
  4306     05  BPMTSO PIC  X(0003).
  4307*    -------------------------------
  4308     05  FILLER            PIC  X(0003).
  4309     05  BPMTAMTO PIC  ZZZZZ9.99.
  4310*    -------------------------------
  4311     05  FILLER            PIC  X(0003).
  4312     05  BAPRO PIC  99.9999.
  4313*    -------------------------------
  4314     05  FILLER            PIC  X(0003).
  4315     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4316*    -------------------------------
  4317     05  FILLER            PIC  X(0003).
  4318     05  BMEMCAPO PIC  X(0011).
  4319*    -------------------------------
  4320     05  FILLER            PIC  X(0003).
  4321     05  BORIGHDO PIC  X(0009).
  4322*    -------------------------------
  4323     05  FILLER            PIC  X(0003).
  4324     05  DMDBILO PIC  X(0006).
  4325*    -------------------------------
  4326     05  FILLER            PIC  X(0003).
  4327     05  BFORCEO PIC  X(0001).
  4328*    -------------------------------
  4329     05  FILLER            PIC  X(0003).
  4330     05  BENTRYO PIC  X(0001).
  4331*    -------------------------------
  4332     05  FILLER            PIC  X(0003).
  4333     05  BREINO PIC  X(0001).
  4334*    -------------------------------
  4335     05  FILLER            PIC  X(0003).
  4336     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  82
* EL6311.cbl
  4337*    -------------------------------
  4338     05  FILLER            PIC  X(0003).
  4339     05  BUNWRITO PIC  X(0001).
  4340*    -------------------------------
  4341     05  FILLER            PIC  X(0003).
  4342     05  BSKPCDO PIC  X(0001).
  4343*    -------------------------------
  4344     05  FILLER            PIC  X(0003).
  4345     05  BINDGRPO PIC  X(0001).
  4346*    -------------------------------
  4347     05  FILLER            PIC  X(0003).
  4348     05  BSIGO PIC  X(0001).
  4349*    -------------------------------
  4350     05  FILLER            PIC  X(0003).
  4351     05  BRTCLSO PIC  X(0002).
  4352*    -------------------------------
  4353     05  FILLER            PIC  X(0003).
  4354     05  BCHGCNTO PIC  X(0003).
  4355*    -------------------------------
  4356     05  FILLER            PIC  X(0003).
  4357     05  BMEMBERO PIC  X(0012).
  4358*    -------------------------------
  4359     05  FILLER            PIC  X(0003).
  4360     05  BORGNOO PIC  X(0006).
  4361*    -------------------------------
  4362     05  FILLER            PIC  X(0003).
  4363     05  BORGSEQO PIC  X(0004).
  4364*    -------------------------------
  4365     05  FILLER            PIC  X(0003).
  4366     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4367*    -------------------------------
  4368     05  FILLER            PIC  X(0003).
  4369     05  BKIND1O PIC  X(0002).
  4370*    -------------------------------
  4371     05  FILLER            PIC  X(0003).
  4372     05  BTYPE1O PIC  X(0003).
  4373*    -------------------------------
  4374     05  FILLER            PIC  X(0003).
  4375     05  BTERM1O PIC  X(0003).
  4376*    -------------------------------
  4377     05  FILLER            PIC  X(0003).
  4378     05  BBEN1O PIC  X(0012).
  4379*    -------------------------------
  4380     05  FILLER            PIC  X(0003).
  4381     05  BPREM1O PIC  X(0011).
  4382*    -------------------------------
  4383     05  FILLER            PIC  X(0003).
  4384     05  BEXPIR1O PIC  X(0008).
  4385*    -------------------------------
  4386     05  FILLER            PIC  X(0003).
  4387     05  BCP1O PIC  X(0002).
  4388*    -------------------------------
  4389     05  FILLER            PIC  X(0003).
  4390     05  BALTBN1O PIC  X(0012).
  4391*    -------------------------------
  4392     05  FILLER            PIC  X(0003).
  4393     05  BALTPR1O PIC  X(0011).
  4394*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  83
* EL6311.cbl
  4395     05  FILLER            PIC  X(0003).
  4396     05  BBNCD1O PIC  X(0003).
  4397*    -------------------------------
  4398     05  FILLER            PIC  X(0003).
  4399     05  BCPRM1O PIC  X(0011).
  4400*    -------------------------------
  4401     05  FILLER            PIC  X(0003).
  4402     05  BCAPRM1O PIC  X(0011).
  4403*    -------------------------------
  4404     05  FILLER            PIC  X(0003).
  4405     05  BENABR1O PIC  X(0005).
  4406*    -------------------------------
  4407     05  FILLER            PIC  X(0003).
  4408     05  BDIFF1O PIC  X(0011).
  4409*    -------------------------------
  4410     05  FILLER            PIC  X(0003).
  4411     05  BBILIT1O PIC  X(0008).
  4412*    -------------------------------
  4413     05  FILLER            PIC  X(0003).
  4414     05  BADIFF1O PIC  X(0011).
  4415*    -------------------------------
  4416     05  FILLER            PIC  X(0003).
  4417     05  BKIND2O PIC  X(0002).
  4418*    -------------------------------
  4419     05  FILLER            PIC  X(0003).
  4420     05  BTYPE2O PIC  X(0003).
  4421*    -------------------------------
  4422     05  FILLER            PIC  X(0003).
  4423     05  BTERM2O PIC  X(0003).
  4424*    -------------------------------
  4425     05  FILLER            PIC  X(0003).
  4426     05  BBEN2O PIC  X(0012).
  4427*    -------------------------------
  4428     05  FILLER            PIC  X(0003).
  4429     05  BPREM2O PIC  X(0011).
  4430*    -------------------------------
  4431     05  FILLER            PIC  X(0003).
  4432     05  BEXPIR2O PIC  X(0008).
  4433*    -------------------------------
  4434     05  FILLER            PIC  X(0003).
  4435     05  BCP2O PIC  X(0002).
  4436*    -------------------------------
  4437     05  FILLER            PIC  X(0003).
  4438     05  BALTBN2O PIC  X(0012).
  4439*    -------------------------------
  4440     05  FILLER            PIC  X(0003).
  4441     05  BALTPR2O PIC  X(0011).
  4442*    -------------------------------
  4443     05  FILLER            PIC  X(0003).
  4444     05  BBNCD2O PIC  X(0003).
  4445*    -------------------------------
  4446     05  FILLER            PIC  X(0003).
  4447     05  BCPRM2O PIC  X(0011).
  4448*    -------------------------------
  4449     05  FILLER            PIC  X(0003).
  4450     05  BCAPRM2O PIC  X(0011).
  4451*    -------------------------------
  4452     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  84
* EL6311.cbl
  4453     05  BENABR2O PIC  X(0005).
  4454*    -------------------------------
  4455     05  FILLER            PIC  X(0003).
  4456     05  BDIFF2O PIC  X(0011).
  4457*    -------------------------------
  4458     05  FILLER            PIC  X(0003).
  4459     05  BBILIT2O PIC  X(0008).
  4460*    -------------------------------
  4461     05  FILLER            PIC  X(0003).
  4462     05  BADIFF2O PIC  X(0011).
  4463*    -------------------------------
  4464     05  FILLER            PIC  X(0003).
  4465     05  BERMSG1O PIC  X(0078).
  4466*    -------------------------------
  4467     05  FILLER            PIC  X(0003).
  4468     05  BERMSG2O PIC  X(0078).
  4469*    -------------------------------
  4470     05  FILLER            PIC  X(0003).
  4471     05  BERMSG3O PIC  X(0078).
  4472*    -------------------------------
  4473     05  FILLER            PIC  X(0003).
  4474     05  BPFENTRO PIC  X(0002).
  4475*    -------------------------------
  4476     05  FILLER            PIC  X(0003).
  4477     05  BPF5HDRO PIC  X(0005).
  4478*    -------------------------------
  4479     05  FILLER            PIC  X(0003).
  4480     05  BPF4HDRO PIC  X(0013).
  4481*    -------------------------------
  4482     05  FILLER            PIC  X(0003).
  4483     05  BF15HDRO PIC  X(0010).
  4484*    -------------------------------
  4485 01  EL631CI REDEFINES EL631BI.
  4486     05  FILLER            PIC  X(0012).
  4487*    -------------------------------
  4488     05  CDATEL PIC S9(0004) COMP.
  4489     05  CDATEF PIC  X(0001).
  4490     05  FILLER REDEFINES CDATEF.
  4491         10  CDATEA PIC  X(0001).
  4492     05  CDATEI PIC  X(0008).
  4493*    -------------------------------
  4494     05  CTIMEL PIC S9(0004) COMP.
  4495     05  CTIMEF PIC  X(0001).
  4496     05  FILLER REDEFINES CTIMEF.
  4497         10  CTIMEA PIC  X(0001).
  4498     05  CTIMEI PIC  X(0005).
  4499*    -------------------------------
  4500     05  CHEADL PIC S9(0004) COMP.
  4501     05  CHEADF PIC  X(0001).
  4502     05  FILLER REDEFINES CHEADF.
  4503         10  CHEADA PIC  X(0001).
  4504     05  CHEADI PIC  X(0038).
  4505*    -------------------------------
  4506     05  CCHGTL PIC S9(0004) COMP.
  4507     05  CCHGTF PIC  X(0001).
  4508     05  FILLER REDEFINES CCHGTF.
  4509         10  CCHGTA PIC  X(0001).
  4510     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  85
* EL6311.cbl
  4511*    -------------------------------
  4512     05  CCHGL PIC S9(0004) COMP.
  4513     05  CCHGF PIC  X(0001).
  4514     05  FILLER REDEFINES CCHGF.
  4515         10  CCHGA PIC  X(0001).
  4516     05  CCHGI PIC  X(0004).
  4517*    -------------------------------
  4518     05  CMAINTL PIC S9(0004) COMP.
  4519     05  CMAINTF PIC  X(0001).
  4520     05  FILLER REDEFINES CMAINTF.
  4521         10  CMAINTA PIC  X(0001).
  4522     05  CMAINTI PIC  X(0001).
  4523*    -------------------------------
  4524     05  CMANTBYL PIC S9(0004) COMP.
  4525     05  CMANTBYF PIC  X(0001).
  4526     05  FILLER REDEFINES CMANTBYF.
  4527         10  CMANTBYA PIC  X(0001).
  4528     05  CMANTBYI PIC  X(0004).
  4529*    -------------------------------
  4530     05  CCHGHDGL PIC S9(0004) COMP.
  4531     05  CCHGHDGF PIC  X(0001).
  4532     05  FILLER REDEFINES CCHGHDGF.
  4533         10  CCHGHDGA PIC  X(0001).
  4534     05  CCHGHDGI PIC  X(0003).
  4535*    -------------------------------
  4536     05  CMANTDTL PIC S9(0004) COMP.
  4537     05  CMANTDTF PIC  X(0001).
  4538     05  FILLER REDEFINES CMANTDTF.
  4539         10  CMANTDTA PIC  X(0001).
  4540     05  CMANTDTI PIC  X(0008).
  4541*    -------------------------------
  4542     05  CMANTATL PIC S9(0004) COMP.
  4543     05  CMANTATF PIC  X(0001).
  4544     05  FILLER REDEFINES CMANTATF.
  4545         10  CMANTATA PIC  X(0001).
  4546     05  CMANTATI PIC  X(0005).
  4547*    -------------------------------
  4548     05  CCSRL PIC S9(0004) COMP.
  4549     05  CCSRF PIC  X(0001).
  4550     05  FILLER REDEFINES CCSRF.
  4551         10  CCSRA PIC  X(0001).
  4552     05  CCSRI PIC  X(0004).
  4553*    -------------------------------
  4554     05  CBATCHL PIC S9(0004) COMP.
  4555     05  CBATCHF PIC  X(0001).
  4556     05  FILLER REDEFINES CBATCHF.
  4557         10  CBATCHA PIC  X(0001).
  4558     05  CBATCHI PIC  X(0006).
  4559*    -------------------------------
  4560     05  CSEQL PIC S9(0004) COMP.
  4561     05  CSEQF PIC  X(0001).
  4562     05  FILLER REDEFINES CSEQF.
  4563         10  CSEQA PIC  X(0001).
  4564     05  CSEQI PIC  X(0004).
  4565*    -------------------------------
  4566     05  CMOENDTL PIC S9(0004) COMP.
  4567     05  CMOENDTF PIC  X(0001).
  4568     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  86
* EL6311.cbl
  4569         10  CMOENDTA PIC  X(0001).
  4570     05  CMOENDTI PIC  X(0008).
  4571*    -------------------------------
  4572     05  CCARRL PIC S9(0004) COMP.
  4573     05  CCARRF PIC  X(0001).
  4574     05  FILLER REDEFINES CCARRF.
  4575         10  CCARRA PIC  X(0001).
  4576     05  CCARRI PIC  X(0001).
  4577*    -------------------------------
  4578     05  CGROUPL PIC S9(0004) COMP.
  4579     05  CGROUPF PIC  X(0001).
  4580     05  FILLER REDEFINES CGROUPF.
  4581         10  CGROUPA PIC  X(0001).
  4582     05  CGROUPI PIC  X(0006).
  4583*    -------------------------------
  4584     05  CSTATEL PIC S9(0004) COMP.
  4585     05  CSTATEF PIC  X(0001).
  4586     05  FILLER REDEFINES CSTATEF.
  4587         10  CSTATEA PIC  X(0001).
  4588     05  CSTATEI PIC  X(0002).
  4589*    -------------------------------
  4590     05  CACCTL PIC S9(0004) COMP.
  4591     05  CACCTF PIC  X(0001).
  4592     05  FILLER REDEFINES CACCTF.
  4593         10  CACCTA PIC  X(0001).
  4594     05  CACCTI PIC  X(0010).
  4595*    -------------------------------
  4596     05  CORIGHDL PIC S9(0004) COMP.
  4597     05  CORIGHDF PIC  X(0001).
  4598     05  FILLER REDEFINES CORIGHDF.
  4599         10  CORIGHDA PIC  X(0001).
  4600     05  CORIGHDI PIC  X(0011).
  4601*    -------------------------------
  4602     05  CORGNOL PIC S9(0004) COMP.
  4603     05  CORGNOF PIC  X(0001).
  4604     05  FILLER REDEFINES CORGNOF.
  4605         10  CORGNOA PIC  X(0001).
  4606     05  CORGNOI PIC  X(0006).
  4607*    -------------------------------
  4608     05  CORGSEQL PIC S9(0004) COMP.
  4609     05  CORGSEQF PIC  X(0001).
  4610     05  FILLER REDEFINES CORGSEQF.
  4611         10  CORGSEQA PIC  X(0001).
  4612     05  CORGSEQI PIC  X(0004).
  4613*    -------------------------------
  4614     05  CREFHDGL PIC S9(0004) COMP.
  4615     05  CREFHDGF PIC  X(0001).
  4616     05  FILLER REDEFINES CREFHDGF.
  4617         10  CREFHDGA PIC  X(0001).
  4618     05  CREFHDGI PIC  X(0010).
  4619*    -------------------------------
  4620     05  CREFL PIC S9(0004) COMP.
  4621     05  CREFF PIC  X(0001).
  4622     05  FILLER REDEFINES CREFF.
  4623         10  CREFA PIC  X(0001).
  4624     05  CREFI PIC  X(0012).
  4625*    -------------------------------
  4626     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  87
* EL6311.cbl
  4627     05  CNHINTF PIC  X(0001).
  4628     05  FILLER REDEFINES CNHINTF.
  4629         10  CNHINTA PIC  X(0001).
  4630     05  CNHINTI PIC  9(7)V99.
  4631*    -------------------------------
  4632     05  CCERTNOL PIC S9(0004) COMP.
  4633     05  CCERTNOF PIC  X(0001).
  4634     05  FILLER REDEFINES CCERTNOF.
  4635         10  CCERTNOA PIC  X(0001).
  4636     05  CCERTNOI PIC  X(0010).
  4637*    -------------------------------
  4638     05  CSUFIXL PIC S9(0004) COMP.
  4639     05  CSUFIXF PIC  X(0001).
  4640     05  FILLER REDEFINES CSUFIXF.
  4641         10  CSUFIXA PIC  X(0001).
  4642     05  CSUFIXI PIC  X(0001).
  4643*    -------------------------------
  4644     05  CEFFDTL PIC S9(0004) COMP.
  4645     05  CEFFDTF PIC  X(0001).
  4646     05  FILLER REDEFINES CEFFDTF.
  4647         10  CEFFDTA PIC  X(0001).
  4648     05  CEFFDTI PIC  X(0008).
  4649*    -------------------------------
  4650     05  CLSTNML PIC S9(0004) COMP.
  4651     05  CLSTNMF PIC  X(0001).
  4652     05  FILLER REDEFINES CLSTNMF.
  4653         10  CLSTNMA PIC  X(0001).
  4654     05  CLSTNMI PIC  X(0015).
  4655*    -------------------------------
  4656     05  CINAMEL PIC S9(0004) COMP.
  4657     05  CINAMEF PIC  X(0001).
  4658     05  FILLER REDEFINES CINAMEF.
  4659         10  CINAMEA PIC  X(0001).
  4660     05  CINAMEI PIC  X(0015).
  4661*    -------------------------------
  4662     05  CINITSL PIC S9(0004) COMP.
  4663     05  CINITSF PIC  X(0001).
  4664     05  FILLER REDEFINES CINITSF.
  4665         10  CINITSA PIC  X(0001).
  4666     05  CINITSI PIC  X(0010).
  4667*    -------------------------------
  4668     05  CCANREAL PIC S9(0004) COMP.
  4669     05  CCANREAF PIC  X(0001).
  4670     05  FILLER REDEFINES CCANREAF.
  4671         10  CCANREAA PIC  X(0001).
  4672     05  CCANREAI PIC  X(0001).
  4673*    -------------------------------
  4674     05  ACTSPCL PIC S9(0004) COMP.
  4675     05  ACTSPCF PIC  X(0001).
  4676     05  FILLER REDEFINES ACTSPCF.
  4677         10  ACTSPCA PIC  X(0001).
  4678     05  ACTSPCI PIC  X(0001).
  4679*    -------------------------------
  4680     05  CKIND1L PIC S9(0004) COMP.
  4681     05  CKIND1F PIC  X(0001).
  4682     05  FILLER REDEFINES CKIND1F.
  4683         10  CKIND1A PIC  X(0001).
  4684     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  88
* EL6311.cbl
  4685*    -------------------------------
  4686     05  CCANDT1L PIC S9(0004) COMP.
  4687     05  CCANDT1F PIC  X(0001).
  4688     05  FILLER REDEFINES CCANDT1F.
  4689         10  CCANDT1A PIC  X(0001).
  4690     05  CCANDT1I PIC  X(0008).
  4691*    -------------------------------
  4692     05  CREFND1L PIC S9(0004) COMP.
  4693     05  CREFND1F PIC  X(0001).
  4694     05  FILLER REDEFINES CREFND1F.
  4695         10  CREFND1A PIC  X(0001).
  4696     05  CREFND1I PIC  S9(9)V99.
  4697*    -------------------------------
  4698     05  CMTHD1L PIC S9(0004) COMP.
  4699     05  CMTHD1F PIC  X(0001).
  4700     05  FILLER REDEFINES CMTHD1F.
  4701         10  CMTHD1A PIC  X(0001).
  4702     05  CMTHD1I PIC  X(0001).
  4703*    -------------------------------
  4704     05  CKIND2L PIC S9(0004) COMP.
  4705     05  CKIND2F PIC  X(0001).
  4706     05  FILLER REDEFINES CKIND2F.
  4707         10  CKIND2A PIC  X(0001).
  4708     05  CKIND2I PIC  X(0002).
  4709*    -------------------------------
  4710     05  CCANDT2L PIC S9(0004) COMP.
  4711     05  CCANDT2F PIC  X(0001).
  4712     05  FILLER REDEFINES CCANDT2F.
  4713         10  CCANDT2A PIC  X(0001).
  4714     05  CCANDT2I PIC  X(0008).
  4715*    -------------------------------
  4716     05  CREFND2L PIC S9(0004) COMP.
  4717     05  CREFND2F PIC  X(0001).
  4718     05  FILLER REDEFINES CREFND2F.
  4719         10  CREFND2A PIC  X(0001).
  4720     05  CREFND2I PIC  S9(9)V99.
  4721*    -------------------------------
  4722     05  CMTHD2L PIC S9(0004) COMP.
  4723     05  CMTHD2F PIC  X(0001).
  4724     05  FILLER REDEFINES CMTHD2F.
  4725         10  CMTHD2A PIC  X(0001).
  4726     05  CMTHD2I PIC  X(0001).
  4727*    -------------------------------
  4728     05  CLIVESL PIC S9(0004) COMP.
  4729     05  CLIVESF PIC  X(0001).
  4730     05  FILLER REDEFINES CLIVESF.
  4731         10  CLIVESA PIC  X(0001).
  4732     05  CLIVESI PIC  X(0003).
  4733*    -------------------------------
  4734     05  CFORCEL PIC S9(0004) COMP.
  4735     05  CFORCEF PIC  X(0001).
  4736     05  FILLER REDEFINES CFORCEF.
  4737         10  CFORCEA PIC  X(0001).
  4738     05  CFORCEI PIC  X(0001).
  4739*    -------------------------------
  4740     05  CBILCDL PIC S9(0004) COMP.
  4741     05  CBILCDF PIC  X(0001).
  4742     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  89
* EL6311.cbl
  4743         10  CBILCDA PIC  X(0001).
  4744     05  CBILCDI PIC  X(0001).
  4745*    -------------------------------
  4746     05  CCRFND1L PIC S9(0004) COMP.
  4747     05  CCRFND1F PIC  X(0001).
  4748     05  FILLER REDEFINES CCRFND1F.
  4749         10  CCRFND1A PIC  X(0001).
  4750     05  CCRFND1I PIC  X(0011).
  4751*    -------------------------------
  4752     05  CCRFND2L PIC S9(0004) COMP.
  4753     05  CCRFND2F PIC  X(0001).
  4754     05  FILLER REDEFINES CCRFND2F.
  4755         10  CCRFND2A PIC  X(0001).
  4756     05  CCRFND2I PIC  X(0011).
  4757*    -------------------------------
  4758     05  CBILIT1L PIC S9(0004) COMP.
  4759     05  CBILIT1F PIC  X(0001).
  4760     05  FILLER REDEFINES CBILIT1F.
  4761         10  CBILIT1A PIC  X(0001).
  4762     05  CBILIT1I PIC  X(0008).
  4763*    -------------------------------
  4764     05  CDRFND1L PIC S9(0004) COMP.
  4765     05  CDRFND1F PIC  X(0001).
  4766     05  FILLER REDEFINES CDRFND1F.
  4767         10  CDRFND1A PIC  X(0001).
  4768     05  CDRFND1I PIC  X(0011).
  4769*    -------------------------------
  4770     05  CBILIT2L PIC S9(0004) COMP.
  4771     05  CBILIT2F PIC  X(0001).
  4772     05  FILLER REDEFINES CBILIT2F.
  4773         10  CBILIT2A PIC  X(0001).
  4774     05  CBILIT2I PIC  X(0008).
  4775*    -------------------------------
  4776     05  CDRFND2L PIC S9(0004) COMP.
  4777     05  CDRFND2F PIC  X(0001).
  4778     05  FILLER REDEFINES CDRFND2F.
  4779         10  CDRFND2A PIC  X(0001).
  4780     05  CDRFND2I PIC  X(0011).
  4781*    -------------------------------
  4782     05  CCANTXTL PIC S9(0004) COMP.
  4783     05  CCANTXTF PIC  X(0001).
  4784     05  FILLER REDEFINES CCANTXTF.
  4785         10  CCANTXTA PIC  X(0001).
  4786     05  CCANTXTI PIC  X(0005).
  4787*    -------------------------------
  4788     05  CCANFEEL PIC S9(0004) COMP.
  4789     05  CCANFEEF PIC  X(0001).
  4790     05  FILLER REDEFINES CCANFEEF.
  4791         10  CCANFEEA PIC  X(0001).
  4792     05  CCANFEEI PIC  X(0002).
  4793*    -------------------------------
  4794     05  CTERM1L PIC S9(0004) COMP.
  4795     05  CTERM1F PIC  X(0001).
  4796     05  FILLER REDEFINES CTERM1F.
  4797         10  CTERM1A PIC  X(0001).
  4798     05  CTERM1I PIC  X(0003).
  4799*    -------------------------------
  4800     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  90
* EL6311.cbl
  4801     05  CRTERM1F PIC  X(0001).
  4802     05  FILLER REDEFINES CRTERM1F.
  4803         10  CRTERM1A PIC  X(0001).
  4804     05  CRTERM1I PIC  X(0003).
  4805*    -------------------------------
  4806     05  CPREM1L PIC S9(0004) COMP.
  4807     05  CPREM1F PIC  X(0001).
  4808     05  FILLER REDEFINES CPREM1F.
  4809         10  CPREM1A PIC  X(0001).
  4810     05  CPREM1I PIC  X(0011).
  4811*    -------------------------------
  4812     05  CTERM2L PIC S9(0004) COMP.
  4813     05  CTERM2F PIC  X(0001).
  4814     05  FILLER REDEFINES CTERM2F.
  4815         10  CTERM2A PIC  X(0001).
  4816     05  CTERM2I PIC  X(0003).
  4817*    -------------------------------
  4818     05  CRTERM2L PIC S9(0004) COMP.
  4819     05  CRTERM2F PIC  X(0001).
  4820     05  FILLER REDEFINES CRTERM2F.
  4821         10  CRTERM2A PIC  X(0001).
  4822     05  CRTERM2I PIC  X(0003).
  4823*    -------------------------------
  4824     05  CPREM2L PIC S9(0004) COMP.
  4825     05  CPREM2F PIC  X(0001).
  4826     05  FILLER REDEFINES CPREM2F.
  4827         10  CPREM2A PIC  X(0001).
  4828     05  CPREM2I PIC  X(0011).
  4829*    -------------------------------
  4830     05  CENTRDTL PIC S9(0004) COMP.
  4831     05  CENTRDTF PIC  X(0001).
  4832     05  FILLER REDEFINES CENTRDTF.
  4833         10  CENTRDTA PIC  X(0001).
  4834     05  CENTRDTI PIC  X(0008).
  4835*    -------------------------------
  4836     05  CPAYEEL PIC S9(0004) COMP.
  4837     05  CPAYEEF PIC  X(0001).
  4838     05  FILLER REDEFINES CPAYEEF.
  4839         10  CPAYEEA PIC  X(0001).
  4840     05  CPAYEEI PIC  X(0006).
  4841*    -------------------------------
  4842     05  CRFNDSWL PIC S9(0004) COMP.
  4843     05  CRFNDSWF PIC  X(0001).
  4844     05  FILLER REDEFINES CRFNDSWF.
  4845         10  CRFNDSWA PIC  X(0001).
  4846     05  CRFNDSWI PIC  X(0003).
  4847*    -------------------------------
  4848     05  CLFHDGL PIC S9(0004) COMP.
  4849     05  CLFHDGF PIC  X(0001).
  4850     05  FILLER REDEFINES CLFHDGF.
  4851         10  CLFHDGA PIC  X(0001).
  4852     05  CLFHDGI PIC  X(0006).
  4853*    -------------------------------
  4854     05  CAHHDGL PIC S9(0004) COMP.
  4855     05  CAHHDGF PIC  X(0001).
  4856     05  FILLER REDEFINES CAHHDGF.
  4857         10  CAHHDGA PIC  X(0001).
  4858     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  91
* EL6311.cbl
  4859*    -------------------------------
  4860     05  CENTDTL PIC S9(0004) COMP.
  4861     05  CENTDTF PIC  X(0001).
  4862     05  FILLER REDEFINES CENTDTF.
  4863         10  CENTDTA PIC  X(0001).
  4864     05  CENTDTI PIC  X(0008).
  4865*    -------------------------------
  4866     05  CENTBYL PIC S9(0004) COMP.
  4867     05  CENTBYF PIC  X(0001).
  4868     05  FILLER REDEFINES CENTBYF.
  4869         10  CENTBYA PIC  X(0001).
  4870     05  CENTBYI PIC  X(0004).
  4871*    -------------------------------
  4872     05  CCHGCNTL PIC S9(0004) COMP.
  4873     05  CCHGCNTF PIC  X(0001).
  4874     05  FILLER REDEFINES CCHGCNTF.
  4875         10  CCHGCNTA PIC  X(0001).
  4876     05  CCHGCNTI PIC  X(0003).
  4877*    -------------------------------
  4878     05  CLFREFNL PIC S9(0004) COMP.
  4879     05  CLFREFNF PIC  X(0001).
  4880     05  FILLER REDEFINES CLFREFNF.
  4881         10  CLFREFNA PIC  X(0001).
  4882     05  CLFREFNI PIC  X(0006).
  4883*    -------------------------------
  4884     05  CAHREFNL PIC S9(0004) COMP.
  4885     05  CAHREFNF PIC  X(0001).
  4886     05  FILLER REDEFINES CAHREFNF.
  4887         10  CAHREFNA PIC  X(0001).
  4888     05  CAHREFNI PIC  X(0006).
  4889*    -------------------------------
  4890     05  CREINCDL PIC S9(0004) COMP.
  4891     05  CREINCDF PIC  X(0001).
  4892     05  FILLER REDEFINES CREINCDF.
  4893         10  CREINCDA PIC  X(0001).
  4894     05  CREINCDI PIC  X(0003).
  4895*    -------------------------------
  4896     05  CAEFFDTL PIC S9(0004) COMP.
  4897     05  CAEFFDTF PIC  X(0001).
  4898     05  FILLER REDEFINES CAEFFDTF.
  4899         10  CAEFFDTA PIC  X(0001).
  4900     05  CAEFFDTI PIC  X(0008).
  4901*    -------------------------------
  4902     05  CAEXPDTL PIC S9(0004) COMP.
  4903     05  CAEXPDTF PIC  X(0001).
  4904     05  FILLER REDEFINES CAEXPDTF.
  4905         10  CAEXPDTA PIC  X(0001).
  4906     05  CAEXPDTI PIC  X(0008).
  4907*    -------------------------------
  4908     05  COMMLFL PIC S9(0004) COMP.
  4909     05  COMMLFF PIC  X(0001).
  4910     05  FILLER REDEFINES COMMLFF.
  4911         10  COMMLFA PIC  X(0001).
  4912     05  COMMLFI PIC  X(0006).
  4913*    -------------------------------
  4914     05  COMMAHL PIC S9(0004) COMP.
  4915     05  COMMAHF PIC  X(0001).
  4916     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  92
* EL6311.cbl
  4917         10  COMMAHA PIC  X(0001).
  4918     05  COMMAHI PIC  X(0006).
  4919*    -------------------------------
  4920     05  CERMSG1L PIC S9(0004) COMP.
  4921     05  CERMSG1F PIC  X(0001).
  4922     05  FILLER REDEFINES CERMSG1F.
  4923         10  CERMSG1A PIC  X(0001).
  4924     05  CERMSG1I PIC  X(0078).
  4925*    -------------------------------
  4926     05  CERMSG2L PIC S9(0004) COMP.
  4927     05  CERMSG2F PIC  X(0001).
  4928     05  FILLER REDEFINES CERMSG2F.
  4929         10  CERMSG2A PIC  X(0001).
  4930     05  CERMSG2I PIC  X(0078).
  4931*    -------------------------------
  4932     05  CERMSG3L PIC S9(0004) COMP.
  4933     05  CERMSG3F PIC  X(0001).
  4934     05  FILLER REDEFINES CERMSG3F.
  4935         10  CERMSG3A PIC  X(0001).
  4936     05  CERMSG3I PIC  X(0078).
  4937*    -------------------------------
  4938     05  CPFENTRL PIC S9(0004) COMP.
  4939     05  CPFENTRF PIC  X(0001).
  4940     05  FILLER REDEFINES CPFENTRF.
  4941         10  CPFENTRA PIC  X(0001).
  4942     05  CPFENTRI PIC  9(2).
  4943*    -------------------------------
  4944     05  CPF5HDRL PIC S9(0004) COMP.
  4945     05  CPF5HDRF PIC  X(0001).
  4946     05  FILLER REDEFINES CPF5HDRF.
  4947         10  CPF5HDRA PIC  X(0001).
  4948     05  CPF5HDRI PIC  X(0005).
  4949*    -------------------------------
  4950     05  CPF4HDRL PIC S9(0004) COMP.
  4951     05  CPF4HDRF PIC  X(0001).
  4952     05  FILLER REDEFINES CPF4HDRF.
  4953         10  CPF4HDRA PIC  X(0001).
  4954     05  CPF4HDRI PIC  X(0013).
  4955*    -------------------------------
  4956     05  CF15HDRL PIC S9(0004) COMP.
  4957     05  CF15HDRF PIC  X(0001).
  4958     05  FILLER REDEFINES CF15HDRF.
  4959         10  CF15HDRA PIC  X(0001).
  4960     05  CF15HDRI PIC  X(0022).
  4961 01  EL631CO REDEFINES EL631BI.
  4962     05  FILLER            PIC  X(0012).
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CDATEO PIC  X(0008).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CTIMEO PIC  99.99.
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CHEADO PIC  X(0038).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  93
* EL6311.cbl
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CCHGO PIC  ZZZ9.
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  CMAINTO PIC  X(0001).
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  CMANTBYO PIC  X(0004).
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  CCHGHDGO PIC  X(0003).
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CMANTDTO PIC  X(0008).
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CMANTATO PIC  99.99.
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CCSRO PIC  X(0004).
  4996*    -------------------------------
  4997     05  FILLER            PIC  X(0003).
  4998     05  CBATCHO PIC  X(0006).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CSEQO PIC  X(0004).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CMOENDTO PIC  X(0008).
  5005*    -------------------------------
  5006     05  FILLER            PIC  X(0003).
  5007     05  CCARRO PIC  X(0001).
  5008*    -------------------------------
  5009     05  FILLER            PIC  X(0003).
  5010     05  CGROUPO PIC  X(0006).
  5011*    -------------------------------
  5012     05  FILLER            PIC  X(0003).
  5013     05  CSTATEO PIC  X(0002).
  5014*    -------------------------------
  5015     05  FILLER            PIC  X(0003).
  5016     05  CACCTO PIC  X(0010).
  5017*    -------------------------------
  5018     05  FILLER            PIC  X(0003).
  5019     05  CORIGHDO PIC  X(0011).
  5020*    -------------------------------
  5021     05  FILLER            PIC  X(0003).
  5022     05  CORGNOO PIC  X(0006).
  5023*    -------------------------------
  5024     05  FILLER            PIC  X(0003).
  5025     05  CORGSEQO PIC  X(0004).
  5026*    -------------------------------
  5027     05  FILLER            PIC  X(0003).
  5028     05  CREFHDGO PIC  X(0010).
  5029*    -------------------------------
  5030     05  FILLER            PIC  X(0003).
  5031     05  CREFO PIC  X(0012).
  5032*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  94
* EL6311.cbl
  5033     05  FILLER            PIC  X(0003).
  5034     05  CNHINTO PIC  ZZZZZ9.99.
  5035*    -------------------------------
  5036     05  FILLER            PIC  X(0003).
  5037     05  CCERTNOO PIC  X(0010).
  5038*    -------------------------------
  5039     05  FILLER            PIC  X(0003).
  5040     05  CSUFIXO PIC  X(0001).
  5041*    -------------------------------
  5042     05  FILLER            PIC  X(0003).
  5043     05  CEFFDTO PIC  X(0008).
  5044*    -------------------------------
  5045     05  FILLER            PIC  X(0003).
  5046     05  CLSTNMO PIC  X(0015).
  5047*    -------------------------------
  5048     05  FILLER            PIC  X(0003).
  5049     05  CINAMEO PIC  X(0015).
  5050*    -------------------------------
  5051     05  FILLER            PIC  X(0003).
  5052     05  CINITSO PIC  X(0010).
  5053*    -------------------------------
  5054     05  FILLER            PIC  X(0003).
  5055     05  CCANREAO PIC  X(0001).
  5056*    -------------------------------
  5057     05  FILLER            PIC  X(0003).
  5058     05  ACTSPCO PIC  X(0001).
  5059*    -------------------------------
  5060     05  FILLER            PIC  X(0003).
  5061     05  CKIND1O PIC  X(0002).
  5062*    -------------------------------
  5063     05  FILLER            PIC  X(0003).
  5064     05  CCANDT1O PIC  X(0008).
  5065*    -------------------------------
  5066     05  FILLER            PIC  X(0003).
  5067     05  CREFND1O PIC  Z(7).99-.
  5068*    -------------------------------
  5069     05  FILLER            PIC  X(0003).
  5070     05  CMTHD1O PIC  X(0001).
  5071*    -------------------------------
  5072     05  FILLER            PIC  X(0003).
  5073     05  CKIND2O PIC  X(0002).
  5074*    -------------------------------
  5075     05  FILLER            PIC  X(0003).
  5076     05  CCANDT2O PIC  X(0008).
  5077*    -------------------------------
  5078     05  FILLER            PIC  X(0003).
  5079     05  CREFND2O PIC  Z(7).99-.
  5080*    -------------------------------
  5081     05  FILLER            PIC  X(0003).
  5082     05  CMTHD2O PIC  X(0001).
  5083*    -------------------------------
  5084     05  FILLER            PIC  X(0003).
  5085     05  CLIVESO PIC  X(0003).
  5086*    -------------------------------
  5087     05  FILLER            PIC  X(0003).
  5088     05  CFORCEO PIC  X(0001).
  5089*    -------------------------------
  5090     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  95
* EL6311.cbl
  5091     05  CBILCDO PIC  X(0001).
  5092*    -------------------------------
  5093     05  FILLER            PIC  X(0003).
  5094     05  CCRFND1O PIC  Z(7).99-.
  5095*    -------------------------------
  5096     05  FILLER            PIC  X(0003).
  5097     05  CCRFND2O PIC  Z(7).99-.
  5098*    -------------------------------
  5099     05  FILLER            PIC  X(0003).
  5100     05  CBILIT1O PIC  X(0008).
  5101*    -------------------------------
  5102     05  FILLER            PIC  X(0003).
  5103     05  CDRFND1O PIC  Z(7).99-.
  5104*    -------------------------------
  5105     05  FILLER            PIC  X(0003).
  5106     05  CBILIT2O PIC  X(0008).
  5107*    -------------------------------
  5108     05  FILLER            PIC  X(0003).
  5109     05  CDRFND2O PIC  Z(7).99-.
  5110*    -------------------------------
  5111     05  FILLER            PIC  X(0003).
  5112     05  CCANTXTO PIC  X(0005).
  5113*    -------------------------------
  5114     05  FILLER            PIC  X(0003).
  5115     05  CCANFEEO PIC  Z9.
  5116*    -------------------------------
  5117     05  FILLER            PIC  X(0003).
  5118     05  CTERM1O PIC  ZZ9.
  5119*    -------------------------------
  5120     05  FILLER            PIC  X(0003).
  5121     05  CRTERM1O PIC  ZZ9.
  5122*    -------------------------------
  5123     05  FILLER            PIC  X(0003).
  5124     05  CPREM1O PIC  ZZZZZZ9.99-.
  5125*    -------------------------------
  5126     05  FILLER            PIC  X(0003).
  5127     05  CTERM2O PIC  ZZ9.
  5128*    -------------------------------
  5129     05  FILLER            PIC  X(0003).
  5130     05  CRTERM2O PIC  ZZ9.
  5131*    -------------------------------
  5132     05  FILLER            PIC  X(0003).
  5133     05  CPREM2O PIC  ZZZZZZ9.99-.
  5134*    -------------------------------
  5135     05  FILLER            PIC  X(0003).
  5136     05  CENTRDTO PIC  X(0008).
  5137*    -------------------------------
  5138     05  FILLER            PIC  X(0003).
  5139     05  CPAYEEO PIC  X(0006).
  5140*    -------------------------------
  5141     05  FILLER            PIC  X(0003).
  5142     05  CRFNDSWO PIC  X(0003).
  5143*    -------------------------------
  5144     05  FILLER            PIC  X(0003).
  5145     05  CLFHDGO PIC  X(0006).
  5146*    -------------------------------
  5147     05  FILLER            PIC  X(0003).
  5148     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  96
* EL6311.cbl
  5149*    -------------------------------
  5150     05  FILLER            PIC  X(0003).
  5151     05  CENTDTO PIC  X(0008).
  5152*    -------------------------------
  5153     05  FILLER            PIC  X(0003).
  5154     05  CENTBYO PIC  X(0004).
  5155*    -------------------------------
  5156     05  FILLER            PIC  X(0003).
  5157     05  CCHGCNTO PIC  X(0003).
  5158*    -------------------------------
  5159     05  FILLER            PIC  X(0003).
  5160     05  CLFREFNO PIC  X(0006).
  5161*    -------------------------------
  5162     05  FILLER            PIC  X(0003).
  5163     05  CAHREFNO PIC  X(0006).
  5164*    -------------------------------
  5165     05  FILLER            PIC  X(0003).
  5166     05  CREINCDO PIC  X(0003).
  5167*    -------------------------------
  5168     05  FILLER            PIC  X(0003).
  5169     05  CAEFFDTO PIC  X(0008).
  5170*    -------------------------------
  5171     05  FILLER            PIC  X(0003).
  5172     05  CAEXPDTO PIC  X(0008).
  5173*    -------------------------------
  5174     05  FILLER            PIC  X(0003).
  5175     05  COMMLFO PIC  .99999.
  5176*    -------------------------------
  5177     05  FILLER            PIC  X(0003).
  5178     05  COMMAHO PIC  .99999.
  5179*    -------------------------------
  5180     05  FILLER            PIC  X(0003).
  5181     05  CERMSG1O PIC  X(0078).
  5182*    -------------------------------
  5183     05  FILLER            PIC  X(0003).
  5184     05  CERMSG2O PIC  X(0078).
  5185*    -------------------------------
  5186     05  FILLER            PIC  X(0003).
  5187     05  CERMSG3O PIC  X(0078).
  5188*    -------------------------------
  5189     05  FILLER            PIC  X(0003).
  5190     05  CPFENTRO PIC  X(0002).
  5191*    -------------------------------
  5192     05  FILLER            PIC  X(0003).
  5193     05  CPF5HDRO PIC  X(0005).
  5194*    -------------------------------
  5195     05  FILLER            PIC  X(0003).
  5196     05  CPF4HDRO PIC  X(0013).
  5197*    -------------------------------
  5198     05  FILLER            PIC  X(0003).
  5199     05  CF15HDRO PIC  X(0022).
  5200*    -------------------------------
  5201 01  EL631DI REDEFINES EL631BI.
  5202     05  FILLER            PIC  X(0012).
  5203*    -------------------------------
  5204     05  DDATEL PIC S9(0004) COMP.
  5205     05  DDATEF PIC  X(0001).
  5206     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  97
* EL6311.cbl
  5207         10  DDATEA PIC  X(0001).
  5208     05  DDATEI PIC  X(0008).
  5209*    -------------------------------
  5210     05  DTIMEL PIC S9(0004) COMP.
  5211     05  DTIMEF PIC  X(0001).
  5212     05  FILLER REDEFINES DTIMEF.
  5213         10  DTIMEA PIC  X(0001).
  5214     05  DTIMEI PIC  X(0005).
  5215*    -------------------------------
  5216     05  DHEADL PIC S9(0004) COMP.
  5217     05  DHEADF PIC  X(0001).
  5218     05  FILLER REDEFINES DHEADF.
  5219         10  DHEADA PIC  X(0001).
  5220     05  DHEADI PIC  X(0038).
  5221*    -------------------------------
  5222     05  DLDATEL PIC S9(0004) COMP.
  5223     05  DLDATEF PIC  X(0001).
  5224     05  FILLER REDEFINES DLDATEF.
  5225         10  DLDATEA PIC  X(0001).
  5226     05  DLDATEI PIC  X(0010).
  5227*    -------------------------------
  5228     05  DBATCHL PIC S9(0004) COMP.
  5229     05  DBATCHF PIC  X(0001).
  5230     05  FILLER REDEFINES DBATCHF.
  5231         10  DBATCHA PIC  X(0001).
  5232     05  DBATCHI PIC  X(0011).
  5233*    -------------------------------
  5234     05  DACCTNML PIC S9(0004) COMP.
  5235     05  DACCTNMF PIC  X(0001).
  5236     05  FILLER REDEFINES DACCTNMF.
  5237         10  DACCTNMA PIC  X(0001).
  5238     05  DACCTNMI PIC  X(0030).
  5239*    -------------------------------
  5240     05  DPROCDTL PIC S9(0004) COMP.
  5241     05  DPROCDTF PIC  X(0001).
  5242     05  FILLER REDEFINES DPROCDTF.
  5243         10  DPROCDTA PIC  X(0001).
  5244     05  DPROCDTI PIC  X(0008).
  5245*    -------------------------------
  5246     05  DINPUTL PIC S9(0004) COMP.
  5247     05  DINPUTF PIC  X(0001).
  5248     05  FILLER REDEFINES DINPUTF.
  5249         10  DINPUTA PIC  X(0001).
  5250     05  DINPUTI PIC  X(0008).
  5251*    -------------------------------
  5252     05  DMAINDTL PIC S9(0004) COMP.
  5253     05  DMAINDTF PIC  X(0001).
  5254     05  FILLER REDEFINES DMAINDTF.
  5255         10  DMAINDTA PIC  X(0001).
  5256     05  DMAINDTI PIC  X(0008).
  5257*    -------------------------------
  5258     05  DCARRL PIC S9(0004) COMP.
  5259     05  DCARRF PIC  X(0001).
  5260     05  FILLER REDEFINES DCARRF.
  5261         10  DCARRA PIC  X(0001).
  5262     05  DCARRI PIC  X(0001).
  5263*    -------------------------------
  5264     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  98
* EL6311.cbl
  5265     05  DGROUPF PIC  X(0001).
  5266     05  FILLER REDEFINES DGROUPF.
  5267         10  DGROUPA PIC  X(0001).
  5268     05  DGROUPI PIC  X(0006).
  5269*    -------------------------------
  5270     05  DSTATEL PIC S9(0004) COMP.
  5271     05  DSTATEF PIC  X(0001).
  5272     05  FILLER REDEFINES DSTATEF.
  5273         10  DSTATEA PIC  X(0001).
  5274     05  DSTATEI PIC  X(0002).
  5275*    -------------------------------
  5276     05  DACCTL PIC S9(0004) COMP.
  5277     05  DACCTF PIC  X(0001).
  5278     05  FILLER REDEFINES DACCTF.
  5279         10  DACCTA PIC  X(0001).
  5280     05  DACCTI PIC  X(0010).
  5281*    -------------------------------
  5282     05  DRECVDTL PIC S9(0004) COMP.
  5283     05  DRECVDTF PIC  X(0001).
  5284     05  FILLER REDEFINES DRECVDTF.
  5285         10  DRECVDTA PIC  X(0001).
  5286     05  DRECVDTI PIC  X(0008).
  5287*    -------------------------------
  5288     05  DCSRL PIC S9(0004) COMP.
  5289     05  DCSRF PIC  X(0001).
  5290     05  FILLER REDEFINES DCSRF.
  5291         10  DCSRA PIC  X(0001).
  5292     05  DCSRI PIC  X(0004).
  5293*    -------------------------------
  5294     05  DREFHDGL PIC S9(0004) COMP.
  5295     05  DREFHDGF PIC  X(0001).
  5296     05  FILLER REDEFINES DREFHDGF.
  5297         10  DREFHDGA PIC  X(0001).
  5298     05  DREFHDGI PIC  X(0010).
  5299*    -------------------------------
  5300     05  DREFL PIC S9(0004) COMP.
  5301     05  DREFF PIC  X(0001).
  5302     05  FILLER REDEFINES DREFF.
  5303         10  DREFA PIC  X(0001).
  5304     05  DREFI PIC  X(0012).
  5305*    -------------------------------
  5306     05  DLFPHDGL PIC S9(0004) COMP.
  5307     05  DLFPHDGF PIC  X(0001).
  5308     05  FILLER REDEFINES DLFPHDGF.
  5309         10  DLFPHDGA PIC  X(0001).
  5310     05  DLFPHDGI PIC  X(0010).
  5311*    -------------------------------
  5312     05  DAHPHDGL PIC S9(0004) COMP.
  5313     05  DAHPHDGF PIC  X(0001).
  5314     05  FILLER REDEFINES DAHPHDGF.
  5315         10  DAHPHDGA PIC  X(0001).
  5316     05  DAHPHDGI PIC  X(0010).
  5317*    -------------------------------
  5318     05  DLFRHDGL PIC S9(0004) COMP.
  5319     05  DLFRHDGF PIC  X(0001).
  5320     05  FILLER REDEFINES DLFRHDGF.
  5321         10  DLFRHDGA PIC  X(0001).
  5322     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page  99
* EL6311.cbl
  5323*    -------------------------------
  5324     05  DAHRHDGL PIC S9(0004) COMP.
  5325     05  DAHRHDGF PIC  X(0001).
  5326     05  FILLER REDEFINES DAHRHDGF.
  5327         10  DAHRHDGA PIC  X(0001).
  5328     05  DAHRHDGI PIC  X(0009).
  5329*    -------------------------------
  5330     05  DRISSL PIC S9(0004) COMP.
  5331     05  DRISSF PIC  X(0001).
  5332     05  FILLER REDEFINES DRISSF.
  5333         10  DRISSA PIC  X(0001).
  5334     05  DRISSI PIC  X(0005).
  5335*    -------------------------------
  5336     05  DRLFPRML PIC S9(0004) COMP.
  5337     05  DRLFPRMF PIC  X(0001).
  5338     05  FILLER REDEFINES DRLFPRMF.
  5339         10  DRLFPRMA PIC  X(0001).
  5340     05  DRLFPRMI PIC  S9(9)V99.
  5341*    -------------------------------
  5342     05  DRAHPRML PIC S9(0004) COMP.
  5343     05  DRAHPRMF PIC  X(0001).
  5344     05  FILLER REDEFINES DRAHPRMF.
  5345         10  DRAHPRMA PIC  X(0001).
  5346     05  DRAHPRMI PIC  S9(9)V99.
  5347*    -------------------------------
  5348     05  DRCANCL PIC S9(0004) COMP.
  5349     05  DRCANCF PIC  X(0001).
  5350     05  FILLER REDEFINES DRCANCF.
  5351         10  DRCANCA PIC  X(0001).
  5352     05  DRCANCI PIC  X(0005).
  5353*    -------------------------------
  5354     05  DRLFRFDL PIC S9(0004) COMP.
  5355     05  DRLFRFDF PIC  X(0001).
  5356     05  FILLER REDEFINES DRLFRFDF.
  5357         10  DRLFRFDA PIC  X(0001).
  5358     05  DRLFRFDI PIC  S9(9)V99.
  5359*    -------------------------------
  5360     05  DRAHRFDL PIC S9(0004) COMP.
  5361     05  DRAHRFDF PIC  X(0001).
  5362     05  FILLER REDEFINES DRAHRFDF.
  5363         10  DRAHRFDA PIC  X(0001).
  5364     05  DRAHRFDI PIC  S9(9)V99.
  5365*    -------------------------------
  5366     05  DEISSL PIC S9(0004) COMP.
  5367     05  DEISSF PIC  X(0001).
  5368     05  FILLER REDEFINES DEISSF.
  5369         10  DEISSA PIC  X(0001).
  5370     05  DEISSI PIC  X(0005).
  5371*    -------------------------------
  5372     05  DELFPRML PIC S9(0004) COMP.
  5373     05  DELFPRMF PIC  X(0001).
  5374     05  FILLER REDEFINES DELFPRMF.
  5375         10  DELFPRMA PIC  X(0001).
  5376     05  DELFPRMI PIC  X(0011).
  5377*    -------------------------------
  5378     05  DEAHPRML PIC S9(0004) COMP.
  5379     05  DEAHPRMF PIC  X(0001).
  5380     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 100
* EL6311.cbl
  5381         10  DEAHPRMA PIC  X(0001).
  5382     05  DEAHPRMI PIC  X(0011).
  5383*    -------------------------------
  5384     05  DECANCL PIC S9(0004) COMP.
  5385     05  DECANCF PIC  X(0001).
  5386     05  FILLER REDEFINES DECANCF.
  5387         10  DECANCA PIC  X(0001).
  5388     05  DECANCI PIC  X(0005).
  5389*    -------------------------------
  5390     05  DELFRFDL PIC S9(0004) COMP.
  5391     05  DELFRFDF PIC  X(0001).
  5392     05  FILLER REDEFINES DELFRFDF.
  5393         10  DELFRFDA PIC  X(0001).
  5394     05  DELFRFDI PIC  X(0011).
  5395*    -------------------------------
  5396     05  DEAHRFDL PIC S9(0004) COMP.
  5397     05  DEAHRFDF PIC  X(0001).
  5398     05  FILLER REDEFINES DEAHRFDF.
  5399         10  DEAHRFDA PIC  X(0001).
  5400     05  DEAHRFDI PIC  X(0011).
  5401*    -------------------------------
  5402     05  DCISSL PIC S9(0004) COMP.
  5403     05  DCISSF PIC  X(0001).
  5404     05  FILLER REDEFINES DCISSF.
  5405         10  DCISSA PIC  X(0001).
  5406     05  DCISSI PIC  X(0005).
  5407*    -------------------------------
  5408     05  DCLFPRML PIC S9(0004) COMP.
  5409     05  DCLFPRMF PIC  X(0001).
  5410     05  FILLER REDEFINES DCLFPRMF.
  5411         10  DCLFPRMA PIC  X(0001).
  5412     05  DCLFPRMI PIC  X(0011).
  5413*    -------------------------------
  5414     05  DCAHPRML PIC S9(0004) COMP.
  5415     05  DCAHPRMF PIC  X(0001).
  5416     05  FILLER REDEFINES DCAHPRMF.
  5417         10  DCAHPRMA PIC  X(0001).
  5418     05  DCAHPRMI PIC  X(0011).
  5419*    -------------------------------
  5420     05  DCCANCL PIC S9(0004) COMP.
  5421     05  DCCANCF PIC  X(0001).
  5422     05  FILLER REDEFINES DCCANCF.
  5423         10  DCCANCA PIC  X(0001).
  5424     05  DCCANCI PIC  X(0005).
  5425*    -------------------------------
  5426     05  DCLFRFDL PIC S9(0004) COMP.
  5427     05  DCLFRFDF PIC  X(0001).
  5428     05  FILLER REDEFINES DCLFRFDF.
  5429         10  DCLFRFDA PIC  X(0001).
  5430     05  DCLFRFDI PIC  X(0011).
  5431*    -------------------------------
  5432     05  DCAHRFDL PIC S9(0004) COMP.
  5433     05  DCAHRFDF PIC  X(0001).
  5434     05  FILLER REDEFINES DCAHRFDF.
  5435         10  DCAHRFDA PIC  X(0001).
  5436     05  DCAHRFDI PIC  X(0011).
  5437*    -------------------------------
  5438     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 101
* EL6311.cbl
  5439     05  DOISSF PIC  X(0001).
  5440     05  FILLER REDEFINES DOISSF.
  5441         10  DOISSA PIC  X(0001).
  5442     05  DOISSI PIC  X(0005).
  5443*    -------------------------------
  5444     05  DOLFPRML PIC S9(0004) COMP.
  5445     05  DOLFPRMF PIC  X(0001).
  5446     05  FILLER REDEFINES DOLFPRMF.
  5447         10  DOLFPRMA PIC  X(0001).
  5448     05  DOLFPRMI PIC  X(0011).
  5449*    -------------------------------
  5450     05  DOAHPRML PIC S9(0004) COMP.
  5451     05  DOAHPRMF PIC  X(0001).
  5452     05  FILLER REDEFINES DOAHPRMF.
  5453         10  DOAHPRMA PIC  X(0001).
  5454     05  DOAHPRMI PIC  X(0011).
  5455*    -------------------------------
  5456     05  DOCANCL PIC S9(0004) COMP.
  5457     05  DOCANCF PIC  X(0001).
  5458     05  FILLER REDEFINES DOCANCF.
  5459         10  DOCANCA PIC  X(0001).
  5460     05  DOCANCI PIC  X(0005).
  5461*    -------------------------------
  5462     05  DOLFRFDL PIC S9(0004) COMP.
  5463     05  DOLFRFDF PIC  X(0001).
  5464     05  FILLER REDEFINES DOLFRFDF.
  5465         10  DOLFRFDA PIC  X(0001).
  5466     05  DOLFRFDI PIC  X(0011).
  5467*    -------------------------------
  5468     05  DOAHRFDL PIC S9(0004) COMP.
  5469     05  DOAHRFDF PIC  X(0001).
  5470     05  FILLER REDEFINES DOAHRFDF.
  5471         10  DOAHRFDA PIC  X(0001).
  5472     05  DOAHRFDI PIC  X(0011).
  5473*    -------------------------------
  5474     05  DITOTALL PIC S9(0004) COMP.
  5475     05  DITOTALF PIC  X(0001).
  5476     05  FILLER REDEFINES DITOTALF.
  5477         10  DITOTALA PIC  X(0001).
  5478     05  DITOTALI PIC  X(0005).
  5479*    -------------------------------
  5480     05  DIFATALL PIC S9(0004) COMP.
  5481     05  DIFATALF PIC  X(0001).
  5482     05  FILLER REDEFINES DIFATALF.
  5483         10  DIFATALA PIC  X(0001).
  5484     05  DIFATALI PIC  X(0005).
  5485*    -------------------------------
  5486     05  DIFORCEL PIC S9(0004) COMP.
  5487     05  DIFORCEF PIC  X(0001).
  5488     05  FILLER REDEFINES DIFORCEF.
  5489         10  DIFORCEA PIC  X(0001).
  5490     05  DIFORCEI PIC  X(0005).
  5491*    -------------------------------
  5492     05  DIHOLDL PIC S9(0004) COMP.
  5493     05  DIHOLDF PIC  X(0001).
  5494     05  FILLER REDEFINES DIHOLDF.
  5495         10  DIHOLDA PIC  X(0001).
  5496     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 102
* EL6311.cbl
  5497*    -------------------------------
  5498     05  DIAVAILL PIC S9(0004) COMP.
  5499     05  DIAVAILF PIC  X(0001).
  5500     05  FILLER REDEFINES DIAVAILF.
  5501         10  DIAVAILA PIC  X(0001).
  5502     05  DIAVAILI PIC  X(0005).
  5503*    -------------------------------
  5504     05  DIGPREML PIC S9(0004) COMP.
  5505     05  DIGPREMF PIC  X(0001).
  5506     05  FILLER REDEFINES DIGPREMF.
  5507         10  DIGPREMA PIC  X(0001).
  5508     05  DIGPREMI PIC  X(0011).
  5509*    -------------------------------
  5510     05  DIBPREML PIC S9(0004) COMP.
  5511     05  DIBPREMF PIC  X(0001).
  5512     05  FILLER REDEFINES DIBPREMF.
  5513         10  DIBPREMA PIC  X(0001).
  5514     05  DIBPREMI PIC  X(0011).
  5515*    -------------------------------
  5516     05  DCTOTALL PIC S9(0004) COMP.
  5517     05  DCTOTALF PIC  X(0001).
  5518     05  FILLER REDEFINES DCTOTALF.
  5519         10  DCTOTALA PIC  X(0001).
  5520     05  DCTOTALI PIC  X(0005).
  5521*    -------------------------------
  5522     05  DCFATALL PIC S9(0004) COMP.
  5523     05  DCFATALF PIC  X(0001).
  5524     05  FILLER REDEFINES DCFATALF.
  5525         10  DCFATALA PIC  X(0001).
  5526     05  DCFATALI PIC  X(0005).
  5527*    -------------------------------
  5528     05  DCFORCEL PIC S9(0004) COMP.
  5529     05  DCFORCEF PIC  X(0001).
  5530     05  FILLER REDEFINES DCFORCEF.
  5531         10  DCFORCEA PIC  X(0001).
  5532     05  DCFORCEI PIC  X(0005).
  5533*    -------------------------------
  5534     05  DCHOLDL PIC S9(0004) COMP.
  5535     05  DCHOLDF PIC  X(0001).
  5536     05  FILLER REDEFINES DCHOLDF.
  5537         10  DCHOLDA PIC  X(0001).
  5538     05  DCHOLDI PIC  X(0005).
  5539*    -------------------------------
  5540     05  DCAVAILL PIC S9(0004) COMP.
  5541     05  DCAVAILF PIC  X(0001).
  5542     05  FILLER REDEFINES DCAVAILF.
  5543         10  DCAVAILA PIC  X(0001).
  5544     05  DCAVAILI PIC  X(0005).
  5545*    -------------------------------
  5546     05  DCGPREML PIC S9(0004) COMP.
  5547     05  DCGPREMF PIC  X(0001).
  5548     05  FILLER REDEFINES DCGPREMF.
  5549         10  DCGPREMA PIC  X(0001).
  5550     05  DCGPREMI PIC  X(0011).
  5551*    -------------------------------
  5552     05  DCBPREML PIC S9(0004) COMP.
  5553     05  DCBPREMF PIC  X(0001).
  5554     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 103
* EL6311.cbl
  5555         10  DCBPREMA PIC  X(0001).
  5556     05  DCBPREMI PIC  X(0011).
  5557*    -------------------------------
  5558     05  DNTOTALL PIC S9(0004) COMP.
  5559     05  DNTOTALF PIC  X(0001).
  5560     05  FILLER REDEFINES DNTOTALF.
  5561         10  DNTOTALA PIC  X(0001).
  5562     05  DNTOTALI PIC  X(0005).
  5563*    -------------------------------
  5564     05  DNFATALL PIC S9(0004) COMP.
  5565     05  DNFATALF PIC  X(0001).
  5566     05  FILLER REDEFINES DNFATALF.
  5567         10  DNFATALA PIC  X(0001).
  5568     05  DNFATALI PIC  X(0005).
  5569*    -------------------------------
  5570     05  DNFORCEL PIC S9(0004) COMP.
  5571     05  DNFORCEF PIC  X(0001).
  5572     05  FILLER REDEFINES DNFORCEF.
  5573         10  DNFORCEA PIC  X(0001).
  5574     05  DNFORCEI PIC  X(0005).
  5575*    -------------------------------
  5576     05  DNHOLDL PIC S9(0004) COMP.
  5577     05  DNHOLDF PIC  X(0001).
  5578     05  FILLER REDEFINES DNHOLDF.
  5579         10  DNHOLDA PIC  X(0001).
  5580     05  DNHOLDI PIC  X(0005).
  5581*    -------------------------------
  5582     05  DNAVAILL PIC S9(0004) COMP.
  5583     05  DNAVAILF PIC  X(0001).
  5584     05  FILLER REDEFINES DNAVAILF.
  5585         10  DNAVAILA PIC  X(0001).
  5586     05  DNAVAILI PIC  X(0005).
  5587*    -------------------------------
  5588     05  DNGPREML PIC S9(0004) COMP.
  5589     05  DNGPREMF PIC  X(0001).
  5590     05  FILLER REDEFINES DNGPREMF.
  5591         10  DNGPREMA PIC  X(0001).
  5592     05  DNGPREMI PIC  X(0011).
  5593*    -------------------------------
  5594     05  DNBPREML PIC S9(0004) COMP.
  5595     05  DNBPREMF PIC  X(0001).
  5596     05  FILLER REDEFINES DNBPREMF.
  5597         10  DNBPREMA PIC  X(0001).
  5598     05  DNBPREMI PIC  X(0011).
  5599*    -------------------------------
  5600     05  DERMSGL PIC S9(0004) COMP.
  5601     05  DERMSGF PIC  X(0001).
  5602     05  FILLER REDEFINES DERMSGF.
  5603         10  DERMSGA PIC  X(0001).
  5604     05  DERMSGI PIC  X(0075).
  5605*    -------------------------------
  5606     05  DPFENTRL PIC S9(0004) COMP.
  5607     05  DPFENTRF PIC  X(0001).
  5608     05  FILLER REDEFINES DPFENTRF.
  5609         10  DPFENTRA PIC  X(0001).
  5610     05  DPFENTRI PIC  9(2).
  5611 01  EL631DO REDEFINES EL631BI.
  5612     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 104
* EL6311.cbl
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DDATEO PIC  X(0008).
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DTIMEO PIC  99.99.
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DHEADO PIC  X(0038).
  5622*    -------------------------------
  5623     05  FILLER            PIC  X(0003).
  5624     05  DLDATEO PIC  X(0010).
  5625*    -------------------------------
  5626     05  FILLER            PIC  X(0003).
  5627     05  DBATCHO PIC  X(0011).
  5628*    -------------------------------
  5629     05  FILLER            PIC  X(0003).
  5630     05  DACCTNMO PIC  X(0030).
  5631*    -------------------------------
  5632     05  FILLER            PIC  X(0003).
  5633     05  DPROCDTO PIC  X(0008).
  5634*    -------------------------------
  5635     05  FILLER            PIC  X(0003).
  5636     05  DINPUTO PIC  X(0008).
  5637*    -------------------------------
  5638     05  FILLER            PIC  X(0003).
  5639     05  DMAINDTO PIC  X(0008).
  5640*    -------------------------------
  5641     05  FILLER            PIC  X(0003).
  5642     05  DCARRO PIC  X(0001).
  5643*    -------------------------------
  5644     05  FILLER            PIC  X(0003).
  5645     05  DGROUPO PIC  X(0006).
  5646*    -------------------------------
  5647     05  FILLER            PIC  X(0003).
  5648     05  DSTATEO PIC  X(0002).
  5649*    -------------------------------
  5650     05  FILLER            PIC  X(0003).
  5651     05  DACCTO PIC  X(0010).
  5652*    -------------------------------
  5653     05  FILLER            PIC  X(0003).
  5654     05  DRECVDTO PIC  X(0008).
  5655*    -------------------------------
  5656     05  FILLER            PIC  X(0003).
  5657     05  DCSRO PIC  X(0004).
  5658*    -------------------------------
  5659     05  FILLER            PIC  X(0003).
  5660     05  DREFHDGO PIC  X(0010).
  5661*    -------------------------------
  5662     05  FILLER            PIC  X(0003).
  5663     05  DREFO PIC  X(0012).
  5664*    -------------------------------
  5665     05  FILLER            PIC  X(0003).
  5666     05  DLFPHDGO PIC  X(0010).
  5667*    -------------------------------
  5668     05  FILLER            PIC  X(0003).
  5669     05  DAHPHDGO PIC  X(0010).
  5670*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 105
* EL6311.cbl
  5671     05  FILLER            PIC  X(0003).
  5672     05  DLFRHDGO PIC  X(0009).
  5673*    -------------------------------
  5674     05  FILLER            PIC  X(0003).
  5675     05  DAHRHDGO PIC  X(0009).
  5676*    -------------------------------
  5677     05  FILLER            PIC  X(0003).
  5678     05  DRISSO PIC  ZZ99-.
  5679*    -------------------------------
  5680     05  FILLER            PIC  X(0003).
  5681     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5682*    -------------------------------
  5683     05  FILLER            PIC  X(0003).
  5684     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5685*    -------------------------------
  5686     05  FILLER            PIC  X(0003).
  5687     05  DRCANCO PIC  ZZ99-.
  5688*    -------------------------------
  5689     05  FILLER            PIC  X(0003).
  5690     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5691*    -------------------------------
  5692     05  FILLER            PIC  X(0003).
  5693     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5694*    -------------------------------
  5695     05  FILLER            PIC  X(0003).
  5696     05  DEISSO PIC  ZZ99-.
  5697*    -------------------------------
  5698     05  FILLER            PIC  X(0003).
  5699     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5700*    -------------------------------
  5701     05  FILLER            PIC  X(0003).
  5702     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5703*    -------------------------------
  5704     05  FILLER            PIC  X(0003).
  5705     05  DECANCO PIC  ZZ99-.
  5706*    -------------------------------
  5707     05  FILLER            PIC  X(0003).
  5708     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5709*    -------------------------------
  5710     05  FILLER            PIC  X(0003).
  5711     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5712*    -------------------------------
  5713     05  FILLER            PIC  X(0003).
  5714     05  DCISSO PIC  ZZ99-.
  5715*    -------------------------------
  5716     05  FILLER            PIC  X(0003).
  5717     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5718*    -------------------------------
  5719     05  FILLER            PIC  X(0003).
  5720     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5721*    -------------------------------
  5722     05  FILLER            PIC  X(0003).
  5723     05  DCCANCO PIC  ZZ99-.
  5724*    -------------------------------
  5725     05  FILLER            PIC  X(0003).
  5726     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5727*    -------------------------------
  5728     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 106
* EL6311.cbl
  5729     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5730*    -------------------------------
  5731     05  FILLER            PIC  X(0003).
  5732     05  DOISSO PIC  ZZ99-.
  5733*    -------------------------------
  5734     05  FILLER            PIC  X(0003).
  5735     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5736*    -------------------------------
  5737     05  FILLER            PIC  X(0003).
  5738     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5739*    -------------------------------
  5740     05  FILLER            PIC  X(0003).
  5741     05  DOCANCO PIC  ZZ99-.
  5742*    -------------------------------
  5743     05  FILLER            PIC  X(0003).
  5744     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5745*    -------------------------------
  5746     05  FILLER            PIC  X(0003).
  5747     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5748*    -------------------------------
  5749     05  FILLER            PIC  X(0003).
  5750     05  DITOTALO PIC  ZZZ99.
  5751*    -------------------------------
  5752     05  FILLER            PIC  X(0003).
  5753     05  DIFATALO PIC  ZZZ99.
  5754*    -------------------------------
  5755     05  FILLER            PIC  X(0003).
  5756     05  DIFORCEO PIC  ZZZ99.
  5757*    -------------------------------
  5758     05  FILLER            PIC  X(0003).
  5759     05  DIHOLDO PIC  ZZZ99.
  5760*    -------------------------------
  5761     05  FILLER            PIC  X(0003).
  5762     05  DIAVAILO PIC  ZZZ99.
  5763*    -------------------------------
  5764     05  FILLER            PIC  X(0003).
  5765     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5766*    -------------------------------
  5767     05  FILLER            PIC  X(0003).
  5768     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5769*    -------------------------------
  5770     05  FILLER            PIC  X(0003).
  5771     05  DCTOTALO PIC  ZZZ99.
  5772*    -------------------------------
  5773     05  FILLER            PIC  X(0003).
  5774     05  DCFATALO PIC  ZZZ99.
  5775*    -------------------------------
  5776     05  FILLER            PIC  X(0003).
  5777     05  DCFORCEO PIC  ZZZ99.
  5778*    -------------------------------
  5779     05  FILLER            PIC  X(0003).
  5780     05  DCHOLDO PIC  ZZZ99.
  5781*    -------------------------------
  5782     05  FILLER            PIC  X(0003).
  5783     05  DCAVAILO PIC  ZZZ99.
  5784*    -------------------------------
  5785     05  FILLER            PIC  X(0003).
  5786     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 107
* EL6311.cbl
  5787*    -------------------------------
  5788     05  FILLER            PIC  X(0003).
  5789     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5790*    -------------------------------
  5791     05  FILLER            PIC  X(0003).
  5792     05  DNTOTALO PIC  ---99.
  5793*    -------------------------------
  5794     05  FILLER            PIC  X(0003).
  5795     05  DNFATALO PIC  ---99.
  5796*    -------------------------------
  5797     05  FILLER            PIC  X(0003).
  5798     05  DNFORCEO PIC  ---99.
  5799*    -------------------------------
  5800     05  FILLER            PIC  X(0003).
  5801     05  DNHOLDO PIC  ---99.
  5802*    -------------------------------
  5803     05  FILLER            PIC  X(0003).
  5804     05  DNAVAILO PIC  ---99.
  5805*    -------------------------------
  5806     05  FILLER            PIC  X(0003).
  5807     05  DNGPREMO PIC  -------9.99.
  5808*    -------------------------------
  5809     05  FILLER            PIC  X(0003).
  5810     05  DNBPREMO PIC  -------9.99.
  5811*    -------------------------------
  5812     05  FILLER            PIC  X(0003).
  5813     05  DERMSGO PIC  X(0075).
  5814*    -------------------------------
  5815     05  FILLER            PIC  X(0003).
  5816     05  DPFENTRO PIC  X(0002).
  5817*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 108
* EL6311.cbl
  5819 01  MAP-B REDEFINES EL631BI.
  5820     12  FILLER                  PIC X(595).
  5821*    12  FILLER                  PIC X(591).
  5822*    12  FILLER                  PIC X(512).
  5823*    12  FILLER                  PIC X(510).
  5824     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5825         16  BKIND-LEN               PIC S9(4)  COMP.
  5826         16  BKIND-ATTRB             PIC X.
  5827         16  BKIND                   PIC XX.
  5828         16  BTYPE-LEN               PIC S9(4)  COMP.
  5829         16  BTYPE-ATTRB             PIC X.
  5830         16  BTYPE                   PIC X(3).
  5831         16  BTERM-LEN               PIC S9(4)  COMP.
  5832         16  BTERM-ATTRB             PIC X.
  5833         16  BTERMI                  PIC 999.
  5834         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5835         16  BBEN-LEN                PIC S9(4)  COMP.
  5836         16  BBEN-ATTRB              PIC X.
  5837         16  BBENI                   PIC 9(10)V99.
  5838*        16  BBENI                   PIC 9(12).
  5839         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5840         16  BPREM-LEN               PIC S9(4)  COMP.
  5841         16  BPREM-ATTRB             PIC X.
  5842         16  BPREMI                  PIC S9(9)V99.
  5843*        16  BPREMI                  PIC 9(11).
  5844         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5845         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5846         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5847         16  BEXPIRE-ATTRB           PIC X.
  5848         16  BEXPIRE                 PIC X(8).
  5849         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5850         16  BCRIT-PERD-ATTRB        PIC X.
  5851         16  BCRIT-PERDI             PIC 99.
  5852         16  BCRIT-PERDO REDEFINES
  5853                         BCRIT-PERDI PIC ZZ.
  5854         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5855         16  BALT-BEN-ATTRB          PIC X.
  5856         16  BALT-BENI               PIC 9(10)V99.
  5857*        16  BALT-BENI               PIC 9(12).
  5858         16  BALT-BENO REDEFINES
  5859                           BALT-BENI PIC Z(9).ZZ.
  5860         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5861         16  BALT-PREM-ATTRB         PIC X.
  5862         16  BALT-PREMI              PIC 9(9)V99.
  5863*        16  BALT-PREMI              PIC 9(11).
  5864         16  BALT-PREMO REDEFINES
  5865                          BALT-PREMI PIC Z(7).ZZ-.
  5866         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5867         16  BBEN-CD-ATTRB           PIC X.
  5868         16  BBEN-CD                 PIC XXX.
  5869         16  BCPREM-LEN              PIC S9(4)  COMP.
  5870         16  BCPREM-ATTRB            PIC X.
  5871         16  BCPREMI                 PIC S9(9)V99.
  5872*        16  BCPREMI                 PIC X(11).
  5873         16  BCPREMO REDEFINES BCPREMI
  5874                                     PIC Z(7).99-.
  5875         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5876         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 109
* EL6311.cbl
  5877         16  BCALT-PREM              PIC Z(7).99-.
  5878         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5879         16  BBEN-ABBR-ATTRB         PIC X.
  5880         16  BBEN-ABBR               PIC X(5).
  5881         16  BDIFF-LEN               PIC S9(4)  COMP.
  5882         16  BDIFF-ATTRB             PIC X.
  5883         16  BDIFFO                  PIC Z(7).99-.
  5884         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5885         16  BBILL-LIT-ATTRB         PIC X.
  5886         16  BBILL-LIT               PIC X(8).
  5887         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5888         16  BDALT-PREM-ATTRB        PIC X.
  5889         16  BDALT-PREM              PIC Z(7).99-.
  5890
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 110
* EL6311.cbl
  5892
  5893****************************************************************
  5894*
  5895* Copyright (c) 2007-2013 Dell Inc.
  5896* All rights reserved.
  5897*
  5898****************************************************************
  5899 01  DFHEIV.
  5900   02  DFHEIV0               PIC X(35).
  5901   02  DFHEIV1               PIC X(08).
  5902   02  DFHEIV2               PIC X(08).
  5903   02  DFHEIV3               PIC X(08).
  5904   02  DFHEIV4               PIC X(06).
  5905   02  DFHEIV5               PIC X(04).
  5906   02  DFHEIV6               PIC X(04).
  5907   02  DFHEIV7               PIC X(02).
  5908   02  DFHEIV8               PIC X(02).
  5909   02  DFHEIV9               PIC X(01).
  5910   02  DFHEIV10              PIC S9(7) COMP-3.
  5911   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5912   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5913   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5914   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5915   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5916   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5917   02  DFHEIV17              PIC X(04).
  5918   02  DFHEIV18              PIC X(04).
  5919   02  DFHEIV19              PIC X(04).
  5920   02  DFHEIV20              USAGE IS POINTER.
  5921   02  DFHEIV21              USAGE IS POINTER.
  5922   02  DFHEIV22              USAGE IS POINTER.
  5923   02  DFHEIV23              USAGE IS POINTER.
  5924   02  DFHEIV24              USAGE IS POINTER.
  5925   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5926   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5927   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5928   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5929   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5930   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5931   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5932   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5933   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5934   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5935   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5936   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5937   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5938   02  FILLER                PIC X(02).
  5939   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5940   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5941   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5942   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5943   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5944   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5945   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5946 LINKAGE  SECTION.
  5947*****************************************************************
  5948*                                                               *
  5949* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 111
* EL6311.cbl
  5950* All rights reserved.                                          *
  5951*                                                               *
  5952*****************************************************************
  5953 01  dfheiblk.
  5954     02  eibtime          pic s9(7) comp-3.
  5955     02  eibdate          pic s9(7) comp-3.
  5956     02  eibtrnid         pic x(4).
  5957     02  eibtaskn         pic s9(7) comp-3.
  5958     02  eibtrmid         pic x(4).
  5959     02  dfheigdi         pic s9(4) comp.
  5960     02  eibcposn         pic s9(4) comp.
  5961     02  eibcalen         pic s9(4) comp.
  5962     02  eibaid           pic x(1).
  5963     02  eibfiller1       pic x(1).
  5964     02  eibfn            pic x(2).
  5965     02  eibfiller2       pic x(2).
  5966     02  eibrcode         pic x(6).
  5967     02  eibfiller3       pic x(2).
  5968     02  eibds            pic x(8).
  5969     02  eibreqid         pic x(8).
  5970     02  eibrsrce         pic x(8).
  5971     02  eibsync          pic x(1).
  5972     02  eibfree          pic x(1).
  5973     02  eibrecv          pic x(1).
  5974     02  eibsend          pic x(1).
  5975     02  eibatt           pic x(1).
  5976     02  eibeoc           pic x(1).
  5977     02  eibfmh           pic x(1).
  5978     02  eibcompl         pic x(1).
  5979     02  eibsig           pic x(1).
  5980     02  eibconf          pic x(1).
  5981     02  eiberr           pic x(1).
  5982     02  eibrldbk         pic x(1).
  5983     02  eiberrcd         pic x(4).
  5984     02  eibsynrb         pic x(1).
  5985     02  eibnodat         pic x(1).
  5986     02  eibfiller5       pic x(2).
  5987     02  eibresp          pic s9(8) comp.
  5988     02  eibresp2         pic s9(8) comp.
  5989     02  dfheigdj         pic s9(4) comp.
  5990     02  dfheigdk         pic s9(4) comp.
  5991 01  DFHCOMMAREA                 PIC X(1300).
  5992*                                COPY ERCPNDB.
  5993******************************************************************
  5994*                                                                *
  5995*                                                                *
  5996*                            ERCPNDB.                            *
  5997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5998*                            VMOD=2.025                          *
  5999*                                                                *
  6000*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6001*                                                                *
  6002******************************************************************
  6003*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6004*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6005******************************************************************
  6006*                                                                *
  6007*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 112
* EL6311.cbl
  6008*   FILE TYPE = VSAM,KSDS                                        *
  6009*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6010*                                                                *
  6011*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6012*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6013*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6014*                                                 RKP=13,LEN=36  *
  6015*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6016*                                      AND CHG-SEQ.)             *
  6017*                                                RKP=49,LEN=11   *
  6018*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6019*                                      AND CHG-SEQ.)             *
  6020*                                                RKP=60,LEN=15   *
  6021*                                                                *
  6022*   LOG = NO                                                     *
  6023*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6024******************************************************************
  6025******************************************************************
  6026*                   C H A N G E   L O G
  6027*
  6028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6029*-----------------------------------------------------------------
  6030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6031* EFFECTIVE    NUMBER
  6032*-----------------------------------------------------------------
  6033* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6034* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6035* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6036* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6037* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6038* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6039* 032306                   PEMA  ADD BOW LOAN NUMBER
  6040* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6041* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6042* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6043* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6044* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6045* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6046* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6047* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6048* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6049* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6050* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6051* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6052* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6053******************************************************************
  6054
  6055 01  PENDING-BUSINESS.
  6056     12  PB-RECORD-ID                     PIC XX.
  6057         88  VALID-PB-ID                        VALUE 'PB'.
  6058
  6059     12  PB-CONTROL-PRIMARY.
  6060         16  PB-COMPANY-CD                PIC X.
  6061         16  PB-ENTRY-BATCH               PIC X(6).
  6062         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6063         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6064
  6065     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 113
* EL6311.cbl
  6066         16  PB-COMPANY-CD-A1             PIC X.
  6067         16  PB-CARRIER                   PIC X.
  6068         16  PB-GROUPING.
  6069             20  PB-GROUPING-PREFIX       PIC XXX.
  6070             20  PB-GROUPING-PRIME        PIC XXX.
  6071         16  PB-STATE                     PIC XX.
  6072         16  PB-ACCOUNT.
  6073             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6074             20  PB-ACCOUNT-PRIME         PIC X(6).
  6075         16  PB-CERT-EFF-DT               PIC XX.
  6076         16  PB-CERT-NO.
  6077             20  PB-CERT-PRIME            PIC X(10).
  6078             20  PB-CERT-SFX              PIC X.
  6079         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6080
  6081         16  PB-RECORD-TYPE               PIC X.
  6082             88  PB-MAILING-DATA                VALUE '0'.
  6083             88  PB-ISSUE                       VALUE '1'.
  6084             88  PB-CANCELLATION                VALUE '2'.
  6085             88  PB-BATCH-TRAILER               VALUE '9'.
  6086
  6087     12  PB-CONTROL-BY-ORIG-BATCH.
  6088         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6089         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6090         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6091         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6092
  6093     12  PB-CONTROL-BY-CSR.
  6094         16  PB-CSR-COMPANY-CD            PIC X.
  6095         16  PB-CSR-ID                    PIC X(4).
  6096         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6097         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6098         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6099******************************************************************
  6100*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6101******************************************************************
  6102
  6103     12  PB-LAST-MAINT-DT                 PIC XX.
  6104     12  PB-LAST-MAINT-BY                 PIC X(4).
  6105     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6106
  6107     12  PB-RECORD-BODY                   PIC X(375).
  6108
  6109     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6110         16  PB-CERT-ORIGIN               PIC X.
  6111             88  CLASIC-CREATED-CERT         VALUE '1'.
  6112         16  PB-I-NAME.
  6113             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6114             20  PB-I-INSURED-FIRST-NAME.
  6115                 24  PB-I-INSURED-1ST-INIT PIC X.
  6116                 24  FILLER                PIC X(9).
  6117             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6118         16  PB-I-AGE                     PIC S99   COMP-3.
  6119         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6120         16  PB-I-BIRTHDAY                PIC XX.
  6121         16  PB-I-INSURED-SEX             PIC X.
  6122             88  PB-SEX-MALE     VALUE 'M'.
  6123             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 114
* EL6311.cbl
  6124
  6125         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6126         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6127         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6128         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6129         16  PB-I-SKIP-CODE               PIC X.
  6130             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6131             88  PB-SKIP-JULY              VALUE '1'.
  6132             88  PB-SKIP-AUGUST            VALUE '2'.
  6133             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6134             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6135             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6136             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6137             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6138             88  PB-SKIP-JUNE              VALUE '8'.
  6139             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6140             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6141             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6142         16  PB-I-TERM-TYPE               PIC X.
  6143             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6144             88  PB-PAID-WEEKLY            VALUE 'W'.
  6145             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6146             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6147             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6148         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6149         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6150         16  PB-I-DATA-ENTRY-SW           PIC X.
  6151             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6152             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6153             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6154             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6155         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6156         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6157*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6158         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6159         16  PB-I-LETTER-REQD             PIC X.
  6160
  6161         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6162             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6163             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6164                                                   '90' THRU '99'.
  6165         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6166                                          PIC XX.
  6167         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6168         16  PB-I-AMOUNT-FINANCED REDEFINES
  6169                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6170         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6171         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6172                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6173         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6174         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6175         16  PB-I-CLP-AMOUNT REDEFINES
  6176                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6177         16  PB-I-LF-CALC-FLAG            PIC X.
  6178             88 PB-COMP-LF-PREM               VALUE '?'.
  6179         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6180         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6181         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 115
* EL6311.cbl
  6182         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6183         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6184         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6185         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6186         16  PB-I-LF-ABBR                 PIC XXX.
  6187         16  PB-I-LF-INPUT-CD             PIC XX.
  6188
  6189         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6190             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6191             88  PB-INVALID-AH               VALUE '  ' '00'
  6192                                                   '90' THRU '99'.
  6193         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6194         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6195         16  PB-I-AH-CALC-FLAG            PIC X.
  6196             88 PB-COMP-AH-PREM                  VALUE '?'.
  6197         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6198         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6199         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6200         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6201         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6202         16  PB-I-AH-ABBR                 PIC XXX.
  6203         16  PB-I-AH-INPUT-CD             PIC XXX.
  6204
  6205         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6206         16  PB-I-REIN-TABLE              PIC XXX.
  6207         16  PB-I-BUSINESS-TYPE           PIC 99.
  6208         16  PB-I-INDV-GRP-CD             PIC X.
  6209         16  PB-I-MORT-CODE.
  6210             20  PB-I-TABLE               PIC X.
  6211             20  PB-I-INTEREST            PIC XX.
  6212             20  PB-I-MORT-TYP            PIC X.
  6213         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6214         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6215         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6216         16  PB-I-INDV-GRP-OVRD           PIC X.
  6217         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6218         16  PB-I-SIG-SW                  PIC X.
  6219             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6220         16  PB-I-RATE-CLASS              PIC XX.
  6221         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6222         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6223         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6224         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6225         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6226         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6227         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6228         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6229         16  PB-I-OB-FLAG                 PIC X.
  6230             88  PB-I-OB                      VALUE 'B'.
  6231             88  PB-I-SUMMARY                 VALUE 'Z'.
  6232         16  PB-I-ENTRY-STATUS            PIC X.
  6233             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6234                                              'M' '5' '9' '2'.
  6235             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6236             88  PB-I-POLICY-PENDING          VALUE '2'.
  6237             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6238             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6239             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 116
* EL6311.cbl
  6240             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6241             88  PB-I-REIN-ONLY               VALUE '9'.
  6242             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6243             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6244             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6245             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6246         16  PB-I-INT-CODE                PIC X.
  6247             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6248             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6249         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6250         16  PB-I-SOC-SEC-NO              PIC X(11).
  6251         16  PB-I-MEMBER-NO               PIC X(12).
  6252         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6253*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6254         16  PB-I-OLD-LOF                 PIC XXX.
  6255         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6256         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6257         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6258         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6259         16  PB-I-LIFE-INDICATOR          PIC X.
  6260             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6261         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6262         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6263                                          PIC S9(5)V99    COMP-3.
  6264         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6265             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6266             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6267         16  PB-I-1ST-PMT-DT              PIC XX.
  6268         16  PB-I-JOINT-INSURED.
  6269             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6270             20 PB-I-JOINT-FIRST-NAME.
  6271                24  PB-I-JOINT-FIRST-INIT PIC X.
  6272                24  FILLER                PIC X(9).
  6273             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6274*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6275         16  PB-I-BENEFICIARY-NAME.
  6276             20  PB-I-BANK-NUMBER         PIC X(10).
  6277             20  FILLER                   PIC X(15).
  6278         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6279         16  PB-I-REFERENCE               PIC X(12).
  6280         16  FILLER REDEFINES PB-I-REFERENCE.
  6281             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6282             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6283             20  PB-I-CLP-STATE           PIC XX.
  6284         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6285             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6286             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6287             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6288         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6289         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6290         16  PB-I-RESIDENT-STATE          PIC XX.
  6291         16  PB-I-RATE-CODE               PIC X(4).
  6292         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6293         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6294         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6295         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6296         16  PB-I-BANK-NOCHRGB            PIC 99.
  6297         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 117
* EL6311.cbl
  6298         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6299
  6300     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6301         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6302             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6303         16  PB-C-CANCEL-ORIGIN           PIC X.
  6304             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6305         16  PB-C-LF-CANCEL-DT            PIC XX.
  6306         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6307         16  PB-C-LF-CALC-REQ             PIC X.
  6308             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6309         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6310         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6311         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6312             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6313         16  PB-C-AH-CANCEL-DT            PIC XX.
  6314         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6315         16  PB-C-AH-CALC-REQ             PIC X.
  6316             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6317         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6318         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6319         16  PB-C-LAST-NAME               PIC X(15).
  6320         16  PB-C-REFUND-SW               PIC X.
  6321             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6322             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6323         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6324         16  PB-C-PAYEE-CODE              PIC X(6).
  6325         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6326         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6327         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6328         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6329         16  PB-C-REFERENCE               PIC X(12).
  6330         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6331         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6332         16  PB-C-POST-CARD-IND           PIC X.
  6333         16  PB-C-CANCEL-REASON           PIC X.
  6334         16  PB-C-REF-INTERFACE-SW        PIC X.
  6335         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6336         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6337         16  FILLER                       PIC X(01).
  6338*        16  FILLER                       PIC X(18).
  6339         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6340*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6341         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6342         16  PB-CANCELED-CERT-DATA.
  6343             20  PB-CI-INSURED-NAME.
  6344                 24  PB-CI-LAST-NAME      PIC X(15).
  6345                 24  PB-CI-INITIALS       PIC XX.
  6346             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6347             20  PB-CI-INSURED-SEX        PIC X.
  6348             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6349             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6350             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6351             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6352             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6353             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6354             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6355             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 118
* EL6311.cbl
  6356             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6357             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6358             20  PB-CI-RATE-CLASS         PIC XX.
  6359             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6360             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6361             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6362             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6363             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6364             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6365             20  PB-CI-LF-ABBR            PIC X(3).
  6366             20  PB-CI-AH-ABBR            PIC X(3).
  6367             20  PB-CI-OB-FLAG            PIC X.
  6368                 88  PB-CI-OB                VALUE 'B'.
  6369             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6370                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6371                                           'M' '4' '5' '9' '2'.
  6372                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6373                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6374                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6375                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6376                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6377                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6378                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6379                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6380                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6381                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6382                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6383                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6384                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6385             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6386                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6387                                           'M' '4' '5' '9' '2'.
  6388                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6389                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6390                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6391                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6392                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6393                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6394                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6395                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6396                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6397                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6398                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6399                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6400                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6401             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6402             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6403             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6404             20  PB-CI-MEMBER-NO          PIC X(12).
  6405             20  PB-CI-INT-CODE           PIC X.
  6406                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6407                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6408             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6409             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6410             20  PB-CI-COMP-EXCP-SW       PIC X.
  6411                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6412                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6413             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 119
* EL6311.cbl
  6414             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6415             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6416             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6417             20  PB-CI-DEATH-DT           PIC XX.
  6418             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6419             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6420             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6421             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6422             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6423             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6424             20  PB-CI-ENTRY-DT              PIC XX.
  6425             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6426             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6427             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6428             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6429             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6430             20  PB-CI-OLD-LOF               PIC XXX.
  6431*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6432             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6433             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6434             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6435             20  PB-CI-INDV-GRP-CD           PIC X.
  6436             20  PB-CI-BENEFICIARY-NAME.
  6437                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6438                 24  FILLER                  PIC X(15).
  6439             20  PB-CI-NOTE-SW               PIC X.
  6440             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6441             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6442             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6443             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6444             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6445             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6446             20  PB-CI-FIRST-NAME            PIC X(10).
  6447             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6448
  6449         16  FILLER                       PIC X(13).
  6450*032306  16  FILLER                       PIC X(27).
  6451*        16  FILLER                       PIC X(46).
  6452
  6453     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6454         16  FILLER                       PIC X(10).
  6455         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6456         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6457         16  PB-M-INSURED-MID-INIT        PIC X.
  6458         16  PB-M-INSURED-AGE             PIC 99.
  6459         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6460         16  PB-M-INSURED-SEX             PIC X.
  6461         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6462         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6463         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6464         16  PB-M-INSURED-CITY-STATE.
  6465             20  PB-M-INSURED-CITY        PIC X(28).
  6466             20  PB-M-INSURED-STATE       PIC XX.
  6467         16  PB-M-INSURED-ZIP-CODE.
  6468             20  PB-M-INSURED-ZIP-PRIME.
  6469                 24  PB-M-INSURED-ZIP-1   PIC X.
  6470                     88  PB-M-CANADIAN-POST-CODE
  6471                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 120
* EL6311.cbl
  6472                 24  FILLER               PIC X(4).
  6473             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6474         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6475                                        PB-M-INSURED-ZIP-CODE.
  6476             20  PM-M-INS-CAN-POST1       PIC XXX.
  6477             20  PM-M-INS-CAN-POST2       PIC XXX.
  6478             20  FILLER                   PIC XXX.
  6479         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6480         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6481         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6482         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6483         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6484         16  PB-M-CRED-BENE-CITYST.
  6485             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6486             20  PB-M-CRED-BENE-STATE     PIC XX.
  6487         16  FILLER                       PIC X(92).
  6488
  6489     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6490         16  FILLER                       PIC X(10).
  6491         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6492         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6493         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6494         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6495         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6496         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6497         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6498         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6499         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6500         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6501         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6502         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6503         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6504         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6505         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6506         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6507         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6508         16  PB-ACCOUNT-NAME              PIC X(30).
  6509         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6510         16  PB-REFERENCE                 PIC X(12).
  6511         16  PB-B-RECEIVED-DT             PIC XX.
  6512         16  FILLER                       PIC X(234).
  6513
  6514     12  PB-RECORD-STATUS.
  6515         16  PB-CREDIT-SELECT-DT          PIC XX.
  6516         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6517         16  PB-BILLED-DT                 PIC XX.
  6518         16  PB-BILLING-STATUS            PIC X.
  6519             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6520             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6521             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6522         16  PB-RECORD-BILL               PIC X.
  6523             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6524             88  PB-RECORD-RETURNED           VALUE 'R'.
  6525             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6526             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6527             88  PB-OVERRIDE-AH               VALUE 'A'.
  6528             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6529         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 121
* EL6311.cbl
  6530             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6531             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6532             88  PB-REISSUED-CERT             VALUE 'E'.
  6533             88  PB-CASH-CERT                 VALUE 'C'.
  6534             88  PB-MONTHLY-CERT              VALUE 'M'.
  6535             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6536             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6537             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6538         16  PB-FORCE-CODE                PIC X.
  6539             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6540             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6541             88  PB-CANCEL-FORCE              VALUE '8'.
  6542             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6543             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6544             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6545             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6546             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6547             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6548             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6549             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6550         16  PB-FATAL-FLAG                PIC X.
  6551             88  PB-FATAL-ERRORS              VALUE 'X'.
  6552         16  PB-FORCE-ER-CD               PIC X.
  6553             88  PB-FORCE-ERRORS              VALUE 'F'.
  6554             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6555         16  PB-WARN-ER-CD                PIC X.
  6556             88  PB-WARNING-ERRORS            VALUE 'W'.
  6557         16  FILLER                       PIC X.
  6558         16  PB-OUT-BAL-CD                PIC X.
  6559             88  PB-OUT-OF-BAL                VALUE 'O'.
  6560         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6561         16  PB-AH-OVERRIDE-L1            PIC X.
  6562         16  PB-INPUT-DT                  PIC XX.
  6563         16  PB-INPUT-BY                  PIC X(4).
  6564         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6565         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6566         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6567         16  PB-LF-EARNING-METHOD         PIC X.
  6568         16  PB-AH-EARNING-METHOD         PIC X.
  6569         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6570         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6571         16  PB-REIN-CD                   PIC XXX.
  6572         16  PB-LF-REFUND-TYPE            PIC X.
  6573         16  PB-AH-REFUND-TYPE            PIC X.
  6574         16  PB-ACCT-EFF-DT               PIC XX.
  6575         16  PB-ACCT-EXP-DT               PIC XX.
  6576         16  PB-COMPANY-ID                PIC X(3).
  6577         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6578         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6579         16  PB-SV-CARRIER                PIC X.
  6580         16  PB-SV-GROUPING               PIC X(6).
  6581         16  PB-SV-STATE                  PIC XX.
  6582         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6583         16  PB-GA-BILLING-INFO.
  6584             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6585                                          PIC XX.
  6586         16  PB-SV-REMIT-TO  REDEFINES
  6587             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 122
* EL6311.cbl
  6588         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6589         16  PB-I-LOAN-OFFICER            PIC X(5).
  6590         16  PB-I-VIN                     PIC X(17).
  6591
  6592         16  FILLER                       PIC X(04).
  6593         16  IMNET-BYPASS-SW              PIC X.
  6594
  6595******************************************************************
  6596*                COMMON EDIT ERRORS                              *
  6597******************************************************************
  6598
  6599     12  PB-COMMON-ERRORS.
  6600         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6601                                           PIC S9(4)     COMP.
  6602
  6603******************************************************************
  6604*                                COPY ELCCERT.
  6605******************************************************************
  6606*                                                                *
  6607*                            ELCCERT.                            *
  6608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6609*                            VMOD=2.013                          *
  6610*                                                                *
  6611*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6612*                                                                *
  6613*   FILE TYPE = VSAM,KSDS                                        *
  6614*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6615*                                                                *
  6616*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6617*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6618*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6619*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6620*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6621*                                                                *
  6622*   LOG = YES                                                    *
  6623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6624******************************************************************
  6625*                   C H A N G E   L O G
  6626*
  6627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6628*-----------------------------------------------------------------
  6629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6630* EFFECTIVE    NUMBER
  6631*-----------------------------------------------------------------
  6632* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6633* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6634* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6635* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6636* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6637* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6638* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6639* 032612  CR2011110200001  PEMA  AHL CHANGES
  6640* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6641* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6642* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6643******************************************************************
  6644
  6645 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 123
* EL6311.cbl
  6646     12  CM-RECORD-ID                      PIC XX.
  6647         88  VALID-CM-ID                      VALUE 'CM'.
  6648
  6649     12  CM-CONTROL-PRIMARY.
  6650         16  CM-COMPANY-CD                 PIC X.
  6651         16  CM-CARRIER                    PIC X.
  6652         16  CM-GROUPING.
  6653             20  CM-GROUPING-PREFIX        PIC X(3).
  6654             20  CM-GROUPING-PRIME         PIC X(3).
  6655         16  CM-STATE                      PIC XX.
  6656         16  CM-ACCOUNT.
  6657             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6658             20  CM-ACCOUNT-PRIME          PIC X(6).
  6659         16  CM-CERT-EFF-DT                PIC XX.
  6660         16  CM-CERT-NO.
  6661             20  CM-CERT-PRIME             PIC X(10).
  6662             20  CM-CERT-SFX               PIC X.
  6663
  6664     12  CM-CONTROL-BY-NAME.
  6665         16  CM-COMPANY-CD-A1              PIC X.
  6666         16  CM-INSURED-LAST-NAME          PIC X(15).
  6667         16  CM-INSURED-INITIALS.
  6668             20  CM-INSURED-INITIAL1       PIC X.
  6669             20  CM-INSURED-INITIAL2       PIC X.
  6670
  6671     12  CM-CONTROL-BY-SSN.
  6672         16  CM-COMPANY-CD-A2              PIC X.
  6673         16  CM-SOC-SEC-NO.
  6674             20  CM-SSN-STATE              PIC XX.
  6675             20  CM-SSN-ACCOUNT            PIC X(6).
  6676             20  CM-SSN-LN3.
  6677                 25  CM-INSURED-INITIALS-A2.
  6678                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6679                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6680                 25 CM-PART-LAST-NAME-A2         PIC X.
  6681
  6682     12  CM-CONTROL-BY-CERT-NO.
  6683         16  CM-COMPANY-CD-A4              PIC X.
  6684         16  CM-CERT-NO-A4                 PIC X(11).
  6685
  6686     12  CM-CONTROL-BY-MEMB.
  6687         16  CM-COMPANY-CD-A5              PIC X.
  6688         16  CM-MEMBER-NO.
  6689             20  CM-MEMB-STATE             PIC XX.
  6690             20  CM-MEMB-ACCOUNT           PIC X(6).
  6691             20  CM-MEMB-LN4.
  6692                 25  CM-INSURED-INITIALS-A5.
  6693                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6694                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6695                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6696
  6697     12  CM-INSURED-PROFILE-DATA.
  6698         16  CM-INSURED-FIRST-NAME.
  6699             20  CM-INSURED-1ST-INIT       PIC X.
  6700             20  FILLER                    PIC X(9).
  6701         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6702         16  CM-INSURED-SEX                PIC X.
  6703             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 124
* EL6311.cbl
  6704             88  CM-SEX-FEMAL                 VALUE 'F'.
  6705         16  CM-INSURED-JOINT-AGE          PIC 99.
  6706         16  CM-JOINT-INSURED-NAME.
  6707             20  CM-JT-LAST-NAME           PIC X(15).
  6708             20  CM-JT-FIRST-NAME.
  6709                 24  CM-JT-1ST-INIT        PIC X.
  6710                 24  FILLER                PIC X(9).
  6711             20  CM-JT-INITIAL             PIC X.
  6712
  6713     12  CM-LIFE-DATA.
  6714         16  CM-LF-BENEFIT-CD              PIC XX.
  6715         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6716         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6717         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6718         16  CM-LF-DEV-CODE                PIC XXX.
  6719         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6720         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6721         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6722         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6723         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6724         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6725         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6726         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6727         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6728         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6729         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6730         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6731         16  cm-temp-epiq                  pic xx.
  6732             88  EPIQ-CLASS                  value 'EQ'.
  6733*        16  FILLER                        PIC XX.
  6734
  6735     12  CM-AH-DATA.
  6736         16  CM-AH-BENEFIT-CD              PIC XX.
  6737         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6738         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6739         16  CM-AH-DEV-CODE                PIC XXX.
  6740         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6741         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6742         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6743         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6744         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6745         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6746         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6747         16  CM-AH-PAID-THRU-DT            PIC XX.
  6748             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6749         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6750         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6751         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6752         16  FILLER                        PIC X.
  6753
  6754     12  CM-LOAN-INFORMATION.
  6755         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6756         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6757                                           PIC S9(5)V99  COMP-3.
  6758         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6759         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6760         16  CM-PAY-FREQUENCY              PIC S99.
  6761         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 125
* EL6311.cbl
  6762         16  CM-RATE-CLASS                 PIC XX.
  6763         16  CM-BENEFICIARY                PIC X(25).
  6764         16  CM-POLICY-FORM-NO             PIC X(12).
  6765         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6766         16  CM-LAST-ADD-ON-DT             PIC XX.
  6767         16  CM-DEDUCTIBLE-AMOUNTS.
  6768             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6769             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6770         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6771             20  CM-RESIDENT-STATE         PIC XX.
  6772             20  CM-RATE-CODE              PIC X(4).
  6773             20  FILLER                    PIC XX.
  6774         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6775             20  CM-LOAN-OFFICER           PIC X(5).
  6776             20  FILLER                    PIC XXX.
  6777         16  CM-CSR-CODE                   PIC XXX.
  6778         16  CM-UNDERWRITING-CODE          PIC X.
  6779             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6780         16  CM-POST-CARD-IND              PIC X.
  6781         16  CM-REF-INTERFACE-SW           PIC X.
  6782         16  CM-PREMIUM-TYPE               PIC X.
  6783             88  CM-SING-PRM                  VALUE '1'.
  6784             88  CM-O-B-COVERAGE              VALUE '2'.
  6785             88  CM-OPEN-END                  VALUE '3'.
  6786         16  CM-IND-GRP-TYPE               PIC X.
  6787             88  CM-INDIVIDUAL                VALUE 'I'.
  6788             88  CM-GROUP                     VALUE 'G'.
  6789         16  CM-SKIP-CODE                  PIC X.
  6790             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6791             88  SKIP-JULY                    VALUE '1'.
  6792             88  SKIP-AUGUST                  VALUE '2'.
  6793             88  SKIP-SEPTEMBER               VALUE '3'.
  6794             88  SKIP-JULY-AUG                VALUE '4'.
  6795             88  SKIP-AUG-SEPT                VALUE '5'.
  6796             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6797             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6798             88  SKIP-JUNE                    VALUE '8'.
  6799             88  SKIP-JUNE-JULY               VALUE '9'.
  6800             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6801             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6802         16  CM-PAYMENT-MODE               PIC X.
  6803             88  PAY-MONTHLY                  VALUE SPACE.
  6804             88  PAY-WEEKLY                   VALUE '1'.
  6805             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6806             88  PAY-BI-WEEKLY                VALUE '3'.
  6807             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6808         16  CM-LOAN-NUMBER                PIC X(8).
  6809         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6810         16  CM-OLD-LOF                    PIC XXX.
  6811*        16  CM-LOAN-OFFICER               PIC XXX.
  6812         16  CM-REIN-TABLE                 PIC XXX.
  6813         16  CM-SPECIAL-REIN-CODE          PIC X.
  6814         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6815         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6816         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6817
  6818     12  CM-STATUS-DATA.
  6819         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 126
* EL6311.cbl
  6820         16  CM-ENTRY-DT                   PIC XX.
  6821
  6822         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6823         16  CM-LF-CANCEL-DT               PIC XX.
  6824         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6825
  6826         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6827         16  CM-LF-DEATH-DT                PIC XX.
  6828         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6829
  6830         16  CM-LF-CURRENT-STATUS          PIC X.
  6831             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6832                                                'M' '4' '5' '9'.
  6833             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6834             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6835             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6836             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6837             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6838             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6839             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6840             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6841             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6842             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6843             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6844             88  CM-LF-DECLINED               VALUE 'D'.
  6845             88  CM-LF-VOIDED                 VALUE 'V'.
  6846
  6847         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6848         16  CM-AH-CANCEL-DT               PIC XX.
  6849         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6850
  6851         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6852         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6853         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6854
  6855         16  CM-AH-CURRENT-STATUS          PIC X.
  6856             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6857                                                'M' '4' '5' '9'.
  6858             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6859             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6860             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6861             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6862             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6863             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6864             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6865             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6866             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6867             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6868             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6869             88  CM-AH-DECLINED               VALUE 'D'.
  6870             88  CM-AH-VOIDED                 VALUE 'V'.
  6871
  6872         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6873             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6874             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6875             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6876         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6877
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 127
* EL6311.cbl
  6878         16  CM-ENTRY-BATCH                PIC X(6).
  6879         16  CM-LF-EXIT-BATCH              PIC X(6).
  6880         16  CM-AH-EXIT-BATCH              PIC X(6).
  6881         16  CM-LAST-MONTH-END             PIC XX.
  6882
  6883     12  CM-NOTE-SW                        PIC X.
  6884         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6885         88  CERT-NOTES-PRESENT               VALUE '1'.
  6886         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6887         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6888         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6889         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6890         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6891         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6892     12  CM-COMP-EXCP-SW                   PIC X.
  6893         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6894         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6895     12  CM-INSURED-ADDRESS-SW             PIC X.
  6896         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6897         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6898
  6899*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6900     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6901     12  FILLER                            PIC X.
  6902
  6903*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6904     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6905     12  FILLER                            PIC X.
  6906*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6907     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6908
  6909     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6910         88  CERT-ADDED-BATCH                 VALUE ' '.
  6911         88  CERT-ADDED-ONLINE                VALUE '1'.
  6912         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6913         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6914         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6915     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6916         88  CERT-AS-LOADED                   VALUE ' '.
  6917         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6918         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6919         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6920         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6921         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6922         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6923         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6924
  6925     12  CM-ACCOUNT-COMM-PCTS.
  6926         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6927         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6928
  6929     12  CM-USER-FIELD                     PIC X.
  6930     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6931     12  CM-CLP-STATE                      PIC XX.
  6932     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6933     12  CM-USER-RESERVED                  PIC XXX.
  6934     12  FILLER REDEFINES CM-USER-RESERVED.
  6935         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 128
* EL6311.cbl
  6936         16  F                             PIC X.
  6937******************************************************************
  6938*                                COPY ERCNOTE.
  6939******************************************************************
  6940*                                                                *
  6941*                                                                *
  6942*                            ERCNOTE                             *
  6943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6944*                            VMOD=2.003                          *
  6945*                                                                *
  6946*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6947*                                                                *
  6948*        FILE TYPE= VSAM,KSDS                                    *
  6949*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6950*                                                                *
  6951*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  6952*                                                                *
  6953*        LOG = YES                                               *
  6954*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6955*                                                                *
  6956******************************************************************
  6957*                   C H A N G E   L O G
  6958*
  6959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6960*-----------------------------------------------------------------
  6961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6962* EFFECTIVE    NUMBER
  6963*-----------------------------------------------------------------
  6964* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6965*                                FILE WILL CONTAIN BILLING NOTES O
  6966* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  6967******************************************************************
  6968
  6969 01  CERTIFICATE-NOTE.
  6970     12  CN-RECORD-ID                PIC  XX.
  6971         88  VALID-CN-ID                  VALUE 'CN'.
  6972
  6973     12  CN-CONTROL-PRIMARY.
  6974         16  CN-COMPANY-CD           PIC X.
  6975         16  CN-CARRIER              PIC X.
  6976         16  CN-GROUPING.
  6977             20 CN-GROUPING-PREFIX   PIC XXX.
  6978             20 CN-GROUPING-PRIME    PIC XXX.
  6979         16  CN-STATE                PIC XX.
  6980         16  CN-ACCOUNT.
  6981             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6982             20 CN-ACCOUNT-PRIME     PIC X(6).
  6983         16  CN-CERT-EFF-DT          PIC XX.
  6984         16  CN-CERT-NO.
  6985             20  CN-CERT-PRIME       PIC X(10).
  6986             20  CN-CERT-SFX         PIC X.
  6987         16  CN-RECORD-TYPE          PIC X.
  6988             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  6989             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  6990     12  CN-BILLING-START-LINE-NO    PIC 99.
  6991     12  CN-BILLING-END-LINE-NO      PIC 99.
  6992
  6993     12  CN-LINES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 129
* EL6311.cbl
  6994         16  CN-LINE OCCURS 10       PIC X(77).
  6995
  6996     12  CN-LAST-MAINT-DT            PIC XX.
  6997     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6998     12  CN-LAST-MAINT-USER          PIC X(4).
  6999     12  FILLER                      PIC X(5).
  7000******************************************************************
  7001*                                COPY ERCPNDM.
  7002******************************************************************
  7003*                                                                *
  7004*                                                                *
  7005*                            ERCPNDM                             *
  7006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7007*                            VMOD=2.003                          *
  7008*                                                                *
  7009*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  7010*                                                                *
  7011*   FILE TYPE = VSAM,KSDS                                        *
  7012*   RECORD SIZE = 374   RECFORM = FIX                            *
  7013*                                                                *
  7014*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7015*   ALTERNATE PATH    = NOT USED                                 *
  7016*                                                                *
  7017*   LOG = YES                                                    *
  7018*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7019******************************************************************
  7020*                   C H A N G E   L O G
  7021*
  7022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7023*-----------------------------------------------------------------
  7024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7025* EFFECTIVE    NUMBER
  7026*-----------------------------------------------------------------
  7027* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7028* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7029* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7030* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7031******************************************************************
  7032
  7033 01  PENDING-MAILING-DATA.
  7034     12  PM-RECORD-ID                      PIC XX.
  7035         88  VALID-MA-ID                       VALUE 'PM'.
  7036
  7037     12  PM-CONTROL-PRIMARY.
  7038         16  PM-COMPANY-CD                 PIC X.
  7039         16  PM-ENTRY-BATCH                PIC X(6).
  7040         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7041         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7042
  7043     12  FILLER                            PIC X(14).
  7044
  7045     12  PM-ACCESS-CONTROL.
  7046         16  PM-SOURCE-SYSTEM              PIC XX.
  7047             88  PM-FROM-CREDIT                VALUE 'CR'.
  7048             88  PM-FROM-VSI                   VALUE 'VS'.
  7049             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7050             88  PM-FROM-OTHER                 VALUE 'OT'.
  7051         16  PM-RECORD-ADD-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 130
* EL6311.cbl
  7052         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7053         16  PM-LAST-MAINT-DT              PIC XX.
  7054         16  PM-LAST-MAINT-BY              PIC XXXX.
  7055         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7056
  7057     12  PM-PROFILE-INFO.
  7058         16  PM-QUALIFY-CODE-1             PIC XX.
  7059         16  PM-QUALIFY-CODE-2             PIC XX.
  7060         16  PM-QUALIFY-CODE-3             PIC XX.
  7061         16  PM-QUALIFY-CODE-4             PIC XX.
  7062         16  PM-QUALIFY-CODE-5             PIC XX.
  7063
  7064         16  PM-INSURED-LAST-NAME          PIC X(15).
  7065         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7066         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7067         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7068         16  PM-INSURED-BIRTH-DT           PIC XX.
  7069         16  PM-INSURED-SEX                PIC X.
  7070             88  PM-SEX-MALE                   VALUE 'M'.
  7071             88  PM-SEX-FEMALE                 VALUE 'F'.
  7072         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7073
  7074         16  PM-ADDRESS-CORRECTED          PIC X.
  7075         16  PM-JOINT-BIRTH-DT             PIC XX.
  7076*        16  FILLER                        PIC X(12).
  7077
  7078         16  PM-ADDRESS-LINE-1             PIC X(30).
  7079         16  PM-ADDRESS-LINE-2             PIC X(30).
  7080         16  PM-CITY-STATE.
  7081             20  PM-CITY                   PIC X(28).
  7082             20  PM-STATE                  PIC XX.
  7083         16  PM-ZIP.
  7084             20  PM-ZIP-CODE.
  7085                 24  PM-ZIP-1              PIC X.
  7086                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7087                 24  FILLER                PIC X(4).
  7088             20  PM-ZIP-PLUS4              PIC X(4).
  7089         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7090             20  PM-CAN-POST1              PIC XXX.
  7091             20  PM-CAN-POST2              PIC XXX.
  7092             20  FILLER                    PIC XXX.
  7093
  7094         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7095         16  pm-city-st-zip-verified       pic x.
  7096         16  FILLER                        PIC XX.
  7097
  7098     12  PM-CRED-BENE-INFO.
  7099         16  PM-CRED-BENE-NAME             PIC X(25).
  7100         16  PM-CRED-BENE-ADDR             PIC X(30).
  7101         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7102         16  PM-CRED-BENE-CTYST.
  7103             20  PM-CRED-BENE-CITY         PIC X(28).
  7104             20  PM-CRED-BENE-STATE        PIC XX.
  7105         16  PM-CRED-BENE-ZIP.
  7106             20  PM-CB-ZIP-CODE.
  7107                 24  PM-CB-ZIP-1           PIC X.
  7108                     88  PM-CB-CANADIAN-POST-CODE
  7109                                  VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 131
* EL6311.cbl
  7110                 24  FILLER                PIC X(4).
  7111             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7112         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  7113             20  PM-CB-CAN-POST1           PIC XXX.
  7114             20  PM-CB-CAN-POST2           PIC XXX.
  7115             20  FILLER                    PIC XXX.
  7116     12  PM-POST-CARD-MAIL-DATA.
  7117         16  PM-MAIL-DATA OCCURS 7.
  7118             20  PM-MAIL-TYPE              PIC X.
  7119                 88  PM-12MO-MAILING           VALUE '1'.
  7120                 88  PM-EXP-MAILING            VALUE '2'.
  7121             20  PM-MAIL-STATUS            PIC X.
  7122                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7123                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7124                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7125             20  PM-MAIL-DATE              PIC XX.
  7126     12  FILLER                            PIC XX.
  7127     12  FILLER                            PIC X(12).
  7128*    12  FILLER                            PIC X(30).
  7129
  7130******************************************************************
  7131*                                COPY ERCMAIL.
  7132******************************************************************
  7133*                                                                *
  7134*                                                                *
  7135*                            ERCMAIL                             *
  7136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7137*                            VMOD=2.003                          *
  7138*                                                                *
  7139*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7140*                                                                *
  7141*   FILE TYPE = VSAM,KSDS                                        *
  7142*   RECORD SIZE = 374   RECFORM = FIX                            *
  7143*                                                                *
  7144*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7145*   ALTERNATE PATH    = NOT USED                                 *
  7146*                                                                *
  7147*   LOG = YES                                                    *
  7148*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7149******************************************************************
  7150*                   C H A N G E   L O G
  7151*
  7152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7153*-----------------------------------------------------------------
  7154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7155* EFFECTIVE    NUMBER
  7156*-----------------------------------------------------------------
  7157* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7158* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7159* 111108                   PEMA  ADD CRED BENE ADDR2
  7160******************************************************************
  7161
  7162 01  MAILING-DATA.
  7163     12  MA-RECORD-ID                      PIC XX.
  7164         88  VALID-MA-ID                       VALUE 'MA'.
  7165
  7166     12  MA-CONTROL-PRIMARY.
  7167         16  MA-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 132
* EL6311.cbl
  7168         16  MA-CARRIER                    PIC X.
  7169         16  MA-GROUPING.
  7170             20  MA-GROUPING-PREFIX        PIC XXX.
  7171             20  MA-GROUPING-PRIME         PIC XXX.
  7172         16  MA-STATE                      PIC XX.
  7173         16  MA-ACCOUNT.
  7174             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7175             20  MA-ACCOUNT-PRIME          PIC X(6).
  7176         16  MA-CERT-EFF-DT                PIC XX.
  7177         16  MA-CERT-NO.
  7178             20  MA-CERT-PRIME             PIC X(10).
  7179             20  MA-CERT-SFX               PIC X.
  7180
  7181     12  FILLER                            PIC XX.
  7182
  7183     12  MA-ACCESS-CONTROL.
  7184         16  MA-SOURCE-SYSTEM              PIC XX.
  7185             88  MA-FROM-CREDIT                VALUE 'CR'.
  7186             88  MA-FROM-VSI                   VALUE 'VS'.
  7187             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7188             88  MA-FROM-OTHER                 VALUE 'OT'.
  7189         16  MA-RECORD-ADD-DT              PIC XX.
  7190         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7191         16  MA-LAST-MAINT-DT              PIC XX.
  7192         16  MA-LAST-MAINT-BY              PIC XXXX.
  7193         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7194
  7195     12  MA-PROFILE-INFO.
  7196         16  MA-QUALIFY-CODE-1             PIC XX.
  7197         16  MA-QUALIFY-CODE-2             PIC XX.
  7198         16  MA-QUALIFY-CODE-3             PIC XX.
  7199         16  MA-QUALIFY-CODE-4             PIC XX.
  7200         16  MA-QUALIFY-CODE-5             PIC XX.
  7201
  7202         16  MA-INSURED-LAST-NAME          PIC X(15).
  7203         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7204         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7205         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7206         16  MA-INSURED-BIRTH-DT           PIC XX.
  7207         16  MA-INSURED-SEX                PIC X.
  7208             88  MA-SEX-MALE                   VALUE 'M'.
  7209             88  MA-SEX-FEMALE                 VALUE 'F'.
  7210         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7211
  7212         16  MA-ADDRESS-CORRECTED          PIC X.
  7213         16  MA-JOINT-BIRTH-DT             PIC XX.
  7214*        16  FILLER                        PIC X(12).
  7215
  7216         16  MA-ADDRESS-LINE-1             PIC X(30).
  7217         16  MA-ADDRESS-LINE-2             PIC X(30).
  7218         16  MA-CITY-STATE.
  7219             20  MA-CITY                   PIC X(28).
  7220             20  MA-ADDR-STATE             PIC XX.
  7221         16  MA-ZIP.
  7222             20  MA-ZIP-CODE.
  7223                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7224                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7225                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 133
* EL6311.cbl
  7226             20  MA-ZIP-PLUS4              PIC X(4).
  7227         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7228             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7229             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7230             20  FILLER                    PIC X(3).
  7231
  7232         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7233
  7234         16  FILLER                        PIC XXX.
  7235*        16  FILLER                        PIC X(10).
  7236
  7237     12  MA-CRED-BENE-INFO.
  7238         16  MA-CRED-BENE-NAME                 PIC X(25).
  7239         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7240         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7241         16  MA-CRED-BENE-CTYST.
  7242             20  MA-CRED-BENE-CITY             PIC X(28).
  7243             20  MA-CRED-BENE-STATE            PIC XX.
  7244         16  MA-CRED-BENE-ZIP.
  7245             20  MA-CB-ZIP-CODE.
  7246                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7247                     88  MA-CB-CANADIAN-POST-CODE
  7248                                           VALUE 'A' THRU 'Z'.
  7249                 24  FILLER                    PIC X(4).
  7250             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7251         16  MA-CB-CANADIAN-POSTAL-CODE
  7252                            REDEFINES MA-CRED-BENE-ZIP.
  7253             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7254             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7255             20  FILLER                        PIC X(3).
  7256     12  MA-POST-CARD-MAIL-DATA.
  7257         16  MA-MAIL-DATA OCCURS 7.
  7258             20  MA-MAIL-TYPE              PIC X.
  7259                 88  MA-12MO-MAILING           VALUE '1'.
  7260                 88  MA-EXP-MAILING            VALUE '2'.
  7261             20  MA-MAIL-STATUS            PIC X.
  7262                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7263                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7264                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7265             20  MA-MAIL-DATE              PIC XX.
  7266     12  FILLER                            PIC XX.
  7267     12  FILLER                            PIC XX.
  7268*    12  FILLER                            PIC X(30).
  7269******************************************************************
  7270*                                COPY ERCRQST.
  7271******************************************************************
  7272*                                                                *
  7273*                                                                *
  7274*                            ERCRQST.                            *
  7275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7276*                            VMOD=2.002                          *
  7277*                                                                *
  7278*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7279*                                                                *
  7280*   FILE TYPE = VSAM,KSDS                                        *
  7281*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7282*                                                                *
  7283*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 134
* EL6311.cbl
  7284*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7285*                                   ACCOUNT, REF, BATCH)         *
  7286*                                                RKP=9, LEN=38   *
  7287*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7288*                                   ACCOUNT, REF, BATCH)         *
  7289*                                                RKP=47, LEN=46  *
  7290*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7291*                                   BATCH)                       *
  7292*                                                RKP=93, LEN=24  *
  7293*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7294*                                   REF, BATCH)                  *
  7295*                                                RKP=117, LEN=35 *
  7296*   LOG = NO                                                     *
  7297*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7298******************************************************************
  7299
  7300 01  AR-REQUEST-RECORD.
  7301     12  RQ-RECORD-ID                     PIC XX.
  7302         88  VALID-RQ-ID                        VALUE 'RQ'.
  7303
  7304     12  RQ-CONTROL-PRIMARY.
  7305         16  RQ-COMPANY-CD                PIC X.
  7306         16  RQ-ENTRY-BATCH               PIC X(6).
  7307
  7308     12  RQ-CONTROL-BY-ACCT-REF.
  7309         16  RQ-COMPANY-CD-A1             PIC X.
  7310         16  RQ-CARRIER-A1                PIC X.
  7311         16  RQ-GROUPING-A1               PIC X(6).
  7312         16  RQ-STATE-A1                  PIC XX.
  7313         16  RQ-ACCOUNT-A1                PIC X(10).
  7314         16  RQ-REFERENCE-A1              PIC X(12).
  7315         16  RQ-BATCH-A1                  PIC X(6).
  7316
  7317     12  RQ-CONTROL-BY-FIN-RESP.
  7318         16  RQ-COMPANY-CD-A2             PIC X.
  7319         16  RQ-CARRIER-A2                PIC X.
  7320         16  RQ-GROUPING-A2               PIC X(6).
  7321         16  RQ-FIN-RESP-A2               PIC X(10).
  7322         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7323         16  RQ-REFERENCE-A2              PIC X(12).
  7324         16  RQ-BATCH-A2                  PIC X(6).
  7325
  7326     12  RQ-CONTROL-BY-ACCT-AGENT.
  7327         16  RQ-COMPANY-CD-A3             PIC X.
  7328         16  RQ-CARRIER-A3                PIC X.
  7329         16  RQ-GROUPING-A3               PIC X(6).
  7330         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7331         16  RQ-BATCH-A3                  PIC X(6).
  7332
  7333     12  RQ-CONTROL-BY-SUMMARY.
  7334         16  RQ-COMPANY-CD-A4             PIC X.
  7335         16  RQ-SUMMARY-CODE              PIC X(6).
  7336         16  RQ-ACCOUNT-A4                PIC X(10).
  7337         16  RQ-REFERENCE-A4              PIC X(12).
  7338         16  RQ-BATCH-A4                  PIC X(6).
  7339
  7340     12  RQ-REQUEST-METHOD                PIC X.
  7341         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 135
* EL6311.cbl
  7342         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7343         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7344         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7345     12  FILLER                           PIC X.
  7346     12  RQ-STATUS                        PIC X.
  7347         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7348         88  RQ-RESUBMIT                      VALUE 'R'.
  7349     12  RQ-PROCESSOR-ID                  PIC X(4).
  7350     12  RQ-ENTRY-DT                      PIC XX.
  7351     12  RQ-MO-END-DT                     PIC XX.
  7352     12  RQ-REQUEST-DT                    PIC XX.
  7353     12  RQ-STMT-DT                       PIC XX.
  7354     12  RQ-REVERSAL-DT                   PIC XX.
  7355     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7356     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7357
  7358     12  FILLER                           PIC X(27).
  7359
  7360******************************************************************
  7361
  7362*                                COPY ERCLOFC.
  7363******************************************************************
  7364*                                                                *
  7365*                                                                *
  7366*                            ERCLOFC                             *
  7367*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7368*                            VMOD=2.003                          *
  7369*                                                                *
  7370*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7371*                                                                *
  7372*   FILE TYPE = VSAM,KSDS                                        *
  7373*   RECORD SIZE = 670   RECFORM = FIX                            *
  7374*                                                                *
  7375*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7376*                                                                *
  7377*   LOG = YES                                                    *
  7378*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7379*                                                                *
  7380******************************************************************
  7381
  7382 01  LOAN-OFFICER-MASTER.
  7383     12  LO-RECORD-ID                PIC XX.
  7384         88  VALID-LO-ID                VALUE 'LO'.
  7385
  7386     12  LO-CONTROL-PRIMARY.
  7387         16  LO-COMPANY-CD           PIC X.
  7388         16  LO-CARRIER              PIC X.
  7389         16  LO-GROUPING.
  7390             20  LO-GROUPING-PREFIX  PIC XXX.
  7391             20  LO-GROUPING-PRIME   PIC XXX.
  7392         16  LO-STATE                PIC XX.
  7393         16  LO-ACCOUNT.
  7394             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7395             20  LO-ACCOUNT-PRIME    PIC X(6).
  7396         16  LO-OFFICER-CODE         PIC X(5).
  7397
  7398     12  LO-OFFICER-NAME             PIC X(30).
  7399
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 136
* EL6311.cbl
  7400     12  LO-LAST-MAINT-DT            PIC XX.
  7401     12  LO-LAST-USER                PIC X(4).
  7402     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7403
  7404     12  LO-COMP-CONTROL             PIC X.
  7405             88  LO-SHOW-COMP           VALUE 'Y'.
  7406             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7407     12  LO-DETAIL-CONTROL           PIC X.
  7408             88  LO-PRINT-DETAIL        VALUE 'D'.
  7409             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7410
  7411     12  LO-SV-CARRIER               PIC X.
  7412     12  LO-SV-GROUPING              PIC X(6).
  7413     12  LO-SV-STATE                 PIC XX.
  7414
  7415     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7416     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7417
  7418     12  LO-OFFICER-INFO.
  7419         16  FILLER OCCURS 12 TIMES.
  7420             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7421             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7422             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7423             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7424             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7425             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7426             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7427             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7428     12  FILLER                      PIC X(198).
  7429******************************************************************
  7430*                                COPY ERCPYAJ.
  7431******************************************************************
  7432*                                                                *
  7433*                            ERCPYAJ                             *
  7434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7435*                            VMOD=2.015                          *
  7436*                                                                *
  7437*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7438*                                                                *
  7439*                                                                *
  7440*   FILE TYPE = VSAM,KSDS                                        *
  7441*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7442*                                                                *
  7443*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7444*       ALTERNATE PATHS = NONE                                   *
  7445*                                                                *
  7446*   LOG = YES                                                    *
  7447*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7448******************************************************************
  7449******************************************************************
  7450*                   C H A N G E   L O G
  7451*
  7452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7453*-----------------------------------------------------------------
  7454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7455* EFFECTIVE    NUMBER
  7456*-----------------------------------------------------------------
  7457* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 137
* EL6311.cbl
  7458* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7459******************************************************************
  7460
  7461 01  PENDING-PAY-ADJ.
  7462     12  PY-RECORD-ID                     PIC XX.
  7463         88  VALID-PY-ID                        VALUE 'PY'.
  7464
  7465     12  PY-CONTROL-PRIMARY.
  7466         16  PY-COMPANY-CD                PIC X.
  7467         16  PY-CARRIER                   PIC X.
  7468         16  PY-GROUPING                  PIC X(6).
  7469         16  PY-FIN-RESP                  PIC X(10).
  7470         16  PY-ACCOUNT                   PIC X(10).
  7471         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7472                                          PIC X(10).
  7473         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7474         16  PY-RECORD-TYPE               PIC X.
  7475             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7476             88  PY-DEPOSIT                   VALUE 'D'.
  7477             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7478             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7479             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7480             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7481             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7482             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7483             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7484             88  PY-FICA-ENTRY                VALUE 'F'.
  7485             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7486             88  PY-POLICY-FEE                VALUE 'W'.
  7487             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7488
  7489     12  PY-PYMT-TYPE                     PIC X.
  7490             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7491             88  PY-REINS-PYMT                VALUE 'R'.
  7492             88  PY-EXP-PYMT                  VALUE 'E'.
  7493
  7494     12  PY-BIL-INV                       PIC X(6).
  7495     12  PY-REF-NO                        PIC X(12).
  7496
  7497     12  PY-LAST-MAINT-DT                 PIC XX.
  7498     12  PY-LAST-MAINT-BY                 PIC X(4).
  7499     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7500
  7501     12  PY-PYADJ-RECORD.
  7502         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7503         16  PY-ENTRY-COMMENT             PIC X(30).
  7504         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7505             20  PY-GL-ACCOUNT            PIC X(10).
  7506             20  PY-GL-STATE              PIC X(02).
  7507             20  PY-GL-CANC-SW            PIC X(01).
  7508                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7509                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7510             20  PY-GL-COMMENT            PIC X(10).
  7511             20  FILLER      REDEFINES PY-GL-COMMENT.
  7512                 24  PY-GL-CHECK-NO       PIC 9(06).
  7513                 24  FILLER               PIC X(04).
  7514             20  FILLER                   PIC X(07).
  7515         16  PY-SAVE-ACCOUNT              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 138
* EL6311.cbl
  7516         16  PY-SAVE-TYPE                 PIC X(01).
  7517
  7518         16  PY-LETTERS.
  7519             20  PY-LETTER OCCURS 3 TIMES
  7520                           INDEXED BY PY-LET-NDX
  7521                                          PIC X(04).
  7522
  7523         16  PY-ERCOMP-TYPE               PIC X.
  7524             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7525             88  PY-GA-TYPE                   VALUE 'G'.
  7526             88  PY-BANK-TYPE                 VALUE 'B'.
  7527         16  FILLER                       PIC X(05).
  7528
  7529     12  PY-RECORD-STATUS.
  7530         16  PY-CREDIT-SELECT-DT          PIC XX.
  7531         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7532         16  PY-BILLED-DATE               PIC XX.
  7533         16  PY-REPORTED-DT               PIC XX.
  7534         16  PY-PMT-APPLIED               PIC X.
  7535             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7536             88  PY-GA-PMT                    VALUE 'G'.
  7537             88  PY-OVWRITE-PMT               VALUE 'O'.
  7538             88  PY-NON-AR-PMT                VALUE 'N'.
  7539         16  FILLER                       PIC X(5).
  7540         16  PY-INPUT-DT                  PIC XX.
  7541         16  PY-CHECK-NUMBER              PIC X(6).
  7542         16  PY-VOID-SW                   PIC X.
  7543             88  PY-CHECK-VOIDED              VALUE 'V'.
  7544         16  PY-CHECK-ORIGIN-SW           PIC X.
  7545             88  PY-BILLING-CHECK             VALUE 'B'.
  7546             88  PY-REFUND-CHECK              VALUE 'R'.
  7547             88  PY-GA-CHECK                  VALUE 'G'.
  7548             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7549             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7550         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7551         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7552         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7553         16  PY-BILL-FLAG                 PIC X.
  7554             88  PY-BILLED                    VALUE 'B'.
  7555         16  PY-AR-FLAG                   PIC X.
  7556             88  PY-AR-CYCLE                  VALUE 'C'.
  7557             88  PY-AR-MONTH-END              VALUE 'M'.
  7558         16  PY-AR-DATE                   PIC XX.
  7559
  7560     12  PY-GL-CODES.
  7561         16  PY-GL-DB                     PIC X(14).
  7562         16  PY-GL-CR                     PIC X(14).
  7563         16  PY-GL-FLAG                   PIC X.
  7564         16  PY-GL-DATE                   PIC XX.
  7565
  7566     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7567     12  FILLER                           PIC X(3).
  7568******************************************************************
  7569*                                COPY ERCCNOT.
  7570******************************************************************
  7571*                                                                *
  7572*                            ERCCNOT                             *
  7573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 139
* EL6311.cbl
  7574*                            VMOD=2.003                          *
  7575*                                                                *
  7576*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7577*                                                                *
  7578*        FILE TYPE= VSAM,KSDS                                    *
  7579*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7580*                                                                *
  7581*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7582*                                                                *
  7583*        LOG = YES                                               *
  7584*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7585*                                                                *
  7586******************************************************************
  7587*                   C H A N G E   L O G
  7588*
  7589* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7590*-----------------------------------------------------------------
  7591*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7592* EFFECTIVE    NUMBER
  7593*-----------------------------------------------------------------
  7594* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7595******************************************************************
  7596
  7597 01  CERT-NOTE-FILE.
  7598     12  CZ-RECORD-ID                PIC  XX.
  7599         88  VALID-CZ-ID                  VALUE 'CZ'.
  7600
  7601     12  CZ-CONTROL-PRIMARY.
  7602         16  CZ-COMPANY-CD           PIC X.
  7603         16  CZ-CARRIER              PIC X.
  7604         16  CZ-GROUPING.
  7605             20 CZ-GROUPING-PREFIX   PIC XXX.
  7606             20 CZ-GROUPING-PRIME    PIC XXX.
  7607         16  CZ-STATE                PIC XX.
  7608         16  CZ-ACCOUNT.
  7609             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7610             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7611         16  CZ-CERT-EFF-DT          PIC XX.
  7612         16  CZ-CERT-NO.
  7613             20  CZ-CERT-PRIME       PIC X(10).
  7614             20  CZ-CERT-SFX         PIC X.
  7615         16  CZ-RECORD-TYPE          PIC X.
  7616             88  CERT-NOTE           VALUE '1'.
  7617             88  CLAIM-CERT-NOTE     VALUE '2'.
  7618         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7619
  7620     12  CZ-LAST-MAINT-DT            PIC XX.
  7621     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7622     12  CZ-LAST-MAINT-USER          PIC X(4).
  7623
  7624     12  CZ-NOTE-INFORMATION.
  7625         16  CZ-NOTE                 PIC X(63).
  7626         16  FILLER                  PIC X(39).
  7627******************************************************************
  7628*                                COPY ELCMSTR.
  7629******************************************************************
  7630*                                                                *
  7631*                            ELCMSTR.                            *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 140
* EL6311.cbl
  7632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7633*                            VMOD=2.012                          *
  7634*                                                                *
  7635*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7636*                                                                *
  7637*   FILE TYPE = VSAM,KSDS                                        *
  7638*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7639*                                                                *
  7640*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7641*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7642*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7643*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7644*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7645*                                                 RKP=75,LEN=21  *
  7646*                                                                *
  7647*   **** NOTE ****                                               *
  7648*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7649*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7650*                                                                *
  7651*   LOG = YES                                                    *
  7652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7653******************************************************************
  7654*                   C H A N G E   L O G
  7655*
  7656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7657*-----------------------------------------------------------------
  7658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7659* EFFECTIVE    NUMBER
  7660*-----------------------------------------------------------------
  7661* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7662* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7663* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7664* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7665* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7666* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7667* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7668******************************************************************
  7669 01  CLAIM-MASTER.
  7670     12  CL-RECORD-ID                PIC XX.
  7671         88  VALID-CL-ID         VALUE 'CL'.
  7672
  7673     12  CL-CONTROL-PRIMARY.
  7674         16  CL-COMPANY-CD           PIC X.
  7675         16  CL-CARRIER              PIC X.
  7676         16  CL-CLAIM-NO             PIC X(7).
  7677         16  CL-CERT-NO.
  7678             20  CL-CERT-PRIME       PIC X(10).
  7679             20  CL-CERT-SFX         PIC X.
  7680
  7681     12  CL-CONTROL-BY-NAME.
  7682         16  CL-COMPANY-CD-A1        PIC X.
  7683         16  CL-INSURED-LAST-NAME    PIC X(15).
  7684         16  CL-INSURED-NAME.
  7685             20  CL-INSURED-1ST-NAME PIC X(12).
  7686             20  CL-INSURED-MID-INIT PIC X.
  7687
  7688     12  CL-CONTROL-BY-SSN.
  7689         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 141
* EL6311.cbl
  7690         16  CL-SOC-SEC-NO.
  7691             20  CL-SSN-STATE        PIC XX.
  7692             20  CL-SSN-ACCOUNT      PIC X(6).
  7693             20  CL-SSN-LN3          PIC X(3).
  7694
  7695     12  CL-CONTROL-BY-CERT-NO.
  7696         16  CL-COMPANY-CD-A4        PIC X.
  7697         16  CL-CERT-NO-A4.
  7698             20  CL-CERT-A4-PRIME    PIC X(10).
  7699             20  CL-CERT-A4-SFX      PIC X.
  7700
  7701     12  CL-CONTROL-BY-CCN.
  7702         16  CL-COMPANY-CD-A5        PIC X.
  7703         16  CL-CCN-A5.
  7704             20  CL-CCN.
  7705                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7706                 24  CL-CCN-PRIME-A5 PIC X(12).
  7707             20  CL-CCN-FILLER-A5    PIC X(4).
  7708
  7709     12  CL-INSURED-PROFILE-DATA.
  7710         16  CL-INSURED-BIRTH-DT     PIC XX.
  7711         16  CL-INSURED-SEX-CD       PIC X.
  7712             88  INSURED-IS-MALE        VALUE 'M'.
  7713             88  INSURED-IS-FEMALE      VALUE 'F'.
  7714             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7715         16  CL-INSURED-OCC-CD       PIC X(6).
  7716         16  FILLER                  PIC X(5).
  7717
  7718     12  CL-PROCESSING-INFO.
  7719         16  CL-PROCESSOR-ID         PIC X(4).
  7720         16  CL-CLAIM-STATUS         PIC X.
  7721             88  CLAIM-IS-OPEN          VALUE 'O'.
  7722             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7723         16  CL-CLAIM-TYPE           PIC X.
  7724*            88  AH-CLAIM               VALUE 'A'.
  7725*            88  LIFE-CLAIM             VALUE 'L'.
  7726*            88  PROPERTY-CLAIM         VALUE 'P'.
  7727*            88  IUI-CLAIM              VALUE 'I'.
  7728*            88  GAP-CLAIM              VALUE 'G'.
  7729*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7730*            88  OTHER-CLAIM            VALUE 'O'.
  7731         16  CL-CLAIM-PREM-TYPE      PIC X.
  7732             88  SINGLE-PREMIUM         VALUE '1'.
  7733             88  O-B-COVERAGE           VALUE '2'.
  7734             88  OPEN-END-COVERAGE      VALUE '3'.
  7735         16  CL-INCURRED-DT          PIC XX.
  7736         16  CL-REPORTED-DT          PIC XX.
  7737         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7738         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7739         16  CL-LAST-PMT-DT          PIC XX.
  7740         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7741         16  CL-PAID-THRU-DT         PIC XX.
  7742         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7743         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7744         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7745         16  CL-PMT-CALC-METHOD      PIC X.
  7746             88  CL-360-DAY-YR          VALUE '1'.
  7747             88  CL-365-DAY-YR          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 142
* EL6311.cbl
  7748             88  CL-FULL-MONTHS         VALUE '3'.
  7749         16  CL-CAUSE-CD             PIC X(6).
  7750
  7751         16  CL-PRIME-CERT-NO.
  7752             20  CL-PRIME-CERT-PRIME PIC X(10).
  7753             20  CL-PRIME-CERT-SFX   PIC X.
  7754
  7755         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7756             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7757             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7758
  7759         16  CL-MICROFILM-NO         PIC X(10).
  7760         16  FILLER REDEFINES CL-MICROFILM-NO.
  7761             20  CL-BENEFIT-PERIOD   PIC 99.
  7762             20  FILLER              PIC X(8).
  7763         16  CL-PROG-FORM-TYPE       PIC X.
  7764         16  CL-LAST-ADD-ON-DT       PIC XX.
  7765
  7766         16  CL-LAST-REOPEN-DT       PIC XX.
  7767         16  CL-LAST-CLOSE-DT        PIC XX.
  7768         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7769             88  FINAL-PAID             VALUE '1'.
  7770             88  CLAIM-DENIED           VALUE '2'.
  7771             88  AUTO-CLOSE             VALUE '3'.
  7772             88  MANUAL-CLOSE           VALUE '4'.
  7773             88  BENEFITS-CHANGED       VALUE 'C'.
  7774             88  SETUP-ERRORS           VALUE 'E'.
  7775         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7776         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7777         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7778             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7779         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7780         16  FILLER                  PIC X.
  7781
  7782     12  CL-CERTIFICATE-DATA.
  7783         16  CL-CERT-ORIGIN          PIC X.
  7784             88  CERT-WAS-ONLINE        VALUE '1'.
  7785             88  CERT-WAS-CREATED       VALUE '2'.
  7786             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7787         16  CL-CERT-KEY-DATA.
  7788             20  CL-CERT-CARRIER     PIC X.
  7789             20  CL-CERT-GROUPING    PIC X(6).
  7790             20  CL-CERT-STATE       PIC XX.
  7791             20  CL-CERT-ACCOUNT.
  7792                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7793                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7794             20  CL-CERT-EFF-DT      PIC XX.
  7795
  7796     12  CL-STATUS-CONTROLS.
  7797         16  CL-PRIORITY-CD          PIC X.
  7798             88  CONFIDENTIAL-DATA      VALUE '8'.
  7799             88  HIGHEST-PRIORITY       VALUE '9'.
  7800         16  CL-SUPV-ATTN-CD         PIC X.
  7801             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7802             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7803         16  CL-PURGED-DT            PIC XX.
  7804         16  CL-RESTORED-DT          PIC XX.
  7805         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 143
* EL6311.cbl
  7806         16  CL-NEXT-RESEND-DT       PIC XX.
  7807         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7808         16  CL-CRITICAL-PERIOD      PIC 99.
  7809*        16  FILLER                  PIC XX.
  7810         16  CL-LAST-MAINT-DT        PIC XX.
  7811         16  CL-LAST-MAINT-USER      PIC X(4).
  7812         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7813         16  CL-LAST-MAINT-TYPE      PIC X.
  7814             88  CLAIM-SET-UP           VALUE ' '.
  7815             88  PAYMENT-MADE           VALUE '1'.
  7816             88  LETTER-SENT            VALUE '2'.
  7817             88  MASTER-WAS-ALTERED     VALUE '3'.
  7818             88  MASTER-WAS-RESTORED    VALUE '4'.
  7819             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7820             88  FILE-CONVERTED         VALUE '6'.
  7821             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7822             88  ERROR-CORRECTION       VALUE 'E'.
  7823         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7824         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7825         16  CL-BENEFICIARY          PIC X(10).
  7826         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7827         16  CL-DENIAL-TYPE          PIC X.
  7828             88  CL-TYPE-DENIAL          VALUE '1'.
  7829             88  CL-TYPE-RESCISSION      VALUE '2'.
  7830             88  CL-TYPE-REFORMATION     VALUE '3'.
  7831             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7832             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7833         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7834         16  filler                  pic x(3).
  7835*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7836*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7837*        16  CL-RTW-DT               PIC XX.
  7838
  7839     12  CL-TRAILER-CONTROLS.
  7840         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7841             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7842             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7843             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7844         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7845         16  FILLER                  PIC XX.
  7846         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7847         16  CL-ADDRESS-TRAILER-CNT.
  7848             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7849                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7850             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7851                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7852             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7853                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7854             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7855                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7856             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7857                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7858             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7859                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7860             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7861                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7862
  7863     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 144
* EL6311.cbl
  7864         16  CL-CV-REFNO-PRIME       PIC X(18).
  7865         16  CL-CV-REFNO-SFX         PIC XX.
  7866
  7867     12  CL-FILE-LOCATION            PIC X(4).
  7868
  7869     12  CL-PROCESS-ERRORS.
  7870         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7871             88  NO-FATAL-ERRORS        VALUE ZERO.
  7872         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7873             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7874
  7875     12  CL-PRODUCT-CD               PIC X.
  7876
  7877     12  CL-CURRENT-KEY-DATA.
  7878         16  CL-CURRENT-CARRIER      PIC X.
  7879         16  CL-CURRENT-GROUPING     PIC X(6).
  7880         16  CL-CURRENT-STATE        PIC XX.
  7881         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7882
  7883     12  CL-ASSOCIATES               PIC X.
  7884         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7885         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7886         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7887         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7888
  7889     12  CL-ACTIVITY-CODE            PIC 99.
  7890     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7891     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7892
  7893     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7894     12  CL-LAG-REPORT-CODE          PIC 9.
  7895     12  CL-LOAN-TYPE                PIC XX.
  7896     12  CL-LEGAL-STATE              PIC XX.
  7897
  7898     12  CL-YESNOSW                  PIC X.
  7899     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7900         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7901         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7902         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7903     12  cl-insured-type             pic x.
  7904         88  cl-claim-on-primary         value 'P'.
  7905         88  cl-claim-on-co-borrower     value 'C'.
  7906     12  cl-benefit-expiration-dt    PIC XX.
  7907*                                COPY ERCENDT.
  7908******************************************************************
  7909*                                                                *
  7910*                                                                *
  7911*                            ERCENDT.                            *
  7912*                            VMOD=2.001                          *
  7913*                                                                *
  7914*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7915*                                                                *
  7916*   FILE TYPE = VSAM,KSDS                                        *
  7917*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7918*                                                                *
  7919*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7920*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7921*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 145
* EL6311.cbl
  7922*   LOG = NO                                                     *
  7923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7924******************************************************************
  7925*-----------------------------------------------------------------
  7926*                   C H A N G E   L O G
  7927*
  7928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7929*-----------------------------------------------------------------
  7930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7931* EFFECTIVE    NUMBER
  7932*-----------------------------------------------------------------
  7933* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7934*                                WITH OPEN CLAIMS
  7935* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7936* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7937* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7938* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7939*-----------------------------------------------------------------
  7940 01  ENDORSEMENT-RECORD.
  7941     12  EN-RECORD-ID                PIC XX.
  7942         88  VALID-EN-ID                VALUE 'EN'.
  7943     12  EN-CONTROL-PRIMARY.
  7944         16  EN-COMPANY-CD           PIC X.
  7945         16  EN-CARRIER              PIC X.
  7946         16  EN-GROUPING             PIC X(6).
  7947         16  EN-STATE                PIC XX.
  7948         16  EN-ACCOUNT              PIC X(10).
  7949         16  EN-CERT-EFF-DT          PIC XX.
  7950         16  EN-CERT-NO.
  7951             20  EN-CERT-PRIME       PIC X(10).
  7952             20  EN-CERT-SFX         PIC X.
  7953         16  EN-REC-TYPE             PIC X.
  7954             88  EN-ISSUE               VALUE 'I'.
  7955             88  EN-CANCELLATION        VALUE 'C'.
  7956         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7957     12  EN-CONTROL-BY-ARCH-NO.
  7958         16  EN-COMPANY-CD-A1              PIC X.
  7959         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7960     12  EN-LAST-MAINT-DT            PIC XX.
  7961     12  EN-LAST-MAINT-BY            PIC X(4).
  7962     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7963     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7964     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7965         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7966         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7967         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7968         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7969         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7970         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7971         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7972         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7973         16  EN-LF-ORIG-BENCD        PIC XX.
  7974         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7975         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7976         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7977         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7978         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7979         16  EN-LF-ORIG-EXP-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 146
* EL6311.cbl
  7980*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7981         16  EN-ORIG-CRED-BENE       PIC X(25).
  7982         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7983         16  FILLER                  PIC X.
  7984         16  EN-AH-ORIG-BENCD        PIC XX.
  7985         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7986         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7987         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7988         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7989*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7990*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7991         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7992         16  F                       PIC X(09).
  7993         16  EN-AH-ORIG-CP           PIC 99.
  7994         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7995         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7996         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7997         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7998         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7999         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8000         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8001         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8002         16  EN-LF-NEW-BENCD         PIC XX.
  8003         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8004         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8005         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8006         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8007         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8008         16  EN-LF-NEW-EXP-DT        PIC XX.
  8009         16  EN-NEW-CRED-BENE        PIC X(25).
  8010         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8011         16  FILLER                  PIC X.
  8012         16  EN-AH-NEW-BENCD         PIC XX.
  8013         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8014         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8015         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8016         16  EN-AH-NEW-EXP-DT        PIC XX.
  8017*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8018*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8019*        16  F                       PIC X(12).
  8020         16  EN-AH-NEW-CP            PIC 99.
  8021         16  EN-SIG-SW               PIC X.
  8022         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8023         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8024         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8025         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8026         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8027         16  FILLER                  PIC X(33).
  8028     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8029         16  EN-LF-ORIG-REF-DT       PIC XX.
  8030         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8031         16  EN-AH-ORIG-REF-DT       PIC XX.
  8032         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8033         16  EN-LF-NEW-REF-DT        PIC XX.
  8034         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8035         16  EN-AH-NEW-REF-DT        PIC XX.
  8036         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8037         16  EN-FLAG-CERT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 147
* EL6311.cbl
  8038         16  EN-INS-LAST-NAME        PIC X(15).
  8039         16  EN-INS-FIRST-NAME       PIC X(10).
  8040         16  EN-INS-MIDDLE-INIT      PIC X.
  8041         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8042         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8043         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8044         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8045         16  FILLER                  PIC X(262).
  8046     12  EN-MONEY-SW             PIC X.
  8047     12  EN-HEALTH-APP           PIC X.
  8048     12  EN-VOUCHER-SW           PIC X.
  8049     12  EN-PAYEE                PIC X(14).
  8050     12  EN-INPUT-DT             PIC XX.
  8051     12  EN-PROCESS-DT           PIC XX.
  8052     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8053     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8054     12  EN-REASON-CODES.
  8055         16  F OCCURS 12.
  8056             20  EN-REASON-CODE  PIC X(4).
  8057     12  EN-TEMPLATE-USED        PIC X(8).
  8058     12  EN-DOCU-TYPE            PIC X.
  8059         88  EN-VERI-DOCU          VALUE 'V'.
  8060         88  EN-GCE-DOCU           VALUE 'G'.
  8061         88  EN-CANC-DOCU          VALUE 'C'.
  8062     12  EN-COMMENTS1            PIC X(13).
  8063     12  EN-COMMENTS2            PIC X(70).
  8064     12  EN-COMM-CHGBK           PIC X.
  8065         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8066         88  EN-CHG-ACCT           VALUE 'Y'.
  8067     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8068     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8069     12  EN-BATCH-NUMBER         PIC X(6).
  8070     12  EN-ACCT-SUMM            PIC X.
  8071     12  EN-CSO-SUMM             PIC X.
  8072     12  en-check-type           pic x.
  8073     12  FILLER                  PIC X(12).
  8074******************************************************************
  8075*                                COPY ELCCRTT.
  8076******************************************************************
  8077*                                                                *
  8078*                            ELCCRTT.                            *
  8079*                                                                *
  8080*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8081*                                                                *
  8082*   FILE TYPE = VSAM,KSDS                                        *
  8083*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8084*                                                                *
  8085*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8086*                                                                *
  8087*   LOG = YES                                                    *
  8088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8089******************************************************************
  8090*                   C H A N G E   L O G
  8091*
  8092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8093*-----------------------------------------------------------------
  8094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8095* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 148
* EL6311.cbl
  8096*-----------------------------------------------------------------
  8097* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8098* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8099* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8100* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8101* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8102* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8103* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8104* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8105* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8106* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8107* 091318  CR2018073000001  PEMA  ADD Refund methods
  8108* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8109******************************************************************
  8110
  8111 01  CERTIFICATE-TRAILERS.
  8112     12  CS-RECORD-ID                      PIC XX.
  8113         88  VALID-CS-ID                      VALUE 'CS'.
  8114
  8115     12  CS-CONTROL-PRIMARY.
  8116         16  CS-COMPANY-CD                 PIC X.
  8117         16  CS-CARRIER                    PIC X.
  8118         16  CS-GROUPING                   PIC X(6).
  8119         16  CS-STATE                      PIC XX.
  8120         16  CS-ACCOUNT                    PIC X(10).
  8121         16  CS-CERT-EFF-DT                PIC XX.
  8122         16  CS-CERT-NO.
  8123             20  CS-CERT-PRIME             PIC X(10).
  8124             20  CS-CERT-SFX               PIC X.
  8125         16  CS-TRAILER-TYPE               PIC X.
  8126             88  COMM-TRLR           VALUE 'A'.
  8127             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8128             88  CERT-DATA-TRLR      VALUE 'C'.
  8129
  8130     12  CS-DATA-AREA                      PIC X(516).
  8131
  8132     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8133         16  CS-BANK-COMMISSION-AREA.
  8134             20  CS-BANK-COMMS       OCCURS 10.
  8135                 24  CS-AGT                PIC X(10).
  8136                 24  CS-COM-TYP            PIC X.
  8137                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8138                 24  CS-RECALC-LV-INDIC    PIC X.
  8139                 24  FILLER                PIC X(10).
  8140         16  FILLER                        PIC X(256).
  8141
  8142     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8143****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8144         16  CS-MB-CLAIM-DATA OCCURS 24.
  8145             20  CS-CLAIM-NO               PIC X(7).
  8146             20  CS-CLAIM-TYPE             PIC X.
  8147                 88  CS-AH-CLM               VALUE 'A'.
  8148                 88  CS-IU-CLM               VALUE 'I'.
  8149                 88  CS-GP-CLM               VALUE 'G'.
  8150                 88  CS-LF-CLM               VALUE 'L'.
  8151                 88  CS-PR-CLM               VALUE 'P'.
  8152                 88  CS-FL-CLM               VALUE 'F'.
  8153                 88  CS-OT-CLM               VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 149
* EL6311.cbl
  8154             20  CS-INSURED-TYPE           PIC X.
  8155                 88  CS-PRIM-INSURED          VALUE 'P'.
  8156                 88  CS-CO-BORROWER           VALUE 'C'.
  8157             20  CS-BENEFIT-PERIOD         PIC 99.
  8158             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8159             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8160             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8161         16  FILLER                        PIC X(12).
  8162     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8163         16  CS-VIN-NUMBER                 PIC X(17).
  8164         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8165         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8166         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8167         16  cs-agent-name.
  8168             20  cs-agent-fname            pic x(20).
  8169             20  cs-agent-mi               pic x.
  8170             20  cs-agent-lname            pic x(25).
  8171         16  cs-license-no                 pic x(15).
  8172         16  cs-npn-number                 pic x(10).
  8173         16  cs-agent-edit-status          pic x.
  8174             88  cs-ae-refer-to-manager      value 'M'.
  8175             88  cs-ae-cover-sheet           value 'C'.
  8176             88  cs-ae-sig-form              value 'S'.
  8177             88  cs-ae-verified              value 'V'.
  8178             88  cs-unidentified-signature   value 'U'.
  8179             88  cs-cert-returned            value 'R'.
  8180             88  cs-accept-no-commission     value 'N'.
  8181         16  cs-year                       pic 9999.
  8182         16  cs-make                       pic x(20).
  8183         16  cs-model                      pic x(20).
  8184         16  cs-future                     pic x(20).
  8185         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8186         16  cs-claim-verification-status  pic x.
  8187             88  cs-clm-ver-eligible         value 'A'.
  8188             88  cs-clm-ver-partial-elig     value 'B'.
  8189             88  cs-clm-ver-not-eligible     value 'C'.
  8190             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8191             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8192             88  cs-clm-ver-ND-CERT          value 'F'.
  8193             88  cs-clm-ver-spec-other       value 'G'.
  8194             88  cs-clam-ver-pratial-corrected
  8195                                             value 'H'.
  8196             88  cs-clm-ver-no-matches       value 'I'.
  8197             88  cs-clm-ver-not-elig-corrected
  8198                                             value 'J'.
  8199             88  cs-clm-ver-needs-review     value 'R'.
  8200             88  cs-clm-ver-sent-to-claims   value 'W'.
  8201         16  CS-LF-REFUND-METHOD           PIC X.
  8202         16  CS-AH-REFUND-METHOD           PIC X.
  8203         16  FILLER                        PIC X(353). *> was 420
  8204*        16  FILLER                        PIC X(496).
  8205*                                COPY ERCCHEK.
  8206******************************************************************
  8207*                                                                *
  8208*                                                                *
  8209*                            ERCCHEK                             *
  8210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8211*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 150
* EL6311.cbl
  8212*                                                                *
  8213*   FILE DESCRIPTION = CHECK RECORDS                             *
  8214*                                                                *
  8215*   FILE TYPE = VSAM,KSDS                                        *
  8216*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8217*                                                                *
  8218*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8219*       ALTERNATE INDEX = NONE                                   *
  8220*                                                                *
  8221*   LOG = YES                                                    *
  8222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8223******************************************************************
  8224*                   C H A N G E   L O G
  8225*
  8226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8227*-----------------------------------------------------------------
  8228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8229* EFFECTIVE    NUMBER
  8230*-----------------------------------------------------------------
  8231* 021414    2003053000001  PEMA  changes for auto chk request
  8232******************************************************************
  8233 01  CHECK-RECORDS.
  8234     12  CH-RECORD-ID                      PIC XX.
  8235         88  VALID-CH-ID                      VALUE 'CH'.
  8236
  8237     12  CH-CONTROL-PRIMARY.
  8238         16  CH-COMPANY-CD                 PIC X.
  8239         16  CH-CARRIER                    PIC X.
  8240         16  CH-GROUPING                   PIC X(6).
  8241         16  CH-STATE                      PIC XX.
  8242         16  CH-ACCOUNT                    PIC X(10).
  8243         16  CH-CERT-EFF-DT                PIC XX.
  8244         16  CH-CERT-NO.
  8245             20  CH-CERT-PRIME             PIC X(10).
  8246             20  CH-CERT-SFX               PIC X.
  8247         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8248
  8249     12  CH-RECORDED-DT                    PIC XX.
  8250     12  CH-RECORDED-BY                    PIC X(4).
  8251     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8252
  8253     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8254     12  CH-CHECK-NO                       PIC X(7).
  8255     12  CH-REASON-FOR-CHECK               PIC X(25).
  8256     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8257     12  FILLER                            PIC X.
  8258
  8259     12  CH-PAYEE-INFO.
  8260         16  CH-PAYEE-NAME-1               PIC X(30).
  8261         16  CH-PAYEE-NAME-2               PIC X(30).
  8262         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8263         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8264         16  CH-PAYEE-CITY-ST.
  8265             20  CH-PAYEE-CITY             PIC X(28).
  8266             20  CH-PAYEE-STATE            PIC XX.
  8267         16  CH-PAYEE-ZIP-CODE.
  8268             20  CH-PAYEE-ZIP.
  8269                 24  CH-ZIP-PRI-1ST        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 151
* EL6311.cbl
  8270                     88  CH-CANADIAN-POST-CODE
  8271                                           VALUES 'A' THRU 'Z'.
  8272                 24  FILLER                PIC X(4).
  8273             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8274         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8275             20  CH-CAN-POSTAL-1           PIC XXX.
  8276             20  CH-CAN-POSTAL-2           PIC XXX.
  8277             20  FILLER                    PIC XXX.
  8278
  8279     12  CH-CHECK-STUB-TEXT.
  8280         16  CH-STUB-LINE-1                PIC X(30).
  8281         16  CH-TEXT-LINE-1                PIC X(50).
  8282         16  CH-TEXT-LINE-2                PIC X(50).
  8283         16  CH-TEXT-LINE-3                PIC X(40).
  8284     12  CH-RETURN-TO                      PIC X(30).
  8285
  8286     12  CH-COMPENSATION-CONTROL.
  8287         16  CH-COMP-CARRIER               PIC X.
  8288         16  CH-COMP-GROUPING              PIC X(6).
  8289         16  CH-COMP-FIN-RESP              PIC X(10).
  8290         16  CH-COMP-ACCOUNT               PIC X(10).
  8291
  8292     12  CH-CREDIT-SELECT-DT               PIC XX.
  8293     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8294     12  CH-PAYEE-CODE                     PIC X(6).
  8295
  8296     12  CH-VOID-DATA.
  8297         20  CH-VOID-DT                    PIC XX.
  8298         20  CH-VOID-BY                    PIC X(4).
  8299         20  CH-VOID-REASON                PIC X(25).
  8300
  8301     12  CH-APPROVAL-DATA.
  8302         20  CH-APPROVAL-DT                PIC XX.
  8303         20  CH-APPROVAL-STATUS            PIC X.
  8304             88  CH-IN-LIMBO                  VALUE ' '.
  8305             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8306             88  CH-APPROVED                  VALUE 'A'.
  8307             88  CH-DENIED                    VALUE 'D'.
  8308         20  CH-APPROVED-BY                PIC XXXX.
  8309     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8310             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8311     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8312
  8313     12  ch-released-dt                    pic xx.
  8314     12  ch-check-cashed-dt                pic xx.
  8315     12  FILLER                            PIC X.
  8316*    12  CH-CHECK-REFERENCE                PIC X(12).
  8317     12  CH-CHECK-ORIGIN-SW                PIC X.
  8318             88  CH-REFUND-CHECK              VALUE 'R'.
  8319             88  CH-MAINT-CHECK               VALUE 'M'.
  8320
  8321     12  CH-CANC-DT                        PIC XX.
  8322     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8323     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8324
  8325     12  CH-INSURED-NAME                   PIC X(28).
  8326
  8327     12  ch-released-by                    pic x(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 152
* EL6311.cbl
  8328     12  ch-csr                            pic x(4).
  8329     12  ch-deduct-commission              pic x.
  8330         88  ch-deduct-comm                  value 'Y'.
  8331         88  ch-do-not-deduct-comm           value 'N'.
  8332
  8333     12  FILLER                            PIC X(11).
  8334*    12  CH-LETTER-TABLE.
  8335*        16  CH-LETTERS OCCURS 3 TIMES
  8336*                       INDEXED BY CH-LT-NDX
  8337*                                          PIC X(04).
  8338
  8339     12  FILLER                            PIC X(07).
  8340
  8341 01  var                         pic x(30).
  8342 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8343                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8344                          PENDING-MAILING-DATA MAILING-DATA
  8345                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8346                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8347                          CLAIM-MASTER ENDORSEMENT-RECORD
  8348                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8349                          VAR.
  8350 0000-DFHEXIT SECTION.
  8351     MOVE '9#                    $   ' TO DFHEIV0.
  8352     MOVE 'EL6311' TO DFHEIV1.
  8353     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8354
  8355     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8356     MOVE EIBTRMID               TO QID-TERM.
  8357     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8358     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8359     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8360     MOVE 2                      TO EMI-SWITCH2.
  8361
  8362     move spaces to ws-kix-myenv
  8363     set P to address of KIXSYS
  8364     CALL "getenv" using by value P returning var-ptr
  8365     if var-ptr = null then
  8366        display ' kixsys not set '
  8367     else
  8368        set address of var to var-ptr
  8369        move 0 to env-var-len
  8370        inspect var tallying env-var-len
  8371          for characters before X'00'
  8372        unstring var (1:env-var-len) delimited by '/'
  8373           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8374              WS-KIX-SYS
  8375        end-unstring
  8376     end-if
  8377     perform varying a1 from +1 by +1 until a1 > +10
  8378        if ws-kix-myenv (a1:1) = low-values or high-values
  8379           display ' found low or hi val '
  8380           move spaces to ws-kix-myenv (a1:1)
  8381        end-if
  8382     end-perform
  8383*    display ' env *' ws-kix-myenv '*'
  8384     IF EIBCALEN = 0
  8385         GO TO 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 153
* EL6311.cbl
  8386
  8387     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8388     MOVE '5'                   TO DC-OPTION-CODE.
  8389     PERFORM 9700-DATE-LINK.
  8390     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8391     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8392
  8393     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8394     MOVE SPACE                  TO DC-OPTION-CODE.
  8395     PERFORM 9700-DATE-LINK.
  8396     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8397     MOVE LOW-VALUES             TO EL631BI.
  8398
  8399
  8400* EXEC CICS HANDLE CONDITION
  8401*        PGMIDERR  (9600-PGMID-ERROR)
  8402*        ERROR     (9990-ABEND)
  8403*        INVREQ    (9990-ABEND)
  8404*        QIDERR    (0010-MAIN-LOGIC)
  8405*    END-EXEC.
  8406*    MOVE '"$L.8N                ! " #00008395' TO DFHEIV0
  8407     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8409     MOVE X'2220233030303038333935' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0
  8411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8412
  8413
  8414     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8415         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8416             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8417             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8418             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8419             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8420             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8421             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8422             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8423             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8424
  8425             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8426                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8427
  8428             ELSE
  8429                 NEXT SENTENCE
  8430
  8431         ELSE
  8432             IF PI-CALLING-PROGRAM = 'EL6315'
  8433                SET CALLED-FROM-6315 TO TRUE
  8434             END-IF
  8435             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8436             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8437             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8438             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8439             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8440             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8441             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8442             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8443             MOVE SPACES               TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 154
* EL6311.cbl
  8444             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8445             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8446             GO TO 3900-RE-DISPLAY-RECORD
  8447     ELSE
  8448         GO TO 0020-MAIN-LOGIC.
  8449
  8450 0010-MAIN-LOGIC.
  8451     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8452                                    WS-FIRST-ENTRY-SW.
  8453
  8454     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8455
  8456     MOVE LOW-VALUES             TO EC-NEW-CERT
  8457                                    EC-NEW-STATE.
  8458
  8459     IF PI-DISPLAY-ORIGINAL-BATCH
  8460         NEXT SENTENCE
  8461     ELSE
  8462         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8463             GO TO 5000-BROWSE-BATCH-HEADERS.
  8464
  8465     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8466         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8467
  8468     IF PI-CSR-BROWSE
  8469        GO TO 4200-BROWSE-CSR-FORWARD.
  8470
  8471     IF PI-FILE-BROWSE
  8472         GO TO 4300-BROWSE-FILE-FORWARD.
  8473
  8474     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8475
  8476 0020-MAIN-LOGIC.
  8477     IF EIBAID = DFHCLEAR
  8478         GO TO 9400-CLEAR.
  8479
  8480     MOVE LOW-VALUES             TO EC-NEW-CERT
  8481                                    EC-NEW-STATE.
  8482
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 155
* EL6311.cbl
  8484
  8485******************************************************************
  8486*                                                                *
  8487*              R E C E I V E   M A P                             *
  8488*                                                                *
  8489******************************************************************
  8490
  8491 0200-RECEIVE.
  8492     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8493         MOVE ER-0008            TO EMI-ERROR
  8494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8495         IF PI-MAP-NAME = EL631B
  8496             MOVE -1                 TO BMAINTL
  8497             GO TO 8200-SEND-DATAONLY
  8498         ELSE
  8499             IF PI-MAP-NAME = EL631C
  8500                 MOVE -1                 TO CMAINTL
  8501                 GO TO 8200-SEND-DATAONLY
  8502             ELSE
  8503                 IF PI-MAP-NAME = EL631D
  8504                     MOVE -1                 TO DPFENTRL
  8505                     GO TO 8200-SEND-DATAONLY.
  8506
  8507
  8508* EXEC CICS RECEIVE
  8509*        MAP      (PI-MAP-NAME)
  8510*        MAPSET   (MAPSET-EL6311S)
  8511*        INTO     (EL631BI)
  8512*    END-EXEC.
  8513     MOVE LENGTH OF
  8514      EL631BI
  8515       TO DFHEIV11
  8516*    MOVE '8"T I  L              ''   #00008495' TO DFHEIV0
  8517     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8519     MOVE X'2020233030303038343935' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           PI-MAP-NAME,
  8522           EL631BI,
  8523           DFHEIV11,
  8524           MAPSET-EL6311S,
  8525           DFHEIV99,
  8526           DFHEIV99
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530******************************************************************
  8531*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8532******************************************************************
  8533
  8534     IF BTYPE-LEN (1) EQUAL +3
  8535        IF BTYPE (1) EQUAL ALL ' '
  8536            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8537
  8538     IF BTYPE-LEN (2) EQUAL +3
  8539        IF BTYPE (2) EQUAL ALL ' '
  8540            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8541
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 156
* EL6311.cbl
  8542     INSPECT EL631BI CONVERTING '_' TO ' '.
  8543
  8544     IF PI-MAP-NAME = EL631B
  8545         IF BPFENTRL GREATER THAN ZEROS
  8546             IF EIBAID NOT = DFHENTER
  8547                 MOVE ER-0004       TO EMI-ERROR
  8548                 MOVE -1            TO BPFENTRL
  8549                 MOVE AL-UNBOF      TO BPFENTRA
  8550                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8551                 GO TO 8200-SEND-DATAONLY
  8552             ELSE
  8553                 IF BPFENTRI NUMERIC AND
  8554                   (BPFENTRI GREATER 0 AND LESS 25)
  8555                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8556                 ELSE
  8557                     MOVE ER-0029  TO EMI-ERROR
  8558                     MOVE AL-UNBON TO BPFENTRA
  8559                     MOVE -1       TO BPFENTRL
  8560                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8561                     GO TO 8200-SEND-DATAONLY
  8562         ELSE
  8563             NEXT SENTENCE
  8564     ELSE
  8565         IF PI-MAP-NAME = EL631C
  8566            IF CPFENTRL GREATER THAN ZEROS
  8567                IF EIBAID NOT = DFHENTER
  8568                 MOVE ER-0004         TO EMI-ERROR
  8569                 MOVE -1              TO CPFENTRL
  8570                 MOVE AL-UNBOF        TO CPFENTRA
  8571                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8572                 GO TO 8200-SEND-DATAONLY
  8573             ELSE
  8574                 IF CPFENTRI NUMERIC AND
  8575                   (CPFENTRI GREATER 0 AND LESS 25)
  8576                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8577                 ELSE
  8578                     MOVE ER-0029      TO EMI-ERROR
  8579                     MOVE AL-UNBON     TO CPFENTRA
  8580                     MOVE -1           TO CPFENTRL
  8581                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8582                     GO TO 8200-SEND-DATAONLY
  8583         ELSE
  8584             NEXT SENTENCE
  8585     ELSE
  8586     IF PI-MAP-NAME = EL631D
  8587         IF DPFENTRL GREATER THAN ZEROS
  8588             IF EIBAID NOT = DFHENTER
  8589                 MOVE ER-0004         TO EMI-ERROR
  8590                 MOVE -1              TO DPFENTRL
  8591                 MOVE AL-UNBOF        TO DPFENTRA
  8592                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8593                 GO TO 8200-SEND-DATAONLY
  8594             ELSE
  8595                 IF DPFENTRI NUMERIC AND
  8596                   (DPFENTRI GREATER 0 AND LESS 25)
  8597                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8598                 ELSE
  8599                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 157
* EL6311.cbl
  8600                     MOVE AL-UNBON     TO DPFENTRA
  8601                     MOVE -1           TO DPFENTRL
  8602                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8603                     GO TO 8200-SEND-DATAONLY.
  8604
  8605     IF EIBAID = DFHPF23
  8606         GO TO 8810-PF23.
  8607
  8608     IF EIBAID = DFHPF24
  8609         GO TO 9200-RETURN-MAIN-MENU.
  8610
  8611     IF EIBAID = DFHPF12
  8612         GO TO 9500-PF12.
  8613
  8614     IF PI-MAP-NAME = EL631B
  8615        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8616
  8617     IF PI-MAP-NAME = EL631C
  8618        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8619
  8620     IF PI-MAP-NAME = EL631D
  8621        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8622
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 158
* EL6311.cbl
  8624
  8625******************************************************************
  8626*                                                                *
  8627*      ISSUE SCREEN PF KEY CHECKING                              *
  8628*                                                                *
  8629******************************************************************
  8630
  8631******************************************************************
  8632*                                                                *
  8633*      PF KEY FUNCTIONS:                                         *
  8634*                                                                *
  8635*      PF1  = BROWSE FORWARD                                     *
  8636*      PF2  = BROWSE BACKWARD                                    *
  8637*      PF3  = CERTIFICATE LOOKUP                                 *
  8638*      PF4  = DISPLAY BATCH HEADER                               *
  8639*      PF5  = ADD ISSUE  SCREEN                                  *
  8640*      PF6  = ADD CANCEL SCREEN                                  *
  8641*      PF7  = CERTIFICATE DISPLAY                                *
  8642*      PF8  = CERTIFICATE NOTES                                  *
  8643*      PF9  = EDIT CONTROL                                       *
  8644*      PF10 = DISPLAY LETTER SCREEN                              *
  8645*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8646*      PF12 = HELP SCREEN                                        *
  8647*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8648*      PF14 = ACCOUNT MASTER                                     *
  8649*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8650*      PF16 = DISPLAY LETTER REVIEW                              *
  8651*                                                                *
  8652******************************************************************
  8653
  8654 0300-CHECK-ISSUE-PF-KEYS.
  8655     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8656        MOVE ER-2337            TO EMI-ERROR
  8657        MOVE -1                  TO BMAINTL
  8658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8659        GO TO 8200-SEND-DATAONLY.
  8660
  8661     IF EIBAID = DFHPF1
  8662        MOVE '0'                TO PI-EDIT-SW
  8663        IF PI-PRIMARY-BROWSE
  8664           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8665        ELSE
  8666           IF PI-PRIMARY-WITH-SELECT
  8667              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8668           ELSE
  8669              IF PI-FILE-BROWSE
  8670                 GO TO 4300-BROWSE-FILE-FORWARD
  8671              ELSE
  8672                 IF PI-CSR-BROWSE
  8673                    GO TO 4200-BROWSE-CSR-FORWARD
  8674                 ELSE
  8675                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8676
  8677     IF EIBAID = DFHPF2
  8678        MOVE '0'                TO PI-EDIT-SW
  8679        IF PI-PRIMARY-BROWSE
  8680           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8681        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 159
* EL6311.cbl
  8682           IF PI-PRIMARY-WITH-SELECT
  8683              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8684           ELSE
  8685              IF PI-FILE-BROWSE
  8686                 GO TO 4800-BROWSE-FILE-BACKWARD
  8687              ELSE
  8688                 IF PI-CSR-BROWSE
  8689                    GO TO 4900-BROWSE-CSR-BACKWARD
  8690                 ELSE
  8691                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8692
  8693     IF EIBAID = DFHPF3
  8694        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8695        MOVE XCTL-EL127         TO PGM-NAME
  8696        GO TO 9300-XCTL.
  8697
  8698     IF (EIBAID = DFHPF15 OR DFHPF6)
  8699        AND (CSR-EDIT-SESSION)
  8700*       AND (FATAL-OR-UNFORCED)
  8701*       AND (FATAL-ERRORS)
  8702        and (pi-6311-fatal-ctr <> +0)
  8703        MOVE ER-1819             TO EMI-ERROR
  8704        MOVE -1                  TO BMAINTL
  8705        MOVE AL-UANON            TO BMAINTA
  8706        PERFORM 9900-ERROR-FORMAT
  8707                                 THRU 9900-EXIT
  8708        GO TO 8200-SEND-DATAONLY
  8709     END-IF
  8710     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8711      OR (EIBAID = DFHPF10)
  8712        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8713        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8714        IF (RESP-NORMAL)
  8715           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8716              AM-CONTROL-PRIMARY (1:20))
  8717            IF AM-NAME NOT GREATER THAN SPACES OR
  8718               AM-ADDRS NOT GREATER THAN SPACES  OR
  8719               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8720               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8721               AM-ZIP NOT GREATER THAN SPACES
  8722               MOVE ER-3834             TO EMI-ERROR
  8723               MOVE -1                  TO BMAINTL
  8724               MOVE AL-UANON            TO BMAINTA
  8725               PERFORM 9900-ERROR-FORMAT
  8726                                 THRU 9900-EXIT
  8727               GO TO 8200-SEND-DATAONLY
  8728            END-IF
  8729        ELSE
  8730           MOVE ER-1609             TO EMI-ERROR
  8731           MOVE -1                  TO BMAINTL
  8732           MOVE AL-UANON            TO BMAINTA
  8733           PERFORM 9900-ERROR-FORMAT
  8734                                THRU 9900-EXIT
  8735           GO TO 8200-SEND-DATAONLY
  8736        END-IF
  8737
  8738        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8739        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 160
* EL6311.cbl
  8740        IF (ERMAIL-FOUND)
  8741            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8742               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8743               MA-CITY NOT GREATER THAN SPACES OR
  8744               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8745               MA-ZIP-CODE NOT GREATER THAN SPACES
  8746               MOVE ER-3835             TO EMI-ERROR
  8747               MOVE -1                  TO BMAINTL
  8748               MOVE AL-UANON            TO BMAINTA
  8749               PERFORM 9900-ERROR-FORMAT
  8750                                 THRU 9900-EXIT
  8751               GO TO 8200-SEND-DATAONLY
  8752            END-IF
  8753        ELSE
  8754           MOVE ER-3000             TO EMI-ERROR
  8755           MOVE -1                  TO BMAINTL
  8756           MOVE AL-UANON            TO BMAINTA
  8757           PERFORM 9900-ERROR-FORMAT
  8758                                THRU 9900-EXIT
  8759           GO TO 8200-SEND-DATAONLY
  8760        END-IF
  8761
  8762     END-IF
  8763     IF (EIBAID = DFHPF15)
  8764        AND (CSR-EDIT-SESSION)
  8765        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8766        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8767        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8768        MOVE PI-SV-STATE         TO PI-STATE
  8769        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8770        MOVE BCERTNOI            TO PI-CERT-PRIME
  8771        MOVE BSUFIXI             TO PI-CERT-SFX
  8772        MOVE BEFFDTI             TO DEEDIT-FIELD
  8773        PERFORM 8600-DEEDIT
  8774        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8775        MOVE '4'                 TO DC-OPTION-CODE
  8776        PERFORM 9700-DATE-LINK
  8777        IF DATE-CONVERSION-ERROR
  8778           MOVE ER-0348          TO EMI-ERROR
  8779           MOVE -1               TO BEFFDTL
  8780           MOVE AL-UABON         TO BEFFDTA
  8781           PERFORM 9900-ERROR-FORMAT
  8782                                 THRU 9900-EXIT
  8783           GO TO 8200-SEND-DATAONLY
  8784        ELSE
  8785           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8786           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8787           MOVE XCTL-EL6315      TO PGM-NAME
  8788           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8789           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8790           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8791           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8792           GO TO 9300-XCTL
  8793        END-IF
  8794     END-IF
  8795
  8796     IF EIBAID = DFHPF4
  8797        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 161
* EL6311.cbl
  8798        IF PI-DISPLAY-ORIGINAL-BATCH
  8799           NEXT SENTENCE
  8800        ELSE
  8801           GO TO 7200-DISPLAY-BATCHES.
  8802
  8803     IF EIBAID = DFHPF5
  8804        MOVE ER-0029                TO EMI-ERROR
  8805        MOVE -1                     TO BPFENTRL
  8806        MOVE AL-UNBON               TO BPFENTRA
  8807        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8808        GO TO 8200-SEND-DATAONLY.
  8809*        MOVE '0'                TO PI-EDIT-SW
  8810*        IF PI-DISPLAY-ORIGINAL-BATCH
  8811*           NEXT SENTENCE
  8812*        ELSE
  8813*           MOVE EL631B              TO PI-MAP-NAME
  8814*           MOVE LOW-VALUES          TO EL631BI
  8815*           MOVE 'A'                 TO BMAINTO
  8816*           MOVE AL-UANON            TO BMAINTA
  8817*           MOVE -1                  TO BMAINTL
  8818*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8819*           GO TO 8100-SEND-INITIAL-MAP.
  8820
  8821     IF EIBAID = DFHPF6
  8822        IF NOT CSR-EDIT-SESSION
  8823           MOVE ER-0029                TO EMI-ERROR
  8824           MOVE -1                     TO BPFENTRL
  8825           MOVE AL-UNBON               TO BPFENTRA
  8826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8827           GO TO 8200-SEND-DATAONLY
  8828*           MOVE '0'              TO PI-EDIT-SW
  8829*           IF PI-DISPLAY-ORIGINAL-BATCH
  8830*              NEXT SENTENCE
  8831*           ELSE
  8832*              MOVE EL631C        TO PI-MAP-NAME
  8833*              MOVE LOW-VALUES    TO EL631CI
  8834*              MOVE 'A'           TO CMAINTO
  8835*              MOVE AL-UANON      TO CMAINTA
  8836*              MOVE -1            TO CMAINTL
  8837*              MOVE '6'           TO PI-MAINT-FUNCTION
  8838*              GO TO 8100-SEND-INITIAL-MAP
  8839*           END-IF
  8840        ELSE
  8841           PERFORM 5100-PROCESS-POL-RESC
  8842                                 THRU 5100-EXIT
  8843           MOVE  PI-PREV-CONTROL-PRIMARY
  8844                                 TO ERPNDB-KEY
  8845
  8846* EXEC CICS READ
  8847*              SET     (ADDRESS OF PENDING-BUSINESS)
  8848*              DATASET (FILE-ID-ERPNDB)
  8849*              RIDFLD  (ERPNDB-KEY)
  8850*          END-EXEC
  8851*    MOVE '&"S        E          (   #00008816' TO DFHEIV0
  8852     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8854     MOVE X'2020233030303038383136' TO DFHEIV0(25:11)
  8855     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 162
* EL6311.cbl
  8856           FILE-ID-ERPNDB,
  8857           DFHEIV20,
  8858           DFHEIV99,
  8859           ERPNDB-KEY,
  8860           DFHEIV99,
  8861           DFHEIV99,
  8862           DFHEIV99
  8863     SET ADDRESS OF PENDING-BUSINESS TO
  8864         DFHEIV20
  8865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8866           PERFORM 9800-LINK-PENDING-EDIT
  8867                                 THRU 9800-EXIT
  8868           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8869           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8870                                    PI-PREV-SEQ-NO
  8871           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8872*                                    WS-CANCEL-LETTER-SW
  8873                                    PI-ALL-ISSUES-SW
  8874                                    PI-ALL-CANCELS-SW
  8875           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8876        END-IF
  8877     END-IF
  8878     IF EIBAID = DFHPF7
  8879        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8880        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8881        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8882        MOVE PI-SV-STATE            TO PI-STATE
  8883        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8884        MOVE BCERTNOI               TO PI-CERT-PRIME
  8885        MOVE BSUFIXI                TO PI-CERT-SFX
  8886        MOVE BEFFDTI                TO DEEDIT-FIELD
  8887        PERFORM 8600-DEEDIT
  8888        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8889        MOVE '4'                    TO DC-OPTION-CODE
  8890        PERFORM 9700-DATE-LINK
  8891        IF DATE-CONVERSION-ERROR
  8892           MOVE ER-0348            TO EMI-ERROR
  8893           MOVE -1                  TO BEFFDTL
  8894           MOVE AL-UABON            TO BEFFDTA
  8895           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8896           GO TO 8200-SEND-DATAONLY
  8897        ELSE
  8898           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8899           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8900           MOVE XCTL-EL1273        TO PGM-NAME
  8901           GO TO 9300-XCTL.
  8902
  8903     IF EIBAID = DFHPF8
  8904        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8905        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8906        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8907        MOVE PI-SV-STATE            TO PI-STATE
  8908        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8909        MOVE BCERTNOI               TO PI-CERT-PRIME
  8910        MOVE BSUFIXI                TO PI-CERT-SFX
  8911        MOVE BEFFDTI                TO DEEDIT-FIELD
  8912        PERFORM 8600-DEEDIT
  8913        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 163
* EL6311.cbl
  8914        MOVE '4'                    TO DC-OPTION-CODE
  8915        PERFORM 9700-DATE-LINK
  8916        IF DATE-CONVERSION-ERROR
  8917           MOVE ER-0348            TO EMI-ERROR
  8918           MOVE -1                  TO BEFFDTL
  8919           MOVE AL-UABON            TO BEFFDTA
  8920           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8921           GO TO 8200-SEND-DATAONLY
  8922        ELSE
  8923           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8924           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8925           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  8926           IF PI-COMPANY-ID = 'DMD'
  8927               MOVE XCTL-EL401DMD      TO PGM-NAME
  8928             ELSE
  8929               MOVE XCTL-EL1279        TO PGM-NAME
  8930           END-IF
  8931           GO TO 9300-XCTL.
  8932
  8933     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8934        MOVE XCTL-EL6312         TO PGM-NAME
  8935
  8936* EXEC CICS XCTL
  8937*           PROGRAM   (PGM-NAME)
  8938*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8939*           LENGTH    (WS-COMM-LENGTH)
  8940*       END-EXEC
  8941*    MOVE '.$C                   %   #00008890' TO DFHEIV0
  8942     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8944     MOVE X'2020233030303038383930' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0,
  8946           PGM-NAME,
  8947           PROGRAM-INTERFACE-BLOCK,
  8948           WS-COMM-LENGTH,
  8949           DFHEIV99
  8950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8951     ELSE
  8952        MOVE '0'                 TO  PI-EDIT-SW.
  8953
  8954     IF  EIBAID = DFHPF10
  8955         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8956         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8957         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8958                                    PI-1042-WA
  8959         MOVE 4                  TO PI-689-DATA-SOURCE
  8960         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8961         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8962         MOVE PI-SV-STATE        TO PI-689-STATE
  8963         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8964         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8965         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8966         MOVE PI-PB-ALT-CHG-SEQ-NO
  8967                                 TO PI-689-ALT-SEQ-NO
  8968         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8969         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8970         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8971         MOVE +0                 TO PI-689-CONTROL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 164
* EL6311.cbl
  8972         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8973                                    PI-689-EXP-DATE
  8974                                    PI-689-RESP-PERSON
  8975                                    PI-689-TYPE
  8976                                    PI-689-FOLLOW-UP-EDIT
  8977                                    PI-689-RESEND1-EDIT
  8978                                    PI-689-SEQ-EDIT
  8979                                    PI-689-BCSEQ-EDIT
  8980                                    PI-689-LBL-OVERRIDE
  8981         MOVE W-LETTER-COMMUNICATION-AREAS
  8982                                 TO PI-PROGRAM-WORK-AREA
  8983         MOVE XCTL-EL689         TO PGM-NAME
  8984         GO TO 9300-XCTL.
  8985
  8986     IF  EIBAID = DFHPF16
  8987         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8988         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8989         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8990                                    PI-1042-WA
  8991         MOVE 4                  TO PI-689-DATA-SOURCE
  8992         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8993         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8994         MOVE PI-SV-STATE        TO PI-689-STATE
  8995         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8996         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8997         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8998         MOVE PI-PB-ALT-CHG-SEQ-NO
  8999                                 TO PI-689-ALT-SEQ-NO
  9000         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  9001         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9002         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9003         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9004         move '1'                to PI-689-CHG-SEQ-NOX
  9005         MOVE W-LETTER-COMMUNICATION-AREAS
  9006                                 TO PI-PROGRAM-WORK-AREA
  9007         MOVE XCTL-EL690         TO PGM-NAME
  9008         GO TO 9300-XCTL.
  9009
  9010     IF EIBAID = DFHPF13
  9011         MOVE XCTL-EL6313        TO PGM-NAME
  9012         GO TO 9300-XCTL.
  9013
  9014     IF EIBAID = DFHPF17
  9015        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9016        IF (PB-I-LOAN-APR numeric)
  9017           and (pb-i-loan-apr < 99.9999)
  9018           AND (PB-I-BENEFICIARY-NAME NOT
  9019              = SPACES AND LOW-VALUES)
  9020
  9021           MOVE LINK-ELVADS          TO PGM-NAME
  9022
  9023* EXEC CICS LINK
  9024*              PROGRAM    (PGM-NAME)
  9025*              COMMAREA   (WS-PASS-AREA)
  9026*              LENGTH     (WS-PASS-AREA-LENGTH)
  9027*          END-EXEC
  9028*    MOVE '."C                   (   #00008966' TO DFHEIV0
  9029     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 165
* EL6311.cbl
  9030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9031     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           PGM-NAME,
  9034           WS-PASS-AREA,
  9035           WS-PASS-AREA-LENGTH,
  9036           DFHEIV99,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9041
  9042           MOVE 0000             TO EMI-ERROR
  9043           MOVE -1               TO BMAINTL
  9044           PERFORM 9900-ERROR-FORMAT
  9045                                 THRU 9900-EXIT
  9046           GO TO 8200-SEND-DATAONLY
  9047        ELSE
  9048           MOVE ER-0877            TO EMI-ERROR
  9049           MOVE -1                  TO BEFFDTL
  9050           MOVE AL-UABON            TO BEFFDTA
  9051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9052           GO TO 8200-SEND-DATAONLY
  9053        END-IF
  9054     END-IF
  9055     IF EIBAID = DFHPF14
  9056        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9057        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9058        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9059        MOVE PI-SV-STATE            TO PI-CR-STATE
  9060        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9061        MOVE SPACE                  TO PI-EDIT-SW
  9062        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9063        MOVE XCTL-EL650             TO PGM-NAME
  9064        GO TO 9300-XCTL.
  9065
  9066     IF EIBAID = DFHPF15
  9067        IF PI-COMPANY-ID  =  'HER'
  9068            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9069            MOVE XCTL-EL680         TO PGM-NAME
  9070            GO TO 9300-XCTL.
  9071
  9072     IF EIBAID = DFHENTER OR DFHPF11
  9073        GO TO 1000-ISSUE-MAINLINE.
  9074
  9075     MOVE ER-0029                TO EMI-ERROR
  9076     MOVE -1                     TO BPFENTRL
  9077     MOVE AL-UNBON               TO BPFENTRA
  9078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079     GO TO 8200-SEND-DATAONLY.
  9080
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 166
* EL6311.cbl
  9082
  9083******************************************************************
  9084*                                                                *
  9085*      CANCEL SCREEN PF KEY CHECKING                             *
  9086*                                                                *
  9087******************************************************************
  9088
  9089******************************************************************
  9090*                                                                *
  9091*      PF KEY FUNCTIONS:                                         *
  9092*                                                                *
  9093*      PF1  = BROWSE FORWARD                                     *
  9094*      PF2  = BROWSE BACKWARD                                    *
  9095*      PF3  = CERTIFICATE LOOKUP                                 *
  9096*      PF4  = DISPLAY BATCH HEADER                               *
  9097*      PF5  = ADD ISSUE SCREEN                                   *
  9098*      PF6  = ADD CANCEL SCREEN                                  *
  9099*      PF7  = CERTIFICATE DISPLAY                                *
  9100*      PF8  = CERTIFICATE NOTES                                  *
  9101*      PF9  = EDIT CONTROL                                       *
  9102*      PF10 = DISPLAY LETTER SCREEN                              *
  9103*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9104*      PF12 = DISPLAY HELP SCREEN                                *
  9105*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9106*      PF14 = ACCOUNT MASTER                                     *
  9107*      PF16 = LETTER REVIEW                                      *
  9108*                                                                *
  9109******************************************************************
  9110
  9111 0400-CHECK-CANCEL-PF-KEYS.
  9112     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9113        MOVE ER-2337             TO EMI-ERROR
  9114        MOVE -1                  TO CMAINTL
  9115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9116        GO TO 8200-SEND-DATAONLY.
  9117
  9118     IF EIBAID = DFHPF1
  9119        MOVE '0'                TO PI-EDIT-SW
  9120        IF PI-PRIMARY-BROWSE
  9121           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9122        ELSE
  9123           IF PI-PRIMARY-WITH-SELECT
  9124              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9125           ELSE
  9126              IF PI-FILE-BROWSE
  9127                 GO TO 4300-BROWSE-FILE-FORWARD
  9128              ELSE
  9129                 IF PI-CSR-BROWSE
  9130                    GO TO 4200-BROWSE-CSR-FORWARD
  9131                 ELSE
  9132                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9133
  9134     IF EIBAID = DFHPF2
  9135        MOVE '0'                TO PI-EDIT-SW
  9136        IF PI-PRIMARY-BROWSE
  9137           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9138        ELSE
  9139           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 167
* EL6311.cbl
  9140              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9141           ELSE
  9142              IF PI-FILE-BROWSE
  9143                 GO TO 4800-BROWSE-FILE-BACKWARD
  9144              ELSE
  9145                 IF PI-CSR-BROWSE
  9146                    GO TO 4900-BROWSE-CSR-BACKWARD
  9147                 ELSE
  9148                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9149
  9150     IF EIBAID = DFHPF3
  9151        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9152        MOVE XCTL-EL127         TO PGM-NAME
  9153        GO TO 9300-XCTL.
  9154
  9155     IF (EIBAID = DFHPF15 OR DFHPF17)
  9156        AND (CSR-EDIT-SESSION)
  9157*       AND (FATAL-OR-UNFORCED)
  9158        AND (FATAL-ERRORS)
  9159        MOVE ER-1819             TO EMI-ERROR
  9160        MOVE -1                  TO CMAINTL
  9161        MOVE AL-UANON            TO CMAINTA
  9162        PERFORM 9900-ERROR-FORMAT
  9163                                 THRU 9900-EXIT
  9164        GO TO 8200-SEND-DATAONLY
  9165     END-IF
  9166     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9167       AND (CSR-EDIT-SESSION)
  9168        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9169        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9170        IF (RESP-NORMAL)
  9171           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9172              AM-CONTROL-PRIMARY (1:20))
  9173            IF AM-NAME NOT GREATER THAN SPACES OR
  9174               AM-ADDRS NOT GREATER THAN SPACES  OR
  9175               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9176               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9177               AM-ZIP NOT GREATER THAN SPACES
  9178               MOVE ER-3834             TO EMI-ERROR
  9179               MOVE -1                  TO BMAINTL
  9180               MOVE AL-UANON            TO BMAINTA
  9181               PERFORM 9900-ERROR-FORMAT
  9182                                 THRU 9900-EXIT
  9183               GO TO 8200-SEND-DATAONLY
  9184            END-IF
  9185        ELSE
  9186           MOVE ER-1609             TO EMI-ERROR
  9187           MOVE -1                  TO BMAINTL
  9188           MOVE AL-UANON            TO BMAINTA
  9189           PERFORM 9900-ERROR-FORMAT
  9190                                THRU 9900-EXIT
  9191           GO TO 8200-SEND-DATAONLY
  9192        END-IF
  9193
  9194        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9195        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9196        IF (ERMAIL-FOUND)
  9197            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 168
* EL6311.cbl
  9198               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9199               MA-CITY NOT GREATER THAN SPACES OR
  9200               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9201               MA-ZIP-CODE NOT GREATER THAN SPACES
  9202               MOVE ER-3835             TO EMI-ERROR
  9203               MOVE -1                  TO BMAINTL
  9204               MOVE AL-UANON            TO BMAINTA
  9205               PERFORM 9900-ERROR-FORMAT
  9206                                 THRU 9900-EXIT
  9207               GO TO 8200-SEND-DATAONLY
  9208            END-IF
  9209        ELSE
  9210           MOVE ER-3000             TO EMI-ERROR
  9211           MOVE -1                  TO BMAINTL
  9212           MOVE AL-UANON            TO BMAINTA
  9213           PERFORM 9900-ERROR-FORMAT
  9214                                THRU 9900-EXIT
  9215           GO TO 8200-SEND-DATAONLY
  9216        END-IF
  9217
  9218     END-IF
  9219     IF (EIBAID = DFHPF15 OR DFHPF17)
  9220        AND (CSR-EDIT-SESSION)
  9221        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9222        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9223        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9224        MOVE PI-SV-STATE         TO PI-STATE
  9225        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9226        MOVE CCERTNOI            TO PI-CERT-PRIME
  9227        MOVE CSUFIXI             TO PI-CERT-SFX
  9228        MOVE CEFFDTI             TO DEEDIT-FIELD
  9229        PERFORM 8600-DEEDIT
  9230        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9231        MOVE '4'                 TO DC-OPTION-CODE
  9232        PERFORM 9700-DATE-LINK
  9233        IF DATE-CONVERSION-ERROR
  9234           MOVE ER-0348          TO EMI-ERROR
  9235           MOVE -1               TO CEFFDTL
  9236           MOVE AL-UABON         TO CEFFDTA
  9237           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9238           GO TO 8200-SEND-DATAONLY
  9239        ELSE
  9240           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9241           PERFORM 6000-CREATE-TEMP-STORAGE
  9242                                 THRU 6000-EXIT
  9243           IF EIBAID = DFHPF17
  9244               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9245                                  THRU 6400-EXIT
  9246               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9247                                 '2' AND '3' AND '4'
  9248                  MOVE ER-3831     TO  EMI-ERROR
  9249                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9250                  GO TO 8200-SEND-DATAONLY
  9251               END-IF
  9252               MOVE 'Y'          TO PI-CLM-RESC-IND
  9253           ELSE
  9254               MOVE 'N'          TO PI-CLM-RESC-IND
  9255           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 169
* EL6311.cbl
  9256           MOVE XCTL-EL6316      TO PGM-NAME
  9257           MOVE '2'              TO PI-ISS-CAN-SW
  9258           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9259           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9260           GO TO 9300-XCTL
  9261        END-IF
  9262     END-IF
  9263
  9264     IF EIBAID = DFHPF4
  9265        MOVE '0'                TO PI-EDIT-SW
  9266        IF PI-DISPLAY-ORIGINAL-BATCH
  9267           NEXT SENTENCE
  9268        ELSE
  9269           GO TO 7200-DISPLAY-BATCHES.
  9270
  9271     IF EIBAID = DFHPF5
  9272        MOVE ER-0029                TO EMI-ERROR
  9273        MOVE -1                     TO BPFENTRL
  9274        MOVE AL-UNBON               TO BPFENTRA
  9275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9276        GO TO 8200-SEND-DATAONLY.
  9277*        MOVE '0'                TO PI-EDIT-SW
  9278*        IF PI-DISPLAY-ORIGINAL-BATCH
  9279*           NEXT SENTENCE
  9280*        ELSE
  9281*           MOVE EL631B              TO PI-MAP-NAME
  9282*           MOVE LOW-VALUES          TO EL631BI
  9283*           MOVE 'A'                 TO BMAINTO
  9284*           MOVE AL-UANON            TO BMAINTA
  9285*           MOVE -1                  TO BMAINTL
  9286*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9287*           GO TO 8100-SEND-INITIAL-MAP.
  9288
  9289     IF EIBAID = DFHPF6
  9290        MOVE ER-0029                TO EMI-ERROR
  9291        MOVE -1                     TO BPFENTRL
  9292        MOVE AL-UNBON               TO BPFENTRA
  9293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9294        GO TO 8200-SEND-DATAONLY.
  9295*        MOVE '0'                TO PI-EDIT-SW
  9296*        IF PI-DISPLAY-ORIGINAL-BATCH
  9297*           NEXT SENTENCE
  9298*        ELSE
  9299*           MOVE EL631C              TO PI-MAP-NAME
  9300*           MOVE LOW-VALUES          TO EL631CI
  9301*           MOVE 'A'                 TO CMAINTO
  9302*           MOVE AL-UANON            TO CMAINTA
  9303*           MOVE -1                  TO CMAINTL
  9304*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9305*           GO TO 8100-SEND-INITIAL-MAP.
  9306
  9307     IF EIBAID = DFHPF7
  9308        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9309        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9310        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9311        MOVE PI-SV-STATE            TO PI-STATE
  9312        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9313        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 170
* EL6311.cbl
  9314        MOVE CSUFIXI                TO PI-CERT-SFX
  9315        MOVE CEFFDTI                TO DEEDIT-FIELD
  9316        PERFORM 8600-DEEDIT
  9317        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9318        MOVE '4'                    TO DC-OPTION-CODE
  9319        PERFORM 9700-DATE-LINK
  9320        IF DATE-CONVERSION-ERROR
  9321           MOVE ER-0348            TO EMI-ERROR
  9322           MOVE -1                  TO BEFFDTL
  9323           MOVE AL-UABON            TO BEFFDTA
  9324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9325           GO TO 8200-SEND-DATAONLY
  9326        ELSE
  9327           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9328           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9329           MOVE XCTL-EL1273        TO PGM-NAME
  9330           GO TO 9300-XCTL.
  9331
  9332     IF EIBAID = DFHPF8
  9333        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9334        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9335        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9336        MOVE PI-SV-STATE            TO PI-STATE
  9337        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9338        MOVE CCERTNOI               TO PI-CERT-PRIME
  9339        MOVE CSUFIXI                TO PI-CERT-SFX
  9340        MOVE CEFFDTI                TO DEEDIT-FIELD
  9341        PERFORM 8600-DEEDIT
  9342        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9343        MOVE '4'                    TO DC-OPTION-CODE
  9344        PERFORM 9700-DATE-LINK
  9345        IF DATE-CONVERSION-ERROR
  9346           MOVE ER-0348             TO EMI-ERROR
  9347           MOVE -1                  TO BEFFDTL
  9348           MOVE AL-UABON            TO BEFFDTA
  9349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9350           GO TO 8200-SEND-DATAONLY
  9351        ELSE
  9352           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9353           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9354           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  9355           IF PI-COMPANY-ID = 'DMD'
  9356               MOVE XCTL-EL401DMD      TO PGM-NAME
  9357             ELSE
  9358               MOVE XCTL-EL1279        TO PGM-NAME
  9359           END-IF
  9360           GO TO 9300-XCTL.
  9361
  9362     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9363        MOVE XCTL-EL6312     TO PGM-NAME
  9364
  9365* EXEC CICS XCTL
  9366*           PROGRAM  (PGM-NAME)
  9367*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9368*           LENGTH   (WS-COMM-LENGTH)
  9369*       END-EXEC
  9370*    MOVE '.$C                   %   #00009294' TO DFHEIV0
  9371     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 171
* EL6311.cbl
  9372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9373     MOVE X'2020233030303039323934' TO DFHEIV0(25:11)
  9374     CALL 'kxdfhei1' USING DFHEIV0,
  9375           PGM-NAME,
  9376           PROGRAM-INTERFACE-BLOCK,
  9377           WS-COMM-LENGTH,
  9378           DFHEIV99
  9379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9380     ELSE
  9381        MOVE '0'                 TO  PI-EDIT-SW.
  9382
  9383     IF EIBAID = DFHPF10
  9384         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9385         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9386         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9387         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9388                                    PI-1042-WA
  9389         MOVE 4                  TO PI-689-DATA-SOURCE
  9390         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9391         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9392         MOVE PI-SV-STATE        TO PI-689-STATE
  9393         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9394         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9395         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9396         MOVE PI-PB-ALT-CHG-SEQ-NO
  9397                                 TO PI-689-ALT-SEQ-NO
  9398         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9399         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9400         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9401         MOVE +0                 TO PI-689-CONTROL
  9402         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9403                                    PI-689-EXP-DATE
  9404                                    PI-689-RESP-PERSON
  9405                                    PI-689-TYPE
  9406                                    PI-689-FOLLOW-UP-EDIT
  9407                                    PI-689-RESEND1-EDIT
  9408                                    PI-689-SEQ-EDIT
  9409                                    PI-689-BCSEQ-EDIT
  9410                                    PI-689-LBL-OVERRIDE
  9411         MOVE W-LETTER-COMMUNICATION-AREAS
  9412                                 TO PI-PROGRAM-WORK-AREA
  9413         MOVE XCTL-EL689         TO PGM-NAME
  9414         GO TO 9300-XCTL.
  9415
  9416     IF  EIBAID = DFHPF16
  9417         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9418         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9419         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9420                                    PI-1042-WA
  9421         MOVE 4                  TO PI-689-DATA-SOURCE
  9422         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9423         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9424         MOVE PI-SV-STATE        TO PI-689-STATE
  9425         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9426         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9427         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9428         MOVE PI-PB-ALT-CHG-SEQ-NO
  9429                                 TO PI-689-ALT-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 172
* EL6311.cbl
  9430         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  9431         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9432         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9433         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9434         move '2'                to PI-689-CHG-SEQ-NOX
  9435         MOVE W-LETTER-COMMUNICATION-AREAS
  9436                                 TO PI-PROGRAM-WORK-AREA
  9437         MOVE XCTL-EL690         TO PGM-NAME
  9438         GO TO 9300-XCTL.
  9439     IF (EIBAID = DFHPF13)
  9440        if (not fatal-errors)
  9441           and (not unforced-errors)
  9442           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9443           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9444           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9445           MOVE PI-SV-STATE      TO PI-STATE
  9446           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9447           MOVE CCERTNOI         TO PI-CERT-PRIME
  9448           MOVE CSUFIXI          TO PI-CERT-SFX
  9449           MOVE CEFFDTI          TO DEEDIT-FIELD
  9450           PERFORM 8600-DEEDIT
  9451           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9452           MOVE '4'              TO DC-OPTION-CODE
  9453           PERFORM 9700-DATE-LINK
  9454           IF DATE-CONVERSION-ERROR
  9455              MOVE ER-0348       TO EMI-ERROR
  9456              MOVE -1            TO CEFFDTL
  9457              MOVE AL-UABON      TO CEFFDTA
  9458              PERFORM 9900-ERROR-FORMAT
  9459                                 THRU 9900-EXIT
  9460              GO TO 8200-SEND-DATAONLY
  9461           ELSE
  9462              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9463              MOVE AL-UANON      TO CEFFDTA
  9464              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9465              PERFORM 6000-CREATE-TEMP-STORAGE
  9466                                 THRU 6000-EXIT
  9467              MOVE XCTL-EL677    TO PGM-NAME
  9468              GO TO 9300-XCTL
  9469           end-if
  9470        else
  9471           MOVE ER-3444          TO EMI-ERROR
  9472           MOVE -1               TO CPFENTRL
  9473           MOVE AL-UNBON         TO CPFENTRA
  9474           PERFORM 9900-ERROR-FORMAT
  9475                                 THRU 9900-EXIT
  9476           GO TO 8200-SEND-DATAONLY
  9477        end-if
  9478     end-if
  9479
  9480     IF EIBAID = DFHPF14
  9481        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9482        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9483        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9484        MOVE PI-SV-STATE            TO PI-CR-STATE
  9485        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9486        MOVE SPACE                  TO PI-EDIT-SW
  9487        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 173
* EL6311.cbl
  9488        MOVE XCTL-EL650             TO PGM-NAME
  9489        GO TO 9300-XCTL.
  9490
  9491     IF EIBAID = DFHENTER OR DFHPF11
  9492        GO TO 2000-CANCEL-MAINLINE.
  9493
  9494     MOVE ER-0029                TO EMI-ERROR.
  9495     MOVE -1                     TO CPFENTRL.
  9496     MOVE AL-UNBON               TO CPFENTRA.
  9497     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498     GO TO 8200-SEND-DATAONLY.
  9499
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 174
* EL6311.cbl
  9501
  9502******************************************************************
  9503*                                                                *
  9504*      BATCH SCREEN PF KEY CHECKING                              *
  9505*                                                                *
  9506******************************************************************
  9507
  9508******************************************************************
  9509*                                                                *
  9510*      PF KEY FUNCTIONS:                                         *
  9511*                                                                *
  9512*      PF1 = BROWSE FORWARD                                      *
  9513*      PF2 = BROWSE BACKWARD                                     *
  9514*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9515*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9516*                                                                *
  9517*                                                                *
  9518******************************************************************
  9519
  9520 0500-CHECK-BATCH-PF-KEYS.
  9521     IF EIBAID = DFHPF1
  9522        MOVE '0'                TO PI-EDIT-SW
  9523        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9524           GO TO 5000-BROWSE-BATCH-HEADERS
  9525        ELSE
  9526           IF PI-GOOD-BROWSE
  9527              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9528                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9529              ELSE
  9530                 IF PI-FILE-BROWSE
  9531                    GO TO 4300-BROWSE-FILE-FORWARD
  9532                 ELSE
  9533                    IF PI-CSR-BROWSE
  9534                       GO TO 4200-BROWSE-CSR-FORWARD
  9535                    ELSE
  9536                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9537           ELSE
  9538              GO TO 0800-BROWSE-ERROR.
  9539
  9540     IF EIBAID = DFHPF2
  9541        MOVE '0'                TO PI-EDIT-SW
  9542        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9543           GO TO 5500-BROWSE-BATCH-BACKWARD
  9544        ELSE
  9545           IF PI-GOOD-BROWSE
  9546              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9547                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9548              ELSE
  9549                 IF PI-FILE-BROWSE
  9550                    GO TO 4800-BROWSE-FILE-BACKWARD
  9551                 ELSE
  9552                    IF PI-CSR-BROWSE
  9553                       GO TO 4900-BROWSE-CSR-BACKWARD
  9554                    ELSE
  9555                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9556           ELSE
  9557              GO TO 0800-BROWSE-ERROR.
  9558
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 175
* EL6311.cbl
  9559     IF EIBAID = DFHPF3
  9560        GO TO 3000-BATCH-MAINLINE.
  9561
  9562     IF  EIBAID = DFHPF4
  9563        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9564        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9565        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9566        MOVE PI-SV-STATE            TO PI-CR-STATE
  9567        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9568                                       PI-CR-FIN-RESP
  9569        MOVE 'A'                    TO PI-CR-TYPE
  9570        MOVE SPACE                  TO PI-EDIT-SW
  9571        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9572        MOVE XCTL-EL640             TO PGM-NAME
  9573        GO TO 9300-XCTL.
  9574
  9575     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9576       AND
  9577        (EIBAID = DFHENTER)
  9578           GO TO 3500-EDIT-BATCH-DATA.
  9579
  9580     IF EIBAID = DFHENTER
  9581        GO TO 3500-EDIT-BATCH-DATA.
  9582
  9583     MOVE ER-0029             TO EMI-ERROR.
  9584     MOVE -1                  TO DPFENTRL.
  9585     MOVE AL-UNBON            TO DPFENTRA.
  9586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9587     GO TO 8200-SEND-DATAONLY.
  9588
  9589 0800-BROWSE-ERROR.
  9590     MOVE ER-2258                TO EMI-ERROR.
  9591     MOVE -1                     TO DPFENTRL.
  9592     MOVE AL-UNBON               TO DPFENTRA.
  9593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9594     GO TO 8200-SEND-DATAONLY.
  9595
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 176
* EL6311.cbl
  9597
  9598******************************************************************
  9599*                                                                *
  9600*                I S S U E   M A I N L I N E                     *
  9601*                                                                *
  9602******************************************************************
  9603
  9604 1000-ISSUE-MAINLINE.
  9605     IF PI-DISPLAY-ORIGINAL-BATCH
  9606        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9607           MOVE ER-0023             TO EMI-ERROR
  9608           MOVE -1                  TO BMAINTL
  9609           MOVE AL-UABON            TO BMAINTA
  9610           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9611           GO TO 8200-SEND-DATAONLY
  9612        ELSE
  9613           NEXT SENTENCE
  9614     ELSE
  9615        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9616           MOVE ER-0023             TO EMI-ERROR
  9617           MOVE -1                  TO BMAINTL
  9618           MOVE AL-UABON            TO BMAINTA
  9619           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9620           GO TO 8200-SEND-DATAONLY.
  9621
  9622     IF BMAINTI = 'S'
  9623        GO TO 1100-SHOW-REQUEST.
  9624
  9625     IF NOT MODIFY-CAP
  9626         MOVE 'UPDATE'       TO SM-READ
  9627         PERFORM 9995-SECURITY-VIOLATION
  9628         MOVE ER-0070        TO EMI-ERROR
  9629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9630         GO TO 8100-SEND-INITIAL-MAP.
  9631
  9632     IF BMAINTL GREATER THAN ZEROS
  9633        IF PI-PF5-FUNCTION
  9634           IF BMAINTI NOT = 'A'
  9635              MOVE AL-UABON  TO BMAINTA
  9636              MOVE -1        TO BMAINTL
  9637              MOVE ER-2260   TO EMI-ERROR
  9638              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9639              GO TO 8200-SEND-DATAONLY.
  9640
  9641     IF BCERTNOL = ZEROS
  9642       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9643         NEXT SENTENCE
  9644     ELSE
  9645         IF BCERTNOL NOT = ZEROS
  9646             MOVE AL-UANON       TO BCERTNOA
  9647         ELSE
  9648             MOVE -1             TO BCERTNOL
  9649             MOVE  1             TO SET-CURSOR-SW
  9650             MOVE ER-2218        TO EMI-ERROR
  9651             MOVE AL-UABON       TO BCERTNOA
  9652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653
  9654     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 177
* EL6311.cbl
  9655         MOVE AL-UANON       TO BSUFIXA
  9656     ELSE
  9657         MOVE AL-SANOF       TO BSUFIXA.
  9658
  9659
  9660* EXEC CICS READ
  9661*        DATASET (FILE-ID-ERPNDB)
  9662*        INTO    (PENDING-BUSINESS)
  9663*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9664*    END-EXEC.
  9665     MOVE LENGTH OF
  9666      PENDING-BUSINESS
  9667       TO DFHEIV11
  9668*    MOVE '&"IL       E          (   #00009578' TO DFHEIV0
  9669     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9671     MOVE X'2020233030303039353738' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           FILE-ID-ERPNDB,
  9674           PENDING-BUSINESS,
  9675           DFHEIV11,
  9676           PI-PREV-CONTROL-PRIMARY,
  9677           DFHEIV99,
  9678           DFHEIV99,
  9679           DFHEIV99
  9680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9681
  9682
  9683     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9684        NEXT SENTENCE
  9685     ELSE
  9686        IF BEFFDTL NOT = ZEROS
  9687           MOVE AL-UNNON             TO BEFFDTA
  9688           MOVE BEFFDTI              TO DEEDIT-FIELD
  9689           PERFORM 8600-DEEDIT
  9690           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9691           MOVE 4                    TO DC-OPTION-CODE
  9692           PERFORM 9700-DATE-LINK
  9693           IF NO-CONVERSION-ERROR
  9694              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9695              ELSE
  9696              MOVE -1                TO BEFFDTL
  9697              MOVE  1                TO SET-CURSOR-SW
  9698              MOVE ER-2226           TO EMI-ERROR
  9699              MOVE AL-UNBON          TO BEFFDTA
  9700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9701           ELSE
  9702              MOVE -1                TO BEFFDTL
  9703              MOVE  1                TO SET-CURSOR-SW
  9704              MOVE ER-2220           TO EMI-ERROR
  9705              MOVE AL-UNBON          TO BEFFDTA
  9706              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9707
  9708     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9709
  9710     IF BCERTNOL NOT = ZEROS
  9711        MOVE BCERTNOI                TO WS-NEW-PRIME
  9712     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 178
* EL6311.cbl
  9713        MOVE SPACES                  TO WS-NEW-PRIME.
  9714
  9715     IF BSUFIXL NOT = ZEROS
  9716        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9717     ELSE
  9718        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9719
  9720     IF BEFFDTL NOT = ZEROS
  9721        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9722     ELSE
  9723        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9724
  9725     IF BMAINTI = 'A' OR 'K' OR 'S'
  9726        NEXT SENTENCE
  9727     ELSE
  9728        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9729        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9730           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9731           WS-PB-RECORD-TYPE NOT = '1'
  9732           IF BMAINTI = 'C'
  9733               MOVE ER-2287          TO EMI-ERROR
  9734               MOVE -1               TO BCERTNOL
  9735               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9736               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9737               GO TO 8200-SEND-DATAONLY
  9738             ELSE
  9739               MOVE ER-2260          TO EMI-ERROR
  9740               MOVE -1               TO BCERTNOL
  9741               MOVE AL-UABON         TO BCERTNOA
  9742               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9743               GO TO 8200-SEND-DATAONLY.
  9744
  9745     IF BMAINTI = 'D'
  9746         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9747
  9748*    IF BMICRNOL  NOT =  ZEROS
  9749*        IF BMICRNOI  NUMERIC
  9750*            MOVE AL-UNNON       TO  BMICRNOA
  9751*        ELSE
  9752*            MOVE -1             TO  BMICRNOL
  9753*            MOVE 1              TO  SET-CURSOR-SW
  9754*            MOVE AL-UNBON       TO  BMICRNOA
  9755*            MOVE ER-2701        TO  EMI-ERROR
  9756*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9757     IF BVINL NOT = ZEROS
  9758        MOVE AL-UANON            TO BVINA
  9759     END-IF
  9760
  9761     IF LETRREQL   GREATER THAN ZEROS
  9762        IF LETRREQI = 'Y'
  9763          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9764           CONTINUE
  9765        ELSE
  9766        IF LETRREQI = 'N'
  9767          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9768           CONTINUE
  9769        ELSE
  9770           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 179
* EL6311.cbl
  9771           MOVE ER-1585          TO EMI-ERROR
  9772           MOVE AL-UABON         TO LETRREQA
  9773           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9774        END-IF
  9775     END-IF.
  9776     IF B1STNML NOT = ZEROS
  9777         MOVE AL-UANON                TO B1STNMA.
  9778
  9779     IF BINITL  NOT = ZEROS
  9780        MOVE AL-UANON                TO BINITA.
  9781
  9782     IF BSEXL NOT = ZEROS
  9783        IF BSEXI = 'M' OR 'F'
  9784           MOVE AL-UANON             TO BSEXA
  9785        ELSE
  9786           MOVE -1               TO BSEXL
  9787           MOVE ER-2629          TO EMI-ERROR
  9788           MOVE AL-UABON         TO BSEXA
  9789           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9790
  9791     IF BAGEL NOT = ZEROS
  9792         IF BAGEI NUMERIC
  9793             MOVE BAGEI              TO WS-BAGE
  9794             MOVE AL-UNNON           TO BAGEA
  9795         ELSE
  9796             MOVE -1                 TO BAGEL
  9797             MOVE  1                 TO SET-CURSOR-SW
  9798             MOVE ER-2223            TO EMI-ERROR
  9799             MOVE AL-UNBON           TO BAGEA
  9800             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9801
  9802     IF BLSTNML NOT = ZERO  OR
  9803        B1STNML NOT = ZERO  OR
  9804        BINITL NOT = ZERO
  9805         IF BAGEL = ZEROS
  9806             MOVE -1                 TO BAGEL
  9807             MOVE  1                 TO SET-CURSOR-SW
  9808             MOVE ER-3269            TO EMI-ERROR
  9809             MOVE AL-UNBON           TO BAGEA
  9810             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9811         END-IF
  9812     END-IF.
  9813
  9814     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9815
  9816     IF (BBIRTHL GREATER THAN +0) AND
  9817        (BBIRTHI NOT EQUAL SPACES)
  9818        NEXT SENTENCE
  9819     ELSE
  9820        GO TO 1010-CHECK-AGE.
  9821
  9822     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9823     PERFORM 8600-DEEDIT.
  9824     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9825     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9826     MOVE AL-UNNON               TO BBIRTHA.
  9827     MOVE '4'                    TO DC-OPTION-CODE.
  9828     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 180
* EL6311.cbl
  9829     IF DATE-CONVERSION-ERROR
  9830        MOVE -1                  TO BBIRTHL
  9831        MOVE  1                  TO SET-CURSOR-SW
  9832        MOVE ER-2228             TO EMI-ERROR
  9833        MOVE AL-UNBON            TO BBIRTHA
  9834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9835        GO TO 1010-CHECK-AGE.
  9836
  9837     IF (NO-CONVERSION-ERROR) AND
  9838        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9839        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9840        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9841        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9842                                    WS-CONVERTED-BIRTH
  9843        MOVE AL-UANON            TO BBIRTHA
  9844     ELSE
  9845        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9846        MOVE AL-UANON            TO BBIRTHA.
  9847
  9848 1010-CHECK-AGE.
  9849
  9850*    IF BAGEL = ZERO
  9851*       IF BBIRTHL GREATER THAN ZERO
  9852*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9853
  9854     IF B1STPMTL NOT = ZEROS
  9855        IF B1STPMTI = SPACES
  9856           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9857        ELSE
  9858           MOVE B1STPMTI             TO DEEDIT-FIELD
  9859           PERFORM 8600-DEEDIT
  9860           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9861           MOVE AL-UNNON             TO B1STPMTA
  9862           MOVE 4                    TO DC-OPTION-CODE
  9863           PERFORM 9700-DATE-LINK
  9864           IF NO-CONVERSION-ERROR
  9865              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9866              MOVE AL-UANON          TO B1STPMTA
  9867           ELSE
  9868              MOVE -1                TO B1STPMTL
  9869              MOVE  1                TO SET-CURSOR-SW
  9870              MOVE ER-2200           TO EMI-ERROR
  9871              MOVE AL-UNBON          TO B1STPMTA
  9872              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9873
  9874     IF BDAYSL NOT = ZEROS
  9875         IF BDAYSI NUMERIC
  9876             MOVE AL-UNNON           TO BDAYSA
  9877         ELSE
  9878             MOVE -1                 TO BDAYSL
  9879             MOVE ER-2530            TO EMI-ERROR
  9880             MOVE AL-UNBON           TO BDAYSA
  9881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9882
  9883     IF BLNTRML NOT = ZEROS
  9884         IF BLNTRMI NUMERIC
  9885             MOVE AL-UNNON       TO BLNTRMA
  9886         ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 181
* EL6311.cbl
  9887             MOVE -1             TO BLNTRML
  9888             MOVE ER-2533        TO EMI-ERROR
  9889             MOVE AL-UNBON       TO BLNTRMA
  9890             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9891
  9892**   IF PI-COMPANY-ID = 'DMD'
  9893     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL' or 'FNL'
  9894        NEXT SENTENCE
  9895     ELSE
  9896         IF BLNOFCRL NOT = ZEROS
  9897            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9898            IF LOAN-OFFICER-FOUND
  9899                MOVE AL-UANON        TO BLNOFCRA
  9900             ELSE
  9901                 MOVE SPACE          TO WS-LOAN-OFFICER
  9902                 MOVE -1             TO BLNOFCRL
  9903                 MOVE  1             TO SET-CURSOR-SW
  9904                 MOVE ER-3006        TO EMI-ERROR
  9905                 MOVE AL-UNBON       TO BLNOFCRA
  9906                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9907
  9908     IF BFREQL NOT = ZEROS
  9909         IF BFREQI NUMERIC
  9910             MOVE AL-UNNON       TO BFREQA
  9911         ELSE
  9912             MOVE -1             TO BFREQL
  9913             MOVE  1             TO SET-CURSOR-SW
  9914             MOVE ER-2223        TO EMI-ERROR
  9915             MOVE AL-UNBON       TO BFREQA
  9916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9917
  9918     IF BMODEL NOT = ZEROS
  9919         MOVE BMODEI             TO WS-MODE-CODE
  9920                                    PI-BMODE
  9921         IF WS-MODE-CODE-VALID
  9922             MOVE AL-UANON       TO BMODEA
  9923         ELSE
  9924             MOVE -1             TO BMODEL
  9925             MOVE ER-2591        TO EMI-ERROR
  9926             MOVE AL-UABON       TO BMODEA
  9927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9928
  9929     IF BPMTSL NOT = ZEROS
  9930         IF BPMTSI NUMERIC
  9931             MOVE AL-UNNON           TO BPMTSA
  9932             MOVE BPMTSI             TO PI-BPMTS
  9933         ELSE
  9934             MOVE -1                 TO BPMTSL
  9935             MOVE ER-2592            TO EMI-ERROR
  9936             MOVE AL-UNBON           TO BPMTSA
  9937             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9938
  9939     IF BPMTAMTL NOT = ZEROS
  9940
  9941* EXEC CICS BIF DEEDIT
  9942*            FIELD  (BPMTAMTI)
  9943*            LENGTH (9)
  9944*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 182
* EL6311.cbl
  9945     MOVE 9
  9946       TO DFHEIV11
  9947*    MOVE '@"L                   #   #00009841' TO DFHEIV0
  9948     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9950     MOVE X'2020233030303039383431' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0,
  9952           BPMTAMTI,
  9953           DFHEIV11
  9954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9955        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9956*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9957*        PERFORM 8600-DEEDIT
  9958*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9959
  9960*    IF BAPRL NOT = ZEROS
  9961*        EXEC CICS BIF DEEDIT
  9962*            FIELD  (BAPRI)
  9963*            LENGTH (7)
  9964*        END-EXEC
  9965*        MOVE BAPRI              TO WS-BAPR.
  9966
  9967     IF BAPRL > 0
  9968        MOVE +0                  TO  WS-BAPR
  9969        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9970           (WS-SUB > 7)
  9971           OR (BAPRI (WS-SUB:1) NUMERIC)
  9972           OR (BAPRI (WS-SUB:1) = '.')
  9973        END-PERFORM
  9974        IF WS-SUB > 7
  9975           MOVE ER-2471       TO EMI-ERROR
  9976           MOVE -1            TO BAPRL
  9977           MOVE AL-UNBON      TO BAPRA
  9978           PERFORM 9900-ERROR-FORMAT
  9979                                 THRU 9900-EXIT
  9980        ELSE
  9981           IF BAPRI (WS-SUB:1) NUMERIC
  9982              MOVE WS-SUB           TO WS-BEG
  9983              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9984                 (WS-SUB > 7)
  9985                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9986              END-PERFORM
  9987              COMPUTE WS-END = WS-SUB - WS-BEG
  9988              MOVE BAPRI (WS-BEG:WS-END)
  9989                                 TO WS-APR-WHOLE-NUM
  9990           END-IF
  9991           IF BAPRI (WS-SUB:1) = '.'
  9992              COMPUTE WS-BEG = WS-SUB + 1
  9993              IF (WS-BEG < 8)
  9994                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9995                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9996                    (WS-SUB > 7)
  9997                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9998                 END-PERFORM
  9999                 COMPUTE WS-END = WS-SUB - WS-BEG
 10000                 MOVE BAPRI (WS-BEG:WS-END)
 10001                                 TO WS-APR-DEC (1:WS-END)
 10002              END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 183
* EL6311.cbl
 10003           END-IF
 10004           MOVE AL-UNNON      TO BAPRA
 10005           MOVE WS-BAPR       TO BAPRO
 10006        END-IF
 10007     END-IF
 10008*     IF BAPRL NOT = ZEROS
 10009*        MOVE BAPRI              TO DEEDIT-FIELD-V4
 10010*        PERFORM 8600-DEEDIT
 10011*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
 10012
 10013     IF BLIVESL NOT = ZEROS
 10014        MOVE BLIVESI             TO DEEDIT-FIELD
 10015        PERFORM 8600-DEEDIT
 10016        IF DEEDIT-FIELD-V0 NUMERIC
 10017           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10018           MOVE AL-UNNON         TO BLIVESA
 10019        ELSE
 10020           MOVE -1               TO BLIVESL
 10021           MOVE AL-UNBON         TO BLIVESA
 10022           MOVE ER-2223          TO EMI-ERROR
 10023           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10024
 10025*DMD CUSTOM CODING*************START
 10026*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10027     IF PI-COMPANY-ID NOT = 'DMD'
 10028         MOVE ZEROS               TO BBILLEDL
 10029         GO TO 1010-EDIT-CONT.
 10030
 10031     IF BBILLEDL NOT = ZEROS
 10032        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10033        MOVE 'Y'                 TO WS-NUMERIC-SW
 10034        MOVE +1                  TO WS-CSO-SUB
 10035        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10036        IF CSO-NUMERIC-FIELD
 10037
 10038* EXEC CICS BIF DEEDIT
 10039*              FIELD  (BBILLEDI)
 10040*              LENGTH (9)
 10041*          END-EXEC
 10042     MOVE 9
 10043       TO DFHEIV11
 10044*    MOVE '@"L                   #   #00009927' TO DFHEIV0
 10045     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10046     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10047     MOVE X'2020233030303039393237' TO DFHEIV0(25:11)
 10048     CALL 'kxdfhei1' USING DFHEIV0,
 10049           BBILLEDI,
 10050           DFHEIV11
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10052           MOVE BBILLEDI         TO WS-BILLED
 10053           MOVE AL-UNNON         TO BBILLEDA
 10054        ELSE
 10055           MOVE -1               TO BBILLEDL
 10056           MOVE AL-UNBON         TO BBILLEDA
 10057           MOVE ER-2547          TO EMI-ERROR
 10058           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10059     ELSE
 10060        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 184
* EL6311.cbl
 10061           MOVE -1               TO BBILLEDL
 10062           MOVE AL-UNBON         TO BBILLEDA
 10063           MOVE ER-8148          TO EMI-ERROR
 10064           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10065
 10066 1010-EDIT-CONT.
 10067
 10068     IF BFORCEL  NOT = ZEROS
 10069         IF FORCE-CAP
 10070            MOVE AL-UANON            TO BFORCEA
 10071         ELSE
 10072            MOVE ER-2945             TO EMI-ERROR
 10073            MOVE AL-UABON            TO BFORCEA
 10074            MOVE -1                  TO BFORCEL
 10075            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10076
 10077     if (bforcel not = zeros)
 10078        and (bforcei = 'L')
 10079        and (not csr-edit-session)
 10080        and (emi-error <> er-2945)
 10081        MOVE ER-2670             TO EMI-ERROR
 10082        MOVE AL-UABON            TO BFORCEA
 10083        MOVE -1                  TO BFORCEL
 10084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10085     end-if
 10086     IF BENTRYL NOT = ZEROS
 10087        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10088                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10089           MOVE ER-2224              TO EMI-ERROR
 10090           MOVE AL-UABON             TO BENTRYA
 10091           MOVE -1                   TO BENTRYL
 10092           MOVE  1                   TO SET-CURSOR-SW
 10093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10094        ELSE
 10095           MOVE AL-UANON             TO BENTRYA.
 10096
 10097     IF BUNWRITL NOT = ZEROS
 10098        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10099           MOVE ER-7574              TO EMI-ERROR
 10100           MOVE AL-UABON             TO BUNWRITA
 10101           MOVE -1                   TO BUNWRITL
 10102           MOVE  1                   TO SET-CURSOR-SW
 10103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10104        ELSE
 10105           MOVE AL-UANON             TO BUNWRITA.
 10106
 10107     IF BREINL  NOT = ZEROS
 10108         MOVE AL-UANON               TO BREINA.
 10109
 10110     IF BBILCDL NOT = ZEROS
 10111        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10112                             AND 'A' AND 'B' AND 'E'
 10113           MOVE ER-2225              TO EMI-ERROR
 10114           MOVE AL-UABON             TO BBILCDA
 10115           MOVE -1                   TO BBILCDL
 10116           MOVE  1                   TO SET-CURSOR-SW
 10117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10118        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 185
* EL6311.cbl
 10119           MOVE AL-UANON             TO BBILCDA.
 10120
 10121     IF BSKPCDL NOT = ZEROS
 10122         MOVE AL-UANON               TO BSKPCDA.
 10123
 10124     IF BINDGRPL NOT = ZEROS
 10125         MOVE AL-UANON               TO BINDGRPA.
 10126
 10127     IF BSIGL   NOT = ZEROS
 10128         MOVE AL-UANON               TO BSIGA.
 10129
 10130     IF BRTCLSL NOT = ZEROS
 10131         MOVE AL-UANON               TO BRTCLSA.
 10132
 10133     IF BMEMBERL NOT = ZEROS
 10134         MOVE AL-UANON               TO BMEMBERA.
 10135
 10136     MOVE +0                         TO WS-SUB1.
 10137
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 186
* EL6311.cbl
 10139
 10140******************************************************************
 10141*                                                                *
 10142*           E D I T   I S S U E   C O V E R A G E S              *
 10143*                                                                *
 10144******************************************************************
 10145
 10146 1020-EDIT-COVERAGES.
 10147     ADD +1                      TO WS-SUB1.
 10148
 10149     IF WS-SUB1 GREATER +2
 10150        GO TO 1025-EDIT-CONTINUE
 10151     END-IF
 10152
 10153     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10154       IF (BMODEL   GREATER ZERO  OR
 10155            BPMTSL   GREATER ZERO  OR
 10156            BPMTAMTL GREATER ZERO)
 10157          AND
 10158            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10159               GO TO 1021-CONT-EDIT.
 10160
 10161     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10162        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10163        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10164        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10165        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10166        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10167        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10168        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10169        NEXT SENTENCE
 10170         ELSE
 10171            GO TO 1020-EDIT-COVERAGES.
 10172
 10173 1021-CONT-EDIT.
 10174
 10175     IF BMAINTI = 'A'
 10176        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10177           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10178        ELSE
 10179           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10180           MOVE ER-7404          TO EMI-ERROR
 10181           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10183     ELSE
 10184        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10185           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10186
 10187     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10188        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10189        PERFORM 8600-DEEDIT
 10190        IF DEEDIT-FIELD-V0 NUMERIC
 10191           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10192        ELSE
 10193           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10194
 10195     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10196*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 187
* EL6311.cbl
 10197        IF BMODEL  GREATER THAN ZEROS  AND
 10198           BPMTSL  GREATER THAN ZEROS
 10199           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10200
 10201     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10202         IF BMODEL   GREATER THAN ZEROS  OR
 10203            BPMTSL   GREATER THAN ZEROS  OR
 10204            BPMTAMTL GREATER THAN ZEROS
 10205             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10206
 10207     IF BMAINTI = ('C' OR 'K')
 10208        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10209           NEXT SENTENCE
 10210        ELSE
 10211           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10212           PERFORM 8600-DEEDIT
 10213           IF DEEDIT-FIELD-V0 NUMERIC
 10214              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10215              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10216                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10217              ELSE
 10218                    MOVE ER-2241      TO EMI-ERROR
 10219                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10220                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10221                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10222           ELSE
 10223              MOVE ER-2223          TO EMI-ERROR
 10224              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10225              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10226              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10227     ELSE
 10228        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10229            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10230            PERFORM 8600-DEEDIT
 10231            IF DEEDIT-FIELD-V0      NUMERIC
 10232               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10233                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10234                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10235               ELSE
 10236                  MOVE ER-2241         TO EMI-ERROR
 10237                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10238                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10239                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10240            ELSE
 10241              MOVE ER-2223             TO EMI-ERROR
 10242              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10243              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10244              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10245        ELSE
 10246            MOVE ER-2240               TO EMI-ERROR
 10247            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10248            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10249*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10250*        IF BMODEL  GREATER THAN ZEROS  AND
 10251*           BPMTSL  GREATER THAN ZEROS
 10252*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10253
 10254     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 188
* EL6311.cbl
 10255        AND BMAINTI = ('C' OR 'K')
 10256           NEXT SENTENCE
 10257     ELSE
 10258        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10259           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10260
 10261* EXEC CICS BIF DEEDIT
 10262*              FIELD  (BBENI (WS-SUB1))
 10263*              LENGTH (12)
 10264*          END-EXEC
 10265     MOVE 12
 10266       TO DFHEIV11
 10267*    MOVE '@"L                   #   #00010139' TO DFHEIV0
 10268     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10269     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10270     MOVE X'2020233030303130313339' TO DFHEIV0(25:11)
 10271     CALL 'kxdfhei1' USING DFHEIV0,
 10272           BBENI(WS-SUB1),
 10273           DFHEIV11
 10274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10275           IF BBENI (WS-SUB1)  NUMERIC
 10276              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10277                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10278*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10279*          PERFORM 8600-DEEDIT
 10280*          IF DEEDIT-FIELD-V2  NUMERIC
 10281*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10282*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10283              ELSE
 10284                 MOVE ER-7632    TO EMI-ERROR
 10285                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10286                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10287                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10288           ELSE
 10289              MOVE ER-2223         TO EMI-ERROR
 10290              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10291              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10292              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10293        ELSE
 10294           MOVE ER-7632    TO EMI-ERROR
 10295           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10296           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10297           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10298
 10299     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10300        AND (BMAINTI = ('C' OR 'K'))
 10301        CONTINUE
 10302     ELSE
 10303        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10304           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10305           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10306              FOR ALL '.'
 10307           IF WS-TALLY > 1
 10308              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10309                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10310              END-PERFORM
 10311              IF A1 < 9
 10312                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 189
* EL6311.cbl
 10313                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10314              END-IF
 10315           ELSE
 10316              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10317                (A1 > 11)
 10318                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10319                  LOW-VALUES OR SPACES)
 10320              END-PERFORM
 10321              IF A1 > 1 AND < 12
 10322                 MOVE SPACES
 10323                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10324              END-IF
 10325           END-IF
 10326
 10327* EXEC CICS BIF DEEDIT
 10328*              FIELD  (BPREMI (WS-SUB1))
 10329*              LENGTH (11)
 10330*          END-EXEC
 10331     MOVE 11
 10332       TO DFHEIV11
 10333*    MOVE '@"L                   #   #00010194' TO DFHEIV0
 10334     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10335     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10336     MOVE X'2020233030303130313934' TO DFHEIV0(25:11)
 10337     CALL 'kxdfhei1' USING DFHEIV0,
 10338           BPREMI(WS-SUB1),
 10339           DFHEIV11
 10340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10341           IF BPREMI (WS-SUB1) NUMERIC
 10342              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10343                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10344*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10345*          PERFORM 8600-DEEDIT
 10346*          IF DEEDIT-FIELD-V2  NUMERIC
 10347*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10348*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10349              ELSE
 10350                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10351                    MOVE ER-7633    TO EMI-ERROR
 10352                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10353                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10354                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10355                 END-IF
 10356              END-IF
 10357           ELSE
 10358              MOVE ER-2223         TO EMI-ERROR
 10359              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10360              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10362           END-IF
 10363        ELSE
 10364           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10365              MOVE ER-7633         TO EMI-ERROR
 10366              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10367              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10368              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10369           END-IF
 10370        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 190
* EL6311.cbl
 10371     END-IF
 10372
 10373     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10374        NEXT SENTENCE
 10375     ELSE
 10376        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10377
 10378* EXEC CICS BIF DEEDIT
 10379*           FIELD  (BCPREMI (WS-SUB1))
 10380*           LENGTH (11)
 10381*       END-EXEC
 10382     MOVE 11
 10383       TO DFHEIV11
 10384*    MOVE '@"L                   #   #00010234' TO DFHEIV0
 10385     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10386     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10387     MOVE X'2020233030303130323334' TO DFHEIV0(25:11)
 10388     CALL 'kxdfhei1' USING DFHEIV0,
 10389           BCPREMI(WS-SUB1),
 10390           DFHEIV11
 10391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10392        IF BCPREMI (WS-SUB1) NUMERIC
 10393           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10394*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10395*       PERFORM 8600-DEEDIT
 10396*       IF DEEDIT-FIELD-V2  NUMERIC
 10397*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10398        ELSE
 10399           MOVE ER-2223         TO EMI-ERROR
 10400           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10401           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10403
 10404     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10405        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10406        PERFORM 8600-DEEDIT
 10407        IF DEEDIT-FIELD-V0 NUMERIC
 10408           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10409           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10410         ELSE
 10411           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10412           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10413           MOVE ER-2223              TO EMI-ERROR
 10414           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10415
 10416     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10417        IF BEXPIRE   (WS-SUB1) = SPACES
 10418           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10419        ELSE
 10420           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10421           PERFORM 8600-DEEDIT
 10422           IF DEEDIT-FIELD-V0        NUMERIC
 10423              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10424              MOVE 4                TO DC-OPTION-CODE
 10425              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10426              PERFORM 9700-DATE-LINK
 10427              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10428                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 191
* EL6311.cbl
 10429              IF NO-CONVERSION-ERROR
 10430                 NEXT SENTENCE
 10431              ELSE
 10432                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10433                 MOVE ER-2531    TO EMI-ERROR
 10434                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10435                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10436           ELSE
 10437             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10438             MOVE ER-2532        TO EMI-ERROR
 10439             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10440             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10441
 10442     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10443        NEXT SENTENCE
 10444     ELSE
 10445
 10446* EXEC CICS BIF DEEDIT
 10447*           FIELD  (BALT-BENI (WS-SUB1))
 10448*           LENGTH (12)
 10449*       END-EXEC
 10450     MOVE 12
 10451       TO DFHEIV11
 10452*    MOVE '@"L                   #   #00010291' TO DFHEIV0
 10453     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10454     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10455     MOVE X'2020233030303130323931' TO DFHEIV0(25:11)
 10456     CALL 'kxdfhei1' USING DFHEIV0,
 10457           BALT-BENI(WS-SUB1),
 10458           DFHEIV11
 10459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10460        IF BALT-BENI (WS-SUB1) NUMERIC
 10461           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10462*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10463*       PERFORM 8600-DEEDIT
 10464*       IF DEEDIT-FIELD-V0 NUMERIC
 10465*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10466        ELSE
 10467           MOVE ER-2223         TO EMI-ERROR
 10468           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10469           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10471
 10472     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10473        NEXT SENTENCE
 10474     ELSE
 10475
 10476* EXEC CICS BIF DEEDIT
 10477*           FIELD  (BALT-PREMI (WS-SUB1))
 10478*           LENGTH (11)
 10479*       END-EXEC
 10480     MOVE 11
 10481       TO DFHEIV11
 10482*    MOVE '@"L                   #   #00010310' TO DFHEIV0
 10483     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10484     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10485     MOVE X'2020233030303130333130' TO DFHEIV0(25:11)
 10486     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 192
* EL6311.cbl
 10487           BALT-PREMI(WS-SUB1),
 10488           DFHEIV11
 10489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10490        IF BALT-PREMI (WS-SUB1) NUMERIC
 10491           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10492*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10493*       PERFORM 8600-DEEDIT
 10494*       IF DEEDIT-FIELD-V0 NUMERIC
 10495*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10496        ELSE
 10497           MOVE ER-2223         TO EMI-ERROR
 10498           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10499           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10500           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10501
 10502      GO TO 1020-EDIT-COVERAGES.
 10503     .
 10504 1025-edit-continue.
 10505     IF PI-COMPANY-ID  =  'DMD'
 10506        MOVE LOW-VALUES             TO BNCERTI
 10507                                       BNSTATI.
 10508
 10509     IF EMI-ERROR = ZEROS
 10510         NEXT SENTENCE
 10511     ELSE
 10512         GO TO 8200-SEND-DATAONLY.
 10513
 10514     IF BMAINTI = 'A'
 10515         GO TO 1200-ADD-ISSUE-ROUTINE.
 10516
 10517     IF BMAINTI = 'C'
 10518         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10519**  This must be a 'K' transaction A,C,S & D spoke for
 10520
 10521     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10522
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 193
* EL6311.cbl
 10524
 10525 1030-EDIT-FOR-NUMERICS.
 10526     IF WS-CSO-SUB EQUAL 10
 10527        GO TO 1030-EDIT-EXIT.
 10528
 10529     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10530        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10531        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10532           ADD +1               TO WS-CSO-SUB
 10533           GO TO 1030-EDIT-FOR-NUMERICS.
 10534
 10535     MOVE 'N'                   TO WS-NUMERIC-SW.
 10536
 10537 1030-EDIT-EXIT.
 10538******************************************************************
 10539*                                                                *
 10540*                 C A L C U L A T E   A G E                      *
 10541*                                                                *
 10542******************************************************************
 10543
 10544
 10545 1095-CALC-AGE.
 10546
 10547     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10548     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10549     MOVE 1                  TO DC-OPTION-CODE.
 10550     PERFORM 9700-DATE-LINK
 10551     IF NO-CONVERSION-ERROR
 10552         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10553         MOVE WS-BAGE            TO BAGEI
 10554         MOVE +2                 TO BAGEL
 10555         MOVE AL-UNNON TO BAGEA.
 10556
 10557 1099-EXIT.
 10558     EXIT.
 10559
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 194
* EL6311.cbl
 10561
 10562******************************************************************
 10563*                                                                *
 10564*                   S H O W   I S S U E                          *
 10565*                                                                *
 10566******************************************************************
 10567
 10568 1100-SHOW-REQUEST.
 10569     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10570
 10571     IF BCERTNOL = ZEROS AND
 10572        BEFFDTL  = ZEROS
 10573        MOVE -1                  TO BMAINTL
 10574        GO TO 8200-SEND-DATAONLY.
 10575
 10576     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10577
 10578     IF BSUFIXL NOT = ZEROS
 10579        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10580     ELSE
 10581        MOVE SPACE               TO WS-NEW-SUFFIX.
 10582
 10583     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10584     PERFORM 8600-DEEDIT.
 10585     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10586     MOVE '4'                    TO DC-OPTION-CODE.
 10587     PERFORM 9700-DATE-LINK.
 10588     IF DATE-CONVERSION-ERROR
 10589        MOVE ER-0348             TO EMI-ERROR
 10590        MOVE -1                  TO BEFFDTL
 10591        MOVE AL-UABON            TO BEFFDTA
 10592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10593        GO TO 8200-SEND-DATAONLY
 10594     ELSE
 10595        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10596        MOVE AL-UANON            TO BEFFDTA
 10597        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10598
 10599     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10600
 10601     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10602        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10603          MOVE 'Y'                    TO WS-SHOW-SW
 10604          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10605             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10606           ELSE
 10607             IF PI-FILE-BROWSE
 10608                GO TO 4300-BROWSE-FILE-FORWARD
 10609              ELSE
 10610                IF PI-CSR-BROWSE
 10611                   GO TO 4200-BROWSE-CSR-FORWARD
 10612                ELSE
 10613                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10614        ELSE
 10615           GO TO 3900-RE-DISPLAY-RECORD.
 10616
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 195
* EL6311.cbl
 10618
 10619******************************************************************
 10620*                                                                *
 10621*            A D D   I S S U E   R O U T I N E                   *
 10622*                                                                *
 10623******************************************************************
 10624
 10625***************************************************************
 10626*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10627*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10628*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10629*     4. LINK TO THE EDIT ROUTINE.                            *
 10630*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10631*     6. WRITE THE NEW ISSUE RECORD.                          *
 10632*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10633*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10634*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10635*        ELSE                                                 *
 10636*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10637***************************************************************
 10638
 10639 1200-ADD-ISSUE-ROUTINE.
 10640     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10641
 10642
 10643* EXEC CICS GETMAIN
 10644*        SET     (ADDRESS OF PENDING-BUSINESS)
 10645*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10646*    END-EXEC.
 10647*    MOVE '," L                  $   #00010466' TO DFHEIV0
 10648     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10650     MOVE X'2020233030303130343636' TO DFHEIV0(25:11)
 10651     CALL 'kxdfhei1' USING DFHEIV0,
 10652           DFHEIV20,
 10653           ERPNDB-RECORD-LENGTH,
 10654           DFHEIV99
 10655     SET ADDRESS OF PENDING-BUSINESS TO
 10656         DFHEIV20
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
 10660
 10661* EXEC CICS HANDLE CONDITION
 10662*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10663*    END-EXEC.
 10664*    MOVE '"$I                   ! # #00010471' TO DFHEIV0
 10665     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10667     MOVE X'2320233030303130343731' TO DFHEIV0(25:11)
 10668     CALL 'kxdfhei1' USING DFHEIV0
 10669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10670
 10671
 10672     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10673     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10674     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10675
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 196
* EL6311.cbl
 10676
 10677* EXEC CICS READ
 10678*        INTO    (PENDING-BUSINESS)
 10679*        DATASET (FILE-ID-ERPNDB)
 10680*        RIDFLD  (ERPNDB-KEY)
 10681*    END-EXEC.
 10682     MOVE LENGTH OF
 10683      PENDING-BUSINESS
 10684       TO DFHEIV11
 10685*    MOVE '&"IL       E          (   #00010479' TO DFHEIV0
 10686     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10688     MOVE X'2020233030303130343739' TO DFHEIV0(25:11)
 10689     CALL 'kxdfhei1' USING DFHEIV0,
 10690           FILE-ID-ERPNDB,
 10691           PENDING-BUSINESS,
 10692           DFHEIV11,
 10693           ERPNDB-KEY,
 10694           DFHEIV99,
 10695           DFHEIV99,
 10696           DFHEIV99
 10697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10698
 10699
 10700     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10701
 10702     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10703     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10704     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10705     MOVE SPACES                 TO PENDING-BUSINESS.
 10706     MOVE 'PB'                   TO PB-RECORD-ID.
 10707     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10708     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10709     MOVE SPACES                 TO PB-CERT-SFX.
 10710     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10711     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10712                                    PB-ALT-CHG-SEQ-NO.
 10713
 10714     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10715     MOVE '1'                    TO PB-RECORD-TYPE.
 10716
 10717     IF BSUFIXL NOT = ZEROS
 10718        MOVE BSUFIXI             TO PB-CERT-SFX.
 10719
 10720     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10721
 10722     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10723     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10724
 10725     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10726                                    PB-I-LF-PREM-CALC
 10727                                    PB-I-LF-ALT-PREM-CALC
 10728                                    PB-I-LF-RATE
 10729                                    PB-I-LF-ALT-RATE
 10730                                    PB-I-LF-REI-RATE
 10731                                    PB-I-LF-ALT-REI-RATE
 10732                                    PB-I-RATE-DEV-PCT-LF
 10733                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 197
* EL6311.cbl
 10734                                    PB-I-AH-RATE
 10735                                    PB-I-AH-REI-RATE
 10736                                    PB-I-AH-RATE-TRM
 10737                                    PB-I-RATE-DEV-PCT-AH
 10738                                    PB-I-BUSINESS-TYPE
 10739                                    PB-I-LIFE-COMMISSION
 10740                                    PB-I-JOINT-COMMISSION
 10741                                    PB-I-JOINT-AGE
 10742                                    PB-I-AH-COMMISSION
 10743                                    PB-I-CURR-SEQ
 10744                                    PB-CHG-COUNT
 10745                                    PB-LF-BILLED-AMTS
 10746                                    PB-AH-BILLED-AMTS
 10747                                    PB-CALC-TOLERANCE
 10748                                    PB-I-EXTENTION-DAYS
 10749*                                   PB-I-MICROFILM-NO
 10750                                    PB-I-TERM-IN-DAYS.
 10751
 10752     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10753                                    PB-I-LF-EXPIRE-DT
 10754                                    PB-I-AH-EXPIRE-DT
 10755                                    PB-BILLED-DT
 10756                                    PB-ACCT-EFF-DT
 10757                                    PB-ACCT-EXP-DT
 10758                                    PB-I-1ST-PMT-DT.
 10759
 10760     MOVE 'X'                    TO PB-FATAL-FLAG.
 10761
 10762     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10763
 10764     IF BLSTNML GREATER THAN ZEROS
 10765         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10766
 10767*    IF BMICRNOL  GREATER  ZEROS
 10768*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10769*    ELSE
 10770*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10771     IF BVINL > ZEROS
 10772        MOVE BVINI               TO PB-I-VIN
 10773     END-IF
 10774     IF B1STNML GREATER THAN ZEROS
 10775         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10776
 10777     IF BINITL  GREATER THAN ZEROS
 10778         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10779
 10780     IF BBIRTHL GREATER THAN ZERO
 10781         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10782     ELSE
 10783         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10784
 10785     IF B1STPMTL GREATER THAN ZERO
 10786         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10787     ELSE
 10788         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10789
 10790     IF BAGEL    GREATER THAN ZEROS
 10791         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 198
* EL6311.cbl
 10792        ELSE
 10793         MOVE ZEROS              TO PB-I-AGE.
 10794
 10795     IF BSEXL    GREATER THAN ZEROS
 10796         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10797
 10798     IF BTERM-LEN (1) GREATER THAN ZEROS
 10799        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10800     ELSE
 10801        MOVE ZEROS               TO PB-I-LF-TERM.
 10802
 10803     IF BTERM-LEN (2) GREATER THAN ZEROS
 10804        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10805     ELSE
 10806        MOVE ZEROS               TO PB-I-AH-TERM.
 10807
 10808     IF BLNTRML       GREATER THAN ZEROS
 10809         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10810        ELSE
 10811         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10812
 10813     IF BFREQL        GREATER THAN ZEROS
 10814         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10815        ELSE
 10816         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10817
 10818     IF BSKPCDL       GREATER THAN ZEROS
 10819         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10820
 10821     IF BMODEL        GREATER THAN ZEROS
 10822         MOVE BMODEI             TO PB-I-TERM-TYPE
 10823                                    PI-BMODE.
 10824
 10825     IF BPMTSL        GREATER THAN ZEROS
 10826         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10827                                    PI-BPMTS
 10828        ELSE
 10829         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10830                                    PI-BPMTS.
 10831
 10832     IF BPMTAMTL      GREATER THAN ZEROS
 10833         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10834        ELSE
 10835         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10836
 10837     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10838        IF BTYPE  (1)   NOT = ZEROS
 10839           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10840                                    PI-BTYPE (1)
 10841           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10842           MOVE SPACES           TO PB-I-LF-ABBR
 10843        ELSE
 10844           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10845                                    PB-I-LF-ABBR
 10846           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10847     ELSE
 10848        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10849                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 199
* EL6311.cbl
 10850        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10851
 10852     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10853         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10854     ELSE
 10855         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10856
 10857     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10858         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10859     ELSE
 10860         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10861
 10862     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10863         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10864            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10865            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10866         ELSE
 10867            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10868*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10869*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10870         END-IF
 10871     ELSE
 10872         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10873
 10874     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10875         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10876
 10877     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10878         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10879         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10880     ELSE
 10881         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10882
 10883     IF  BALT-PREM-LEN     (2) > ZEROS
 10884         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10885     ELSE
 10886         MOVE ZEROS            TO PB-I-TOT-FEES.
 10887
 10888     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10889        IF BTYPE      (2)   NOT = ZEROS
 10890           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10891                                  PI-BTYPE (2)
 10892           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10893           MOVE SPACES         TO PB-I-AH-ABBR
 10894        ELSE
 10895           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10896                                  PB-I-AH-ABBR
 10897           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10898     ELSE
 10899        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10900                                  PB-I-AH-ABBR
 10901        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10902
 10903     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10904         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10905     ELSE
 10906         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10907
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 200
* EL6311.cbl
 10908     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10909         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10910            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10911            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10912         ELSE
 10913            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10914*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10915*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10916         END-IF
 10917     ELSE
 10918         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10919
 10920     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10921         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10922
 10923     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10924        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10925     ELSE
 10926        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10927
 10928     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10929        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10930     ELSE
 10931        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10932
 10933     IF BINDGRPL  GREATER THAN ZEROS
 10934         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10935
 10936     IF BRTCLSL   GREATER THAN ZEROS
 10937         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10938
 10939     IF BSIGL     GREATER THAN ZEROS
 10940         MOVE BSIGI              TO PB-I-SIG-SW.
 10941     IF BAPRL > ZEROS
 10942         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10943     ELSE
 10944        if pi-company-id = 'CID'
 10945           move +99.9999         to pb-i-loan-apr
 10946        else
 10947           MOVE ZEROS            TO PB-I-LOAN-APR
 10948        end-if
 10949     end-if
 10950     IF BMEMBERL  GREATER THAN ZEROS
 10951         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10952
 10953     IF BLNOFCRL  GREATER THAN ZEROS
 10954         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10955
 10956     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10957        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10958     ELSE
 10959        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10960
 10961     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10962        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10963     ELSE
 10964        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10965
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 201
* EL6311.cbl
 10966     IF BDAYSL   GREATER THAN ZEROS
 10967        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10968                                    PB-I-EXTENTION-DAYS
 10969     ELSE
 10970        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10971                                    PB-I-EXTENTION-DAYS.
 10972
 10973     IF BDAYSL GREATER THAN ZEROS
 10974        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10975
 10976     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10977        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10978           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10979
 10980     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10981        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10982           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10983
 10984     IF B1STPMTL GREATER THAN ZEROS
 10985        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10986
 10987     IF PB-EXT-DAYS-PROCESSING
 10988        IF PB-I-EXTENTION-DAYS = ZEROS
 10989           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10990
 10991     IF PB-EXPIRE-DT-PROCESSING
 10992        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10993           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10994             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10995
 10996     IF PB-1ST-PMT-DT-PROCESSING
 10997        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10998           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10999
 11000     IF BREINL GREATER THAN ZEROS
 11001        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11002
 11003     IF BENTRYL NOT = ZEROS
 11004        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11005        IF PI-COMPANY-ID = 'CID'
 11006           AND (PB-BATCH-ENTRY = 'P')
 11007           AND (PB-STATE = 'VA')
 11008           PERFORM 1500-UPDATE-ERNOTE
 11009                                 THRU 1500-EXIT
 11010        END-IF
 11011     END-IF
 11012     IF BUNWRITL NOT = ZEROS
 11013        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11014
 11015     IF BFORCEL NOT = ZEROS
 11016        MOVE BFORCEI             TO PB-FORCE-CODE.
 11017
 11018     IF BBILCDL NOT = ZEROS
 11019        MOVE BBILCDI             TO PB-RECORD-BILL.
 11020
 11021     IF BLIVESL GREATER THAN ZEROS
 11022        MOVE WS-BLIVES           TO PB-I-LIVES
 11023     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 202
* EL6311.cbl
 11024        MOVE ZEROS               TO PB-I-LIVES.
 11025
 11026     IF BBILLEDL GREATER THAN ZEROS
 11027        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11028     ELSE
 11029        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11030
 11031*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11032
 11033 1260-WRITE-PB-RECORD.
 11034     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11035                                    PB-INPUT-BY.
 11036     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11037     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11038                                    PB-INPUT-DT.
 11039
 11040     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11041     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11042                                    PB-CONTROL-BY-ORIG-BATCH.
 11043
 11044
 11045     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11046     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11047     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11048     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11049     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11050
 11051     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11052
 11053     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11054
 11055     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11056     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11057     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11058
 11059     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11060     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11061
 11062 1275-WRITE-PENDING-BUSINESS.
 11063     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11064     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11065     MOVE 'A'                    TO JP-RECORD-TYPE.
 11066     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11067
 11068
 11069* EXEC CICS HANDLE CONDITION
 11070*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11071*    END-EXEC.
 11072*    MOVE '"$%                   ! $ #00010853' TO DFHEIV0
 11073     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11075     MOVE X'2420233030303130383533' TO DFHEIV0(25:11)
 11076     CALL 'kxdfhei1' USING DFHEIV0
 11077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11078
 11079
 11080
 11081* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 203
* EL6311.cbl
 11082*        DATASET (FILE-ID-ERPNDB)
 11083*        FROM    (PENDING-BUSINESS)
 11084*        RIDFLD  (PB-CONTROL-PRIMARY)
 11085*    END-EXEC.
 11086     MOVE LENGTH OF
 11087      PENDING-BUSINESS
 11088       TO DFHEIV11
 11089*    MOVE '&$ L                  ''   #00010857' TO DFHEIV0
 11090     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11092     MOVE X'2020233030303130383537' TO DFHEIV0(25:11)
 11093     CALL 'kxdfhei1' USING DFHEIV0,
 11094           FILE-ID-ERPNDB,
 11095           PENDING-BUSINESS,
 11096           DFHEIV11,
 11097           PB-CONTROL-PRIMARY,
 11098           DFHEIV99,
 11099           DFHEIV99
 11100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11101
 11102
 11103     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11104
 11105     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11106
 11107******************************************************************
 11108*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11109******************************************************************
 11110     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11111     MOVE ' '                    TO WS-ERMAIL-SW
 11112
 11113* EXEC CICS READ
 11114*       DATASET   (FILE-ID-ERMAIL)
 11115*       SET       (ADDRESS OF MAILING-DATA)
 11116*       RIDFLD    (ERMAIL-KEY)
 11117*       RESP      (WS-RESPONSE)
 11118*    END-EXEC
 11119*    MOVE '&"S        E          (  N#00010873' TO DFHEIV0
 11120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11122     MOVE X'204E233030303130383733' TO DFHEIV0(25:11)
 11123     CALL 'kxdfhei1' USING DFHEIV0,
 11124           FILE-ID-ERMAIL,
 11125           DFHEIV20,
 11126           DFHEIV99,
 11127           ERMAIL-KEY,
 11128           DFHEIV99,
 11129           DFHEIV99,
 11130           DFHEIV99
 11131     SET ADDRESS OF MAILING-DATA TO
 11132         DFHEIV20
 11133     MOVE EIBRESP  TO WS-RESPONSE
 11134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11135     IF RESP-NORMAL
 11136        SET ERMAIL-FOUND TO TRUE
 11137     END-IF
 11138
 11139     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 204
* EL6311.cbl
 11140     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11141     MOVE 'OC'                   TO OC-RECORD-ID
 11142     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11143                                 TO OC-CONTROL-PRIMARY (1:33)
 11144     MOVE 'I'                    TO OC-RECORD-TYPE
 11145     MOVE +4096                  TO OC-KEY-SEQ-NO
 11146     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11147     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11148     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11149     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11150     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11151     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11152     MOVE PB-I-AGE               TO OC-INS-AGE
 11153     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11154     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11155     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11156     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11157     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11158     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11159     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11160     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11161     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11162     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11163     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11164     IF PB-I-JOINT-COMMISSION > +0
 11165         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11166     ELSE
 11167         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11168     END-IF
 11169     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11170     MOVE +0                     TO OC-LF-CANCEL-AMT
 11171                                    OC-LF-ITD-CANCEL-AMT
 11172     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11173     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11174     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11175     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11176     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11177     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11178     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11179     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11180     MOVE +0                     TO OC-AH-CANCEL-AMT
 11181                                    OC-AH-ITD-CANCEL-AMT
 11182     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11183     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11184     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11185     IF ERMAIL-FOUND
 11186        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11187     END-IF
 11188     IF NOT CERT-TRL-REC-NOT-FOUND
 11189        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11190                           OC-INS-AGE-DEFAULT-FLAG
 11191        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11192                           OC-JNT-AGE-DEFAULT-FLAG
 11193     END-IF
 11194     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11195     .
 11196 1275-WRITE-ELCRTO.
 11197
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 205
* EL6311.cbl
 11198* EXEC CICS WRITE
 11199*       DATASET   ('ELCRTO')
 11200*       FROM      (ORIGINAL-CERTIFICATE)
 11201*       RIDFLD    (OC-CONTROL-PRIMARY)
 11202*       RESP      (WS-RESPONSE)
 11203*    END-EXEC
 11204     MOVE LENGTH OF
 11205      ORIGINAL-CERTIFICATE
 11206       TO DFHEIV11
 11207     MOVE 'ELCRTO' TO DFHEIV1
 11208*    MOVE '&$ L                  ''  N#00010941' TO DFHEIV0
 11209     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11210     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11211     MOVE X'204E233030303130393431' TO DFHEIV0(25:11)
 11212     CALL 'kxdfhei1' USING DFHEIV0,
 11213           DFHEIV1,
 11214           ORIGINAL-CERTIFICATE,
 11215           DFHEIV11,
 11216           OC-CONTROL-PRIMARY,
 11217           DFHEIV99,
 11218           DFHEIV99
 11219     MOVE EIBRESP  TO WS-RESPONSE
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11221*    display ' just wrote 1275 ' ws-response
 11222     IF RESP-DUPKEY
 11223        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11224        GO TO 1275-WRITE-ELCRTO
 11225     ELSE
 11226        IF NOT RESP-NORMAL
 11227           MOVE -1               TO BMAINTL
 11228           MOVE ER-7450          TO EMI-ERROR
 11229           PERFORM 9900-ERROR-FORMAT
 11230                                 THRU 9900-EXIT
 11231           GO TO 8200-SEND-DATAONLY
 11232        END-IF
 11233     END-IF
 11234******************************************************************
 11235*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11236******************************************************************
 11237
 11238
 11239* EXEC CICS READ
 11240*        INTO    (PENDING-BUSINESS)
 11241*        DATASET (FILE-ID-ERPNDB)
 11242*        RIDFLD  (ERPNDB-KEY)
 11243*        UPDATE
 11244*    END-EXEC.
 11245     MOVE LENGTH OF
 11246      PENDING-BUSINESS
 11247       TO DFHEIV11
 11248*    MOVE '&"IL       EU         (   #00010964' TO DFHEIV0
 11249     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11250     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11251     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 11252     CALL 'kxdfhei1' USING DFHEIV0,
 11253           FILE-ID-ERPNDB,
 11254           PENDING-BUSINESS,
 11255           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 206
* EL6311.cbl
 11256           ERPNDB-KEY,
 11257           DFHEIV99,
 11258           DFHEIV99,
 11259           DFHEIV99
 11260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11261
 11262
 11263     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11264     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11265     MOVE 'B'                    TO JP-RECORD-TYPE.
 11266     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11267
 11268     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11269
 11270     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11271
 11272
 11273* EXEC CICS REWRITE
 11274*        DATASET (FILE-ID-ERPNDB)
 11275*        FROM    (PENDING-BUSINESS)
 11276*    END-EXEC.
 11277     MOVE LENGTH OF
 11278      PENDING-BUSINESS
 11279       TO DFHEIV11
 11280*    MOVE '&& L                  %   #00010980' TO DFHEIV0
 11281     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11282     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11283     MOVE X'2020233030303130393830' TO DFHEIV0(25:11)
 11284     CALL 'kxdfhei1' USING DFHEIV0,
 11285           FILE-ID-ERPNDB,
 11286           PENDING-BUSINESS,
 11287           DFHEIV11,
 11288           DFHEIV99
 11289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11290
 11291
 11292     MOVE 'C'                    TO JP-RECORD-TYPE.
 11293     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11294
 11295     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11296
 11297     IF WS-ERRORS-PRESENT
 11298         GO TO 3900-RE-DISPLAY-RECORD.
 11299
 11300     MOVE ZEROS                  TO EMI-ERROR.
 11301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11302     MOVE LOW-VALUES             TO EL631BI.
 11303     MOVE  -1                    TO BMAINTL.
 11304     GO TO 8100-SEND-INITIAL-MAP.
 11305
 11306 1280-BATCH-HDR-NOT-FOUND.
 11307     MOVE -1                     TO BMAINTL.
 11308     MOVE ER-7450                TO EMI-ERROR.
 11309     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11310     GO TO 8200-SEND-DATAONLY.
 11311
 11312 1290-DUPLICATE-ALT-INDEX.
 11313
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 207
* EL6311.cbl
 11314******************************************************************
 11315*                                                                *
 11316*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11317*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11318*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11319*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11320*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11321*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11322*                                                                *
 11323******************************************************************
 11324
 11325     IF LCP-ONCTR-01 =  0
 11326         ADD 1 TO LCP-ONCTR-01
 11327        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11328
 11329     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11330
 11331     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11332         NEXT SENTENCE
 11333     ELSE
 11334         ADD +1 TO PB-BATCH-SEQ-NO
 11335                   PB-CSR-BATCH-SEQ-NO
 11336         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11337         GO TO 1275-WRITE-PENDING-BUSINESS.
 11338
 11339     MOVE -1                     TO BCERTNOL.
 11340     MOVE AL-UABON               TO BCERTNOA.
 11341     MOVE AL-UNBON               TO BEFFDTA.
 11342
 11343     MOVE 1                      TO EMI-SUB
 11344                                    EMI-SWITCH1
 11345                                    EMI-SWITCH-AREA-1
 11346                                    EMI-SWITCH-AREA-2.
 11347
 11348     MOVE SPACES                 TO EMI-ERROR-LINES.
 11349
 11350
 11351* EXEC CICS SYNCPOINT ROLLBACK
 11352*    END-EXEC.
 11353*    MOVE '6"R                   !   #00011043' TO DFHEIV0
 11354     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11356     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 11357     CALL 'kxdfhei1' USING DFHEIV0
 11358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11359
 11360
 11361     MOVE ER-2247                TO EMI-ERROR.
 11362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11363     GO TO 8200-SEND-DATAONLY.
 11364
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 208
* EL6311.cbl
 11366
 11367
 11368 1295-READ-CERT-TRAILER.
 11369
 11370
 11371* EXEC CICS GETMAIN
 11372*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11373*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11374*        INITIMG (GETMAIN-SPACE)
 11375*    END-EXEC
 11376*    MOVE ',"IL                  $   #00011055' TO DFHEIV0
 11377     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11379     MOVE X'2020233030303131303535' TO DFHEIV0(25:11)
 11380     CALL 'kxdfhei1' USING DFHEIV0,
 11381           DFHEIV20,
 11382           ELCRTT-RECORD-LENGTH,
 11383           GETMAIN-SPACE
 11384     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11385         DFHEIV20
 11386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11387
 11388     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11389     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11390     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11391
 11392
 11393* EXEC CICS HANDLE CONDITION
 11394*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11395*    END-EXEC.
 11396*    MOVE '"$I                   ! % #00011065' TO DFHEIV0
 11397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11399     MOVE X'2520233030303131303635' TO DFHEIV0(25:11)
 11400     CALL 'kxdfhei1' USING DFHEIV0
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404
 11405* EXEC CICS READ
 11406*        DATASET  (CRTT-ID)
 11407*        RIDFLD   (ELCRTT-KEY)
 11408*        INTO     (CERTIFICATE-TRAILERS)
 11409*    END-EXEC.
 11410     MOVE LENGTH OF
 11411      CERTIFICATE-TRAILERS
 11412       TO DFHEIV11
 11413*    MOVE '&"IL       E          (   #00011069' TO DFHEIV0
 11414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11416     MOVE X'2020233030303131303639' TO DFHEIV0(25:11)
 11417     CALL 'kxdfhei1' USING DFHEIV0,
 11418           CRTT-ID,
 11419           CERTIFICATE-TRAILERS,
 11420           DFHEIV11,
 11421           ELCRTT-KEY,
 11422           DFHEIV99,
 11423           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 209
* EL6311.cbl
 11424           DFHEIV99
 11425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11426
 11427
 11428     GO TO 1295-EXIT.
 11429
 11430 1295-CERT-TRL-REC-NOTFND.
 11431     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11432
 11433 1295-EXIT.
 11434     EXIT.
 11435
 11436******************************************************************
 11437*                                                                *
 11438*          C H A N G E   I S S U E   R O U T I N E               *
 11439*                                                                *
 11440******************************************************************
 11441
 11442***************************************************************
 11443*                                                             *
 11444*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11445*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11446*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11447*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11448*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11449*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11450*     5. LINK TO THE EDIT ROUTINE.                            *
 11451*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11452*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11453*              THE EDIT ROUTINE.                              *
 11454*     7. REWRITE THE NEW ISSUE                                *
 11455*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11456*                                                             *
 11457***************************************************************
 11458
 11459 1300-CHANGE-ISSUE-ROUTINE.
 11460     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11461
 11462     IF BCHGL NOT = ZEROS
 11463        MOVE ER-2196             TO EMI-ERROR
 11464        MOVE AL-UABON            TO BMAINTA
 11465        MOVE -1                  TO BMAINTL
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        GO TO 8200-SEND-DATAONLY.
 11468
 11469     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11470
 11471     IF BSUFIXL NOT = ZEROS
 11472        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11473     ELSE
 11474        MOVE SPACE               TO WS-NEW-SUFFIX.
 11475
 11476     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11477     PERFORM 8600-DEEDIT.
 11478     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11479     MOVE '4'                    TO DC-OPTION-CODE.
 11480     PERFORM 9700-DATE-LINK.
 11481     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 210
* EL6311.cbl
 11482        MOVE ER-0348             TO EMI-ERROR
 11483        MOVE -1                  TO BEFFDTL
 11484        MOVE AL-UABON            TO BEFFDTA
 11485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486        GO TO 8200-SEND-DATAONLY
 11487     ELSE
 11488        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11489        MOVE AL-UANON            TO BEFFDTA
 11490        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11491
 11492 1325-PROCESS-ISSUE-CHANGES.
 11493
 11494* EXEC CICS HANDLE CONDITION
 11495*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11496*    END-EXEC.
 11497*    MOVE '"$I                   ! & #00011140' TO DFHEIV0
 11498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11500     MOVE X'2620233030303131313430' TO DFHEIV0(25:11)
 11501     CALL 'kxdfhei1' USING DFHEIV0
 11502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11503
 11504
 11505     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11506     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11507     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11508
 11509
 11510* EXEC CICS GETMAIN
 11511*        SET      (ADDRESS OF PENDING-BUSINESS)
 11512*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11513*        INITIMG  (GETMAIN-SPACE)
 11514*     END-EXEC.
 11515*    MOVE ',"IL                  $   #00011148' TO DFHEIV0
 11516     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11518     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 11519     CALL 'kxdfhei1' USING DFHEIV0,
 11520           DFHEIV20,
 11521           ERPNDB-RECORD-LENGTH,
 11522           GETMAIN-SPACE
 11523     SET ADDRESS OF PENDING-BUSINESS TO
 11524         DFHEIV20
 11525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11526
 11527
 11528
 11529* EXEC CICS READ
 11530*        INTO    (PENDING-BUSINESS)
 11531*        DATASET (FILE-ID-ERPNDB)
 11532*        RIDFLD  (ERPNDB-KEY)
 11533*    END-EXEC.
 11534     MOVE LENGTH OF
 11535      PENDING-BUSINESS
 11536       TO DFHEIV11
 11537*    MOVE '&"IL       E          (   #00011154' TO DFHEIV0
 11538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 211
* EL6311.cbl
 11540     MOVE X'2020233030303131313534' TO DFHEIV0(25:11)
 11541     CALL 'kxdfhei1' USING DFHEIV0,
 11542           FILE-ID-ERPNDB,
 11543           PENDING-BUSINESS,
 11544           DFHEIV11,
 11545           ERPNDB-KEY,
 11546           DFHEIV99,
 11547           DFHEIV99,
 11548           DFHEIV99
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11550
 11551
 11552     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11553
 11554
 11555* EXEC CICS HANDLE CONDITION
 11556*         NOTFND     (1385-REC-NOT-FOUND)
 11557*    END-EXEC.
 11558*    MOVE '"$I                   ! '' #00011162' TO DFHEIV0
 11559     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11561     MOVE X'2720233030303131313632' TO DFHEIV0(25:11)
 11562     CALL 'kxdfhei1' USING DFHEIV0
 11563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11564
 11565
 11566**********************************************************
 11567*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11568*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11569**********************************************************
 11570
 11571
 11572* EXEC CICS READ
 11573*        DATASET (FILE-ID-ERPNDB)
 11574*        INTO    (PENDING-BUSINESS)
 11575*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11576*    END-EXEC.
 11577     MOVE LENGTH OF
 11578      PENDING-BUSINESS
 11579       TO DFHEIV11
 11580*    MOVE '&"IL       E          (   #00011171' TO DFHEIV0
 11581     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11583     MOVE X'2020233030303131313731' TO DFHEIV0(25:11)
 11584     CALL 'kxdfhei1' USING DFHEIV0,
 11585           FILE-ID-ERPNDB,
 11586           PENDING-BUSINESS,
 11587           DFHEIV11,
 11588           PI-PREV-CONTROL-PRIMARY,
 11589           DFHEIV99,
 11590           DFHEIV99,
 11591           DFHEIV99
 11592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11593
 11594
 11595********** DO NOT ALLOW CHANGES IF THRU A/R
 11596     IF BMAINTI = 'C'
 11597         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 212
* EL6311.cbl
 11598             MOVE ER-4005          TO EMI-ERROR
 11599             MOVE -1               TO BMAINTL
 11600             MOVE AL-UABON         TO BMAINTA
 11601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602             GO TO 8200-SEND-DATAONLY.
 11603**********
 11604     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11605
 11606     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11607        MOVE -1                 TO BMAINTL
 11608        MOVE ER-2197            TO EMI-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610        GO TO 8200-SEND-DATAONLY.
 11611
 11612     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11613        MOVE ER-2196             TO EMI-ERROR
 11614        MOVE AL-UABON            TO BMAINTA
 11615        MOVE -1                  TO BMAINTL
 11616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11617        GO TO 8200-SEND-DATAONLY.
 11618
 11619     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11620
 11621     IF PB-BILLED-DT = LOW-VALUES AND
 11622        PB-CHG-COUNT = ZEROS
 11623        NEXT SENTENCE
 11624     ELSE
 11625        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11626            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11627           OR
 11628           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11629            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11630           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11631     move zeros                  to ws-check-amts
 11632     move ' '                    to ws-stop-sw
 11633                                    ws-check-sw
 11634                                    ws-proc-check-sw
 11635                                    ws-any-check-sw
 11636                                    ws-chek-browse-sw
 11637
 11638     perform 2500-browse-checks  thru 2500-exit
 11639
 11640     if i-have-processed-checks
 11641        or i-have-checks
 11642        continue
 11643     else
 11644        go to 1330-continue
 11645     end-if
 11646
 11647     compute ws-tot-orig-prem =
 11648        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11649        pb-i-lf-alt-premium-amt
 11650
 11651     if bprem1l <> zeros
 11652        MOVE AL-UNNON            TO bprem1a
 11653        move ws-bprem (1)        to ws-new-iss-total
 11654     else
 11655        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 213
* EL6311.cbl
 11656     end-if
 11657     display ' new iss totala ' ws-new-iss-total
 11658
 11659     if baltpr1l <> zeros
 11660        MOVE AL-UNNON            TO baltpr1a
 11661        compute ws-new-iss-total =
 11662           ws-new-iss-total + ws-balt-prem(1)
 11663     else
 11664        compute ws-new-iss-total =
 11665           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11666     end-if
 11667
 11668     if bprem2l <> zeros
 11669        MOVE AL-UNNON            TO bprem2a
 11670        compute ws-new-iss-total = ws-new-iss-total +
 11671           ws-bprem (2)
 11672     else
 11673        compute ws-new-iss-total = ws-new-iss-total +
 11674           pb-i-ah-premium-amt
 11675     end-if
 11676
 11677     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11678        if ((bprem1l <> zeros)
 11679           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11680                      or
 11681           ((bprem2l <> zeros)
 11682           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11683           move er-3456          to emi-error
 11684           perform 9900-error-format
 11685                                 thru 9900-exit
 11686           go to 1330-continue
 11687        end-if
 11688     end-if
 11689
 11690     if ws-new-iss-total > ws-tot-orig-prem
 11691        move er-3458             to emi-error
 11692        perform 9900-error-format thru 9900-exit
 11693        move al-uabon            to bmainta
 11694        move -1                  to bmaintl
 11695        go to 8200-send-dataonly
 11696     end-if
 11697
 11698     if ws-new-iss-total < ws-tot-orig-prem
 11699        move er-3457             to emi-error
 11700        move al-uabon            to bprem1a
 11701                                    bprem2a
 11702        move +0 to bprem1l bprem2l
 11703        perform 9900-error-format thru 9900-exit
 11704        move -1                  to bmaintl
 11705        go to 1330-continue
 11706     end-if
 11707
 11708     .
 11709 1330-continue.
 11710
 11711
 11712* EXEC CICS READ
 11713*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 214
* EL6311.cbl
 11714*        INTO    (PENDING-BUSINESS)
 11715*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11716*        UPDATE
 11717*    END-EXEC.
 11718     MOVE LENGTH OF
 11719      PENDING-BUSINESS
 11720       TO DFHEIV11
 11721*    MOVE '&"IL       EU         (   #00011293' TO DFHEIV0
 11722     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11723     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11724     MOVE X'2020233030303131323933' TO DFHEIV0(25:11)
 11725     CALL 'kxdfhei1' USING DFHEIV0,
 11726           FILE-ID-ERPNDB,
 11727           PENDING-BUSINESS,
 11728           DFHEIV11,
 11729           PI-PREV-CONTROL-PRIMARY,
 11730           DFHEIV99,
 11731           DFHEIV99,
 11732           DFHEIV99
 11733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11734
 11735
 11736     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11737     MOVE 'B'                    TO JP-RECORD-TYPE
 11738     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11739     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11740
 11741*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11742
 11743     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11744        PB-CHG-COUNT NOT = ZEROS
 11745        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11746            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11747           OR
 11748           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11749            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11750            MOVE LOW-VALUES             TO PB-BILLED-DT
 11751            ADD +1                      TO PB-CHG-COUNT.
 11752
 11753     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11754     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11755     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11756     MOVE '5'                    TO DC-OPTION-CODE.
 11757     PERFORM 9700-DATE-LINK
 11758     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11759
 11760*    IF BMICRNOL  GREATER  ZEROS
 11761*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11762
 11763     IF BVINL > ZEROS
 11764        MOVE BVINI               TO PB-I-VIN
 11765     END-IF
 11766     IF (BFORCEL NOT = ZEROS)
 11767        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11768        AND (BFORCEI = ' ')
 11769        AND (PB-FORCE-CODE = 'O')
 11770        COMPUTE PB-I-AH-PREMIUM-AMT =
 11771           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 215
* EL6311.cbl
 11772        PERFORM 1800-REMOVE-CERT-NOTES
 11773                                 THRU 1800-EXIT
 11774        PERFORM 1900-DELETE-ERPYAJ
 11775                                 THRU 1900-EXIT
 11776        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11777     END-IF
 11778     IF (BFORCEL NOT = ZEROS)
 11779        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11780        AND (BFORCEI = 'O')
 11781        AND (PB-FORCE-CODE NOT = 'O')
 11782        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11783           PB-I-AH-PREM-CALC
 11784        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11785        MOVE SPACE               TO DC-OPTION-CODE
 11786        PERFORM 9700-DATE-LINK
 11787        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11788        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11789        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11790        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11791        PERFORM 1500-UPDATE-ERNOTE
 11792                                 THRU 1500-EXIT
 11793        PERFORM 1600-UPDATE-ERPYAJ
 11794                                 THRU 1600-EXIT
 11795     END-IF
 11796     IF BLSTNML  GREATER THAN ZEROS
 11797         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11798
 11799     IF B1STNML  GREATER THAN ZEROS
 11800         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11801
 11802     IF BINITL   GREATER THAN ZEROS
 11803         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11804
 11805     IF BBIRTHL  GREATER THAN ZERO
 11806         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11807
 11808     IF B1STPMTL GREATER THAN ZERO
 11809         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11810
 11811     IF BAGEL    GREATER THAN ZEROS
 11812         MOVE BAGEI              TO PB-I-AGE.
 11813
 11814     MOVE 'N'                    TO WS-INS-AGE-SET
 11815                                    WS-JNT-AGE-SET.
 11816     IF BAGEL    GREATER THAN ZEROS
 11817        MOVE 'Y'                TO WS-INS-AGE-SET
 11818        IF BAGEI = ZERO AND
 11819             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11820           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11821           MOVE 'AGE*'          TO BAGEDEFO
 11822        ELSE
 11823           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11824           MOVE 'AGE '          TO BAGEDEFO
 11825        END-IF
 11826        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11827     END-IF.
 11828
 11829     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 216
* EL6311.cbl
 11830         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11831
 11832     IF LETRREQL   GREATER THAN ZEROS
 11833        MOVE LETRREQI TO PB-I-LETTER-REQD
 11834     END-IF.
 11835
 11836     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11837        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11838
 11839     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11840        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11841
 11842     IF BLNTRML  GREATER THAN ZEROS
 11843         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11844
 11845     IF BFREQL   GREATER THAN ZEROS
 11846         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11847
 11848     IF BSKPCDL  GREATER THAN ZEROS
 11849         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11850
 11851     IF BMODEL   GREATER THAN ZEROS
 11852         MOVE BMODEI             TO PB-I-TERM-TYPE
 11853                                    PI-BMODE.
 11854
 11855     IF BPMTSL   GREATER THAN ZEROS
 11856         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11857                                    PI-BPMTS.
 11858
 11859     IF BPMTAMTL GREATER THAN ZEROS
 11860         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11861
 11862     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11863         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11864
 11865     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11866         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11867
 11868     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11869
 11870     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11871         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11872            SUBTRACT PB-I-LF-PREMIUM-AMT
 11873                     FROM WS-B-LF-ISS-PRM-ENTERED
 11874            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11875            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11876            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11877         ELSE
 11878            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11879*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11880*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11881         END-IF
 11882     END-IF.
 11883
 11884     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11885            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11886                     FROM WS-B-LF-ISS-PRM-ENTERED
 11887         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 217
* EL6311.cbl
 11888         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11889
 11890     IF  BALT-PREM-LEN     (2)  > ZEROS
 11891         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11892
 11893     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11894         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11895
 11896     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11897         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11898            SUBTRACT PB-I-AH-PREMIUM-AMT
 11899                     FROM WS-B-AH-ISS-PRM-ENTERED
 11900            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11901            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11902            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11903         ELSE
 11904            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11905*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11906*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11907         END-IF
 11908     END-IF
 11909
 11910     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11911        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11912
 11913     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11914        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11915
 11916     IF BINDGRPL            GREATER THAN ZEROS
 11917         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11918
 11919     IF BRTCLSL             GREATER THAN ZEROS
 11920         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11921
 11922     IF BSIGL               GREATER THAN ZEROS
 11923         MOVE BSIGI              TO PB-I-SIG-SW.
 11924
 11925     IF BAPRL               GREATER THAN ZEROS
 11926         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11927
 11928     IF BMEMBERL            GREATER THAN ZEROS
 11929         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11930
 11931     IF BLNOFCRL            GREATER THAN ZEROS
 11932         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11933
 11934     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11935        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11936
 11937     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11938        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11939
 11940     IF BDAYSL              GREATER THAN ZEROS
 11941        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11942                                    PB-I-EXTENTION-DAYS.
 11943
 11944     IF BDAYSL GREATER THAN ZEROS
 11945        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 218
* EL6311.cbl
 11946
 11947     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11948        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11949           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11950
 11951     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11952        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11953           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11954
 11955     IF B1STPMTL GREATER THAN ZEROS
 11956        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11957
 11958     IF PB-EXT-DAYS-PROCESSING
 11959        IF PB-I-EXTENTION-DAYS = ZEROS
 11960           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11961
 11962     IF PB-EXPIRE-DT-PROCESSING
 11963        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11964           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11965             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11966
 11967     IF PB-1ST-PMT-DT-PROCESSING
 11968        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11969           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11970
 11971     IF BREINL GREATER THAN ZEROS
 11972        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11973
 11974     IF BFORCEL NOT = ZEROS
 11975        MOVE BFORCEI             TO PB-FORCE-CODE.
 11976     IF (BENTRYL NOT = ZEROS)
 11977        AND (PB-COMPANY-ID = 'CID')
 11978        AND (PB-STATE = 'VA')
 11979        AND (BENTRYI NOT = 'P')
 11980        AND (PB-BATCH-ENTRY = 'P')
 11981        PERFORM 1800-REMOVE-CERT-NOTES
 11982                                 THRU 1800-EXIT
 11983     END-IF
 11984     IF BENTRYL NOT = ZEROS
 11985        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11986        IF PI-COMPANY-ID = 'CID'
 11987           AND (PB-BATCH-ENTRY = 'P')
 11988           AND (PB-STATE = 'VA')
 11989           PERFORM 1500-UPDATE-ERNOTE
 11990                                 THRU 1500-EXIT
 11991        END-IF
 11992     END-IF
 11993
 11994     IF BUNWRITL NOT = ZEROS
 11995        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11996
 11997     IF BBILCDL NOT = ZEROS
 11998        MOVE BBILCDI             TO PB-RECORD-BILL.
 11999
 12000     IF BLIVESL GREATER THAN ZEROS
 12001        MOVE WS-BLIVES           TO PB-I-LIVES.
 12002
 12003
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 219
* EL6311.cbl
 12004*DMD CUSTOM CODING*************START
 12005     IF PI-COMPANY-ID NOT = 'DMD'
 12006         MOVE ZEROS               TO BBILLEDL.
 12007*DMD CUSTOM CODING*************END
 12008
 12009     IF BBILLEDL GREATER THAN ZEROS
 12010        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 12011
 12012
 12013*****************************************************************
 12014*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 12015*****************************************************************
 12016
 12017     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12018        IF BTYPE  (1)   = ZEROS OR SPACES
 12019           IF REMOVE-LF-COVERAGE
 12020               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12021                                        PI-BTYPE (1)
 12022               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12023                                        WS-B-LF-ISS-PRM-ENTERED
 12024               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12025                                        WS-B-LF-ISS-PRM-ENTERED
 12026               SUBTRACT PB-I-LF-PREM-CALC FROM
 12027                                        WS-B-LF-ISS-PRM-COMPUTED
 12028               MOVE ZEROS            TO PB-I-LF-TERM
 12029                                        PB-I-LF-BENEFIT-AMT
 12030                                        PB-I-LF-PREMIUM-AMT
 12031                                        PB-I-LF-BENEFIT-CD
 12032                                        PB-I-LF-PREM-CALC
 12033                                        PB-I-LF-CRIT-PER
 12034                                        PB-I-LF-ALT-BENEFIT-AMT
 12035                                        PB-I-LF-ALT-PREMIUM-AMT
 12036               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12037           ELSE
 12038               NEXT SENTENCE
 12039        ELSE
 12040           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12041                                    PI-BTYPE (1).
 12042     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12043        IF BTYPE  (2)   = ZEROS OR SPACES
 12044           IF  REMOVE-AH-COVERAGE
 12045               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12046                                        PI-BTYPE (2)
 12047               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12048                                        WS-B-AH-ISS-PRM-ENTERED
 12049               SUBTRACT PB-I-AH-PREM-CALC FROM
 12050                                        WS-B-AH-ISS-PRM-COMPUTED
 12051               MOVE ZEROS            TO PB-I-AH-TERM
 12052                                        PB-I-AH-BENEFIT-AMT
 12053                                        PB-I-AH-PREMIUM-AMT
 12054                                        PB-I-AH-BENEFIT-CD
 12055                                        PB-I-AH-PREM-CALC
 12056                                        PB-I-AH-CRIT-PER
 12057               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12058           ELSE
 12059               NEXT SENTENCE
 12060        ELSE
 12061           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 220
* EL6311.cbl
 12062                                    PI-BTYPE (2).
 12063 1360-REWRITE-PB-RECORD.
 12064     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12065
 12066     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12067     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12068
 12069     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12070
 12071     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12072     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12073
 12074     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12075         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12076
 12077     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12078         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12079
 12080     IF CSR-EDIT-SESSION
 12081        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12082     END-IF.
 12083
 12084     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12085
 12086     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12087
 12088     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12089
 12090     IF ARCHIVE-LETTER-RELEASED
 12091        MOVE 'C' TO PB-I-LETTER-REQD
 12092        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12093        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12094     END-IF
 12095
 12096     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12097     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12098     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12099
 12100     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12101     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12102
 12103 1375-REWRITE-PB-RECORD.
 12104     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12105     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12106     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12107     MOVE 'C'                    TO JP-RECORD-TYPE.
 12108     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12109
 12110
 12111* EXEC CICS REWRITE
 12112*        DATASET (FILE-ID-ERPNDB)
 12113*        FROM    (PENDING-BUSINESS)
 12114*    END-EXEC.
 12115     MOVE LENGTH OF
 12116      PENDING-BUSINESS
 12117       TO DFHEIV11
 12118*    MOVE '&& L                  %   #00011674' TO DFHEIV0
 12119     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 221
* EL6311.cbl
 12120     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12121     MOVE X'2020233030303131363734' TO DFHEIV0(25:11)
 12122     CALL 'kxdfhei1' USING DFHEIV0,
 12123           FILE-ID-ERPNDB,
 12124           PENDING-BUSINESS,
 12125           DFHEIV11,
 12126           DFHEIV99
 12127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12128
 12129
 12130     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12131******************************************************************
 12132*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12133******************************************************************
 12134     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12135     MOVE ' '                    TO WS-ERMAIL-SW
 12136
 12137* EXEC CICS READ
 12138*       DATASET   (FILE-ID-ERMAIL)
 12139*       SET       (ADDRESS OF MAILING-DATA)
 12140*       RIDFLD    (ERMAIL-KEY)
 12141*       RESP      (WS-RESPONSE)
 12142*    END-EXEC
 12143*    MOVE '&"S        E          (  N#00011685' TO DFHEIV0
 12144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12146     MOVE X'204E233030303131363835' TO DFHEIV0(25:11)
 12147     CALL 'kxdfhei1' USING DFHEIV0,
 12148           FILE-ID-ERMAIL,
 12149           DFHEIV20,
 12150           DFHEIV99,
 12151           ERMAIL-KEY,
 12152           DFHEIV99,
 12153           DFHEIV99,
 12154           DFHEIV99
 12155     SET ADDRESS OF MAILING-DATA TO
 12156         DFHEIV20
 12157     MOVE EIBRESP  TO WS-RESPONSE
 12158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12159     IF RESP-NORMAL
 12160        SET ERMAIL-FOUND TO TRUE
 12161     END-IF
 12162
 12163     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12164     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12165                                 TO ELCRTO-KEY
 12166     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12167     MOVE +0                     TO ELCRTO-SEQ-NO
 12168
 12169* EXEC CICS READ
 12170*       DATASET   ('ELCRTO')
 12171*       INTO      (ORIGINAL-CERTIFICATE)
 12172*       RIDFLD    (ELCRTO-KEY)
 12173*       GTEQ
 12174*       RESP      (WS-RESPONSE)
 12175*    END-EXEC
 12176     MOVE LENGTH OF
 12177      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 222
* EL6311.cbl
 12178       TO DFHEIV11
 12179     MOVE 'ELCRTO' TO DFHEIV1
 12180*    MOVE '&"IL       G          (  N#00011700' TO DFHEIV0
 12181     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12183     MOVE X'204E233030303131373030' TO DFHEIV0(25:11)
 12184     CALL 'kxdfhei1' USING DFHEIV0,
 12185           DFHEIV1,
 12186           ORIGINAL-CERTIFICATE,
 12187           DFHEIV11,
 12188           ELCRTO-KEY,
 12189           DFHEIV99,
 12190           DFHEIV99,
 12191           DFHEIV99
 12192     MOVE EIBRESP  TO WS-RESPONSE
 12193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12194*    display ' just read gteq ' ws-response
 12195     IF RESP-NORMAL
 12196        AND (OC-CONTROL-PRIMARY (1:33) =
 12197                 PB-CONTROL-BY-ACCOUNT (1:33))
 12198        AND (OC-RECORD-TYPE = 'I')
 12199        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12200           display ' csr edit session ' PI-CSR-SESSION-SW
 12201           IF NOT CSR-EDIT-SESSION
 12202
 12203* EXEC CICS READ
 12204*                DATASET   ('ELCRTO')
 12205*                INTO      (ORIGINAL-CERTIFICATE)
 12206*                RIDFLD    (OC-CONTROL-PRIMARY)
 12207*                UPDATE
 12208*                RESP      (WS-RESPONSE)
 12209*             END-EXEC
 12210     MOVE LENGTH OF
 12211      ORIGINAL-CERTIFICATE
 12212       TO DFHEIV11
 12213     MOVE 'ELCRTO' TO DFHEIV1
 12214*    MOVE '&"IL       EU         (  N#00011717' TO DFHEIV0
 12215     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12217     MOVE X'204E233030303131373137' TO DFHEIV0(25:11)
 12218     CALL 'kxdfhei1' USING DFHEIV0,
 12219           DFHEIV1,
 12220           ORIGINAL-CERTIFICATE,
 12221           DFHEIV11,
 12222           OC-CONTROL-PRIMARY,
 12223           DFHEIV99,
 12224           DFHEIV99,
 12225           DFHEIV99
 12226     MOVE EIBRESP  TO WS-RESPONSE
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12228              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12229              IF RESP-NORMAL
 12230                 display ' good read upd '
 12231                 MOVE PB-I-INSURED-LAST-NAME TO
 12232                         OC-INS-LAST-NAME
 12233                 MOVE PB-I-INSURED-FIRST-NAME TO
 12234                         OC-INS-FIRST-NAME
 12235                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 223
* EL6311.cbl
 12236                         OC-INS-MIDDLE-INIT
 12237                 MOVE PB-I-AGE         TO OC-INS-AGE
 12238                 MOVE PB-I-JOINT-LAST-NAME   TO
 12239                         OC-JNT-LAST-NAME
 12240                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12241                         OC-JNT-FIRST-NAME
 12242                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12243                         OC-JNT-MIDDLE-INIT
 12244                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12245                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12246                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12247                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12248                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12249                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12250                         OC-LF-ALT-BEN-AMT
 12251                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12252                         OC-LF-ALT-PRM-AMT
 12253                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12254                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12255                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12256                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12257                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12258                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12259                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12260                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12261                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12262                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12263                 IF OC-CANCEL-TRAN-IND = 'N'
 12264                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12265                    MOVE +0            TO OC-LF-CANCEL-AMT
 12266                                          OC-LF-ITD-CANCEL-AMT
 12267                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12268                    MOVE +0            TO OC-AH-CANCEL-AMT
 12269                                          OC-AH-ITD-CANCEL-AMT
 12270                 END-IF
 12271                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12272                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12273                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12274                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12275                 IF ERMAIL-FOUND
 12276                    MOVE MA-CRED-BENE-NAME
 12277                                 TO OC-CRED-BENE-NAME
 12278                 END-IF
 12279                 IF NOT CERT-TRL-REC-NOT-FOUND
 12280                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12281                           OC-INS-AGE-DEFAULT-FLAG
 12282                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12283                           OC-JNT-AGE-DEFAULT-FLAG
 12284                 END-IF
 12285
 12286* EXEC CICS REWRITE
 12287*                   DATASET   ('ELCRTO')
 12288*                   FROM      (ORIGINAL-CERTIFICATE)
 12289*                   RESP      (WS-RESPONSE)
 12290*                END-EXEC
 12291     MOVE LENGTH OF
 12292      ORIGINAL-CERTIFICATE
 12293       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 224
* EL6311.cbl
 12294     MOVE 'ELCRTO' TO DFHEIV1
 12295*    MOVE '&& L                  %  N#00011781' TO DFHEIV0
 12296     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12297     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12298     MOVE X'204E233030303131373831' TO DFHEIV0(25:11)
 12299     CALL 'kxdfhei1' USING DFHEIV0,
 12300           DFHEIV1,
 12301           ORIGINAL-CERTIFICATE,
 12302           DFHEIV11,
 12303           DFHEIV99
 12304     MOVE EIBRESP  TO WS-RESPONSE
 12305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12306                 display ' just rewrote ' ws-response
 12307              END-IF
 12308           END-IF
 12309        ELSE
 12310           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12311           MOVE 'OC'             TO OC-RECORD-ID
 12312           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12313           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12314           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12315           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12316           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12317           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12318           MOVE PB-I-AGE         TO OC-INS-AGE
 12319           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12320           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12321           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12322           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12323           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12324           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12325           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12326           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12327           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12328           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12329           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12330           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12331           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12332           MOVE +0               TO OC-LF-CANCEL-AMT
 12333                                    OC-LF-ITD-CANCEL-AMT
 12334           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12335           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12336           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12337           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12338           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12339           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12340           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12341           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12342           MOVE +0               TO OC-AH-CANCEL-AMT
 12343                                    OC-AH-ITD-CANCEL-AMT
 12344           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12345           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12346           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12347           IF ERMAIL-FOUND
 12348              MOVE MA-CRED-BENE-NAME
 12349                                 TO OC-CRED-BENE-NAME
 12350           END-IF
 12351           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 225
* EL6311.cbl
 12352              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12353                           OC-INS-AGE-DEFAULT-FLAG
 12354              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12355                           OC-JNT-AGE-DEFAULT-FLAG
 12356           END-IF
 12357           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12358
 12359* EXEC CICS WRITE
 12360*             DATASET   ('ELCRTO')
 12361*             FROM      (ORIGINAL-CERTIFICATE)
 12362*             RIDFLD    (OC-CONTROL-PRIMARY)
 12363*             RESP      (WS-RESPONSE)
 12364*          END-EXEC
 12365     MOVE LENGTH OF
 12366      ORIGINAL-CERTIFICATE
 12367       TO DFHEIV11
 12368     MOVE 'ELCRTO' TO DFHEIV1
 12369*    MOVE '&$ L                  ''  N#00011838' TO DFHEIV0
 12370     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12372     MOVE X'204E233030303131383338' TO DFHEIV0(25:11)
 12373     CALL 'kxdfhei1' USING DFHEIV0,
 12374           DFHEIV1,
 12375           ORIGINAL-CERTIFICATE,
 12376           DFHEIV11,
 12377           OC-CONTROL-PRIMARY,
 12378           DFHEIV99,
 12379           DFHEIV99
 12380     MOVE EIBRESP  TO WS-RESPONSE
 12381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12382        END-IF
 12383     ELSE
 12384        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12385        MOVE 'OC'                TO OC-RECORD-ID
 12386        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12387                                 TO OC-CONTROL-PRIMARY (1:33)
 12388        MOVE 'I'                 TO OC-RECORD-TYPE
 12389        MOVE +4096               TO OC-KEY-SEQ-NO
 12390        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12391        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12392        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12393        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12394        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12395        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12396        MOVE PB-I-AGE            TO OC-INS-AGE
 12397        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12398        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12399        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12400        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12401        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12402        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12403        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12404        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12405        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12406        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12407        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12408        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12409        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 226
* EL6311.cbl
 12410        MOVE +0                  TO OC-LF-CANCEL-AMT
 12411                                    OC-LF-ITD-CANCEL-AMT
 12412        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12413        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12414        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12415        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12416        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12417        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12418        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12419        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12420        MOVE +0                  TO OC-AH-CANCEL-AMT
 12421                                    OC-AH-ITD-CANCEL-AMT
 12422        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12423        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12424        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12425        IF ERMAIL-FOUND
 12426           MOVE MA-CRED-BENE-NAME
 12427                                 TO OC-CRED-BENE-NAME
 12428        END-IF
 12429        IF NOT CERT-TRL-REC-NOT-FOUND
 12430           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12431                           OC-INS-AGE-DEFAULT-FLAG
 12432           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12433                           OC-JNT-AGE-DEFAULT-FLAG
 12434        END-IF
 12435        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12436
 12437* EXEC CICS WRITE
 12438*          DATASET   ('ELCRTO')
 12439*          FROM      (ORIGINAL-CERTIFICATE)
 12440*          RIDFLD    (OC-CONTROL-PRIMARY)
 12441*          RESP      (WS-RESPONSE)
 12442*       END-EXEC
 12443     MOVE LENGTH OF
 12444      ORIGINAL-CERTIFICATE
 12445       TO DFHEIV11
 12446     MOVE 'ELCRTO' TO DFHEIV1
 12447*    MOVE '&$ L                  ''  N#00011898' TO DFHEIV0
 12448     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12450     MOVE X'204E233030303131383938' TO DFHEIV0(25:11)
 12451     CALL 'kxdfhei1' USING DFHEIV0,
 12452           DFHEIV1,
 12453           ORIGINAL-CERTIFICATE,
 12454           DFHEIV11,
 12455           OC-CONTROL-PRIMARY,
 12456           DFHEIV99,
 12457           DFHEIV99
 12458     MOVE EIBRESP  TO WS-RESPONSE
 12459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12460     END-IF
 12461******************************************************************
 12462*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12463******************************************************************
 12464
 12465     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12466     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12467
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 227
* EL6311.cbl
 12468
 12469* EXEC CICS READ
 12470*        INTO    (PENDING-BUSINESS)
 12471*        DATASET (FILE-ID-ERPNDB)
 12472*        RIDFLD  (ERPNDB-KEY)
 12473*        UPDATE
 12474*    END-EXEC.
 12475     MOVE LENGTH OF
 12476      PENDING-BUSINESS
 12477       TO DFHEIV11
 12478*    MOVE '&"IL       EU         (   #00011912' TO DFHEIV0
 12479     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12480     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12481     MOVE X'2020233030303131393132' TO DFHEIV0(25:11)
 12482     CALL 'kxdfhei1' USING DFHEIV0,
 12483           FILE-ID-ERPNDB,
 12484           PENDING-BUSINESS,
 12485           DFHEIV11,
 12486           ERPNDB-KEY,
 12487           DFHEIV99,
 12488           DFHEIV99,
 12489           DFHEIV99
 12490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12491
 12492
 12493     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12494     MOVE 'B'                    TO JP-RECORD-TYPE.
 12495     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12496
 12497     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12498
 12499     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12500
 12501     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12502
 12503     MOVE 'C'                    TO JP-RECORD-TYPE.
 12504     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12505
 12506
 12507* EXEC CICS REWRITE
 12508*        DATASET    (FILE-ID-ERPNDB)
 12509*        FROM       (PENDING-BUSINESS)
 12510*    END-EXEC.
 12511     MOVE LENGTH OF
 12512      PENDING-BUSINESS
 12513       TO DFHEIV11
 12514*    MOVE '&& L                  %   #00011932' TO DFHEIV0
 12515     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12516     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12517     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0,
 12519           FILE-ID-ERPNDB,
 12520           PENDING-BUSINESS,
 12521           DFHEIV11,
 12522           DFHEIV99
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 228
* EL6311.cbl
 12526     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12527
 12528     IF WS-ERRORS-PRESENT
 12529        GO TO 3900-RE-DISPLAY-RECORD.
 12530
 12531     MOVE ZEROS                  TO EMI-ERROR.
 12532     MOVE -1                     TO BMAINTL.
 12533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12534     GO TO 3900-RE-DISPLAY-RECORD.
 12535
 12536 1380-BATCH-HDR-NOT-FOUND.
 12537     MOVE -1                     TO BMAINTL.
 12538     MOVE ER-7450                TO EMI-ERROR.
 12539     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12540     GO TO 8200-SEND-DATAONLY.
 12541
 12542 1385-REC-NOT-FOUND.
 12543     MOVE -1                     TO BMAINTL.
 12544     MOVE ER-7451                TO EMI-ERROR.
 12545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12546     GO TO 8200-SEND-DATAONLY.
 12547
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 229
* EL6311.cbl
 12549
 12550 1386-UPDATE-AGE-FLAGS.
 12551
 12552
 12553* EXEC CICS GETMAIN
 12554*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12555*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12556*        INITIMG (GETMAIN-SPACE)
 12557*    END-EXEC
 12558*    MOVE ',"IL                  $   #00011963' TO DFHEIV0
 12559     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12561     MOVE X'2020233030303131393633' TO DFHEIV0(25:11)
 12562     CALL 'kxdfhei1' USING DFHEIV0,
 12563           DFHEIV20,
 12564           ELCRTT-RECORD-LENGTH,
 12565           GETMAIN-SPACE
 12566     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12567         DFHEIV20
 12568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12569
 12570
 12571* EXEC CICS HANDLE CONDITION
 12572*        NOTFND   (1386-NOTFND)
 12573*    END-EXEC.
 12574*    MOVE '"$I                   ! ( #00011969' TO DFHEIV0
 12575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12577     MOVE X'2820233030303131393639' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12583     MOVE 'C'                TO ELCRTT-REC-TYPE
 12584
 12585
 12586* EXEC CICS READ
 12587*        UPDATE
 12588*        DATASET  (CRTT-ID)
 12589*        RIDFLD   (ELCRTT-KEY)
 12590*        INTO     (CERTIFICATE-TRAILERS)
 12591*    END-EXEC.
 12592     MOVE LENGTH OF
 12593      CERTIFICATE-TRAILERS
 12594       TO DFHEIV11
 12595*    MOVE '&"IL       EU         (   #00011976' TO DFHEIV0
 12596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12598     MOVE X'2020233030303131393736' TO DFHEIV0(25:11)
 12599     CALL 'kxdfhei1' USING DFHEIV0,
 12600           CRTT-ID,
 12601           CERTIFICATE-TRAILERS,
 12602           DFHEIV11,
 12603           ELCRTT-KEY,
 12604           DFHEIV99,
 12605           DFHEIV99,
 12606           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 230
* EL6311.cbl
 12607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12608
 12609
 12610     IF WS-INS-AGE-SET = 'Y'
 12611        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12612     END-IF
 12613     IF WS-JNT-AGE-SET = 'Y'
 12614        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12615     END-IF
 12616
 12617
 12618* EXEC CICS REWRITE
 12619*       DATASET  (CRTT-ID)
 12620*       FROM     (CERTIFICATE-TRAILERS)
 12621*    END-EXEC.
 12622     MOVE LENGTH OF
 12623      CERTIFICATE-TRAILERS
 12624       TO DFHEIV11
 12625*    MOVE '&& L                  %   #00011990' TO DFHEIV0
 12626     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12627     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12628     MOVE X'2020233030303131393930' TO DFHEIV0(25:11)
 12629     CALL 'kxdfhei1' USING DFHEIV0,
 12630           CRTT-ID,
 12631           CERTIFICATE-TRAILERS,
 12632           DFHEIV11,
 12633           DFHEIV99
 12634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12635
 12636
 12637     GO TO 1386-EXIT.
 12638
 12639 1386-NOTFND.
 12640
 12641     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12642     MOVE 'CS'         TO CS-RECORD-ID.
 12643     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12644     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12645     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12646     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12647     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12648
 12649* EXEC CICS WRITE
 12650*       DATASET  (CRTT-ID)
 12651*       RIDFLD   (ELCRTT-KEY)
 12652*       FROM     (CERTIFICATE-TRAILERS)
 12653*    END-EXEC.
 12654     MOVE LENGTH OF
 12655      CERTIFICATE-TRAILERS
 12656       TO DFHEIV11
 12657*    MOVE '&$ L                  ''   #00012006' TO DFHEIV0
 12658     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12660     MOVE X'2020233030303132303036' TO DFHEIV0(25:11)
 12661     CALL 'kxdfhei1' USING DFHEIV0,
 12662           CRTT-ID,
 12663           CERTIFICATE-TRAILERS,
 12664           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 231
* EL6311.cbl
 12665           ELCRTT-KEY,
 12666           DFHEIV99,
 12667           DFHEIV99
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670
 12671 1386-EXIT.
 12672     EXIT.
 12673
 12674 1390-UPDATE-ERPNDM.
 12675
 12676
 12677* EXEC CICS HANDLE CONDITION
 12678*        NOTFND (1399-EXIT)
 12679*    END-EXEC.
 12680*    MOVE '"$I                   ! ) #00012017' TO DFHEIV0
 12681     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12683     MOVE X'2920233030303132303137' TO DFHEIV0(25:11)
 12684     CALL 'kxdfhei1' USING DFHEIV0
 12685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12686
 12687
 12688     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12689
 12690
 12691* EXEC CICS READ
 12692*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12693*        DATASET (FILE-ID-ERPNDM)
 12694*        RIDFLD  (ERPNDM-KEY)
 12695*        UPDATE
 12696*    END-EXEC.
 12697*    MOVE '&"S        EU         (   #00012023' TO DFHEIV0
 12698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12700     MOVE X'2020233030303132303233' TO DFHEIV0(25:11)
 12701     CALL 'kxdfhei1' USING DFHEIV0,
 12702           FILE-ID-ERPNDM,
 12703           DFHEIV20,
 12704           DFHEIV99,
 12705           ERPNDM-KEY,
 12706           DFHEIV99,
 12707           DFHEIV99,
 12708           DFHEIV99
 12709     SET ADDRESS OF PENDING-MAILING-DATA TO
 12710         DFHEIV20
 12711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12712
 12713
 12714     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12715     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12716     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12717
 12718     IF BLSTNML GREATER THAN ZEROS
 12719         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12720
 12721     IF B1STNML GREATER  THAN ZEROS
 12722         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 232
* EL6311.cbl
 12723
 12724     IF BINITL GREATER THAN ZEROS
 12725         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12726
 12727     IF BAGEL GREATER THAN ZEROS
 12728         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12729
 12730     IF BBIRTHL GREATER THAN ZEROS
 12731         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12732
 12733     IF BSEXL GREATER THAN ZEROS
 12734         MOVE  BSEXI             TO PM-INSURED-SEX.
 12735
 12736
 12737* EXEC CICS REWRITE
 12738*        DATASET (FILE-ID-ERPNDM)
 12739*        FROM    (PENDING-MAILING-DATA)
 12740*    END-EXEC.
 12741     MOVE LENGTH OF
 12742      PENDING-MAILING-DATA
 12743       TO DFHEIV11
 12744*    MOVE '&& L                  %   #00012052' TO DFHEIV0
 12745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12747     MOVE X'2020233030303132303532' TO DFHEIV0(25:11)
 12748     CALL 'kxdfhei1' USING DFHEIV0,
 12749           FILE-ID-ERPNDM,
 12750           PENDING-MAILING-DATA,
 12751           DFHEIV11,
 12752           DFHEIV99
 12753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12754
 12755
 12756 1399-EXIT.
 12757     EXIT.
 12758 139A-SET-LETTER-REQD.
 12759*  COMPARE BEFORE AND AFTER CHANGE
 12760     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12761        GO TO 139A-EXIT
 12762     END-IF
 12763
 12764*  READ ELCRTO
 12765     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12766                                 TO ELCRTO-KEY
 12767     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12768     MOVE +0                     TO ELCRTO-SEQ-NO
 12769
 12770
 12771* EXEC CICS READ
 12772*       DATASET   ('ELCRTO')
 12773*       INTO      (ORIGINAL-CERTIFICATE)
 12774*       RIDFLD    (ELCRTO-KEY)
 12775*       GTEQ
 12776*       RESP      (WS-RESPONSE)
 12777*    END-EXEC
 12778     MOVE LENGTH OF
 12779      ORIGINAL-CERTIFICATE
 12780       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 233
* EL6311.cbl
 12781     MOVE 'ELCRTO' TO DFHEIV1
 12782*    MOVE '&"IL       G          (  N#00012071' TO DFHEIV0
 12783     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12785     MOVE X'204E233030303132303731' TO DFHEIV0(25:11)
 12786     CALL 'kxdfhei1' USING DFHEIV0,
 12787           DFHEIV1,
 12788           ORIGINAL-CERTIFICATE,
 12789           DFHEIV11,
 12790           ELCRTO-KEY,
 12791           DFHEIV99,
 12792           DFHEIV99,
 12793           DFHEIV99
 12794     MOVE EIBRESP  TO WS-RESPONSE
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12796
 12797*    display ' just read gteq ' ws-response
 12798     IF RESP-NORMAL
 12799        AND (OC-CONTROL-PRIMARY (1:33) =
 12800                 PB-CONTROL-BY-ACCOUNT (1:33))
 12801        AND (OC-RECORD-TYPE = 'I')
 12802*      compare individual fields
 12803        IF LETRREQL   GREATER THAN ZEROS
 12804           CONTINUE
 12805        ELSE
 12806        IF OC-CERT-NO = PB-CERT-NO
 12807          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12808          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12809          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12810          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12811          AND OC-INS-AGE = PB-I-AGE
 12812          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12813          AND OC-LF-TERM = PB-I-LF-TERM
 12814          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12815          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12816          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12817          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12818          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12819          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12820          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12821          AND PB-I-AH-TERM           = OC-AH-TERM
 12822          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12823          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12824          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12825          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12826          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12827           MOVE SPACE TO PB-I-LETTER-REQD
 12828        ELSE
 12829           MOVE 'Y' TO PB-I-LETTER-REQD
 12830        END-IF
 12831     END-IF.
 12832
 12833 139A-EXIT.
 12834     EXIT.
 12835
 12836******************************************************************
 12837*                                                                *
 12838*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 234
* EL6311.cbl
 12839*                                                                *
 12840******************************************************************
 12841
 12842 1400-DELETE-ISSUE-ROUTINE.
 12843     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12844
 12845     IF BCHGL NOT = ZEROS
 12846        MOVE ER-2196             TO EMI-ERROR
 12847        MOVE AL-UABON            TO BMAINTA
 12848        MOVE -1                  TO BMAINTL
 12849        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12850        GO TO 8200-SEND-DATAONLY.
 12851
 12852
 12853* EXEC CICS HANDLE CONDITION
 12854*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12855*    END-EXEC.
 12856*    MOVE '"$I                   ! * #00012134' TO DFHEIV0
 12857     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12859     MOVE X'2A20233030303132313334' TO DFHEIV0(25:11)
 12860     CALL 'kxdfhei1' USING DFHEIV0
 12861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12862
 12863
 12864     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12865     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12866     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12867
 12868
 12869* EXEC CICS READ
 12870*        SET     (ADDRESS OF PENDING-BUSINESS)
 12871*        DATASET (FILE-ID-ERPNDB)
 12872*        RIDFLD  (ERPNDB-KEY)
 12873*    END-EXEC.
 12874*    MOVE '&"S        E          (   #00012142' TO DFHEIV0
 12875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12877     MOVE X'2020233030303132313432' TO DFHEIV0(25:11)
 12878     CALL 'kxdfhei1' USING DFHEIV0,
 12879           FILE-ID-ERPNDB,
 12880           DFHEIV20,
 12881           DFHEIV99,
 12882           ERPNDB-KEY,
 12883           DFHEIV99,
 12884           DFHEIV99,
 12885           DFHEIV99
 12886     SET ADDRESS OF PENDING-BUSINESS TO
 12887         DFHEIV20
 12888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12889
 12890
 12891     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12892
 12893     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12894
 12895     IF BSUFIXL NOT = ZEROS
 12896        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 235
* EL6311.cbl
 12897     ELSE
 12898        MOVE SPACE               TO WS-NEW-SUFFIX.
 12899
 12900     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12901     PERFORM 8600-DEEDIT.
 12902     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12903     MOVE '4'                    TO DC-OPTION-CODE.
 12904     PERFORM 9700-DATE-LINK.
 12905     IF DATE-CONVERSION-ERROR
 12906        MOVE ER-0348             TO EMI-ERROR
 12907        MOVE -1                  TO BEFFDTL
 12908        MOVE AL-UABON            TO BEFFDTA
 12909        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12910        GO TO 8200-SEND-DATAONLY
 12911     ELSE
 12912        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12913        MOVE AL-UANON            TO BEFFDTA
 12914        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12915
 12916
 12917* EXEC CICS HANDLE CONDITION
 12918*         NOTFND    (1490-RECORD-NOT-FOUND)
 12919*    END-EXEC.
 12920*    MOVE '"$I                   ! + #00012173' TO DFHEIV0
 12921     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12923     MOVE X'2B20233030303132313733' TO DFHEIV0(25:11)
 12924     CALL 'kxdfhei1' USING DFHEIV0
 12925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12926
 12927
 12928
 12929* EXEC CICS READ
 12930*        SET     (ADDRESS OF PENDING-BUSINESS)
 12931*        DATASET (FILE-ID-ERPNDB)
 12932*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12933*        UPDATE
 12934*    END-EXEC.
 12935*    MOVE '&"S        EU         (   #00012177' TO DFHEIV0
 12936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12938     MOVE X'2020233030303132313737' TO DFHEIV0(25:11)
 12939     CALL 'kxdfhei1' USING DFHEIV0,
 12940           FILE-ID-ERPNDB,
 12941           DFHEIV20,
 12942           DFHEIV99,
 12943           PI-PREV-CONTROL-PRIMARY,
 12944           DFHEIV99,
 12945           DFHEIV99,
 12946           DFHEIV99
 12947     SET ADDRESS OF PENDING-BUSINESS TO
 12948         DFHEIV20
 12949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12950
 12951
 12952     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12953        MOVE -1                 TO BMAINTL
 12954        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 236
* EL6311.cbl
 12955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12956        GO TO 8200-SEND-DATAONLY.
 12957
 12958     IF PB-BILLED-DT NOT = LOW-VALUES
 12959        MOVE -1                 TO BMAINTL
 12960        MOVE ER-2129            TO EMI-ERROR
 12961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12962        GO TO 8200-SEND-DATAONLY.
 12963
 12964     IF PB-CHG-COUNT NOT = ZEROS
 12965        MOVE ER-2336            TO EMI-ERROR
 12966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12967        MOVE AL-UABON            TO BMAINTA
 12968        MOVE -1                  TO BMAINTL
 12969        GO TO 8200-SEND-DATAONLY.
 12970
 12971     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12972        PB-CHG-COUNT NOT = ZEROS
 12973        MOVE ER-2196             TO EMI-ERROR
 12974        MOVE AL-UABON            TO BMAINTA
 12975        MOVE -1                  TO BMAINTL
 12976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12977        GO TO 8200-SEND-DATAONLY.
 12978******************************************************************
 12979*                                                                *
 12980*       Determine if this is a dup and we should allow the       *
 12981*       user to delete the pending issue record only.            *
 12982*                                                                *
 12983******************************************************************
 12984     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12985                                 TO ELCERT-KEY
 12986
 12987* EXEC CICS READ
 12988*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12989*        DATASET (FILE-ID-ELCERT)
 12990*        RIDFLD  (ELCERT-KEY)
 12991*        RESP    (WS-RESPONSE)
 12992*    END-EXEC
 12993*    MOVE '&"S        E          (  N#00012218' TO DFHEIV0
 12994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12995     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12996     MOVE X'204E233030303132323138' TO DFHEIV0(25:11)
 12997     CALL 'kxdfhei1' USING DFHEIV0,
 12998           FILE-ID-ELCERT,
 12999           DFHEIV20,
 13000           DFHEIV99,
 13001           ELCERT-KEY,
 13002           DFHEIV99,
 13003           DFHEIV99,
 13004           DFHEIV99
 13005     SET ADDRESS OF CERTIFICATE-MASTER TO
 13006         DFHEIV20
 13007     MOVE EIBRESP  TO WS-RESPONSE
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13009     if (resp-normal)
 13010        and (cert-added-batch)
 13011        and (valid-cm-id)
 13012        go to 1420-CONTINUE-DELETE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 237
* EL6311.cbl
 13013     end-if
 13014******************************************************************
 13015*                                                                *
 13016*       Determine if there have been any checks created          *
 13017*                                                                *
 13018******************************************************************
 13019
 13020     perform 2500-browse-checks  thru 2500-exit
 13021
 13022     if i-have-processed-checks
 13023        or i-have-checks
 13024        or i-have-a-check-period
 13025        move er-3446             to emi-error
 13026        perform 9900-error-format thru 9900-exit
 13027        move al-uabon            to bmainta
 13028        move -1                  to bmaintl
 13029        go to 8200-send-dataonly
 13030     end-if
 13031******************************************************************
 13032*                                                                *
 13033*       DELETE ORIGINAL CERTIFICATE INFO                         *
 13034*                                                                *
 13035******************************************************************
 13036     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 13037     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 13038     MOVE +0                     TO ELCRTO-SEQ-NO
 13039
 13040* EXEC CICS READ
 13041*       DATASET   ('ELCRTO')
 13042*       INTO      (ORIGINAL-CERTIFICATE)
 13043*       RIDFLD    (ELCRTO-KEY)
 13044*       GTEQ
 13045*       RESP      (WS-RESPONSE)
 13046*    END-EXEC
 13047     MOVE LENGTH OF
 13048      ORIGINAL-CERTIFICATE
 13049       TO DFHEIV11
 13050     MOVE 'ELCRTO' TO DFHEIV1
 13051*    MOVE '&"IL       G          (  N#00012254' TO DFHEIV0
 13052     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13054     MOVE X'204E233030303132323534' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           DFHEIV1,
 13057           ORIGINAL-CERTIFICATE,
 13058           DFHEIV11,
 13059           ELCRTO-KEY,
 13060           DFHEIV99,
 13061           DFHEIV99,
 13062           DFHEIV99
 13063     MOVE EIBRESP  TO WS-RESPONSE
 13064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13065     IF RESP-NORMAL
 13066        AND (OC-CONTROL-PRIMARY (1:33) =
 13067                 PB-CONTROL-BY-ACCOUNT (1:33))
 13068        AND (OC-RECORD-TYPE = 'I')
 13069
 13070* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 238
* EL6311.cbl
 13071*          DATASET   ('ELCRTO')
 13072*          INTO      (ORIGINAL-CERTIFICATE)
 13073*          RIDFLD    (ELCRTO-KEY)
 13074*          UPDATE
 13075*          RESP      (WS-RESPONSE)
 13076*       END-EXEC
 13077     MOVE LENGTH OF
 13078      ORIGINAL-CERTIFICATE
 13079       TO DFHEIV11
 13080     MOVE 'ELCRTO' TO DFHEIV1
 13081*    MOVE '&"IL       EU         (  N#00012265' TO DFHEIV0
 13082     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13083     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13084     MOVE X'204E233030303132323635' TO DFHEIV0(25:11)
 13085     CALL 'kxdfhei1' USING DFHEIV0,
 13086           DFHEIV1,
 13087           ORIGINAL-CERTIFICATE,
 13088           DFHEIV11,
 13089           ELCRTO-KEY,
 13090           DFHEIV99,
 13091           DFHEIV99,
 13092           DFHEIV99
 13093     MOVE EIBRESP  TO WS-RESPONSE
 13094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13095        IF RESP-NORMAL
 13096
 13097* EXEC CICS DELETE
 13098*             DATASET   ('ELCRTO')
 13099*          END-EXEC
 13100     MOVE 'ELCRTO' TO DFHEIV1
 13101*    MOVE '&(                    &   #00012273' TO DFHEIV0
 13102     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303132323733' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           DFHEIV1,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99
 13111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13112        END-IF
 13113     END-IF
 13114******************************************************************
 13115*                                                                *
 13116*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13117*                                                                *
 13118******************************************************************
 13119
 13120* EXEC CICS HANDLE CONDITION
 13121*        NOTFND    (1405-DELETE-CERTIFICATE)
 13122*    END-EXEC.
 13123*    MOVE '"$I                   ! , #00012283' TO DFHEIV0
 13124     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13126     MOVE X'2C20233030303132323833' TO DFHEIV0(25:11)
 13127     CALL 'kxdfhei1' USING DFHEIV0
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 239
* EL6311.cbl
 13129
 13130
 13131
 13132* EXEC CICS READ
 13133*        EQUAL
 13134*        DATASET   (FILE-ID-ERPNDM)
 13135*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13136*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13137*        UPDATE
 13138*    END-EXEC.
 13139*    MOVE '&"S        EU         (   #00012287' TO DFHEIV0
 13140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13141     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13142     MOVE X'2020233030303132323837' TO DFHEIV0(25:11)
 13143     CALL 'kxdfhei1' USING DFHEIV0,
 13144           FILE-ID-ERPNDM,
 13145           DFHEIV20,
 13146           DFHEIV99,
 13147           PI-PREV-CONTROL-PRIMARY,
 13148           DFHEIV99,
 13149           DFHEIV99,
 13150           DFHEIV99
 13151     SET ADDRESS OF PENDING-MAILING-DATA TO
 13152         DFHEIV20
 13153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13154
 13155
 13156     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13157     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13158     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13159
 13160     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13161
 13162
 13163* EXEC CICS DELETE
 13164*        DATASET   (FILE-ID-ERPNDM)
 13165*    END-EXEC.
 13166*    MOVE '&(                    &   #00012301' TO DFHEIV0
 13167     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13169     MOVE X'2020233030303132333031' TO DFHEIV0(25:11)
 13170     CALL 'kxdfhei1' USING DFHEIV0,
 13171           FILE-ID-ERPNDM,
 13172           DFHEIV99,
 13173           DFHEIV99,
 13174           DFHEIV99,
 13175           DFHEIV99
 13176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13177
 13178
 13179******************************************************************
 13180*                PROCESS   CERTIFICATE                           *
 13181******************************************************************
 13182
 13183 1405-DELETE-CERTIFICATE.
 13184
 13185* EXEC CICS HANDLE CONDITION
 13186*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 240
* EL6311.cbl
 13187*    END-EXEC.
 13188*    MOVE '"$I                   ! - #00012310' TO DFHEIV0
 13189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13191     MOVE X'2D20233030303132333130' TO DFHEIV0(25:11)
 13192     CALL 'kxdfhei1' USING DFHEIV0
 13193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13194
 13195
 13196     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13197     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13198     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13199     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13200
 13201
 13202* EXEC CICS READ
 13203*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13204*        DATASET (FILE-ID-ELCERT)
 13205*        RIDFLD  (ELCERT-KEY)
 13206*        UPDATE
 13207*    END-EXEC.
 13208*    MOVE '&"S        EU         (   #00012319' TO DFHEIV0
 13209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13210     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13211     MOVE X'2020233030303132333139' TO DFHEIV0(25:11)
 13212     CALL 'kxdfhei1' USING DFHEIV0,
 13213           FILE-ID-ELCERT,
 13214           DFHEIV20,
 13215           DFHEIV99,
 13216           ELCERT-KEY,
 13217           DFHEIV99,
 13218           DFHEIV99,
 13219           DFHEIV99
 13220     SET ADDRESS OF CERTIFICATE-MASTER TO
 13221         DFHEIV20
 13222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13223
 13224
 13225     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13226
 13227     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13228     MOVE 'B'                    TO JP-RECORD-TYPE
 13229     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13230
 13231     PERFORM 8400-LOG-JOURNAL-RECORD.
 13232
 13233     IF CERT-NOTES-ARE-NOT-PRESENT
 13234        MOVE ' '                 TO WS-CERT-NOTE-SW
 13235     ELSE
 13236        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13237
 13238     IF INSURED-ADDR-PRESENT
 13239        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13240
 13241******************************************************************
 13242******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13243******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13244******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 241
* EL6311.cbl
 13245******************************************************************
 13246
 13247     IF CERT-ADDED-BATCH AND
 13248        (NOT NO-CLAIM-ATTACHED
 13249         OR
 13250         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13251        GO TO 1410-REWRITE-CERT.
 13252
 13253******************************************************************
 13254******************************************************************
 13255
 13256     IF CERT-ADDED-BATCH  AND
 13257        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13258        GO TO 1410-REWRITE-CERT.
 13259
 13260     IF NO-CLAIM-ATTACHED
 13261        NEXT SENTENCE
 13262     ELSE
 13263        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13264        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13265        GO TO 1410-REWRITE-CERT.
 13266
 13267     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13268     MOVE 'D'                      TO JP-RECORD-TYPE.
 13269     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13270
 13271
 13272* EXEC CICS DELETE
 13273*         DATASET    (FILE-ID-ELCERT)
 13274*    END-EXEC.
 13275*    MOVE '&(                    &   #00012372' TO DFHEIV0
 13276     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13278     MOVE X'2020233030303132333732' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           FILE-ID-ELCERT,
 13281           DFHEIV99,
 13282           DFHEIV99,
 13283           DFHEIV99,
 13284           DFHEIV99
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287
 13288     PERFORM 8400-LOG-JOURNAL-RECORD.
 13289
 13290******************************************************************
 13291*                                                                *
 13292*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13293*                                                                *
 13294******************************************************************
 13295
 13296     IF  CERT-NOTES-ARE-PRESENT
 13297         NEXT SENTENCE
 13298     ELSE
 13299         GO TO 1407-DELETE-MAILING.
 13300
 13301
 13302* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 242
* EL6311.cbl
 13303*         NOTFND  (1406-DELETE-ERNOTE)
 13304*    END-EXEC.
 13305*    MOVE '"$I                   ! . #00012389' TO DFHEIV0
 13306     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13308     MOVE X'2E20233030303132333839' TO DFHEIV0(25:11)
 13309     CALL 'kxdfhei1' USING DFHEIV0
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13311
 13312
 13313     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13314     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13315     MOVE 0                     TO ERCNOT-SEQUENCE.
 13316
 13317 1406-DELETE-ERCNOT-LOOP.
 13318
 13319
 13320* EXEC CICS READ
 13321*        GTEQ
 13322*        DATASET   (FILE-ID-ERCNOT)
 13323*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13324*        RIDFLD    (ERCNOT-KEY)
 13325*    END-EXEC.
 13326*    MOVE '&"S        G          (   #00012399' TO DFHEIV0
 13327     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13329     MOVE X'2020233030303132333939' TO DFHEIV0(25:11)
 13330     CALL 'kxdfhei1' USING DFHEIV0,
 13331           FILE-ID-ERCNOT,
 13332           DFHEIV20,
 13333           DFHEIV99,
 13334           ERCNOT-KEY,
 13335           DFHEIV99,
 13336           DFHEIV99,
 13337           DFHEIV99
 13338     SET ADDRESS OF CERT-NOTE-FILE TO
 13339         DFHEIV20
 13340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13341
 13342
 13343     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13344     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13345         GO TO 1406-DELETE-ERNOTE
 13346     END-IF.
 13347
 13348     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13349     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13350     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13351
 13352     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13353
 13354
 13355* EXEC CICS DELETE
 13356*        DATASET   (FILE-ID-ERCNOT)
 13357*        RIDFLD    (ERCNOT-KEY)
 13358*        END-EXEC.
 13359*    MOVE '&(  R                 &   #00012417' TO DFHEIV0
 13360     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 243
* EL6311.cbl
 13361     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13362     MOVE X'2020233030303132343137' TO DFHEIV0(25:11)
 13363     CALL 'kxdfhei1' USING DFHEIV0,
 13364           FILE-ID-ERCNOT,
 13365           ERCNOT-KEY,
 13366           DFHEIV99,
 13367           DFHEIV99,
 13368           DFHEIV99
 13369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13370
 13371
 13372     PERFORM 8400-LOG-JOURNAL-RECORD.
 13373
 13374     GO TO 1406-DELETE-ERCNOT-LOOP.
 13375
 13376 1406-DELETE-ERNOTE.
 13377
 13378
 13379* EXEC CICS HANDLE CONDITION
 13380*         NOTFND  (1407-DELETE-MAILING)
 13381*    END-EXEC.
 13382*    MOVE '"$I                   ! / #00012428' TO DFHEIV0
 13383     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13385     MOVE X'2F20233030303132343238' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13388
 13389
 13390*    EXEC CICS READ
 13391*        EQUAL
 13392*        DATASET   (FILE-ID-ERNOTE)
 13393*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13394*        RIDFLD    (ELCERT-KEY)
 13395*        UPDATE
 13396*    END-EXEC.
 13397
 13398     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13399     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13400     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13401
 13402     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13403
 13404
 13405* exec cics delete
 13406*       dataset       ('ERNOTE')
 13407*       keylength     (33)
 13408*       ridfld        (elcert-key)
 13409*       generic
 13410*    end-exec
 13411     MOVE 'ERNOTE' TO DFHEIV1
 13412     MOVE 33
 13413       TO DFHEIV11
 13414*    MOVE '&(  RKG               &   #00012446' TO DFHEIV0
 13415     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
 13416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13417     MOVE X'2020233030303132343436' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 244
* EL6311.cbl
 13419           DFHEIV1,
 13420           elcert-key,
 13421           DFHEIV11,
 13422           DFHEIV99,
 13423           DFHEIV99
 13424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13425*    EXEC CICS DELETE
 13426*        DATASET   (FILE-ID-ERNOTE)
 13427*        END-EXEC.
 13428
 13429     PERFORM 8400-LOG-JOURNAL-RECORD.
 13430
 13431******************************************************************
 13432*                                                                *
 13433*                DELETE MAILING ADDRESS RECORDS                  *
 13434*                                                                *
 13435******************************************************************
 13436
 13437 1407-DELETE-MAILING.
 13438     IF CERT-ADDRESS-PRESENT
 13439        NEXT SENTENCE
 13440     ELSE
 13441        GO TO 1420-CONTINUE-DELETE.
 13442
 13443
 13444* EXEC CICS HANDLE CONDITION
 13445*         NOTFND  (1420-CONTINUE-DELETE)
 13446*    END-EXEC.
 13447*    MOVE '"$I                   ! 0 #00012470' TO DFHEIV0
 13448     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13450     MOVE X'3020233030303132343730' TO DFHEIV0(25:11)
 13451     CALL 'kxdfhei1' USING DFHEIV0
 13452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13453
 13454
 13455
 13456* EXEC CICS READ
 13457*        EQUAL
 13458*        DATASET   (FILE-ID-ERMAIL)
 13459*        SET       (ADDRESS OF MAILING-DATA)
 13460*        RIDFLD    (ELCERT-KEY)
 13461*        UPDATE
 13462*    END-EXEC.
 13463*    MOVE '&"S        EU         (   #00012474' TO DFHEIV0
 13464     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13466     MOVE X'2020233030303132343734' TO DFHEIV0(25:11)
 13467     CALL 'kxdfhei1' USING DFHEIV0,
 13468           FILE-ID-ERMAIL,
 13469           DFHEIV20,
 13470           DFHEIV99,
 13471           ELCERT-KEY,
 13472           DFHEIV99,
 13473           DFHEIV99,
 13474           DFHEIV99
 13475     SET ADDRESS OF MAILING-DATA TO
 13476         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 245
* EL6311.cbl
 13477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13478
 13479
 13480     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13481     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13482     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13483
 13484     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13485
 13486
 13487* EXEC CICS DELETE
 13488*        DATASET   (FILE-ID-ERMAIL)
 13489*    END-EXEC.
 13490*    MOVE '&(                    &   #00012488' TO DFHEIV0
 13491     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13493     MOVE X'2020233030303132343838' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           FILE-ID-ERMAIL,
 13496           DFHEIV99,
 13497           DFHEIV99,
 13498           DFHEIV99,
 13499           DFHEIV99
 13500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13501
 13502
 13503     GO TO 1420-CONTINUE-DELETE.
 13504
 13505 1410-REWRITE-CERT.
 13506     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13507     MOVE 'C'                      TO JP-RECORD-TYPE.
 13508     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13509     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13510
 13511
 13512* EXEC CICS REWRITE
 13513*         DATASET    (FILE-ID-ELCERT)
 13514*         FROM       (CERTIFICATE-MASTER)
 13515*         END-EXEC.
 13516     MOVE LENGTH OF
 13517      CERTIFICATE-MASTER
 13518       TO DFHEIV11
 13519*    MOVE '&& L                  %   #00012500' TO DFHEIV0
 13520     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13521     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13522     MOVE X'2020233030303132353030' TO DFHEIV0(25:11)
 13523     CALL 'kxdfhei1' USING DFHEIV0,
 13524           FILE-ID-ELCERT,
 13525           CERTIFICATE-MASTER,
 13526           DFHEIV11,
 13527           DFHEIV99
 13528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13529
 13530
 13531     PERFORM 8400-LOG-JOURNAL-RECORD.
 13532
 13533 1420-CONTINUE-DELETE.
 13534     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 246
* EL6311.cbl
 13535     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13536
 13537     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13538     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13539
 13540     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13541
 13542 1450-DELETE-PB-RECORD.
 13543     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13544     MOVE 'D'                      TO JP-RECORD-TYPE
 13545     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13546
 13547
 13548* EXEC CICS DELETE
 13549*        DATASET    (FILE-ID-ERPNDB)
 13550*    END-EXEC.
 13551*    MOVE '&(                    &   #00012521' TO DFHEIV0
 13552     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13554     MOVE X'2020233030303132353231' TO DFHEIV0(25:11)
 13555     CALL 'kxdfhei1' USING DFHEIV0,
 13556           FILE-ID-ERPNDB,
 13557           DFHEIV99,
 13558           DFHEIV99,
 13559           DFHEIV99,
 13560           DFHEIV99
 13561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13562
 13563
 13564     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13565
 13566     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13567
 13568     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13569     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13570     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13571
 13572
 13573* EXEC CICS HANDLE CONDITION
 13574*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13575*    END-EXEC.
 13576*    MOVE '"$I                   ! 1 #00012533' TO DFHEIV0
 13577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13579     MOVE X'3120233030303132353333' TO DFHEIV0(25:11)
 13580     CALL 'kxdfhei1' USING DFHEIV0
 13581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13582
 13583
 13584
 13585* EXEC CICS READ
 13586*        SET     (ADDRESS OF PENDING-BUSINESS)
 13587*        DATASET (FILE-ID-ERPNDB)
 13588*        RIDFLD  (ERPNDB-KEY)
 13589*        UPDATE
 13590*    END-EXEC.
 13591*    MOVE '&"S        EU         (   #00012537' TO DFHEIV0
 13592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 247
* EL6311.cbl
 13593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303132353337' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           FILE-ID-ERPNDB,
 13597           DFHEIV20,
 13598           DFHEIV99,
 13599           ERPNDB-KEY,
 13600           DFHEIV99,
 13601           DFHEIV99,
 13602           DFHEIV99
 13603     SET ADDRESS OF PENDING-BUSINESS TO
 13604         DFHEIV20
 13605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13606
 13607
 13608     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13609
 13610     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13611
 13612     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13613        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13614        MOVE 'D'                   TO JP-RECORD-TYPE
 13615        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13616
 13617* EXEC CICS DELETE
 13618*            DATASET    (FILE-ID-ERPNDB)
 13619*       END-EXEC
 13620*    MOVE '&(                    &   #00012552' TO DFHEIV0
 13621     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13623     MOVE X'2020233030303132353532' TO DFHEIV0(25:11)
 13624     CALL 'kxdfhei1' USING DFHEIV0,
 13625           FILE-ID-ERPNDB,
 13626           DFHEIV99,
 13627           DFHEIV99,
 13628           DFHEIV99,
 13629           DFHEIV99
 13630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13631        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13632     ELSE
 13633        MOVE 'B'                 TO JP-RECORD-TYPE
 13634        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13635        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13636        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13637        MOVE 'C'                 TO JP-RECORD-TYPE
 13638        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13639
 13640* EXEC CICS REWRITE
 13641*            DATASET    (FILE-ID-ERPNDB)
 13642*            FROM       (PENDING-BUSINESS)
 13643*       END-EXEC
 13644     MOVE LENGTH OF
 13645      PENDING-BUSINESS
 13646       TO DFHEIV11
 13647*    MOVE '&& L                  %   #00012563' TO DFHEIV0
 13648     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13649     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13650     MOVE X'2020233030303132353633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 248
* EL6311.cbl
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           FILE-ID-ERPNDB,
 13653           PENDING-BUSINESS,
 13654           DFHEIV11,
 13655           DFHEIV99
 13656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13657        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13658     end-if
 13659******************************************************************
 13660*                                                                *
 13661*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13662*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13663*                                                                *
 13664******************************************************************
 13665
 13666     IF NOT PI-AR-PROCESSING
 13667        GO TO 1475-DELETE-FINISHED.
 13668
 13669     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13670        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13671        NEXT SENTENCE
 13672     ELSE
 13673        GO TO 1475-DELETE-FINISHED.
 13674
 13675
 13676* EXEC CICS HANDLE CONDITION
 13677*         NOTFND    (1475-DELETE-FINISHED)
 13678*         END-EXEC.
 13679*    MOVE '"$I                   ! 2 #00012585' TO DFHEIV0
 13680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13682     MOVE X'3220233030303132353835' TO DFHEIV0(25:11)
 13683     CALL 'kxdfhei1' USING DFHEIV0
 13684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13685
 13686
 13687     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13688     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13689
 13690
 13691* EXEC CICS READ
 13692*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13693*        DATASET (FILE-ID-ERRQST)
 13694*        RIDFLD  (ERRQST-KEY)
 13695*        UPDATE
 13696*    END-EXEC.
 13697*    MOVE '&"S        EU         (   #00012592' TO DFHEIV0
 13698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13700     MOVE X'2020233030303132353932' TO DFHEIV0(25:11)
 13701     CALL 'kxdfhei1' USING DFHEIV0,
 13702           FILE-ID-ERRQST,
 13703           DFHEIV20,
 13704           DFHEIV99,
 13705           ERRQST-KEY,
 13706           DFHEIV99,
 13707           DFHEIV99,
 13708           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 249
* EL6311.cbl
 13709     SET ADDRESS OF AR-REQUEST-RECORD TO
 13710         DFHEIV20
 13711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13712
 13713
 13714     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13715
 13716     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13717
 13718     MOVE 'D'                      TO JP-RECORD-TYPE.
 13719     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13720
 13721
 13722* EXEC CICS DELETE
 13723*         DATASET    (FILE-ID-ERRQST)
 13724*    END-EXEC.
 13725*    MOVE '&(                    &   #00012606' TO DFHEIV0
 13726     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13728     MOVE X'2020233030303132363036' TO DFHEIV0(25:11)
 13729     CALL 'kxdfhei1' USING DFHEIV0,
 13730           FILE-ID-ERRQST,
 13731           DFHEIV99,
 13732           DFHEIV99,
 13733           DFHEIV99,
 13734           DFHEIV99
 13735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13736
 13737
 13738     PERFORM 8400-LOG-JOURNAL-RECORD.
 13739
 13740 1475-DELETE-FINISHED.
 13741     MOVE ZEROS                  TO EMI-ERROR.
 13742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13743     MOVE LOW-VALUES             TO EL631BI.
 13744     MOVE -1                     TO BMAINTL.
 13745     GO TO 8100-SEND-INITIAL-MAP.
 13746
 13747 1480-BATCH-HDR-NOT-FOUND.
 13748     MOVE -1                     TO BMAINTL.
 13749     MOVE ER-7450                TO EMI-ERROR.
 13750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13751     GO TO 8200-SEND-DATAONLY.
 13752
 13753 1490-RECORD-NOT-FOUND.
 13754     MOVE -1                     TO BMAINTL.
 13755     MOVE ER-7451                TO EMI-ERROR.
 13756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13757     GO TO 8200-SEND-DATAONLY.
 13758
 13759******************************************************************
 13760*            O V E R   C H A R G E   P R O C E S S I N G         *
 13761******************************************************************
 13762 1500-UPDATE-ERNOTE.
 13763     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13764     MOVE 'A'                    TO WS-NOTE-SW
 13765     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13766     .
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 250
* EL6311.cbl
 13767 1500-EXIT.
 13768     EXIT.
 13769 1510-ADD-ERNOTE-REC.
 13770
 13771* EXEC CICS GETMAIN
 13772*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13773*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13774*        INITIMG (GETMAIN-SPACE)
 13775*    END-EXEC
 13776*    MOVE ',"IL                  $   #00012642' TO DFHEIV0
 13777     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13778     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13779     MOVE X'2020233030303132363432' TO DFHEIV0(25:11)
 13780     CALL 'kxdfhei1' USING DFHEIV0,
 13781           DFHEIV20,
 13782           ERNOTE-RECORD-LENGTH,
 13783           GETMAIN-SPACE
 13784     SET ADDRESS OF CERTIFICATE-NOTE TO
 13785         DFHEIV20
 13786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13787     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13788                                 TO ERNOTE-KEY
 13789     move '1'                    to ernote-record-type
 13790
 13791* EXEC CICS READ
 13792*       DATASET    (FILE-ID-ERNOTE)
 13793*       RIDFLD     (ERNOTE-KEY)
 13794*       INTO       (CERTIFICATE-NOTE)
 13795*       RESP       (WS-RESPONSE)
 13796*       UPDATE
 13797*    END-EXEC
 13798     MOVE LENGTH OF
 13799      CERTIFICATE-NOTE
 13800       TO DFHEIV11
 13801*    MOVE '&"IL       EU         (  N#00012650' TO DFHEIV0
 13802     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13803     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13804     MOVE X'204E233030303132363530' TO DFHEIV0(25:11)
 13805     CALL 'kxdfhei1' USING DFHEIV0,
 13806           FILE-ID-ERNOTE,
 13807           CERTIFICATE-NOTE,
 13808           DFHEIV11,
 13809           ERNOTE-KEY,
 13810           DFHEIV99,
 13811           DFHEIV99,
 13812           DFHEIV99
 13813     MOVE EIBRESP  TO WS-RESPONSE
 13814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13815     IF RESP-NORMAL
 13816        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13817           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13818        END-IF
 13819        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13820           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13821        END-IF
 13822        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13823           (N1 > +10)
 13824           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 251
* EL6311.cbl
 13825           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13826        END-PERFORM
 13827        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13828          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13829
 13830* EXEC CICS UNLOCK
 13831*            DATASET    (FILE-ID-ERNOTE)
 13832*          END-EXEC
 13833*    MOVE '&*                    #   #00012671' TO DFHEIV0
 13834     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13835     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13836     MOVE X'2020233030303132363731' TO DFHEIV0(25:11)
 13837     CALL 'kxdfhei1' USING DFHEIV0,
 13838           FILE-ID-ERNOTE,
 13839           DFHEIV99
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13841        ELSE
 13842          PERFORM VARYING N1 FROM +1 BY +1
 13843           UNTIL (N1 > +10)
 13844           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13845          END-PERFORM
 13846          IF (N1 < +11)
 13847            IF N1 >= CN-BILLING-START-LINE-NO AND
 13848              N1 <= CN-BILLING-END-LINE-NO
 13849              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13850                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13851              ELSE
 13852                 MOVE WS-VA-NO-COMM-MESS
 13853                                    TO CN-LINE (N1)
 13854              END-IF
 13855            ELSE
 13856              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13857               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13858                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13859                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13860                ELSE
 13861                  MOVE WS-VA-NO-COMM-MESS
 13862                                    TO CN-LINE (N1)
 13863                END-IF
 13864                MOVE N1             TO CN-BILLING-END-LINE-NO
 13865              ELSE
 13866                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13867                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13868                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13869                  ELSE
 13870                     MOVE WS-VA-NO-COMM-MESS
 13871                                    TO CN-LINE (N1)
 13872                  END-IF
 13873                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13874                                      CN-BILLING-START-LINE-NO
 13875                ELSE
 13876                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13877                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13878                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13879                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13880                     ELSE
 13881                       MOVE WS-VA-NO-COMM-MESS
 13882                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 252
* EL6311.cbl
 13883                     END-IF
 13884                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13885                  ELSE
 13886                     PERFORM 1700-SQUEEZE-IT-IN
 13887                                 THRU 1700-EXIT
 13888                  END-IF
 13889                END-IF
 13890              END-IF
 13891            END-IF
 13892            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13893            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13894            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13895
 13896* EXEC CICS REWRITE
 13897*              DATASET    (FILE-ID-ERNOTE)
 13898*              FROM       (CERTIFICATE-NOTE)
 13899*              RESP       (WS-RESPONSE)
 13900*           END-EXEC
 13901     MOVE LENGTH OF
 13902      CERTIFICATE-NOTE
 13903       TO DFHEIV11
 13904*    MOVE '&& L                  %  N#00012728' TO DFHEIV0
 13905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13907     MOVE X'204E233030303132373238' TO DFHEIV0(25:11)
 13908     CALL 'kxdfhei1' USING DFHEIV0,
 13909           FILE-ID-ERNOTE,
 13910           CERTIFICATE-NOTE,
 13911           DFHEIV11,
 13912           DFHEIV99
 13913     MOVE EIBRESP  TO WS-RESPONSE
 13914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13915          END-IF
 13916        END-IF
 13917     ELSE
 13918        MOVE SPACES              TO CERTIFICATE-NOTE
 13919        MOVE 'CN'                TO CN-RECORD-ID
 13920        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13921                                 TO CN-CONTROL-PRIMARY
 13922                                    ERNOTE-KEY
 13923        move '1'                 to cn-record-type
 13924                                    ernote-record-type
 13925        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13926                                    CN-BILLING-END-LINE-NO
 13927        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13928           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13929        ELSE
 13930           MOVE WS-VA-NO-COMM-MESS
 13931                                 TO CN-LINE (1)
 13932        END-IF
 13933        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13934        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13935        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13936
 13937* EXEC CICS WRITE
 13938*          DATASET    (FILE-ID-ERNOTE)
 13939*          FROM       (CERTIFICATE-NOTE)
 13940*          RIDFLD     (ERNOTE-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 253
* EL6311.cbl
 13941*          RESP       (WS-RESPONSE)
 13942*       END-EXEC
 13943     MOVE LENGTH OF
 13944      CERTIFICATE-NOTE
 13945       TO DFHEIV11
 13946*    MOVE '&$ L                  ''  N#00012754' TO DFHEIV0
 13947     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13948     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13949     MOVE X'204E233030303132373534' TO DFHEIV0(25:11)
 13950     CALL 'kxdfhei1' USING DFHEIV0,
 13951           FILE-ID-ERNOTE,
 13952           CERTIFICATE-NOTE,
 13953           DFHEIV11,
 13954           ERNOTE-KEY,
 13955           DFHEIV99,
 13956           DFHEIV99
 13957     MOVE EIBRESP  TO WS-RESPONSE
 13958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13959     END-IF
 13960     .
 13961 1510-EXIT.
 13962     EXIT.
 13963 1520-UPDATE-ELCERT.
 13964     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13965                                 TO ELCERT-KEY
 13966
 13967* EXEC CICS READ
 13968*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13969*        DATASET (FILE-ID-ELCERT)
 13970*        RIDFLD  (ELCERT-KEY)
 13971*        UPDATE
 13972*        RESP    (WS-RESPONSE)
 13973*    END-EXEC
 13974*    MOVE '&"S        EU         (  N#00012767' TO DFHEIV0
 13975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13976     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13977     MOVE X'204E233030303132373637' TO DFHEIV0(25:11)
 13978     CALL 'kxdfhei1' USING DFHEIV0,
 13979           FILE-ID-ELCERT,
 13980           DFHEIV20,
 13981           DFHEIV99,
 13982           ELCERT-KEY,
 13983           DFHEIV99,
 13984           DFHEIV99,
 13985           DFHEIV99
 13986     SET ADDRESS OF CERTIFICATE-MASTER TO
 13987         DFHEIV20
 13988     MOVE EIBRESP  TO WS-RESPONSE
 13989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13990     IF RESP-NORMAL
 13991        IF WS-NOTE-SW = 'A'
 13992           IF CM-NOTE-SW = ' '
 13993              MOVE '2'             TO CM-NOTE-SW
 13994           ELSE
 13995             IF CM-NOTE-SW = '1'
 13996                MOVE '3'           TO CM-NOTE-SW
 13997             ELSE
 13998               IF CM-NOTE-SW = '4'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 254
* EL6311.cbl
 13999                  MOVE '6'         TO CM-NOTE-SW
 14000               ELSE
 14001                 IF CM-NOTE-SW = '5'
 14002                    MOVE '7'       TO CM-NOTE-SW
 14003                 END-IF
 14004               END-IF
 14005             END-IF
 14006           END-IF
 14007        ELSE
 14008           IF CM-NOTE-SW = '2'
 14009              MOVE ' '             TO CM-NOTE-SW
 14010           ELSE
 14011             IF CM-NOTE-SW = '3'
 14012                MOVE '1'           TO CM-NOTE-SW
 14013             ELSE
 14014               IF CM-NOTE-SW = '6'
 14015                  MOVE '4'         TO CM-NOTE-SW
 14016               ELSE
 14017                 IF CM-NOTE-SW = '7'
 14018                    MOVE '5'       TO CM-NOTE-SW
 14019                 END-IF
 14020               END-IF
 14021             END-IF
 14022           END-IF
 14023        END-IF
 14024
 14025* EXEC CICS REWRITE
 14026*          DATASET    (FILE-ID-ELCERT)
 14027*          FROM       (CERTIFICATE-MASTER)
 14028*          RESP       (WS-RESPONSE)
 14029*       END-EXEC
 14030     MOVE LENGTH OF
 14031      CERTIFICATE-MASTER
 14032       TO DFHEIV11
 14033*    MOVE '&& L                  %  N#00012808' TO DFHEIV0
 14034     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14035     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14036     MOVE X'204E233030303132383038' TO DFHEIV0(25:11)
 14037     CALL 'kxdfhei1' USING DFHEIV0,
 14038           FILE-ID-ELCERT,
 14039           CERTIFICATE-MASTER,
 14040           DFHEIV11,
 14041           DFHEIV99
 14042     MOVE EIBRESP  TO WS-RESPONSE
 14043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14044        IF RESP-NORMAL
 14045           CONTINUE
 14046        ELSE
 14047           MOVE WS-RESPONSE TO EMI-ERROR
 14048           PERFORM 9900-ERROR-FORMAT
 14049                                 THRU 9900-EXIT
 14050           GO TO 8200-SEND-DATAONLY
 14051        END-IF
 14052     ELSE
 14053        MOVE -1                  TO BMAINTL
 14054        MOVE 0249                TO EMI-ERROR
 14055        PERFORM 9900-ERROR-FORMAT
 14056                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 255
* EL6311.cbl
 14057        GO TO 8200-SEND-DATAONLY
 14058     END-IF
 14059     .
 14060 1520-EXIT.
 14061     EXIT.
 14062 1600-UPDATE-ERPYAJ.
 14063     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14064                                 THRU 1610-EXIT
 14065     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14066                                 THRU 1620-EXIT
 14067     .
 14068 1600-EXIT.
 14069     EXIT.
 14070 1610-ADD-ERPYAJ-BANK-REC.
 14071
 14072* EXEC CICS GETMAIN
 14073*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14074*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14075*        INITIMG (GETMAIN-SPACE)
 14076*    END-EXEC
 14077*    MOVE ',"IL                  $   #00012840' TO DFHEIV0
 14078     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14080     MOVE X'2020233030303132383430' TO DFHEIV0(25:11)
 14081     CALL 'kxdfhei1' USING DFHEIV0,
 14082           DFHEIV20,
 14083           ERPYAJ-RECORD-LENGTH,
 14084           GETMAIN-SPACE
 14085     SET ADDRESS OF PENDING-PAY-ADJ TO
 14086         DFHEIV20
 14087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14088     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14089     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14090     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14091     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14092     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14093     MOVE +10                    TO ERPYAJ-SEQ-NO
 14094     MOVE 'R'                    TO ERPYAJ-TYPE
 14095     IF REVERSAL
 14096        MOVE 'C'                 TO ERPYAJ-TYPE
 14097     END-IF
 14098     MOVE SPACES                 TO PENDING-PAY-ADJ
 14099     MOVE 'PY'                   TO PY-RECORD-ID
 14100     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14101     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14102     IF REVERSAL
 14103        MOVE PB-I-DCC-OVER-CHG-AMT
 14104                                 TO PY-ENTRY-AMT
 14105     END-IF
 14106     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14107                                    PY-INPUT-DT
 14108*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14109*                                   PY-INPUT-DT
 14110     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14111     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14112     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14113     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14114     IF PB-CARRIER = '2'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 256
* EL6311.cbl
 14115        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14116     ELSE
 14117        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14118     END-IF
 14119     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14120                                    PY-BILLED-DATE
 14121                                    PY-AR-DATE
 14122                                    PY-REPORTED-DT
 14123                                    PY-CHECK-WRITTEN-DT
 14124     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14125                                    PY-CHECK-QUE-SEQUENCE
 14126     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14127     PERFORM WITH TEST AFTER
 14128        UNTIL (NOT RESP-DUPKEY)
 14129           AND (NOT RESP-DUPREC)
 14130
 14131* EXEC CICS WRITE
 14132*          DATASET    (FILE-ID-ERPYAJ)
 14133*          FROM       (PENDING-PAY-ADJ)
 14134*          RIDFLD     (ERPYAJ-KEY)
 14135*          RESP       (WS-RESPONSE)
 14136*       END-EXEC
 14137     MOVE LENGTH OF
 14138      PENDING-PAY-ADJ
 14139       TO DFHEIV11
 14140*    MOVE '&$ L                  ''  N#00012887' TO DFHEIV0
 14141     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14143     MOVE X'204E233030303132383837' TO DFHEIV0(25:11)
 14144     CALL 'kxdfhei1' USING DFHEIV0,
 14145           FILE-ID-ERPYAJ,
 14146           PENDING-PAY-ADJ,
 14147           DFHEIV11,
 14148           ERPYAJ-KEY,
 14149           DFHEIV99,
 14150           DFHEIV99
 14151     MOVE EIBRESP  TO WS-RESPONSE
 14152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14153        IF RESP-DUPKEY OR RESP-DUPREC
 14154           ADD +1                TO ERPYAJ-SEQ-NO
 14155           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14156        END-IF
 14157     END-PERFORM
 14158     .
 14159 1610-EXIT.
 14160     EXIT.
 14161 1620-ADD-ERPYAJ-DLR-REC.
 14162     MOVE 'C'                    TO ERPYAJ-TYPE
 14163     IF REVERSAL
 14164        MOVE 'R'                 TO ERPYAJ-TYPE
 14165     END-IF
 14166     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14167                                    ERPYAJ-ACCOUNT
 14168     ADD +1                      TO ERPYAJ-SEQ-NO
 14169     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14170     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14171     IF PB-CARRIER = '2'
 14172        MOVE '2725040330'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 257
* EL6311.cbl
 14173     ELSE
 14174        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14175     END-IF
 14176     PERFORM WITH TEST AFTER
 14177        UNTIL (NOT RESP-DUPKEY)
 14178           AND (NOT RESP-DUPREC)
 14179
 14180* EXEC CICS WRITE
 14181*          DATASET    (FILE-ID-ERPYAJ)
 14182*          FROM       (PENDING-PAY-ADJ)
 14183*          RIDFLD     (ERPYAJ-KEY)
 14184*          RESP       (WS-RESPONSE)
 14185*       END-EXEC
 14186     MOVE LENGTH OF
 14187      PENDING-PAY-ADJ
 14188       TO DFHEIV11
 14189*    MOVE '&$ L                  ''  N#00012919' TO DFHEIV0
 14190     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14191     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14192     MOVE X'204E233030303132393139' TO DFHEIV0(25:11)
 14193     CALL 'kxdfhei1' USING DFHEIV0,
 14194           FILE-ID-ERPYAJ,
 14195           PENDING-PAY-ADJ,
 14196           DFHEIV11,
 14197           ERPYAJ-KEY,
 14198           DFHEIV99,
 14199           DFHEIV99
 14200     MOVE EIBRESP  TO WS-RESPONSE
 14201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14202        IF RESP-DUPKEY OR RESP-DUPREC
 14203           ADD +1                TO ERPYAJ-SEQ-NO
 14204           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14205        END-IF
 14206     END-PERFORM
 14207     .
 14208 1620-EXIT.
 14209     EXIT.
 14210 1700-SQUEEZE-IT-IN.
 14211     IF (N1 > CN-BILLING-END-LINE-NO)
 14212        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14213           N1 = +1
 14214           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14215           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14216              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14217                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14218              ELSE
 14219                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14220              END-IF
 14221              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14222              MOVE +2 TO N1
 14223           END-IF
 14224        END-PERFORM
 14225     ELSE
 14226        IF (N1 < CN-BILLING-START-LINE-NO)
 14227           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14228              N1 = +10
 14229              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14230              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 258
* EL6311.cbl
 14231                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14232                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14233                 ELSE
 14234                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14235                 END-IF
 14236                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14237                 MOVE +9 TO N1
 14238              END-IF
 14239           END-PERFORM
 14240        END-IF
 14241     END-IF
 14242     .
 14243 1700-EXIT.
 14244     EXIT.
 14245 1800-REMOVE-CERT-NOTES.
 14246     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14247                                 TO ERNOTE-KEY
 14248     move '1'                    to ernote-record-type
 14249
 14250* EXEC CICS READ
 14251*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14252*       DATASET    (FILE-ID-ERNOTE)
 14253*       RIDFLD     (ERNOTE-KEY)
 14254*       RESP       (WS-RESPONSE)
 14255*       UPDATE
 14256*    END-EXEC
 14257*    MOVE '&"S        EU         (  N#00012972' TO DFHEIV0
 14258     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14259     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14260     MOVE X'204E233030303132393732' TO DFHEIV0(25:11)
 14261     CALL 'kxdfhei1' USING DFHEIV0,
 14262           FILE-ID-ERNOTE,
 14263           DFHEIV20,
 14264           DFHEIV99,
 14265           ERNOTE-KEY,
 14266           DFHEIV99,
 14267           DFHEIV99,
 14268           DFHEIV99
 14269     SET ADDRESS OF CERTIFICATE-NOTE TO
 14270         DFHEIV20
 14271     MOVE EIBRESP  TO WS-RESPONSE
 14272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14273     IF RESP-NORMAL
 14274        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14275           (N1 > +10)
 14276           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14277           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14278        END-PERFORM
 14279        IF N1 < +11
 14280           MOVE SPACES              TO CN-LINE (N1)
 14281           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14282              N1 <= CN-BILLING-END-LINE-NO
 14283              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14284              IF CN-BILLING-END-LINE-NO <
 14285                               CN-BILLING-START-LINE-NO
 14286                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14287                                     CN-BILLING-START-LINE-NO
 14288              END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 259
* EL6311.cbl
 14289              PERFORM 1820-SQUEEZE-ERNOTE
 14290                                  THRU 1820-EXIT
 14291           END-IF
 14292           IF CN-LINES = SPACES
 14293
 14294* EXEC CICS DELETE
 14295*                DATASET    (FILE-ID-ERNOTE)
 14296*                RESP       (WS-RESPONSE)
 14297*             END-EXEC
 14298*    MOVE '&(                    &  N#00012999' TO DFHEIV0
 14299     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14301     MOVE X'204E233030303132393939' TO DFHEIV0(25:11)
 14302     CALL 'kxdfhei1' USING DFHEIV0,
 14303           FILE-ID-ERNOTE,
 14304           DFHEIV99,
 14305           DFHEIV99,
 14306           DFHEIV99,
 14307           DFHEIV99
 14308     MOVE EIBRESP  TO WS-RESPONSE
 14309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14310              IF RESP-NORMAL
 14311                 MOVE 'D'        TO WS-NOTE-SW
 14312                 PERFORM 1520-UPDATE-ELCERT
 14313                                 THRU 1520-EXIT
 14314              END-IF
 14315           ELSE
 14316
 14317* EXEC CICS REWRITE
 14318*                DATASET    (FILE-ID-ERNOTE)
 14319*                FROM       (CERTIFICATE-NOTE)
 14320*                RESP       (WS-RESPONSE)
 14321*             END-EXEC
 14322     MOVE LENGTH OF
 14323      CERTIFICATE-NOTE
 14324       TO DFHEIV11
 14325*    MOVE '&& L                  %  N#00013009' TO DFHEIV0
 14326     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14327     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14328     MOVE X'204E233030303133303039' TO DFHEIV0(25:11)
 14329     CALL 'kxdfhei1' USING DFHEIV0,
 14330           FILE-ID-ERNOTE,
 14331           CERTIFICATE-NOTE,
 14332           DFHEIV11,
 14333           DFHEIV99
 14334     MOVE EIBRESP  TO WS-RESPONSE
 14335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14336           END-IF
 14337        END-IF
 14338     END-IF
 14339     .
 14340 1800-EXIT.
 14341     EXIT.
 14342 1820-SQUEEZE-ERNOTE.
 14343     MOVE CN-BILLING-START-LINE-NO TO N2
 14344     IF N2 = 0
 14345         MOVE +1                 TO N2
 14346     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 260
* EL6311.cbl
 14347     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14348        (N1 > +9)
 14349        IF CN-LINE (N1) = SPACES
 14350           MOVE CN-LINE (N1 + +1)
 14351                                 TO CN-LINE (N1)
 14352           MOVE SPACES           TO CN-LINE (N1 + +1)
 14353        END-IF
 14354     END-PERFORM
 14355     .
 14356 1820-EXIT.
 14357     EXIT.
 14358 1900-DELETE-ERPYAJ.
 14359     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14360     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14361     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14362     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14363     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14364     MOVE +10                    TO ERPYAJ-SEQ-NO
 14365     MOVE 'R'                    TO ERPYAJ-TYPE
 14366     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14367
 14368* EXEC CICS STARTBR
 14369*       DATASET    (FILE-ID-ERPYAJ)
 14370*       RIDFLD     (ERPYAJ-KEY)
 14371*       RESP       (WS-RESPONSE)
 14372*    END-EXEC
 14373     MOVE 0
 14374       TO DFHEIV11
 14375*    MOVE '&,         G          &  N#00013045' TO DFHEIV0
 14376     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14378     MOVE X'204E233030303133303435' TO DFHEIV0(25:11)
 14379     CALL 'kxdfhei1' USING DFHEIV0,
 14380           FILE-ID-ERPYAJ,
 14381           ERPYAJ-KEY,
 14382           DFHEIV99,
 14383           DFHEIV11,
 14384           DFHEIV99
 14385     MOVE EIBRESP  TO WS-RESPONSE
 14386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14387     IF RESP-NORMAL
 14388        CONTINUE
 14389     ELSE
 14390        GO TO 1900-GET-DEALER
 14391     END-IF
 14392     .
 14393 1900-READNEXT-ERPYAJ-B.
 14394*  GET THE BANK ERPYAJ RECORD
 14395
 14396* EXEC CICS READNEXT
 14397*       DATASET    (FILE-ID-ERPYAJ)
 14398*       RIDFLD     (ERPYAJ-KEY)
 14399*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14400*       RESP       (WS-RESPONSE)
 14401*    END-EXEC
 14402     MOVE 0
 14403       TO DFHEIV11
 14404*    MOVE '&.S                   )  N#00013058' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 261
* EL6311.cbl
 14405     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14406     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14407     MOVE X'204E233030303133303538' TO DFHEIV0(25:11)
 14408     CALL 'kxdfhei1' USING DFHEIV0,
 14409           FILE-ID-ERPYAJ,
 14410           DFHEIV20,
 14411           DFHEIV99,
 14412           ERPYAJ-KEY,
 14413           DFHEIV99,
 14414           DFHEIV11,
 14415           DFHEIV99,
 14416           DFHEIV99
 14417     SET ADDRESS OF PENDING-PAY-ADJ TO
 14418         DFHEIV20
 14419     MOVE EIBRESP  TO WS-RESPONSE
 14420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14421     IF RESP-NORMAL
 14422        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14423           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14424              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14425                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14426
 14427* EXEC CICS READ
 14428*                   DATASET    (FILE-ID-ERPYAJ)
 14429*                   RIDFLD     (ERPYAJ-KEY)
 14430*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14431*                   RESP       (WS-RESPONSE)
 14432*                   UPDATE
 14433*                END-EXEC
 14434*    MOVE '&"S        EU         (  N#00013069' TO DFHEIV0
 14435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14436     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14437     MOVE X'204E233030303133303639' TO DFHEIV0(25:11)
 14438     CALL 'kxdfhei1' USING DFHEIV0,
 14439           FILE-ID-ERPYAJ,
 14440           DFHEIV20,
 14441           DFHEIV99,
 14442           ERPYAJ-KEY,
 14443           DFHEIV99,
 14444           DFHEIV99,
 14445           DFHEIV99
 14446     SET ADDRESS OF PENDING-PAY-ADJ TO
 14447         DFHEIV20
 14448     MOVE EIBRESP  TO WS-RESPONSE
 14449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14450                 IF RESP-NORMAL
 14451
 14452* EXEC CICS DELETE
 14453*                      DATASET   (FILE-ID-ERPYAJ)
 14454*                      RESP      (WS-RESPONSE)
 14455*                   END-EXEC
 14456*    MOVE '&(                    &  N#00013077' TO DFHEIV0
 14457     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14459     MOVE X'204E233030303133303737' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0,
 14461           FILE-ID-ERPYAJ,
 14462           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 262
* EL6311.cbl
 14463           DFHEIV99,
 14464           DFHEIV99,
 14465           DFHEIV99
 14466     MOVE EIBRESP  TO WS-RESPONSE
 14467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14468                 END-IF
 14469              ELSE
 14470                 SET REVERSAL    TO TRUE
 14471                 PERFORM 1600-UPDATE-ERPYAJ
 14472                                 THRU 1600-EXIT
 14473                 GO TO 1900-EXIT
 14474              END-IF
 14475           ELSE
 14476              GO TO 1900-READNEXT-ERPYAJ-B
 14477           END-IF
 14478        END-IF
 14479
 14480* EXEC CICS ENDBR
 14481*          DATASET   (FILE-ID-ERPYAJ)
 14482*       END-EXEC
 14483     MOVE 0
 14484       TO DFHEIV11
 14485*    MOVE '&2                    $   #00013092' TO DFHEIV0
 14486     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14488     MOVE X'2020233030303133303932' TO DFHEIV0(25:11)
 14489     CALL 'kxdfhei1' USING DFHEIV0,
 14490           FILE-ID-ERPYAJ,
 14491           DFHEIV11,
 14492           DFHEIV99
 14493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14494     END-IF
 14495     .
 14496 1900-GET-DEALER.
 14497     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14498     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14499     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14500     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14501     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14502     MOVE +10                    TO ERPYAJ-SEQ-NO
 14503     MOVE 'C'                    TO ERPYAJ-TYPE
 14504     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14505
 14506* EXEC CICS STARTBR
 14507*       DATASET    (FILE-ID-ERPYAJ)
 14508*       RIDFLD     (ERPYAJ-KEY)
 14509*       RESP       (WS-RESPONSE)
 14510*    END-EXEC
 14511     MOVE 0
 14512       TO DFHEIV11
 14513*    MOVE '&,         G          &  N#00013106' TO DFHEIV0
 14514     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14515     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14516     MOVE X'204E233030303133313036' TO DFHEIV0(25:11)
 14517     CALL 'kxdfhei1' USING DFHEIV0,
 14518           FILE-ID-ERPYAJ,
 14519           ERPYAJ-KEY,
 14520           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 263
* EL6311.cbl
 14521           DFHEIV11,
 14522           DFHEIV99
 14523     MOVE EIBRESP  TO WS-RESPONSE
 14524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14525     IF RESP-NORMAL
 14526        CONTINUE
 14527     ELSE
 14528        GO TO 1900-EXIT
 14529     END-IF
 14530     .
 14531 1900-READNEXT-ERPYAJ-D.
 14532*  GET THE DEALER ERPYAJ RECORD
 14533
 14534* EXEC CICS READNEXT
 14535*       DATASET    (FILE-ID-ERPYAJ)
 14536*       RIDFLD     (ERPYAJ-KEY)
 14537*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14538*       RESP       (WS-RESPONSE)
 14539*    END-EXEC
 14540     MOVE 0
 14541       TO DFHEIV11
 14542*    MOVE '&.S                   )  N#00013119' TO DFHEIV0
 14543     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14544     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14545     MOVE X'204E233030303133313139' TO DFHEIV0(25:11)
 14546     CALL 'kxdfhei1' USING DFHEIV0,
 14547           FILE-ID-ERPYAJ,
 14548           DFHEIV20,
 14549           DFHEIV99,
 14550           ERPYAJ-KEY,
 14551           DFHEIV99,
 14552           DFHEIV11,
 14553           DFHEIV99,
 14554           DFHEIV99
 14555     SET ADDRESS OF PENDING-PAY-ADJ TO
 14556         DFHEIV20
 14557     MOVE EIBRESP  TO WS-RESPONSE
 14558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14559     IF RESP-NORMAL
 14560        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14561           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14562              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14563                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14564
 14565* EXEC CICS READ
 14566*                   DATASET    (FILE-ID-ERPYAJ)
 14567*                   RIDFLD     (ERPYAJ-KEY)
 14568*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14569*                   RESP       (WS-RESPONSE)
 14570*                   UPDATE
 14571*                END-EXEC
 14572*    MOVE '&"S        EU         (  N#00013130' TO DFHEIV0
 14573     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14574     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14575     MOVE X'204E233030303133313330' TO DFHEIV0(25:11)
 14576     CALL 'kxdfhei1' USING DFHEIV0,
 14577           FILE-ID-ERPYAJ,
 14578           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 264
* EL6311.cbl
 14579           DFHEIV99,
 14580           ERPYAJ-KEY,
 14581           DFHEIV99,
 14582           DFHEIV99,
 14583           DFHEIV99
 14584     SET ADDRESS OF PENDING-PAY-ADJ TO
 14585         DFHEIV20
 14586     MOVE EIBRESP  TO WS-RESPONSE
 14587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14588                 IF RESP-NORMAL
 14589
 14590* EXEC CICS DELETE
 14591*                      DATASET   (FILE-ID-ERPYAJ)
 14592*                      RESP      (WS-RESPONSE)
 14593*                   END-EXEC
 14594*    MOVE '&(                    &  N#00013138' TO DFHEIV0
 14595     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14597     MOVE X'204E233030303133313338' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           FILE-ID-ERPYAJ,
 14600           DFHEIV99,
 14601           DFHEIV99,
 14602           DFHEIV99,
 14603           DFHEIV99
 14604     MOVE EIBRESP  TO WS-RESPONSE
 14605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14606                 END-IF
 14607              ELSE
 14608                 SET REVERSAL    TO TRUE
 14609              END-IF
 14610           ELSE
 14611              GO TO 1900-READNEXT-ERPYAJ-D
 14612           END-IF
 14613        END-IF
 14614
 14615* EXEC CICS ENDBR
 14616*          DATASET   (FILE-ID-ERPYAJ)
 14617*       END-EXEC
 14618     MOVE 0
 14619       TO DFHEIV11
 14620*    MOVE '&2                    $   #00013150' TO DFHEIV0
 14621     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14622     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14623     MOVE X'2020233030303133313530' TO DFHEIV0(25:11)
 14624     CALL 'kxdfhei1' USING DFHEIV0,
 14625           FILE-ID-ERPYAJ,
 14626           DFHEIV11,
 14627           DFHEIV99
 14628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14629     END-IF
 14630     .
 14631 1900-EXIT.
 14632     EXIT.
 14633******************************************************************
 14634*            C A N C E L   M A I N L I N E                       *
 14635******************************************************************
 14636
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 265
* EL6311.cbl
 14637 2000-CANCEL-MAINLINE.
 14638     IF PI-DISPLAY-ORIGINAL-BATCH
 14639        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14640           MOVE ER-0023             TO EMI-ERROR
 14641           MOVE -1                  TO CMAINTL
 14642           MOVE AL-UABON            TO CMAINTA
 14643           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14644           GO TO 8200-SEND-DATAONLY
 14645        ELSE
 14646           NEXT SENTENCE
 14647     ELSE
 14648        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14649           MOVE ER-0023             TO EMI-ERROR
 14650           MOVE -1                  TO CMAINTL
 14651           MOVE AL-UABON            TO CMAINTA
 14652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14653           GO TO 8200-SEND-DATAONLY.
 14654
 14655     IF CMAINTI = 'S'
 14656        GO TO 2100-SHOW-REQUEST.
 14657
 14658     IF NOT MODIFY-CAP
 14659         MOVE 'UPDATE'       TO SM-READ
 14660         PERFORM 9995-SECURITY-VIOLATION
 14661         MOVE ER-0070        TO EMI-ERROR
 14662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14663         GO TO 8100-SEND-INITIAL-MAP.
 14664
 14665     IF CMAINTL GREATER THAN ZEROS
 14666        IF PI-PF6-FUNCTION
 14667           IF CMAINTI NOT = 'A'
 14668              MOVE AL-UABON  TO CMAINTA
 14669              MOVE -1        TO CMAINTL
 14670              MOVE ER-2260   TO EMI-ERROR
 14671              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14672              GO TO 8200-SEND-DATAONLY.
 14673
 14674     IF CCERTNOL = ZEROS
 14675       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14676         NEXT SENTENCE
 14677     ELSE
 14678         IF CCERTNOL NOT = ZEROS
 14679             MOVE AL-UANON       TO CCERTNOA
 14680         ELSE
 14681             MOVE -1             TO CCERTNOL
 14682             MOVE  1             TO SET-CURSOR-SW
 14683             MOVE ER-2218       TO EMI-ERROR
 14684             MOVE AL-UABON       TO CCERTNOA
 14685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14686
 14687     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14688        NEXT SENTENCE
 14689     ELSE
 14690        IF CEFFDTL NOT = ZEROS
 14691           MOVE AL-UNNON         TO CEFFDTA
 14692           MOVE CEFFDTI TO DEEDIT-FIELD
 14693           PERFORM 8600-DEEDIT
 14694           MOVE 4                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 266
* EL6311.cbl
 14695           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14696           PERFORM 9700-DATE-LINK
 14697           IF NO-CONVERSION-ERROR
 14698              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14699              ELSE
 14700              MOVE -1            TO CEFFDTL
 14701              MOVE  1            TO SET-CURSOR-SW
 14702              MOVE ER-2226      TO EMI-ERROR
 14703              MOVE AL-UNBON      TO CEFFDTA
 14704              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14705          ELSE
 14706          MOVE -1                 TO CEFFDTL
 14707          MOVE  1                 TO SET-CURSOR-SW
 14708          MOVE ER-2220            TO EMI-ERROR
 14709          MOVE AL-UNBON           TO CEFFDTA
 14710          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14711
 14712     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14713
 14714     IF CCERTNOL NOT = ZEROS
 14715        MOVE CCERTNOI                TO WS-NEW-PRIME
 14716     ELSE
 14717        MOVE SPACES                  TO WS-NEW-PRIME.
 14718
 14719     IF CSUFIXL NOT = ZEROS
 14720        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14721     ELSE
 14722        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14723
 14724     IF CEFFDTL NOT = ZEROS
 14725        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14726     ELSE
 14727        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14728
 14729     IF CMAINTI = 'A' OR 'K' OR 'S'
 14730        NEXT SENTENCE
 14731     ELSE
 14732        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14733        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14734           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14735           WS-PB-RECORD-TYPE NOT = '2'
 14736           IF CMAINTI = 'C'
 14737              MOVE ER-2287          TO EMI-ERROR
 14738              MOVE -1               TO CCERTNOL
 14739              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14741              GO TO 8200-SEND-DATAONLY
 14742             ELSE
 14743              MOVE ER-2260          TO EMI-ERROR
 14744              MOVE -1               TO CCERTNOL
 14745              MOVE AL-UABON         TO CCERTNOA
 14746              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14747              GO TO 8200-SEND-DATAONLY.
 14748
 14749     IF CMAINTI = 'D'
 14750        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14751
 14752     IF CLSTNML GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 267
* EL6311.cbl
 14753         MOVE AL-UANON           TO CLSTNMA.
 14754
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 268
* EL6311.cbl
 14756
 14757******************************************************************
 14758*                                                                *
 14759*           E D I T   C A N C E L   C O V E R A G E S            *
 14760*                                                                *
 14761******************************************************************
 14762
 14763 2015-EDIT-COVERAGES.
 14764     IF CCANDT1L      GREATER THAN ZEROS OR
 14765        CREFND1L      GREATER THAN ZEROS OR
 14766        CCANDT2L      GREATER THAN ZEROS OR
 14767        CREFND2L      GREATER THAN ZEROS OR
 14768        CMTHD1L       GREATER THAN ZEROS OR
 14769        CMTHD2L       GREATER THAN ZEROS OR
 14770        CLIVESL       GREATER THAN ZEROS OR
 14771        CPAYEEL       GREATER THAN ZEROS OR
 14772        CFORCEL       GREATER THAN ZEROS OR
 14773        CBILCDL       GREATER THAN ZEROS OR
 14774        CCANREAL      GREATER THAN ZEROS
 14775            NEXT SENTENCE
 14776         ELSE
 14777            GO TO 2030-EDIT-COMPLETE.
 14778
 14779     IF CCANDT1L = ZEROS
 14780        AND (CMAINTI = 'C' OR 'K')
 14781        NEXT SENTENCE
 14782     ELSE
 14783        IF CCANDT1L      GREATER THAN ZEROS
 14784            MOVE AL-UNNON            TO CCANDT1A
 14785            IF CCANDT1I = SPACES
 14786               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14787            ELSE
 14788               MOVE CCANDT1I            TO DEEDIT-FIELD
 14789               PERFORM 8600-DEEDIT
 14790               IF DEEDIT-FIELD-V0   NUMERIC
 14791                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14792                  MOVE 4                TO DC-OPTION-CODE
 14793                  PERFORM 9700-DATE-LINK
 14794                  IF NO-CONVERSION-ERROR
 14795                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14796                  ELSE
 14797                      MOVE -1        TO CCANDT1L
 14798                      MOVE ER-2227   TO EMI-ERROR
 14799                      MOVE AL-UNBON  TO CCANDT1A
 14800                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14801               ELSE
 14802                  MOVE -1         TO CCANDT1L
 14803                  MOVE ER-2223    TO EMI-ERROR
 14804                  MOVE AL-UNBON   TO CCANDT1A
 14805                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14806        ELSE
 14807            IF CREFND1L GREATER THAN ZEROS
 14808               MOVE -1             TO CCANDT1L
 14809               MOVE ER-2222        TO EMI-ERROR
 14810               MOVE AL-UNBOF       TO CCANDT1A
 14811               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14812
 14813     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 269
* EL6311.cbl
 14814        AND (CMAINTI = 'C' OR 'K')
 14815         NEXT SENTENCE
 14816     ELSE
 14817         IF CREFND1L NOT = ZEROS
 14818            MOVE AL-UNNON        TO CREFND1A
 14819
 14820* EXEC CICS BIF DEEDIT
 14821*               FIELD  (CREFND1I)
 14822*               LENGTH (11)
 14823*           END-EXEC
 14824     MOVE 11
 14825       TO DFHEIV11
 14826*    MOVE '@"L                   #   #00013343' TO DFHEIV0
 14827     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14828     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14829     MOVE X'2020233030303133333433' TO DFHEIV0(25:11)
 14830     CALL 'kxdfhei1' USING DFHEIV0,
 14831           CREFND1I,
 14832           DFHEIV11
 14833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14834            MOVE CREFND1I        TO WS-CREFND1
 14835*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14836*           PERFORM 8600-DEEDIT
 14837*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14838            IF WS-CREFND1  = ZEROS
 14839               AND CMAINTI = 'A'
 14840             MOVE ER-2437        TO EMI-ERROR
 14841             MOVE -1             TO CREFND1L
 14842             MOVE AL-UNBON       TO CREFND1A
 14843             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14844
 14845     IF CCANREAL > +0
 14846        MOVE AL-UANON            TO CCANREAA
 14847        IF CCANREAI = 'R' OR ' '
 14848           CONTINUE
 14849        ELSE
 14850           MOVE ER-9841        TO EMI-ERROR
 14851           MOVE -1             TO CCANREAL
 14852           MOVE AL-UABON       TO CCANREAA
 14853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14854        END-IF
 14855     END-IF
 14856     IF CMTHD1L EQUAL +0
 14857        NEXT SENTENCE
 14858     ELSE
 14859        IF CMTHD1L NOT = +0
 14860           MOVE AL-UNNON        TO CMTHD1A
 14861           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14862                         OR '5' OR '6' OR '8' OR '9'
 14863                         OR 'R' OR ' '
 14864              NEXT SENTENCE
 14865           ELSE
 14866              MOVE ER-0582        TO EMI-ERROR
 14867              MOVE -1             TO CMTHD1L
 14868              MOVE AL-UNBON       TO CMTHD1A
 14869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14870
 14871     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 270
* EL6311.cbl
 14872        AND (CMAINTI = 'C' OR 'K')
 14873         NEXT SENTENCE
 14874     ELSE
 14875         IF CCANDT2L  GREATER THAN ZEROS
 14876             MOVE AL-UNNON       TO CCANDT2A
 14877             IF CCANDT2I = SPACES
 14878                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14879             ELSE
 14880                MOVE CCANDT2I       TO DEEDIT-FIELD
 14881                PERFORM 8600-DEEDIT
 14882                IF DEEDIT-FIELD-V0   NUMERIC
 14883                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14884                   MOVE 4                TO DC-OPTION-CODE
 14885                   PERFORM 9700-DATE-LINK
 14886                   IF NO-CONVERSION-ERROR
 14887                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14888                   ELSE
 14889                      MOVE -1       TO CCANDT2L
 14890                      MOVE ER-2227  TO EMI-ERROR
 14891                      MOVE AL-UNBON TO CCANDT2A
 14892                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14893                ELSE
 14894                   MOVE -1         TO CCANDT2L
 14895                   MOVE ER-2223    TO EMI-ERROR
 14896                   MOVE AL-UNBON   TO CCANDT2A
 14897                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14898         ELSE
 14899            IF CREFND2L GREATER THAN ZEROS
 14900               MOVE -1             TO CCANDT2L
 14901               MOVE ER-2222        TO EMI-ERROR
 14902               MOVE AL-UNBOF       TO CCANDT2A
 14903               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14904
 14905     IF CREFND2L = ZEROS
 14906        AND (CMAINTI = 'C' OR 'K')
 14907         NEXT SENTENCE
 14908     ELSE
 14909         IF CREFND2L NOT = ZEROS
 14910            MOVE AL-UNNON        TO CREFND2A
 14911
 14912* EXEC CICS BIF DEEDIT
 14913*               FIELD  (CREFND2I)
 14914*               LENGTH (11)
 14915*           END-EXEC
 14916     MOVE 11
 14917       TO DFHEIV11
 14918*    MOVE '@"L                   #   #00013424' TO DFHEIV0
 14919     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14920     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14921     MOVE X'2020233030303133343234' TO DFHEIV0(25:11)
 14922     CALL 'kxdfhei1' USING DFHEIV0,
 14923           CREFND2I,
 14924           DFHEIV11
 14925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14926            MOVE CREFND2I        TO WS-CREFND2
 14927*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14928*           PERFORM 8600-DEEDIT
 14929*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 271
* EL6311.cbl
 14930            IF WS-CREFND2  = ZEROS
 14931               AND CMAINTI = 'A'
 14932             MOVE ER-2437        TO EMI-ERROR
 14933             MOVE -1             TO CREFND2L
 14934             MOVE AL-UNBON       TO CREFND2A
 14935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14936
 14937     IF CMTHD2L EQUAL +0
 14938        NEXT SENTENCE
 14939     ELSE
 14940        IF CMTHD2L NOT = +0
 14941           MOVE AL-UNNON        TO CMTHD2A
 14942           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14943                         OR '5' OR '6' OR '8' OR '9'
 14944                         OR ' ' OR 'R'
 14945              NEXT SENTENCE
 14946           ELSE
 14947              MOVE ER-0582        TO EMI-ERROR
 14948              MOVE -1             TO CMTHD2L
 14949              MOVE AL-UNBON       TO CMTHD2A
 14950              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14951
 14952     IF CLIVESL GREATER THAN ZEROS
 14953         MOVE CLIVESI            TO DEEDIT-FIELD
 14954         PERFORM 8600-DEEDIT
 14955         IF DEEDIT-FIELD-V0 NUMERIC
 14956             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14957             MOVE AL-UNNON       TO CLIVESA
 14958         ELSE
 14959             MOVE -1             TO CLIVESL
 14960             MOVE AL-UNBON       TO CLIVESA
 14961             MOVE ER-2223        TO EMI-ERROR
 14962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14963
 14964     IF CFORCEL  NOT = ZEROS
 14965         IF FORCE-CAP
 14966            MOVE AL-UANON            TO CFORCEA
 14967         ELSE
 14968            MOVE ER-2945             TO EMI-ERROR
 14969            MOVE AL-UABON            TO CFORCEA
 14970            MOVE -1                  TO CFORCEL
 14971            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14972
 14973     IF CPAYEEL GREATER THAN ZEROS
 14974        MOVE AL-UANON            TO CPAYEEA.
 14975
 14976     IF CBILCDL NOT = ZEROS
 14977        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14978                             AND 'A' AND 'B' AND 'E'
 14979           MOVE ER-2225              TO EMI-ERROR
 14980           MOVE AL-UABON             TO CBILCDA
 14981           MOVE -1                   TO CBILCDL
 14982           MOVE  1                   TO SET-CURSOR-SW
 14983           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14984        ELSE
 14985           MOVE AL-UANON             TO CBILCDA.
 14986
 14987 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 272
* EL6311.cbl
 14988     IF EMI-ERROR = ZEROS
 14989         NEXT SENTENCE
 14990     ELSE
 14991         GO TO 8200-SEND-DATAONLY.
 14992
 14993     IF CMAINTI = 'A'
 14994        GO TO 2200-ADD-CANCEL-ROUTINE.
 14995
 14996     IF CMAINTI = 'C'
 14997        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14998
 14999     GO TO 2900-REWRITE-CAN-CERT-KEY.
 15000
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 273
* EL6311.cbl
 15002
 15003******************************************************************
 15004*                                                                *
 15005*                   S H O W   C A N C E L                        *
 15006*                                                                *
 15007******************************************************************
 15008
 15009 2100-SHOW-REQUEST.
 15010     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 15011
 15012     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 15013        MOVE -1                  TO CMAINTL
 15014        GO TO 8200-SEND-DATAONLY.
 15015
 15016     MOVE CCERTNOI            TO WS-NEW-PRIME.
 15017
 15018     IF CSUFIXL NOT = ZEROS
 15019        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 15020       ELSE
 15021        MOVE SPACE            TO WS-NEW-SUFFIX.
 15022
 15023     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15024     PERFORM 8600-DEEDIT.
 15025     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15026     MOVE '4'                    TO DC-OPTION-CODE.
 15027     PERFORM 9700-DATE-LINK.
 15028     IF DATE-CONVERSION-ERROR
 15029        MOVE ER-0348             TO EMI-ERROR
 15030        MOVE -1                  TO CEFFDTL
 15031        MOVE AL-UABON            TO CEFFDTA
 15032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15033        GO TO 8200-SEND-DATAONLY
 15034     ELSE
 15035        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15036        MOVE AL-UANON            TO CEFFDTA
 15037        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15038
 15039     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 15040
 15041     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 15042        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 15043        MOVE 'Y'                    TO WS-SHOW-SW
 15044        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 15045           GO TO 4100-BROWSE-PRIMARY-FORWARD
 15046        ELSE
 15047           IF PI-FILE-BROWSE
 15048              GO TO 4300-BROWSE-FILE-FORWARD
 15049           ELSE
 15050              IF PI-CSR-BROWSE
 15051                 GO TO 4200-BROWSE-CSR-FORWARD
 15052              ELSE
 15053                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15054     ELSE
 15055        GO TO 3900-RE-DISPLAY-RECORD.
 15056
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 274
* EL6311.cbl
 15058
 15059
 15060******************************************************************
 15061*                                                                *
 15062*            A D D   C A N C E L   R O U T I N E                 *
 15063*                                                                *
 15064******************************************************************
 15065
 15066 2200-ADD-CANCEL-ROUTINE.
 15067     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15068
 15069
 15070* EXEC CICS GETMAIN
 15071*        SET     (ADDRESS OF PENDING-BUSINESS)
 15072*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15073*    END-EXEC.
 15074*    MOVE '," L                  $   #00013571' TO DFHEIV0
 15075     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15076     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15077     MOVE X'2020233030303133353731' TO DFHEIV0(25:11)
 15078     CALL 'kxdfhei1' USING DFHEIV0,
 15079           DFHEIV20,
 15080           ERPNDB-RECORD-LENGTH,
 15081           DFHEIV99
 15082     SET ADDRESS OF PENDING-BUSINESS TO
 15083         DFHEIV20
 15084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15085
 15086
 15087
 15088* EXEC CICS HANDLE CONDITION
 15089*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15090*    END-EXEC.
 15091*    MOVE '"$I                   ! 3 #00013576' TO DFHEIV0
 15092     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15094     MOVE X'3320233030303133353736' TO DFHEIV0(25:11)
 15095     CALL 'kxdfhei1' USING DFHEIV0
 15096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15097
 15098
 15099     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15100     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15101     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15102
 15103
 15104* EXEC CICS READ
 15105*        INTO    (PENDING-BUSINESS)
 15106*        DATASET (FILE-ID-ERPNDB)
 15107*        RIDFLD  (ERPNDB-KEY)
 15108*    END-EXEC.
 15109     MOVE LENGTH OF
 15110      PENDING-BUSINESS
 15111       TO DFHEIV11
 15112*    MOVE '&"IL       E          (   #00013584' TO DFHEIV0
 15113     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15115     MOVE X'2020233030303133353834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 275
* EL6311.cbl
 15116     CALL 'kxdfhei1' USING DFHEIV0,
 15117           FILE-ID-ERPNDB,
 15118           PENDING-BUSINESS,
 15119           DFHEIV11,
 15120           ERPNDB-KEY,
 15121           DFHEIV99,
 15122           DFHEIV99,
 15123           DFHEIV99
 15124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15125
 15126
 15127     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15128
 15129     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15130     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15131     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15132     MOVE SPACES                 TO PENDING-BUSINESS.
 15133     MOVE 'PB'                   TO PB-RECORD-ID.
 15134     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15135     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15136     MOVE SPACES                 TO PB-CERT-SFX.
 15137     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15138     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15139                                    PB-ALT-CHG-SEQ-NO.
 15140
 15141     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15142     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15143     MOVE '2'                    TO PB-RECORD-TYPE.
 15144
 15145     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15146     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15147
 15148
 15149     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15150                                    PB-ALT-CHG-SEQ-NO
 15151                                    PB-C-LF-REF-CALC
 15152                                    PB-C-AH-REF-CALC
 15153                                    PB-C-LF-RFND-CLP
 15154                                    PB-C-AH-RFND-CLP
 15155                                    PB-CI-INSURED-AGE
 15156                                    PB-CI-LF-TERM
 15157                                    PB-CI-AH-TERM
 15158                                    PB-CI-LF-BENEFIT-CD
 15159                                    PB-CI-LF-BENEFIT-AMT
 15160                                    PB-CI-LF-ALT-BENEFIT-AMT
 15161                                    PB-CI-LF-PREMIUM-AMT
 15162                                    PB-CI-LF-ALT-PREMIUM-AMT
 15163                                    PB-CI-AH-BENEFIT-CD
 15164                                    PB-CI-AH-BENEFIT-AMT
 15165                                    PB-CI-AH-PREMIUM-AMT
 15166                                    PB-CI-PAY-FREQUENCY
 15167                                    PB-CI-LOAN-APR
 15168                                    PB-CI-LOAN-TERM
 15169                                    PB-CI-LIFE-COMMISSION
 15170                                    PB-CI-AH-COMMISSION
 15171                                    PB-CI-CURR-SEQ
 15172                                    PB-CI-AH-CANCEL-AMT
 15173                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 276
* EL6311.cbl
 15174                                    PB-CI-RATE-DEV-PCT-LF
 15175                                    PB-CI-RATE-DEV-PCT-AH
 15176                                    PB-CI-EXTENTION-DAYS
 15177                                    PB-CI-TERM-IN-DAYS
 15178                                    PB-CI-LIVES
 15179                                    PB-CI-LF-CRIT-PER
 15180                                    PB-CI-AH-CRIT-PER
 15181                                    PB-C-LF-REM-TERM
 15182                                    PB-C-AH-REM-TERM
 15183                                    PB-CHG-COUNT
 15184                                    PB-LF-BILLED-AMTS
 15185                                    PB-AH-BILLED-AMTS
 15186                                    PB-C-INT-ON-REFS
 15187*                                   PB-C-MICROFILM-NO
 15188                                    PB-CALC-TOLERANCE.
 15189
 15190     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15191                                    PB-CI-AH-SETTLEMENT-DT
 15192                                    PB-CI-DEATH-DT
 15193                                    PB-CI-LF-PRIOR-CANCEL-DT
 15194                                    PB-CI-AH-PRIOR-CANCEL-DT
 15195                                    PB-CI-ENTRY-DT
 15196                                    PB-CI-LF-EXPIRE-DT
 15197                                    PB-CI-AH-EXPIRE-DT
 15198                                    PB-CI-LOAN-1ST-PMT-DT
 15199                                    PB-C-LF-CANCEL-DT
 15200                                    PB-C-AH-CANCEL-DT
 15201                                    PB-CREDIT-ACCEPT-DT
 15202                                    PB-BILLED-DT
 15203                                    PB-ACCT-EFF-DT
 15204                                    PB-ACCT-EXP-DT.
 15205
 15206     MOVE 'X'                    TO PB-FATAL-FLAG.
 15207
 15208     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15209
 15210     IF CSUFIXL     GREATER THAN ZEROS
 15211        MOVE CSUFIXI             TO PB-CERT-SFX.
 15212
 15213*    IF CMICRNOL  GREATER  ZEROS
 15214*        IF CMICRNOI  NUMERIC
 15215*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15216*            MOVE AL-UNNON       TO  CMICRNOA
 15217*        ELSE
 15218*            MOVE -1             TO  CMICRNOL
 15219*            MOVE AL-UNBON       TO  CMICRNOA
 15220*            MOVE ER-2701        TO  EMI-ERROR
 15221*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15222
 15223     IF CLSTNML     GREATER THAN ZEROS
 15224        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15225
 15226     IF CCANREAL > ZEROS
 15227        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15228     END-IF
 15229     IF CCANDT1L    GREATER THAN ZEROS
 15230        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15231
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 277
* EL6311.cbl
 15232     IF CCANDT2L    GREATER THAN ZEROS
 15233        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15234
 15235     IF CMTHD1L    GREATER THAN +0
 15236        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15237
 15238     IF CMTHD2L    GREATER THAN +0
 15239        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15240
 15241     IF CREFND1L    GREATER THAN ZEROS
 15242        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15243        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15244     ELSE
 15245        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15246
 15247     IF CREFND2L    GREATER THAN ZEROS
 15248        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15249        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15250     ELSE
 15251        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15252
 15253     IF CLIVESL     GREATER THAN ZEROS
 15254        MOVE WS-CLIVES           TO PB-C-LIVES
 15255     ELSE
 15256        MOVE ZEROS               TO PB-C-LIVES.
 15257
 15258     IF CPAYEEL     GREATER THAN ZEROS
 15259        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15260
 15261     IF CFORCEL     GREATER THAN ZEROS
 15262        MOVE CFORCEI             TO PB-FORCE-CODE.
 15263
 15264     IF CBILCDL     GREATER THAN ZEROS
 15265        MOVE CBILCDI             TO PB-RECORD-BILL.
 15266
 15267*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15268
 15269 2260-WRITE-PB-RECORD.
 15270     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15271                                    PB-INPUT-BY.
 15272     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15273     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15274                                    PB-INPUT-DT.
 15275
 15276     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15277     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15278                                    PB-CONTROL-BY-ORIG-BATCH.
 15279
 15280     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15281     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15282     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15283     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15284     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15285
 15286     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15287
 15288     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15289
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 278
* EL6311.cbl
 15290     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15291     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15292     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15293
 15294     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15295     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15296
 15297 2275-WRITE-PENDING-BUSINESS.
 15298     MOVE 'A'                    TO JP-RECORD-TYPE.
 15299     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15300     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15301     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15302
 15303
 15304* EXEC CICS HANDLE CONDITION
 15305*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15306*    END-EXEC.
 15307*    MOVE '"$%                   ! 4 #00013766' TO DFHEIV0
 15308     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15310     MOVE X'3420233030303133373636' TO DFHEIV0(25:11)
 15311     CALL 'kxdfhei1' USING DFHEIV0
 15312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15313
 15314
 15315
 15316* EXEC CICS WRITE
 15317*        DATASET (FILE-ID-ERPNDB)
 15318*        FROM    (PENDING-BUSINESS)
 15319*        RIDFLD  (PB-CONTROL-PRIMARY)
 15320*    END-EXEC.
 15321     MOVE LENGTH OF
 15322      PENDING-BUSINESS
 15323       TO DFHEIV11
 15324*    MOVE '&$ L                  ''   #00013770' TO DFHEIV0
 15325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15327     MOVE X'2020233030303133373730' TO DFHEIV0(25:11)
 15328     CALL 'kxdfhei1' USING DFHEIV0,
 15329           FILE-ID-ERPNDB,
 15330           PENDING-BUSINESS,
 15331           DFHEIV11,
 15332           PB-CONTROL-PRIMARY,
 15333           DFHEIV99,
 15334           DFHEIV99
 15335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15336
 15337
 15338     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15339
 15340     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15341
 15342******************************************************************
 15343*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15344******************************************************************
 15345
 15346     display ' made it to add orig CANCEL cert '
 15347     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 279
* EL6311.cbl
 15348     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15349     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15350     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15351
 15352
 15353* EXEC CICS READ
 15354*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15355*        DATASET (FILE-ID-ELCERT)
 15356*        RIDFLD  (ELCERT-KEY)
 15357*        RESP    (WS-RESPONSE)
 15358*    END-EXEC.
 15359*    MOVE '&"S        E          (  N#00013790' TO DFHEIV0
 15360     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15362     MOVE X'204E233030303133373930' TO DFHEIV0(25:11)
 15363     CALL 'kxdfhei1' USING DFHEIV0,
 15364           FILE-ID-ELCERT,
 15365           DFHEIV20,
 15366           DFHEIV99,
 15367           ELCERT-KEY,
 15368           DFHEIV99,
 15369           DFHEIV99,
 15370           DFHEIV99
 15371     SET ADDRESS OF CERTIFICATE-MASTER TO
 15372         DFHEIV20
 15373     MOVE EIBRESP  TO WS-RESPONSE
 15374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15375
 15376
 15377     IF NOT RESP-NORMAL
 15378        GO TO 2276-BYPASS-CRTO
 15379     END-IF
 15380
 15381     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15382     MOVE ' '                    TO WS-ERMAIL-SW
 15383
 15384
 15385* EXEC CICS READ
 15386*       DATASET   (FILE-ID-ERMAIL)
 15387*       SET       (ADDRESS OF MAILING-DATA)
 15388*       RIDFLD    (ERMAIL-KEY)
 15389*       RESP      (WS-RESPONSE)
 15390*    END-EXEC
 15391*    MOVE '&"S        E          (  N#00013804' TO DFHEIV0
 15392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15394     MOVE X'204E233030303133383034' TO DFHEIV0(25:11)
 15395     CALL 'kxdfhei1' USING DFHEIV0,
 15396           FILE-ID-ERMAIL,
 15397           DFHEIV20,
 15398           DFHEIV99,
 15399           ERMAIL-KEY,
 15400           DFHEIV99,
 15401           DFHEIV99,
 15402           DFHEIV99
 15403     SET ADDRESS OF MAILING-DATA TO
 15404         DFHEIV20
 15405     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 280
* EL6311.cbl
 15406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15407
 15408     IF RESP-NORMAL
 15409        SET ERMAIL-FOUND TO TRUE
 15410     END-IF
 15411
 15412     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15413
 15414     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15415     MOVE 'OC'                   TO OC-RECORD-ID
 15416     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15417                                 TO OC-CONTROL-PRIMARY (1:33)
 15418     MOVE 'I'                    TO OC-RECORD-TYPE
 15419     MOVE +4096                  TO OC-KEY-SEQ-NO
 15420     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15421     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15422     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15423
 15424     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15425     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15426     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15427     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15428     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15429     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15430     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15431     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15432     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15433     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15434     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15435     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15436     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15437     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15438     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15439     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15440     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15441     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15442     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15443     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15444     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15445     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15446     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15447     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15448     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15449     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15450     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15451     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15452     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15453     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15454     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15455     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15456
 15457     IF ERMAIL-FOUND
 15458        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15459     END-IF
 15460     IF NOT CERT-TRL-REC-NOT-FOUND
 15461        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15462                           OC-INS-AGE-DEFAULT-FLAG
 15463        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 281
* EL6311.cbl
 15464                           OC-JNT-AGE-DEFAULT-FLAG
 15465     END-IF
 15466     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15467     .
 15468 2275-WRITE-ELCRTO.
 15469
 15470
 15471* EXEC CICS WRITE
 15472*       DATASET   ('ELCRTO')
 15473*       FROM      (ORIGINAL-CERTIFICATE)
 15474*       RIDFLD    (OC-CONTROL-PRIMARY)
 15475*       RESP      (WS-RESPONSE)
 15476*    END-EXEC
 15477     MOVE LENGTH OF
 15478      ORIGINAL-CERTIFICATE
 15479       TO DFHEIV11
 15480     MOVE 'ELCRTO' TO DFHEIV1
 15481*    MOVE '&$ L                  ''  N#00013873' TO DFHEIV0
 15482     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15484     MOVE X'204E233030303133383733' TO DFHEIV0(25:11)
 15485     CALL 'kxdfhei1' USING DFHEIV0,
 15486           DFHEIV1,
 15487           ORIGINAL-CERTIFICATE,
 15488           DFHEIV11,
 15489           OC-CONTROL-PRIMARY,
 15490           DFHEIV99,
 15491           DFHEIV99
 15492     MOVE EIBRESP  TO WS-RESPONSE
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15494
 15495     display ' just wrote 2275 ' ws-response
 15496     IF RESP-DUPKEY
 15497        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15498        GO TO 2275-WRITE-ELCRTO
 15499     ELSE
 15500        IF NOT RESP-NORMAL
 15501           MOVE -1               TO BMAINTL
 15502           MOVE ER-7450          TO EMI-ERROR
 15503           PERFORM 9900-ERROR-FORMAT
 15504                                 THRU 9900-EXIT
 15505           GO TO 8200-SEND-DATAONLY
 15506        END-IF
 15507     END-IF.
 15508
 15509 2276-BYPASS-CRTO.
 15510******************************************************************
 15511*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15512******************************************************************
 15513
 15514
 15515* EXEC CICS READ
 15516*        INTO    (PENDING-BUSINESS)
 15517*        DATASET (FILE-ID-ERPNDB)
 15518*        RIDFLD  (ERPNDB-KEY)
 15519*        UPDATE
 15520*    END-EXEC.
 15521     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 282
* EL6311.cbl
 15522      PENDING-BUSINESS
 15523       TO DFHEIV11
 15524*    MOVE '&"IL       EU         (   #00013899' TO DFHEIV0
 15525     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15526     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15527     MOVE X'2020233030303133383939' TO DFHEIV0(25:11)
 15528     CALL 'kxdfhei1' USING DFHEIV0,
 15529           FILE-ID-ERPNDB,
 15530           PENDING-BUSINESS,
 15531           DFHEIV11,
 15532           ERPNDB-KEY,
 15533           DFHEIV99,
 15534           DFHEIV99,
 15535           DFHEIV99
 15536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15537
 15538
 15539     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15540     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15541     MOVE 'B'                    TO JP-RECORD-TYPE.
 15542     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15543
 15544     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15545
 15546     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15547
 15548
 15549* EXEC CICS REWRITE
 15550*        DATASET (FILE-ID-ERPNDB)
 15551*        FROM    (PENDING-BUSINESS)
 15552*    END-EXEC.
 15553     MOVE LENGTH OF
 15554      PENDING-BUSINESS
 15555       TO DFHEIV11
 15556*    MOVE '&& L                  %   #00013915' TO DFHEIV0
 15557     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15558     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15559     MOVE X'2020233030303133393135' TO DFHEIV0(25:11)
 15560     CALL 'kxdfhei1' USING DFHEIV0,
 15561           FILE-ID-ERPNDB,
 15562           PENDING-BUSINESS,
 15563           DFHEIV11,
 15564           DFHEIV99
 15565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15566
 15567
 15568     MOVE 'C'                    TO JP-RECORD-TYPE.
 15569     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15570
 15571     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15572
 15573     IF WS-ERRORS-PRESENT
 15574        GO TO 3900-RE-DISPLAY-RECORD.
 15575
 15576     MOVE ZEROS                  TO EMI-ERROR.
 15577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15578     MOVE LOW-VALUES             TO EL631CI.
 15579     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 283
* EL6311.cbl
 15580     GO TO 8100-SEND-INITIAL-MAP.
 15581
 15582 2280-BATCH-HDR-NOT-FOUND.
 15583     MOVE -1                     TO BMAINTL.
 15584     MOVE ER-7450                TO EMI-ERROR.
 15585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15586     GO TO 8200-SEND-DATAONLY.
 15587
 15588 2290-DUPLICATE-ALT-INDEX.
 15589
 15590******************************************************************
 15591*                                                                *
 15592*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15593*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15594*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15595*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15596*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15597*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15598*                                                                *
 15599******************************************************************
 15600
 15601     IF LCP-ONCTR-02 =  0
 15602         ADD 1 TO LCP-ONCTR-02
 15603        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15604
 15605     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15606
 15607     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15608         NEXT SENTENCE
 15609     ELSE
 15610         ADD +1 TO PB-BATCH-SEQ-NO
 15611                   PB-CSR-BATCH-SEQ-NO
 15612         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15613         GO TO 2275-WRITE-PENDING-BUSINESS.
 15614
 15615     MOVE -1                     TO CCERTNOL.
 15616     MOVE AL-UABON               TO CCERTNOA.
 15617     MOVE AL-UNBON               TO CEFFDTA.
 15618
 15619     MOVE 1                      TO EMI-SUB
 15620                                    EMI-SWITCH1
 15621                                    EMI-SWITCH-AREA-1
 15622                                    EMI-SWITCH-AREA-2.
 15623
 15624     MOVE SPACES                 TO EMI-ERROR-LINES.
 15625
 15626
 15627* EXEC CICS SYNCPOINT ROLLBACK
 15628*    END-EXEC.
 15629*    MOVE '6"R                   !   #00013978' TO DFHEIV0
 15630     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15632     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 15633     CALL 'kxdfhei1' USING DFHEIV0
 15634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15635
 15636
 15637     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 284
* EL6311.cbl
 15638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15639     GO TO 8200-SEND-DATAONLY.
 15640
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 285
* EL6311.cbl
 15642
 15643******************************************************************
 15644*                                                                *
 15645*          C H A N G E   C A N C E L   R O U T I N E             *
 15646*                                                                *
 15647******************************************************************
 15648
 15649***************************************************************
 15650*                                                             *
 15651*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15652*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15653*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15654*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15655*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15656*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15657*     5. LINK TO THE EDIT ROUTINE.                            *
 15658*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15659*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15660*              THE EDIT ROUTINE.                              *
 15661*     7. REWRITE THE NEW ISSUE                                *
 15662*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15663*                                                             *
 15664***************************************************************
 15665 2300-CHANGE-CANCEL-ROUTINE.
 15666     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15667
 15668     IF CCHGL NOT = ZEROS
 15669        MOVE ER-2196             TO EMI-ERROR
 15670        MOVE AL-UABON            TO CMAINTA
 15671        MOVE -1                  TO CMAINTL
 15672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15673        GO TO 8200-SEND-DATAONLY.
 15674
 15675     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15676
 15677     IF CSUFIXL NOT = ZEROS
 15678        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15679     ELSE
 15680        MOVE SPACE               TO WS-NEW-SUFFIX.
 15681
 15682     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15683     PERFORM 8600-DEEDIT.
 15684     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15685     MOVE '4'                    TO DC-OPTION-CODE.
 15686
 15687     PERFORM 9700-DATE-LINK.
 15688
 15689     IF DATE-CONVERSION-ERROR
 15690        MOVE ER-0348             TO EMI-ERROR
 15691        MOVE -1                  TO CEFFDTL
 15692        MOVE AL-UABON            TO CEFFDTA
 15693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15694        GO TO 8200-SEND-DATAONLY
 15695     ELSE
 15696        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15697        MOVE AL-UANON            TO CEFFDTA
 15698        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15699
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 286
* EL6311.cbl
 15700 2325-PROCESS-CANCEL-CHANGES.
 15701
 15702* EXEC CICS HANDLE CONDITION
 15703*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15704*    END-EXEC.
 15705*    MOVE '"$I                   ! 5 #00014045' TO DFHEIV0
 15706     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15708     MOVE X'3520233030303134303435' TO DFHEIV0(25:11)
 15709     CALL 'kxdfhei1' USING DFHEIV0
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15711
 15712
 15713     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15714     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15715     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15716
 15717
 15718* EXEC CICS GETMAIN
 15719*        SET      (ADDRESS OF PENDING-BUSINESS)
 15720*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15721*        INITIMG  (GETMAIN-SPACE)
 15722*     END-EXEC.
 15723*    MOVE ',"IL                  $   #00014053' TO DFHEIV0
 15724     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15725     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15726     MOVE X'2020233030303134303533' TO DFHEIV0(25:11)
 15727     CALL 'kxdfhei1' USING DFHEIV0,
 15728           DFHEIV20,
 15729           ERPNDB-RECORD-LENGTH,
 15730           GETMAIN-SPACE
 15731     SET ADDRESS OF PENDING-BUSINESS TO
 15732         DFHEIV20
 15733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15734
 15735
 15736
 15737* EXEC CICS READ
 15738*        INTO    (PENDING-BUSINESS)
 15739*        DATASET (FILE-ID-ERPNDB)
 15740*        RIDFLD  (ERPNDB-KEY)
 15741*    END-EXEC.
 15742     MOVE LENGTH OF
 15743      PENDING-BUSINESS
 15744       TO DFHEIV11
 15745*    MOVE '&"IL       E          (   #00014059' TO DFHEIV0
 15746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15748     MOVE X'2020233030303134303539' TO DFHEIV0(25:11)
 15749     CALL 'kxdfhei1' USING DFHEIV0,
 15750           FILE-ID-ERPNDB,
 15751           PENDING-BUSINESS,
 15752           DFHEIV11,
 15753           ERPNDB-KEY,
 15754           DFHEIV99,
 15755           DFHEIV99,
 15756           DFHEIV99
 15757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 287
* EL6311.cbl
 15758
 15759
 15760     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15761
 15762
 15763* EXEC CICS HANDLE CONDITION
 15764*         NOTFND     (2385-REC-NOT-FOUND)
 15765*    END-EXEC.
 15766*    MOVE '"$I                   ! 6 #00014067' TO DFHEIV0
 15767     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15769     MOVE X'3620233030303134303637' TO DFHEIV0(25:11)
 15770     CALL 'kxdfhei1' USING DFHEIV0
 15771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15772
 15773
 15774**********************************************************
 15775*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15776*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15777**********************************************************
 15778
 15779
 15780* EXEC CICS READ
 15781*        DATASET (FILE-ID-ERPNDB)
 15782*        INTO    (PENDING-BUSINESS)
 15783*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15784*    END-EXEC.
 15785     MOVE LENGTH OF
 15786      PENDING-BUSINESS
 15787       TO DFHEIV11
 15788*    MOVE '&"IL       E          (   #00014076' TO DFHEIV0
 15789     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15791     MOVE X'2020233030303134303736' TO DFHEIV0(25:11)
 15792     CALL 'kxdfhei1' USING DFHEIV0,
 15793           FILE-ID-ERPNDB,
 15794           PENDING-BUSINESS,
 15795           DFHEIV11,
 15796           PI-PREV-CONTROL-PRIMARY,
 15797           DFHEIV99,
 15798           DFHEIV99,
 15799           DFHEIV99
 15800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15801
 15802
 15803********** DO NOT ALLOW CHANGES IF THRU A/R
 15804     IF BMAINTI = 'C'
 15805         IF PB-EL860-INTERNAL-PROCESS
 15806             MOVE ER-4005          TO EMI-ERROR
 15807             MOVE -1               TO BMAINTL
 15808             MOVE AL-UABON         TO BMAINTA
 15809             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15810             GO TO 8200-SEND-DATAONLY.
 15811**********
 15812
 15813     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15814        MOVE -1                 TO CMAINTL
 15815        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 288
* EL6311.cbl
 15816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15817        GO TO 8200-SEND-DATAONLY.
 15818
 15819     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15820        MOVE ER-2196             TO EMI-ERROR
 15821        MOVE AL-UABON            TO CMAINTA
 15822        MOVE -1                  TO CMAINTL
 15823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15824        GO TO 8200-SEND-DATAONLY.
 15825     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15826
 15827     IF PB-BILLED-DT = LOW-VALUES AND
 15828        PB-CHG-COUNT = ZEROS
 15829        NEXT SENTENCE
 15830     ELSE
 15831        IF (CREFND1L GREATER THAN ZEROS AND
 15832            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15833           OR
 15834           (CREFND2L GREATER THAN ZEROS AND
 15835            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15836           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15837     if ((crefnd1l <> zeros)
 15838        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15839                      or
 15840        ((crefnd2l <> zeros)
 15841        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15842        continue
 15843     else
 15844        go to 2330-continue-change
 15845     end-if
 15846
 15847     move zeros                  to ws-check-amts
 15848     move ' '                    to ws-stop-sw
 15849                                    ws-check-sw
 15850                                    ws-any-check-sw
 15851                                    ws-proc-check-sw
 15852                                    ws-chek-browse-sw
 15853
 15854     perform 2500-browse-checks  thru 2500-exit
 15855
 15856     if i-have-processed-checks
 15857        or i-have-checks
 15858        continue
 15859     else
 15860        go to 2330-continue-change
 15861     end-if
 15862
 15863     if crefnd1l <> zeros
 15864        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15865        move ws-crefnd1 to ws-new-ref-total
 15866     else
 15867        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15868     end-if
 15869     if crefnd2l <> zeros
 15870        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15871        compute ws-new-ref-total = ws-new-ref-total +
 15872           ws-crefnd2
 15873     else
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 289
* EL6311.cbl
 15874        compute ws-new-ref-total = ws-new-ref-total +
 15875           pb-c-ah-cancel-amt
 15876     end-if
 15877
 15878     if zeros = (ws-lf-diff + ws-ah-diff)
 15879        move er-3449             to emi-error
 15880        perform 9900-error-format thru 9900-exit
 15881        go to 2330-continue-change
 15882     end-if
 15883
 15884     if (ws-new-ref-total < ws-check-amts)
 15885        and (pb-c-refund-sw = 'Y')
 15886        move er-3447             to emi-error
 15887        perform 9900-error-format thru 9900-exit
 15888        move al-uabon            to cmainta
 15889        move -1                  to cmaintl
 15890        go to 8200-send-dataonly
 15891     end-if
 15892
 15893     if (ws-new-ref-total > ws-check-amts)
 15894        and (ws-check-amts not = zeros)
 15895        move er-3448             to emi-error
 15896        move al-uabon            to crefnd1a
 15897                                    crefnd2a
 15898        perform 9900-error-format thru 9900-exit
 15899     end-if
 15900
 15901*     if (ws-lf-diff + ws-ah-diff) < zeros
 15902*        move er-3447             to emi-error
 15903*        perform 9900-error-format thru 9900-exit
 15904*        move al-uabon            to cmainta
 15905*        move -1                  to cmaintl
 15906*        go to 8200-send-dataonly
 15907*     end-if
 15908     .
 15909 2330-continue-change.
 15910
 15911
 15912* EXEC CICS READ
 15913*        DATASET (FILE-ID-ERPNDB)
 15914*        INTO    (PENDING-BUSINESS)
 15915*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15916*        UPDATE
 15917*    END-EXEC.
 15918     MOVE LENGTH OF
 15919      PENDING-BUSINESS
 15920       TO DFHEIV11
 15921*    MOVE '&"IL       EU         (   #00014190' TO DFHEIV0
 15922     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15924     MOVE X'2020233030303134313930' TO DFHEIV0(25:11)
 15925     CALL 'kxdfhei1' USING DFHEIV0,
 15926           FILE-ID-ERPNDB,
 15927           PENDING-BUSINESS,
 15928           DFHEIV11,
 15929           PI-PREV-CONTROL-PRIMARY,
 15930           DFHEIV99,
 15931           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 290
* EL6311.cbl
 15932           DFHEIV99
 15933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15934
 15935
 15936     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15937     MOVE 'B'                    TO JP-RECORD-TYPE
 15938     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15939     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15940
 15941*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15942
 15943     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15944          PB-CHG-COUNT NOT = ZEROS
 15945        IF (CREFND1L GREATER THAN ZEROS AND
 15946            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15947           OR
 15948           (CREFND2L GREATER THAN ZEROS AND
 15949            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15950            ADD +1                      TO PB-CHG-COUNT
 15951            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15952
 15953*    IF CMICRNOL  GREATER  ZEROS
 15954*        IF CMICRNOI  NUMERIC
 15955*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15956*            MOVE AL-UNNON       TO  CMICRNOA
 15957*        ELSE
 15958*            MOVE -1             TO  CMICRNOL
 15959*            MOVE AL-UNBON       TO  CMICRNOA
 15960*            MOVE ER-2701        TO  EMI-ERROR
 15961*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15962
 15963     IF CSUFIXL GREATER THAN ZEROS
 15964        MOVE CSUFIXI             TO PB-CERT-SFX.
 15965
 15966     IF CLSTNML GREATER THAN ZEROS
 15967         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15968
 15969     IF CCANREAL > ZEROS
 15970        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15971     END-IF
 15972     IF CCANDT1L    GREATER THAN ZEROS
 15973        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15974
 15975     IF CCANDT2L    GREATER THAN ZEROS
 15976        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15977
 15978     IF CMTHD1L    GREATER THAN +0
 15979        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15980
 15981     IF CMTHD2L    GREATER THAN +0
 15982        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15983
 15984     IF CREFND1L    GREATER THAN ZEROS
 15985        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15986        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15987        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15988        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15989
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 291
* EL6311.cbl
 15990     IF CREFND2L    GREATER THAN ZEROS
 15991        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15992        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15993        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15994        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15995
 15996     IF CLIVESL     GREATER THAN ZEROS
 15997        MOVE WS-CLIVES           TO PB-C-LIVES.
 15998
 15999     IF CPAYEEL     GREATER THAN ZEROS
 16000        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 16001
 16002     IF CFORCEL     GREATER THAN ZEROS
 16003        MOVE CFORCEI             TO PB-FORCE-CODE.
 16004
 16005     IF CBILCDL     GREATER THAN ZEROS
 16006        MOVE CBILCDI             TO PB-RECORD-BILL.
 16007
 16008 2360-REWRITE-PB-RECORD.
 16009     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16010     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16011     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 16012*    MOVE 'C'                    TO JP-RECORD-TYPE.
 16013*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16014     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16015*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16016
 16017     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16018
 16019     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 16020     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 16021
 16022     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 16023
 16024     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 16025
 16026     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 16027     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 16028     MOVE PB-SV-STATE            TO PI-SV-STATE.
 16029
 16030     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 16031     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 16032
 16033 2375-REWRITE-PENDING-BUSINESS.
 16034     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 16035     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16036     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16037     MOVE 'C'                    TO JP-RECORD-TYPE.
 16038     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16039
 16040
 16041* EXEC CICS REWRITE
 16042*        DATASET (FILE-ID-ERPNDB)
 16043*        FROM    (PENDING-BUSINESS)
 16044*    END-EXEC.
 16045     MOVE LENGTH OF
 16046      PENDING-BUSINESS
 16047       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 292
* EL6311.cbl
 16048*    MOVE '&& L                  %   #00014301' TO DFHEIV0
 16049     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16051     MOVE X'2020233030303134333031' TO DFHEIV0(25:11)
 16052     CALL 'kxdfhei1' USING DFHEIV0,
 16053           FILE-ID-ERPNDB,
 16054           PENDING-BUSINESS,
 16055           DFHEIV11,
 16056           DFHEIV99
 16057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16058
 16059
 16060     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16061
 16062******************************************************************
 16063*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16064******************************************************************
 16065
 16066     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16067     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16068     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16069     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16070
 16071
 16072* EXEC CICS READ
 16073*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16074*        DATASET (FILE-ID-ELCERT)
 16075*        RIDFLD  (ELCERT-KEY)
 16076*        RESP    (WS-RESPONSE)
 16077*    END-EXEC.
 16078*    MOVE '&"S        E          (  N#00014317' TO DFHEIV0
 16079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16081     MOVE X'204E233030303134333137' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           FILE-ID-ELCERT,
 16084           DFHEIV20,
 16085           DFHEIV99,
 16086           ELCERT-KEY,
 16087           DFHEIV99,
 16088           DFHEIV99,
 16089           DFHEIV99
 16090     SET ADDRESS OF CERTIFICATE-MASTER TO
 16091         DFHEIV20
 16092     MOVE EIBRESP  TO WS-RESPONSE
 16093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16094
 16095
 16096     IF NOT RESP-NORMAL
 16097        GO TO 2376-BYPASS-CRTO
 16098     END-IF
 16099
 16100
 16101     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16102     MOVE ' '                    TO WS-ERMAIL-SW
 16103
 16104
 16105* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 293
* EL6311.cbl
 16106*       DATASET   (FILE-ID-ERMAIL)
 16107*       SET       (ADDRESS OF MAILING-DATA)
 16108*       RIDFLD    (ERMAIL-KEY)
 16109*       RESP      (WS-RESPONSE)
 16110*    END-EXEC
 16111*    MOVE '&"S        E          (  N#00014332' TO DFHEIV0
 16112     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16114     MOVE X'204E233030303134333332' TO DFHEIV0(25:11)
 16115     CALL 'kxdfhei1' USING DFHEIV0,
 16116           FILE-ID-ERMAIL,
 16117           DFHEIV20,
 16118           DFHEIV99,
 16119           ERMAIL-KEY,
 16120           DFHEIV99,
 16121           DFHEIV99,
 16122           DFHEIV99
 16123     SET ADDRESS OF MAILING-DATA TO
 16124         DFHEIV20
 16125     MOVE EIBRESP  TO WS-RESPONSE
 16126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16127
 16128     IF RESP-NORMAL
 16129        SET ERMAIL-FOUND TO TRUE
 16130     END-IF
 16131
 16132     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16133
 16134     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16135                                 TO ELCRTO-KEY
 16136     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16137     MOVE +0                     TO ELCRTO-SEQ-NO
 16138
 16139
 16140* EXEC CICS READ
 16141*       DATASET   ('ELCRTO')
 16142*       INTO      (ORIGINAL-CERTIFICATE)
 16143*       RIDFLD    (ELCRTO-KEY)
 16144*       GTEQ
 16145*       RESP      (WS-RESPONSE)
 16146*    END-EXEC
 16147     MOVE LENGTH OF
 16148      ORIGINAL-CERTIFICATE
 16149       TO DFHEIV11
 16150     MOVE 'ELCRTO' TO DFHEIV1
 16151*    MOVE '&"IL       G          (  N#00014350' TO DFHEIV0
 16152     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16154     MOVE X'204E233030303134333530' TO DFHEIV0(25:11)
 16155     CALL 'kxdfhei1' USING DFHEIV0,
 16156           DFHEIV1,
 16157           ORIGINAL-CERTIFICATE,
 16158           DFHEIV11,
 16159           ELCRTO-KEY,
 16160           DFHEIV99,
 16161           DFHEIV99,
 16162           DFHEIV99
 16163     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 294
* EL6311.cbl
 16164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16165
 16166     IF RESP-NORMAL
 16167        AND (OC-CONTROL-PRIMARY (1:33) =
 16168                 PB-CONTROL-BY-ACCOUNT (1:33))
 16169        AND (OC-RECORD-TYPE = 'I')
 16170        display ' resp norm, key =, type i '
 16171        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16172           display ' end proc blank '
 16173           display ' csr edit session ' PI-CSR-SESSION-SW
 16174           IF NOT CSR-EDIT-SESSION
 16175
 16176* EXEC CICS READ
 16177*                DATASET   ('ELCRTO')
 16178*                INTO      (ORIGINAL-CERTIFICATE)
 16179*                RIDFLD    (OC-CONTROL-PRIMARY)
 16180*                UPDATE
 16181*                RESP      (WS-RESPONSE)
 16182*             END-EXEC
 16183     MOVE LENGTH OF
 16184      ORIGINAL-CERTIFICATE
 16185       TO DFHEIV11
 16186     MOVE 'ELCRTO' TO DFHEIV1
 16187*    MOVE '&"IL       EU         (  N#00014367' TO DFHEIV0
 16188     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16189     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16190     MOVE X'204E233030303134333637' TO DFHEIV0(25:11)
 16191     CALL 'kxdfhei1' USING DFHEIV0,
 16192           DFHEIV1,
 16193           ORIGINAL-CERTIFICATE,
 16194           DFHEIV11,
 16195           OC-CONTROL-PRIMARY,
 16196           DFHEIV99,
 16197           DFHEIV99,
 16198           DFHEIV99
 16199     MOVE EIBRESP  TO WS-RESPONSE
 16200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16201              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16202              IF RESP-NORMAL
 16203                 display ' good read upd '
 16204                 IF OC-ISSUE-TRAN-IND = 'N'
 16205                    MOVE CM-INSURED-LAST-NAME   TO
 16206                         OC-INS-LAST-NAME
 16207                    MOVE CM-INSURED-FIRST-NAME  TO
 16208                         OC-INS-FIRST-NAME
 16209                    MOVE CM-INSURED-INITIAL2    TO
 16210                         OC-INS-MIDDLE-INIT
 16211                    MOVE CM-INSURED-ISSUE-AGE   TO
 16212                         OC-INS-AGE
 16213                    MOVE CM-JT-LAST-NAME        TO
 16214                         OC-JNT-LAST-NAME
 16215                    MOVE CM-JT-FIRST-NAME       TO
 16216                         OC-JNT-FIRST-NAME
 16217                    MOVE CM-JT-INITIAL          TO
 16218                         OC-JNT-MIDDLE-INIT
 16219                    MOVE CM-INSURED-JOINT-AGE   TO
 16220                         OC-JNT-AGE
 16221                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 295
* EL6311.cbl
 16222                         OC-LF-BENCD
 16223                    MOVE CM-LF-ORIG-TERM        TO
 16224                         OC-LF-TERM
 16225                    MOVE CM-LF-BENEFIT-AMT      TO
 16226                         OC-LF-BEN-AMT
 16227                    MOVE CM-LF-PREMIUM-AMT      TO
 16228                         OC-LF-PRM-AMT
 16229                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16230                         OC-LF-ALT-BEN-AMT
 16231                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16232                         OC-LF-ALT-PRM-AMT
 16233                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16234                         OC-LF-EXP-DT
 16235                    MOVE CM-LIFE-COMM-PCT       TO
 16236                         OC-LF-COMM-PCT
 16237                    MOVE CM-AH-BENEFIT-CD       TO
 16238                         OC-AH-BENCD
 16239                    MOVE CM-AH-ORIG-TERM        TO
 16240                         OC-AH-TERM
 16241                    MOVE CM-AH-BENEFIT-AMT      TO
 16242                         OC-AH-BEN-AMT
 16243                    MOVE CM-AH-PREMIUM-AMT      TO
 16244                         OC-AH-PRM-AMT
 16245                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16246                         OC-AH-EXP-DT
 16247                    MOVE CM-AH-COMM-PCT         TO
 16248                         OC-AH-COMM-PCT
 16249                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16250                         OC-AH-CP
 16251                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16252                         OC-1ST-PMT-DT
 16253                 END-IF
 16254                 MOVE PB-C-LF-CANCEL-DT      TO
 16255                         OC-LF-CANCEL-DT
 16256                 MOVE PB-C-LF-CANCEL-AMT     TO
 16257                         OC-LF-CANCEL-AMT
 16258                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16259                         OC-LF-ITD-CANCEL-AMT
 16260                 MOVE PB-C-AH-CANCEL-DT      TO
 16261                         OC-AH-CANCEL-DT
 16262                 MOVE PB-C-AH-CANCEL-AMT     TO
 16263                         OC-AH-CANCEL-AMT
 16264                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16265                         OC-AH-ITD-CANCEL-AMT
 16266                 MOVE 'Y'                    TO
 16267                         OC-CANCEL-TRAN-IND
 16268                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16269                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16270                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16271                 IF ERMAIL-FOUND
 16272                    MOVE MA-CRED-BENE-NAME
 16273                                 TO OC-CRED-BENE-NAME
 16274                 END-IF
 16275                 IF NOT CERT-TRL-REC-NOT-FOUND
 16276                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16277                           OC-INS-AGE-DEFAULT-FLAG
 16278                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16279                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 296
* EL6311.cbl
 16280                 END-IF
 16281
 16282* EXEC CICS REWRITE
 16283*                   DATASET   ('ELCRTO')
 16284*                   FROM      (ORIGINAL-CERTIFICATE)
 16285*                   RESP      (WS-RESPONSE)
 16286*                END-EXEC
 16287     MOVE LENGTH OF
 16288      ORIGINAL-CERTIFICATE
 16289       TO DFHEIV11
 16290     MOVE 'ELCRTO' TO DFHEIV1
 16291*    MOVE '&& L                  %  N#00014454' TO DFHEIV0
 16292     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16293     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16294     MOVE X'204E233030303134343534' TO DFHEIV0(25:11)
 16295     CALL 'kxdfhei1' USING DFHEIV0,
 16296           DFHEIV1,
 16297           ORIGINAL-CERTIFICATE,
 16298           DFHEIV11,
 16299           DFHEIV99
 16300     MOVE EIBRESP  TO WS-RESPONSE
 16301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16302                 display ' just rewrote ' ws-response
 16303              END-IF
 16304           END-IF
 16305        ELSE
 16306           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16307           MOVE 'OC'             TO OC-RECORD-ID
 16308           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16309           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16310           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16311           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16312           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16313           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16314           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16315           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16316           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16317           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16318           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16319           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16320           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16321           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16322           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16323           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16324           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16325           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16326           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16327           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16328           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16329           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16330           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16331           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16332           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16333           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16334           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16335           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16336           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16337           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 297
* EL6311.cbl
 16338           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16339           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16340           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16341           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16342           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16343           IF ERMAIL-FOUND
 16344              MOVE MA-CRED-BENE-NAME
 16345                                 TO OC-CRED-BENE-NAME
 16346           END-IF
 16347           IF NOT CERT-TRL-REC-NOT-FOUND
 16348              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16349                           OC-INS-AGE-DEFAULT-FLAG
 16350              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16351                           OC-JNT-AGE-DEFAULT-FLAG
 16352           END-IF
 16353           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16354
 16355* EXEC CICS WRITE
 16356*             DATASET   ('ELCRTO')
 16357*             FROM      (ORIGINAL-CERTIFICATE)
 16358*             RIDFLD    (OC-CONTROL-PRIMARY)
 16359*             RESP      (WS-RESPONSE)
 16360*          END-EXEC
 16361     MOVE LENGTH OF
 16362      ORIGINAL-CERTIFICATE
 16363       TO DFHEIV11
 16364     MOVE 'ELCRTO' TO DFHEIV1
 16365*    MOVE '&$ L                  ''  N#00014511' TO DFHEIV0
 16366     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16368     MOVE X'204E233030303134353131' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0,
 16370           DFHEIV1,
 16371           ORIGINAL-CERTIFICATE,
 16372           DFHEIV11,
 16373           OC-CONTROL-PRIMARY,
 16374           DFHEIV99,
 16375           DFHEIV99
 16376     MOVE EIBRESP  TO WS-RESPONSE
 16377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16378        END-IF
 16379     ELSE
 16380        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16381        MOVE 'OC'                TO OC-RECORD-ID
 16382        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16383                                 TO OC-CONTROL-PRIMARY (1:33)
 16384        MOVE 'I'                 TO OC-RECORD-TYPE
 16385        MOVE +4096               TO OC-KEY-SEQ-NO
 16386        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16387        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16388        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16389        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16390        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16391        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16392        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16393        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16394        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16395        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 298
* EL6311.cbl
 16396        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16397        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16398        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16399        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16400        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16401        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16402        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16403        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16404        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16405        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16406        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16407        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16408        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16409        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16410        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16411        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16412        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16413        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16414        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16415        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16416        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16417        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16418        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16419        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16420        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16421        IF ERMAIL-FOUND
 16422           MOVE MA-CRED-BENE-NAME
 16423                                 TO OC-CRED-BENE-NAME
 16424        END-IF
 16425        IF NOT CERT-TRL-REC-NOT-FOUND
 16426           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16427                           OC-INS-AGE-DEFAULT-FLAG
 16428           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16429                           OC-JNT-AGE-DEFAULT-FLAG
 16430        END-IF
 16431        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16432
 16433
 16434* EXEC CICS WRITE
 16435*          DATASET   ('ELCRTO')
 16436*          FROM      (ORIGINAL-CERTIFICATE)
 16437*          RIDFLD    (OC-CONTROL-PRIMARY)
 16438*          RESP      (WS-RESPONSE)
 16439*       END-EXEC
 16440     MOVE LENGTH OF
 16441      ORIGINAL-CERTIFICATE
 16442       TO DFHEIV11
 16443     MOVE 'ELCRTO' TO DFHEIV1
 16444*    MOVE '&$ L                  ''  N#00014572' TO DFHEIV0
 16445     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16447     MOVE X'204E233030303134353732' TO DFHEIV0(25:11)
 16448     CALL 'kxdfhei1' USING DFHEIV0,
 16449           DFHEIV1,
 16450           ORIGINAL-CERTIFICATE,
 16451           DFHEIV11,
 16452           OC-CONTROL-PRIMARY,
 16453           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 299
* EL6311.cbl
 16454           DFHEIV99
 16455     MOVE EIBRESP  TO WS-RESPONSE
 16456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16457     END-IF.
 16458
 16459 2376-BYPASS-CRTO.
 16460******************************************************************
 16461*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16462******************************************************************
 16463
 16464
 16465* EXEC CICS HANDLE CONDITION
 16466*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16467*    END-EXEC.
 16468*    MOVE '"$I                   ! 7 #00014585' TO DFHEIV0
 16469     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16471     MOVE X'3720233030303134353835' TO DFHEIV0(25:11)
 16472     CALL 'kxdfhei1' USING DFHEIV0
 16473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16474
 16475
 16476
 16477* EXEC CICS READ
 16478*        INTO    (PENDING-BUSINESS)
 16479*        DATASET (FILE-ID-ERPNDB)
 16480*        RIDFLD  (ERPNDB-KEY)
 16481*        UPDATE
 16482*    END-EXEC.
 16483     MOVE LENGTH OF
 16484      PENDING-BUSINESS
 16485       TO DFHEIV11
 16486*    MOVE '&"IL       EU         (   #00014589' TO DFHEIV0
 16487     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16488     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16489     MOVE X'2020233030303134353839' TO DFHEIV0(25:11)
 16490     CALL 'kxdfhei1' USING DFHEIV0,
 16491           FILE-ID-ERPNDB,
 16492           PENDING-BUSINESS,
 16493           DFHEIV11,
 16494           ERPNDB-KEY,
 16495           DFHEIV99,
 16496           DFHEIV99,
 16497           DFHEIV99
 16498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16499
 16500
 16501     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16502     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16503     MOVE 'B'                    TO JP-RECORD-TYPE.
 16504     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16505
 16506     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16507
 16508     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16509
 16510
 16511* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 300
* EL6311.cbl
 16512*        DATASET (FILE-ID-ERPNDB)
 16513*        FROM    (PENDING-BUSINESS)
 16514*    END-EXEC.
 16515     MOVE LENGTH OF
 16516      PENDING-BUSINESS
 16517       TO DFHEIV11
 16518*    MOVE '&& L                  %   #00014605' TO DFHEIV0
 16519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16521     MOVE X'2020233030303134363035' TO DFHEIV0(25:11)
 16522     CALL 'kxdfhei1' USING DFHEIV0,
 16523           FILE-ID-ERPNDB,
 16524           PENDING-BUSINESS,
 16525           DFHEIV11,
 16526           DFHEIV99
 16527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16528
 16529
 16530     MOVE 'C'                    TO JP-RECORD-TYPE.
 16531     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16532
 16533     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16534
 16535     IF WS-ERRORS-PRESENT
 16536         GO TO 3900-RE-DISPLAY-RECORD.
 16537
 16538     MOVE ZEROS                  TO EMI-ERROR
 16539     MOVE -1                     TO CMAINTL
 16540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16541     GO TO 3900-RE-DISPLAY-RECORD.
 16542
 16543 2380-BATCH-HDR-NOT-FOUND.
 16544     MOVE -1                     TO BMAINTL.
 16545     MOVE ER-7450                TO EMI-ERROR.
 16546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16547     GO TO 8200-SEND-DATAONLY.
 16548
 16549 2385-REC-NOT-FOUND.
 16550     MOVE -1                     TO BMAINTL.
 16551     MOVE ER-7451                TO EMI-ERROR.
 16552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16553     GO TO 8200-SEND-DATAONLY.
 16554
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 301
* EL6311.cbl
 16556
 16557******************************************************************
 16558*                                                                *
 16559*          D E L E T E   C A N C E L   R O U T I N E             *
 16560*                                                                *
 16561******************************************************************
 16562
 16563 2400-DELETE-CANCEL-ROUTINE.
 16564     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16565
 16566     IF CCHGL NOT = ZEROS
 16567        MOVE ER-2196             TO EMI-ERROR
 16568        MOVE AL-UABON            TO CMAINTA
 16569        MOVE -1                  TO CMAINTL
 16570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16571        GO TO 8200-SEND-DATAONLY.
 16572
 16573
 16574* EXEC CICS HANDLE CONDITION
 16575*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16576*    END-EXEC.
 16577*    MOVE '"$I                   ! 8 #00014653' TO DFHEIV0
 16578     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16580     MOVE X'3820233030303134363533' TO DFHEIV0(25:11)
 16581     CALL 'kxdfhei1' USING DFHEIV0
 16582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16583
 16584
 16585     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16586     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16587     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16588
 16589
 16590* EXEC CICS READ
 16591*        SET     (ADDRESS OF PENDING-BUSINESS)
 16592*        DATASET (FILE-ID-ERPNDB)
 16593*        RIDFLD  (ERPNDB-KEY)
 16594*    END-EXEC.
 16595*    MOVE '&"S        E          (   #00014661' TO DFHEIV0
 16596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16598     MOVE X'2020233030303134363631' TO DFHEIV0(25:11)
 16599     CALL 'kxdfhei1' USING DFHEIV0,
 16600           FILE-ID-ERPNDB,
 16601           DFHEIV20,
 16602           DFHEIV99,
 16603           ERPNDB-KEY,
 16604           DFHEIV99,
 16605           DFHEIV99,
 16606           DFHEIV99
 16607     SET ADDRESS OF PENDING-BUSINESS TO
 16608         DFHEIV20
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16613
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 302
* EL6311.cbl
 16614     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16615
 16616     IF CSUFIXL NOT = ZEROS
 16617        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16618     ELSE
 16619        MOVE SPACE               TO WS-NEW-SUFFIX.
 16620
 16621     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16622
 16623     PERFORM 8600-DEEDIT.
 16624     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16625     MOVE '4'                    TO DC-OPTION-CODE.
 16626     PERFORM 9700-DATE-LINK.
 16627
 16628     IF DATE-CONVERSION-ERROR
 16629        MOVE ER-0348             TO EMI-ERROR
 16630        MOVE -1                  TO CEFFDTL
 16631        MOVE AL-UABON            TO CEFFDTA
 16632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633        GO TO 8200-SEND-DATAONLY
 16634     ELSE
 16635        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16636        MOVE AL-UANON            TO CEFFDTA
 16637        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16638
 16639
 16640* EXEC CICS HANDLE CONDITION
 16641*         NOTFND    (2490-RECORD-NOT-FOUND)
 16642*    END-EXEC.
 16643*    MOVE '"$I                   ! 9 #00014694' TO DFHEIV0
 16644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16646     MOVE X'3920233030303134363934' TO DFHEIV0(25:11)
 16647     CALL 'kxdfhei1' USING DFHEIV0
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16649
 16650
 16651
 16652* EXEC CICS READ
 16653*        SET     (ADDRESS OF PENDING-BUSINESS)
 16654*        DATASET (FILE-ID-ERPNDB)
 16655*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16656*        UPDATE
 16657*    END-EXEC.
 16658*    MOVE '&"S        EU         (   #00014698' TO DFHEIV0
 16659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16661     MOVE X'2020233030303134363938' TO DFHEIV0(25:11)
 16662     CALL 'kxdfhei1' USING DFHEIV0,
 16663           FILE-ID-ERPNDB,
 16664           DFHEIV20,
 16665           DFHEIV99,
 16666           PI-PREV-CONTROL-PRIMARY,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           DFHEIV99
 16670     SET ADDRESS OF PENDING-BUSINESS TO
 16671         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 303
* EL6311.cbl
 16672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16673
 16674
 16675     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16676        MOVE -1                 TO CMAINTL
 16677        MOVE ER-2197            TO EMI-ERROR
 16678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16679        GO TO 8200-SEND-DATAONLY.
 16680
 16681     IF PB-BILLED-DT NOT = LOW-VALUES
 16682        MOVE -1                 TO CMAINTL
 16683        MOVE ER-2129            TO EMI-ERROR
 16684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16685        GO TO 8200-SEND-DATAONLY.
 16686
 16687     IF PB-CHG-COUNT NOT = ZEROS
 16688        MOVE ER-2336            TO EMI-ERROR
 16689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16690        MOVE AL-UABON            TO CMAINTA
 16691        MOVE -1                  TO CMAINTL
 16692        GO TO 8200-SEND-DATAONLY.
 16693
 16694     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16695        PB-CHG-COUNT NOT = ZEROS
 16696        MOVE ER-2196             TO EMI-ERROR
 16697        MOVE AL-UABON            TO CMAINTA
 16698        MOVE -1                  TO CMAINTL
 16699        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16700        GO TO 8200-SEND-DATAONLY.
 16701
 16702     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16703        MOVE ER-2900 TO EMI-ERROR
 16704        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16705        MOVE AL-UABON         TO CMAINTA
 16706        MOVE -1               TO CMAINTL
 16707        GO TO 8200-SEND-DATAONLY.
 16708     move ' '                    to ws-stop-sw
 16709                                    ws-check-sw
 16710                                    ws-any-check-sw
 16711                                    ws-proc-check-sw
 16712                                    ws-chek-browse-sw
 16713
 16714     perform 2500-browse-checks  thru 2500-exit
 16715     if (i-have-processed-checks)
 16716        and (pb-c-refund-sw = 'Y')
 16717        move er-3446             to emi-error
 16718        perform 9900-error-format thru 9900-exit
 16719        move al-uabon            to cmainta
 16720        move -1                  to cmaintl
 16721        go to 8200-send-dataonly
 16722     end-if
 16723
 16724* EXEC CICS HANDLE CONDITION
 16725*         NOTFND  (2475-CONTINUE-DELETE)
 16726*    END-EXEC
 16727*    MOVE '"$I                   ! : #00014753' TO DFHEIV0
 16728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 304
* EL6311.cbl
 16730     MOVE X'3A20233030303134373533' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0
 16732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16733
 16734     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16735     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16736     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16737     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16738
 16739
 16740* EXEC CICS READ
 16741*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16742*        DATASET (FILE-ID-ELCERT)
 16743*        RIDFLD  (ELCERT-KEY)
 16744*        UPDATE
 16745*    END-EXEC.
 16746*    MOVE '&"S        EU         (   #00014762' TO DFHEIV0
 16747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16749     MOVE X'2020233030303134373632' TO DFHEIV0(25:11)
 16750     CALL 'kxdfhei1' USING DFHEIV0,
 16751           FILE-ID-ELCERT,
 16752           DFHEIV20,
 16753           DFHEIV99,
 16754           ELCERT-KEY,
 16755           DFHEIV99,
 16756           DFHEIV99,
 16757           DFHEIV99
 16758     SET ADDRESS OF CERTIFICATE-MASTER TO
 16759         DFHEIV20
 16760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16761
 16762
 16763     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16764
 16765     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16766     MOVE 'B'                    TO JP-RECORD-TYPE.
 16767     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16768     PERFORM 8400-LOG-JOURNAL-RECORD.
 16769
 16770     IF PB-CI-LIVES NOT NUMERIC
 16771         MOVE ZERO                    TO PB-CI-LIVES.
 16772
 16773     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16774        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16775           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16776           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16777           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16778                                            CM-LF-CANCEL-DT
 16779           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16780        ELSE
 16781           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16782           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16783           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16784           MOVE PB-CI-LIVES              TO CM-LIVES.
 16785
 16786     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16787        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 305
* EL6311.cbl
 16788           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16789               MOVE CM-LF-STATUS-AT-CANCEL
 16790                                        TO CM-LF-CURRENT-STATUS
 16791               MOVE SPACE
 16792                                        TO CM-LF-STATUS-AT-CANCEL
 16793           ELSE
 16794               MOVE PB-CI-LF-POLICY-STATUS
 16795                                        TO CM-LF-CURRENT-STATUS
 16796        ELSE
 16797           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16798
 16799
 16800     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16801        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16802           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16803           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16804           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16805                                            CM-AH-CANCEL-DT
 16806           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16807        ELSE
 16808           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16809           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16810           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16811           MOVE PB-CI-LIVES              TO CM-LIVES.
 16812
 16813     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16814        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16815           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16816               MOVE CM-AH-STATUS-AT-CANCEL
 16817                                        TO CM-AH-CURRENT-STATUS
 16818               MOVE SPACE
 16819                                        TO CM-AH-STATUS-AT-CANCEL
 16820           ELSE
 16821               MOVE PB-CI-AH-POLICY-STATUS
 16822                                        TO CM-AH-CURRENT-STATUS
 16823        ELSE
 16824           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16825
 16826 2450-REWRITE-CERT.
 16827     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16828     MOVE 'C'                      TO JP-RECORD-TYPE.
 16829     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16830
 16831
 16832* EXEC CICS REWRITE
 16833*        DATASET  (FILE-ID-ELCERT)
 16834*        FROM     (CERTIFICATE-MASTER)
 16835*    END-EXEC.
 16836     MOVE LENGTH OF
 16837      CERTIFICATE-MASTER
 16838       TO DFHEIV11
 16839*    MOVE '&& L                  %   #00014837' TO DFHEIV0
 16840     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16842     MOVE X'2020233030303134383337' TO DFHEIV0(25:11)
 16843     CALL 'kxdfhei1' USING DFHEIV0,
 16844           FILE-ID-ELCERT,
 16845           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 306
* EL6311.cbl
 16846           DFHEIV11,
 16847           DFHEIV99
 16848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16849
 16850
 16851     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16852
 16853     PERFORM 8400-LOG-JOURNAL-RECORD.
 16854
 16855     move ' '                    to ws-stop-sw
 16856                                    ws-any-check-sw
 16857                                    ws-proc-check-sw
 16858                                    ws-chek-browse-sw
 16859
 16860     if i-have-checks
 16861        perform until i-say-stop
 16862           perform 2510-startbr-erchek
 16863                                 thru 2510-exit
 16864           if resp-normal
 16865              perform 2520-readnext-erchek
 16866                                 thru 2520-exit
 16867           end-if
 16868           if (not resp-normal)
 16869              or (pb-control-by-account (1:33) not =
 16870                 ch-control-primary (1:33))
 16871                 set i-say-stop to true
 16872           else
 16873              perform 2530-readupd-erchek
 16874                                 thru 2530-exit
 16875              if resp-normal
 16876                 perform 2540-delete-erchek
 16877                                 thru 2540-exit
 16878              end-if
 16879              if ws-chek-browse-sw = 'Y'
 16880                 perform 2525-endbr-erchek
 16881                                 thru 2525-exit
 16882                 move ' '        to ws-chek-browse-sw
 16883              end-if
 16884           end-if
 16885        end-perform
 16886     end-if
 16887
 16888     if ws-chek-browse-sw = 'Y'
 16889        perform 2525-endbr-erchek thru 2525-exit
 16890     end-if
 16891     .
 16892 2475-CONTINUE-DELETE.
 16893     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16894     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16895
 16896     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16897     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16898
 16899     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16900
 16901     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16902     MOVE 'D'                    TO JP-RECORD-TYPE
 16903     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 307
* EL6311.cbl
 16904
 16905
 16906* EXEC CICS DELETE
 16907*        DATASET    (FILE-ID-ERPNDB)
 16908*    END-EXEC.
 16909*    MOVE '&(                    &   #00014896' TO DFHEIV0
 16910     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16911     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16912     MOVE X'2020233030303134383936' TO DFHEIV0(25:11)
 16913     CALL 'kxdfhei1' USING DFHEIV0,
 16914           FILE-ID-ERPNDB,
 16915           DFHEIV99,
 16916           DFHEIV99,
 16917           DFHEIV99,
 16918           DFHEIV99
 16919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16920
 16921
 16922     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16923
 16924     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16925
 16926     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16927     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16928
 16929
 16930* EXEC CICS HANDLE CONDITION
 16931*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16932*    END-EXEC.
 16933*    MOVE '"$I                   ! ; #00014907' TO DFHEIV0
 16934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16936     MOVE X'3B20233030303134393037' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0
 16938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16939
 16940
 16941
 16942* EXEC CICS READ
 16943*        SET     (ADDRESS OF PENDING-BUSINESS)
 16944*        DATASET (FILE-ID-ERPNDB)
 16945*        RIDFLD  (ERPNDB-KEY)
 16946*        UPDATE
 16947*    END-EXEC.
 16948*    MOVE '&"S        EU         (   #00014911' TO DFHEIV0
 16949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16951     MOVE X'2020233030303134393131' TO DFHEIV0(25:11)
 16952     CALL 'kxdfhei1' USING DFHEIV0,
 16953           FILE-ID-ERPNDB,
 16954           DFHEIV20,
 16955           DFHEIV99,
 16956           ERPNDB-KEY,
 16957           DFHEIV99,
 16958           DFHEIV99,
 16959           DFHEIV99
 16960     SET ADDRESS OF PENDING-BUSINESS TO
 16961         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 308
* EL6311.cbl
 16962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16963
 16964
 16965     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16966     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16967
 16968     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16969        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16970        MOVE 'D'                 TO JP-RECORD-TYPE
 16971        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16972
 16973* EXEC CICS DELETE
 16974*            DATASET    (FILE-ID-ERPNDB)
 16975*       END-EXEC
 16976*    MOVE '&(                    &   #00014925' TO DFHEIV0
 16977     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16978     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16979     MOVE X'2020233030303134393235' TO DFHEIV0(25:11)
 16980     CALL 'kxdfhei1' USING DFHEIV0,
 16981           FILE-ID-ERPNDB,
 16982           DFHEIV99,
 16983           DFHEIV99,
 16984           DFHEIV99,
 16985           DFHEIV99
 16986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16987        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16988     ELSE
 16989        MOVE 'B'                 TO JP-RECORD-TYPE
 16990        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16991        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16992        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16993        MOVE 'C'                 TO JP-RECORD-TYPE
 16994        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16995
 16996* EXEC CICS REWRITE
 16997*            DATASET    (FILE-ID-ERPNDB)
 16998*            FROM       (PENDING-BUSINESS)
 16999*       END-EXEC
 17000     MOVE LENGTH OF
 17001      PENDING-BUSINESS
 17002       TO DFHEIV11
 17003*    MOVE '&& L                  %   #00014936' TO DFHEIV0
 17004     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17006     MOVE X'2020233030303134393336' TO DFHEIV0(25:11)
 17007     CALL 'kxdfhei1' USING DFHEIV0,
 17008           FILE-ID-ERPNDB,
 17009           PENDING-BUSINESS,
 17010           DFHEIV11,
 17011           DFHEIV99
 17012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17013        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 17014     end-if
 17015
 17016******************************************************************
 17017*                                                                *
 17018*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 17019*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 309
* EL6311.cbl
 17020*                                                                *
 17021******************************************************************
 17022
 17023     IF NOT PI-AR-PROCESSING
 17024        GO TO 2480-DELETE-FINISHED.
 17025
 17026     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 17027        WS-B-CANCEL-CNT-ENTERED = ZEROS
 17028        NEXT SENTENCE
 17029     ELSE
 17030        GO TO 2480-DELETE-FINISHED.
 17031
 17032
 17033* EXEC CICS HANDLE CONDITION
 17034*         NOTFND    (2480-DELETE-FINISHED)
 17035*    END-EXEC.
 17036*    MOVE '"$I                   ! < #00014959' TO DFHEIV0
 17037     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17039     MOVE X'3C20233030303134393539' TO DFHEIV0(25:11)
 17040     CALL 'kxdfhei1' USING DFHEIV0
 17041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17042
 17043
 17044     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17045     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17046
 17047
 17048* EXEC CICS READ
 17049*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17050*        DATASET (FILE-ID-ERRQST)
 17051*        RIDFLD  (ERRQST-KEY)
 17052*        UPDATE
 17053*    END-EXEC.
 17054*    MOVE '&"S        EU         (   #00014966' TO DFHEIV0
 17055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17056     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17057     MOVE X'2020233030303134393636' TO DFHEIV0(25:11)
 17058     CALL 'kxdfhei1' USING DFHEIV0,
 17059           FILE-ID-ERRQST,
 17060           DFHEIV20,
 17061           DFHEIV99,
 17062           ERRQST-KEY,
 17063           DFHEIV99,
 17064           DFHEIV99,
 17065           DFHEIV99
 17066     SET ADDRESS OF AR-REQUEST-RECORD TO
 17067         DFHEIV20
 17068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17069
 17070
 17071     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17072
 17073     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17074
 17075     MOVE 'D'                      TO JP-RECORD-TYPE.
 17076     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17077
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 310
* EL6311.cbl
 17078
 17079* EXEC CICS DELETE
 17080*         DATASET    (FILE-ID-ERRQST)
 17081*    END-EXEC.
 17082*    MOVE '&(                    &   #00014980' TO DFHEIV0
 17083     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17085     MOVE X'2020233030303134393830' TO DFHEIV0(25:11)
 17086     CALL 'kxdfhei1' USING DFHEIV0,
 17087           FILE-ID-ERRQST,
 17088           DFHEIV99,
 17089           DFHEIV99,
 17090           DFHEIV99,
 17091           DFHEIV99
 17092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17093
 17094
 17095     PERFORM 8400-LOG-JOURNAL-RECORD.
 17096
 17097 2480-DELETE-FINISHED.
 17098     MOVE ZEROS                  TO EMI-ERROR.
 17099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17100     MOVE LOW-VALUES             TO EL631CI.
 17101     MOVE -1                     TO CMAINTL.
 17102     GO TO 8100-SEND-INITIAL-MAP.
 17103
 17104 2485-BATCH-HDR-NOT-FOUND.
 17105     MOVE -1                     TO CMAINTL
 17106     MOVE AL-UABON               TO CMAINTA.
 17107     MOVE ER-7450                TO EMI-ERROR.
 17108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17109     GO TO 8200-SEND-DATAONLY.
 17110
 17111 2490-RECORD-NOT-FOUND.
 17112     MOVE -1                     TO CMAINTL
 17113     MOVE AL-UABON               TO CMAINTA.
 17114     MOVE ER-7451                TO EMI-ERROR.
 17115     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17116     GO TO 8200-SEND-DATAONLY.
 17117***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17118***                                                            ***
 17119***     2500  B R O W S E   C H E C K S                        ***
 17120***  We perform this routine from 2 different places.          ***
 17121***  1. If the user changes the refund amount on a cancel, we  ***
 17122***    want to.........                                        ***
 17123***    a. determine if prior checks have been processed        ***
 17124***    b. If the amt is larger, display message instructing    ***
 17125***     them to create another check to make up the difference.***
 17126***    c. If the amt is less, do not allow the change and      ***
 17127***     display a FATAL error suggesting they deal with check  ***
 17128***     records befor continuing.                              ***
 17129***  2. If the user wants to delete a cancel record we......   ***
 17130***    a. browse through all the checks and if there is a      ***
 17131***     processed check, send FATAL message.                   ***
 17132***    b. If there is a non-released check, then delete that   ***
 17133***     check after you delete the pending cancel record.      ***
 17134***                                                            ***
 17135***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 311
* EL6311.cbl
 17136
 17137 2500-browse-checks.
 17138
 17139     perform 2510-startbr-erchek thru 2510-exit
 17140
 17141     if not resp-normal
 17142        go to 2500-exit
 17143     end-if
 17144
 17145     perform until i-say-stop
 17146        perform 2520-readnext-erchek
 17147                                 thru 2520-exit
 17148        if (not resp-normal)
 17149           or (pb-control-by-account (1:33) not =
 17150              ch-control-primary (1:33))
 17151              set i-say-stop to true
 17152        else
 17153           set i-have-a-check-period to true
 17154           if (ch-approval-status) = ' '
 17155              and (ch-void-dt = low-values)
 17156              and (ch-released-dt = low-values)
 17157              set i-have-checks to true
 17158           else
 17159              if ch-void-dt = low-values
 17160                 set i-have-processed-checks to true
 17161              end-if
 17162           end-if
 17163           if (ch-credit-accept-dt = low-values)
 17164              and (ch-void-dt = low-values)
 17165              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17166              if (ch-check-origin-sw not = 'R')
 17167                 and (pb-record-type = '2')
 17168                 continue
 17169              else
 17170                 compute ws-check-amts =
 17171                    ws-check-amts + ch-amount-paid
 17172              end-if
 17173           end-if
 17174        end-if
 17175     end-perform
 17176
 17177     if ws-chek-browse-sw = 'Y'
 17178        perform 2525-endbr-erchek thru 2525-exit
 17179     end-if
 17180
 17181    .
 17182 2500-exit.
 17183     exit.
 17184
 17185 2510-startbr-erchek.
 17186
 17187     move pb-control-by-account  to erchek-key
 17188     move +0                     to chek-record-seq
 17189
 17190
 17191* exec cics startbr
 17192*       dataset   ('ERCHEK')
 17193*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 312
* EL6311.cbl
 17194*       gteq
 17195*       resp      (ws-response)
 17196*    end-exec
 17197     MOVE 'ERCHEK' TO DFHEIV1
 17198     MOVE 0
 17199       TO DFHEIV11
 17200*    MOVE '&,         G          &  N#00015079' TO DFHEIV0
 17201     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17202     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17203     MOVE X'204E233030303135303739' TO DFHEIV0(25:11)
 17204     CALL 'kxdfhei1' USING DFHEIV0,
 17205           DFHEIV1,
 17206           erchek-key,
 17207           DFHEIV99,
 17208           DFHEIV11,
 17209           DFHEIV99
 17210     MOVE EIBRESP  TO ws-response
 17211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17212
 17213     IF RESP-NORMAL
 17214        move 'Y'                 to ws-chek-browse-sw
 17215     end-if
 17216
 17217     .
 17218 2510-exit.
 17219     exit.
 17220
 17221 2520-readnext-erchek.
 17222
 17223
 17224* EXEC CICS READNEXT
 17225*       SET     (ADDRESS OF CHECK-RECORDS)
 17226*       DATASET ('ERCHEK')
 17227*       RIDFLD  (ERCHEK-KEY)
 17228*       RESP    (WS-RESPONSE)
 17229*    END-EXEC
 17230     MOVE 'ERCHEK' TO DFHEIV1
 17231     MOVE 0
 17232       TO DFHEIV11
 17233*    MOVE '&.S                   )  N#00015096' TO DFHEIV0
 17234     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17236     MOVE X'204E233030303135303936' TO DFHEIV0(25:11)
 17237     CALL 'kxdfhei1' USING DFHEIV0,
 17238           DFHEIV1,
 17239           DFHEIV20,
 17240           DFHEIV99,
 17241           ERCHEK-KEY,
 17242           DFHEIV99,
 17243           DFHEIV11,
 17244           DFHEIV99,
 17245           DFHEIV99
 17246     SET ADDRESS OF CHECK-RECORDS TO
 17247         DFHEIV20
 17248     MOVE EIBRESP  TO WS-RESPONSE
 17249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17250
 17251     .
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 313
* EL6311.cbl
 17252 2520-exit.
 17253     exit.
 17254
 17255 2525-endbr-erchek.
 17256
 17257
 17258* exec cics endbr
 17259*       dataset  ('ERCHEK')
 17260*    end-exec
 17261     MOVE 'ERCHEK' TO DFHEIV1
 17262     MOVE 0
 17263       TO DFHEIV11
 17264*    MOVE '&2                    $   #00015109' TO DFHEIV0
 17265     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17267     MOVE X'2020233030303135313039' TO DFHEIV0(25:11)
 17268     CALL 'kxdfhei1' USING DFHEIV0,
 17269           DFHEIV1,
 17270           DFHEIV11,
 17271           DFHEIV99
 17272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17273
 17274     .
 17275 2525-exit.
 17276     exit.
 17277
 17278 2530-readupd-erchek.
 17279
 17280
 17281* EXEC CICS READ
 17282*       UPDATE
 17283*       SET     (ADDRESS OF CHECK-RECORDS)
 17284*       DATASET ('ERCHEK')
 17285*       RIDFLD  (ERCHEK-KEY)
 17286*       RESP    (WS-RESPONSE)
 17287*    END-EXEC
 17288     MOVE 'ERCHEK' TO DFHEIV1
 17289*    MOVE '&"S        EU         (  N#00015119' TO DFHEIV0
 17290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17292     MOVE X'204E233030303135313139' TO DFHEIV0(25:11)
 17293     CALL 'kxdfhei1' USING DFHEIV0,
 17294           DFHEIV1,
 17295           DFHEIV20,
 17296           DFHEIV99,
 17297           ERCHEK-KEY,
 17298           DFHEIV99,
 17299           DFHEIV99,
 17300           DFHEIV99
 17301     SET ADDRESS OF CHECK-RECORDS TO
 17302         DFHEIV20
 17303     MOVE EIBRESP  TO WS-RESPONSE
 17304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17305
 17306     .
 17307 2530-exit.
 17308     exit.
 17309
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 314
* EL6311.cbl
 17310 2540-delete-erchek.
 17311
 17312
 17313* EXEC CICS DELETE
 17314*       DATASET ('ERCHEK')
 17315*       RESP    (WS-RESPONSE)
 17316*    END-EXEC
 17317     MOVE 'ERCHEK' TO DFHEIV1
 17318*    MOVE '&(                    &  N#00015133' TO DFHEIV0
 17319     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17321     MOVE X'204E233030303135313333' TO DFHEIV0(25:11)
 17322     CALL 'kxdfhei1' USING DFHEIV0,
 17323           DFHEIV1,
 17324           DFHEIV99,
 17325           DFHEIV99,
 17326           DFHEIV99,
 17327           DFHEIV99
 17328     MOVE EIBRESP  TO WS-RESPONSE
 17329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17330
 17331     .
 17332 2540-exit.
 17333     exit.
 17334***************************************************************
 17335*                                                             *
 17336*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17337*                                                             *
 17338***************************************************************
 17339
 17340***************************************************************
 17341*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17342*     AN ALREADY BILLED RECORD.                               *
 17343***************************************************************
 17344
 17345 2700-BUILD-CORRECTION-RECORD.
 17346     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17347     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17348     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17349     MOVE '5'                    TO DC-OPTION-CODE.
 17350     PERFORM 9700-DATE-LINK.
 17351     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17352
 17353     IF PB-CHG-COUNT = ZEROS
 17354        MOVE +1                  TO WS-SEQ-SAVE
 17355     ELSE
 17356        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17357
 17358     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17359     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17360
 17361     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17362
 17363     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17364     MOVE 'A'                    TO JP-RECORD-TYPE.
 17365     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17366
 17367
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 315
* EL6311.cbl
 17368* EXEC CICS WRITE
 17369*        DATASET    (FILE-ID-ERPNDB)
 17370*        FROM       (PENDING-BUSINESS)
 17371*        RIDFLD     (PB-CONTROL-PRIMARY)
 17372*    END-EXEC.
 17373     MOVE LENGTH OF
 17374      PENDING-BUSINESS
 17375       TO DFHEIV11
 17376*    MOVE '&$ L                  ''   #00015174' TO DFHEIV0
 17377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17379     MOVE X'2020233030303135313734' TO DFHEIV0(25:11)
 17380     CALL 'kxdfhei1' USING DFHEIV0,
 17381           FILE-ID-ERPNDB,
 17382           PENDING-BUSINESS,
 17383           DFHEIV11,
 17384           PB-CONTROL-PRIMARY,
 17385           DFHEIV99,
 17386           DFHEIV99
 17387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17388
 17389
 17390     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17391
 17392     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17393     .
 17394 2799-EXIT.
 17395      EXIT.
 17396
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 316
* EL6311.cbl
 17398
 17399******************************************************************
 17400*                                                                *
 17401*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17402*                 'K' transaction                                *
 17403******************************************************************
 17404
 17405 2800-REWRITE-ISSUE-CERT-KEY.
 17406     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17407
 17408     IF  BCERTNOL GREATER THAN ZEROS
 17409         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17410
 17411     IF  BSUFIXL  GREATER THAN ZEROS
 17412         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17413
 17414     IF  BEFFDTL  GREATER THAN ZEROS
 17415         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17416     move pi-prev-control-primary to pa-current-key
 17417     move erpndb-alt-key          to pa-new-alt-key
 17418     move spaces                  to pa-return-area
 17419
 17420
 17421* EXEC CICS LINK
 17422*       PROGRAM   ('EL055')
 17423*       COMMAREA  (EL055-PASS-AREA)
 17424*       LENGTH    (256)
 17425*    END-EXEC
 17426     MOVE 'EL055' TO DFHEIV1
 17427     MOVE 256
 17428       TO DFHEIV11
 17429*    MOVE '."C                   (   #00015210' TO DFHEIV0
 17430     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17432     MOVE X'2020233030303135323130' TO DFHEIV0(25:11)
 17433     CALL 'kxdfhei1' USING DFHEIV0,
 17434           DFHEIV1,
 17435           EL055-PASS-AREA,
 17436           DFHEIV11,
 17437           DFHEIV99,
 17438           DFHEIV99,
 17439           DFHEIV99,
 17440           DFHEIV99
 17441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17442     if ra-status-code = +99  *> found a claim
 17443        move -1                  to bmaintl
 17444        move al-uabon            to bmainta
 17445        move er-2878             to emi-error
 17446        perform 9900-error-format thru 9900-exit
 17447        go to 8200-send-dataonly
 17448     end-if
 17449
 17450     if ra-status-code = +88  *> found dup cert
 17451        move -1                  to bmaintl
 17452        move al-uabon            to bmainta
 17453        move er-0229             to emi-error
 17454        perform 9900-error-format thru 9900-exit
 17455        go to 8200-send-dataonly
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 317
* EL6311.cbl
 17456     end-if
 17457     GO TO 1325-PROCESS-ISSUE-CHANGES
 17458     .
 17459******************************************************************
 17460*                                                                *
 17461*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17462*                                                                *
 17463******************************************************************
 17464
 17465 2900-REWRITE-CAN-CERT-KEY.
 17466     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17467
 17468     IF  CCERTNOL GREATER THAN ZEROS
 17469         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17470
 17471     IF  CSUFIXL  GREATER THAN ZEROS
 17472         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17473
 17474     IF  CEFFDTL  GREATER THAN ZEROS
 17475         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17476
 17477 2910-READ-BY-ACCOUNT.
 17478
 17479* EXEC CICS HANDLE CONDITION
 17480*         NOTFND    (2920-PROCESS-REWRITE)
 17481*    END-EXEC.
 17482*    MOVE '"$I                   ! = #00015251' TO DFHEIV0
 17483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17485     MOVE X'3D20233030303135323531' TO DFHEIV0(25:11)
 17486     CALL 'kxdfhei1' USING DFHEIV0
 17487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17488
 17489
 17490
 17491* EXEC CICS READ
 17492*        SET     (ADDRESS OF PENDING-BUSINESS)
 17493*        DATASET (FILE-ID-ERPNDB2)
 17494*        RIDFLD  (ERPNDB-ALT-KEY)
 17495*    END-EXEC.
 17496*    MOVE '&"S        E          (   #00015255' TO DFHEIV0
 17497     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17499     MOVE X'2020233030303135323535' TO DFHEIV0(25:11)
 17500     CALL 'kxdfhei1' USING DFHEIV0,
 17501           FILE-ID-ERPNDB2,
 17502           DFHEIV20,
 17503           DFHEIV99,
 17504           ERPNDB-ALT-KEY,
 17505           DFHEIV99,
 17506           DFHEIV99,
 17507           DFHEIV99
 17508     SET ADDRESS OF PENDING-BUSINESS TO
 17509         DFHEIV20
 17510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17511
 17512
 17513     GO TO 2990-DUPLICATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 318
* EL6311.cbl
 17514
 17515  2920-PROCESS-REWRITE.
 17516
 17517* EXEC CICS HANDLE CONDITION
 17518*         NOTFND    (2985-RECORD-MISSING)
 17519*    END-EXEC.
 17520*    MOVE '"$I                   ! > #00015264' TO DFHEIV0
 17521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17523     MOVE X'3E20233030303135323634' TO DFHEIV0(25:11)
 17524     CALL 'kxdfhei1' USING DFHEIV0
 17525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17526
 17527
 17528     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17529
 17530
 17531* EXEC CICS READ
 17532*        SET     (ADDRESS OF PENDING-BUSINESS)
 17533*        DATASET (FILE-ID-ERPNDB)
 17534*        RIDFLD  (ERPNDB-KEY)
 17535*        UPDATE
 17536*    END-EXEC.
 17537*    MOVE '&"S        EU         (   #00015270' TO DFHEIV0
 17538     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17539     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17540     MOVE X'2020233030303135323730' TO DFHEIV0(25:11)
 17541     CALL 'kxdfhei1' USING DFHEIV0,
 17542           FILE-ID-ERPNDB,
 17543           DFHEIV20,
 17544           DFHEIV99,
 17545           ERPNDB-KEY,
 17546           DFHEIV99,
 17547           DFHEIV99,
 17548           DFHEIV99
 17549     SET ADDRESS OF PENDING-BUSINESS TO
 17550         DFHEIV20
 17551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17552
 17553
 17554     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17555     MOVE 'D'                    TO JP-RECORD-TYPE.
 17556     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17557     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17558
 17559     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17560
 17561     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17562     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17563     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17564
 17565
 17566* EXEC CICS DELETE
 17567*        DATASET    (FILE-ID-ERPNDB)
 17568*    END-EXEC.
 17569*    MOVE '&(                    &   #00015288' TO DFHEIV0
 17570     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17571     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 319
* EL6311.cbl
 17572     MOVE X'2020233030303135323838' TO DFHEIV0(25:11)
 17573     CALL 'kxdfhei1' USING DFHEIV0,
 17574           FILE-ID-ERPNDB,
 17575           DFHEIV99,
 17576           DFHEIV99,
 17577           DFHEIV99,
 17578           DFHEIV99
 17579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17580
 17581
 17582     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17583
 17584
 17585* EXEC CICS GETMAIN
 17586*        SET      (ADDRESS OF PENDING-BUSINESS)
 17587*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17588*        INITIMG  (GETMAIN-SPACE)
 17589*    END-EXEC.
 17590*    MOVE ',"IL                  $   #00015294' TO DFHEIV0
 17591     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17592     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17593     MOVE X'2020233030303135323934' TO DFHEIV0(25:11)
 17594     CALL 'kxdfhei1' USING DFHEIV0,
 17595           DFHEIV20,
 17596           ERPNDB-RECORD-LENGTH,
 17597           GETMAIN-SPACE
 17598     SET ADDRESS OF PENDING-BUSINESS TO
 17599         DFHEIV20
 17600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17601
 17602
 17603     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17604
 17605 2950-PROCESS-CANCELS.
 17606
 17607
 17608* EXEC CICS HANDLE CONDITION
 17609*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17610*    END-EXEC.
 17611*    MOVE '"$I                   ! ? #00015304' TO DFHEIV0
 17612     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17613     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17614     MOVE X'3F20233030303135333034' TO DFHEIV0(25:11)
 17615     CALL 'kxdfhei1' USING DFHEIV0
 17616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17617
 17618
 17619
 17620* EXEC CICS READ
 17621*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17622*        DATASET (FILE-ID-ELCERT)
 17623*        RIDFLD  (ELCERT-KEY)
 17624*        UPDATE
 17625*    END-EXEC.
 17626*    MOVE '&"S        EU         (   #00015308' TO DFHEIV0
 17627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17629     MOVE X'2020233030303135333038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 320
* EL6311.cbl
 17630     CALL 'kxdfhei1' USING DFHEIV0,
 17631           FILE-ID-ELCERT,
 17632           DFHEIV20,
 17633           DFHEIV99,
 17634           ELCERT-KEY,
 17635           DFHEIV99,
 17636           DFHEIV99,
 17637           DFHEIV99
 17638     SET ADDRESS OF CERTIFICATE-MASTER TO
 17639         DFHEIV20
 17640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17641
 17642
 17643     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17644
 17645     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17646     MOVE 'B'                      TO JP-RECORD-TYPE.
 17647     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17648     PERFORM 8400-LOG-JOURNAL-RECORD.
 17649
 17650     IF PB-CI-LIVES NOT NUMERIC
 17651         MOVE ZERO                    TO PB-CI-LIVES.
 17652
 17653     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17654        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17655        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17656        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17657                                         CM-LF-CANCEL-DT
 17658     ELSE
 17659        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17660        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17661        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17662        MOVE PB-CI-LIVES              TO CM-LIVES.
 17663
 17664     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17665        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17666            MOVE CM-LF-STATUS-AT-CANCEL
 17667                                     TO CM-LF-CURRENT-STATUS
 17668            MOVE SPACE
 17669                                     TO CM-LF-STATUS-AT-CANCEL
 17670        ELSE
 17671            MOVE PB-CI-LF-POLICY-STATUS
 17672                                     TO CM-LF-CURRENT-STATUS
 17673     ELSE
 17674        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17675
 17676     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17677        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17678        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17679        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17680                                         CM-AH-CANCEL-DT
 17681     ELSE
 17682        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17683        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17684        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17685        MOVE PB-CI-LIVES              TO CM-LIVES.
 17686
 17687     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 321
* EL6311.cbl
 17688        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17689            MOVE CM-AH-STATUS-AT-CANCEL
 17690                                     TO CM-AH-CURRENT-STATUS
 17691            MOVE SPACE
 17692                                     TO CM-AH-STATUS-AT-CANCEL
 17693        ELSE
 17694            MOVE PB-CI-AH-POLICY-STATUS
 17695                                     TO CM-AH-CURRENT-STATUS
 17696     ELSE
 17697        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17698
 17699 2975-REWRITE-CERT.
 17700     MOVE 'C'                      TO JP-RECORD-TYPE.
 17701     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17702
 17703
 17704* EXEC CICS REWRITE
 17705*        DATASET    (FILE-ID-ELCERT)
 17706*        FROM       (CERTIFICATE-MASTER)
 17707*    END-EXEC.
 17708     MOVE LENGTH OF
 17709      CERTIFICATE-MASTER
 17710       TO DFHEIV11
 17711*    MOVE '&& L                  %   #00015375' TO DFHEIV0
 17712     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17713     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17714     MOVE X'2020233030303135333735' TO DFHEIV0(25:11)
 17715     CALL 'kxdfhei1' USING DFHEIV0,
 17716           FILE-ID-ELCERT,
 17717           CERTIFICATE-MASTER,
 17718           DFHEIV11,
 17719           DFHEIV99
 17720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17721
 17722
 17723     PERFORM 8400-LOG-JOURNAL-RECORD.
 17724
 17725 2960-BUILD-NEW-CANCEL-RECORD.
 17726     IF  CCERTNOL GREATER THAN ZEROS
 17727         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17728
 17729     IF  CSUFIXL  GREATER THAN ZEROS
 17730         MOVE CSUFIXI             TO PB-CERT-SFX.
 17731
 17732     IF  CEFFDTL  GREATER  THAN ZEROS
 17733         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17734
 17735 2970-WRITE-PENDING-BUSINESS.
 17736     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17737     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17738     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17739     MOVE '5'                    TO DC-OPTION-CODE.
 17740     PERFORM 9700-DATE-LINK.
 17741     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17742
 17743     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17744
 17745     MOVE SPACES                 TO PB-CI-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 322
* EL6311.cbl
 17746                                    PB-CI-INSURED-SEX
 17747                                    PB-CI-LF-BENEFIT-CD
 17748                                    PB-CI-AH-BENEFIT-CD
 17749                                    PB-CI-RATE-CLASS
 17750                                    PB-CI-RATE-DEV-LF
 17751                                    PB-CI-RATE-DEV-AH
 17752                                    PB-CI-LF-ABBR
 17753                                    PB-CI-AH-ABBR
 17754                                    PB-CI-OB-FLAG
 17755                                    PB-CI-LF-POLICY-STATUS
 17756                                    PB-CI-AH-POLICY-STATUS
 17757                                    PB-CI-INDV-GRP-CD
 17758                                    PB-CI-BENEFICIARY-NAME
 17759                                    PB-CI-NOTE-SW
 17760                                    PB-CI-SOC-SEC-NO
 17761                                    PB-CI-MEMBER-NO
 17762                                    PB-CI-INT-CODE
 17763                                    PB-CI-COMP-EXCP-SW
 17764                                    PB-CI-ENTRY-STATUS
 17765                                    PB-CI-CREDIT-INTERFACE-SW-1
 17766                                    PB-CI-CREDIT-INTERFACE-SW-2
 17767                                    PB-CI-ENTRY-BATCH.
 17768
 17769     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17770                                    PB-CI-AH-SETTLEMENT-DT
 17771                                    PB-CI-DEATH-DT
 17772                                    PB-CI-LF-PRIOR-CANCEL-DT
 17773                                    PB-CI-AH-PRIOR-CANCEL-DT
 17774                                    PB-CI-LOAN-1ST-PMT-DT
 17775                                    PB-CI-ENTRY-DT
 17776                                    PB-CI-LF-EXPIRE-DT
 17777                                    PB-CI-AH-EXPIRE-DT.
 17778
 17779     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17780                                    PB-CI-LF-TERM
 17781                                    PB-CI-LF-BENEFIT-AMT
 17782                                    PB-CI-LF-ALT-BENEFIT-AMT
 17783                                    PB-CI-LF-PREMIUM-AMT
 17784                                    PB-CI-LF-ALT-PREMIUM-AMT
 17785                                    PB-CI-AH-TERM
 17786                                    PB-CI-AH-BENEFIT-AMT
 17787                                    PB-CI-AH-PREMIUM-AMT
 17788                                    PB-CI-RATE-DEV-PCT-LF
 17789                                    PB-CI-RATE-DEV-PCT-AH
 17790                                    PB-CI-LIFE-COMMISSION
 17791                                    PB-CI-AH-COMMISSION
 17792                                    PB-CI-PAY-FREQUENCY
 17793                                    PB-CI-LOAN-APR
 17794                                    PB-CI-LOAN-TERM
 17795                                    PB-CI-CURR-SEQ
 17796                                    PB-CI-AH-CANCEL-AMT
 17797                                    PB-CI-LF-CANCEL-AMT
 17798                                    PB-CI-EXTENTION-DAYS
 17799                                    PB-CI-TERM-IN-DAYS
 17800                                    PB-CI-LOAN-OFFICER
 17801                                    PB-CI-LIVES
 17802                                    PB-CI-LF-CRIT-PER
 17803                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 323
* EL6311.cbl
 17804                                    PB-C-LF-REM-TERM
 17805                                    PB-C-AH-REM-TERM.
 17806
 17807     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17808     MOVE 'A'                    TO JP-RECORD-TYPE.
 17809     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17810
 17811
 17812* EXEC CICS HANDLE CONDITION
 17813*        DUPREC   (2990-DUPLICATE-RECORD)
 17814*    END-EXEC.
 17815*    MOVE '"$%                   ! @ #00015468' TO DFHEIV0
 17816     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17818     MOVE X'4020233030303135343638' TO DFHEIV0(25:11)
 17819     CALL 'kxdfhei1' USING DFHEIV0
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17821
 17822
 17823
 17824* EXEC CICS WRITE
 17825*        DATASET  (FILE-ID-ERPNDB)
 17826*        FROM     (PENDING-BUSINESS)
 17827*        RIDFLD   (PB-CONTROL-PRIMARY)
 17828*    END-EXEC.
 17829     MOVE LENGTH OF
 17830      PENDING-BUSINESS
 17831       TO DFHEIV11
 17832*    MOVE '&$ L                  ''   #00015472' TO DFHEIV0
 17833     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17834     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17835     MOVE X'2020233030303135343732' TO DFHEIV0(25:11)
 17836     CALL 'kxdfhei1' USING DFHEIV0,
 17837           FILE-ID-ERPNDB,
 17838           PENDING-BUSINESS,
 17839           DFHEIV11,
 17840           PB-CONTROL-PRIMARY,
 17841           DFHEIV99,
 17842           DFHEIV99
 17843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17844
 17845
 17846     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17847
 17848     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 17849
 17850     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17851
 17852 2985-RECORD-MISSING.
 17853     MOVE -1                     TO CMAINTL
 17854     MOVE AL-UABON               TO CMAINTA.
 17855
 17856     MOVE ER-2902                TO EMI-ERROR.
 17857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17858     GO TO 8200-SEND-DATAONLY.
 17859
 17860 2990-DUPLICATE-RECORD.
 17861     MOVE SPACE                  TO CMAINTI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 324
* EL6311.cbl
 17862     MOVE -1                     TO CMAINTL.
 17863     MOVE AL-UABON               TO CCERTNOA.
 17864     MOVE AL-UNBON               TO CEFFDTA.
 17865
 17866     MOVE 1                      TO EMI-SUB
 17867                                    EMI-SWITCH1
 17868                                    EMI-SWITCH-AREA-1
 17869                                    EMI-SWITCH-AREA-2.
 17870     MOVE SPACES                 TO EMI-ERROR-LINES.
 17871
 17872
 17873* EXEC CICS SYNCPOINT ROLLBACK
 17874*    END-EXEC.
 17875*    MOVE '6"R                   !   #00015504' TO DFHEIV0
 17876     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17878     MOVE X'2020233030303135353034' TO DFHEIV0(25:11)
 17879     CALL 'kxdfhei1' USING DFHEIV0
 17880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17881
 17882
 17883     MOVE ER-2247                TO EMI-ERROR.
 17884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17885     GO TO 8200-SEND-DATAONLY.
 17886
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 325
* EL6311.cbl
 17888
 17889***************************************************************
 17890*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17891*     PREMIUM FOR A SINGLE BATCH.                             *
 17892*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17893***************************************************************
 17894
 17895 3000-BATCH-MAINLINE.
 17896     IF PI-PREV-KEY NOT = SPACES
 17897         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17898     ELSE
 17899         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17900
 17901     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17902
 17903 3010-READNEXT.
 17904
 17905* EXEC CICS READ
 17906*         DATASET    (FILE-ID-ERPNDB)
 17907*         SET        (ADDRESS OF PENDING-BUSINESS)
 17908*         RIDFLD     (ERPNDB-KEY)
 17909*         GTEQ
 17910*    END-EXEC.
 17911*    MOVE '&"S        G          (   #00015528' TO DFHEIV0
 17912     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17914     MOVE X'2020233030303135353238' TO DFHEIV0(25:11)
 17915     CALL 'kxdfhei1' USING DFHEIV0,
 17916           FILE-ID-ERPNDB,
 17917           DFHEIV20,
 17918           DFHEIV99,
 17919           ERPNDB-KEY,
 17920           DFHEIV99,
 17921           DFHEIV99,
 17922           DFHEIV99
 17923     SET ADDRESS OF PENDING-BUSINESS TO
 17924         DFHEIV20
 17925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17926
 17927
 17928     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17929        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17930          GO TO 3030-END-BATCH.
 17931
 17932     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17933
 17934     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17935        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17936          GO TO 3020-BUMP-SEQ.
 17937
 17938     IF PB-ISSUE
 17939        ADD +1                   TO WS-ISS-TOTAL-CNT
 17940        IF PB-FATAL-ERRORS
 17941           ADD +1                      TO WS-ISS-FATAL-CNT
 17942           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17943           GO TO 3020-BUMP-SEQ
 17944        ELSE
 17945           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 326
* EL6311.cbl
 17946              ADD +1                      TO WS-ISS-FORCE-CNT
 17947              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17948              GO TO 3020-BUMP-SEQ
 17949           ELSE
 17950              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17951                 ADD +1                      TO WS-ISS-HOLD-CNT
 17952                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17953                 GO TO 3020-BUMP-SEQ
 17954              ELSE
 17955                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17956                     THRU  3299-EXIT
 17957                 GO TO 3020-BUMP-SEQ.
 17958
 17959     IF PB-CANCELLATION
 17960        ADD +1                   TO WS-CAN-TOTAL-CNT
 17961        IF PB-FATAL-ERRORS
 17962           ADD +1                 TO WS-CAN-FATAL-CNT
 17963           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17964           GO TO 3020-BUMP-SEQ
 17965        ELSE
 17966           IF PB-UNFORCED-ERRORS
 17967              ADD +1                 TO WS-CAN-FORCE-CNT
 17968              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17969              GO TO 3020-BUMP-SEQ
 17970           ELSE
 17971              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17972                 ADD +1                 TO WS-CAN-HOLD-CNT
 17973                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17974                 GO TO 3020-BUMP-SEQ
 17975              ELSE
 17976                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17977                     THRU  3499-EXIT
 17978                 GO TO 3020-BUMP-SEQ.
 17979
 17980     IF PB-BATCH-TRAILER
 17981         GO TO 3030-END-BATCH.
 17982
 17983 3020-BUMP-SEQ.
 17984     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17985     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17986     GO TO 3010-READNEXT.
 17987
 17988 3030-END-BATCH.
 17989     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17990     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17991     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17992     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17993
 17994     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17995                                          - WS-ISS-FORCE-CNT
 17996                                          - WS-ISS-HOLD-CNT).
 17997
 17998     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17999     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18000
 18001     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18002     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18003     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 327
* EL6311.cbl
 18004     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18005     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18006                                          - WS-CAN-FORCE-CNT
 18007                                          - WS-CAN-HOLD-CNT).
 18008     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18009     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18010
 18011     COMPUTE WS-NET-TOTAL-CNT
 18012         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18013     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18014     COMPUTE WS-NET-FATAL-CNT
 18015         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18016     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18017     COMPUTE WS-NET-FORCE-CNT
 18018         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18019     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18020     COMPUTE WS-NET-HOLD-CNT
 18021         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18022     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18023
 18024     COMPUTE WS-NET-AVAIL-CNT
 18025          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18026                              - WS-ISS-FORCE-CNT
 18027                              - WS-ISS-HOLD-CNT)
 18028          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18029                              - WS-CAN-FORCE-CNT
 18030                              - WS-CAN-HOLD-CNT).
 18031     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18032
 18033     COMPUTE WS-NET-GOOD-PREM
 18034         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18035     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18036     COMPUTE WS-NET-BAD-PREM
 18037         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18038     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18039
 18040     MOVE 0000                   TO EMI-ERROR.
 18041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18042     MOVE -1                     TO DPFENTRL.
 18043     GO TO 8200-SEND-DATAONLY.
 18044
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 328
* EL6311.cbl
 18046
 18047******************************************************************
 18048*                                                                *
 18049*           A D D    B A D   I S S U E   P R E M I U M           *
 18050*                                                                *
 18051******************************************************************
 18052
 18053 3100-ADD-BAD-ISSUE-PREM.
 18054     IF PB-OVERRIDE-LIFE
 18055       OR PB-OVERRIDE-BOTH
 18056           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18057           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18058       ELSE
 18059           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18060           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18061
 18062     IF PB-OVERRIDE-AH
 18063       OR PB-OVERRIDE-BOTH
 18064           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18065       ELSE
 18066           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18067
 18068 3199-EXIT.
 18069     EXIT.
 18070
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 329
* EL6311.cbl
 18072
 18073******************************************************************
 18074*                                                                *
 18075*       A D D   G O O D   I S S U E   P R E M I U M              *
 18076*                                                                *
 18077******************************************************************
 18078
 18079 3200-ADD-GOOD-ISSUE-PREM.
 18080     IF PB-OVERRIDE-LIFE
 18081       OR PB-OVERRIDE-BOTH
 18082           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18083           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18084       ELSE
 18085           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18086           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18087
 18088     IF PB-OVERRIDE-AH
 18089       OR PB-OVERRIDE-BOTH
 18090           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18091       ELSE
 18092           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18093
 18094 3299-EXIT.
 18095     EXIT.
 18096
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 330
* EL6311.cbl
 18098
 18099
 18100******************************************************************
 18101*                                                                *
 18102*        A D D   B A D   C A N C E L   P R E M I U M             *
 18103*                                                                *
 18104******************************************************************
 18105
 18106 3300-ADD-BAD-CANCEL-PREM.
 18107     IF PB-OVERRIDE-LIFE
 18108       OR PB-OVERRIDE-BOTH
 18109           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18110       ELSE
 18111           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18112
 18113     IF PB-OVERRIDE-AH
 18114       OR PB-OVERRIDE-BOTH
 18115           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18116       ELSE
 18117           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18118
 18119 3399-EXIT.
 18120     EXIT.
 18121
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 331
* EL6311.cbl
 18123
 18124******************************************************************
 18125*                                                                *
 18126*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18127*                                                                *
 18128******************************************************************
 18129
 18130 3400-ADD-GOOD-CANCEL-PREM.
 18131     IF PB-OVERRIDE-LIFE
 18132       OR PB-OVERRIDE-BOTH
 18133           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18134       ELSE
 18135           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18136
 18137     IF PB-OVERRIDE-AH
 18138       OR PB-OVERRIDE-BOTH
 18139           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18140       ELSE
 18141           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18142
 18143 3499-EXIT.
 18144     EXIT.
 18145
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 332
* EL6311.cbl
 18147
 18148******************************************************************
 18149*                                                                *
 18150*           E D I T   B A T C H   D A T A                        *
 18151*                                                                *
 18152******************************************************************
 18153
 18154 3500-EDIT-BATCH-DATA.
 18155     IF PI-PREV-KEY NOT = SPACES
 18156        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18157     ELSE
 18158        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18159
 18160     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18161     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18162
 18163
 18164* EXEC CICS HANDLE CONDITION
 18165*         NOTFND      (3590-NOT-FOUND)
 18166*    END-EXEC.
 18167*    MOVE '"$I                   ! A #00015770' TO DFHEIV0
 18168     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18170     MOVE X'4120233030303135373730' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0
 18172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18173
 18174
 18175     IF DRISSL   GREATER THAN ZEROS OR
 18176        DRISSL   GREATER THAN ZEROS OR
 18177        DRLFPRML GREATER THAN ZEROS OR
 18178        DRAHPRML GREATER THAN ZEROS OR
 18179        DRCANCL  GREATER THAN ZEROS OR
 18180        DRLFRFDL GREATER THAN ZEROS OR
 18181        DRAHRFDL GREATER THAN ZEROS
 18182              NEXT SENTENCE
 18183          ELSE
 18184              MOVE ER-3224    TO EMI-ERROR
 18185              MOVE -1         TO DPFENTRL
 18186              MOVE AL-UNBON   TO DPFENTRA
 18187              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18188              GO TO 8200-SEND-DATAONLY.
 18189
 18190     IF NOT MODIFY-CAP
 18191         MOVE 'UPDATE'       TO SM-READ
 18192         PERFORM 9995-SECURITY-VIOLATION
 18193         MOVE ER-0070        TO EMI-ERROR
 18194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18195         GO TO 8100-SEND-INITIAL-MAP.
 18196
 18197        IF DRISSL GREATER THAN ZEROS
 18198           MOVE AL-UNNON         TO DRISSA
 18199           MOVE DRISSI           TO DEEDIT-FIELD
 18200           PERFORM 8600-DEEDIT
 18201           IF DEEDIT-FIELD-V0  NUMERIC
 18202              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18203           ELSE
 18204              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 333
* EL6311.cbl
 18205              MOVE -1         TO DRISSL
 18206              MOVE AL-UNBON   TO DRISSA
 18207              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18208
 18209        IF DRLFPRML GREATER THAN ZEROS
 18210           MOVE AL-UNNON         TO DRLFPRMA
 18211
 18212* EXEC CICS BIF DEEDIT
 18213*              FIELD  (DRLFPRMI)
 18214*              LENGTH (11)
 18215*          END-EXEC
 18216     MOVE 11
 18217       TO DFHEIV11
 18218*    MOVE '@"L                   #   #00015810' TO DFHEIV0
 18219     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18221     MOVE X'2020233030303135383130' TO DFHEIV0(25:11)
 18222     CALL 'kxdfhei1' USING DFHEIV0,
 18223           DRLFPRMI,
 18224           DFHEIV11
 18225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18226           IF DRLFPRMI NUMERIC
 18227              MOVE DRLFPRMI   TO WS-DRLFPRM
 18228*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18229*          PERFORM 8600-DEEDIT
 18230*          IF DEEDIT-FIELD-V2  NUMERIC
 18231*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18232           ELSE
 18233              MOVE ER-2223    TO EMI-ERROR
 18234              MOVE -1         TO DRLFPRML
 18235              MOVE AL-UNBON   TO DRLFPRMA
 18236              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18237
 18238        IF DRAHPRML GREATER THAN ZEROS
 18239           MOVE AL-UNNON         TO DRAHPRMA
 18240
 18241* EXEC CICS BIF DEEDIT
 18242*              FIELD  (DRAHPRMI)
 18243*              LENGTH (11)
 18244*          END-EXEC
 18245     MOVE 11
 18246       TO DFHEIV11
 18247*    MOVE '@"L                   #   #00015828' TO DFHEIV0
 18248     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18250     MOVE X'2020233030303135383238' TO DFHEIV0(25:11)
 18251     CALL 'kxdfhei1' USING DFHEIV0,
 18252           DRAHPRMI,
 18253           DFHEIV11
 18254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18255           IF DRAHPRMI NUMERIC
 18256              MOVE DRAHPRMI   TO WS-DRAHPRM
 18257*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18258*          PERFORM 8600-DEEDIT
 18259*          IF DEEDIT-FIELD-V2  NUMERIC
 18260*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18261           ELSE
 18262              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 334
* EL6311.cbl
 18263              MOVE -1         TO DRAHPRML
 18264              MOVE AL-UNBON   TO DRAHPRMA
 18265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18266
 18267        IF DRCANCL GREATER THAN ZEROS
 18268           MOVE AL-UNNON         TO DRCANCA
 18269           MOVE DRCANCI          TO DEEDIT-FIELD
 18270           PERFORM 8600-DEEDIT
 18271           IF DEEDIT-FIELD-V0  NUMERIC
 18272              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18273           ELSE
 18274              MOVE ER-2223    TO EMI-ERROR
 18275              MOVE -1         TO DRCANCL
 18276              MOVE AL-UNBON   TO DRCANCL
 18277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18278
 18279        IF DRLFRFDL GREATER THAN ZEROS
 18280           MOVE AL-UNNON         TO DRLFRFDA
 18281
 18282* EXEC CICS BIF DEEDIT
 18283*              FIELD  (DRLFRFDI)
 18284*              LENGTH (11)
 18285*          END-EXEC
 18286     MOVE 11
 18287       TO DFHEIV11
 18288*    MOVE '@"L                   #   #00015858' TO DFHEIV0
 18289     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18291     MOVE X'2020233030303135383538' TO DFHEIV0(25:11)
 18292     CALL 'kxdfhei1' USING DFHEIV0,
 18293           DRLFRFDI,
 18294           DFHEIV11
 18295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18296           IF DRLFRFDI NUMERIC
 18297              MOVE DRLFRFDI   TO WS-DRLFRFD
 18298*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18299*          PERFORM 8600-DEEDIT
 18300*          IF DEEDIT-FIELD-V2  NUMERIC
 18301*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18302           ELSE
 18303              MOVE ER-2223    TO EMI-ERROR
 18304              MOVE -1         TO DRLFRFDL
 18305              MOVE AL-UNBON   TO DRLFRFDA
 18306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18307
 18308        IF DRAHRFDL GREATER THAN ZEROS
 18309           MOVE AL-UNNON         TO DRAHRFDA
 18310
 18311* EXEC CICS BIF DEEDIT
 18312*              FIELD  (DRAHRFDI)
 18313*              LENGTH (11)
 18314*          END-EXEC
 18315     MOVE 11
 18316       TO DFHEIV11
 18317*    MOVE '@"L                   #   #00015876' TO DFHEIV0
 18318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18320     MOVE X'2020233030303135383736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 335
* EL6311.cbl
 18321     CALL 'kxdfhei1' USING DFHEIV0,
 18322           DRAHRFDI,
 18323           DFHEIV11
 18324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18325           IF DRAHRFDI NUMERIC
 18326              MOVE DRAHRFDI   TO WS-DRAHRFD
 18327*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18328*          PERFORM 8600-DEEDIT
 18329*          IF DEEDIT-FIELD-V2  NUMERIC
 18330*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18331           ELSE
 18332              MOVE ER-2223    TO EMI-ERROR
 18333              MOVE -1         TO DRAHRFDL
 18334              MOVE AL-UNBON   TO DRAHRFDA
 18335              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18336
 18337     IF EMI-ERROR = ZEROS
 18338        GO 3600-UPDATE-BATCH-HEADER.
 18339
 18340     GO TO 8200-SEND-DATAONLY.
 18341
 18342 3590-NOT-FOUND.
 18343     MOVE ER-2192                TO EMI-ERROR.
 18344     MOVE -1                     TO DPFENTRL.
 18345     MOVE AL-UNBON               TO DPFENTRA.
 18346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18347     GO TO 8200-SEND-DATAONLY.
 18348
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 336
* EL6311.cbl
 18350
 18351******************************************************************
 18352*                                                                *
 18353*           U P D A T E   B A T C H   H E A D E R                *
 18354*                                                                *
 18355******************************************************************
 18356
 18357 3600-UPDATE-BATCH-HEADER.
 18358
 18359* EXEC CICS HANDLE CONDITION
 18360*         NOTFND      (3690-NOT-FOUND)
 18361*    END-EXEC.
 18362*    MOVE '"$I                   ! B #00015913' TO DFHEIV0
 18363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18365     MOVE X'4220233030303135393133' TO DFHEIV0(25:11)
 18366     CALL 'kxdfhei1' USING DFHEIV0
 18367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18368
 18369
 18370
 18371* EXEC CICS READ
 18372*        DATASET (FILE-ID-ERPNDB)
 18373*        RIDFLD  (ERPNDB-KEY)
 18374*        SET     (ADDRESS OF PENDING-BUSINESS)
 18375*        UPDATE
 18376*    END-EXEC.
 18377*    MOVE '&"S        EU         (   #00015917' TO DFHEIV0
 18378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18379     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18380     MOVE X'2020233030303135393137' TO DFHEIV0(25:11)
 18381     CALL 'kxdfhei1' USING DFHEIV0,
 18382           FILE-ID-ERPNDB,
 18383           DFHEIV20,
 18384           DFHEIV99,
 18385           ERPNDB-KEY,
 18386           DFHEIV99,
 18387           DFHEIV99,
 18388           DFHEIV99
 18389     SET ADDRESS OF PENDING-BUSINESS TO
 18390         DFHEIV20
 18391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18392
 18393
 18394     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18395     MOVE 'B'                    TO JP-RECORD-TYPE.
 18396     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18397
 18398     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18399
 18400     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18401
 18402     IF DRISSL GREATER THAN ZEROS
 18403        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18404
 18405     IF DRCANCL GREATER THAN ZEROS
 18406        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18407
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 337
* EL6311.cbl
 18408
 18409     IF DRLFPRML GREATER THAN ZEROS
 18410        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18411
 18412     IF DRAHPRML GREATER THAN ZEROS
 18413        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18414
 18415     IF DRLFRFDL GREATER THAN ZEROS
 18416        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18417
 18418     IF DRAHRFDL GREATER THAN ZEROS
 18419        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18420
 18421 3670-REWRITE-BATCH-HEADER.
 18422     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18423        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18424        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18425        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18426        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18427        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18428        MOVE SPACE               TO PB-OUT-BAL-CD
 18429     ELSE
 18430        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18431
 18432     MOVE 'C'                    TO JP-RECORD-TYPE.
 18433     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18434
 18435
 18436* EXEC CICS REWRITE
 18437*         DATASET      (FILE-ID-ERPNDB)
 18438*         FROM         (PENDING-BUSINESS)
 18439*    END-EXEC.
 18440     MOVE LENGTH OF
 18441      PENDING-BUSINESS
 18442       TO DFHEIV11
 18443*    MOVE '&& L                  %   #00015965' TO DFHEIV0
 18444     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18446     MOVE X'2020233030303135393635' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0,
 18448           FILE-ID-ERPNDB,
 18449           PENDING-BUSINESS,
 18450           DFHEIV11,
 18451           DFHEIV99
 18452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18453
 18454
 18455     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18456
 18457     GO TO 7200-DISPLAY-BATCHES.
 18458
 18459 3690-NOT-FOUND.
 18460     MOVE ER-2192                TO EMI-ERROR.
 18461     MOVE -1                     TO DPFENTRL.
 18462     MOVE AL-UNBON               TO DPFENTRA.
 18463     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18464     GO TO 8200-SEND-DATAONLY.
 18465
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 338
* EL6311.cbl
 18467
 18468******************************************************************
 18469*                                                                *
 18470*           R E - D I S P L A Y   R E C O R D                    *
 18471*                                                                *
 18472******************************************************************
 18473
 18474 3900-RE-DISPLAY-RECORD.
 18475
 18476* EXEC CICS HANDLE CONDITION
 18477*         NOTFND   (3990-NOT-FOUND)
 18478*    END-EXEC.
 18479*    MOVE '"$I                   ! C #00015990' TO DFHEIV0
 18480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18482     MOVE X'4320233030303135393930' TO DFHEIV0(25:11)
 18483     CALL 'kxdfhei1' USING DFHEIV0
 18484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18485
 18486
 18487     IF PI-DISPLAY-ORIGINAL-BATCH
 18488         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18489     ELSE
 18490         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18491
 18492
 18493* EXEC CICS READ
 18494*         DATASET   (FILE-ID)
 18495*         RIDFLD    (PI-PREV-KEY)
 18496*         SET       (ADDRESS OF PENDING-BUSINESS)
 18497*    END-EXEC.
 18498*    MOVE '&"S        E          (   #00015999' TO DFHEIV0
 18499     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18501     MOVE X'2020233030303135393939' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0,
 18503           FILE-ID,
 18504           DFHEIV20,
 18505           DFHEIV99,
 18506           PI-PREV-KEY,
 18507           DFHEIV99,
 18508           DFHEIV99,
 18509           DFHEIV99
 18510     SET ADDRESS OF PENDING-BUSINESS TO
 18511         DFHEIV20
 18512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18513
 18514
 18515     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18516
 18517     IF PB-ISSUE
 18518         GO TO 7000-DISPLAY-ISSUES.
 18519
 18520     IF PB-CANCELLATION
 18521         GO TO 7100-DISPLAY-CANCELS.
 18522
 18523     IF PB-BATCH-TRAILER
 18524         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 339
* EL6311.cbl
 18525
 18526 3990-NOT-FOUND.
 18527     MOVE LOW-VALUES             TO EL631BI.
 18528
 18529     IF PI-MAP-NAME = EL631B
 18530         MOVE -1                  TO BMAINTL
 18531     ELSE
 18532         MOVE -1                  TO CMAINTL.
 18533
 18534     GO TO 8100-SEND-INITIAL-MAP.
 18535
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 340
* EL6311.cbl
 18537
 18538***************************************************************
 18539*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18540*                                                             *
 18541*      1. START BROWSE WITH                                   *
 18542*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18543*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18544*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18545*                                                             *
 18546*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18547*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18548*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18549*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18550*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18551*               AND IS IT TO BE DISPLAYED.                    *
 18552*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18553*               DISPLAYED.                                    *
 18554*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18555*               DISPLAYED.                                    *
 18556*                                                             *
 18557*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18558*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18559***************************************************************
 18560
 18561 4000-BROWSE-DETAIL-FORWARD.
 18562     IF FIRST-TIME
 18563        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18564     ELSE
 18565        IF SHOW-RECORD
 18566           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18567           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18568           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18569           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18570           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18571        ELSE
 18572           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18573
 18574
 18575* EXEC CICS HANDLE CONDITION
 18576*         NOTFND   (4050-END-RECORDS)
 18577*         ENDFILE  (4050-END-RECORDS)
 18578*    END-EXEC.
 18579*    MOVE '"$I''                  ! D #00016064' TO DFHEIV0
 18580     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18582     MOVE X'4420233030303136303634' TO DFHEIV0(25:11)
 18583     CALL 'kxdfhei1' USING DFHEIV0
 18584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18585
 18586
 18587
 18588* EXEC CICS STARTBR
 18589*         DATASET   (FILE-ID-ERPNDB2)
 18590*         RIDFLD    (ERPNDB-ALT-KEY)
 18591*    END-EXEC.
 18592     MOVE 0
 18593       TO DFHEIV11
 18594*    MOVE '&,         G          &   #00016069' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 341
* EL6311.cbl
 18595     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18597     MOVE X'2020233030303136303639' TO DFHEIV0(25:11)
 18598     CALL 'kxdfhei1' USING DFHEIV0,
 18599           FILE-ID-ERPNDB2,
 18600           ERPNDB-ALT-KEY,
 18601           DFHEIV99,
 18602           DFHEIV11,
 18603           DFHEIV99
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18605
 18606
 18607     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18608
 18609     IF FIRST-TIME OR SHOW-RECORD
 18610        MOVE SPACE               TO WS-FIRST-TIME-SW
 18611        GO TO 4005-READ-NEXT-RECORD.
 18612
 18613
 18614* EXEC CICS READNEXT
 18615*         DATASET    (FILE-ID-ERPNDB2)
 18616*         SET        (ADDRESS OF PENDING-BUSINESS)
 18617*         RIDFLD     (ERPNDB-ALT-KEY)
 18618*    END-EXEC.
 18619     MOVE 0
 18620       TO DFHEIV11
 18621*    MOVE '&.S                   )   #00016080' TO DFHEIV0
 18622     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18624     MOVE X'2020233030303136303830' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0,
 18626           FILE-ID-ERPNDB2,
 18627           DFHEIV20,
 18628           DFHEIV99,
 18629           ERPNDB-ALT-KEY,
 18630           DFHEIV99,
 18631           DFHEIV11,
 18632           DFHEIV99,
 18633           DFHEIV99
 18634     SET ADDRESS OF PENDING-BUSINESS TO
 18635         DFHEIV20
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638
 18639 4005-READ-NEXT-RECORD.
 18640
 18641* EXEC CICS READNEXT
 18642*         DATASET    (FILE-ID-ERPNDB2)
 18643*         SET        (ADDRESS OF PENDING-BUSINESS)
 18644*         RIDFLD     (ERPNDB-ALT-KEY)
 18645*    END-EXEC.
 18646     MOVE 0
 18647       TO DFHEIV11
 18648*    MOVE '&.S                   )   #00016087' TO DFHEIV0
 18649     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18650     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18651     MOVE X'2020233030303136303837' TO DFHEIV0(25:11)
 18652     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 342
* EL6311.cbl
 18653           FILE-ID-ERPNDB2,
 18654           DFHEIV20,
 18655           DFHEIV99,
 18656           ERPNDB-ALT-KEY,
 18657           DFHEIV99,
 18658           DFHEIV11,
 18659           DFHEIV99,
 18660           DFHEIV99
 18661     SET ADDRESS OF PENDING-BUSINESS TO
 18662         DFHEIV20
 18663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18664
 18665
 18666     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18667
 18668     IF WS-BATCH-PREFIX = '#CL'
 18669        GO TO 4005-READ-NEXT-RECORD.
 18670
 18671     IF SHOW-RECORD
 18672        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18673           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18674           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18675           PB-STATE         NOT = PI-PB-STATE          OR
 18676           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18677           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18678           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18679           GO TO 4050-END-RECORDS
 18680        ELSE
 18681           GO TO 4010-CHECK-REC-TYPE.
 18682
 18683     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18684        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18685        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18686        PB-STATE            NOT = PI-PB-STATE          OR
 18687        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18688        GO TO 4050-END-RECORDS.
 18689
 18690     IF PB-BATCH-TRAILER
 18691        GO TO 4005-READ-NEXT-RECORD.
 18692
 18693     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18694        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18695           GO TO 4005-READ-NEXT-RECORD
 18696        ELSE
 18697           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18698              GO TO 4010-CHECK-REC-TYPE
 18699           ELSE
 18700              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18701                 GO TO 4010-CHECK-REC-TYPE
 18702              ELSE
 18703                 GO TO 4005-READ-NEXT-RECORD.
 18704
 18705     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18706        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18707           GO TO 4005-READ-NEXT-RECORD.
 18708
 18709 4010-CHECK-REC-TYPE.
 18710     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 343
* EL6311.cbl
 18711         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18712             NEXT SENTENCE
 18713         ELSE
 18714             GO TO 4005-READ-NEXT-RECORD.
 18715
 18716     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18717         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18718             NEXT SENTENCE
 18719        ELSE
 18720             GO TO 4005-READ-NEXT-RECORD.
 18721
 18722     IF NOT DISPLAY-CHANGE-RECORDS AND
 18723            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18724        GO TO 4005-READ-NEXT-RECORD.
 18725
 18726     IF DISPLAY-HOLD-RECORDS AND
 18727        NOT PB-RECORD-ON-HOLD
 18728          GO TO 4005-READ-NEXT-RECORD.
 18729
 18730     IF PB-ISSUE
 18731        IF DISPLAY-CHK-REQ-RECORDS
 18732            GO TO 4005-READ-NEXT-RECORD.
 18733
 18734     IF PB-ISSUE
 18735        IF ISSUE-WITH-WARNING
 18736           IF PB-WARNING-ERRORS
 18737              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18738                  GO TO 4005-READ-NEXT-RECORD
 18739              ELSE
 18740                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18741                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18742                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18743                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18744                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18745                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18746                 GO TO 7000-DISPLAY-ISSUES
 18747           ELSE
 18748              GO TO 4005-READ-NEXT-RECORD.
 18749
 18750     IF PB-ISSUE
 18751        IF (ISSUES-IN-ERROR AND
 18752            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18753            ALL-ISSUES
 18754            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18755            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18756            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18757            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18758            MOVE PB-SV-STATE            TO PI-SV-STATE
 18759            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18760            GO TO 7000-DISPLAY-ISSUES
 18761        ELSE
 18762            GO TO 4005-READ-NEXT-RECORD.
 18763
 18764     IF PB-CANCELLATION
 18765        IF DISPLAY-CHK-REQ-RECORDS
 18766           IF PB-C-REFUND-REQUESTED
 18767              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18768              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 344
* EL6311.cbl
 18769              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18770              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18771              MOVE PB-SV-STATE            TO PI-SV-STATE
 18772              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18773              GO TO 7100-DISPLAY-CANCELS
 18774           ELSE
 18775               GO TO 4005-READ-NEXT-RECORD.
 18776
 18777     IF PB-CANCELLATION
 18778        IF CANCEL-WITH-WARNING
 18779           IF PB-WARNING-ERRORS
 18780              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18781                  GO TO 4005-READ-NEXT-RECORD
 18782              ELSE
 18783                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18784                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18785                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18786                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18787                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18788                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18789                 GO TO 7100-DISPLAY-CANCELS
 18790           ELSE
 18791              GO TO 4005-READ-NEXT-RECORD.
 18792
 18793     IF PB-CANCELLATION
 18794        IF (CANCEL-IN-ERROR  AND
 18795            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18796            ALL-CANCELS
 18797            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18798            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18799            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18800            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18801            MOVE PB-SV-STATE            TO PI-SV-STATE
 18802            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18803            GO TO 7100-DISPLAY-CANCELS.
 18804
 18805     GO TO 4005-READ-NEXT-RECORD.
 18806
 18807 4050-END-RECORDS.
 18808******************************************************************
 18809*                                                                *
 18810*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18811*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18812*         PROGRAM.                                               *
 18813*                                                                *
 18814******************************************************************
 18815
 18816     IF BROWSE-STARTED
 18817        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18818
 18819* EXEC CICS ENDBR
 18820*            DATASET  (FILE-ID-ERPNDB2)
 18821*       END-EXEC.
 18822     MOVE 0
 18823       TO DFHEIV11
 18824*    MOVE '&2                    $   #00016245' TO DFHEIV0
 18825     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 345
* EL6311.cbl
 18827     MOVE X'2020233030303136323435' TO DFHEIV0(25:11)
 18828     CALL 'kxdfhei1' USING DFHEIV0,
 18829           FILE-ID-ERPNDB2,
 18830           DFHEIV11,
 18831           DFHEIV99
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835     IF  EIBTRNID NOT = TRANS-EXB1
 18836         IF PENDING-BUS-RECS-FOUND
 18837             NEXT SENTENCE
 18838           ELSE
 18839             MOVE '9'            TO PI-BROWSE-SW
 18840             GO TO 9400-CLEAR.
 18841
 18842     IF SHOW-RECORD
 18843        MOVE ER-2253            TO EMI-ERROR
 18844       ELSE
 18845        MOVE ER-2254            TO EMI-ERROR.
 18846
 18847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18848
 18849     IF PI-MAP-NAME = SPACES
 18850        MOVE -1                  TO DPFENTRL
 18851        MOVE EL631D               TO PI-MAP-NAME
 18852        GO TO 8100-SEND-INITIAL-MAP.
 18853
 18854     IF PI-MAP-NAME = EL631B
 18855        MOVE -1                  TO BMAINTL
 18856     ELSE
 18857        IF PI-MAP-NAME = EL631C
 18858           MOVE -1               TO CMAINTL
 18859        ELSE
 18860           MOVE -1               TO DPFENTRL.
 18861
 18862     GO TO 8200-SEND-DATAONLY.
 18863
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 346
* EL6311.cbl
 18865
 18866***************************************************************
 18867*                                                             *
 18868*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18869*                                                             *
 18870*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18871*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18872*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18873*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18874*                                                             *
 18875*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18876*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18877*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18878*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18879*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18880*                AND IS IT TO BE DISPLAYED.                   *
 18881*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18882*                DISPLAYED.                                   *
 18883*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18884*                DISPLAYED.                                   *
 18885*                                                             *
 18886*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18887*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18888*                                                             *
 18889*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18890*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18891*                THEY ARE NOT TO BE DISPLAYED.                *
 18892*                                                             *
 18893***************************************************************
 18894
 18895 4100-BROWSE-PRIMARY-FORWARD.
 18896     IF FIRST-TIME  OR SHOW-RECORD
 18897        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18898        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18899        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18900     ELSE
 18901        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18902        IF ERPNDB-BATCH-SEQ-NO = +9999
 18903           GO TO 4150-END-BATCH
 18904        ELSE
 18905           IF DISPLAY-CHANGE-RECORDS
 18906              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18907           ELSE
 18908              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18909              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18910
 18911     IF FIRST-TIME
 18912         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18913            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18914              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18915
 18916
 18917* EXEC CICS HANDLE CONDITION
 18918*         ENDFILE  (4150-END-BATCH)
 18919*    END-EXEC.
 18920*    MOVE '"$''                   ! E #00016330' TO DFHEIV0
 18921     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 347
* EL6311.cbl
 18923     MOVE X'4520233030303136333330' TO DFHEIV0(25:11)
 18924     CALL 'kxdfhei1' USING DFHEIV0
 18925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18926
 18927
 18928 4105-READ-NEXT.
 18929
 18930* EXEC CICS HANDLE CONDITION
 18931*         NOTFND    (4150-END-BATCH)
 18932*    END-EXEC.
 18933*    MOVE '"$I                   ! F #00016335' TO DFHEIV0
 18934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18936     MOVE X'4620233030303136333335' TO DFHEIV0(25:11)
 18937     CALL 'kxdfhei1' USING DFHEIV0
 18938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18939
 18940
 18941     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18942
 18943     IF PI-DISPLAY-ORIGINAL-BATCH
 18944        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18945     ELSE
 18946        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18947
 18948
 18949* EXEC CICS READ
 18950*         DATASET   (FILE-ID)
 18951*         SET       (ADDRESS OF PENDING-BUSINESS)
 18952*         RIDFLD    (ERPNDB-KEY)
 18953*         GTEQ
 18954*    END-EXEC.
 18955*    MOVE '&"S        G          (   #00016346' TO DFHEIV0
 18956     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18958     MOVE X'2020233030303136333436' TO DFHEIV0(25:11)
 18959     CALL 'kxdfhei1' USING DFHEIV0,
 18960           FILE-ID,
 18961           DFHEIV20,
 18962           DFHEIV99,
 18963           ERPNDB-KEY,
 18964           DFHEIV99,
 18965           DFHEIV99,
 18966           DFHEIV99
 18967     SET ADDRESS OF PENDING-BUSINESS TO
 18968         DFHEIV20
 18969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18970
 18971
 18972     IF PI-DISPLAY-ORIGINAL-BATCH
 18973        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18974           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18975           GO TO 4150-END-BATCH
 18976        ELSE
 18977           IF PB-BATCH-TRAILER
 18978              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18979              GO TO 4105-READ-NEXT
 18980           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 348
* EL6311.cbl
 18981              NEXT SENTENCE
 18982     ELSE
 18983        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18984           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18985           GO TO 4150-END-BATCH.
 18986
 18987     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18988
 18989     IF WS-BATCH-PREFIX = '#CL'
 18990         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18991         GO TO 4105-READ-NEXT.
 18992
 18993     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18994     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18995     MOVE PB-STATE               TO PI-PB-STATE.
 18996     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18997
 18998     IF PB-BATCH-TRAILER
 18999        IF SHOW-RECORD
 19000           GO TO 4150-END-BATCH
 19001        ELSE
 19002           MOVE ER-2251         TO EMI-ERROR
 19003           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19004           MOVE 1               TO PI-BROWSE-TYPE
 19005           GO TO 7200-DISPLAY-BATCHES.
 19006
 19007     IF SHOW-RECORD
 19008           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19009              GO TO 4110-BUMP-SEQ
 19010           ELSE
 19011              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19012                 GO TO 4110-BUMP-SEQ
 19013              ELSE
 19014                 GO TO 4107-CHECK-REC-TYPE.
 19015
 19016     IF NOT  PI-PRIMARY-WITH-SELECT
 19017        GO TO 4107-CHECK-REC-TYPE.
 19018
 19019     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19020        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19021           GO TO 4110-BUMP-SEQ
 19022        ELSE
 19023           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19024              GO TO 4107-CHECK-REC-TYPE
 19025           ELSE
 19026              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19027                 GO TO 4107-CHECK-REC-TYPE
 19028              ELSE
 19029                 GO TO 4110-BUMP-SEQ.
 19030
 19031     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19032        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19033           GO TO 4110-BUMP-SEQ.
 19034
 19035 4107-CHECK-REC-TYPE.
 19036     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19037         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19038             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 349
* EL6311.cbl
 19039           ELSE
 19040             GO TO 4110-BUMP-SEQ.
 19041
 19042     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19043         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19044             NEXT SENTENCE
 19045           ELSE
 19046             GO TO 4110-BUMP-SEQ.
 19047
 19048     IF NOT DISPLAY-CHANGE-RECORDS AND
 19049        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19050           GO TO 4110-BUMP-SEQ.
 19051
 19052     IF DISPLAY-HOLD-RECORDS AND
 19053        NOT PB-RECORD-ON-HOLD
 19054          GO TO 4110-BUMP-SEQ.
 19055
 19056     IF PB-ISSUE
 19057        IF DISPLAY-CHK-REQ-RECORDS
 19058            GO TO 4110-BUMP-SEQ.
 19059
 19060     IF PB-ISSUE
 19061        IF ISSUE-WITH-WARNING
 19062           IF PB-WARNING-ERRORS
 19063              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19064                  GO TO 4110-BUMP-SEQ
 19065              ELSE
 19066                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19067                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19068                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19069                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19070                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19071                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19072                 GO TO 7000-DISPLAY-ISSUES
 19073        ELSE
 19074            GO TO 4110-BUMP-SEQ.
 19075
 19076     IF PB-ISSUE
 19077        IF (ISSUES-IN-ERROR AND
 19078            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19079            ALL-ISSUES
 19080            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19081            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19082            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19083            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19084            MOVE PB-SV-STATE            TO PI-SV-STATE
 19085            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19086            GO TO 7000-DISPLAY-ISSUES
 19087        ELSE
 19088            GO TO 4110-BUMP-SEQ.
 19089
 19090     IF PB-CANCELLATION
 19091        IF DISPLAY-CHK-REQ-RECORDS
 19092           IF PB-C-REFUND-REQUESTED
 19093              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19094              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19095              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19096              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 350
* EL6311.cbl
 19097              MOVE PB-SV-STATE            TO PI-SV-STATE
 19098              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19099              GO TO 7100-DISPLAY-CANCELS
 19100           ELSE
 19101              GO TO 4110-BUMP-SEQ.
 19102
 19103     IF PB-CANCELLATION
 19104        IF CANCEL-WITH-WARNING
 19105           IF PB-WARNING-ERRORS
 19106              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19107                  GO TO 4110-BUMP-SEQ
 19108              ELSE
 19109                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19110                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19111                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19112                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19113                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19114                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19115                 GO TO 7100-DISPLAY-CANCELS
 19116           ELSE
 19117              GO TO 4110-BUMP-SEQ.
 19118
 19119     IF PB-CANCELLATION
 19120        IF (CANCEL-IN-ERROR  AND
 19121            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19122            ALL-CANCELS
 19123            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19124            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19125            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19126            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19127            MOVE PB-SV-STATE            TO PI-SV-STATE
 19128            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19129            GO TO 7100-DISPLAY-CANCELS.
 19130
 19131 4110-BUMP-SEQ.
 19132     IF NOT DISPLAY-CHANGE-RECORDS
 19133        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19134        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19135     ELSE
 19136        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19137           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19138           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19139        ELSE
 19140           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19141           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19142
 19143     GO TO 4105-READ-NEXT.
 19144
 19145 4150-END-BATCH.
 19146******************************************************************
 19147*                                                                *
 19148*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19149*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19150*         PROGRAM.                                               *
 19151*                                                                *
 19152******************************************************************
 19153
 19154     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 351
* EL6311.cbl
 19155         IF PENDING-BUS-RECS-FOUND
 19156             NEXT SENTENCE
 19157           ELSE
 19158             MOVE '9'            TO PI-BROWSE-SW
 19159             GO TO 9400-CLEAR.
 19160
 19161     IF SHOW-RECORD
 19162        MOVE ER-2253             TO EMI-ERROR
 19163     ELSE
 19164        MOVE ER-2251             TO EMI-ERROR.
 19165
 19166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19167
 19168     IF PI-MAP-NAME = SPACES
 19169        MOVE -1                  TO BMAINTL
 19170        MOVE EL631B              TO PI-MAP-NAME
 19171        GO TO 8100-SEND-INITIAL-MAP.
 19172
 19173     IF PI-MAP-NAME = EL631B
 19174        MOVE -1                  TO BMAINTL
 19175     ELSE
 19176        IF PI-MAP-NAME = EL631C
 19177           MOVE -1               TO CMAINTL
 19178        ELSE
 19179           MOVE -1               TO DPFENTRL.
 19180
 19181     GO TO 8200-SEND-DATAONLY.
 19182
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 352
* EL6311.cbl
 19184
 19185***************************************************************
 19186*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19187*                                                             *
 19188*      1. START BROWSE WITH                                   *
 19189*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19190*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19191*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19192*                                                             *
 19193*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19194*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19195*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19196*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19197*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19198*               AND IS IT TO BE DISPLAYED.                    *
 19199*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19200*               DISPLAYED.                                    *
 19201*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19202*               DISPLAYED.                                    *
 19203*                                                             *
 19204*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19205*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19206***************************************************************
 19207
 19208 4200-BROWSE-CSR-FORWARD.
 19209
 19210     IF FIRST-TIME
 19211        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19212     ELSE
 19213        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19214
 19215
 19216* EXEC CICS HANDLE CONDITION
 19217*         NOTFND   (4250-END-RECORDS)
 19218*         ENDFILE  (4250-END-RECORDS)
 19219*    END-EXEC.
 19220*    MOVE '"$I''                  ! G #00016596' TO DFHEIV0
 19221     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19223     MOVE X'4720233030303136353936' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0
 19225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19226
 19227
 19228
 19229* EXEC CICS STARTBR
 19230*         DATASET   (FILE-ID-ERPNDB4)
 19231*         RIDFLD    (ERPNDB-CSR-KEY)
 19232*    END-EXEC.
 19233     MOVE 0
 19234       TO DFHEIV11
 19235*    MOVE '&,         G          &   #00016601' TO DFHEIV0
 19236     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19237     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19238     MOVE X'2020233030303136363031' TO DFHEIV0(25:11)
 19239     CALL 'kxdfhei1' USING DFHEIV0,
 19240           FILE-ID-ERPNDB4,
 19241           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 353
* EL6311.cbl
 19242           DFHEIV99,
 19243           DFHEIV11,
 19244           DFHEIV99
 19245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19246
 19247
 19248     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19249
 19250     IF FIRST-TIME
 19251        MOVE SPACE               TO WS-FIRST-TIME-SW
 19252        GO TO 4205-READ-NEXT-RECORD.
 19253
 19254
 19255* EXEC CICS READNEXT
 19256*         DATASET    (FILE-ID-ERPNDB4)
 19257*         SET        (ADDRESS OF PENDING-BUSINESS)
 19258*         RIDFLD     (ERPNDB-CSR-KEY)
 19259*    END-EXEC.
 19260     MOVE 0
 19261       TO DFHEIV11
 19262*    MOVE '&.S                   )   #00016612' TO DFHEIV0
 19263     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19265     MOVE X'2020233030303136363132' TO DFHEIV0(25:11)
 19266     CALL 'kxdfhei1' USING DFHEIV0,
 19267           FILE-ID-ERPNDB4,
 19268           DFHEIV20,
 19269           DFHEIV99,
 19270           ERPNDB-CSR-KEY,
 19271           DFHEIV99,
 19272           DFHEIV11,
 19273           DFHEIV99,
 19274           DFHEIV99
 19275     SET ADDRESS OF PENDING-BUSINESS TO
 19276         DFHEIV20
 19277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19278
 19279
 19280 4205-READ-NEXT-RECORD.
 19281
 19282
 19283* EXEC CICS READNEXT
 19284*         DATASET    (FILE-ID-ERPNDB4)
 19285*         SET        (ADDRESS OF PENDING-BUSINESS)
 19286*         RIDFLD     (ERPNDB-CSR-KEY)
 19287*    END-EXEC.
 19288     MOVE 0
 19289       TO DFHEIV11
 19290*    MOVE '&.S                   )   #00016620' TO DFHEIV0
 19291     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303136363230' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           FILE-ID-ERPNDB4,
 19296           DFHEIV20,
 19297           DFHEIV99,
 19298           ERPNDB-CSR-KEY,
 19299           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 354
* EL6311.cbl
 19300           DFHEIV11,
 19301           DFHEIV99,
 19302           DFHEIV99
 19303     SET ADDRESS OF PENDING-BUSINESS TO
 19304         DFHEIV20
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19306
 19307
 19308     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19309
 19310     IF WS-BATCH-PREFIX = '#CL'
 19311        GO TO 4205-READ-NEXT-RECORD.
 19312
 19313     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19314        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19315        GO TO 4250-END-RECORDS.
 19316
 19317     IF PB-BATCH-TRAILER
 19318        GO TO 4205-READ-NEXT-RECORD.
 19319
 19320     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19321        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19322           GO TO 4205-READ-NEXT-RECORD
 19323        ELSE
 19324           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19325              GO TO 4210-CHECK-REC-TYPE
 19326           ELSE
 19327              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19328                 GO TO 4210-CHECK-REC-TYPE
 19329              ELSE
 19330                 GO TO 4205-READ-NEXT-RECORD.
 19331
 19332     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19333        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19334           GO TO 4205-READ-NEXT-RECORD.
 19335
 19336 4210-CHECK-REC-TYPE.
 19337     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19338         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19339             NEXT SENTENCE
 19340         ELSE
 19341             GO TO 4205-READ-NEXT-RECORD.
 19342
 19343     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19344         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19345             NEXT SENTENCE
 19346        ELSE
 19347             GO TO 4205-READ-NEXT-RECORD.
 19348
 19349     IF NOT DISPLAY-CHANGE-RECORDS AND
 19350            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19351        GO TO 4205-READ-NEXT-RECORD.
 19352
 19353     IF DISPLAY-HOLD-RECORDS AND
 19354        NOT PB-RECORD-ON-HOLD
 19355          GO TO 4205-READ-NEXT-RECORD.
 19356
 19357     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 355
* EL6311.cbl
 19358        IF DISPLAY-CHK-REQ-RECORDS
 19359            GO TO 4205-READ-NEXT-RECORD.
 19360
 19361     IF PB-ISSUE
 19362        IF ISSUE-WITH-WARNING
 19363           IF PB-WARNING-ERRORS
 19364              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19365                  GO TO 4205-READ-NEXT-RECORD
 19366              ELSE
 19367                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19368                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19369                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19370                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19371                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19372                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19373                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19374                 GO TO 7000-DISPLAY-ISSUES
 19375           ELSE
 19376              GO TO 4205-READ-NEXT-RECORD.
 19377
 19378     IF PB-ISSUE
 19379        IF (ISSUES-IN-ERROR AND
 19380            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19381            ALL-ISSUES
 19382            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19383            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19384            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19385            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19386            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19387            MOVE PB-SV-STATE            TO PI-SV-STATE
 19388            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19389            GO TO 7000-DISPLAY-ISSUES
 19390        ELSE
 19391            GO TO 4205-READ-NEXT-RECORD.
 19392
 19393     IF PB-CANCELLATION
 19394        IF DISPLAY-CHK-REQ-RECORDS
 19395           IF PB-C-REFUND-REQUESTED
 19396              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19397              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19398              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19399              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19400              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19401              MOVE PB-SV-STATE            TO PI-SV-STATE
 19402              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19403              GO TO 7100-DISPLAY-CANCELS
 19404           ELSE
 19405               GO TO 4205-READ-NEXT-RECORD.
 19406
 19407     IF PB-CANCELLATION
 19408        IF CANCEL-WITH-WARNING
 19409           IF PB-WARNING-ERRORS
 19410              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19411                  GO TO 4205-READ-NEXT-RECORD
 19412              ELSE
 19413                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19414                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19415                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 356
* EL6311.cbl
 19416                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19417                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19418                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19419                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19420                 GO TO 7100-DISPLAY-CANCELS
 19421           ELSE
 19422              GO TO 4205-READ-NEXT-RECORD.
 19423
 19424     IF PB-CANCELLATION
 19425        IF (CANCEL-IN-ERROR  AND
 19426            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19427            ALL-CANCELS
 19428            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19429            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19430            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19431            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19432            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19433            MOVE PB-SV-STATE            TO PI-SV-STATE
 19434            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19435            GO TO 7100-DISPLAY-CANCELS.
 19436
 19437     GO TO 4205-READ-NEXT-RECORD.
 19438
 19439 4250-END-RECORDS.
 19440******************************************************************
 19441*                                                                *
 19442*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19443*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19444*         PROGRAM.                                               *
 19445*                                                                *
 19446******************************************************************
 19447
 19448     IF BROWSE-STARTED
 19449        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19450
 19451* EXEC CICS ENDBR
 19452*            DATASET  (FILE-ID-ERPNDB4)
 19453*       END-EXEC.
 19454     MOVE 0
 19455       TO DFHEIV11
 19456*    MOVE '&2                    $   #00016768' TO DFHEIV0
 19457     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19458     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19459     MOVE X'2020233030303136373638' TO DFHEIV0(25:11)
 19460     CALL 'kxdfhei1' USING DFHEIV0,
 19461           FILE-ID-ERPNDB4,
 19462           DFHEIV11,
 19463           DFHEIV99
 19464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19465
 19466
 19467     IF  EIBTRNID NOT = TRANS-EXB1
 19468         IF PENDING-BUS-RECS-FOUND
 19469             NEXT SENTENCE
 19470           ELSE
 19471             MOVE '9'            TO PI-BROWSE-SW
 19472             GO TO 9400-CLEAR.
 19473
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 357
* EL6311.cbl
 19474     IF SHOW-RECORD
 19475        MOVE ER-2253            TO EMI-ERROR
 19476       ELSE
 19477        MOVE ER-2254            TO EMI-ERROR.
 19478
 19479     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19480
 19481     IF PI-MAP-NAME = SPACES
 19482        MOVE -1                  TO DPFENTRL
 19483        MOVE EL631D               TO PI-MAP-NAME
 19484        GO TO 8100-SEND-INITIAL-MAP.
 19485
 19486     IF PI-MAP-NAME = EL631B
 19487        MOVE -1                  TO BMAINTL
 19488     ELSE
 19489        IF PI-MAP-NAME = EL631C
 19490           MOVE -1               TO CMAINTL
 19491        ELSE
 19492           MOVE -1               TO DPFENTRL.
 19493
 19494     GO TO 8200-SEND-DATAONLY.
 19495
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 358
* EL6311.cbl
 19497
 19498***************************************************************
 19499*                                                             *
 19500*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19501*                                                             *
 19502*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19503*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19504*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19505*                                                             *
 19506*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19507*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19508*          A. IS IT WITHIN THE SAME COMPANY                   *
 19509*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19510*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19511*                AND IS IT TO BE DISPLAYED.                   *
 19512*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19513*                DISPLAYED.                                   *
 19514*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19515*                DISPLAYED.                                   *
 19516*                                                             *
 19517*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19518*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19519*                                                             *
 19520*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19521*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19522*                THEY ARE NOT TO BE DISPLAYED.                *
 19523*                                                             *
 19524***************************************************************
 19525
 19526 4300-BROWSE-FILE-FORWARD.
 19527     IF FIRST-TIME OR SHOW-RECORD
 19528        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19529        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19530        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19531     ELSE
 19532        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19533        IF ERPNDB-BATCH-SEQ-NO = +9999
 19534           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19535        ELSE
 19536           IF DISPLAY-CHANGE-RECORDS
 19537              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19538           ELSE
 19539              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19540              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19541
 19542
 19543* EXEC CICS HANDLE CONDITION
 19544*         ENDFILE  (4350-END-BATCH)
 19545*         NOTFND   (4350-END-BATCH)
 19546*    END-EXEC.
 19547*    MOVE '"$''I                  ! H #00016847' TO DFHEIV0
 19548     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19550     MOVE X'4820233030303136383437' TO DFHEIV0(25:11)
 19551     CALL 'kxdfhei1' USING DFHEIV0
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 359
* EL6311.cbl
 19555 4305-READ-NEXT.
 19556     IF PI-DISPLAY-ORIGINAL-BATCH
 19557        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19558     ELSE
 19559        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19560
 19561
 19562* EXEC CICS READ
 19563*         DATASET   (FILE-ID)
 19564*         SET       (ADDRESS OF PENDING-BUSINESS)
 19565*         RIDFLD    (ERPNDB-KEY)
 19566*         GTEQ
 19567*    END-EXEC.
 19568*    MOVE '&"S        G          (   #00016858' TO DFHEIV0
 19569     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19571     MOVE X'2020233030303136383538' TO DFHEIV0(25:11)
 19572     CALL 'kxdfhei1' USING DFHEIV0,
 19573           FILE-ID,
 19574           DFHEIV20,
 19575           DFHEIV99,
 19576           ERPNDB-KEY,
 19577           DFHEIV99,
 19578           DFHEIV99,
 19579           DFHEIV99
 19580     SET ADDRESS OF PENDING-BUSINESS TO
 19581         DFHEIV20
 19582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19583
 19584
 19585     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19586        GO TO 4350-END-BATCH.
 19587
 19588     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19589                                    WS-BATCH-NO.
 19590
 19591     IF  WS-BATCH-PREFIX = '#CL'
 19592         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19593         GO TO 4305-READ-NEXT.
 19594
 19595     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19596     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19597     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19598     MOVE PB-STATE               TO PI-PB-STATE.
 19599     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19600
 19601     IF PB-BATCH-TRAILER
 19602        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19603        GO TO 4305-READ-NEXT.
 19604
 19605     IF SHOW-RECORD
 19606           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19607              GO TO 4310-BUMP-SEQ
 19608           ELSE
 19609              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19610                 GO TO 4310-BUMP-SEQ
 19611              ELSE
 19612                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 360
* EL6311.cbl
 19613
 19614     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19615        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19616           GO TO 4310-BUMP-SEQ
 19617        ELSE
 19618           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19619              GO TO 4307-CHECK-REC-TYPE
 19620           ELSE
 19621              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19622                 GO TO 4307-CHECK-REC-TYPE
 19623              ELSE
 19624                 GO TO 4310-BUMP-SEQ.
 19625
 19626     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19627        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19628           GO TO 4310-BUMP-SEQ.
 19629
 19630 4307-CHECK-REC-TYPE.
 19631     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19632         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19633             NEXT SENTENCE
 19634         ELSE
 19635             GO TO 4310-BUMP-SEQ.
 19636
 19637     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19638         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19639             NEXT SENTENCE
 19640        ELSE
 19641             GO TO 4310-BUMP-SEQ.
 19642
 19643     IF NOT DISPLAY-CHANGE-RECORDS AND
 19644            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19645        GO TO 4310-BUMP-SEQ.
 19646
 19647     IF DISPLAY-HOLD-RECORDS AND
 19648        NOT PB-RECORD-ON-HOLD
 19649          GO TO 4310-BUMP-SEQ.
 19650
 19651     IF PB-ISSUE
 19652        IF DISPLAY-CHK-REQ-RECORDS
 19653           GO TO 4310-BUMP-SEQ.
 19654
 19655     IF PB-ISSUE
 19656        IF ISSUE-WITH-WARNING
 19657           IF PB-WARNING-ERRORS
 19658              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19659                  GO TO 4310-BUMP-SEQ
 19660              ELSE
 19661                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19662                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19663                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19664                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19665                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19666                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19667                 GO TO 7000-DISPLAY-ISSUES
 19668           ELSE
 19669              GO TO 4310-BUMP-SEQ.
 19670
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 361
* EL6311.cbl
 19671     IF PB-ISSUE
 19672        IF (ISSUES-IN-ERROR AND
 19673            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19674            ALL-ISSUES
 19675            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19676            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19677            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19678            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19679            MOVE PB-SV-STATE            TO PI-SV-STATE
 19680            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19681            GO TO 7000-DISPLAY-ISSUES
 19682        ELSE
 19683            GO TO 4310-BUMP-SEQ.
 19684
 19685     IF PB-CANCELLATION
 19686        IF DISPLAY-CHK-REQ-RECORDS
 19687           IF PB-C-REFUND-REQUESTED
 19688              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19689              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19690              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19691              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19692              MOVE PB-SV-STATE            TO PI-SV-STATE
 19693              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19694              GO TO 7100-DISPLAY-CANCELS
 19695           ELSE
 19696              GO TO 4310-BUMP-SEQ.
 19697
 19698     IF PB-CANCELLATION
 19699        IF CANCEL-WITH-WARNING
 19700           IF PB-WARNING-ERRORS
 19701              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19702                  GO TO 4310-BUMP-SEQ
 19703              ELSE
 19704                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19705                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19706                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19707                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19708                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19709                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19710                 GO TO 7100-DISPLAY-CANCELS
 19711           ELSE
 19712              GO TO 4310-BUMP-SEQ.
 19713
 19714     IF PB-CANCELLATION
 19715        IF (CANCEL-IN-ERROR  AND
 19716            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19717            ALL-CANCELS
 19718            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19719            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19720            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19721            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19722            MOVE PB-SV-STATE            TO PI-SV-STATE
 19723            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19724            GO TO 7100-DISPLAY-CANCELS.
 19725
 19726 4310-BUMP-SEQ.
 19727     IF NOT DISPLAY-CHANGE-RECORDS
 19728        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 362
* EL6311.cbl
 19729        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19730     ELSE
 19731        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19732           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19733           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19734        ELSE
 19735           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19736           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19737
 19738     GO TO 4305-READ-NEXT.
 19739
 19740 4350-END-BATCH.
 19741
 19742******************************************************************
 19743*                                                                *
 19744*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19745*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19746*         PROGRAM.                                               *
 19747*                                                                *
 19748******************************************************************
 19749
 19750     IF  EIBTRNID NOT = TRANS-EXB1
 19751         IF PENDING-BUS-RECS-FOUND
 19752             NEXT SENTENCE
 19753           ELSE
 19754             MOVE '9'            TO PI-BROWSE-SW
 19755             GO TO 9400-CLEAR.
 19756
 19757     IF SHOW-RECORD
 19758        MOVE ER-2253            TO EMI-ERROR
 19759     ELSE
 19760        MOVE ER-2251            TO EMI-ERROR.
 19761
 19762     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19763
 19764     IF PI-MAP-NAME = SPACES
 19765        MOVE -1                  TO BMAINTL
 19766        MOVE EL631B               TO PI-MAP-NAME
 19767        GO TO 8100-SEND-INITIAL-MAP.
 19768
 19769     IF PI-MAP-NAME = EL631B
 19770        MOVE -1                  TO BMAINTL
 19771     ELSE
 19772        IF PI-MAP-NAME = EL631C
 19773           MOVE -1               TO CMAINTL
 19774        ELSE
 19775           MOVE -1               TO DPFENTRL.
 19776
 19777     GO TO 8200-SEND-DATAONLY.
 19778
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 363
* EL6311.cbl
 19780
 19781******************************************************************
 19782*                                                                *
 19783*        B R O W S E   D E T A I L   B A C K W A R D             *
 19784*                                                                *
 19785******************************************************************
 19786
 19787 4500-BROWSE-DETAIL-BACKWARD.
 19788
 19789     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19790
 19791
 19792* EXEC CICS HANDLE CONDITION
 19793*         NOTFND   (4570-NOT-FOUND)
 19794*         ENDFILE  (4550-END-RECORDS)
 19795*    END-EXEC
 19796*    MOVE '"$I''                  ! I #00017071' TO DFHEIV0
 19797     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19799     MOVE X'4920233030303137303731' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19802
 19803
 19804* EXEC CICS STARTBR
 19805*         DATASET   (FILE-ID-ERPNDB2)
 19806*         RIDFLD    (ERPNDB-ALT-KEY)
 19807*    END-EXEC.
 19808     MOVE 0
 19809       TO DFHEIV11
 19810*    MOVE '&,         G          &   #00017076' TO DFHEIV0
 19811     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19812     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19813     MOVE X'2020233030303137303736' TO DFHEIV0(25:11)
 19814     CALL 'kxdfhei1' USING DFHEIV0,
 19815           FILE-ID-ERPNDB2,
 19816           ERPNDB-ALT-KEY,
 19817           DFHEIV99,
 19818           DFHEIV11,
 19819           DFHEIV99
 19820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19821
 19822
 19823     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19824                                    WS-FIRST-TIME-SW.
 19825
 19826 4505-READ-PREV-RECORD.
 19827
 19828* EXEC CICS READPREV
 19829*         DATASET    (FILE-ID-ERPNDB2)
 19830*         SET        (ADDRESS OF PENDING-BUSINESS)
 19831*         RIDFLD     (ERPNDB-ALT-KEY)
 19832*    END-EXEC.
 19833     MOVE 0
 19834       TO DFHEIV11
 19835*    MOVE '&0S                   )   #00017085' TO DFHEIV0
 19836     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19837     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 364
* EL6311.cbl
 19838     MOVE X'2020233030303137303835' TO DFHEIV0(25:11)
 19839     CALL 'kxdfhei1' USING DFHEIV0,
 19840           FILE-ID-ERPNDB2,
 19841           DFHEIV20,
 19842           DFHEIV99,
 19843           ERPNDB-ALT-KEY,
 19844           DFHEIV99,
 19845           DFHEIV11,
 19846           DFHEIV99,
 19847           DFHEIV99
 19848     SET ADDRESS OF PENDING-BUSINESS TO
 19849         DFHEIV20
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19851
 19852
 19853     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19854
 19855     IF WS-BATCH-PREFIX = '#CL'
 19856         GO TO 4505-READ-PREV-RECORD.
 19857
 19858     IF FIRST-TIME
 19859         MOVE SPACE               TO WS-FIRST-TIME-SW
 19860         GO TO 4505-READ-PREV-RECORD.
 19861
 19862     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19863        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19864        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19865        PB-STATE         NOT = PI-PB-STATE    OR
 19866        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19867          GO TO 4550-END-RECORDS.
 19868
 19869
 19870     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19871
 19872     IF PB-BATCH-TRAILER
 19873        GO TO 4505-READ-PREV-RECORD.
 19874
 19875     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19876
 19877     IF  WS-BATCH-PREFIX = '#CL'
 19878         GO TO 4505-READ-PREV-RECORD.
 19879
 19880     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19881        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19882           GO TO 4505-READ-PREV-RECORD
 19883        ELSE
 19884           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19885              GO TO 4510-CHECK-REC-TYPE
 19886           ELSE
 19887              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19888                 GO TO 4510-CHECK-REC-TYPE
 19889              ELSE
 19890                 GO TO 4505-READ-PREV-RECORD.
 19891
 19892     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19893        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19894           GO TO 4505-READ-PREV-RECORD.
 19895
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 365
* EL6311.cbl
 19896 4510-CHECK-REC-TYPE.
 19897     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19898         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19899             NEXT SENTENCE
 19900         ELSE
 19901             GO TO 4505-READ-PREV-RECORD.
 19902
 19903     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19904         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19905             NEXT SENTENCE
 19906        ELSE
 19907             GO TO 4505-READ-PREV-RECORD.
 19908
 19909     IF NOT DISPLAY-CHANGE-RECORDS AND
 19910            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19911        GO TO 4505-READ-PREV-RECORD.
 19912
 19913     IF DISPLAY-HOLD-RECORDS AND
 19914        NOT PB-RECORD-ON-HOLD
 19915          GO TO 4505-READ-PREV-RECORD.
 19916
 19917     IF PB-ISSUE
 19918        IF DISPLAY-CHK-REQ-RECORDS
 19919           GO TO 4505-READ-PREV-RECORD.
 19920
 19921     IF PB-ISSUE
 19922        IF ISSUE-WITH-WARNING
 19923           IF PB-WARNING-ERRORS
 19924              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19925                  GO TO 4505-READ-PREV-RECORD
 19926              ELSE
 19927                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19928                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19929                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19930                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19931                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19932                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19933                 GO TO 7000-DISPLAY-ISSUES
 19934           ELSE
 19935              GO TO 4505-READ-PREV-RECORD.
 19936
 19937     IF PB-ISSUE
 19938        IF (ISSUES-IN-ERROR AND
 19939            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19940            ALL-ISSUES
 19941            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19942            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19943            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19944            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19945            MOVE PB-SV-STATE            TO PI-SV-STATE
 19946            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19947            GO TO 7000-DISPLAY-ISSUES
 19948        ELSE
 19949            GO TO 4505-READ-PREV-RECORD.
 19950
 19951     IF PB-CANCELLATION
 19952        IF DISPLAY-CHK-REQ-RECORDS
 19953           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 366
* EL6311.cbl
 19954              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19955              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19956              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19957              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19958              MOVE PB-SV-STATE            TO PI-SV-STATE
 19959              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19960              GO TO 7100-DISPLAY-CANCELS
 19961           ELSE
 19962              GO TO 4505-READ-PREV-RECORD.
 19963
 19964     IF PB-CANCELLATION
 19965        IF CANCEL-WITH-WARNING
 19966           IF PB-WARNING-ERRORS
 19967              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19968                  GO TO 4505-READ-PREV-RECORD
 19969              ELSE
 19970                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19971                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19972                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19973                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19974                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19975                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19976                 GO TO 7100-DISPLAY-CANCELS
 19977           ELSE
 19978              GO TO 4505-READ-PREV-RECORD.
 19979
 19980     IF PB-CANCELLATION
 19981        IF (CANCEL-IN-ERROR  AND
 19982            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19983            ALL-CANCELS
 19984            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19985            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19986            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19987            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19988            MOVE PB-SV-STATE            TO PI-SV-STATE
 19989            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19990            GO TO 7100-DISPLAY-CANCELS.
 19991
 19992     GO TO 4505-READ-PREV-RECORD.
 19993
 19994 4550-END-RECORDS.
 19995     IF PI-MAP-NAME = EL631B
 19996        MOVE -1                  TO BMAINTL
 19997     ELSE
 19998        IF PI-MAP-NAME = EL631C
 19999           MOVE -1               TO CMAINTL
 20000        ELSE
 20001           MOVE -1               TO DPFENTRL.
 20002
 20003     MOVE ER-2255               TO EMI-ERROR.
 20004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20005     GO TO 8200-SEND-DATAONLY.
 20006
 20007 4570-NOT-FOUND.
 20008
 20009******************************************************************
 20010*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20011******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 367
* EL6311.cbl
 20012
 20013
 20014* EXEC CICS RESETBR
 20015*         DATASET    (FILE-ID-ERPNDB2)
 20016*         RIDFLD     (ERPNDB-ALT-KEY)
 20017*    END-EXEC.
 20018     MOVE 0
 20019       TO DFHEIV11
 20020*    MOVE '&4         G          &   #00017251' TO DFHEIV0
 20021     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20023     MOVE X'2020233030303137323531' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0,
 20025           FILE-ID-ERPNDB2,
 20026           ERPNDB-ALT-KEY,
 20027           DFHEIV99,
 20028           DFHEIV11,
 20029           DFHEIV99
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033
 20034* EXEC CICS READNEXT
 20035*         DATASET    (FILE-ID-ERPNDB2)
 20036*         SET        (ADDRESS OF PENDING-BUSINESS)
 20037*         RIDFLD     (ERPNDB-ALT-KEY)
 20038*    END-EXEC.
 20039     MOVE 0
 20040       TO DFHEIV11
 20041*    MOVE '&.S                   )   #00017256' TO DFHEIV0
 20042     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20043     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20044     MOVE X'2020233030303137323536' TO DFHEIV0(25:11)
 20045     CALL 'kxdfhei1' USING DFHEIV0,
 20046           FILE-ID-ERPNDB2,
 20047           DFHEIV20,
 20048           DFHEIV99,
 20049           ERPNDB-ALT-KEY,
 20050           DFHEIV99,
 20051           DFHEIV11,
 20052           DFHEIV99,
 20053           DFHEIV99
 20054     SET ADDRESS OF PENDING-BUSINESS TO
 20055         DFHEIV20
 20056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20057
 20058
 20059
 20060* EXEC CICS READPREV
 20061*         DATASET    (FILE-ID-ERPNDB2)
 20062*         SET        (ADDRESS OF PENDING-BUSINESS)
 20063*         RIDFLD     (ERPNDB-ALT-KEY)
 20064*    END-EXEC.
 20065     MOVE 0
 20066       TO DFHEIV11
 20067*    MOVE '&0S                   )   #00017262' TO DFHEIV0
 20068     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20069     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 368
* EL6311.cbl
 20070     MOVE X'2020233030303137323632' TO DFHEIV0(25:11)
 20071     CALL 'kxdfhei1' USING DFHEIV0,
 20072           FILE-ID-ERPNDB2,
 20073           DFHEIV20,
 20074           DFHEIV99,
 20075           ERPNDB-ALT-KEY,
 20076           DFHEIV99,
 20077           DFHEIV11,
 20078           DFHEIV99,
 20079           DFHEIV99
 20080     SET ADDRESS OF PENDING-BUSINESS TO
 20081         DFHEIV20
 20082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20083
 20084
 20085 4580-READ-PREV-RECORD.
 20086
 20087* EXEC CICS READPREV
 20088*         DATASET    (FILE-ID-ERPNDB2)
 20089*         SET        (ADDRESS OF PENDING-BUSINESS)
 20090*         RIDFLD     (ERPNDB-ALT-KEY)
 20091*    END-EXEC.
 20092     MOVE 0
 20093       TO DFHEIV11
 20094*    MOVE '&0S                   )   #00017269' TO DFHEIV0
 20095     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20096     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20097     MOVE X'2020233030303137323639' TO DFHEIV0(25:11)
 20098     CALL 'kxdfhei1' USING DFHEIV0,
 20099           FILE-ID-ERPNDB2,
 20100           DFHEIV20,
 20101           DFHEIV99,
 20102           ERPNDB-ALT-KEY,
 20103           DFHEIV99,
 20104           DFHEIV11,
 20105           DFHEIV99,
 20106           DFHEIV99
 20107     SET ADDRESS OF PENDING-BUSINESS TO
 20108         DFHEIV20
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20110
 20111
 20112     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20113
 20114     IF WS-BATCH-PREFIX = '#CL'
 20115        GO TO 4580-READ-PREV-RECORD.
 20116
 20117     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20118     GO TO 4505-READ-PREV-RECORD.
 20119
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 369
* EL6311.cbl
 20121
 20122******************************************************************
 20123*                                                                *
 20124*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20125*                                                                *
 20126******************************************************************
 20127
 20128 4600-BROWSE-PRIMARY-BACKWARD.
 20129        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20130
 20131     IF ERPNDB-BATCH-SEQ-NO = +9999
 20132        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20133
 20134        IF ERPNDB-BATCH-SEQ-NO = +0000
 20135           GO TO 4650-END-BATCH
 20136        ELSE
 20137           IF PI-MAP-NAME NOT = EL631D
 20138              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20139                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20140              ELSE
 20141                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20142                 IF DISPLAY-CHANGE-RECORDS
 20143                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20144                 ELSE
 20145                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20146
 20147
 20148* EXEC CICS HANDLE CONDITION
 20149*         NOTFND    (4680-NOT-FOUND)
 20150*         ENDFILE   (4680-NOT-FOUND)
 20151*    END-EXEC.
 20152*    MOVE '"$I''                  ! J #00017310' TO DFHEIV0
 20153     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20154     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20155     MOVE X'4A20233030303137333130' TO DFHEIV0(25:11)
 20156     CALL 'kxdfhei1' USING DFHEIV0
 20157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20158
 20159
 20160 4605-READ-NEXT.
 20161     IF ERPNDB-BATCH-SEQ-NO = +0000
 20162        GO TO 4650-END-BATCH.
 20163
 20164     IF PI-DISPLAY-ORIGINAL-BATCH
 20165        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20166     ELSE
 20167        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20168
 20169
 20170* EXEC CICS READ
 20171*         DATASET   (FILE-ID)
 20172*         SET       (ADDRESS OF PENDING-BUSINESS)
 20173*         RIDFLD    (ERPNDB-KEY)
 20174*    END-EXEC.
 20175*    MOVE '&"S        E          (   #00017324' TO DFHEIV0
 20176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20178     MOVE X'2020233030303137333234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 370
* EL6311.cbl
 20179     CALL 'kxdfhei1' USING DFHEIV0,
 20180           FILE-ID,
 20181           DFHEIV20,
 20182           DFHEIV99,
 20183           ERPNDB-KEY,
 20184           DFHEIV99,
 20185           DFHEIV99,
 20186           DFHEIV99
 20187     SET ADDRESS OF PENDING-BUSINESS TO
 20188         DFHEIV20
 20189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20190
 20191
 20192     IF NOT  PI-PRIMARY-WITH-SELECT
 20193        GO TO 4607-CHECK-REC-TYPE.
 20194
 20195     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20196
 20197     IF  WS-BATCH-PREFIX = '#CL'
 20198         GO TO 4610-BUMP-SEQ.
 20199
 20200     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20201        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20202           GO TO 4610-BUMP-SEQ
 20203        ELSE
 20204           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20205              GO TO 4607-CHECK-REC-TYPE
 20206           ELSE
 20207              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20208                 GO TO 4607-CHECK-REC-TYPE
 20209              ELSE
 20210                 GO TO 4610-BUMP-SEQ.
 20211
 20212     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20213        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20214           GO TO 4610-BUMP-SEQ.
 20215
 20216 4607-CHECK-REC-TYPE.
 20217     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20218         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20219             NEXT SENTENCE
 20220         ELSE
 20221             GO TO 4610-BUMP-SEQ.
 20222
 20223     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20224         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20225             NEXT SENTENCE
 20226        ELSE
 20227             GO TO 4610-BUMP-SEQ.
 20228
 20229     IF NOT DISPLAY-CHANGE-RECORDS AND
 20230            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20231        GO TO 4610-BUMP-SEQ.
 20232
 20233     IF DISPLAY-HOLD-RECORDS AND
 20234        NOT PB-RECORD-ON-HOLD
 20235          GO TO 4610-BUMP-SEQ.
 20236
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 371
* EL6311.cbl
 20237     IF PB-ISSUE
 20238        IF DISPLAY-CHK-REQ-RECORDS
 20239           GO TO 4610-BUMP-SEQ.
 20240
 20241     IF PB-ISSUE
 20242        IF ISSUE-WITH-WARNING
 20243           IF PB-WARNING-ERRORS
 20244              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20245                  GO TO 4610-BUMP-SEQ
 20246              ELSE
 20247                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20248                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20249                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20250                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20251                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20252                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20253                 GO TO 7000-DISPLAY-ISSUES
 20254           ELSE
 20255              GO TO 4610-BUMP-SEQ.
 20256
 20257     IF PB-ISSUE
 20258        IF (ISSUES-IN-ERROR AND
 20259            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20260            ALL-ISSUES
 20261            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20262            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20263            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20264            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20265            MOVE PB-SV-STATE            TO PI-SV-STATE
 20266            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20267            GO TO 7000-DISPLAY-ISSUES
 20268        ELSE
 20269            GO TO 4610-BUMP-SEQ.
 20270
 20271     IF PB-CANCELLATION
 20272        IF DISPLAY-CHK-REQ-RECORDS
 20273           IF PB-C-REFUND-REQUESTED
 20274              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20275              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20276              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20277              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20278              MOVE PB-SV-STATE            TO PI-SV-STATE
 20279              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20280              GO TO 7100-DISPLAY-CANCELS
 20281           ELSE
 20282              GO TO 4610-BUMP-SEQ.
 20283
 20284     IF PB-CANCELLATION
 20285        IF CANCEL-WITH-WARNING
 20286           IF PB-WARNING-ERRORS
 20287              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20288                  GO TO 4610-BUMP-SEQ
 20289              ELSE
 20290                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20291                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20292                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20293                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20294                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 372
* EL6311.cbl
 20295                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20296                 GO TO 7100-DISPLAY-CANCELS
 20297           ELSE
 20298              GO TO 4610-BUMP-SEQ.
 20299
 20300     IF PB-CANCELLATION
 20301        IF (CANCEL-IN-ERROR  AND
 20302            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20303            ALL-CANCELS
 20304            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20305            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20306            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20307            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20308            MOVE PB-SV-STATE            TO PI-SV-STATE
 20309            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20310            GO TO 7100-DISPLAY-CANCELS.
 20311
 20312 4610-BUMP-SEQ.
 20313     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20314        GO TO 4650-END-BATCH.
 20315
 20316     IF DISPLAY-CHANGE-RECORDS
 20317        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20318           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20319        ELSE
 20320           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20321           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20322        ELSE
 20323           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20324           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20325
 20326        GO TO 4605-READ-NEXT.
 20327
 20328 4650-END-BATCH.
 20329     IF PI-MAP-NAME = EL631B
 20330        MOVE -1                  TO BMAINTL
 20331     ELSE
 20332        IF PI-MAP-NAME = EL631C
 20333           MOVE -1               TO CMAINTL
 20334        ELSE
 20335           MOVE -1               TO DPFENTRL.
 20336
 20337     MOVE ER-2252               TO EMI-ERROR.
 20338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20339     GO TO 8200-SEND-DATAONLY.
 20340
 20341 4680-NOT-FOUND.
 20342     IF DISPLAY-CHANGE-RECORDS
 20343        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20344           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20345        ELSE
 20346           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20347           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20348     ELSE
 20349        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20350
 20351     GO TO 4605-READ-NEXT.
 20352
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 373
* EL6311.cbl
 20354
 20355******************************************************************
 20356*                                                                *
 20357*        B R O W S E   F I L E   B A C K W A R D S               *
 20358*                                                                *
 20359******************************************************************
 20360
 20361 4800-BROWSE-FILE-BACKWARD.
 20362
 20363* EXEC CICS HANDLE CONDITION
 20364*         NOTFND   (4860-NOT-FOUND)
 20365*         ENDFILE  (4850-END-RECORDS)
 20366*    END-EXEC.
 20367*    MOVE '"$I''                  ! K #00017500' TO DFHEIV0
 20368     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20370     MOVE X'4B20233030303137353030' TO DFHEIV0(25:11)
 20371     CALL 'kxdfhei1' USING DFHEIV0
 20372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20373
 20374
 20375     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20376
 20377     IF PI-DISPLAY-ORIGINAL-BATCH
 20378        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20379     ELSE
 20380        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20381
 20382
 20383* EXEC CICS STARTBR
 20384*         DATASET   (FILE-ID)
 20385*         RIDFLD    (ERPNDB-KEY)
 20386*    END-EXEC.
 20387     MOVE 0
 20388       TO DFHEIV11
 20389*    MOVE '&,         G          &   #00017512' TO DFHEIV0
 20390     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20391     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20392     MOVE X'2020233030303137353132' TO DFHEIV0(25:11)
 20393     CALL 'kxdfhei1' USING DFHEIV0,
 20394           FILE-ID,
 20395           ERPNDB-KEY,
 20396           DFHEIV99,
 20397           DFHEIV11,
 20398           DFHEIV99
 20399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20400
 20401
 20402     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20403
 20404
 20405* EXEC CICS READPREV
 20406*         DATASET    (FILE-ID-ERPNDB)
 20407*         SET        (ADDRESS OF PENDING-BUSINESS)
 20408*         RIDFLD     (ERPNDB-KEY)
 20409*    END-EXEC.
 20410     MOVE 0
 20411       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 374
* EL6311.cbl
 20412*    MOVE '&0S                   )   #00017519' TO DFHEIV0
 20413     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303137353139' TO DFHEIV0(25:11)
 20416     CALL 'kxdfhei1' USING DFHEIV0,
 20417           FILE-ID-ERPNDB,
 20418           DFHEIV20,
 20419           DFHEIV99,
 20420           ERPNDB-KEY,
 20421           DFHEIV99,
 20422           DFHEIV11,
 20423           DFHEIV99,
 20424           DFHEIV99
 20425     SET ADDRESS OF PENDING-BUSINESS TO
 20426         DFHEIV20
 20427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20428
 20429
 20430 4810-READ-PREV-RECORD.
 20431
 20432* EXEC CICS READPREV
 20433*         DATASET    (FILE-ID-ERPNDB)
 20434*         SET        (ADDRESS OF PENDING-BUSINESS)
 20435*         RIDFLD     (ERPNDB-KEY)
 20436*    END-EXEC.
 20437     MOVE 0
 20438       TO DFHEIV11
 20439*    MOVE '&0S                   )   #00017526' TO DFHEIV0
 20440     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303137353236' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
 20444           FILE-ID-ERPNDB,
 20445           DFHEIV20,
 20446           DFHEIV99,
 20447           ERPNDB-KEY,
 20448           DFHEIV99,
 20449           DFHEIV11,
 20450           DFHEIV99,
 20451           DFHEIV99
 20452     SET ADDRESS OF PENDING-BUSINESS TO
 20453         DFHEIV20
 20454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20455
 20456
 20457     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20458        GO TO 4850-END-RECORDS.
 20459
 20460     IF PB-BATCH-TRAILER
 20461        GO TO 4810-READ-PREV-RECORD.
 20462
 20463     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20464
 20465     IF  WS-BATCH-PREFIX = '#CL'
 20466         GO TO 4810-READ-PREV-RECORD.
 20467
 20468     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20469        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 375
* EL6311.cbl
 20470           GO TO 4810-READ-PREV-RECORD
 20471        ELSE
 20472           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20473              GO TO 4820-CHECK-REC-TYPE
 20474           ELSE
 20475              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20476                 GO TO 4820-CHECK-REC-TYPE
 20477              ELSE
 20478                 GO TO 4810-READ-PREV-RECORD.
 20479
 20480     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20481        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20482           GO TO 4810-READ-PREV-RECORD.
 20483
 20484 4820-CHECK-REC-TYPE.
 20485     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20486         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20487             NEXT SENTENCE
 20488         ELSE
 20489             GO TO 4810-READ-PREV-RECORD.
 20490
 20491     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20492         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20493             NEXT SENTENCE
 20494        ELSE
 20495             GO TO 4810-READ-PREV-RECORD.
 20496
 20497     IF NOT DISPLAY-CHANGE-RECORDS AND
 20498            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20499        GO TO 4810-READ-PREV-RECORD.
 20500
 20501     IF DISPLAY-HOLD-RECORDS AND
 20502        NOT PB-RECORD-ON-HOLD
 20503          GO TO 4810-READ-PREV-RECORD.
 20504
 20505     IF PB-ISSUE
 20506        IF DISPLAY-CHK-REQ-RECORDS
 20507           GO TO 4810-READ-PREV-RECORD.
 20508
 20509     IF PB-ISSUE
 20510        IF ISSUE-WITH-WARNING
 20511           IF PB-WARNING-ERRORS
 20512              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20513                  GO TO 4810-READ-PREV-RECORD
 20514              ELSE
 20515                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20516                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20517                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20518                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20519                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20520                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20521                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20522                 GO TO 7000-DISPLAY-ISSUES
 20523           ELSE
 20524              GO TO 4810-READ-PREV-RECORD.
 20525
 20526     IF PB-ISSUE
 20527        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 376
* EL6311.cbl
 20528            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20529            ALL-ISSUES
 20530            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20531            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20532            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20533            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20534            MOVE PB-SV-STATE            TO PI-SV-STATE
 20535            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20536            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20537            GO TO 7000-DISPLAY-ISSUES
 20538        ELSE
 20539            GO TO 4810-READ-PREV-RECORD.
 20540
 20541     IF PB-CANCELLATION
 20542        IF DISPLAY-CHK-REQ-RECORDS
 20543           IF PB-C-REFUND-REQUESTED
 20544              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20545              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20546              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20547              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20548              MOVE PB-SV-STATE            TO PI-SV-STATE
 20549              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20550              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20551              GO TO 7100-DISPLAY-CANCELS
 20552           ELSE
 20553              GO TO 4810-READ-PREV-RECORD.
 20554
 20555     IF PB-CANCELLATION
 20556        IF CANCEL-WITH-WARNING
 20557           IF PB-WARNING-ERRORS
 20558              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20559                  GO TO 4810-READ-PREV-RECORD
 20560              ELSE
 20561                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20562                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20563                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20564                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20565                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20566                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20567                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20568                 GO TO 7100-DISPLAY-CANCELS
 20569           ELSE
 20570              GO TO 4810-READ-PREV-RECORD.
 20571
 20572     IF PB-CANCELLATION
 20573        IF (CANCEL-IN-ERROR  AND
 20574            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20575            ALL-CANCELS
 20576            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20577            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20578            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20579            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20580            MOVE PB-SV-STATE            TO PI-SV-STATE
 20581            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20582            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20583            GO TO 7100-DISPLAY-CANCELS.
 20584
 20585     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 377
* EL6311.cbl
 20586
 20587 4850-END-RECORDS.
 20588     MOVE ER-2252                TO EMI-ERROR.
 20589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20590
 20591     IF PI-MAP-NAME = EL631B
 20592        MOVE -1                  TO BPFENTRL
 20593     ELSE
 20594        MOVE -1                  TO CPFENTRL.
 20595
 20596     GO TO 8200-SEND-DATAONLY.
 20597
 20598 4860-NOT-FOUND.
 20599
 20600******************************************************************
 20601*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20602******************************************************************
 20603
 20604
 20605* EXEC CICS RESETBR
 20606*         DATASET    (FILE-ID-ERPNDB)
 20607*         RIDFLD     (ERPNDB-KEY)
 20608*     END-EXEC.
 20609     MOVE 0
 20610       TO DFHEIV11
 20611*    MOVE '&4         G          &   #00017679' TO DFHEIV0
 20612     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20614     MOVE X'2020233030303137363739' TO DFHEIV0(25:11)
 20615     CALL 'kxdfhei1' USING DFHEIV0,
 20616           FILE-ID-ERPNDB,
 20617           ERPNDB-KEY,
 20618           DFHEIV99,
 20619           DFHEIV11,
 20620           DFHEIV99
 20621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20622
 20623
 20624
 20625* EXEC CICS READNEXT
 20626*         DATASET    (FILE-ID-ERPNDB)
 20627*         SET        (ADDRESS OF PENDING-BUSINESS)
 20628*         RIDFLD     (ERPNDB-KEY)
 20629*    END-EXEC.
 20630     MOVE 0
 20631       TO DFHEIV11
 20632*    MOVE '&.S                   )   #00017684' TO DFHEIV0
 20633     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20635     MOVE X'2020233030303137363834' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0,
 20637           FILE-ID-ERPNDB,
 20638           DFHEIV20,
 20639           DFHEIV99,
 20640           ERPNDB-KEY,
 20641           DFHEIV99,
 20642           DFHEIV11,
 20643           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 378
* EL6311.cbl
 20644           DFHEIV99
 20645     SET ADDRESS OF PENDING-BUSINESS TO
 20646         DFHEIV20
 20647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20648
 20649
 20650
 20651* EXEC CICS READPREV
 20652*         DATASET    (FILE-ID-ERPNDB)
 20653*         SET        (ADDRESS OF PENDING-BUSINESS)
 20654*         RIDFLD     (ERPNDB-KEY)
 20655*    END-EXEC.
 20656     MOVE 0
 20657       TO DFHEIV11
 20658*    MOVE '&0S                   )   #00017690' TO DFHEIV0
 20659     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303137363930' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           FILE-ID-ERPNDB,
 20664           DFHEIV20,
 20665           DFHEIV99,
 20666           ERPNDB-KEY,
 20667           DFHEIV99,
 20668           DFHEIV11,
 20669           DFHEIV99,
 20670           DFHEIV99
 20671     SET ADDRESS OF PENDING-BUSINESS TO
 20672         DFHEIV20
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20674
 20675
 20676     GO TO 4810-READ-PREV-RECORD.
 20677
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 379
* EL6311.cbl
 20679
 20680******************************************************************
 20681*                                                                *
 20682*           B R O W S E   C S R   B A C K W A R D                *
 20683*                                                                *
 20684******************************************************************
 20685
 20686 4900-BROWSE-CSR-BACKWARD.
 20687
 20688     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20689
 20690
 20691* EXEC CICS HANDLE CONDITION
 20692*         NOTFND   (4970-NOT-FOUND)
 20693*         ENDFILE  (4950-END-RECORDS)
 20694*    END-EXEC
 20695*    MOVE '"$I''                  ! L #00017710' TO DFHEIV0
 20696     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20698     MOVE X'4C20233030303137373130' TO DFHEIV0(25:11)
 20699     CALL 'kxdfhei1' USING DFHEIV0
 20700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20701
 20702
 20703* EXEC CICS STARTBR
 20704*         DATASET   (FILE-ID-ERPNDB4)
 20705*         RIDFLD    (ERPNDB-CSR-KEY)
 20706*    END-EXEC.
 20707     MOVE 0
 20708       TO DFHEIV11
 20709*    MOVE '&,         G          &   #00017715' TO DFHEIV0
 20710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20712     MOVE X'2020233030303137373135' TO DFHEIV0(25:11)
 20713     CALL 'kxdfhei1' USING DFHEIV0,
 20714           FILE-ID-ERPNDB4,
 20715           ERPNDB-CSR-KEY,
 20716           DFHEIV99,
 20717           DFHEIV11,
 20718           DFHEIV99
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20723                                    WS-FIRST-TIME-SW.
 20724
 20725 4905-READ-PREV-RECORD.
 20726
 20727* EXEC CICS READPREV
 20728*         DATASET    (FILE-ID-ERPNDB4)
 20729*         SET        (ADDRESS OF PENDING-BUSINESS)
 20730*         RIDFLD     (ERPNDB-CSR-KEY)
 20731*    END-EXEC.
 20732     MOVE 0
 20733       TO DFHEIV11
 20734*    MOVE '&0S                   )   #00017724' TO DFHEIV0
 20735     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 380
* EL6311.cbl
 20737     MOVE X'2020233030303137373234' TO DFHEIV0(25:11)
 20738     CALL 'kxdfhei1' USING DFHEIV0,
 20739           FILE-ID-ERPNDB4,
 20740           DFHEIV20,
 20741           DFHEIV99,
 20742           ERPNDB-CSR-KEY,
 20743           DFHEIV99,
 20744           DFHEIV11,
 20745           DFHEIV99,
 20746           DFHEIV99
 20747     SET ADDRESS OF PENDING-BUSINESS TO
 20748         DFHEIV20
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20750
 20751
 20752     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20753
 20754     IF WS-BATCH-PREFIX = '#CL'
 20755         GO TO 4905-READ-PREV-RECORD.
 20756
 20757     IF FIRST-TIME
 20758         MOVE SPACE               TO WS-FIRST-TIME-SW
 20759         GO TO 4905-READ-PREV-RECORD.
 20760
 20761     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20762        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20763        GO TO 4950-END-RECORDS.
 20764
 20765     IF PB-BATCH-TRAILER
 20766        GO TO 4905-READ-PREV-RECORD.
 20767
 20768     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20769
 20770     IF  WS-BATCH-PREFIX = '#CL'
 20771         GO TO 4905-READ-PREV-RECORD.
 20772
 20773     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20774        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20775           GO TO 4905-READ-PREV-RECORD
 20776        ELSE
 20777           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20778              GO TO 4910-CHECK-REC-TYPE
 20779           ELSE
 20780              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20781                 GO TO 4910-CHECK-REC-TYPE
 20782              ELSE
 20783                 GO TO 4905-READ-PREV-RECORD.
 20784
 20785     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20786        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20787           GO TO 4905-READ-PREV-RECORD.
 20788
 20789 4910-CHECK-REC-TYPE.
 20790     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20791         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20792             NEXT SENTENCE
 20793         ELSE
 20794             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 381
* EL6311.cbl
 20795
 20796     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20797         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20798             NEXT SENTENCE
 20799        ELSE
 20800             GO TO 4905-READ-PREV-RECORD.
 20801
 20802     IF NOT DISPLAY-CHANGE-RECORDS AND
 20803            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20804        GO TO 4905-READ-PREV-RECORD.
 20805
 20806     IF DISPLAY-HOLD-RECORDS AND
 20807        NOT PB-RECORD-ON-HOLD
 20808          GO TO 4905-READ-PREV-RECORD.
 20809
 20810     IF PB-ISSUE
 20811        IF DISPLAY-CHK-REQ-RECORDS
 20812           GO TO 4905-READ-PREV-RECORD.
 20813
 20814     IF PB-ISSUE
 20815        IF ISSUE-WITH-WARNING
 20816           IF PB-WARNING-ERRORS
 20817              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20818                  GO TO 4505-READ-PREV-RECORD
 20819              ELSE
 20820                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20821                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20822                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20823                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20824                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20825                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20826                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20827                 GO TO 7000-DISPLAY-ISSUES
 20828           ELSE
 20829              GO TO 4905-READ-PREV-RECORD.
 20830
 20831     IF PB-ISSUE
 20832        IF (ISSUES-IN-ERROR AND
 20833            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20834            ALL-ISSUES
 20835            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20836            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20837            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20838            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20839            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20840            MOVE PB-SV-STATE            TO PI-SV-STATE
 20841            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20842            GO TO 7000-DISPLAY-ISSUES
 20843        ELSE
 20844            GO TO 4905-READ-PREV-RECORD.
 20845
 20846     IF PB-CANCELLATION
 20847        IF DISPLAY-CHK-REQ-RECORDS
 20848           IF PB-C-REFUND-REQUESTED
 20849              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20850              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20851              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20852              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 382
* EL6311.cbl
 20853              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20854              MOVE PB-SV-STATE            TO PI-SV-STATE
 20855              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20856              GO TO 7100-DISPLAY-CANCELS
 20857           ELSE
 20858              GO TO 4905-READ-PREV-RECORD.
 20859
 20860     IF PB-CANCELLATION
 20861        IF CANCEL-WITH-WARNING
 20862           IF PB-WARNING-ERRORS
 20863              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20864                  GO TO 4505-READ-PREV-RECORD
 20865              ELSE
 20866                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20867                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20868                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20869                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20870                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20871                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20872                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20873                 GO TO 7100-DISPLAY-CANCELS
 20874           ELSE
 20875              GO TO 4905-READ-PREV-RECORD.
 20876
 20877     IF PB-CANCELLATION
 20878        IF (CANCEL-IN-ERROR  AND
 20879            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20880            ALL-CANCELS
 20881            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20882            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20883            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20884            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20885            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20886            MOVE PB-SV-STATE            TO PI-SV-STATE
 20887            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20888            GO TO 7100-DISPLAY-CANCELS.
 20889
 20890     GO TO 4905-READ-PREV-RECORD.
 20891
 20892 4950-END-RECORDS.
 20893     IF PI-MAP-NAME = EL631B
 20894        MOVE -1                  TO BMAINTL
 20895     ELSE
 20896        IF PI-MAP-NAME = EL631C
 20897           MOVE -1               TO CMAINTL
 20898        ELSE
 20899           MOVE -1               TO DPFENTRL.
 20900
 20901     MOVE ER-2255               TO EMI-ERROR.
 20902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20903     GO TO 8200-SEND-DATAONLY.
 20904
 20905 4970-NOT-FOUND.
 20906
 20907******************************************************************
 20908*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20909******************************************************************
 20910
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 383
* EL6311.cbl
 20911
 20912* EXEC CICS RESETBR
 20913*         DATASET    (FILE-ID-ERPNDB4)
 20914*         RIDFLD     (ERPNDB-CSR-KEY)
 20915*    END-EXEC.
 20916     MOVE 0
 20917       TO DFHEIV11
 20918*    MOVE '&4         G          &   #00017889' TO DFHEIV0
 20919     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20921     MOVE X'2020233030303137383839' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0,
 20923           FILE-ID-ERPNDB4,
 20924           ERPNDB-CSR-KEY,
 20925           DFHEIV99,
 20926           DFHEIV11,
 20927           DFHEIV99
 20928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20929
 20930
 20931
 20932* EXEC CICS READNEXT
 20933*         DATASET    (FILE-ID-ERPNDB4)
 20934*         SET        (ADDRESS OF PENDING-BUSINESS)
 20935*         RIDFLD     (ERPNDB-CSR-KEY)
 20936*    END-EXEC.
 20937     MOVE 0
 20938       TO DFHEIV11
 20939*    MOVE '&.S                   )   #00017894' TO DFHEIV0
 20940     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20941     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20942     MOVE X'2020233030303137383934' TO DFHEIV0(25:11)
 20943     CALL 'kxdfhei1' USING DFHEIV0,
 20944           FILE-ID-ERPNDB4,
 20945           DFHEIV20,
 20946           DFHEIV99,
 20947           ERPNDB-CSR-KEY,
 20948           DFHEIV99,
 20949           DFHEIV11,
 20950           DFHEIV99,
 20951           DFHEIV99
 20952     SET ADDRESS OF PENDING-BUSINESS TO
 20953         DFHEIV20
 20954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20955
 20956
 20957
 20958* EXEC CICS READPREV
 20959*         DATASET    (FILE-ID-ERPNDB4)
 20960*         SET        (ADDRESS OF PENDING-BUSINESS)
 20961*         RIDFLD     (ERPNDB-CSR-KEY)
 20962*    END-EXEC.
 20963     MOVE 0
 20964       TO DFHEIV11
 20965*    MOVE '&0S                   )   #00017900' TO DFHEIV0
 20966     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20967     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20968     MOVE X'2020233030303137393030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 384
* EL6311.cbl
 20969     CALL 'kxdfhei1' USING DFHEIV0,
 20970           FILE-ID-ERPNDB4,
 20971           DFHEIV20,
 20972           DFHEIV99,
 20973           ERPNDB-CSR-KEY,
 20974           DFHEIV99,
 20975           DFHEIV11,
 20976           DFHEIV99,
 20977           DFHEIV99
 20978     SET ADDRESS OF PENDING-BUSINESS TO
 20979         DFHEIV20
 20980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20981
 20982
 20983 4980-READ-PREV-RECORD.
 20984
 20985* EXEC CICS READPREV
 20986*         DATASET    (FILE-ID-ERPNDB4)
 20987*         SET        (ADDRESS OF PENDING-BUSINESS)
 20988*         RIDFLD     (ERPNDB-CSR-KEY)
 20989*    END-EXEC.
 20990     MOVE 0
 20991       TO DFHEIV11
 20992*    MOVE '&0S                   )   #00017907' TO DFHEIV0
 20993     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20994     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20995     MOVE X'2020233030303137393037' TO DFHEIV0(25:11)
 20996     CALL 'kxdfhei1' USING DFHEIV0,
 20997           FILE-ID-ERPNDB4,
 20998           DFHEIV20,
 20999           DFHEIV99,
 21000           ERPNDB-CSR-KEY,
 21001           DFHEIV99,
 21002           DFHEIV11,
 21003           DFHEIV99,
 21004           DFHEIV99
 21005     SET ADDRESS OF PENDING-BUSINESS TO
 21006         DFHEIV20
 21007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21008
 21009
 21010     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21011
 21012     IF WS-BATCH-PREFIX = '#CL'
 21013        GO TO 4980-READ-PREV-RECORD.
 21014
 21015     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21016     GO TO 4905-READ-PREV-RECORD.
 21017
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 385
* EL6311.cbl
 21019
 21020
 21021******************************************************************
 21022*                                                                *
 21023*        B R O W S E   B A T C H   H E A D E R S                 *
 21024*                                                                *
 21025******************************************************************
 21026
 21027 5000-BROWSE-BATCH-HEADERS.
 21028
 21029     IF EIBTRNID NOT = TRANS-EXB1
 21030        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21031        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21032        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21033        GO TO 5010-READ-NEXT-RECORD.
 21034
 21035     IF EIBAID = DFHPF4
 21036        MOVE '0'                TO PI-EDIT-SW
 21037        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21038        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21039        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21040        GO TO 5010-READ-NEXT-RECORD.
 21041
 21042     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21043     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21044     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21045
 21046
 21047* EXEC CICS HANDLE CONDITION
 21048*         ENDFILE  (5050-NOT-FOUND)
 21049*    END-EXEC.
 21050*    MOVE '"$''                   ! M #00017949' TO DFHEIV0
 21051     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21053     MOVE X'4D20233030303137393439' TO DFHEIV0(25:11)
 21054     CALL 'kxdfhei1' USING DFHEIV0
 21055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21056
 21057
 21058 5010-READ-NEXT-RECORD.
 21059
 21060* EXEC CICS HANDLE CONDITION
 21061*         NOTFND    (5050-NOT-FOUND)
 21062*    END-EXEC.
 21063*    MOVE '"$I                   ! N #00017954' TO DFHEIV0
 21064     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21066     MOVE X'4E20233030303137393534' TO DFHEIV0(25:11)
 21067     CALL 'kxdfhei1' USING DFHEIV0
 21068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21069
 21070
 21071
 21072* EXEC CICS READ
 21073*         DATASET   (FILE-ID-ERPNDB)
 21074*         SET       (ADDRESS OF PENDING-BUSINESS)
 21075*         RIDFLD    (ERPNDB-KEY)
 21076*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 386
* EL6311.cbl
 21077*    END-EXEC.
 21078*    MOVE '&"S        G          (   #00017958' TO DFHEIV0
 21079     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21081     MOVE X'2020233030303137393538' TO DFHEIV0(25:11)
 21082     CALL 'kxdfhei1' USING DFHEIV0,
 21083           FILE-ID-ERPNDB,
 21084           DFHEIV20,
 21085           DFHEIV99,
 21086           ERPNDB-KEY,
 21087           DFHEIV99,
 21088           DFHEIV99,
 21089           DFHEIV99
 21090     SET ADDRESS OF PENDING-BUSINESS TO
 21091         DFHEIV20
 21092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21093
 21094
 21095     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21096         GO TO 5050-NOT-FOUND.
 21097
 21098     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21099
 21100     IF WS-BATCH-PREFIX = '#CL'
 21101         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21102         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21103         GO TO 5010-READ-NEXT-RECORD.
 21104
 21105     IF NOT PB-BATCH-TRAILER
 21106         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21107         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21108         GO TO 5010-READ-NEXT-RECORD.
 21109
 21110     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21111         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21112             NEXT SENTENCE
 21113         ELSE
 21114             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21115             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21116             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21117             GO TO 5010-READ-NEXT-RECORD.
 21118
 21119     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21120         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21121             NEXT SENTENCE
 21122        ELSE
 21123             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21124             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21125             GO TO 5010-READ-NEXT-RECORD.
 21126
 21127     IF EIBAID = DFHPF4
 21128        MOVE '0'                TO PI-EDIT-SW
 21129        GO TO 7200-DISPLAY-BATCHES.
 21130
 21131     IF PI-CSR-BROWSE
 21132        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21133           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21134           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 387
* EL6311.cbl
 21135           GO TO 5010-READ-NEXT-RECORD.
 21136
 21137     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21138       IF PI-PB-CARRIER    = SPACES AND
 21139          PI-PB-GROUPING   = SPACES AND
 21140          PI-PB-STATE      = SPACES AND
 21141          PI-PB-ACCOUNT    = SPACES
 21142            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21143            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21144            GO TO 7200-DISPLAY-BATCHES
 21145         ELSE
 21146           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21147              PI-PB-GROUPING   = PB-GROUPING AND
 21148              PI-PB-STATE      = PB-STATE    AND
 21149              PI-PB-ACCOUNT    = PB-ACCOUNT
 21150              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21151              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21152              GO TO 7200-DISPLAY-BATCHES.
 21153
 21154     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21155     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21156
 21157
 21158* EXEC CICS HANDLE CONDITION
 21159*         NOTFND    (5050-NOT-FOUND)
 21160*    END-EXEC.
 21161*    MOVE '"$I                   ! O #00018027' TO DFHEIV0
 21162     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21164     MOVE X'4F20233030303138303237' TO DFHEIV0(25:11)
 21165     CALL 'kxdfhei1' USING DFHEIV0
 21166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21167
 21168
 21169
 21170* EXEC CICS READ
 21171*         DATASET   (FILE-ID-ERPNDB)
 21172*         SET       (ADDRESS OF PENDING-BUSINESS)
 21173*         RIDFLD    (ERPNDB-KEY)
 21174*         GTEQ
 21175*    END-EXEC.
 21176*    MOVE '&"S        G          (   #00018031' TO DFHEIV0
 21177     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21179     MOVE X'2020233030303138303331' TO DFHEIV0(25:11)
 21180     CALL 'kxdfhei1' USING DFHEIV0,
 21181           FILE-ID-ERPNDB,
 21182           DFHEIV20,
 21183           DFHEIV99,
 21184           ERPNDB-KEY,
 21185           DFHEIV99,
 21186           DFHEIV99,
 21187           DFHEIV99
 21188     SET ADDRESS OF PENDING-BUSINESS TO
 21189         DFHEIV20
 21190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21191
 21192
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 388
* EL6311.cbl
 21193     GO TO 5010-READ-NEXT-RECORD.
 21194
 21195 5050-NOT-FOUND.
 21196
 21197******************************************************************
 21198*                                                                *
 21199*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21200*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21201*         PROGRAM.                                               *
 21202*                                                                *
 21203******************************************************************
 21204
 21205     IF EIBTRNID NOT = TRANS-EXB1
 21206        IF PENDING-BUS-RECS-FOUND
 21207            NEXT SENTENCE
 21208          ELSE
 21209            MOVE '9'            TO PI-BROWSE-SW
 21210            GO TO 9400-CLEAR.
 21211
 21212     MOVE ER-2256                TO EMI-ERROR.
 21213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21214
 21215     IF PI-MAP-NAME = SPACES
 21216        MOVE EL631D              TO PI-MAP-NAME
 21217        MOVE -1                  TO DPFENTRL
 21218        GO TO 8100-SEND-INITIAL-MAP.
 21219
 21220     IF PI-MAP-NAME = EL631B
 21221        MOVE -1                  TO BMAINTL
 21222     ELSE
 21223        IF PI-MAP-NAME = EL631C
 21224           MOVE -1               TO CMAINTL
 21225        ELSE
 21226           MOVE -1               TO DPFENTRL
 21227           GO TO 8200-SEND-DATAONLY.
 21228
 21229     GO TO 8100-SEND-INITIAL-MAP.
 21230
 21231     .
 21232 5100-PROCESS-POL-RESC.
 21233     MOVE ZEROS                  TO CG-LF-BENCD
 21234                                    CG-AH-BENCD
 21235                                    CG-LF-CAN-AMT
 21236                                    CG-AH-CAN-AMT
 21237     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21238                                    CG-AH-CAN-DT
 21239     MOVE SPACES                 TO CG-BATCH-NO
 21240     MOVE '4'                    TO CG-OPTION-CODE
 21241     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21242     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21243     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21244     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21245     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21246     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21247     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21248     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21249     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21250     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 389
* EL6311.cbl
 21251     MOVE PI-PREV-ALT-KEY (1:33)
 21252                                 TO CG-CERT-KEY
 21253     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21254     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21255                                    CG-AH-CAN-AMT
 21256     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21257                                    CG-AH-CAN-DT
 21258     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21259     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21260      display 'about to cancel ' cg-cert-key
 21261
 21262* EXEC CICS LINK
 21263*        PROGRAM  ('ELCANC')
 21264*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21265*    END-EXEC
 21266     MOVE LENGTH OF
 21267      CANCEL-GEN-PASS-AREA
 21268       TO DFHEIV11
 21269     MOVE 'ELCANC' TO DFHEIV1
 21270*    MOVE '."C                   (   #00018106' TO DFHEIV0
 21271     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21273     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 21274     CALL 'kxdfhei1' USING DFHEIV0,
 21275           DFHEIV1,
 21276           CANCEL-GEN-PASS-AREA,
 21277           DFHEIV11,
 21278           DFHEIV99,
 21279           DFHEIV99,
 21280           DFHEIV99,
 21281           DFHEIV99
 21282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21283     IF CG-SUCCESS
 21284        CONTINUE
 21285     ELSE
 21286        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21287        MOVE '3'                 TO EMI-SWITCH1
 21288        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21289        EVALUATE TRUE
 21290           WHEN CG-DATE-ERROR
 21291             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21292           WHEN CG-CERT-NOT-FOUND
 21293             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21294           WHEN CG-AMOUNT-ERROR
 21295             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21296           WHEN CG-OPTION-ERROR
 21297             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21298           WHEN CG-PREV-CAN
 21299             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21300           WHEN CG-INVALID-DATA
 21301             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21302           WHEN CG-NO-ACCT-MSTR
 21303             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21304           WHEN CG-SFX-A-EXIST
 21305             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21306           WHEN CG-MISC-ERROR
 21307             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21308           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 390
* EL6311.cbl
 21309             MOVE ' ERROR - ELCANC - RETURN '
 21310                                 TO EMI-ERROR-TEXT (1) (12:25)
 21311        END-EVALUATE
 21312        GO TO 8200-SEND-DATAONLY
 21313     END-IF
 21314
 21315* EXEC CICS GETMAIN
 21316*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21317*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21318*        INITIMG (GETMAIN-SPACE)
 21319*    END-EXEC
 21320*    MOVE ',"IL                  $   #00018141' TO DFHEIV0
 21321     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21323     MOVE X'2020233030303138313431' TO DFHEIV0(25:11)
 21324     CALL 'kxdfhei1' USING DFHEIV0,
 21325           DFHEIV20,
 21326           ELCRTT-RECORD-LENGTH,
 21327           GETMAIN-SPACE
 21328     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21329         DFHEIV20
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21331
 21332     move ' '                    to ws-elcrtt-update-sw
 21333     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21334     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21335
 21336
 21337* EXEC CICS READ
 21338*        UPDATE
 21339*        DATASET  (CRTT-ID)
 21340*        RIDFLD   (ELCRTT-KEY)
 21341*        INTO     (CERTIFICATE-TRAILERS)
 21342*        resp     (ws-response)
 21343*    END-EXEC
 21344     MOVE LENGTH OF
 21345      CERTIFICATE-TRAILERS
 21346       TO DFHEIV11
 21347*    MOVE '&"IL       EU         (  N#00018151' TO DFHEIV0
 21348     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21349     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21350     MOVE X'204E233030303138313531' TO DFHEIV0(25:11)
 21351     CALL 'kxdfhei1' USING DFHEIV0,
 21352           CRTT-ID,
 21353           CERTIFICATE-TRAILERS,
 21354           DFHEIV11,
 21355           ELCRTT-KEY,
 21356           DFHEIV99,
 21357           DFHEIV99,
 21358           DFHEIV99
 21359     MOVE EIBRESP  TO ws-response
 21360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21361
 21362     if resp-normal
 21363        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21364                  'E' or 'F' or 'G'
 21365           move 'J'              to cs-claim-verification-status
 21366           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 391
* EL6311.cbl
 21367        end-if
 21368        if update-elcrtt
 21369
 21370* EXEC CICS REWRITE
 21371*             DATASET    (crtt-ID)
 21372*             FROM       (CERTIFICATE-TRAILERS)
 21373*          END-EXEC
 21374     MOVE LENGTH OF
 21375      CERTIFICATE-TRAILERS
 21376       TO DFHEIV11
 21377*    MOVE '&& L                  %   #00018166' TO DFHEIV0
 21378     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21380     MOVE X'2020233030303138313636' TO DFHEIV0(25:11)
 21381     CALL 'kxdfhei1' USING DFHEIV0,
 21382           crtt-ID,
 21383           CERTIFICATE-TRAILERS,
 21384           DFHEIV11,
 21385           DFHEIV99
 21386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21387        else
 21388
 21389* exec cics unlock
 21390*             dataset    (crtt-ID)
 21391*          end-exec
 21392*    MOVE '&*                    #   #00018171' TO DFHEIV0
 21393     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21395     MOVE X'2020233030303138313731' TO DFHEIV0(25:11)
 21396     CALL 'kxdfhei1' USING DFHEIV0,
 21397           crtt-ID,
 21398           DFHEIV99
 21399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21400        end-if
 21401     end-if
 21402     .
 21403 5100-EXIT.
 21404     EXIT.
 21405
 21406******************************************************************
 21407*                                                                *
 21408*        B R O W S E   B A T C H   B A C K W A R D S             *
 21409*                                                                *
 21410******************************************************************
 21411
 21412 5500-BROWSE-BATCH-BACKWARD.
 21413
 21414* EXEC CICS HANDLE CONDITION
 21415*         NOTFND   (5550-END-RECORDS)
 21416*         ENDFILE  (5550-END-RECORDS)
 21417*    END-EXEC.
 21418*    MOVE '"$I''                  ! P #00018187' TO DFHEIV0
 21419     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21421     MOVE X'5020233030303138313837' TO DFHEIV0(25:11)
 21422     CALL 'kxdfhei1' USING DFHEIV0
 21423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21424
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 392
* EL6311.cbl
 21425
 21426 5505-START-BROWSE.
 21427     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21428     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21429     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21430
 21431
 21432* EXEC CICS STARTBR
 21433*         DATASET   (FILE-ID-ERPNDB)
 21434*         RIDFLD    (ERPNDB-ALT-KEY)
 21435*    END-EXEC.
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&,         G          &   #00018197' TO DFHEIV0
 21439     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21441     MOVE X'2020233030303138313937' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           FILE-ID-ERPNDB,
 21444           ERPNDB-ALT-KEY,
 21445           DFHEIV99,
 21446           DFHEIV11,
 21447           DFHEIV99
 21448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21449
 21450
 21451     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21452
 21453
 21454* EXEC CICS READNEXT
 21455*         DATASET    (FILE-ID-ERPNDB)
 21456*         SET        (ADDRESS OF PENDING-BUSINESS)
 21457*         RIDFLD     (ERPNDB-KEY)
 21458*    END-EXEC.
 21459     MOVE 0
 21460       TO DFHEIV11
 21461*    MOVE '&.S                   )   #00018204' TO DFHEIV0
 21462     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21464     MOVE X'2020233030303138323034' TO DFHEIV0(25:11)
 21465     CALL 'kxdfhei1' USING DFHEIV0,
 21466           FILE-ID-ERPNDB,
 21467           DFHEIV20,
 21468           DFHEIV99,
 21469           ERPNDB-KEY,
 21470           DFHEIV99,
 21471           DFHEIV11,
 21472           DFHEIV99,
 21473           DFHEIV99
 21474     SET ADDRESS OF PENDING-BUSINESS TO
 21475         DFHEIV20
 21476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21477
 21478
 21479
 21480* EXEC CICS READPREV
 21481*         DATASET    (FILE-ID-ERPNDB)
 21482*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 393
* EL6311.cbl
 21483*         RIDFLD     (ERPNDB-KEY)
 21484*    END-EXEC.
 21485     MOVE 0
 21486       TO DFHEIV11
 21487*    MOVE '&0S                   )   #00018210' TO DFHEIV0
 21488     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21490     MOVE X'2020233030303138323130' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0,
 21492           FILE-ID-ERPNDB,
 21493           DFHEIV20,
 21494           DFHEIV99,
 21495           ERPNDB-KEY,
 21496           DFHEIV99,
 21497           DFHEIV11,
 21498           DFHEIV99,
 21499           DFHEIV99
 21500     SET ADDRESS OF PENDING-BUSINESS TO
 21501         DFHEIV20
 21502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21503
 21504
 21505
 21506* EXEC CICS READPREV
 21507*         DATASET    (FILE-ID-ERPNDB)
 21508*         SET        (ADDRESS OF PENDING-BUSINESS)
 21509*         RIDFLD     (ERPNDB-KEY)
 21510*    END-EXEC.
 21511     MOVE 0
 21512       TO DFHEIV11
 21513*    MOVE '&0S                   )   #00018216' TO DFHEIV0
 21514     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21515     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21516     MOVE X'2020233030303138323136' TO DFHEIV0(25:11)
 21517     CALL 'kxdfhei1' USING DFHEIV0,
 21518           FILE-ID-ERPNDB,
 21519           DFHEIV20,
 21520           DFHEIV99,
 21521           ERPNDB-KEY,
 21522           DFHEIV99,
 21523           DFHEIV11,
 21524           DFHEIV99,
 21525           DFHEIV99
 21526     SET ADDRESS OF PENDING-BUSINESS TO
 21527         DFHEIV20
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21529
 21530
 21531     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21532        GO TO 5550-END-RECORDS.
 21533
 21534     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21535
 21536     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21537
 21538     IF  WS-BATCH-PREFIX = '#CL'
 21539             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21540
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 394
* EL6311.cbl
 21541* EXEC CICS ENDBR
 21542*                 DATASET  (FILE-ID-ERPNDB)
 21543*            END-EXEC
 21544     MOVE 0
 21545       TO DFHEIV11
 21546*    MOVE '&2                    $   #00018231' TO DFHEIV0
 21547     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21549     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 21550     CALL 'kxdfhei1' USING DFHEIV0,
 21551           FILE-ID-ERPNDB,
 21552           DFHEIV11,
 21553           DFHEIV99
 21554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21555         GO TO 5505-START-BROWSE.
 21556
 21557     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21558         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21559             NEXT SENTENCE
 21560         ELSE
 21561             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21562
 21563* EXEC CICS ENDBR
 21564*                 DATASET  (FILE-ID-ERPNDB)
 21565*            END-EXEC
 21566     MOVE 0
 21567       TO DFHEIV11
 21568*    MOVE '&2                    $   #00018241' TO DFHEIV0
 21569     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21571     MOVE X'2020233030303138323431' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0,
 21573           FILE-ID-ERPNDB,
 21574           DFHEIV11,
 21575           DFHEIV99
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21577             GO TO 5505-START-BROWSE.
 21578
 21579
 21580     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21581         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21582             NEXT SENTENCE
 21583        ELSE
 21584             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21585
 21586* EXEC CICS ENDBR
 21587*                 DATASET  (FILE-ID-ERPNDB)
 21588*            END-EXEC
 21589     MOVE 0
 21590       TO DFHEIV11
 21591*    MOVE '&2                    $   #00018252' TO DFHEIV0
 21592     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21594     MOVE X'2020233030303138323532' TO DFHEIV0(25:11)
 21595     CALL 'kxdfhei1' USING DFHEIV0,
 21596           FILE-ID-ERPNDB,
 21597           DFHEIV11,
 21598           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 395
* EL6311.cbl
 21599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21600             GO TO 5505-START-BROWSE.
 21601
 21602     IF NOT PB-BATCH-TRAILER
 21603        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21604
 21605* EXEC CICS ENDBR
 21606*            DATASET  (FILE-ID-ERPNDB)
 21607*       END-EXEC
 21608     MOVE 0
 21609       TO DFHEIV11
 21610*    MOVE '&2                    $   #00018259' TO DFHEIV0
 21611     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21612     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21613     MOVE X'2020233030303138323539' TO DFHEIV0(25:11)
 21614     CALL 'kxdfhei1' USING DFHEIV0,
 21615           FILE-ID-ERPNDB,
 21616           DFHEIV11,
 21617           DFHEIV99
 21618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21619        GO TO 5505-START-BROWSE.
 21620
 21621     IF PI-CSR-BROWSE
 21622        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21623           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21624
 21625* EXEC CICS ENDBR
 21626*               DATASET  (FILE-ID-ERPNDB)
 21627*          END-EXEC
 21628     MOVE 0
 21629       TO DFHEIV11
 21630*    MOVE '&2                    $   #00018267' TO DFHEIV0
 21631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21633     MOVE X'2020233030303138323637' TO DFHEIV0(25:11)
 21634     CALL 'kxdfhei1' USING DFHEIV0,
 21635           FILE-ID-ERPNDB,
 21636           DFHEIV11,
 21637           DFHEIV99
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21639           GO TO 5505-START-BROWSE.
 21640
 21641     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21642        IF PI-PB-CARRIER    = SPACES AND
 21643           PI-PB-GROUPING   = SPACES AND
 21644           PI-PB-STATE      = SPACES AND
 21645           PI-PB-ACCOUNT    = SPACES
 21646             GO TO 7200-DISPLAY-BATCHES
 21647          ELSE
 21648            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21649               PI-PB-GROUPING   = PB-GROUPING AND
 21650               PI-PB-STATE      = PB-STATE    AND
 21651               PI-PB-ACCOUNT    = PB-ACCOUNT
 21652                 GO TO 7200-DISPLAY-BATCHES.
 21653
 21654     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21655
 21656
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 396
* EL6311.cbl
 21657* EXEC CICS ENDBR
 21658*         DATASET  (FILE-ID-ERPNDB)
 21659*    END-EXEC.
 21660     MOVE 0
 21661       TO DFHEIV11
 21662*    MOVE '&2                    $   #00018287' TO DFHEIV0
 21663     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21665     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 21666     CALL 'kxdfhei1' USING DFHEIV0,
 21667           FILE-ID-ERPNDB,
 21668           DFHEIV11,
 21669           DFHEIV99
 21670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21671
 21672
 21673     GO TO 5505-START-BROWSE.
 21674
 21675 5550-END-RECORDS.
 21676     MOVE ER-2257                TO EMI-ERROR.
 21677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21678     MOVE -1                     TO DPFENTRL.
 21679
 21680     GO TO 8200-SEND-DATAONLY.
 21681
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 397
* EL6311.cbl
 21683
 21684******************************************************************
 21685*                                                                *
 21686*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21687*                                                                *
 21688******************************************************************
 21689
 21690 6000-CREATE-TEMP-STORAGE.
 21691
 21692
 21693* EXEC CICS HANDLE CONDITION
 21694*        QIDERR  (6050-QID-ERROR)
 21695*    END-EXEC.
 21696*    MOVE '"$N                   ! Q #00018310' TO DFHEIV0
 21697     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21699     MOVE X'5120233030303138333130' TO DFHEIV0(25:11)
 21700     CALL 'kxdfhei1' USING DFHEIV0
 21701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21702
 21703
 21704
 21705* EXEC CICS WRITEQ TS
 21706*        QUEUE    (QID)
 21707*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21708*        LENGTH   (WS-COMM-LENGTH)
 21709*        ITEM     (W-ONE)
 21710*    END-EXEC.
 21711*    MOVE '*" I   L              ''   #00018314' TO DFHEIV0
 21712     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21714     MOVE X'2020233030303138333134' TO DFHEIV0(25:11)
 21715     CALL 'kxdfhei1' USING DFHEIV0,
 21716           QID,
 21717           PROGRAM-INTERFACE-BLOCK,
 21718           WS-COMM-LENGTH,
 21719           W-ONE,
 21720           DFHEIV99,
 21721           DFHEIV99
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21723
 21724
 21725 6000-EXIT.
 21726      EXIT.
 21727
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 398
* EL6311.cbl
 21729
 21730******************************************************************
 21731*                                                                *
 21732*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21733*                                                                *
 21734******************************************************************
 21735
 21736 6050-RECOVER-TEMP-STORAGE.
 21737     IF PGM-NAME = XCTL-EL6312
 21738        GO TO 6050-EXIT.
 21739
 21740     IF PGM-NAME = XCTL-EL6313
 21741        GO TO 6050-EXIT.
 21742
 21743     IF PGM-NAME = XCTL-EL6315
 21744         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21745     END-IF
 21746
 21747     IF PGM-NAME = XCTL-EL6316
 21748         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21749     END-IF
 21750
 21751
 21752* EXEC CICS HANDLE CONDITION
 21753*        QIDERR  (6050-QID-ERROR)
 21754*    END-EXEC.
 21755*    MOVE '"$N                   ! R #00018347' TO DFHEIV0
 21756     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21758     MOVE X'5220233030303138333437' TO DFHEIV0(25:11)
 21759     CALL 'kxdfhei1' USING DFHEIV0
 21760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21761
 21762
 21763
 21764* EXEC CICS READQ TS
 21765*         QUEUE   (QID)
 21766*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21767*         LENGTH  (WS-COMM-LENGTH)
 21768*         ITEM    (W-ONE)
 21769*     END-EXEC.
 21770*    MOVE '*$II   L              ''   #00018351' TO DFHEIV0
 21771     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21772     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21773     MOVE X'2020233030303138333531' TO DFHEIV0(25:11)
 21774     CALL 'kxdfhei1' USING DFHEIV0,
 21775           QID,
 21776           PROGRAM-INTERFACE-BLOCK,
 21777           WS-COMM-LENGTH,
 21778           W-ONE,
 21779           DFHEIV99,
 21780           DFHEIV99
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21782
 21783
 21784 6050-DELETE-TEMP-STORAGE.
 21785
 21786
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 399
* EL6311.cbl
 21787* EXEC CICS DELETEQ TS
 21788*        QUEUE   (QID)
 21789*    END-EXEC.
 21790*    MOVE '*&                    #   #00018360' TO DFHEIV0
 21791     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21792     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21793     MOVE X'2020233030303138333630' TO DFHEIV0(25:11)
 21794     CALL 'kxdfhei1' USING DFHEIV0,
 21795           QID,
 21796           DFHEIV99
 21797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21798
 21799
 21800     GO TO 6050-EXIT.
 21801
 21802 6050-QID-ERROR.
 21803     MOVE ER-0033                TO EMI-ERROR
 21804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21805
 21806 6050-EXIT.
 21807      EXIT.
 21808
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 400
* EL6311.cbl
 21810
 21811******************************************************************
 21812*                                                                *
 21813*            T E R M   C O N V E R S I O N                       *
 21814*                                                                *
 21815******************************************************************
 21816
 21817 6100-TERM-CONVERSION.
 21818
 21819     IF PI-BPMTS = ZERO
 21820         GO TO 6199-EXIT.
 21821
 21822     IF PI-BMODE = ' ' OR 'M'
 21823         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21824         GO TO 6105-ROUND-TERM.
 21825
 21826     IF PI-BMODE = 'S'
 21827         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21828         GO TO 6105-ROUND-TERM.
 21829
 21830     IF PI-BMODE = 'W'
 21831         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21832         GO TO 6105-ROUND-TERM.
 21833
 21834     IF PI-BMODE = 'B'
 21835         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21836         GO TO 6105-ROUND-TERM.
 21837
 21838     IF PI-BMODE = 'T'
 21839         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21840
 21841 6105-ROUND-TERM.
 21842
 21843     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21844         ADD +1                  TO WS-CALC-TERM-WHOLE
 21845         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21846
 21847     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21848         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21849
 21850     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21851         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21852                                      WS-BTERM    (WS-SUB1)
 21853         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21854
 21855     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21856         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21857             MOVE -1               TO BMODEL
 21858             MOVE ER-2593          TO EMI-ERROR
 21859             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21861
 21862 6124-CHECK-BENEFIT.
 21863
 21864     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21865        GO TO 6126-COMPUTE-BENEFIT.
 21866
 21867     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 401
* EL6311.cbl
 21868
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 402
* EL6311.cbl
 21870******************************************************************
 21871**         COMPUTE TERM AND BENEFIT
 21872******************************************************************
 21873 6125-COMPUTE-TERM-BENEFIT.
 21874
 21875     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21876        PI-BPMTAMT = ZERO
 21877         GO TO 6199-EXIT.
 21878
 21879     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21880                                     WS-BTERM  (WS-SUB1).
 21881     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21882
 21883 6126-COMPUTE-BENEFIT.
 21884
 21885     IF PI-BMODE = 'M' OR  ' '
 21886         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21887
 21888     IF PI-BMODE = 'W'
 21889         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21890
 21891     IF PI-BMODE = 'S'
 21892         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21893
 21894     IF PI-BMODE = 'B'
 21895         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21896
 21897     IF PI-BMODE = 'T'
 21898         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21899
 21900     IF WS-SUB1 = +1
 21901        COMPUTE WS-BBEN (WS-SUB1) =
 21902                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21903
 21904     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21905     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21906     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21907
 21908 6199-EXIT.
 21909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 403
* EL6311.cbl
 21911
 21912******************************************************************
 21913*                                                                *
 21914*             D I S P L A Y   I S S U E S                        *
 21915*                                                                *
 21916******************************************************************
 21917
 21918 6200-CREATE-VADS.
 21919     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21920     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21921     MOVE SPACES                 TO WS-PASS-VADS-REC
 21922
 21923* EXEC CICS GETMAIN
 21924*       SET      (ADDRESS OF PENDING-BUSINESS)
 21925*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21926*       INITIMG  (GETMAIN-SPACE)
 21927*       RESP     (WS-RESPONSE)
 21928*    END-EXEC
 21929*    MOVE ',"IL                  $  N#00018486' TO DFHEIV0
 21930     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21932     MOVE X'204E233030303138343836' TO DFHEIV0(25:11)
 21933     CALL 'kxdfhei1' USING DFHEIV0,
 21934           DFHEIV20,
 21935           ERPNDB-RECORD-LENGTH,
 21936           GETMAIN-SPACE
 21937     SET ADDRESS OF PENDING-BUSINESS TO
 21938         DFHEIV20
 21939     MOVE EIBRESP  TO WS-RESPONSE
 21940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21941
 21942* EXEC CICS READ
 21943*       INTO    (PENDING-BUSINESS)
 21944*       DATASET (FILE-ID-ERPNDB)
 21945*       RIDFLD  (ERPNDB-KEY)
 21946*       RESP    (WS-RESPONSE)
 21947*    END-EXEC
 21948     MOVE LENGTH OF
 21949      PENDING-BUSINESS
 21950       TO DFHEIV11
 21951*    MOVE '&"IL       E          (  N#00018492' TO DFHEIV0
 21952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21954     MOVE X'204E233030303138343932' TO DFHEIV0(25:11)
 21955     CALL 'kxdfhei1' USING DFHEIV0,
 21956           FILE-ID-ERPNDB,
 21957           PENDING-BUSINESS,
 21958           DFHEIV11,
 21959           ERPNDB-KEY,
 21960           DFHEIV99,
 21961           DFHEIV99,
 21962           DFHEIV99
 21963     MOVE EIBRESP  TO WS-RESPONSE
 21964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21965     IF RESP-NORMAL
 21966        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21967        IF (RESP-NORMAL)
 21968           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 404
* EL6311.cbl
 21969              AM-CONTROL-PRIMARY (1:20))
 21970           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21971        ELSE
 21972           MOVE 'ACCOUNT NOT FOUND'
 21973                                 TO VD-ACCOUNT-NAME
 21974        END-IF
 21975        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21976                                    TO M1
 21977        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21978        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21979           (A2 > M1)
 21980           OR (WS-WORK-FIELD (A2:1) = '*')
 21981           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21982           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21983        END-PERFORM
 21984        IF A2 > M1
 21985           CONTINUE
 21986        ELSE
 21987           MOVE WS-WORK-FIELD (1:A2 - 1)
 21988                                    TO VD-ACCOUNT-NAME
 21989        END-IF
 21990        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21991        MOVE PB-CARRIER          TO VD-CARRIER
 21992        MOVE PB-GROUPING         TO VD-GROUPING
 21993        MOVE PB-STATE            TO VD-STATE
 21994        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21995        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21996        MOVE PB-CERT-NO          TO VD-CERT-NO
 21997        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21998        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21999        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22000        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22001        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22002        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22003        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22004        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22005        MOVE PB-CSR-ID           TO VD-CSR-ID
 22006        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22007        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22008        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22009        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22010        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22011        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22012        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22013        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22014        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22015        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22016        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22017        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22018        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22019     END-IF
 22020     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22021
 22022
 22023* EXEC CICS GETMAIN
 22024*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22025*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22026*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 405
* EL6311.cbl
 22027*       RESP     (WS-RESPONSE)
 22028*    END-EXEC
 22029*    MOVE ',"IL                  $  N#00018555' TO DFHEIV0
 22030     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22032     MOVE X'204E233030303138353535' TO DFHEIV0(25:11)
 22033     CALL 'kxdfhei1' USING DFHEIV0,
 22034           DFHEIV20,
 22035           ERPNDM-RECORD-LENGTH,
 22036           GETMAIN-SPACE
 22037     SET ADDRESS OF PENDING-MAILING-DATA TO
 22038         DFHEIV20
 22039     MOVE EIBRESP  TO WS-RESPONSE
 22040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22041
 22042
 22043* EXEC CICS READ
 22044*       INTO    (PENDING-MAILING-DATA)
 22045*       DATASET (FILE-ID-ERPNDM)
 22046*       RIDFLD  (ERPNDM-KEY)
 22047*       RESP    (WS-RESPONSE)
 22048*    END-EXEC
 22049     MOVE LENGTH OF
 22050      PENDING-MAILING-DATA
 22051       TO DFHEIV11
 22052*    MOVE '&"IL       E          (  N#00018562' TO DFHEIV0
 22053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22055     MOVE X'204E233030303138353632' TO DFHEIV0(25:11)
 22056     CALL 'kxdfhei1' USING DFHEIV0,
 22057           FILE-ID-ERPNDM,
 22058           PENDING-MAILING-DATA,
 22059           DFHEIV11,
 22060           ERPNDM-KEY,
 22061           DFHEIV99,
 22062           DFHEIV99,
 22063           DFHEIV99
 22064     MOVE EIBRESP  TO WS-RESPONSE
 22065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22066
 22067     IF RESP-NORMAL
 22068        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22069        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22070        MOVE PM-CITY              TO VD-INSURED-CITY
 22071        MOVE PM-STATE             TO VD-INSURED-STATE
 22072        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22073     END-IF
 22074
 22075     MOVE 'VAC1'                  TO VD-LETTER-ID
 22076     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22077     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22078     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22079     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22080     MOVE +0                      TO VD-ARCHIVE-NO
 22081     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22082     .
 22083 6200-EXIT.
 22084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 406
* EL6311.cbl
 22085 6210-READ-ERACCT.
 22086     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22087     MOVE LOW-VALUES             TO ERACCT-FILL
 22088
 22089* EXEC CICS READ
 22090*         DATASET   ('ERACCT')
 22091*         INTO      (ACCOUNT-MASTER)
 22092*         RIDFLD    (ERACCT-KEY)
 22093*         GTEQ
 22094*         RESP      (WS-RESPONSE)
 22095*    END-EXEC
 22096     MOVE LENGTH OF
 22097      ACCOUNT-MASTER
 22098       TO DFHEIV11
 22099     MOVE 'ERACCT' TO DFHEIV1
 22100*    MOVE '&"IL       G          (  N#00018590' TO DFHEIV0
 22101     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22103     MOVE X'204E233030303138353930' TO DFHEIV0(25:11)
 22104     CALL 'kxdfhei1' USING DFHEIV0,
 22105           DFHEIV1,
 22106           ACCOUNT-MASTER,
 22107           DFHEIV11,
 22108           ERACCT-KEY,
 22109           DFHEIV99,
 22110           DFHEIV99,
 22111           DFHEIV99
 22112     MOVE EIBRESP  TO WS-RESPONSE
 22113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22114     .
 22115 6210-EXIT.
 22116     EXIT.
 22117
 22118 6220-READ-ERMAIL.
 22119
 22120     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22121     MOVE ' '                    TO WS-ERMAIL-SW
 22122
 22123
 22124* EXEC CICS READ
 22125*       DATASET   (FILE-ID-ERMAIL)
 22126*       SET       (ADDRESS OF MAILING-DATA)
 22127*       RIDFLD    (ERMAIL-KEY)
 22128*       RESP      (WS-RESPONSE)
 22129*    END-EXEC
 22130*    MOVE '&"S        E          (  N#00018606' TO DFHEIV0
 22131     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22133     MOVE X'204E233030303138363036' TO DFHEIV0(25:11)
 22134     CALL 'kxdfhei1' USING DFHEIV0,
 22135           FILE-ID-ERMAIL,
 22136           DFHEIV20,
 22137           DFHEIV99,
 22138           ERMAIL-KEY,
 22139           DFHEIV99,
 22140           DFHEIV99,
 22141           DFHEIV99
 22142     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 407
* EL6311.cbl
 22143         DFHEIV20
 22144     MOVE EIBRESP  TO WS-RESPONSE
 22145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22146
 22147     IF RESP-NORMAL
 22148        SET ERMAIL-FOUND TO TRUE
 22149     END-IF
 22150     .
 22151 6220-EXIT.
 22152     EXIT.
 22153
 22154 6400-CHECK-FOR-RES-REF-CLAIM.
 22155     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22156
 22157     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22158                                    W-CL-COMP-CD.
 22159     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22160                                    W-CL-CERT-NO.
 22161     MOVE SPACES                 TO MSTR-CERT-SFX.
 22162
 22163
 22164* EXEC CICS HANDLE CONDITION
 22165*        NOTFND  (6400-CONTINUE)
 22166*        ENDFILE (6400-CONTINUE)
 22167*    END-EXEC.
 22168*    MOVE '"$I''                  ! S #00018629' TO DFHEIV0
 22169     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22171     MOVE X'5320233030303138363239' TO DFHEIV0(25:11)
 22172     CALL 'kxdfhei1' USING DFHEIV0
 22173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22174
 22175
 22176
 22177* EXEC CICS IGNORE CONDITION
 22178*        DUPKEY
 22179*    END-EXEC.
 22180*    MOVE '"*$                   !   #00018634' TO DFHEIV0
 22181     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22183     MOVE X'2020233030303138363334' TO DFHEIV0(25:11)
 22184     CALL 'kxdfhei1' USING DFHEIV0
 22185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22186
 22187
 22188
 22189* EXEC CICS STARTBR
 22190*        DATASET   (CLMS-ID)
 22191*        RIDFLD    (ELMSTR-KEY)
 22192*        GENERIC   EQUAL
 22193*        KEYLENGTH (ELMSTR-LENGTH)
 22194*    END-EXEC.
 22195     MOVE 0
 22196       TO DFHEIV11
 22197*    MOVE '&,   KG    E          &   #00018638' TO DFHEIV0
 22198     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22199     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22200     MOVE X'2020233030303138363338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 408
* EL6311.cbl
 22201     CALL 'kxdfhei1' USING DFHEIV0,
 22202           CLMS-ID,
 22203           ELMSTR-KEY,
 22204           ELMSTR-LENGTH,
 22205           DFHEIV11,
 22206           DFHEIV99
 22207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22208
 22209
 22210     display 'browse started'
 22211     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22212
 22213 6400-NEXT-CLAIM.
 22214
 22215
 22216* EXEC CICS READNEXT
 22217*        DATASET   (CLMS-ID)
 22218*        RIDFLD    (ELMSTR-KEY)
 22219*        SET       (ADDRESS OF CLAIM-MASTER)
 22220*    END-EXEC.
 22221     MOVE 0
 22222       TO DFHEIV11
 22223*    MOVE '&.S                   )   #00018650' TO DFHEIV0
 22224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22226     MOVE X'2020233030303138363530' TO DFHEIV0(25:11)
 22227     CALL 'kxdfhei1' USING DFHEIV0,
 22228           CLMS-ID,
 22229           DFHEIV20,
 22230           DFHEIV99,
 22231           ELMSTR-KEY,
 22232           DFHEIV99,
 22233           DFHEIV11,
 22234           DFHEIV99,
 22235           DFHEIV99
 22236     SET ADDRESS OF CLAIM-MASTER TO
 22237         DFHEIV20
 22238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22239
 22240
 22241     display 'read claim for ' mstr-cert-no
 22242     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22243        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22244         GO TO 6400-CONTINUE
 22245     END-IF.
 22246
 22247     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22248        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22249        PI-STATE       NOT = CL-CERT-STATE     OR
 22250        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22251        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22252         GO TO 6400-NEXT-CLAIM
 22253     END-IF.
 22254
 22255     display 'found claim ' cl-claim-no
 22256        ' with denial type ' cl-denial-type
 22257     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 22258         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 409
* EL6311.cbl
 22259         GO TO 6400-CONTINUE
 22260     END-IF.
 22261
 22262     GO TO 6400-NEXT-CLAIM.
 22263
 22264 6400-CONTINUE.
 22265
 22266     IF WS-BROWSE-STARTED-SW = 'Y'
 22267
 22268* EXEC CICS ENDBR
 22269*            DATASET   (CLMS-ID)
 22270*        END-EXEC
 22271     MOVE 0
 22272       TO DFHEIV11
 22273*    MOVE '&2                    $   #00018682' TO DFHEIV0
 22274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22276     MOVE X'2020233030303138363832' TO DFHEIV0(25:11)
 22277     CALL 'kxdfhei1' USING DFHEIV0,
 22278           CLMS-ID,
 22279           DFHEIV11,
 22280           DFHEIV99
 22281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22282         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22283     END-IF.
 22284
 22285 6400-EXIT.
 22286     EXIT.
 22287
 22288 7000-DISPLAY-ISSUES.
 22289
 22290     IF PI-DISPLAY-ORIGINAL-BATCH
 22291        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22292        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22293     ELSE
 22294        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22295
 22296     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22297
 22298     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22299     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22300
 22301     MOVE LOW-VALUES                 TO EL631BI.
 22302     MOVE ZEROS                      TO PI-BPMTAMT
 22303                                        PI-BPMTS.
 22304     MOVE SPACE                      TO PI-BMODE
 22305                                        PI-BTYPE (1)
 22306                                        PI-BTYPE (2).
 22307     MOVE EL631B                     TO PI-MAP-NAME.
 22308     MOVE 'Y'                        TO PI-BROWSE-SW.
 22309     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22310                                        PI-HIGH-SEQ-NO.
 22311
 22312     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22313        MOVE AL-SABOF                TO BCHGTA
 22314        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22315        MOVE AL-SANON                TO BCHGA
 22316     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 410
* EL6311.cbl
 22317        MOVE AL-SADOF                TO BCHGTA
 22318                                        BCHGA
 22319        MOVE PB-CHG-COUNT            TO BCHGO.
 22320
 22321     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22322     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22323     MOVE WS-HR-MINS                 TO BMANTATO.
 22324
 22325     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22326        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22327        MOVE SPACE                   TO DC-OPTION-CODE
 22328        PERFORM 9700-DATE-LINK
 22329        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22330        MOVE 'INACTIVE'              TO BMOENDTO
 22331     ELSE
 22332        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22333        MOVE SPACE                   TO DC-OPTION-CODE
 22334        PERFORM 9700-DATE-LINK
 22335        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22336        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22337        MOVE SPACE                   TO DC-OPTION-CODE
 22338        PERFORM 9700-DATE-LINK
 22339        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22340
 22341*    MOVE PB-I-REFERENCE             TO BREFO.
 22342
 22343*    IF PI-COMPANY-ID EQUAL 'HER'
 22344*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22345*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22346*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22347*                MOVE WS-MEMBER-NO-1-8
 22348*                                TO  BMICRNOO.
 22349
 22350*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22351*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22352*            MOVE PB-I-MICROFILM-NO
 22353*                                TO  BMICRNOO.
 22354     IF PB-I-VIN NOT = SPACES
 22355        MOVE PB-I-VIN            TO BVINO
 22356     END-IF
 22357     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22358
 22359
 22360     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22361     MOVE PB-CERT-SFX                TO BSUFIXO.
 22362     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22363     MOVE SPACE                      TO DC-OPTION-CODE.
 22364     PERFORM 9700-DATE-LINK.
 22365     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22366
 22367     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22368     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22369     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22370     MOVE PB-I-INSURED-SEX           TO BSEXO
 22371
 22372     IF PB-I-AGE NOT = ZEROS
 22373         MOVE PB-I-AGE               TO BAGEO.
 22374
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 411
* EL6311.cbl
 22375     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22376                                 TO ELCERT-KEY
 22377     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22378     IF NOT CERT-TRL-REC-NOT-FOUND
 22379         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22380             MOVE 'AGE*'             TO BAGEDEFO
 22381         ELSE
 22382             MOVE 'AGE '             TO BAGEDEFO
 22383         END-IF
 22384     ELSE
 22385         MOVE 'AGE '             TO BAGEDEFO
 22386     END-IF
 22387
 22388     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22389         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22390         MOVE SPACE                  TO DC-OPTION-CODE
 22391         PERFORM 9700-DATE-LINK
 22392         IF NO-CONVERSION-ERROR
 22393            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22394
 22395     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22396         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22397         MOVE SPACE                  TO DC-OPTION-CODE
 22398         PERFORM 9700-DATE-LINK
 22399         IF NO-CONVERSION-ERROR
 22400            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22401
 22402     IF PB-I-EXTENTION-DAYS NUMERIC
 22403        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22404           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22405        ELSE
 22406           IF PB-I-TERM-IN-DAYS NUMERIC
 22407              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22408                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22409
 22410     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22411        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22412
 22413     MOVE PB-FORCE-CODE              TO BFORCEO.
 22414     MOVE PB-I-TERM-TYPE             TO BMODEO
 22415                                        PI-BMODE.
 22416
 22417     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22418        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22419
 22420     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22421         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22422                                        PI-BPMTS.
 22423
 22424     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22425         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22426           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22427                                        PI-BPMTAMT.
 22428
 22429     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22430     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22431     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22432     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 412
* EL6311.cbl
 22433     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22434     MOVE PB-I-SIG-SW                TO BSIGO.
 22435     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22436     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22437     MOVE PB-RECORD-BILL             TO BBILCDO.
 22438     MOVE PB-FORCE-CODE              TO BFORCEO.
 22439
 22440     IF (PB-I-LIVES NUMERIC)
 22441        AND (PB-I-LIVES > ZEROS)
 22442        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22443        IF (RESP-NORMAL)
 22444           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22445           CONTINUE
 22446        ELSE
 22447           MOVE PB-I-LIVES       TO BLIVESO
 22448        END-IF
 22449     END-IF
 22450
 22451     IF PB-I-NUM-BILLED NUMERIC AND
 22452        PB-I-NUM-BILLED GREATER THAN ZEROS
 22453        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22454*    ELSE
 22455*       MOVE ZEROS                   TO BBILLEDO.
 22456
 22457     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22458
 22459     IF PB-I-LOAN-APR NOT = +99.9999
 22460        MOVE PB-I-LOAN-APR           TO BAPRO.
 22461
 22462     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22463        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22464
 22465     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22466        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22467           MOVE AL-SANOF                TO BORIGHDA
 22468           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22469           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22470
 22471     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22472
 22473     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22474        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22475
 22476     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22477        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22478                                        PI-BTYPE (1).
 22479
 22480     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22481        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22482
 22483     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22484        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22485
 22486     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22487        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22488
 22489     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22490        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 413
* EL6311.cbl
 22491
 22492     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22493        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22494
 22495     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22496         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22497         MOVE SPACE                  TO DC-OPTION-CODE
 22498         PERFORM 9700-DATE-LINK
 22499         IF NO-CONVERSION-ERROR
 22500            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22501
 22502     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22503        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22504        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22505        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22506        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22507                 GIVING BDIFFO (1)
 22508     ELSE
 22509        MOVE SPACES                  TO BBEN-CD     (1)
 22510                                        BBEN-ABBR   (1).
 22511
 22512     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22513        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22514        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22515                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22516
 22517     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22518       IF PB-RECORD-ON-HOLD
 22519          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22520
 22521     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22522       IF PB-RECORD-RETURNED
 22523          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22524
 22525     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22526        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22527             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22528
 22529     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22530
 22531     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22532        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22533
 22534     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22535        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22536                                        PI-BTYPE (2).
 22537
 22538     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22539        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22540
 22541     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22542        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22543
 22544     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22545        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22546
 22547     IF PB-I-TOT-FEES NOT NUMERIC
 22548        MOVE ZEROS               TO PB-I-TOT-FEES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 414
* EL6311.cbl
 22549     END-IF
 22550     IF PB-I-TOT-FEES > ZEROS
 22551        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22552
 22553     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22554         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22555         MOVE SPACE                  TO DC-OPTION-CODE
 22556         PERFORM 9700-DATE-LINK
 22557         IF NO-CONVERSION-ERROR
 22558            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22559
 22560     IF PB-I-TOT-FEES > ZEROS
 22561        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22562        SUBTRACT PB-I-TOT-FEES FROM
 22563                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22564
 22565     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22566        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22567        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22568        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22569        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22570                 GIVING BDIFFO (2)
 22571     ELSE
 22572        MOVE SPACES                  TO BBEN-CD     (2)
 22573                                        BBEN-ABBR   (2).
 22574
 22575     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22576       IF PB-RECORD-ON-HOLD
 22577          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22578
 22579     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22580       IF PB-RECORD-RETURNED
 22581          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22582
 22583     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22584        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22585             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22586
 22587     MOVE PB-CSR-ID                  TO BCSRO.
 22588
 22589     IF PI-COMPANY-ID  =  'DMD'
 22590        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22591            NEXT SENTENCE
 22592        ELSE
 22593            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22594               MOVE 'NEW CERT'       TO BNCERTLI
 22595               MOVE EC-NEW-CERT      TO BNCERTO.
 22596
 22597     IF PI-COMPANY-ID  =  'DMD'
 22598        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22599            NEXT SENTENCE
 22600        ELSE
 22601           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22602               MOVE 'NEW STATE'      TO BNSTATLI
 22603               MOVE EC-NEW-STATE     TO BNSTATO.
 22604
 22605 7000-CONTINUE.
 22606     MOVE 'C'                        TO BMAINTI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 415
* EL6311.cbl
 22607     MOVE AL-UANON                   TO BMAINTA.
 22608
 22609     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22610        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22611
 22612     IF ARCHIVE-LETTER-RELEASED
 22613        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 22614     END-IF
 22615     IF PI-6315-FINALIZED = 'Y'   AND
 22616        PB-UNFORCED-ERRORS
 22617          MOVE -1                TO BFORCEL
 22618          MOVE  1                TO SET-CURSOR-SW
 22619     END-IF
 22620
 22621     IF NO-CURSOR-SET
 22622        MOVE -1                      TO BMAINTL.
 22623
 22624     GO TO 8100-SEND-INITIAL-MAP.
 22625
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 416
* EL6311.cbl
 22627
 22628 7050-UPDATE-PENDING.
 22629
 22630* EXEC CICS READ
 22631*        DATASET (FILE-ID-ERPNDB)
 22632*        INTO    (PENDING-BUSINESS)
 22633*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 22634*        UPDATE
 22635*    END-EXEC.
 22636     MOVE LENGTH OF
 22637      PENDING-BUSINESS
 22638       TO DFHEIV11
 22639*    MOVE '&"IL       EU         (   #00019032' TO DFHEIV0
 22640     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22642     MOVE X'2020233030303139303332' TO DFHEIV0(25:11)
 22643     CALL 'kxdfhei1' USING DFHEIV0,
 22644           FILE-ID-ERPNDB,
 22645           PENDING-BUSINESS,
 22646           DFHEIV11,
 22647           PI-PREV-CONTROL-PRIMARY,
 22648           DFHEIV99,
 22649           DFHEIV99,
 22650           DFHEIV99
 22651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22652
 22653
 22654     MOVE 'C' TO PB-I-LETTER-REQD
 22655     MOVE PB-I-LETTER-REQD       TO LETRREQO
 22656     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 22657     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 22658     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 22659     MOVE '5'                    TO DC-OPTION-CODE.
 22660     PERFORM 9700-DATE-LINK
 22661     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 22662
 22663
 22664* EXEC CICS REWRITE
 22665*        DATASET (FILE-ID-ERPNDB)
 22666*        FROM    (PENDING-BUSINESS)
 22667*    END-EXEC.
 22668     MOVE LENGTH OF
 22669      PENDING-BUSINESS
 22670       TO DFHEIV11
 22671*    MOVE '&& L                  %   #00019048' TO DFHEIV0
 22672     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22673     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22674     MOVE X'2020233030303139303438' TO DFHEIV0(25:11)
 22675     CALL 'kxdfhei1' USING DFHEIV0,
 22676           FILE-ID-ERPNDB,
 22677           PENDING-BUSINESS,
 22678           DFHEIV11,
 22679           DFHEIV99
 22680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22681
 22682
 22683 7050-EXIT.
 22684      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 417
* EL6311.cbl
 22685
 22686******************************************************************
 22687*                                                                *
 22688*             D I S P L A Y   C A N C E L S                      *
 22689*                                                                *
 22690******************************************************************
 22691
 22692 7100-DISPLAY-CANCELS.
 22693     IF PI-DISPLAY-ORIGINAL-BATCH
 22694        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22695        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22696     ELSE
 22697        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22698
 22699     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22700
 22701     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22702     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22703
 22704     MOVE LOW-VALUES                 TO EL631CI.
 22705     MOVE EL631C                     TO PI-MAP-NAME.
 22706     MOVE 'Y'                        TO PI-BROWSE-SW.
 22707     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22708                                        PI-HIGH-SEQ-NO.
 22709
 22710     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22711        MOVE AL-SABOF                TO CCHGTA
 22712        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22713        MOVE AL-SANON                TO CCHGA
 22714      ELSE
 22715        MOVE AL-SADOF                TO CCHGTA
 22716                                        CCHGA
 22717        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22718
 22719*    MOVE PB-C-REFERENCE             TO CREFO.
 22720
 22721*    IF PB-C-MICROFILM-NO IS NUMERIC
 22722*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22723*          MOVE PB-C-MICROFILM-NO
 22724*                                TO CMICRNOO
 22725*          MOVE AL-UNNON         TO CMICRNOA
 22726*       END-IF
 22727*    END-IF
 22728     IF PB-C-INT-ON-REFS NUMERIC
 22729        IF PB-C-INT-ON-REFS NOT = ZEROS
 22730           MOVE PB-C-INT-ON-REFS
 22731                                 TO CNHINTO
 22732           MOVE AL-SANOF         TO CNHINTA
 22733        END-IF
 22734     END-IF
 22735     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22736     MOVE PB-CERT-SFX                TO CSUFIXO.
 22737     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22738     MOVE SPACE                      TO DC-OPTION-CODE.
 22739     PERFORM 9700-DATE-LINK.
 22740     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22741
 22742     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 418
* EL6311.cbl
 22743        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22744        MOVE SPACE                   TO DC-OPTION-CODE
 22745        PERFORM 9700-DATE-LINK
 22746        IF NO-CONVERSION-ERROR
 22747           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22748
 22749     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22750        NEXT SENTENCE
 22751     ELSE
 22752        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22753
 22754     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22755        NEXT SENTENCE
 22756     ELSE
 22757        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22758
 22759     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22760        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22761        MOVE SPACE                   TO DC-OPTION-CODE
 22762        PERFORM 9700-DATE-LINK
 22763        IF NO-CONVERSION-ERROR
 22764           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22765
 22766     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22767         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22768
 22769     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22770         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22771
 22772     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22773        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22774        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22775                 GIVING CDRFND1O.
 22776
 22777     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22778        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22779        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22780                 GIVING CDRFND2O.
 22781
 22782     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22783       IF PB-RECORD-ON-HOLD
 22784          MOVE 'ON HOLD'             TO CBILIT1O.
 22785
 22786     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22787       IF PB-RECORD-RETURNED
 22788          MOVE 'RETURNED'            TO CBILIT1O.
 22789
 22790     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22791        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22792             MOVE 'OVERRIDE'         TO CBILIT1O.
 22793
 22794     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22795       IF PB-RECORD-ON-HOLD
 22796          MOVE 'ON HOLD'             TO CBILIT2O.
 22797
 22798     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22799       IF PB-RECORD-RETURNED
 22800          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 419
* EL6311.cbl
 22801
 22802     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22803        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22804             MOVE 'OVERRIDE'         TO CBILIT2O.
 22805
 22806     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22807     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22808     MOVE PB-FORCE-CODE              TO CFORCEO.
 22809     MOVE PB-RECORD-BILL             TO CBILCDO.
 22810     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22811     MOVE SPACES                     TO CINITSO.
 22812     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22813         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22814     ELSE
 22815         MOVE PB-CI-INITIALS         TO CINITSO
 22816     END-IF.
 22817
 22818     IF PB-CI-CANCEL-FEE NUMERIC
 22819        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22820        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22821     ELSE
 22822        MOVE ZEROES                  TO W-CANCEL-FEE.
 22823
 22824     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22825
 22826     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22827        ADD PB-CI-LF-PREMIUM-AMT
 22828             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22829
 22830     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22831        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22832
 22833     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22834     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22835     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22836     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22837
 22838     IF PB-C-LIVES NUMERIC
 22839        MOVE PB-C-LIVES              TO CLIVESO.
 22840
 22841     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22842        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22843
 22844     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22845        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22846        MOVE SPACE                   TO DC-OPTION-CODE
 22847        PERFORM 9700-DATE-LINK
 22848        IF NO-CONVERSION-ERROR
 22849           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22850
 22851     IF  PB-C-REFUND-CREATED
 22852         MOVE 'YES'                  TO CRFNDSWO
 22853     ELSE
 22854         IF PB-C-REFUND-REQUESTED
 22855            MOVE 'REQ'               TO CRFNDSWO
 22856         ELSE
 22857            MOVE 'NO'                TO CRFNDSWO.
 22858
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 420
* EL6311.cbl
 22859     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22860     MOVE SPACE                      TO DC-OPTION-CODE.
 22861     PERFORM 9700-DATE-LINK.
 22862     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22863     MOVE PB-INPUT-BY                TO CENTBYO.
 22864
 22865     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22866        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22867        MOVE SPACE                   TO DC-OPTION-CODE
 22868        PERFORM 9700-DATE-LINK
 22869        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22870        MOVE 'INACTIVE'              TO CMOENDTO
 22871     ELSE
 22872        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22873        MOVE SPACE                   TO DC-OPTION-CODE
 22874        PERFORM 9700-DATE-LINK
 22875        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22876        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22877        MOVE SPACE                   TO DC-OPTION-CODE
 22878        PERFORM 9700-DATE-LINK
 22879        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22880
 22881     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22882
 22883     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22884     MOVE WS-HR-MINS                 TO CMANTATO.
 22885
 22886     EVALUATE PB-LF-REFUND-TYPE
 22887        WHEN '1'
 22888           MOVE 'RULE78'            TO CLFREFNO
 22889        WHEN '2'
 22890           MOVE 'PRORAT'            TO CLFREFNO
 22891        WHEN '3'
 22892           MOVE 'CALIF'             TO CLFREFNO
 22893        WHEN '4'
 22894           MOVE 'IRREG'             TO CLFREFNO
 22895        WHEN '5'
 22896           MOVE 'NETPAY'            TO CLFREFNO
 22897        WHEN '6'
 22898           MOVE 'ATCP'              TO CLFREFNO
 22899        WHEN '7'
 22900           MOVE 'UTAH'              TO CLFREFNO
 22901        WHEN '8'
 22902           MOVE 'MEAN'              TO CLFREFNO
 22903        WHEN '9'
 22904           MOVE 'SUM '              TO CLFREFNO
 22905        WHEN 'B'
 22906           MOVE 'BALN'              TO CLFREFNO
 22907     END-EVALUATE.
 22908
 22909     EVALUATE TRUE
 22910        WHEN PB-AH-REFUND-TYPE =  '1'
 22911           MOVE 'RULE78'            TO CAHREFNO
 22912        WHEN PB-AH-REFUND-TYPE =  '2'
 22913           MOVE 'PRORAT'            TO CAHREFNO
 22914        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22915           MOVE 'CALIF'             TO CAHREFNO
 22916        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 421
* EL6311.cbl
 22917           MOVE 'IRREG'             TO CAHREFNO
 22918        WHEN PB-AH-REFUND-TYPE =  '5'
 22919           MOVE 'NETPAY'            TO CAHREFNO
 22920        WHEN PB-AH-REFUND-TYPE =  '6'
 22921           MOVE 'ATCP'              TO CAHREFNO
 22922        WHEN PB-AH-REFUND-TYPE =  '7'
 22923           MOVE 'UTAH'              TO CAHREFNO
 22924        WHEN PB-AH-REFUND-TYPE =  '8'
 22925           MOVE 'MEAN'              TO CAHREFNO
 22926        WHEN PB-AH-REFUND-TYPE =  '9'
 22927           MOVE 'SUM '              TO CAHREFNO
 22928        WHEN PB-AH-REFUND-TYPE =  'B'
 22929           MOVE 'BALN'              TO CAHREFNO
 22930     END-EVALUATE.
 22931
 22932     MOVE PB-REIN-CD                 TO CREINCDO.
 22933
 22934     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22935        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22936        MOVE SPACE                   TO DC-OPTION-CODE
 22937        PERFORM 9700-DATE-LINK
 22938        IF NO-CONVERSION-ERROR
 22939           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22940
 22941     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22942        MOVE 999999                  TO WS-EXP-DT-EDIT
 22943        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22944        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22945     ELSE
 22946        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22947           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22948           MOVE SPACE                   TO DC-OPTION-CODE
 22949           PERFORM 9700-DATE-LINK
 22950           IF NO-CONVERSION-ERROR
 22951              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22952
 22953     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22954        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22955           MOVE AL-SANOF                TO CORIGHDA
 22956           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22957           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22958
 22959     MOVE PB-CSR-ID              TO CCSRO.
 22960
 22961     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22962     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22963     MOVE 'N'                    TO ACTSPCO
 22964     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 22965     MOVE '2'                    TO ERACNT-REC-TYPE
 22966     MOVE +3                     TO ERACNT-SEQ-NO
 22967
 22968
 22969* EXEC CICS READ
 22970*         DATASET   ('ERACNT')
 22971*         INTO      (NOTE-FILE)
 22972*         RIDFLD    (ERACNT-KEY)
 22973*         RESP      (WS-RESPONSE)
 22974*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 422
* EL6311.cbl
 22975     MOVE LENGTH OF
 22976      NOTE-FILE
 22977       TO DFHEIV11
 22978     MOVE 'ERACNT' TO DFHEIV1
 22979*    MOVE '&"IL       E          (  N#00019338' TO DFHEIV0
 22980     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22982     MOVE X'204E233030303139333338' TO DFHEIV0(25:11)
 22983     CALL 'kxdfhei1' USING DFHEIV0,
 22984           DFHEIV1,
 22985           NOTE-FILE,
 22986           DFHEIV11,
 22987           ERACNT-KEY,
 22988           DFHEIV99,
 22989           DFHEIV99,
 22990           DFHEIV99
 22991     MOVE EIBRESP  TO WS-RESPONSE
 22992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22993
 22994     IF RESP-NORMAL
 22995        IF NT-account-special = 'Y'
 22996           MOVE 'Y'              TO actspcO
 22997           MOVE ER-1762          TO EMI-ERROR
 22998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22999        END-IF
 23000     END-IF
 23001     MOVE 'C'                    TO CMAINTI.
 23002     MOVE AL-UANON               TO CMAINTA.
 23003
 23004     IF PI-6316-FINALIZED = 'Y'  AND
 23005        PB-UNFORCED-ERRORS
 23006          MOVE -1                TO CFORCEL
 23007          MOVE  1                TO SET-CURSOR-SW
 23008     END-IF
 23009
 23010     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23011        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23012
 23013     IF NO-CURSOR-SET
 23014        MOVE -1                  TO CMAINTL.
 23015
 23016     GO TO 8100-SEND-INITIAL-MAP.
 23017
 23018
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 423
* EL6311.cbl
 23020***************************************************************
 23021*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23022*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23023***************************************************************
 23024
 23025 7200-DISPLAY-BATCHES.
 23026     MOVE EL631D                 TO PI-MAP-NAME.
 23027     MOVE LOW-VALUES             TO EL631DI.
 23028
 23029     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23030
 23031
 23032* EXEC CICS HANDLE CONDITION
 23033*         NOTFND   (3690-NOT-FOUND)
 23034*    END-EXEC.
 23035*    MOVE '"$I                   ! T #00019382' TO DFHEIV0
 23036     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23038     MOVE X'5420233030303139333832' TO DFHEIV0(25:11)
 23039     CALL 'kxdfhei1' USING DFHEIV0
 23040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23041
 23042
 23043     IF PI-DISPLAY-SCREEN
 23044        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23045     ELSE
 23046        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23047
 23048     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23049     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23050
 23051
 23052* EXEC CICS READ
 23053*         DATASET   (FILE-ID-ERPNDB)
 23054*         RIDFLD    (ERPNDB-KEY)
 23055*         SET       (ADDRESS OF PENDING-BUSINESS)
 23056*    END-EXEC.
 23057*    MOVE '&"S        E          (   #00019394' TO DFHEIV0
 23058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23060     MOVE X'2020233030303139333934' TO DFHEIV0(25:11)
 23061     CALL 'kxdfhei1' USING DFHEIV0,
 23062           FILE-ID-ERPNDB,
 23063           DFHEIV20,
 23064           DFHEIV99,
 23065           ERPNDB-KEY,
 23066           DFHEIV99,
 23067           DFHEIV99,
 23068           DFHEIV99
 23069     SET ADDRESS OF PENDING-BUSINESS TO
 23070         DFHEIV20
 23071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23072
 23073
 23074     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23075     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23076     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23077     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 424
* EL6311.cbl
 23078     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23079
 23080     MOVE EL631D                 TO PI-MAP-NAME.
 23081     MOVE LOW-VALUES             TO EL631DI.
 23082     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23083
 23084*    IF PI-AR-PROCESSING
 23085*       MOVE PB-REFERENCE        TO DREFO.
 23086
 23087     MOVE PB-CSR-ID              TO DCSRO.
 23088
 23089     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23090        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23091        MOVE SPACE               TO DC-OPTION-CODE
 23092        PERFORM 9700-DATE-LINK
 23093        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23094        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23095        MOVE 'INACTIVE'          TO DLDATEO
 23096     ELSE
 23097        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23098        MOVE SPACE               TO DC-OPTION-CODE
 23099        PERFORM 9700-DATE-LINK
 23100        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23101
 23102     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23103     MOVE SPACE                  TO DC-OPTION-CODE.
 23104     PERFORM 9700-DATE-LINK.
 23105     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23106
 23107     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23108        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23109     ELSE
 23110        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23111        MOVE SPACE               TO DC-OPTION-CODE
 23112        PERFORM 9700-DATE-LINK
 23113        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23114
 23115     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23116     MOVE SPACE                  TO DC-OPTION-CODE.
 23117     PERFORM 9700-DATE-LINK.
 23118     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23119
 23120     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23121     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23122
 23123     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23124        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23125                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23126
 23127     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23128     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23129     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23130
 23131     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23132        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23133                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23134
 23135     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 425
* EL6311.cbl
 23136     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23137     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23138
 23139     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23140        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23141                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23142
 23143     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23144     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23145
 23146     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23147        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23148                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23149
 23150     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23151     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23152     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23153
 23154     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23155        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23156                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23157
 23158     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23159     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23160     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23161
 23162     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23163        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23164                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23165
 23166     MOVE -1                     TO DPFENTRL.
 23167     GO TO 8100-SEND-INITIAL-MAP.
 23168
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 426
* EL6311.cbl
 23170
 23171***************************************************************
 23172*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23173*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23174*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23175*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23176*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23177*     ARE THEN SET ACCORDINGLY.                               *
 23178*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23179*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23180*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23181***************************************************************
 23182
 23183******************************************************************
 23184*                                                                *
 23185*            E R R O R   A N A L Y S I S                         *
 23186*                                                                *
 23187******************************************************************
 23188
 23189******************************************************************
 23190*                                                                *
 23191*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23192*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23193*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23194*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23195*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23196*                                                                *
 23197*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23198*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23199*                                                                *
 23200******************************************************************
 23201
 23202 7300-FORMAT-ERRORS.
 23203     MOVE ' '                    TO PI-ERRORS-SW
 23204     IF PB-COMMON-ERRORS = LOW-VALUES
 23205        IF PB-FATAL-ERRORS
 23206           MOVE ER-2695          TO EMI-ERROR
 23207           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23208           GO TO 7399-EXIT.
 23209
 23210     MOVE +0                     TO WS-SUB4
 23211     move +0                     to pi-6311-fatal-ctr
 23212     .
 23213 7310-ERROR-LOOP.
 23214
 23215     ADD +1                      TO WS-SUB4.
 23216
 23217     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23218        GO TO 7350-SET-ERROR-FLAGS.
 23219
 23220     IF PI-COMPANY-ID = 'UCL'
 23221         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23222             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23223             MOVE ' '                   TO DC-OPTION-CODE
 23224             PERFORM 9700-DATE-LINK
 23225             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23226
 23227     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 427
* EL6311.cbl
 23228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23229     if (emi-fatal)
 23230        and (emi-error not = 1753 and 1754 and 1757 and
 23231                             1758 and 1759 and 1760)
 23232        add +1                   to pi-6311-fatal-ctr
 23233     end-if
 23234     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23235
 23236     GO TO 7310-ERROR-LOOP.
 23237
 23238
 23239 7350-SET-ERROR-FLAGS.
 23240
 23241     IF EMI-FATAL-CTR NOT = ZEROS
 23242        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23243        MOVE 'X'                 TO PB-FATAL-FLAG
 23244                                    PI-ERRORS-SW
 23245        GO TO 7355-SET-ERROR-FLAGS.
 23246
 23247     move ' ' to pi-unforced-sw
 23248     IF EMI-FORCABLE-CTR NOT = ZEROS
 23249        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23250        IF PB-ISSUE
 23251           IF PB-ISSUE-FORCE
 23252              MOVE 'F'           TO PB-FORCE-ER-CD
 23253              MOVE ER-2600       TO EMI-ERROR
 23254              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23255             ELSE
 23256              MOVE 'X'           TO PB-FORCE-ER-CD
 23257*                                   PI-ERRORS-SW
 23258          ELSE
 23259           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23260              MOVE 'F'           TO PB-FORCE-ER-CD
 23261                                    pi-unforced-sw
 23262              MOVE ER-2600       TO EMI-ERROR
 23263              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23264             ELSE
 23265              MOVE 'X'           TO PB-FORCE-ER-CD
 23266                                    pi-unforced-sw.
 23267*                                   PI-ERRORS-SW.
 23268
 23269     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23270     IF PB-ISSUE
 23271         MOVE 'I'                TO ENDT-RECORD-TYPE
 23272     ELSE
 23273         MOVE 'C'                TO ENDT-RECORD-TYPE
 23274     END-IF
 23275     MOVE +0                     TO ENDT-SEQ-NO
 23276
 23277
 23278* EXEC CICS READ
 23279*        DATASET   (FILE-ID-ERENDT)
 23280*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23281*        RIDFLD    (ERENDT-KEY)
 23282*        RESP      (WS-RESPONSE)
 23283*        GTEQ
 23284*    END-EXEC
 23285*    MOVE '&"S        G          (  N#00019603' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 428
* EL6311.cbl
 23286     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23288     MOVE X'204E233030303139363033' TO DFHEIV0(25:11)
 23289     CALL 'kxdfhei1' USING DFHEIV0,
 23290           FILE-ID-ERENDT,
 23291           DFHEIV20,
 23292           DFHEIV99,
 23293           ERENDT-KEY,
 23294           DFHEIV99,
 23295           DFHEIV99,
 23296           DFHEIV99
 23297     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23298         DFHEIV20
 23299     MOVE EIBRESP  TO WS-RESPONSE
 23300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23301
 23302     IF RESP-NORMAL
 23303        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23304        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23305            MOVE ER-0280          TO EMI-ERROR
 23306            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23307            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23308            IF CALLED-FROM-6315
 23309               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23310            END-IF
 23311            EVALUATE TRUE
 23312              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23313                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23314              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23315                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23316              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23317                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23318            END-EVALUATE
 23319        END-IF
 23320     END-IF
 23321
 23322
 23323
 23324     IF FIRST-ENTRY OR
 23325        EIBAID = DFHPF1 OR DFHPF2
 23326        MOVE '0'                TO PI-EDIT-SW
 23327        GO TO 7399-EXIT.
 23328
 23329 7355-SET-ERROR-FLAGS.
 23330
 23331     IF EMI-WARNING-CTR NOT = ZEROS
 23332        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23333        MOVE 'W'                 TO PB-WARN-ER-CD.
 23334
 23335     IF PB-UNFORCED-ERRORS OR
 23336        PB-FATAL-ERRORS    OR
 23337        PB-RECORD-ON-HOLD  OR
 23338        PB-RECORD-RETURNED OR
 23339        PB-CANCELLATION
 23340          NEXT SENTENCE
 23341        ELSE
 23342          GO TO 7399-EXIT.
 23343
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 429
* EL6311.cbl
 23344
 23345* EXEC CICS  HANDLE CONDITION
 23346*           NOTFND   (7399-EXIT)
 23347*    END-EXEC.
 23348*    MOVE '"$I                   ! U #00019653' TO DFHEIV0
 23349     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23351     MOVE X'5520233030303139363533' TO DFHEIV0(25:11)
 23352     CALL 'kxdfhei1' USING DFHEIV0
 23353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23354
 23355
 23356     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23357     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23358     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23359     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23360
 23361
 23362* EXEC CICS READ
 23363*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23364*        DATASET (FILE-ID-ELCERT)
 23365*        RIDFLD  (ELCERT-KEY)
 23366*        UPDATE
 23367*    END-EXEC.
 23368*    MOVE '&"S        EU         (   #00019662' TO DFHEIV0
 23369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23370     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23371     MOVE X'2020233030303139363632' TO DFHEIV0(25:11)
 23372     CALL 'kxdfhei1' USING DFHEIV0,
 23373           FILE-ID-ELCERT,
 23374           DFHEIV20,
 23375           DFHEIV99,
 23376           ELCERT-KEY,
 23377           DFHEIV99,
 23378           DFHEIV99,
 23379           DFHEIV99
 23380     SET ADDRESS OF CERTIFICATE-MASTER TO
 23381         DFHEIV20
 23382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23383
 23384
 23385
 23386     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23387     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23388
 23389     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23390        GO TO 7360-REWRITE-CERT-MASTER.
 23391
 23392     IF PB-ISSUE
 23393        IF PB-RECORD-RETURNED
 23394            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23395            GO TO 7360-REWRITE-CERT-MASTER
 23396        ELSE
 23397            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23398            GO TO 7360-REWRITE-CERT-MASTER.
 23399
 23400     IF PB-RECORD-RETURNED
 23401         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 430
* EL6311.cbl
 23402         GO TO 7360-REWRITE-CERT-MASTER.
 23403
 23404     IF (PB-C-LF-CANCEL-VOIDED)
 23405        or (pb-c-ah-cancel-voided)
 23406        IF (PB-UNFORCED-ERRORS OR
 23407            PB-FATAL-ERRORS    OR
 23408            PB-RECORD-ON-HOLD)
 23409            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23410            GO TO 7360-REWRITE-CERT-MASTER
 23411        ELSE
 23412            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23413            GO TO 7360-REWRITE-CERT-MASTER.
 23414
 23415     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23416                            OR PB-RECORD-ON-HOLD)
 23417        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23418     ELSE
 23419        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23420
 23421 7360-REWRITE-CERT-MASTER.
 23422
 23423     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23424        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23425
 23426* EXEC CICS UNLOCK
 23427*            DATASET    (FILE-ID-ELCERT)
 23428*       END-EXEC
 23429*    MOVE '&*                    #   #00019709' TO DFHEIV0
 23430     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23432     MOVE X'2020233030303139373039' TO DFHEIV0(25:11)
 23433     CALL 'kxdfhei1' USING DFHEIV0,
 23434           FILE-ID-ELCERT,
 23435           DFHEIV99
 23436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23437        GO TO 7399-EXIT.
 23438
 23439
 23440* EXEC CICS REWRITE
 23441*         DATASET    (FILE-ID-ELCERT)
 23442*         FROM       (CERTIFICATE-MASTER)
 23443*    END-EXEC.
 23444     MOVE LENGTH OF
 23445      CERTIFICATE-MASTER
 23446       TO DFHEIV11
 23447*    MOVE '&& L                  %   #00019714' TO DFHEIV0
 23448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23450     MOVE X'2020233030303139373134' TO DFHEIV0(25:11)
 23451     CALL 'kxdfhei1' USING DFHEIV0,
 23452           FILE-ID-ELCERT,
 23453           CERTIFICATE-MASTER,
 23454           DFHEIV11,
 23455           DFHEIV99
 23456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23457
 23458
 23459 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 431
* EL6311.cbl
 23460      EXIT.
 23461
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 432
* EL6311.cbl
 23463
 23464*************************************************************
 23465*                                                           *
 23466*              S E T   A T T R I B U T E S                  *
 23467*                                                           *
 23468*************************************************************
 23469
 23470 7400-SET-ATTRIBUTES.
 23471
 23472     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23473        GO TO 7499-EXIT.
 23474
 23475**2601**
 23476
 23477     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23478        IF PB-ISSUE
 23479           MOVE AL-UABON         TO BEFFDTA
 23480           GO TO 7499-EXIT
 23481         ELSE
 23482           MOVE AL-UABON         TO CEFFDTA
 23483           GO TO 7499-EXIT.
 23484
 23485**2604**
 23486
 23487     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23488        IF PB-ISSUE
 23489           MOVE AL-UABON         TO BTYPE1A
 23490           MOVE -1               TO BTYPE1L
 23491           MOVE  1               TO SET-CURSOR-SW
 23492           GO TO 7499-EXIT.
 23493
 23494**2605**
 23495
 23496     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23497        IF PB-ISSUE
 23498           MOVE AL-UABON         TO BTYPE2A
 23499           MOVE -1               TO BTYPE2L
 23500           MOVE  1               TO SET-CURSOR-SW
 23501           GO TO 7499-EXIT.
 23502
 23503**2606**
 23504
 23505     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23506        IF PB-ISSUE
 23507           MOVE AL-UABON         TO BSIGA
 23508           MOVE -1               TO BSIGL
 23509           MOVE  1               TO SET-CURSOR-SW
 23510           GO TO 7499-EXIT.
 23511
 23512**2607**
 23513
 23514     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23515        IF PB-ISSUE
 23516           MOVE AL-UABON         TO BSIGA
 23517           MOVE -1               TO BSIGL
 23518           MOVE  1               TO SET-CURSOR-SW
 23519           GO TO 7499-EXIT.
 23520
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 433
* EL6311.cbl
 23521**2615**
 23522
 23523     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23524        IF PB-ISSUE
 23525           MOVE AL-UABOF         TO BREINA
 23526           MOVE -1               TO BREINL
 23527           GO TO 7499-EXIT.
 23528
 23529**2622**
 23530
 23531     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23532        IF PB-ISSUE
 23533           MOVE AL-UABON         TO BEFFDTA
 23534           GO TO 7499-EXIT
 23535        ELSE
 23536           MOVE AL-UABON         TO CEFFDTA
 23537           GO TO 7499-EXIT.
 23538
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 434
* EL6311.cbl
 23540
 23541*************************************************************
 23542*                                                           *
 23543*              I S S U E   E R R O R S                      *
 23544*                                                           *
 23545*************************************************************
 23546
 23547 7420-ISSUE-ERRORS.
 23548
 23549     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23550        MOVE -1                  TO LETRREQL
 23551        MOVE AL-UABOF            TO LETRREQA
 23552        MOVE  1                  TO SET-CURSOR-SW
 23553        GO TO 7499-EXIT.
 23554
 23555     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23556        MOVE AL-UABOF            TO LETRREQA
 23557        GO TO 7499-EXIT.
 23558
 23559**2626**
 23560
 23561     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23562        MOVE AL-UABON            TO BCERTNOA
 23563        GO TO 7499-EXIT.
 23564
 23565**2627**
 23566
 23567     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23568        MOVE AL-UNBON            TO BAGEA
 23569        MOVE -1                  TO BAGEL
 23570        MOVE  1                  TO SET-CURSOR-SW
 23571        GO TO 7499-EXIT.
 23572
 23573**2628**
 23574
 23575     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23576        MOVE AL-UNBON            TO BAGEA
 23577        MOVE -1                  TO BAGEL
 23578        MOVE  1                  TO SET-CURSOR-SW
 23579        GO TO 7499-EXIT.
 23580
 23581**2629**
 23582
 23583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23584        MOVE AL-UABON            TO BSEXA
 23585        MOVE -1                  TO BSEXL
 23586        MOVE  1                  TO SET-CURSOR-SW
 23587        GO TO 7499-EXIT.
 23588
 23589**2630**
 23590
 23591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23592        MOVE -1                  TO BTYPE1L
 23593        MOVE  1                  TO SET-CURSOR-SW
 23594        GO TO 7499-EXIT.
 23595
 23596**2631**
 23597
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 435
* EL6311.cbl
 23598     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23599        MOVE -1                  TO BTYPE1L
 23600        MOVE  1                  TO SET-CURSOR-SW
 23601        GO TO 7499-EXIT.
 23602
 23603**2632**
 23604
 23605     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23606        MOVE AL-UNBON            TO BBEN1A
 23607        MOVE -1                  TO BBEN1L
 23608        MOVE  1                  TO SET-CURSOR-SW
 23609        GO TO 7499-EXIT.
 23610
 23611**2633**
 23612
 23613     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23614        MOVE AL-UNBON            TO BPREM1A
 23615        MOVE -1                  TO BPREM1L
 23616        MOVE  1                  TO SET-CURSOR-SW
 23617        GO TO 7499-EXIT.
 23618
 23619**2634**
 23620
 23621     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23622        MOVE -1                  TO BTYPE2L
 23623        MOVE  1                  TO SET-CURSOR-SW
 23624        GO TO 7499-EXIT.
 23625
 23626**2635**
 23627
 23628     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23629        MOVE AL-UNBON            TO BBEN2A
 23630        MOVE -1                  TO BBEN2L
 23631        MOVE  1                  TO SET-CURSOR-SW
 23632        GO TO 7499-EXIT.
 23633
 23634**2636**
 23635
 23636     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23637        MOVE AL-UNBON            TO BPREM2A
 23638        MOVE -1                  TO BPREM2L
 23639        MOVE  1                  TO SET-CURSOR-SW
 23640        GO TO 7499-EXIT.
 23641
 23642**2639**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23645        MOVE AL-UNBON            TO BBEN1A
 23646        MOVE -1                  TO BBEN1L
 23647        MOVE  1                  TO SET-CURSOR-SW
 23648        GO TO 7499-EXIT.
 23649
 23650**2640**
 23651
 23652     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23653        MOVE AL-UNBON            TO BBEN2A
 23654        MOVE -1                  TO BBEN2L
 23655        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 436
* EL6311.cbl
 23656        GO TO 7499-EXIT.
 23657
 23658**2647**
 23659
 23660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23661        MOVE AL-UNBON            TO BTERM1A
 23662        MOVE -1                  TO BTERM1L
 23663        MOVE  1                  TO SET-CURSOR-SW
 23664        GO TO 7499-EXIT.
 23665
 23666**2648**
 23667
 23668     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23669              or er-3070
 23670        MOVE AL-UNBON            TO BLNTRMA
 23671        MOVE -1                  TO BLNTRML
 23672        MOVE  1                  TO SET-CURSOR-SW
 23673        GO TO 7499-EXIT.
 23674
 23675**2649**
 23676
 23677     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23678        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23679            MOVE AL-UNBON            TO BPREM1A
 23680            MOVE -1                  TO BPREM1L
 23681            MOVE  1                  TO SET-CURSOR-SW
 23682            GO TO 7499-EXIT
 23683     ELSE
 23684        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23685           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23686            MOVE AL-UNBON            TO BPREM2A
 23687            MOVE -1                  TO BPREM2L
 23688            MOVE  1                  TO SET-CURSOR-SW
 23689            GO TO 7499-EXIT.
 23690
 23691**2650**
 23692
 23693     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23694        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23695            MOVE AL-UNBON        TO BPREM1A
 23696            MOVE -1              TO BPREM1L
 23697            MOVE  1              TO SET-CURSOR-SW
 23698            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23699                MOVE AL-UNBON        TO BPREM2A
 23700                MOVE -1              TO BPREM2L
 23701                MOVE  1              TO SET-CURSOR-SW
 23702                GO TO 7499-EXIT
 23703            ELSE
 23704                GO TO 7499-EXIT
 23705        ELSE
 23706            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23707                MOVE AL-UNBON        TO BPREM2A
 23708                MOVE -1              TO BPREM2L
 23709                MOVE  1              TO SET-CURSOR-SW
 23710                GO TO 7499-EXIT
 23711            ELSE
 23712                GO TO 7499-EXIT.
 23713
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 437
* EL6311.cbl
 23714**2651**
 23715
 23716     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 23717        MOVE AL-UABON            TO BSIGA
 23718        MOVE -1                  TO BSIGL
 23719        MOVE  1                  TO SET-CURSOR-SW
 23720        GO TO 7499-EXIT.
 23721
 23722**2653**
 23723
 23724     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 23725        MOVE AL-UABON            TO BFREQA
 23726        MOVE -1                  TO BFREQL
 23727        MOVE  1                  TO SET-CURSOR-SW
 23728        GO TO 7499-EXIT.
 23729
 23730**2654**
 23731
 23732     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23733        MOVE AL-UABON            TO BFREQA
 23734        MOVE -1                  TO BFREQL
 23735        MOVE  1                  TO SET-CURSOR-SW
 23736        GO TO 7499-EXIT.
 23737
 23738**2655**
 23739
 23740     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23741        MOVE AL-UABON            TO BFREQA
 23742        MOVE -1                  TO BFREQL
 23743        MOVE  1                  TO SET-CURSOR-SW
 23744        GO TO 7499-EXIT.
 23745
 23746**2656**
 23747
 23748     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23749        MOVE AL-UNBON            TO BAPRA
 23750        MOVE -1                  TO BAPRL
 23751        MOVE  1                  TO SET-CURSOR-SW
 23752        GO TO 7499-EXIT.
 23753
 23754**2657**
 23755
 23756     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23757        MOVE AL-UNBON            TO BAPRA
 23758        MOVE -1                  TO BAPRL
 23759        MOVE  1                  TO SET-CURSOR-SW
 23760        GO TO 7499-EXIT.
 23761
 23762**2658**
 23763
 23764     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23765        MOVE AL-UNBON            TO BTERM2A
 23766        MOVE -1                  TO BTERM2L
 23767        MOVE  1                  TO SET-CURSOR-SW
 23768        GO TO 7499-EXIT.
 23769
 23770**2660**
 23771
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 438
* EL6311.cbl
 23772     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23773        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23774        MOVE -1                  TO BLSTNML
 23775        MOVE  1                  TO SET-CURSOR-SW
 23776        GO TO 7499-EXIT.
 23777
 23778
 23779**2662**
 23780
 23781     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23782        MOVE AL-UNBON            TO BAGEA
 23783        MOVE -1                  TO BAGEL
 23784        MOVE  1                  TO SET-CURSOR-SW
 23785        GO TO 7499-EXIT.
 23786
 23787**2663**
 23788
 23789     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23790        MOVE AL-UNBON            TO BAGEA
 23791        MOVE -1                  TO BAGEL
 23792        MOVE  1                  TO SET-CURSOR-SW
 23793        GO TO 7499-EXIT.
 23794
 23795**2664**
 23796
 23797     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23798        MOVE AL-UABON            TO BREINA
 23799        MOVE -1                  TO BREINL
 23800        MOVE  1                  TO SET-CURSOR-SW
 23801        GO TO 7499-EXIT.
 23802
 23803**2667**
 23804
 23805     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23806        MOVE AL-UNBON            TO BBEN2A
 23807        MOVE -1                  TO BBEN2L
 23808        MOVE  1                  TO SET-CURSOR-SW
 23809        GO TO 7499-EXIT.
 23810
 23811**2668**
 23812
 23813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23814        MOVE AL-UABON            TO BEFFDTA
 23815        GO TO 7499-EXIT.
 23816
 23817**2669**
 23818
 23819     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23820       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23821       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23822        MOVE AL-UNBON            TO BAGEA
 23823        MOVE -1                  TO BAGEL
 23824        MOVE  1                  TO SET-CURSOR-SW
 23825        GO TO 7499-EXIT.
 23826
 23827**2670**
 23828
 23829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 439
* EL6311.cbl
 23830        MOVE AL-UABON            TO BFORCEA
 23831        MOVE -1                  TO BFORCEL
 23832        MOVE  1                  TO SET-CURSOR-SW
 23833        GO TO 7499-EXIT.
 23834
 23835**2671**
 23836
 23837     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23838        MOVE AL-UABON            TO BEFFDTA
 23839        GO TO 7499-EXIT.
 23840
 23841**2672**
 23842
 23843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23844        MOVE AL-UABON            TO BEFFDTA
 23845        GO TO 7499-EXIT.
 23846
 23847**2673**
 23848
 23849     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23850        MOVE AL-UABON            TO BEFFDTA
 23851        GO TO 7499-EXIT.
 23852
 23853**2674**
 23854
 23855     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23856        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23857        MOVE -1                  TO BTYPE1L
 23858        MOVE  1                  TO SET-CURSOR-SW
 23859        GO TO 7499-EXIT.
 23860
 23861**2677**
 23862
 23863     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23864        MOVE AL-UNBON            TO BTERM1A
 23865        MOVE -1                  TO BTERM1L
 23866        MOVE  1                  TO SET-CURSOR-SW
 23867        GO TO 7499-EXIT.
 23868
 23869**2678**
 23870
 23871     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23872        MOVE AL-UNBON            TO BTERM2A
 23873        MOVE -1                  TO BTERM2L
 23874        MOVE  1                  TO SET-CURSOR-SW
 23875        GO TO 7499-EXIT.
 23876
 23877**2679**
 23878
 23879     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23880        MOVE AL-UABON            TO BTYPE1A
 23881        MOVE -1                  TO BTYPE1L
 23882        MOVE  1                  TO SET-CURSOR-SW
 23883        GO TO 7499-EXIT.
 23884
 23885**2680**
 23886
 23887     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 440
* EL6311.cbl
 23888        MOVE AL-UABOF            TO B1STPMTA
 23889        MOVE -1                  TO B1STPMTL
 23890        MOVE  1                  TO SET-CURSOR-SW
 23891        GO TO 7499-EXIT.
 23892
 23893**2681**
 23894
 23895     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23896        MOVE AL-UABON            TO BDAYSA
 23897        MOVE -1                  TO BDAYSL
 23898        MOVE  1                  TO SET-CURSOR-SW
 23899        GO TO 7499-EXIT.
 23900
 23901**2682**
 23902
 23903     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23904        MOVE AL-UABON            TO BTERM1A
 23905        MOVE -1                  TO BTERM1L
 23906        MOVE  1                  TO SET-CURSOR-SW
 23907        GO TO 7499-EXIT.
 23908
 23909**2683**
 23910
 23911     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23912        MOVE AL-UABON            TO BSKPCDA
 23913        MOVE -1                  TO BSKPCDL
 23914        MOVE  1                  TO SET-CURSOR-SW
 23915        GO TO 7499-EXIT.
 23916
 23917**2684**
 23918
 23919     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23920        MOVE AL-UABON            TO BTYPE2A
 23921        MOVE -1                  TO BTYPE2L
 23922        MOVE  1                  TO SET-CURSOR-SW
 23923        GO TO 7499-EXIT.
 23924
 23925**2686**
 23926
 23927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23928        MOVE AL-UABON            TO BTYPE2A
 23929        MOVE -1                  TO BTYPE2L
 23930        MOVE  1                  TO SET-CURSOR-SW
 23931        GO TO 7499-EXIT.
 23932
 23933**2689**
 23934
 23935     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23936        MOVE AL-UABON            TO BSIGA
 23937        MOVE -1                  TO BSIGL
 23938        MOVE  1                  TO SET-CURSOR-SW
 23939        GO TO 7499-EXIT.
 23940
 23941**2690**
 23942
 23943     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23944        MOVE AL-UABOF            TO BLNOFCRA
 23945        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 441
* EL6311.cbl
 23946        MOVE  1                  TO SET-CURSOR-SW
 23947        GO TO 7499-EXIT.
 23948
 23949**2693**
 23950
 23951     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23952        MOVE AL-UABOF            TO BLNOFCRA
 23953        MOVE AL-UNBON            TO BBEN1A
 23954        MOVE -1                  TO BBEN1L
 23955        MOVE  1                  TO SET-CURSOR-SW
 23956        GO TO 7499-EXIT.
 23957
 23958**2720**
 23959
 23960     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23961        MOVE AL-UNBON            TO BBEN1A
 23962        MOVE -1                  TO BBEN1L
 23963        MOVE  1                  TO SET-CURSOR-SW
 23964        GO TO 7499-EXIT.
 23965
 23966**2709**
 23967
 23968*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23969*       MOVE AL-UNBON            TO BBEN1A
 23970*       MOVE -1                  TO BBEN1L
 23971*       MOVE  1                  TO SET-CURSOR-SW
 23972*       GO TO 7499-EXIT.
 23973
 23974*************************************************************
 23975*                                                           *
 23976*            C A N C E L   E R R O R S                      *
 23977*                                                           *
 23978*************************************************************
 23979
 23980**2726**
 23981
 23982     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23983        MOVE AL-UABON            TO CCERTNOA
 23984        GO TO 7499-EXIT.
 23985
 23986**2728**
 23987
 23988     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23989        MOVE AL-UABON            TO CCERTNOA
 23990        GO TO 7499-EXIT.
 23991
 23992**2729**
 23993
 23994     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23995        MOVE AL-UABON            TO CCERTNOA
 23996        GO TO 7499-EXIT.
 23997
 23998**2730**
 23999
 24000     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24001        MOVE AL-UABON            TO CCERTNOA
 24002        GO TO 7499-EXIT.
 24003
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 442
* EL6311.cbl
 24004**2731**
 24005
 24006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24007        MOVE AL-UABON            TO CCANDT1A
 24008        MOVE -1                  TO CCANDT1L
 24009        MOVE  1                  TO SET-CURSOR-SW
 24010        GO TO 7499-EXIT.
 24011
 24012**2732**
 24013
 24014     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24015        MOVE AL-UABON            TO CCANDT1A
 24016        MOVE -1                  TO CCANDT1L
 24017        MOVE  1                  TO SET-CURSOR-SW
 24018        GO TO 7499-EXIT.
 24019
 24020**2733**
 24021
 24022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24023        MOVE AL-UABON            TO CCANDT1A
 24024        MOVE -1                  TO CCANDT1L
 24025        MOVE  1                  TO SET-CURSOR-SW
 24026        GO TO 7499-EXIT.
 24027
 24028**2734**
 24029
 24030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24031        MOVE AL-UNBON            TO CREFND1A
 24032        MOVE -1                  TO CREFND1L
 24033        MOVE  1                  TO SET-CURSOR-SW
 24034        GO TO 7499-EXIT.
 24035
 24036**2735**
 24037
 24038     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24039        MOVE AL-UABON            TO CCANDT2A
 24040        MOVE -1                  TO CCANDT2L
 24041        MOVE  1                  TO SET-CURSOR-SW
 24042        GO TO 7499-EXIT.
 24043
 24044**2736**
 24045
 24046     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24047        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24048            MOVE AL-UNBON        TO CREFND1A
 24049            MOVE -1              TO CREFND1L
 24050            MOVE  1              TO SET-CURSOR-SW
 24051            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24052                MOVE AL-UNBON        TO CREFND2A
 24053                MOVE -1              TO CREFND2L
 24054                MOVE  1              TO SET-CURSOR-SW
 24055                GO TO 7499-EXIT
 24056            ELSE
 24057                GO TO 7499-EXIT
 24058        ELSE
 24059            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24060                MOVE AL-UNBON        TO CREFND2A
 24061                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 443
* EL6311.cbl
 24062                MOVE  1              TO SET-CURSOR-SW
 24063                GO TO 7499-EXIT
 24064            ELSE
 24065                GO TO 7499-EXIT.
 24066
 24067**2738**
 24068
 24069     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24070        MOVE -1                  TO CREFND2L
 24071        MOVE  1                  TO SET-CURSOR-SW
 24072        GO TO 7499-EXIT.
 24073
 24074**2739**
 24075
 24076     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24077        MOVE -1                  TO CREFND1L
 24078        MOVE  1                  TO SET-CURSOR-SW
 24079        GO TO 7499-EXIT.
 24080
 24081**2741**
 24082
 24083     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24084        MOVE -1                  TO CREFND1L
 24085        MOVE  1                  TO SET-CURSOR-SW
 24086        GO TO 7499-EXIT.
 24087
 24088**2743**
 24089
 24090     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24091        MOVE AL-UNBON            TO CCANDT1A
 24092        MOVE -1                  TO CCANDT1L
 24093        MOVE  1                  TO SET-CURSOR-SW
 24094        GO TO 7499-EXIT.
 24095
 24096**2744**
 24097
 24098     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24099        MOVE AL-UNBON            TO CCANDT2A
 24100        MOVE -1                  TO CCANDT2L
 24101        MOVE  1                  TO SET-CURSOR-SW
 24102        GO TO 7499-EXIT.
 24103
 24104**2747**
 24105
 24106     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24107        MOVE AL-UABON            TO CLSTNMA
 24108        MOVE -1                  TO CLSTNML
 24109        MOVE  1                  TO SET-CURSOR-SW
 24110        GO TO 7499-EXIT.
 24111
 24112**2749**
 24113
 24114     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24115        MOVE AL-UABON            TO CFORCEA
 24116        MOVE -1                  TO CFORCEL
 24117        MOVE  1                  TO SET-CURSOR-SW
 24118        GO TO 7499-EXIT.
 24119
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 444
* EL6311.cbl
 24120**2753**
 24121
 24122     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24123        MOVE AL-UNBON            TO CCANDT1A
 24124        MOVE -1                  TO CCANDT1L
 24125        MOVE  1                  TO SET-CURSOR-SW
 24126        GO TO 7499-EXIT.
 24127
 24128**2755**
 24129
 24130     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24131        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24132            MOVE AL-UNBON        TO CREFND1A
 24133            MOVE -1              TO CREFND1L
 24134            MOVE  1              TO SET-CURSOR-SW
 24135            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24136                MOVE AL-UNBON        TO CREFND2A
 24137                MOVE -1              TO CREFND2L
 24138                MOVE  1              TO SET-CURSOR-SW
 24139                GO TO 7499-EXIT
 24140            ELSE
 24141                GO TO 7499-EXIT
 24142        ELSE
 24143            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24144                MOVE AL-UNBON        TO CREFND2A
 24145                MOVE -1              TO CREFND2L
 24146                MOVE  1              TO SET-CURSOR-SW
 24147            ELSE
 24148                GO TO 7499-EXIT.
 24149
 24150**2757**
 24151
 24152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24153        MOVE AL-UNBON            TO CLIVESA
 24154        MOVE -1                  TO CLIVESL
 24155        MOVE  1                  TO SET-CURSOR-SW
 24156        GO TO 7499-EXIT.
 24157
 24158**2771**
 24159
 24160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24161        MOVE AL-UABON            TO CCANDT2A
 24162        MOVE -1                  TO CCANDT2L
 24163        MOVE  1                  TO SET-CURSOR-SW
 24164        GO TO 7499-EXIT.
 24165
 24166**2774**
 24167
 24168     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24169        MOVE AL-UABON            TO CCANDT1A
 24170        MOVE -1                  TO CCANDT1L
 24171        MOVE  1                  TO SET-CURSOR-SW
 24172        GO TO 7499-EXIT.
 24173
 24174**2775**
 24175
 24176     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24177        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 445
* EL6311.cbl
 24178        MOVE -1                  TO CCANDT2L
 24179        MOVE  1                  TO SET-CURSOR-SW
 24180        GO TO 7499-EXIT.
 24181
 24182**2776**
 24183
 24184     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24185        MOVE AL-UABON            TO CCANDT1A
 24186        MOVE -1                  TO CCANDT1L
 24187        MOVE  1                  TO SET-CURSOR-SW
 24188        GO TO 7499-EXIT.
 24189
 24190
 24191**2777**
 24192
 24193     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24194        MOVE AL-UABON            TO CCANDT2A
 24195        MOVE -1                  TO CCANDT2L
 24196        MOVE  1                  TO SET-CURSOR-SW
 24197        GO TO 7499-EXIT.
 24198
 24199**2794**
 24200
 24201     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24202        MOVE AL-UABON            TO CFORCEA
 24203        MOVE -1                  TO CFORCEL
 24204        MOVE  1                  TO SET-CURSOR-SW
 24205        GO TO 7499-EXIT.
 24206
 24207**2799**
 24208
 24209     IF PI-COMPANY-ID = 'UCL'
 24210         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24211             MOVE AL-UNBON            TO BEFFDTA
 24212             MOVE -1                  TO BEFFDTL
 24213             MOVE  1                  TO SET-CURSOR-SW
 24214             GO TO 7499-EXIT.
 24215
 24216 7499-EXIT.
 24217      EXIT.
 24218
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 446
* EL6311.cbl
 24220
 24221 7500-READ-ERLOFC.
 24222     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24223                                     ERLOFC-KEY.
 24224
 24225     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24226
 24227     IF ST-ACCNT-CNTL
 24228         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24229
 24230     IF CARR-GROUP-ST-ACCNT-CNTL
 24231         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24232         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24233         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24234
 24235     IF CARR-ST-ACCNT-CNTL
 24236         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24237         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24238
 24239     IF CARR-ACCNT-CNTL
 24240         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24241
 24242     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24243
 24244     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24245
 24246
 24247* EXEC CICS HANDLE CONDITION
 24248*        NOTFND   (7550-OFFICER-NOTFND)
 24249*    END-EXEC.
 24250*    MOVE '"$I                   ! V #00020506' TO DFHEIV0
 24251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24253     MOVE X'5620233030303230353036' TO DFHEIV0(25:11)
 24254     CALL 'kxdfhei1' USING DFHEIV0
 24255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24256
 24257
 24258
 24259* EXEC CICS READ
 24260*        DATASET   (FILE-ID-ERLOFC)
 24261*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24262*        RIDFLD    (ERLOFC-KEY)
 24263*        EQUAL
 24264*    END-EXEC.
 24265*    MOVE '&"S        E          (   #00020510' TO DFHEIV0
 24266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24268     MOVE X'2020233030303230353130' TO DFHEIV0(25:11)
 24269     CALL 'kxdfhei1' USING DFHEIV0,
 24270           FILE-ID-ERLOFC,
 24271           DFHEIV20,
 24272           DFHEIV99,
 24273           ERLOFC-KEY,
 24274           DFHEIV99,
 24275           DFHEIV99,
 24276           DFHEIV99
 24277     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 447
* EL6311.cbl
 24278         DFHEIV20
 24279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24280
 24281
 24282     GO TO 7599-EXIT.
 24283
 24284 7550-OFFICER-NOTFND.
 24285     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24286
 24287 7599-EXIT.
 24288      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 448
* EL6311.cbl
 24290******************************************************************
 24291*                                                                *
 24292*            S  E N D    I N I T I A L   M A P                   *
 24293*                                                                *
 24294******************************************************************
 24295
 24296 8100-SEND-INITIAL-MAP.
 24297     MOVE EIBTIME                TO TIME-IN.
 24298
 24299     IF EIBAID = DFHPF11
 24300        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24302
 24303
 24304     IF PI-COMPANY-ID = CLIENT-GIC
 24305        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24306                                       BCPREM-ATTRB (2).
 24307
 24308     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24309                         CLIENT-PEM OR
 24310                         CLIENT-CSO)
 24311        AND PI-DISPLAY-ORIGINAL-BATCH
 24312          IF PI-MAP-NAME = EL631B
 24313             MOVE AL-SADOF               TO BPF5HDRA
 24314                                            BPF4HDRA
 24315          ELSE
 24316             IF PI-MAP-NAME = EL631C
 24317                MOVE AL-SADOF            TO CPF5HDRA
 24318                                            CPF4HDRA.
 24319
 24320     IF PI-MAP-NAME = EL631B
 24321        MOVE AL-SADOF               TO BPF5HDRA
 24322     ELSE
 24323        MOVE AL-SADOF               TO CPF5HDRA
 24324     END-IF
 24325
 24326*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24327     IF PI-MAP-NAME = EL631B
 24328          IF PI-COMPANY-ID NOT = 'DMD'
 24329             MOVE AL-SANOF            TO BBILLEDA
 24330             MOVE AL-SADOF            TO DMDBILA.
 24331*DMD CUSTOM CODING*************END
 24332
 24333     IF PI-PROCESSOR-ID = 'LGXX'
 24334        IF PI-MAP-NAME = EL631B
 24335           MOVE AL-SABOF                    TO BREFHDGA
 24336           MOVE AL-SANOF                    TO BREFA
 24337        ELSE
 24338           IF PI-MAP-NAME = EL631C
 24339              MOVE AL-SABOF                 TO CREFHDGA
 24340              MOVE AL-SANOF                 TO CREFA.
 24341
 24342     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24343        continue
 24344     ELSE
 24345        IF PI-MAP-NAME = EL631C
 24346           MOVE AL-SADOF         TO CCANTXTA
 24347                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 449
* EL6311.cbl
 24348        end-if
 24349     end-if
 24350     IF PI-MAP-NAME = EL631D
 24351        IF PI-AR-PROCESSING
 24352           MOVE AL-SANOF            TO DREFHDGA
 24353        ELSE
 24354           MOVE AL-SADOF            TO DREFHDGA.
 24355
 24356     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24357        AND (PI-MAP-NAME = EL631B)
 24358        MOVE AL-SADOF            TO BVINHA
 24359                                    BVINA
 24360     END-IF
 24361     IF PI-MAP-NAME = EL631B
 24362        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24363        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24364                                 TO BREGIONO
 24365        MOVE PI-PROCESSOR-ID     TO BUSERO
 24366        IF CSR-EDIT-SESSION
 24367           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24368                                 TO BHEADO
 24369           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24370        ELSE
 24371           MOVE AL-SADOF         TO BF15HDRA
 24372           MOVE '4=B-HDR      '  TO BPF4HDRO
 24373        END-IF
 24374        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24375        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24376        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24377        MOVE WS-CURRENT-DT          TO BDATEO
 24378        MOVE TIME-OUT               TO BTIMEO
 24379        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24380        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24381        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24382        IF   WS-DISPLAY-SCREEN
 24383             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24384             MOVE PB-SV-CARRIER     TO BCARRO
 24385             MOVE PB-SV-GROUPING    TO BGROUPO
 24386             MOVE PB-SV-STATE       TO BSTATEO
 24387             MOVE PB-ACCOUNT        TO BACCTO
 24388        ELSE
 24389             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24390     ELSE
 24391        IF PI-MAP-NAME = EL631C
 24392           MOVE '4=B-HDR      '     TO CPF4HDRO
 24393           IF CSR-EDIT-SESSION
 24394              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24395                                 TO CHEADO
 24396           ELSE
 24397              MOVE AL-SADOF      TO CF15HDRA
 24398           END-IF
 24399           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24400           MOVE WS-CURRENT-DT          TO CDATEO
 24401           MOVE TIME-OUT               TO CTIMEO
 24402           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24403           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24404           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24405           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 450
* EL6311.cbl
 24406           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24407           MOVE WS-C-HDG               TO CAHHDGO
 24408           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24409           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24410           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24411           IF   WS-DISPLAY-SCREEN
 24412                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24413                MOVE PB-SV-CARRIER     TO CCARRO
 24414                MOVE PB-SV-GROUPING    TO CGROUPO
 24415                MOVE PB-SV-STATE       TO CSTATEO
 24416                MOVE PB-ACCOUNT        TO CACCTO
 24417           ELSE
 24418                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24419        ELSE
 24420           MOVE WS-CURRENT-DT          TO DDATEO
 24421           MOVE TIME-OUT               TO DTIMEO
 24422           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24423                                          WS-REFUND-HDG-OVERRIDE
 24424           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24425           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24426           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24427                                          WS-REFUND-HDG-OVERRIDE
 24428           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24429           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24430           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24431           IF CSR-EDIT-SESSION
 24432              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24433                                 TO DHEADO
 24434           END-IF
 24435           IF  WS-DISPLAY-SCREEN
 24436               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24437               MOVE PB-CARRIER         TO DCARRO
 24438               MOVE PB-GROUPING        TO DGROUPO
 24439               MOVE PB-STATE           TO DSTATEO
 24440               MOVE PB-ACCOUNT         TO DACCTO
 24441               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24442           ELSE
 24443               MOVE EL631D             TO PI-MAP-NAME
 24444               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24445               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24446
 24447     MOVE SPACE                        TO WS-DISPLAY-SW.
 24448
 24449
 24450* EXEC CICS SEND
 24451*        MAP      (PI-MAP-NAME)
 24452*        MAPSET   (MAPSET-EL6311S)
 24453*        FROM     (EL631BI)
 24454*        ERASE
 24455*        CURSOR
 24456*    END-EXEC.
 24457     MOVE LENGTH OF
 24458      EL631BI
 24459       TO DFHEIV12
 24460     MOVE -1
 24461       TO DFHEIV11
 24462*    MOVE '8$     CT  E    H L F ,   #00020684' TO DFHEIV0
 24463     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 451
* EL6311.cbl
 24464     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24465     MOVE X'2020233030303230363834' TO DFHEIV0(25:11)
 24466     CALL 'kxdfhei1' USING DFHEIV0,
 24467           PI-MAP-NAME,
 24468           EL631BI,
 24469           DFHEIV12,
 24470           MAPSET-EL6311S,
 24471           DFHEIV99,
 24472           DFHEIV99,
 24473           DFHEIV99,
 24474           DFHEIV11,
 24475           DFHEIV99,
 24476           DFHEIV99,
 24477           DFHEIV99
 24478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24479
 24480
 24481     GO TO 9100-RETURN-TRAN.
 24482
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 452
* EL6311.cbl
 24484
 24485******************************************************************
 24486*                                                                *
 24487*              S E N D    D A T A O N L Y                        *
 24488*                                                                *
 24489******************************************************************
 24490
 24491 8200-SEND-DATAONLY.
 24492     MOVE EIBTIME                TO TIME-IN.
 24493
 24494     IF PI-COMPANY-ID = CLIENT-GIC
 24495        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24496                                       BCPREM-ATTRB (2).
 24497
 24498     IF PI-MAP-NAME = EL631B
 24499        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24500        MOVE WS-CURRENT-DT          TO BDATEO
 24501        MOVE TIME-OUT               TO BTIMEO
 24502        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24503        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24504        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24505        MOVE SPACES                 TO BPFENTRO
 24506        MOVE AL-UANOF               TO BPFENTRA
 24507
 24508*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24509        IF PI-COMPANY-ID NOT = 'DMD'
 24510             MOVE AL-SANOF            TO BBILLEDA
 24511             MOVE AL-SADOF            TO DMDBILA
 24512         ELSE
 24513            NEXT SENTENCE
 24514*DMD CUSTOM CODING*************END
 24515     ELSE
 24516        IF PI-MAP-NAME = EL631C
 24517           MOVE WS-CURRENT-DT          TO CDATEO
 24518           MOVE TIME-OUT               TO CTIMEO
 24519           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24520           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24521           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24522           MOVE SPACES                 TO CPFENTRO
 24523           MOVE AL-UANOF               TO CPFENTRA
 24524        ELSE
 24525           MOVE WS-CURRENT-DT          TO DDATEO
 24526           MOVE TIME-OUT               TO DTIMEO
 24527           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24528
 24529
 24530* EXEC CICS SEND
 24531*        MAP      (PI-MAP-NAME)
 24532*        MAPSET   (MAPSET-EL6311S)
 24533*        FROM     (EL631BI)
 24534*        DATAONLY
 24535*        CURSOR
 24536*    END-EXEC.
 24537     MOVE LENGTH OF
 24538      EL631BI
 24539       TO DFHEIV12
 24540     MOVE -1
 24541       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 453
* EL6311.cbl
 24542*    MOVE '8$D    CT       H L F ,   #00020740' TO DFHEIV0
 24543     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24544     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24545     MOVE X'2020233030303230373430' TO DFHEIV0(25:11)
 24546     CALL 'kxdfhei1' USING DFHEIV0,
 24547           PI-MAP-NAME,
 24548           EL631BI,
 24549           DFHEIV12,
 24550           MAPSET-EL6311S,
 24551           DFHEIV99,
 24552           DFHEIV99,
 24553           DFHEIV99,
 24554           DFHEIV11,
 24555           DFHEIV99,
 24556           DFHEIV99,
 24557           DFHEIV99
 24558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24559
 24560
 24561     GO TO 9100-RETURN-TRAN.
 24562
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 454
* EL6311.cbl
 24564
 24565******************************************************************
 24566*                                                                *
 24567*           U T I L I T Y   R O U T I N E S                      *
 24568*                                                                *
 24569******************************************************************
 24570
 24571 8300-SEND-TEXT.
 24572
 24573* EXEC CICS SEND TEXT
 24574*        FROM     (LOGOFF-TEXT)
 24575*        LENGTH   (LOGOFF-LENGTH)
 24576*        ERASE
 24577*        FREEKB
 24578*    END-EXEC.
 24579*    MOVE '8&      T  E F  H   F -   #00020759' TO DFHEIV0
 24580     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24581     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24582     MOVE X'2020233030303230373539' TO DFHEIV0(25:11)
 24583     CALL 'kxdfhei1' USING DFHEIV0,
 24584           LOGOFF-TEXT,
 24585           LOGOFF-LENGTH,
 24586           DFHEIV99,
 24587           DFHEIV99,
 24588           DFHEIV99,
 24589           DFHEIV99,
 24590           DFHEIV99,
 24591           DFHEIV99,
 24592           DFHEIV99,
 24593           DFHEIV99,
 24594           DFHEIV99,
 24595           DFHEIV99
 24596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24597
 24598
 24599
 24600* EXEC CICS RETURN
 24601*    END-EXEC.
 24602*    MOVE '.(                    ''   #00020766' TO DFHEIV0
 24603     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24605     MOVE X'2020233030303230373636' TO DFHEIV0(25:11)
 24606     CALL 'kxdfhei1' USING DFHEIV0,
 24607           DFHEIV99,
 24608           DFHEIV99,
 24609           DFHEIV99,
 24610           DFHEIV99,
 24611           DFHEIV99,
 24612           DFHEIV99
 24613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24614
 24615
 24616 8400-LOG-JOURNAL-RECORD.
 24617
 24618     if (pi-journal-file-id > 0)
 24619        and (jp-file-id = file-id-erpndb)
 24620        move eibdate             to jp-date
 24621        move eibtime             to jp-time
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 455
* EL6311.cbl
 24622*       move FILE-ID-ERPNDB      TO JP-FILE-ID
 24623        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
 24624        MOVE 03                  TO PI-JOURNAL-FILE-ID
 24625        if csr-edit-session
 24626           move 'EL6311C'        to jp-program-id
 24627        else
 24628           MOVE THIS-PGM         TO JP-PROGRAM-ID
 24629        end-if
 24630
 24631**      length is 585 plus 30 extra for jrnl stuff
 24632**      system already accounts for the 34
 24633
 24634
 24635* EXEC CICS JOURNAL
 24636*          JFILEID   (PI-JOURNAL-FILE-ID)
 24637*          JTYPEID   ('EL')
 24638*          FROM      (JOURNAL-RECORD)
 24639*          LENGTH    (615)
 24640*          resp      (ws-response)
 24641*       END-EXEC
 24642     MOVE 'EL' TO DFHEIV7
 24643     MOVE 615
 24644       TO DFHEIV11
 24645*    MOVE '4"LF                  (  N#00020787' TO DFHEIV0
 24646     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 24647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24648     MOVE X'204E233030303230373837' TO DFHEIV0(25:11)
 24649     CALL 'kxdfhei1' USING DFHEIV0,
 24650           PI-JOURNAL-FILE-ID,
 24651           DFHEIV7,
 24652           JOURNAL-RECORD,
 24653           DFHEIV11,
 24654           DFHEIV99,
 24655           DFHEIV99,
 24656           DFHEIV99
 24657     MOVE EIBRESP  TO ws-response
 24658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 24659
 24660        if resp-normal
 24661           continue
 24662        else
 24663           display ' error-el6311-journal ' ws-response
 24664        end-if
 24665     end-if
 24666
 24667*    EXEC CICS JOURNAL
 24668*        JFILEID     (PI-JOURNAL-FILE-ID)
 24669*        JTYPEID     ('EL')
 24670*        FROM        (JOURNAL-RECORD)
 24671*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24672*    END-EXEC.
 24673     .
 24674 8400-exit.
 24675     exit.
 24676 8600-DEEDIT.
 24677
 24678* EXEC CICS BIF DEEDIT
 24679*         FIELD   (DEEDIT-FIELD)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 456
* EL6311.cbl
 24680*         LENGTH  (15)
 24681*    END-EXEC.
 24682     MOVE 15
 24683       TO DFHEIV11
 24684*    MOVE '@"L                   #   #00020812' TO DFHEIV0
 24685     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24686     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24687     MOVE X'2020233030303230383132' TO DFHEIV0(25:11)
 24688     CALL 'kxdfhei1' USING DFHEIV0,
 24689           DEEDIT-FIELD,
 24690           DFHEIV11
 24691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24692
 24693
 24694 8800-UNAUTHORIZED-ACCESS.
 24695     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24696     GO TO 8300-SEND-TEXT.
 24697
 24698 8810-PF23.
 24699     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24700     MOVE XCTL-EL005             TO PGM-NAME.
 24701     GO TO 9300-XCTL.
 24702
 24703 9100-RETURN-TRAN.
 24704     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24705
 24706     IF  PI-MAP-NAME =  EL631B
 24707         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24708
 24709     IF  PI-MAP-NAME =  EL631C
 24710         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24711
 24712     IF  PI-MAP-NAME =  EL631D
 24713         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24714
 24715
 24716* EXEC CICS RETURN
 24717*        TRANSID    (TRANS-EXB1)
 24718*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24719*        LENGTH     (1300)
 24720*    END-EXEC.
 24721     MOVE 1300
 24722       TO DFHEIV11
 24723*    MOVE '.(CT                  ''   #00020838' TO DFHEIV0
 24724     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24726     MOVE X'2020233030303230383338' TO DFHEIV0(25:11)
 24727     CALL 'kxdfhei1' USING DFHEIV0,
 24728           TRANS-EXB1,
 24729           PROGRAM-INTERFACE-BLOCK,
 24730           DFHEIV11,
 24731           DFHEIV99,
 24732           DFHEIV99,
 24733           DFHEIV99
 24734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24735
 24736
 24737 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 457
* EL6311.cbl
 24738     MOVE XCTL-EL626             TO PGM-NAME.
 24739     GO TO 9300-XCTL.
 24740
 24741 9300-XCTL.
 24742
 24743* EXEC CICS XCTL
 24744*        PROGRAM    (PGM-NAME)
 24745*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24746*        LENGTH     (PI-COMM-LENGTH)
 24747*    END-EXEC.
 24748*    MOVE '.$C                   %   #00020849' TO DFHEIV0
 24749     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24750     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24751     MOVE X'2020233030303230383439' TO DFHEIV0(25:11)
 24752     CALL 'kxdfhei1' USING DFHEIV0,
 24753           PGM-NAME,
 24754           PROGRAM-INTERFACE-BLOCK,
 24755           PI-COMM-LENGTH,
 24756           DFHEIV99
 24757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24758
 24759
 24760 9400-CLEAR.
 24761     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24762     GO TO 9300-XCTL.
 24763
 24764 9500-PF12.
 24765     MOVE XCTL-EL010             TO PGM-NAME.
 24766     GO TO 9300-XCTL.
 24767
 24768 9600-PGMID-ERROR.
 24769
 24770* EXEC CICS HANDLE CONDITION
 24771*        PGMIDERR    (8300-SEND-TEXT)
 24772*    END-EXEC.
 24773*    MOVE '"$L                   ! W #00020864' TO DFHEIV0
 24774     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24776     MOVE X'5720233030303230383634' TO DFHEIV0(25:11)
 24777     CALL 'kxdfhei1' USING DFHEIV0
 24778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24779
 24780
 24781     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24782     MOVE ' '                    TO PI-ENTRY-CD-1.
 24783     MOVE XCTL-EL005             TO PGM-NAME.
 24784     MOVE PGM-NAME               TO LOGOFF-PGM.
 24785     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24786     GO TO 9300-XCTL.
 24787
 24788 9700-DATE-LINK.
 24789     MOVE LINK-ELDATCV           TO PGM-NAME.
 24790
 24791* EXEC CICS LINK
 24792*        PROGRAM    (PGM-NAME)
 24793*        COMMAREA   (DATE-CONVERSION-DATA)
 24794*        LENGTH     (DC-COMM-LENGTH)
 24795*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 458
* EL6311.cbl
 24796*    MOVE '."C                   (   #00020877' TO DFHEIV0
 24797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24799     MOVE X'2020233030303230383737' TO DFHEIV0(25:11)
 24800     CALL 'kxdfhei1' USING DFHEIV0,
 24801           PGM-NAME,
 24802           DATE-CONVERSION-DATA,
 24803           DC-COMM-LENGTH,
 24804           DFHEIV99,
 24805           DFHEIV99,
 24806           DFHEIV99,
 24807           DFHEIV99
 24808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24809
 24810
 24811 9800-LINK-PENDING-EDIT.
 24812     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24813     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24814
 24815     MOVE LINK-EL050             TO PGM-NAME
 24816     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24817     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24818                                    WK-CO-TOL-CLAIM
 24819                                    WK-CO-TOL-PREM
 24820                                    WK-CO-TOL-REFUND
 24821                                    WK-CO-TOL-PREM-PCT
 24822                                    WK-CO-TOL-REFUND-PCT
 24823                                    WK-REFUND-OVS-AMT
 24824                                    WK-REFUND-OVS-PCT
 24825                                    WK-ACCT-ADDR
 24826                                    WK-LIFE-EDIT-ADDR
 24827                                    WK-AH-EDIT-ADDR
 24828                                    WK-LIFE-BEN-ADDR
 24829                                    WK-AH-BEN-ADDR
 24830                                    WK-STATE-ADDR
 24831                                    WK-PLAN-ADDR
 24832                                    WK-FORM-ADDR
 24833     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24834
 24835     MOVE '6'                    TO WK-ENTRY-SW.
 24836
 24837     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24838
 24839     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24840                                    EC-AM-EXPIRATION-DT
 24841                                    EC-AM-EFFECTIVE-DT
 24842                                    EC-CM-LF-CANCEL-DT
 24843                                    EC-CM-AH-CANCEL-DT
 24844                                    EC-CM-DEATH-DT.
 24845
 24846     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24847                                    EC-CO-TOL-REFUND
 24848                                    EC-CO-MIN-AGE
 24849                                    EC-CO-MIN-PREMIUM
 24850                                    EC-CO-MIN-TERM
 24851                                    EC-CO-MAX-TERM
 24852                                    EC-ST-TOL-PREM
 24853                                    EC-ST-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 459
* EL6311.cbl
 24854                                    EC-AM-LF-TOL-PREM
 24855                                    EC-AM-AH-TOL-PREM
 24856                                    EC-AM-LF-MAX-ATT-AGE
 24857                                    EC-AM-LF-MAX-AGE
 24858                                    EC-AM-LF-MAX-TERM
 24859                                    EC-AM-LF-MAX-TOT-BEN
 24860                                    EC-AM-AH-MAX-ATT-AGE
 24861                                    EC-AM-AH-MAX-AGE
 24862                                    EC-AM-AH-MAX-TERM
 24863                                    EC-AM-AH-MAX-TOT-BEN
 24864                                    EC-AM-AH-MAX-MON-BEN
 24865                                    EC-RT-LF-MAX-ATT-AGE
 24866                                    EC-RT-LF-MAX-AGE
 24867                                    EC-RT-LF-MAX-TERM
 24868                                    EC-RT-LF-MAX-TOT-BEN
 24869                                    EC-RT-AH-MAX-ATT-AGE
 24870                                    EC-RT-AH-MAX-AGE
 24871                                    EC-RT-AH-MAX-TERM
 24872                                    EC-RT-AH-MAX-TOT-BEN
 24873                                    EC-RT-AH-MAX-MON-BEN
 24874                                    EC-RT-AH-RATE
 24875                                    EC-RT-LF-RATE
 24876                                    EC-RT-LF-NSP-RATE
 24877                                    EC-RT-AH-NSP-RATE
 24878                                    EC-CM-LF-PRIOR-REFUND
 24879                                    EC-CM-AH-PRIOR-REFUND.
 24880
 24881     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24882                                    EC-ST-TOL-PREM-PCT
 24883                                    EC-AM-LF-TOL-REFUND
 24884                                    EC-AM-LF-DEV-PERCENT
 24885                                    EC-CO-TOL-REFUND-PCT
 24886                                    EC-ST-TOL-REFUND-PCT
 24887                                    EC-AM-AH-TOL-REFUND
 24888                                    EC-AM-AH-DEV-PERCENT.
 24889
 24890
 24891* EXEC CICS LINK
 24892*         PROGRAM   (PGM-NAME)
 24893*         COMMAREA  (PASSED-RECORD)
 24894*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24895*    END-EXEC.
 24896*    MOVE '."C                   (   #00020962' TO DFHEIV0
 24897     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24899     MOVE X'2020233030303230393632' TO DFHEIV0(25:11)
 24900     CALL 'kxdfhei1' USING DFHEIV0,
 24901           PGM-NAME,
 24902           PASSED-RECORD,
 24903           WS-EDIT-PASS-LENGTH,
 24904           DFHEIV99,
 24905           DFHEIV99,
 24906           DFHEIV99,
 24907           DFHEIV99
 24908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24909
 24910
 24911     MOVE '1'                    TO PI-EDIT-SW.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 460
* EL6311.cbl
 24912     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24913
 24914     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24915
 24916     IF PI-COMPANY-ID = 'UCL'
 24917         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24918
 24919     IF VALID-PB-ID
 24920        GO TO 9800-EXIT.
 24921
 24922     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24923
 24924     IF PI-MAP-NAME = EL631B
 24925        MOVE -1                  TO BMAINTL
 24926       ELSE
 24927        MOVE -1                  TO CMAINTL.
 24928
 24929     GO TO 8200-SEND-DATAONLY.
 24930
 24931 9800-EXIT.
 24932      EXIT.
 24933
 24934 9900-ERROR-FORMAT.
 24935
 24936     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24937
 24938     IF NOT EMI-ERRORS-COMPLETE
 24939         MOVE LINK-EL001         TO PGM-NAME
 24940
 24941* EXEC CICS LINK
 24942*            PROGRAM    (PGM-NAME)
 24943*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24944*            LENGTH     (EMI-COMM-LENGTH)
 24945*        END-EXEC.
 24946*    MOVE '."C                   (   #00020997' TO DFHEIV0
 24947     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24949     MOVE X'2020233030303230393937' TO DFHEIV0(25:11)
 24950     CALL 'kxdfhei1' USING DFHEIV0,
 24951           PGM-NAME,
 24952           ERROR-MESSAGE-INTERFACE-BLOCK,
 24953           EMI-COMM-LENGTH,
 24954           DFHEIV99,
 24955           DFHEIV99,
 24956           DFHEIV99,
 24957           DFHEIV99
 24958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24959
 24960
 24961 9900-EXIT.
 24962     EXIT.
 24963
 24964 9990-ABEND.
 24965     MOVE LINK-EL004             TO PGM-NAME.
 24966     MOVE DFHEIBLK               TO EMI-LINE1.
 24967
 24968* EXEC CICS LINK
 24969*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 461
* EL6311.cbl
 24970*        COMMAREA  (EMI-LINE1)
 24971*        LENGTH    (72)
 24972*    END-EXEC.
 24973     MOVE 72
 24974       TO DFHEIV11
 24975*    MOVE '."C                   (   #00021009' TO DFHEIV0
 24976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24978     MOVE X'2020233030303231303039' TO DFHEIV0(25:11)
 24979     CALL 'kxdfhei1' USING DFHEIV0,
 24980           PGM-NAME,
 24981           EMI-LINE1,
 24982           DFHEIV11,
 24983           DFHEIV99,
 24984           DFHEIV99,
 24985           DFHEIV99,
 24986           DFHEIV99
 24987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24988
 24989
 24990     IF PI-MAP-NAME = EL631B
 24991        MOVE -1                  TO BMAINTL
 24992       ELSE
 24993        MOVE -1                  TO CMAINTL.
 24994
 24995     IF EIBTRNID NOT = TRANS-EXB1
 24996        GO TO 8100-SEND-INITIAL-MAP
 24997       ELSE
 24998        GO TO 8200-SEND-DATAONLY.
 24999
 25000 9995-SECURITY-VIOLATION.
 25001*                            COPY ELCSCTP.
 25002******************************************************************
 25003*                                                                *
 25004*                            ELCSCTP                             *
 25005*                            VMOD=2.001                          *
 25006*                                                                *
 25007*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25008******************************************************************
 25009
 25010
 25011     MOVE EIBDATE          TO SM-JUL-DATE.
 25012     MOVE EIBTRMID         TO SM-TERMID.
 25013     MOVE THIS-PGM         TO SM-PGM.
 25014     MOVE EIBTIME          TO TIME-IN.
 25015     MOVE TIME-OUT         TO SM-TIME.
 25016     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25017
 25018
 25019* EXEC CICS LINK
 25020*         PROGRAM  ('EL003')
 25021*         COMMAREA (SECURITY-MESSAGE)
 25022*         LENGTH   (80)
 25023*    END-EXEC.
 25024     MOVE 'EL003' TO DFHEIV1
 25025     MOVE 80
 25026       TO DFHEIV11
 25027*    MOVE '."C                   (   #00021043' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 462
* EL6311.cbl
 25028     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25030     MOVE X'2020233030303231303433' TO DFHEIV0(25:11)
 25031     CALL 'kxdfhei1' USING DFHEIV0,
 25032           DFHEIV1,
 25033           SECURITY-MESSAGE,
 25034           DFHEIV11,
 25035           DFHEIV99,
 25036           DFHEIV99,
 25037           DFHEIV99,
 25038           DFHEIV99
 25039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25040
 25041
 25042******************************************************************
 25043
 25044
 25045 9999-DFHBACK SECTION.
 25046     MOVE '9%                    "   ' TO DFHEIV0
 25047     MOVE 'EL6311' TO DFHEIV1
 25048     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25049     GOBACK.
 25050 9999-DFHEXIT.
 25051     IF DFHEIGDJ EQUAL 0001
 25052         NEXT SENTENCE
 25053     ELSE IF DFHEIGDJ EQUAL 2
 25054         GO TO 9600-PGMID-ERROR,
 25055               9990-ABEND,
 25056               9990-ABEND,
 25057               0010-MAIN-LOGIC
 25058         DEPENDING ON DFHEIGDI
 25059     ELSE IF DFHEIGDJ EQUAL 3
 25060         GO TO 1280-BATCH-HDR-NOT-FOUND
 25061         DEPENDING ON DFHEIGDI
 25062     ELSE IF DFHEIGDJ EQUAL 4
 25063         GO TO 1290-DUPLICATE-ALT-INDEX
 25064         DEPENDING ON DFHEIGDI
 25065     ELSE IF DFHEIGDJ EQUAL 5
 25066         GO TO 1295-CERT-TRL-REC-NOTFND
 25067         DEPENDING ON DFHEIGDI
 25068     ELSE IF DFHEIGDJ EQUAL 6
 25069         GO TO 1380-BATCH-HDR-NOT-FOUND
 25070         DEPENDING ON DFHEIGDI
 25071     ELSE IF DFHEIGDJ EQUAL 7
 25072         GO TO 1385-REC-NOT-FOUND
 25073         DEPENDING ON DFHEIGDI
 25074     ELSE IF DFHEIGDJ EQUAL 8
 25075         GO TO 1386-NOTFND
 25076         DEPENDING ON DFHEIGDI
 25077     ELSE IF DFHEIGDJ EQUAL 9
 25078         GO TO 1399-EXIT
 25079         DEPENDING ON DFHEIGDI
 25080     ELSE IF DFHEIGDJ EQUAL 10
 25081         GO TO 1480-BATCH-HDR-NOT-FOUND
 25082         DEPENDING ON DFHEIGDI
 25083     ELSE IF DFHEIGDJ EQUAL 11
 25084         GO TO 1490-RECORD-NOT-FOUND
 25085         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 463
* EL6311.cbl
 25086     ELSE IF DFHEIGDJ EQUAL 12
 25087         GO TO 1405-DELETE-CERTIFICATE
 25088         DEPENDING ON DFHEIGDI
 25089     ELSE IF DFHEIGDJ EQUAL 13
 25090         GO TO 1420-CONTINUE-DELETE
 25091         DEPENDING ON DFHEIGDI
 25092     ELSE IF DFHEIGDJ EQUAL 14
 25093         GO TO 1406-DELETE-ERNOTE
 25094         DEPENDING ON DFHEIGDI
 25095     ELSE IF DFHEIGDJ EQUAL 15
 25096         GO TO 1407-DELETE-MAILING
 25097         DEPENDING ON DFHEIGDI
 25098     ELSE IF DFHEIGDJ EQUAL 16
 25099         GO TO 1420-CONTINUE-DELETE
 25100         DEPENDING ON DFHEIGDI
 25101     ELSE IF DFHEIGDJ EQUAL 17
 25102         GO TO 1480-BATCH-HDR-NOT-FOUND
 25103         DEPENDING ON DFHEIGDI
 25104     ELSE IF DFHEIGDJ EQUAL 18
 25105         GO TO 1475-DELETE-FINISHED
 25106         DEPENDING ON DFHEIGDI
 25107     ELSE IF DFHEIGDJ EQUAL 19
 25108         GO TO 2280-BATCH-HDR-NOT-FOUND
 25109         DEPENDING ON DFHEIGDI
 25110     ELSE IF DFHEIGDJ EQUAL 20
 25111         GO TO 2290-DUPLICATE-ALT-INDEX
 25112         DEPENDING ON DFHEIGDI
 25113     ELSE IF DFHEIGDJ EQUAL 21
 25114         GO TO 2380-BATCH-HDR-NOT-FOUND
 25115         DEPENDING ON DFHEIGDI
 25116     ELSE IF DFHEIGDJ EQUAL 22
 25117         GO TO 2385-REC-NOT-FOUND
 25118         DEPENDING ON DFHEIGDI
 25119     ELSE IF DFHEIGDJ EQUAL 23
 25120         GO TO 2380-BATCH-HDR-NOT-FOUND
 25121         DEPENDING ON DFHEIGDI
 25122     ELSE IF DFHEIGDJ EQUAL 24
 25123         GO TO 2485-BATCH-HDR-NOT-FOUND
 25124         DEPENDING ON DFHEIGDI
 25125     ELSE IF DFHEIGDJ EQUAL 25
 25126         GO TO 2490-RECORD-NOT-FOUND
 25127         DEPENDING ON DFHEIGDI
 25128     ELSE IF DFHEIGDJ EQUAL 26
 25129         GO TO 2475-CONTINUE-DELETE
 25130         DEPENDING ON DFHEIGDI
 25131     ELSE IF DFHEIGDJ EQUAL 27
 25132         GO TO 2485-BATCH-HDR-NOT-FOUND
 25133         DEPENDING ON DFHEIGDI
 25134     ELSE IF DFHEIGDJ EQUAL 28
 25135         GO TO 2480-DELETE-FINISHED
 25136         DEPENDING ON DFHEIGDI
 25137     ELSE IF DFHEIGDJ EQUAL 29
 25138         GO TO 2920-PROCESS-REWRITE
 25139         DEPENDING ON DFHEIGDI
 25140     ELSE IF DFHEIGDJ EQUAL 30
 25141         GO TO 2985-RECORD-MISSING
 25142         DEPENDING ON DFHEIGDI
 25143     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 464
* EL6311.cbl
 25144         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25145         DEPENDING ON DFHEIGDI
 25146     ELSE IF DFHEIGDJ EQUAL 32
 25147         GO TO 2990-DUPLICATE-RECORD
 25148         DEPENDING ON DFHEIGDI
 25149     ELSE IF DFHEIGDJ EQUAL 33
 25150         GO TO 3590-NOT-FOUND
 25151         DEPENDING ON DFHEIGDI
 25152     ELSE IF DFHEIGDJ EQUAL 34
 25153         GO TO 3690-NOT-FOUND
 25154         DEPENDING ON DFHEIGDI
 25155     ELSE IF DFHEIGDJ EQUAL 35
 25156         GO TO 3990-NOT-FOUND
 25157         DEPENDING ON DFHEIGDI
 25158     ELSE IF DFHEIGDJ EQUAL 36
 25159         GO TO 4050-END-RECORDS,
 25160               4050-END-RECORDS
 25161         DEPENDING ON DFHEIGDI
 25162     ELSE IF DFHEIGDJ EQUAL 37
 25163         GO TO 4150-END-BATCH
 25164         DEPENDING ON DFHEIGDI
 25165     ELSE IF DFHEIGDJ EQUAL 38
 25166         GO TO 4150-END-BATCH
 25167         DEPENDING ON DFHEIGDI
 25168     ELSE IF DFHEIGDJ EQUAL 39
 25169         GO TO 4250-END-RECORDS,
 25170               4250-END-RECORDS
 25171         DEPENDING ON DFHEIGDI
 25172     ELSE IF DFHEIGDJ EQUAL 40
 25173         GO TO 4350-END-BATCH,
 25174               4350-END-BATCH
 25175         DEPENDING ON DFHEIGDI
 25176     ELSE IF DFHEIGDJ EQUAL 41
 25177         GO TO 4570-NOT-FOUND,
 25178               4550-END-RECORDS
 25179         DEPENDING ON DFHEIGDI
 25180     ELSE IF DFHEIGDJ EQUAL 42
 25181         GO TO 4680-NOT-FOUND,
 25182               4680-NOT-FOUND
 25183         DEPENDING ON DFHEIGDI
 25184     ELSE IF DFHEIGDJ EQUAL 43
 25185         GO TO 4860-NOT-FOUND,
 25186               4850-END-RECORDS
 25187         DEPENDING ON DFHEIGDI
 25188     ELSE IF DFHEIGDJ EQUAL 44
 25189         GO TO 4970-NOT-FOUND,
 25190               4950-END-RECORDS
 25191         DEPENDING ON DFHEIGDI
 25192     ELSE IF DFHEIGDJ EQUAL 45
 25193         GO TO 5050-NOT-FOUND
 25194         DEPENDING ON DFHEIGDI
 25195     ELSE IF DFHEIGDJ EQUAL 46
 25196         GO TO 5050-NOT-FOUND
 25197         DEPENDING ON DFHEIGDI
 25198     ELSE IF DFHEIGDJ EQUAL 47
 25199         GO TO 5050-NOT-FOUND
 25200         DEPENDING ON DFHEIGDI
 25201     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:32 Page 465
* EL6311.cbl
 25202         GO TO 5550-END-RECORDS,
 25203               5550-END-RECORDS
 25204         DEPENDING ON DFHEIGDI
 25205     ELSE IF DFHEIGDJ EQUAL 49
 25206         GO TO 6050-QID-ERROR
 25207         DEPENDING ON DFHEIGDI
 25208     ELSE IF DFHEIGDJ EQUAL 50
 25209         GO TO 6050-QID-ERROR
 25210         DEPENDING ON DFHEIGDI
 25211     ELSE IF DFHEIGDJ EQUAL 51
 25212         GO TO 6400-CONTINUE,
 25213               6400-CONTINUE
 25214         DEPENDING ON DFHEIGDI
 25215     ELSE IF DFHEIGDJ EQUAL 52
 25216         GO TO 3690-NOT-FOUND
 25217         DEPENDING ON DFHEIGDI
 25218     ELSE IF DFHEIGDJ EQUAL 53
 25219         GO TO 7399-EXIT
 25220         DEPENDING ON DFHEIGDI
 25221     ELSE IF DFHEIGDJ EQUAL 54
 25222         GO TO 7550-OFFICER-NOTFND
 25223         DEPENDING ON DFHEIGDI
 25224     ELSE IF DFHEIGDJ EQUAL 55
 25225         GO TO 8300-SEND-TEXT
 25226         DEPENDING ON DFHEIGDI.
 25227     MOVE '9%                    "   ' TO DFHEIV0
 25228     MOVE 'EL6311' TO DFHEIV1
 25229     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25230     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16636     Code:       99384
