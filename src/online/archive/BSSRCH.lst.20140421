* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   1
* BSSRCH.cbl
* Options: int("BSSRCH.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("BSSRCH.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"BSSRCH.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"BSSRCH.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2013 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. BSSRCH.
     9*
    10*AUTHOR.    Pablo.
    11*           Colleyville, TEXAS.
    12********************************************
    13*   Balance sheet for month end balancing
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   2
* BSSRCH.cbl
    14********************************************
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 082013  CR2013060600001  PEMA  ADJ TOL TO 10% FOR NON-PROC
    24* 100813  IR2013100100001  PEMA INCREASE NON-PROC REF TOL
    25* 101713  CR2013060600001  PEMA AUTOMATE AHL MORT RESERVE CALC
    26* 031714  IR2014030200002  PEMA INCREASE NON-PROC REF TOL
    27 environment division.
    28 INPUT-OUTPUT SECTION.
    29 FILE-CONTROL.
    30 SELECT CID-ECS010-IN ASSIGN TO
    31    '/data/seqfiles/cilgm15.ECS010.ME50.BAL.AMTS'
    32    FILE STATUS IS ECS010-STATUS.
    33 SELECT AHL-ECS080-IN ASSIGN TO
    34    '/data/seqfiles/ahlgm17.ECS080.ME.BAL.AMTS'
    35    FILE STATUS IS ECS080-STATUS.
    36 SELECT AHL-ECS010-IN ASSIGN TO
    37    '/data/seqfiles/ahlgm15.ECS010.ME50.BAL.AMTS'
    38    FILE STATUS IS ECS010-STATUS.
    39 SELECT DCC-ECS010-IN ASSIGN TO
    40    '/data/seqfiles/cidclgm15.ECS010.ME50.BAL.AMTS'
    41    FILE STATUS IS ECS010-STATUS.
    42 SELECT CID-CHKPOINT-OUT ASSIGN TO
    43    '/data/seqfiles/cidmechkpts.txt'
    44    FILE STATUS IS CHKPNT-STATUS
    45                            ORGANIZATION IS LINE SEQUENTIAL.
    46 SELECT ahl-CHKPOINT-OUT ASSIGN TO
    47   '/data/seqfiles/ahlmechkpts.txt'
    48    FILE STATUS IS CHKPNT-STATUS
    49                            ORGANIZATION IS LINE SEQUENTIAL.
    50 SELECT dcc-CHKPOINT-OUT ASSIGN TO
    51    '/data/seqfiles/dccmechkpts.txt'
    52    FILE STATUS IS CHKPNT-STATUS
    53                            ORGANIZATION IS LINE SEQUENTIAL.
    54 data division.
    55 FILE SECTION.
    56 FD  CID-ECS010-IN
    57     BLOCK CONTAINS 0
    58     RECORDING MODE F.
    59 01  CID-ECS010-IN-REC           pic x(94).
    60 FD  AHL-ECS010-IN
    61     BLOCK CONTAINS 0
    62     RECORDING MODE F.
    63 01  AHL-ECS010-IN-REC           pic x(94).
    64 FD  AHL-ECS080-IN
    65     BLOCK CONTAINS 0
    66     RECORDING MODE F.
    67 01  AHL-ECS080-IN-REC           pic x(46).
    68 FD  DCC-ECS010-IN
    69     BLOCK CONTAINS 0
    70     RECORDING MODE F.
    71 01  DCC-ECS010-IN-REC           pic x(94).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   3
* BSSRCH.cbl
    72 FD  cid-CHKPOINT-OUT
    73     BLOCK CONTAINS 0
    74     RECORDING MODE F.
    75 01  cid-CHKPOINT-OUT-REC        pic x(94).
    76 FD  ahl-CHKPOINT-OUT
    77     BLOCK CONTAINS 0
    78     RECORDING MODE F.
    79 01  ahl-CHKPOINT-OUT-REC        pic x(94).
    80 FD  dcc-CHKPOINT-OUT
    81     BLOCK CONTAINS 0
    82     RECORDING MODE F.
    83 01  dcc-CHKPOINT-OUT-REC        pic x(94).
    84 working-storage section.
    85 01  DFH-START PIC X(04).
    86 77  s1 pic s999 comp-3 value +0.
    87 77  s2 pic s999 comp-3 value +0.
    88 77  ws-pass-amount              pic s9(11) comp-3 value +0.
    89 77  ws-low-amount               pic s9(11) value zeros.
    90 77  ws-hi-amount                pic s9(11) value zeros.
    91 77  ws-low-pct                  pic s9v9(4) value zeros comp-3.
    92 77  ws-high-pct                 pic s9v9(4) value zeros comp-3.
    93************************************************
    94* commarea passed to the business logic
    95************************************************
    96 01  srch-commarea.
    97*                                copy BSSRCH-COMMAREA.
    98*****************************************************************
    99*                                                               *
   100* Copyright (c) 2013 by CSO.                                    *
   101* All rights reserved.                                          *
   102*                                                               *
   103*****************************************************************
   104****************************************
   105*  commarea for QUERY by eom date and company id
   106*  (business logic input & output)
   107****************************************
   108     03  bl-input.
   109         05  bl-input-eom-date   pic x(10).
   110         05  bl-input-comp-id    pic xxx.
   111         05  bl-input-lo-resv    pic 9(9).
   112         05  bl-input-hi-resv    pic 9(9).
   113         05  bl-input-bld-file   pic xxx.
   114     03  bl-output.
   115         05  bl-status           pic x.
   116             88  bl-ok                 value "p".
   117             88  bl-fail               value "f".
   118         05  bl-output-message   pic x(50).
   119         05  bl-output-record.
   120            07  bl-out-company-name
   121                                 pic x(30).
   122            07  bl-out-formated-date
   123                                 pic x(20).
   124            07  filler occurs 3.
   125                09  bl-out-lf-prem  pic s9(9)v99 comp-3 value +0.
   126                09  bl-out-ah-prem  pic s9(9)v99 comp-3 value +0.
   127                09  bl-out-lf-ref   pic s9(9)v99 comp-3 value +0.
   128                09  bl-out-ah-ref   pic s9(9)v99 comp-3 value +0.
   129                09  bl-out-lf-net   pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   4
* BSSRCH.cbl
   130                09  bl-out-ah-net   pic s9(9)v99 comp-3 value +0.
   131                09  bl-out-lf-iss-com
   132                                    pic s9(9)v99 comp-3 value +0.
   133                09  bl-out-ah-iss-com
   134                                    pic s9(9)v99 comp-3 value +0.
   135                09  bl-out-lf-ref-com
   136                                    pic s9(9)v99 comp-3 value +0.
   137                09  bl-out-ah-ref-com
   138                                    pic s9(9)v99 comp-3 value +0.
   139                09  bl-out-lf-net-com
   140                                    pic s9(9)v99 comp-3 value +0.
   141                09  bl-out-ah-net-com
   142                                    pic s9(9)v99 comp-3 value +0.
   143                09  bl-out-iss-com  pic s9(9)v99 comp-3 value +0.
   144                09  bl-out-ref-com  pic s9(9)v99 comp-3 value +0.
   145                09  bl-out-net-com  pic s9(9)v99 comp-3 value +0.
   146                09  bl-out-iss-cnt  pic s9(9)    comp-3 value +0.
   147                09  bl-out-can-cnt  pic s9(9)    comp-3 value +0.
   148                09  bl-out-net-cnt  pic s9(9)    comp-3 value +0.
   149                09  bl-out-tot-prm  pic s9(9)v99 comp-3 value +0.
   150                09  bl-out-tot-ref  pic s9(9)v99 comp-3 value +0.
   151                09  bl-out-net-tot  pic s9(9)v99 comp-3 value +0.
   152            07  bl-out-cm-cnt    pic s9(9)     comp-3 value +0.
   153            07  bl-out-lf-clms-pd
   154                                 pic s9(9)v99  comp-3 value +0.
   155            07  bl-out-lf-clms-void
   156                                 pic s9(9)v99  comp-3 value +0.
   157            07  bl-out-lf-tot-clms
   158                                 pic s9(9)v99  comp-3 value +0.
   159            07  bl-out-ah-clms-pd
   160                                 pic s9(9)v99  comp-3 value +0.
   161            07  bl-out-ah-clms-void
   162                                 pic s9(9)v99  comp-3 value +0.
   163            07  bl-out-ah-tot-clms
   164                                 pic s9(9)v99  comp-3 value +0.
   165            07  bl-out-clms-pd   pic s9(9)v99  comp-3 value +0.
   166            07  bl-out-clms-void pic s9(9)v99  comp-3 value +0.
   167            07  bl-out-tot-clms  pic s9(9)v99  comp-3 value +0.
   168            07  bl-out-lf-clms-cur
   169                                 pic s9(9)v99  comp-3 value +0.
   170            07  bl-out-ah-clms-cur
   171                                 pic s9(9)v99  comp-3 value +0.
   172            07  bl-out-tot-clms-cur
   173                                 pic s9(9)v99  comp-3 value +0.
   174*                                copy ELCFUNDT.
   175*****************************************************************
   176*                                                               *
   177*                            ELCFUNDT.                          *
   178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   179*                            VMOD=2.001                         *
   180*                                                               *
   181*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   182*                                                               *
   183*****************************************************************
   184
   185
   186 01  FUNCTION-DATE.
   187     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   5
* BSSRCH.cbl
   188     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   189         10  WS-FN-CCYR            PIC 9(4).
   190         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   191             15  WS-FN-CC          PIC 99.
   192             15  WS-FN-YR          PIC 99.
   193         10  WS-FN-MO              PIC 99.
   194         10  WS-FN-DA              PIC 99.
   195     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   196     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   197     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   198     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   199     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   200         88  WS-BEHIND-GMT                     VALUE '-'.
   201         88  WS-AFTER-GMT                      VALUE '+'.
   202         88  WS-NO-GMT                         VALUE ZERO.
   203     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   204     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   205*                                COPY ELCDATE.
   206******************************************************************
   207*                                                                *
   208*                                                                *
   209*                            ELCDATE.                            *
   210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   211*                            VMOD=2.003
   212*                                                                *
   213*                                                                *
   214*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   215*                 LENGTH = 200                                   *
   216******************************************************************
   217
   218 01  DATE-CONVERSION-DATA.
   219     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   220     12  DC-OPTION-CODE                PIC X.
   221         88  BIN-TO-GREG                VALUE ' '.
   222         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   223         88  EDIT-GREG-TO-BIN           VALUE '2'.
   224         88  YMD-GREG-TO-BIN            VALUE '3'.
   225         88  MDY-GREG-TO-BIN            VALUE '4'.
   226         88  JULIAN-TO-BIN              VALUE '5'.
   227         88  BIN-PLUS-ELAPSED           VALUE '6'.
   228         88  FIND-CENTURY               VALUE '7'.
   229         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   230         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   231         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   232         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   233         88  JULIAN-TO-BIN-3            VALUE 'C'.
   234         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   235         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   236         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   237         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   238         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   239         88  CHECK-LEAP-YEAR            VALUE 'H'.
   240         88  BIN-3-TO-GREG              VALUE 'I'.
   241         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   242         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   243         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   244         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   245         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   6
* BSSRCH.cbl
   246         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   247         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   248         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   249         88  THREE-CHARACTER-BIN
   250                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   251         88  GREGORIAN-TO-BIN
   252                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   253         88  BIN-TO-GREGORIAN
   254                  VALUES ' ' '1' 'I' '8' 'G'.
   255         88  JULIAN-TO-BINARY
   256                  VALUES '5' 'C' 'E' 'F'.
   257     12  DC-ERROR-CODE                 PIC X.
   258         88  NO-CONVERSION-ERROR        VALUE ' '.
   259         88  DATE-CONVERSION-ERROR
   260                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   261         88  DATE-IS-ZERO               VALUE '1'.
   262         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   263         88  DATE-IS-INVALID            VALUE '3'.
   264         88  DATE1-GREATER-DATE2        VALUE '4'.
   265         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   266         88  DATE-INVALID-OPTION        VALUE '9'.
   267         88  INVALID-CENTURY            VALUE 'A'.
   268         88  ONLY-CENTURY               VALUE 'B'.
   269         88  ONLY-LEAP-YEAR             VALUE 'C'.
   270         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   271     12  DC-END-OF-MONTH               PIC X.
   272         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   273     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   274         88  USE-NORMAL-PROCESS         VALUE ' '.
   275         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   276         88  ADJUST-UP-100-YRS          VALUE '2'.
   277     12  FILLER                        PIC X.
   278     12  DC-CONVERSION-DATES.
   279         16  DC-BIN-DATE-1             PIC XX.
   280         16  DC-BIN-DATE-2             PIC XX.
   281         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   282         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   283                       DC-GREG-DATE-1-EDIT.
   284             20  DC-EDIT1-MONTH        PIC 99.
   285             20  SLASH1-1              PIC X.
   286             20  DC-EDIT1-DAY          PIC 99.
   287             20  SLASH1-2              PIC X.
   288             20  DC-EDIT1-YEAR         PIC 99.
   289         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   290         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   291                     DC-GREG-DATE-2-EDIT.
   292             20  DC-EDIT2-MONTH        PIC 99.
   293             20  SLASH2-1              PIC X.
   294             20  DC-EDIT2-DAY          PIC 99.
   295             20  SLASH2-2              PIC X.
   296             20  DC-EDIT2-YEAR         PIC 99.
   297         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   298         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   299                     DC-GREG-DATE-1-YMD.
   300             20  DC-YMD-YEAR           PIC 99.
   301             20  DC-YMD-MONTH          PIC 99.
   302             20  DC-YMD-DAY            PIC 99.
   303         16  DC-GREG-DATE-1-MDY        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   7
* BSSRCH.cbl
   304         16  DC-GREG-DATE-1-MDY-R REDEFINES
   305                      DC-GREG-DATE-1-MDY.
   306             20  DC-MDY-MONTH          PIC 99.
   307             20  DC-MDY-DAY            PIC 99.
   308             20  DC-MDY-YEAR           PIC 99.
   309         16  DC-GREG-DATE-1-ALPHA.
   310             20  DC-ALPHA-MONTH        PIC X(10).
   311             20  DC-ALPHA-DAY          PIC 99.
   312             20  FILLER                PIC XX.
   313             20  DC-ALPHA-CENTURY.
   314                 24 DC-ALPHA-CEN-N     PIC 99.
   315             20  DC-ALPHA-YEAR         PIC 99.
   316         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   317         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   318         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   319         16  DC-JULIAN-DATE            PIC 9(05).
   320         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   321                                       PIC 9(05).
   322         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   323             20  DC-JULIAN-YEAR        PIC 99.
   324             20  DC-JULIAN-DAYS        PIC 999.
   325         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   326         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   327         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   328     12  DATE-CONVERSION-VARIBLES.
   329         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   330         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   331             20  FILLER                PIC 9(3).
   332             20  HOLD-CEN-1-CCYY.
   333                 24  HOLD-CEN-1-CC     PIC 99.
   334                 24  HOLD-CEN-1-YY     PIC 99.
   335             20  HOLD-CEN-1-MO         PIC 99.
   336             20  HOLD-CEN-1-DA         PIC 99.
   337         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   338             20  HOLD-CEN-1-R-MO       PIC 99.
   339             20  HOLD-CEN-1-R-DA       PIC 99.
   340             20  HOLD-CEN-1-R-CCYY.
   341                 24  HOLD-CEN-1-R-CC   PIC 99.
   342                 24  HOLD-CEN-1-R-YY   PIC 99.
   343             20  FILLER                PIC 9(3).
   344         16  HOLD-CENTURY-1-X.
   345             20  FILLER                PIC X(3)  VALUE SPACES.
   346             20  HOLD-CEN-1-X-CCYY.
   347                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   348                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   349             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   350             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   351         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   352             20  HOLD-CEN-1-R-X-MO     PIC XX.
   353             20  HOLD-CEN-1-R-X-DA     PIC XX.
   354             20  HOLD-CEN-1-R-X-CCYY.
   355                 24  HOLD-CEN-1-R-X-CC PIC XX.
   356                 24  HOLD-CEN-1-R-X-YY PIC XX.
   357             20  FILLER                PIC XXX.
   358         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   359         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   360         16  DC-JULIAN-DATE-1          PIC 9(07).
   361         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   8
* BSSRCH.cbl
   362             20  DC-JULIAN-1-CCYY.
   363                 24  DC-JULIAN-1-CC    PIC 99.
   364                 24  DC-JULIAN-1-YR    PIC 99.
   365             20  DC-JULIAN-DA-1        PIC 999.
   366         16  DC-JULIAN-DATE-2          PIC 9(07).
   367         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   368             20  DC-JULIAN-2-CCYY.
   369                 24  DC-JULIAN-2-CC    PIC 99.
   370                 24  DC-JULIAN-2-YR    PIC 99.
   371             20  DC-JULIAN-DA-2        PIC 999.
   372         16  DC-GREG-DATE-A-EDIT.
   373             20  DC-EDITA-MONTH        PIC 99.
   374             20  SLASHA-1              PIC X VALUE '/'.
   375             20  DC-EDITA-DAY          PIC 99.
   376             20  SLASHA-2              PIC X VALUE '/'.
   377             20  DC-EDITA-CCYY.
   378                 24  DC-EDITA-CENT     PIC 99.
   379                 24  DC-EDITA-YEAR     PIC 99.
   380         16  DC-GREG-DATE-B-EDIT.
   381             20  DC-EDITB-MONTH        PIC 99.
   382             20  SLASHB-1              PIC X VALUE '/'.
   383             20  DC-EDITB-DAY          PIC 99.
   384             20  SLASHB-2              PIC X VALUE '/'.
   385             20  DC-EDITB-CCYY.
   386                 24  DC-EDITB-CENT     PIC 99.
   387                 24  DC-EDITB-YEAR     PIC 99.
   388         16  DC-GREG-DATE-CYMD         PIC 9(08).
   389         16  DC-GREG-DATE-CYMD-R REDEFINES
   390                              DC-GREG-DATE-CYMD.
   391             20  DC-CYMD-CEN           PIC 99.
   392             20  DC-CYMD-YEAR          PIC 99.
   393             20  DC-CYMD-MONTH         PIC 99.
   394             20  DC-CYMD-DAY           PIC 99.
   395         16  DC-GREG-DATE-MDCY         PIC 9(08).
   396         16  DC-GREG-DATE-MDCY-R REDEFINES
   397                              DC-GREG-DATE-MDCY.
   398             20  DC-MDCY-MONTH         PIC 99.
   399             20  DC-MDCY-DAY           PIC 99.
   400             20  DC-MDCY-CEN           PIC 99.
   401             20  DC-MDCY-YEAR          PIC 99.
   402    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   403        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   404    12  DC-EL310-DATE                  PIC X(21).
   405    12  FILLER                         PIC X(28).
   406* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   407*     'BEGINJOB mode=''MVS'''.
   408* 01  TRAN-DATA-LINE2             PIC X(80)    VALUE
   409*     'LABEL name=PERL1'.
   410* 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   411*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   412* 01  TRAN-DATA-LINE4             PIC X(80)    VALUE
   413*     'perl /export/home/pema/bin/bal_sheet_ss.pl $SEQFILES/a1.txt
   414*-    '$SEQFILES/a2.xlsx'
   415* 01  TRAN-DATA-LINE5             PIC X(80)    VALUE '!'.
   416* 01  TRAN-DATA-LINE6             PIC X(80)    VALUE
   417*    'EXECPGM pgmname=''BPXBATCH'' stepname=''PERL1'' parm=''SH'''
   418* 01  TRAN-DATA-LINE7             PIC X(80)    VALUE
   419*     'LABEL name=EMAIL'.
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page   9
* BSSRCH.cbl
   420* 01  TRAN-DATA-LINE8             PIC X(80)    VALUE
   421*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   422* 01  TRAN-DATA-LINE9             PIC X(80)    VALUE
   423*     'mutt -s ''AHL chkpts'' -a $SEQFILES/ahlmechkpts.xlsx pema@c
   424*-    'o.com < /dev/null'.
   425* 01  TRAN-DATA-LINE10            PIC X(80)    VALUE '!'.
   426* 01  TRAN-DATA-LINE11            PIC X(80)    VALUE
   427*    'EXECPGM pgmname=''BPXBATCH'' stepname=''EMAIL'' parm=''SH'''
   428* 01  TRAN-DATA-LINE12            PIC X(80)    VALUE
   429*     'ENDJOB'.
   430 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   431     'cd /apps/prod/cid1p/jcl'.
   432 01  TRAN-DATA-LINE2.
   433     05  filler                  pic x(10) value 'unikixjob '.
   434     05  tran-comp-id            pic xxx   value '   '.
   435     05  filler                 pic x(15) value 'chkpts -k cid1p'.
   436     05  filler                  pic x(52) value spaces.
   437 01  ECS010-IN-REC.
   438     05  filler                  pic x(21).
   439     05  ecs010-cert-cnt         pic x(11).
   440     05  filler                  pic x(62).
   441 01  ECS080-IN-REC.
   442     05  filler                  pic x(21).
   443     05  ecs080-mort-resv        pic x(11).
   444     05  filler                  pic x(14).
   445 01  cpo-out-record.
   446     05  cpo-jobname             pic x(10)  value spaces.
   447     05  f                       pic x value ';'.
   448     05  cpo-stepname            pic x(6)   value spaces.
   449     05  f                       pic x value ';'.
   450     05  cpo-low-amount          pic -9(9)  value zeros.
   451     05  f                       pic x value ';'.
   452     05  cpo-hi-amount           pic -9(9)  value zeros.
   453     05  f                       pic x value ';'.
   454     05  cpo-desc                pic x(50)  value spaces.
   455 01  ahl-table.
   456     05 f                        pic x(68) value
   457         'AHLGM10   ;EL524 ;Total Claims Paid
   458-        '            '.
   459     05 f                        pic x(68) value
   460         'AHLGM10   ;EL523 ;Processable Written & Outstanding Bala
   461-        'nce         '.
   462     05 f                        pic x(68) value
   463         'AHLGM10   ;EL523 ;Non-Processable Written & Outstanding
   464-        'Balance     '.
   465     05 f                        pic x(68) value
   466         'AHLGM10   ;EL523 ;Total Written & Outstanding Balance
   467-        '            '.
   468     05 f                        pic x(68) value
   469         'AHLGM10   ;EL523 ;Processable Cancelled
   470-        '            '.
   471     05 f                        pic x(68) value
   472         'AHLGM10   ;EL523 ;Non-Processable Cancelled
   473-        '            '.
   474     05 f                        pic x(68) value
   475         'AHLGM10   ;EL523 ;Total Cancelled
   476-        '            '.
   477     05 f                        pic x(68) value
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  10
* BSSRCH.cbl
   478         'AHLGM10   ;EL523 ;Processable Net Premium
   479-        '            '.
   480     05 f                        pic x(68) value
   481         'AHLGM10   ;EL523 ;Non-Processable Net Premium
   482-        '            '.
   483     05 f                        pic x(68) value
   484         'AHLGM10   ;EL523 ;Total Net Premium
   485-        '            '.
   486     05 f                        pic x(68) value
   487         'AHLGM10   ;EL523 ;Processable Net Commission
   488-        '            '.
   489     05 f                        pic x(68) value
   490         'AHLGM10   ;EL523 ;Non-Processable Net Commission
   491-        '            '.
   492     05 f                        pic x(68) value
   493         'AHLGM10   ;EL523 ;Total Net Commission
   494-        '            '.
   495     05 f                        pic x(68) value
   496         'AHLGM15   ;ECS010;Life Claims Paid
   497-        '            '.
   498     05 f                        pic x(68) value
   499         'AHLGM15   ;ECS010;A&H Claims Paid
   500-        '            '.
   501     05 f                        pic x(68) value
   502         'AHLGM15   ;ECS010;Output Certificate Master Records Prio
   503-        'r Month     '.
   504     05 f                        pic x(68) value
   505         'AHLGM17   ;ECS080;Gross Reserve
   506-        '            '.
   507 01  dcc-table.
   508     05 f                        pic x(68) value
   509         'CIDCLGM10 ;EL524 ;Total Claims Paid
   510-        '            '.
   511     05 f                        pic x(68) value
   512         'CIDCLGM10 ;EL523 ;Processable Written & Outstanding Bala
   513-        'nce         '.
   514     05 f                        pic x(68) value
   515         'CIDCLGM10 ;EL523 ;Non-Processable Written & Outstanding
   516-        'Balance     '.
   517     05 f                        pic x(68) value
   518         'CIDCLGM10 ;EL523 ;Total Written & Outstanding Balance
   519-        '            '.
   520     05 f                        pic x(68) value
   521         'CIDCLGM10 ;EL523 ;Processable Cancelled
   522-        '            '.
   523     05 f                        pic x(68) value
   524         'CIDCLGM10 ;EL523 ;Non-Processable Cancelled
   525-        '            '.
   526     05 f                        pic x(68) value
   527         'CIDCLGM10 ;EL523 ;Total Cancelled
   528-        '            '.
   529     05 f                        pic x(68) value
   530         'CIDCLGM10 ;EL523 ;Processable Net Premium
   531-        '            '.
   532     05 f                        pic x(68) value
   533         'CIDCLGM10 ;EL523 ;Non-Processable Net Premium
   534-        '            '.
   535     05 f                        pic x(68) value
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  11
* BSSRCH.cbl
   536         'CIDCLGM10 ;EL523 ;Total Net Premium
   537-        '            '.
   538     05 f                        pic x(68) value
   539         'CIDCLGM10 ;EL523 ;Processable Net Commission
   540-        '            '.
   541     05 f                        pic x(68) value
   542         'CIDCLGM10 ;EL523 ;Non-Processable Net Commission
   543-        '            '.
   544     05 f                        pic x(68) value
   545         'CIDCLGM10 ;EL523 ;Total Net Commission
   546-        '            '.
   547     05 f                        pic x(68) value
   548         'CIDCLGM15 ;ECS010;Life Claims Paid
   549-        '            '.
   550     05 f                        pic x(68) value
   551         'CIDCLGM15 ;ECS010;A&H Claims Paid
   552-        '            '.
   553     05 f                        pic x(68) value
   554         'CIDCLGM15 ;ECS010;Output Certificate Master Records Prio
   555-        'r Month     '.
   556     05 f                        pic x(68) value
   557         'CIDCLGM17 ;ECS080;Gross Reserve
   558-        '            '.
   559 01  cid-table.
   560     05 f                        pic x(68) value
   561         'CILGM10   ;EL524 ;Total Claims Paid
   562-        '            '.
   563     05 f                        pic x(68) value
   564         'CILGM10   ;EL523 ;Processable Written & Outstanding Bala
   565-        'nce         '.
   566     05 f                        pic x(68) value
   567         'CILGM10   ;EL523 ;Non-Processable Written & Outstanding
   568-        'Balance     '.
   569     05 f                        pic x(68) value
   570         'CILGM10   ;EL523 ;Total Written & Outstanding Balance
   571-        '            '.
   572     05 f                        pic x(68) value
   573         'CILGM10   ;EL523 ;Processable Cancelled
   574-        '            '.
   575     05 f                        pic x(68) value
   576         'CILGM10   ;EL523 ;Non-Processable Cancelled
   577-        '            '.
   578     05 f                        pic x(68) value
   579         'CILGM10   ;EL523 ;Total Cancelled
   580-        '            '.
   581     05 f                        pic x(68) value
   582         'CILGM10   ;EL523 ;Processable Net Premium
   583-        '            '.
   584     05 f                        pic x(68) value
   585         'CILGM10   ;EL523 ;Non-Processable Net Premium
   586-        '            '.
   587     05 f                        pic x(68) value
   588         'CILGM10   ;EL523 ;Total Net Premium
   589-        '            '.
   590     05 f                        pic x(68) value
   591         'CILGM10   ;EL523 ;Processable Net Commission
   592-        '            '.
   593     05 f                        pic x(68) value
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  12
* BSSRCH.cbl
   594         'CILGM10   ;EL523 ;Non-Processable Net Commission
   595-        '            '.
   596     05 f                        pic x(68) value
   597         'CILGM10   ;EL523 ;Total Net Commission
   598-        '            '.
   599     05 f                        pic x(68) value
   600         'CILGM15   ;ECS010;Life Claims Paid
   601-        '            '.
   602     05 f                        pic x(68) value
   603         'CILGM15   ;ECS010;A&H Claims Paid
   604-        '            '.
   605     05 f                        pic x(68) value
   606         'CILGM15   ;ECS010;Output Certificate Master Records Prio
   607-        'r Month     '.
   608     05 f                        pic x(68) value
   609         'CILGM17   ;ECS080;Gross Reserve
   610-        '            '.
   611 01  filler redefines cid-table.
   612     05  filler occurs 17.
   613         10  tbl-jobname             pic x(10).
   614         10  f                       pic x.
   615         10  tbl-stepname            pic x(6).
   616         10  f                       pic x.
   617         10  tbl-desc                pic x(50).
   618 01  filler.
   619     05  filler occurs 17.
   620         10  tbl-low-amount      pic s9(9).
   621         10  tbl-hi-amount       pic s9(9).
   622************************************
   623* fields used to read web data
   624************************************
   625 01  w-form-name       pic x(80).
   626 01  w-form-value      pic x(80).
   627 01  w-form-name-len   pic s9(8) comp.
   628 01  w-form-value-len  pic s9(8) comp.
   629 01  w-resp            pic s9(8) comp.
   630 01  w-doctoken        pic x(16).
   631 01  filler.
   632     05  ECS010-STATUS           PIC XX VALUE ZEROS.
   633     05  ECS080-STATUS           PIC XX VALUE ZEROS.
   634     05  CHKPNT-STATUS           pic xx value zeros.
   635     05  work-cert-cnt           pic x(11).
   636     05  numeric-cert-cnt        pic 9(9).
   637     05  work-mort-resv          pic x(11).
   638     05  work-mort-resv-lo       pic x(11).
   639     05  work-mort-resv-hi       pic x(11).
   640     05  numeric-mort-resv       pic 9(9).
   641*****************************************
   642* symbol list for the BSDETAIL template
   643*****************************************
   644 01 output-data.
   645    05  filler                   pic x(7) value"COMPID=".
   646    05  out-comp-id              pic xxx.
   647    05  filler                   pic x(8) value"&EOMDTE=".
   648    05  out-eom-date             pic x(10).
   649    05  filler                   pic x(9) value"&COMPNME=".
   650    05  out-comp-name            pic x(30).
   651    05  filler                   pic x(7) value"&FDATE=".
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  13
* BSSRCH.cbl
   652    05  out-format-date          pic x(20).
   653    05  filler                   pic x(10) value"&LFISSPRM=".
   654    05  out-lf-iss-prem          pic zz,z99,999.99.
   655    05  filler                   pic x(10) value"&LFREFPRM=".
   656    05  out-lf-ref-prem          pic zz,z99,999.99.
   657    05  filler                   pic x(10) value"&LFNETPRM=".
   658    05  out-lf-net-prem          pic -zz,zz9,999.99.
   659    05  filler                   pic x(10) value"&AHISSPRM=".
   660    05  out-ah-iss-prem          pic zz,zz9,999.99.
   661    05  filler                   pic x(10) value"&AHREFPRM=".
   662    05  out-ah-ref-prem          pic zz,z99,999.99.
   663    05  filler                   pic x(10) value"&AHNETPRM=".
   664    05  out-ah-net-prem          pic -zz,z99,999.99.
   665    05  filler                   pic x(10) value"&LFISSCOM=".
   666    05  out-lf-iss-comm          pic zz,zz9,999.99.
   667    05  filler                   pic x(10) value"&LFREFCOM=".
   668    05  out-lf-ref-comm          pic zz,zz9,999.99.
   669    05  filler                   pic x(10) value"&LFNETCOM=".
   670    05  out-lf-net-comm          pic -zz,zz9,999.99.
   671    05  filler                   pic x(10) value"&AHISSCOM=".
   672    05  out-ah-iss-comm          pic zz,zzz,999.99.
   673    05  filler                   pic x(10) value"&AHREFCOM=".
   674    05  out-ah-ref-comm          pic zz,z99,999.99.
   675    05  filler                   pic x(10) value"&AHNETCOM=".
   676    05  out-ah-net-comm          pic -zz,z99,999.99.
   677    05  filler                   pic x(9) value "&TOTPREM=".
   678    05  out-tot-prem             pic zz,z99,999.99.
   679    05  filler                   pic x(9) value "&TOTREFS=".
   680    05  out-tot-refs             pic zz,z99,999.99.
   681    05  filler                   pic x(9) value"&TOTNETP=".
   682    05  out-tot-netp             pic -zz,z99,999.99.
   683    05  filler                   pic x(8) value"&ISSCOM=".
   684    05  out-iss-comm             pic zz,zz9,999.99.
   685    05  filler                   pic x(8) value"&REFCOM=".
   686    05  out-ref-comm             pic zz,z99,999.99.
   687    05  filler                   pic x(9) value"&TOTNCOM=".
   688    05  out-net-comm             pic -zz,z99,999.99.
   689    05  filler                   pic x(8) value "&ISSCNT=".
   690    05  out-iss-cnt              pic zzzz,z99.
   691    05  filler                   pic x(8) value "&REFCNT=".
   692    05  out-ref-cnt              pic zzzz,999.
   693    05  filler                   pic x(8) value "&NETCNT=".
   694    05  out-net-cnt              pic -zzzz,999.
   695    05  filler                   pic x(8) value"&LFCLMS=".
   696    05  out-lf-clms-pd           pic zz,z99,999.99.
   697    05  filler                   pic x(9) value"&LFVOIDS=".
   698    05  out-lf-clms-void         pic zz,zz9,999.99.
   699    05  filler                   pic x(11) value"&TOTLFCLMS=".
   700    05  out-lf-tot-clms          pic -zz,z99,999.99.
   701    05  filler                   pic x(8) value"&AHCLMS=".
   702    05  out-ah-clms-pd           pic zz,z99,999.99.
   703    05  filler                   pic x(9) value"&AHVOIDS=".
   704    05  out-ah-clms-void         pic zz,zz9,999.99.
   705    05  filler                   pic x(11) value"&TOTAHCLMS=".
   706    05  out-ah-tot-clms          pic -zz,z99,999.99.
   707    05  filler                   pic x(8) value"&PDCLMS=".
   708    05  out-clms-pd              pic zz,z99,999.99.
   709    05  filler                   pic x(8) value"&VDCLMS=".
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  14
* BSSRCH.cbl
   710    05  out-clms-void            pic zz,z99,999.99.
   711    05  filler                   pic x(9) value"&TOTCLMS=".
   712    05  out-tot-clms             pic -zz,z99,999.99.
   713    05  filler                   pic x(8) value"&LORESV=".
   714    05  out-lo-resv              pic zzz,z99,999.
   715    05  filler                   pic x(8) value"&HIRESV=".
   716    05  out-hi-resv              pic zzz,z99,999.
   717    05  filler                   pic x(8) value"&CRTCNT=".
   718    05  out-crt-cnt              pic z,zz9,999.
   719    05  filler                   pic x(5) value "&MSG=".
   720    05  output-msg               pic x(50).
   721 01 bl-index               pic s9(8) comp.
   722****************************************************************
   723*
   724* Copyright (c) 2007 by Clerity Solutions, Inc.
   725* All rights reserved.
   726*
   727****************************************************************
   728 01  DFHEIV.
   729   02  DFHEIV0               PIC X(35).
   730   02  DFHEIV1               PIC X(08).
   731   02  DFHEIV2               PIC X(08).
   732   02  DFHEIV3               PIC X(08).
   733   02  DFHEIV4               PIC X(06).
   734   02  DFHEIV5               PIC X(04).
   735   02  DFHEIV6               PIC X(04).
   736   02  DFHEIV7               PIC X(02).
   737   02  DFHEIV8               PIC X(02).
   738   02  DFHEIV9               PIC X(01).
   739   02  DFHEIV10              PIC S9(7) COMP-3.
   740   02  DFHEIV11              PIC S9(4) COMP SYNC.
   741   02  DFHEIV12              PIC S9(4) COMP SYNC.
   742   02  DFHEIV13              PIC S9(4) COMP SYNC.
   743   02  DFHEIV14              PIC S9(4) COMP SYNC.
   744   02  DFHEIV15              PIC S9(4) COMP SYNC.
   745   02  DFHEIV16              PIC S9(9) COMP SYNC.
   746   02  DFHEIV17              PIC X(04).
   747   02  DFHEIV18              PIC X(04).
   748   02  DFHEIV19              PIC X(04).
   749   02  DFHEIV20              USAGE IS POINTER.
   750   02  DFHEIV21              USAGE IS POINTER.
   751   02  DFHEIV22              USAGE IS POINTER.
   752   02  DFHEIV23              USAGE IS POINTER.
   753   02  DFHEIV24              USAGE IS POINTER.
   754   02  DFHEIV25              PIC S9(9) COMP SYNC.
   755   02  DFHEIV26              PIC S9(9) COMP SYNC.
   756   02  DFHEIV27              PIC S9(9) COMP SYNC.
   757   02  DFHEIV28              PIC S9(9) COMP SYNC.
   758   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   759   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   760   02  FILLER                PIC X(02).
   761   02  DFHEIV99              PIC X(08) VALUE SPACE.
   762   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   763   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   764   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   765   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   766 LINKAGE  SECTION.
   767*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  15
* BSSRCH.cbl
   768*                                                               *
   769* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   770* All rights reserved.                                          *
   771*                                                               *
   772*****************************************************************
   773 01  dfheiblk.
   774     02  eibtime          pic s9(7) comp-3.
   775     02  eibdate          pic s9(7) comp-3.
   776     02  eibtrnid         pic x(4).
   777     02  eibtaskn         pic s9(7) comp-3.
   778     02  eibtrmid         pic x(4).
   779     02  dfheigdi         pic s9(4) comp.
   780     02  eibcposn         pic s9(4) comp.
   781     02  eibcalen         pic s9(4) comp.
   782     02  eibaid           pic x(1).
   783     02  eibfiller1       pic x(1).
   784     02  eibfn            pic x(2).
   785     02  eibfiller2       pic x(2).
   786     02  eibrcode         pic x(6).
   787     02  eibfiller3       pic x(2).
   788     02  eibds            pic x(8).
   789     02  eibreqid         pic x(8).
   790     02  eibrsrce         pic x(8).
   791     02  eibsync          pic x(1).
   792     02  eibfree          pic x(1).
   793     02  eibrecv          pic x(1).
   794     02  eibsend          pic x(1).
   795     02  eibatt           pic x(1).
   796     02  eibeoc           pic x(1).
   797     02  eibfmh           pic x(1).
   798     02  eibcompl         pic x(1).
   799     02  eibsig           pic x(1).
   800     02  eibconf          pic x(1).
   801     02  eiberr           pic x(1).
   802     02  eibrldbk         pic x(1).
   803     02  eiberrcd         pic x(4).
   804     02  eibsynrb         pic x(1).
   805     02  eibnodat         pic x(1).
   806     02  eibfiller5       pic x(2).
   807     02  eibresp          pic 9(09) comp.
   808     02  eibresp2         pic 9(09) comp.
   809     02  dfheigdj         pic s9(4) comp.
   810     02  dfheigdk         pic s9(4) comp.
   811 01  DFHCOMMAREA       PIC X(01).
   812 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   813 0000-DFHEXIT SECTION.
   814     MOVE '9#                    $   ' TO DFHEIV0.
   815     MOVE 'BSSRCH' TO DFHEIV1.
   816     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   817 0000-begin.
   818     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
   819
   820* exec cics web
   821*       startbr formfield resp(w-resp)
   822*    end-exec
   823*    MOVE 'X(f                   &  N#00000815' TO DFHEIV0
   824     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  16
* BSSRCH.cbl
   826     MOVE X'204E233030303030383135' TO DFHEIV0(25:11)
   827     CALL 'kxdfhei1' USING DFHEIV0,
   828           DFHEIV99,
   829           DFHEIV99,
   830           DFHEIV99,
   831           DFHEIV99,
   832           DFHEIV99
   833     MOVE EIBRESP  TO w-resp
   834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   835     perform 0200-read-form      thru 0200-exit until
   836        w-resp not = 0
   837*   dfhresp(normal)
   838
   839* exec cics web
   840*       endbr formfield
   841*    end-exec
   842*    MOVE 'X,f                   #   #00000820' TO DFHEIV0
   843     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   844     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   845     MOVE X'2020233030303030383230' TO DFHEIV0(25:11)
   846     CALL 'kxdfhei1' USING DFHEIV0,
   847           DFHEIV99,
   848           DFHEIV99
   849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   850     display ' input date   ' bl-input-eom-date
   851     display ' comp id      ' bl-input-comp-id
   852     display ' mort resv lo ' work-mort-resv-lo
   853     display ' mort resv hi ' work-mort-resv-hi
   854     display ' build file   ' bl-input-bld-file
   855     evaluate bl-input-comp-id
   856        when 'AHL'
   857           open input AHL-ECS010-IN
   858           if ecs010-status not = '00'
   859              move ' Cant open AHL ecs010 file '
   860                                 to bl-output-message
   861              go to 0100-send-document
   862           end-if
   863           READ AHL-ECS010-IN into ecs010-in-rec
   864              display ' ecs010 cert cnt ' ecs010-cert-cnt
   865              move ecs010-cert-cnt
   866                                 to work-cert-cnt
   867           close ahl-ecs010-in
   868           open input AHL-ECS080-IN
   869           if ecs080-status not = '00'
   870              move ' Cant open AHL ecs080 file '
   871                                 to bl-output-message
   872              go to 0100-send-document
   873           end-if
   874           READ AHL-ECS080-IN into ecs080-in-rec
   875              display ' ecs080 mort resv ' ecs080-in-rec
   876              move ecs080-mort-resv
   877                                 to work-mort-resv
   878           close ahl-ecs080-in
   879        when 'CID'
   880           open input CID-ECS010-IN
   881           if ecs010-status not = '00'
   882              move ' Cant open AHL ecs010 file '
   883                                 to bl-output-message
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  17
* BSSRCH.cbl
   884              go to 0100-send-document
   885           end-if
   886           READ CID-ECS010-IN into ecs010-in-rec
   887              display ' ecs010 cert cnt ' ecs010-cert-cnt
   888              move ecs010-cert-cnt
   889                                 to work-cert-cnt
   890           close cid-ecs010-in
   891        when 'DCC'
   892           open input DCC-ECS010-IN
   893           if ecs010-status not = '00'
   894              move ' Cant open AHL ecs010 file '
   895                                 to bl-output-message
   896              go to 0100-send-document
   897           end-if
   898           READ DCC-ECS010-IN into ecs010-in-rec
   899              display ' ecs010 cert cnt ' ecs010-cert-cnt
   900              move ecs010-cert-cnt
   901                                 to work-cert-cnt
   902           close dcc-ecs010-in
   903     end-evaluate
   904     move zeros                  to numeric-cert-cnt
   905     inspect work-cert-cnt replacing all spaces by zeros
   906     move +9 to s2
   907     perform varying s1 from +11 by -1 until s1 < +1
   908        if work-cert-cnt (s1:1) numeric
   909           move work-cert-cnt (s1:1)
   910                                 to numeric-cert-cnt (s2:1)
   911           subtract +1 from s2
   912        end-if
   913     end-perform
   914     move numeric-cert-cnt       to bl-out-cm-cnt
   915     if bl-input-comp-id = 'AHL'
   916        display ' work mort reserve  **' work-mort-resv '**'
   917        move zeros               to numeric-mort-resv
   918        inspect work-mort-resv replacing all spaces by zeros
   919        display ' work mort reserve  **' work-mort-resv '**'
   920        move +9 to s2
   921        perform varying s1 from +11 by -1 until s1 < +1
   922           if work-mort-resv (s1:1) numeric
   923              move work-mort-resv (s1:1)
   924                                 to numeric-mort-resv (s2:1)
   925              subtract +1 from s2
   926           end-if
   927        end-perform
   928        move numeric-mort-resv   to bl-input-hi-resv
   929        display ' bl hi reserve ' bl-input-hi-resv
   930        if bl-input-hi-resv < 1000000
   931           move zeros            to bl-input-lo-resv
   932        else
   933           compute bl-input-lo-resv = bl-input-hi-resv - 1000000
   934        end-if
   935        display ' bl lo reserve ' bl-input-lo-resv
   936     else
   937        move zeros               to numeric-mort-resv
   938****    inspect work-mort-resv replacing all spaces by zeros
   939        move +9 to s2
   940        perform varying s1 from +11 by -1 until s1 < +1
   941           if work-mort-resv-lo (s1:1) numeric
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  18
* BSSRCH.cbl
   942              move work-mort-resv-lo (s1:1)
   943                                 to numeric-mort-resv (s2:1)
   944              subtract +1 from s2
   945           end-if
   946        end-perform
   947        move numeric-mort-resv   to bl-input-lo-resv
   948        display ' bl lo reserve ' bl-input-lo-resv
   949        move zeros               to numeric-mort-resv
   950****    inspect work-mort-resv replacing all spaces by zeros
   951        move +9 to s2
   952        perform varying s1 from +11 by -1 until s1 < +1
   953           if work-mort-resv-hi (s1:1) numeric
   954              move work-mort-resv-hi (s1:1)
   955                                 to numeric-mort-resv (s2:1)
   956              subtract +1 from s2
   957           end-if
   958        end-perform
   959        move numeric-mort-resv   to bl-input-hi-resv
   960        display ' bl hi reserve ' bl-input-hi-resv
   961     end-if
   962
   963* exec cics link
   964*       program  ('BSSRCHBL')
   965*       commarea (srch-commarea)
   966*    end-exec
   967     MOVE LENGTH OF
   968      srch-commarea
   969       TO DFHEIV11
   970     MOVE 'BSSRCHBL' TO DFHEIV1
   971*    MOVE '."C                   (   #00000935' TO DFHEIV0
   972     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   974     MOVE X'2020233030303030393335' TO DFHEIV0(25:11)
   975     CALL 'kxdfhei1' USING DFHEIV0,
   976           DFHEIV1,
   977           srch-commarea,
   978           DFHEIV11,
   979           DFHEIV99,
   980           DFHEIV99,
   981           DFHEIV99,
   982           DFHEIV99
   983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   984     .
   985 0100-send-document.
   986***********************************************************
   987* Build output document.
   988***********************************************************
   989     move bl-input-comp-id       to out-comp-id
   990     move bl-input-eom-date      to out-eom-date
   991     move bl-input-lo-resv       to out-lo-resv
   992     move bl-input-hi-resv       to out-hi-resv
   993     move bl-out-company-name    to out-comp-name
   994     move bl-out-formated-date   to out-format-date
   995     move bl-out-lf-prem (1)     to out-lf-iss-prem
   996     move bl-out-ah-prem (1)     to out-ah-iss-prem
   997     move bl-out-tot-prm (1)     to out-tot-prem
   998     move bl-out-lf-ref  (1)     to out-lf-ref-prem
   999     move bl-out-ah-ref  (1)     to out-ah-ref-prem
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  19
* BSSRCH.cbl
  1000     move bl-out-tot-ref (1)     to out-tot-refs
  1001     move bl-out-lf-net  (1)     to out-lf-net-prem
  1002     move bl-out-ah-net  (1)     to out-ah-net-prem
  1003     move bl-out-lf-iss-com (1)  to out-lf-iss-comm
  1004     move bl-out-ah-iss-com (1)  to out-ah-iss-comm
  1005     move bl-out-lf-ref-com (1)  to out-lf-ref-comm
  1006     move bl-out-ah-ref-com (1)  to out-ah-ref-comm
  1007     move bl-out-lf-net-com (1)  to out-lf-net-comm
  1008     move bl-out-ah-net-com (1)  to out-ah-net-comm
  1009     move bl-out-iss-com    (1)  to out-iss-comm
  1010     move bl-out-ref-com    (1)  to out-ref-comm
  1011     move bl-out-net-com    (1)  to out-net-comm
  1012     move bl-out-iss-cnt    (1)  to out-iss-cnt
  1013     move bl-out-can-cnt    (1)  to out-ref-cnt
  1014     move bl-out-net-cnt    (1)  to out-net-cnt
  1015     move bl-out-net-tot    (1)  to out-tot-netp
  1016     move bl-out-cm-cnt          to out-crt-cnt
  1017     move bl-out-lf-clms-pd      to out-lf-clms-pd
  1018     move bl-out-lf-clms-void    to out-lf-clms-void
  1019     move bl-out-lf-tot-clms     to out-lf-tot-clms
  1020     move bl-out-ah-clms-pd      to out-ah-clms-pd
  1021     move bl-out-ah-clms-void    to out-ah-clms-void
  1022     move bl-out-ah-tot-clms     to out-ah-tot-clms
  1023     move bl-out-clms-pd         to out-clms-pd
  1024     move bl-out-clms-void       to out-clms-void
  1025     move bl-out-tot-clms        to out-tot-clms
  1026     move bl-output-message      to output-msg
  1027     if bl-input-bld-file = 'YES'
  1028        move 'Balance File Created'
  1029                                 to output-msg
  1030     end-if
  1031
  1032* exec cics document create
  1033*       doctoken   (w-doctoken)
  1034*       template   ('BSDETAIL')
  1035*       symbollist (output-data)
  1036*       listlength (length of output-data)
  1037*    end-exec
  1038     MOVE 'BSDETAIL'
  1039      TO DFHEIVL0
  1040     MOVE LENGTH OF
  1041      output-data TO DFHEIV16
  1042*    MOVE '\"D tSL               )   #00000986' TO DFHEIV0
  1043     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1044     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1045     MOVE X'2020233030303030393836' TO DFHEIV0(25:11)
  1046     CALL 'kxdfhei1' USING DFHEIV0,
  1047           w-doctoken,
  1048           DFHEIV99,
  1049           DFHEIVL0,
  1050           output-data,
  1051           DFHEIV16,
  1052           DFHEIV99,
  1053           DFHEIV99,
  1054           DFHEIV99
  1055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1056     move 1                      to bl-index
  1057*    exec cics document insert
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  20
* BSSRCH.cbl
  1058*       doctoken (w-doctoken)
  1059*       template ('BSFTR')
  1060*    end-exec
  1061    if bl-fail
  1062
  1063* exec cics syncpoint rollback
  1064*      end-exec
  1065*    MOVE '6"R                   !   #00000998' TO DFHEIV0
  1066     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  1067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1068     MOVE X'2020233030303030393938' TO DFHEIV0(25:11)
  1069     CALL 'kxdfhei1' USING DFHEIV0
  1070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1071    end-if
  1072****************************************
  1073* Send the document and return.
  1074****************************************
  1075
  1076* exec cics web send
  1077*       doctoken(w-doctoken)
  1078*    end-exec
  1079*    MOVE 'X$D                   *   #00001004' TO DFHEIV0
  1080     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1081     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1082     MOVE X'2020233030303031303034' TO DFHEIV0(25:11)
  1083     CALL 'kxdfhei1' USING DFHEIV0,
  1084           w-doctoken,
  1085           DFHEIV99,
  1086           DFHEIV99,
  1087           DFHEIV99,
  1088           DFHEIV99,
  1089           DFHEIV99,
  1090           DFHEIV99,
  1091           DFHEIV99,
  1092           DFHEIV99
  1093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1094     if bl-input-bld-file = 'YES'
  1095        evaluate bl-input-comp-id
  1096           when 'AHL'
  1097              move ahl-table     to cid-table
  1098              perform 0300-build-cid
  1099                                 thru 0300-exit
  1100              perform 0400-write-ahl
  1101                                 thru 0400-exit
  1102           when 'CID'
  1103              perform 0300-build-cid
  1104                                 thru 0300-exit
  1105              perform 0500-write-cid
  1106                                 thru 0500-exit
  1107           when 'DCC'
  1108              move dcc-table     to cid-table
  1109              perform 0300-build-cid
  1110                                 thru 0300-exit
  1111              perform 0600-write-dcc
  1112                                 thru 0600-exit
  1113        end-evaluate
  1114     end-if
  1115
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  21
* BSSRCH.cbl
  1116* exec cics return
  1117*    end-exec
  1118*    MOVE '.(                    ''   #00001028' TO DFHEIV0
  1119     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1121     MOVE X'2020233030303031303238' TO DFHEIV0(25:11)
  1122     CALL 'kxdfhei1' USING DFHEIV0,
  1123           DFHEIV99,
  1124           DFHEIV99,
  1125           DFHEIV99,
  1126           DFHEIV99,
  1127           DFHEIV99,
  1128           DFHEIV99
  1129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1130     .
  1131 0200-read-form.
  1132     move spaces                 to w-form-name
  1133     move length of w-form-name  to w-form-name-len
  1134     move spaces                 to w-form-value
  1135     move length of w-form-value to w-form-value-len
  1136
  1137* exec cics web readnext
  1138*       formfield   (w-form-name)
  1139*       namelength  (w-form-name-len)
  1140*       value       (w-form-value)
  1141*       valuelength (w-form-value-len)
  1142*       resp        (w-resp)
  1143*    end-exec
  1144*    MOVE 'X*FLVL                &  N#00001036' TO DFHEIV0
  1145     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1146     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1147     MOVE X'204E233030303031303336' TO DFHEIV0(25:11)
  1148     CALL 'kxdfhei1' USING DFHEIV0,
  1149           w-form-name,
  1150           w-form-name-len,
  1151           w-form-value,
  1152           w-form-value-len,
  1153           DFHEIV99
  1154     MOVE EIBRESP  TO w-resp
  1155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1156     evaluate w-resp
  1157        when 0
  1158*   dfhresp(normal)
  1159           evaluate w-form-name(1:w-form-name-len)
  1160              when 'eom_dte'
  1161                 if w-form-value-len not = 0
  1162                    move w-form-value(1:w-form-value-len)
  1163                                 to bl-input-eom-date
  1164                 else
  1165                    move spaces  to bl-input-eom-date
  1166                end-if
  1167              when 'comp_id'
  1168                 if w-form-value-len not = 0
  1169                    move w-form-value(1:w-form-value-len)
  1170                                 to bl-input-comp-id
  1171                 else
  1172                    move spaces  to bl-input-comp-id
  1173                end-if
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  22
* BSSRCH.cbl
  1174              when 'lo_resv'
  1175                 if w-form-value-len not = 0
  1176                    move w-form-value(1:w-form-value-len)
  1177                                 to work-mort-resv-lo
  1178                 else
  1179                    move zeros   to work-mort-resv-lo
  1180                end-if
  1181              when 'hi_resv'
  1182                 if w-form-value-len not = 0
  1183                    move w-form-value(1:w-form-value-len)
  1184                                 to work-mort-resv-hi
  1185                 else
  1186                    move zeros   to work-mort-resv-hi
  1187                end-if
  1188              when 'bld_file'
  1189                 if w-form-value-len not = 0
  1190                    move w-form-value(1:w-form-value-len)
  1191                                 to bl-input-bld-file
  1192                 else
  1193                    move spaces  to bl-input-bld-file
  1194                end-if
  1195           end-evaluate
  1196        when other
  1197           continue
  1198     end-evaluate
  1199     .
  1200 0200-exit.
  1201     exit.
  1202 0300-build-cid.
  1203     move +.98                   to ws-low-pct
  1204     move +1.02                  to ws-high-pct
  1205     perform varying s1 from +1 by +1 until s1 > +17
  1206        move -999999999          to tbl-low-amount (s1)
  1207        move +999999999          to tbl-hi-amount  (s1)
  1208     end-perform
  1209     move bl-out-tot-clms        to ws-pass-amount
  1210     perform 0310-calc-tol       thru 0310-exit
  1211     move ws-low-amount          to tbl-low-amount (1)
  1212     move ws-hi-amount           to tbl-hi-amount (1)
  1213*** processable gross premium
  1214     move bl-out-tot-prm (1)     to ws-pass-amount
  1215     perform 0310-calc-tol       thru 0310-exit
  1216     move ws-low-amount          to tbl-low-amount (2)
  1217     move ws-hi-amount           to tbl-hi-amount (2)
  1218*** non-processable gross premium
  1219     move +.90                   to ws-low-pct
  1220     move +1.10                  to ws-high-pct
  1221     move bl-out-tot-prm (2)     to ws-pass-amount
  1222     perform 0310-calc-tol       thru 0310-exit
  1223     move ws-low-amount          to tbl-low-amount (3)
  1224     move ws-hi-amount           to tbl-hi-amount (3)
  1225*** total gross premium
  1226     move +.98                   to ws-low-pct
  1227     move +1.02                  to ws-high-pct
  1228     compute tbl-low-amount (4) =
  1229        tbl-low-amount (2) + tbl-low-amount (3)
  1230     compute tbl-hi-amount (4) =
  1231        tbl-hi-amount (2) + tbl-hi-amount (3)
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  23
* BSSRCH.cbl
  1232*** processable refunded premium
  1233     move bl-out-tot-ref (1)     to ws-pass-amount
  1234     perform 0310-calc-tol       thru 0310-exit
  1235     move ws-low-amount          to tbl-low-amount (5)
  1236     move ws-hi-amount           to tbl-hi-amount (5)
  1237*** non-processable refunded premium
  1238     move +.60                   to ws-low-pct
  1239     move +1.40                  to ws-high-pct
  1240     move bl-out-tot-ref (2)     to ws-pass-amount
  1241     perform 0310-calc-tol       thru 0310-exit
  1242     move ws-low-amount          to tbl-low-amount (6)
  1243     move ws-hi-amount           to tbl-hi-amount (6)
  1244*** total refunded premium
  1245     move +.98                   to ws-low-pct
  1246     move +1.02                  to ws-high-pct
  1247     compute tbl-low-amount (7) =
  1248        tbl-low-amount (5) + tbl-low-amount (6)
  1249     compute tbl-hi-amount (7) =
  1250        tbl-hi-amount (5) + tbl-hi-amount (6)
  1251*** processable net premium
  1252     move bl-out-net-tot (1)     to ws-pass-amount
  1253     perform 0310-calc-tol       thru 0310-exit
  1254     move ws-low-amount          to tbl-low-amount (8)
  1255     move ws-hi-amount           to tbl-hi-amount (8)
  1256*** non-processable net premium
  1257     move +.90                   to ws-low-pct
  1258     move +1.10                  to ws-high-pct
  1259     move bl-out-net-tot (2)     to ws-pass-amount
  1260     perform 0310-calc-tol       thru 0310-exit
  1261     move ws-low-amount          to tbl-low-amount (9)
  1262     move ws-hi-amount           to tbl-hi-amount (9)
  1263*** total net premium
  1264     move +.98                   to ws-low-pct
  1265     move +1.02                  to ws-high-pct
  1266     compute tbl-low-amount (10) =
  1267        tbl-low-amount (8) + tbl-low-amount (9)
  1268     compute tbl-hi-amount (10) =
  1269        tbl-hi-amount (8) + tbl-hi-amount (9)
  1270*** processable commission
  1271     move bl-out-net-com (1)     to ws-pass-amount
  1272     perform 0310-calc-tol       thru 0310-exit
  1273     move ws-low-amount          to tbl-low-amount (11)
  1274     move ws-hi-amount           to tbl-hi-amount (11)
  1275*** non-processable commission
  1276     move +.90                   to ws-low-pct
  1277     move +1.10                  to ws-high-pct
  1278     move bl-out-net-com (2)     to ws-pass-amount
  1279     perform 0310-calc-tol       thru 0310-exit
  1280     move ws-low-amount          to tbl-low-amount (12)
  1281     move ws-hi-amount           to tbl-hi-amount (12)
  1282*** total commission
  1283     move +.98                   to ws-low-pct
  1284     move +1.02                  to ws-high-pct
  1285     compute tbl-low-amount (13) =
  1286        tbl-low-amount (11) + tbl-low-amount (12)
  1287     compute tbl-hi-amount (13) =
  1288        tbl-hi-amount (11) + tbl-hi-amount (12)
  1289     move bl-out-lf-tot-clms     to ws-pass-amount
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  24
* BSSRCH.cbl
  1290     perform 0310-calc-tol       thru 0310-exit
  1291     move ws-low-amount          to tbl-low-amount (14)
  1292     move ws-hi-amount           to tbl-hi-amount (14)
  1293     move bl-out-ah-tot-clms     to ws-pass-amount
  1294     perform 0310-calc-tol       thru 0310-exit
  1295     move ws-low-amount          to tbl-low-amount (15)
  1296     move ws-hi-amount           to tbl-hi-amount (15)
  1297     move bl-out-cm-cnt          to tbl-low-amount (16)
  1298                                    tbl-hi-amount  (16)
  1299     move bl-input-lo-resv       to tbl-low-amount (17)
  1300     move bl-input-hi-resv       to tbl-hi-amount (17)
  1301     .
  1302 0300-exit.
  1303     exit.
  1304 0310-calc-tol.
  1305     if ws-pass-amount > zeros
  1306        compute ws-low-amount = ws-pass-amount * ws-low-pct
  1307        compute ws-hi-amount  = ws-pass-amount * ws-high-pct
  1308     else
  1309        compute ws-low-amount = ws-pass-amount * ws-high-pct
  1310        compute ws-hi-amount  = ws-pass-amount * ws-low-pct
  1311     end-if
  1312     .
  1313 0310-exit.
  1314     exit.
  1315 0400-write-ahl.
  1316     open output ahl-chkpoint-out
  1317     if chkpnt-status not = '00'
  1318        move ' Cant open AHL CHKPNT file '
  1319           to bl-output-message
  1320        go to 0100-send-document
  1321     end-if
  1322     move bl-input-eom-date      to cpo-jobname
  1323     move 'AHL'                  to cpo-stepname
  1324     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1325        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1326        delimited by size into cpo-desc
  1327     end-string
  1328     write ahl-chkpoint-out-rec  from cpo-out-record
  1329     move spaces                 to cpo-jobname
  1330                                    cpo-stepname
  1331     move 'Proc Cnt'             to cpo-desc
  1332     move bl-out-iss-cnt (1)     to cpo-low-amount
  1333     move bl-out-can-cnt (1)     to cpo-hi-amount
  1334     write ahl-chkpoint-out-rec  from cpo-out-record
  1335     move 'NonProcCnt'           to cpo-desc
  1336     move bl-out-iss-cnt (2)     to cpo-low-amount
  1337     move bl-out-can-cnt (2)     to cpo-hi-amount
  1338     write ahl-chkpoint-out-rec  from cpo-out-record
  1339     move 'Total Cnt'            to cpo-desc
  1340     move bl-out-iss-cnt (3)     to cpo-low-amount
  1341     move bl-out-can-cnt (3)     to cpo-hi-amount
  1342     write ahl-chkpoint-out-rec  from cpo-out-record
  1343     move bl-out-lf-clms-cur     to ws-pass-amount
  1344     perform 0310-calc-tol       thru 0310-exit
  1345     move 'LF Claims Paid Curr'  to cpo-desc
  1346     move ws-low-amount          to cpo-low-amount
  1347     move ws-hi-amount           to cpo-hi-amount
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  25
* BSSRCH.cbl
  1348     write ahl-chkpoint-out-rec  from cpo-out-record
  1349     move bl-out-ah-clms-cur     to ws-pass-amount
  1350     perform 0310-calc-tol       thru 0310-exit
  1351     move 'AH Claims Paid Curr'  to cpo-desc
  1352     move ws-low-amount          to cpo-low-amount
  1353     move ws-hi-amount           to cpo-hi-amount
  1354     write ahl-chkpoint-out-rec  from cpo-out-record
  1355     move bl-out-tot-clms-cur    to ws-pass-amount
  1356     perform 0310-calc-tol       thru 0310-exit
  1357     move 'TOT Claims Paid Curr' to cpo-desc
  1358     move ws-low-amount          to cpo-low-amount
  1359     move ws-hi-amount           to cpo-hi-amount
  1360     write ahl-chkpoint-out-rec  from cpo-out-record
  1361     perform varying s1 from 1 by 1 until s1 > 17
  1362        move tbl-jobname    (s1) to cpo-jobname
  1363        move tbl-stepname   (s1) to cpo-stepname
  1364        move tbl-desc       (s1) to cpo-desc
  1365        move tbl-low-amount (s1) to cpo-low-amount
  1366        move tbl-hi-amount  (s1) to cpo-hi-amount
  1367        write ahl-chkpoint-out-rec from cpo-out-record
  1368     end-perform
  1369     close ahl-chkpoint-out
  1370     perform 0700-submit-job     thru 0700-exit
  1371     .
  1372 0400-exit.
  1373     exit.
  1374 0500-write-cid.
  1375     open output cid-chkpoint-out
  1376     if chkpnt-status not = '00'
  1377        move ' Cant open CID CHKPNT file '
  1378           to bl-output-message
  1379        go to 0100-send-document
  1380     end-if
  1381     move bl-input-eom-date      to cpo-jobname
  1382     move 'CID'                  to cpo-stepname
  1383     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1384        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1385        delimited by size into cpo-desc
  1386     end-string
  1387     write cid-chkpoint-out-rec  from cpo-out-record
  1388     move spaces                 to cpo-jobname
  1389                                    cpo-stepname
  1390     move 'Proc Cnt'             to cpo-desc
  1391     move bl-out-iss-cnt (1)     to cpo-low-amount
  1392     move bl-out-can-cnt (1)     to cpo-hi-amount
  1393     write cid-chkpoint-out-rec  from cpo-out-record
  1394     move 'NonProcCnt'           to cpo-desc
  1395     move bl-out-iss-cnt (2)     to cpo-low-amount
  1396     move bl-out-can-cnt (2)     to cpo-hi-amount
  1397     write cid-chkpoint-out-rec  from cpo-out-record
  1398     move 'Total Cnt'            to cpo-desc
  1399     move bl-out-iss-cnt (3)     to cpo-low-amount
  1400     move bl-out-can-cnt (3)     to cpo-hi-amount
  1401     write cid-chkpoint-out-rec  from cpo-out-record
  1402     move bl-out-lf-clms-cur     to ws-pass-amount
  1403     perform 0310-calc-tol       thru 0310-exit
  1404     move 'LF Claims Paid Curr'  to cpo-desc
  1405     move ws-low-amount          to cpo-low-amount
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  26
* BSSRCH.cbl
  1406     move ws-hi-amount           to cpo-hi-amount
  1407     write cid-chkpoint-out-rec  from cpo-out-record
  1408     move bl-out-ah-clms-cur     to ws-pass-amount
  1409     perform 0310-calc-tol       thru 0310-exit
  1410     move 'AH Claims Paid Curr'  to cpo-desc
  1411     move ws-low-amount          to cpo-low-amount
  1412     move ws-hi-amount           to cpo-hi-amount
  1413     write cid-chkpoint-out-rec  from cpo-out-record
  1414     move bl-out-tot-clms-cur    to ws-pass-amount
  1415     perform 0310-calc-tol       thru 0310-exit
  1416     move 'TOT Claims Paid Curr' to cpo-desc
  1417     move ws-low-amount          to cpo-low-amount
  1418     move ws-hi-amount           to cpo-hi-amount
  1419     write cid-chkpoint-out-rec  from cpo-out-record
  1420     perform varying s1 from 1 by 1 until s1 > 17
  1421        move tbl-jobname    (s1) to cpo-jobname
  1422        move tbl-stepname   (s1) to cpo-stepname
  1423        move tbl-desc       (s1) to cpo-desc
  1424        move tbl-low-amount (s1) to cpo-low-amount
  1425        move tbl-hi-amount  (s1) to cpo-hi-amount
  1426        write cid-chkpoint-out-rec
  1427                                 from cpo-out-record
  1428     end-perform
  1429     close cid-chkpoint-out
  1430     perform 0700-submit-job     thru 0700-exit
  1431     .
  1432 0500-exit.
  1433     exit.
  1434 0600-write-dcc.
  1435     open output dcc-chkpoint-out
  1436     if chkpnt-status not = '00'
  1437        move ' Cant open DCC CHKPNT file '
  1438           to bl-output-message
  1439        go to 0100-send-document
  1440     end-if
  1441     move bl-input-eom-date      to cpo-jobname
  1442     move 'DCC'                  to cpo-stepname
  1443     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1444        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1445        delimited by size into cpo-desc
  1446     end-string
  1447     write dcc-chkpoint-out-rec  from cpo-out-record
  1448     move spaces                 to cpo-jobname
  1449                                    cpo-stepname
  1450     move 'Proc Cnt'             to cpo-desc
  1451     move bl-out-iss-cnt (1)     to cpo-low-amount
  1452     move bl-out-can-cnt (1)     to cpo-hi-amount
  1453     write dcc-chkpoint-out-rec  from cpo-out-record
  1454     move 'NonProcCnt'           to cpo-desc
  1455     move bl-out-iss-cnt (2)     to cpo-low-amount
  1456     move bl-out-can-cnt (2)     to cpo-hi-amount
  1457     write dcc-chkpoint-out-rec  from cpo-out-record
  1458     move 'Total Cnt'            to cpo-desc
  1459     move bl-out-iss-cnt (3)     to cpo-low-amount
  1460     move bl-out-can-cnt (3)     to cpo-hi-amount
  1461     write dcc-chkpoint-out-rec  from cpo-out-record
  1462     move bl-out-lf-clms-cur     to ws-pass-amount
  1463     perform 0310-calc-tol       thru 0310-exit
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  27
* BSSRCH.cbl
  1464     move 'LF Claims Paid Curr'  to cpo-desc
  1465     move ws-low-amount          to cpo-low-amount
  1466     move ws-hi-amount           to cpo-hi-amount
  1467     write dcc-chkpoint-out-rec  from cpo-out-record
  1468     move bl-out-ah-clms-cur     to ws-pass-amount
  1469     perform 0310-calc-tol       thru 0310-exit
  1470     move 'AH Claims Paid Curr'  to cpo-desc
  1471     move ws-low-amount          to cpo-low-amount
  1472     move ws-hi-amount           to cpo-hi-amount
  1473     write dcc-chkpoint-out-rec  from cpo-out-record
  1474     move bl-out-tot-clms-cur    to ws-pass-amount
  1475     perform 0310-calc-tol       thru 0310-exit
  1476     move 'TOT Claims Paid Curr' to cpo-desc
  1477     move ws-low-amount          to cpo-low-amount
  1478     move ws-hi-amount           to cpo-hi-amount
  1479     write dcc-chkpoint-out-rec  from cpo-out-record
  1480     perform varying s1 from 1 by 1 until s1 > 16
  1481        move tbl-jobname    (s1) to cpo-jobname
  1482        move tbl-stepname   (s1) to cpo-stepname
  1483        move tbl-desc       (s1) to cpo-desc
  1484        move tbl-low-amount (s1) to cpo-low-amount
  1485        move tbl-hi-amount  (s1) to cpo-hi-amount
  1486        write dcc-chkpoint-out-rec from cpo-out-record
  1487     end-perform
  1488     close dcc-chkpoint-out
  1489     perform 0700-submit-job     thru 0700-exit
  1490     .
  1491 0600-exit.
  1492     exit.
  1493 0700-submit-job.
  1494     move function lower-case(bl-input-comp-id)
  1495                                 to tran-comp-id
  1496
  1497* EXEC CICS WRITEQ TD
  1498*       QUEUE ('BTCH')
  1499*       FROM (TRAN-DATA-LINE1)
  1500*       LENGTH (80)
  1501*    END-EXEC
  1502     MOVE 80
  1503       TO DFHEIV11
  1504     MOVE 'BTCH' TO DFHEIV5
  1505*    MOVE '(" L                  &   #00001382' TO DFHEIV0
  1506     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1507     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1508     MOVE X'2020233030303031333832' TO DFHEIV0(25:11)
  1509     CALL 'kxdfhei1' USING DFHEIV0,
  1510           DFHEIV5,
  1511           TRAN-DATA-LINE1,
  1512           DFHEIV11,
  1513           DFHEIV99,
  1514           DFHEIV99
  1515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1516
  1517* EXEC CICS WRITEQ TD
  1518*       QUEUE ('BTCH')
  1519*       FROM (TRAN-DATA-LINE2)
  1520*       LENGTH (80)
  1521*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Mar-14 08:14 Page  28
* BSSRCH.cbl
  1522     MOVE 80
  1523       TO DFHEIV11
  1524     MOVE 'BTCH' TO DFHEIV5
  1525*    MOVE '(" L                  &   #00001387' TO DFHEIV0
  1526     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1528     MOVE X'2020233030303031333837' TO DFHEIV0(25:11)
  1529     CALL 'kxdfhei1' USING DFHEIV0,
  1530           DFHEIV5,
  1531           TRAN-DATA-LINE2,
  1532           DFHEIV11,
  1533           DFHEIV99,
  1534           DFHEIV99
  1535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1536     .
  1537 0700-exit.
  1538     exit.
  1539
  1540 9999-DFHBACK SECTION.
  1541     MOVE '9%                    "   ' TO DFHEIV0
  1542     MOVE 'BSSRCH' TO DFHEIV1
  1543     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1544     GOBACK.
  1545 9999-DFHEXIT.
  1546     IF DFHEIGDJ EQUAL 0001
  1547         NEXT SENTENCE.
  1548     MOVE '9%                    "   ' TO DFHEIV0
  1549     MOVE 'BSSRCH' TO DFHEIV1
  1550     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1551     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10712     Code:        8204
